Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648488861.2213535
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0010123252868652344  GigaBytes
Max Memory Allocated: 0.0010123252868652344  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.02487969398498535
range selection method range initialization spend 0.013367414474487305
time for parepare:  0.017907381057739258
local_output_nid generation:  0.0013492107391357422
local_in_edges_tensor generation:  0.003859996795654297
mini_batch_src_global generation:  0.0017917156219482422
r_  generation:  0.018152952194213867
local_output_nid generation:  0.0014472007751464844
local_in_edges_tensor generation:  0.0008921623229980469
mini_batch_src_global generation:  0.0021009445190429688
r_  generation:  0.017609357833862305
local_output_nid generation:  0.001443624496459961
local_in_edges_tensor generation:  0.0008535385131835938
mini_batch_src_global generation:  0.001321554183959961
r_  generation:  0.017307758331298828
local_output_nid generation:  0.001470327377319336
local_in_edges_tensor generation:  0.0008330345153808594
mini_batch_src_global generation:  0.0013599395751953125
r_  generation:  0.017568349838256836
local_output_nid generation:  0.0014562606811523438
local_in_edges_tensor generation:  0.0008563995361328125
mini_batch_src_global generation:  0.0012831687927246094
r_  generation:  0.01839756965637207
local_output_nid generation:  0.0014748573303222656
local_in_edges_tensor generation:  0.0008387565612792969
mini_batch_src_global generation:  0.0014538764953613281
r_  generation:  0.018710613250732422
local_output_nid generation:  0.0014843940734863281
local_in_edges_tensor generation:  0.0008728504180908203
mini_batch_src_global generation:  0.0013892650604248047
r_  generation:  0.018335342407226562
local_output_nid generation:  0.001470804214477539
local_in_edges_tensor generation:  0.0008203983306884766
mini_batch_src_global generation:  0.0014195442199707031
r_  generation:  0.018192052841186523
local_output_nid generation:  0.0014853477478027344
local_in_edges_tensor generation:  0.0008230209350585938
mini_batch_src_global generation:  0.001333475112915039
r_  generation:  0.018300533294677734
local_output_nid generation:  0.0014748573303222656
local_in_edges_tensor generation:  0.000820159912109375
mini_batch_src_global generation:  0.001444101333618164
r_  generation:  0.018749475479125977
local_output_nid generation:  0.0015230178833007812
local_in_edges_tensor generation:  0.0008606910705566406
mini_batch_src_global generation:  0.0013573169708251953
r_  generation:  0.01879286766052246
local_output_nid generation:  0.001485586166381836
local_in_edges_tensor generation:  0.0008153915405273438
mini_batch_src_global generation:  0.0015511512756347656
r_  generation:  0.01859116554260254
local_output_nid generation:  0.0014786720275878906
local_in_edges_tensor generation:  0.0008203983306884766
mini_batch_src_global generation:  0.0013911724090576172
r_  generation:  0.019054651260375977
local_output_nid generation:  0.0014636516571044922
local_in_edges_tensor generation:  0.000865936279296875
mini_batch_src_global generation:  0.001489400863647461
r_  generation:  0.01858806610107422
local_output_nid generation:  0.0014607906341552734
local_in_edges_tensor generation:  0.0008029937744140625
mini_batch_src_global generation:  0.0015001296997070312
r_  generation:  0.01881694793701172
local_output_nid generation:  0.0014727115631103516
local_in_edges_tensor generation:  0.0008165836334228516
mini_batch_src_global generation:  0.0014865398406982422
r_  generation:  0.0184328556060791
----------------------check_connections_block total spend ----------------------------- 0.44098949432373047
generate_one_block  0.026964902877807617
generate_one_block  0.028131484985351562
generate_one_block  0.026688575744628906
generate_one_block  0.029084205627441406
generate_one_block  0.02800607681274414
generate_one_block  0.027593135833740234
generate_one_block  0.027054786682128906
generate_one_block  0.027185440063476562
generate_one_block  0.027315378189086914
generate_one_block  0.027714967727661133
generate_one_block  0.02743697166442871
generate_one_block  0.027265071868896484
generate_one_block  0.027477741241455078
generate_one_block  0.02758502960205078
generate_one_block  0.02734684944152832
generate_one_block  0.02749156951904297
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04110383987426758
gen group dst list time:  0.018559932708740234
time for parepare:  0.019238948822021484
local_output_nid generation:  0.0065500736236572266
local_in_edges_tensor generation:  0.016178131103515625
mini_batch_src_global generation:  0.019769906997680664
r_  generation:  0.1953597068786621
local_output_nid generation:  0.009990930557250977
local_in_edges_tensor generation:  0.018566608428955078
mini_batch_src_global generation:  0.025919437408447266
r_  generation:  0.20482587814331055
local_output_nid generation:  0.009923696517944336
local_in_edges_tensor generation:  0.014746904373168945
mini_batch_src_global generation:  0.024257898330688477
r_  generation:  0.2034449577331543
local_output_nid generation:  0.010270357131958008
local_in_edges_tensor generation:  0.015339374542236328
mini_batch_src_global generation:  0.0254058837890625
r_  generation:  0.20865511894226074
local_output_nid generation:  0.010753393173217773
local_in_edges_tensor generation:  0.015810251235961914
mini_batch_src_global generation:  0.02886199951171875
r_  generation:  0.2186577320098877
local_output_nid generation:  0.010746002197265625
local_in_edges_tensor generation:  0.014245748519897461
mini_batch_src_global generation:  0.03207993507385254
r_  generation:  0.21750473976135254
local_output_nid generation:  0.010576963424682617
local_in_edges_tensor generation:  0.012200117111206055
mini_batch_src_global generation:  0.0271756649017334
r_  generation:  0.21198678016662598
local_output_nid generation:  0.010865449905395508
local_in_edges_tensor generation:  0.012268304824829102
mini_batch_src_global generation:  0.03274869918823242
r_  generation:  0.22055625915527344
local_output_nid generation:  0.010901927947998047
local_in_edges_tensor generation:  0.017949342727661133
mini_batch_src_global generation:  0.027158021926879883
r_  generation:  0.2178182601928711
local_output_nid generation:  0.011172771453857422
local_in_edges_tensor generation:  0.018030881881713867
mini_batch_src_global generation:  0.03319215774536133
r_  generation:  0.2189953327178955
local_output_nid generation:  0.011065483093261719
local_in_edges_tensor generation:  0.012847185134887695
mini_batch_src_global generation:  0.027593374252319336
r_  generation:  0.21697592735290527
local_output_nid generation:  0.011036396026611328
local_in_edges_tensor generation:  0.012542486190795898
mini_batch_src_global generation:  0.027525901794433594
r_  generation:  0.21856403350830078
local_output_nid generation:  0.01106882095336914
local_in_edges_tensor generation:  0.01571941375732422
mini_batch_src_global generation:  0.027385473251342773
r_  generation:  0.21784257888793945
local_output_nid generation:  0.011049509048461914
local_in_edges_tensor generation:  0.01255178451538086
mini_batch_src_global generation:  0.027573347091674805
r_  generation:  0.21556973457336426
local_output_nid generation:  0.011213302612304688
local_in_edges_tensor generation:  0.014297246932983398
mini_batch_src_global generation:  0.027249574661254883
r_  generation:  0.21729612350463867
local_output_nid generation:  0.011233329772949219
local_in_edges_tensor generation:  0.014287948608398438
mini_batch_src_global generation:  0.027484655380249023
r_  generation:  0.21534156799316406
----------------------check_connections_block total spend ----------------------------- 5.037049770355225
generate_one_block  0.28220701217651367
generate_one_block  0.27979111671447754
generate_one_block  0.2766735553741455
generate_one_block  0.27833104133605957
generate_one_block  0.3096432685852051
generate_one_block  0.2874011993408203
generate_one_block  0.2730069160461426
generate_one_block  0.27472400665283203
generate_one_block  0.2868845462799072
generate_one_block  0.2892303466796875
generate_one_block  0.27588605880737305
generate_one_block  0.2764699459075928
generate_one_block  0.27946925163269043
generate_one_block  0.27513718605041504
generate_one_block  0.28356456756591797
generate_one_block  0.2758045196533203
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04713773727416992
gen group dst list time:  0.06009268760681152
time for parepare:  0.018642187118530273
local_output_nid generation:  0.02399134635925293
local_in_edges_tensor generation:  0.03948664665222168
mini_batch_src_global generation:  0.04723620414733887
r_  generation:  0.4731762409210205
local_output_nid generation:  0.02965688705444336
local_in_edges_tensor generation:  0.04725837707519531
mini_batch_src_global generation:  0.06013989448547363
r_  generation:  0.48328232765197754
local_output_nid generation:  0.030513525009155273
local_in_edges_tensor generation:  0.04759383201599121
mini_batch_src_global generation:  0.059601783752441406
r_  generation:  0.5108704566955566
local_output_nid generation:  0.03340864181518555
local_in_edges_tensor generation:  0.04398345947265625
mini_batch_src_global generation:  0.05807781219482422
r_  generation:  0.49282002449035645
local_output_nid generation:  0.031830549240112305
local_in_edges_tensor generation:  0.042638540267944336
mini_batch_src_global generation:  0.05738568305969238
r_  generation:  0.4953286647796631
local_output_nid generation:  0.031495094299316406
local_in_edges_tensor generation:  0.028964757919311523
mini_batch_src_global generation:  0.05869650840759277
r_  generation:  0.49265551567077637
local_output_nid generation:  0.030968666076660156
local_in_edges_tensor generation:  0.03156566619873047
mini_batch_src_global generation:  0.05815863609313965
r_  generation:  0.491741418838501
local_output_nid generation:  0.03114604949951172
local_in_edges_tensor generation:  0.034038543701171875
mini_batch_src_global generation:  0.05818533897399902
r_  generation:  0.49057841300964355
local_output_nid generation:  0.031146764755249023
local_in_edges_tensor generation:  0.04359149932861328
mini_batch_src_global generation:  0.05738186836242676
r_  generation:  0.49341607093811035
local_output_nid generation:  0.03146982192993164
local_in_edges_tensor generation:  0.03464388847351074
mini_batch_src_global generation:  0.0625159740447998
r_  generation:  0.4919426441192627
local_output_nid generation:  0.031301021575927734
local_in_edges_tensor generation:  0.028914690017700195
mini_batch_src_global generation:  0.05792832374572754
r_  generation:  0.4946262836456299
local_output_nid generation:  0.031177759170532227
local_in_edges_tensor generation:  0.030345678329467773
mini_batch_src_global generation:  0.059845924377441406
r_  generation:  0.49000120162963867
local_output_nid generation:  0.03139638900756836
local_in_edges_tensor generation:  0.032956838607788086
mini_batch_src_global generation:  0.06171393394470215
r_  generation:  0.49800801277160645
local_output_nid generation:  0.032573699951171875
local_in_edges_tensor generation:  0.038718223571777344
mini_batch_src_global generation:  0.06032109260559082
r_  generation:  0.4892895221710205
local_output_nid generation:  0.03176522254943848
local_in_edges_tensor generation:  0.03341054916381836
mini_batch_src_global generation:  0.057112693786621094
r_  generation:  0.49884915351867676
local_output_nid generation:  0.03148055076599121
local_in_edges_tensor generation:  0.04384326934814453
mini_batch_src_global generation:  0.06089043617248535
r_  generation:  0.49207305908203125
----------------------check_connections_block total spend ----------------------------- 11.620299100875854
generate_one_block  0.6357252597808838
generate_one_block  0.6459567546844482
generate_one_block  0.6232573986053467
generate_one_block  0.6312968730926514
generate_one_block  0.667285680770874
generate_one_block  0.6331372261047363
generate_one_block  0.6724076271057129
generate_one_block  0.6437032222747803
generate_one_block  0.6200351715087891
generate_one_block  0.6418521404266357
generate_one_block  0.6186723709106445
generate_one_block  0.6143922805786133
generate_one_block  0.6277074813842773
generate_one_block  0.6414082050323486
generate_one_block  0.6294376850128174
generate_one_block  0.6288466453552246
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.07142090797424316
gen group dst list time:  0.08791661262512207
time for parepare:  0.019466161727905273
local_output_nid generation:  0.031874895095825195
local_in_edges_tensor generation:  0.061682939529418945
mini_batch_src_global generation:  0.044692039489746094
r_  generation:  0.49491167068481445
local_output_nid generation:  0.037003278732299805
local_in_edges_tensor generation:  0.04385256767272949
mini_batch_src_global generation:  0.056001901626586914
r_  generation:  0.49634552001953125
local_output_nid generation:  0.03716731071472168
local_in_edges_tensor generation:  0.03783011436462402
mini_batch_src_global generation:  0.05406546592712402
r_  generation:  0.49950718879699707
local_output_nid generation:  0.036255598068237305
local_in_edges_tensor generation:  0.03639578819274902
mini_batch_src_global generation:  0.053314924240112305
r_  generation:  0.4997730255126953
local_output_nid generation:  0.03627276420593262
local_in_edges_tensor generation:  0.04153776168823242
mini_batch_src_global generation:  0.05350661277770996
r_  generation:  0.5069634914398193
local_output_nid generation:  0.03640246391296387
local_in_edges_tensor generation:  0.04055070877075195
mini_batch_src_global generation:  0.05430245399475098
r_  generation:  0.5069010257720947
local_output_nid generation:  0.03729581832885742
local_in_edges_tensor generation:  0.041409969329833984
mini_batch_src_global generation:  0.05484485626220703
r_  generation:  0.5130167007446289
local_output_nid generation:  0.03690147399902344
local_in_edges_tensor generation:  0.0460205078125
mini_batch_src_global generation:  0.054644107818603516
r_  generation:  0.5107841491699219
local_output_nid generation:  0.03829765319824219
local_in_edges_tensor generation:  0.0376894474029541
mini_batch_src_global generation:  0.0555267333984375
r_  generation:  0.5171587467193604
local_output_nid generation:  0.03794074058532715
local_in_edges_tensor generation:  0.04615354537963867
mini_batch_src_global generation:  0.05899405479431152
r_  generation:  0.5131568908691406
local_output_nid generation:  0.03705263137817383
local_in_edges_tensor generation:  0.04104924201965332
mini_batch_src_global generation:  0.05576634407043457
r_  generation:  0.5200824737548828
local_output_nid generation:  0.03708529472351074
local_in_edges_tensor generation:  0.036797523498535156
mini_batch_src_global generation:  0.05633282661437988
r_  generation:  0.5207850933074951
local_output_nid generation:  0.036997079849243164
local_in_edges_tensor generation:  0.04630732536315918
mini_batch_src_global generation:  0.05917048454284668
r_  generation:  0.5178422927856445
local_output_nid generation:  0.03721785545349121
local_in_edges_tensor generation:  0.04123425483703613
mini_batch_src_global generation:  0.0554044246673584
r_  generation:  0.5321516990661621
local_output_nid generation:  0.037306785583496094
local_in_edges_tensor generation:  0.05060410499572754
mini_batch_src_global generation:  0.0556795597076416
r_  generation:  0.5179736614227295
local_output_nid generation:  0.037110090255737305
local_in_edges_tensor generation:  0.045861005783081055
mini_batch_src_global generation:  0.055283546447753906
r_  generation:  0.5212366580963135
----------------------check_connections_block total spend ----------------------------- 12.2909836769104
generate_one_block  0.6325585842132568
generate_one_block  0.7298080921173096
generate_one_block  0.6182308197021484
generate_one_block  0.6363644599914551
generate_one_block  0.6379973888397217
generate_one_block  0.6318960189819336
generate_one_block  0.6323795318603516
generate_one_block  0.6387133598327637
generate_one_block  0.6994497776031494
generate_one_block  0.6933465003967285
generate_one_block  0.6499099731445312
generate_one_block  0.6543128490447998
generate_one_block  0.6459445953369141
generate_one_block  0.6418752670288086
generate_one_block  0.6665852069854736
generate_one_block  0.6448779106140137
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0010123252868652344  GigaBytes
Max Memory Allocated: 0.0010123252868652344  GigaBytes

connection checking time:  28.94833254814148
block generation total time  25.133596897125244
average batch blocks generation time:  1.5708498060703278
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1990966796875 GB
    Memory Allocated: 0.10764694213867188  GigaBytes
Max Memory Allocated: 0.10764694213867188  GigaBytes

torch.Size([163659, 128])
torch.Size([155435, 64])
torch.Size([123829, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.6776123046875 GB
    Memory Allocated: 20.315643310546875  GigaBytes
Max Memory Allocated: 20.329642295837402  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 0.1096944808959961  GigaBytes
Max Memory Allocated: 20.329642295837402  GigaBytes

torch.Size([163741, 128])
torch.Size([155958, 64])
torch.Size([124351, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7967529296875 GB
    Memory Allocated: 20.360881805419922  GigaBytes
Max Memory Allocated: 20.375508308410645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7967529296875 GB
    Memory Allocated: 0.1095881462097168  GigaBytes
Max Memory Allocated: 20.375508308410645  GigaBytes

torch.Size([163508, 128])
torch.Size([155103, 64])
torch.Size([122808, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7967529296875 GB
    Memory Allocated: 20.256920337677002  GigaBytes
Max Memory Allocated: 20.375508308410645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7967529296875 GB
    Memory Allocated: 0.10965967178344727  GigaBytes
Max Memory Allocated: 20.375508308410645  GigaBytes

torch.Size([163746, 128])
torch.Size([155802, 64])
torch.Size([124295, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7967529296875 GB
    Memory Allocated: 20.326687812805176  GigaBytes
Max Memory Allocated: 20.375508308410645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7967529296875 GB
    Memory Allocated: 0.10992765426635742  GigaBytes
Max Memory Allocated: 20.375508308410645  GigaBytes

torch.Size([163690, 128])
torch.Size([155571, 64])
torch.Size([124453, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8045654296875 GB
    Memory Allocated: 20.46422004699707  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5545654296875 GB
    Memory Allocated: 0.1096944808959961  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

torch.Size([163571, 128])
torch.Size([155549, 64])
torch.Size([123930, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 20.36957883834839  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 0.10968351364135742  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

torch.Size([163542, 128])
torch.Size([155420, 64])
torch.Size([123403, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 20.29643440246582  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 0.10958194732666016  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

torch.Size([163577, 128])
torch.Size([155489, 64])
torch.Size([124111, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 20.334310054779053  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 0.10977983474731445  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

torch.Size([163614, 128])
torch.Size([155409, 64])
torch.Size([123593, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 20.35832691192627  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 0.10969686508178711  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

torch.Size([163614, 128])
torch.Size([155821, 64])
torch.Size([124626, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 20.385239124298096  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 0.10971593856811523  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

torch.Size([163583, 128])
torch.Size([155430, 64])
torch.Size([123557, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 20.315285205841064  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 0.10949134826660156  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

torch.Size([163369, 128])
torch.Size([155067, 64])
torch.Size([122861, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 20.312577724456787  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 0.10973978042602539  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

torch.Size([163561, 128])
torch.Size([155467, 64])
torch.Size([123674, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 20.336415767669678  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 0.10951948165893555  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

torch.Size([163486, 128])
torch.Size([155275, 64])
torch.Size([123888, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 20.305049419403076  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 0.10970544815063477  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

torch.Size([163662, 128])
torch.Size([155710, 64])
torch.Size([124160, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 20.321590423583984  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 0.10950994491577148  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

torch.Size([163532, 128])
torch.Size([155682, 64])
torch.Size([123792, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 20.301700115203857  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0424959659576416 |0.05220337212085724 |0.41666558384895325 |0.00010690093040466309 |0.5373430550098419 |0.009236812591552734 |
----------------------------------------------------------pseudo_mini_loss sum 4.741672515869141
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  7748342
Number of first layer input nodes during this epoch:  2617455
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 0.16113662719726562  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.023296117782592773
range selection method range initialization spend 0.012513399124145508
time for parepare:  0.017596960067749023
local_output_nid generation:  0.0018286705017089844
local_in_edges_tensor generation:  0.007747650146484375
mini_batch_src_global generation:  0.0020215511322021484
r_  generation:  0.026410579681396484
local_output_nid generation:  0.002447366714477539
local_in_edges_tensor generation:  0.0011103153228759766
mini_batch_src_global generation:  0.0022521018981933594
r_  generation:  0.018436670303344727
local_output_nid generation:  0.002252817153930664
local_in_edges_tensor generation:  0.0009951591491699219
mini_batch_src_global generation:  0.0014872550964355469
r_  generation:  0.018795013427734375
local_output_nid generation:  0.0021758079528808594
local_in_edges_tensor generation:  0.0009729862213134766
mini_batch_src_global generation:  0.0014085769653320312
r_  generation:  0.01871204376220703
local_output_nid generation:  0.0020318031311035156
local_in_edges_tensor generation:  0.0008807182312011719
mini_batch_src_global generation:  0.0014777183532714844
r_  generation:  0.018505096435546875
local_output_nid generation:  0.002003908157348633
local_in_edges_tensor generation:  0.0008988380432128906
mini_batch_src_global generation:  0.0015423297882080078
r_  generation:  0.019127607345581055
local_output_nid generation:  0.001954317092895508
local_in_edges_tensor generation:  0.0009410381317138672
mini_batch_src_global generation:  0.0015823841094970703
r_  generation:  0.018799304962158203
local_output_nid generation:  0.001973867416381836
local_in_edges_tensor generation:  0.0009720325469970703
mini_batch_src_global generation:  0.0015642642974853516
r_  generation:  0.019134998321533203
local_output_nid generation:  0.0020856857299804688
local_in_edges_tensor generation:  0.0009126663208007812
mini_batch_src_global generation:  0.0014958381652832031
r_  generation:  0.019048690795898438
local_output_nid generation:  0.0019958019256591797
local_in_edges_tensor generation:  0.0009393692016601562
mini_batch_src_global generation:  0.0015597343444824219
r_  generation:  0.019664287567138672
local_output_nid generation:  0.0019779205322265625
local_in_edges_tensor generation:  0.0009143352508544922
mini_batch_src_global generation:  0.0016202926635742188
r_  generation:  0.019024133682250977
local_output_nid generation:  0.0019352436065673828
local_in_edges_tensor generation:  0.00089263916015625
mini_batch_src_global generation:  0.0015134811401367188
r_  generation:  0.019248485565185547
local_output_nid generation:  0.001978635787963867
local_in_edges_tensor generation:  0.0009169578552246094
mini_batch_src_global generation:  0.001573801040649414
r_  generation:  0.019275665283203125
local_output_nid generation:  0.0019314289093017578
local_in_edges_tensor generation:  0.000926971435546875
mini_batch_src_global generation:  0.0014591217041015625
r_  generation:  0.01964545249938965
local_output_nid generation:  0.0019538402557373047
local_in_edges_tensor generation:  0.0009257793426513672
mini_batch_src_global generation:  0.0015797615051269531
r_  generation:  0.019564151763916016
local_output_nid generation:  0.0019464492797851562
local_in_edges_tensor generation:  0.0009016990661621094
mini_batch_src_global generation:  0.0016160011291503906
r_  generation:  0.01951909065246582
----------------------check_connections_block total spend ----------------------------- 0.4866483211517334
generate_one_block  0.0478816032409668
generate_one_block  0.032523393630981445
generate_one_block  0.032294511795043945
generate_one_block  0.03202033042907715
generate_one_block  0.03182506561279297
generate_one_block  0.03661823272705078
generate_one_block  0.03499555587768555
generate_one_block  0.03279709815979004
generate_one_block  0.03270697593688965
generate_one_block  0.03289222717285156
generate_one_block  0.03249549865722656
generate_one_block  0.03131556510925293
generate_one_block  0.032469749450683594
generate_one_block  0.03253984451293945
generate_one_block  0.0325922966003418
generate_one_block  0.03274035453796387
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04134011268615723
gen group dst list time:  0.018689870834350586
time for parepare:  0.0203857421875
local_output_nid generation:  0.008364439010620117
local_in_edges_tensor generation:  0.02212691307067871
mini_batch_src_global generation:  0.022222280502319336
r_  generation:  0.20541977882385254
local_output_nid generation:  0.013594627380371094
local_in_edges_tensor generation:  0.021277189254760742
mini_batch_src_global generation:  0.025260210037231445
r_  generation:  0.20739197731018066
local_output_nid generation:  0.014353513717651367
local_in_edges_tensor generation:  0.017850399017333984
mini_batch_src_global generation:  0.02425384521484375
r_  generation:  0.2158668041229248
local_output_nid generation:  0.0220944881439209
local_in_edges_tensor generation:  0.025166988372802734
mini_batch_src_global generation:  0.03185749053955078
r_  generation:  0.24271845817565918
local_output_nid generation:  0.015958547592163086
local_in_edges_tensor generation:  0.015122413635253906
mini_batch_src_global generation:  0.0317378044128418
r_  generation:  0.2396230697631836
local_output_nid generation:  0.015716552734375
local_in_edges_tensor generation:  0.022739887237548828
mini_batch_src_global generation:  0.032526493072509766
r_  generation:  0.2475748062133789
local_output_nid generation:  0.01547384262084961
local_in_edges_tensor generation:  0.015347003936767578
mini_batch_src_global generation:  0.03256821632385254
r_  generation:  0.24587535858154297
local_output_nid generation:  0.015481233596801758
local_in_edges_tensor generation:  0.0163419246673584
mini_batch_src_global generation:  0.03667902946472168
r_  generation:  0.24261188507080078
local_output_nid generation:  0.015646696090698242
local_in_edges_tensor generation:  0.017319440841674805
mini_batch_src_global generation:  0.03104567527770996
r_  generation:  0.2438192367553711
local_output_nid generation:  0.015197515487670898
local_in_edges_tensor generation:  0.020415306091308594
mini_batch_src_global generation:  0.036157846450805664
r_  generation:  0.27283787727355957
local_output_nid generation:  0.018039464950561523
local_in_edges_tensor generation:  0.025179147720336914
mini_batch_src_global generation:  0.03425025939941406
r_  generation:  0.23875832557678223
local_output_nid generation:  0.014920473098754883
local_in_edges_tensor generation:  0.016917943954467773
mini_batch_src_global generation:  0.03083658218383789
r_  generation:  0.23479652404785156
local_output_nid generation:  0.015465021133422852
local_in_edges_tensor generation:  0.022382497787475586
mini_batch_src_global generation:  0.031842708587646484
r_  generation:  0.24208593368530273
local_output_nid generation:  0.015163183212280273
local_in_edges_tensor generation:  0.016979694366455078
mini_batch_src_global generation:  0.03165388107299805
r_  generation:  0.24457716941833496
local_output_nid generation:  0.015568733215332031
local_in_edges_tensor generation:  0.015515804290771484
mini_batch_src_global generation:  0.031815290451049805
r_  generation:  0.24365544319152832
local_output_nid generation:  0.015198230743408203
local_in_edges_tensor generation:  0.017179250717163086
mini_batch_src_global generation:  0.03194999694824219
r_  generation:  0.2408895492553711
----------------------check_connections_block total spend ----------------------------- 5.754233121871948
generate_one_block  0.3219590187072754
generate_one_block  0.31150174140930176
generate_one_block  0.31142663955688477
generate_one_block  0.3037130832672119
generate_one_block  0.2914128303527832
generate_one_block  0.3063023090362549
generate_one_block  0.3221406936645508
generate_one_block  0.3358290195465088
generate_one_block  0.3213212490081787
generate_one_block  0.29572629928588867
generate_one_block  0.2929198741912842
generate_one_block  0.2842121124267578
generate_one_block  0.2969837188720703
generate_one_block  0.2980978488922119
generate_one_block  0.29200029373168945
generate_one_block  0.29813528060913086
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05085492134094238
gen group dst list time:  0.07514286041259766
time for parepare:  0.017566919326782227
local_output_nid generation:  0.02730584144592285
local_in_edges_tensor generation:  0.055979251861572266
mini_batch_src_global generation:  0.04891633987426758
r_  generation:  0.5020954608917236
local_output_nid generation:  0.030199766159057617
local_in_edges_tensor generation:  0.05087733268737793
mini_batch_src_global generation:  0.05645561218261719
r_  generation:  0.5025644302368164
local_output_nid generation:  0.030391454696655273
local_in_edges_tensor generation:  0.03624081611633301
mini_batch_src_global generation:  0.05571579933166504
r_  generation:  0.49961280822753906
local_output_nid generation:  0.030703306198120117
local_in_edges_tensor generation:  0.03853344917297363
mini_batch_src_global generation:  0.060092926025390625
r_  generation:  0.5359537601470947
local_output_nid generation:  0.03368234634399414
local_in_edges_tensor generation:  0.10914444923400879
mini_batch_src_global generation:  0.06512641906738281
r_  generation:  0.5019586086273193
local_output_nid generation:  0.031143903732299805
local_in_edges_tensor generation:  0.04583477973937988
mini_batch_src_global generation:  0.061621665954589844
r_  generation:  0.5034909248352051
local_output_nid generation:  0.031003713607788086
local_in_edges_tensor generation:  0.034659385681152344
mini_batch_src_global generation:  0.05755352973937988
r_  generation:  0.5020663738250732
local_output_nid generation:  0.031172990798950195
local_in_edges_tensor generation:  0.036110639572143555
mini_batch_src_global generation:  0.061794281005859375
r_  generation:  0.49585723876953125
local_output_nid generation:  0.031299591064453125
local_in_edges_tensor generation:  0.03248238563537598
mini_batch_src_global generation:  0.057396888732910156
r_  generation:  0.5061380863189697
local_output_nid generation:  0.031032800674438477
local_in_edges_tensor generation:  0.03593850135803223
mini_batch_src_global generation:  0.06203269958496094
r_  generation:  0.4995763301849365
local_output_nid generation:  0.03105759620666504
local_in_edges_tensor generation:  0.032388925552368164
mini_batch_src_global generation:  0.0575864315032959
r_  generation:  0.511223554611206
local_output_nid generation:  0.031148195266723633
local_in_edges_tensor generation:  0.035660743713378906
mini_batch_src_global generation:  0.0589296817779541
r_  generation:  0.508164644241333
local_output_nid generation:  0.03336977958679199
local_in_edges_tensor generation:  0.04481697082519531
mini_batch_src_global generation:  0.05692100524902344
r_  generation:  0.5099670886993408
local_output_nid generation:  0.031243085861206055
local_in_edges_tensor generation:  0.04969930648803711
mini_batch_src_global generation:  0.05759716033935547
r_  generation:  0.4986131191253662
local_output_nid generation:  0.0312960147857666
local_in_edges_tensor generation:  0.03646492958068848
mini_batch_src_global generation:  0.05672430992126465
r_  generation:  0.5088794231414795
local_output_nid generation:  0.031178712844848633
local_in_edges_tensor generation:  0.03662705421447754
mini_batch_src_global generation:  0.05897784233093262
r_  generation:  0.5078234672546387
----------------------check_connections_block total spend ----------------------------- 11.969134092330933
generate_one_block  0.6950516700744629
generate_one_block  0.66042160987854
generate_one_block  0.6533446311950684
generate_one_block  0.6528685092926025
generate_one_block  0.6410317420959473
generate_one_block  0.6769030094146729
generate_one_block  0.6629769802093506
generate_one_block  0.658463716506958
generate_one_block  0.6780014038085938
generate_one_block  0.660348653793335
generate_one_block  0.6390881538391113
generate_one_block  0.6447558403015137
generate_one_block  0.6668238639831543
generate_one_block  0.6586084365844727
generate_one_block  0.6580181121826172
generate_one_block  0.6634039878845215
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04053139686584473
gen group dst list time:  0.09719371795654297
time for parepare:  0.019591808319091797
local_output_nid generation:  0.03271007537841797
local_in_edges_tensor generation:  0.049376487731933594
mini_batch_src_global generation:  0.04555773735046387
r_  generation:  0.4976954460144043
local_output_nid generation:  0.03961515426635742
local_in_edges_tensor generation:  0.03479886054992676
mini_batch_src_global generation:  0.05730390548706055
r_  generation:  0.5012223720550537
local_output_nid generation:  0.04048919677734375
local_in_edges_tensor generation:  0.0357058048248291
mini_batch_src_global generation:  0.05399799346923828
r_  generation:  0.5114009380340576
local_output_nid generation:  0.039899349212646484
local_in_edges_tensor generation:  0.0412442684173584
mini_batch_src_global generation:  0.05368304252624512
r_  generation:  0.5149097442626953
local_output_nid generation:  0.03839111328125
local_in_edges_tensor generation:  0.04350852966308594
mini_batch_src_global generation:  0.05389237403869629
r_  generation:  0.5213372707366943
local_output_nid generation:  0.03859972953796387
local_in_edges_tensor generation:  0.04106950759887695
mini_batch_src_global generation:  0.05504608154296875
r_  generation:  0.534883975982666
local_output_nid generation:  0.041567325592041016
local_in_edges_tensor generation:  0.04480338096618652
mini_batch_src_global generation:  0.06065487861633301
r_  generation:  0.5179927349090576
local_output_nid generation:  0.03939938545227051
local_in_edges_tensor generation:  0.04059290885925293
mini_batch_src_global generation:  0.05461716651916504
r_  generation:  0.5302004814147949
local_output_nid generation:  0.039160966873168945
local_in_edges_tensor generation:  0.04033613204956055
mini_batch_src_global generation:  0.05553150177001953
r_  generation:  0.519324541091919
local_output_nid generation:  0.03936958312988281
local_in_edges_tensor generation:  0.044286489486694336
mini_batch_src_global generation:  0.05554962158203125
r_  generation:  0.5220084190368652
local_output_nid generation:  0.039533376693725586
local_in_edges_tensor generation:  0.04079103469848633
mini_batch_src_global generation:  0.05547165870666504
r_  generation:  0.5331387519836426
local_output_nid generation:  0.039793968200683594
local_in_edges_tensor generation:  0.0416874885559082
mini_batch_src_global generation:  0.05614209175109863
r_  generation:  0.5230574607849121
local_output_nid generation:  0.03953123092651367
local_in_edges_tensor generation:  0.04449200630187988
mini_batch_src_global generation:  0.055771827697753906
r_  generation:  0.5291900634765625
local_output_nid generation:  0.03975033760070801
local_in_edges_tensor generation:  0.0399479866027832
mini_batch_src_global generation:  0.05608224868774414
r_  generation:  0.5230197906494141
local_output_nid generation:  0.03983306884765625
local_in_edges_tensor generation:  0.04459333419799805
mini_batch_src_global generation:  0.05579566955566406
r_  generation:  0.5289764404296875
local_output_nid generation:  0.03995513916015625
local_in_edges_tensor generation:  0.04069638252258301
mini_batch_src_global generation:  0.055303335189819336
r_  generation:  0.52321457862854
----------------------check_connections_block total spend ----------------------------- 12.44865608215332
generate_one_block  0.6643519401550293
generate_one_block  0.6535401344299316
generate_one_block  0.6643116474151611
generate_one_block  0.6476345062255859
generate_one_block  0.6635808944702148
generate_one_block  0.6637740135192871
generate_one_block  0.7117512226104736
generate_one_block  0.6420919895172119
generate_one_block  0.6417686939239502
generate_one_block  0.6498911380767822
generate_one_block  0.6602926254272461
generate_one_block  0.6640839576721191
generate_one_block  0.6396737098693848
generate_one_block  0.649174690246582
generate_one_block  0.6569328308105469
generate_one_block  0.6424322128295898
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 0.16113662719726562  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

connection checking time:  30.1720232963562
block generation total time  25.969078540802002
average batch blocks generation time:  1.6230674088001251
block dataloader generation time/epoch 59.086233377456665
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 0.11187744140625  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

torch.Size([163642, 128])
torch.Size([155770, 64])
torch.Size([124355, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 20.425002574920654  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 0.11158084869384766  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

torch.Size([163585, 128])
torch.Size([155428, 64])
torch.Size([123527, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 20.286314964294434  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 0.11181402206420898  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

torch.Size([163709, 128])
torch.Size([155477, 64])
torch.Size([123758, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 20.37000560760498  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 0.11162376403808594  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

torch.Size([163507, 128])
torch.Size([155378, 64])
torch.Size([123550, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 20.34119415283203  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 0.11164617538452148  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

torch.Size([163815, 128])
torch.Size([155842, 64])
torch.Size([123593, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 20.275949478149414  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 0.11176681518554688  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

torch.Size([163761, 128])
torch.Size([155938, 64])
torch.Size([124714, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 20.399611949920654  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 0.1116938591003418  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

torch.Size([163702, 128])
torch.Size([155460, 64])
torch.Size([123580, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 20.30498504638672  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 0.11168622970581055  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

torch.Size([163684, 128])
torch.Size([155641, 64])
torch.Size([124190, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 20.35429048538208  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 0.11174345016479492  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

torch.Size([163539, 128])
torch.Size([155452, 64])
torch.Size([123900, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 20.321210861206055  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 0.11173009872436523  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

torch.Size([163642, 128])
torch.Size([155492, 64])
torch.Size([123554, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 20.375003814697266  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 0.11167478561401367  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

torch.Size([163722, 128])
torch.Size([155509, 64])
torch.Size([123211, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 20.2857985496521  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 0.1115102767944336  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

torch.Size([163741, 128])
torch.Size([155696, 64])
torch.Size([123320, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 20.209839344024658  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 0.11182641983032227  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

torch.Size([163609, 128])
torch.Size([155377, 64])
torch.Size([123876, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 20.380423545837402  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 0.11168766021728516  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

torch.Size([163633, 128])
torch.Size([155330, 64])
torch.Size([123530, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 20.347867488861084  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 0.11174154281616211  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

torch.Size([163656, 128])
torch.Size([155666, 64])
torch.Size([124423, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 20.34359121322632  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 0.11163187026977539  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

torch.Size([163526, 128])
torch.Size([155407, 64])
torch.Size([123586, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 20.347514629364014  GigaBytes
Max Memory Allocated: 20.479313373565674  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04105745255947113 |0.028668418526649475 |0.3668714165687561 |9.685754776000977e-05 |0.5314302891492844 |0.008196830749511719 |
----------------------------------------------------------pseudo_mini_loss sum 3.7418789863586426
Total (block generation + training)time/epoch 74.62336277961731
Training time/epoch 15.536799907684326
Training time without block to device /epoch 15.078105211257935
Training time without total dataloading part /epoch 14.38257384300232
load block tensor time/epoch 0.6569192409515381
block to device time/epoch 0.4586946964263916
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  7749413
Number of first layer input nodes during this epoch:  2618473
