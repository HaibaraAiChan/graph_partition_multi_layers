Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648507161.4248707
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0272216796875 GB
    Memory Allocated: 0.010137557983398438  GigaBytes
Max Memory Allocated: 0.010137557983398438  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.024914979934692383
range selection method range initialization spend 0.013440132141113281
time for parepare:  0.017795085906982422
local_output_nid generation:  0.0013279914855957031
local_in_edges_tensor generation:  0.003958463668823242
mini_batch_src_global generation:  0.0017316341400146484
r_  generation:  0.0184476375579834
local_output_nid generation:  0.00141143798828125
local_in_edges_tensor generation:  0.0008943080902099609
mini_batch_src_global generation:  0.0020537376403808594
r_  generation:  0.018300294876098633
local_output_nid generation:  0.0014781951904296875
local_in_edges_tensor generation:  0.0008656978607177734
mini_batch_src_global generation:  0.001399993896484375
r_  generation:  0.01785564422607422
local_output_nid generation:  0.0014920234680175781
local_in_edges_tensor generation:  0.0008966922760009766
mini_batch_src_global generation:  0.0012774467468261719
r_  generation:  0.017954349517822266
local_output_nid generation:  0.0014793872833251953
local_in_edges_tensor generation:  0.0008320808410644531
mini_batch_src_global generation:  0.0013854503631591797
r_  generation:  0.018051624298095703
local_output_nid generation:  0.001468658447265625
local_in_edges_tensor generation:  0.0008435249328613281
mini_batch_src_global generation:  0.0014803409576416016
r_  generation:  0.018747568130493164
local_output_nid generation:  0.0014503002166748047
local_in_edges_tensor generation:  0.0008227825164794922
mini_batch_src_global generation:  0.00146484375
r_  generation:  0.018406391143798828
local_output_nid generation:  0.0015027523040771484
local_in_edges_tensor generation:  0.0008184909820556641
mini_batch_src_global generation:  0.0013728141784667969
r_  generation:  0.018972396850585938
local_output_nid generation:  0.001458883285522461
local_in_edges_tensor generation:  0.0008137226104736328
mini_batch_src_global generation:  0.0014617443084716797
r_  generation:  0.01861739158630371
local_output_nid generation:  0.001445770263671875
local_in_edges_tensor generation:  0.0008320808410644531
mini_batch_src_global generation:  0.0014061927795410156
r_  generation:  0.019170761108398438
local_output_nid generation:  0.0014421939849853516
local_in_edges_tensor generation:  0.0008671283721923828
mini_batch_src_global generation:  0.0014793872833251953
r_  generation:  0.018752098083496094
local_output_nid generation:  0.0015430450439453125
local_in_edges_tensor generation:  0.000835418701171875
mini_batch_src_global generation:  0.0014073848724365234
r_  generation:  0.019528627395629883
local_output_nid generation:  0.0014896392822265625
local_in_edges_tensor generation:  0.0008723735809326172
mini_batch_src_global generation:  0.0015397071838378906
r_  generation:  0.018904685974121094
local_output_nid generation:  0.001588582992553711
local_in_edges_tensor generation:  0.0009510517120361328
mini_batch_src_global generation:  0.0016345977783203125
r_  generation:  0.019756078720092773
local_output_nid generation:  0.001569986343383789
local_in_edges_tensor generation:  0.0009522438049316406
mini_batch_src_global generation:  0.0015273094177246094
r_  generation:  0.019292354583740234
local_output_nid generation:  0.001546621322631836
local_in_edges_tensor generation:  0.0008366107940673828
mini_batch_src_global generation:  0.0015265941619873047
r_  generation:  0.019595861434936523
----------------------check_connections_block total spend ----------------------------- 0.45026159286499023
generate_one_block  0.027955293655395508
generate_one_block  0.028450727462768555
generate_one_block  0.02716684341430664
generate_one_block  0.028842687606811523
generate_one_block  0.027350425720214844
generate_one_block  0.027641773223876953
generate_one_block  0.027164459228515625
generate_one_block  0.02768564224243164
generate_one_block  0.027198076248168945
generate_one_block  0.027696609497070312
generate_one_block  0.026964902877807617
generate_one_block  0.027877330780029297
generate_one_block  0.026909589767456055
generate_one_block  0.028057575225830078
generate_one_block  0.02720165252685547
generate_one_block  0.027956247329711914
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.04208230972290039
gen group dst list time:  0.018613100051879883
time for parepare:  0.01924872398376465
local_output_nid generation:  0.006859540939331055
local_in_edges_tensor generation:  0.0167238712310791
mini_batch_src_global generation:  0.021422624588012695
r_  generation:  0.2029891014099121
local_output_nid generation:  0.010394811630249023
local_in_edges_tensor generation:  0.018494367599487305
mini_batch_src_global generation:  0.02502894401550293
r_  generation:  0.2123565673828125
local_output_nid generation:  0.010377645492553711
local_in_edges_tensor generation:  0.013425350189208984
mini_batch_src_global generation:  0.024466753005981445
r_  generation:  0.21457171440124512
local_output_nid generation:  0.010509967803955078
local_in_edges_tensor generation:  0.01369476318359375
mini_batch_src_global generation:  0.026865005493164062
r_  generation:  0.2180802822113037
local_output_nid generation:  0.010724782943725586
local_in_edges_tensor generation:  0.015490531921386719
mini_batch_src_global generation:  0.026680946350097656
r_  generation:  0.22211289405822754
local_output_nid generation:  0.010912418365478516
local_in_edges_tensor generation:  0.015674352645874023
mini_batch_src_global generation:  0.027344465255737305
r_  generation:  0.23123669624328613
local_output_nid generation:  0.011827468872070312
local_in_edges_tensor generation:  0.026833534240722656
mini_batch_src_global generation:  0.03588056564331055
r_  generation:  0.21738243103027344
local_output_nid generation:  0.012477636337280273
local_in_edges_tensor generation:  0.01626420021057129
mini_batch_src_global generation:  0.027155160903930664
r_  generation:  0.21948027610778809
local_output_nid generation:  0.01152348518371582
local_in_edges_tensor generation:  0.013768196105957031
mini_batch_src_global generation:  0.02741241455078125
r_  generation:  0.2148303985595703
local_output_nid generation:  0.011652708053588867
local_in_edges_tensor generation:  0.015398263931274414
mini_batch_src_global generation:  0.027171850204467773
r_  generation:  0.22005438804626465
local_output_nid generation:  0.011421918869018555
local_in_edges_tensor generation:  0.011461496353149414
mini_batch_src_global generation:  0.026969432830810547
r_  generation:  0.21291494369506836
local_output_nid generation:  0.011945247650146484
local_in_edges_tensor generation:  0.014111995697021484
mini_batch_src_global generation:  0.02788853645324707
r_  generation:  0.22350001335144043
local_output_nid generation:  0.01159048080444336
local_in_edges_tensor generation:  0.011834383010864258
mini_batch_src_global generation:  0.027727365493774414
r_  generation:  0.21814370155334473
local_output_nid generation:  0.011723518371582031
local_in_edges_tensor generation:  0.014786958694458008
mini_batch_src_global generation:  0.027300596237182617
r_  generation:  0.22098016738891602
local_output_nid generation:  0.011768102645874023
local_in_edges_tensor generation:  0.01211094856262207
mini_batch_src_global generation:  0.02778005599975586
r_  generation:  0.21819472312927246
local_output_nid generation:  0.011914253234863281
local_in_edges_tensor generation:  0.015648365020751953
mini_batch_src_global generation:  0.027257680892944336
r_  generation:  0.21989655494689941
----------------------check_connections_block total spend ----------------------------- 5.153043746948242
generate_one_block  0.28980278968811035
generate_one_block  0.2851285934448242
generate_one_block  0.27918267250061035
generate_one_block  0.27988386154174805
generate_one_block  0.30554914474487305
generate_one_block  0.2952260971069336
generate_one_block  0.27848029136657715
generate_one_block  0.2854437828063965
generate_one_block  0.2773897647857666
generate_one_block  0.28592801094055176
generate_one_block  0.2721588611602783
generate_one_block  0.29050135612487793
generate_one_block  0.27689456939697266
generate_one_block  0.2869400978088379
generate_one_block  0.2876403331756592
generate_one_block  0.2906811237335205
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.05050778388977051
gen group dst list time:  0.06525254249572754
time for parepare:  0.019742965698242188
local_output_nid generation:  0.024382352828979492
local_in_edges_tensor generation:  0.07078957557678223
mini_batch_src_global generation:  0.05179095268249512
r_  generation:  0.5088410377502441
local_output_nid generation:  0.03521299362182617
local_in_edges_tensor generation:  0.053055524826049805
mini_batch_src_global generation:  0.059220075607299805
r_  generation:  0.49591517448425293
local_output_nid generation:  0.03028130531311035
local_in_edges_tensor generation:  0.03894329071044922
mini_batch_src_global generation:  0.05829739570617676
r_  generation:  0.5035285949707031
local_output_nid generation:  0.030336856842041016
local_in_edges_tensor generation:  0.04152274131774902
mini_batch_src_global generation:  0.05917024612426758
r_  generation:  0.505380392074585
local_output_nid generation:  0.031177997589111328
local_in_edges_tensor generation:  0.039037466049194336
mini_batch_src_global generation:  0.05938577651977539
r_  generation:  0.5269718170166016
local_output_nid generation:  0.03337907791137695
local_in_edges_tensor generation:  0.051845550537109375
mini_batch_src_global generation:  0.061327457427978516
r_  generation:  0.5049059391021729
local_output_nid generation:  0.03067779541015625
local_in_edges_tensor generation:  0.040410757064819336
mini_batch_src_global generation:  0.05936026573181152
r_  generation:  0.5084309577941895
local_output_nid generation:  0.03132176399230957
local_in_edges_tensor generation:  0.04074883460998535
mini_batch_src_global generation:  0.06828856468200684
r_  generation:  0.5125982761383057
local_output_nid generation:  0.03265857696533203
local_in_edges_tensor generation:  0.04451298713684082
mini_batch_src_global generation:  0.061187028884887695
r_  generation:  0.5130794048309326
local_output_nid generation:  0.031517744064331055
local_in_edges_tensor generation:  0.04545164108276367
mini_batch_src_global generation:  0.05990338325500488
r_  generation:  0.5306475162506104
local_output_nid generation:  0.03316617012023926
local_in_edges_tensor generation:  0.039212703704833984
mini_batch_src_global generation:  0.06346249580383301
r_  generation:  0.5084633827209473
local_output_nid generation:  0.031220436096191406
local_in_edges_tensor generation:  0.0384678840637207
mini_batch_src_global generation:  0.06290864944458008
r_  generation:  0.5082066059112549
local_output_nid generation:  0.03123188018798828
local_in_edges_tensor generation:  0.03924131393432617
mini_batch_src_global generation:  0.05879378318786621
r_  generation:  0.5168623924255371
local_output_nid generation:  0.03136920928955078
local_in_edges_tensor generation:  0.03165006637573242
mini_batch_src_global generation:  0.06463384628295898
r_  generation:  0.5037884712219238
local_output_nid generation:  0.03138136863708496
local_in_edges_tensor generation:  0.03461170196533203
mini_batch_src_global generation:  0.0627741813659668
r_  generation:  0.5096158981323242
local_output_nid generation:  0.034255027770996094
local_in_edges_tensor generation:  0.04647541046142578
mini_batch_src_global generation:  0.05970478057861328
r_  generation:  0.5066370964050293
----------------------check_connections_block total spend ----------------------------- 12.098774671554565
generate_one_block  0.6542825698852539
generate_one_block  0.643749475479126
generate_one_block  0.6373453140258789
generate_one_block  0.6573522090911865
generate_one_block  0.6332869529724121
generate_one_block  0.651824951171875
generate_one_block  0.7200050354003906
generate_one_block  0.6778256893157959
generate_one_block  0.6863861083984375
generate_one_block  0.6594924926757812
generate_one_block  0.6396534442901611
generate_one_block  0.6439719200134277
generate_one_block  0.6472923755645752
generate_one_block  0.6468505859375
generate_one_block  0.6561238765716553
generate_one_block  0.6679675579071045
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.053325653076171875
gen group dst list time:  0.09633040428161621
time for parepare:  0.02085399627685547
local_output_nid generation:  0.03236508369445801
local_in_edges_tensor generation:  0.08292055130004883
mini_batch_src_global generation:  0.050570011138916016
r_  generation:  0.5273516178131104
local_output_nid generation:  0.03752708435058594
local_in_edges_tensor generation:  0.05965232849121094
mini_batch_src_global generation:  0.06197834014892578
r_  generation:  0.5330579280853271
local_output_nid generation:  0.03724336624145508
local_in_edges_tensor generation:  0.042333364486694336
mini_batch_src_global generation:  0.06294941902160645
r_  generation:  0.5378096103668213
local_output_nid generation:  0.03728604316711426
local_in_edges_tensor generation:  0.03856539726257324
mini_batch_src_global generation:  0.057872772216796875
r_  generation:  0.5411617755889893
local_output_nid generation:  0.037358760833740234
local_in_edges_tensor generation:  0.0423886775970459
mini_batch_src_global generation:  0.05927276611328125
r_  generation:  0.5476415157318115
local_output_nid generation:  0.03747820854187012
local_in_edges_tensor generation:  0.04784560203552246
mini_batch_src_global generation:  0.058107614517211914
r_  generation:  0.5485234260559082
local_output_nid generation:  0.03760504722595215
local_in_edges_tensor generation:  0.03812718391418457
mini_batch_src_global generation:  0.05842757225036621
r_  generation:  0.553309440612793
local_output_nid generation:  0.037679195404052734
local_in_edges_tensor generation:  0.04264020919799805
mini_batch_src_global generation:  0.05956125259399414
r_  generation:  0.555854082107544
local_output_nid generation:  0.03778409957885742
local_in_edges_tensor generation:  0.0574796199798584
mini_batch_src_global generation:  0.061074256896972656
r_  generation:  0.5592000484466553
local_output_nid generation:  0.03761792182922363
local_in_edges_tensor generation:  0.0430905818939209
mini_batch_src_global generation:  0.060596466064453125
r_  generation:  0.557023286819458
local_output_nid generation:  0.03831219673156738
local_in_edges_tensor generation:  0.04327130317687988
mini_batch_src_global generation:  0.06063699722290039
r_  generation:  0.5614855289459229
local_output_nid generation:  0.038320064544677734
local_in_edges_tensor generation:  0.04346299171447754
mini_batch_src_global generation:  0.0639810562133789
r_  generation:  0.5636746883392334
local_output_nid generation:  0.03836631774902344
local_in_edges_tensor generation:  0.04487276077270508
mini_batch_src_global generation:  0.06068849563598633
r_  generation:  0.5617611408233643
local_output_nid generation:  0.03842306137084961
local_in_edges_tensor generation:  0.04320716857910156
mini_batch_src_global generation:  0.061237335205078125
r_  generation:  0.5624599456787109
local_output_nid generation:  0.03809642791748047
local_in_edges_tensor generation:  0.04321551322937012
mini_batch_src_global generation:  0.06045198440551758
r_  generation:  0.5624167919158936
local_output_nid generation:  0.04091072082519531
local_in_edges_tensor generation:  0.052692413330078125
mini_batch_src_global generation:  0.06041717529296875
r_  generation:  0.5565407276153564
----------------------check_connections_block total spend ----------------------------- 13.20900273323059
generate_one_block  0.6697919368743896
generate_one_block  0.6763901710510254
generate_one_block  0.7516005039215088
generate_one_block  0.6811482906341553
generate_one_block  0.674152135848999
generate_one_block  0.6880407333374023
generate_one_block  0.6694631576538086
generate_one_block  0.6742136478424072
generate_one_block  0.6934254169464111
generate_one_block  0.6859040260314941
generate_one_block  0.6768641471862793
generate_one_block  0.6889786720275879
generate_one_block  0.6774003505706787
generate_one_block  0.6846039295196533
generate_one_block  0.6838922500610352
generate_one_block  0.7055330276489258
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.053853511810302734
gen group dst list time:  0.09303975105285645
time for parepare:  0.019631624221801758
local_output_nid generation:  0.03376913070678711
local_in_edges_tensor generation:  0.04937624931335449
mini_batch_src_global generation:  0.04770231246948242
r_  generation:  0.501370906829834
local_output_nid generation:  0.04100513458251953
local_in_edges_tensor generation:  0.03748965263366699
mini_batch_src_global generation:  0.057945966720581055
r_  generation:  0.5105080604553223
local_output_nid generation:  0.03906059265136719
local_in_edges_tensor generation:  0.03791689872741699
mini_batch_src_global generation:  0.058293819427490234
r_  generation:  0.5176692008972168
local_output_nid generation:  0.039823293685913086
local_in_edges_tensor generation:  0.03577065467834473
mini_batch_src_global generation:  0.05879616737365723
r_  generation:  0.5110080242156982
local_output_nid generation:  0.03875088691711426
local_in_edges_tensor generation:  0.03763151168823242
mini_batch_src_global generation:  0.05701947212219238
r_  generation:  0.5103235244750977
local_output_nid generation:  0.038744449615478516
local_in_edges_tensor generation:  0.03840279579162598
mini_batch_src_global generation:  0.05683708190917969
r_  generation:  0.5128734111785889
local_output_nid generation:  0.03897237777709961
local_in_edges_tensor generation:  0.03927421569824219
mini_batch_src_global generation:  0.05665445327758789
r_  generation:  0.5208213329315186
local_output_nid generation:  0.04118967056274414
local_in_edges_tensor generation:  0.03923201560974121
mini_batch_src_global generation:  0.05643510818481445
r_  generation:  0.516381025314331
local_output_nid generation:  0.040505170822143555
local_in_edges_tensor generation:  0.03996872901916504
mini_batch_src_global generation:  0.05731964111328125
r_  generation:  0.5182266235351562
local_output_nid generation:  0.04008841514587402
local_in_edges_tensor generation:  0.042901039123535156
mini_batch_src_global generation:  0.05683302879333496
r_  generation:  0.5162849426269531
local_output_nid generation:  0.03998160362243652
local_in_edges_tensor generation:  0.046799421310424805
mini_batch_src_global generation:  0.0567171573638916
r_  generation:  0.52474045753479
local_output_nid generation:  0.040326595306396484
local_in_edges_tensor generation:  0.042298316955566406
mini_batch_src_global generation:  0.056731462478637695
r_  generation:  0.5224509239196777
local_output_nid generation:  0.04014849662780762
local_in_edges_tensor generation:  0.03618884086608887
mini_batch_src_global generation:  0.05708432197570801
r_  generation:  0.5236246585845947
local_output_nid generation:  0.040232181549072266
local_in_edges_tensor generation:  0.037184715270996094
mini_batch_src_global generation:  0.05709123611450195
r_  generation:  0.5230953693389893
local_output_nid generation:  0.04024004936218262
local_in_edges_tensor generation:  0.04055953025817871
mini_batch_src_global generation:  0.07420802116394043
r_  generation:  0.5261800289154053
local_output_nid generation:  0.04052734375
local_in_edges_tensor generation:  0.04504060745239258
mini_batch_src_global generation:  0.05670046806335449
r_  generation:  0.5228056907653809
----------------------check_connections_block total spend ----------------------------- 12.442510604858398
generate_one_block  0.6510114669799805
generate_one_block  0.6439826488494873
generate_one_block  0.6390078067779541
generate_one_block  0.6316018104553223
generate_one_block  0.6383726596832275
generate_one_block  0.7198581695556641
generate_one_block  0.6254780292510986
generate_one_block  0.6489801406860352
generate_one_block  0.6554596424102783
generate_one_block  0.6402757167816162
generate_one_block  0.6419460773468018
generate_one_block  0.6442582607269287
generate_one_block  0.6416730880737305
generate_one_block  0.6246614456176758
generate_one_block  0.6282658576965332
generate_one_block  0.6476328372955322
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0272216796875 GB
    Memory Allocated: 0.010137557983398438  GigaBytes
Max Memory Allocated: 0.010137557983398438  GigaBytes

connection checking time:  42.9033317565918
block generation total time  36.39410996437073
average batch blocks generation time:  2.2746318727731705
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2303466796875 GB
    Memory Allocated: 0.13193178176879883  GigaBytes
Max Memory Allocated: 0.13193178176879883  GigaBytes

torch.Size([166356, 128])
torch.Size([164087, 256])
Traceback (most recent call last):
  File "pseudo_mini_batch_range_arxiv_sage.py", line 435, in <module>
    main()
  File "pseudo_mini_batch_range_arxiv_sage.py", line 431, in main
    best_test = run(args, device, data)
  File "pseudo_mini_batch_range_arxiv_sage.py", line 251, in run
    batch_pred = model(blocks, batch_inputs)#------------*
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/graph_partition_multi_layers/pseudo_mini_batch_full_batch/SAGE/graphsage_model_arxiv.py", line 182, in forward
    x = layer(block, x)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 258, in forward
    graph.update_all(msg_fn, self._lstm_reducer)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/heterograph.py", line 4849, in update_all
    ndata = core.message_passing(g, message_func, reduce_func, apply_node_func)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 337, in message_passing
    ndata = invoke_udf_reduce(g, rfunc, msgdata, orig_nid=orig_nid)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 143, in invoke_udf_reduce
    bkt_rsts.append(func(nbatch))
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 173, in _lstm_reducer
    _, (rst, _) = self.lstm(m, h)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/rnn.py", line 582, in forward
    self.dropout, self.training, self.bidirectional, self.batch_first)
RuntimeError: CUDA out of memory. Tried to allocate 18.00 MiB (GPU 0; 23.62 GiB total capacity; 21.92 GiB already allocated; 4.44 MiB free; 22.42 GiB reserved in total by PyTorch)
