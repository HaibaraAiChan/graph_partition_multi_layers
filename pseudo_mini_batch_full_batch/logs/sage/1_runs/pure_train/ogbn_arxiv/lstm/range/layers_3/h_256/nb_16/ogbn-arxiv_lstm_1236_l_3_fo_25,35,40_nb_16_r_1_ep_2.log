Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648475171.1707077
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0213623046875 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024887561798095703
range selection method range initialization spend 0.012917280197143555
time for parepare:  0.017957687377929688
local_output_nid generation:  0.0013189315795898438
local_in_edges_tensor generation:  0.0038101673126220703
mini_batch_src_global generation:  0.0017440319061279297
r_  generation:  0.017812252044677734
local_output_nid generation:  0.0013742446899414062
local_in_edges_tensor generation:  0.0008697509765625
mini_batch_src_global generation:  0.0018818378448486328
r_  generation:  0.016819238662719727
local_output_nid generation:  0.0014634132385253906
local_in_edges_tensor generation:  0.0008571147918701172
mini_batch_src_global generation:  0.0013148784637451172
r_  generation:  0.017357826232910156
local_output_nid generation:  0.001535177230834961
local_in_edges_tensor generation:  0.0008335113525390625
mini_batch_src_global generation:  0.0012087821960449219
r_  generation:  0.017501115798950195
local_output_nid generation:  0.0014870166778564453
local_in_edges_tensor generation:  0.0008552074432373047
mini_batch_src_global generation:  0.0013811588287353516
r_  generation:  0.01765751838684082
local_output_nid generation:  0.001451730728149414
local_in_edges_tensor generation:  0.0008494853973388672
mini_batch_src_global generation:  0.0013251304626464844
r_  generation:  0.018184900283813477
local_output_nid generation:  0.0015249252319335938
local_in_edges_tensor generation:  0.0008513927459716797
mini_batch_src_global generation:  0.001451730728149414
r_  generation:  0.018975257873535156
local_output_nid generation:  0.0014736652374267578
local_in_edges_tensor generation:  0.0008947849273681641
mini_batch_src_global generation:  0.001360177993774414
r_  generation:  0.018419504165649414
local_output_nid generation:  0.0014538764953613281
local_in_edges_tensor generation:  0.0008330345153808594
mini_batch_src_global generation:  0.00142669677734375
r_  generation:  0.01821279525756836
local_output_nid generation:  0.0014564990997314453
local_in_edges_tensor generation:  0.0008280277252197266
mini_batch_src_global generation:  0.0014202594757080078
r_  generation:  0.01854681968688965
local_output_nid generation:  0.0015654563903808594
local_in_edges_tensor generation:  0.0008232593536376953
mini_batch_src_global generation:  0.0014684200286865234
r_  generation:  0.01866292953491211
local_output_nid generation:  0.0014760494232177734
local_in_edges_tensor generation:  0.0008571147918701172
mini_batch_src_global generation:  0.001466989517211914
r_  generation:  0.018169403076171875
local_output_nid generation:  0.00145721435546875
local_in_edges_tensor generation:  0.0008192062377929688
mini_batch_src_global generation:  0.0013546943664550781
r_  generation:  0.01866602897644043
local_output_nid generation:  0.001504659652709961
local_in_edges_tensor generation:  0.0008592605590820312
mini_batch_src_global generation:  0.0015211105346679688
r_  generation:  0.018604516983032227
local_output_nid generation:  0.0015087127685546875
local_in_edges_tensor generation:  0.0008103847503662109
mini_batch_src_global generation:  0.0013859272003173828
r_  generation:  0.018576622009277344
local_output_nid generation:  0.001477956771850586
local_in_edges_tensor generation:  0.0008094310760498047
mini_batch_src_global generation:  0.0014967918395996094
r_  generation:  0.018547773361206055
----------------------check_connections_block total spend ----------------------------- 0.43712353706359863
generate_one_block  0.027228116989135742
generate_one_block  0.026854991912841797
generate_one_block  0.028886795043945312
generate_one_block  0.02780938148498535
generate_one_block  0.02752208709716797
generate_one_block  0.027785539627075195
generate_one_block  0.02803325653076172
generate_one_block  0.027570247650146484
generate_one_block  0.027333736419677734
generate_one_block  0.027203083038330078
generate_one_block  0.027740955352783203
generate_one_block  0.026671886444091797
generate_one_block  0.02741408348083496
generate_one_block  0.027733325958251953
generate_one_block  0.027078866958618164
generate_one_block  0.02722001075744629
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.038774728775024414
gen group dst list time:  0.019367456436157227
time for parepare:  0.019659996032714844
local_output_nid generation:  0.006818532943725586
local_in_edges_tensor generation:  0.017667531967163086
mini_batch_src_global generation:  0.020364999771118164
r_  generation:  0.19102191925048828
local_output_nid generation:  0.011542320251464844
local_in_edges_tensor generation:  0.018266916275024414
mini_batch_src_global generation:  0.023144245147705078
r_  generation:  0.19170451164245605
local_output_nid generation:  0.012278556823730469
local_in_edges_tensor generation:  0.013532161712646484
mini_batch_src_global generation:  0.024733304977416992
r_  generation:  0.1997509002685547
local_output_nid generation:  0.012809991836547852
local_in_edges_tensor generation:  0.015996694564819336
mini_batch_src_global generation:  0.024396419525146484
r_  generation:  0.2038891315460205
local_output_nid generation:  0.013234853744506836
local_in_edges_tensor generation:  0.014245033264160156
mini_batch_src_global generation:  0.025004148483276367
r_  generation:  0.2069411277770996
local_output_nid generation:  0.013750076293945312
local_in_edges_tensor generation:  0.016798734664916992
mini_batch_src_global generation:  0.027683496475219727
r_  generation:  0.21520328521728516
local_output_nid generation:  0.013632774353027344
local_in_edges_tensor generation:  0.014752626419067383
mini_batch_src_global generation:  0.026216983795166016
r_  generation:  0.21310639381408691
local_output_nid generation:  0.013597249984741211
local_in_edges_tensor generation:  0.014920234680175781
mini_batch_src_global generation:  0.026670455932617188
r_  generation:  0.21289825439453125
local_output_nid generation:  0.01367044448852539
local_in_edges_tensor generation:  0.012941598892211914
mini_batch_src_global generation:  0.025835037231445312
r_  generation:  0.20778727531433105
local_output_nid generation:  0.013857126235961914
local_in_edges_tensor generation:  0.01381540298461914
mini_batch_src_global generation:  0.025889873504638672
r_  generation:  0.210768461227417
local_output_nid generation:  0.013942241668701172
local_in_edges_tensor generation:  0.014770030975341797
mini_batch_src_global generation:  0.027796030044555664
r_  generation:  0.21298766136169434
local_output_nid generation:  0.013540983200073242
local_in_edges_tensor generation:  0.014590024948120117
mini_batch_src_global generation:  0.025285959243774414
r_  generation:  0.2053062915802002
local_output_nid generation:  0.013820886611938477
local_in_edges_tensor generation:  0.01654195785522461
mini_batch_src_global generation:  0.02781391143798828
r_  generation:  0.21065711975097656
local_output_nid generation:  0.01387476921081543
local_in_edges_tensor generation:  0.015001773834228516
mini_batch_src_global generation:  0.026538610458374023
r_  generation:  0.2111949920654297
local_output_nid generation:  0.013822078704833984
local_in_edges_tensor generation:  0.014643192291259766
mini_batch_src_global generation:  0.025880098342895508
r_  generation:  0.2078568935394287
local_output_nid generation:  0.01396322250366211
local_in_edges_tensor generation:  0.016454219818115234
mini_batch_src_global generation:  0.0263063907623291
r_  generation:  0.2098679542541504
----------------------check_connections_block total spend ----------------------------- 4.9300737380981445
generate_one_block  0.2732985019683838
generate_one_block  0.26012158393859863
generate_one_block  0.273040771484375
generate_one_block  0.2717869281768799
generate_one_block  0.2814464569091797
generate_one_block  0.27773237228393555
generate_one_block  0.27895188331604004
generate_one_block  0.27379441261291504
generate_one_block  0.2634925842285156
generate_one_block  0.2658557891845703
generate_one_block  0.27715206146240234
generate_one_block  0.2589080333709717
generate_one_block  0.2712991237640381
generate_one_block  0.27263474464416504
generate_one_block  0.2676353454589844
generate_one_block  0.272202730178833
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.036243438720703125
gen group dst list time:  0.060622453689575195
time for parepare:  0.0187528133392334
local_output_nid generation:  0.023029804229736328
local_in_edges_tensor generation:  0.03830122947692871
mini_batch_src_global generation:  0.041161537170410156
r_  generation:  0.4444119930267334
local_output_nid generation:  0.02921915054321289
local_in_edges_tensor generation:  0.045758962631225586
mini_batch_src_global generation:  0.05085468292236328
r_  generation:  0.4400362968444824
local_output_nid generation:  0.02895498275756836
local_in_edges_tensor generation:  0.04645991325378418
mini_batch_src_global generation:  0.04973006248474121
r_  generation:  0.4485359191894531
local_output_nid generation:  0.029205799102783203
local_in_edges_tensor generation:  0.03512144088745117
mini_batch_src_global generation:  0.05261969566345215
r_  generation:  0.4516582489013672
local_output_nid generation:  0.02893972396850586
local_in_edges_tensor generation:  0.03043961524963379
mini_batch_src_global generation:  0.051455020904541016
r_  generation:  0.4532458782196045
local_output_nid generation:  0.029381752014160156
local_in_edges_tensor generation:  0.034885406494140625
mini_batch_src_global generation:  0.0563206672668457
r_  generation:  0.45209741592407227
local_output_nid generation:  0.029767274856567383
local_in_edges_tensor generation:  0.04297351837158203
mini_batch_src_global generation:  0.05161547660827637
r_  generation:  0.4591689109802246
local_output_nid generation:  0.0299985408782959
local_in_edges_tensor generation:  0.03532147407531738
mini_batch_src_global generation:  0.05369067192077637
r_  generation:  0.45134902000427246
local_output_nid generation:  0.02986741065979004
local_in_edges_tensor generation:  0.031085729598999023
mini_batch_src_global generation:  0.0522770881652832
r_  generation:  0.45469045639038086
local_output_nid generation:  0.02985978126525879
local_in_edges_tensor generation:  0.03515219688415527
mini_batch_src_global generation:  0.05310392379760742
r_  generation:  0.4584169387817383
local_output_nid generation:  0.02983999252319336
local_in_edges_tensor generation:  0.039017438888549805
mini_batch_src_global generation:  0.05510282516479492
r_  generation:  0.4595968723297119
local_output_nid generation:  0.02973651885986328
local_in_edges_tensor generation:  0.03209972381591797
mini_batch_src_global generation:  0.052942514419555664
r_  generation:  0.44937872886657715
local_output_nid generation:  0.029761552810668945
local_in_edges_tensor generation:  0.04741716384887695
mini_batch_src_global generation:  0.050780296325683594
r_  generation:  0.4587407112121582
local_output_nid generation:  0.029877901077270508
local_in_edges_tensor generation:  0.03542137145996094
mini_batch_src_global generation:  0.054518699645996094
r_  generation:  0.45397496223449707
local_output_nid generation:  0.030185222625732422
local_in_edges_tensor generation:  0.03600144386291504
mini_batch_src_global generation:  0.0521550178527832
r_  generation:  0.458904504776001
local_output_nid generation:  0.030038833618164062
local_in_edges_tensor generation:  0.03511548042297363
mini_batch_src_global generation:  0.055915117263793945
r_  generation:  0.4533250331878662
----------------------check_connections_block total spend ----------------------------- 10.727878093719482
generate_one_block  0.5668840408325195
generate_one_block  0.5704069137573242
generate_one_block  0.5840952396392822
generate_one_block  0.5817685127258301
generate_one_block  0.5654168128967285
generate_one_block  0.5881915092468262
generate_one_block  0.6307640075683594
generate_one_block  0.5781025886535645
generate_one_block  0.5669248104095459
generate_one_block  0.583575963973999
generate_one_block  0.578406810760498
generate_one_block  0.578967809677124
generate_one_block  0.5962002277374268
generate_one_block  0.5979514122009277
generate_one_block  0.562997579574585
generate_one_block  0.581550121307373
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0213623046875 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

connection checking time:  15.657951831817627
block generation total time  13.651557683944702
average batch blocks generation time:  0.8532223552465439
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.09504365921020508  GigaBytes
Max Memory Allocated: 0.09504365921020508  GigaBytes

torch.Size([154222, 128])
torch.Size([122201, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 21.183022499084473  GigaBytes
Max Memory Allocated: 21.243584632873535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1893310546875 GB
    Memory Allocated: 0.10031890869140625  GigaBytes
Max Memory Allocated: 21.243584632873535  GigaBytes

torch.Size([154378, 128])
torch.Size([121907, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3416748046875 GB
    Memory Allocated: 20.775768280029297  GigaBytes
Max Memory Allocated: 21.243584632873535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3436279296875 GB
    Memory Allocated: 0.10109710693359375  GigaBytes
Max Memory Allocated: 21.243584632873535  GigaBytes

torch.Size([154692, 128])
torch.Size([122937, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0174560546875 GB
    Memory Allocated: 21.068336963653564  GigaBytes
Max Memory Allocated: 21.243584632873535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0174560546875 GB
    Memory Allocated: 0.10066652297973633  GigaBytes
Max Memory Allocated: 21.243584632873535  GigaBytes

torch.Size([154677, 128])
torch.Size([123149, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3475341796875 GB
    Memory Allocated: 21.113780975341797  GigaBytes
Max Memory Allocated: 21.243584632873535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3494873046875 GB
    Memory Allocated: 0.10104751586914062  GigaBytes
Max Memory Allocated: 21.243584632873535  GigaBytes

torch.Size([154174, 128])
torch.Size([122086, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3494873046875 GB
    Memory Allocated: 21.00344181060791  GigaBytes
Max Memory Allocated: 21.243584632873535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10073375701904297  GigaBytes
Max Memory Allocated: 21.243584632873535  GigaBytes

torch.Size([154526, 128])
torch.Size([123195, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5858154296875 GB
    Memory Allocated: 21.38155746459961  GigaBytes
Max Memory Allocated: 21.44287872314453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4549560546875 GB
    Memory Allocated: 0.10125446319580078  GigaBytes
Max Memory Allocated: 21.44287872314453  GigaBytes

torch.Size([154604, 128])
torch.Size([122767, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 21.358744144439697  GigaBytes
Max Memory Allocated: 21.44287872314453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0545654296875 GB
    Memory Allocated: 0.10070466995239258  GigaBytes
Max Memory Allocated: 21.44287872314453  GigaBytes

torch.Size([154571, 128])
torch.Size([122665, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0545654296875 GB
    Memory Allocated: 21.28859043121338  GigaBytes
Max Memory Allocated: 21.44287872314453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7694091796875 GB
    Memory Allocated: 0.1010599136352539  GigaBytes
Max Memory Allocated: 21.44287872314453  GigaBytes

torch.Size([154583, 128])
torch.Size([122663, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6072998046875 GB
    Memory Allocated: 21.013070106506348  GigaBytes
Max Memory Allocated: 21.44287872314453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6092529296875 GB
    Memory Allocated: 0.10041284561157227  GigaBytes
Max Memory Allocated: 21.44287872314453  GigaBytes

torch.Size([154265, 128])
torch.Size([122305, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8123779296875 GB
    Memory Allocated: 21.04253053665161  GigaBytes
Max Memory Allocated: 21.44287872314453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8123779296875 GB
    Memory Allocated: 0.10119056701660156  GigaBytes
Max Memory Allocated: 21.44287872314453  GigaBytes

torch.Size([154179, 128])
torch.Size([122539, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6033935546875 GB
    Memory Allocated: 21.243159770965576  GigaBytes
Max Memory Allocated: 21.44287872314453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6053466796875 GB
    Memory Allocated: 0.10016155242919922  GigaBytes
Max Memory Allocated: 21.44287872314453  GigaBytes

torch.Size([154124, 128])
torch.Size([121324, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6053466796875 GB
    Memory Allocated: 20.76478672027588  GigaBytes
Max Memory Allocated: 21.44287872314453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6053466796875 GB
    Memory Allocated: 0.10108566284179688  GigaBytes
Max Memory Allocated: 21.44287872314453  GigaBytes

torch.Size([154186, 128])
torch.Size([121853, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6053466796875 GB
    Memory Allocated: 21.09890127182007  GigaBytes
Max Memory Allocated: 21.44287872314453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6053466796875 GB
    Memory Allocated: 0.10060644149780273  GigaBytes
Max Memory Allocated: 21.44287872314453  GigaBytes

torch.Size([154505, 128])
torch.Size([122955, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6053466796875 GB
    Memory Allocated: 21.165659427642822  GigaBytes
Max Memory Allocated: 21.44287872314453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6053466796875 GB
    Memory Allocated: 0.1009988784790039  GigaBytes
Max Memory Allocated: 21.44287872314453  GigaBytes

torch.Size([154549, 128])
torch.Size([122348, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6053466796875 GB
    Memory Allocated: 20.9306902885437  GigaBytes
Max Memory Allocated: 21.44287872314453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6053466796875 GB
    Memory Allocated: 0.10060739517211914  GigaBytes
Max Memory Allocated: 21.44287872314453  GigaBytes

torch.Size([154573, 128])
torch.Size([122553, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6053466796875 GB
    Memory Allocated: 21.12298822402954  GigaBytes
Max Memory Allocated: 21.44287872314453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.042384013533592224 |0.04017066955566406 |0.3592434674501419 |0.00010657310485839844 |0.595697358250618 |0.007180452346801758 |
----------------------------------------------------------pseudo_mini_loss sum 5.389960765838623
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5091357
Number of first layer input nodes during this epoch:  2470808
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.6053466796875 GB
    Memory Allocated: 0.13421297073364258  GigaBytes
Max Memory Allocated: 21.44287872314453  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022705554962158203
range selection method range initialization spend 0.01563572883605957
time for parepare:  0.017009496688842773
local_output_nid generation:  0.0016951560974121094
local_in_edges_tensor generation:  0.0051729679107666016
mini_batch_src_global generation:  0.002132415771484375
r_  generation:  0.01991581916809082
local_output_nid generation:  0.0017328262329101562
local_in_edges_tensor generation:  0.0009546279907226562
mini_batch_src_global generation:  0.0024504661560058594
r_  generation:  0.02021002769470215
local_output_nid generation:  0.001722097396850586
local_in_edges_tensor generation:  0.0008993148803710938
mini_batch_src_global generation:  0.0016605854034423828
r_  generation:  0.02030491828918457
local_output_nid generation:  0.0017881393432617188
local_in_edges_tensor generation:  0.0008928775787353516
mini_batch_src_global generation:  0.0017211437225341797
r_  generation:  0.020656347274780273
local_output_nid generation:  0.0017049312591552734
local_in_edges_tensor generation:  0.0008959770202636719
mini_batch_src_global generation:  0.0016896724700927734
r_  generation:  0.020802021026611328
local_output_nid generation:  0.0016353130340576172
local_in_edges_tensor generation:  0.0008985996246337891
mini_batch_src_global generation:  0.0018227100372314453
r_  generation:  0.020375967025756836
local_output_nid generation:  0.0016674995422363281
local_in_edges_tensor generation:  0.0009450912475585938
mini_batch_src_global generation:  0.0015408992767333984
r_  generation:  0.019520282745361328
local_output_nid generation:  0.0016531944274902344
local_in_edges_tensor generation:  0.0008895397186279297
mini_batch_src_global generation:  0.001466989517211914
r_  generation:  0.019651174545288086
local_output_nid generation:  0.00167083740234375
local_in_edges_tensor generation:  0.0009291172027587891
mini_batch_src_global generation:  0.0014598369598388672
r_  generation:  0.018944740295410156
local_output_nid generation:  0.0017123222351074219
local_in_edges_tensor generation:  0.0008614063262939453
mini_batch_src_global generation:  0.0014612674713134766
r_  generation:  0.019505739212036133
local_output_nid generation:  0.0016279220581054688
local_in_edges_tensor generation:  0.0008730888366699219
mini_batch_src_global generation:  0.0014672279357910156
r_  generation:  0.019795656204223633
local_output_nid generation:  0.0016522407531738281
local_in_edges_tensor generation:  0.0008840560913085938
mini_batch_src_global generation:  0.001596689224243164
r_  generation:  0.019835472106933594
local_output_nid generation:  0.0016243457794189453
local_in_edges_tensor generation:  0.0009136199951171875
mini_batch_src_global generation:  0.0015888214111328125
r_  generation:  0.019812345504760742
local_output_nid generation:  0.0016460418701171875
local_in_edges_tensor generation:  0.0008747577667236328
mini_batch_src_global generation:  0.0015494823455810547
r_  generation:  0.019879817962646484
local_output_nid generation:  0.0016281604766845703
local_in_edges_tensor generation:  0.0008978843688964844
mini_batch_src_global generation:  0.0014848709106445312
r_  generation:  0.019229888916015625
local_output_nid generation:  0.0016109943389892578
local_in_edges_tensor generation:  0.0008654594421386719
mini_batch_src_global generation:  0.0015130043029785156
r_  generation:  0.020092010498046875
----------------------check_connections_block total spend ----------------------------- 0.4804108142852783
generate_one_block  0.03998875617980957
generate_one_block  0.030951738357543945
generate_one_block  0.03103184700012207
generate_one_block  0.031070470809936523
generate_one_block  0.031922101974487305
generate_one_block  0.0346827507019043
generate_one_block  0.03173017501831055
generate_one_block  0.03085947036743164
generate_one_block  0.030861616134643555
generate_one_block  0.03067469596862793
generate_one_block  0.031355857849121094
generate_one_block  0.03171491622924805
generate_one_block  0.03251194953918457
generate_one_block  0.03339505195617676
generate_one_block  0.031557321548461914
generate_one_block  0.03234434127807617
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0340118408203125
gen group dst list time:  0.01824164390563965
time for parepare:  0.020732641220092773
local_output_nid generation:  0.0073511600494384766
local_in_edges_tensor generation:  0.01892828941345215
mini_batch_src_global generation:  0.02018427848815918
r_  generation:  0.1920483112335205
local_output_nid generation:  0.011222124099731445
local_in_edges_tensor generation:  0.018206119537353516
mini_batch_src_global generation:  0.023936986923217773
r_  generation:  0.19660067558288574
local_output_nid generation:  0.011927366256713867
local_in_edges_tensor generation:  0.017328262329101562
mini_batch_src_global generation:  0.023056507110595703
r_  generation:  0.20430207252502441
local_output_nid generation:  0.012732267379760742
local_in_edges_tensor generation:  0.014047622680664062
mini_batch_src_global generation:  0.023629426956176758
r_  generation:  0.20473361015319824
local_output_nid generation:  0.012836456298828125
local_in_edges_tensor generation:  0.014312028884887695
mini_batch_src_global generation:  0.026965618133544922
r_  generation:  0.20978188514709473
local_output_nid generation:  0.012880802154541016
local_in_edges_tensor generation:  0.018247365951538086
mini_batch_src_global generation:  0.02579188346862793
r_  generation:  0.21425342559814453
local_output_nid generation:  0.012420654296875
local_in_edges_tensor generation:  0.012982845306396484
mini_batch_src_global generation:  0.025846242904663086
r_  generation:  0.21036791801452637
local_output_nid generation:  0.012465238571166992
local_in_edges_tensor generation:  0.012583494186401367
mini_batch_src_global generation:  0.02599811553955078
r_  generation:  0.20762062072753906
local_output_nid generation:  0.012618303298950195
local_in_edges_tensor generation:  0.012618780136108398
mini_batch_src_global generation:  0.028313875198364258
r_  generation:  0.20717787742614746
local_output_nid generation:  0.012650251388549805
local_in_edges_tensor generation:  0.015642166137695312
mini_batch_src_global generation:  0.027223587036132812
r_  generation:  0.20978641510009766
local_output_nid generation:  0.012856721878051758
local_in_edges_tensor generation:  0.012997150421142578
mini_batch_src_global generation:  0.03156900405883789
r_  generation:  0.21466612815856934
local_output_nid generation:  0.014031648635864258
local_in_edges_tensor generation:  0.01621866226196289
mini_batch_src_global generation:  0.030827045440673828
r_  generation:  0.21994853019714355
local_output_nid generation:  0.012992382049560547
local_in_edges_tensor generation:  0.019951343536376953
mini_batch_src_global generation:  0.045027732849121094
r_  generation:  0.21845436096191406
local_output_nid generation:  0.014248371124267578
local_in_edges_tensor generation:  0.015263080596923828
mini_batch_src_global generation:  0.027104616165161133
r_  generation:  0.2137620449066162
local_output_nid generation:  0.013152360916137695
local_in_edges_tensor generation:  0.014827489852905273
mini_batch_src_global generation:  0.025849580764770508
r_  generation:  0.21349215507507324
local_output_nid generation:  0.013421058654785156
local_in_edges_tensor generation:  0.018568754196166992
mini_batch_src_global generation:  0.0277249813079834
r_  generation:  0.21367740631103516
----------------------check_connections_block total spend ----------------------------- 5.011790752410889
generate_one_block  0.285872220993042
generate_one_block  0.27850866317749023
generate_one_block  0.2859761714935303
generate_one_block  0.2798192501068115
generate_one_block  0.29026174545288086
generate_one_block  0.29392004013061523
generate_one_block  0.3028748035430908
generate_one_block  0.27591466903686523
generate_one_block  0.27802491188049316
generate_one_block  0.27976369857788086
generate_one_block  0.28554773330688477
generate_one_block  0.319105863571167
generate_one_block  0.2817270755767822
generate_one_block  0.2747993469238281
generate_one_block  0.27786779403686523
generate_one_block  0.28488659858703613
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.08929681777954102
gen group dst list time:  0.06277203559875488
time for parepare:  0.01781320571899414
local_output_nid generation:  0.024161338806152344
local_in_edges_tensor generation:  0.05701613426208496
mini_batch_src_global generation:  0.04619574546813965
r_  generation:  0.43818116188049316
local_output_nid generation:  0.029727458953857422
local_in_edges_tensor generation:  0.04324173927307129
mini_batch_src_global generation:  0.05316948890686035
r_  generation:  0.44499731063842773
local_output_nid generation:  0.030185461044311523
local_in_edges_tensor generation:  0.03270125389099121
mini_batch_src_global generation:  0.05264902114868164
r_  generation:  0.45595407485961914
local_output_nid generation:  0.029892683029174805
local_in_edges_tensor generation:  0.036170005798339844
mini_batch_src_global generation:  0.053638458251953125
r_  generation:  0.4538912773132324
local_output_nid generation:  0.030655860900878906
local_in_edges_tensor generation:  0.07906866073608398
mini_batch_src_global generation:  0.05372905731201172
r_  generation:  0.45725107192993164
local_output_nid generation:  0.030530691146850586
local_in_edges_tensor generation:  0.03219032287597656
mini_batch_src_global generation:  0.07878994941711426
r_  generation:  0.4606142044067383
local_output_nid generation:  0.03069472312927246
local_in_edges_tensor generation:  0.029654502868652344
mini_batch_src_global generation:  0.054236650466918945
r_  generation:  0.4606966972351074
local_output_nid generation:  0.030916452407836914
local_in_edges_tensor generation:  0.02841329574584961
mini_batch_src_global generation:  0.05976581573486328
r_  generation:  0.452059268951416
local_output_nid generation:  0.03099656105041504
local_in_edges_tensor generation:  0.029587984085083008
mini_batch_src_global generation:  0.05391693115234375
r_  generation:  0.457775354385376
local_output_nid generation:  0.03239798545837402
local_in_edges_tensor generation:  0.03238940238952637
mini_batch_src_global generation:  0.05508685111999512
r_  generation:  0.4529082775115967
local_output_nid generation:  0.03109455108642578
local_in_edges_tensor generation:  0.03690695762634277
mini_batch_src_global generation:  0.053899288177490234
r_  generation:  0.4585683345794678
local_output_nid generation:  0.03132224082946777
local_in_edges_tensor generation:  0.04078221321105957
mini_batch_src_global generation:  0.052657365798950195
r_  generation:  0.45575547218322754
local_output_nid generation:  0.030880212783813477
local_in_edges_tensor generation:  0.03623557090759277
mini_batch_src_global generation:  0.05165815353393555
r_  generation:  0.4643516540527344
local_output_nid generation:  0.032438039779663086
local_in_edges_tensor generation:  0.029245853424072266
mini_batch_src_global generation:  0.05209159851074219
r_  generation:  0.45671916007995605
local_output_nid generation:  0.03101491928100586
local_in_edges_tensor generation:  0.03249382972717285
mini_batch_src_global generation:  0.051358699798583984
r_  generation:  0.4588165283203125
local_output_nid generation:  0.030852317810058594
local_in_edges_tensor generation:  0.03680300712585449
mini_batch_src_global generation:  0.05208730697631836
r_  generation:  0.45741987228393555
----------------------check_connections_block total spend ----------------------------- 10.84528923034668
generate_one_block  0.6126971244812012
generate_one_block  0.5923323631286621
generate_one_block  0.5857853889465332
generate_one_block  0.5887761116027832
generate_one_block  0.5923340320587158
generate_one_block  0.596360445022583
generate_one_block  0.5793411731719971
generate_one_block  0.5895242691040039
generate_one_block  0.6192417144775391
generate_one_block  0.5982539653778076
generate_one_block  0.5969028472900391
generate_one_block  0.6070473194122314
generate_one_block  0.5934896469116211
generate_one_block  0.5950784683227539
generate_one_block  0.5942859649658203
generate_one_block  0.5929005146026611
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.6053466796875 GB
    Memory Allocated: 0.13421297073364258  GigaBytes
Max Memory Allocated: 21.44287872314453  GigaBytes

connection checking time:  15.857079982757568
block generation total time  14.109221935272217
average batch blocks generation time:  0.8818263709545135
block dataloader generation time/epoch 32.33531332015991
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6053466796875 GB
    Memory Allocated: 0.11158132553100586  GigaBytes
Max Memory Allocated: 21.44287872314453  GigaBytes

torch.Size([154492, 128])
torch.Size([122688, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6053466796875 GB
    Memory Allocated: 21.207679271697998  GigaBytes
Max Memory Allocated: 21.44287872314453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6053466796875 GB
    Memory Allocated: 0.1107487678527832  GigaBytes
Max Memory Allocated: 21.44287872314453  GigaBytes

torch.Size([154153, 128])
torch.Size([121608, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6053466796875 GB
    Memory Allocated: 20.938234329223633  GigaBytes
Max Memory Allocated: 21.44287872314453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6053466796875 GB
    Memory Allocated: 0.1115875244140625  GigaBytes
Max Memory Allocated: 21.44287872314453  GigaBytes

torch.Size([154275, 128])
torch.Size([122147, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6092529296875 GB
    Memory Allocated: 21.134376525878906  GigaBytes
Max Memory Allocated: 21.44287872314453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6112060546875 GB
    Memory Allocated: 0.1109619140625  GigaBytes
Max Memory Allocated: 21.44287872314453  GigaBytes

torch.Size([154550, 128])
torch.Size([122314, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6112060546875 GB
    Memory Allocated: 20.961196422576904  GigaBytes
Max Memory Allocated: 21.44287872314453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6112060546875 GB
    Memory Allocated: 0.11161518096923828  GigaBytes
Max Memory Allocated: 21.44287872314453  GigaBytes

torch.Size([154502, 128])
torch.Size([122918, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6112060546875 GB
    Memory Allocated: 21.23644256591797  GigaBytes
Max Memory Allocated: 21.44287872314453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6112060546875 GB
    Memory Allocated: 0.11110210418701172  GigaBytes
Max Memory Allocated: 21.44287872314453  GigaBytes

torch.Size([154380, 128])
torch.Size([122816, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3201904296875 GB
    Memory Allocated: 21.40100860595703  GigaBytes
Max Memory Allocated: 21.463019371032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3221435546875 GB
    Memory Allocated: 0.11152935028076172  GigaBytes
Max Memory Allocated: 21.463019371032715  GigaBytes

torch.Size([154350, 128])
torch.Size([122090, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3221435546875 GB
    Memory Allocated: 21.077056884765625  GigaBytes
Max Memory Allocated: 21.463019371032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3221435546875 GB
    Memory Allocated: 0.11090326309204102  GigaBytes
Max Memory Allocated: 21.463019371032715  GigaBytes

torch.Size([154471, 128])
torch.Size([122154, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3221435546875 GB
    Memory Allocated: 20.94080877304077  GigaBytes
Max Memory Allocated: 21.463019371032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3221435546875 GB
    Memory Allocated: 0.11142635345458984  GigaBytes
Max Memory Allocated: 21.463019371032715  GigaBytes

torch.Size([154147, 128])
torch.Size([122134, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3221435546875 GB
    Memory Allocated: 20.85625648498535  GigaBytes
Max Memory Allocated: 21.463019371032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3221435546875 GB
    Memory Allocated: 0.11091089248657227  GigaBytes
Max Memory Allocated: 21.463019371032715  GigaBytes

torch.Size([154497, 128])
torch.Size([122358, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 20.96912717819214  GigaBytes
Max Memory Allocated: 21.463019371032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3319091796875 GB
    Memory Allocated: 0.11151885986328125  GigaBytes
Max Memory Allocated: 21.463019371032715  GigaBytes

torch.Size([154834, 128])
torch.Size([122591, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3319091796875 GB
    Memory Allocated: 21.048514366149902  GigaBytes
Max Memory Allocated: 21.463019371032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3319091796875 GB
    Memory Allocated: 0.111328125  GigaBytes
Max Memory Allocated: 21.463019371032715  GigaBytes

torch.Size([154832, 128])
torch.Size([123196, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3319091796875 GB
    Memory Allocated: 21.425150871276855  GigaBytes
Max Memory Allocated: 21.48687505722046  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.2674560546875 GB
    Memory Allocated: 0.11158275604248047  GigaBytes
Max Memory Allocated: 21.48687505722046  GigaBytes

torch.Size([154469, 128])
torch.Size([122618, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7967529296875 GB
    Memory Allocated: 21.16936731338501  GigaBytes
Max Memory Allocated: 21.48687505722046  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7987060546875 GB
    Memory Allocated: 0.11087846755981445  GigaBytes
Max Memory Allocated: 21.48687505722046  GigaBytes

torch.Size([154301, 128])
torch.Size([122191, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 21.043776035308838  GigaBytes
Max Memory Allocated: 21.48687505722046  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8182373046875 GB
    Memory Allocated: 0.11149978637695312  GigaBytes
Max Memory Allocated: 21.48687505722046  GigaBytes

torch.Size([154512, 128])
torch.Size([122163, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8182373046875 GB
    Memory Allocated: 20.981085300445557  GigaBytes
Max Memory Allocated: 21.48687505722046  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8182373046875 GB
    Memory Allocated: 0.11078739166259766  GigaBytes
Max Memory Allocated: 21.48687505722046  GigaBytes

torch.Size([153980, 128])
torch.Size([121944, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0252685546875 GB
    Memory Allocated: 21.186194896697998  GigaBytes
Max Memory Allocated: 21.48687505722046  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03691437840461731 |0.015726059675216675 |0.3182939738035202 |9.822845458984375e-05 |0.5746036618947983 |0.005758762359619141 |
----------------------------------------------------------pseudo_mini_loss sum 3.8683857917785645
Total (block generation + training)time/epoch 47.5076105594635
Training time/epoch 15.1720290184021
Training time without block to device /epoch 14.920412063598633
Training time without total dataloading part /epoch 14.293692588806152
load block tensor time/epoch 0.590630054473877
block to device time/epoch 0.2516169548034668
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5089500
Number of first layer input nodes during this epoch:  2470745
