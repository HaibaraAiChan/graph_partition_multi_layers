Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648505968.9019656
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0011692047119140625  GigaBytes
Max Memory Allocated: 0.0011692047119140625  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.024188756942749023
range selection method range initialization spend 0.012876749038696289
time for parepare:  0.01776576042175293
local_output_nid generation:  0.0006954669952392578
local_in_edges_tensor generation:  0.003565549850463867
mini_batch_src_global generation:  0.001293182373046875
r_  generation:  0.008544206619262695
local_output_nid generation:  0.0006957054138183594
local_in_edges_tensor generation:  0.0005323886871337891
mini_batch_src_global generation:  0.0012123584747314453
r_  generation:  0.007882833480834961
local_output_nid generation:  0.0006992816925048828
local_in_edges_tensor generation:  0.0004792213439941406
mini_batch_src_global generation:  0.0007829666137695312
r_  generation:  0.007621049880981445
local_output_nid generation:  0.0006985664367675781
local_in_edges_tensor generation:  0.00047397613525390625
mini_batch_src_global generation:  0.00072479248046875
r_  generation:  0.007472991943359375
local_output_nid generation:  0.0007126331329345703
local_in_edges_tensor generation:  0.00046753883361816406
mini_batch_src_global generation:  0.0007369518280029297
r_  generation:  0.007684230804443359
local_output_nid generation:  0.0006945133209228516
local_in_edges_tensor generation:  0.0004944801330566406
mini_batch_src_global generation:  0.0007789134979248047
r_  generation:  0.007813692092895508
local_output_nid generation:  0.0006999969482421875
local_in_edges_tensor generation:  0.00046443939208984375
mini_batch_src_global generation:  0.0007777214050292969
r_  generation:  0.008110761642456055
local_output_nid generation:  0.0007104873657226562
local_in_edges_tensor generation:  0.0004684925079345703
mini_batch_src_global generation:  0.0007715225219726562
r_  generation:  0.00773310661315918
local_output_nid generation:  0.0007004737854003906
local_in_edges_tensor generation:  0.0004513263702392578
mini_batch_src_global generation:  0.0007691383361816406
r_  generation:  0.007839679718017578
local_output_nid generation:  0.0007154941558837891
local_in_edges_tensor generation:  0.0004487037658691406
mini_batch_src_global generation:  0.0007624626159667969
r_  generation:  0.007698774337768555
local_output_nid generation:  0.0007035732269287109
local_in_edges_tensor generation:  0.0004544258117675781
mini_batch_src_global generation:  0.0007741451263427734
r_  generation:  0.007870674133300781
local_output_nid generation:  0.0007045269012451172
local_in_edges_tensor generation:  0.0004405975341796875
mini_batch_src_global generation:  0.0008196830749511719
r_  generation:  0.008057117462158203
local_output_nid generation:  0.0007371902465820312
local_in_edges_tensor generation:  0.0004673004150390625
mini_batch_src_global generation:  0.0007750988006591797
r_  generation:  0.007735729217529297
local_output_nid generation:  0.0007116794586181641
local_in_edges_tensor generation:  0.00045418739318847656
mini_batch_src_global generation:  0.0007982254028320312
r_  generation:  0.008184194564819336
local_output_nid generation:  0.0007054805755615234
local_in_edges_tensor generation:  0.000453948974609375
mini_batch_src_global generation:  0.0007996559143066406
r_  generation:  0.008138418197631836
local_output_nid generation:  0.0007033348083496094
local_in_edges_tensor generation:  0.00045013427734375
mini_batch_src_global generation:  0.0008327960968017578
r_  generation:  0.008555173873901367
local_output_nid generation:  0.0007088184356689453
local_in_edges_tensor generation:  0.00045180320739746094
mini_batch_src_global generation:  0.0008609294891357422
r_  generation:  0.009239435195922852
local_output_nid generation:  0.0007164478302001953
local_in_edges_tensor generation:  0.00045609474182128906
mini_batch_src_global generation:  0.0009455680847167969
r_  generation:  0.007982254028320312
local_output_nid generation:  0.0007174015045166016
local_in_edges_tensor generation:  0.00044846534729003906
mini_batch_src_global generation:  0.0008106231689453125
r_  generation:  0.007917404174804688
local_output_nid generation:  0.0007231235504150391
local_in_edges_tensor generation:  0.0004477500915527344
mini_batch_src_global generation:  0.0008044242858886719
r_  generation:  0.008049488067626953
local_output_nid generation:  0.0007152557373046875
local_in_edges_tensor generation:  0.0004525184631347656
mini_batch_src_global generation:  0.0008819103240966797
r_  generation:  0.008182287216186523
local_output_nid generation:  0.0007181167602539062
local_in_edges_tensor generation:  0.0004551410675048828
mini_batch_src_global generation:  0.0008592605590820312
r_  generation:  0.008170604705810547
local_output_nid generation:  0.000743865966796875
local_in_edges_tensor generation:  0.0004470348358154297
mini_batch_src_global generation:  0.0008296966552734375
r_  generation:  0.00829458236694336
local_output_nid generation:  0.0007259845733642578
local_in_edges_tensor generation:  0.0004494190216064453
mini_batch_src_global generation:  0.0008609294891357422
r_  generation:  0.008428096771240234
local_output_nid generation:  0.0007190704345703125
local_in_edges_tensor generation:  0.0004525184631347656
mini_batch_src_global generation:  0.000804901123046875
r_  generation:  0.007960796356201172
local_output_nid generation:  0.0007145404815673828
local_in_edges_tensor generation:  0.00045800209045410156
mini_batch_src_global generation:  0.0008196830749511719
r_  generation:  0.00925588607788086
local_output_nid generation:  0.0007357597351074219
local_in_edges_tensor generation:  0.00047087669372558594
mini_batch_src_global generation:  0.0008549690246582031
r_  generation:  0.00834512710571289
local_output_nid generation:  0.0007121562957763672
local_in_edges_tensor generation:  0.00045418739318847656
mini_batch_src_global generation:  0.0008594989776611328
r_  generation:  0.00848388671875
local_output_nid generation:  0.0007119178771972656
local_in_edges_tensor generation:  0.0004496574401855469
mini_batch_src_global generation:  0.0008199214935302734
r_  generation:  0.008042335510253906
local_output_nid generation:  0.0007085800170898438
local_in_edges_tensor generation:  0.00044727325439453125
mini_batch_src_global generation:  0.0007975101470947266
r_  generation:  0.007965803146362305
local_output_nid generation:  0.0007071495056152344
local_in_edges_tensor generation:  0.003936767578125
mini_batch_src_global generation:  0.0009708404541015625
r_  generation:  0.007867574691772461
local_output_nid generation:  0.0007739067077636719
local_in_edges_tensor generation:  0.00048804283142089844
mini_batch_src_global generation:  0.0008869171142578125
r_  generation:  0.007858037948608398
----------------------check_connections_block total spend ----------------------------- 0.4119091033935547
generate_one_block  0.01407933235168457
generate_one_block  0.01335763931274414
generate_one_block  0.013187408447265625
generate_one_block  0.012856006622314453
generate_one_block  0.013136148452758789
generate_one_block  0.013113260269165039
generate_one_block  0.013426780700683594
generate_one_block  0.012876272201538086
generate_one_block  0.01323080062866211
generate_one_block  0.013002634048461914
generate_one_block  0.012928009033203125
generate_one_block  0.013317346572875977
generate_one_block  0.012744665145874023
generate_one_block  0.013314485549926758
generate_one_block  0.013070344924926758
generate_one_block  0.013498306274414062
generate_one_block  0.013611078262329102
generate_one_block  0.013057947158813477
generate_one_block  0.012921571731567383
generate_one_block  0.013032197952270508
generate_one_block  0.013367176055908203
generate_one_block  0.013321876525878906
generate_one_block  0.013187170028686523
generate_one_block  0.01366734504699707
generate_one_block  0.013015270233154297
generate_one_block  0.013586759567260742
generate_one_block  0.013612747192382812
generate_one_block  0.013745546340942383
generate_one_block  0.012926816940307617
generate_one_block  0.012860298156738281
generate_one_block  0.01300191879272461
generate_one_block  0.012759923934936523
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.04299569129943848
gen group dst list time:  0.02057671546936035
time for parepare:  0.01874518394470215
local_output_nid generation:  0.003839254379272461
local_in_edges_tensor generation:  0.011981010437011719
mini_batch_src_global generation:  0.011818170547485352
r_  generation:  0.12056851387023926
local_output_nid generation:  0.0062258243560791016
local_in_edges_tensor generation:  0.007193803787231445
mini_batch_src_global generation:  0.014844894409179688
r_  generation:  0.12393784523010254
local_output_nid generation:  0.006331205368041992
local_in_edges_tensor generation:  0.0072324275970458984
mini_batch_src_global generation:  0.014635086059570312
r_  generation:  0.1278243064880371
local_output_nid generation:  0.006405353546142578
local_in_edges_tensor generation:  0.009124040603637695
mini_batch_src_global generation:  0.013675928115844727
r_  generation:  0.12683320045471191
local_output_nid generation:  0.006272077560424805
local_in_edges_tensor generation:  0.008643150329589844
mini_batch_src_global generation:  0.015450239181518555
r_  generation:  0.13422107696533203
local_output_nid generation:  0.006392717361450195
local_in_edges_tensor generation:  0.008768081665039062
mini_batch_src_global generation:  0.0157167911529541
r_  generation:  0.1331007480621338
local_output_nid generation:  0.0064678192138671875
local_in_edges_tensor generation:  0.008805990219116211
mini_batch_src_global generation:  0.015796184539794922
r_  generation:  0.13790082931518555
local_output_nid generation:  0.006446361541748047
local_in_edges_tensor generation:  0.007762908935546875
mini_batch_src_global generation:  0.01579594612121582
r_  generation:  0.1324625015258789
local_output_nid generation:  0.006615638732910156
local_in_edges_tensor generation:  0.007878780364990234
mini_batch_src_global generation:  0.01626420021057129
r_  generation:  0.13392114639282227
local_output_nid generation:  0.006426334381103516
local_in_edges_tensor generation:  0.008939027786254883
mini_batch_src_global generation:  0.0157620906829834
r_  generation:  0.13242387771606445
local_output_nid generation:  0.006590843200683594
local_in_edges_tensor generation:  0.008685111999511719
mini_batch_src_global generation:  0.0166928768157959
r_  generation:  0.13357043266296387
local_output_nid generation:  0.006733894348144531
local_in_edges_tensor generation:  0.009228229522705078
mini_batch_src_global generation:  0.01779031753540039
r_  generation:  0.139359712600708
local_output_nid generation:  0.006493330001831055
local_in_edges_tensor generation:  0.007662773132324219
mini_batch_src_global generation:  0.015976905822753906
r_  generation:  0.13111281394958496
local_output_nid generation:  0.0067708492279052734
local_in_edges_tensor generation:  0.007983207702636719
mini_batch_src_global generation:  0.01778864860534668
r_  generation:  0.1394362449645996
local_output_nid generation:  0.006597757339477539
local_in_edges_tensor generation:  0.009950637817382812
mini_batch_src_global generation:  0.0168459415435791
r_  generation:  0.1353909969329834
local_output_nid generation:  0.0068395137786865234
local_in_edges_tensor generation:  0.010440587997436523
mini_batch_src_global generation:  0.01707768440246582
r_  generation:  0.1426377296447754
local_output_nid generation:  0.006978750228881836
local_in_edges_tensor generation:  0.010746002197265625
mini_batch_src_global generation:  0.01779770851135254
r_  generation:  0.14432716369628906
local_output_nid generation:  0.006711006164550781
local_in_edges_tensor generation:  0.007806539535522461
mini_batch_src_global generation:  0.01679062843322754
r_  generation:  0.13359618186950684
local_output_nid generation:  0.006648540496826172
local_in_edges_tensor generation:  0.00870060920715332
mini_batch_src_global generation:  0.016182899475097656
r_  generation:  0.13528180122375488
local_output_nid generation:  0.00661158561706543
local_in_edges_tensor generation:  0.007889747619628906
mini_batch_src_global generation:  0.016571521759033203
r_  generation:  0.1355733871459961
local_output_nid generation:  0.006900310516357422
local_in_edges_tensor generation:  0.008079767227172852
mini_batch_src_global generation:  0.016757965087890625
r_  generation:  0.13941359519958496
local_output_nid generation:  0.006789445877075195
local_in_edges_tensor generation:  0.011438131332397461
mini_batch_src_global generation:  0.02177882194519043
r_  generation:  0.1410057544708252
local_output_nid generation:  0.007892131805419922
local_in_edges_tensor generation:  0.008499860763549805
mini_batch_src_global generation:  0.018273115158081055
r_  generation:  0.14274334907531738
local_output_nid generation:  0.007027626037597656
local_in_edges_tensor generation:  0.017815589904785156
mini_batch_src_global generation:  0.01748824119567871
r_  generation:  0.14252805709838867
local_output_nid generation:  0.0068972110748291016
local_in_edges_tensor generation:  0.009024620056152344
mini_batch_src_global generation:  0.016612529754638672
r_  generation:  0.1371464729309082
local_output_nid generation:  0.007109165191650391
local_in_edges_tensor generation:  0.009067058563232422
mini_batch_src_global generation:  0.018233299255371094
r_  generation:  0.14332056045532227
local_output_nid generation:  0.007226705551147461
local_in_edges_tensor generation:  0.010241508483886719
mini_batch_src_global generation:  0.017669200897216797
r_  generation:  0.14332222938537598
local_output_nid generation:  0.0071871280670166016
local_in_edges_tensor generation:  0.009038209915161133
mini_batch_src_global generation:  0.01753973960876465
r_  generation:  0.14412784576416016
local_output_nid generation:  0.006793975830078125
local_in_edges_tensor generation:  0.007803678512573242
mini_batch_src_global generation:  0.01922297477722168
r_  generation:  0.13803315162658691
local_output_nid generation:  0.0067632198333740234
local_in_edges_tensor generation:  0.0077517032623291016
mini_batch_src_global generation:  0.016610383987426758
r_  generation:  0.13550925254821777
local_output_nid generation:  0.006766080856323242
local_in_edges_tensor generation:  0.007544040679931641
mini_batch_src_global generation:  0.016056299209594727
r_  generation:  0.13297629356384277
local_output_nid generation:  0.006797313690185547
local_in_edges_tensor generation:  0.009553909301757812
mini_batch_src_global generation:  0.017218589782714844
r_  generation:  0.1339120864868164
----------------------check_connections_block total spend ----------------------------- 6.451594114303589
generate_one_block  0.18753910064697266
generate_one_block  0.17370152473449707
generate_one_block  0.19861602783203125
generate_one_block  0.165924072265625
generate_one_block  0.18009209632873535
generate_one_block  0.1735234260559082
generate_one_block  0.1820049285888672
generate_one_block  0.16803503036499023
generate_one_block  0.17348718643188477
generate_one_block  0.16867947578430176
generate_one_block  0.16957569122314453
generate_one_block  0.1823558807373047
generate_one_block  0.16499781608581543
generate_one_block  0.1774730682373047
generate_one_block  0.17097139358520508
generate_one_block  0.18200016021728516
generate_one_block  0.1961803436279297
generate_one_block  0.17380475997924805
generate_one_block  0.1685190200805664
generate_one_block  0.17329883575439453
generate_one_block  0.18102550506591797
generate_one_block  0.18021559715270996
generate_one_block  0.17278194427490234
generate_one_block  0.1807568073272705
generate_one_block  0.1755378246307373
generate_one_block  0.18230700492858887
generate_one_block  0.18320679664611816
generate_one_block  0.18556904792785645
generate_one_block  0.17142534255981445
generate_one_block  0.16820621490478516
generate_one_block  0.1678314208984375
generate_one_block  0.1696460247039795
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.08041739463806152
gen group dst list time:  0.10385513305664062
time for parepare:  0.020996809005737305
local_output_nid generation:  0.02021050453186035
local_in_edges_tensor generation:  0.04772186279296875
mini_batch_src_global generation:  0.046178579330444336
r_  generation:  0.43340134620666504
local_output_nid generation:  0.026453495025634766
local_in_edges_tensor generation:  0.04462265968322754
mini_batch_src_global generation:  0.05257368087768555
r_  generation:  0.43666505813598633
local_output_nid generation:  0.026689767837524414
local_in_edges_tensor generation:  0.037078142166137695
mini_batch_src_global generation:  0.05238056182861328
r_  generation:  0.4438962936401367
local_output_nid generation:  0.024989843368530273
local_in_edges_tensor generation:  0.03239750862121582
mini_batch_src_global generation:  0.05300474166870117
r_  generation:  0.4372246265411377
local_output_nid generation:  0.025119304656982422
local_in_edges_tensor generation:  0.03280043601989746
mini_batch_src_global generation:  0.05765724182128906
r_  generation:  0.44761061668395996
local_output_nid generation:  0.024877309799194336
local_in_edges_tensor generation:  0.032662391662597656
mini_batch_src_global generation:  0.07422471046447754
r_  generation:  0.442441463470459
local_output_nid generation:  0.025132179260253906
local_in_edges_tensor generation:  0.03290605545043945
mini_batch_src_global generation:  0.05791807174682617
r_  generation:  0.4473550319671631
local_output_nid generation:  0.026630401611328125
local_in_edges_tensor generation:  0.032364845275878906
mini_batch_src_global generation:  0.06012773513793945
r_  generation:  0.46747541427612305
local_output_nid generation:  0.02675318717956543
local_in_edges_tensor generation:  0.04034280776977539
mini_batch_src_global generation:  0.061493635177612305
r_  generation:  0.44538140296936035
local_output_nid generation:  0.027316808700561523
local_in_edges_tensor generation:  0.03352785110473633
mini_batch_src_global generation:  0.053833723068237305
r_  generation:  0.4419093132019043
local_output_nid generation:  0.026046276092529297
local_in_edges_tensor generation:  0.03663039207458496
mini_batch_src_global generation:  0.05384635925292969
r_  generation:  0.4439225196838379
local_output_nid generation:  0.026785850524902344
local_in_edges_tensor generation:  0.03269028663635254
mini_batch_src_global generation:  0.05495858192443848
r_  generation:  0.4521489143371582
local_output_nid generation:  0.026363134384155273
local_in_edges_tensor generation:  0.036194801330566406
mini_batch_src_global generation:  0.053558349609375
r_  generation:  0.44316959381103516
local_output_nid generation:  0.026749849319458008
local_in_edges_tensor generation:  0.03249478340148926
mini_batch_src_global generation:  0.05943775177001953
r_  generation:  0.4490797519683838
local_output_nid generation:  0.026463747024536133
local_in_edges_tensor generation:  0.03249073028564453
mini_batch_src_global generation:  0.06600165367126465
r_  generation:  0.44446420669555664
local_output_nid generation:  0.026787519454956055
local_in_edges_tensor generation:  0.03680300712585449
mini_batch_src_global generation:  0.057187557220458984
r_  generation:  0.44960808753967285
local_output_nid generation:  0.02802109718322754
local_in_edges_tensor generation:  0.04736733436584473
mini_batch_src_global generation:  0.05438566207885742
r_  generation:  0.4673759937286377
local_output_nid generation:  0.026617050170898438
local_in_edges_tensor generation:  0.04349231719970703
mini_batch_src_global generation:  0.07138180732727051
r_  generation:  0.4485814571380615
local_output_nid generation:  0.027492046356201172
local_in_edges_tensor generation:  0.03661537170410156
mini_batch_src_global generation:  0.058269500732421875
r_  generation:  0.44620609283447266
local_output_nid generation:  0.026377439498901367
local_in_edges_tensor generation:  0.025888919830322266
mini_batch_src_global generation:  0.05450773239135742
r_  generation:  0.44867730140686035
local_output_nid generation:  0.026613712310791016
local_in_edges_tensor generation:  0.03174924850463867
mini_batch_src_global generation:  0.057119131088256836
r_  generation:  0.4516105651855469
local_output_nid generation:  0.026743173599243164
local_in_edges_tensor generation:  0.029886960983276367
mini_batch_src_global generation:  0.05452442169189453
r_  generation:  0.44870591163635254
local_output_nid generation:  0.0267333984375
local_in_edges_tensor generation:  0.029624223709106445
mini_batch_src_global generation:  0.05740022659301758
r_  generation:  0.4524807929992676
local_output_nid generation:  0.02663421630859375
local_in_edges_tensor generation:  0.03090381622314453
mini_batch_src_global generation:  0.0717172622680664
r_  generation:  0.4488563537597656
local_output_nid generation:  0.026772737503051758
local_in_edges_tensor generation:  0.034096717834472656
mini_batch_src_global generation:  0.05506277084350586
r_  generation:  0.4493732452392578
local_output_nid generation:  0.02772831916809082
local_in_edges_tensor generation:  0.033159494400024414
mini_batch_src_global generation:  0.057915687561035156
r_  generation:  0.45383787155151367
local_output_nid generation:  0.027040958404541016
local_in_edges_tensor generation:  0.03542804718017578
mini_batch_src_global generation:  0.06977725028991699
r_  generation:  0.45911073684692383
local_output_nid generation:  0.02793288230895996
local_in_edges_tensor generation:  0.039182424545288086
mini_batch_src_global generation:  0.05513763427734375
r_  generation:  0.45469212532043457
local_output_nid generation:  0.026523590087890625
local_in_edges_tensor generation:  0.027880430221557617
mini_batch_src_global generation:  0.05419301986694336
r_  generation:  0.4511537551879883
local_output_nid generation:  0.0264737606048584
local_in_edges_tensor generation:  0.03163623809814453
mini_batch_src_global generation:  0.05458569526672363
r_  generation:  0.45579075813293457
local_output_nid generation:  0.02618241310119629
local_in_edges_tensor generation:  0.029601097106933594
mini_batch_src_global generation:  0.05341958999633789
r_  generation:  0.4501218795776367
local_output_nid generation:  0.02637314796447754
local_in_edges_tensor generation:  0.029802322387695312
mini_batch_src_global generation:  0.053624868392944336
r_  generation:  0.4443051815032959
----------------------check_connections_block total spend ----------------------------- 21.311000108718872
generate_one_block  0.6179842948913574
generate_one_block  0.6946449279785156
generate_one_block  0.5770370960235596
generate_one_block  0.5731568336486816
generate_one_block  0.590933084487915
generate_one_block  0.5886406898498535
generate_one_block  0.646113395690918
generate_one_block  0.611724853515625
generate_one_block  0.6043763160705566
generate_one_block  0.6059489250183105
generate_one_block  0.6030166149139404
generate_one_block  0.6243903636932373
generate_one_block  0.6059665679931641
generate_one_block  0.6063292026519775
generate_one_block  0.5924928188323975
generate_one_block  0.6158692836761475
generate_one_block  0.6129467487335205
generate_one_block  0.5892999172210693
generate_one_block  0.5931980609893799
generate_one_block  0.5960516929626465
generate_one_block  0.6180860996246338
generate_one_block  0.6169328689575195
generate_one_block  0.5921492576599121
generate_one_block  0.590886116027832
generate_one_block  0.5941133499145508
generate_one_block  0.5977787971496582
generate_one_block  0.6347966194152832
generate_one_block  0.6220386028289795
generate_one_block  0.5883762836456299
generate_one_block  0.586108922958374
generate_one_block  0.5825371742248535
generate_one_block  0.5802552700042725
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05223536491394043
gen group dst list time:  0.1841428279876709
time for parepare:  0.01899266242980957
local_output_nid generation:  0.03342795372009277
local_in_edges_tensor generation:  0.0664818286895752
mini_batch_src_global generation:  0.0527958869934082
r_  generation:  0.5189521312713623
local_output_nid generation:  0.039717912673950195
local_in_edges_tensor generation:  0.05555367469787598
mini_batch_src_global generation:  0.06160759925842285
r_  generation:  0.5263605117797852
local_output_nid generation:  0.037729740142822266
local_in_edges_tensor generation:  0.05608510971069336
mini_batch_src_global generation:  0.05651593208312988
r_  generation:  0.5326483249664307
local_output_nid generation:  0.03639864921569824
local_in_edges_tensor generation:  0.04121685028076172
mini_batch_src_global generation:  0.05878758430480957
r_  generation:  0.5478603839874268
local_output_nid generation:  0.03672194480895996
local_in_edges_tensor generation:  0.05024385452270508
mini_batch_src_global generation:  0.07941794395446777
r_  generation:  0.5418539047241211
local_output_nid generation:  0.03886580467224121
local_in_edges_tensor generation:  0.04433703422546387
mini_batch_src_global generation:  0.06166553497314453
r_  generation:  0.5378963947296143
local_output_nid generation:  0.03724408149719238
local_in_edges_tensor generation:  0.041272640228271484
mini_batch_src_global generation:  0.05859494209289551
r_  generation:  0.5449733734130859
local_output_nid generation:  0.03782033920288086
local_in_edges_tensor generation:  0.04151344299316406
mini_batch_src_global generation:  0.0629580020904541
r_  generation:  0.5416378974914551
local_output_nid generation:  0.03775954246520996
local_in_edges_tensor generation:  0.05009627342224121
mini_batch_src_global generation:  0.05870461463928223
r_  generation:  0.5438024997711182
local_output_nid generation:  0.03786587715148926
local_in_edges_tensor generation:  0.03686332702636719
mini_batch_src_global generation:  0.059005022048950195
r_  generation:  0.5382907390594482
local_output_nid generation:  0.03732657432556152
local_in_edges_tensor generation:  0.04215669631958008
mini_batch_src_global generation:  0.05909395217895508
r_  generation:  0.5438106060028076
local_output_nid generation:  0.03834676742553711
local_in_edges_tensor generation:  0.0424952507019043
mini_batch_src_global generation:  0.059572458267211914
r_  generation:  0.5481472015380859
local_output_nid generation:  0.04026174545288086
local_in_edges_tensor generation:  0.04190564155578613
mini_batch_src_global generation:  0.06062197685241699
r_  generation:  0.5455539226531982
local_output_nid generation:  0.03813052177429199
local_in_edges_tensor generation:  0.04146862030029297
mini_batch_src_global generation:  0.06006956100463867
r_  generation:  0.5434887409210205
local_output_nid generation:  0.040999412536621094
local_in_edges_tensor generation:  0.04474306106567383
mini_batch_src_global generation:  0.05917048454284668
r_  generation:  0.5494930744171143
local_output_nid generation:  0.03804969787597656
local_in_edges_tensor generation:  0.04201006889343262
mini_batch_src_global generation:  0.06441497802734375
r_  generation:  0.5519847869873047
local_output_nid generation:  0.03925800323486328
local_in_edges_tensor generation:  0.05191516876220703
mini_batch_src_global generation:  0.06000852584838867
r_  generation:  0.5514624118804932
local_output_nid generation:  0.03839111328125
local_in_edges_tensor generation:  0.041686058044433594
mini_batch_src_global generation:  0.06108355522155762
r_  generation:  0.5443782806396484
local_output_nid generation:  0.03824305534362793
local_in_edges_tensor generation:  0.0384058952331543
mini_batch_src_global generation:  0.05928158760070801
r_  generation:  0.551154613494873
local_output_nid generation:  0.03819084167480469
local_in_edges_tensor generation:  0.03725171089172363
mini_batch_src_global generation:  0.06090569496154785
r_  generation:  0.548814058303833
local_output_nid generation:  0.0380091667175293
local_in_edges_tensor generation:  0.0413820743560791
mini_batch_src_global generation:  0.06092715263366699
r_  generation:  0.5503358840942383
local_output_nid generation:  0.03817582130432129
local_in_edges_tensor generation:  0.041586875915527344
mini_batch_src_global generation:  0.06030106544494629
r_  generation:  0.5496337413787842
local_output_nid generation:  0.03804278373718262
local_in_edges_tensor generation:  0.05161619186401367
mini_batch_src_global generation:  0.05966997146606445
r_  generation:  0.5527350902557373
local_output_nid generation:  0.03814697265625
local_in_edges_tensor generation:  0.03732109069824219
mini_batch_src_global generation:  0.06127595901489258
r_  generation:  0.5457029342651367
local_output_nid generation:  0.038132667541503906
local_in_edges_tensor generation:  0.03763604164123535
mini_batch_src_global generation:  0.06395530700683594
r_  generation:  0.5497338771820068
local_output_nid generation:  0.03826189041137695
local_in_edges_tensor generation:  0.051613569259643555
mini_batch_src_global generation:  0.060655832290649414
r_  generation:  0.550487756729126
local_output_nid generation:  0.038278818130493164
local_in_edges_tensor generation:  0.04145693778991699
mini_batch_src_global generation:  0.05976223945617676
r_  generation:  0.5544650554656982
local_output_nid generation:  0.037869930267333984
local_in_edges_tensor generation:  0.03752398490905762
mini_batch_src_global generation:  0.06144452095031738
r_  generation:  0.5509934425354004
local_output_nid generation:  0.038089752197265625
local_in_edges_tensor generation:  0.047461509704589844
mini_batch_src_global generation:  0.0649116039276123
r_  generation:  0.5544760227203369
local_output_nid generation:  0.03792715072631836
local_in_edges_tensor generation:  0.04402565956115723
mini_batch_src_global generation:  0.06513619422912598
r_  generation:  0.5544483661651611
local_output_nid generation:  0.04060626029968262
local_in_edges_tensor generation:  0.04691600799560547
mini_batch_src_global generation:  0.06657028198242188
r_  generation:  0.5515027046203613
local_output_nid generation:  0.03809332847595215
local_in_edges_tensor generation:  0.041753530502319336
mini_batch_src_global generation:  0.06505489349365234
r_  generation:  0.544194221496582
----------------------check_connections_block total spend ----------------------------- 26.178364515304565
generate_one_block  0.6894941329956055
generate_one_block  0.6809694766998291
generate_one_block  0.6852371692657471
generate_one_block  0.6808769702911377
generate_one_block  0.6632115840911865
generate_one_block  0.6600673198699951
generate_one_block  0.6840479373931885
generate_one_block  0.8242192268371582
generate_one_block  0.6869747638702393
generate_one_block  0.66261887550354
generate_one_block  0.663623571395874
generate_one_block  0.6907329559326172
generate_one_block  0.6824421882629395
generate_one_block  0.6766400337219238
generate_one_block  0.6754400730133057
generate_one_block  0.6822526454925537
generate_one_block  0.6903178691864014
generate_one_block  0.6795189380645752
generate_one_block  0.6648128032684326
generate_one_block  0.6637427806854248
generate_one_block  0.6744289398193359
generate_one_block  0.6841821670532227
generate_one_block  0.6922814846038818
generate_one_block  0.6702752113342285
generate_one_block  0.686767578125
generate_one_block  0.6880261898040771
generate_one_block  0.6780760288238525
generate_one_block  0.691591739654541
generate_one_block  0.671668529510498
generate_one_block  0.6757736206054688
generate_one_block  0.6784749031066895
generate_one_block  0.6777915954589844
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.043875694274902344
gen group dst list time:  0.191758394241333
time for parepare:  0.019353389739990234
local_output_nid generation:  0.03697824478149414
local_in_edges_tensor generation:  0.05065035820007324
mini_batch_src_global generation:  0.04469418525695801
r_  generation:  0.5006413459777832
local_output_nid generation:  0.041954755783081055
local_in_edges_tensor generation:  0.033709049224853516
mini_batch_src_global generation:  0.056975603103637695
r_  generation:  0.5050103664398193
local_output_nid generation:  0.04199576377868652
local_in_edges_tensor generation:  0.034557342529296875
mini_batch_src_global generation:  0.05980277061462402
r_  generation:  0.5057530403137207
local_output_nid generation:  0.04120826721191406
local_in_edges_tensor generation:  0.03705286979675293
mini_batch_src_global generation:  0.056014060974121094
r_  generation:  0.5043234825134277
local_output_nid generation:  0.039320945739746094
local_in_edges_tensor generation:  0.034581899642944336
mini_batch_src_global generation:  0.05680084228515625
r_  generation:  0.5054421424865723
local_output_nid generation:  0.03935599327087402
local_in_edges_tensor generation:  0.034108638763427734
mini_batch_src_global generation:  0.05976080894470215
r_  generation:  0.5090150833129883
local_output_nid generation:  0.039240121841430664
local_in_edges_tensor generation:  0.03708958625793457
mini_batch_src_global generation:  0.06287455558776855
r_  generation:  0.5127367973327637
local_output_nid generation:  0.03958415985107422
local_in_edges_tensor generation:  0.04154801368713379
mini_batch_src_global generation:  0.06799674034118652
r_  generation:  0.510714054107666
local_output_nid generation:  0.04186654090881348
local_in_edges_tensor generation:  0.041800498962402344
mini_batch_src_global generation:  0.05900907516479492
r_  generation:  0.5145654678344727
local_output_nid generation:  0.04054713249206543
local_in_edges_tensor generation:  0.04368090629577637
mini_batch_src_global generation:  0.05679750442504883
r_  generation:  0.5130906105041504
local_output_nid generation:  0.0410466194152832
local_in_edges_tensor generation:  0.03951096534729004
mini_batch_src_global generation:  0.05682682991027832
r_  generation:  0.5162796974182129
local_output_nid generation:  0.04067635536193848
local_in_edges_tensor generation:  0.043473243713378906
mini_batch_src_global generation:  0.05740833282470703
r_  generation:  0.520207405090332
local_output_nid generation:  0.04086470603942871
local_in_edges_tensor generation:  0.044231414794921875
mini_batch_src_global generation:  0.0562281608581543
r_  generation:  0.5228569507598877
local_output_nid generation:  0.04092764854431152
local_in_edges_tensor generation:  0.03924131393432617
mini_batch_src_global generation:  0.056929588317871094
r_  generation:  0.5220944881439209
local_output_nid generation:  0.04179024696350098
local_in_edges_tensor generation:  0.03521895408630371
mini_batch_src_global generation:  0.05691242218017578
r_  generation:  0.5208308696746826
local_output_nid generation:  0.04092574119567871
local_in_edges_tensor generation:  0.04324674606323242
mini_batch_src_global generation:  0.05970311164855957
r_  generation:  0.5315401554107666
local_output_nid generation:  0.04098629951477051
local_in_edges_tensor generation:  0.0436859130859375
mini_batch_src_global generation:  0.05685782432556152
r_  generation:  0.5223233699798584
local_output_nid generation:  0.04095888137817383
local_in_edges_tensor generation:  0.04405808448791504
mini_batch_src_global generation:  0.05941295623779297
r_  generation:  0.5219166278839111
local_output_nid generation:  0.0411224365234375
local_in_edges_tensor generation:  0.034975290298461914
mini_batch_src_global generation:  0.05579519271850586
r_  generation:  0.5229394435882568
local_output_nid generation:  0.0411379337310791
local_in_edges_tensor generation:  0.034493207931518555
mini_batch_src_global generation:  0.05683016777038574
r_  generation:  0.5207798480987549
local_output_nid generation:  0.0410463809967041
local_in_edges_tensor generation:  0.043181419372558594
mini_batch_src_global generation:  0.05680727958679199
r_  generation:  0.5253186225891113
local_output_nid generation:  0.04106283187866211
local_in_edges_tensor generation:  0.04171109199523926
mini_batch_src_global generation:  0.056627750396728516
r_  generation:  0.5250244140625
local_output_nid generation:  0.04091525077819824
local_in_edges_tensor generation:  0.047441959381103516
mini_batch_src_global generation:  0.05769681930541992
r_  generation:  0.5269961357116699
local_output_nid generation:  0.04103255271911621
local_in_edges_tensor generation:  0.034520864486694336
mini_batch_src_global generation:  0.05717897415161133
r_  generation:  0.5233321189880371
local_output_nid generation:  0.04102611541748047
local_in_edges_tensor generation:  0.041203975677490234
mini_batch_src_global generation:  0.057648420333862305
r_  generation:  0.5252995491027832
local_output_nid generation:  0.041074275970458984
local_in_edges_tensor generation:  0.04762721061706543
mini_batch_src_global generation:  0.05722379684448242
r_  generation:  0.5303966999053955
local_output_nid generation:  0.04117178916931152
local_in_edges_tensor generation:  0.03879594802856445
mini_batch_src_global generation:  0.056681156158447266
r_  generation:  0.5283560752868652
local_output_nid generation:  0.04102945327758789
local_in_edges_tensor generation:  0.038580894470214844
mini_batch_src_global generation:  0.05693459510803223
r_  generation:  0.522758960723877
local_output_nid generation:  0.04128146171569824
local_in_edges_tensor generation:  0.038445472717285156
mini_batch_src_global generation:  0.057126522064208984
r_  generation:  0.5308561325073242
local_output_nid generation:  0.04139566421508789
local_in_edges_tensor generation:  0.047600746154785156
mini_batch_src_global generation:  0.05780673027038574
r_  generation:  0.524315595626831
local_output_nid generation:  0.04102349281311035
local_in_edges_tensor generation:  0.03912806510925293
mini_batch_src_global generation:  0.056581735610961914
r_  generation:  0.5513534545898438
local_output_nid generation:  0.04373478889465332
local_in_edges_tensor generation:  0.04524540901184082
mini_batch_src_global generation:  0.06485962867736816
r_  generation:  0.523158073425293
----------------------check_connections_block total spend ----------------------------- 25.094022750854492
generate_one_block  0.6385083198547363
generate_one_block  0.6541862487792969
generate_one_block  0.6360132694244385
generate_one_block  0.6373872756958008
generate_one_block  0.6386127471923828
generate_one_block  0.6431057453155518
generate_one_block  0.6376757621765137
generate_one_block  0.6508457660675049
generate_one_block  0.6448585987091064
generate_one_block  0.6497695446014404
generate_one_block  0.6602334976196289
generate_one_block  0.6692986488342285
generate_one_block  0.6672754287719727
generate_one_block  0.7936694622039795
generate_one_block  0.6467132568359375
generate_one_block  0.6447632312774658
generate_one_block  0.659243106842041
generate_one_block  0.6419534683227539
generate_one_block  0.6296586990356445
generate_one_block  0.7084429264068604
generate_one_block  0.6324295997619629
generate_one_block  0.6271522045135498
generate_one_block  0.6601719856262207
generate_one_block  0.6382791996002197
generate_one_block  0.6796779632568359
generate_one_block  0.653820276260376
generate_one_block  0.6566205024719238
generate_one_block  0.6415355205535889
generate_one_block  0.640204906463623
generate_one_block  0.6536929607391357
generate_one_block  0.654686450958252
generate_one_block  0.6442999839782715
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0011692047119140625  GigaBytes
Max Memory Allocated: 0.0011692047119140625  GigaBytes

connection checking time:  79.03498148918152
block generation total time  67.7948362827301
average batch blocks generation time:  2.1185886338353157
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2010498046875 GB
    Memory Allocated: 0.11815214157104492  GigaBytes
Max Memory Allocated: 0.11815214157104492  GigaBytes

torch.Size([165000, 128])
torch.Size([160662, 64])
torch.Size([146731, 64])
Traceback (most recent call last):
  File "pseudo_mini_batch_range_arxiv_sage.py", line 435, in <module>
    main()
  File "pseudo_mini_batch_range_arxiv_sage.py", line 431, in main
    best_test = run(args, device, data)
  File "pseudo_mini_batch_range_arxiv_sage.py", line 251, in run
    batch_pred = model(blocks, batch_inputs)#------------*
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/graph_partition_multi_layers/pseudo_mini_batch_full_batch/SAGE/graphsage_model_arxiv.py", line 182, in forward
    x = layer(block, x)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 258, in forward
    graph.update_all(msg_fn, self._lstm_reducer)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/heterograph.py", line 4849, in update_all
    ndata = core.message_passing(g, message_func, reduce_func, apply_node_func)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 337, in message_passing
    ndata = invoke_udf_reduce(g, rfunc, msgdata, orig_nid=orig_nid)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 143, in invoke_udf_reduce
    bkt_rsts.append(func(nbatch))
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 173, in _lstm_reducer
    _, (rst, _) = self.lstm(m, h)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/rnn.py", line 582, in forward
    self.dropout, self.training, self.bidirectional, self.batch_first)
RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 23.62 GiB total capacity; 22.35 GiB already allocated; 18.44 MiB free; 22.40 GiB reserved in total by PyTorch)
