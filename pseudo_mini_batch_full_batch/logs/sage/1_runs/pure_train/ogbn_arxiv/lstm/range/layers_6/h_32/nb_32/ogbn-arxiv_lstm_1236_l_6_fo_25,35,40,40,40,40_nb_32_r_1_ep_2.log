Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648525425.4937158
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007319450378417969  GigaBytes
Max Memory Allocated: 0.0007319450378417969  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.02477574348449707
range selection method range initialization spend 0.013486146926879883
time for parepare:  0.01787853240966797
local_output_nid generation:  0.0007059574127197266
local_in_edges_tensor generation:  0.003689289093017578
mini_batch_src_global generation:  0.0012981891632080078
r_  generation:  0.008626937866210938
local_output_nid generation:  0.0007367134094238281
local_in_edges_tensor generation:  0.0005693435668945312
mini_batch_src_global generation:  0.0013298988342285156
r_  generation:  0.00797414779663086
local_output_nid generation:  0.0007128715515136719
local_in_edges_tensor generation:  0.0005028247833251953
mini_batch_src_global generation:  0.0008332729339599609
r_  generation:  0.007768154144287109
local_output_nid generation:  0.0007333755493164062
local_in_edges_tensor generation:  0.0004940032958984375
mini_batch_src_global generation:  0.0007660388946533203
r_  generation:  0.007642984390258789
local_output_nid generation:  0.0007083415985107422
local_in_edges_tensor generation:  0.0004725456237792969
mini_batch_src_global generation:  0.0007295608520507812
r_  generation:  0.007430553436279297
local_output_nid generation:  0.0007107257843017578
local_in_edges_tensor generation:  0.00046253204345703125
mini_batch_src_global generation:  0.0007534027099609375
r_  generation:  0.007848501205444336
local_output_nid generation:  0.0007114410400390625
local_in_edges_tensor generation:  0.0004661083221435547
mini_batch_src_global generation:  0.0007832050323486328
r_  generation:  0.00789189338684082
local_output_nid generation:  0.0007162094116210938
local_in_edges_tensor generation:  0.00046181678771972656
mini_batch_src_global generation:  0.0007479190826416016
r_  generation:  0.0076982975006103516
local_output_nid generation:  0.0007212162017822266
local_in_edges_tensor generation:  0.000461578369140625
mini_batch_src_global generation:  0.0007696151733398438
r_  generation:  0.008185148239135742
local_output_nid generation:  0.0007236003875732422
local_in_edges_tensor generation:  0.00046062469482421875
mini_batch_src_global generation:  0.0007815361022949219
r_  generation:  0.007739543914794922
local_output_nid generation:  0.0007131099700927734
local_in_edges_tensor generation:  0.00046133995056152344
mini_batch_src_global generation:  0.0007925033569335938
r_  generation:  0.007961511611938477
local_output_nid generation:  0.00070953369140625
local_in_edges_tensor generation:  0.00047135353088378906
mini_batch_src_global generation:  0.0008347034454345703
r_  generation:  0.008394241333007812
local_output_nid generation:  0.0007147789001464844
local_in_edges_tensor generation:  0.0004508495330810547
mini_batch_src_global generation:  0.0008094310760498047
r_  generation:  0.007801055908203125
local_output_nid generation:  0.0007145404815673828
local_in_edges_tensor generation:  0.00046133995056152344
mini_batch_src_global generation:  0.0008447170257568359
r_  generation:  0.009319782257080078
local_output_nid generation:  0.0007252693176269531
local_in_edges_tensor generation:  0.0004684925079345703
mini_batch_src_global generation:  0.0008394718170166016
r_  generation:  0.007962465286254883
local_output_nid generation:  0.0007281303405761719
local_in_edges_tensor generation:  0.00045871734619140625
mini_batch_src_global generation:  0.0008151531219482422
r_  generation:  0.008049726486206055
local_output_nid generation:  0.0007383823394775391
local_in_edges_tensor generation:  0.0004591941833496094
mini_batch_src_global generation:  0.0008127689361572266
r_  generation:  0.007916450500488281
local_output_nid generation:  0.0007343292236328125
local_in_edges_tensor generation:  0.00047397613525390625
mini_batch_src_global generation:  0.0009541511535644531
r_  generation:  0.008421659469604492
local_output_nid generation:  0.0007338523864746094
local_in_edges_tensor generation:  0.00045871734619140625
mini_batch_src_global generation:  0.0008358955383300781
r_  generation:  0.008118152618408203
local_output_nid generation:  0.0007202625274658203
local_in_edges_tensor generation:  0.00045943260192871094
mini_batch_src_global generation:  0.0008282661437988281
r_  generation:  0.008225202560424805
local_output_nid generation:  0.0007264614105224609
local_in_edges_tensor generation:  0.0004551410675048828
mini_batch_src_global generation:  0.0008189678192138672
r_  generation:  0.008007287979125977
local_output_nid generation:  0.0007200241088867188
local_in_edges_tensor generation:  0.0004584789276123047
mini_batch_src_global generation:  0.0008141994476318359
r_  generation:  0.008195877075195312
local_output_nid generation:  0.0007174015045166016
local_in_edges_tensor generation:  0.0004565715789794922
mini_batch_src_global generation:  0.0009641647338867188
r_  generation:  0.008231639862060547
local_output_nid generation:  0.0007183551788330078
local_in_edges_tensor generation:  0.00046372413635253906
mini_batch_src_global generation:  0.0008320808410644531
r_  generation:  0.008321285247802734
local_output_nid generation:  0.0007178783416748047
local_in_edges_tensor generation:  0.00045418739318847656
mini_batch_src_global generation:  0.0008351802825927734
r_  generation:  0.008115530014038086
local_output_nid generation:  0.0007202625274658203
local_in_edges_tensor generation:  0.00046372413635253906
mini_batch_src_global generation:  0.0008156299591064453
r_  generation:  0.008179426193237305
local_output_nid generation:  0.0007276535034179688
local_in_edges_tensor generation:  0.0004582405090332031
mini_batch_src_global generation:  0.0008442401885986328
r_  generation:  0.008317947387695312
local_output_nid generation:  0.0007207393646240234
local_in_edges_tensor generation:  0.0004608631134033203
mini_batch_src_global generation:  0.0008218288421630859
r_  generation:  0.008077383041381836
local_output_nid generation:  0.0007200241088867188
local_in_edges_tensor generation:  0.0004646778106689453
mini_batch_src_global generation:  0.0008637905120849609
r_  generation:  0.008209228515625
local_output_nid generation:  0.0007307529449462891
local_in_edges_tensor generation:  0.0004525184631347656
mini_batch_src_global generation:  0.00083160400390625
r_  generation:  0.008193731307983398
local_output_nid generation:  0.0007169246673583984
local_in_edges_tensor generation:  0.0040590763092041016
mini_batch_src_global generation:  0.0010383129119873047
r_  generation:  0.008726835250854492
local_output_nid generation:  0.0007996559143066406
local_in_edges_tensor generation:  0.0004897117614746094
mini_batch_src_global generation:  0.0009241104125976562
r_  generation:  0.008275985717773438
----------------------check_connections_block total spend ----------------------------- 0.4145781993865967
generate_one_block  0.013565540313720703
generate_one_block  0.01325845718383789
generate_one_block  0.013230085372924805
generate_one_block  0.013054370880126953
generate_one_block  0.012677431106567383
generate_one_block  0.012992620468139648
generate_one_block  0.013228654861450195
generate_one_block  0.012944221496582031
generate_one_block  0.01318502426147461
generate_one_block  0.012853384017944336
generate_one_block  0.013032197952270508
generate_one_block  0.013512134552001953
generate_one_block  0.012762069702148438
generate_one_block  0.013815879821777344
generate_one_block  0.013139486312866211
generate_one_block  0.01296687126159668
generate_one_block  0.012917280197143555
generate_one_block  0.013620615005493164
generate_one_block  0.013108968734741211
generate_one_block  0.013297080993652344
generate_one_block  0.013037443161010742
generate_one_block  0.013336658477783203
generate_one_block  0.013317346572875977
generate_one_block  0.013341426849365234
generate_one_block  0.013396263122558594
generate_one_block  0.013261079788208008
generate_one_block  0.013468742370605469
generate_one_block  0.012945890426635742
generate_one_block  0.013205528259277344
generate_one_block  0.013186931610107422
generate_one_block  0.013926029205322266
generate_one_block  0.013259172439575195
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.043067216873168945
gen group dst list time:  0.02078866958618164
time for parepare:  0.019603252410888672
local_output_nid generation:  0.0038003921508789062
local_in_edges_tensor generation:  0.013254642486572266
mini_batch_src_global generation:  0.01172780990600586
r_  generation:  0.11686515808105469
local_output_nid generation:  0.0072727203369140625
local_in_edges_tensor generation:  0.011593341827392578
mini_batch_src_global generation:  0.01507711410522461
r_  generation:  0.12493300437927246
local_output_nid generation:  0.0079803466796875
local_in_edges_tensor generation:  0.007448911666870117
mini_batch_src_global generation:  0.01499629020690918
r_  generation:  0.13481593132019043
local_output_nid generation:  0.007964849472045898
local_in_edges_tensor generation:  0.009166955947875977
mini_batch_src_global generation:  0.01728367805480957
r_  generation:  0.147141695022583
local_output_nid generation:  0.007944583892822266
local_in_edges_tensor generation:  0.01849961280822754
mini_batch_src_global generation:  0.024024248123168945
r_  generation:  0.13236737251281738
local_output_nid generation:  0.008074045181274414
local_in_edges_tensor generation:  0.009093999862670898
mini_batch_src_global generation:  0.016523361206054688
r_  generation:  0.13387131690979004
local_output_nid generation:  0.006739616394042969
local_in_edges_tensor generation:  0.009485483169555664
mini_batch_src_global generation:  0.015372991561889648
r_  generation:  0.13567328453063965
local_output_nid generation:  0.006734371185302734
local_in_edges_tensor generation:  0.009576082229614258
mini_batch_src_global generation:  0.015509366989135742
r_  generation:  0.13238883018493652
local_output_nid generation:  0.0069921016693115234
local_in_edges_tensor generation:  0.009676694869995117
mini_batch_src_global generation:  0.016232013702392578
r_  generation:  0.1393871307373047
local_output_nid generation:  0.006846189498901367
local_in_edges_tensor generation:  0.008306741714477539
mini_batch_src_global generation:  0.01567864418029785
r_  generation:  0.13003993034362793
local_output_nid generation:  0.00699615478515625
local_in_edges_tensor generation:  0.009409904479980469
mini_batch_src_global generation:  0.017020463943481445
r_  generation:  0.1361980438232422
local_output_nid generation:  0.007111549377441406
local_in_edges_tensor generation:  0.008641958236694336
mini_batch_src_global generation:  0.017573118209838867
r_  generation:  0.1390683650970459
local_output_nid generation:  0.006983757019042969
local_in_edges_tensor generation:  0.007335662841796875
mini_batch_src_global generation:  0.03185009956359863
r_  generation:  0.13551568984985352
local_output_nid generation:  0.007314205169677734
local_in_edges_tensor generation:  0.00863027572631836
mini_batch_src_global generation:  0.017192840576171875
r_  generation:  0.14363312721252441
local_output_nid generation:  0.006922245025634766
local_in_edges_tensor generation:  0.010406732559204102
mini_batch_src_global generation:  0.016237258911132812
r_  generation:  0.136885404586792
local_output_nid generation:  0.007002592086791992
local_in_edges_tensor generation:  0.0072176456451416016
mini_batch_src_global generation:  0.016276836395263672
r_  generation:  0.1388225555419922
local_output_nid generation:  0.006994485855102539
local_in_edges_tensor generation:  0.007287025451660156
mini_batch_src_global generation:  0.016483306884765625
r_  generation:  0.13391780853271484
local_output_nid generation:  0.007260799407958984
local_in_edges_tensor generation:  0.008831024169921875
mini_batch_src_global generation:  0.017217397689819336
r_  generation:  0.14554810523986816
local_output_nid generation:  0.00710296630859375
local_in_edges_tensor generation:  0.009499311447143555
mini_batch_src_global generation:  0.016515731811523438
r_  generation:  0.14078760147094727
local_output_nid generation:  0.00713658332824707
local_in_edges_tensor generation:  0.009788036346435547
mini_batch_src_global generation:  0.016968727111816406
r_  generation:  0.1396622657775879
local_output_nid generation:  0.007039070129394531
local_in_edges_tensor generation:  0.007283687591552734
mini_batch_src_global generation:  0.01607680320739746
r_  generation:  0.13747406005859375
local_output_nid generation:  0.007166147232055664
local_in_edges_tensor generation:  0.008402109146118164
mini_batch_src_global generation:  0.017458438873291016
r_  generation:  0.13798832893371582
local_output_nid generation:  0.007245063781738281
local_in_edges_tensor generation:  0.010692119598388672
mini_batch_src_global generation:  0.016895771026611328
r_  generation:  0.14968276023864746
local_output_nid generation:  0.007239818572998047
local_in_edges_tensor generation:  0.00720977783203125
mini_batch_src_global generation:  0.019622802734375
r_  generation:  0.1402139663696289
local_output_nid generation:  0.0071451663970947266
local_in_edges_tensor generation:  0.008638620376586914
mini_batch_src_global generation:  0.015897750854492188
r_  generation:  0.13922429084777832
local_output_nid generation:  0.007050275802612305
local_in_edges_tensor generation:  0.008855342864990234
mini_batch_src_global generation:  0.021130084991455078
r_  generation:  0.13804125785827637
local_output_nid generation:  0.007335662841796875
local_in_edges_tensor generation:  0.01102137565612793
mini_batch_src_global generation:  0.016891002655029297
r_  generation:  0.1451563835144043
local_output_nid generation:  0.007125377655029297
local_in_edges_tensor generation:  0.007512331008911133
mini_batch_src_global generation:  0.016547203063964844
r_  generation:  0.13915371894836426
local_output_nid generation:  0.007175445556640625
local_in_edges_tensor generation:  0.00905752182006836
mini_batch_src_global generation:  0.01633763313293457
r_  generation:  0.13986587524414062
local_output_nid generation:  0.007284641265869141
local_in_edges_tensor generation:  0.009844303131103516
mini_batch_src_global generation:  0.016373634338378906
r_  generation:  0.13990283012390137
local_output_nid generation:  0.007392168045043945
local_in_edges_tensor generation:  0.010822296142578125
mini_batch_src_global generation:  0.016374826431274414
r_  generation:  0.1447463035583496
local_output_nid generation:  0.007343769073486328
local_in_edges_tensor generation:  0.007764101028442383
mini_batch_src_global generation:  0.02465224266052246
r_  generation:  0.14292502403259277
----------------------check_connections_block total spend ----------------------------- 6.622589349746704
generate_one_block  0.18284344673156738
generate_one_block  0.18135285377502441
generate_one_block  0.20683550834655762
generate_one_block  0.17463183403015137
generate_one_block  0.16748452186584473
generate_one_block  0.17349672317504883
generate_one_block  0.1723330020904541
generate_one_block  0.17044568061828613
generate_one_block  0.18530726432800293
generate_one_block  0.16639494895935059
generate_one_block  0.17756366729736328
generate_one_block  0.1844933032989502
generate_one_block  0.17123794555664062
generate_one_block  0.1872730255126953
generate_one_block  0.16998815536499023
generate_one_block  0.17327117919921875
generate_one_block  0.17244410514831543
generate_one_block  0.18453264236450195
generate_one_block  0.17493510246276855
generate_one_block  0.1765148639678955
generate_one_block  0.16891956329345703
generate_one_block  0.17525243759155273
generate_one_block  0.20963096618652344
generate_one_block  0.1976604461669922
generate_one_block  0.1692361831665039
generate_one_block  0.17072033882141113
generate_one_block  0.18487191200256348
generate_one_block  0.17354416847229004
generate_one_block  0.18120384216308594
generate_one_block  0.17669892311096191
generate_one_block  0.18475031852722168
generate_one_block  0.17845416069030762
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.07317805290222168
gen group dst list time:  0.1088402271270752
time for parepare:  0.02087092399597168
local_output_nid generation:  0.020798206329345703
local_in_edges_tensor generation:  0.046236276626586914
mini_batch_src_global generation:  0.04651904106140137
r_  generation:  0.4457051753997803
local_output_nid generation:  0.027246475219726562
local_in_edges_tensor generation:  0.04732537269592285
mini_batch_src_global generation:  0.05670166015625
r_  generation:  0.44614219665527344
local_output_nid generation:  0.027098655700683594
local_in_edges_tensor generation:  0.04264044761657715
mini_batch_src_global generation:  0.0529484748840332
r_  generation:  0.4475104808807373
local_output_nid generation:  0.025678634643554688
local_in_edges_tensor generation:  0.03920245170593262
mini_batch_src_global generation:  0.05426812171936035
r_  generation:  0.4597795009613037
local_output_nid generation:  0.02524542808532715
local_in_edges_tensor generation:  0.03088998794555664
mini_batch_src_global generation:  0.05411052703857422
r_  generation:  0.4648606777191162
local_output_nid generation:  0.02528834342956543
local_in_edges_tensor generation:  0.03282570838928223
mini_batch_src_global generation:  0.054628849029541016
r_  generation:  0.451540470123291
local_output_nid generation:  0.026070356369018555
local_in_edges_tensor generation:  0.0449676513671875
mini_batch_src_global generation:  0.0540921688079834
r_  generation:  0.447770357131958
local_output_nid generation:  0.0258638858795166
local_in_edges_tensor generation:  0.03520965576171875
mini_batch_src_global generation:  0.058431148529052734
r_  generation:  0.45105791091918945
local_output_nid generation:  0.026772737503051758
local_in_edges_tensor generation:  0.0368192195892334
mini_batch_src_global generation:  0.0547029972076416
r_  generation:  0.4742143154144287
local_output_nid generation:  0.026176929473876953
local_in_edges_tensor generation:  0.04498887062072754
mini_batch_src_global generation:  0.06177377700805664
r_  generation:  0.45319366455078125
local_output_nid generation:  0.02898573875427246
local_in_edges_tensor generation:  0.04155397415161133
mini_batch_src_global generation:  0.0541071891784668
r_  generation:  0.45500755310058594
local_output_nid generation:  0.02653670310974121
local_in_edges_tensor generation:  0.04431939125061035
mini_batch_src_global generation:  0.05428290367126465
r_  generation:  0.45653676986694336
local_output_nid generation:  0.02663135528564453
local_in_edges_tensor generation:  0.031487226486206055
mini_batch_src_global generation:  0.05367112159729004
r_  generation:  0.4507415294647217
local_output_nid generation:  0.02699756622314453
local_in_edges_tensor generation:  0.0479278564453125
mini_batch_src_global generation:  0.05484151840209961
r_  generation:  0.46130871772766113
local_output_nid generation:  0.026758193969726562
local_in_edges_tensor generation:  0.033766746520996094
mini_batch_src_global generation:  0.05462956428527832
r_  generation:  0.44964599609375
local_output_nid generation:  0.026599645614624023
local_in_edges_tensor generation:  0.03144502639770508
mini_batch_src_global generation:  0.05497407913208008
r_  generation:  0.4626777172088623
local_output_nid generation:  0.027205467224121094
local_in_edges_tensor generation:  0.03517031669616699
mini_batch_src_global generation:  0.05514812469482422
r_  generation:  0.45783567428588867
local_output_nid generation:  0.02676987648010254
local_in_edges_tensor generation:  0.03899383544921875
mini_batch_src_global generation:  0.057747602462768555
r_  generation:  0.4579346179962158
local_output_nid generation:  0.02688121795654297
local_in_edges_tensor generation:  0.04577374458312988
mini_batch_src_global generation:  0.054282188415527344
r_  generation:  0.45220065116882324
local_output_nid generation:  0.026877403259277344
local_in_edges_tensor generation:  0.03394508361816406
mini_batch_src_global generation:  0.05805516242980957
r_  generation:  0.45064830780029297
local_output_nid generation:  0.026680707931518555
local_in_edges_tensor generation:  0.03055119514465332
mini_batch_src_global generation:  0.05448269844055176
r_  generation:  0.4536170959472656
local_output_nid generation:  0.02685093879699707
local_in_edges_tensor generation:  0.03258180618286133
mini_batch_src_global generation:  0.05565762519836426
r_  generation:  0.4522087574005127
local_output_nid generation:  0.02777409553527832
local_in_edges_tensor generation:  0.049536705017089844
mini_batch_src_global generation:  0.07142114639282227
r_  generation:  0.45782995223999023
local_output_nid generation:  0.02892446517944336
local_in_edges_tensor generation:  0.034479618072509766
mini_batch_src_global generation:  0.0621490478515625
r_  generation:  0.4523153305053711
local_output_nid generation:  0.02703237533569336
local_in_edges_tensor generation:  0.029622554779052734
mini_batch_src_global generation:  0.05401277542114258
r_  generation:  0.4518299102783203
local_output_nid generation:  0.026922941207885742
local_in_edges_tensor generation:  0.027447938919067383
mini_batch_src_global generation:  0.0550694465637207
r_  generation:  0.4516470432281494
local_output_nid generation:  0.02707505226135254
local_in_edges_tensor generation:  0.03147435188293457
mini_batch_src_global generation:  0.054732322692871094
r_  generation:  0.46521735191345215
local_output_nid generation:  0.02684330940246582
local_in_edges_tensor generation:  0.03552675247192383
mini_batch_src_global generation:  0.05746936798095703
r_  generation:  0.4541330337524414
local_output_nid generation:  0.026871442794799805
local_in_edges_tensor generation:  0.03153681755065918
mini_batch_src_global generation:  0.055054664611816406
r_  generation:  0.45851635932922363
local_output_nid generation:  0.026864051818847656
local_in_edges_tensor generation:  0.038214921951293945
mini_batch_src_global generation:  0.05582857131958008
r_  generation:  0.4568297863006592
local_output_nid generation:  0.027928590774536133
local_in_edges_tensor generation:  0.042989492416381836
mini_batch_src_global generation:  0.059233665466308594
r_  generation:  0.4747908115386963
local_output_nid generation:  0.027284622192382812
local_in_edges_tensor generation:  0.03857588768005371
mini_batch_src_global generation:  0.07322478294372559
r_  generation:  0.460310697555542
----------------------check_connections_block total spend ----------------------------- 21.599888801574707
generate_one_block  0.5917849540710449
generate_one_block  0.6815011501312256
generate_one_block  0.5938596725463867
generate_one_block  0.6089210510253906
generate_one_block  0.5976722240447998
generate_one_block  0.618779182434082
generate_one_block  0.6054844856262207
generate_one_block  0.5961618423461914
generate_one_block  0.6137526035308838
generate_one_block  0.5833835601806641
generate_one_block  0.5946011543273926
generate_one_block  0.6182382106781006
generate_one_block  0.591691255569458
generate_one_block  0.6002845764160156
generate_one_block  0.5807986259460449
generate_one_block  0.5801236629486084
generate_one_block  0.5872395038604736
generate_one_block  0.6089489459991455
generate_one_block  0.5892055034637451
generate_one_block  0.5886964797973633
generate_one_block  0.6159870624542236
generate_one_block  0.6251904964447021
generate_one_block  0.6148598194122314
generate_one_block  0.5934488773345947
generate_one_block  0.5798509120941162
generate_one_block  0.6018729209899902
generate_one_block  0.6189582347869873
generate_one_block  0.6045918464660645
generate_one_block  0.6180086135864258
generate_one_block  0.5936734676361084
generate_one_block  0.5940835475921631
generate_one_block  0.6049206256866455
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.05474853515625
gen group dst list time:  0.18624401092529297
time for parepare:  0.021018505096435547
local_output_nid generation:  0.03256940841674805
local_in_edges_tensor generation:  0.06105399131774902
mini_batch_src_global generation:  0.05097627639770508
r_  generation:  0.5368409156799316
local_output_nid generation:  0.03805685043334961
local_in_edges_tensor generation:  0.05490565299987793
mini_batch_src_global generation:  0.06270766258239746
r_  generation:  0.5474774837493896
local_output_nid generation:  0.037444114685058594
local_in_edges_tensor generation:  0.05096912384033203
mini_batch_src_global generation:  0.06095409393310547
r_  generation:  0.5456669330596924
local_output_nid generation:  0.03605794906616211
local_in_edges_tensor generation:  0.03677701950073242
mini_batch_src_global generation:  0.05724024772644043
r_  generation:  0.5458369255065918
local_output_nid generation:  0.036243438720703125
local_in_edges_tensor generation:  0.03958296775817871
mini_batch_src_global generation:  0.059684038162231445
r_  generation:  0.5514094829559326
local_output_nid generation:  0.037741661071777344
local_in_edges_tensor generation:  0.04058670997619629
mini_batch_src_global generation:  0.05983257293701172
r_  generation:  0.5550343990325928
local_output_nid generation:  0.03624224662780762
local_in_edges_tensor generation:  0.04176068305969238
mini_batch_src_global generation:  0.06073403358459473
r_  generation:  0.5608930587768555
local_output_nid generation:  0.036535024642944336
local_in_edges_tensor generation:  0.055325984954833984
mini_batch_src_global generation:  0.07043576240539551
r_  generation:  0.5642187595367432
local_output_nid generation:  0.03815340995788574
local_in_edges_tensor generation:  0.04666328430175781
mini_batch_src_global generation:  0.061353206634521484
r_  generation:  0.5548434257507324
local_output_nid generation:  0.037561655044555664
local_in_edges_tensor generation:  0.04148292541503906
mini_batch_src_global generation:  0.06162881851196289
r_  generation:  0.5581381320953369
local_output_nid generation:  0.03750467300415039
local_in_edges_tensor generation:  0.03630471229553223
mini_batch_src_global generation:  0.061167240142822266
r_  generation:  0.5547537803649902
local_output_nid generation:  0.037590980529785156
local_in_edges_tensor generation:  0.04644036293029785
mini_batch_src_global generation:  0.06061291694641113
r_  generation:  0.5685944557189941
local_output_nid generation:  0.0372011661529541
local_in_edges_tensor generation:  0.04159998893737793
mini_batch_src_global generation:  0.06597518920898438
r_  generation:  0.5620231628417969
local_output_nid generation:  0.03731274604797363
local_in_edges_tensor generation:  0.0464167594909668
mini_batch_src_global generation:  0.06168556213378906
r_  generation:  0.5610270500183105
local_output_nid generation:  0.03737235069274902
local_in_edges_tensor generation:  0.04155731201171875
mini_batch_src_global generation:  0.06371903419494629
r_  generation:  0.5595622062683105
local_output_nid generation:  0.03788900375366211
local_in_edges_tensor generation:  0.03669857978820801
mini_batch_src_global generation:  0.06170248985290527
r_  generation:  0.5602335929870605
local_output_nid generation:  0.037787437438964844
local_in_edges_tensor generation:  0.04470634460449219
mini_batch_src_global generation:  0.061484575271606445
r_  generation:  0.5586714744567871
local_output_nid generation:  0.03748965263366699
local_in_edges_tensor generation:  0.03916525840759277
mini_batch_src_global generation:  0.061582088470458984
r_  generation:  0.5644283294677734
local_output_nid generation:  0.03875613212585449
local_in_edges_tensor generation:  0.035088539123535156
mini_batch_src_global generation:  0.06145048141479492
r_  generation:  0.5613510608673096
local_output_nid generation:  0.03785061836242676
local_in_edges_tensor generation:  0.044457197189331055
mini_batch_src_global generation:  0.06178617477416992
r_  generation:  0.565676212310791
local_output_nid generation:  0.03813004493713379
local_in_edges_tensor generation:  0.045792341232299805
mini_batch_src_global generation:  0.062163352966308594
r_  generation:  0.5634493827819824
local_output_nid generation:  0.03814291954040527
local_in_edges_tensor generation:  0.03809809684753418
mini_batch_src_global generation:  0.06399083137512207
r_  generation:  0.5636742115020752
local_output_nid generation:  0.037928104400634766
local_in_edges_tensor generation:  0.039095163345336914
mini_batch_src_global generation:  0.06182575225830078
r_  generation:  0.5685217380523682
local_output_nid generation:  0.037842750549316406
local_in_edges_tensor generation:  0.050664424896240234
mini_batch_src_global generation:  0.06713318824768066
r_  generation:  0.5703840255737305
local_output_nid generation:  0.038546085357666016
local_in_edges_tensor generation:  0.04535675048828125
mini_batch_src_global generation:  0.06289315223693848
r_  generation:  0.5639064311981201
local_output_nid generation:  0.03781580924987793
local_in_edges_tensor generation:  0.03927469253540039
mini_batch_src_global generation:  0.06599187850952148
r_  generation:  0.5609331130981445
local_output_nid generation:  0.03817892074584961
local_in_edges_tensor generation:  0.04506564140319824
mini_batch_src_global generation:  0.06188368797302246
r_  generation:  0.5621376037597656
local_output_nid generation:  0.03783679008483887
local_in_edges_tensor generation:  0.0345914363861084
mini_batch_src_global generation:  0.06518697738647461
r_  generation:  0.5755321979522705
local_output_nid generation:  0.03773021697998047
local_in_edges_tensor generation:  0.03439664840698242
mini_batch_src_global generation:  0.06320858001708984
r_  generation:  0.5627892017364502
local_output_nid generation:  0.03772401809692383
local_in_edges_tensor generation:  0.03446030616760254
mini_batch_src_global generation:  0.06334877014160156
r_  generation:  0.5689249038696289
local_output_nid generation:  0.03795480728149414
local_in_edges_tensor generation:  0.04060649871826172
mini_batch_src_global generation:  0.06728196144104004
r_  generation:  0.5581042766571045
local_output_nid generation:  0.037694454193115234
local_in_edges_tensor generation:  0.03932929039001465
mini_batch_src_global generation:  0.06142377853393555
r_  generation:  0.5708105564117432
----------------------check_connections_block total spend ----------------------------- 26.731589317321777
generate_one_block  0.7196860313415527
generate_one_block  0.708853006362915
generate_one_block  0.6980154514312744
generate_one_block  0.6860342025756836
generate_one_block  0.6945874691009521
generate_one_block  0.6892037391662598
generate_one_block  0.7022733688354492
generate_one_block  0.8352093696594238
generate_one_block  0.6902153491973877
generate_one_block  0.6793503761291504
generate_one_block  0.6776955127716064
generate_one_block  0.6865665912628174
generate_one_block  0.687593936920166
generate_one_block  0.7016372680664062
generate_one_block  0.7019453048706055
generate_one_block  0.6863112449645996
generate_one_block  0.7040786743164062
generate_one_block  0.6827807426452637
generate_one_block  0.6800014972686768
generate_one_block  0.689361572265625
generate_one_block  0.6979854106903076
generate_one_block  0.6797876358032227
generate_one_block  0.7002460956573486
generate_one_block  0.700244665145874
generate_one_block  0.7014079093933105
generate_one_block  0.6977083683013916
generate_one_block  0.7047903537750244
generate_one_block  0.7187895774841309
generate_one_block  0.6991238594055176
generate_one_block  0.69246506690979
generate_one_block  0.7076659202575684
generate_one_block  0.698725700378418
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04566550254821777
gen group dst list time:  0.20840692520141602
time for parepare:  0.019799470901489258
local_output_nid generation:  0.03567028045654297
local_in_edges_tensor generation:  0.06378340721130371
mini_batch_src_global generation:  0.05166172981262207
r_  generation:  0.5366048812866211
local_output_nid generation:  0.04142045974731445
local_in_edges_tensor generation:  0.046837568283081055
mini_batch_src_global generation:  0.0619807243347168
r_  generation:  0.5424904823303223
local_output_nid generation:  0.04192066192626953
local_in_edges_tensor generation:  0.03773808479309082
mini_batch_src_global generation:  0.06199908256530762
r_  generation:  0.5402543544769287
local_output_nid generation:  0.04086613655090332
local_in_edges_tensor generation:  0.040014028549194336
mini_batch_src_global generation:  0.06136679649353027
r_  generation:  0.5414371490478516
local_output_nid generation:  0.03935837745666504
local_in_edges_tensor generation:  0.04014182090759277
mini_batch_src_global generation:  0.06140637397766113
r_  generation:  0.5538415908813477
local_output_nid generation:  0.039519309997558594
local_in_edges_tensor generation:  0.03965902328491211
mini_batch_src_global generation:  0.06090092658996582
r_  generation:  0.5449421405792236
local_output_nid generation:  0.03964424133300781
local_in_edges_tensor generation:  0.038207054138183594
mini_batch_src_global generation:  0.0608372688293457
r_  generation:  0.5498054027557373
local_output_nid generation:  0.03985190391540527
local_in_edges_tensor generation:  0.038222551345825195
mini_batch_src_global generation:  0.0607757568359375
r_  generation:  0.5475327968597412
local_output_nid generation:  0.03914332389831543
local_in_edges_tensor generation:  0.04205203056335449
mini_batch_src_global generation:  0.06091451644897461
r_  generation:  0.553490161895752
local_output_nid generation:  0.0394740104675293
local_in_edges_tensor generation:  0.0380401611328125
mini_batch_src_global generation:  0.06148838996887207
r_  generation:  0.55584716796875
local_output_nid generation:  0.039420127868652344
local_in_edges_tensor generation:  0.04240822792053223
mini_batch_src_global generation:  0.06168341636657715
r_  generation:  0.5536582469940186
local_output_nid generation:  0.03946542739868164
local_in_edges_tensor generation:  0.04773974418640137
mini_batch_src_global generation:  0.0604705810546875
r_  generation:  0.5605616569519043
local_output_nid generation:  0.03983664512634277
local_in_edges_tensor generation:  0.04224348068237305
mini_batch_src_global generation:  0.06091117858886719
r_  generation:  0.5538749694824219
local_output_nid generation:  0.03952431678771973
local_in_edges_tensor generation:  0.047686100006103516
mini_batch_src_global generation:  0.06142878532409668
r_  generation:  0.5546543598175049
local_output_nid generation:  0.039663076400756836
local_in_edges_tensor generation:  0.047017574310302734
mini_batch_src_global generation:  0.06343507766723633
r_  generation:  0.5556232929229736
local_output_nid generation:  0.04043221473693848
local_in_edges_tensor generation:  0.04184317588806152
mini_batch_src_global generation:  0.06089210510253906
r_  generation:  0.55645751953125
local_output_nid generation:  0.03950619697570801
local_in_edges_tensor generation:  0.04723072052001953
mini_batch_src_global generation:  0.06131577491760254
r_  generation:  0.5638926029205322
local_output_nid generation:  0.03994941711425781
local_in_edges_tensor generation:  0.03881406784057617
mini_batch_src_global generation:  0.06221628189086914
r_  generation:  0.5655350685119629
local_output_nid generation:  0.03949236869812012
local_in_edges_tensor generation:  0.04443073272705078
mini_batch_src_global generation:  0.0612645149230957
r_  generation:  0.5603396892547607
local_output_nid generation:  0.03987860679626465
local_in_edges_tensor generation:  0.04248762130737305
mini_batch_src_global generation:  0.062102317810058594
r_  generation:  0.5598611831665039
local_output_nid generation:  0.03967714309692383
local_in_edges_tensor generation:  0.04797959327697754
mini_batch_src_global generation:  0.06196451187133789
r_  generation:  0.5603175163269043
local_output_nid generation:  0.03955364227294922
local_in_edges_tensor generation:  0.03838920593261719
mini_batch_src_global generation:  0.061697959899902344
r_  generation:  0.5607204437255859
local_output_nid generation:  0.03962349891662598
local_in_edges_tensor generation:  0.04224681854248047
mini_batch_src_global generation:  0.06594347953796387
r_  generation:  0.5670244693756104
local_output_nid generation:  0.03971552848815918
local_in_edges_tensor generation:  0.04847311973571777
mini_batch_src_global generation:  0.06257176399230957
r_  generation:  0.5660779476165771
local_output_nid generation:  0.04002046585083008
local_in_edges_tensor generation:  0.03911757469177246
mini_batch_src_global generation:  0.06244349479675293
r_  generation:  0.562654972076416
local_output_nid generation:  0.03993678092956543
local_in_edges_tensor generation:  0.03888416290283203
mini_batch_src_global generation:  0.06655716896057129
r_  generation:  0.5596621036529541
local_output_nid generation:  0.040318965911865234
local_in_edges_tensor generation:  0.048238277435302734
mini_batch_src_global generation:  0.06279706954956055
r_  generation:  0.5600600242614746
local_output_nid generation:  0.039774179458618164
local_in_edges_tensor generation:  0.04777050018310547
mini_batch_src_global generation:  0.06588172912597656
r_  generation:  0.5581560134887695
local_output_nid generation:  0.040006399154663086
local_in_edges_tensor generation:  0.041867971420288086
mini_batch_src_global generation:  0.06235957145690918
r_  generation:  0.564605712890625
local_output_nid generation:  0.04012560844421387
local_in_edges_tensor generation:  0.038474321365356445
mini_batch_src_global generation:  0.0627446174621582
r_  generation:  0.5598666667938232
local_output_nid generation:  0.03988361358642578
local_in_edges_tensor generation:  0.03795957565307617
mini_batch_src_global generation:  0.06202292442321777
r_  generation:  0.5672786235809326
local_output_nid generation:  0.04011964797973633
local_in_edges_tensor generation:  0.05262351036071777
mini_batch_src_global generation:  0.06275272369384766
r_  generation:  0.5609936714172363
----------------------check_connections_block total spend ----------------------------- 26.69738268852234
generate_one_block  0.6865878105163574
generate_one_block  0.6977729797363281
generate_one_block  0.6968982219696045
generate_one_block  0.6777470111846924
generate_one_block  0.6819198131561279
generate_one_block  0.6864349842071533
generate_one_block  0.6987264156341553
generate_one_block  0.6964659690856934
generate_one_block  0.6862680912017822
generate_one_block  0.6755814552307129
generate_one_block  0.6743452548980713
generate_one_block  0.6800031661987305
generate_one_block  0.7030782699584961
generate_one_block  0.8365635871887207
generate_one_block  0.7097954750061035
generate_one_block  0.6895644664764404
generate_one_block  0.6931874752044678
generate_one_block  0.6911022663116455
generate_one_block  0.6838557720184326
generate_one_block  0.695040225982666
generate_one_block  0.6963586807250977
generate_one_block  0.6923220157623291
generate_one_block  0.6907262802124023
generate_one_block  0.6975481510162354
generate_one_block  0.6758522987365723
generate_one_block  0.693253755569458
generate_one_block  0.6834192276000977
generate_one_block  0.7060716152191162
generate_one_block  0.7115662097930908
generate_one_block  0.6826522350311279
generate_one_block  0.7077057361602783
generate_one_block  0.6881439685821533
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05139493942260742
gen group dst list time:  0.21649813652038574
time for parepare:  0.019197702407836914
local_output_nid generation:  0.03663945198059082
local_in_edges_tensor generation:  0.05601358413696289
mini_batch_src_global generation:  0.045023441314697266
r_  generation:  0.5126745700836182
local_output_nid generation:  0.042426109313964844
local_in_edges_tensor generation:  0.03901362419128418
mini_batch_src_global generation:  0.05782794952392578
r_  generation:  0.5067422389984131
local_output_nid generation:  0.04259133338928223
local_in_edges_tensor generation:  0.03670978546142578
mini_batch_src_global generation:  0.05765104293823242
r_  generation:  0.5087668895721436
local_output_nid generation:  0.04205441474914551
local_in_edges_tensor generation:  0.036972761154174805
mini_batch_src_global generation:  0.05781698226928711
r_  generation:  0.5219311714172363
local_output_nid generation:  0.03986215591430664
local_in_edges_tensor generation:  0.03686237335205078
mini_batch_src_global generation:  0.05728769302368164
r_  generation:  0.507838249206543
local_output_nid generation:  0.04027915000915527
local_in_edges_tensor generation:  0.03861212730407715
mini_batch_src_global generation:  0.05722761154174805
r_  generation:  0.508183479309082
local_output_nid generation:  0.039940595626831055
local_in_edges_tensor generation:  0.03917098045349121
mini_batch_src_global generation:  0.05744194984436035
r_  generation:  0.5095109939575195
local_output_nid generation:  0.03988504409790039
local_in_edges_tensor generation:  0.03707766532897949
mini_batch_src_global generation:  0.05843758583068848
r_  generation:  0.5135204792022705
local_output_nid generation:  0.04046940803527832
local_in_edges_tensor generation:  0.03681135177612305
mini_batch_src_global generation:  0.057959556579589844
r_  generation:  0.5113010406494141
local_output_nid generation:  0.040368080139160156
local_in_edges_tensor generation:  0.03716611862182617
mini_batch_src_global generation:  0.05850815773010254
r_  generation:  0.517967939376831
local_output_nid generation:  0.04059267044067383
local_in_edges_tensor generation:  0.04131579399108887
mini_batch_src_global generation:  0.05821800231933594
r_  generation:  0.5149936676025391
local_output_nid generation:  0.04073071479797363
local_in_edges_tensor generation:  0.04102015495300293
mini_batch_src_global generation:  0.05852079391479492
r_  generation:  0.5163788795471191
local_output_nid generation:  0.0407867431640625
local_in_edges_tensor generation:  0.04137015342712402
mini_batch_src_global generation:  0.058007240295410156
r_  generation:  0.5174241065979004
local_output_nid generation:  0.040717363357543945
local_in_edges_tensor generation:  0.04600834846496582
mini_batch_src_global generation:  0.05782747268676758
r_  generation:  0.5180225372314453
local_output_nid generation:  0.040511369705200195
local_in_edges_tensor generation:  0.04564166069030762
mini_batch_src_global generation:  0.05942583084106445
r_  generation:  0.5378189086914062
local_output_nid generation:  0.04066634178161621
local_in_edges_tensor generation:  0.041259050369262695
mini_batch_src_global generation:  0.0586695671081543
r_  generation:  0.5205755233764648
local_output_nid generation:  0.040654659271240234
local_in_edges_tensor generation:  0.04593348503112793
mini_batch_src_global generation:  0.06135749816894531
r_  generation:  0.5225176811218262
local_output_nid generation:  0.04147672653198242
local_in_edges_tensor generation:  0.03781723976135254
mini_batch_src_global generation:  0.05796408653259277
r_  generation:  0.5183026790618896
local_output_nid generation:  0.04082131385803223
local_in_edges_tensor generation:  0.036574363708496094
mini_batch_src_global generation:  0.06186485290527344
r_  generation:  0.5201902389526367
local_output_nid generation:  0.0403749942779541
local_in_edges_tensor generation:  0.04608559608459473
mini_batch_src_global generation:  0.058705806732177734
r_  generation:  0.5190944671630859
local_output_nid generation:  0.04051780700683594
local_in_edges_tensor generation:  0.04136824607849121
mini_batch_src_global generation:  0.06199288368225098
r_  generation:  0.5211770534515381
local_output_nid generation:  0.040509700775146484
local_in_edges_tensor generation:  0.037151336669921875
mini_batch_src_global generation:  0.05840134620666504
r_  generation:  0.5175504684448242
local_output_nid generation:  0.040544748306274414
local_in_edges_tensor generation:  0.15352702140808105
mini_batch_src_global generation:  0.05775594711303711
r_  generation:  0.5266637802124023
local_output_nid generation:  0.04050159454345703
local_in_edges_tensor generation:  0.04150843620300293
mini_batch_src_global generation:  0.05827021598815918
r_  generation:  0.5202250480651855
local_output_nid generation:  0.04063820838928223
local_in_edges_tensor generation:  0.040876150131225586
mini_batch_src_global generation:  0.058326005935668945
r_  generation:  0.5233449935913086
local_output_nid generation:  0.04071688652038574
local_in_edges_tensor generation:  0.045911550521850586
mini_batch_src_global generation:  0.057875633239746094
r_  generation:  0.5206301212310791
local_output_nid generation:  0.04081892967224121
local_in_edges_tensor generation:  0.04096269607543945
mini_batch_src_global generation:  0.0581209659576416
r_  generation:  0.5215344429016113
local_output_nid generation:  0.04066824913024902
local_in_edges_tensor generation:  0.0409543514251709
mini_batch_src_global generation:  0.0630486011505127
r_  generation:  0.5208818912506104
local_output_nid generation:  0.040734291076660156
local_in_edges_tensor generation:  0.03763175010681152
mini_batch_src_global generation:  0.05758547782897949
r_  generation:  0.5224452018737793
local_output_nid generation:  0.04028463363647461
local_in_edges_tensor generation:  0.04526209831237793
mini_batch_src_global generation:  0.057749271392822266
r_  generation:  0.5231823921203613
local_output_nid generation:  0.040308475494384766
local_in_edges_tensor generation:  0.04317593574523926
mini_batch_src_global generation:  0.05813312530517578
r_  generation:  0.5312464237213135
local_output_nid generation:  0.04049825668334961
local_in_edges_tensor generation:  0.04121828079223633
mini_batch_src_global generation:  0.05795621871948242
r_  generation:  0.5270655155181885
----------------------check_connections_block total spend ----------------------------- 25.179797172546387
generate_one_block  0.6340243816375732
generate_one_block  0.6444911956787109
generate_one_block  0.641315221786499
generate_one_block  0.6471500396728516
generate_one_block  0.6438045501708984
generate_one_block  0.6447603702545166
generate_one_block  0.6421527862548828
generate_one_block  0.647284746170044
generate_one_block  0.6428351402282715
generate_one_block  0.7069180011749268
generate_one_block  0.6382148265838623
generate_one_block  0.6432065963745117
generate_one_block  0.704594612121582
generate_one_block  0.6533398628234863
generate_one_block  0.6570713520050049
generate_one_block  0.6447863578796387
generate_one_block  0.6700551509857178
generate_one_block  0.6491391658782959
generate_one_block  0.6530570983886719
generate_one_block  0.6881833076477051
generate_one_block  0.6586341857910156
generate_one_block  0.6624853610992432
generate_one_block  0.6686818599700928
generate_one_block  0.6552975177764893
generate_one_block  0.6433541774749756
generate_one_block  0.6654059886932373
generate_one_block  0.6530942916870117
generate_one_block  0.6448681354522705
generate_one_block  0.6464183330535889
generate_one_block  0.6435267925262451
generate_one_block  0.644467830657959
generate_one_block  0.644939661026001
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007319450378417969  GigaBytes
Max Memory Allocated: 0.0007319450378417969  GigaBytes

connection checking time:  106.83124732971191
block generation total time  90.61535716056824
average batch blocks generation time:  2.8317299112677574
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2205810546875 GB
    Memory Allocated: 0.13231420516967773  GigaBytes
Max Memory Allocated: 0.13231420516967773  GigaBytes

torch.Size([166922, 128])
torch.Size([165611, 32])
torch.Size([161477, 32])
torch.Size([147759, 32])
torch.Size([100397, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2088623046875 GB
    Memory Allocated: 21.93734073638916  GigaBytes
Max Memory Allocated: 21.94042158126831  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7694091796875 GB
    Memory Allocated: 0.13346242904663086  GigaBytes
Max Memory Allocated: 21.94042158126831  GigaBytes

torch.Size([166776, 128])
torch.Size([165411, 32])
torch.Size([161280, 32])
torch.Size([147665, 32])
torch.Size([100455, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 21.93207883834839  GigaBytes
Max Memory Allocated: 21.94042158126831  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 0.1340794563293457  GigaBytes
Max Memory Allocated: 21.94042158126831  GigaBytes

torch.Size([166830, 128])
torch.Size([165506, 32])
torch.Size([161440, 32])
torch.Size([148043, 32])
torch.Size([101728, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 21.9651837348938  GigaBytes
Max Memory Allocated: 21.968733310699463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 0.13346385955810547  GigaBytes
Max Memory Allocated: 21.968733310699463  GigaBytes

torch.Size([166743, 128])
torch.Size([165315, 32])
torch.Size([161022, 32])
torch.Size([147174, 32])
torch.Size([101430, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 21.964359283447266  GigaBytes
Max Memory Allocated: 21.96896505355835  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 0.1329350471496582  GigaBytes
Max Memory Allocated: 21.96896505355835  GigaBytes

torch.Size([166897, 128])
torch.Size([165456, 32])
torch.Size([161232, 32])
torch.Size([147079, 32])
torch.Size([99185, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 21.893226623535156  GigaBytes
Max Memory Allocated: 21.96896505355835  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 0.1334834098815918  GigaBytes
Max Memory Allocated: 21.96896505355835  GigaBytes

torch.Size([166798, 128])
torch.Size([165416, 32])
torch.Size([161309, 32])
torch.Size([147570, 32])
torch.Size([101074, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 21.945916175842285  GigaBytes
Max Memory Allocated: 21.96896505355835  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 0.13402700424194336  GigaBytes
Max Memory Allocated: 21.96896505355835  GigaBytes

torch.Size([166891, 128])
torch.Size([165620, 32])
torch.Size([161567, 32])
torch.Size([147741, 32])
torch.Size([100476, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 21.94459581375122  GigaBytes
Max Memory Allocated: 21.96896505355835  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 0.1334676742553711  GigaBytes
Max Memory Allocated: 21.96896505355835  GigaBytes

torch.Size([166859, 128])
torch.Size([165526, 32])
torch.Size([161448, 32])
torch.Size([147661, 32])
torch.Size([101199, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 21.931722164154053  GigaBytes
Max Memory Allocated: 21.96896505355835  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 0.13411569595336914  GigaBytes
Max Memory Allocated: 21.96896505355835  GigaBytes

torch.Size([166879, 128])
torch.Size([165531, 32])
torch.Size([161402, 32])
torch.Size([147507, 32])
torch.Size([100399, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5975341796875 GB
    Memory Allocated: 21.96665382385254  GigaBytes
Max Memory Allocated: 21.970516681671143  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5975341796875 GB
    Memory Allocated: 0.13341617584228516  GigaBytes
Max Memory Allocated: 21.970516681671143  GigaBytes

torch.Size([166855, 128])
torch.Size([165485, 32])
torch.Size([161203, 32])
torch.Size([147011, 32])
torch.Size([99717, 32])
Traceback (most recent call last):
  File "pseudo_mini_batch_range_arxiv_sage.py", line 438, in <module>
    main()
  File "pseudo_mini_batch_range_arxiv_sage.py", line 434, in main
    best_test = run(args, device, data)
  File "pseudo_mini_batch_range_arxiv_sage.py", line 253, in run
    batch_pred = model(blocks, batch_inputs)#------------*
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/graph_partition_multi_layers/pseudo_mini_batch_full_batch/SAGE/graphsage_model_arxiv.py", line 203, in forward
    x = self.layers[-1](blocks[-1], x)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 267, in forward
    rst = self.fc_self(h_self) + h_neigh
RuntimeError: CUDA out of memory. Tried to allocate 2.00 MiB (GPU 0; 23.62 GiB total capacity; 21.91 GiB already allocated; 2.44 MiB free; 22.40 GiB reserved in total by PyTorch)
