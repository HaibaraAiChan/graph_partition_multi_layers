Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648469139.76042
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024291276931762695
range selection method range initialization spend 0.017121315002441406
time for parepare:  0.017895936965942383
local_output_nid generation:  0.0007586479187011719
local_in_edges_tensor generation:  0.003167867660522461
mini_batch_src_global generation:  0.0017285346984863281
r_  generation:  0.010427474975585938
local_output_nid generation:  0.0008597373962402344
local_in_edges_tensor generation:  0.0005731582641601562
mini_batch_src_global generation:  0.0013332366943359375
r_  generation:  0.008119344711303711
local_output_nid generation:  0.0008318424224853516
local_in_edges_tensor generation:  0.0004897117614746094
mini_batch_src_global generation:  0.0008625984191894531
r_  generation:  0.007637977600097656
local_output_nid generation:  0.0008149147033691406
local_in_edges_tensor generation:  0.00046944618225097656
mini_batch_src_global generation:  0.0008165836334228516
r_  generation:  0.0075833797454833984
local_output_nid generation:  0.0008111000061035156
local_in_edges_tensor generation:  0.0004546642303466797
mini_batch_src_global generation:  0.0007159709930419922
r_  generation:  0.0074121952056884766
local_output_nid generation:  0.0008008480072021484
local_in_edges_tensor generation:  0.0004494190216064453
mini_batch_src_global generation:  0.0007176399230957031
r_  generation:  0.0076410770416259766
local_output_nid generation:  0.0007822513580322266
local_in_edges_tensor generation:  0.00046944618225097656
mini_batch_src_global generation:  0.0007493495941162109
r_  generation:  0.007903337478637695
local_output_nid generation:  0.0007853507995605469
local_in_edges_tensor generation:  0.0004401206970214844
mini_batch_src_global generation:  0.0007290840148925781
r_  generation:  0.007606029510498047
local_output_nid generation:  0.0007686614990234375
local_in_edges_tensor generation:  0.0004582405090332031
mini_batch_src_global generation:  0.0008976459503173828
r_  generation:  0.008002519607543945
local_output_nid generation:  0.0007798671722412109
local_in_edges_tensor generation:  0.0004553794860839844
mini_batch_src_global generation:  0.0007650852203369141
r_  generation:  0.007719755172729492
local_output_nid generation:  0.0007698535919189453
local_in_edges_tensor generation:  0.0004532337188720703
mini_batch_src_global generation:  0.000934600830078125
r_  generation:  0.00811910629272461
local_output_nid generation:  0.0007781982421875
local_in_edges_tensor generation:  0.0004496574401855469
mini_batch_src_global generation:  0.0007967948913574219
r_  generation:  0.008161067962646484
local_output_nid generation:  0.0007627010345458984
local_in_edges_tensor generation:  0.00044608116149902344
mini_batch_src_global generation:  0.0007877349853515625
r_  generation:  0.007905721664428711
local_output_nid generation:  0.0007767677307128906
local_in_edges_tensor generation:  0.00043702125549316406
mini_batch_src_global generation:  0.0007863044738769531
r_  generation:  0.007820844650268555
local_output_nid generation:  0.0007729530334472656
local_in_edges_tensor generation:  0.00045752525329589844
mini_batch_src_global generation:  0.0008285045623779297
r_  generation:  0.008198261260986328
local_output_nid generation:  0.0007662773132324219
local_in_edges_tensor generation:  0.0004379749298095703
mini_batch_src_global generation:  0.0008282661437988281
r_  generation:  0.007688045501708984
local_output_nid generation:  0.0007672309875488281
local_in_edges_tensor generation:  0.0004367828369140625
mini_batch_src_global generation:  0.0007784366607666016
r_  generation:  0.007700443267822266
local_output_nid generation:  0.0007739067077636719
local_in_edges_tensor generation:  0.0004372596740722656
mini_batch_src_global generation:  0.0009391307830810547
r_  generation:  0.008152008056640625
local_output_nid generation:  0.0007555484771728516
local_in_edges_tensor generation:  0.0004405975341796875
mini_batch_src_global generation:  0.00080108642578125
r_  generation:  0.008011817932128906
local_output_nid generation:  0.0007660388946533203
local_in_edges_tensor generation:  0.00043964385986328125
mini_batch_src_global generation:  0.0008249282836914062
r_  generation:  0.008295059204101562
local_output_nid generation:  0.0007719993591308594
local_in_edges_tensor generation:  0.00043964385986328125
mini_batch_src_global generation:  0.0008158683776855469
r_  generation:  0.008104562759399414
local_output_nid generation:  0.0007753372192382812
local_in_edges_tensor generation:  0.00044274330139160156
mini_batch_src_global generation:  0.0008006095886230469
r_  generation:  0.007875680923461914
local_output_nid generation:  0.0007765293121337891
local_in_edges_tensor generation:  0.0004410743713378906
mini_batch_src_global generation:  0.0007889270782470703
r_  generation:  0.008009195327758789
local_output_nid generation:  0.0007593631744384766
local_in_edges_tensor generation:  0.00044035911560058594
mini_batch_src_global generation:  0.0008032321929931641
r_  generation:  0.008248567581176758
local_output_nid generation:  0.0007596015930175781
local_in_edges_tensor generation:  0.00043845176696777344
mini_batch_src_global generation:  0.0008330345153808594
r_  generation:  0.008264780044555664
local_output_nid generation:  0.0007648468017578125
local_in_edges_tensor generation:  0.00044846534729003906
mini_batch_src_global generation:  0.0008373260498046875
r_  generation:  0.008140325546264648
local_output_nid generation:  0.0007548332214355469
local_in_edges_tensor generation:  0.0004405975341796875
mini_batch_src_global generation:  0.0008232593536376953
r_  generation:  0.007876873016357422
local_output_nid generation:  0.000762939453125
local_in_edges_tensor generation:  0.00044155120849609375
mini_batch_src_global generation:  0.0008027553558349609
r_  generation:  0.008086442947387695
local_output_nid generation:  0.0007507801055908203
local_in_edges_tensor generation:  0.0004420280456542969
mini_batch_src_global generation:  0.0008611679077148438
r_  generation:  0.009113073348999023
local_output_nid generation:  0.0007722377777099609
local_in_edges_tensor generation:  0.003997087478637695
mini_batch_src_global generation:  0.001047372817993164
r_  generation:  0.008105754852294922
local_output_nid generation:  0.0008203983306884766
local_in_edges_tensor generation:  0.0004725456237792969
mini_batch_src_global generation:  0.0009033679962158203
r_  generation:  0.008103609085083008
local_output_nid generation:  0.0008091926574707031
local_in_edges_tensor generation:  0.0004572868347167969
mini_batch_src_global generation:  0.0008485317230224609
r_  generation:  0.0080718994140625
----------------------check_connections_block total spend ----------------------------- 0.41408705711364746
generate_one_block  0.013456583023071289
generate_one_block  0.013126134872436523
generate_one_block  0.012766361236572266
generate_one_block  0.012929439544677734
generate_one_block  0.012477874755859375
generate_one_block  0.012589216232299805
generate_one_block  0.012983560562133789
generate_one_block  0.012525320053100586
generate_one_block  0.013036012649536133
generate_one_block  0.012932300567626953
generate_one_block  0.013366222381591797
generate_one_block  0.013061761856079102
generate_one_block  0.012691259384155273
generate_one_block  0.012502908706665039
generate_one_block  0.013131856918334961
generate_one_block  0.01246953010559082
generate_one_block  0.01254892349243164
generate_one_block  0.013124704360961914
generate_one_block  0.012876272201538086
generate_one_block  0.013152122497558594
generate_one_block  0.01292872428894043
generate_one_block  0.012593269348144531
generate_one_block  0.012724161148071289
generate_one_block  0.013248920440673828
generate_one_block  0.013367414474487305
generate_one_block  0.01304316520690918
generate_one_block  0.012629508972167969
generate_one_block  0.012877941131591797
generate_one_block  0.013355731964111328
generate_one_block  0.012930631637573242
generate_one_block  0.013262033462524414
generate_one_block  0.012908935546875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03961300849914551
gen group dst list time:  0.023223161697387695
time for parepare:  0.018651723861694336
local_output_nid generation:  0.0037038326263427734
local_in_edges_tensor generation:  0.012184381484985352
mini_batch_src_global generation:  0.013403892517089844
r_  generation:  0.1144864559173584
local_output_nid generation:  0.006170034408569336
local_in_edges_tensor generation:  0.008414268493652344
mini_batch_src_global generation:  0.015640735626220703
r_  generation:  0.1226041316986084
local_output_nid generation:  0.006387948989868164
local_in_edges_tensor generation:  0.007252931594848633
mini_batch_src_global generation:  0.013160228729248047
r_  generation:  0.12180685997009277
local_output_nid generation:  0.006341695785522461
local_in_edges_tensor generation:  0.008698225021362305
mini_batch_src_global generation:  0.01517486572265625
r_  generation:  0.12732887268066406
local_output_nid generation:  0.006285190582275391
local_in_edges_tensor generation:  0.0064144134521484375
mini_batch_src_global generation:  0.014695882797241211
r_  generation:  0.12558245658874512
local_output_nid generation:  0.006335735321044922
local_in_edges_tensor generation:  0.00789499282836914
mini_batch_src_global generation:  0.01486968994140625
r_  generation:  0.12513303756713867
local_output_nid generation:  0.006669044494628906
local_in_edges_tensor generation:  0.008917808532714844
mini_batch_src_global generation:  0.015649080276489258
r_  generation:  0.13039922714233398
local_output_nid generation:  0.006561279296875
local_in_edges_tensor generation:  0.006644248962402344
mini_batch_src_global generation:  0.015257596969604492
r_  generation:  0.12634849548339844
local_output_nid generation:  0.006715297698974609
local_in_edges_tensor generation:  0.006860256195068359
mini_batch_src_global generation:  0.016636133193969727
r_  generation:  0.13065075874328613
local_output_nid generation:  0.006517648696899414
local_in_edges_tensor generation:  0.007649898529052734
mini_batch_src_global generation:  0.019215822219848633
r_  generation:  0.1255955696105957
local_output_nid generation:  0.00682520866394043
local_in_edges_tensor generation:  0.010101556777954102
mini_batch_src_global generation:  0.01915287971496582
r_  generation:  0.1336972713470459
local_output_nid generation:  0.006807804107666016
local_in_edges_tensor generation:  0.007901906967163086
mini_batch_src_global generation:  0.01580667495727539
r_  generation:  0.12955689430236816
local_output_nid generation:  0.006727933883666992
local_in_edges_tensor generation:  0.006577253341674805
mini_batch_src_global generation:  0.016506195068359375
r_  generation:  0.13231205940246582
local_output_nid generation:  0.006689310073852539
local_in_edges_tensor generation:  0.00671839714050293
mini_batch_src_global generation:  0.015532732009887695
r_  generation:  0.1272878646850586
local_output_nid generation:  0.00700068473815918
local_in_edges_tensor generation:  0.007784843444824219
mini_batch_src_global generation:  0.016106843948364258
r_  generation:  0.1348254680633545
local_output_nid generation:  0.006693363189697266
local_in_edges_tensor generation:  0.006828784942626953
mini_batch_src_global generation:  0.01558995246887207
r_  generation:  0.12796330451965332
local_output_nid generation:  0.006807565689086914
local_in_edges_tensor generation:  0.008005142211914062
mini_batch_src_global generation:  0.015382766723632812
r_  generation:  0.13199830055236816
local_output_nid generation:  0.007002592086791992
local_in_edges_tensor generation:  0.008072853088378906
mini_batch_src_global generation:  0.01724553108215332
r_  generation:  0.1362290382385254
local_output_nid generation:  0.006985187530517578
local_in_edges_tensor generation:  0.007937908172607422
mini_batch_src_global generation:  0.015902280807495117
r_  generation:  0.13163089752197266
local_output_nid generation:  0.007015705108642578
local_in_edges_tensor generation:  0.008255243301391602
mini_batch_src_global generation:  0.0162351131439209
r_  generation:  0.13295459747314453
local_output_nid generation:  0.006944894790649414
local_in_edges_tensor generation:  0.010242938995361328
mini_batch_src_global generation:  0.016518354415893555
r_  generation:  0.13550567626953125
local_output_nid generation:  0.006968498229980469
local_in_edges_tensor generation:  0.008071184158325195
mini_batch_src_global generation:  0.015887022018432617
r_  generation:  0.13101887702941895
local_output_nid generation:  0.006998300552368164
local_in_edges_tensor generation:  0.007120609283447266
mini_batch_src_global generation:  0.01566338539123535
r_  generation:  0.13272309303283691
local_output_nid generation:  0.007064104080200195
local_in_edges_tensor generation:  0.009207963943481445
mini_batch_src_global generation:  0.017122745513916016
r_  generation:  0.13411998748779297
local_output_nid generation:  0.007108449935913086
local_in_edges_tensor generation:  0.008329391479492188
mini_batch_src_global generation:  0.016155004501342773
r_  generation:  0.13468027114868164
local_output_nid generation:  0.007102012634277344
local_in_edges_tensor generation:  0.009148359298706055
mini_batch_src_global generation:  0.01671767234802246
r_  generation:  0.1337902545928955
local_output_nid generation:  0.0069179534912109375
local_in_edges_tensor generation:  0.008056163787841797
mini_batch_src_global generation:  0.015825271606445312
r_  generation:  0.13442158699035645
local_output_nid generation:  0.007024288177490234
local_in_edges_tensor generation:  0.0071680545806884766
mini_batch_src_global generation:  0.017003536224365234
r_  generation:  0.13167548179626465
local_output_nid generation:  0.0071713924407958984
local_in_edges_tensor generation:  0.009452104568481445
mini_batch_src_global generation:  0.02025890350341797
r_  generation:  0.1382741928100586
local_output_nid generation:  0.006989240646362305
local_in_edges_tensor generation:  0.007224321365356445
mini_batch_src_global generation:  0.01620960235595703
r_  generation:  0.1349349021911621
local_output_nid generation:  0.007238149642944336
local_in_edges_tensor generation:  0.010100126266479492
mini_batch_src_global generation:  0.01738572120666504
r_  generation:  0.13831496238708496
local_output_nid generation:  0.007967710494995117
local_in_edges_tensor generation:  0.012568473815917969
mini_batch_src_global generation:  0.01643681526184082
r_  generation:  0.1436293125152588
----------------------check_connections_block total spend ----------------------------- 6.216293573379517
generate_one_block  0.1659395694732666
generate_one_block  0.16153812408447266
generate_one_block  0.17804527282714844
generate_one_block  0.16804122924804688
generate_one_block  0.15825319290161133
generate_one_block  0.16291260719299316
generate_one_block  0.16925907135009766
generate_one_block  0.15757250785827637
generate_one_block  0.16650795936584473
generate_one_block  0.15577435493469238
generate_one_block  0.17211699485778809
generate_one_block  0.15896105766296387
generate_one_block  0.15951180458068848
generate_one_block  0.1584336757659912
generate_one_block  0.17152953147888184
generate_one_block  0.18035316467285156
generate_one_block  0.15671777725219727
generate_one_block  0.17326664924621582
generate_one_block  0.1626448631286621
generate_one_block  0.16829633712768555
generate_one_block  0.16881465911865234
generate_one_block  0.1629798412322998
generate_one_block  0.16077208518981934
generate_one_block  0.1703627109527588
generate_one_block  0.1717386245727539
generate_one_block  0.16835451126098633
generate_one_block  0.1621568202972412
generate_one_block  0.1645064353942871
generate_one_block  0.1716160774230957
generate_one_block  0.17389440536499023
generate_one_block  0.17398524284362793
generate_one_block  0.16362214088439941
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.08499431610107422
gen group dst list time:  0.10525012016296387
time for parepare:  0.020367145538330078
local_output_nid generation:  0.020421981811523438
local_in_edges_tensor generation:  0.05097246170043945
mini_batch_src_global generation:  0.03905296325683594
r_  generation:  0.37823963165283203
local_output_nid generation:  0.02630758285522461
local_in_edges_tensor generation:  0.03728818893432617
mini_batch_src_global generation:  0.04769730567932129
r_  generation:  0.3859381675720215
local_output_nid generation:  0.02629709243774414
local_in_edges_tensor generation:  0.0302431583404541
mini_batch_src_global generation:  0.04489016532897949
r_  generation:  0.3912045955657959
local_output_nid generation:  0.02519702911376953
local_in_edges_tensor generation:  0.031029939651489258
mini_batch_src_global generation:  0.057679176330566406
r_  generation:  0.39293432235717773
local_output_nid generation:  0.024854183197021484
local_in_edges_tensor generation:  0.03092050552368164
mini_batch_src_global generation:  0.045861005783081055
r_  generation:  0.41384100914001465
local_output_nid generation:  0.024936914443969727
local_in_edges_tensor generation:  0.02353072166442871
mini_batch_src_global generation:  0.04651975631713867
r_  generation:  0.3899552822113037
local_output_nid generation:  0.025129318237304688
local_in_edges_tensor generation:  0.024033069610595703
mini_batch_src_global generation:  0.046788930892944336
r_  generation:  0.3987002372741699
local_output_nid generation:  0.024913549423217773
local_in_edges_tensor generation:  0.030889511108398438
mini_batch_src_global generation:  0.04674053192138672
r_  generation:  0.38945913314819336
local_output_nid generation:  0.02490091323852539
local_in_edges_tensor generation:  0.031037092208862305
mini_batch_src_global generation:  0.048783302307128906
r_  generation:  0.3985626697540283
local_output_nid generation:  0.02480173110961914
local_in_edges_tensor generation:  0.023882389068603516
mini_batch_src_global generation:  0.04644298553466797
r_  generation:  0.3876495361328125
local_output_nid generation:  0.02517867088317871
local_in_edges_tensor generation:  0.0240018367767334
mini_batch_src_global generation:  0.04648900032043457
r_  generation:  0.40875935554504395
local_output_nid generation:  0.02533435821533203
local_in_edges_tensor generation:  0.0345463752746582
mini_batch_src_global generation:  0.04731297492980957
r_  generation:  0.39510607719421387
local_output_nid generation:  0.025420665740966797
local_in_edges_tensor generation:  0.024159908294677734
mini_batch_src_global generation:  0.04658818244934082
r_  generation:  0.3988823890686035
local_output_nid generation:  0.025354385375976562
local_in_edges_tensor generation:  0.02733612060546875
mini_batch_src_global generation:  0.04645180702209473
r_  generation:  0.395585298538208
local_output_nid generation:  0.025204181671142578
local_in_edges_tensor generation:  0.0349726676940918
mini_batch_src_global generation:  0.04940485954284668
r_  generation:  0.40291547775268555
local_output_nid generation:  0.025130748748779297
local_in_edges_tensor generation:  0.024095773696899414
mini_batch_src_global generation:  0.046588897705078125
r_  generation:  0.39225292205810547
local_output_nid generation:  0.02500462532043457
local_in_edges_tensor generation:  0.024255037307739258
mini_batch_src_global generation:  0.049495697021484375
r_  generation:  0.3994574546813965
local_output_nid generation:  0.026439905166625977
local_in_edges_tensor generation:  0.030485153198242188
mini_batch_src_global generation:  0.050127267837524414
r_  generation:  0.40039491653442383
local_output_nid generation:  0.02545642852783203
local_in_edges_tensor generation:  0.02769303321838379
mini_batch_src_global generation:  0.04681277275085449
r_  generation:  0.39797234535217285
local_output_nid generation:  0.02539849281311035
local_in_edges_tensor generation:  0.024511098861694336
mini_batch_src_global generation:  0.047598838806152344
r_  generation:  0.4503772258758545
local_output_nid generation:  0.027287006378173828
local_in_edges_tensor generation:  0.031188488006591797
mini_batch_src_global generation:  0.04949688911437988
r_  generation:  0.4115478992462158
local_output_nid generation:  0.02582550048828125
local_in_edges_tensor generation:  0.035443782806396484
mini_batch_src_global generation:  0.04666328430175781
r_  generation:  0.4016726016998291
local_output_nid generation:  0.0262758731842041
local_in_edges_tensor generation:  0.029410123825073242
mini_batch_src_global generation:  0.061699628829956055
r_  generation:  0.4158303737640381
local_output_nid generation:  0.027345895767211914
local_in_edges_tensor generation:  0.031683921813964844
mini_batch_src_global generation:  0.04953169822692871
r_  generation:  0.4134814739227295
local_output_nid generation:  0.026415348052978516
local_in_edges_tensor generation:  0.03171181678771973
mini_batch_src_global generation:  0.046972036361694336
r_  generation:  0.4068577289581299
local_output_nid generation:  0.026512861251831055
local_in_edges_tensor generation:  0.03164410591125488
mini_batch_src_global generation:  0.049674272537231445
r_  generation:  0.4038057327270508
local_output_nid generation:  0.02715778350830078
local_in_edges_tensor generation:  0.029873132705688477
mini_batch_src_global generation:  0.04634523391723633
r_  generation:  0.43302297592163086
local_output_nid generation:  0.02865743637084961
local_in_edges_tensor generation:  0.03026413917541504
mini_batch_src_global generation:  0.04928779602050781
r_  generation:  0.4014871120452881
local_output_nid generation:  0.026992321014404297
local_in_edges_tensor generation:  0.037361860275268555
mini_batch_src_global generation:  0.04716086387634277
r_  generation:  0.4170188903808594
local_output_nid generation:  0.02654290199279785
local_in_edges_tensor generation:  0.03498244285583496
mini_batch_src_global generation:  0.04705691337585449
r_  generation:  0.4033632278442383
local_output_nid generation:  0.02688884735107422
local_in_edges_tensor generation:  0.02816939353942871
mini_batch_src_global generation:  0.050164222717285156
r_  generation:  0.42423009872436523
local_output_nid generation:  0.026606082916259766
local_in_edges_tensor generation:  0.024257898330688477
mini_batch_src_global generation:  0.05155372619628906
r_  generation:  0.4045381546020508
----------------------check_connections_block total spend ----------------------------- 19.074626922607422
generate_one_block  0.6119499206542969
generate_one_block  0.5235729217529297
generate_one_block  0.5284795761108398
generate_one_block  0.5237033367156982
generate_one_block  0.5056517124176025
generate_one_block  0.504702091217041
generate_one_block  0.5103986263275146
generate_one_block  0.510805606842041
generate_one_block  0.5101497173309326
generate_one_block  0.49908876419067383
generate_one_block  0.530982255935669
generate_one_block  0.5176346302032471
generate_one_block  0.5052964687347412
generate_one_block  0.5103664398193359
generate_one_block  0.5654520988464355
generate_one_block  0.5063953399658203
generate_one_block  0.5359673500061035
generate_one_block  0.5288097858428955
generate_one_block  0.513007640838623
generate_one_block  0.5082848072052002
generate_one_block  0.5333104133605957
generate_one_block  0.5095741748809814
generate_one_block  0.5282788276672363
generate_one_block  0.5473635196685791
generate_one_block  0.5328967571258545
generate_one_block  0.518639087677002
generate_one_block  0.5123858451843262
generate_one_block  0.5114924907684326
generate_one_block  0.5255179405212402
generate_one_block  0.5166075229644775
generate_one_block  0.5272996425628662
generate_one_block  0.53706955909729
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

connection checking time:  25.29092049598694
block generation total time  22.06961417198181
average batch blocks generation time:  0.6896754428744316
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1717529296875 GB
    Memory Allocated: 0.08345651626586914  GigaBytes
Max Memory Allocated: 0.08345651626586914  GigaBytes

torch.Size([146093, 128])
torch.Size([99866, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2694091796875 GB
    Memory Allocated: 10.893198490142822  GigaBytes
Max Memory Allocated: 10.900042057037354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2772216796875 GB
    Memory Allocated: 0.08361148834228516  GigaBytes
Max Memory Allocated: 10.900042057037354  GigaBytes

torch.Size([144938, 128])
torch.Size([98939, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.5096435546875 GB
    Memory Allocated: 10.929152965545654  GigaBytes
Max Memory Allocated: 10.936553001403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.5096435546875 GB
    Memory Allocated: 0.08338308334350586  GigaBytes
Max Memory Allocated: 10.936553001403809  GigaBytes

torch.Size([144803, 128])
torch.Size([98271, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.5780029296875 GB
    Memory Allocated: 10.79896879196167  GigaBytes
Max Memory Allocated: 10.936553001403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.5799560546875 GB
    Memory Allocated: 0.08490610122680664  GigaBytes
Max Memory Allocated: 10.936553001403809  GigaBytes

torch.Size([145538, 128])
torch.Size([99795, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3280029296875 GB
    Memory Allocated: 11.038112163543701  GigaBytes
Max Memory Allocated: 11.045536041259766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3280029296875 GB
    Memory Allocated: 0.08350467681884766  GigaBytes
Max Memory Allocated: 11.045536041259766  GigaBytes

torch.Size([144960, 128])
torch.Size([98495, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3280029296875 GB
    Memory Allocated: 10.91218376159668  GigaBytes
Max Memory Allocated: 11.045536041259766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3280029296875 GB
    Memory Allocated: 0.0836338996887207  GigaBytes
Max Memory Allocated: 11.045536041259766  GigaBytes

torch.Size([145463, 128])
torch.Size([98215, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3280029296875 GB
    Memory Allocated: 10.793947696685791  GigaBytes
Max Memory Allocated: 11.045536041259766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3280029296875 GB
    Memory Allocated: 0.08478355407714844  GigaBytes
Max Memory Allocated: 11.045536041259766  GigaBytes

torch.Size([145560, 128])
torch.Size([99328, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3280029296875 GB
    Memory Allocated: 10.91544485092163  GigaBytes
Max Memory Allocated: 11.045536041259766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3280029296875 GB
    Memory Allocated: 0.08379220962524414  GigaBytes
Max Memory Allocated: 11.045536041259766  GigaBytes

torch.Size([145737, 128])
torch.Size([98704, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3280029296875 GB
    Memory Allocated: 10.778163433074951  GigaBytes
Max Memory Allocated: 11.045536041259766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3280029296875 GB
    Memory Allocated: 0.08347654342651367  GigaBytes
Max Memory Allocated: 11.045536041259766  GigaBytes

torch.Size([144717, 128])
torch.Size([98729, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3280029296875 GB
    Memory Allocated: 10.899725914001465  GigaBytes
Max Memory Allocated: 11.045536041259766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3280029296875 GB
    Memory Allocated: 0.0832509994506836  GigaBytes
Max Memory Allocated: 11.045536041259766  GigaBytes

torch.Size([144794, 128])
torch.Size([97569, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3280029296875 GB
    Memory Allocated: 10.696175575256348  GigaBytes
Max Memory Allocated: 11.045536041259766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3280029296875 GB
    Memory Allocated: 0.0858306884765625  GigaBytes
Max Memory Allocated: 11.045536041259766  GigaBytes

torch.Size([145467, 128])
torch.Size([99606, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3280029296875 GB
    Memory Allocated: 10.980609893798828  GigaBytes
Max Memory Allocated: 11.045536041259766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3280029296875 GB
    Memory Allocated: 0.08366012573242188  GigaBytes
Max Memory Allocated: 11.045536041259766  GigaBytes

torch.Size([145224, 128])
torch.Size([99103, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3280029296875 GB
    Memory Allocated: 10.880019664764404  GigaBytes
Max Memory Allocated: 11.045536041259766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3280029296875 GB
    Memory Allocated: 0.08362960815429688  GigaBytes
Max Memory Allocated: 11.045536041259766  GigaBytes

torch.Size([145206, 128])
torch.Size([98610, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3280029296875 GB
    Memory Allocated: 10.85289192199707  GigaBytes
Max Memory Allocated: 11.045536041259766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3280029296875 GB
    Memory Allocated: 0.08365869522094727  GigaBytes
Max Memory Allocated: 11.045536041259766  GigaBytes

torch.Size([145391, 128])
torch.Size([98618, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3280029296875 GB
    Memory Allocated: 10.806131362915039  GigaBytes
Max Memory Allocated: 11.045536041259766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3280029296875 GB
    Memory Allocated: 0.08584165573120117  GigaBytes
Max Memory Allocated: 11.045536041259766  GigaBytes

torch.Size([145411, 128])
torch.Size([99294, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3280029296875 GB
    Memory Allocated: 11.023355484008789  GigaBytes
Max Memory Allocated: 11.045536041259766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3280029296875 GB
    Memory Allocated: 0.08351373672485352  GigaBytes
Max Memory Allocated: 11.045536041259766  GigaBytes

torch.Size([145269, 128])
torch.Size([97977, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3280029296875 GB
    Memory Allocated: 10.74833869934082  GigaBytes
Max Memory Allocated: 11.045536041259766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3280029296875 GB
    Memory Allocated: 0.08331584930419922  GigaBytes
Max Memory Allocated: 11.045536041259766  GigaBytes

torch.Size([144760, 128])
torch.Size([97870, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3280029296875 GB
    Memory Allocated: 10.780666828155518  GigaBytes
Max Memory Allocated: 11.045536041259766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3280029296875 GB
    Memory Allocated: 0.08500194549560547  GigaBytes
Max Memory Allocated: 11.045536041259766  GigaBytes

torch.Size([145666, 128])
torch.Size([100036, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9295654296875 GB
    Memory Allocated: 11.110145092010498  GigaBytes
Max Memory Allocated: 11.118666648864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9295654296875 GB
    Memory Allocated: 0.08465385437011719  GigaBytes
Max Memory Allocated: 11.118666648864746  GigaBytes

torch.Size([145755, 128])
torch.Size([98804, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9295654296875 GB
    Memory Allocated: 10.80992317199707  GigaBytes
Max Memory Allocated: 11.118666648864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9295654296875 GB
    Memory Allocated: 0.08370065689086914  GigaBytes
Max Memory Allocated: 11.118666648864746  GigaBytes

torch.Size([145289, 128])
torch.Size([98912, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9295654296875 GB
    Memory Allocated: 10.87750244140625  GigaBytes
Max Memory Allocated: 11.118666648864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9295654296875 GB
    Memory Allocated: 0.08474397659301758  GigaBytes
Max Memory Allocated: 11.118666648864746  GigaBytes

torch.Size([145215, 128])
torch.Size([99149, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9295654296875 GB
    Memory Allocated: 11.009131908416748  GigaBytes
Max Memory Allocated: 11.118666648864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9295654296875 GB
    Memory Allocated: 0.08378982543945312  GigaBytes
Max Memory Allocated: 11.118666648864746  GigaBytes

torch.Size([145500, 128])
torch.Size([98675, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9295654296875 GB
    Memory Allocated: 10.866357803344727  GigaBytes
Max Memory Allocated: 11.118666648864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9295654296875 GB
    Memory Allocated: 0.08474540710449219  GigaBytes
Max Memory Allocated: 11.118666648864746  GigaBytes

torch.Size([145769, 128])
torch.Size([99418, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9295654296875 GB
    Memory Allocated: 10.904447078704834  GigaBytes
Max Memory Allocated: 11.118666648864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9295654296875 GB
    Memory Allocated: 0.08472919464111328  GigaBytes
Max Memory Allocated: 11.118666648864746  GigaBytes

torch.Size([145148, 128])
torch.Size([99389, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9295654296875 GB
    Memory Allocated: 11.036128520965576  GigaBytes
Max Memory Allocated: 11.118666648864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9295654296875 GB
    Memory Allocated: 0.08482074737548828  GigaBytes
Max Memory Allocated: 11.118666648864746  GigaBytes

torch.Size([145487, 128])
torch.Size([98969, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9295654296875 GB
    Memory Allocated: 10.993471622467041  GigaBytes
Max Memory Allocated: 11.118666648864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9295654296875 GB
    Memory Allocated: 0.08480358123779297  GigaBytes
Max Memory Allocated: 11.118666648864746  GigaBytes

torch.Size([145313, 128])
torch.Size([99515, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9295654296875 GB
    Memory Allocated: 11.05478286743164  GigaBytes
Max Memory Allocated: 11.118666648864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9295654296875 GB
    Memory Allocated: 0.0847625732421875  GigaBytes
Max Memory Allocated: 11.118666648864746  GigaBytes

torch.Size([145600, 128])
torch.Size([98785, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9295654296875 GB
    Memory Allocated: 10.946435928344727  GigaBytes
Max Memory Allocated: 11.118666648864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9295654296875 GB
    Memory Allocated: 0.08372259140014648  GigaBytes
Max Memory Allocated: 11.118666648864746  GigaBytes

torch.Size([145271, 128])
torch.Size([98915, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9295654296875 GB
    Memory Allocated: 10.889042377471924  GigaBytes
Max Memory Allocated: 11.118666648864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9295654296875 GB
    Memory Allocated: 0.08585405349731445  GigaBytes
Max Memory Allocated: 11.118666648864746  GigaBytes

torch.Size([145782, 128])
torch.Size([100123, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5330810546875 GB
    Memory Allocated: 11.142215728759766  GigaBytes
Max Memory Allocated: 11.1499605178833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5330810546875 GB
    Memory Allocated: 0.08459138870239258  GigaBytes
Max Memory Allocated: 11.1499605178833  GigaBytes

torch.Size([144892, 128])
torch.Size([99035, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5330810546875 GB
    Memory Allocated: 11.023938655853271  GigaBytes
Max Memory Allocated: 11.1499605178833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5330810546875 GB
    Memory Allocated: 0.0858464241027832  GigaBytes
Max Memory Allocated: 11.1499605178833  GigaBytes

torch.Size([145781, 128])
torch.Size([100119, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5330810546875 GB
    Memory Allocated: 11.087587833404541  GigaBytes
Max Memory Allocated: 11.1499605178833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5330810546875 GB
    Memory Allocated: 0.08379316329956055  GigaBytes
Max Memory Allocated: 11.1499605178833  GigaBytes

torch.Size([145303, 128])
torch.Size([99362, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5330810546875 GB
    Memory Allocated: 10.981059551239014  GigaBytes
Max Memory Allocated: 11.1499605178833  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03191812336444855 |0.024795696139335632 |0.24899230897426605 |9.53376293182373e-05 |0.3951184079051018 |0.007990121841430664 |
----------------------------------------------------------pseudo_mini_loss sum 4.955753326416016
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  8570252
Number of first layer input nodes during this epoch:  4651102
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 16.5330810546875 GB
    Memory Allocated: 0.10246133804321289  GigaBytes
Max Memory Allocated: 11.1499605178833  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022907495498657227
range selection method range initialization spend 0.014518499374389648
time for parepare:  0.020749568939208984
local_output_nid generation:  0.001138925552368164
local_in_edges_tensor generation:  0.004737377166748047
mini_batch_src_global generation:  0.0019097328186035156
r_  generation:  0.008759498596191406
local_output_nid generation:  0.0010640621185302734
local_in_edges_tensor generation:  0.0006425380706787109
mini_batch_src_global generation:  0.001535654067993164
r_  generation:  0.00908970832824707
local_output_nid generation:  0.0009849071502685547
local_in_edges_tensor generation:  0.0005826950073242188
mini_batch_src_global generation:  0.0010712146759033203
r_  generation:  0.007964611053466797
local_output_nid generation:  0.000988006591796875
local_in_edges_tensor generation:  0.0006012916564941406
mini_batch_src_global generation:  0.0010037422180175781
r_  generation:  0.009456634521484375
local_output_nid generation:  0.0010137557983398438
local_in_edges_tensor generation:  0.0005807876586914062
mini_batch_src_global generation:  0.0009477138519287109
r_  generation:  0.007921457290649414
local_output_nid generation:  0.0009968280792236328
local_in_edges_tensor generation:  0.0005788803100585938
mini_batch_src_global generation:  0.0009217262268066406
r_  generation:  0.007906198501586914
local_output_nid generation:  0.001004934310913086
local_in_edges_tensor generation:  0.0005731582641601562
mini_batch_src_global generation:  0.0009090900421142578
r_  generation:  0.007993698120117188
local_output_nid generation:  0.0010008811950683594
local_in_edges_tensor generation:  0.0005533695220947266
mini_batch_src_global generation:  0.0009605884552001953
r_  generation:  0.008298873901367188
local_output_nid generation:  0.0009965896606445312
local_in_edges_tensor generation:  0.0005860328674316406
mini_batch_src_global generation:  0.0009815692901611328
r_  generation:  0.009399890899658203
local_output_nid generation:  0.0010318756103515625
local_in_edges_tensor generation:  0.0005474090576171875
mini_batch_src_global generation:  0.0009529590606689453
r_  generation:  0.008107662200927734
local_output_nid generation:  0.0010273456573486328
local_in_edges_tensor generation:  0.0005667209625244141
mini_batch_src_global generation:  0.0011234283447265625
r_  generation:  0.008527278900146484
local_output_nid generation:  0.0010290145874023438
local_in_edges_tensor generation:  0.0005617141723632812
mini_batch_src_global generation:  0.0010416507720947266
r_  generation:  0.007948875427246094
local_output_nid generation:  0.0010340213775634766
local_in_edges_tensor generation:  0.0005605220794677734
mini_batch_src_global generation:  0.0009377002716064453
r_  generation:  0.00832366943359375
local_output_nid generation:  0.0010094642639160156
local_in_edges_tensor generation:  0.0005457401275634766
mini_batch_src_global generation:  0.0009806156158447266
r_  generation:  0.008303642272949219
local_output_nid generation:  0.0010135173797607422
local_in_edges_tensor generation:  0.0005443096160888672
mini_batch_src_global generation:  0.0009517669677734375
r_  generation:  0.008434772491455078
local_output_nid generation:  0.0010128021240234375
local_in_edges_tensor generation:  0.0005509853363037109
mini_batch_src_global generation:  0.000946044921875
r_  generation:  0.008408546447753906
local_output_nid generation:  0.0009987354278564453
local_in_edges_tensor generation:  0.0005409717559814453
mini_batch_src_global generation:  0.0009768009185791016
r_  generation:  0.008366584777832031
local_output_nid generation:  0.0010046958923339844
local_in_edges_tensor generation:  0.0005443096160888672
mini_batch_src_global generation:  0.0009274482727050781
r_  generation:  0.00839996337890625
local_output_nid generation:  0.0009975433349609375
local_in_edges_tensor generation:  0.0005407333374023438
mini_batch_src_global generation:  0.0009148120880126953
r_  generation:  0.008175134658813477
local_output_nid generation:  0.0009851455688476562
local_in_edges_tensor generation:  0.0005314350128173828
mini_batch_src_global generation:  0.0009183883666992188
r_  generation:  0.008054971694946289
local_output_nid generation:  0.0009932518005371094
local_in_edges_tensor generation:  0.0005371570587158203
mini_batch_src_global generation:  0.0009407997131347656
r_  generation:  0.008444547653198242
local_output_nid generation:  0.0009729862213134766
local_in_edges_tensor generation:  0.0005548000335693359
mini_batch_src_global generation:  0.0009672641754150391
r_  generation:  0.008636474609375
local_output_nid generation:  0.0010006427764892578
local_in_edges_tensor generation:  0.0005476474761962891
mini_batch_src_global generation:  0.0009286403656005859
r_  generation:  0.00817251205444336
local_output_nid generation:  0.0009708404541015625
local_in_edges_tensor generation:  0.0005354881286621094
mini_batch_src_global generation:  0.0009481906890869141
r_  generation:  0.008318424224853516
local_output_nid generation:  0.0009768009185791016
local_in_edges_tensor generation:  0.0005495548248291016
mini_batch_src_global generation:  0.0009381771087646484
r_  generation:  0.00836324691772461
local_output_nid generation:  0.000972747802734375
local_in_edges_tensor generation:  0.0005555152893066406
mini_batch_src_global generation:  0.0009224414825439453
r_  generation:  0.008276939392089844
local_output_nid generation:  0.0009734630584716797
local_in_edges_tensor generation:  0.000530242919921875
mini_batch_src_global generation:  0.0008950233459472656
r_  generation:  0.008197546005249023
local_output_nid generation:  0.0009794235229492188
local_in_edges_tensor generation:  0.0005335807800292969
mini_batch_src_global generation:  0.0009396076202392578
r_  generation:  0.008160114288330078
local_output_nid generation:  0.000988006591796875
local_in_edges_tensor generation:  0.0005297660827636719
mini_batch_src_global generation:  0.0009214878082275391
r_  generation:  0.00826263427734375
local_output_nid generation:  0.0009658336639404297
local_in_edges_tensor generation:  0.0005488395690917969
mini_batch_src_global generation:  0.0012028217315673828
r_  generation:  0.00862264633178711
local_output_nid generation:  0.0009593963623046875
local_in_edges_tensor generation:  0.0005664825439453125
mini_batch_src_global generation:  0.0009181499481201172
r_  generation:  0.008282184600830078
local_output_nid generation:  0.0009596347808837891
local_in_edges_tensor generation:  0.0005297660827636719
mini_batch_src_global generation:  0.0009262561798095703
r_  generation:  0.00818324089050293
----------------------check_connections_block total spend ----------------------------- 0.4486989974975586
generate_one_block  0.022860288619995117
generate_one_block  0.01840686798095703
generate_one_block  0.015703201293945312
generate_one_block  0.01579427719116211
generate_one_block  0.014914274215698242
generate_one_block  0.014624357223510742
generate_one_block  0.014943838119506836
generate_one_block  0.029775381088256836
generate_one_block  0.015824079513549805
generate_one_block  0.014635086059570312
generate_one_block  0.01482844352722168
generate_one_block  0.014258861541748047
generate_one_block  0.014636754989624023
generate_one_block  0.014600992202758789
generate_one_block  0.014616012573242188
generate_one_block  0.014708757400512695
generate_one_block  0.014653205871582031
generate_one_block  0.014496088027954102
generate_one_block  0.014229297637939453
generate_one_block  0.013913631439208984
generate_one_block  0.014532804489135742
generate_one_block  0.014870643615722656
generate_one_block  0.014093875885009766
generate_one_block  0.014322042465209961
generate_one_block  0.014345407485961914
generate_one_block  0.014409542083740234
generate_one_block  0.013996362686157227
generate_one_block  0.014193296432495117
generate_one_block  0.014075040817260742
generate_one_block  0.014938831329345703
generate_one_block  0.014146566390991211
generate_one_block  0.014246940612792969
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03756237030029297
gen group dst list time:  0.021832942962646484
time for parepare:  0.019208192825317383
local_output_nid generation:  0.004426479339599609
local_in_edges_tensor generation:  0.014602184295654297
mini_batch_src_global generation:  0.013450384140014648
r_  generation:  0.11870694160461426
local_output_nid generation:  0.006743192672729492
local_in_edges_tensor generation:  0.007784843444824219
mini_batch_src_global generation:  0.01587963104248047
r_  generation:  0.1264173984527588
local_output_nid generation:  0.00687098503112793
local_in_edges_tensor generation:  0.02518773078918457
mini_batch_src_global generation:  0.013499021530151367
r_  generation:  0.1281280517578125
local_output_nid generation:  0.0072689056396484375
local_in_edges_tensor generation:  0.009136199951171875
mini_batch_src_global generation:  0.014803171157836914
r_  generation:  0.13318705558776855
local_output_nid generation:  0.00760650634765625
local_in_edges_tensor generation:  0.00766754150390625
mini_batch_src_global generation:  0.015088081359863281
r_  generation:  0.1322314739227295
local_output_nid generation:  0.007380962371826172
local_in_edges_tensor generation:  0.007531642913818359
mini_batch_src_global generation:  0.014921426773071289
r_  generation:  0.15878510475158691
local_output_nid generation:  0.011552095413208008
local_in_edges_tensor generation:  0.010435819625854492
mini_batch_src_global generation:  0.01862025260925293
r_  generation:  0.1477811336517334
local_output_nid generation:  0.011885643005371094
local_in_edges_tensor generation:  0.011823892593383789
mini_batch_src_global generation:  0.0188596248626709
r_  generation:  0.14801859855651855
local_output_nid generation:  0.01181650161743164
local_in_edges_tensor generation:  0.011189937591552734
mini_batch_src_global generation:  0.019050121307373047
r_  generation:  0.15044069290161133
local_output_nid generation:  0.011395692825317383
local_in_edges_tensor generation:  0.010839700698852539
mini_batch_src_global generation:  0.018874406814575195
r_  generation:  0.14841055870056152
local_output_nid generation:  0.011913537979125977
local_in_edges_tensor generation:  0.010637760162353516
mini_batch_src_global generation:  0.02013397216796875
r_  generation:  0.15203475952148438
local_output_nid generation:  0.011430740356445312
local_in_edges_tensor generation:  0.010289430618286133
mini_batch_src_global generation:  0.018193721771240234
r_  generation:  0.14407086372375488
local_output_nid generation:  0.012351512908935547
local_in_edges_tensor generation:  0.011213541030883789
mini_batch_src_global generation:  0.01945328712463379
r_  generation:  0.15877366065979004
local_output_nid generation:  0.012081623077392578
local_in_edges_tensor generation:  0.010463476181030273
mini_batch_src_global generation:  0.018835067749023438
r_  generation:  0.15117502212524414
local_output_nid generation:  0.012282371520996094
local_in_edges_tensor generation:  0.010602951049804688
mini_batch_src_global generation:  0.019209623336791992
r_  generation:  0.15360784530639648
local_output_nid generation:  0.012523651123046875
local_in_edges_tensor generation:  0.011973142623901367
mini_batch_src_global generation:  0.021495342254638672
r_  generation:  0.15342235565185547
local_output_nid generation:  0.012613534927368164
local_in_edges_tensor generation:  0.01685643196105957
mini_batch_src_global generation:  0.01947784423828125
r_  generation:  0.1750507354736328
local_output_nid generation:  0.01550436019897461
local_in_edges_tensor generation:  0.01789093017578125
mini_batch_src_global generation:  0.026189565658569336
r_  generation:  0.14845657348632812
local_output_nid generation:  0.011041402816772461
local_in_edges_tensor generation:  0.015568971633911133
mini_batch_src_global generation:  0.01739954948425293
r_  generation:  0.1375586986541748
local_output_nid generation:  0.009279012680053711
local_in_edges_tensor generation:  0.009157419204711914
mini_batch_src_global generation:  0.01655435562133789
r_  generation:  0.1364281177520752
local_output_nid generation:  0.008797168731689453
local_in_edges_tensor generation:  0.010174274444580078
mini_batch_src_global generation:  0.01653146743774414
r_  generation:  0.13964509963989258
local_output_nid generation:  0.008350610733032227
local_in_edges_tensor generation:  0.00785970687866211
mini_batch_src_global generation:  0.018089771270751953
r_  generation:  0.14253926277160645
local_output_nid generation:  0.007995843887329102
local_in_edges_tensor generation:  0.007668018341064453
mini_batch_src_global generation:  0.01647162437438965
r_  generation:  0.18036222457885742
local_output_nid generation:  0.007935523986816406
local_in_edges_tensor generation:  0.007512331008911133
mini_batch_src_global generation:  0.01815056800842285
r_  generation:  0.14134979248046875
local_output_nid generation:  0.008028984069824219
local_in_edges_tensor generation:  0.008599281311035156
mini_batch_src_global generation:  0.016576290130615234
r_  generation:  0.13975119590759277
local_output_nid generation:  0.00808405876159668
local_in_edges_tensor generation:  0.00844717025756836
mini_batch_src_global generation:  0.018039226531982422
r_  generation:  0.14136934280395508
local_output_nid generation:  0.007890462875366211
local_in_edges_tensor generation:  0.007356405258178711
mini_batch_src_global generation:  0.01925945281982422
r_  generation:  0.14043831825256348
local_output_nid generation:  0.008088350296020508
local_in_edges_tensor generation:  0.008245229721069336
mini_batch_src_global generation:  0.01754593849182129
r_  generation:  0.14281702041625977
local_output_nid generation:  0.007946491241455078
local_in_edges_tensor generation:  0.00729680061340332
mini_batch_src_global generation:  0.01660609245300293
r_  generation:  0.1398322582244873
local_output_nid generation:  0.008150577545166016
local_in_edges_tensor generation:  0.00965118408203125
mini_batch_src_global generation:  0.017256736755371094
r_  generation:  0.15408802032470703
local_output_nid generation:  0.007921218872070312
local_in_edges_tensor generation:  0.008122920989990234
mini_batch_src_global generation:  0.016704797744750977
r_  generation:  0.13517212867736816
local_output_nid generation:  0.008164405822753906
local_in_edges_tensor generation:  0.008466005325317383
mini_batch_src_global generation:  0.016979217529296875
r_  generation:  0.13916850090026855
----------------------check_connections_block total spend ----------------------------- 7.004999876022339
generate_one_block  0.18794655799865723
generate_one_block  0.17827582359313965
generate_one_block  0.18240022659301758
generate_one_block  0.1874992847442627
generate_one_block  0.1982715129852295
generate_one_block  0.16650700569152832
generate_one_block  0.1708667278289795
generate_one_block  0.17630720138549805
generate_one_block  0.18285417556762695
generate_one_block  0.17049670219421387
generate_one_block  0.17673397064208984
generate_one_block  0.1709446907043457
generate_one_block  0.17593026161193848
generate_one_block  0.17168068885803223
generate_one_block  0.1827411651611328
generate_one_block  0.18119096755981445
generate_one_block  0.18558192253112793
generate_one_block  0.17276263236999512
generate_one_block  0.17071175575256348
generate_one_block  0.20374560356140137
generate_one_block  0.1877579689025879
generate_one_block  0.18454957008361816
generate_one_block  0.17046165466308594
generate_one_block  0.17660951614379883
generate_one_block  0.1752948760986328
generate_one_block  0.17345809936523438
generate_one_block  0.16901540756225586
generate_one_block  0.1763002872467041
generate_one_block  0.16949224472045898
generate_one_block  0.18964171409606934
generate_one_block  0.17766261100769043
generate_one_block  0.18288207054138184
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0369267463684082
gen group dst list time:  0.10134649276733398
time for parepare:  0.01757335662841797
local_output_nid generation:  0.029573917388916016
local_in_edges_tensor generation:  0.05290675163269043
mini_batch_src_global generation:  0.05312967300415039
r_  generation:  0.39791369438171387
local_output_nid generation:  0.028425931930541992
local_in_edges_tensor generation:  0.03776907920837402
mini_batch_src_global generation:  0.04774975776672363
r_  generation:  0.39832496643066406
local_output_nid generation:  0.028217077255249023
local_in_edges_tensor generation:  0.031847476959228516
mini_batch_src_global generation:  0.04656386375427246
r_  generation:  0.40689516067504883
local_output_nid generation:  0.026968717575073242
local_in_edges_tensor generation:  0.027539730072021484
mini_batch_src_global generation:  0.04814028739929199
r_  generation:  0.4019961357116699
local_output_nid generation:  0.027292251586914062
local_in_edges_tensor generation:  0.031189441680908203
mini_batch_src_global generation:  0.05067610740661621
r_  generation:  0.42019033432006836
local_output_nid generation:  0.02666926383972168
local_in_edges_tensor generation:  0.02400064468383789
mini_batch_src_global generation:  0.047368764877319336
r_  generation:  0.39783453941345215
local_output_nid generation:  0.0269622802734375
local_in_edges_tensor generation:  0.027553319931030273
mini_batch_src_global generation:  0.04813122749328613
r_  generation:  0.40846872329711914
local_output_nid generation:  0.02844095230102539
local_in_edges_tensor generation:  0.031398773193359375
mini_batch_src_global generation:  0.05036807060241699
r_  generation:  0.4117918014526367
local_output_nid generation:  0.027553319931030273
local_in_edges_tensor generation:  0.0391087532043457
mini_batch_src_global generation:  0.04872703552246094
r_  generation:  0.4224405288696289
local_output_nid generation:  0.028382062911987305
local_in_edges_tensor generation:  0.03632712364196777
mini_batch_src_global generation:  0.0657355785369873
r_  generation:  0.39943552017211914
local_output_nid generation:  0.02870011329650879
local_in_edges_tensor generation:  0.03216075897216797
mini_batch_src_global generation:  0.04741525650024414
r_  generation:  0.410106897354126
local_output_nid generation:  0.026891708374023438
local_in_edges_tensor generation:  0.025767087936401367
mini_batch_src_global generation:  0.048941850662231445
r_  generation:  0.3943333625793457
local_output_nid generation:  0.027059078216552734
local_in_edges_tensor generation:  0.031229257583618164
mini_batch_src_global generation:  0.04673361778259277
r_  generation:  0.4015161991119385
local_output_nid generation:  0.026981115341186523
local_in_edges_tensor generation:  0.027179718017578125
mini_batch_src_global generation:  0.04784345626831055
r_  generation:  0.4018418788909912
local_output_nid generation:  0.027963638305664062
local_in_edges_tensor generation:  0.0278778076171875
mini_batch_src_global generation:  0.049947500228881836
r_  generation:  0.4244420528411865
local_output_nid generation:  0.02750396728515625
local_in_edges_tensor generation:  0.024895906448364258
mini_batch_src_global generation:  0.047716379165649414
r_  generation:  0.41041064262390137
local_output_nid generation:  0.027802705764770508
local_in_edges_tensor generation:  0.03200364112854004
mini_batch_src_global generation:  0.05143451690673828
r_  generation:  0.40902185440063477
local_output_nid generation:  0.027233123779296875
local_in_edges_tensor generation:  0.024684667587280273
mini_batch_src_global generation:  0.0583953857421875
r_  generation:  0.3987762928009033
local_output_nid generation:  0.027342796325683594
local_in_edges_tensor generation:  0.027760982513427734
mini_batch_src_global generation:  0.0513615608215332
r_  generation:  0.40419459342956543
local_output_nid generation:  0.027370452880859375
local_in_edges_tensor generation:  0.037313222885131836
mini_batch_src_global generation:  0.04707670211791992
r_  generation:  0.40064334869384766
local_output_nid generation:  0.027865886688232422
local_in_edges_tensor generation:  0.028176546096801758
mini_batch_src_global generation:  0.04727530479431152
r_  generation:  0.40637898445129395
local_output_nid generation:  0.027828216552734375
local_in_edges_tensor generation:  0.03457760810852051
mini_batch_src_global generation:  0.04773235321044922
r_  generation:  0.4073762893676758
local_output_nid generation:  0.027437448501586914
local_in_edges_tensor generation:  0.0276181697845459
mini_batch_src_global generation:  0.046755313873291016
r_  generation:  0.40483593940734863
local_output_nid generation:  0.02761363983154297
local_in_edges_tensor generation:  0.027485370635986328
mini_batch_src_global generation:  0.04735112190246582
r_  generation:  0.4062354564666748
local_output_nid generation:  0.02836894989013672
local_in_edges_tensor generation:  0.028162002563476562
mini_batch_src_global generation:  0.04732537269592285
r_  generation:  0.42232251167297363
local_output_nid generation:  0.028885841369628906
local_in_edges_tensor generation:  0.03188824653625488
mini_batch_src_global generation:  0.04937481880187988
r_  generation:  0.4039115905761719
local_output_nid generation:  0.02731800079345703
local_in_edges_tensor generation:  0.027584314346313477
mini_batch_src_global generation:  0.04662799835205078
r_  generation:  0.40073275566101074
local_output_nid generation:  0.027849912643432617
local_in_edges_tensor generation:  0.03144383430480957
mini_batch_src_global generation:  0.04732775688171387
r_  generation:  0.40404224395751953
local_output_nid generation:  0.027413606643676758
local_in_edges_tensor generation:  0.0276639461517334
mini_batch_src_global generation:  0.046785831451416016
r_  generation:  0.40108680725097656
local_output_nid generation:  0.027846813201904297
local_in_edges_tensor generation:  0.027782440185546875
mini_batch_src_global generation:  0.05020451545715332
r_  generation:  0.4080371856689453
local_output_nid generation:  0.02732086181640625
local_in_edges_tensor generation:  0.027174711227416992
mini_batch_src_global generation:  0.046478986740112305
r_  generation:  0.400470495223999
local_output_nid generation:  0.027672290802001953
local_in_edges_tensor generation:  0.024565696716308594
mini_batch_src_global generation:  0.047765493392944336
r_  generation:  0.40224385261535645
----------------------check_connections_block total spend ----------------------------- 19.305145025253296
generate_one_block  0.5337116718292236
generate_one_block  0.5326526165008545
generate_one_block  0.5341942310333252
generate_one_block  0.5372653007507324
generate_one_block  0.6213474273681641
generate_one_block  0.5171060562133789
generate_one_block  0.5350179672241211
generate_one_block  0.5349161624908447
generate_one_block  0.5543355941772461
generate_one_block  0.518524169921875
generate_one_block  0.5368397235870361
generate_one_block  0.5179803371429443
generate_one_block  0.5322628021240234
generate_one_block  0.5230264663696289
generate_one_block  0.5426619052886963
generate_one_block  0.5163078308105469
generate_one_block  0.5459544658660889
generate_one_block  0.52174973487854
generate_one_block  0.5209848880767822
generate_one_block  0.5311193466186523
generate_one_block  0.5426902770996094
generate_one_block  0.5379726886749268
generate_one_block  0.5213463306427002
generate_one_block  0.536719560623169
generate_one_block  0.555438756942749
generate_one_block  0.5323045253753662
generate_one_block  0.524852991104126
generate_one_block  0.5451767444610596
generate_one_block  0.5315287113189697
generate_one_block  0.5462319850921631
generate_one_block  0.5169322490692139
generate_one_block  0.5363738536834717
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 16.5330810546875 GB
    Memory Allocated: 0.10246133804321289  GigaBytes
Max Memory Allocated: 11.1499605178833  GigaBytes

connection checking time:  26.310144901275635
block generation total time  22.862102270126343
average batch blocks generation time:  0.7144406959414482
block dataloader generation time/epoch 51.74829387664795
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5330810546875 GB
    Memory Allocated: 0.08540010452270508  GigaBytes
Max Memory Allocated: 11.1499605178833  GigaBytes

torch.Size([145150, 128])
torch.Size([99037, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5330810546875 GB
    Memory Allocated: 10.912443161010742  GigaBytes
Max Memory Allocated: 11.1499605178833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5330810546875 GB
    Memory Allocated: 0.08541297912597656  GigaBytes
Max Memory Allocated: 11.1499605178833  GigaBytes

torch.Size([145136, 128])
torch.Size([98855, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5330810546875 GB
    Memory Allocated: 10.902194023132324  GigaBytes
Max Memory Allocated: 11.1499605178833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5330810546875 GB
    Memory Allocated: 0.08750772476196289  GigaBytes
Max Memory Allocated: 11.1499605178833  GigaBytes

torch.Size([145510, 128])
torch.Size([99707, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5330810546875 GB
    Memory Allocated: 11.02908182144165  GigaBytes
Max Memory Allocated: 11.1499605178833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5330810546875 GB
    Memory Allocated: 0.08658885955810547  GigaBytes
Max Memory Allocated: 11.1499605178833  GigaBytes

torch.Size([145410, 128])
torch.Size([99416, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5330810546875 GB
    Memory Allocated: 11.059902667999268  GigaBytes
Max Memory Allocated: 11.1499605178833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5330810546875 GB
    Memory Allocated: 0.08646202087402344  GigaBytes
Max Memory Allocated: 11.1499605178833  GigaBytes

torch.Size([146009, 128])
torch.Size([99399, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5330810546875 GB
    Memory Allocated: 10.902712345123291  GigaBytes
Max Memory Allocated: 11.1499605178833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5330810546875 GB
    Memory Allocated: 0.08490848541259766  GigaBytes
Max Memory Allocated: 11.1499605178833  GigaBytes

torch.Size([144704, 128])
torch.Size([97369, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5330810546875 GB
    Memory Allocated: 10.71806812286377  GigaBytes
Max Memory Allocated: 11.1499605178833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5330810546875 GB
    Memory Allocated: 0.0853414535522461  GigaBytes
Max Memory Allocated: 11.1499605178833  GigaBytes

torch.Size([145198, 128])
torch.Size([98506, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5330810546875 GB
    Memory Allocated: 10.866477489471436  GigaBytes
Max Memory Allocated: 11.1499605178833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5330810546875 GB
    Memory Allocated: 0.0855412483215332  GigaBytes
Max Memory Allocated: 11.1499605178833  GigaBytes

torch.Size([145505, 128])
torch.Size([98984, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5330810546875 GB
    Memory Allocated: 10.903576850891113  GigaBytes
Max Memory Allocated: 11.1499605178833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5330810546875 GB
    Memory Allocated: 0.0875701904296875  GigaBytes
Max Memory Allocated: 11.1499605178833  GigaBytes

torch.Size([146329, 128])
torch.Size([101029, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1385498046875 GB
    Memory Allocated: 11.176892280578613  GigaBytes
Max Memory Allocated: 11.184483051300049  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1385498046875 GB
    Memory Allocated: 0.08539056777954102  GigaBytes
Max Memory Allocated: 11.184483051300049  GigaBytes

torch.Size([145257, 128])
torch.Size([98922, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1385498046875 GB
    Memory Allocated: 10.890851020812988  GigaBytes
Max Memory Allocated: 11.184483051300049  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1385498046875 GB
    Memory Allocated: 0.08752775192260742  GigaBytes
Max Memory Allocated: 11.184483051300049  GigaBytes

torch.Size([146069, 128])
torch.Size([100231, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1385498046875 GB
    Memory Allocated: 11.066690921783447  GigaBytes
Max Memory Allocated: 11.184483051300049  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1385498046875 GB
    Memory Allocated: 0.0851583480834961  GigaBytes
Max Memory Allocated: 11.184483051300049  GigaBytes

torch.Size([145160, 128])
torch.Size([97573, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1385498046875 GB
    Memory Allocated: 10.777765274047852  GigaBytes
Max Memory Allocated: 11.184483051300049  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1385498046875 GB
    Memory Allocated: 0.08548307418823242  GigaBytes
Max Memory Allocated: 11.184483051300049  GigaBytes

torch.Size([145269, 128])
torch.Size([98669, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1385498046875 GB
    Memory Allocated: 10.951416969299316  GigaBytes
Max Memory Allocated: 11.184483051300049  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1385498046875 GB
    Memory Allocated: 0.08525514602661133  GigaBytes
Max Memory Allocated: 11.184483051300049  GigaBytes

torch.Size([144999, 128])
torch.Size([98478, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1385498046875 GB
    Memory Allocated: 10.871164321899414  GigaBytes
Max Memory Allocated: 11.184483051300049  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1385498046875 GB
    Memory Allocated: 0.08752298355102539  GigaBytes
Max Memory Allocated: 11.184483051300049  GigaBytes

torch.Size([145529, 128])
torch.Size([99588, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1385498046875 GB
    Memory Allocated: 11.04712963104248  GigaBytes
Max Memory Allocated: 11.184483051300049  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1385498046875 GB
    Memory Allocated: 0.08566856384277344  GigaBytes
Max Memory Allocated: 11.184483051300049  GigaBytes

torch.Size([145788, 128])
torch.Size([99024, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1385498046875 GB
    Memory Allocated: 10.883951187133789  GigaBytes
Max Memory Allocated: 11.184483051300049  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1385498046875 GB
    Memory Allocated: 0.08754968643188477  GigaBytes
Max Memory Allocated: 11.184483051300049  GigaBytes

torch.Size([145551, 128])
torch.Size([100209, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1385498046875 GB
    Memory Allocated: 11.10823106765747  GigaBytes
Max Memory Allocated: 11.184483051300049  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1385498046875 GB
    Memory Allocated: 0.0852346420288086  GigaBytes
Max Memory Allocated: 11.184483051300049  GigaBytes

torch.Size([144872, 128])
torch.Size([98378, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1385498046875 GB
    Memory Allocated: 10.870527744293213  GigaBytes
Max Memory Allocated: 11.184483051300049  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1385498046875 GB
    Memory Allocated: 0.08633804321289062  GigaBytes
Max Memory Allocated: 11.184483051300049  GigaBytes

torch.Size([145515, 128])
torch.Size([98661, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1385498046875 GB
    Memory Allocated: 10.829607009887695  GigaBytes
Max Memory Allocated: 11.184483051300049  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1385498046875 GB
    Memory Allocated: 0.0852823257446289  GigaBytes
Max Memory Allocated: 11.184483051300049  GigaBytes

torch.Size([145180, 128])
torch.Size([98398, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1385498046875 GB
    Memory Allocated: 10.851358413696289  GigaBytes
Max Memory Allocated: 11.184483051300049  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1385498046875 GB
    Memory Allocated: 0.08547782897949219  GigaBytes
Max Memory Allocated: 11.184483051300049  GigaBytes

torch.Size([145332, 128])
torch.Size([99520, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1385498046875 GB
    Memory Allocated: 10.928255081176758  GigaBytes
Max Memory Allocated: 11.184483051300049  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1385498046875 GB
    Memory Allocated: 0.08665180206298828  GigaBytes
Max Memory Allocated: 11.184483051300049  GigaBytes

torch.Size([145589, 128])
torch.Size([99733, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1385498046875 GB
    Memory Allocated: 11.051229476928711  GigaBytes
Max Memory Allocated: 11.184483051300049  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1385498046875 GB
    Memory Allocated: 0.08526372909545898  GigaBytes
Max Memory Allocated: 11.184483051300049  GigaBytes

torch.Size([145111, 128])
torch.Size([98257, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1385498046875 GB
    Memory Allocated: 10.823997497558594  GigaBytes
Max Memory Allocated: 11.184483051300049  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1385498046875 GB
    Memory Allocated: 0.08568716049194336  GigaBytes
Max Memory Allocated: 11.184483051300049  GigaBytes

torch.Size([145699, 128])
torch.Size([99327, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1385498046875 GB
    Memory Allocated: 10.935973644256592  GigaBytes
Max Memory Allocated: 11.184483051300049  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1385498046875 GB
    Memory Allocated: 0.08550596237182617  GigaBytes
Max Memory Allocated: 11.184483051300049  GigaBytes

torch.Size([145339, 128])
torch.Size([99059, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1385498046875 GB
    Memory Allocated: 11.011294841766357  GigaBytes
Max Memory Allocated: 11.184483051300049  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1385498046875 GB
    Memory Allocated: 0.08527517318725586  GigaBytes
Max Memory Allocated: 11.184483051300049  GigaBytes

torch.Size([144955, 128])
torch.Size([98386, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1385498046875 GB
    Memory Allocated: 10.918508052825928  GigaBytes
Max Memory Allocated: 11.184483051300049  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1385498046875 GB
    Memory Allocated: 0.08518552780151367  GigaBytes
Max Memory Allocated: 11.184483051300049  GigaBytes

torch.Size([145063, 128])
torch.Size([97911, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1385498046875 GB
    Memory Allocated: 10.795459270477295  GigaBytes
Max Memory Allocated: 11.184483051300049  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1385498046875 GB
    Memory Allocated: 0.08688640594482422  GigaBytes
Max Memory Allocated: 11.184483051300049  GigaBytes

torch.Size([146193, 128])
torch.Size([100374, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1385498046875 GB
    Memory Allocated: 10.987339973449707  GigaBytes
Max Memory Allocated: 11.184483051300049  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1385498046875 GB
    Memory Allocated: 0.08631610870361328  GigaBytes
Max Memory Allocated: 11.184483051300049  GigaBytes

torch.Size([145723, 128])
torch.Size([98436, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1385498046875 GB
    Memory Allocated: 10.78010892868042  GigaBytes
Max Memory Allocated: 11.184483051300049  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1385498046875 GB
    Memory Allocated: 0.08664274215698242  GigaBytes
Max Memory Allocated: 11.184483051300049  GigaBytes

torch.Size([145518, 128])
torch.Size([100124, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1385498046875 GB
    Memory Allocated: 11.128677368164062  GigaBytes
Max Memory Allocated: 11.184483051300049  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1385498046875 GB
    Memory Allocated: 0.08633995056152344  GigaBytes
Max Memory Allocated: 11.184483051300049  GigaBytes

torch.Size([145590, 128])
torch.Size([98183, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1385498046875 GB
    Memory Allocated: 10.789222240447998  GigaBytes
Max Memory Allocated: 11.184483051300049  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1385498046875 GB
    Memory Allocated: 0.0856027603149414  GigaBytes
Max Memory Allocated: 11.184483051300049  GigaBytes

torch.Size([145534, 128])
torch.Size([99226, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1385498046875 GB
    Memory Allocated: 11.018263816833496  GigaBytes
Max Memory Allocated: 11.184483051300049  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.033730290830135345 |0.012732766568660736 |0.23272619396448135 |9.259581565856934e-05 |0.32468391954898834 |0.003588438034057617 |
----------------------------------------------------------pseudo_mini_loss sum 3.792710781097412
Total (block generation + training)time/epoch 71.13495182991028
Training time/epoch 19.38637614250183
Training time without block to device /epoch 18.978927612304688
Training time without total dataloading part /epoch 17.843675136566162
load block tensor time/epoch 1.079369306564331
block to device time/epoch 0.40744853019714355
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  8574115
Number of first layer input nodes during this epoch:  4653786
