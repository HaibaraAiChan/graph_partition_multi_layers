Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648506611.9828925
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0029964447021484375  GigaBytes
Max Memory Allocated: 0.0029964447021484375  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.024851322174072266
range selection method range initialization spend 0.013298988342285156
time for parepare:  0.018364906311035156
local_output_nid generation:  0.0007050037384033203
local_in_edges_tensor generation:  0.0034835338592529297
mini_batch_src_global generation:  0.0013246536254882812
r_  generation:  0.008728504180908203
local_output_nid generation:  0.0007581710815429688
local_in_edges_tensor generation:  0.0005457401275634766
mini_batch_src_global generation:  0.0012660026550292969
r_  generation:  0.008222818374633789
local_output_nid generation:  0.0007128715515136719
local_in_edges_tensor generation:  0.00048160552978515625
mini_batch_src_global generation:  0.0008263587951660156
r_  generation:  0.007809877395629883
local_output_nid generation:  0.0007255077362060547
local_in_edges_tensor generation:  0.0004706382751464844
mini_batch_src_global generation:  0.0007681846618652344
r_  generation:  0.007753133773803711
local_output_nid generation:  0.0007107257843017578
local_in_edges_tensor generation:  0.000453948974609375
mini_batch_src_global generation:  0.0008068084716796875
r_  generation:  0.009024381637573242
local_output_nid generation:  0.0007710456848144531
local_in_edges_tensor generation:  0.0004971027374267578
mini_batch_src_global generation:  0.0008683204650878906
r_  generation:  0.00787353515625
local_output_nid generation:  0.0007348060607910156
local_in_edges_tensor generation:  0.0004582405090332031
mini_batch_src_global generation:  0.0007808208465576172
r_  generation:  0.008077859878540039
local_output_nid generation:  0.0007374286651611328
local_in_edges_tensor generation:  0.0004572868347167969
mini_batch_src_global generation:  0.0008728504180908203
r_  generation:  0.007974624633789062
local_output_nid generation:  0.0007152557373046875
local_in_edges_tensor generation:  0.0004506111145019531
mini_batch_src_global generation:  0.0007624626159667969
r_  generation:  0.00791311264038086
local_output_nid generation:  0.0007185935974121094
local_in_edges_tensor generation:  0.0004494190216064453
mini_batch_src_global generation:  0.0007605552673339844
r_  generation:  0.008037567138671875
local_output_nid generation:  0.000713348388671875
local_in_edges_tensor generation:  0.00045561790466308594
mini_batch_src_global generation:  0.0008966922760009766
r_  generation:  0.007921218872070312
local_output_nid generation:  0.0007364749908447266
local_in_edges_tensor generation:  0.0004761219024658203
mini_batch_src_global generation:  0.00081634521484375
r_  generation:  0.008168220520019531
local_output_nid generation:  0.0007169246673583984
local_in_edges_tensor generation:  0.0004532337188720703
mini_batch_src_global generation:  0.0007917881011962891
r_  generation:  0.008249044418334961
local_output_nid generation:  0.0007147789001464844
local_in_edges_tensor generation:  0.0004532337188720703
mini_batch_src_global generation:  0.0007789134979248047
r_  generation:  0.008042097091674805
local_output_nid generation:  0.0007152557373046875
local_in_edges_tensor generation:  0.00044918060302734375
mini_batch_src_global generation:  0.0007824897766113281
r_  generation:  0.008086919784545898
local_output_nid generation:  0.0007171630859375
local_in_edges_tensor generation:  0.0004546642303466797
mini_batch_src_global generation:  0.0007958412170410156
r_  generation:  0.008105039596557617
local_output_nid generation:  0.0007431507110595703
local_in_edges_tensor generation:  0.0004763603210449219
mini_batch_src_global generation:  0.0008535385131835938
r_  generation:  0.008464574813842773
local_output_nid generation:  0.0007140636444091797
local_in_edges_tensor generation:  0.0004477500915527344
mini_batch_src_global generation:  0.0008082389831542969
r_  generation:  0.008212804794311523
local_output_nid generation:  0.0007221698760986328
local_in_edges_tensor generation:  0.00045108795166015625
mini_batch_src_global generation:  0.0007987022399902344
r_  generation:  0.00807046890258789
local_output_nid generation:  0.0007090568542480469
local_in_edges_tensor generation:  0.00044155120849609375
mini_batch_src_global generation:  0.0007710456848144531
r_  generation:  0.007894039154052734
local_output_nid generation:  0.0007231235504150391
local_in_edges_tensor generation:  0.00045013427734375
mini_batch_src_global generation:  0.0008087158203125
r_  generation:  0.00827479362487793
local_output_nid generation:  0.0007116794586181641
local_in_edges_tensor generation:  0.0004572868347167969
mini_batch_src_global generation:  0.0008330345153808594
r_  generation:  0.007961273193359375
local_output_nid generation:  0.0007672309875488281
local_in_edges_tensor generation:  0.0004563331604003906
mini_batch_src_global generation:  0.0009222030639648438
r_  generation:  0.008088827133178711
local_output_nid generation:  0.0007252693176269531
local_in_edges_tensor generation:  0.00045180320739746094
mini_batch_src_global generation:  0.0008082389831542969
r_  generation:  0.00812220573425293
local_output_nid generation:  0.0007219314575195312
local_in_edges_tensor generation:  0.0004534721374511719
mini_batch_src_global generation:  0.0009334087371826172
r_  generation:  0.008145570755004883
local_output_nid generation:  0.000720977783203125
local_in_edges_tensor generation:  0.0004467964172363281
mini_batch_src_global generation:  0.0007963180541992188
r_  generation:  0.00815582275390625
local_output_nid generation:  0.00072479248046875
local_in_edges_tensor generation:  0.00046372413635253906
mini_batch_src_global generation:  0.0009882450103759766
r_  generation:  0.008237600326538086
local_output_nid generation:  0.0007562637329101562
local_in_edges_tensor generation:  0.0004546642303466797
mini_batch_src_global generation:  0.0007994174957275391
r_  generation:  0.008130788803100586
local_output_nid generation:  0.0007243156433105469
local_in_edges_tensor generation:  0.0004506111145019531
mini_batch_src_global generation:  0.0008215904235839844
r_  generation:  0.008487701416015625
local_output_nid generation:  0.0007379055023193359
local_in_edges_tensor generation:  0.0004584789276123047
mini_batch_src_global generation:  0.0008325576782226562
r_  generation:  0.008368253707885742
local_output_nid generation:  0.0007307529449462891
local_in_edges_tensor generation:  0.004044532775878906
mini_batch_src_global generation:  0.0010159015655517578
r_  generation:  0.008249521255493164
local_output_nid generation:  0.0007724761962890625
local_in_edges_tensor generation:  0.0004792213439941406
mini_batch_src_global generation:  0.0008788108825683594
r_  generation:  0.008194923400878906
----------------------check_connections_block total spend ----------------------------- 0.4159681797027588
generate_one_block  0.01381683349609375
generate_one_block  0.013641119003295898
generate_one_block  0.013315677642822266
generate_one_block  0.013295650482177734
generate_one_block  0.013592243194580078
generate_one_block  0.013182401657104492
generate_one_block  0.013272762298583984
generate_one_block  0.013180971145629883
generate_one_block  0.013111591339111328
generate_one_block  0.013111114501953125
generate_one_block  0.012970924377441406
generate_one_block  0.013392925262451172
generate_one_block  0.013109922409057617
generate_one_block  0.012871503829956055
generate_one_block  0.013133764266967773
generate_one_block  0.012948989868164062
generate_one_block  0.013446807861328125
generate_one_block  0.01318979263305664
generate_one_block  0.012977361679077148
generate_one_block  0.012637615203857422
generate_one_block  0.01338648796081543
generate_one_block  0.012782573699951172
generate_one_block  0.013113975524902344
generate_one_block  0.013329505920410156
generate_one_block  0.013013601303100586
generate_one_block  0.012928962707519531
generate_one_block  0.013274908065795898
generate_one_block  0.012953042984008789
generate_one_block  0.013450145721435547
generate_one_block  0.01343226432800293
generate_one_block  0.013271093368530273
generate_one_block  0.012844085693359375
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.043058156967163086
gen group dst list time:  0.021033763885498047
time for parepare:  0.018878459930419922
local_output_nid generation:  0.0037860870361328125
local_in_edges_tensor generation:  0.011526346206665039
mini_batch_src_global generation:  0.011857271194458008
r_  generation:  0.11803054809570312
local_output_nid generation:  0.006246328353881836
local_in_edges_tensor generation:  0.011499404907226562
mini_batch_src_global generation:  0.015486478805541992
r_  generation:  0.12974834442138672
local_output_nid generation:  0.006676912307739258
local_in_edges_tensor generation:  0.008449316024780273
mini_batch_src_global generation:  0.01410222053527832
r_  generation:  0.13218259811401367
local_output_nid generation:  0.006798505783081055
local_in_edges_tensor generation:  0.010830402374267578
mini_batch_src_global generation:  0.01504826545715332
r_  generation:  0.13246369361877441
local_output_nid generation:  0.006689786911010742
local_in_edges_tensor generation:  0.007718801498413086
mini_batch_src_global generation:  0.015729188919067383
r_  generation:  0.13957452774047852
local_output_nid generation:  0.006607532501220703
local_in_edges_tensor generation:  0.009551763534545898
mini_batch_src_global generation:  0.016021728515625
r_  generation:  0.1356678009033203
local_output_nid generation:  0.006655693054199219
local_in_edges_tensor generation:  0.008768320083618164
mini_batch_src_global generation:  0.01641678810119629
r_  generation:  0.13677382469177246
local_output_nid generation:  0.006670713424682617
local_in_edges_tensor generation:  0.009811878204345703
mini_batch_src_global generation:  0.016483306884765625
r_  generation:  0.13896846771240234
local_output_nid generation:  0.00665736198425293
local_in_edges_tensor generation:  0.007445335388183594
mini_batch_src_global generation:  0.016146421432495117
r_  generation:  0.13598394393920898
local_output_nid generation:  0.006564617156982422
local_in_edges_tensor generation:  0.009260177612304688
mini_batch_src_global generation:  0.015935659408569336
r_  generation:  0.13372159004211426
local_output_nid generation:  0.006734609603881836
local_in_edges_tensor generation:  0.009563922882080078
mini_batch_src_global generation:  0.016108989715576172
r_  generation:  0.13669991493225098
local_output_nid generation:  0.006795406341552734
local_in_edges_tensor generation:  0.008714914321899414
mini_batch_src_global generation:  0.017733097076416016
r_  generation:  0.1363697052001953
local_output_nid generation:  0.006810188293457031
local_in_edges_tensor generation:  0.00858306884765625
mini_batch_src_global generation:  0.016635656356811523
r_  generation:  0.13871312141418457
local_output_nid generation:  0.006798982620239258
local_in_edges_tensor generation:  0.007359027862548828
mini_batch_src_global generation:  0.016199827194213867
r_  generation:  0.13399100303649902
local_output_nid generation:  0.006771564483642578
local_in_edges_tensor generation:  0.009328365325927734
mini_batch_src_global generation:  0.016384601593017578
r_  generation:  0.13953661918640137
local_output_nid generation:  0.006669521331787109
local_in_edges_tensor generation:  0.00741267204284668
mini_batch_src_global generation:  0.016511917114257812
r_  generation:  0.13446640968322754
local_output_nid generation:  0.006967067718505859
local_in_edges_tensor generation:  0.007893562316894531
mini_batch_src_global generation:  0.01799941062927246
r_  generation:  0.1407153606414795
local_output_nid generation:  0.006847381591796875
local_in_edges_tensor generation:  0.00969243049621582
mini_batch_src_global generation:  0.01661992073059082
r_  generation:  0.1411139965057373
local_output_nid generation:  0.0068056583404541016
local_in_edges_tensor generation:  0.008588552474975586
mini_batch_src_global generation:  0.016385316848754883
r_  generation:  0.13618087768554688
local_output_nid generation:  0.006647348403930664
local_in_edges_tensor generation:  0.008318901062011719
mini_batch_src_global generation:  0.016215085983276367
r_  generation:  0.13585257530212402
local_output_nid generation:  0.0069789886474609375
local_in_edges_tensor generation:  0.009900808334350586
mini_batch_src_global generation:  0.01796889305114746
r_  generation:  0.1429140567779541
local_output_nid generation:  0.0068569183349609375
local_in_edges_tensor generation:  0.007519245147705078
mini_batch_src_global generation:  0.01660609245300293
r_  generation:  0.13617801666259766
local_output_nid generation:  0.0068891048431396484
local_in_edges_tensor generation:  0.007750749588012695
mini_batch_src_global generation:  0.016768217086791992
r_  generation:  0.14041662216186523
local_output_nid generation:  0.006841421127319336
local_in_edges_tensor generation:  0.009604454040527344
mini_batch_src_global generation:  0.016674041748046875
r_  generation:  0.13582181930541992
local_output_nid generation:  0.006943464279174805
local_in_edges_tensor generation:  0.008634090423583984
mini_batch_src_global generation:  0.016889572143554688
r_  generation:  0.13677287101745605
local_output_nid generation:  0.006823301315307617
local_in_edges_tensor generation:  0.009861469268798828
mini_batch_src_global generation:  0.016633987426757812
r_  generation:  0.13617181777954102
local_output_nid generation:  0.006909370422363281
local_in_edges_tensor generation:  0.008836507797241211
mini_batch_src_global generation:  0.016849279403686523
r_  generation:  0.13964271545410156
local_output_nid generation:  0.006915092468261719
local_in_edges_tensor generation:  0.00755620002746582
mini_batch_src_global generation:  0.016443490982055664
r_  generation:  0.13996624946594238
local_output_nid generation:  0.0069882869720458984
local_in_edges_tensor generation:  0.009767532348632812
mini_batch_src_global generation:  0.017890214920043945
r_  generation:  0.14435863494873047
local_output_nid generation:  0.007056713104248047
local_in_edges_tensor generation:  0.009018421173095703
mini_batch_src_global generation:  0.01699662208557129
r_  generation:  0.14081645011901855
local_output_nid generation:  0.006879091262817383
local_in_edges_tensor generation:  0.007509708404541016
mini_batch_src_global generation:  0.016927719116210938
r_  generation:  0.13541340827941895
local_output_nid generation:  0.006832122802734375
local_in_edges_tensor generation:  0.007756471633911133
mini_batch_src_global generation:  0.01646256446838379
r_  generation:  0.1389904022216797
----------------------check_connections_block total spend ----------------------------- 6.445768594741821
generate_one_block  0.17200660705566406
generate_one_block  0.17586040496826172
generate_one_block  0.19363021850585938
generate_one_block  0.17578506469726562
generate_one_block  0.18137764930725098
generate_one_block  0.17793679237365723
generate_one_block  0.17435359954833984
generate_one_block  0.17167162895202637
generate_one_block  0.17173981666564941
generate_one_block  0.16556859016418457
generate_one_block  0.17014169692993164
generate_one_block  0.17495274543762207
generate_one_block  0.17441844940185547
generate_one_block  0.16781139373779297
generate_one_block  0.1717841625213623
generate_one_block  0.1685657501220703
generate_one_block  0.18085646629333496
generate_one_block  0.17195963859558105
generate_one_block  0.1698906421661377
generate_one_block  0.16660761833190918
generate_one_block  0.17924189567565918
generate_one_block  0.16694879531860352
generate_one_block  0.1748957633972168
generate_one_block  0.1681230068206787
generate_one_block  0.16942358016967773
generate_one_block  0.16917848587036133
generate_one_block  0.17284679412841797
generate_one_block  0.17259573936462402
generate_one_block  0.18796157836914062
generate_one_block  0.1811966896057129
generate_one_block  0.1708078384399414
generate_one_block  0.17085742950439453
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03940701484680176
gen group dst list time:  0.09557485580444336
time for parepare:  0.019440889358520508
local_output_nid generation:  0.02056288719177246
local_in_edges_tensor generation:  0.03996109962463379
mini_batch_src_global generation:  0.042507171630859375
r_  generation:  0.43032217025756836
local_output_nid generation:  0.030446290969848633
local_in_edges_tensor generation:  0.04336738586425781
mini_batch_src_global generation:  0.05329155921936035
r_  generation:  0.44687652587890625
local_output_nid generation:  0.03008437156677246
local_in_edges_tensor generation:  0.03645920753479004
mini_batch_src_global generation:  0.05261373519897461
r_  generation:  0.44441771507263184
local_output_nid generation:  0.0295257568359375
local_in_edges_tensor generation:  0.040952444076538086
mini_batch_src_global generation:  0.05436134338378906
r_  generation:  0.4539210796356201
local_output_nid generation:  0.029414892196655273
local_in_edges_tensor generation:  0.03256106376647949
mini_batch_src_global generation:  0.05398821830749512
r_  generation:  0.45543694496154785
local_output_nid generation:  0.02950572967529297
local_in_edges_tensor generation:  0.03574728965759277
mini_batch_src_global generation:  0.054882049560546875
r_  generation:  0.4481668472290039
local_output_nid generation:  0.029729366302490234
local_in_edges_tensor generation:  0.027897357940673828
mini_batch_src_global generation:  0.054234981536865234
r_  generation:  0.4491441249847412
local_output_nid generation:  0.02953338623046875
local_in_edges_tensor generation:  0.03213691711425781
mini_batch_src_global generation:  0.05476999282836914
r_  generation:  0.456714391708374
local_output_nid generation:  0.03236269950866699
local_in_edges_tensor generation:  0.031372785568237305
mini_batch_src_global generation:  0.05370140075683594
r_  generation:  0.45101141929626465
local_output_nid generation:  0.029256582260131836
local_in_edges_tensor generation:  0.037207841873168945
mini_batch_src_global generation:  0.05387306213378906
r_  generation:  0.4449496269226074
local_output_nid generation:  0.029810190200805664
local_in_edges_tensor generation:  0.031763553619384766
mini_batch_src_global generation:  0.05333590507507324
r_  generation:  0.4485926628112793
local_output_nid generation:  0.029799938201904297
local_in_edges_tensor generation:  0.03581070899963379
mini_batch_src_global generation:  0.057333946228027344
r_  generation:  0.4494812488555908
local_output_nid generation:  0.030046939849853516
local_in_edges_tensor generation:  0.032862186431884766
mini_batch_src_global generation:  0.05408668518066406
r_  generation:  0.4465651512145996
local_output_nid generation:  0.029804229736328125
local_in_edges_tensor generation:  0.031386613845825195
mini_batch_src_global generation:  0.0539088249206543
r_  generation:  0.4460010528564453
local_output_nid generation:  0.029923439025878906
local_in_edges_tensor generation:  0.027801036834716797
mini_batch_src_global generation:  0.05962014198303223
r_  generation:  0.450333833694458
local_output_nid generation:  0.029659271240234375
local_in_edges_tensor generation:  0.0371701717376709
mini_batch_src_global generation:  0.0552060604095459
r_  generation:  0.4481775760650635
local_output_nid generation:  0.02999567985534668
local_in_edges_tensor generation:  0.03225851058959961
mini_batch_src_global generation:  0.05735373497009277
r_  generation:  0.4537484645843506
local_output_nid generation:  0.029783010482788086
local_in_edges_tensor generation:  0.02826833724975586
mini_batch_src_global generation:  0.05847740173339844
r_  generation:  0.4419381618499756
local_output_nid generation:  0.027560949325561523
local_in_edges_tensor generation:  0.04039311408996582
mini_batch_src_global generation:  0.05454826354980469
r_  generation:  0.4630603790283203
local_output_nid generation:  0.026064395904541016
local_in_edges_tensor generation:  0.04379582405090332
mini_batch_src_global generation:  0.06869173049926758
r_  generation:  0.44907355308532715
local_output_nid generation:  0.028779268264770508
local_in_edges_tensor generation:  0.03771495819091797
mini_batch_src_global generation:  0.05767488479614258
r_  generation:  0.4544699192047119
local_output_nid generation:  0.026649951934814453
local_in_edges_tensor generation:  0.03011918067932129
mini_batch_src_global generation:  0.05759263038635254
r_  generation:  0.44759583473205566
local_output_nid generation:  0.026732921600341797
local_in_edges_tensor generation:  0.029900789260864258
mini_batch_src_global generation:  0.0767207145690918
r_  generation:  0.4591789245605469
local_output_nid generation:  0.026859045028686523
local_in_edges_tensor generation:  0.034676551818847656
mini_batch_src_global generation:  0.058387041091918945
r_  generation:  0.4501364231109619
local_output_nid generation:  0.027823686599731445
local_in_edges_tensor generation:  0.028406858444213867
mini_batch_src_global generation:  0.054941415786743164
r_  generation:  0.45998716354370117
local_output_nid generation:  0.02695751190185547
local_in_edges_tensor generation:  0.030861377716064453
mini_batch_src_global generation:  0.055268287658691406
r_  generation:  0.44730281829833984
local_output_nid generation:  0.026889324188232422
local_in_edges_tensor generation:  0.03669548034667969
mini_batch_src_global generation:  0.05386018753051758
r_  generation:  0.4540903568267822
local_output_nid generation:  0.02654099464416504
local_in_edges_tensor generation:  0.029062271118164062
mini_batch_src_global generation:  0.05427813529968262
r_  generation:  0.4439582824707031
local_output_nid generation:  0.02674245834350586
local_in_edges_tensor generation:  0.03384757041931152
mini_batch_src_global generation:  0.05418515205383301
r_  generation:  0.45520806312561035
local_output_nid generation:  0.026701688766479492
local_in_edges_tensor generation:  0.03513693809509277
mini_batch_src_global generation:  0.06361269950866699
r_  generation:  0.46181511878967285
local_output_nid generation:  0.026824235916137695
local_in_edges_tensor generation:  0.027726411819458008
mini_batch_src_global generation:  0.0542452335357666
r_  generation:  0.4500584602355957
local_output_nid generation:  0.026814937591552734
local_in_edges_tensor generation:  0.02593517303466797
mini_batch_src_global generation:  0.05441927909851074
r_  generation:  0.4474496841430664
----------------------check_connections_block total spend ----------------------------- 21.299657583236694
generate_one_block  0.5954587459564209
generate_one_block  0.7189829349517822
generate_one_block  0.5930886268615723
generate_one_block  0.5903246402740479
generate_one_block  0.6006941795349121
generate_one_block  0.5854752063751221
generate_one_block  0.5850400924682617
generate_one_block  0.587855339050293
generate_one_block  0.5954446792602539
generate_one_block  0.5829055309295654
generate_one_block  0.5770268440246582
generate_one_block  0.5884768962860107
generate_one_block  0.5821611881256104
generate_one_block  0.5679595470428467
generate_one_block  0.5828838348388672
generate_one_block  0.5873205661773682
generate_one_block  0.5977840423583984
generate_one_block  0.573162317276001
generate_one_block  0.5749742984771729
generate_one_block  0.5847079753875732
generate_one_block  0.5957891941070557
generate_one_block  0.5880780220031738
generate_one_block  0.6009817123413086
generate_one_block  0.5886178016662598
generate_one_block  0.5728216171264648
generate_one_block  0.5736370086669922
generate_one_block  0.5803241729736328
generate_one_block  0.568406343460083
generate_one_block  0.601698637008667
generate_one_block  0.6467025279998779
generate_one_block  0.6081650257110596
generate_one_block  0.6031737327575684
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.06963157653808594
gen group dst list time:  0.19019675254821777
time for parepare:  0.019675016403198242
local_output_nid generation:  0.03284263610839844
local_in_edges_tensor generation:  0.0589299201965332
mini_batch_src_global generation:  0.051958560943603516
r_  generation:  0.5414695739746094
local_output_nid generation:  0.03789067268371582
local_in_edges_tensor generation:  0.05285477638244629
mini_batch_src_global generation:  0.06510758399963379
r_  generation:  0.5259397029876709
local_output_nid generation:  0.03791618347167969
local_in_edges_tensor generation:  0.043347835540771484
mini_batch_src_global generation:  0.06133437156677246
r_  generation:  0.5417063236236572
local_output_nid generation:  0.037630558013916016
local_in_edges_tensor generation:  0.04497098922729492
mini_batch_src_global generation:  0.055846214294433594
r_  generation:  0.548844575881958
local_output_nid generation:  0.039635419845581055
local_in_edges_tensor generation:  0.052845001220703125
mini_batch_src_global generation:  0.0745079517364502
r_  generation:  0.5402674674987793
local_output_nid generation:  0.038098812103271484
local_in_edges_tensor generation:  0.04357409477233887
mini_batch_src_global generation:  0.057451725006103516
r_  generation:  0.546511173248291
local_output_nid generation:  0.03754472732543945
local_in_edges_tensor generation:  0.03706860542297363
mini_batch_src_global generation:  0.06093955039978027
r_  generation:  0.5452513694763184
local_output_nid generation:  0.03764915466308594
local_in_edges_tensor generation:  0.05416393280029297
mini_batch_src_global generation:  0.05832171440124512
r_  generation:  0.5425152778625488
local_output_nid generation:  0.03855562210083008
local_in_edges_tensor generation:  0.03354191780090332
mini_batch_src_global generation:  0.05912923812866211
r_  generation:  0.5500307083129883
local_output_nid generation:  0.037925004959106445
local_in_edges_tensor generation:  0.038132667541503906
mini_batch_src_global generation:  0.06295514106750488
r_  generation:  0.5418727397918701
local_output_nid generation:  0.03800773620605469
local_in_edges_tensor generation:  0.04701113700866699
mini_batch_src_global generation:  0.05962538719177246
r_  generation:  0.5645015239715576
local_output_nid generation:  0.04033041000366211
local_in_edges_tensor generation:  0.04564332962036133
mini_batch_src_global generation:  0.06365609169006348
r_  generation:  0.5432388782501221
local_output_nid generation:  0.03771615028381348
local_in_edges_tensor generation:  0.04146432876586914
mini_batch_src_global generation:  0.06173825263977051
r_  generation:  0.5498623847961426
local_output_nid generation:  0.037911415100097656
local_in_edges_tensor generation:  0.04809165000915527
mini_batch_src_global generation:  0.0727534294128418
r_  generation:  0.5444340705871582
local_output_nid generation:  0.03837227821350098
local_in_edges_tensor generation:  0.05601954460144043
mini_batch_src_global generation:  0.05996346473693848
r_  generation:  0.5495345592498779
local_output_nid generation:  0.03824734687805176
local_in_edges_tensor generation:  0.03844189643859863
mini_batch_src_global generation:  0.060742855072021484
r_  generation:  0.5433928966522217
local_output_nid generation:  0.03807425498962402
local_in_edges_tensor generation:  0.0402374267578125
mini_batch_src_global generation:  0.06293725967407227
r_  generation:  0.5522162914276123
local_output_nid generation:  0.03819131851196289
local_in_edges_tensor generation:  0.04893803596496582
mini_batch_src_global generation:  0.05953669548034668
r_  generation:  0.544295072555542
local_output_nid generation:  0.04088091850280762
local_in_edges_tensor generation:  0.033951759338378906
mini_batch_src_global generation:  0.05994296073913574
r_  generation:  0.5463652610778809
local_output_nid generation:  0.040320396423339844
local_in_edges_tensor generation:  0.03402900695800781
mini_batch_src_global generation:  0.05955243110656738
r_  generation:  0.5421144962310791
local_output_nid generation:  0.0390324592590332
local_in_edges_tensor generation:  0.034064531326293945
mini_batch_src_global generation:  0.06054830551147461
r_  generation:  0.5427639484405518
local_output_nid generation:  0.03764533996582031
local_in_edges_tensor generation:  0.035111427307128906
mini_batch_src_global generation:  0.059720516204833984
r_  generation:  0.5410254001617432
local_output_nid generation:  0.0378108024597168
local_in_edges_tensor generation:  0.05290555953979492
mini_batch_src_global generation:  0.06010723114013672
r_  generation:  0.5485749244689941
local_output_nid generation:  0.040610313415527344
local_in_edges_tensor generation:  0.04755067825317383
mini_batch_src_global generation:  0.05980229377746582
r_  generation:  0.5424931049346924
local_output_nid generation:  0.04109048843383789
local_in_edges_tensor generation:  0.04563498497009277
mini_batch_src_global generation:  0.06459569931030273
r_  generation:  0.550584077835083
local_output_nid generation:  0.04014325141906738
local_in_edges_tensor generation:  0.04134654998779297
mini_batch_src_global generation:  0.07382535934448242
r_  generation:  0.5547809600830078
local_output_nid generation:  0.038299560546875
local_in_edges_tensor generation:  0.034088850021362305
mini_batch_src_global generation:  0.06444692611694336
r_  generation:  0.5470361709594727
local_output_nid generation:  0.03804969787597656
local_in_edges_tensor generation:  0.048169612884521484
mini_batch_src_global generation:  0.06080889701843262
r_  generation:  0.5523464679718018
local_output_nid generation:  0.03786921501159668
local_in_edges_tensor generation:  0.0341489315032959
mini_batch_src_global generation:  0.060530900955200195
r_  generation:  0.5462408065795898
local_output_nid generation:  0.03794741630554199
local_in_edges_tensor generation:  0.033514976501464844
mini_batch_src_global generation:  0.06104087829589844
r_  generation:  0.5506978034973145
local_output_nid generation:  0.03787589073181152
local_in_edges_tensor generation:  0.037149667739868164
mini_batch_src_global generation:  0.06155729293823242
r_  generation:  0.5446586608886719
local_output_nid generation:  0.03801274299621582
local_in_edges_tensor generation:  0.03836345672607422
mini_batch_src_global generation:  0.06408810615539551
r_  generation:  0.5471301078796387
----------------------check_connections_block total spend ----------------------------- 26.205551624298096
generate_one_block  0.6947035789489746
generate_one_block  0.6920101642608643
generate_one_block  0.6753714084625244
generate_one_block  0.6891598701477051
generate_one_block  0.6774978637695312
generate_one_block  0.6662921905517578
generate_one_block  0.6764118671417236
generate_one_block  0.8179905414581299
generate_one_block  0.6671905517578125
generate_one_block  0.6805942058563232
generate_one_block  0.6729311943054199
generate_one_block  0.6752293109893799
generate_one_block  0.6594793796539307
generate_one_block  0.6708967685699463
generate_one_block  0.6910262107849121
generate_one_block  0.6648654937744141
generate_one_block  0.6884276866912842
generate_one_block  0.66977858543396
generate_one_block  0.6671860218048096
generate_one_block  0.6586220264434814
generate_one_block  0.6676797866821289
generate_one_block  0.678638219833374
generate_one_block  0.694556474685669
generate_one_block  0.6834533214569092
generate_one_block  0.6687221527099609
generate_one_block  0.6700654029846191
generate_one_block  0.6792261600494385
generate_one_block  0.7006921768188477
generate_one_block  0.6684484481811523
generate_one_block  0.6975159645080566
generate_one_block  0.6666207313537598
generate_one_block  0.6675684452056885
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.037523508071899414
gen group dst list time:  0.2067112922668457
time for parepare:  0.019040584564208984
local_output_nid generation:  0.036612510681152344
local_in_edges_tensor generation:  0.05317044258117676
mini_batch_src_global generation:  0.0449671745300293
r_  generation:  0.4985008239746094
local_output_nid generation:  0.04266858100891113
local_in_edges_tensor generation:  0.039858102798461914
mini_batch_src_global generation:  0.05716657638549805
r_  generation:  0.5071778297424316
local_output_nid generation:  0.0417025089263916
local_in_edges_tensor generation:  0.035358428955078125
mini_batch_src_global generation:  0.056708574295043945
r_  generation:  0.506371021270752
local_output_nid generation:  0.04088258743286133
local_in_edges_tensor generation:  0.043791770935058594
mini_batch_src_global generation:  0.05682849884033203
r_  generation:  0.5053379535675049
local_output_nid generation:  0.03948473930358887
local_in_edges_tensor generation:  0.03569960594177246
mini_batch_src_global generation:  0.05625033378601074
r_  generation:  0.5102794170379639
local_output_nid generation:  0.03936362266540527
local_in_edges_tensor generation:  0.03862786293029785
mini_batch_src_global generation:  0.05734086036682129
r_  generation:  0.5071392059326172
local_output_nid generation:  0.039789676666259766
local_in_edges_tensor generation:  0.043848514556884766
mini_batch_src_global generation:  0.056088924407958984
r_  generation:  0.5108697414398193
local_output_nid generation:  0.039407968521118164
local_in_edges_tensor generation:  0.03868579864501953
mini_batch_src_global generation:  0.0578765869140625
r_  generation:  0.5120584964752197
local_output_nid generation:  0.0395505428314209
local_in_edges_tensor generation:  0.03890514373779297
mini_batch_src_global generation:  0.0562434196472168
r_  generation:  0.5106735229492188
local_output_nid generation:  0.03977799415588379
local_in_edges_tensor generation:  0.04393911361694336
mini_batch_src_global generation:  0.05691027641296387
r_  generation:  0.5111856460571289
local_output_nid generation:  0.03947925567626953
local_in_edges_tensor generation:  0.038851261138916016
mini_batch_src_global generation:  0.05668759346008301
r_  generation:  0.5111615657806396
local_output_nid generation:  0.0397944450378418
local_in_edges_tensor generation:  0.04889178276062012
mini_batch_src_global generation:  0.05635380744934082
r_  generation:  0.5105948448181152
local_output_nid generation:  0.03937029838562012
local_in_edges_tensor generation:  0.035016536712646484
mini_batch_src_global generation:  0.05669260025024414
r_  generation:  0.5157082080841064
local_output_nid generation:  0.03960418701171875
local_in_edges_tensor generation:  0.04116630554199219
mini_batch_src_global generation:  0.05693244934082031
r_  generation:  0.5157582759857178
local_output_nid generation:  0.03978300094604492
local_in_edges_tensor generation:  0.047365665435791016
mini_batch_src_global generation:  0.056227684020996094
r_  generation:  0.5162973403930664
local_output_nid generation:  0.039926767349243164
local_in_edges_tensor generation:  0.03900885581970215
mini_batch_src_global generation:  0.05646085739135742
r_  generation:  0.5166440010070801
local_output_nid generation:  0.03993964195251465
local_in_edges_tensor generation:  0.03833270072937012
mini_batch_src_global generation:  0.061193227767944336
r_  generation:  0.519528865814209
local_output_nid generation:  0.04000973701477051
local_in_edges_tensor generation:  0.039127349853515625
mini_batch_src_global generation:  0.057535409927368164
r_  generation:  0.5202558040618896
local_output_nid generation:  0.03961682319641113
local_in_edges_tensor generation:  0.03515005111694336
mini_batch_src_global generation:  0.057262420654296875
r_  generation:  0.5213298797607422
local_output_nid generation:  0.039888858795166016
local_in_edges_tensor generation:  0.03884458541870117
mini_batch_src_global generation:  0.06081819534301758
r_  generation:  0.5202007293701172
local_output_nid generation:  0.0396420955657959
local_in_edges_tensor generation:  0.039301156997680664
mini_batch_src_global generation:  0.05768251419067383
r_  generation:  0.5203158855438232
local_output_nid generation:  0.03980278968811035
local_in_edges_tensor generation:  0.04310917854309082
mini_batch_src_global generation:  0.05797576904296875
r_  generation:  0.5220620632171631
local_output_nid generation:  0.039791107177734375
local_in_edges_tensor generation:  0.04347801208496094
mini_batch_src_global generation:  0.05735492706298828
r_  generation:  0.5203206539154053
local_output_nid generation:  0.04008817672729492
local_in_edges_tensor generation:  0.03929471969604492
mini_batch_src_global generation:  0.05787849426269531
r_  generation:  0.5252220630645752
local_output_nid generation:  0.04015398025512695
local_in_edges_tensor generation:  0.04149198532104492
mini_batch_src_global generation:  0.07241535186767578
r_  generation:  0.5368187427520752
local_output_nid generation:  0.04335951805114746
local_in_edges_tensor generation:  0.039301395416259766
mini_batch_src_global generation:  0.06345534324645996
r_  generation:  0.5199074745178223
local_output_nid generation:  0.04080462455749512
local_in_edges_tensor generation:  0.037146568298339844
mini_batch_src_global generation:  0.05788564682006836
r_  generation:  0.5242178440093994
local_output_nid generation:  0.04103899002075195
local_in_edges_tensor generation:  0.03511524200439453
mini_batch_src_global generation:  0.05785942077636719
r_  generation:  0.5215768814086914
local_output_nid generation:  0.04102611541748047
local_in_edges_tensor generation:  0.04358386993408203
mini_batch_src_global generation:  0.05692410469055176
r_  generation:  0.5285422801971436
local_output_nid generation:  0.0409390926361084
local_in_edges_tensor generation:  0.044202566146850586
mini_batch_src_global generation:  0.0575411319732666
r_  generation:  0.5224618911743164
local_output_nid generation:  0.04076385498046875
local_in_edges_tensor generation:  0.03523540496826172
mini_batch_src_global generation:  0.05711531639099121
r_  generation:  0.5240776538848877
local_output_nid generation:  0.04117083549499512
local_in_edges_tensor generation:  0.03958010673522949
mini_batch_src_global generation:  0.05745410919189453
r_  generation:  0.523123025894165
----------------------check_connections_block total spend ----------------------------- 24.962913274765015
generate_one_block  0.6671710014343262
generate_one_block  0.6531615257263184
generate_one_block  0.6332230567932129
generate_one_block  0.6419327259063721
generate_one_block  0.6273515224456787
generate_one_block  0.646155834197998
generate_one_block  0.6345174312591553
generate_one_block  0.627730131149292
generate_one_block  0.6432113647460938
generate_one_block  0.6514270305633545
generate_one_block  0.622833251953125
generate_one_block  0.6363265514373779
generate_one_block  0.6493391990661621
generate_one_block  0.771740198135376
generate_one_block  0.6429941654205322
generate_one_block  0.6299028396606445
generate_one_block  0.6990816593170166
generate_one_block  0.6490530967712402
generate_one_block  0.6264019012451172
generate_one_block  0.6484246253967285
generate_one_block  0.6658608913421631
generate_one_block  0.6478099822998047
generate_one_block  0.6441733837127686
generate_one_block  0.6455850601196289
generate_one_block  0.6649584770202637
generate_one_block  0.648906946182251
generate_one_block  0.632155179977417
generate_one_block  0.6315994262695312
generate_one_block  0.6370809078216553
generate_one_block  0.654543399810791
generate_one_block  0.6525857448577881
generate_one_block  0.6501743793487549
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0029964447021484375  GigaBytes
Max Memory Allocated: 0.0029964447021484375  GigaBytes

connection checking time:  78.91389107704163
block generation total time  67.1173849105835
average batch blocks generation time:  2.0974182784557343
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2030029296875 GB
    Memory Allocated: 0.12009048461914062  GigaBytes
Max Memory Allocated: 0.12009048461914062  GigaBytes

torch.Size([165316, 128])
torch.Size([161207, 128])
Traceback (most recent call last):
  File "pseudo_mini_batch_range_arxiv_sage.py", line 435, in <module>
    main()
  File "pseudo_mini_batch_range_arxiv_sage.py", line 431, in main
    best_test = run(args, device, data)
  File "pseudo_mini_batch_range_arxiv_sage.py", line 251, in run
    batch_pred = model(blocks, batch_inputs)#------------*
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/graph_partition_multi_layers/pseudo_mini_batch_full_batch/SAGE/graphsage_model_arxiv.py", line 182, in forward
    x = layer(block, x)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 258, in forward
    graph.update_all(msg_fn, self._lstm_reducer)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/heterograph.py", line 4849, in update_all
    ndata = core.message_passing(g, message_func, reduce_func, apply_node_func)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 337, in message_passing
    ndata = invoke_udf_reduce(g, rfunc, msgdata, orig_nid=orig_nid)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 143, in invoke_udf_reduce
    bkt_rsts.append(func(nbatch))
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 173, in _lstm_reducer
    _, (rst, _) = self.lstm(m, h)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/rnn.py", line 582, in forward
    self.dropout, self.training, self.bidirectional, self.batch_first)
RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 23.62 GiB total capacity; 22.35 GiB already allocated; 10.44 MiB free; 22.41 GiB reserved in total by PyTorch)
