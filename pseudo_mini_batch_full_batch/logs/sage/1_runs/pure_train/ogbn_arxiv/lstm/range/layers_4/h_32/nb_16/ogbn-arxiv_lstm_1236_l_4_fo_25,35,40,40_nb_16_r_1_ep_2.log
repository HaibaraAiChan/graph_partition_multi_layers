Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648487891.6802104
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006489753723144531  GigaBytes
Max Memory Allocated: 0.0006489753723144531  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.024116992950439453
range selection method range initialization spend 0.012936115264892578
time for parepare:  0.017756938934326172
local_output_nid generation:  0.0013353824615478516
local_in_edges_tensor generation:  0.0038819313049316406
mini_batch_src_global generation:  0.0017080307006835938
r_  generation:  0.017650127410888672
local_output_nid generation:  0.0013926029205322266
local_in_edges_tensor generation:  0.0008804798126220703
mini_batch_src_global generation:  0.0019519329071044922
r_  generation:  0.01721024513244629
local_output_nid generation:  0.0016376972198486328
local_in_edges_tensor generation:  0.0008456707000732422
mini_batch_src_global generation:  0.0012865066528320312
r_  generation:  0.01629042625427246
local_output_nid generation:  0.001474142074584961
local_in_edges_tensor generation:  0.0008611679077148438
mini_batch_src_global generation:  0.0013451576232910156
r_  generation:  0.017566442489624023
local_output_nid generation:  0.0015039443969726562
local_in_edges_tensor generation:  0.00079345703125
mini_batch_src_global generation:  0.0012001991271972656
r_  generation:  0.017077207565307617
local_output_nid generation:  0.0014503002166748047
local_in_edges_tensor generation:  0.0008361339569091797
mini_batch_src_global generation:  0.0014162063598632812
r_  generation:  0.018235206604003906
local_output_nid generation:  0.0015523433685302734
local_in_edges_tensor generation:  0.0008618831634521484
mini_batch_src_global generation:  0.0013761520385742188
r_  generation:  0.01855301856994629
local_output_nid generation:  0.0015783309936523438
local_in_edges_tensor generation:  0.0008158683776855469
mini_batch_src_global generation:  0.0014231204986572266
r_  generation:  0.01850414276123047
local_output_nid generation:  0.0015099048614501953
local_in_edges_tensor generation:  0.0008571147918701172
mini_batch_src_global generation:  0.0013098716735839844
r_  generation:  0.01841259002685547
local_output_nid generation:  0.0014722347259521484
local_in_edges_tensor generation:  0.0008261203765869141
mini_batch_src_global generation:  0.0014300346374511719
r_  generation:  0.0184328556060791
local_output_nid generation:  0.0014586448669433594
local_in_edges_tensor generation:  0.0008265972137451172
mini_batch_src_global generation:  0.0013911724090576172
r_  generation:  0.019226551055908203
local_output_nid generation:  0.001504659652709961
local_in_edges_tensor generation:  0.0008306503295898438
mini_batch_src_global generation:  0.0014617443084716797
r_  generation:  0.018481731414794922
local_output_nid generation:  0.0015120506286621094
local_in_edges_tensor generation:  0.0008332729339599609
mini_batch_src_global generation:  0.001405477523803711
r_  generation:  0.018324851989746094
local_output_nid generation:  0.0015037059783935547
local_in_edges_tensor generation:  0.0008223056793212891
mini_batch_src_global generation:  0.0014977455139160156
r_  generation:  0.01867818832397461
local_output_nid generation:  0.0014677047729492188
local_in_edges_tensor generation:  0.0008101463317871094
mini_batch_src_global generation:  0.0015184879302978516
r_  generation:  0.01893305778503418
local_output_nid generation:  0.0015249252319335938
local_in_edges_tensor generation:  0.0008420944213867188
mini_batch_src_global generation:  0.0013790130615234375
r_  generation:  0.01847529411315918
----------------------check_connections_block total spend ----------------------------- 0.4363574981689453
generate_one_block  0.027008056640625
generate_one_block  0.02705836296081543
generate_one_block  0.026140213012695312
generate_one_block  0.029628753662109375
generate_one_block  0.026976823806762695
generate_one_block  0.02768564224243164
generate_one_block  0.02734971046447754
generate_one_block  0.027399301528930664
generate_one_block  0.027414560317993164
generate_one_block  0.02740955352783203
generate_one_block  0.028245925903320312
generate_one_block  0.027167797088623047
generate_one_block  0.02717113494873047
generate_one_block  0.027680397033691406
generate_one_block  0.027416229248046875
generate_one_block  0.027377605438232422
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.039963483810424805
gen group dst list time:  0.018464326858520508
time for parepare:  0.01970696449279785
local_output_nid generation:  0.0067980289459228516
local_in_edges_tensor generation:  0.017979860305786133
mini_batch_src_global generation:  0.02160501480102539
r_  generation:  0.2006850242614746
local_output_nid generation:  0.012337446212768555
local_in_edges_tensor generation:  0.019120454788208008
mini_batch_src_global generation:  0.02497124671936035
r_  generation:  0.20010900497436523
local_output_nid generation:  0.012526988983154297
local_in_edges_tensor generation:  0.013738870620727539
mini_batch_src_global generation:  0.02374744415283203
r_  generation:  0.20144367218017578
local_output_nid generation:  0.013198375701904297
local_in_edges_tensor generation:  0.016210556030273438
mini_batch_src_global generation:  0.024966955184936523
r_  generation:  0.21064305305480957
local_output_nid generation:  0.013130426406860352
local_in_edges_tensor generation:  0.012592792510986328
mini_batch_src_global generation:  0.025498151779174805
r_  generation:  0.20971894264221191
local_output_nid generation:  0.013623714447021484
local_in_edges_tensor generation:  0.016562700271606445
mini_batch_src_global generation:  0.036844491958618164
r_  generation:  0.2206563949584961
local_output_nid generation:  0.01370549201965332
local_in_edges_tensor generation:  0.015038728713989258
mini_batch_src_global generation:  0.02716374397277832
r_  generation:  0.21509861946105957
local_output_nid generation:  0.013876199722290039
local_in_edges_tensor generation:  0.012546539306640625
mini_batch_src_global generation:  0.027105093002319336
r_  generation:  0.21883368492126465
local_output_nid generation:  0.013967752456665039
local_in_edges_tensor generation:  0.016707420349121094
mini_batch_src_global generation:  0.027063369750976562
r_  generation:  0.21567559242248535
local_output_nid generation:  0.013627290725708008
local_in_edges_tensor generation:  0.013258695602416992
mini_batch_src_global generation:  0.027644634246826172
r_  generation:  0.21467971801757812
local_output_nid generation:  0.014283418655395508
local_in_edges_tensor generation:  0.017122983932495117
mini_batch_src_global generation:  0.027296781539916992
r_  generation:  0.2213115692138672
local_output_nid generation:  0.014036893844604492
local_in_edges_tensor generation:  0.0131683349609375
mini_batch_src_global generation:  0.027328014373779297
r_  generation:  0.21876764297485352
local_output_nid generation:  0.013922691345214844
local_in_edges_tensor generation:  0.016409635543823242
mini_batch_src_global generation:  0.026368141174316406
r_  generation:  0.21119117736816406
local_output_nid generation:  0.014046907424926758
local_in_edges_tensor generation:  0.014728307723999023
mini_batch_src_global generation:  0.026975154876708984
r_  generation:  0.21409273147583008
local_output_nid generation:  0.013920307159423828
local_in_edges_tensor generation:  0.01656317710876465
mini_batch_src_global generation:  0.027460813522338867
r_  generation:  0.2148897647857666
local_output_nid generation:  0.014026641845703125
local_in_edges_tensor generation:  0.016772985458374023
mini_batch_src_global generation:  0.026912689208984375
r_  generation:  0.21749305725097656
----------------------check_connections_block total spend ----------------------------- 5.067631721496582
generate_one_block  0.28818392753601074
generate_one_block  0.2750973701477051
generate_one_block  0.27614402770996094
generate_one_block  0.2848823070526123
generate_one_block  0.29404520988464355
generate_one_block  0.2855410575866699
generate_one_block  0.2837257385253906
generate_one_block  0.2781541347503662
generate_one_block  0.27931833267211914
generate_one_block  0.2847263813018799
generate_one_block  0.2952554225921631
generate_one_block  0.2778513431549072
generate_one_block  0.27321553230285645
generate_one_block  0.2814505100250244
generate_one_block  0.2860069274902344
generate_one_block  0.2815821170806885
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.040021657943725586
gen group dst list time:  0.06176114082336426
time for parepare:  0.018697500228881836
local_output_nid generation:  0.023515939712524414
local_in_edges_tensor generation:  0.04000067710876465
mini_batch_src_global generation:  0.04942631721496582
r_  generation:  0.46715283393859863
local_output_nid generation:  0.029165983200073242
local_in_edges_tensor generation:  0.04754161834716797
mini_batch_src_global generation:  0.056336402893066406
r_  generation:  0.4759535789489746
local_output_nid generation:  0.02910757064819336
local_in_edges_tensor generation:  0.03517317771911621
mini_batch_src_global generation:  0.05555438995361328
r_  generation:  0.4857771396636963
local_output_nid generation:  0.029759883880615234
local_in_edges_tensor generation:  0.04521369934082031
mini_batch_src_global generation:  0.06124520301818848
r_  generation:  0.49542927742004395
local_output_nid generation:  0.029920101165771484
local_in_edges_tensor generation:  0.03585028648376465
mini_batch_src_global generation:  0.05729269981384277
r_  generation:  0.4976053237915039
local_output_nid generation:  0.030283689498901367
local_in_edges_tensor generation:  0.04036545753479004
mini_batch_src_global generation:  0.061862945556640625
r_  generation:  0.4912452697753906
local_output_nid generation:  0.029691696166992188
local_in_edges_tensor generation:  0.03050851821899414
mini_batch_src_global generation:  0.05620527267456055
r_  generation:  0.49158382415771484
local_output_nid generation:  0.02968764305114746
local_in_edges_tensor generation:  0.031294822692871094
mini_batch_src_global generation:  0.0587000846862793
r_  generation:  0.48559141159057617
local_output_nid generation:  0.0298159122467041
local_in_edges_tensor generation:  0.03968977928161621
mini_batch_src_global generation:  0.05648994445800781
r_  generation:  0.49690747261047363
local_output_nid generation:  0.029692649841308594
local_in_edges_tensor generation:  0.03130817413330078
mini_batch_src_global generation:  0.05882143974304199
r_  generation:  0.48597002029418945
local_output_nid generation:  0.030346155166625977
local_in_edges_tensor generation:  0.03144431114196777
mini_batch_src_global generation:  0.06653738021850586
r_  generation:  0.49579596519470215
local_output_nid generation:  0.03153657913208008
local_in_edges_tensor generation:  0.05735945701599121
mini_batch_src_global generation:  0.07067394256591797
r_  generation:  0.4901008605957031
local_output_nid generation:  0.03023982048034668
local_in_edges_tensor generation:  0.03642868995666504
mini_batch_src_global generation:  0.058411598205566406
r_  generation:  0.4926455020904541
local_output_nid generation:  0.030692338943481445
local_in_edges_tensor generation:  0.03418231010437012
mini_batch_src_global generation:  0.058037519454956055
r_  generation:  0.5018556118011475
local_output_nid generation:  0.030363082885742188
local_in_edges_tensor generation:  0.046904802322387695
mini_batch_src_global generation:  0.06049799919128418
r_  generation:  0.492509126663208
local_output_nid generation:  0.03044271469116211
local_in_edges_tensor generation:  0.03266716003417969
mini_batch_src_global generation:  0.057692766189575195
r_  generation:  0.48660969734191895
----------------------check_connections_block total spend ----------------------------- 11.57634687423706
generate_one_block  0.6470329761505127
generate_one_block  0.6233532428741455
generate_one_block  0.6399655342102051
generate_one_block  0.6407992839813232
generate_one_block  0.631535530090332
generate_one_block  0.6451518535614014
generate_one_block  0.6867117881774902
generate_one_block  0.6348223686218262
generate_one_block  0.6390194892883301
generate_one_block  0.6227898597717285
generate_one_block  0.6537501811981201
generate_one_block  0.6383843421936035
generate_one_block  0.6451451778411865
generate_one_block  0.643812894821167
generate_one_block  0.6396143436431885
generate_one_block  0.6352694034576416
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.046326637268066406
gen group dst list time:  0.09159445762634277
time for parepare:  0.02028632164001465
local_output_nid generation:  0.032372236251831055
local_in_edges_tensor generation:  0.058722734451293945
mini_batch_src_global generation:  0.0464169979095459
r_  generation:  0.4930384159088135
local_output_nid generation:  0.04046010971069336
local_in_edges_tensor generation:  0.04213976860046387
mini_batch_src_global generation:  0.05682086944580078
r_  generation:  0.495241641998291
local_output_nid generation:  0.03671860694885254
local_in_edges_tensor generation:  0.042016029357910156
mini_batch_src_global generation:  0.05411124229431152
r_  generation:  0.5024948120117188
local_output_nid generation:  0.036878108978271484
local_in_edges_tensor generation:  0.03802752494812012
mini_batch_src_global generation:  0.05384969711303711
r_  generation:  0.5088663101196289
local_output_nid generation:  0.037072181701660156
local_in_edges_tensor generation:  0.04054403305053711
mini_batch_src_global generation:  0.05473828315734863
r_  generation:  0.5112357139587402
local_output_nid generation:  0.037267446517944336
local_in_edges_tensor generation:  0.0441129207611084
mini_batch_src_global generation:  0.06433653831481934
r_  generation:  0.5156583786010742
local_output_nid generation:  0.03857159614562988
local_in_edges_tensor generation:  0.045229434967041016
mini_batch_src_global generation:  0.05413222312927246
r_  generation:  0.5194361209869385
local_output_nid generation:  0.03848695755004883
local_in_edges_tensor generation:  0.038013458251953125
mini_batch_src_global generation:  0.05542325973510742
r_  generation:  0.5188806056976318
local_output_nid generation:  0.03871655464172363
local_in_edges_tensor generation:  0.045366525650024414
mini_batch_src_global generation:  0.054738521575927734
r_  generation:  0.5301306247711182
local_output_nid generation:  0.04065442085266113
local_in_edges_tensor generation:  0.04086709022521973
mini_batch_src_global generation:  0.05656027793884277
r_  generation:  0.5213043689727783
local_output_nid generation:  0.03859567642211914
local_in_edges_tensor generation:  0.0449976921081543
mini_batch_src_global generation:  0.0554347038269043
r_  generation:  0.5243604183197021
local_output_nid generation:  0.038516998291015625
local_in_edges_tensor generation:  0.04093623161315918
mini_batch_src_global generation:  0.05675387382507324
r_  generation:  0.5241961479187012
local_output_nid generation:  0.038787126541137695
local_in_edges_tensor generation:  0.04037189483642578
mini_batch_src_global generation:  0.059250831604003906
r_  generation:  0.5278069972991943
local_output_nid generation:  0.03879714012145996
local_in_edges_tensor generation:  0.04544496536254883
mini_batch_src_global generation:  0.05623054504394531
r_  generation:  0.5198509693145752
local_output_nid generation:  0.03872275352478027
local_in_edges_tensor generation:  0.0367121696472168
mini_batch_src_global generation:  0.0560603141784668
r_  generation:  0.5237431526184082
local_output_nid generation:  0.03862333297729492
local_in_edges_tensor generation:  0.03687429428100586
mini_batch_src_global generation:  0.060108184814453125
r_  generation:  0.5217587947845459
----------------------check_connections_block total spend ----------------------------- 12.378604412078857
generate_one_block  0.6450798511505127
generate_one_block  0.732611894607544
generate_one_block  0.6325738430023193
generate_one_block  0.6448237895965576
generate_one_block  0.6368842124938965
generate_one_block  0.6415121555328369
generate_one_block  0.630537748336792
generate_one_block  0.6188127994537354
generate_one_block  0.63230299949646
generate_one_block  0.6157171726226807
generate_one_block  0.6306796073913574
generate_one_block  0.6289525032043457
generate_one_block  0.6324195861816406
generate_one_block  0.6499080657958984
generate_one_block  0.6209099292755127
generate_one_block  0.6214437484741211
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006489753723144531  GigaBytes
Max Memory Allocated: 0.0006489753723144531  GigaBytes

connection checking time:  29.0225830078125
block generation total time  25.007508516311646
average batch blocks generation time:  1.5629692822694778
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1990966796875 GB
    Memory Allocated: 0.10734367370605469  GigaBytes
Max Memory Allocated: 0.10734367370605469  GigaBytes

torch.Size([163604, 128])
torch.Size([155595, 32])
torch.Size([124040, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.3299560546875 GB
    Memory Allocated: 16.005853176116943  GigaBytes
Max Memory Allocated: 16.01232624053955  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8846435546875 GB
    Memory Allocated: 0.10877847671508789  GigaBytes
Max Memory Allocated: 16.01232624053955  GigaBytes

torch.Size([163534, 128])
torch.Size([155371, 32])
torch.Size([123437, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8846435546875 GB
    Memory Allocated: 15.963915824890137  GigaBytes
Max Memory Allocated: 16.01232624053955  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8846435546875 GB
    Memory Allocated: 0.10885858535766602  GigaBytes
Max Memory Allocated: 16.01232624053955  GigaBytes

torch.Size([163529, 128])
torch.Size([155504, 32])
torch.Size([123452, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8846435546875 GB
    Memory Allocated: 15.927650928497314  GigaBytes
Max Memory Allocated: 16.01232624053955  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8846435546875 GB
    Memory Allocated: 0.10897064208984375  GigaBytes
Max Memory Allocated: 16.01232624053955  GigaBytes

torch.Size([163653, 128])
torch.Size([155768, 32])
torch.Size([124430, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8846435546875 GB
    Memory Allocated: 16.0232515335083  GigaBytes
Max Memory Allocated: 16.03039312362671  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8846435546875 GB
    Memory Allocated: 0.10891008377075195  GigaBytes
Max Memory Allocated: 16.03039312362671  GigaBytes

torch.Size([163652, 128])
torch.Size([155596, 32])
torch.Size([123574, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8846435546875 GB
    Memory Allocated: 15.966853618621826  GigaBytes
Max Memory Allocated: 16.03039312362671  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8846435546875 GB
    Memory Allocated: 0.10902881622314453  GigaBytes
Max Memory Allocated: 16.03039312362671  GigaBytes

torch.Size([163699, 128])
torch.Size([155826, 32])
torch.Size([124734, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8846435546875 GB
    Memory Allocated: 16.033166885375977  GigaBytes
Max Memory Allocated: 16.04028558731079  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8846435546875 GB
    Memory Allocated: 0.10903406143188477  GigaBytes
Max Memory Allocated: 16.04028558731079  GigaBytes

torch.Size([163636, 128])
torch.Size([155541, 32])
torch.Size([123626, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8846435546875 GB
    Memory Allocated: 16.00053882598877  GigaBytes
Max Memory Allocated: 16.04028558731079  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8846435546875 GB
    Memory Allocated: 0.10889005661010742  GigaBytes
Max Memory Allocated: 16.04028558731079  GigaBytes

torch.Size([163578, 128])
torch.Size([155364, 32])
torch.Size([123463, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8846435546875 GB
    Memory Allocated: 15.987865447998047  GigaBytes
Max Memory Allocated: 16.04028558731079  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8846435546875 GB
    Memory Allocated: 0.10903215408325195  GigaBytes
Max Memory Allocated: 16.04028558731079  GigaBytes

torch.Size([163666, 128])
torch.Size([155579, 32])
torch.Size([123936, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8846435546875 GB
    Memory Allocated: 16.010249614715576  GigaBytes
Max Memory Allocated: 16.04028558731079  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8846435546875 GB
    Memory Allocated: 0.10882997512817383  GigaBytes
Max Memory Allocated: 16.04028558731079  GigaBytes

torch.Size([163452, 128])
torch.Size([154966, 32])
torch.Size([122731, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8846435546875 GB
    Memory Allocated: 15.954885482788086  GigaBytes
Max Memory Allocated: 16.04028558731079  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8846435546875 GB
    Memory Allocated: 0.10919523239135742  GigaBytes
Max Memory Allocated: 16.04028558731079  GigaBytes

torch.Size([163670, 128])
torch.Size([155723, 32])
torch.Size([124687, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8846435546875 GB
    Memory Allocated: 16.0650691986084  GigaBytes
Max Memory Allocated: 16.072317600250244  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8846435546875 GB
    Memory Allocated: 0.10887718200683594  GigaBytes
Max Memory Allocated: 16.072317600250244  GigaBytes

torch.Size([163551, 128])
torch.Size([155517, 32])
torch.Size([123954, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8846435546875 GB
    Memory Allocated: 15.99913740158081  GigaBytes
Max Memory Allocated: 16.072317600250244  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8846435546875 GB
    Memory Allocated: 0.10889291763305664  GigaBytes
Max Memory Allocated: 16.072317600250244  GigaBytes

torch.Size([163681, 128])
torch.Size([155471, 32])
torch.Size([123380, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8846435546875 GB
    Memory Allocated: 15.951587200164795  GigaBytes
Max Memory Allocated: 16.072317600250244  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8846435546875 GB
    Memory Allocated: 0.108917236328125  GigaBytes
Max Memory Allocated: 16.072317600250244  GigaBytes

torch.Size([163685, 128])
torch.Size([155884, 32])
torch.Size([124364, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8846435546875 GB
    Memory Allocated: 15.985620975494385  GigaBytes
Max Memory Allocated: 16.072317600250244  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8846435546875 GB
    Memory Allocated: 0.10898542404174805  GigaBytes
Max Memory Allocated: 16.072317600250244  GigaBytes

torch.Size([163481, 128])
torch.Size([155322, 32])
torch.Size([123606, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8846435546875 GB
    Memory Allocated: 15.988457679748535  GigaBytes
Max Memory Allocated: 16.072317600250244  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8846435546875 GB
    Memory Allocated: 0.10894250869750977  GigaBytes
Max Memory Allocated: 16.072317600250244  GigaBytes

torch.Size([163680, 128])
torch.Size([155452, 32])
torch.Size([123581, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8846435546875 GB
    Memory Allocated: 15.975048065185547  GigaBytes
Max Memory Allocated: 16.072317600250244  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04104296863079071 |0.04961404204368591 |0.39332421123981476 |0.00010332465171813965 |0.48109154403209686 |0.010255813598632812 |
----------------------------------------------------------pseudo_mini_loss sum 4.485957145690918
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  7748584
Number of first layer input nodes during this epoch:  2617751
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 17.8846435546875 GB
    Memory Allocated: 0.15938997268676758  GigaBytes
Max Memory Allocated: 16.072317600250244  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.025424480438232422
range selection method range initialization spend 0.012203454971313477
time for parepare:  0.017787456512451172
local_output_nid generation:  0.001744985580444336
local_in_edges_tensor generation:  0.003960371017456055
mini_batch_src_global generation:  0.001941680908203125
r_  generation:  0.01918816566467285
local_output_nid generation:  0.0018029212951660156
local_in_edges_tensor generation:  0.0010075569152832031
mini_batch_src_global generation:  0.0021364688873291016
r_  generation:  0.018484115600585938
local_output_nid generation:  0.0017824172973632812
local_in_edges_tensor generation:  0.0009100437164306641
mini_batch_src_global generation:  0.001453399658203125
r_  generation:  0.01883840560913086
local_output_nid generation:  0.0017571449279785156
local_in_edges_tensor generation:  0.0008950233459472656
mini_batch_src_global generation:  0.0013346672058105469
r_  generation:  0.018722057342529297
local_output_nid generation:  0.0019342899322509766
local_in_edges_tensor generation:  0.0009608268737792969
mini_batch_src_global generation:  0.0015249252319335938
r_  generation:  0.01918339729309082
local_output_nid generation:  0.001689910888671875
local_in_edges_tensor generation:  0.0008769035339355469
mini_batch_src_global generation:  0.0014460086822509766
r_  generation:  0.01921677589416504
local_output_nid generation:  0.0016977787017822266
local_in_edges_tensor generation:  0.0008935928344726562
mini_batch_src_global generation:  0.0015316009521484375
r_  generation:  0.01979231834411621
local_output_nid generation:  0.0017206668853759766
local_in_edges_tensor generation:  0.0008838176727294922
mini_batch_src_global generation:  0.0014967918395996094
r_  generation:  0.019572973251342773
local_output_nid generation:  0.0017240047454833984
local_in_edges_tensor generation:  0.0009272098541259766
mini_batch_src_global generation:  0.0015254020690917969
r_  generation:  0.019819259643554688
local_output_nid generation:  0.0017931461334228516
local_in_edges_tensor generation:  0.0008833408355712891
mini_batch_src_global generation:  0.0014913082122802734
r_  generation:  0.019443273544311523
local_output_nid generation:  0.001705169677734375
local_in_edges_tensor generation:  0.0008990764617919922
mini_batch_src_global generation:  0.0015423297882080078
r_  generation:  0.01957249641418457
local_output_nid generation:  0.0017256736755371094
local_in_edges_tensor generation:  0.0008838176727294922
mini_batch_src_global generation:  0.0014934539794921875
r_  generation:  0.02010488510131836
local_output_nid generation:  0.0017578601837158203
local_in_edges_tensor generation:  0.0008671283721923828
mini_batch_src_global generation:  0.0015130043029785156
r_  generation:  0.019399642944335938
local_output_nid generation:  0.0016827583312988281
local_in_edges_tensor generation:  0.0009696483612060547
mini_batch_src_global generation:  0.001550912857055664
r_  generation:  0.020052433013916016
local_output_nid generation:  0.0017518997192382812
local_in_edges_tensor generation:  0.0008733272552490234
mini_batch_src_global generation:  0.0015323162078857422
r_  generation:  0.020333290100097656
local_output_nid generation:  0.001667022705078125
local_in_edges_tensor generation:  0.0008680820465087891
mini_batch_src_global generation:  0.0015959739685058594
r_  generation:  0.019466876983642578
----------------------check_connections_block total spend ----------------------------- 0.469602108001709
generate_one_block  0.03593707084655762
generate_one_block  0.03147244453430176
generate_one_block  0.031183481216430664
generate_one_block  0.031071901321411133
generate_one_block  0.0320892333984375
generate_one_block  0.03438425064086914
generate_one_block  0.032540082931518555
generate_one_block  0.0324099063873291
generate_one_block  0.032195091247558594
generate_one_block  0.0313875675201416
generate_one_block  0.03078150749206543
generate_one_block  0.03179526329040527
generate_one_block  0.03159594535827637
generate_one_block  0.031157732009887695
generate_one_block  0.03195834159851074
generate_one_block  0.03147172927856445
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.038895606994628906
gen group dst list time:  0.017004728317260742
time for parepare:  0.019609451293945312
local_output_nid generation:  0.007424592971801758
local_in_edges_tensor generation:  0.0183866024017334
mini_batch_src_global generation:  0.021129131317138672
r_  generation:  0.1992173194885254
local_output_nid generation:  0.01091146469116211
local_in_edges_tensor generation:  0.02066516876220703
mini_batch_src_global generation:  0.025249242782592773
r_  generation:  0.20787310600280762
local_output_nid generation:  0.01159524917602539
local_in_edges_tensor generation:  0.014785289764404297
mini_batch_src_global generation:  0.023906946182250977
r_  generation:  0.20731091499328613
local_output_nid generation:  0.01165771484375
local_in_edges_tensor generation:  0.013240337371826172
mini_batch_src_global generation:  0.02469658851623535
r_  generation:  0.21143579483032227
local_output_nid generation:  0.012449026107788086
local_in_edges_tensor generation:  0.01497650146484375
mini_batch_src_global generation:  0.0275266170501709
r_  generation:  0.2142467498779297
local_output_nid generation:  0.012548685073852539
local_in_edges_tensor generation:  0.013441801071166992
mini_batch_src_global generation:  0.02848672866821289
r_  generation:  0.21843171119689941
local_output_nid generation:  0.012846946716308594
local_in_edges_tensor generation:  0.015999794006347656
mini_batch_src_global generation:  0.02705097198486328
r_  generation:  0.22375059127807617
local_output_nid generation:  0.01304173469543457
local_in_edges_tensor generation:  0.01583576202392578
mini_batch_src_global generation:  0.027298450469970703
r_  generation:  0.22190260887145996
local_output_nid generation:  0.012817144393920898
local_in_edges_tensor generation:  0.01388406753540039
mini_batch_src_global generation:  0.02732086181640625
r_  generation:  0.22665166854858398
local_output_nid generation:  0.012452363967895508
local_in_edges_tensor generation:  0.016705036163330078
mini_batch_src_global generation:  0.02844405174255371
r_  generation:  0.2223198413848877
local_output_nid generation:  0.012273550033569336
local_in_edges_tensor generation:  0.012163877487182617
mini_batch_src_global generation:  0.027704715728759766
r_  generation:  0.21767020225524902
local_output_nid generation:  0.012534141540527344
local_in_edges_tensor generation:  0.013355493545532227
mini_batch_src_global generation:  0.0276947021484375
r_  generation:  0.22054123878479004
local_output_nid generation:  0.013259649276733398
local_in_edges_tensor generation:  0.01619100570678711
mini_batch_src_global generation:  0.028593063354492188
r_  generation:  0.21573114395141602
local_output_nid generation:  0.012502193450927734
local_in_edges_tensor generation:  0.01580333709716797
mini_batch_src_global generation:  0.026997089385986328
r_  generation:  0.23308110237121582
local_output_nid generation:  0.014838933944702148
local_in_edges_tensor generation:  0.017836332321166992
mini_batch_src_global generation:  0.028430700302124023
r_  generation:  0.2236039638519287
local_output_nid generation:  0.012909173965454102
local_in_edges_tensor generation:  0.015131711959838867
mini_batch_src_global generation:  0.02766704559326172
r_  generation:  0.21888947486877441
----------------------check_connections_block total spend ----------------------------- 5.150182247161865
generate_one_block  0.2978088855743408
generate_one_block  0.29309511184692383
generate_one_block  0.2882649898529053
generate_one_block  0.2856919765472412
generate_one_block  0.2899484634399414
generate_one_block  0.2931394577026367
generate_one_block  0.32050395011901855
generate_one_block  0.29724597930908203
generate_one_block  0.2954518795013428
generate_one_block  0.29908180236816406
generate_one_block  0.2940845489501953
generate_one_block  0.2913331985473633
generate_one_block  0.2862262725830078
generate_one_block  0.287677526473999
generate_one_block  0.29382777214050293
generate_one_block  0.2913930416107178
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.08777189254760742
gen group dst list time:  0.061957597732543945
time for parepare:  0.018019676208496094
local_output_nid generation:  0.02493119239807129
local_in_edges_tensor generation:  0.05081605911254883
mini_batch_src_global generation:  0.048631906509399414
r_  generation:  0.4818131923675537
local_output_nid generation:  0.030260324478149414
local_in_edges_tensor generation:  0.047588348388671875
mini_batch_src_global generation:  0.05631279945373535
r_  generation:  0.482454776763916
local_output_nid generation:  0.030328989028930664
local_in_edges_tensor generation:  0.03072500228881836
mini_batch_src_global generation:  0.05620098114013672
r_  generation:  0.48944711685180664
local_output_nid generation:  0.030092477798461914
local_in_edges_tensor generation:  0.034731388092041016
mini_batch_src_global generation:  0.056642770767211914
r_  generation:  0.48500704765319824
local_output_nid generation:  0.030544757843017578
local_in_edges_tensor generation:  0.07837700843811035
mini_batch_src_global generation:  0.059609174728393555
r_  generation:  0.49356913566589355
local_output_nid generation:  0.030345439910888672
local_in_edges_tensor generation:  0.03453850746154785
mini_batch_src_global generation:  0.05785870552062988
r_  generation:  0.49201250076293945
local_output_nid generation:  0.030606508255004883
local_in_edges_tensor generation:  0.03970170021057129
mini_batch_src_global generation:  0.06067466735839844
r_  generation:  0.5087316036224365
local_output_nid generation:  0.031139373779296875
local_in_edges_tensor generation:  0.03487873077392578
mini_batch_src_global generation:  0.05783581733703613
r_  generation:  0.4962186813354492
local_output_nid generation:  0.03112936019897461
local_in_edges_tensor generation:  0.03512215614318848
mini_batch_src_global generation:  0.05779600143432617
r_  generation:  0.5024745464324951
local_output_nid generation:  0.031408071517944336
local_in_edges_tensor generation:  0.0347895622253418
mini_batch_src_global generation:  0.05785107612609863
r_  generation:  0.49652528762817383
local_output_nid generation:  0.031775474548339844
local_in_edges_tensor generation:  0.035042762756347656
mini_batch_src_global generation:  0.05668377876281738
r_  generation:  0.4969635009765625
local_output_nid generation:  0.03133726119995117
local_in_edges_tensor generation:  0.03914809226989746
mini_batch_src_global generation:  0.05742144584655762
r_  generation:  0.4972398281097412
local_output_nid generation:  0.03399944305419922
local_in_edges_tensor generation:  0.03032374382019043
mini_batch_src_global generation:  0.05647158622741699
r_  generation:  0.49851155281066895
local_output_nid generation:  0.03138875961303711
local_in_edges_tensor generation:  0.03691506385803223
mini_batch_src_global generation:  0.057959794998168945
r_  generation:  0.4926643371582031
local_output_nid generation:  0.031039714813232422
local_in_edges_tensor generation:  0.030514240264892578
mini_batch_src_global generation:  0.05661439895629883
r_  generation:  0.500157356262207
local_output_nid generation:  0.03153705596923828
local_in_edges_tensor generation:  0.03964996337890625
mini_batch_src_global generation:  0.06108450889587402
r_  generation:  0.49190425872802734
----------------------check_connections_block total spend ----------------------------- 11.640989780426025
generate_one_block  0.6363444328308105
generate_one_block  0.65287184715271
generate_one_block  0.6418676376342773
generate_one_block  0.6511073112487793
generate_one_block  0.6525354385375977
generate_one_block  0.6541671752929688
generate_one_block  0.6603379249572754
generate_one_block  0.6611804962158203
generate_one_block  0.6918466091156006
generate_one_block  0.6495721340179443
generate_one_block  0.6401021480560303
generate_one_block  0.641801118850708
generate_one_block  0.648587703704834
generate_one_block  0.650087833404541
generate_one_block  0.6503951549530029
generate_one_block  0.6565077304840088
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04406261444091797
gen group dst list time:  0.10018682479858398
time for parepare:  0.019828319549560547
local_output_nid generation:  0.0337979793548584
local_in_edges_tensor generation:  0.05111980438232422
mini_batch_src_global generation:  0.04611372947692871
r_  generation:  0.49085164070129395
local_output_nid generation:  0.03986716270446777
local_in_edges_tensor generation:  0.04301571846008301
mini_batch_src_global generation:  0.056772470474243164
r_  generation:  0.4987776279449463
local_output_nid generation:  0.04015493392944336
local_in_edges_tensor generation:  0.03804373741149902
mini_batch_src_global generation:  0.05382108688354492
r_  generation:  0.5059788227081299
local_output_nid generation:  0.0386958122253418
local_in_edges_tensor generation:  0.04292011260986328
mini_batch_src_global generation:  0.05359506607055664
r_  generation:  0.5090682506561279
local_output_nid generation:  0.03831744194030762
local_in_edges_tensor generation:  0.03895926475524902
mini_batch_src_global generation:  0.053772926330566406
r_  generation:  0.5092465877532959
local_output_nid generation:  0.03729987144470215
local_in_edges_tensor generation:  0.03840517997741699
mini_batch_src_global generation:  0.05449986457824707
r_  generation:  0.5115048885345459
local_output_nid generation:  0.03745579719543457
local_in_edges_tensor generation:  0.043012142181396484
mini_batch_src_global generation:  0.05368971824645996
r_  generation:  0.515784740447998
local_output_nid generation:  0.037677764892578125
local_in_edges_tensor generation:  0.03829813003540039
mini_batch_src_global generation:  0.06083321571350098
r_  generation:  0.5269262790679932
local_output_nid generation:  0.037780046463012695
local_in_edges_tensor generation:  0.038259267807006836
mini_batch_src_global generation:  0.055060625076293945
r_  generation:  0.5248672962188721
local_output_nid generation:  0.03807497024536133
local_in_edges_tensor generation:  0.044652700424194336
mini_batch_src_global generation:  0.05921339988708496
r_  generation:  0.5197017192840576
local_output_nid generation:  0.03788924217224121
local_in_edges_tensor generation:  0.03879666328430176
mini_batch_src_global generation:  0.055471181869506836
r_  generation:  0.5288119316101074
local_output_nid generation:  0.03786063194274902
local_in_edges_tensor generation:  0.03884100914001465
mini_batch_src_global generation:  0.0560917854309082
r_  generation:  0.5226378440856934
local_output_nid generation:  0.037830352783203125
local_in_edges_tensor generation:  0.03885960578918457
mini_batch_src_global generation:  0.058638572692871094
r_  generation:  0.5253098011016846
local_output_nid generation:  0.03772425651550293
local_in_edges_tensor generation:  0.03471231460571289
mini_batch_src_global generation:  0.05549049377441406
r_  generation:  0.5198781490325928
local_output_nid generation:  0.03805661201477051
local_in_edges_tensor generation:  0.039990901947021484
mini_batch_src_global generation:  0.05611753463745117
r_  generation:  0.5276155471801758
local_output_nid generation:  0.03797578811645508
local_in_edges_tensor generation:  0.04308915138244629
mini_batch_src_global generation:  0.05613899230957031
r_  generation:  0.5216617584228516
----------------------check_connections_block total spend ----------------------------- 12.337164163589478
generate_one_block  0.6498622894287109
generate_one_block  0.6573262214660645
generate_one_block  0.6521961688995361
generate_one_block  0.6394450664520264
generate_one_block  0.6500568389892578
generate_one_block  0.6380152702331543
generate_one_block  0.7130377292633057
generate_one_block  0.660027265548706
generate_one_block  0.655534029006958
generate_one_block  0.658484697341919
generate_one_block  0.6575679779052734
generate_one_block  0.634660005569458
generate_one_block  0.6503889560699463
generate_one_block  0.6406471729278564
generate_one_block  0.6356754302978516
generate_one_block  0.6612071990966797
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.8846435546875 GB
    Memory Allocated: 0.15938997268676758  GigaBytes
Max Memory Allocated: 16.072317600250244  GigaBytes

connection checking time:  29.128336191177368
block generation total time  25.598219871520996
average batch blocks generation time:  1.5998887419700623
block dataloader generation time/epoch 57.57129621505737
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8846435546875 GB
    Memory Allocated: 0.11034011840820312  GigaBytes
Max Memory Allocated: 16.072317600250244  GigaBytes

torch.Size([163712, 128])
torch.Size([155685, 32])
torch.Size([123944, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8846435546875 GB
    Memory Allocated: 16.012402057647705  GigaBytes
Max Memory Allocated: 16.072317600250244  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8846435546875 GB
    Memory Allocated: 0.11029911041259766  GigaBytes
Max Memory Allocated: 16.072317600250244  GigaBytes

torch.Size([163811, 128])
torch.Size([155674, 32])
torch.Size([124042, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8846435546875 GB
    Memory Allocated: 16.010058879852295  GigaBytes
Max Memory Allocated: 16.072317600250244  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8846435546875 GB
    Memory Allocated: 0.11023569107055664  GigaBytes
Max Memory Allocated: 16.072317600250244  GigaBytes

torch.Size([163752, 128])
torch.Size([155668, 32])
torch.Size([123794, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8846435546875 GB
    Memory Allocated: 15.983151912689209  GigaBytes
Max Memory Allocated: 16.072317600250244  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8846435546875 GB
    Memory Allocated: 0.11014413833618164  GigaBytes
Max Memory Allocated: 16.072317600250244  GigaBytes

torch.Size([163728, 128])
torch.Size([155392, 32])
torch.Size([123072, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8846435546875 GB
    Memory Allocated: 15.955577373504639  GigaBytes
Max Memory Allocated: 16.072317600250244  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8846435546875 GB
    Memory Allocated: 0.11028242111206055  GigaBytes
Max Memory Allocated: 16.072317600250244  GigaBytes

torch.Size([163549, 128])
torch.Size([155356, 32])
torch.Size([123335, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8846435546875 GB
    Memory Allocated: 15.98314619064331  GigaBytes
Max Memory Allocated: 16.072317600250244  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8846435546875 GB
    Memory Allocated: 0.11014461517333984  GigaBytes
Max Memory Allocated: 16.072317600250244  GigaBytes

torch.Size([163473, 128])
torch.Size([155234, 32])
torch.Size([123353, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8846435546875 GB
    Memory Allocated: 15.993168354034424  GigaBytes
Max Memory Allocated: 16.072317600250244  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8846435546875 GB
    Memory Allocated: 0.1103816032409668  GigaBytes
Max Memory Allocated: 16.072317600250244  GigaBytes

torch.Size([163592, 128])
torch.Size([155368, 32])
torch.Size([124004, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8865966796875 GB
    Memory Allocated: 16.01576042175293  GigaBytes
Max Memory Allocated: 16.072317600250244  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8865966796875 GB
    Memory Allocated: 0.11030387878417969  GigaBytes
Max Memory Allocated: 16.072317600250244  GigaBytes

torch.Size([163707, 128])
torch.Size([155588, 32])
torch.Size([123729, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8865966796875 GB
    Memory Allocated: 16.013166904449463  GigaBytes
Max Memory Allocated: 16.072317600250244  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8865966796875 GB
    Memory Allocated: 0.11035013198852539  GigaBytes
Max Memory Allocated: 16.072317600250244  GigaBytes

torch.Size([163530, 128])
torch.Size([155371, 32])
torch.Size([123889, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8865966796875 GB
    Memory Allocated: 15.992641925811768  GigaBytes
Max Memory Allocated: 16.072317600250244  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8865966796875 GB
    Memory Allocated: 0.11026620864868164  GigaBytes
Max Memory Allocated: 16.072317600250244  GigaBytes

torch.Size([163678, 128])
torch.Size([155604, 32])
torch.Size([124021, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8865966796875 GB
    Memory Allocated: 16.01180934906006  GigaBytes
Max Memory Allocated: 16.072317600250244  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8865966796875 GB
    Memory Allocated: 0.11028623580932617  GigaBytes
Max Memory Allocated: 16.072317600250244  GigaBytes

torch.Size([163823, 128])
torch.Size([156050, 32])
torch.Size([124069, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8865966796875 GB
    Memory Allocated: 16.004351139068604  GigaBytes
Max Memory Allocated: 16.072317600250244  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8865966796875 GB
    Memory Allocated: 0.11022043228149414  GigaBytes
Max Memory Allocated: 16.072317600250244  GigaBytes

torch.Size([163684, 128])
torch.Size([155526, 32])
torch.Size([123598, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8865966796875 GB
    Memory Allocated: 15.993732452392578  GigaBytes
Max Memory Allocated: 16.072317600250244  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8865966796875 GB
    Memory Allocated: 0.11020517349243164  GigaBytes
Max Memory Allocated: 16.072317600250244  GigaBytes

torch.Size([163679, 128])
torch.Size([155562, 32])
torch.Size([123796, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8865966796875 GB
    Memory Allocated: 15.961006164550781  GigaBytes
Max Memory Allocated: 16.072317600250244  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8865966796875 GB
    Memory Allocated: 0.11011409759521484  GigaBytes
Max Memory Allocated: 16.072317600250244  GigaBytes

torch.Size([163615, 128])
torch.Size([155315, 32])
torch.Size([123648, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8865966796875 GB
    Memory Allocated: 15.975180625915527  GigaBytes
Max Memory Allocated: 16.072317600250244  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8865966796875 GB
    Memory Allocated: 0.11033964157104492  GigaBytes
Max Memory Allocated: 16.072317600250244  GigaBytes

torch.Size([163530, 128])
torch.Size([155360, 32])
torch.Size([123317, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8885498046875 GB
    Memory Allocated: 15.997764110565186  GigaBytes
Max Memory Allocated: 16.072317600250244  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8885498046875 GB
    Memory Allocated: 0.11026763916015625  GigaBytes
Max Memory Allocated: 16.072317600250244  GigaBytes

torch.Size([163807, 128])
torch.Size([155662, 32])
torch.Size([123838, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8885498046875 GB
    Memory Allocated: 16.000052452087402  GigaBytes
Max Memory Allocated: 16.072317600250244  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.041135162115097046 |0.02840253710746765 |0.34752097725868225 |9.715557098388672e-05 |0.469333678483963 |0.006922245025634766 |
----------------------------------------------------------pseudo_mini_loss sum 3.9584450721740723
Total (block generation + training)time/epoch 71.80411791801453
Training time/epoch 14.232536554336548
Training time without block to device /epoch 13.778095960617065
Training time without total dataloading part /epoch 13.078151226043701
load block tensor time/epoch 0.6581625938415527
block to device time/epoch 0.4544405937194824
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  7747700
Number of first layer input nodes during this epoch:  2618670
