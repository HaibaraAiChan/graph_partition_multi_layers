Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648467934.2353804
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026974201202392578
range selection method range initialization spend 0.013697385787963867
time for parepare:  0.017758846282958984
local_output_nid generation:  0.010434627532958984
local_in_edges_tensor generation:  0.009304046630859375
mini_batch_src_global generation:  0.015200376510620117
r_  generation:  0.18540263175964355
local_output_nid generation:  0.011668205261230469
local_in_edges_tensor generation:  0.011459589004516602
mini_batch_src_global generation:  0.01982712745666504
r_  generation:  0.19887304306030273
----------------------check_connections_block total spend ----------------------------- 0.5556802749633789
generate_one_block  0.21942543983459473
generate_one_block  0.22307133674621582
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04258298873901367
gen group dst list time:  0.007811546325683594
time for parepare:  0.019296646118164062
local_output_nid generation:  0.016668081283569336
local_in_edges_tensor generation:  0.038934946060180664
mini_batch_src_global generation:  0.05512595176696777
r_  generation:  0.5439774990081787
local_output_nid generation:  0.026482582092285156
local_in_edges_tensor generation:  0.04824399948120117
mini_batch_src_global generation:  0.06395435333251953
r_  generation:  0.5615291595458984
----------------------check_connections_block total spend ----------------------------- 1.613668441772461
generate_one_block  0.7178006172180176
generate_one_block  0.7315754890441895
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.034124135971069336
gen group dst list time:  0.012012243270874023
time for parepare:  0.01883077621459961
local_output_nid generation:  0.022119522094726562
local_in_edges_tensor generation:  0.03912043571472168
mini_batch_src_global generation:  0.05289793014526367
r_  generation:  0.575312614440918
local_output_nid generation:  0.031652212142944336
local_in_edges_tensor generation:  0.05367708206176758
mini_batch_src_global generation:  0.06644511222839355
r_  generation:  0.580000638961792
----------------------check_connections_block total spend ----------------------------- 1.693465232849121
generate_one_block  0.7435119152069092
generate_one_block  0.7356619834899902
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

connection checking time:  3.307133674621582
block generation total time  2.9285500049591064
average batch blocks generation time:  1.4642750024795532
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2010498046875 GB
    Memory Allocated: 0.11150789260864258  GigaBytes
Max Memory Allocated: 0.11150789260864258  GigaBytes

torch.Size([167451, 128])
torch.Size([164288, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.4256591796875 GB
    Memory Allocated: 18.02678394317627  GigaBytes
Max Memory Allocated: 18.084160804748535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.9901123046875 GB
    Memory Allocated: 0.11951208114624023  GigaBytes
Max Memory Allocated: 18.084160804748535  GigaBytes

torch.Size([167470, 128])
torch.Size([164375, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.0135498046875 GB
    Memory Allocated: 18.12331199645996  GigaBytes
Max Memory Allocated: 18.187099933624268  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02420485019683838 |0.15364480018615723 |1.2136452198028564 |0.00013887882232666016 |1.1613301038742065 |0.005012035369873047 |
----------------------------------------------------------pseudo_mini_loss sum 4.387124061584473
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  941810
Number of first layer input nodes during this epoch:  334921
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.0135498046875 GB
    Memory Allocated: 0.17099475860595703  GigaBytes
Max Memory Allocated: 18.187099933624268  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.030678749084472656
range selection method range initialization spend 0.013733863830566406
time for parepare:  0.017934083938598633
local_output_nid generation:  0.010295391082763672
local_in_edges_tensor generation:  0.015208959579467773
mini_batch_src_global generation:  0.014574050903320312
r_  generation:  0.1890113353729248
local_output_nid generation:  0.011761188507080078
local_in_edges_tensor generation:  0.01170206069946289
mini_batch_src_global generation:  0.020818710327148438
r_  generation:  0.20501232147216797
----------------------check_connections_block total spend ----------------------------- 0.5712485313415527
generate_one_block  0.253253698348999
generate_one_block  0.2610445022583008
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.042191267013549805
gen group dst list time:  0.007821083068847656
time for parepare:  0.01951003074645996
local_output_nid generation:  0.01639103889465332
local_in_edges_tensor generation:  0.041728973388671875
mini_batch_src_global generation:  0.055542707443237305
r_  generation:  0.5607397556304932
local_output_nid generation:  0.02599787712097168
local_in_edges_tensor generation:  0.048110246658325195
mini_batch_src_global generation:  0.0679159164428711
r_  generation:  0.5699858665466309
----------------------check_connections_block total spend ----------------------------- 1.6493206024169922
generate_one_block  0.7683391571044922
generate_one_block  0.7752504348754883
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03521442413330078
gen group dst list time:  0.01224660873413086
time for parepare:  0.019414186477661133
local_output_nid generation:  0.021013259887695312
local_in_edges_tensor generation:  0.03975176811218262
mini_batch_src_global generation:  0.0524904727935791
r_  generation:  0.5863943099975586
local_output_nid generation:  0.030637741088867188
local_in_edges_tensor generation:  0.057417869567871094
mini_batch_src_global generation:  0.07025003433227539
r_  generation:  0.5909864902496338
----------------------check_connections_block total spend ----------------------------- 1.724571704864502
generate_one_block  0.7847163677215576
generate_one_block  0.8028378486633301
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.0135498046875 GB
    Memory Allocated: 0.17099475860595703  GigaBytes
Max Memory Allocated: 18.187099933624268  GigaBytes

connection checking time:  3.373892307281494
block generation total time  3.131143808364868
average batch blocks generation time:  1.565571904182434
block dataloader generation time/epoch 8.64688754081726
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.0135498046875 GB
    Memory Allocated: 0.12011194229125977  GigaBytes
Max Memory Allocated: 18.187099933624268  GigaBytes

torch.Size([167410, 128])
torch.Size([164343, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8846435546875 GB
    Memory Allocated: 18.106226444244385  GigaBytes
Max Memory Allocated: 18.187099933624268  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8846435546875 GB
    Memory Allocated: 0.1201786994934082  GigaBytes
Max Memory Allocated: 18.187099933624268  GigaBytes

torch.Size([167443, 128])
torch.Size([164381, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8846435546875 GB
    Memory Allocated: 18.12301206588745  GigaBytes
Max Memory Allocated: 18.187099933624268  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03742051124572754 |0.03614318370819092 |0.6987392902374268 |0.00014078617095947266 |1.1377087831497192 |0.006356716156005859 |
----------------------------------------------------------pseudo_mini_loss sum 3.718961238861084
Total (block generation + training)time/epoch 12.496448516845703
Training time/epoch 3.849256753921509
Training time without block to device /epoch 3.776970386505127
Training time without total dataloading part /epoch 3.679534435272217
load block tensor time/epoch 0.07484102249145508
block to device time/epoch 0.07228636741638184
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  942196
Number of first layer input nodes during this epoch:  334853
