Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648466574.2251096
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02725052833557129
range selection method range initialization spend 0.01719498634338379
time for parepare:  0.017894983291625977
local_output_nid generation:  0.0007181167602539062
local_in_edges_tensor generation:  0.003194570541381836
mini_batch_src_global generation:  0.002014636993408203
r_  generation:  0.012350320816040039
local_output_nid generation:  0.0008442401885986328
local_in_edges_tensor generation:  0.0006513595581054688
mini_batch_src_global generation:  0.0015263557434082031
r_  generation:  0.009567499160766602
local_output_nid generation:  0.0007948875427246094
local_in_edges_tensor generation:  0.0005555152893066406
mini_batch_src_global generation:  0.0009889602661132812
r_  generation:  0.00921773910522461
local_output_nid generation:  0.0007870197296142578
local_in_edges_tensor generation:  0.0005137920379638672
mini_batch_src_global generation:  0.0009090900421142578
r_  generation:  0.00927424430847168
local_output_nid generation:  0.0007691383361816406
local_in_edges_tensor generation:  0.0005066394805908203
mini_batch_src_global generation:  0.0009031295776367188
r_  generation:  0.009491920471191406
local_output_nid generation:  0.0008060932159423828
local_in_edges_tensor generation:  0.000492095947265625
mini_batch_src_global generation:  0.0009069442749023438
r_  generation:  0.009607791900634766
local_output_nid generation:  0.0007851123809814453
local_in_edges_tensor generation:  0.0004923343658447266
mini_batch_src_global generation:  0.0009224414825439453
r_  generation:  0.009252309799194336
local_output_nid generation:  0.0007736682891845703
local_in_edges_tensor generation:  0.00048160552978515625
mini_batch_src_global generation:  0.0009291172027587891
r_  generation:  0.009627342224121094
local_output_nid generation:  0.000762939453125
local_in_edges_tensor generation:  0.0004951953887939453
mini_batch_src_global generation:  0.0009205341339111328
r_  generation:  0.009807825088500977
local_output_nid generation:  0.0007622241973876953
local_in_edges_tensor generation:  0.0004818439483642578
mini_batch_src_global generation:  0.0009021759033203125
r_  generation:  0.009235143661499023
local_output_nid generation:  0.0007672309875488281
local_in_edges_tensor generation:  0.0004940032958984375
mini_batch_src_global generation:  0.0009405612945556641
r_  generation:  0.009552001953125
local_output_nid generation:  0.0007565021514892578
local_in_edges_tensor generation:  0.000469207763671875
mini_batch_src_global generation:  0.0010781288146972656
r_  generation:  0.009900569915771484
local_output_nid generation:  0.0007536411285400391
local_in_edges_tensor generation:  0.00047588348388671875
mini_batch_src_global generation:  0.000946044921875
r_  generation:  0.009798288345336914
local_output_nid generation:  0.0007643699645996094
local_in_edges_tensor generation:  0.00048613548278808594
mini_batch_src_global generation:  0.0009303092956542969
r_  generation:  0.009727239608764648
local_output_nid generation:  0.0007483959197998047
local_in_edges_tensor generation:  0.0004773139953613281
mini_batch_src_global generation:  0.0009658336639404297
r_  generation:  0.009977102279663086
local_output_nid generation:  0.0007526874542236328
local_in_edges_tensor generation:  0.00048351287841796875
mini_batch_src_global generation:  0.0009870529174804688
r_  generation:  0.010136842727661133
local_output_nid generation:  0.0007538795471191406
local_in_edges_tensor generation:  0.0004673004150390625
mini_batch_src_global generation:  0.000988006591796875
r_  generation:  0.00981283187866211
local_output_nid generation:  0.0007445812225341797
local_in_edges_tensor generation:  0.00047898292541503906
mini_batch_src_global generation:  0.0009675025939941406
r_  generation:  0.009732484817504883
local_output_nid generation:  0.0007517337799072266
local_in_edges_tensor generation:  0.0004756450653076172
mini_batch_src_global generation:  0.0009894371032714844
r_  generation:  0.010164260864257812
local_output_nid generation:  0.00075531005859375
local_in_edges_tensor generation:  0.00047206878662109375
mini_batch_src_global generation:  0.0009829998016357422
r_  generation:  0.009638309478759766
local_output_nid generation:  0.0007548332214355469
local_in_edges_tensor generation:  0.0004744529724121094
mini_batch_src_global generation:  0.0010099411010742188
r_  generation:  0.010103702545166016
local_output_nid generation:  0.0007638931274414062
local_in_edges_tensor generation:  0.00047206878662109375
mini_batch_src_global generation:  0.0009996891021728516
r_  generation:  0.009766101837158203
local_output_nid generation:  0.0007488727569580078
local_in_edges_tensor generation:  0.00047898292541503906
mini_batch_src_global generation:  0.001028299331665039
r_  generation:  0.010204792022705078
local_output_nid generation:  0.0007557868957519531
local_in_edges_tensor generation:  0.0004673004150390625
mini_batch_src_global generation:  0.0010416507720947266
r_  generation:  0.010121583938598633
local_output_nid generation:  0.0007505416870117188
local_in_edges_tensor generation:  0.0004911422729492188
mini_batch_src_global generation:  0.0010175704956054688
r_  generation:  0.01033329963684082
local_output_nid generation:  0.0007731914520263672
local_in_edges_tensor generation:  0.0004992485046386719
mini_batch_src_global generation:  0.0010313987731933594
r_  generation:  0.010206460952758789
local_output_nid generation:  0.0007424354553222656
local_in_edges_tensor generation:  0.00048351287841796875
mini_batch_src_global generation:  0.0010216236114501953
r_  generation:  0.009860515594482422
local_output_nid generation:  0.0007543563842773438
local_in_edges_tensor generation:  0.0004718303680419922
mini_batch_src_global generation:  0.0010232925415039062
r_  generation:  0.009879589080810547
local_output_nid generation:  0.000759124755859375
local_in_edges_tensor generation:  0.00047135353088378906
mini_batch_src_global generation:  0.0012278556823730469
r_  generation:  0.01433563232421875
local_output_nid generation:  0.0008134841918945312
local_in_edges_tensor generation:  0.0045583248138427734
mini_batch_src_global generation:  0.0013568401336669922
r_  generation:  0.010413646697998047
local_output_nid generation:  0.0008082389831542969
local_in_edges_tensor generation:  0.0005171298980712891
mini_batch_src_global generation:  0.0011038780212402344
r_  generation:  0.010082721710205078
local_output_nid generation:  0.0007977485656738281
local_in_edges_tensor generation:  0.0004801750183105469
mini_batch_src_global generation:  0.0011436939239501953
r_  generation:  0.009976387023925781
----------------------check_connections_block total spend ----------------------------- 0.49474263191223145
generate_one_block  0.015906810760498047
generate_one_block  0.014974832534790039
generate_one_block  0.014757633209228516
generate_one_block  0.014937162399291992
generate_one_block  0.014952421188354492
generate_one_block  0.014887094497680664
generate_one_block  0.014185428619384766
generate_one_block  0.015029430389404297
generate_one_block  0.01485896110534668
generate_one_block  0.01414799690246582
generate_one_block  0.014555215835571289
generate_one_block  0.014625072479248047
generate_one_block  0.014622211456298828
generate_one_block  0.014435052871704102
generate_one_block  0.015136480331420898
generate_one_block  0.014922380447387695
generate_one_block  0.014652252197265625
generate_one_block  0.01468658447265625
generate_one_block  0.015045642852783203
generate_one_block  0.014307737350463867
generate_one_block  0.015123128890991211
generate_one_block  0.014526605606079102
generate_one_block  0.01535940170288086
generate_one_block  0.014755487442016602
generate_one_block  0.014978170394897461
generate_one_block  0.015029430389404297
generate_one_block  0.014627456665039062
generate_one_block  0.01455998420715332
generate_one_block  0.016180992126464844
generate_one_block  0.01858067512512207
generate_one_block  0.015748262405395508
generate_one_block  0.014847517013549805
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.041448354721069336
gen group dst list time:  0.02587890625
time for parepare:  0.018903017044067383
local_output_nid generation:  0.004179477691650391
local_in_edges_tensor generation:  0.012873172760009766
mini_batch_src_global generation:  0.016046762466430664
r_  generation:  0.13674688339233398
local_output_nid generation:  0.006991386413574219
local_in_edges_tensor generation:  0.012511968612670898
mini_batch_src_global generation:  0.017292022705078125
r_  generation:  0.14105772972106934
local_output_nid generation:  0.007096290588378906
local_in_edges_tensor generation:  0.009721040725708008
mini_batch_src_global generation:  0.015525341033935547
r_  generation:  0.1391129493713379
local_output_nid generation:  0.006989955902099609
local_in_edges_tensor generation:  0.009865522384643555
mini_batch_src_global generation:  0.016463518142700195
r_  generation:  0.1457207202911377
local_output_nid generation:  0.007159709930419922
local_in_edges_tensor generation:  0.010360956192016602
mini_batch_src_global generation:  0.017470598220825195
r_  generation:  0.15271735191345215
local_output_nid generation:  0.007349729537963867
local_in_edges_tensor generation:  0.008056163787841797
mini_batch_src_global generation:  0.018025636672973633
r_  generation:  0.15319180488586426
local_output_nid generation:  0.006963253021240234
local_in_edges_tensor generation:  0.008701801300048828
mini_batch_src_global generation:  0.017233848571777344
r_  generation:  0.14572834968566895
local_output_nid generation:  0.007430076599121094
local_in_edges_tensor generation:  0.010500669479370117
mini_batch_src_global generation:  0.018312931060791016
r_  generation:  0.1518871784210205
local_output_nid generation:  0.01058650016784668
local_in_edges_tensor generation:  0.010686159133911133
mini_batch_src_global generation:  0.01948714256286621
r_  generation:  0.15402507781982422
local_output_nid generation:  0.007056474685668945
local_in_edges_tensor generation:  0.00776982307434082
mini_batch_src_global generation:  0.01790022850036621
r_  generation:  0.14426279067993164
local_output_nid generation:  0.007392406463623047
local_in_edges_tensor generation:  0.008003711700439453
mini_batch_src_global generation:  0.021431922912597656
r_  generation:  0.157545804977417
local_output_nid generation:  0.008283853530883789
local_in_edges_tensor generation:  0.016706228256225586
mini_batch_src_global generation:  0.020275115966796875
r_  generation:  0.16122102737426758
local_output_nid generation:  0.009625673294067383
local_in_edges_tensor generation:  0.010205268859863281
mini_batch_src_global generation:  0.018388986587524414
r_  generation:  0.15187764167785645
local_output_nid generation:  0.007688760757446289
local_in_edges_tensor generation:  0.008534669876098633
mini_batch_src_global generation:  0.017817020416259766
r_  generation:  0.14510488510131836
local_output_nid generation:  0.007948160171508789
local_in_edges_tensor generation:  0.0095977783203125
mini_batch_src_global generation:  0.019502639770507812
r_  generation:  0.15055084228515625
local_output_nid generation:  0.008012533187866211
local_in_edges_tensor generation:  0.009524822235107422
mini_batch_src_global generation:  0.01989006996154785
r_  generation:  0.152632474899292
local_output_nid generation:  0.007927894592285156
local_in_edges_tensor generation:  0.010797739028930664
mini_batch_src_global generation:  0.018795251846313477
r_  generation:  0.15256094932556152
local_output_nid generation:  0.0077631473541259766
local_in_edges_tensor generation:  0.008075952529907227
mini_batch_src_global generation:  0.018071651458740234
r_  generation:  0.14504122734069824
local_output_nid generation:  0.008041620254516602
local_in_edges_tensor generation:  0.008564233779907227
mini_batch_src_global generation:  0.01875591278076172
r_  generation:  0.1546461582183838
local_output_nid generation:  0.0077970027923583984
local_in_edges_tensor generation:  0.010423898696899414
mini_batch_src_global generation:  0.018325328826904297
r_  generation:  0.14894318580627441
local_output_nid generation:  0.008118152618408203
local_in_edges_tensor generation:  0.008637428283691406
mini_batch_src_global generation:  0.019924163818359375
r_  generation:  0.15580463409423828
local_output_nid generation:  0.0079498291015625
local_in_edges_tensor generation:  0.010680913925170898
mini_batch_src_global generation:  0.018728256225585938
r_  generation:  0.1517643928527832
local_output_nid generation:  0.008174896240234375
local_in_edges_tensor generation:  0.011015653610229492
mini_batch_src_global generation:  0.019133806228637695
r_  generation:  0.15825796127319336
local_output_nid generation:  0.007993936538696289
local_in_edges_tensor generation:  0.008428812026977539
mini_batch_src_global generation:  0.018779754638671875
r_  generation:  0.15065813064575195
local_output_nid generation:  0.008082151412963867
local_in_edges_tensor generation:  0.00964212417602539
mini_batch_src_global generation:  0.01883864402770996
r_  generation:  0.15610694885253906
local_output_nid generation:  0.008011817932128906
local_in_edges_tensor generation:  0.010816574096679688
mini_batch_src_global generation:  0.01921558380126953
r_  generation:  0.15447449684143066
local_output_nid generation:  0.00781702995300293
local_in_edges_tensor generation:  0.008118629455566406
mini_batch_src_global generation:  0.01828789710998535
r_  generation:  0.15120267868041992
local_output_nid generation:  0.007903099060058594
local_in_edges_tensor generation:  0.008239269256591797
mini_batch_src_global generation:  0.018344879150390625
r_  generation:  0.15180373191833496
local_output_nid generation:  0.008445024490356445
local_in_edges_tensor generation:  0.012863397598266602
mini_batch_src_global generation:  0.02106618881225586
r_  generation:  0.1648244857788086
local_output_nid generation:  0.008010149002075195
local_in_edges_tensor generation:  0.008196353912353516
mini_batch_src_global generation:  0.021970748901367188
r_  generation:  0.15217924118041992
local_output_nid generation:  0.008070945739746094
local_in_edges_tensor generation:  0.008565664291381836
mini_batch_src_global generation:  0.018637895584106445
r_  generation:  0.15499472618103027
local_output_nid generation:  0.007994651794433594
local_in_edges_tensor generation:  0.009553909301757812
mini_batch_src_global generation:  0.01984238624572754
r_  generation:  0.15532183647155762
----------------------check_connections_block total spend ----------------------------- 7.155135154724121
generate_one_block  0.22111082077026367
generate_one_block  0.19601082801818848
generate_one_block  0.21387028694152832
generate_one_block  0.18547558784484863
generate_one_block  0.191314697265625
generate_one_block  0.1920166015625
generate_one_block  0.20056986808776855
generate_one_block  0.18950939178466797
generate_one_block  0.19345593452453613
generate_one_block  0.17695403099060059
generate_one_block  0.19144582748413086
generate_one_block  0.18579316139221191
generate_one_block  0.18616962432861328
generate_one_block  0.18105292320251465
generate_one_block  0.19015288352966309
generate_one_block  0.22067594528198242
generate_one_block  0.18962430953979492
generate_one_block  0.18405747413635254
generate_one_block  0.19016718864440918
generate_one_block  0.18432831764221191
generate_one_block  0.19705677032470703
generate_one_block  0.18858742713928223
generate_one_block  0.19930458068847656
generate_one_block  0.1859912872314453
generate_one_block  0.19367718696594238
generate_one_block  0.1937859058380127
generate_one_block  0.18233871459960938
generate_one_block  0.1851813793182373
generate_one_block  0.20844340324401855
generate_one_block  0.18551397323608398
generate_one_block  0.1859900951385498
generate_one_block  0.19603395462036133
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.049569129943847656
gen group dst list time:  0.10191154479980469
time for parepare:  0.02045297622680664
local_output_nid generation:  0.02133488655090332
local_in_edges_tensor generation:  0.05016064643859863
mini_batch_src_global generation:  0.04068470001220703
r_  generation:  0.3914189338684082
local_output_nid generation:  0.02703857421875
local_in_edges_tensor generation:  0.04001259803771973
mini_batch_src_global generation:  0.04710030555725098
r_  generation:  0.40643906593322754
local_output_nid generation:  0.027804851531982422
local_in_edges_tensor generation:  0.03612089157104492
mini_batch_src_global generation:  0.05171513557434082
r_  generation:  0.40592408180236816
local_output_nid generation:  0.025661230087280273
local_in_edges_tensor generation:  0.025465965270996094
mini_batch_src_global generation:  0.047553300857543945
r_  generation:  0.4062538146972656
local_output_nid generation:  0.0262753963470459
local_in_edges_tensor generation:  0.03317832946777344
mini_batch_src_global generation:  0.047782182693481445
r_  generation:  0.4113438129425049
local_output_nid generation:  0.026302099227905273
local_in_edges_tensor generation:  0.03703594207763672
mini_batch_src_global generation:  0.047966957092285156
r_  generation:  0.4177381992340088
local_output_nid generation:  0.025748729705810547
local_in_edges_tensor generation:  0.03573775291442871
mini_batch_src_global generation:  0.050551414489746094
r_  generation:  0.40224766731262207
local_output_nid generation:  0.02624344825744629
local_in_edges_tensor generation:  0.03335428237915039
mini_batch_src_global generation:  0.050594329833984375
r_  generation:  0.4248948097229004
local_output_nid generation:  0.029010772705078125
local_in_edges_tensor generation:  0.03381752967834473
mini_batch_src_global generation:  0.04926562309265137
r_  generation:  0.4160783290863037
local_output_nid generation:  0.026904582977294922
local_in_edges_tensor generation:  0.025937795639038086
mini_batch_src_global generation:  0.04851341247558594
r_  generation:  0.407135009765625
local_output_nid generation:  0.027425765991210938
local_in_edges_tensor generation:  0.02956104278564453
mini_batch_src_global generation:  0.05045366287231445
r_  generation:  0.4139869213104248
local_output_nid generation:  0.0269625186920166
local_in_edges_tensor generation:  0.029239177703857422
mini_batch_src_global generation:  0.04861283302307129
r_  generation:  0.40714168548583984
local_output_nid generation:  0.02736806869506836
local_in_edges_tensor generation:  0.030416250228881836
mini_batch_src_global generation:  0.04844808578491211
r_  generation:  0.4211606979370117
local_output_nid generation:  0.026961565017700195
local_in_edges_tensor generation:  0.02898406982421875
mini_batch_src_global generation:  0.04897785186767578
r_  generation:  0.40914416313171387
local_output_nid generation:  0.027301549911499023
local_in_edges_tensor generation:  0.03400421142578125
mini_batch_src_global generation:  0.05062532424926758
r_  generation:  0.4166438579559326
local_output_nid generation:  0.027385234832763672
local_in_edges_tensor generation:  0.02957606315612793
mini_batch_src_global generation:  0.048795223236083984
r_  generation:  0.4098193645477295
local_output_nid generation:  0.02720785140991211
local_in_edges_tensor generation:  0.029620647430419922
mini_batch_src_global generation:  0.04851126670837402
r_  generation:  0.41527295112609863
local_output_nid generation:  0.02725505828857422
local_in_edges_tensor generation:  0.03023386001586914
mini_batch_src_global generation:  0.050180673599243164
r_  generation:  0.41235852241516113
local_output_nid generation:  0.02724003791809082
local_in_edges_tensor generation:  0.03380727767944336
mini_batch_src_global generation:  0.04795050621032715
r_  generation:  0.4210059642791748
local_output_nid generation:  0.028304338455200195
local_in_edges_tensor generation:  0.03275632858276367
mini_batch_src_global generation:  0.04967665672302246
r_  generation:  0.41340184211730957
local_output_nid generation:  0.027315139770507812
local_in_edges_tensor generation:  0.02835536003112793
mini_batch_src_global generation:  0.0484316349029541
r_  generation:  0.4301943778991699
local_output_nid generation:  0.026881933212280273
local_in_edges_tensor generation:  0.039112091064453125
mini_batch_src_global generation:  0.06224822998046875
r_  generation:  0.4139094352722168
local_output_nid generation:  0.02867722511291504
local_in_edges_tensor generation:  0.032823801040649414
mini_batch_src_global generation:  0.0506136417388916
r_  generation:  0.4215092658996582
local_output_nid generation:  0.027173280715942383
local_in_edges_tensor generation:  0.02538442611694336
mini_batch_src_global generation:  0.04870963096618652
r_  generation:  0.41002440452575684
local_output_nid generation:  0.027612686157226562
local_in_edges_tensor generation:  0.03207969665527344
mini_batch_src_global generation:  0.04771709442138672
r_  generation:  0.4174673557281494
local_output_nid generation:  0.027509450912475586
local_in_edges_tensor generation:  0.029379606246948242
mini_batch_src_global generation:  0.04928898811340332
r_  generation:  0.4134550094604492
local_output_nid generation:  0.027269363403320312
local_in_edges_tensor generation:  0.02498173713684082
mini_batch_src_global generation:  0.04824542999267578
r_  generation:  0.41614723205566406
local_output_nid generation:  0.02769303321838379
local_in_edges_tensor generation:  0.028783082962036133
mini_batch_src_global generation:  0.05159735679626465
r_  generation:  0.41355061531066895
local_output_nid generation:  0.027848243713378906
local_in_edges_tensor generation:  0.029301881790161133
mini_batch_src_global generation:  0.05793166160583496
r_  generation:  0.42751336097717285
local_output_nid generation:  0.028270959854125977
local_in_edges_tensor generation:  0.03565621376037598
mini_batch_src_global generation:  0.04938030242919922
r_  generation:  0.4136028289794922
local_output_nid generation:  0.027364730834960938
local_in_edges_tensor generation:  0.02867722511291504
mini_batch_src_global generation:  0.04840731620788574
r_  generation:  0.4218161106109619
local_output_nid generation:  0.02745962142944336
local_in_edges_tensor generation:  0.03512740135192871
mini_batch_src_global generation:  0.052727460861206055
r_  generation:  0.41533899307250977
----------------------check_connections_block total spend ----------------------------- 19.6265606880188
generate_one_block  0.6396851539611816
generate_one_block  0.5330581665039062
generate_one_block  0.5227422714233398
generate_one_block  0.5335719585418701
generate_one_block  0.6034972667694092
generate_one_block  0.5818557739257812
generate_one_block  0.5346214771270752
generate_one_block  0.5355396270751953
generate_one_block  0.5346972942352295
generate_one_block  0.5121757984161377
generate_one_block  0.5224289894104004
generate_one_block  0.519711971282959
generate_one_block  0.5415019989013672
generate_one_block  0.5303707122802734
generate_one_block  0.5378732681274414
generate_one_block  0.5550491809844971
generate_one_block  0.5309617519378662
generate_one_block  0.5230600833892822
generate_one_block  0.5275685787200928
generate_one_block  0.5306751728057861
generate_one_block  0.554145097732544
generate_one_block  0.5356979370117188
generate_one_block  0.5586674213409424
generate_one_block  0.5240285396575928
generate_one_block  0.5229842662811279
generate_one_block  0.5297985076904297
generate_one_block  0.5205662250518799
generate_one_block  0.5409431457519531
generate_one_block  0.5591335296630859
generate_one_block  0.538250207901001
generate_one_block  0.5310287475585938
generate_one_block  0.5377388000488281
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

connection checking time:  26.78169584274292
block generation total time  23.469289302825928
average batch blocks generation time:  0.7334152907133102
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1717529296875 GB
    Memory Allocated: 0.08416032791137695  GigaBytes
Max Memory Allocated: 0.08416032791137695  GigaBytes

torch.Size([146742, 128])
torch.Size([103375, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.4295654296875 GB
    Memory Allocated: 10.580979824066162  GigaBytes
Max Memory Allocated: 10.58469295501709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.4354248046875 GB
    Memory Allocated: 0.08489227294921875  GigaBytes
Max Memory Allocated: 10.58469295501709  GigaBytes

torch.Size([146027, 128])
torch.Size([101895, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6717529296875 GB
    Memory Allocated: 10.51036024093628  GigaBytes
Max Memory Allocated: 10.58469295501709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6717529296875 GB
    Memory Allocated: 0.08550786972045898  GigaBytes
Max Memory Allocated: 10.58469295501709  GigaBytes

torch.Size([146115, 128])
torch.Size([101968, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6717529296875 GB
    Memory Allocated: 10.442843914031982  GigaBytes
Max Memory Allocated: 10.58469295501709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6717529296875 GB
    Memory Allocated: 0.08486509323120117  GigaBytes
Max Memory Allocated: 10.58469295501709  GigaBytes

torch.Size([146068, 128])
torch.Size([101419, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6717529296875 GB
    Memory Allocated: 10.427305698394775  GigaBytes
Max Memory Allocated: 10.58469295501709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6717529296875 GB
    Memory Allocated: 0.08557796478271484  GigaBytes
Max Memory Allocated: 10.58469295501709  GigaBytes

torch.Size([146316, 128])
torch.Size([102779, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6717529296875 GB
    Memory Allocated: 10.549564838409424  GigaBytes
Max Memory Allocated: 10.58469295501709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6717529296875 GB
    Memory Allocated: 0.0850520133972168  GigaBytes
Max Memory Allocated: 10.58469295501709  GigaBytes

torch.Size([146370, 128])
torch.Size([102649, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6717529296875 GB
    Memory Allocated: 10.512980461120605  GigaBytes
Max Memory Allocated: 10.58469295501709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6717529296875 GB
    Memory Allocated: 0.08546018600463867  GigaBytes
Max Memory Allocated: 10.58469295501709  GigaBytes

torch.Size([145499, 128])
torch.Size([99772, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6717529296875 GB
    Memory Allocated: 10.340028762817383  GigaBytes
Max Memory Allocated: 10.58469295501709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6717529296875 GB
    Memory Allocated: 0.08534669876098633  GigaBytes
Max Memory Allocated: 10.58469295501709  GigaBytes

torch.Size([146983, 128])
torch.Size([102735, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6717529296875 GB
    Memory Allocated: 10.536125183105469  GigaBytes
Max Memory Allocated: 10.58469295501709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6717529296875 GB
    Memory Allocated: 0.08557987213134766  GigaBytes
Max Memory Allocated: 10.58469295501709  GigaBytes

torch.Size([146733, 128])
torch.Size([103240, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6717529296875 GB
    Memory Allocated: 10.564069747924805  GigaBytes
Max Memory Allocated: 10.58469295501709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6717529296875 GB
    Memory Allocated: 0.08506488800048828  GigaBytes
Max Memory Allocated: 10.58469295501709  GigaBytes

torch.Size([146702, 128])
torch.Size([101370, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6717529296875 GB
    Memory Allocated: 10.349663734436035  GigaBytes
Max Memory Allocated: 10.58469295501709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6717529296875 GB
    Memory Allocated: 0.08553886413574219  GigaBytes
Max Memory Allocated: 10.58469295501709  GigaBytes

torch.Size([145978, 128])
torch.Size([101612, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6717529296875 GB
    Memory Allocated: 10.474022388458252  GigaBytes
Max Memory Allocated: 10.58469295501709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6717529296875 GB
    Memory Allocated: 0.08465147018432617  GigaBytes
Max Memory Allocated: 10.58469295501709  GigaBytes

torch.Size([145643, 128])
torch.Size([101141, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6717529296875 GB
    Memory Allocated: 10.401391506195068  GigaBytes
Max Memory Allocated: 10.58469295501709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6717529296875 GB
    Memory Allocated: 0.08553028106689453  GigaBytes
Max Memory Allocated: 10.58469295501709  GigaBytes

torch.Size([146368, 128])
torch.Size([102589, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6717529296875 GB
    Memory Allocated: 10.522407054901123  GigaBytes
Max Memory Allocated: 10.58469295501709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6717529296875 GB
    Memory Allocated: 0.0848994255065918  GigaBytes
Max Memory Allocated: 10.58469295501709  GigaBytes

torch.Size([146244, 128])
torch.Size([101181, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6717529296875 GB
    Memory Allocated: 10.351438045501709  GigaBytes
Max Memory Allocated: 10.58469295501709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6717529296875 GB
    Memory Allocated: 0.08553361892700195  GigaBytes
Max Memory Allocated: 10.58469295501709  GigaBytes

torch.Size([146291, 128])
torch.Size([102731, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6717529296875 GB
    Memory Allocated: 10.480335235595703  GigaBytes
Max Memory Allocated: 10.58469295501709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6717529296875 GB
    Memory Allocated: 0.08509683609008789  GigaBytes
Max Memory Allocated: 10.58469295501709  GigaBytes

torch.Size([146478, 128])
torch.Size([102513, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6717529296875 GB
    Memory Allocated: 10.515955448150635  GigaBytes
Max Memory Allocated: 10.58469295501709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6717529296875 GB
    Memory Allocated: 0.0855565071105957  GigaBytes
Max Memory Allocated: 10.58469295501709  GigaBytes

torch.Size([145860, 128])
torch.Size([101852, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6717529296875 GB
    Memory Allocated: 10.483243465423584  GigaBytes
Max Memory Allocated: 10.58469295501709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6717529296875 GB
    Memory Allocated: 0.08500242233276367  GigaBytes
Max Memory Allocated: 10.58469295501709  GigaBytes

torch.Size([146449, 128])
torch.Size([101910, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6717529296875 GB
    Memory Allocated: 10.403193950653076  GigaBytes
Max Memory Allocated: 10.58469295501709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6717529296875 GB
    Memory Allocated: 0.08556747436523438  GigaBytes
Max Memory Allocated: 10.58469295501709  GigaBytes

torch.Size([146366, 128])
torch.Size([102265, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6717529296875 GB
    Memory Allocated: 10.506054401397705  GigaBytes
Max Memory Allocated: 10.58469295501709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6717529296875 GB
    Memory Allocated: 0.08501672744750977  GigaBytes
Max Memory Allocated: 10.58469295501709  GigaBytes

torch.Size([146454, 128])
torch.Size([102188, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6717529296875 GB
    Memory Allocated: 10.460565567016602  GigaBytes
Max Memory Allocated: 10.58469295501709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6717529296875 GB
    Memory Allocated: 0.08559608459472656  GigaBytes
Max Memory Allocated: 10.58469295501709  GigaBytes

torch.Size([147122, 128])
torch.Size([103289, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6717529296875 GB
    Memory Allocated: 10.569001197814941  GigaBytes
Max Memory Allocated: 10.58469295501709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6717529296875 GB
    Memory Allocated: 0.08493328094482422  GigaBytes
Max Memory Allocated: 10.58469295501709  GigaBytes

torch.Size([146152, 128])
torch.Size([102082, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.1483154296875 GB
    Memory Allocated: 10.53226613998413  GigaBytes
Max Memory Allocated: 10.58469295501709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.1483154296875 GB
    Memory Allocated: 0.08562135696411133  GigaBytes
Max Memory Allocated: 10.58469295501709  GigaBytes

torch.Size([146556, 128])
torch.Size([103648, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 10.61073637008667  GigaBytes
Max Memory Allocated: 10.614895343780518  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.08514881134033203  GigaBytes
Max Memory Allocated: 10.614895343780518  GigaBytes

torch.Size([146622, 128])
torch.Size([102405, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 10.470449924468994  GigaBytes
Max Memory Allocated: 10.614895343780518  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.08559226989746094  GigaBytes
Max Memory Allocated: 10.614895343780518  GigaBytes

torch.Size([146351, 128])
torch.Size([102367, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 10.513393878936768  GigaBytes
Max Memory Allocated: 10.614895343780518  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.08485651016235352  GigaBytes
Max Memory Allocated: 10.614895343780518  GigaBytes

torch.Size([145915, 128])
torch.Size([102603, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 10.552088260650635  GigaBytes
Max Memory Allocated: 10.614895343780518  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.08551359176635742  GigaBytes
Max Memory Allocated: 10.614895343780518  GigaBytes

torch.Size([146283, 128])
torch.Size([101835, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 10.4266996383667  GigaBytes
Max Memory Allocated: 10.614895343780518  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.08508634567260742  GigaBytes
Max Memory Allocated: 10.614895343780518  GigaBytes

torch.Size([146527, 128])
torch.Size([103126, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 10.540898323059082  GigaBytes
Max Memory Allocated: 10.614895343780518  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.08572530746459961  GigaBytes
Max Memory Allocated: 10.614895343780518  GigaBytes

torch.Size([146966, 128])
torch.Size([104354, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 10.717714786529541  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 0.08504056930541992  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

torch.Size([146401, 128])
torch.Size([102274, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 10.477191925048828  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 0.08554458618164062  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

torch.Size([146303, 128])
torch.Size([102149, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 10.5008225440979  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 0.08509349822998047  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

torch.Size([146504, 128])
torch.Size([102974, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 10.500511646270752  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.028960108757019043 |0.027617081999778748 |0.403122715651989 |0.00010959804058074951 |0.5920441895723343 |0.011474132537841797 |
----------------------------------------------------------pseudo_mini_loss sum 4.395962238311768
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  8797494
Number of first layer input nodes during this epoch:  4683388
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 0.104949951171875  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.030842304229736328
range selection method range initialization spend 0.013943910598754883
time for parepare:  0.021391868591308594
local_output_nid generation:  0.0011398792266845703
local_in_edges_tensor generation:  0.006067752838134766
mini_batch_src_global generation:  0.0021996498107910156
r_  generation:  0.011084794998168945
local_output_nid generation:  0.0010421276092529297
local_in_edges_tensor generation:  0.0007412433624267578
mini_batch_src_global generation:  0.0018863677978515625
r_  generation:  0.01129603385925293
local_output_nid generation:  0.0009915828704833984
local_in_edges_tensor generation:  0.0006961822509765625
mini_batch_src_global generation:  0.0012862682342529297
r_  generation:  0.009941816329956055
local_output_nid generation:  0.0009605884552001953
local_in_edges_tensor generation:  0.0006515979766845703
mini_batch_src_global generation:  0.0011632442474365234
r_  generation:  0.009965181350708008
local_output_nid generation:  0.0009560585021972656
local_in_edges_tensor generation:  0.0006501674652099609
mini_batch_src_global generation:  0.0011904239654541016
r_  generation:  0.009922027587890625
local_output_nid generation:  0.0009703636169433594
local_in_edges_tensor generation:  0.0006167888641357422
mini_batch_src_global generation:  0.001149892807006836
r_  generation:  0.010306119918823242
local_output_nid generation:  0.0009713172912597656
local_in_edges_tensor generation:  0.0010800361633300781
mini_batch_src_global generation:  0.0035924911499023438
r_  generation:  0.018122196197509766
local_output_nid generation:  0.0013380050659179688
local_in_edges_tensor generation:  0.0006859302520751953
mini_batch_src_global generation:  0.0013306140899658203
r_  generation:  0.010701179504394531
local_output_nid generation:  0.0010650157928466797
local_in_edges_tensor generation:  0.0005919933319091797
mini_batch_src_global generation:  0.0011336803436279297
r_  generation:  0.010268688201904297
local_output_nid generation:  0.0009870529174804688
local_in_edges_tensor generation:  0.0005550384521484375
mini_batch_src_global generation:  0.0011470317840576172
r_  generation:  0.010065793991088867
local_output_nid generation:  0.0010769367218017578
local_in_edges_tensor generation:  0.0005507469177246094
mini_batch_src_global generation:  0.001046895980834961
r_  generation:  0.009729385375976562
local_output_nid generation:  0.0009393692016601562
local_in_edges_tensor generation:  0.0005407333374023438
mini_batch_src_global generation:  0.0010521411895751953
r_  generation:  0.01041412353515625
local_output_nid generation:  0.00090789794921875
local_in_edges_tensor generation:  0.0005428791046142578
mini_batch_src_global generation:  0.001064300537109375
r_  generation:  0.010037899017333984
local_output_nid generation:  0.0008733272552490234
local_in_edges_tensor generation:  0.0005290508270263672
mini_batch_src_global generation:  0.0010662078857421875
r_  generation:  0.010179996490478516
local_output_nid generation:  0.0008881092071533203
local_in_edges_tensor generation:  0.0005409717559814453
mini_batch_src_global generation:  0.0010325908660888672
r_  generation:  0.011935234069824219
local_output_nid generation:  0.0008778572082519531
local_in_edges_tensor generation:  0.0005390644073486328
mini_batch_src_global generation:  0.0010554790496826172
r_  generation:  0.01006627082824707
local_output_nid generation:  0.0008802413940429688
local_in_edges_tensor generation:  0.000545501708984375
mini_batch_src_global generation:  0.0011966228485107422
r_  generation:  0.010549783706665039
local_output_nid generation:  0.0008630752563476562
local_in_edges_tensor generation:  0.0005552768707275391
mini_batch_src_global generation:  0.0011622905731201172
r_  generation:  0.010088443756103516
local_output_nid generation:  0.0008649826049804688
local_in_edges_tensor generation:  0.0005362033843994141
mini_batch_src_global generation:  0.00110626220703125
r_  generation:  0.010313034057617188
local_output_nid generation:  0.0008800029754638672
local_in_edges_tensor generation:  0.0005331039428710938
mini_batch_src_global generation:  0.0010461807250976562
r_  generation:  0.01001286506652832
local_output_nid generation:  0.0008642673492431641
local_in_edges_tensor generation:  0.0005452632904052734
mini_batch_src_global generation:  0.0012631416320800781
r_  generation:  0.010370254516601562
local_output_nid generation:  0.0008542537689208984
local_in_edges_tensor generation:  0.0005257129669189453
mini_batch_src_global generation:  0.0010647773742675781
r_  generation:  0.012111663818359375
local_output_nid generation:  0.0008623600006103516
local_in_edges_tensor generation:  0.0005323886871337891
mini_batch_src_global generation:  0.0011179447174072266
r_  generation:  0.010631322860717773
local_output_nid generation:  0.0009007453918457031
local_in_edges_tensor generation:  0.0005464553833007812
mini_batch_src_global generation:  0.0010902881622314453
r_  generation:  0.010467529296875
local_output_nid generation:  0.0008599758148193359
local_in_edges_tensor generation:  0.0005314350128173828
mini_batch_src_global generation:  0.0010514259338378906
r_  generation:  0.009969472885131836
local_output_nid generation:  0.0008664131164550781
local_in_edges_tensor generation:  0.0005214214324951172
mini_batch_src_global generation:  0.0010569095611572266
r_  generation:  0.010351419448852539
local_output_nid generation:  0.0008611679077148438
local_in_edges_tensor generation:  0.0005340576171875
mini_batch_src_global generation:  0.0010764598846435547
r_  generation:  0.010384559631347656
local_output_nid generation:  0.0008723735809326172
local_in_edges_tensor generation:  0.0005404949188232422
mini_batch_src_global generation:  0.0010387897491455078
r_  generation:  0.010155677795410156
local_output_nid generation:  0.0008616447448730469
local_in_edges_tensor generation:  0.0005354881286621094
mini_batch_src_global generation:  0.0010852813720703125
r_  generation:  0.012606382369995117
local_output_nid generation:  0.0009915828704833984
local_in_edges_tensor generation:  0.0006246566772460938
mini_batch_src_global generation:  0.001224517822265625
r_  generation:  0.011118412017822266
local_output_nid generation:  0.0008683204650878906
local_in_edges_tensor generation:  0.0006120204925537109
mini_batch_src_global generation:  0.0010786056518554688
r_  generation:  0.010242223739624023
local_output_nid generation:  0.0008559226989746094
local_in_edges_tensor generation:  0.0005323886871337891
mini_batch_src_global generation:  0.0011096000671386719
r_  generation:  0.010468721389770508
----------------------check_connections_block total spend ----------------------------- 0.5425007343292236
generate_one_block  0.024634599685668945
generate_one_block  0.020289182662963867
generate_one_block  0.022983551025390625
generate_one_block  0.018490314483642578
generate_one_block  0.01738452911376953
generate_one_block  0.017670631408691406
generate_one_block  0.01719355583190918
generate_one_block  0.020452499389648438
generate_one_block  0.02312326431274414
generate_one_block  0.017093658447265625
generate_one_block  0.0172274112701416
generate_one_block  0.017827272415161133
generate_one_block  0.017306804656982422
generate_one_block  0.021136760711669922
generate_one_block  0.017617225646972656
generate_one_block  0.017073869705200195
generate_one_block  0.017822980880737305
generate_one_block  0.01694631576538086
generate_one_block  0.017606019973754883
generate_one_block  0.019532203674316406
generate_one_block  0.01779651641845703
generate_one_block  0.017393827438354492
generate_one_block  0.0177462100982666
generate_one_block  0.01757073402404785
generate_one_block  0.016991376876831055
generate_one_block  0.018214941024780273
generate_one_block  0.017784833908081055
generate_one_block  0.017400264739990234
generate_one_block  0.017172813415527344
generate_one_block  0.018261432647705078
generate_one_block  0.017356157302856445
generate_one_block  0.017882823944091797
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04804682731628418
gen group dst list time:  0.025159597396850586
time for parepare:  0.02129650115966797
local_output_nid generation:  0.005780458450317383
local_in_edges_tensor generation:  0.021187782287597656
mini_batch_src_global generation:  0.013066291809082031
r_  generation:  0.1338798999786377
local_output_nid generation:  0.007519245147705078
local_in_edges_tensor generation:  0.010503053665161133
mini_batch_src_global generation:  0.01721358299255371
r_  generation:  0.1870255470275879
local_output_nid generation:  0.007502317428588867
local_in_edges_tensor generation:  0.029384851455688477
mini_batch_src_global generation:  0.015836238861083984
r_  generation:  0.1428532600402832
local_output_nid generation:  0.008060216903686523
local_in_edges_tensor generation:  0.008803367614746094
mini_batch_src_global generation:  0.016842365264892578
r_  generation:  0.15114784240722656
local_output_nid generation:  0.007962226867675781
local_in_edges_tensor generation:  0.008705377578735352
mini_batch_src_global generation:  0.017177104949951172
r_  generation:  0.1487283706665039
local_output_nid generation:  0.008498430252075195
local_in_edges_tensor generation:  0.009082317352294922
mini_batch_src_global generation:  0.018967866897583008
r_  generation:  0.15096187591552734
local_output_nid generation:  0.008392810821533203
local_in_edges_tensor generation:  0.00765228271484375
mini_batch_src_global generation:  0.02480912208557129
r_  generation:  0.14641094207763672
local_output_nid generation:  0.008257389068603516
local_in_edges_tensor generation:  0.009752750396728516
mini_batch_src_global generation:  0.019103288650512695
r_  generation:  0.1511549949645996
local_output_nid generation:  0.008244514465332031
local_in_edges_tensor generation:  0.009129762649536133
mini_batch_src_global generation:  0.018073558807373047
r_  generation:  0.15038037300109863
local_output_nid generation:  0.008450031280517578
local_in_edges_tensor generation:  0.00763392448425293
mini_batch_src_global generation:  0.01789546012878418
r_  generation:  0.14904379844665527
local_output_nid generation:  0.008398056030273438
local_in_edges_tensor generation:  0.008712530136108398
mini_batch_src_global generation:  0.017731189727783203
r_  generation:  0.14828062057495117
local_output_nid generation:  0.008918523788452148
local_in_edges_tensor generation:  0.010568380355834961
mini_batch_src_global generation:  0.018615007400512695
r_  generation:  0.15330123901367188
local_output_nid generation:  0.008719682693481445
local_in_edges_tensor generation:  0.00789022445678711
mini_batch_src_global generation:  0.01809096336364746
r_  generation:  0.15066218376159668
local_output_nid generation:  0.008948087692260742
local_in_edges_tensor generation:  0.00807046890258789
mini_batch_src_global generation:  0.01977992057800293
r_  generation:  0.1552584171295166
local_output_nid generation:  0.008911371231079102
local_in_edges_tensor generation:  0.009341239929199219
mini_batch_src_global generation:  0.018622636795043945
r_  generation:  0.15221858024597168
local_output_nid generation:  0.008734941482543945
local_in_edges_tensor generation:  0.009086847305297852
mini_batch_src_global generation:  0.018263816833496094
r_  generation:  0.15284013748168945
local_output_nid generation:  0.008996248245239258
local_in_edges_tensor generation:  0.010660409927368164
mini_batch_src_global generation:  0.020079374313354492
r_  generation:  0.1559755802154541
local_output_nid generation:  0.00862431526184082
local_in_edges_tensor generation:  0.007878303527832031
mini_batch_src_global generation:  0.018315792083740234
r_  generation:  0.15044927597045898
local_output_nid generation:  0.008738517761230469
local_in_edges_tensor generation:  0.008634805679321289
mini_batch_src_global generation:  0.01978588104248047
r_  generation:  0.15369558334350586
local_output_nid generation:  0.008366107940673828
local_in_edges_tensor generation:  0.009210348129272461
mini_batch_src_global generation:  0.018535375595092773
r_  generation:  0.1518409252166748
local_output_nid generation:  0.008491039276123047
local_in_edges_tensor generation:  0.009479761123657227
mini_batch_src_global generation:  0.019922256469726562
r_  generation:  0.1621994972229004
local_output_nid generation:  0.008526802062988281
local_in_edges_tensor generation:  0.008096456527709961
mini_batch_src_global generation:  0.018682241439819336
r_  generation:  0.15636658668518066
local_output_nid generation:  0.008564472198486328
local_in_edges_tensor generation:  0.010122299194335938
mini_batch_src_global generation:  0.018976926803588867
r_  generation:  0.1585543155670166
local_output_nid generation:  0.008534669876098633
local_in_edges_tensor generation:  0.008351802825927734
mini_batch_src_global generation:  0.01871204376220703
r_  generation:  0.15369725227355957
local_output_nid generation:  0.008450031280517578
local_in_edges_tensor generation:  0.008039236068725586
mini_batch_src_global generation:  0.018387556076049805
r_  generation:  0.15288686752319336
local_output_nid generation:  0.008680105209350586
local_in_edges_tensor generation:  0.01206660270690918
mini_batch_src_global generation:  0.020314455032348633
r_  generation:  0.16109657287597656
local_output_nid generation:  0.008679389953613281
local_in_edges_tensor generation:  0.012175559997558594
mini_batch_src_global generation:  0.020818710327148438
r_  generation:  0.15939617156982422
local_output_nid generation:  0.011107444763183594
local_in_edges_tensor generation:  0.008263826370239258
mini_batch_src_global generation:  0.018769502639770508
r_  generation:  0.15814518928527832
local_output_nid generation:  0.008402824401855469
local_in_edges_tensor generation:  0.008264780044555664
mini_batch_src_global generation:  0.01830267906188965
r_  generation:  0.1557149887084961
local_output_nid generation:  0.00906682014465332
local_in_edges_tensor generation:  0.008681058883666992
mini_batch_src_global generation:  0.01914215087890625
r_  generation:  0.16408085823059082
local_output_nid generation:  0.008655786514282227
local_in_edges_tensor generation:  0.008475780487060547
mini_batch_src_global generation:  0.019256114959716797
r_  generation:  0.1591019630432129
local_output_nid generation:  0.00959920883178711
local_in_edges_tensor generation:  0.01774883270263672
mini_batch_src_global generation:  0.025699615478515625
r_  generation:  0.1661994457244873
----------------------check_connections_block total spend ----------------------------- 7.315465450286865
generate_one_block  0.21689271926879883
generate_one_block  0.20588421821594238
generate_one_block  0.19751548767089844
generate_one_block  0.2043137550354004
generate_one_block  0.22840356826782227
generate_one_block  0.20226812362670898
generate_one_block  0.19476580619812012
generate_one_block  0.20054960250854492
generate_one_block  0.19956350326538086
generate_one_block  0.19356489181518555
generate_one_block  0.1936202049255371
generate_one_block  0.20343923568725586
generate_one_block  0.19829201698303223
generate_one_block  0.22368693351745605
generate_one_block  0.20340800285339355
generate_one_block  0.1978139877319336
generate_one_block  0.20956110954284668
generate_one_block  0.19502878189086914
generate_one_block  0.20215892791748047
generate_one_block  0.2030353546142578
generate_one_block  0.2111647129058838
generate_one_block  0.2021470069885254
generate_one_block  0.20844769477844238
generate_one_block  0.203016996383667
generate_one_block  0.20785975456237793
generate_one_block  0.21722054481506348
generate_one_block  0.21395659446716309
generate_one_block  0.19908452033996582
generate_one_block  0.19708943367004395
generate_one_block  0.21027636528015137
generate_one_block  0.2003929615020752
generate_one_block  0.21058320999145508
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.045488595962524414
gen group dst list time:  0.10662698745727539
time for parepare:  0.01765298843383789
local_output_nid generation:  0.023647785186767578
local_in_edges_tensor generation:  0.045134544372558594
mini_batch_src_global generation:  0.03868865966796875
r_  generation:  0.3954794406890869
local_output_nid generation:  0.027832508087158203
local_in_edges_tensor generation:  0.04000544548034668
mini_batch_src_global generation:  0.046994924545288086
r_  generation:  0.41254281997680664
local_output_nid generation:  0.02763533592224121
local_in_edges_tensor generation:  0.03681802749633789
mini_batch_src_global generation:  0.0466921329498291
r_  generation:  0.41478967666625977
local_output_nid generation:  0.027081012725830078
local_in_edges_tensor generation:  0.04648184776306152
mini_batch_src_global generation:  0.04793143272399902
r_  generation:  0.4167747497558594
local_output_nid generation:  0.02642083168029785
local_in_edges_tensor generation:  0.025678157806396484
mini_batch_src_global generation:  0.04776406288146973
r_  generation:  0.41332292556762695
local_output_nid generation:  0.026874303817749023
local_in_edges_tensor generation:  0.027621746063232422
mini_batch_src_global generation:  0.05141925811767578
r_  generation:  0.4111809730529785
local_output_nid generation:  0.027356624603271484
local_in_edges_tensor generation:  0.029218435287475586
mini_batch_src_global generation:  0.04751753807067871
r_  generation:  0.4141697883605957
local_output_nid generation:  0.026810884475708008
local_in_edges_tensor generation:  0.029448509216308594
mini_batch_src_global generation:  0.04890918731689453
r_  generation:  0.41612672805786133
local_output_nid generation:  0.027137279510498047
local_in_edges_tensor generation:  0.029339313507080078
mini_batch_src_global generation:  0.048148155212402344
r_  generation:  0.41481590270996094
local_output_nid generation:  0.02677011489868164
local_in_edges_tensor generation:  0.03330826759338379
mini_batch_src_global generation:  0.04947996139526367
r_  generation:  0.4153475761413574
local_output_nid generation:  0.026809215545654297
local_in_edges_tensor generation:  0.029011249542236328
mini_batch_src_global generation:  0.047998666763305664
r_  generation:  0.4146699905395508
local_output_nid generation:  0.027068138122558594
local_in_edges_tensor generation:  0.03345346450805664
mini_batch_src_global generation:  0.05081629753112793
r_  generation:  0.41941261291503906
local_output_nid generation:  0.02826380729675293
local_in_edges_tensor generation:  0.03253984451293945
mini_batch_src_global generation:  0.053885459899902344
r_  generation:  0.42607855796813965
local_output_nid generation:  0.027843475341796875
local_in_edges_tensor generation:  0.0390772819519043
mini_batch_src_global generation:  0.057645559310913086
r_  generation:  0.4218142032623291
local_output_nid generation:  0.02922821044921875
local_in_edges_tensor generation:  0.03568267822265625
mini_batch_src_global generation:  0.048476219177246094
r_  generation:  0.41749000549316406
local_output_nid generation:  0.028200864791870117
local_in_edges_tensor generation:  0.029728174209594727
mini_batch_src_global generation:  0.048920631408691406
r_  generation:  0.41281628608703613
local_output_nid generation:  0.02841329574584961
local_in_edges_tensor generation:  0.03333282470703125
mini_batch_src_global generation:  0.05087709426879883
r_  generation:  0.42272257804870605
local_output_nid generation:  0.028228759765625
local_in_edges_tensor generation:  0.02670001983642578
mini_batch_src_global generation:  0.04879403114318848
r_  generation:  0.4153909683227539
local_output_nid generation:  0.028397321701049805
local_in_edges_tensor generation:  0.029868125915527344
mini_batch_src_global generation:  0.04839468002319336
r_  generation:  0.4347221851348877
local_output_nid generation:  0.028134584426879883
local_in_edges_tensor generation:  0.03303885459899902
mini_batch_src_global generation:  0.04818320274353027
r_  generation:  0.4117884635925293
local_output_nid generation:  0.028351306915283203
local_in_edges_tensor generation:  0.029576778411865234
mini_batch_src_global generation:  0.050925254821777344
r_  generation:  0.42609524726867676
local_output_nid generation:  0.028623580932617188
local_in_edges_tensor generation:  0.029448747634887695
mini_batch_src_global generation:  0.048307180404663086
r_  generation:  0.41979169845581055
local_output_nid generation:  0.028290510177612305
local_in_edges_tensor generation:  0.025923967361450195
mini_batch_src_global generation:  0.048461198806762695
r_  generation:  0.4180436134338379
local_output_nid generation:  0.028336524963378906
local_in_edges_tensor generation:  0.029433488845825195
mini_batch_src_global generation:  0.0482485294342041
r_  generation:  0.4125335216522217
local_output_nid generation:  0.02809929847717285
local_in_edges_tensor generation:  0.03343963623046875
mini_batch_src_global generation:  0.04865550994873047
r_  generation:  0.4171617031097412
local_output_nid generation:  0.028284072875976562
local_in_edges_tensor generation:  0.029692649841308594
mini_batch_src_global generation:  0.05141448974609375
r_  generation:  0.4190995693206787
local_output_nid generation:  0.028611421585083008
local_in_edges_tensor generation:  0.02935194969177246
mini_batch_src_global generation:  0.04823136329650879
r_  generation:  0.42174744606018066
local_output_nid generation:  0.028432846069335938
local_in_edges_tensor generation:  0.02973771095275879
mini_batch_src_global generation:  0.049123287200927734
r_  generation:  0.4127683639526367
local_output_nid generation:  0.028122901916503906
local_in_edges_tensor generation:  0.025842905044555664
mini_batch_src_global generation:  0.04843592643737793
r_  generation:  0.41686558723449707
local_output_nid generation:  0.02850031852722168
local_in_edges_tensor generation:  0.032024383544921875
mini_batch_src_global generation:  0.04878854751586914
r_  generation:  0.4207930564880371
local_output_nid generation:  0.028499603271484375
local_in_edges_tensor generation:  0.03315234184265137
mini_batch_src_global generation:  0.04733920097351074
r_  generation:  0.4198324680328369
local_output_nid generation:  0.028359413146972656
local_in_edges_tensor generation:  0.03509068489074707
mini_batch_src_global generation:  0.05127239227294922
r_  generation:  0.41817259788513184
----------------------check_connections_block total spend ----------------------------- 19.733897924423218
generate_one_block  0.5800313949584961
generate_one_block  0.5643925666809082
generate_one_block  0.5671148300170898
generate_one_block  0.5571596622467041
generate_one_block  0.6576545238494873
generate_one_block  0.5514640808105469
generate_one_block  0.5482938289642334
generate_one_block  0.5490391254425049
generate_one_block  0.5494494438171387
generate_one_block  0.5454928874969482
generate_one_block  0.5460591316223145
generate_one_block  0.5766377449035645
generate_one_block  0.5406653881072998
generate_one_block  0.5590848922729492
generate_one_block  0.5471234321594238
generate_one_block  0.5480353832244873
generate_one_block  0.5582430362701416
generate_one_block  0.5455629825592041
generate_one_block  0.5521514415740967
generate_one_block  0.5569918155670166
generate_one_block  0.5584707260131836
generate_one_block  0.5590646266937256
generate_one_block  0.5426054000854492
generate_one_block  0.5880424976348877
generate_one_block  0.5708308219909668
generate_one_block  0.5714311599731445
generate_one_block  0.591313362121582
generate_one_block  0.5660409927368164
generate_one_block  0.5475561618804932
generate_one_block  0.563178300857544
generate_one_block  0.5459692478179932
generate_one_block  0.5620019435882568
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 0.104949951171875  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

connection checking time:  27.049363374710083
block generation total time  24.52215886116028
average batch blocks generation time:  0.7663174644112587
block dataloader generation time/epoch 54.71226382255554
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 0.08673667907714844  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

torch.Size([146362, 128])
torch.Size([102186, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 10.459322929382324  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 0.08622980117797852  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

torch.Size([146270, 128])
torch.Size([102715, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 10.547394275665283  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 0.08674049377441406  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

torch.Size([146501, 128])
torch.Size([102888, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 10.480653762817383  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 0.08633565902709961  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

torch.Size([146520, 128])
torch.Size([103281, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 10.55461311340332  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 0.08673715591430664  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

torch.Size([145821, 128])
torch.Size([101391, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 10.441762924194336  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 0.08634567260742188  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

torch.Size([146567, 128])
torch.Size([102888, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 10.514232635498047  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 0.08670330047607422  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

torch.Size([146534, 128])
torch.Size([102398, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 10.445180892944336  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 0.08611631393432617  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

torch.Size([146136, 128])
torch.Size([101724, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 10.448787212371826  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 0.08674144744873047  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

torch.Size([146643, 128])
torch.Size([102977, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 10.497633457183838  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 0.08616065979003906  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

torch.Size([146342, 128])
torch.Size([102035, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 10.409119129180908  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 0.08667707443237305  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

torch.Size([146081, 128])
torch.Size([100963, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 10.377978324890137  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 0.08623409271240234  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

torch.Size([146352, 128])
torch.Size([103031, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 10.527616024017334  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 0.08573102951049805  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

torch.Size([145364, 128])
torch.Size([100980, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 10.387969017028809  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 0.08643436431884766  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

torch.Size([146726, 128])
torch.Size([103212, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 10.56142282485962  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 0.08675575256347656  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

torch.Size([146487, 128])
torch.Size([102714, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 10.515855312347412  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 0.08613729476928711  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

torch.Size([146218, 128])
torch.Size([101873, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 10.468257904052734  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 0.08680963516235352  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

torch.Size([146597, 128])
torch.Size([102959, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 10.566200256347656  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 0.08608436584472656  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

torch.Size([146174, 128])
torch.Size([101638, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 10.395521640777588  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 0.08677530288696289  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

torch.Size([146501, 128])
torch.Size([102380, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 10.518493175506592  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 0.08616352081298828  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

torch.Size([146251, 128])
torch.Size([101585, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 10.455099105834961  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 0.08681297302246094  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

torch.Size([146396, 128])
torch.Size([102609, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 10.55916166305542  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 0.08622980117797852  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

torch.Size([146362, 128])
torch.Size([102823, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 10.533593654632568  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 0.08679866790771484  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

torch.Size([145884, 128])
torch.Size([101470, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 10.474478721618652  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 0.08621883392333984  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

torch.Size([146337, 128])
torch.Size([102129, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 10.466472625732422  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 0.08673810958862305  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

torch.Size([146351, 128])
torch.Size([102208, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 10.464632511138916  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 0.08640670776367188  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

torch.Size([146606, 128])
torch.Size([102757, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 10.586142539978027  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 0.08681297302246094  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

torch.Size([146784, 128])
torch.Size([103271, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 10.587380409240723  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 0.0864262580871582  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

torch.Size([146762, 128])
torch.Size([102823, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 10.528825283050537  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 0.08672571182250977  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

torch.Size([146183, 128])
torch.Size([101464, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 10.412345886230469  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 0.08647346496582031  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

torch.Size([146682, 128])
torch.Size([103606, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 10.619338035583496  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 0.08675193786621094  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

torch.Size([146771, 128])
torch.Size([102876, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 10.470515727996826  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 0.08626174926757812  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

torch.Size([146227, 128])
torch.Size([102550, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4256591796875 GB
    Memory Allocated: 10.610429763793945  GigaBytes
Max Memory Allocated: 10.722133159637451  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.023610077798366547 |0.014783129096031189 |0.3849441781640053 |9.815394878387451e-05 |0.5862358957529068 |0.006602287292480469 |
----------------------------------------------------------pseudo_mini_loss sum 3.6953256130218506
Total (block generation + training)time/epoch 87.07778072357178
Training time/epoch 32.3652126789093
Training time without block to device /epoch 31.892152547836304
Training time without total dataloading part /epoch 31.08750557899475
load block tensor time/epoch 0.7555224895477295
block to device time/epoch 0.47306013107299805
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  8800501
Number of first layer input nodes during this epoch:  4683792
