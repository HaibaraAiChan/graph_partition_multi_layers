Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648473470.5315595
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017633438110351562  GigaBytes
Max Memory Allocated: 0.0017633438110351562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.034917354583740234
range selection method range initialization spend 0.013779401779174805
time for parepare:  0.01804637908935547
local_output_nid generation:  0.001470804214477539
local_in_edges_tensor generation:  0.004000186920166016
mini_batch_src_global generation:  0.001974821090698242
r_  generation:  0.020456314086914062
local_output_nid generation:  0.0015757083892822266
local_in_edges_tensor generation:  0.0009758472442626953
mini_batch_src_global generation:  0.0024743080139160156
r_  generation:  0.02077460289001465
local_output_nid generation:  0.0016396045684814453
local_in_edges_tensor generation:  0.0009658336639404297
mini_batch_src_global generation:  0.0016260147094726562
r_  generation:  0.021960020065307617
local_output_nid generation:  0.0016591548919677734
local_in_edges_tensor generation:  0.0009160041809082031
mini_batch_src_global generation:  0.0016546249389648438
r_  generation:  0.021538734436035156
local_output_nid generation:  0.0017070770263671875
local_in_edges_tensor generation:  0.0009062290191650391
mini_batch_src_global generation:  0.001627206802368164
r_  generation:  0.02092266082763672
local_output_nid generation:  0.0016453266143798828
local_in_edges_tensor generation:  0.0008800029754638672
mini_batch_src_global generation:  0.0017161369323730469
r_  generation:  0.021263599395751953
local_output_nid generation:  0.0016641616821289062
local_in_edges_tensor generation:  0.0008907318115234375
mini_batch_src_global generation:  0.0016942024230957031
r_  generation:  0.021802663803100586
local_output_nid generation:  0.0018131732940673828
local_in_edges_tensor generation:  0.0008769035339355469
mini_batch_src_global generation:  0.001714468002319336
r_  generation:  0.021829843521118164
local_output_nid generation:  0.0016331672668457031
local_in_edges_tensor generation:  0.0008604526519775391
mini_batch_src_global generation:  0.0017120838165283203
r_  generation:  0.022549867630004883
local_output_nid generation:  0.0016503334045410156
local_in_edges_tensor generation:  0.0009267330169677734
mini_batch_src_global generation:  0.0017316341400146484
r_  generation:  0.022051334381103516
local_output_nid generation:  0.0016598701477050781
local_in_edges_tensor generation:  0.0008614063262939453
mini_batch_src_global generation:  0.0017414093017578125
r_  generation:  0.022858619689941406
local_output_nid generation:  0.0016667842864990234
local_in_edges_tensor generation:  0.0008847713470458984
mini_batch_src_global generation:  0.0017733573913574219
r_  generation:  0.022978782653808594
local_output_nid generation:  0.001650094985961914
local_in_edges_tensor generation:  0.0008904933929443359
mini_batch_src_global generation:  0.001768350601196289
r_  generation:  0.022189855575561523
local_output_nid generation:  0.0016589164733886719
local_in_edges_tensor generation:  0.0008590221405029297
mini_batch_src_global generation:  0.0017485618591308594
r_  generation:  0.022120952606201172
local_output_nid generation:  0.001644134521484375
local_in_edges_tensor generation:  0.0008580684661865234
mini_batch_src_global generation:  0.0017795562744140625
r_  generation:  0.022005081176757812
local_output_nid generation:  0.0016536712646484375
local_in_edges_tensor generation:  0.0008776187896728516
mini_batch_src_global generation:  0.0017690658569335938
r_  generation:  0.02238917350769043
----------------------check_connections_block total spend ----------------------------- 0.5161046981811523
generate_one_block  0.02963733673095703
generate_one_block  0.0314946174621582
generate_one_block  0.03466677665710449
generate_one_block  0.03209829330444336
generate_one_block  0.030968666076660156
generate_one_block  0.031005859375
generate_one_block  0.03165745735168457
generate_one_block  0.031795501708984375
generate_one_block  0.03141975402832031
generate_one_block  0.031281471252441406
generate_one_block  0.0320432186126709
generate_one_block  0.03222966194152832
generate_one_block  0.0316925048828125
generate_one_block  0.03114604949951172
generate_one_block  0.03108382225036621
generate_one_block  0.031356096267700195
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0418095588684082
gen group dst list time:  0.02077960968017578
time for parepare:  0.019368410110473633
local_output_nid generation:  0.007265567779541016
local_in_edges_tensor generation:  0.019085407257080078
mini_batch_src_global generation:  0.025160789489746094
r_  generation:  0.24512004852294922
local_output_nid generation:  0.012206077575683594
local_in_edges_tensor generation:  0.022223711013793945
mini_batch_src_global generation:  0.03264164924621582
r_  generation:  0.2565445899963379
local_output_nid generation:  0.012901782989501953
local_in_edges_tensor generation:  0.02118086814880371
mini_batch_src_global generation:  0.03220105171203613
r_  generation:  0.26973843574523926
local_output_nid generation:  0.013103008270263672
local_in_edges_tensor generation:  0.020773649215698242
mini_batch_src_global generation:  0.03318190574645996
r_  generation:  0.27184343338012695
local_output_nid generation:  0.013534784317016602
local_in_edges_tensor generation:  0.014175176620483398
mini_batch_src_global generation:  0.03387045860290527
r_  generation:  0.26738905906677246
local_output_nid generation:  0.013666152954101562
local_in_edges_tensor generation:  0.01625537872314453
mini_batch_src_global generation:  0.03377246856689453
r_  generation:  0.2665269374847412
local_output_nid generation:  0.013684511184692383
local_in_edges_tensor generation:  0.0161130428314209
mini_batch_src_global generation:  0.035576820373535156
r_  generation:  0.26674675941467285
local_output_nid generation:  0.014000654220581055
local_in_edges_tensor generation:  0.018934249877929688
mini_batch_src_global generation:  0.03354907035827637
r_  generation:  0.27123212814331055
local_output_nid generation:  0.014011144638061523
local_in_edges_tensor generation:  0.018863916397094727
mini_batch_src_global generation:  0.03467583656311035
r_  generation:  0.27140021324157715
local_output_nid generation:  0.013969659805297852
local_in_edges_tensor generation:  0.014211893081665039
mini_batch_src_global generation:  0.0372469425201416
r_  generation:  0.27107954025268555
local_output_nid generation:  0.014416694641113281
local_in_edges_tensor generation:  0.016764163970947266
mini_batch_src_global generation:  0.03504443168640137
r_  generation:  0.27563023567199707
local_output_nid generation:  0.014364004135131836
local_in_edges_tensor generation:  0.019382238388061523
mini_batch_src_global generation:  0.03514409065246582
r_  generation:  0.2726023197174072
local_output_nid generation:  0.014130830764770508
local_in_edges_tensor generation:  0.016901016235351562
mini_batch_src_global generation:  0.03433060646057129
r_  generation:  0.27268409729003906
local_output_nid generation:  0.014064550399780273
local_in_edges_tensor generation:  0.016375064849853516
mini_batch_src_global generation:  0.03448891639709473
r_  generation:  0.27100300788879395
local_output_nid generation:  0.014408588409423828
local_in_edges_tensor generation:  0.01418757438659668
mini_batch_src_global generation:  0.03439140319824219
r_  generation:  0.26915526390075684
local_output_nid generation:  0.014208555221557617
local_in_edges_tensor generation:  0.014621734619140625
mini_batch_src_global generation:  0.0362086296081543
r_  generation:  0.26844334602355957
----------------------check_connections_block total spend ----------------------------- 6.263231992721558
generate_one_block  0.3515803813934326
generate_one_block  0.3565685749053955
generate_one_block  0.3686389923095703
generate_one_block  0.3579392433166504
generate_one_block  0.3674046993255615
generate_one_block  0.35036802291870117
generate_one_block  0.3528726100921631
generate_one_block  0.3549072742462158
generate_one_block  0.35785651206970215
generate_one_block  0.34612512588500977
generate_one_block  0.3706684112548828
generate_one_block  0.3588433265686035
generate_one_block  0.35374999046325684
generate_one_block  0.3524658679962158
generate_one_block  0.3574392795562744
generate_one_block  0.35119199752807617
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03460097312927246
gen group dst list time:  0.06537938117980957
time for parepare:  0.019089937210083008
local_output_nid generation:  0.02438807487487793
local_in_edges_tensor generation:  0.03781557083129883
mini_batch_src_global generation:  0.042116641998291016
r_  generation:  0.4523751735687256
local_output_nid generation:  0.030591964721679688
local_in_edges_tensor generation:  0.04758858680725098
mini_batch_src_global generation:  0.05253005027770996
r_  generation:  0.46294450759887695
local_output_nid generation:  0.03561973571777344
local_in_edges_tensor generation:  0.05093216896057129
mini_batch_src_global generation:  0.054158926010131836
r_  generation:  0.46446776390075684
local_output_nid generation:  0.03188467025756836
local_in_edges_tensor generation:  0.037904977798461914
mini_batch_src_global generation:  0.0520327091217041
r_  generation:  0.4691183567047119
local_output_nid generation:  0.03179430961608887
local_in_edges_tensor generation:  0.02957439422607422
mini_batch_src_global generation:  0.051935672760009766
r_  generation:  0.4734458923339844
local_output_nid generation:  0.03343915939331055
local_in_edges_tensor generation:  0.02969837188720703
mini_batch_src_global generation:  0.05312538146972656
r_  generation:  0.4720289707183838
local_output_nid generation:  0.031195640563964844
local_in_edges_tensor generation:  0.037724971771240234
mini_batch_src_global generation:  0.05379343032836914
r_  generation:  0.4733259677886963
local_output_nid generation:  0.03133559226989746
local_in_edges_tensor generation:  0.03064894676208496
mini_batch_src_global generation:  0.05364704132080078
r_  generation:  0.4797990322113037
local_output_nid generation:  0.031942129135131836
local_in_edges_tensor generation:  0.03658175468444824
mini_batch_src_global generation:  0.06505703926086426
r_  generation:  0.47561192512512207
local_output_nid generation:  0.032401323318481445
local_in_edges_tensor generation:  0.034343719482421875
mini_batch_src_global generation:  0.05453157424926758
r_  generation:  0.47277140617370605
local_output_nid generation:  0.0314788818359375
local_in_edges_tensor generation:  0.03367733955383301
mini_batch_src_global generation:  0.05359911918640137
r_  generation:  0.49346041679382324
local_output_nid generation:  0.03206658363342285
local_in_edges_tensor generation:  0.04837965965270996
mini_batch_src_global generation:  0.057708024978637695
r_  generation:  0.4757535457611084
local_output_nid generation:  0.0320277214050293
local_in_edges_tensor generation:  0.03707456588745117
mini_batch_src_global generation:  0.053891658782958984
r_  generation:  0.4815192222595215
local_output_nid generation:  0.03183865547180176
local_in_edges_tensor generation:  0.029407978057861328
mini_batch_src_global generation:  0.053853750228881836
r_  generation:  0.48146820068359375
local_output_nid generation:  0.034386396408081055
local_in_edges_tensor generation:  0.033341169357299805
mini_batch_src_global generation:  0.05610179901123047
r_  generation:  0.47995519638061523
local_output_nid generation:  0.03242969512939453
local_in_edges_tensor generation:  0.03795146942138672
mini_batch_src_global generation:  0.053534746170043945
r_  generation:  0.4763209819793701
----------------------check_connections_block total spend ----------------------------- 11.252545595169067
generate_one_block  0.5961475372314453
generate_one_block  0.6060404777526855
generate_one_block  0.6128020286560059
generate_one_block  0.6043117046356201
generate_one_block  0.5876932144165039
generate_one_block  0.5955989360809326
generate_one_block  0.6601772308349609
generate_one_block  0.6067550182342529
generate_one_block  0.597339391708374
generate_one_block  0.5833179950714111
generate_one_block  0.6037166118621826
generate_one_block  0.6055278778076172
generate_one_block  0.6117393970489502
generate_one_block  0.5851607322692871
generate_one_block  0.5891106128692627
generate_one_block  0.600701093673706
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017633438110351562  GigaBytes
Max Memory Allocated: 0.0017633438110351562  GigaBytes

connection checking time:  17.515777587890625
block generation total time  15.35476016998291
average batch blocks generation time:  0.9596725106239319
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.09420204162597656  GigaBytes
Max Memory Allocated: 0.09420204162597656  GigaBytes

torch.Size([156897, 128])
torch.Size([129713, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.4510498046875 GB
    Memory Allocated: 17.891230583190918  GigaBytes
Max Memory Allocated: 17.923418521881104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.6756591796875 GB
    Memory Allocated: 0.09744024276733398  GigaBytes
Max Memory Allocated: 17.923418521881104  GigaBytes

torch.Size([156733, 128])
torch.Size([129871, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7908935546875 GB
    Memory Allocated: 17.939136028289795  GigaBytes
Max Memory Allocated: 17.972745418548584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.6033935546875 GB
    Memory Allocated: 0.09816646575927734  GigaBytes
Max Memory Allocated: 17.972745418548584  GigaBytes

torch.Size([157266, 128])
torch.Size([131119, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3026123046875 GB
    Memory Allocated: 18.222949981689453  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7264404296875 GB
    Memory Allocated: 0.09748220443725586  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

torch.Size([156912, 128])
torch.Size([130160, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7264404296875 GB
    Memory Allocated: 18.01532793045044  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7264404296875 GB
    Memory Allocated: 0.09758186340332031  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

torch.Size([156590, 128])
torch.Size([129193, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7264404296875 GB
    Memory Allocated: 17.935515880584717  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7264404296875 GB
    Memory Allocated: 0.09742879867553711  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

torch.Size([156781, 128])
torch.Size([130006, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7264404296875 GB
    Memory Allocated: 17.91563081741333  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7264404296875 GB
    Memory Allocated: 0.09790849685668945  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

torch.Size([157285, 128])
torch.Size([130528, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7264404296875 GB
    Memory Allocated: 17.966649055480957  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7264404296875 GB
    Memory Allocated: 0.0974416732788086  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

torch.Size([156677, 128])
torch.Size([129964, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7264404296875 GB
    Memory Allocated: 17.946316242218018  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7264404296875 GB
    Memory Allocated: 0.09769392013549805  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

torch.Size([156631, 128])
torch.Size([129733, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 18.02408504486084  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.0974130630493164  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

torch.Size([156765, 128])
torch.Size([129598, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 17.911826133728027  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.09799718856811523  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

torch.Size([157181, 128])
torch.Size([130744, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 18.111520290374756  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.09750223159790039  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

torch.Size([156753, 128])
torch.Size([130226, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 18.05336570739746  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.09784269332885742  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

torch.Size([157025, 128])
torch.Size([130269, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 18.0116925239563  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.09743547439575195  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

torch.Size([156386, 128])
torch.Size([129375, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 17.93448257446289  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.09757757186889648  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

torch.Size([156691, 128])
torch.Size([129535, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 17.87044334411621  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.09744024276733398  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

torch.Size([156611, 128])
torch.Size([129964, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 17.931806564331055  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03784312307834625 |0.044619396328926086 |0.6265659630298615 |0.00011421740055084229 |1.0488277673721313 |0.023341655731201172 |
----------------------------------------------------------pseudo_mini_loss sum 4.992806434631348
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5319977
Number of first layer input nodes during this epoch:  2509184
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.1288766860961914  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025812625885009766
range selection method range initialization spend 0.013401269912719727
time for parepare:  0.018887996673583984
local_output_nid generation:  0.0022492408752441406
local_in_edges_tensor generation:  0.0091094970703125
mini_batch_src_global generation:  0.002228260040283203
r_  generation:  0.020670413970947266
local_output_nid generation:  0.0020744800567626953
local_in_edges_tensor generation:  0.0010085105895996094
mini_batch_src_global generation:  0.0024366378784179688
r_  generation:  0.02143096923828125
local_output_nid generation:  0.002020597457885742
local_in_edges_tensor generation:  0.0009701251983642578
mini_batch_src_global generation:  0.0015909671783447266
r_  generation:  0.02187371253967285
local_output_nid generation:  0.0020360946655273438
local_in_edges_tensor generation:  0.0009343624114990234
mini_batch_src_global generation:  0.0016574859619140625
r_  generation:  0.021376371383666992
local_output_nid generation:  0.0020308494567871094
local_in_edges_tensor generation:  0.0009386539459228516
mini_batch_src_global generation:  0.0016031265258789062
r_  generation:  0.021822452545166016
local_output_nid generation:  0.002048969268798828
local_in_edges_tensor generation:  0.0009560585021972656
mini_batch_src_global generation:  0.0016677379608154297
r_  generation:  0.021544456481933594
local_output_nid generation:  0.0020437240600585938
local_in_edges_tensor generation:  0.0009245872497558594
mini_batch_src_global generation:  0.0016741752624511719
r_  generation:  0.03500938415527344
local_output_nid generation:  0.002722024917602539
local_in_edges_tensor generation:  0.001201629638671875
mini_batch_src_global generation:  0.0019965171813964844
r_  generation:  0.02329707145690918
local_output_nid generation:  0.002310514450073242
local_in_edges_tensor generation:  0.0010237693786621094
mini_batch_src_global generation:  0.001811981201171875
r_  generation:  0.02265024185180664
local_output_nid generation:  0.002174854278564453
local_in_edges_tensor generation:  0.001032114028930664
mini_batch_src_global generation:  0.0017709732055664062
r_  generation:  0.022459030151367188
local_output_nid generation:  0.0021331310272216797
local_in_edges_tensor generation:  0.0009534358978271484
mini_batch_src_global generation:  0.0018076896667480469
r_  generation:  0.022439241409301758
local_output_nid generation:  0.002131223678588867
local_in_edges_tensor generation:  0.0009984970092773438
mini_batch_src_global generation:  0.0017960071563720703
r_  generation:  0.02270364761352539
local_output_nid generation:  0.0020503997802734375
local_in_edges_tensor generation:  0.0009510517120361328
mini_batch_src_global generation:  0.0044443607330322266
r_  generation:  0.02442765235900879
local_output_nid generation:  0.002155780792236328
local_in_edges_tensor generation:  0.0010492801666259766
mini_batch_src_global generation:  0.0018007755279541016
r_  generation:  0.035538673400878906
local_output_nid generation:  0.0021512508392333984
local_in_edges_tensor generation:  0.0010159015655517578
mini_batch_src_global generation:  0.0018932819366455078
r_  generation:  0.022886276245117188
local_output_nid generation:  0.002095937728881836
local_in_edges_tensor generation:  0.001003265380859375
mini_batch_src_global generation:  0.0018703937530517578
r_  generation:  0.02237081527709961
----------------------check_connections_block total spend ----------------------------- 0.5753500461578369
generate_one_block  0.050977230072021484
generate_one_block  0.04732322692871094
generate_one_block  0.0403900146484375
generate_one_block  0.03814101219177246
generate_one_block  0.03806018829345703
generate_one_block  0.039407968521118164
generate_one_block  0.05096435546875
generate_one_block  0.04115152359008789
generate_one_block  0.04002737998962402
generate_one_block  0.03993797302246094
generate_one_block  0.03886532783508301
generate_one_block  0.04010748863220215
generate_one_block  0.03990054130554199
generate_one_block  0.04091477394104004
generate_one_block  0.04052233695983887
generate_one_block  0.039536476135253906
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04504060745239258
gen group dst list time:  0.021011829376220703
time for parepare:  0.021314382553100586
local_output_nid generation:  0.014256000518798828
local_in_edges_tensor generation:  0.026607513427734375
mini_batch_src_global generation:  0.02658534049987793
r_  generation:  0.24966740608215332
local_output_nid generation:  0.016541242599487305
local_in_edges_tensor generation:  0.024991989135742188
mini_batch_src_global generation:  0.03214621543884277
r_  generation:  0.25838422775268555
local_output_nid generation:  0.019045352935791016
local_in_edges_tensor generation:  0.023583173751831055
mini_batch_src_global generation:  0.031626224517822266
r_  generation:  0.27941203117370605
local_output_nid generation:  0.01842975616455078
local_in_edges_tensor generation:  0.021117210388183594
mini_batch_src_global generation:  0.032018423080444336
r_  generation:  0.2664964199066162
local_output_nid generation:  0.021640539169311523
local_in_edges_tensor generation:  0.019265174865722656
mini_batch_src_global generation:  0.03493309020996094
r_  generation:  0.2727549076080322
local_output_nid generation:  0.0187528133392334
local_in_edges_tensor generation:  0.01676034927368164
mini_batch_src_global generation:  0.03488016128540039
r_  generation:  0.26647210121154785
local_output_nid generation:  0.0190737247467041
local_in_edges_tensor generation:  0.018714427947998047
mini_batch_src_global generation:  0.03577995300292969
r_  generation:  0.2709770202636719
local_output_nid generation:  0.019682645797729492
local_in_edges_tensor generation:  0.02457141876220703
mini_batch_src_global generation:  0.03480648994445801
r_  generation:  0.27590346336364746
local_output_nid generation:  0.019605159759521484
local_in_edges_tensor generation:  0.019414424896240234
mini_batch_src_global generation:  0.03452181816101074
r_  generation:  0.2754249572753906
local_output_nid generation:  0.01981043815612793
local_in_edges_tensor generation:  0.017727375030517578
mini_batch_src_global generation:  0.03443765640258789
r_  generation:  0.27335143089294434
local_output_nid generation:  0.02156829833984375
local_in_edges_tensor generation:  0.019786596298217773
mini_batch_src_global generation:  0.03446531295776367
r_  generation:  0.2742633819580078
local_output_nid generation:  0.019671201705932617
local_in_edges_tensor generation:  0.019165515899658203
mini_batch_src_global generation:  0.03711271286010742
r_  generation:  0.2871739864349365
local_output_nid generation:  0.02086353302001953
local_in_edges_tensor generation:  0.02691054344177246
mini_batch_src_global generation:  0.04584360122680664
r_  generation:  0.2897300720214844
local_output_nid generation:  0.024636268615722656
local_in_edges_tensor generation:  0.025057315826416016
mini_batch_src_global generation:  0.03599429130554199
r_  generation:  0.27649664878845215
local_output_nid generation:  0.02151179313659668
local_in_edges_tensor generation:  0.020170211791992188
mini_batch_src_global generation:  0.034773826599121094
r_  generation:  0.28078413009643555
local_output_nid generation:  0.021172761917114258
local_in_edges_tensor generation:  0.017384767532348633
mini_batch_src_global generation:  0.03466486930847168
r_  generation:  0.2728884220123291
----------------------check_connections_block total spend ----------------------------- 6.561767816543579
generate_one_block  0.39397454261779785
generate_one_block  0.3794870376586914
generate_one_block  0.38907337188720703
generate_one_block  0.3770120143890381
generate_one_block  0.3909428119659424
generate_one_block  0.36844730377197266
generate_one_block  0.41846561431884766
generate_one_block  0.38987064361572266
generate_one_block  0.3815903663635254
generate_one_block  0.3795657157897949
generate_one_block  0.3723268508911133
generate_one_block  0.3811805248260498
generate_one_block  0.3796699047088623
generate_one_block  0.38858485221862793
generate_one_block  0.39646458625793457
generate_one_block  0.3938901424407959
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05029726028442383
gen group dst list time:  0.07634663581848145
time for parepare:  0.021935224533081055
local_output_nid generation:  0.027919769287109375
local_in_edges_tensor generation:  0.06576371192932129
mini_batch_src_global generation:  0.04542040824890137
r_  generation:  0.4537780284881592
local_output_nid generation:  0.03194999694824219
local_in_edges_tensor generation:  0.04517197608947754
mini_batch_src_global generation:  0.052729129791259766
r_  generation:  0.457902193069458
local_output_nid generation:  0.03217816352844238
local_in_edges_tensor generation:  0.04222440719604492
mini_batch_src_global generation:  0.05054473876953125
r_  generation:  0.4697132110595703
local_output_nid generation:  0.032328128814697266
local_in_edges_tensor generation:  0.033531904220581055
mini_batch_src_global generation:  0.05131101608276367
r_  generation:  0.4716827869415283
local_output_nid generation:  0.03294968605041504
local_in_edges_tensor generation:  0.08317255973815918
mini_batch_src_global generation:  0.055182456970214844
r_  generation:  0.489790678024292
local_output_nid generation:  0.03242993354797363
local_in_edges_tensor generation:  0.03059220314025879
mini_batch_src_global generation:  0.05611014366149902
r_  generation:  0.4748709201812744
local_output_nid generation:  0.03255105018615723
local_in_edges_tensor generation:  0.030179500579833984
mini_batch_src_global generation:  0.053659915924072266
r_  generation:  0.4783625602722168
local_output_nid generation:  0.032816171646118164
local_in_edges_tensor generation:  0.029816389083862305
mini_batch_src_global generation:  0.05318617820739746
r_  generation:  0.4809989929199219
local_output_nid generation:  0.03262162208557129
local_in_edges_tensor generation:  0.037200927734375
mini_batch_src_global generation:  0.05356907844543457
r_  generation:  0.48918938636779785
local_output_nid generation:  0.03295636177062988
local_in_edges_tensor generation:  0.034233808517456055
mini_batch_src_global generation:  0.056282997131347656
r_  generation:  0.48591065406799316
local_output_nid generation:  0.03393816947937012
local_in_edges_tensor generation:  0.033638715744018555
mini_batch_src_global generation:  0.0536036491394043
r_  generation:  0.50272536277771
local_output_nid generation:  0.03398728370666504
local_in_edges_tensor generation:  0.04405951499938965
mini_batch_src_global generation:  0.07045197486877441
r_  generation:  0.485537052154541
local_output_nid generation:  0.0355527400970459
local_in_edges_tensor generation:  0.0451054573059082
mini_batch_src_global generation:  0.05629873275756836
r_  generation:  0.48169827461242676
local_output_nid generation:  0.03406381607055664
local_in_edges_tensor generation:  0.03674936294555664
mini_batch_src_global generation:  0.053327083587646484
r_  generation:  0.48182153701782227
local_output_nid generation:  0.034220218658447266
local_in_edges_tensor generation:  0.03416109085083008
mini_batch_src_global generation:  0.05337786674499512
r_  generation:  0.485337495803833
local_output_nid generation:  0.03411412239074707
local_in_edges_tensor generation:  0.034107208251953125
mini_batch_src_global generation:  0.05319571495056152
r_  generation:  0.4784572124481201
----------------------check_connections_block total spend ----------------------------- 11.423351526260376
generate_one_block  0.6403439044952393
generate_one_block  0.6380374431610107
generate_one_block  0.6261518001556396
generate_one_block  0.624168872833252
generate_one_block  0.6245582103729248
generate_one_block  0.6218850612640381
generate_one_block  0.6226658821105957
generate_one_block  0.6328866481781006
generate_one_block  0.6577608585357666
generate_one_block  0.6255197525024414
generate_one_block  0.6261751651763916
generate_one_block  0.631688117980957
generate_one_block  0.6262557506561279
generate_one_block  0.6242473125457764
generate_one_block  0.6336963176727295
generate_one_block  0.6281797885894775
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.1288766860961914  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

connection checking time:  17.985119342803955
block generation total time  16.264767169952393
average batch blocks generation time:  1.0165479481220245
block dataloader generation time/epoch 37.16138768196106
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.1011648178100586  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

torch.Size([156791, 128])
torch.Size([130142, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 17.92464590072632  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.10094165802001953  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

torch.Size([156769, 128])
torch.Size([129745, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 17.890772819519043  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.10154151916503906  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

torch.Size([157010, 128])
torch.Size([130458, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 18.19082736968994  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.1009378433227539  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

torch.Size([156630, 128])
torch.Size([129521, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 17.922943115234375  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.10137796401977539  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

torch.Size([157161, 128])
torch.Size([130771, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 17.95882272720337  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.10089635848999023  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

torch.Size([156346, 128])
torch.Size([128809, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 17.8491153717041  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.10113906860351562  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

torch.Size([156644, 128])
torch.Size([129120, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 17.93898344039917  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.1010732650756836  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

torch.Size([156629, 128])
torch.Size([130042, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 18.11380434036255  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.10123348236083984  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

torch.Size([156734, 128])
torch.Size([130036, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 18.022705078125  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.10098934173583984  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

torch.Size([157115, 128])
torch.Size([130136, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 17.987488269805908  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.10125255584716797  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

torch.Size([156952, 128])
torch.Size([129730, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 17.911738395690918  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.1009669303894043  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

torch.Size([156801, 128])
torch.Size([130102, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 17.950905799865723  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.10127115249633789  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

torch.Size([156839, 128])
torch.Size([129992, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 18.01945447921753  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.10100364685058594  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

torch.Size([157082, 128])
torch.Size([130074, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 18.027451515197754  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.10134410858154297  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

torch.Size([156900, 128])
torch.Size([130040, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 18.037964820861816  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.10092449188232422  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

torch.Size([156563, 128])
torch.Size([129289, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 17.892383098602295  GigaBytes
Max Memory Allocated: 18.257999897003174  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03469671308994293 |0.024715840816497803 |0.5653953552246094 |0.00010128319263458252 |1.0120803117752075 |0.00531768798828125 |
----------------------------------------------------------pseudo_mini_loss sum 3.3083791732788086
Total (block generation + training)time/epoch 63.39167356491089
Training time/epoch 26.230026960372925
Training time without block to device /epoch 25.83457350730896
Training time without total dataloading part /epoch 25.246548891067505
load block tensor time/epoch 0.5551474094390869
block to device time/epoch 0.39545345306396484
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5317339
Number of first layer input nodes during this epoch:  2508966
