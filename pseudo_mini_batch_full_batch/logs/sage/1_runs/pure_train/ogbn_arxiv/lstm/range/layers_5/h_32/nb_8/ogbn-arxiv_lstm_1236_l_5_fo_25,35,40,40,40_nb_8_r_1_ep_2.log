Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648504345.589636
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000690460205078125  GigaBytes
Max Memory Allocated: 0.000690460205078125  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.024674177169799805
range selection method range initialization spend 0.013455629348754883
time for parepare:  0.017805814743041992
local_output_nid generation:  0.0026738643646240234
local_in_edges_tensor generation:  0.004615068435668945
mini_batch_src_global generation:  0.003277301788330078
r_  generation:  0.037461280822753906
local_output_nid generation:  0.0029959678649902344
local_in_edges_tensor generation:  0.0016448497772216797
mini_batch_src_global generation:  0.004085540771484375
r_  generation:  0.037940263748168945
local_output_nid generation:  0.0031964778900146484
local_in_edges_tensor generation:  0.0017135143280029297
mini_batch_src_global generation:  0.0026466846466064453
r_  generation:  0.0381622314453125
local_output_nid generation:  0.0031185150146484375
local_in_edges_tensor generation:  0.0016927719116210938
mini_batch_src_global generation:  0.0027980804443359375
r_  generation:  0.039781808853149414
local_output_nid generation:  0.0031244754791259766
local_in_edges_tensor generation:  0.0016758441925048828
mini_batch_src_global generation:  0.002933502197265625
r_  generation:  0.04054975509643555
local_output_nid generation:  0.003081798553466797
local_in_edges_tensor generation:  0.0017266273498535156
mini_batch_src_global generation:  0.003031015396118164
r_  generation:  0.04044604301452637
local_output_nid generation:  0.0031583309173583984
local_in_edges_tensor generation:  0.0017316341400146484
mini_batch_src_global generation:  0.002994537353515625
r_  generation:  0.0405116081237793
local_output_nid generation:  0.003118276596069336
local_in_edges_tensor generation:  0.0016684532165527344
mini_batch_src_global generation:  0.0031020641326904297
r_  generation:  0.04018115997314453
----------------------check_connections_block total spend ----------------------------- 0.4652860164642334
generate_one_block  0.05491065979003906
generate_one_block  0.05499696731567383
generate_one_block  0.05446457862854004
generate_one_block  0.054628610610961914
generate_one_block  0.05825185775756836
generate_one_block  0.05637502670288086
generate_one_block  0.05402350425720215
generate_one_block  0.054273128509521484
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.04218769073486328
gen group dst list time:  0.015110492706298828
time for parepare:  0.019631624221801758
local_output_nid generation:  0.010821819305419922
local_in_edges_tensor generation:  0.030250072479248047
mini_batch_src_global generation:  0.030819177627563477
r_  generation:  0.3008534908294678
local_output_nid generation:  0.018234968185424805
local_in_edges_tensor generation:  0.02891254425048828
mini_batch_src_global generation:  0.03596830368041992
r_  generation:  0.3012876510620117
local_output_nid generation:  0.019210338592529297
local_in_edges_tensor generation:  0.024272441864013672
mini_batch_src_global generation:  0.03675270080566406
r_  generation:  0.3151431083679199
local_output_nid generation:  0.01979994773864746
local_in_edges_tensor generation:  0.021204233169555664
mini_batch_src_global generation:  0.039628028869628906
r_  generation:  0.31273412704467773
local_output_nid generation:  0.02353644371032715
local_in_edges_tensor generation:  0.025223970413208008
mini_batch_src_global generation:  0.04043865203857422
r_  generation:  0.3201315402984619
local_output_nid generation:  0.020174503326416016
local_in_edges_tensor generation:  0.01970982551574707
mini_batch_src_global generation:  0.03908491134643555
r_  generation:  0.3197619915008545
local_output_nid generation:  0.020314931869506836
local_in_edges_tensor generation:  0.018947362899780273
mini_batch_src_global generation:  0.03879427909851074
r_  generation:  0.3137528896331787
local_output_nid generation:  0.02008986473083496
local_in_edges_tensor generation:  0.02564239501953125
mini_batch_src_global generation:  0.04051494598388672
r_  generation:  0.31688618659973145
----------------------check_connections_block total spend ----------------------------- 3.7013590335845947
generate_one_block  0.4143028259277344
generate_one_block  0.4066026210784912
generate_one_block  0.41306185722351074
generate_one_block  0.4148125648498535
generate_one_block  0.41813182830810547
generate_one_block  0.4183216094970703
generate_one_block  0.40749645233154297
generate_one_block  0.4104180335998535
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0374755859375
gen group dst list time:  0.035570621490478516
time for parepare:  0.01870894432067871
local_output_nid generation:  0.025259017944335938
local_in_edges_tensor generation:  0.04295039176940918
mini_batch_src_global generation:  0.05012774467468262
r_  generation:  0.5248839855194092
local_output_nid generation:  0.03171229362487793
local_in_edges_tensor generation:  0.05172586441040039
mini_batch_src_global generation:  0.059998273849487305
r_  generation:  0.540398359298706
local_output_nid generation:  0.032930612564086914
local_in_edges_tensor generation:  0.03794693946838379
mini_batch_src_global generation:  0.06392693519592285
r_  generation:  0.5400969982147217
local_output_nid generation:  0.03325676918029785
local_in_edges_tensor generation:  0.047017574310302734
mini_batch_src_global generation:  0.06424236297607422
r_  generation:  0.5404605865478516
local_output_nid generation:  0.03821706771850586
local_in_edges_tensor generation:  0.04480791091918945
mini_batch_src_global generation:  0.07018184661865234
r_  generation:  0.5442640781402588
local_output_nid generation:  0.03468132019042969
local_in_edges_tensor generation:  0.04069042205810547
mini_batch_src_global generation:  0.061919450759887695
r_  generation:  0.5403347015380859
local_output_nid generation:  0.034911394119262695
local_in_edges_tensor generation:  0.03729653358459473
mini_batch_src_global generation:  0.05997109413146973
r_  generation:  0.5474481582641602
local_output_nid generation:  0.03480124473571777
local_in_edges_tensor generation:  0.04197072982788086
mini_batch_src_global generation:  0.0626058578491211
r_  generation:  0.5647299289703369
----------------------check_connections_block total spend ----------------------------- 6.430094957351685
generate_one_block  0.6852529048919678
generate_one_block  0.6965465545654297
generate_one_block  0.6824424266815186
generate_one_block  0.696202278137207
generate_one_block  0.6763932704925537
generate_one_block  0.6754519939422607
generate_one_block  0.719519853591919
generate_one_block  0.6996793746948242
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.06439781188964844
gen group dst list time:  0.04462313652038574
time for parepare:  0.01906609535217285
local_output_nid generation:  0.03098583221435547
local_in_edges_tensor generation:  0.07444262504577637
mini_batch_src_global generation:  0.05614948272705078
r_  generation:  0.5342442989349365
local_output_nid generation:  0.036458730697631836
local_in_edges_tensor generation:  0.054234981536865234
mini_batch_src_global generation:  0.06194353103637695
r_  generation:  0.5576825141906738
local_output_nid generation:  0.03686261177062988
local_in_edges_tensor generation:  0.04083847999572754
mini_batch_src_global generation:  0.0628046989440918
r_  generation:  0.5393610000610352
local_output_nid generation:  0.037473201751708984
local_in_edges_tensor generation:  0.050315141677856445
mini_batch_src_global generation:  0.059656381607055664
r_  generation:  0.5481226444244385
local_output_nid generation:  0.03727602958679199
local_in_edges_tensor generation:  0.036458492279052734
mini_batch_src_global generation:  0.06008434295654297
r_  generation:  0.5494694709777832
local_output_nid generation:  0.037471771240234375
local_in_edges_tensor generation:  0.03609609603881836
mini_batch_src_global generation:  0.062490224838256836
r_  generation:  0.5651664733886719
local_output_nid generation:  0.037816762924194336
local_in_edges_tensor generation:  0.04633164405822754
mini_batch_src_global generation:  0.06182551383972168
r_  generation:  0.5771737098693848
local_output_nid generation:  0.039940834045410156
local_in_edges_tensor generation:  0.05261039733886719
mini_batch_src_global generation:  0.05947446823120117
r_  generation:  0.5670168399810791
----------------------check_connections_block total spend ----------------------------- 6.629639387130737
generate_one_block  0.7190909385681152
generate_one_block  0.6919612884521484
generate_one_block  0.6957242488861084
generate_one_block  0.6994290351867676
generate_one_block  0.687690258026123
generate_one_block  0.6925163269042969
generate_one_block  0.7538473606109619
generate_one_block  0.6927046775817871
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.09093379974365234
gen group dst list time:  0.04701495170593262
time for parepare:  0.019538402557373047
local_output_nid generation:  0.031913042068481445
local_in_edges_tensor generation:  0.04313802719116211
mini_batch_src_global generation:  0.04487156867980957
r_  generation:  0.5150697231292725
local_output_nid generation:  0.037207841873168945
local_in_edges_tensor generation:  0.04069232940673828
mini_batch_src_global generation:  0.05816292762756348
r_  generation:  0.5156731605529785
local_output_nid generation:  0.03782796859741211
local_in_edges_tensor generation:  0.035318613052368164
mini_batch_src_global generation:  0.05962204933166504
r_  generation:  0.5155510902404785
local_output_nid generation:  0.03807401657104492
local_in_edges_tensor generation:  0.03725147247314453
mini_batch_src_global generation:  0.06455636024475098
r_  generation:  0.5189545154571533
local_output_nid generation:  0.0421900749206543
local_in_edges_tensor generation:  0.048631906509399414
mini_batch_src_global generation:  0.06509685516357422
r_  generation:  0.510413646697998
local_output_nid generation:  0.038971662521362305
local_in_edges_tensor generation:  0.04733419418334961
mini_batch_src_global generation:  0.057077646255493164
r_  generation:  0.514409065246582
local_output_nid generation:  0.03892016410827637
local_in_edges_tensor generation:  0.04287075996398926
mini_batch_src_global generation:  0.057652950286865234
r_  generation:  0.5132482051849365
local_output_nid generation:  0.039069175720214844
local_in_edges_tensor generation:  0.04266357421875
mini_batch_src_global generation:  0.05673623085021973
r_  generation:  0.5249972343444824
----------------------check_connections_block total spend ----------------------------- 6.205756425857544
generate_one_block  0.6659235954284668
generate_one_block  0.6467268466949463
generate_one_block  0.6386990547180176
generate_one_block  0.6491513252258301
generate_one_block  0.6402111053466797
generate_one_block  0.6454286575317383
generate_one_block  0.6423406600952148
generate_one_block  0.6923158168792725
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000690460205078125  GigaBytes
Max Memory Allocated: 0.000690460205078125  GigaBytes

connection checking time:  22.96684980392456
block generation total time  19.688397645950317
average batch blocks generation time:  2.4610497057437897
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2205810546875 GB
    Memory Allocated: 0.12658119201660156  GigaBytes
Max Memory Allocated: 0.12658119201660156  GigaBytes

torch.Size([167007, 128])
torch.Size([165827, 32])
torch.Size([161401, 32])
torch.Size([142313, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7615966796875 GB
    Memory Allocated: 20.45240068435669  GigaBytes
Max Memory Allocated: 20.464584827423096  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1580810546875 GB
    Memory Allocated: 0.12783336639404297  GigaBytes
Max Memory Allocated: 20.464584827423096  GigaBytes

torch.Size([166973, 128])
torch.Size([165725, 32])
torch.Size([161266, 32])
torch.Size([141751, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1737060546875 GB
    Memory Allocated: 20.420859813690186  GigaBytes
Max Memory Allocated: 20.464584827423096  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1737060546875 GB
    Memory Allocated: 0.1283421516418457  GigaBytes
Max Memory Allocated: 20.464584827423096  GigaBytes

torch.Size([166973, 128])
torch.Size([165727, 32])
torch.Size([161360, 32])
torch.Size([142220, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1737060546875 GB
    Memory Allocated: 20.44113254547119  GigaBytes
Max Memory Allocated: 20.464584827423096  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1737060546875 GB
    Memory Allocated: 0.12799644470214844  GigaBytes
Max Memory Allocated: 20.464584827423096  GigaBytes

torch.Size([167075, 128])
torch.Size([165913, 32])
torch.Size([161628, 32])
torch.Size([142602, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1737060546875 GB
    Memory Allocated: 20.452366828918457  GigaBytes
Max Memory Allocated: 20.466637134552002  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1737060546875 GB
    Memory Allocated: 0.12844038009643555  GigaBytes
Max Memory Allocated: 20.466637134552002  GigaBytes

torch.Size([166937, 128])
torch.Size([165688, 32])
torch.Size([161261, 32])
torch.Size([141815, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1737060546875 GB
    Memory Allocated: 20.45550012588501  GigaBytes
Max Memory Allocated: 20.469738483428955  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1737060546875 GB
    Memory Allocated: 0.12786245346069336  GigaBytes
Max Memory Allocated: 20.469738483428955  GigaBytes

torch.Size([166996, 128])
torch.Size([165742, 32])
torch.Size([161299, 32])
torch.Size([141848, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1737060546875 GB
    Memory Allocated: 20.435139656066895  GigaBytes
Max Memory Allocated: 20.469738483428955  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1737060546875 GB
    Memory Allocated: 0.12892913818359375  GigaBytes
Max Memory Allocated: 20.469738483428955  GigaBytes

torch.Size([166973, 128])
torch.Size([165765, 32])
torch.Size([161284, 32])
torch.Size([141639, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1737060546875 GB
    Memory Allocated: 20.415896892547607  GigaBytes
Max Memory Allocated: 20.469738483428955  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1737060546875 GB
    Memory Allocated: 0.12790822982788086  GigaBytes
Max Memory Allocated: 20.469738483428955  GigaBytes

torch.Size([167004, 128])
torch.Size([165802, 32])
torch.Size([161349, 32])
torch.Size([141952, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1737060546875 GB
    Memory Allocated: 20.430678844451904  GigaBytes
Max Memory Allocated: 20.469738483428955  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04080772399902344 |0.08414405584335327 |0.5790051519870758 |0.00012007355690002441 |0.652653843164444 |0.011471748352050781 |
----------------------------------------------------------pseudo_mini_loss sum 4.501112461090088
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5632616
Number of first layer input nodes during this epoch:  1335938
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.1737060546875 GB
    Memory Allocated: 0.21369314193725586  GigaBytes
Max Memory Allocated: 20.469738483428955  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.026460886001586914
range selection method range initialization spend 0.011894941329956055
time for parepare:  0.017244338989257812
local_output_nid generation:  0.003183126449584961
local_in_edges_tensor generation:  0.008291244506835938
mini_batch_src_global generation:  0.0033388137817382812
r_  generation:  0.037863969802856445
local_output_nid generation:  0.0034286975860595703
local_in_edges_tensor generation:  0.002984285354614258
mini_batch_src_global generation:  0.004275321960449219
r_  generation:  0.040277719497680664
local_output_nid generation:  0.0034873485565185547
local_in_edges_tensor generation:  0.0017597675323486328
mini_batch_src_global generation:  0.002767324447631836
r_  generation:  0.04092764854431152
local_output_nid generation:  0.003515481948852539
local_in_edges_tensor generation:  0.001737833023071289
mini_batch_src_global generation:  0.00286102294921875
r_  generation:  0.041329383850097656
local_output_nid generation:  0.003448009490966797
local_in_edges_tensor generation:  0.0017452239990234375
mini_batch_src_global generation:  0.003022432327270508
r_  generation:  0.041773319244384766
local_output_nid generation:  0.003511190414428711
local_in_edges_tensor generation:  0.0017657279968261719
mini_batch_src_global generation:  0.0031890869140625
r_  generation:  0.04220271110534668
local_output_nid generation:  0.003498554229736328
local_in_edges_tensor generation:  0.0018091201782226562
mini_batch_src_global generation:  0.003202676773071289
r_  generation:  0.04321932792663574
local_output_nid generation:  0.0034618377685546875
local_in_edges_tensor generation:  0.0017473697662353516
mini_batch_src_global generation:  0.003255605697631836
r_  generation:  0.04266023635864258
----------------------check_connections_block total spend ----------------------------- 0.4962646961212158
generate_one_block  0.06792545318603516
generate_one_block  0.06552267074584961
generate_one_block  0.06491732597351074
generate_one_block  0.06464171409606934
generate_one_block  0.0654449462890625
generate_one_block  0.06575894355773926
generate_one_block  0.0670771598815918
generate_one_block  0.06930327415466309
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.04268503189086914
gen group dst list time:  0.02162313461303711
time for parepare:  0.022874116897583008
local_output_nid generation:  0.012369632720947266
local_in_edges_tensor generation:  0.03792238235473633
mini_batch_src_global generation:  0.02843189239501953
r_  generation:  0.30719757080078125
local_output_nid generation:  0.0217897891998291
local_in_edges_tensor generation:  0.02800774574279785
mini_batch_src_global generation:  0.03984522819519043
r_  generation:  0.31864500045776367
local_output_nid generation:  0.026312828063964844
local_in_edges_tensor generation:  0.023504018783569336
mini_batch_src_global generation:  0.03707575798034668
r_  generation:  0.3290712833404541
local_output_nid generation:  0.025650501251220703
local_in_edges_tensor generation:  0.02868342399597168
mini_batch_src_global generation:  0.04035019874572754
r_  generation:  0.33060455322265625
local_output_nid generation:  0.02274346351623535
local_in_edges_tensor generation:  0.027332305908203125
mini_batch_src_global generation:  0.042289018630981445
r_  generation:  0.33330321311950684
local_output_nid generation:  0.022932052612304688
local_in_edges_tensor generation:  0.023992061614990234
mini_batch_src_global generation:  0.040551185607910156
r_  generation:  0.3246324062347412
local_output_nid generation:  0.02320075035095215
local_in_edges_tensor generation:  0.025447368621826172
mini_batch_src_global generation:  0.04059457778930664
r_  generation:  0.3222229480743408
local_output_nid generation:  0.02515435218811035
local_in_edges_tensor generation:  0.02648758888244629
mini_batch_src_global generation:  0.04101300239562988
r_  generation:  0.34169602394104004
----------------------check_connections_block total spend ----------------------------- 3.9256832599639893
generate_one_block  0.4586477279663086
generate_one_block  0.43555665016174316
generate_one_block  0.4386880397796631
generate_one_block  0.4256298542022705
generate_one_block  0.4320530891418457
generate_one_block  0.43329334259033203
generate_one_block  0.43140101432800293
generate_one_block  0.46123480796813965
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04578804969787598
gen group dst list time:  0.03641557693481445
time for parepare:  0.018767118453979492
local_output_nid generation:  0.02487802505493164
local_in_edges_tensor generation:  0.05782914161682129
mini_batch_src_global generation:  0.0484471321105957
r_  generation:  0.523878812789917
local_output_nid generation:  0.03257417678833008
local_in_edges_tensor generation:  0.05431079864501953
mini_batch_src_global generation:  0.06706619262695312
r_  generation:  0.5350370407104492
local_output_nid generation:  0.03310108184814453
local_in_edges_tensor generation:  0.05088996887207031
mini_batch_src_global generation:  0.07549023628234863
r_  generation:  0.5433750152587891
local_output_nid generation:  0.03526949882507324
local_in_edges_tensor generation:  0.04315757751464844
mini_batch_src_global generation:  0.0648195743560791
r_  generation:  0.5318114757537842
local_output_nid generation:  0.034154415130615234
local_in_edges_tensor generation:  0.03313302993774414
mini_batch_src_global generation:  0.061409711837768555
r_  generation:  0.5425019264221191
local_output_nid generation:  0.034253597259521484
local_in_edges_tensor generation:  0.038133859634399414
mini_batch_src_global generation:  0.06314420700073242
r_  generation:  0.5344171524047852
local_output_nid generation:  0.03464102745056152
local_in_edges_tensor generation:  0.04763603210449219
mini_batch_src_global generation:  0.059729576110839844
r_  generation:  0.5482978820800781
local_output_nid generation:  0.03459310531616211
local_in_edges_tensor generation:  0.043134212493896484
mini_batch_src_global generation:  0.0612490177154541
r_  generation:  0.5339310169219971
----------------------check_connections_block total spend ----------------------------- 6.39731764793396
generate_one_block  0.7232918739318848
generate_one_block  0.694077730178833
generate_one_block  0.6832516193389893
generate_one_block  0.6941282749176025
generate_one_block  0.696829080581665
generate_one_block  0.6950588226318359
generate_one_block  0.7108664512634277
generate_one_block  0.6921548843383789
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04682159423828125
gen group dst list time:  0.04569506645202637
time for parepare:  0.01887655258178711
local_output_nid generation:  0.031088829040527344
local_in_edges_tensor generation:  0.059226036071777344
mini_batch_src_global generation:  0.052744150161743164
r_  generation:  0.5359091758728027
local_output_nid generation:  0.03941702842712402
local_in_edges_tensor generation:  0.09424400329589844
mini_batch_src_global generation:  0.06116294860839844
r_  generation:  0.5530767440795898
local_output_nid generation:  0.03631782531738281
local_in_edges_tensor generation:  0.04811549186706543
mini_batch_src_global generation:  0.0697023868560791
r_  generation:  0.556387186050415
local_output_nid generation:  0.040108442306518555
local_in_edges_tensor generation:  0.046372413635253906
mini_batch_src_global generation:  0.06093597412109375
r_  generation:  0.5520937442779541
local_output_nid generation:  0.038079023361206055
local_in_edges_tensor generation:  0.048508405685424805
mini_batch_src_global generation:  0.05906319618225098
r_  generation:  0.5469474792480469
local_output_nid generation:  0.038500070571899414
local_in_edges_tensor generation:  0.0466156005859375
mini_batch_src_global generation:  0.05870795249938965
r_  generation:  0.5526797771453857
local_output_nid generation:  0.037832021713256836
local_in_edges_tensor generation:  0.04145669937133789
mini_batch_src_global generation:  0.05948352813720703
r_  generation:  0.5542194843292236
local_output_nid generation:  0.03788328170776367
local_in_edges_tensor generation:  0.041155099868774414
mini_batch_src_global generation:  0.05835127830505371
r_  generation:  0.5576381683349609
----------------------check_connections_block total spend ----------------------------- 6.636596441268921
generate_one_block  0.7095439434051514
generate_one_block  0.7068765163421631
generate_one_block  0.7022449970245361
generate_one_block  0.7052078247070312
generate_one_block  0.7082836627960205
generate_one_block  0.705897331237793
generate_one_block  0.7113242149353027
generate_one_block  0.6923890113830566
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04706168174743652
gen group dst list time:  0.0499272346496582
time for parepare:  0.01897907257080078
local_output_nid generation:  0.031301259994506836
local_in_edges_tensor generation:  0.05247163772583008
mini_batch_src_global generation:  0.0454103946685791
r_  generation:  0.5044858455657959
local_output_nid generation:  0.03694653511047363
local_in_edges_tensor generation:  0.0348966121673584
mini_batch_src_global generation:  0.057488203048706055
r_  generation:  0.5048208236694336
local_output_nid generation:  0.03740215301513672
local_in_edges_tensor generation:  0.035355329513549805
mini_batch_src_global generation:  0.05817985534667969
r_  generation:  0.5113027095794678
local_output_nid generation:  0.037770986557006836
local_in_edges_tensor generation:  0.04045891761779785
mini_batch_src_global generation:  0.05817437171936035
r_  generation:  0.5190057754516602
local_output_nid generation:  0.03814983367919922
local_in_edges_tensor generation:  0.03637814521789551
mini_batch_src_global generation:  0.05798006057739258
r_  generation:  0.5118834972381592
local_output_nid generation:  0.03834724426269531
local_in_edges_tensor generation:  0.07361888885498047
mini_batch_src_global generation:  0.05701017379760742
r_  generation:  0.5138983726501465
local_output_nid generation:  0.03853869438171387
local_in_edges_tensor generation:  0.03991866111755371
mini_batch_src_global generation:  0.0567479133605957
r_  generation:  0.5146067142486572
local_output_nid generation:  0.039095163345336914
local_in_edges_tensor generation:  0.04072451591491699
mini_batch_src_global generation:  0.05755043029785156
r_  generation:  0.5133223533630371
----------------------check_connections_block total spend ----------------------------- 6.154486417770386
generate_one_block  0.6457822322845459
generate_one_block  0.6636555194854736
generate_one_block  0.6563479900360107
generate_one_block  0.661675214767456
generate_one_block  0.6590111255645752
generate_one_block  0.6635415554046631
generate_one_block  0.6638913154602051
generate_one_block  0.658987283706665
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.1737060546875 GB
    Memory Allocated: 0.21369314193725586  GigaBytes
Max Memory Allocated: 20.469738483428955  GigaBytes

connection checking time:  23.114083766937256
block generation total time  20.020823001861572
average batch blocks generation time:  2.5026028752326965
block dataloader generation time/epoch 45.981157302856445
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1737060546875 GB
    Memory Allocated: 0.1296367645263672  GigaBytes
Max Memory Allocated: 20.469738483428955  GigaBytes

torch.Size([166941, 128])
torch.Size([165647, 32])
torch.Size([161202, 32])
torch.Size([141867, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1737060546875 GB
    Memory Allocated: 20.418241024017334  GigaBytes
Max Memory Allocated: 20.469738483428955  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1737060546875 GB
    Memory Allocated: 0.12932157516479492  GigaBytes
Max Memory Allocated: 20.469738483428955  GigaBytes

torch.Size([166996, 128])
torch.Size([165791, 32])
torch.Size([161375, 32])
torch.Size([141908, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1737060546875 GB
    Memory Allocated: 20.452548503875732  GigaBytes
Max Memory Allocated: 20.469738483428955  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1737060546875 GB
    Memory Allocated: 0.1296849250793457  GigaBytes
Max Memory Allocated: 20.469738483428955  GigaBytes

torch.Size([166910, 128])
torch.Size([165609, 32])
torch.Size([161238, 32])
torch.Size([141907, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1737060546875 GB
    Memory Allocated: 20.42946195602417  GigaBytes
Max Memory Allocated: 20.469738483428955  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1737060546875 GB
    Memory Allocated: 0.1292095184326172  GigaBytes
Max Memory Allocated: 20.469738483428955  GigaBytes

torch.Size([167001, 128])
torch.Size([165836, 32])
torch.Size([161502, 32])
torch.Size([141968, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1737060546875 GB
    Memory Allocated: 20.422046661376953  GigaBytes
Max Memory Allocated: 20.469738483428955  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1737060546875 GB
    Memory Allocated: 0.1296992301940918  GigaBytes
Max Memory Allocated: 20.469738483428955  GigaBytes

torch.Size([166966, 128])
torch.Size([165755, 32])
torch.Size([161306, 32])
torch.Size([141764, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1737060546875 GB
    Memory Allocated: 20.432589054107666  GigaBytes
Max Memory Allocated: 20.469738483428955  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1737060546875 GB
    Memory Allocated: 0.1292858123779297  GigaBytes
Max Memory Allocated: 20.469738483428955  GigaBytes

torch.Size([167025, 128])
torch.Size([165872, 32])
torch.Size([161505, 32])
torch.Size([141940, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1737060546875 GB
    Memory Allocated: 20.433547973632812  GigaBytes
Max Memory Allocated: 20.469738483428955  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1737060546875 GB
    Memory Allocated: 0.13041257858276367  GigaBytes
Max Memory Allocated: 20.469738483428955  GigaBytes

torch.Size([166952, 128])
torch.Size([165771, 32])
torch.Size([161437, 32])
torch.Size([142474, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1737060546875 GB
    Memory Allocated: 20.4471755027771  GigaBytes
Max Memory Allocated: 20.469738483428955  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1737060546875 GB
    Memory Allocated: 0.1292872428894043  GigaBytes
Max Memory Allocated: 20.469738483428955  GigaBytes

torch.Size([166962, 128])
torch.Size([165730, 32])
torch.Size([161322, 32])
torch.Size([141983, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1737060546875 GB
    Memory Allocated: 20.43997621536255  GigaBytes
Max Memory Allocated: 20.469738483428955  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.041200846433639526 |0.04319360852241516 |0.45828142762184143 |0.00010463595390319824 |0.6411770582199097 |0.008871316909790039 |
----------------------------------------------------------pseudo_mini_loss sum 4.012387275695801
Total (block generation + training)time/epoch 55.49098610877991
Training time/epoch 9.50952696800232
Training time without block to device /epoch 9.163978099822998
Training time without total dataloading part /epoch 8.805376291275024
load block tensor time/epoch 0.3296067714691162
block to device time/epoch 0.3455488681793213
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5631177
Number of first layer input nodes during this epoch:  1335753
