Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648472717.170704
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017633438110351562  GigaBytes
Max Memory Allocated: 0.0017633438110351562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025653362274169922
range selection method range initialization spend 0.013748884201049805
time for parepare:  0.017835378646850586
local_output_nid generation:  0.002641439437866211
local_in_edges_tensor generation:  0.004050493240356445
mini_batch_src_global generation:  0.003729104995727539
r_  generation:  0.04172062873840332
local_output_nid generation:  0.0031425952911376953
local_in_edges_tensor generation:  0.001722097396850586
mini_batch_src_global generation:  0.004931211471557617
r_  generation:  0.04459977149963379
local_output_nid generation:  0.003185272216796875
local_in_edges_tensor generation:  0.0017397403717041016
mini_batch_src_global generation:  0.0032727718353271484
r_  generation:  0.0444185733795166
local_output_nid generation:  0.003209829330444336
local_in_edges_tensor generation:  0.0017132759094238281
mini_batch_src_global generation:  0.003374338150024414
r_  generation:  0.045612335205078125
local_output_nid generation:  0.0032415390014648438
local_in_edges_tensor generation:  0.0017135143280029297
mini_batch_src_global generation:  0.00353240966796875
r_  generation:  0.04709196090698242
local_output_nid generation:  0.0032515525817871094
local_in_edges_tensor generation:  0.001706838607788086
mini_batch_src_global generation:  0.0037963390350341797
r_  generation:  0.04742622375488281
local_output_nid generation:  0.0031633377075195312
local_in_edges_tensor generation:  0.0017023086547851562
mini_batch_src_global generation:  0.0038580894470214844
r_  generation:  0.04724383354187012
local_output_nid generation:  0.0032401084899902344
local_in_edges_tensor generation:  0.0017514228820800781
mini_batch_src_global generation:  0.0037763118743896484
r_  generation:  0.0471193790435791
----------------------check_connections_block total spend ----------------------------- 0.531501293182373
generate_one_block  0.059824228286743164
generate_one_block  0.06290411949157715
generate_one_block  0.06112527847290039
generate_one_block  0.06104302406311035
generate_one_block  0.06438159942626953
generate_one_block  0.06277132034301758
generate_one_block  0.06143784523010254
generate_one_block  0.061568498611450195
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03923153877258301
gen group dst list time:  0.016513586044311523
time for parepare:  0.01919078826904297
local_output_nid generation:  0.01112985610961914
local_in_edges_tensor generation:  0.030665159225463867
mini_batch_src_global generation:  0.03223395347595215
r_  generation:  0.31122732162475586
local_output_nid generation:  0.017650365829467773
local_in_edges_tensor generation:  0.02944803237915039
mini_batch_src_global generation:  0.03918027877807617
r_  generation:  0.3292267322540283
local_output_nid generation:  0.018243074417114258
local_in_edges_tensor generation:  0.026630163192749023
mini_batch_src_global generation:  0.03778696060180664
r_  generation:  0.32601094245910645
local_output_nid generation:  0.018503427505493164
local_in_edges_tensor generation:  0.0189974308013916
mini_batch_src_global generation:  0.04200148582458496
r_  generation:  0.3278024196624756
local_output_nid generation:  0.018618106842041016
local_in_edges_tensor generation:  0.021241188049316406
mini_batch_src_global generation:  0.03951001167297363
r_  generation:  0.3335385322570801
local_output_nid generation:  0.019005537033081055
local_in_edges_tensor generation:  0.02533102035522461
mini_batch_src_global generation:  0.0415501594543457
r_  generation:  0.3391432762145996
local_output_nid generation:  0.018948078155517578
local_in_edges_tensor generation:  0.018918275833129883
mini_batch_src_global generation:  0.040495872497558594
r_  generation:  0.3367948532104492
local_output_nid generation:  0.018964052200317383
local_in_edges_tensor generation:  0.021369457244873047
mini_batch_src_global generation:  0.04638957977294922
r_  generation:  0.33355045318603516
----------------------check_connections_block total spend ----------------------------- 3.8723533153533936
generate_one_block  0.426969051361084
generate_one_block  0.4474949836730957
generate_one_block  0.4332096576690674
generate_one_block  0.4272274971008301
generate_one_block  0.43682432174682617
generate_one_block  0.4570503234863281
generate_one_block  0.4367256164550781
generate_one_block  0.4209306240081787
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0313718318939209
gen group dst list time:  0.03695225715637207
time for parepare:  0.018890380859375
local_output_nid generation:  0.025011539459228516
local_in_edges_tensor generation:  0.03914356231689453
mini_batch_src_global generation:  0.04963040351867676
r_  generation:  0.47626161575317383
local_output_nid generation:  0.03293180465698242
local_in_edges_tensor generation:  0.05520462989807129
mini_batch_src_global generation:  0.05920577049255371
r_  generation:  0.47916412353515625
local_output_nid generation:  0.033133506774902344
local_in_edges_tensor generation:  0.03474831581115723
mini_batch_src_global generation:  0.051100730895996094
r_  generation:  0.49321436882019043
local_output_nid generation:  0.03439021110534668
local_in_edges_tensor generation:  0.03543591499328613
mini_batch_src_global generation:  0.05637717247009277
r_  generation:  0.483569860458374
local_output_nid generation:  0.03321480751037598
local_in_edges_tensor generation:  0.03250265121459961
mini_batch_src_global generation:  0.05227160453796387
r_  generation:  0.4943513870239258
local_output_nid generation:  0.03409886360168457
local_in_edges_tensor generation:  0.039208173751831055
mini_batch_src_global generation:  0.05726146697998047
r_  generation:  0.49124860763549805
local_output_nid generation:  0.033754825592041016
local_in_edges_tensor generation:  0.04334616661071777
mini_batch_src_global generation:  0.05660843849182129
r_  generation:  0.4960932731628418
local_output_nid generation:  0.03429222106933594
local_in_edges_tensor generation:  0.03452658653259277
mini_batch_src_global generation:  0.05487060546875
r_  generation:  0.4867818355560303
----------------------check_connections_block total spend ----------------------------- 5.8012731075286865
generate_one_block  0.6192970275878906
generate_one_block  0.6235437393188477
generate_one_block  0.6088070869445801
generate_one_block  0.622051477432251
generate_one_block  0.6056323051452637
generate_one_block  0.6218228340148926
generate_one_block  0.6442470550537109
generate_one_block  0.6098244190216064
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017633438110351562  GigaBytes
Max Memory Allocated: 0.0017633438110351562  GigaBytes

connection checking time:  9.67362642288208
block generation total time  8.441658020019531
average batch blocks generation time:  1.0552072525024414
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1815185546875 GB
    Memory Allocated: 0.09902000427246094  GigaBytes
Max Memory Allocated: 0.09902000427246094  GigaBytes

torch.Size([160954, 128])
torch.Size([142752, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.8729248046875 GB
    Memory Allocated: 20.282236099243164  GigaBytes
Max Memory Allocated: 20.346787452697754  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3865966796875 GB
    Memory Allocated: 0.10273408889770508  GigaBytes
Max Memory Allocated: 20.346787452697754  GigaBytes

torch.Size([161124, 128])
torch.Size([143757, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2752685546875 GB
    Memory Allocated: 20.488239765167236  GigaBytes
Max Memory Allocated: 20.55758237838745  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2947998046875 GB
    Memory Allocated: 0.1026453971862793  GigaBytes
Max Memory Allocated: 20.55758237838745  GigaBytes

torch.Size([160805, 128])
torch.Size([142620, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3631591796875 GB
    Memory Allocated: 20.24937391281128  GigaBytes
Max Memory Allocated: 20.55758237838745  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4979248046875 GB
    Memory Allocated: 0.10394906997680664  GigaBytes
Max Memory Allocated: 20.55758237838745  GigaBytes

torch.Size([161098, 128])
torch.Size([143184, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.8084716796875 GB
    Memory Allocated: 20.23513174057007  GigaBytes
Max Memory Allocated: 20.55758237838745  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3084716796875 GB
    Memory Allocated: 0.10243701934814453  GigaBytes
Max Memory Allocated: 20.55758237838745  GigaBytes

torch.Size([160877, 128])
torch.Size([142622, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3436279296875 GB
    Memory Allocated: 20.256041526794434  GigaBytes
Max Memory Allocated: 20.55758237838745  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3436279296875 GB
    Memory Allocated: 0.10265398025512695  GigaBytes
Max Memory Allocated: 20.55758237838745  GigaBytes

torch.Size([161010, 128])
torch.Size([143356, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3709716796875 GB
    Memory Allocated: 20.440104484558105  GigaBytes
Max Memory Allocated: 20.55758237838745  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3709716796875 GB
    Memory Allocated: 0.10244464874267578  GigaBytes
Max Memory Allocated: 20.55758237838745  GigaBytes

torch.Size([160873, 128])
torch.Size([142731, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3709716796875 GB
    Memory Allocated: 20.260958671569824  GigaBytes
Max Memory Allocated: 20.55758237838745  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3709716796875 GB
    Memory Allocated: 0.10236215591430664  GigaBytes
Max Memory Allocated: 20.55758237838745  GigaBytes

torch.Size([160834, 128])
torch.Size([142750, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3709716796875 GB
    Memory Allocated: 20.176915168762207  GigaBytes
Max Memory Allocated: 20.55758237838745  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04259487986564636 |0.061868637800216675 |0.6805559396743774 |0.00012311339378356934 |0.8828453719615936 |0.01032257080078125 |
----------------------------------------------------------pseudo_mini_loss sum 4.992802143096924
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3020570
Number of first layer input nodes during this epoch:  1287575
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.3709716796875 GB
    Memory Allocated: 0.13867425918579102  GigaBytes
Max Memory Allocated: 20.55758237838745  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.029659032821655273
range selection method range initialization spend 0.011867761611938477
time for parepare:  0.01711869239807129
local_output_nid generation:  0.0030968189239501953
local_in_edges_tensor generation:  0.03338003158569336
mini_batch_src_global generation:  0.003972768783569336
r_  generation:  0.04211115837097168
local_output_nid generation:  0.003327608108520508
local_in_edges_tensor generation:  0.0017502307891845703
mini_batch_src_global generation:  0.00479888916015625
r_  generation:  0.04479384422302246
local_output_nid generation:  0.0033817291259765625
local_in_edges_tensor generation:  0.00177001953125
mini_batch_src_global generation:  0.003199338912963867
r_  generation:  0.04506635665893555
local_output_nid generation:  0.003418445587158203
local_in_edges_tensor generation:  0.0017769336700439453
mini_batch_src_global generation:  0.0034258365631103516
r_  generation:  0.046452999114990234
local_output_nid generation:  0.0034513473510742188
local_in_edges_tensor generation:  0.0020940303802490234
mini_batch_src_global generation:  0.0035924911499023438
r_  generation:  0.048517465591430664
local_output_nid generation:  0.0033779144287109375
local_in_edges_tensor generation:  0.0017545223236083984
mini_batch_src_global generation:  0.0037784576416015625
r_  generation:  0.04748082160949707
local_output_nid generation:  0.003391265869140625
local_in_edges_tensor generation:  0.0017673969268798828
mini_batch_src_global generation:  0.0038597583770751953
r_  generation:  0.04828143119812012
local_output_nid generation:  0.0034797191619873047
local_in_edges_tensor generation:  0.0017237663269042969
mini_batch_src_global generation:  0.003916263580322266
r_  generation:  0.0481104850769043
----------------------check_connections_block total spend ----------------------------- 0.5736720561981201
generate_one_block  0.07553529739379883
generate_one_block  0.07334256172180176
generate_one_block  0.07210206985473633
generate_one_block  0.07371234893798828
generate_one_block  0.07478046417236328
generate_one_block  0.07380104064941406
generate_one_block  0.07692098617553711
generate_one_block  0.07466578483581543
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04088425636291504
gen group dst list time:  0.01764988899230957
time for parepare:  0.020528078079223633
local_output_nid generation:  0.013448476791381836
local_in_edges_tensor generation:  0.04340314865112305
mini_batch_src_global generation:  0.037790775299072266
r_  generation:  0.3277440071105957
local_output_nid generation:  0.020898103713989258
local_in_edges_tensor generation:  0.03344273567199707
mini_batch_src_global generation:  0.03926539421081543
r_  generation:  0.33107709884643555
local_output_nid generation:  0.018244266510009766
local_in_edges_tensor generation:  0.022299766540527344
mini_batch_src_global generation:  0.03834342956542969
r_  generation:  0.32925844192504883
local_output_nid generation:  0.019016265869140625
local_in_edges_tensor generation:  0.022856950759887695
mini_batch_src_global generation:  0.0404052734375
r_  generation:  0.34482884407043457
local_output_nid generation:  0.019002676010131836
local_in_edges_tensor generation:  0.026192188262939453
mini_batch_src_global generation:  0.040578603744506836
r_  generation:  0.3419668674468994
local_output_nid generation:  0.01896071434020996
local_in_edges_tensor generation:  0.022997140884399414
mini_batch_src_global generation:  0.04083657264709473
r_  generation:  0.34690284729003906
local_output_nid generation:  0.01936030387878418
local_in_edges_tensor generation:  0.0259096622467041
mini_batch_src_global generation:  0.04039144515991211
r_  generation:  0.3400869369506836
local_output_nid generation:  0.01899862289428711
local_in_edges_tensor generation:  0.022721290588378906
mini_batch_src_global generation:  0.04078555107116699
r_  generation:  0.3416457176208496
----------------------check_connections_block total spend ----------------------------- 3.9946577548980713
generate_one_block  0.47370290756225586
generate_one_block  0.4707496166229248
generate_one_block  0.44776034355163574
generate_one_block  0.4663982391357422
generate_one_block  0.46818995475769043
generate_one_block  0.4755110740661621
generate_one_block  0.46861720085144043
generate_one_block  0.5073513984680176
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04365825653076172
gen group dst list time:  0.03886222839355469
time for parepare:  0.01933121681213379
local_output_nid generation:  0.027462482452392578
local_in_edges_tensor generation:  0.052361488342285156
mini_batch_src_global generation:  0.04779529571533203
r_  generation:  0.47401976585388184
local_output_nid generation:  0.033269405364990234
local_in_edges_tensor generation:  0.04953622817993164
mini_batch_src_global generation:  0.053872108459472656
r_  generation:  0.4849555492401123
local_output_nid generation:  0.033431291580200195
local_in_edges_tensor generation:  0.036981821060180664
mini_batch_src_global generation:  0.05123138427734375
r_  generation:  0.4961888790130615
local_output_nid generation:  0.03366899490356445
local_in_edges_tensor generation:  0.040740251541137695
mini_batch_src_global generation:  0.05298137664794922
r_  generation:  0.49060750007629395
local_output_nid generation:  0.03387594223022461
local_in_edges_tensor generation:  0.03730964660644531
mini_batch_src_global generation:  0.05868887901306152
r_  generation:  0.5011758804321289
local_output_nid generation:  0.034140586853027344
local_in_edges_tensor generation:  0.033335208892822266
mini_batch_src_global generation:  0.05393815040588379
r_  generation:  0.49173569679260254
local_output_nid generation:  0.03405475616455078
local_in_edges_tensor generation:  0.037008047103881836
mini_batch_src_global generation:  0.05400729179382324
r_  generation:  0.503077507019043
local_output_nid generation:  0.034055471420288086
local_in_edges_tensor generation:  0.038103580474853516
mini_batch_src_global generation:  0.05477285385131836
r_  generation:  0.4969000816345215
----------------------check_connections_block total spend ----------------------------- 5.832974910736084
generate_one_block  0.6544992923736572
generate_one_block  0.6489920616149902
generate_one_block  0.6376810073852539
generate_one_block  0.6527197360992432
generate_one_block  0.6526520252227783
generate_one_block  0.6359574794769287
generate_one_block  0.6520276069641113
generate_one_block  0.6399035453796387
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.3709716796875 GB
    Memory Allocated: 0.13867425918579102  GigaBytes
Max Memory Allocated: 20.55758237838745  GigaBytes

connection checking time:  9.827632665634155
block generation total time  8.95271348953247
average batch blocks generation time:  1.1190891861915588
block dataloader generation time/epoch 21.224788904190063
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3709716796875 GB
    Memory Allocated: 0.10589361190795898  GigaBytes
Max Memory Allocated: 20.55758237838745  GigaBytes

torch.Size([160787, 128])
torch.Size([142873, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3709716796875 GB
    Memory Allocated: 20.22996425628662  GigaBytes
Max Memory Allocated: 20.55758237838745  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3709716796875 GB
    Memory Allocated: 0.10605764389038086  GigaBytes
Max Memory Allocated: 20.55758237838745  GigaBytes

torch.Size([160860, 128])
torch.Size([142852, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3709716796875 GB
    Memory Allocated: 20.367313861846924  GigaBytes
Max Memory Allocated: 20.55758237838745  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3709716796875 GB
    Memory Allocated: 0.10590505599975586  GigaBytes
Max Memory Allocated: 20.55758237838745  GigaBytes

torch.Size([160902, 128])
torch.Size([142817, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3709716796875 GB
    Memory Allocated: 20.180309295654297  GigaBytes
Max Memory Allocated: 20.55758237838745  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3709716796875 GB
    Memory Allocated: 0.1060943603515625  GigaBytes
Max Memory Allocated: 20.55758237838745  GigaBytes

torch.Size([160855, 128])
torch.Size([142738, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3709716796875 GB
    Memory Allocated: 20.389852046966553  GigaBytes
Max Memory Allocated: 20.55758237838745  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3709716796875 GB
    Memory Allocated: 0.10583782196044922  GigaBytes
Max Memory Allocated: 20.55758237838745  GigaBytes

torch.Size([161019, 128])
torch.Size([143097, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3709716796875 GB
    Memory Allocated: 20.377448558807373  GigaBytes
Max Memory Allocated: 20.55758237838745  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3709716796875 GB
    Memory Allocated: 0.10536861419677734  GigaBytes
Max Memory Allocated: 20.55758237838745  GigaBytes

torch.Size([160811, 128])
torch.Size([142757, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4061279296875 GB
    Memory Allocated: 20.18513822555542  GigaBytes
Max Memory Allocated: 20.55758237838745  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4061279296875 GB
    Memory Allocated: 0.10615110397338867  GigaBytes
Max Memory Allocated: 20.55758237838745  GigaBytes

torch.Size([161130, 128])
torch.Size([143003, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4061279296875 GB
    Memory Allocated: 20.32830047607422  GigaBytes
Max Memory Allocated: 20.55758237838745  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4061279296875 GB
    Memory Allocated: 0.10599517822265625  GigaBytes
Max Memory Allocated: 20.55758237838745  GigaBytes

torch.Size([160921, 128])
torch.Size([142800, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4061279296875 GB
    Memory Allocated: 20.23052406311035  GigaBytes
Max Memory Allocated: 20.55758237838745  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04168996214866638 |0.01944422721862793 |0.4595726728439331 |9.998679161071777e-05 |0.8618101179599762 |0.006026506423950195 |
----------------------------------------------------------pseudo_mini_loss sum 3.311586856842041
Total (block generation + training)time/epoch 32.31326937675476
Training time/epoch 11.088196039199829
Training time without block to device /epoch 10.932642221450806
Training time without total dataloading part /epoch 10.57788872718811
load block tensor time/epoch 0.33351969718933105
block to device time/epoch 0.15555381774902344
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3019428
Number of first layer input nodes during this epoch:  1287285
