Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648470419.119676
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02749490737915039
range selection method range initialization spend 0.013721466064453125
time for parepare:  0.018126487731933594
local_output_nid generation:  0.0013442039489746094
local_in_edges_tensor generation:  0.003976345062255859
mini_batch_src_global generation:  0.002025604248046875
r_  generation:  0.021219730377197266
local_output_nid generation:  0.0015001296997070312
local_in_edges_tensor generation:  0.0009548664093017578
mini_batch_src_global generation:  0.0024886131286621094
r_  generation:  0.020892858505249023
local_output_nid generation:  0.0015027523040771484
local_in_edges_tensor generation:  0.0009136199951171875
mini_batch_src_global generation:  0.0015952587127685547
r_  generation:  0.020250797271728516
local_output_nid generation:  0.0015451908111572266
local_in_edges_tensor generation:  0.0008845329284667969
mini_batch_src_global generation:  0.0016489028930664062
r_  generation:  0.02054738998413086
local_output_nid generation:  0.0015106201171875
local_in_edges_tensor generation:  0.0008728504180908203
mini_batch_src_global generation:  0.0015795230865478516
r_  generation:  0.0208282470703125
local_output_nid generation:  0.0015099048614501953
local_in_edges_tensor generation:  0.0009102821350097656
mini_batch_src_global generation:  0.0016849040985107422
r_  generation:  0.022049665451049805
local_output_nid generation:  0.0014791488647460938
local_in_edges_tensor generation:  0.0008828639984130859
mini_batch_src_global generation:  0.0016810894012451172
r_  generation:  0.021322250366210938
local_output_nid generation:  0.0015096664428710938
local_in_edges_tensor generation:  0.0008759498596191406
mini_batch_src_global generation:  0.0016407966613769531
r_  generation:  0.021772384643554688
local_output_nid generation:  0.0014996528625488281
local_in_edges_tensor generation:  0.0009107589721679688
mini_batch_src_global generation:  0.0016527175903320312
r_  generation:  0.021585464477539062
local_output_nid generation:  0.001603841781616211
local_in_edges_tensor generation:  0.0008726119995117188
mini_batch_src_global generation:  0.0017368793487548828
r_  generation:  0.022043466567993164
local_output_nid generation:  0.0015211105346679688
local_in_edges_tensor generation:  0.0009126663208007812
mini_batch_src_global generation:  0.0016932487487792969
r_  generation:  0.021906614303588867
local_output_nid generation:  0.0015034675598144531
local_in_edges_tensor generation:  0.0008776187896728516
mini_batch_src_global generation:  0.0017666816711425781
r_  generation:  0.022218704223632812
local_output_nid generation:  0.0015044212341308594
local_in_edges_tensor generation:  0.0009024143218994141
mini_batch_src_global generation:  0.0017905235290527344
r_  generation:  0.022712230682373047
local_output_nid generation:  0.0015294551849365234
local_in_edges_tensor generation:  0.0008728504180908203
mini_batch_src_global generation:  0.001802682876586914
r_  generation:  0.022676706314086914
local_output_nid generation:  0.0015230178833007812
local_in_edges_tensor generation:  0.0009000301361083984
mini_batch_src_global generation:  0.0017964839935302734
r_  generation:  0.0226137638092041
local_output_nid generation:  0.0015416145324707031
local_in_edges_tensor generation:  0.0008924007415771484
mini_batch_src_global generation:  0.0018088817596435547
r_  generation:  0.02241802215576172
----------------------check_connections_block total spend ----------------------------- 0.5115132331848145
generate_one_block  0.030028343200683594
generate_one_block  0.03199148178100586
generate_one_block  0.03259468078613281
generate_one_block  0.03148961067199707
generate_one_block  0.030852794647216797
generate_one_block  0.031899452209472656
generate_one_block  0.03089618682861328
generate_one_block  0.03129148483276367
generate_one_block  0.031497955322265625
generate_one_block  0.031687259674072266
generate_one_block  0.0312039852142334
generate_one_block  0.031549692153930664
generate_one_block  0.032380104064941406
generate_one_block  0.03171491622924805
generate_one_block  0.03222489356994629
generate_one_block  0.031463623046875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.040163278579711914
gen group dst list time:  0.02104973793029785
time for parepare:  0.01980733871459961
local_output_nid generation:  0.0076122283935546875
local_in_edges_tensor generation:  0.01941990852355957
mini_batch_src_global generation:  0.02669382095336914
r_  generation:  0.25054264068603516
local_output_nid generation:  0.012668848037719727
local_in_edges_tensor generation:  0.022339582443237305
mini_batch_src_global generation:  0.03199648857116699
r_  generation:  0.2619023323059082
local_output_nid generation:  0.01289057731628418
local_in_edges_tensor generation:  0.015561580657958984
mini_batch_src_global generation:  0.030822038650512695
r_  generation:  0.2612128257751465
local_output_nid generation:  0.01346135139465332
local_in_edges_tensor generation:  0.015810728073120117
mini_batch_src_global generation:  0.0334475040435791
r_  generation:  0.26444053649902344
local_output_nid generation:  0.013772010803222656
local_in_edges_tensor generation:  0.013437747955322266
mini_batch_src_global generation:  0.03303861618041992
r_  generation:  0.27276062965393066
local_output_nid generation:  0.014322280883789062
local_in_edges_tensor generation:  0.01635146141052246
mini_batch_src_global generation:  0.03392839431762695
r_  generation:  0.2708930969238281
local_output_nid generation:  0.01394033432006836
local_in_edges_tensor generation:  0.018483400344848633
mini_batch_src_global generation:  0.03306078910827637
r_  generation:  0.26654553413391113
local_output_nid generation:  0.014445066452026367
local_in_edges_tensor generation:  0.01631784439086914
mini_batch_src_global generation:  0.03384709358215332
r_  generation:  0.2708616256713867
local_output_nid generation:  0.01440119743347168
local_in_edges_tensor generation:  0.016362905502319336
mini_batch_src_global generation:  0.03405141830444336
r_  generation:  0.2749626636505127
local_output_nid generation:  0.014583110809326172
local_in_edges_tensor generation:  0.018912553787231445
mini_batch_src_global generation:  0.03431582450866699
r_  generation:  0.27202320098876953
local_output_nid generation:  0.014599800109863281
local_in_edges_tensor generation:  0.018673181533813477
mini_batch_src_global generation:  0.0344843864440918
r_  generation:  0.2757070064544678
local_output_nid generation:  0.014767646789550781
local_in_edges_tensor generation:  0.016423463821411133
mini_batch_src_global generation:  0.03459620475769043
r_  generation:  0.27563953399658203
local_output_nid generation:  0.014961957931518555
local_in_edges_tensor generation:  0.018931865692138672
mini_batch_src_global generation:  0.03677725791931152
r_  generation:  0.2764260768890381
local_output_nid generation:  0.014982461929321289
local_in_edges_tensor generation:  0.016141891479492188
mini_batch_src_global generation:  0.03520798683166504
r_  generation:  0.2758469581604004
local_output_nid generation:  0.015176057815551758
local_in_edges_tensor generation:  0.01894402503967285
mini_batch_src_global generation:  0.03593277931213379
r_  generation:  0.2807886600494385
local_output_nid generation:  0.014938116073608398
local_in_edges_tensor generation:  0.018766403198242188
mini_batch_src_global generation:  0.035359859466552734
r_  generation:  0.27845239639282227
----------------------check_connections_block total spend ----------------------------- 6.321811676025391
generate_one_block  0.35445117950439453
generate_one_block  0.3521413803100586
generate_one_block  0.3463740348815918
generate_one_block  0.3503406047821045
generate_one_block  0.3636174201965332
generate_one_block  0.35602307319641113
generate_one_block  0.34787726402282715
generate_one_block  0.3547394275665283
generate_one_block  0.35901689529418945
generate_one_block  0.3498528003692627
generate_one_block  0.36898279190063477
generate_one_block  0.3567206859588623
generate_one_block  0.3652660846710205
generate_one_block  0.36456751823425293
generate_one_block  0.37682461738586426
generate_one_block  0.3663513660430908
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.027499914169311523
gen group dst list time:  0.06261491775512695
time for parepare:  0.019363880157470703
local_output_nid generation:  0.025362730026245117
local_in_edges_tensor generation:  0.04014420509338379
mini_batch_src_global generation:  0.04617667198181152
r_  generation:  0.451566219329834
local_output_nid generation:  0.031296730041503906
local_in_edges_tensor generation:  0.04648780822753906
mini_batch_src_global generation:  0.05249500274658203
r_  generation:  0.45977067947387695
local_output_nid generation:  0.0343475341796875
local_in_edges_tensor generation:  0.03493547439575195
mini_batch_src_global generation:  0.051596641540527344
r_  generation:  0.46442556381225586
local_output_nid generation:  0.031563758850097656
local_in_edges_tensor generation:  0.03478527069091797
mini_batch_src_global generation:  0.054880619049072266
r_  generation:  0.4663982391357422
local_output_nid generation:  0.03155922889709473
local_in_edges_tensor generation:  0.03117203712463379
mini_batch_src_global generation:  0.05282402038574219
r_  generation:  0.4734313488006592
local_output_nid generation:  0.031591176986694336
local_in_edges_tensor generation:  0.03463149070739746
mini_batch_src_global generation:  0.05632734298706055
r_  generation:  0.4758787155151367
local_output_nid generation:  0.031699180603027344
local_in_edges_tensor generation:  0.04328203201293945
mini_batch_src_global generation:  0.05324149131774902
r_  generation:  0.47293710708618164
local_output_nid generation:  0.03168630599975586
local_in_edges_tensor generation:  0.03475046157836914
mini_batch_src_global generation:  0.05350375175476074
r_  generation:  0.48046135902404785
local_output_nid generation:  0.03204941749572754
local_in_edges_tensor generation:  0.04355955123901367
mini_batch_src_global generation:  0.05330777168273926
r_  generation:  0.4766225814819336
local_output_nid generation:  0.03185582160949707
local_in_edges_tensor generation:  0.03159904479980469
mini_batch_src_global generation:  0.05417609214782715
r_  generation:  0.47355151176452637
local_output_nid generation:  0.03195643424987793
local_in_edges_tensor generation:  0.03621387481689453
mini_batch_src_global generation:  0.0529022216796875
r_  generation:  0.4825735092163086
local_output_nid generation:  0.03226113319396973
local_in_edges_tensor generation:  0.04386448860168457
mini_batch_src_global generation:  0.05425453186035156
r_  generation:  0.48053455352783203
local_output_nid generation:  0.032161712646484375
local_in_edges_tensor generation:  0.03195762634277344
mini_batch_src_global generation:  0.0532073974609375
r_  generation:  0.48160648345947266
local_output_nid generation:  0.03198957443237305
local_in_edges_tensor generation:  0.03217625617980957
mini_batch_src_global generation:  0.05437922477722168
r_  generation:  0.48320984840393066
local_output_nid generation:  0.0321500301361084
local_in_edges_tensor generation:  0.044680118560791016
mini_batch_src_global generation:  0.05424022674560547
r_  generation:  0.4819772243499756
local_output_nid generation:  0.032208919525146484
local_in_edges_tensor generation:  0.0357820987701416
mini_batch_src_global generation:  0.05795407295227051
r_  generation:  0.4781677722930908
----------------------check_connections_block total spend ----------------------------- 11.233084201812744
generate_one_block  0.6057546138763428
generate_one_block  0.6123132705688477
generate_one_block  0.5868620872497559
generate_one_block  0.5959692001342773
generate_one_block  0.5955038070678711
generate_one_block  0.5982441902160645
generate_one_block  0.6429543495178223
generate_one_block  0.5992181301116943
generate_one_block  0.6063480377197266
generate_one_block  0.5920770168304443
generate_one_block  0.616600513458252
generate_one_block  0.6144957542419434
generate_one_block  0.6013309955596924
generate_one_block  0.6562974452972412
generate_one_block  0.6269221305847168
generate_one_block  0.6154055595397949
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

connection checking time:  17.554895877838135
block generation total time  15.499444246292114
average batch blocks generation time:  0.9687152653932571
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.09325361251831055  GigaBytes
Max Memory Allocated: 0.09325361251831055  GigaBytes

torch.Size([156748, 128])
torch.Size([130122, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8201904296875 GB
    Memory Allocated: 14.430643558502197  GigaBytes
Max Memory Allocated: 14.446263790130615  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4393310546875 GB
    Memory Allocated: 0.09592151641845703  GigaBytes
Max Memory Allocated: 14.446263790130615  GigaBytes

torch.Size([156786, 128])
torch.Size([130370, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1697998046875 GB
    Memory Allocated: 14.489706993103027  GigaBytes
Max Memory Allocated: 14.507307052612305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1717529296875 GB
    Memory Allocated: 0.09569168090820312  GigaBytes
Max Memory Allocated: 14.507307052612305  GigaBytes

torch.Size([156706, 128])
torch.Size([129817, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2127685546875 GB
    Memory Allocated: 14.372180461883545  GigaBytes
Max Memory Allocated: 14.507307052612305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2127685546875 GB
    Memory Allocated: 0.09575128555297852  GigaBytes
Max Memory Allocated: 14.507307052612305  GigaBytes

torch.Size([156813, 128])
torch.Size([130068, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2127685546875 GB
    Memory Allocated: 14.390283107757568  GigaBytes
Max Memory Allocated: 14.507307052612305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2127685546875 GB
    Memory Allocated: 0.0956125259399414  GigaBytes
Max Memory Allocated: 14.507307052612305  GigaBytes

torch.Size([156536, 128])
torch.Size([129580, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2127685546875 GB
    Memory Allocated: 14.369349479675293  GigaBytes
Max Memory Allocated: 14.507307052612305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2127685546875 GB
    Memory Allocated: 0.09587526321411133  GigaBytes
Max Memory Allocated: 14.507307052612305  GigaBytes

torch.Size([156731, 128])
torch.Size([129959, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2127685546875 GB
    Memory Allocated: 14.471317768096924  GigaBytes
Max Memory Allocated: 14.507307052612305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2127685546875 GB
    Memory Allocated: 0.09571695327758789  GigaBytes
Max Memory Allocated: 14.507307052612305  GigaBytes

torch.Size([156743, 128])
torch.Size([129665, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2127685546875 GB
    Memory Allocated: 14.376885414123535  GigaBytes
Max Memory Allocated: 14.507307052612305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2127685546875 GB
    Memory Allocated: 0.09582948684692383  GigaBytes
Max Memory Allocated: 14.507307052612305  GigaBytes

torch.Size([156717, 128])
torch.Size([129629, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2127685546875 GB
    Memory Allocated: 14.438365459442139  GigaBytes
Max Memory Allocated: 14.507307052612305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2127685546875 GB
    Memory Allocated: 0.09591484069824219  GigaBytes
Max Memory Allocated: 14.507307052612305  GigaBytes

torch.Size([156818, 128])
torch.Size([129853, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2127685546875 GB
    Memory Allocated: 14.475072383880615  GigaBytes
Max Memory Allocated: 14.507307052612305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2127685546875 GB
    Memory Allocated: 0.09583330154418945  GigaBytes
Max Memory Allocated: 14.507307052612305  GigaBytes

torch.Size([156845, 128])
torch.Size([130038, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2127685546875 GB
    Memory Allocated: 14.418515682220459  GigaBytes
Max Memory Allocated: 14.507307052612305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2127685546875 GB
    Memory Allocated: 0.095916748046875  GigaBytes
Max Memory Allocated: 14.507307052612305  GigaBytes

torch.Size([156776, 128])
torch.Size([130047, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2303466796875 GB
    Memory Allocated: 14.482580184936523  GigaBytes
Max Memory Allocated: 14.507307052612305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2303466796875 GB
    Memory Allocated: 0.09595775604248047  GigaBytes
Max Memory Allocated: 14.507307052612305  GigaBytes

torch.Size([156930, 128])
torch.Size([130196, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2635498046875 GB
    Memory Allocated: 14.46845817565918  GigaBytes
Max Memory Allocated: 14.507307052612305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2635498046875 GB
    Memory Allocated: 0.09592485427856445  GigaBytes
Max Memory Allocated: 14.507307052612305  GigaBytes

torch.Size([156615, 128])
torch.Size([129887, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2967529296875 GB
    Memory Allocated: 14.515190124511719  GigaBytes
Max Memory Allocated: 14.532634258270264  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2967529296875 GB
    Memory Allocated: 0.0960841178894043  GigaBytes
Max Memory Allocated: 14.532634258270264  GigaBytes

torch.Size([156969, 128])
torch.Size([130209, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2967529296875 GB
    Memory Allocated: 14.530454635620117  GigaBytes
Max Memory Allocated: 14.547880172729492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2967529296875 GB
    Memory Allocated: 0.09613609313964844  GigaBytes
Max Memory Allocated: 14.547880172729492  GigaBytes

torch.Size([156864, 128])
torch.Size([130184, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2967529296875 GB
    Memory Allocated: 14.57460069656372  GigaBytes
Max Memory Allocated: 14.592152118682861  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2967529296875 GB
    Memory Allocated: 0.09614896774291992  GigaBytes
Max Memory Allocated: 14.592152118682861  GigaBytes

torch.Size([157023, 128])
torch.Size([130674, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2967529296875 GB
    Memory Allocated: 14.552579879760742  GigaBytes
Max Memory Allocated: 14.592152118682861  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03567519783973694 |0.0438113659620285 |0.606513112783432 |0.00011228024959564209 |0.932117149233818 |0.01346898078918457 |
----------------------------------------------------------pseudo_mini_loss sum 4.955403804779053
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5319175
Number of first layer input nodes during this epoch:  2508620
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 17.2967529296875 GB
    Memory Allocated: 0.12578058242797852  GigaBytes
Max Memory Allocated: 14.592152118682861  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.028082609176635742
range selection method range initialization spend 0.016143798828125
time for parepare:  0.017689943313598633
local_output_nid generation:  0.0018773078918457031
local_in_edges_tensor generation:  0.006712913513183594
mini_batch_src_global generation:  0.0025014877319335938
r_  generation:  0.02238154411315918
local_output_nid generation:  0.001856088638305664
local_in_edges_tensor generation:  0.0010654926300048828
mini_batch_src_global generation:  0.002563953399658203
r_  generation:  0.02210235595703125
local_output_nid generation:  0.0018880367279052734
local_in_edges_tensor generation:  0.0009713172912597656
mini_batch_src_global generation:  0.0015311241149902344
r_  generation:  0.020702600479125977
local_output_nid generation:  0.0019087791442871094
local_in_edges_tensor generation:  0.0010297298431396484
mini_batch_src_global generation:  0.0015773773193359375
r_  generation:  0.021304607391357422
local_output_nid generation:  0.001886129379272461
local_in_edges_tensor generation:  0.0009648799896240234
mini_batch_src_global generation:  0.0016162395477294922
r_  generation:  0.02149367332458496
local_output_nid generation:  0.001895904541015625
local_in_edges_tensor generation:  0.0009524822235107422
mini_batch_src_global generation:  0.0016508102416992188
r_  generation:  0.021464109420776367
local_output_nid generation:  0.0018641948699951172
local_in_edges_tensor generation:  0.0009505748748779297
mini_batch_src_global generation:  0.001734018325805664
r_  generation:  0.022457122802734375
local_output_nid generation:  0.0018105506896972656
local_in_edges_tensor generation:  0.0009961128234863281
mini_batch_src_global generation:  0.0017251968383789062
r_  generation:  0.02225351333618164
local_output_nid generation:  0.0018241405487060547
local_in_edges_tensor generation:  0.0009317398071289062
mini_batch_src_global generation:  0.0017282962799072266
r_  generation:  0.02244400978088379
local_output_nid generation:  0.0018353462219238281
local_in_edges_tensor generation:  0.0009372234344482422
mini_batch_src_global generation:  0.0017154216766357422
r_  generation:  0.021565914154052734
local_output_nid generation:  0.0018460750579833984
local_in_edges_tensor generation:  0.000993490219116211
mini_batch_src_global generation:  0.0017828941345214844
r_  generation:  0.022547483444213867
local_output_nid generation:  0.0018033981323242188
local_in_edges_tensor generation:  0.0009922981262207031
mini_batch_src_global generation:  0.0017383098602294922
r_  generation:  0.021979093551635742
local_output_nid generation:  0.0018172264099121094
local_in_edges_tensor generation:  0.0009059906005859375
mini_batch_src_global generation:  0.001749277114868164
r_  generation:  0.022209644317626953
local_output_nid generation:  0.0018157958984375
local_in_edges_tensor generation:  0.0009856224060058594
mini_batch_src_global generation:  0.0017547607421875
r_  generation:  0.021436691284179688
local_output_nid generation:  0.0018353462219238281
local_in_edges_tensor generation:  0.0009815692901611328
mini_batch_src_global generation:  0.0017750263214111328
r_  generation:  0.022747278213500977
local_output_nid generation:  0.0018825531005859375
local_in_edges_tensor generation:  0.0009233951568603516
mini_batch_src_global generation:  0.0017769336700439453
r_  generation:  0.022307395935058594
----------------------check_connections_block total spend ----------------------------- 0.5276036262512207
generate_one_block  0.042952537536621094
generate_one_block  0.03905057907104492
generate_one_block  0.037073612213134766
generate_one_block  0.03799152374267578
generate_one_block  0.038605451583862305
generate_one_block  0.039361000061035156
generate_one_block  0.03920316696166992
generate_one_block  0.03823661804199219
generate_one_block  0.038251399993896484
generate_one_block  0.036669254302978516
generate_one_block  0.03911018371582031
generate_one_block  0.037917137145996094
generate_one_block  0.03823375701904297
generate_one_block  0.03714179992675781
generate_one_block  0.0383305549621582
generate_one_block  0.038291215896606445
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04239606857299805
gen group dst list time:  0.019505977630615234
time for parepare:  0.020102500915527344
local_output_nid generation:  0.008375883102416992
local_in_edges_tensor generation:  0.020061492919921875
mini_batch_src_global generation:  0.027014493942260742
r_  generation:  0.25116515159606934
local_output_nid generation:  0.01221609115600586
local_in_edges_tensor generation:  0.02278447151184082
mini_batch_src_global generation:  0.032469749450683594
r_  generation:  0.2706263065338135
local_output_nid generation:  0.014052629470825195
local_in_edges_tensor generation:  0.020191192626953125
mini_batch_src_global generation:  0.030733346939086914
r_  generation:  0.26140546798706055
local_output_nid generation:  0.012649297714233398
local_in_edges_tensor generation:  0.015624761581420898
mini_batch_src_global generation:  0.03202676773071289
r_  generation:  0.2655494213104248
local_output_nid generation:  0.013164043426513672
local_in_edges_tensor generation:  0.018926620483398438
mini_batch_src_global generation:  0.03322768211364746
r_  generation:  0.27492737770080566
local_output_nid generation:  0.01267862319946289
local_in_edges_tensor generation:  0.016083478927612305
mini_batch_src_global generation:  0.033554792404174805
r_  generation:  0.2696042060852051
local_output_nid generation:  0.012944221496582031
local_in_edges_tensor generation:  0.018756628036499023
mini_batch_src_global generation:  0.03603506088256836
r_  generation:  0.27402567863464355
local_output_nid generation:  0.012982606887817383
local_in_edges_tensor generation:  0.014082908630371094
mini_batch_src_global generation:  0.03398752212524414
r_  generation:  0.272355318069458
local_output_nid generation:  0.013064384460449219
local_in_edges_tensor generation:  0.014253377914428711
mini_batch_src_global generation:  0.034626007080078125
r_  generation:  0.27774715423583984
local_output_nid generation:  0.012869119644165039
local_in_edges_tensor generation:  0.014153242111206055
mini_batch_src_global generation:  0.033730268478393555
r_  generation:  0.26638007164001465
local_output_nid generation:  0.013195037841796875
local_in_edges_tensor generation:  0.018542766571044922
mini_batch_src_global generation:  0.0342257022857666
r_  generation:  0.2761211395263672
local_output_nid generation:  0.013042211532592773
local_in_edges_tensor generation:  0.018804073333740234
mini_batch_src_global generation:  0.0338740348815918
r_  generation:  0.273179292678833
local_output_nid generation:  0.013168573379516602
local_in_edges_tensor generation:  0.013990640640258789
mini_batch_src_global generation:  0.03429722785949707
r_  generation:  0.2717783451080322
local_output_nid generation:  0.012919902801513672
local_in_edges_tensor generation:  0.01682138442993164
mini_batch_src_global generation:  0.03439211845397949
r_  generation:  0.26833534240722656
local_output_nid generation:  0.013220787048339844
local_in_edges_tensor generation:  0.01679706573486328
mini_batch_src_global generation:  0.034470319747924805
r_  generation:  0.27422237396240234
local_output_nid generation:  0.012946844100952148
local_in_edges_tensor generation:  0.014286994934082031
mini_batch_src_global generation:  0.03445625305175781
r_  generation:  0.27609705924987793
----------------------check_connections_block total spend ----------------------------- 6.270381450653076
generate_one_block  0.3753509521484375
generate_one_block  0.38582301139831543
generate_one_block  0.36737942695617676
generate_one_block  0.3766467571258545
generate_one_block  0.38730883598327637
generate_one_block  0.37066125869750977
generate_one_block  0.4056129455566406
generate_one_block  0.37752652168273926
generate_one_block  0.3856487274169922
generate_one_block  0.36621832847595215
generate_one_block  0.3776087760925293
generate_one_block  0.37099432945251465
generate_one_block  0.3792266845703125
generate_one_block  0.3688783645629883
generate_one_block  0.3820669651031494
generate_one_block  0.3673515319824219
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.031358957290649414
gen group dst list time:  0.06263446807861328
time for parepare:  0.018400192260742188
local_output_nid generation:  0.02660536766052246
local_in_edges_tensor generation:  0.038416147232055664
mini_batch_src_global generation:  0.042232513427734375
r_  generation:  0.45409178733825684
local_output_nid generation:  0.03203392028808594
local_in_edges_tensor generation:  0.044707536697387695
mini_batch_src_global generation:  0.05520749092102051
r_  generation:  0.46159934997558594
local_output_nid generation:  0.03257322311401367
local_in_edges_tensor generation:  0.03451228141784668
mini_batch_src_global generation:  0.05367136001586914
r_  generation:  0.47225451469421387
local_output_nid generation:  0.03287076950073242
local_in_edges_tensor generation:  0.02928638458251953
mini_batch_src_global generation:  0.05074596405029297
r_  generation:  0.47049450874328613
local_output_nid generation:  0.03322291374206543
local_in_edges_tensor generation:  0.07659196853637695
mini_batch_src_global generation:  0.054646968841552734
r_  generation:  0.4761314392089844
local_output_nid generation:  0.0331575870513916
local_in_edges_tensor generation:  0.03835344314575195
mini_batch_src_global generation:  0.05219078063964844
r_  generation:  0.4775412082672119
local_output_nid generation:  0.033255815505981445
local_in_edges_tensor generation:  0.029793977737426758
mini_batch_src_global generation:  0.053298234939575195
r_  generation:  0.47792840003967285
local_output_nid generation:  0.03327488899230957
local_in_edges_tensor generation:  0.0353391170501709
mini_batch_src_global generation:  0.052918434143066406
r_  generation:  0.4799814224243164
local_output_nid generation:  0.03291177749633789
local_in_edges_tensor generation:  0.038498640060424805
mini_batch_src_global generation:  0.052854299545288086
r_  generation:  0.4807109832763672
local_output_nid generation:  0.03316664695739746
local_in_edges_tensor generation:  0.02940201759338379
mini_batch_src_global generation:  0.05300259590148926
r_  generation:  0.4783666133880615
local_output_nid generation:  0.03354978561401367
local_in_edges_tensor generation:  0.038297176361083984
mini_batch_src_global generation:  0.05264472961425781
r_  generation:  0.4806053638458252
local_output_nid generation:  0.033716440200805664
local_in_edges_tensor generation:  0.038584232330322266
mini_batch_src_global generation:  0.05261540412902832
r_  generation:  0.47870540618896484
local_output_nid generation:  0.033223628997802734
local_in_edges_tensor generation:  0.030205488204956055
mini_batch_src_global generation:  0.05261707305908203
r_  generation:  0.48111748695373535
local_output_nid generation:  0.03321099281311035
local_in_edges_tensor generation:  0.03328728675842285
mini_batch_src_global generation:  0.054917335510253906
r_  generation:  0.47946667671203613
local_output_nid generation:  0.03328657150268555
local_in_edges_tensor generation:  0.038431406021118164
mini_batch_src_global generation:  0.052722930908203125
r_  generation:  0.4826793670654297
local_output_nid generation:  0.03369712829589844
local_in_edges_tensor generation:  0.037210941314697266
mini_batch_src_global generation:  0.05233478546142578
r_  generation:  0.4796102046966553
----------------------check_connections_block total spend ----------------------------- 11.26353645324707
generate_one_block  0.6149146556854248
generate_one_block  0.6259453296661377
generate_one_block  0.6356544494628906
generate_one_block  0.6100583076477051
generate_one_block  0.6306324005126953
generate_one_block  0.6260161399841309
generate_one_block  0.6126749515533447
generate_one_block  0.6251225471496582
generate_one_block  0.6604654788970947
generate_one_block  0.6120269298553467
generate_one_block  0.6368372440338135
generate_one_block  0.6348073482513428
generate_one_block  0.6215648651123047
generate_one_block  0.6173574924468994
generate_one_block  0.6414265632629395
generate_one_block  0.6306929588317871
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.2967529296875 GB
    Memory Allocated: 0.12578058242797852  GigaBytes
Max Memory Allocated: 14.592152118682861  GigaBytes

connection checking time:  17.533917903900146
block generation total time  16.080501079559326
average batch blocks generation time:  1.0050313174724579
block dataloader generation time/epoch 36.41125249862671
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2967529296875 GB
    Memory Allocated: 0.09754657745361328  GigaBytes
Max Memory Allocated: 14.592152118682861  GigaBytes

torch.Size([156625, 128])
torch.Size([129698, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2967529296875 GB
    Memory Allocated: 14.446109294891357  GigaBytes
Max Memory Allocated: 14.592152118682861  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2967529296875 GB
    Memory Allocated: 0.09782266616821289  GigaBytes
Max Memory Allocated: 14.592152118682861  GigaBytes

torch.Size([156881, 128])
torch.Size([130095, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2967529296875 GB
    Memory Allocated: 14.557939052581787  GigaBytes
Max Memory Allocated: 14.592152118682861  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2967529296875 GB
    Memory Allocated: 0.09752130508422852  GigaBytes
Max Memory Allocated: 14.592152118682861  GigaBytes

torch.Size([156867, 128])
torch.Size([130103, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2967529296875 GB
    Memory Allocated: 14.421809196472168  GigaBytes
Max Memory Allocated: 14.592152118682861  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2967529296875 GB
    Memory Allocated: 0.09751272201538086  GigaBytes
Max Memory Allocated: 14.592152118682861  GigaBytes

torch.Size([156651, 128])
torch.Size([129564, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2967529296875 GB
    Memory Allocated: 14.442641258239746  GigaBytes
Max Memory Allocated: 14.592152118682861  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2967529296875 GB
    Memory Allocated: 0.09768486022949219  GigaBytes
Max Memory Allocated: 14.592152118682861  GigaBytes

torch.Size([156692, 128])
torch.Size([130396, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2967529296875 GB
    Memory Allocated: 14.546214580535889  GigaBytes
Max Memory Allocated: 14.592152118682861  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2967529296875 GB
    Memory Allocated: 0.09772253036499023  GigaBytes
Max Memory Allocated: 14.592152118682861  GigaBytes

torch.Size([157155, 128])
torch.Size([130231, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2967529296875 GB
    Memory Allocated: 14.45267105102539  GigaBytes
Max Memory Allocated: 14.592152118682861  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2967529296875 GB
    Memory Allocated: 0.09760856628417969  GigaBytes
Max Memory Allocated: 14.592152118682861  GigaBytes

torch.Size([156686, 128])
torch.Size([129715, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2967529296875 GB
    Memory Allocated: 14.493431568145752  GigaBytes
Max Memory Allocated: 14.592152118682861  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2967529296875 GB
    Memory Allocated: 0.09769248962402344  GigaBytes
Max Memory Allocated: 14.592152118682861  GigaBytes

torch.Size([156970, 128])
torch.Size([130128, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2967529296875 GB
    Memory Allocated: 14.473991870880127  GigaBytes
Max Memory Allocated: 14.592152118682861  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2967529296875 GB
    Memory Allocated: 0.09761714935302734  GigaBytes
Max Memory Allocated: 14.592152118682861  GigaBytes

torch.Size([156648, 128])
torch.Size([129760, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.3006591796875 GB
    Memory Allocated: 14.499573707580566  GigaBytes
Max Memory Allocated: 14.592152118682861  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.3006591796875 GB
    Memory Allocated: 0.0973958969116211  GigaBytes
Max Memory Allocated: 14.592152118682861  GigaBytes

torch.Size([156742, 128])
torch.Size([129735, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.3006591796875 GB
    Memory Allocated: 14.362836837768555  GigaBytes
Max Memory Allocated: 14.592152118682861  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.3006591796875 GB
    Memory Allocated: 0.09762287139892578  GigaBytes
Max Memory Allocated: 14.592152118682861  GigaBytes

torch.Size([156790, 128])
torch.Size([130192, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.3006591796875 GB
    Memory Allocated: 14.482084274291992  GigaBytes
Max Memory Allocated: 14.592152118682861  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.3006591796875 GB
    Memory Allocated: 0.09757614135742188  GigaBytes
Max Memory Allocated: 14.592152118682861  GigaBytes

torch.Size([156864, 128])
torch.Size([129847, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.3006591796875 GB
    Memory Allocated: 14.434248447418213  GigaBytes
Max Memory Allocated: 14.592152118682861  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.3006591796875 GB
    Memory Allocated: 0.09749364852905273  GigaBytes
Max Memory Allocated: 14.592152118682861  GigaBytes

torch.Size([156599, 128])
torch.Size([129360, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.3006591796875 GB
    Memory Allocated: 14.4258394241333  GigaBytes
Max Memory Allocated: 14.592152118682861  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.3006591796875 GB
    Memory Allocated: 0.09745264053344727  GigaBytes
Max Memory Allocated: 14.592152118682861  GigaBytes

torch.Size([156757, 128])
torch.Size([129919, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.3006591796875 GB
    Memory Allocated: 14.398330211639404  GigaBytes
Max Memory Allocated: 14.592152118682861  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.3006591796875 GB
    Memory Allocated: 0.0976414680480957  GigaBytes
Max Memory Allocated: 14.592152118682861  GigaBytes

torch.Size([156809, 128])
torch.Size([129967, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.3006591796875 GB
    Memory Allocated: 14.478935241699219  GigaBytes
Max Memory Allocated: 14.592152118682861  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.3006591796875 GB
    Memory Allocated: 0.09751272201538086  GigaBytes
Max Memory Allocated: 14.592152118682861  GigaBytes

torch.Size([156879, 128])
torch.Size([129662, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.3006591796875 GB
    Memory Allocated: 14.396406173706055  GigaBytes
Max Memory Allocated: 14.592152118682861  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03319661319255829 |0.022931858897209167 |0.5568751841783524 |9.939074516296387e-05 |0.9048693776130676 |0.010225534439086914 |
----------------------------------------------------------pseudo_mini_loss sum 3.79198956489563
Total (block generation + training)time/epoch 60.74156475067139
Training time/epoch 24.33008313179016
Training time without block to device /epoch 23.963173389434814
Training time without total dataloading part /epoch 23.399728775024414
load block tensor time/epoch 0.5311458110809326
block to device time/epoch 0.3669097423553467
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5317401
Number of first layer input nodes during this epoch:  2508615
