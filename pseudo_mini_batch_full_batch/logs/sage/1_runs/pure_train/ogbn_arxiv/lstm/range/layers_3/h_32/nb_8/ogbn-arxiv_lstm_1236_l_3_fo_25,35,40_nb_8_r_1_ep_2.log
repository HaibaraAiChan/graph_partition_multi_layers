Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648465790.8884747
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02469635009765625
range selection method range initialization spend 0.013854503631591797
time for parepare:  0.017644882202148438
local_output_nid generation:  0.002633333206176758
local_in_edges_tensor generation:  0.004558086395263672
mini_batch_src_global generation:  0.0033712387084960938
r_  generation:  0.03864240646362305
local_output_nid generation:  0.003081083297729492
local_in_edges_tensor generation:  0.0015931129455566406
mini_batch_src_global generation:  0.00420379638671875
r_  generation:  0.039405107498168945
local_output_nid generation:  0.0030858516693115234
local_in_edges_tensor generation:  0.0016598701477050781
mini_batch_src_global generation:  0.0028014183044433594
r_  generation:  0.038544654846191406
local_output_nid generation:  0.0030982494354248047
local_in_edges_tensor generation:  0.0016489028930664062
mini_batch_src_global generation:  0.0028662681579589844
r_  generation:  0.0399327278137207
local_output_nid generation:  0.003091096878051758
local_in_edges_tensor generation:  0.0016486644744873047
mini_batch_src_global generation:  0.0029442310333251953
r_  generation:  0.040183067321777344
local_output_nid generation:  0.0030808448791503906
local_in_edges_tensor generation:  0.001615762710571289
mini_batch_src_global generation:  0.0032155513763427734
r_  generation:  0.041483163833618164
local_output_nid generation:  0.003067493438720703
local_in_edges_tensor generation:  0.001619100570678711
mini_batch_src_global generation:  0.0031371116638183594
r_  generation:  0.04153728485107422
local_output_nid generation:  0.0030875205993652344
local_in_edges_tensor generation:  0.0016446113586425781
mini_batch_src_global generation:  0.0032749176025390625
r_  generation:  0.04247117042541504
----------------------check_connections_block total spend ----------------------------- 0.4738776683807373
generate_one_block  0.05421781539916992
generate_one_block  0.05482292175292969
generate_one_block  0.05429887771606445
generate_one_block  0.05456256866455078
generate_one_block  0.05664491653442383
generate_one_block  0.0547022819519043
generate_one_block  0.05457282066345215
generate_one_block  0.05567288398742676
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.040317535400390625
gen group dst list time:  0.015243768692016602
time for parepare:  0.018786907196044922
local_output_nid generation:  0.010264158248901367
local_in_edges_tensor generation:  0.028681278228759766
mini_batch_src_global generation:  0.026857376098632812
r_  generation:  0.28319334983825684
local_output_nid generation:  0.016476869583129883
local_in_edges_tensor generation:  0.02733159065246582
mini_batch_src_global generation:  0.03568768501281738
r_  generation:  0.2959756851196289
local_output_nid generation:  0.016791343688964844
local_in_edges_tensor generation:  0.022794246673583984
mini_batch_src_global generation:  0.035079002380371094
r_  generation:  0.2967047691345215
local_output_nid generation:  0.01711130142211914
local_in_edges_tensor generation:  0.020452260971069336
mini_batch_src_global generation:  0.03556632995605469
r_  generation:  0.30076169967651367
local_output_nid generation:  0.020987510681152344
local_in_edges_tensor generation:  0.026423931121826172
mini_batch_src_global generation:  0.036702632904052734
r_  generation:  0.3076622486114502
local_output_nid generation:  0.017947673797607422
local_in_edges_tensor generation:  0.026224374771118164
mini_batch_src_global generation:  0.03782391548156738
r_  generation:  0.30989623069763184
local_output_nid generation:  0.017876625061035156
local_in_edges_tensor generation:  0.027168750762939453
mini_batch_src_global generation:  0.03720974922180176
r_  generation:  0.30951809883117676
local_output_nid generation:  0.017949342727661133
local_in_edges_tensor generation:  0.021328449249267578
mini_batch_src_global generation:  0.03751087188720703
r_  generation:  0.3118305206298828
----------------------check_connections_block total spend ----------------------------- 3.568697214126587
generate_one_block  0.39394187927246094
generate_one_block  0.38646459579467773
generate_one_block  0.38019275665283203
generate_one_block  0.3866250514984131
generate_one_block  0.3901801109313965
generate_one_block  0.42113733291625977
generate_one_block  0.39380788803100586
generate_one_block  0.39549779891967773
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03330850601196289
gen group dst list time:  0.03550076484680176
time for parepare:  0.018862247467041016
local_output_nid generation:  0.024730682373046875
local_in_edges_tensor generation:  0.03950691223144531
mini_batch_src_global generation:  0.04309248924255371
r_  generation:  0.4782700538635254
local_output_nid generation:  0.03149533271789551
local_in_edges_tensor generation:  0.049844980239868164
mini_batch_src_global generation:  0.05484652519226074
r_  generation:  0.48841285705566406
local_output_nid generation:  0.03201413154602051
local_in_edges_tensor generation:  0.04597759246826172
mini_batch_src_global generation:  0.05112910270690918
r_  generation:  0.489058256149292
local_output_nid generation:  0.03245234489440918
local_in_edges_tensor generation:  0.03623843193054199
mini_batch_src_global generation:  0.05431818962097168
r_  generation:  0.4795241355895996
local_output_nid generation:  0.03270578384399414
local_in_edges_tensor generation:  0.04447221755981445
mini_batch_src_global generation:  0.05304718017578125
r_  generation:  0.4919931888580322
local_output_nid generation:  0.03278946876525879
local_in_edges_tensor generation:  0.0408778190612793
mini_batch_src_global generation:  0.05847001075744629
r_  generation:  0.4856078624725342
local_output_nid generation:  0.03289222717285156
local_in_edges_tensor generation:  0.03706717491149902
mini_batch_src_global generation:  0.053785085678100586
r_  generation:  0.4977688789367676
local_output_nid generation:  0.03279757499694824
local_in_edges_tensor generation:  0.0329279899597168
mini_batch_src_global generation:  0.05692243576049805
r_  generation:  0.4996609687805176
----------------------check_connections_block total spend ----------------------------- 5.7839367389678955
generate_one_block  0.6021990776062012
generate_one_block  0.6050012111663818
generate_one_block  0.6147933006286621
generate_one_block  0.6062679290771484
generate_one_block  0.6119341850280762
generate_one_block  0.6154093742370605
generate_one_block  0.6377263069152832
generate_one_block  0.6084132194519043
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

connection checking time:  9.352633953094482
block generation total time  8.049592018127441
average batch blocks generation time:  1.0061990022659302
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.09613037109375  GigaBytes
Max Memory Allocated: 0.09613037109375  GigaBytes

torch.Size([160458, 128])
torch.Size([140833, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5506591796875 GB
    Memory Allocated: 13.239075660705566  GigaBytes
Max Memory Allocated: 13.25145673751831  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 0.0986318588256836  GigaBytes
Max Memory Allocated: 13.25145673751831  GigaBytes

torch.Size([160403, 128])
torch.Size([141051, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2772216796875 GB
    Memory Allocated: 13.273705959320068  GigaBytes
Max Memory Allocated: 13.28768253326416  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2772216796875 GB
    Memory Allocated: 0.09890460968017578  GigaBytes
Max Memory Allocated: 13.28768253326416  GigaBytes

torch.Size([160347, 128])
torch.Size([140704, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2772216796875 GB
    Memory Allocated: 13.23772668838501  GigaBytes
Max Memory Allocated: 13.28768253326416  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2772216796875 GB
    Memory Allocated: 0.09895849227905273  GigaBytes
Max Memory Allocated: 13.28768253326416  GigaBytes

torch.Size([160416, 128])
torch.Size([140941, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2772216796875 GB
    Memory Allocated: 13.236003398895264  GigaBytes
Max Memory Allocated: 13.28768253326416  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2772216796875 GB
    Memory Allocated: 0.09905242919921875  GigaBytes
Max Memory Allocated: 13.28768253326416  GigaBytes

torch.Size([160551, 128])
torch.Size([141199, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2772216796875 GB
    Memory Allocated: 13.263570785522461  GigaBytes
Max Memory Allocated: 13.28768253326416  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2772216796875 GB
    Memory Allocated: 0.09921979904174805  GigaBytes
Max Memory Allocated: 13.28768253326416  GigaBytes

torch.Size([160574, 128])
torch.Size([141390, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2772216796875 GB
    Memory Allocated: 13.312071800231934  GigaBytes
Max Memory Allocated: 13.32608699798584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2772216796875 GB
    Memory Allocated: 0.09904956817626953  GigaBytes
Max Memory Allocated: 13.32608699798584  GigaBytes

torch.Size([160393, 128])
torch.Size([141346, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2869873046875 GB
    Memory Allocated: 13.267307758331299  GigaBytes
Max Memory Allocated: 13.32608699798584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2869873046875 GB
    Memory Allocated: 0.09857511520385742  GigaBytes
Max Memory Allocated: 13.32608699798584  GigaBytes

torch.Size([160418, 128])
torch.Size([141263, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2869873046875 GB
    Memory Allocated: 13.313469409942627  GigaBytes
Max Memory Allocated: 13.327777862548828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04206991195678711 |0.051131248474121094 |0.32778409123420715 |0.0001017153263092041 |0.3238760530948639 |0.007874011993408203 |
----------------------------------------------------------pseudo_mini_loss sum 4.398879051208496
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  2955010
Number of first layer input nodes during this epoch:  1283560
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 15.2869873046875 GB
    Memory Allocated: 0.12926864624023438  GigaBytes
Max Memory Allocated: 13.327777862548828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02271580696105957
range selection method range initialization spend 0.011677742004394531
time for parepare:  0.018680810928344727
local_output_nid generation:  0.0030546188354492188
local_in_edges_tensor generation:  0.007658243179321289
mini_batch_src_global generation:  0.003414630889892578
r_  generation:  0.03767085075378418
local_output_nid generation:  0.0032362937927246094
local_in_edges_tensor generation:  0.0015988349914550781
mini_batch_src_global generation:  0.004171609878540039
r_  generation:  0.03916668891906738
local_output_nid generation:  0.0032651424407958984
local_in_edges_tensor generation:  0.001653909683227539
mini_batch_src_global generation:  0.002762317657470703
r_  generation:  0.03924679756164551
local_output_nid generation:  0.003339052200317383
local_in_edges_tensor generation:  0.0016295909881591797
mini_batch_src_global generation:  0.002874612808227539
r_  generation:  0.041513919830322266
local_output_nid generation:  0.003328561782836914
local_in_edges_tensor generation:  0.0016322135925292969
mini_batch_src_global generation:  0.0030536651611328125
r_  generation:  0.04097318649291992
local_output_nid generation:  0.0032994747161865234
local_in_edges_tensor generation:  0.0016829967498779297
mini_batch_src_global generation:  0.0033104419708251953
r_  generation:  0.04228568077087402
local_output_nid generation:  0.0032820701599121094
local_in_edges_tensor generation:  0.0016429424285888672
mini_batch_src_global generation:  0.003156900405883789
r_  generation:  0.04424142837524414
local_output_nid generation:  0.0033082962036132812
local_in_edges_tensor generation:  0.0016562938690185547
mini_batch_src_global generation:  0.003221273422241211
r_  generation:  0.04236292839050293
----------------------check_connections_block total spend ----------------------------- 0.48549461364746094
generate_one_block  0.0640866756439209
generate_one_block  0.05963778495788574
generate_one_block  0.0601651668548584
generate_one_block  0.06056380271911621
generate_one_block  0.06104636192321777
generate_one_block  0.06215810775756836
generate_one_block  0.06360554695129395
generate_one_block  0.06242084503173828
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.040509700775146484
gen group dst list time:  0.015289545059204102
time for parepare:  0.021453142166137695
local_output_nid generation:  0.010773897171020508
local_in_edges_tensor generation:  0.02548670768737793
mini_batch_src_global generation:  0.027678251266479492
r_  generation:  0.30484700202941895
local_output_nid generation:  0.018859148025512695
local_in_edges_tensor generation:  0.03741765022277832
mini_batch_src_global generation:  0.04002022743225098
r_  generation:  0.29909181594848633
local_output_nid generation:  0.016739606857299805
local_in_edges_tensor generation:  0.02038264274597168
mini_batch_src_global generation:  0.03483271598815918
r_  generation:  0.2995767593383789
local_output_nid generation:  0.017134904861450195
local_in_edges_tensor generation:  0.019638538360595703
mini_batch_src_global generation:  0.03832554817199707
r_  generation:  0.303297758102417
local_output_nid generation:  0.017415761947631836
local_in_edges_tensor generation:  0.019333839416503906
mini_batch_src_global generation:  0.039600372314453125
r_  generation:  0.3097665309906006
local_output_nid generation:  0.01767706871032715
local_in_edges_tensor generation:  0.0202178955078125
mini_batch_src_global generation:  0.03999185562133789
r_  generation:  0.3126387596130371
local_output_nid generation:  0.017659902572631836
local_in_edges_tensor generation:  0.01994156837463379
mini_batch_src_global generation:  0.037412166595458984
r_  generation:  0.3117945194244385
local_output_nid generation:  0.01788616180419922
local_in_edges_tensor generation:  0.020298004150390625
mini_batch_src_global generation:  0.04013466835021973
r_  generation:  0.3113586902618408
----------------------check_connections_block total spend ----------------------------- 3.6235737800598145
generate_one_block  0.4221611022949219
generate_one_block  0.39904117584228516
generate_one_block  0.40024638175964355
generate_one_block  0.402681827545166
generate_one_block  0.40581583976745605
generate_one_block  0.41062498092651367
generate_one_block  0.43378376960754395
generate_one_block  0.44985270500183105
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05269646644592285
gen group dst list time:  0.0376276969909668
time for parepare:  0.0191652774810791
local_output_nid generation:  0.025803089141845703
local_in_edges_tensor generation:  0.05909872055053711
mini_batch_src_global generation:  0.04771924018859863
r_  generation:  0.46863412857055664
local_output_nid generation:  0.03157687187194824
local_in_edges_tensor generation:  0.047541141510009766
mini_batch_src_global generation:  0.0535120964050293
r_  generation:  0.47766685485839844
local_output_nid generation:  0.0319366455078125
local_in_edges_tensor generation:  0.040480852127075195
mini_batch_src_global generation:  0.050665855407714844
r_  generation:  0.4886040687561035
local_output_nid generation:  0.032315731048583984
local_in_edges_tensor generation:  0.031707763671875
mini_batch_src_global generation:  0.054383039474487305
r_  generation:  0.4904475212097168
local_output_nid generation:  0.032512664794921875
local_in_edges_tensor generation:  0.040199995040893555
mini_batch_src_global generation:  0.05275774002075195
r_  generation:  0.49565982818603516
local_output_nid generation:  0.03264212608337402
local_in_edges_tensor generation:  0.039990901947021484
mini_batch_src_global generation:  0.05462026596069336
r_  generation:  0.4864215850830078
local_output_nid generation:  0.03273177146911621
local_in_edges_tensor generation:  0.03671526908874512
mini_batch_src_global generation:  0.05637860298156738
r_  generation:  0.4935882091522217
local_output_nid generation:  0.03436851501464844
local_in_edges_tensor generation:  0.032016754150390625
mini_batch_src_global generation:  0.05476069450378418
r_  generation:  0.4819803237915039
----------------------check_connections_block total spend ----------------------------- 5.763214826583862
generate_one_block  0.6357595920562744
generate_one_block  0.6298110485076904
generate_one_block  0.6290233135223389
generate_one_block  0.61883544921875
generate_one_block  0.6316657066345215
generate_one_block  0.6210074424743652
generate_one_block  0.6856317520141602
generate_one_block  0.6619229316711426
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 15.2869873046875 GB
    Memory Allocated: 0.12926864624023438  GigaBytes
Max Memory Allocated: 13.327777862548828  GigaBytes

connection checking time:  9.386788606643677
block generation total time  8.437865018844604
average batch blocks generation time:  1.0547331273555756
block dataloader generation time/epoch 19.944939374923706
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2869873046875 GB
    Memory Allocated: 0.10029315948486328  GigaBytes
Max Memory Allocated: 13.327777862548828  GigaBytes

torch.Size([160558, 128])
torch.Size([141298, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2869873046875 GB
    Memory Allocated: 13.280567169189453  GigaBytes
Max Memory Allocated: 13.327777862548828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2869873046875 GB
    Memory Allocated: 0.1003260612487793  GigaBytes
Max Memory Allocated: 13.327777862548828  GigaBytes

torch.Size([160622, 128])
torch.Size([141117, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2869873046875 GB
    Memory Allocated: 13.273775100708008  GigaBytes
Max Memory Allocated: 13.327777862548828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2869873046875 GB
    Memory Allocated: 0.10026168823242188  GigaBytes
Max Memory Allocated: 13.327777862548828  GigaBytes

torch.Size([160619, 128])
torch.Size([141441, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2869873046875 GB
    Memory Allocated: 13.247324466705322  GigaBytes
Max Memory Allocated: 13.327777862548828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2869873046875 GB
    Memory Allocated: 0.10013246536254883  GigaBytes
Max Memory Allocated: 13.327777862548828  GigaBytes

torch.Size([160256, 128])
torch.Size([140875, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2869873046875 GB
    Memory Allocated: 13.258317947387695  GigaBytes
Max Memory Allocated: 13.327777862548828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2869873046875 GB
    Memory Allocated: 0.10037803649902344  GigaBytes
Max Memory Allocated: 13.327777862548828  GigaBytes

torch.Size([160691, 128])
torch.Size([141329, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2869873046875 GB
    Memory Allocated: 13.286868572235107  GigaBytes
Max Memory Allocated: 13.327777862548828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2869873046875 GB
    Memory Allocated: 0.10038137435913086  GigaBytes
Max Memory Allocated: 13.327777862548828  GigaBytes

torch.Size([160612, 128])
torch.Size([141243, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2908935546875 GB
    Memory Allocated: 13.270004272460938  GigaBytes
Max Memory Allocated: 13.327777862548828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2908935546875 GB
    Memory Allocated: 0.1003866195678711  GigaBytes
Max Memory Allocated: 13.327777862548828  GigaBytes

torch.Size([160621, 128])
torch.Size([141403, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2908935546875 GB
    Memory Allocated: 13.296119213104248  GigaBytes
Max Memory Allocated: 13.327777862548828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2908935546875 GB
    Memory Allocated: 0.10047149658203125  GigaBytes
Max Memory Allocated: 13.327777862548828  GigaBytes

torch.Size([160683, 128])
torch.Size([141374, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2908935546875 GB
    Memory Allocated: 13.31028413772583  GigaBytes
Max Memory Allocated: 13.327777862548828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.046199142932891846 |0.018061280250549316 |0.2533620595932007 |9.530782699584961e-05 |0.3209514915943146 |0.005004405975341797 |
----------------------------------------------------------pseudo_mini_loss sum 3.705524206161499
Total (block generation + training)time/epoch 25.084957361221313
Training time/epoch 5.139766693115234
Training time without block to device /epoch 4.99527645111084
Training time without total dataloading part /epoch 4.600275278091431
load block tensor time/epoch 0.36959314346313477
block to device time/epoch 0.14449024200439453
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  2958412
Number of first layer input nodes during this epoch:  1284662
