Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648490363.0430691
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0233154296875 GB
    Memory Allocated: 0.007684230804443359  GigaBytes
Max Memory Allocated: 0.007684230804443359  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.024631977081298828
range selection method range initialization spend 0.01273655891418457
time for parepare:  0.017402172088623047
local_output_nid generation:  0.0007059574127197266
local_in_edges_tensor generation:  0.0037491321563720703
mini_batch_src_global generation:  0.0012798309326171875
r_  generation:  0.008674144744873047
local_output_nid generation:  0.0007336139678955078
local_in_edges_tensor generation:  0.0005855560302734375
mini_batch_src_global generation:  0.0013680458068847656
r_  generation:  0.007954120635986328
local_output_nid generation:  0.0006873607635498047
local_in_edges_tensor generation:  0.0005173683166503906
mini_batch_src_global generation:  0.0008921623229980469
r_  generation:  0.007780313491821289
local_output_nid generation:  0.0007119178771972656
local_in_edges_tensor generation:  0.0005030632019042969
mini_batch_src_global generation:  0.0007877349853515625
r_  generation:  0.007657766342163086
local_output_nid generation:  0.0006835460662841797
local_in_edges_tensor generation:  0.00048542022705078125
mini_batch_src_global generation:  0.0007491111755371094
r_  generation:  0.007605075836181641
local_output_nid generation:  0.0007061958312988281
local_in_edges_tensor generation:  0.0004966259002685547
mini_batch_src_global generation:  0.0007727146148681641
r_  generation:  0.007695674896240234
local_output_nid generation:  0.0006983280181884766
local_in_edges_tensor generation:  0.0004825592041015625
mini_batch_src_global generation:  0.0007739067077636719
r_  generation:  0.00785064697265625
local_output_nid generation:  0.0006957054138183594
local_in_edges_tensor generation:  0.0004792213439941406
mini_batch_src_global generation:  0.0007717609405517578
r_  generation:  0.007718563079833984
local_output_nid generation:  0.0006930828094482422
local_in_edges_tensor generation:  0.0004794597625732422
mini_batch_src_global generation:  0.0007815361022949219
r_  generation:  0.007935762405395508
local_output_nid generation:  0.0007052421569824219
local_in_edges_tensor generation:  0.0004813671112060547
mini_batch_src_global generation:  0.0007882118225097656
r_  generation:  0.007871150970458984
local_output_nid generation:  0.0006906986236572266
local_in_edges_tensor generation:  0.0004918575286865234
mini_batch_src_global generation:  0.000919342041015625
r_  generation:  0.008162975311279297
local_output_nid generation:  0.0006990432739257812
local_in_edges_tensor generation:  0.0004875659942626953
mini_batch_src_global generation:  0.0009360313415527344
r_  generation:  0.008311033248901367
local_output_nid generation:  0.0007016658782958984
local_in_edges_tensor generation:  0.0004830360412597656
mini_batch_src_global generation:  0.0008342266082763672
r_  generation:  0.008018016815185547
local_output_nid generation:  0.0006992816925048828
local_in_edges_tensor generation:  0.00047469139099121094
mini_batch_src_global generation:  0.0008270740509033203
r_  generation:  0.007720470428466797
local_output_nid generation:  0.0007076263427734375
local_in_edges_tensor generation:  0.0004773139953613281
mini_batch_src_global generation:  0.0008020401000976562
r_  generation:  0.008062362670898438
local_output_nid generation:  0.0007128715515136719
local_in_edges_tensor generation:  0.0004825592041015625
mini_batch_src_global generation:  0.0009937286376953125
r_  generation:  0.009318828582763672
local_output_nid generation:  0.0007054805755615234
local_in_edges_tensor generation:  0.00047588348388671875
mini_batch_src_global generation:  0.0008494853973388672
r_  generation:  0.008005619049072266
local_output_nid generation:  0.0007159709930419922
local_in_edges_tensor generation:  0.0004782676696777344
mini_batch_src_global generation:  0.0008330345153808594
r_  generation:  0.00814962387084961
local_output_nid generation:  0.0007112026214599609
local_in_edges_tensor generation:  0.00047779083251953125
mini_batch_src_global generation:  0.0008299350738525391
r_  generation:  0.008278369903564453
local_output_nid generation:  0.0007119178771972656
local_in_edges_tensor generation:  0.00048351287841796875
mini_batch_src_global generation:  0.0008504390716552734
r_  generation:  0.008232355117797852
local_output_nid generation:  0.0007140636444091797
local_in_edges_tensor generation:  0.00047588348388671875
mini_batch_src_global generation:  0.0008559226989746094
r_  generation:  0.008465051651000977
local_output_nid generation:  0.0006999969482421875
local_in_edges_tensor generation:  0.00047898292541503906
mini_batch_src_global generation:  0.000858306884765625
r_  generation:  0.008329391479492188
local_output_nid generation:  0.0007154941558837891
local_in_edges_tensor generation:  0.0004858970642089844
mini_batch_src_global generation:  0.0008819103240966797
r_  generation:  0.008356332778930664
local_output_nid generation:  0.0007071495056152344
local_in_edges_tensor generation:  0.0004889965057373047
mini_batch_src_global generation:  0.0008335113525390625
r_  generation:  0.00812983512878418
local_output_nid generation:  0.00070953369140625
local_in_edges_tensor generation:  0.0004832744598388672
mini_batch_src_global generation:  0.0008389949798583984
r_  generation:  0.008055925369262695
local_output_nid generation:  0.0006992816925048828
local_in_edges_tensor generation:  0.0004839897155761719
mini_batch_src_global generation:  0.0008332729339599609
r_  generation:  0.008272647857666016
local_output_nid generation:  0.0007033348083496094
local_in_edges_tensor generation:  0.0004887580871582031
mini_batch_src_global generation:  0.0008463859558105469
r_  generation:  0.008094072341918945
local_output_nid generation:  0.0007023811340332031
local_in_edges_tensor generation:  0.0004825592041015625
mini_batch_src_global generation:  0.0008463859558105469
r_  generation:  0.00817561149597168
local_output_nid generation:  0.0007240772247314453
local_in_edges_tensor generation:  0.0004749298095703125
mini_batch_src_global generation:  0.0008311271667480469
r_  generation:  0.008272886276245117
local_output_nid generation:  0.0007154941558837891
local_in_edges_tensor generation:  0.00047397613525390625
mini_batch_src_global generation:  0.0008263587951660156
r_  generation:  0.008002996444702148
local_output_nid generation:  0.0007164478302001953
local_in_edges_tensor generation:  0.004019975662231445
mini_batch_src_global generation:  0.0010886192321777344
r_  generation:  0.008352994918823242
local_output_nid generation:  0.0007481575012207031
local_in_edges_tensor generation:  0.0005097389221191406
mini_batch_src_global generation:  0.000957489013671875
r_  generation:  0.008452415466308594
----------------------check_connections_block total spend ----------------------------- 0.4160950183868408
generate_one_block  0.013833284378051758
generate_one_block  0.01342463493347168
generate_one_block  0.013543367385864258
generate_one_block  0.013376474380493164
generate_one_block  0.013034820556640625
generate_one_block  0.013089895248413086
generate_one_block  0.013031959533691406
generate_one_block  0.012854576110839844
generate_one_block  0.013165712356567383
generate_one_block  0.013172149658203125
generate_one_block  0.013332605361938477
generate_one_block  0.013265371322631836
generate_one_block  0.01301121711730957
generate_one_block  0.012601137161254883
generate_one_block  0.012946844100952148
generate_one_block  0.013898849487304688
generate_one_block  0.012971162796020508
generate_one_block  0.013158082962036133
generate_one_block  0.013337850570678711
generate_one_block  0.013347387313842773
generate_one_block  0.013449907302856445
generate_one_block  0.01322031021118164
generate_one_block  0.013318538665771484
generate_one_block  0.013141393661499023
generate_one_block  0.013054132461547852
generate_one_block  0.013158082962036133
generate_one_block  0.012986183166503906
generate_one_block  0.01308298110961914
generate_one_block  0.013113737106323242
generate_one_block  0.013009071350097656
generate_one_block  0.013590097427368164
generate_one_block  0.013396739959716797
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.043610334396362305
gen group dst list time:  0.020852088928222656
time for parepare:  0.018912076950073242
local_output_nid generation:  0.0037512779235839844
local_in_edges_tensor generation:  0.012246131896972656
mini_batch_src_global generation:  0.011899948120117188
r_  generation:  0.12009310722351074
local_output_nid generation:  0.006207704544067383
local_in_edges_tensor generation:  0.011661291122436523
mini_batch_src_global generation:  0.01526188850402832
r_  generation:  0.12841582298278809
local_output_nid generation:  0.006341695785522461
local_in_edges_tensor generation:  0.008130311965942383
mini_batch_src_global generation:  0.01388096809387207
r_  generation:  0.1307682991027832
local_output_nid generation:  0.006255626678466797
local_in_edges_tensor generation:  0.009231805801391602
mini_batch_src_global generation:  0.014851808547973633
r_  generation:  0.13275909423828125
local_output_nid generation:  0.0062885284423828125
local_in_edges_tensor generation:  0.010484457015991211
mini_batch_src_global generation:  0.015388727188110352
r_  generation:  0.13545942306518555
local_output_nid generation:  0.006469249725341797
local_in_edges_tensor generation:  0.007962703704833984
mini_batch_src_global generation:  0.01918196678161621
r_  generation:  0.14022469520568848
local_output_nid generation:  0.0065479278564453125
local_in_edges_tensor generation:  0.007475614547729492
mini_batch_src_global generation:  0.016071319580078125
r_  generation:  0.13588905334472656
local_output_nid generation:  0.0064449310302734375
local_in_edges_tensor generation:  0.009039640426635742
mini_batch_src_global generation:  0.015651941299438477
r_  generation:  0.13444304466247559
local_output_nid generation:  0.0065877437591552734
local_in_edges_tensor generation:  0.009664773941040039
mini_batch_src_global generation:  0.015943050384521484
r_  generation:  0.1430976390838623
local_output_nid generation:  0.006624698638916016
local_in_edges_tensor generation:  0.00735020637512207
mini_batch_src_global generation:  0.016019582748413086
r_  generation:  0.1400892734527588
local_output_nid generation:  0.0075757503509521484
local_in_edges_tensor generation:  0.02023792266845703
mini_batch_src_global generation:  0.024366140365600586
r_  generation:  0.15046072006225586
local_output_nid generation:  0.008779764175415039
local_in_edges_tensor generation:  0.01176905632019043
mini_batch_src_global generation:  0.017295360565185547
r_  generation:  0.14268112182617188
local_output_nid generation:  0.006923198699951172
local_in_edges_tensor generation:  0.009161949157714844
mini_batch_src_global generation:  0.0166473388671875
r_  generation:  0.1400454044342041
local_output_nid generation:  0.006768703460693359
local_in_edges_tensor generation:  0.008196353912353516
mini_batch_src_global generation:  0.015794992446899414
r_  generation:  0.13149428367614746
local_output_nid generation:  0.0070154666900634766
local_in_edges_tensor generation:  0.009841203689575195
mini_batch_src_global generation:  0.01644444465637207
r_  generation:  0.1394190788269043
local_output_nid generation:  0.007352113723754883
local_in_edges_tensor generation:  0.009223461151123047
mini_batch_src_global generation:  0.01763296127319336
r_  generation:  0.14556598663330078
local_output_nid generation:  0.006994724273681641
local_in_edges_tensor generation:  0.008443832397460938
mini_batch_src_global generation:  0.016476869583129883
r_  generation:  0.13715195655822754
local_output_nid generation:  0.00716400146484375
local_in_edges_tensor generation:  0.008886337280273438
mini_batch_src_global generation:  0.016850709915161133
r_  generation:  0.14041948318481445
local_output_nid generation:  0.007105588912963867
local_in_edges_tensor generation:  0.008716106414794922
mini_batch_src_global generation:  0.016876697540283203
r_  generation:  0.14212703704833984
local_output_nid generation:  0.007189273834228516
local_in_edges_tensor generation:  0.008873701095581055
mini_batch_src_global generation:  0.018193721771240234
r_  generation:  0.14234399795532227
local_output_nid generation:  0.007294654846191406
local_in_edges_tensor generation:  0.007706165313720703
mini_batch_src_global generation:  0.01748371124267578
r_  generation:  0.14477086067199707
local_output_nid generation:  0.0073010921478271484
local_in_edges_tensor generation:  0.009229898452758789
mini_batch_src_global generation:  0.017209529876708984
r_  generation:  0.1407773494720459
local_output_nid generation:  0.007281303405761719
local_in_edges_tensor generation:  0.007745504379272461
mini_batch_src_global generation:  0.016657590866088867
r_  generation:  0.14292573928833008
local_output_nid generation:  0.0070612430572509766
local_in_edges_tensor generation:  0.007603168487548828
mini_batch_src_global generation:  0.016505002975463867
r_  generation:  0.13535165786743164
local_output_nid generation:  0.007219552993774414
local_in_edges_tensor generation:  0.00775146484375
mini_batch_src_global generation:  0.016631126403808594
r_  generation:  0.14003610610961914
local_output_nid generation:  0.007149457931518555
local_in_edges_tensor generation:  0.010333776473999023
mini_batch_src_global generation:  0.0173032283782959
r_  generation:  0.14034175872802734
local_output_nid generation:  0.007203578948974609
local_in_edges_tensor generation:  0.008367061614990234
mini_batch_src_global generation:  0.01653003692626953
r_  generation:  0.13689565658569336
local_output_nid generation:  0.007298707962036133
local_in_edges_tensor generation:  0.008572578430175781
mini_batch_src_global generation:  0.016397476196289062
r_  generation:  0.1360325813293457
local_output_nid generation:  0.007279396057128906
local_in_edges_tensor generation:  0.009629011154174805
mini_batch_src_global generation:  0.01645207405090332
r_  generation:  0.14480233192443848
local_output_nid generation:  0.007179975509643555
local_in_edges_tensor generation:  0.009773731231689453
mini_batch_src_global generation:  0.01700758934020996
r_  generation:  0.14214038848876953
local_output_nid generation:  0.007620334625244141
local_in_edges_tensor generation:  0.008963823318481445
mini_batch_src_global generation:  0.017035961151123047
r_  generation:  0.15255141258239746
local_output_nid generation:  0.00732731819152832
local_in_edges_tensor generation:  0.01009225845336914
mini_batch_src_global generation:  0.01693129539489746
r_  generation:  0.14336657524108887
----------------------check_connections_block total spend ----------------------------- 6.594851732254028
generate_one_block  0.18324828147888184
generate_one_block  0.19303107261657715
generate_one_block  0.20506834983825684
generate_one_block  0.17949652671813965
generate_one_block  0.17214274406433105
generate_one_block  0.1762855052947998
generate_one_block  0.18077301979064941
generate_one_block  0.1701500415802002
generate_one_block  0.17414593696594238
generate_one_block  0.17287349700927734
generate_one_block  0.17237305641174316
generate_one_block  0.17662954330444336
generate_one_block  0.1735389232635498
generate_one_block  0.16389012336730957
generate_one_block  0.1763765811920166
generate_one_block  0.18949222564697266
generate_one_block  0.16640567779541016
generate_one_block  0.17356157302856445
generate_one_block  0.18649721145629883
generate_one_block  0.18002581596374512
generate_one_block  0.2077951431274414
generate_one_block  0.17565131187438965
generate_one_block  0.18770623207092285
generate_one_block  0.16727399826049805
generate_one_block  0.17458033561706543
generate_one_block  0.17430710792541504
generate_one_block  0.1693730354309082
generate_one_block  0.16876697540283203
generate_one_block  0.1776294708251953
generate_one_block  0.17609357833862305
generate_one_block  0.17855215072631836
generate_one_block  0.1797785758972168
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04278564453125
gen group dst list time:  0.10538697242736816
time for parepare:  0.020328521728515625
local_output_nid generation:  0.02094101905822754
local_in_edges_tensor generation:  0.0503847599029541
mini_batch_src_global generation:  0.0445094108581543
r_  generation:  0.41605615615844727
local_output_nid generation:  0.026517868041992188
local_in_edges_tensor generation:  0.04384493827819824
mini_batch_src_global generation:  0.05051732063293457
r_  generation:  0.4274864196777344
local_output_nid generation:  0.02719569206237793
local_in_edges_tensor generation:  0.03644871711730957
mini_batch_src_global generation:  0.05068159103393555
r_  generation:  0.4325697422027588
local_output_nid generation:  0.026248693466186523
local_in_edges_tensor generation:  0.03236079216003418
mini_batch_src_global generation:  0.05612540245056152
r_  generation:  0.4517836570739746
local_output_nid generation:  0.026068925857543945
local_in_edges_tensor generation:  0.04147458076477051
mini_batch_src_global generation:  0.0526738166809082
r_  generation:  0.4444401264190674
local_output_nid generation:  0.02596306800842285
local_in_edges_tensor generation:  0.029495716094970703
mini_batch_src_global generation:  0.0520777702331543
r_  generation:  0.43675708770751953
local_output_nid generation:  0.025975465774536133
local_in_edges_tensor generation:  0.03652596473693848
mini_batch_src_global generation:  0.052695274353027344
r_  generation:  0.43964648246765137
local_output_nid generation:  0.025849342346191406
local_in_edges_tensor generation:  0.0293123722076416
mini_batch_src_global generation:  0.052460432052612305
r_  generation:  0.4429631233215332
local_output_nid generation:  0.025839805603027344
local_in_edges_tensor generation:  0.029131174087524414
mini_batch_src_global generation:  0.055284976959228516
r_  generation:  0.44269680976867676
local_output_nid generation:  0.02830958366394043
local_in_edges_tensor generation:  0.028943538665771484
mini_batch_src_global generation:  0.05478858947753906
r_  generation:  0.4375295639038086
local_output_nid generation:  0.025851964950561523
local_in_edges_tensor generation:  0.03283429145812988
mini_batch_src_global generation:  0.05185556411743164
r_  generation:  0.4430980682373047
local_output_nid generation:  0.02609705924987793
local_in_edges_tensor generation:  0.043262481689453125
mini_batch_src_global generation:  0.05263018608093262
r_  generation:  0.4458627700805664
local_output_nid generation:  0.02618241310119629
local_in_edges_tensor generation:  0.03269791603088379
mini_batch_src_global generation:  0.05275416374206543
r_  generation:  0.45078563690185547
local_output_nid generation:  0.026854991912841797
local_in_edges_tensor generation:  0.03402996063232422
mini_batch_src_global generation:  0.054460763931274414
r_  generation:  0.45221996307373047
local_output_nid generation:  0.02631068229675293
local_in_edges_tensor generation:  0.04097461700439453
mini_batch_src_global generation:  0.061467647552490234
r_  generation:  0.44374990463256836
local_output_nid generation:  0.026308536529541016
local_in_edges_tensor generation:  0.035599470138549805
mini_batch_src_global generation:  0.06232333183288574
r_  generation:  0.4444611072540283
local_output_nid generation:  0.027762651443481445
local_in_edges_tensor generation:  0.02933955192565918
mini_batch_src_global generation:  0.05426526069641113
r_  generation:  0.4438021183013916
local_output_nid generation:  0.027055740356445312
local_in_edges_tensor generation:  0.03221774101257324
mini_batch_src_global generation:  0.052747488021850586
r_  generation:  0.4408745765686035
local_output_nid generation:  0.026851415634155273
local_in_edges_tensor generation:  0.04042673110961914
mini_batch_src_global generation:  0.05219674110412598
r_  generation:  0.45780062675476074
local_output_nid generation:  0.02691793441772461
local_in_edges_tensor generation:  0.04063129425048828
mini_batch_src_global generation:  0.055806636810302734
r_  generation:  0.4420769214630127
local_output_nid generation:  0.027152061462402344
local_in_edges_tensor generation:  0.03304409980773926
mini_batch_src_global generation:  0.053107261657714844
r_  generation:  0.4596736431121826
local_output_nid generation:  0.027231931686401367
local_in_edges_tensor generation:  0.03673505783081055
mini_batch_src_global generation:  0.053386688232421875
r_  generation:  0.442455530166626
local_output_nid generation:  0.02681446075439453
local_in_edges_tensor generation:  0.029011964797973633
mini_batch_src_global generation:  0.06978249549865723
r_  generation:  0.49310731887817383
local_output_nid generation:  0.027481555938720703
local_in_edges_tensor generation:  0.029833555221557617
mini_batch_src_global generation:  0.05610084533691406
r_  generation:  0.44969820976257324
local_output_nid generation:  0.027971744537353516
local_in_edges_tensor generation:  0.05720067024230957
mini_batch_src_global generation:  0.0540318489074707
r_  generation:  0.46007513999938965
local_output_nid generation:  0.0291898250579834
local_in_edges_tensor generation:  0.03220176696777344
mini_batch_src_global generation:  0.05275464057922363
r_  generation:  0.4515721797943115
local_output_nid generation:  0.02966761589050293
local_in_edges_tensor generation:  0.03061962127685547
mini_batch_src_global generation:  0.05359148979187012
r_  generation:  0.44685840606689453
local_output_nid generation:  0.028334379196166992
local_in_edges_tensor generation:  0.03645944595336914
mini_batch_src_global generation:  0.052773237228393555
r_  generation:  0.46634912490844727
local_output_nid generation:  0.029156923294067383
local_in_edges_tensor generation:  0.037241220474243164
mini_batch_src_global generation:  0.05780911445617676
r_  generation:  0.450563907623291
local_output_nid generation:  0.02696990966796875
local_in_edges_tensor generation:  0.03256344795227051
mini_batch_src_global generation:  0.05257010459899902
r_  generation:  0.44390106201171875
local_output_nid generation:  0.026928186416625977
local_in_edges_tensor generation:  0.030978679656982422
mini_batch_src_global generation:  0.05301809310913086
r_  generation:  0.44339466094970703
local_output_nid generation:  0.026795625686645508
local_in_edges_tensor generation:  0.0301055908203125
mini_batch_src_global generation:  0.05298590660095215
r_  generation:  0.44487905502319336
----------------------check_connections_block total spend ----------------------------- 21.141801834106445
generate_one_block  0.696403980255127
generate_one_block  0.5964882373809814
generate_one_block  0.5802607536315918
generate_one_block  0.582373857498169
generate_one_block  0.5782685279846191
generate_one_block  0.585080623626709
generate_one_block  0.591193437576294
generate_one_block  0.5733892917633057
generate_one_block  0.5860469341278076
generate_one_block  0.606454610824585
generate_one_block  0.5914225578308105
generate_one_block  0.6045260429382324
generate_one_block  0.574716329574585
generate_one_block  0.5671825408935547
generate_one_block  0.577603816986084
generate_one_block  0.5941476821899414
generate_one_block  0.5768516063690186
generate_one_block  0.570819616317749
generate_one_block  0.5942187309265137
generate_one_block  0.6036698818206787
generate_one_block  0.6022098064422607
generate_one_block  0.5801565647125244
generate_one_block  0.5768289566040039
generate_one_block  0.5646796226501465
generate_one_block  0.5669863224029541
generate_one_block  0.5662782192230225
generate_one_block  0.591339111328125
generate_one_block  0.6115169525146484
generate_one_block  0.584148645401001
generate_one_block  0.5989489555358887
generate_one_block  0.5867927074432373
generate_one_block  0.5741703510284424
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05086255073547363
gen group dst list time:  0.18356752395629883
time for parepare:  0.01889181137084961
local_output_nid generation:  0.03292250633239746
local_in_edges_tensor generation:  0.07624435424804688
mini_batch_src_global generation:  0.048525333404541016
r_  generation:  0.4962306022644043
local_output_nid generation:  0.042900800704956055
local_in_edges_tensor generation:  0.05347180366516113
mini_batch_src_global generation:  0.05471968650817871
r_  generation:  0.4875376224517822
local_output_nid generation:  0.03807640075683594
local_in_edges_tensor generation:  0.04306483268737793
mini_batch_src_global generation:  0.050939083099365234
r_  generation:  0.4938788414001465
local_output_nid generation:  0.037133216857910156
local_in_edges_tensor generation:  0.044792890548706055
mini_batch_src_global generation:  0.05055093765258789
r_  generation:  0.5070974826812744
local_output_nid generation:  0.0375981330871582
local_in_edges_tensor generation:  0.04106783866882324
mini_batch_src_global generation:  0.05603218078613281
r_  generation:  0.5024571418762207
local_output_nid generation:  0.03740715980529785
local_in_edges_tensor generation:  0.041001081466674805
mini_batch_src_global generation:  0.053173065185546875
r_  generation:  0.5056960582733154
local_output_nid generation:  0.03750753402709961
local_in_edges_tensor generation:  0.04077625274658203
mini_batch_src_global generation:  0.05546092987060547
r_  generation:  0.5077817440032959
local_output_nid generation:  0.038033246994018555
local_in_edges_tensor generation:  0.04088640213012695
mini_batch_src_global generation:  0.0543670654296875
r_  generation:  0.509652853012085
local_output_nid generation:  0.03784584999084473
local_in_edges_tensor generation:  0.046225547790527344
mini_batch_src_global generation:  0.053581953048706055
r_  generation:  0.5150294303894043
local_output_nid generation:  0.038114309310913086
local_in_edges_tensor generation:  0.04547905921936035
mini_batch_src_global generation:  0.054439544677734375
r_  generation:  0.51426100730896
local_output_nid generation:  0.037908315658569336
local_in_edges_tensor generation:  0.04067277908325195
mini_batch_src_global generation:  0.05485868453979492
r_  generation:  0.5087740421295166
local_output_nid generation:  0.037992000579833984
local_in_edges_tensor generation:  0.04118537902832031
mini_batch_src_global generation:  0.05474734306335449
r_  generation:  0.5078608989715576
local_output_nid generation:  0.03853178024291992
local_in_edges_tensor generation:  0.03690791130065918
mini_batch_src_global generation:  0.05475306510925293
r_  generation:  0.5097155570983887
local_output_nid generation:  0.03841400146484375
local_in_edges_tensor generation:  0.043346405029296875
mini_batch_src_global generation:  0.055437564849853516
r_  generation:  0.511622428894043
local_output_nid generation:  0.03996753692626953
local_in_edges_tensor generation:  0.04665374755859375
mini_batch_src_global generation:  0.06308412551879883
r_  generation:  0.5118622779846191
local_output_nid generation:  0.038175344467163086
local_in_edges_tensor generation:  0.0460658073425293
mini_batch_src_global generation:  0.06719350814819336
r_  generation:  0.5090587139129639
local_output_nid generation:  0.03916645050048828
local_in_edges_tensor generation:  0.04060697555541992
mini_batch_src_global generation:  0.05827641487121582
r_  generation:  0.5096545219421387
local_output_nid generation:  0.0384211540222168
local_in_edges_tensor generation:  0.04996180534362793
mini_batch_src_global generation:  0.054451942443847656
r_  generation:  0.5174150466918945
local_output_nid generation:  0.037790536880493164
local_in_edges_tensor generation:  0.03763318061828613
mini_batch_src_global generation:  0.055406808853149414
r_  generation:  0.5127601623535156
local_output_nid generation:  0.03843188285827637
local_in_edges_tensor generation:  0.03721213340759277
mini_batch_src_global generation:  0.05620241165161133
r_  generation:  0.5122783184051514
local_output_nid generation:  0.03812050819396973
local_in_edges_tensor generation:  0.03776144981384277
mini_batch_src_global generation:  0.05647563934326172
r_  generation:  0.5150492191314697
local_output_nid generation:  0.0391697883605957
local_in_edges_tensor generation:  0.03744316101074219
mini_batch_src_global generation:  0.05617642402648926
r_  generation:  0.5107600688934326
local_output_nid generation:  0.038428306579589844
local_in_edges_tensor generation:  0.0530247688293457
mini_batch_src_global generation:  0.05510091781616211
r_  generation:  0.5139319896697998
local_output_nid generation:  0.03839755058288574
local_in_edges_tensor generation:  0.0376279354095459
mini_batch_src_global generation:  0.0594635009765625
r_  generation:  0.506242036819458
local_output_nid generation:  0.03820610046386719
local_in_edges_tensor generation:  0.04209542274475098
mini_batch_src_global generation:  0.05540108680725098
r_  generation:  0.5144481658935547
local_output_nid generation:  0.03843808174133301
local_in_edges_tensor generation:  0.04160714149475098
mini_batch_src_global generation:  0.05593252182006836
r_  generation:  0.5130467414855957
local_output_nid generation:  0.03813338279724121
local_in_edges_tensor generation:  0.041509389877319336
mini_batch_src_global generation:  0.05454230308532715
r_  generation:  0.5185160636901855
local_output_nid generation:  0.039136409759521484
local_in_edges_tensor generation:  0.04122614860534668
mini_batch_src_global generation:  0.056092262268066406
r_  generation:  0.5071423053741455
local_output_nid generation:  0.03836202621459961
local_in_edges_tensor generation:  0.04107475280761719
mini_batch_src_global generation:  0.055542945861816406
r_  generation:  0.5159149169921875
local_output_nid generation:  0.038727521896362305
local_in_edges_tensor generation:  0.034169912338256836
mini_batch_src_global generation:  0.055906057357788086
r_  generation:  0.5169458389282227
local_output_nid generation:  0.03885841369628906
local_in_edges_tensor generation:  0.034236907958984375
mini_batch_src_global generation:  0.05463075637817383
r_  generation:  0.5200409889221191
local_output_nid generation:  0.03839278221130371
local_in_edges_tensor generation:  0.035370588302612305
mini_batch_src_global generation:  0.05751943588256836
r_  generation:  0.5117161273956299
----------------------check_connections_block total spend ----------------------------- 24.511654376983643
generate_one_block  0.6408164501190186
generate_one_block  0.6336073875427246
generate_one_block  0.6220953464508057
generate_one_block  0.6406219005584717
generate_one_block  0.6427443027496338
generate_one_block  0.626288652420044
generate_one_block  0.7674131393432617
generate_one_block  0.6255679130554199
generate_one_block  0.6248815059661865
generate_one_block  0.6305468082427979
generate_one_block  0.6324231624603271
generate_one_block  0.6195282936096191
generate_one_block  0.6331300735473633
generate_one_block  0.6318356990814209
generate_one_block  0.6305475234985352
generate_one_block  0.6206965446472168
generate_one_block  0.6214280128479004
generate_one_block  0.6338801383972168
generate_one_block  0.6158132553100586
generate_one_block  0.6353588104248047
generate_one_block  0.6197552680969238
generate_one_block  0.6418921947479248
generate_one_block  0.6192080974578857
generate_one_block  0.6275613307952881
generate_one_block  0.6272068023681641
generate_one_block  0.6331241130828857
generate_one_block  0.6472697257995605
generate_one_block  0.6344268321990967
generate_one_block  0.6395370960235596
generate_one_block  0.6327202320098877
generate_one_block  0.620755672454834
generate_one_block  0.6292932033538818
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0233154296875 GB
    Memory Allocated: 0.007684230804443359  GigaBytes
Max Memory Allocated: 0.007684230804443359  GigaBytes

connection checking time:  52.248307943344116
block generation total time  44.84066438674927
average batch blocks generation time:  1.4012707620859146
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2069091796875 GB
    Memory Allocated: 0.10933637619018555  GigaBytes
Max Memory Allocated: 0.10933637619018555  GigaBytes

torch.Size([160741, 128])
torch.Size([147331, 256])
Traceback (most recent call last):
  File "pseudo_mini_batch_range_arxiv_sage.py", line 435, in <module>
    main()
  File "pseudo_mini_batch_range_arxiv_sage.py", line 431, in main
    best_test = run(args, device, data)
  File "pseudo_mini_batch_range_arxiv_sage.py", line 251, in run
    batch_pred = model(blocks, batch_inputs)#------------*
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/graph_partition_multi_layers/pseudo_mini_batch_full_batch/SAGE/graphsage_model_arxiv.py", line 182, in forward
    x = layer(block, x)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 258, in forward
    graph.update_all(msg_fn, self._lstm_reducer)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/heterograph.py", line 4849, in update_all
    ndata = core.message_passing(g, message_func, reduce_func, apply_node_func)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 337, in message_passing
    ndata = invoke_udf_reduce(g, rfunc, msgdata, orig_nid=orig_nid)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 143, in invoke_udf_reduce
    bkt_rsts.append(func(nbatch))
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 173, in _lstm_reducer
    _, (rst, _) = self.lstm(m, h)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/rnn.py", line 582, in forward
    self.dropout, self.training, self.bidirectional, self.batch_first)
RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 23.62 GiB total capacity; 21.85 GiB already allocated; 18.44 MiB free; 22.41 GiB reserved in total by PyTorch)
