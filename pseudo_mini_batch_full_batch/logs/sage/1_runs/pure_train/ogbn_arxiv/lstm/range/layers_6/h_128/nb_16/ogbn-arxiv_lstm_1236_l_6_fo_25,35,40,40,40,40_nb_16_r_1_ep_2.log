Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648527580.8710148
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.003612995147705078  GigaBytes
Max Memory Allocated: 0.003612995147705078  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.024824857711791992
range selection method range initialization spend 0.01278543472290039
time for parepare:  0.017795324325561523
local_output_nid generation:  0.0013616085052490234
local_in_edges_tensor generation:  0.00420832633972168
mini_batch_src_global generation:  0.0017046928405761719
r_  generation:  0.017149925231933594
local_output_nid generation:  0.0013997554779052734
local_in_edges_tensor generation:  0.0009160041809082031
mini_batch_src_global generation:  0.001890420913696289
r_  generation:  0.017570018768310547
local_output_nid generation:  0.0014362335205078125
local_in_edges_tensor generation:  0.0008661746978759766
mini_batch_src_global generation:  0.0013337135314941406
r_  generation:  0.01715397834777832
local_output_nid generation:  0.0014927387237548828
local_in_edges_tensor generation:  0.000843048095703125
mini_batch_src_global generation:  0.001256704330444336
r_  generation:  0.016814470291137695
local_output_nid generation:  0.0014634132385253906
local_in_edges_tensor generation:  0.0008437633514404297
mini_batch_src_global generation:  0.0011472702026367188
r_  generation:  0.017868518829345703
local_output_nid generation:  0.001552581787109375
local_in_edges_tensor generation:  0.0008268356323242188
mini_batch_src_global generation:  0.0014195442199707031
r_  generation:  0.01841139793395996
local_output_nid generation:  0.0014798641204833984
local_in_edges_tensor generation:  0.0008325576782226562
mini_batch_src_global generation:  0.001435995101928711
r_  generation:  0.017972946166992188
local_output_nid generation:  0.0015017986297607422
local_in_edges_tensor generation:  0.0008230209350585938
mini_batch_src_global generation:  0.0014348030090332031
r_  generation:  0.017994403839111328
local_output_nid generation:  0.0014977455139160156
local_in_edges_tensor generation:  0.0008428096771240234
mini_batch_src_global generation:  0.0012736320495605469
r_  generation:  0.01808953285217285
local_output_nid generation:  0.0014944076538085938
local_in_edges_tensor generation:  0.0008754730224609375
mini_batch_src_global generation:  0.0015077590942382812
r_  generation:  0.018603801727294922
local_output_nid generation:  0.001482248306274414
local_in_edges_tensor generation:  0.0008552074432373047
mini_batch_src_global generation:  0.0015361309051513672
r_  generation:  0.01802349090576172
local_output_nid generation:  0.0014789104461669922
local_in_edges_tensor generation:  0.0008559226989746094
mini_batch_src_global generation:  0.00140380859375
r_  generation:  0.01805734634399414
local_output_nid generation:  0.001537322998046875
local_in_edges_tensor generation:  0.00084686279296875
mini_batch_src_global generation:  0.0013337135314941406
r_  generation:  0.018027305603027344
local_output_nid generation:  0.0014672279357910156
local_in_edges_tensor generation:  0.0008256435394287109
mini_batch_src_global generation:  0.0014874935150146484
r_  generation:  0.018279314041137695
local_output_nid generation:  0.0015151500701904297
local_in_edges_tensor generation:  0.0008833408355712891
mini_batch_src_global generation:  0.001384735107421875
r_  generation:  0.018330097198486328
local_output_nid generation:  0.0014622211456298828
local_in_edges_tensor generation:  0.0008087158203125
mini_batch_src_global generation:  0.0015654563903808594
r_  generation:  0.01909351348876953
----------------------check_connections_block total spend ----------------------------- 0.4337282180786133
generate_one_block  0.02753734588623047
generate_one_block  0.028397083282470703
generate_one_block  0.02767205238342285
generate_one_block  0.028653621673583984
generate_one_block  0.02797555923461914
generate_one_block  0.02775716781616211
generate_one_block  0.02766871452331543
generate_one_block  0.027297258377075195
generate_one_block  0.027516841888427734
generate_one_block  0.02792072296142578
generate_one_block  0.027737855911254883
generate_one_block  0.026879549026489258
generate_one_block  0.027155399322509766
generate_one_block  0.027504682540893555
generate_one_block  0.027043819427490234
generate_one_block  0.02774500846862793
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.040924072265625
gen group dst list time:  0.018970727920532227
time for parepare:  0.019919157028198242
local_output_nid generation:  0.006809711456298828
local_in_edges_tensor generation:  0.0180814266204834
mini_batch_src_global generation:  0.0219113826751709
r_  generation:  0.19822072982788086
local_output_nid generation:  0.012261629104614258
local_in_edges_tensor generation:  0.01854085922241211
mini_batch_src_global generation:  0.02509474754333496
r_  generation:  0.21870183944702148
local_output_nid generation:  0.012922286987304688
local_in_edges_tensor generation:  0.0160219669342041
mini_batch_src_global generation:  0.024625062942504883
r_  generation:  0.21725869178771973
local_output_nid generation:  0.013143062591552734
local_in_edges_tensor generation:  0.013712167739868164
mini_batch_src_global generation:  0.024745464324951172
r_  generation:  0.21533560752868652
local_output_nid generation:  0.01375269889831543
local_in_edges_tensor generation:  0.013619184494018555
mini_batch_src_global generation:  0.02788710594177246
r_  generation:  0.22739744186401367
local_output_nid generation:  0.014263153076171875
local_in_edges_tensor generation:  0.014806747436523438
mini_batch_src_global generation:  0.031252384185791016
r_  generation:  0.2372434139251709
local_output_nid generation:  0.015015363693237305
local_in_edges_tensor generation:  0.026012182235717773
mini_batch_src_global generation:  0.035056352615356445
r_  generation:  0.21724534034729004
local_output_nid generation:  0.011569738388061523
local_in_edges_tensor generation:  0.015308141708374023
mini_batch_src_global generation:  0.02742791175842285
r_  generation:  0.2153027057647705
local_output_nid generation:  0.011619329452514648
local_in_edges_tensor generation:  0.016705036163330078
mini_batch_src_global generation:  0.026611804962158203
r_  generation:  0.22423505783081055
local_output_nid generation:  0.011614322662353516
local_in_edges_tensor generation:  0.015537738800048828
mini_batch_src_global generation:  0.026912212371826172
r_  generation:  0.21756720542907715
local_output_nid generation:  0.011658191680908203
local_in_edges_tensor generation:  0.011736869812011719
mini_batch_src_global generation:  0.026848554611206055
r_  generation:  0.22173094749450684
local_output_nid generation:  0.011495828628540039
local_in_edges_tensor generation:  0.011831283569335938
mini_batch_src_global generation:  0.026969194412231445
r_  generation:  0.2153456211090088
local_output_nid generation:  0.011688232421875
local_in_edges_tensor generation:  0.011621236801147461
mini_batch_src_global generation:  0.02682662010192871
r_  generation:  0.22577190399169922
local_output_nid generation:  0.011837959289550781
local_in_edges_tensor generation:  0.012073755264282227
mini_batch_src_global generation:  0.027396678924560547
r_  generation:  0.21275901794433594
local_output_nid generation:  0.011870384216308594
local_in_edges_tensor generation:  0.01513981819152832
mini_batch_src_global generation:  0.026559114456176758
r_  generation:  0.21568012237548828
local_output_nid generation:  0.011899471282958984
local_in_edges_tensor generation:  0.015743732452392578
mini_batch_src_global generation:  0.028925418853759766
r_  generation:  0.21969056129455566
----------------------check_connections_block total spend ----------------------------- 5.1856982707977295
generate_one_block  0.28303980827331543
generate_one_block  0.2883260250091553
generate_one_block  0.2888798713684082
generate_one_block  0.2741837501525879
generate_one_block  0.30599546432495117
generate_one_block  0.2955472469329834
generate_one_block  0.27719545364379883
generate_one_block  0.29833316802978516
generate_one_block  0.29252099990844727
generate_one_block  0.2816450595855713
generate_one_block  0.2829301357269287
generate_one_block  0.2756030559539795
generate_one_block  0.28143858909606934
generate_one_block  0.2792632579803467
generate_one_block  0.2974865436553955
generate_one_block  0.29331326484680176
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.05144977569580078
gen group dst list time:  0.06196475028991699
time for parepare:  0.019598960876464844
local_output_nid generation:  0.024479150772094727
local_in_edges_tensor generation:  0.06968045234680176
mini_batch_src_global generation:  0.04799294471740723
r_  generation:  0.5225391387939453
local_output_nid generation:  0.03407764434814453
local_in_edges_tensor generation:  0.0488739013671875
mini_batch_src_global generation:  0.05827188491821289
r_  generation:  0.5244040489196777
local_output_nid generation:  0.030681610107421875
local_in_edges_tensor generation:  0.0406947135925293
mini_batch_src_global generation:  0.057045698165893555
r_  generation:  0.5164239406585693
local_output_nid generation:  0.031235218048095703
local_in_edges_tensor generation:  0.03348731994628906
mini_batch_src_global generation:  0.0594785213470459
r_  generation:  0.5077178478240967
local_output_nid generation:  0.031069040298461914
local_in_edges_tensor generation:  0.04397749900817871
mini_batch_src_global generation:  0.060730695724487305
r_  generation:  0.5196430683135986
local_output_nid generation:  0.03286123275756836
local_in_edges_tensor generation:  0.04587888717651367
mini_batch_src_global generation:  0.08383560180664062
r_  generation:  0.5144736766815186
local_output_nid generation:  0.03262591361999512
local_in_edges_tensor generation:  0.04003143310546875
mini_batch_src_global generation:  0.060868024826049805
r_  generation:  0.5177433490753174
local_output_nid generation:  0.03148055076599121
local_in_edges_tensor generation:  0.03694748878479004
mini_batch_src_global generation:  0.0677957534790039
r_  generation:  0.5055818557739258
local_output_nid generation:  0.031493186950683594
local_in_edges_tensor generation:  0.048254966735839844
mini_batch_src_global generation:  0.05947160720825195
r_  generation:  0.5128369331359863
local_output_nid generation:  0.032382965087890625
local_in_edges_tensor generation:  0.039968252182006836
mini_batch_src_global generation:  0.07955622673034668
r_  generation:  0.516864538192749
local_output_nid generation:  0.03257870674133301
local_in_edges_tensor generation:  0.043370962142944336
mini_batch_src_global generation:  0.05843663215637207
r_  generation:  0.5285530090332031
local_output_nid generation:  0.03200793266296387
local_in_edges_tensor generation:  0.032135725021362305
mini_batch_src_global generation:  0.0685427188873291
r_  generation:  0.5090818405151367
local_output_nid generation:  0.03155851364135742
local_in_edges_tensor generation:  0.03996133804321289
mini_batch_src_global generation:  0.058358192443847656
r_  generation:  0.5205557346343994
local_output_nid generation:  0.03277254104614258
local_in_edges_tensor generation:  0.04036092758178711
mini_batch_src_global generation:  0.07708859443664551
r_  generation:  0.5144593715667725
local_output_nid generation:  0.03424406051635742
local_in_edges_tensor generation:  0.03645634651184082
mini_batch_src_global generation:  0.06904363632202148
r_  generation:  0.5088968276977539
local_output_nid generation:  0.0317535400390625
local_in_edges_tensor generation:  0.03481721878051758
mini_batch_src_global generation:  0.05995917320251465
r_  generation:  0.5261869430541992
----------------------check_connections_block total spend ----------------------------- 12.305596828460693
generate_one_block  0.6722409725189209
generate_one_block  0.6685361862182617
generate_one_block  0.6530911922454834
generate_one_block  0.6287202835083008
generate_one_block  0.6527767181396484
generate_one_block  0.660346269607544
generate_one_block  0.7220571041107178
generate_one_block  0.6375102996826172
generate_one_block  0.6461780071258545
generate_one_block  0.6422123908996582
generate_one_block  0.654188871383667
generate_one_block  0.6321499347686768
generate_one_block  0.6578145027160645
generate_one_block  0.6351597309112549
generate_one_block  0.6387073993682861
generate_one_block  0.6663112640380859
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04841136932373047
gen group dst list time:  0.08879923820495605
time for parepare:  0.019651412963867188
local_output_nid generation:  0.032088279724121094
local_in_edges_tensor generation:  0.10792279243469238
mini_batch_src_global generation:  0.05121111869812012
r_  generation:  0.5417253971099854
local_output_nid generation:  0.036795616149902344
local_in_edges_tensor generation:  0.05676674842834473
mini_batch_src_global generation:  0.06325006484985352
r_  generation:  0.5466759204864502
local_output_nid generation:  0.03649330139160156
local_in_edges_tensor generation:  0.04744219779968262
mini_batch_src_global generation:  0.059377193450927734
r_  generation:  0.5569841861724854
local_output_nid generation:  0.03657102584838867
local_in_edges_tensor generation:  0.04454350471496582
mini_batch_src_global generation:  0.059471845626831055
r_  generation:  0.5559360980987549
local_output_nid generation:  0.036908626556396484
local_in_edges_tensor generation:  0.04263901710510254
mini_batch_src_global generation:  0.05857682228088379
r_  generation:  0.567065954208374
local_output_nid generation:  0.03734755516052246
local_in_edges_tensor generation:  0.04821014404296875
mini_batch_src_global generation:  0.060053110122680664
r_  generation:  0.5649778842926025
local_output_nid generation:  0.0374913215637207
local_in_edges_tensor generation:  0.03877401351928711
mini_batch_src_global generation:  0.06095290184020996
r_  generation:  0.5746524333953857
local_output_nid generation:  0.03871870040893555
local_in_edges_tensor generation:  0.043892860412597656
mini_batch_src_global generation:  0.06271743774414062
r_  generation:  0.5633070468902588
local_output_nid generation:  0.03698563575744629
local_in_edges_tensor generation:  0.04807853698730469
mini_batch_src_global generation:  0.06175422668457031
r_  generation:  0.5764739513397217
local_output_nid generation:  0.037103891372680664
local_in_edges_tensor generation:  0.038353681564331055
mini_batch_src_global generation:  0.06217360496520996
r_  generation:  0.5738248825073242
local_output_nid generation:  0.03729438781738281
local_in_edges_tensor generation:  0.04250812530517578
mini_batch_src_global generation:  0.061705589294433594
r_  generation:  0.5779392719268799
local_output_nid generation:  0.03761792182922363
local_in_edges_tensor generation:  0.0432744026184082
mini_batch_src_global generation:  0.0632929801940918
r_  generation:  0.5648281574249268
local_output_nid generation:  0.037560224533081055
local_in_edges_tensor generation:  0.043060302734375
mini_batch_src_global generation:  0.06293487548828125
r_  generation:  0.5772027969360352
local_output_nid generation:  0.03755831718444824
local_in_edges_tensor generation:  0.0434260368347168
mini_batch_src_global generation:  0.06231856346130371
r_  generation:  0.5747663974761963
local_output_nid generation:  0.037748098373413086
local_in_edges_tensor generation:  0.05553078651428223
mini_batch_src_global generation:  0.06719183921813965
r_  generation:  0.5747601985931396
local_output_nid generation:  0.03803658485412598
local_in_edges_tensor generation:  0.05598807334899902
mini_batch_src_global generation:  0.06252932548522949
r_  generation:  0.567617654800415
----------------------check_connections_block total spend ----------------------------- 13.533299446105957
generate_one_block  0.7028493881225586
generate_one_block  0.7142057418823242
generate_one_block  0.7058391571044922
generate_one_block  0.7628333568572998
generate_one_block  0.6967546939849854
generate_one_block  0.7162094116210938
generate_one_block  0.6828815937042236
generate_one_block  0.7035562992095947
generate_one_block  0.6943984031677246
generate_one_block  0.6957271099090576
generate_one_block  0.6898086071014404
generate_one_block  0.6986594200134277
generate_one_block  0.68695068359375
generate_one_block  0.6954336166381836
generate_one_block  0.7087454795837402
generate_one_block  0.7138543128967285
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04290437698364258
gen group dst list time:  0.09938788414001465
time for parepare:  0.019405364990234375
local_output_nid generation:  0.03464460372924805
local_in_edges_tensor generation:  0.05468273162841797
mini_batch_src_global generation:  0.04901719093322754
r_  generation:  0.5421357154846191
local_output_nid generation:  0.04033946990966797
local_in_edges_tensor generation:  0.04123115539550781
mini_batch_src_global generation:  0.06308388710021973
r_  generation:  0.5443112850189209
local_output_nid generation:  0.038512468338012695
local_in_edges_tensor generation:  0.035897016525268555
mini_batch_src_global generation:  0.06320810317993164
r_  generation:  0.543257474899292
local_output_nid generation:  0.0390779972076416
local_in_edges_tensor generation:  0.036448001861572266
mini_batch_src_global generation:  0.06204652786254883
r_  generation:  0.5536315441131592
local_output_nid generation:  0.039446115493774414
local_in_edges_tensor generation:  0.04297447204589844
mini_batch_src_global generation:  0.06307148933410645
r_  generation:  0.5479474067687988
local_output_nid generation:  0.03977799415588379
local_in_edges_tensor generation:  0.04110383987426758
mini_batch_src_global generation:  0.06139731407165527
r_  generation:  0.5497801303863525
local_output_nid generation:  0.04095458984375
local_in_edges_tensor generation:  0.04112100601196289
mini_batch_src_global generation:  0.061712026596069336
r_  generation:  0.5490965843200684
local_output_nid generation:  0.03998088836669922
local_in_edges_tensor generation:  0.04234790802001953
mini_batch_src_global generation:  0.06382966041564941
r_  generation:  0.5663609504699707
local_output_nid generation:  0.039751291275024414
local_in_edges_tensor generation:  0.050299644470214844
mini_batch_src_global generation:  0.071014404296875
r_  generation:  0.5558457374572754
local_output_nid generation:  0.041617631912231445
local_in_edges_tensor generation:  0.04466414451599121
mini_batch_src_global generation:  0.06128859519958496
r_  generation:  0.5651185512542725
local_output_nid generation:  0.04091501235961914
local_in_edges_tensor generation:  0.041016340255737305
mini_batch_src_global generation:  0.061362504959106445
r_  generation:  0.5507059097290039
local_output_nid generation:  0.04052138328552246
local_in_edges_tensor generation:  0.046456098556518555
mini_batch_src_global generation:  0.06106162071228027
r_  generation:  0.5602922439575195
local_output_nid generation:  0.04086709022521973
local_in_edges_tensor generation:  0.04345083236694336
mini_batch_src_global generation:  0.0655977725982666
r_  generation:  0.55572509765625
local_output_nid generation:  0.04084420204162598
local_in_edges_tensor generation:  0.04113960266113281
mini_batch_src_global generation:  0.06204819679260254
r_  generation:  0.5610020160675049
local_output_nid generation:  0.040967464447021484
local_in_edges_tensor generation:  0.04585862159729004
mini_batch_src_global generation:  0.06151223182678223
r_  generation:  0.5763900279998779
local_output_nid generation:  0.04100751876831055
local_in_edges_tensor generation:  0.04119372367858887
mini_batch_src_global generation:  0.06207275390625
r_  generation:  0.5639207363128662
----------------------check_connections_block total spend ----------------------------- 13.3103506565094
generate_one_block  0.7003219127655029
generate_one_block  0.6906485557556152
generate_one_block  0.6952154636383057
generate_one_block  0.6788201332092285
generate_one_block  0.6935296058654785
generate_one_block  0.6980135440826416
generate_one_block  0.7427463531494141
generate_one_block  0.6939048767089844
generate_one_block  0.6784131526947021
generate_one_block  0.6837115287780762
generate_one_block  0.6873643398284912
generate_one_block  0.674746036529541
generate_one_block  0.695526123046875
generate_one_block  0.6759369373321533
generate_one_block  0.702885627746582
generate_one_block  0.6994566917419434
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03547954559326172
gen group dst list time:  0.09543991088867188
time for parepare:  0.018769502639770508
local_output_nid generation:  0.03565573692321777
local_in_edges_tensor generation:  0.04502248764038086
mini_batch_src_global generation:  0.05790352821350098
r_  generation:  0.5157968997955322
local_output_nid generation:  0.0416262149810791
local_in_edges_tensor generation:  0.03983044624328613
mini_batch_src_global generation:  0.06296730041503906
r_  generation:  0.5134520530700684
local_output_nid generation:  0.04022574424743652
local_in_edges_tensor generation:  0.035846710205078125
mini_batch_src_global generation:  0.060276031494140625
r_  generation:  0.5178461074829102
local_output_nid generation:  0.039734840393066406
local_in_edges_tensor generation:  0.04120755195617676
mini_batch_src_global generation:  0.06043505668640137
r_  generation:  0.5370123386383057
local_output_nid generation:  0.04356694221496582
local_in_edges_tensor generation:  0.049440622329711914
mini_batch_src_global generation:  0.06159329414367676
r_  generation:  0.514458417892456
local_output_nid generation:  0.041197776794433594
local_in_edges_tensor generation:  0.038912057876586914
mini_batch_src_global generation:  0.06087207794189453
r_  generation:  0.5225412845611572
local_output_nid generation:  0.041425466537475586
local_in_edges_tensor generation:  0.037711143493652344
mini_batch_src_global generation:  0.060270071029663086
r_  generation:  0.5265793800354004
local_output_nid generation:  0.04276108741760254
local_in_edges_tensor generation:  0.03601956367492676
mini_batch_src_global generation:  0.06193876266479492
r_  generation:  0.515479326248169
local_output_nid generation:  0.04332375526428223
local_in_edges_tensor generation:  0.05087566375732422
mini_batch_src_global generation:  0.06130647659301758
r_  generation:  0.5201225280761719
local_output_nid generation:  0.04210305213928223
local_in_edges_tensor generation:  0.05087018013000488
mini_batch_src_global generation:  0.0754547119140625
r_  generation:  0.5106875896453857
local_output_nid generation:  0.04264378547668457
local_in_edges_tensor generation:  0.044089317321777344
mini_batch_src_global generation:  0.05827474594116211
r_  generation:  0.5113558769226074
local_output_nid generation:  0.041701555252075195
local_in_edges_tensor generation:  0.03501152992248535
mini_batch_src_global generation:  0.060552120208740234
r_  generation:  0.5152320861816406
local_output_nid generation:  0.04181504249572754
local_in_edges_tensor generation:  0.04379391670227051
mini_batch_src_global generation:  0.058228492736816406
r_  generation:  0.5281217098236084
local_output_nid generation:  0.04215049743652344
local_in_edges_tensor generation:  0.03500056266784668
mini_batch_src_global generation:  0.05976462364196777
r_  generation:  0.5194032192230225
local_output_nid generation:  0.04270744323730469
local_in_edges_tensor generation:  0.039167165756225586
mini_batch_src_global generation:  0.05852961540222168
r_  generation:  0.5149857997894287
local_output_nid generation:  0.043158531188964844
local_in_edges_tensor generation:  0.04399919509887695
mini_batch_src_global generation:  0.057466745376586914
r_  generation:  0.5252058506011963
----------------------check_connections_block total spend ----------------------------- 12.658664226531982
generate_one_block  0.6468977928161621
generate_one_block  0.6620042324066162
generate_one_block  0.6486592292785645
generate_one_block  0.6363935470581055
generate_one_block  0.6449711322784424
generate_one_block  0.6794524192810059
generate_one_block  0.6459043025970459
generate_one_block  0.6445746421813965
generate_one_block  0.7503724098205566
generate_one_block  0.6738870143890381
generate_one_block  0.654822587966919
generate_one_block  0.6295671463012695
generate_one_block  0.6533079147338867
generate_one_block  0.637610673904419
generate_one_block  0.6401503086090088
generate_one_block  0.6806843280792236
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.003612995147705078  GigaBytes
Max Memory Allocated: 0.003612995147705078  GigaBytes

connection checking time:  56.99360942840576
block generation total time  47.95291066169739
average batch blocks generation time:  2.9970569163560867
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2244873046875 GB
    Memory Allocated: 0.13860130310058594  GigaBytes
Max Memory Allocated: 0.13860130310058594  GigaBytes

torch.Size([167276, 128])
torch.Size([166448, 128])
Traceback (most recent call last):
  File "pseudo_mini_batch_range_arxiv_sage.py", line 438, in <module>
    main()
  File "pseudo_mini_batch_range_arxiv_sage.py", line 434, in main
    best_test = run(args, device, data)
  File "pseudo_mini_batch_range_arxiv_sage.py", line 253, in run
    batch_pred = model(blocks, batch_inputs)#------------*
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/graph_partition_multi_layers/pseudo_mini_batch_full_batch/SAGE/graphsage_model_arxiv.py", line 182, in forward
    x = layer(block, x)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 258, in forward
    graph.update_all(msg_fn, self._lstm_reducer)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/heterograph.py", line 4849, in update_all
    ndata = core.message_passing(g, message_func, reduce_func, apply_node_func)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 337, in message_passing
    ndata = invoke_udf_reduce(g, rfunc, msgdata, orig_nid=orig_nid)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 143, in invoke_udf_reduce
    bkt_rsts.append(func(nbatch))
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 173, in _lstm_reducer
    _, (rst, _) = self.lstm(m, h)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/rnn.py", line 582, in forward
    self.dropout, self.training, self.bidirectional, self.batch_first)
RuntimeError: CUDA out of memory. Tried to allocate 2.00 MiB (GPU 0; 23.62 GiB total capacity; 22.35 GiB already allocated; 2.44 MiB free; 22.42 GiB reserved in total by PyTorch)
