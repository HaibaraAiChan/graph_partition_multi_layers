Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648472907.5761695
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017633438110351562  GigaBytes
Max Memory Allocated: 0.0017633438110351562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02782726287841797
range selection method range initialization spend 0.013543128967285156
time for parepare:  0.017823457717895508
local_output_nid generation:  0.0006999969482421875
local_in_edges_tensor generation:  0.003632783889770508
mini_batch_src_global generation:  0.0014300346374511719
r_  generation:  0.010116815567016602
local_output_nid generation:  0.0007534027099609375
local_in_edges_tensor generation:  0.0005950927734375
mini_batch_src_global generation:  0.0014884471893310547
r_  generation:  0.009492158889770508
local_output_nid generation:  0.0007669925689697266
local_in_edges_tensor generation:  0.0005087852478027344
mini_batch_src_global generation:  0.0009522438049316406
r_  generation:  0.009039163589477539
local_output_nid generation:  0.0007412433624267578
local_in_edges_tensor generation:  0.0004937648773193359
mini_batch_src_global generation:  0.0008997917175292969
r_  generation:  0.009168148040771484
local_output_nid generation:  0.0007429122924804688
local_in_edges_tensor generation:  0.0004856586456298828
mini_batch_src_global generation:  0.0010251998901367188
r_  generation:  0.009809732437133789
local_output_nid generation:  0.0007495880126953125
local_in_edges_tensor generation:  0.00048041343688964844
mini_batch_src_global generation:  0.0009617805480957031
r_  generation:  0.009658098220825195
local_output_nid generation:  0.0007445812225341797
local_in_edges_tensor generation:  0.00048422813415527344
mini_batch_src_global generation:  0.0009148120880126953
r_  generation:  0.009552955627441406
local_output_nid generation:  0.0007417201995849609
local_in_edges_tensor generation:  0.0004837512969970703
mini_batch_src_global generation:  0.0009357929229736328
r_  generation:  0.009737730026245117
local_output_nid generation:  0.0007627010345458984
local_in_edges_tensor generation:  0.0004820823669433594
mini_batch_src_global generation:  0.0009710788726806641
r_  generation:  0.009966135025024414
local_output_nid generation:  0.0007586479187011719
local_in_edges_tensor generation:  0.00047969818115234375
mini_batch_src_global generation:  0.0009355545043945312
r_  generation:  0.00928807258605957
local_output_nid generation:  0.0007457733154296875
local_in_edges_tensor generation:  0.0005133152008056641
mini_batch_src_global generation:  0.0009546279907226562
r_  generation:  0.009623050689697266
local_output_nid generation:  0.0007457733154296875
local_in_edges_tensor generation:  0.0004715919494628906
mini_batch_src_global generation:  0.0009250640869140625
r_  generation:  0.009375810623168945
local_output_nid generation:  0.0007297992706298828
local_in_edges_tensor generation:  0.00045943260192871094
mini_batch_src_global generation:  0.0010142326354980469
r_  generation:  0.00967097282409668
local_output_nid generation:  0.0007450580596923828
local_in_edges_tensor generation:  0.0004622936248779297
mini_batch_src_global generation:  0.0009350776672363281
r_  generation:  0.009493827819824219
local_output_nid generation:  0.0007522106170654297
local_in_edges_tensor generation:  0.0004749298095703125
mini_batch_src_global generation:  0.0009610652923583984
r_  generation:  0.010286569595336914
local_output_nid generation:  0.0007507801055908203
local_in_edges_tensor generation:  0.0004687309265136719
mini_batch_src_global generation:  0.0009295940399169922
r_  generation:  0.009371519088745117
local_output_nid generation:  0.0007555484771728516
local_in_edges_tensor generation:  0.0004677772521972656
mini_batch_src_global generation:  0.0010666847229003906
r_  generation:  0.009658098220825195
local_output_nid generation:  0.0007541179656982422
local_in_edges_tensor generation:  0.0004875659942626953
mini_batch_src_global generation:  0.0009741783142089844
r_  generation:  0.009993314743041992
local_output_nid generation:  0.0007383823394775391
local_in_edges_tensor generation:  0.00047898292541503906
mini_batch_src_global generation:  0.0009739398956298828
r_  generation:  0.009914875030517578
local_output_nid generation:  0.0007381439208984375
local_in_edges_tensor generation:  0.0004684925079345703
mini_batch_src_global generation:  0.0009675025939941406
r_  generation:  0.009697675704956055
local_output_nid generation:  0.0007491111755371094
local_in_edges_tensor generation:  0.0004780292510986328
mini_batch_src_global generation:  0.0010447502136230469
r_  generation:  0.010487794876098633
local_output_nid generation:  0.0007383823394775391
local_in_edges_tensor generation:  0.0004730224609375
mini_batch_src_global generation:  0.000997304916381836
r_  generation:  0.009647130966186523
local_output_nid generation:  0.0007498264312744141
local_in_edges_tensor generation:  0.00048279762268066406
mini_batch_src_global generation:  0.0009918212890625
r_  generation:  0.010145425796508789
local_output_nid generation:  0.0007500648498535156
local_in_edges_tensor generation:  0.0004756450653076172
mini_batch_src_global generation:  0.0009579658508300781
r_  generation:  0.009751558303833008
local_output_nid generation:  0.0007326602935791016
local_in_edges_tensor generation:  0.0004870891571044922
mini_batch_src_global generation:  0.0011141300201416016
r_  generation:  0.009946107864379883
local_output_nid generation:  0.0007433891296386719
local_in_edges_tensor generation:  0.00048422813415527344
mini_batch_src_global generation:  0.0009746551513671875
r_  generation:  0.009739398956298828
local_output_nid generation:  0.0007467269897460938
local_in_edges_tensor generation:  0.0004718303680419922
mini_batch_src_global generation:  0.0009577274322509766
r_  generation:  0.009588956832885742
local_output_nid generation:  0.0007526874542236328
local_in_edges_tensor generation:  0.0004811286926269531
mini_batch_src_global generation:  0.0009548664093017578
r_  generation:  0.009723663330078125
local_output_nid generation:  0.0007390975952148438
local_in_edges_tensor generation:  0.0004608631134033203
mini_batch_src_global generation:  0.0009691715240478516
r_  generation:  0.009907245635986328
local_output_nid generation:  0.0007531642913818359
local_in_edges_tensor generation:  0.0041463375091552734
mini_batch_src_global generation:  0.0011975765228271484
r_  generation:  0.009748697280883789
local_output_nid generation:  0.0008013248443603516
local_in_edges_tensor generation:  0.0005023479461669922
mini_batch_src_global generation:  0.0010514259338378906
r_  generation:  0.00961160659790039
local_output_nid generation:  0.0007750988006591797
local_in_edges_tensor generation:  0.0004813671112060547
mini_batch_src_global generation:  0.001039743423461914
r_  generation:  0.00972747802734375
----------------------check_connections_block total spend ----------------------------- 0.4789559841156006
generate_one_block  0.014823436737060547
generate_one_block  0.014709949493408203
generate_one_block  0.014473199844360352
generate_one_block  0.01463174819946289
generate_one_block  0.015513181686401367
generate_one_block  0.01489877700805664
generate_one_block  0.014719486236572266
generate_one_block  0.014930486679077148
generate_one_block  0.015150070190429688
generate_one_block  0.01432943344116211
generate_one_block  0.014668464660644531
generate_one_block  0.014322757720947266
generate_one_block  0.014774084091186523
generate_one_block  0.01440882682800293
generate_one_block  0.01535797119140625
generate_one_block  0.01404261589050293
generate_one_block  0.014405965805053711
generate_one_block  0.015237569808959961
generate_one_block  0.014560937881469727
generate_one_block  0.01457524299621582
generate_one_block  0.015737295150756836
generate_one_block  0.014477968215942383
generate_one_block  0.015335798263549805
generate_one_block  0.014534711837768555
generate_one_block  0.01476597785949707
generate_one_block  0.014602899551391602
generate_one_block  0.014466285705566406
generate_one_block  0.014516592025756836
generate_one_block  0.01492452621459961
generate_one_block  0.014277219772338867
generate_one_block  0.014648914337158203
generate_one_block  0.014698266983032227
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03922748565673828
gen group dst list time:  0.02366161346435547
time for parepare:  0.019416093826293945
local_output_nid generation:  0.004143238067626953
local_in_edges_tensor generation:  0.011960506439208984
mini_batch_src_global generation:  0.013218164443969727
r_  generation:  0.1284480094909668
local_output_nid generation:  0.007829427719116211
local_in_edges_tensor generation:  0.012204647064208984
mini_batch_src_global generation:  0.01660299301147461
r_  generation:  0.13867449760437012
local_output_nid generation:  0.008117914199829102
local_in_edges_tensor generation:  0.009127616882324219
mini_batch_src_global generation:  0.015648841857910156
r_  generation:  0.14528608322143555
local_output_nid generation:  0.007969379425048828
local_in_edges_tensor generation:  0.010143280029296875
mini_batch_src_global generation:  0.017473936080932617
r_  generation:  0.14165997505187988
local_output_nid generation:  0.008498907089233398
local_in_edges_tensor generation:  0.01068735122680664
mini_batch_src_global generation:  0.01895904541015625
r_  generation:  0.15056490898132324
local_output_nid generation:  0.00860738754272461
local_in_edges_tensor generation:  0.008031368255615234
mini_batch_src_global generation:  0.01846766471862793
r_  generation:  0.14674830436706543
local_output_nid generation:  0.008411407470703125
local_in_edges_tensor generation:  0.009460926055908203
mini_batch_src_global generation:  0.017667293548583984
r_  generation:  0.14548563957214355
local_output_nid generation:  0.008729219436645508
local_in_edges_tensor generation:  0.010764837265014648
mini_batch_src_global generation:  0.019285202026367188
r_  generation:  0.15227437019348145
local_output_nid generation:  0.01257014274597168
local_in_edges_tensor generation:  0.010929107666015625
mini_batch_src_global generation:  0.01870870590209961
r_  generation:  0.15178728103637695
local_output_nid generation:  0.008246183395385742
local_in_edges_tensor generation:  0.008181333541870117
mini_batch_src_global generation:  0.017778873443603516
r_  generation:  0.14252948760986328
local_output_nid generation:  0.008840084075927734
local_in_edges_tensor generation:  0.008236408233642578
mini_batch_src_global generation:  0.0179445743560791
r_  generation:  0.14528393745422363
local_output_nid generation:  0.008624792098999023
local_in_edges_tensor generation:  0.009102106094360352
mini_batch_src_global generation:  0.017755985260009766
r_  generation:  0.1442105770111084
local_output_nid generation:  0.008997201919555664
local_in_edges_tensor generation:  0.01066446304321289
mini_batch_src_global generation:  0.019487857818603516
r_  generation:  0.1503129005432129
local_output_nid generation:  0.008815288543701172
local_in_edges_tensor generation:  0.00847768783569336
mini_batch_src_global generation:  0.018341064453125
r_  generation:  0.14319205284118652
local_output_nid generation:  0.009253263473510742
local_in_edges_tensor generation:  0.009495258331298828
mini_batch_src_global generation:  0.019861459732055664
r_  generation:  0.15317940711975098
local_output_nid generation:  0.008649587631225586
local_in_edges_tensor generation:  0.008473396301269531
mini_batch_src_global generation:  0.01821756362915039
r_  generation:  0.14466357231140137
local_output_nid generation:  0.00888514518737793
local_in_edges_tensor generation:  0.008343935012817383
mini_batch_src_global generation:  0.018245697021484375
r_  generation:  0.14599180221557617
local_output_nid generation:  0.0092010498046875
local_in_edges_tensor generation:  0.010919570922851562
mini_batch_src_global generation:  0.02032184600830078
r_  generation:  0.1560516357421875
local_output_nid generation:  0.008866310119628906
local_in_edges_tensor generation:  0.008439302444458008
mini_batch_src_global generation:  0.0187835693359375
r_  generation:  0.14789080619812012
local_output_nid generation:  0.008915185928344727
local_in_edges_tensor generation:  0.009559392929077148
mini_batch_src_global generation:  0.01813030242919922
r_  generation:  0.14959955215454102
local_output_nid generation:  0.009409904479980469
local_in_edges_tensor generation:  0.011149883270263672
mini_batch_src_global generation:  0.019517183303833008
r_  generation:  0.1568152904510498
local_output_nid generation:  0.00895380973815918
local_in_edges_tensor generation:  0.008762359619140625
mini_batch_src_global generation:  0.018008708953857422
r_  generation:  0.1474308967590332
local_output_nid generation:  0.009332895278930664
local_in_edges_tensor generation:  0.009985923767089844
mini_batch_src_global generation:  0.018796443939208984
r_  generation:  0.15314698219299316
local_output_nid generation:  0.00896143913269043
local_in_edges_tensor generation:  0.008783578872680664
mini_batch_src_global generation:  0.018385887145996094
r_  generation:  0.14895868301391602
local_output_nid generation:  0.00915384292602539
local_in_edges_tensor generation:  0.008816719055175781
mini_batch_src_global generation:  0.019047975540161133
r_  generation:  0.15096163749694824
local_output_nid generation:  0.009000778198242188
local_in_edges_tensor generation:  0.009579896926879883
mini_batch_src_global generation:  0.01862812042236328
r_  generation:  0.15110254287719727
local_output_nid generation:  0.008872270584106445
local_in_edges_tensor generation:  0.008432626724243164
mini_batch_src_global generation:  0.018570423126220703
r_  generation:  0.1468048095703125
local_output_nid generation:  0.008994579315185547
local_in_edges_tensor generation:  0.008416175842285156
mini_batch_src_global generation:  0.019121885299682617
r_  generation:  0.1539313793182373
local_output_nid generation:  0.009231090545654297
local_in_edges_tensor generation:  0.00959324836730957
mini_batch_src_global generation:  0.018770694732666016
r_  generation:  0.1489095687866211
local_output_nid generation:  0.008904218673706055
local_in_edges_tensor generation:  0.008457660675048828
mini_batch_src_global generation:  0.018135547637939453
r_  generation:  0.14537286758422852
local_output_nid generation:  0.008998870849609375
local_in_edges_tensor generation:  0.010218620300292969
mini_batch_src_global generation:  0.018178224563598633
r_  generation:  0.14946866035461426
local_output_nid generation:  0.009134292602539062
local_in_edges_tensor generation:  0.009599447250366211
mini_batch_src_global generation:  0.017955541610717773
r_  generation:  0.15233635902404785
----------------------check_connections_block total spend ----------------------------- 7.036050319671631
generate_one_block  0.18504714965820312
generate_one_block  0.18408632278442383
generate_one_block  0.20728254318237305
generate_one_block  0.19340014457702637
generate_one_block  0.19662904739379883
generate_one_block  0.19201254844665527
generate_one_block  0.1853797435760498
generate_one_block  0.19133234024047852
generate_one_block  0.19538164138793945
generate_one_block  0.17591524124145508
generate_one_block  0.1843428611755371
generate_one_block  0.1817312240600586
generate_one_block  0.19069766998291016
generate_one_block  0.18105578422546387
generate_one_block  0.19806528091430664
generate_one_block  0.2010514736175537
generate_one_block  0.18136334419250488
generate_one_block  0.1994307041168213
generate_one_block  0.18292498588562012
generate_one_block  0.1837928295135498
generate_one_block  0.2039046287536621
generate_one_block  0.18242120742797852
generate_one_block  0.1973876953125
generate_one_block  0.18784260749816895
generate_one_block  0.19702553749084473
generate_one_block  0.19048094749450684
generate_one_block  0.18384671211242676
generate_one_block  0.19107890129089355
generate_one_block  0.192488431930542
generate_one_block  0.18926382064819336
generate_one_block  0.1840827465057373
generate_one_block  0.18885135650634766
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0554654598236084
gen group dst list time:  0.11180734634399414
time for parepare:  0.01889181137084961
local_output_nid generation:  0.020389080047607422
local_in_edges_tensor generation:  0.06654977798461914
mini_batch_src_global generation:  0.03799939155578613
r_  generation:  0.38417625427246094
local_output_nid generation:  0.026462078094482422
local_in_edges_tensor generation:  0.040863752365112305
mini_batch_src_global generation:  0.04784131050109863
r_  generation:  0.3985939025878906
local_output_nid generation:  0.026597261428833008
local_in_edges_tensor generation:  0.03352093696594238
mini_batch_src_global generation:  0.047209739685058594
r_  generation:  0.4003458023071289
local_output_nid generation:  0.025255203247070312
local_in_edges_tensor generation:  0.03314518928527832
mini_batch_src_global generation:  0.0483851432800293
r_  generation:  0.4100196361541748
local_output_nid generation:  0.025831937789916992
local_in_edges_tensor generation:  0.033980607986450195
mini_batch_src_global generation:  0.05131244659423828
r_  generation:  0.43083810806274414
local_output_nid generation:  0.026053428649902344
local_in_edges_tensor generation:  0.03882956504821777
mini_batch_src_global generation:  0.049347639083862305
r_  generation:  0.4072282314300537
local_output_nid generation:  0.0254061222076416
local_in_edges_tensor generation:  0.02690410614013672
mini_batch_src_global generation:  0.048128604888916016
r_  generation:  0.4064903259277344
local_output_nid generation:  0.025793075561523438
local_in_edges_tensor generation:  0.027959823608398438
mini_batch_src_global generation:  0.04872941970825195
r_  generation:  0.40859079360961914
local_output_nid generation:  0.025660037994384766
local_in_edges_tensor generation:  0.041364431381225586
mini_batch_src_global generation:  0.04828524589538574
r_  generation:  0.41046977043151855
local_output_nid generation:  0.025060176849365234
local_in_edges_tensor generation:  0.026744604110717773
mini_batch_src_global generation:  0.047902584075927734
r_  generation:  0.39974379539489746
local_output_nid generation:  0.026062965393066406
local_in_edges_tensor generation:  0.0328061580657959
mini_batch_src_global generation:  0.04879593849182129
r_  generation:  0.43538975715637207
local_output_nid generation:  0.027337312698364258
local_in_edges_tensor generation:  0.0351719856262207
mini_batch_src_global generation:  0.05753684043884277
r_  generation:  0.40542101860046387
local_output_nid generation:  0.02677297592163086
local_in_edges_tensor generation:  0.03527021408081055
mini_batch_src_global generation:  0.051244497299194336
r_  generation:  0.41302943229675293
local_output_nid generation:  0.02638530731201172
local_in_edges_tensor generation:  0.031035423278808594
mini_batch_src_global generation:  0.04864788055419922
r_  generation:  0.4043765068054199
local_output_nid generation:  0.02693772315979004
local_in_edges_tensor generation:  0.03485679626464844
mini_batch_src_global generation:  0.04918980598449707
r_  generation:  0.4191627502441406
local_output_nid generation:  0.02657794952392578
local_in_edges_tensor generation:  0.027534008026123047
mini_batch_src_global generation:  0.048447370529174805
r_  generation:  0.40856337547302246
local_output_nid generation:  0.026683568954467773
local_in_edges_tensor generation:  0.031824588775634766
mini_batch_src_global generation:  0.05051898956298828
r_  generation:  0.4091165065765381
local_output_nid generation:  0.027750253677368164
local_in_edges_tensor generation:  0.034227848052978516
mini_batch_src_global generation:  0.048195600509643555
r_  generation:  0.4119694232940674
local_output_nid generation:  0.027196645736694336
local_in_edges_tensor generation:  0.027578115463256836
mini_batch_src_global generation:  0.04752326011657715
r_  generation:  0.41004204750061035
local_output_nid generation:  0.026712894439697266
local_in_edges_tensor generation:  0.030352354049682617
mini_batch_src_global generation:  0.048317670822143555
r_  generation:  0.4051651954650879
local_output_nid generation:  0.027100324630737305
local_in_edges_tensor generation:  0.03873109817504883
mini_batch_src_global generation:  0.0486454963684082
r_  generation:  0.4158444404602051
local_output_nid generation:  0.026620149612426758
local_in_edges_tensor generation:  0.027179241180419922
mini_batch_src_global generation:  0.04818916320800781
r_  generation:  0.40621137619018555
local_output_nid generation:  0.026983976364135742
local_in_edges_tensor generation:  0.03107595443725586
mini_batch_src_global generation:  0.04784893989562988
r_  generation:  0.41490769386291504
local_output_nid generation:  0.02683234214782715
local_in_edges_tensor generation:  0.030308008193969727
mini_batch_src_global generation:  0.04874253273010254
r_  generation:  0.4113180637359619
local_output_nid generation:  0.026982545852661133
local_in_edges_tensor generation:  0.03486919403076172
mini_batch_src_global generation:  0.04830789566040039
r_  generation:  0.4118916988372803
local_output_nid generation:  0.026686429977416992
local_in_edges_tensor generation:  0.03132486343383789
mini_batch_src_global generation:  0.04867863655090332
r_  generation:  0.40993690490722656
local_output_nid generation:  0.0266876220703125
local_in_edges_tensor generation:  0.026534318923950195
mini_batch_src_global generation:  0.04754328727722168
r_  generation:  0.40617847442626953
local_output_nid generation:  0.02667689323425293
local_in_edges_tensor generation:  0.03126096725463867
mini_batch_src_global generation:  0.05144810676574707
r_  generation:  0.409928560256958
local_output_nid generation:  0.02703070640563965
local_in_edges_tensor generation:  0.030833721160888672
mini_batch_src_global generation:  0.04831814765930176
r_  generation:  0.4141089916229248
local_output_nid generation:  0.02666306495666504
local_in_edges_tensor generation:  0.02746105194091797
mini_batch_src_global generation:  0.049167633056640625
r_  generation:  0.4070396423339844
local_output_nid generation:  0.027034521102905273
local_in_edges_tensor generation:  0.03383064270019531
mini_batch_src_global generation:  0.05047464370727539
r_  generation:  0.41422057151794434
local_output_nid generation:  0.026641130447387695
local_in_edges_tensor generation:  0.031271934509277344
mini_batch_src_global generation:  0.049182891845703125
r_  generation:  0.4076821804046631
----------------------check_connections_block total spend ----------------------------- 19.463624477386475
generate_one_block  0.6106922626495361
generate_one_block  0.5313100814819336
generate_one_block  0.5322928428649902
generate_one_block  0.5298380851745605
generate_one_block  0.5450983047485352
generate_one_block  0.5297503471374512
generate_one_block  0.516223669052124
generate_one_block  0.5301311016082764
generate_one_block  0.535064697265625
generate_one_block  0.5091216564178467
generate_one_block  0.530116081237793
generate_one_block  0.5196950435638428
generate_one_block  0.5384526252746582
generate_one_block  0.5238513946533203
generate_one_block  0.5339455604553223
generate_one_block  0.522571325302124
generate_one_block  0.5238502025604248
generate_one_block  0.5362715721130371
generate_one_block  0.5164802074432373
generate_one_block  0.5231521129608154
generate_one_block  0.5579922199249268
generate_one_block  0.5262324810028076
generate_one_block  0.5424818992614746
generate_one_block  0.534902811050415
generate_one_block  0.5360012054443359
generate_one_block  0.5277869701385498
generate_one_block  0.5217204093933105
generate_one_block  0.5328083038330078
generate_one_block  0.5345802307128906
generate_one_block  0.514523983001709
generate_one_block  0.5234014987945557
generate_one_block  0.5242178440093994
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017633438110351562  GigaBytes
Max Memory Allocated: 0.0017633438110351562  GigaBytes

connection checking time:  26.499674797058105
block generation total time  23.094156503677368
average batch blocks generation time:  0.7216923907399178
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1737060546875 GB
    Memory Allocated: 0.0850377082824707  GigaBytes
Max Memory Allocated: 0.0850377082824707  GigaBytes

torch.Size([146155, 128])
torch.Size([101521, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.6209716796875 GB
    Memory Allocated: 13.10768985748291  GigaBytes
Max Memory Allocated: 13.12829065322876  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0389404296875 GB
    Memory Allocated: 0.08764410018920898  GigaBytes
Max Memory Allocated: 13.12829065322876  GigaBytes

torch.Size([147025, 128])
torch.Size([102933, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6541748046875 GB
    Memory Allocated: 13.240853786468506  GigaBytes
Max Memory Allocated: 13.257698059082031  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6541748046875 GB
    Memory Allocated: 0.0878448486328125  GigaBytes
Max Memory Allocated: 13.257698059082031  GigaBytes

torch.Size([146460, 128])
torch.Size([102427, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6697998046875 GB
    Memory Allocated: 13.230443954467773  GigaBytes
Max Memory Allocated: 13.257698059082031  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6697998046875 GB
    Memory Allocated: 0.08705854415893555  GigaBytes
Max Memory Allocated: 13.257698059082031  GigaBytes

torch.Size([145750, 128])
torch.Size([102321, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6697998046875 GB
    Memory Allocated: 13.30568552017212  GigaBytes
Max Memory Allocated: 13.324856758117676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6697998046875 GB
    Memory Allocated: 0.08795785903930664  GigaBytes
Max Memory Allocated: 13.324856758117676  GigaBytes

torch.Size([146874, 128])
torch.Size([103756, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.2908935546875 GB
    Memory Allocated: 13.513552188873291  GigaBytes
Max Memory Allocated: 13.53220272064209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.2908935546875 GB
    Memory Allocated: 0.08785247802734375  GigaBytes
Max Memory Allocated: 13.53220272064209  GigaBytes

torch.Size([147353, 128])
torch.Size([103397, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3260498046875 GB
    Memory Allocated: 13.363864421844482  GigaBytes
Max Memory Allocated: 13.53220272064209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3260498046875 GB
    Memory Allocated: 0.08785533905029297  GigaBytes
Max Memory Allocated: 13.53220272064209  GigaBytes

torch.Size([146079, 128])
torch.Size([101518, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3260498046875 GB
    Memory Allocated: 13.200586318969727  GigaBytes
Max Memory Allocated: 13.53220272064209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3260498046875 GB
    Memory Allocated: 0.08759641647338867  GigaBytes
Max Memory Allocated: 13.53220272064209  GigaBytes

torch.Size([146811, 128])
torch.Size([103765, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3397216796875 GB
    Memory Allocated: 13.383094310760498  GigaBytes
Max Memory Allocated: 13.53220272064209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3397216796875 GB
    Memory Allocated: 0.08793020248413086  GigaBytes
Max Memory Allocated: 13.53220272064209  GigaBytes

torch.Size([146272, 128])
torch.Size([102947, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3397216796875 GB
    Memory Allocated: 13.42000675201416  GigaBytes
Max Memory Allocated: 13.53220272064209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3397216796875 GB
    Memory Allocated: 0.08670663833618164  GigaBytes
Max Memory Allocated: 13.53220272064209  GigaBytes

torch.Size([145226, 128])
torch.Size([99788, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3397216796875 GB
    Memory Allocated: 12.88291072845459  GigaBytes
Max Memory Allocated: 13.53220272064209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3397216796875 GB
    Memory Allocated: 0.08784914016723633  GigaBytes
Max Memory Allocated: 13.53220272064209  GigaBytes

torch.Size([146626, 128])
torch.Size([103134, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3553466796875 GB
    Memory Allocated: 13.254682064056396  GigaBytes
Max Memory Allocated: 13.53220272064209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3553466796875 GB
    Memory Allocated: 0.0870065689086914  GigaBytes
Max Memory Allocated: 13.53220272064209  GigaBytes

torch.Size([145765, 128])
torch.Size([101072, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3553466796875 GB
    Memory Allocated: 13.083097457885742  GigaBytes
Max Memory Allocated: 13.53220272064209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3553466796875 GB
    Memory Allocated: 0.087890625  GigaBytes
Max Memory Allocated: 13.53220272064209  GigaBytes

torch.Size([146885, 128])
torch.Size([103607, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3553466796875 GB
    Memory Allocated: 13.37179708480835  GigaBytes
Max Memory Allocated: 13.53220272064209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3553466796875 GB
    Memory Allocated: 0.08733320236206055  GigaBytes
Max Memory Allocated: 13.53220272064209  GigaBytes

torch.Size([146453, 128])
torch.Size([101866, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3553466796875 GB
    Memory Allocated: 13.105201244354248  GigaBytes
Max Memory Allocated: 13.53220272064209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3553466796875 GB
    Memory Allocated: 0.08791637420654297  GigaBytes
Max Memory Allocated: 13.53220272064209  GigaBytes

torch.Size([146530, 128])
torch.Size([103747, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3553466796875 GB
    Memory Allocated: 13.448413372039795  GigaBytes
Max Memory Allocated: 13.53220272064209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3553466796875 GB
    Memory Allocated: 0.08708667755126953  GigaBytes
Max Memory Allocated: 13.53220272064209  GigaBytes

torch.Size([146003, 128])
torch.Size([101026, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3553466796875 GB
    Memory Allocated: 12.987128257751465  GigaBytes
Max Memory Allocated: 13.53220272064209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3553466796875 GB
    Memory Allocated: 0.08782720565795898  GigaBytes
Max Memory Allocated: 13.53220272064209  GigaBytes

torch.Size([146058, 128])
torch.Size([101411, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3553466796875 GB
    Memory Allocated: 13.097508907318115  GigaBytes
Max Memory Allocated: 13.53220272064209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3553466796875 GB
    Memory Allocated: 0.0872960090637207  GigaBytes
Max Memory Allocated: 13.53220272064209  GigaBytes

torch.Size([146083, 128])
torch.Size([103138, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3553466796875 GB
    Memory Allocated: 13.48407506942749  GigaBytes
Max Memory Allocated: 13.53220272064209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3553466796875 GB
    Memory Allocated: 0.0878453254699707  GigaBytes
Max Memory Allocated: 13.53220272064209  GigaBytes

torch.Size([146208, 128])
torch.Size([101592, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3553466796875 GB
    Memory Allocated: 13.12711477279663  GigaBytes
Max Memory Allocated: 13.53220272064209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3553466796875 GB
    Memory Allocated: 0.0872807502746582  GigaBytes
Max Memory Allocated: 13.53220272064209  GigaBytes

torch.Size([146290, 128])
torch.Size([101915, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3553466796875 GB
    Memory Allocated: 13.159101963043213  GigaBytes
Max Memory Allocated: 13.53220272064209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3553466796875 GB
    Memory Allocated: 0.08797693252563477  GigaBytes
Max Memory Allocated: 13.53220272064209  GigaBytes

torch.Size([146872, 128])
torch.Size([104086, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 13.572504043579102  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 0.08732748031616211  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

torch.Size([146421, 128])
torch.Size([101951, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 13.10633659362793  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 0.0879206657409668  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

torch.Size([146606, 128])
torch.Size([103373, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 13.427155017852783  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 0.08708477020263672  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

torch.Size([145883, 128])
torch.Size([102010, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 13.19805908203125  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 0.08787822723388672  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

torch.Size([146874, 128])
torch.Size([103416, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 13.326504230499268  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 0.0872492790222168  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

torch.Size([146184, 128])
torch.Size([101945, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 13.255260944366455  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 0.08783483505249023  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

torch.Size([145841, 128])
torch.Size([101167, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 13.122888565063477  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 0.08731889724731445  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

torch.Size([146315, 128])
torch.Size([102846, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 13.309210300445557  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 0.08786487579345703  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

torch.Size([146655, 128])
torch.Size([103095, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 13.265022277832031  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 0.08704519271850586  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

torch.Size([145855, 128])
torch.Size([101028, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 13.045977115631104  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 0.08782339096069336  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

torch.Size([146533, 128])
torch.Size([102758, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 13.172805309295654  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 0.08730649948120117  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

torch.Size([146302, 128])
torch.Size([102066, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 13.245756149291992  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.033784545958042145 |0.029427900910377502 |0.41220589727163315 |0.00010616332292556763 |0.668517179787159 |0.012184858322143555 |
----------------------------------------------------------pseudo_mini_loss sum 4.999636650085449
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  8800040
Number of first layer input nodes during this epoch:  4683247
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 0.10948562622070312  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023596763610839844
range selection method range initialization spend 0.01415395736694336
time for parepare:  0.018046855926513672
local_output_nid generation:  0.0009107589721679688
local_in_edges_tensor generation:  0.003773927688598633
mini_batch_src_global generation:  0.0017261505126953125
r_  generation:  0.010551691055297852
local_output_nid generation:  0.0009789466857910156
local_in_edges_tensor generation:  0.0006995201110839844
mini_batch_src_global generation:  0.001695871353149414
r_  generation:  0.010786771774291992
local_output_nid generation:  0.0009462833404541016
local_in_edges_tensor generation:  0.0006320476531982422
mini_batch_src_global generation:  0.0011532306671142578
r_  generation:  0.010089397430419922
local_output_nid generation:  0.0009124279022216797
local_in_edges_tensor generation:  0.0005831718444824219
mini_batch_src_global generation:  0.0010628700256347656
r_  generation:  0.009447336196899414
local_output_nid generation:  0.0008804798126220703
local_in_edges_tensor generation:  0.0005848407745361328
mini_batch_src_global generation:  0.0011072158813476562
r_  generation:  0.009818553924560547
local_output_nid generation:  0.0008885860443115234
local_in_edges_tensor generation:  0.0005927085876464844
mini_batch_src_global generation:  0.001140594482421875
r_  generation:  0.010718822479248047
local_output_nid generation:  0.0008966922760009766
local_in_edges_tensor generation:  0.0005786418914794922
mini_batch_src_global generation:  0.0011134147644042969
r_  generation:  0.009911298751831055
local_output_nid generation:  0.0008649826049804688
local_in_edges_tensor generation:  0.0005793571472167969
mini_batch_src_global generation:  0.0011143684387207031
r_  generation:  0.009901762008666992
local_output_nid generation:  0.0008733272552490234
local_in_edges_tensor generation:  0.0005664825439453125
mini_batch_src_global generation:  0.001096963882446289
r_  generation:  0.01013803482055664
local_output_nid generation:  0.0008673667907714844
local_in_edges_tensor generation:  0.0005564689636230469
mini_batch_src_global generation:  0.001115560531616211
r_  generation:  0.010125398635864258
local_output_nid generation:  0.0009198188781738281
local_in_edges_tensor generation:  0.0005817413330078125
mini_batch_src_global generation:  0.0010952949523925781
r_  generation:  0.01052093505859375
local_output_nid generation:  0.0008678436279296875
local_in_edges_tensor generation:  0.0005939006805419922
mini_batch_src_global generation:  0.0010838508605957031
r_  generation:  0.009791851043701172
local_output_nid generation:  0.000904083251953125
local_in_edges_tensor generation:  0.0005581378936767578
mini_batch_src_global generation:  0.0012333393096923828
r_  generation:  0.00996255874633789
local_output_nid generation:  0.0008680820465087891
local_in_edges_tensor generation:  0.0005533695220947266
mini_batch_src_global generation:  0.001074075698852539
r_  generation:  0.01026606559753418
local_output_nid generation:  0.0009167194366455078
local_in_edges_tensor generation:  0.0005805492401123047
mini_batch_src_global generation:  0.0012695789337158203
r_  generation:  0.010750055313110352
local_output_nid generation:  0.00086212158203125
local_in_edges_tensor generation:  0.0005879402160644531
mini_batch_src_global generation:  0.001194000244140625
r_  generation:  0.010365009307861328
local_output_nid generation:  0.0008604526519775391
local_in_edges_tensor generation:  0.0005700588226318359
mini_batch_src_global generation:  0.0012054443359375
r_  generation:  0.010401487350463867
local_output_nid generation:  0.0008678436279296875
local_in_edges_tensor generation:  0.0005469322204589844
mini_batch_src_global generation:  0.0011069774627685547
r_  generation:  0.01044321060180664
local_output_nid generation:  0.000873565673828125
local_in_edges_tensor generation:  0.0005636215209960938
mini_batch_src_global generation:  0.00116729736328125
r_  generation:  0.009972572326660156
local_output_nid generation:  0.0008599758148193359
local_in_edges_tensor generation:  0.0005688667297363281
mini_batch_src_global generation:  0.0011205673217773438
r_  generation:  0.010503530502319336
local_output_nid generation:  0.0008718967437744141
local_in_edges_tensor generation:  0.0005586147308349609
mini_batch_src_global generation:  0.0011494159698486328
r_  generation:  0.010299921035766602
local_output_nid generation:  0.0008518695831298828
local_in_edges_tensor generation:  0.0005762577056884766
mini_batch_src_global generation:  0.0010759830474853516
r_  generation:  0.010079622268676758
local_output_nid generation:  0.0008642673492431641
local_in_edges_tensor generation:  0.0005424022674560547
mini_batch_src_global generation:  0.0011143684387207031
r_  generation:  0.010169506072998047
local_output_nid generation:  0.0008625984191894531
local_in_edges_tensor generation:  0.0005688667297363281
mini_batch_src_global generation:  0.0010895729064941406
r_  generation:  0.010274648666381836
local_output_nid generation:  0.002441883087158203
local_in_edges_tensor generation:  0.0005965232849121094
mini_batch_src_global generation:  0.0012052059173583984
r_  generation:  0.01053476333618164
local_output_nid generation:  0.0008656978607177734
local_in_edges_tensor generation:  0.0005698204040527344
mini_batch_src_global generation:  0.0012054443359375
r_  generation:  0.01033926010131836
local_output_nid generation:  0.0008704662322998047
local_in_edges_tensor generation:  0.0005633831024169922
mini_batch_src_global generation:  0.0011341571807861328
r_  generation:  0.010431051254272461
local_output_nid generation:  0.0008690357208251953
local_in_edges_tensor generation:  0.0005393028259277344
mini_batch_src_global generation:  0.0011501312255859375
r_  generation:  0.010125398635864258
local_output_nid generation:  0.0008594989776611328
local_in_edges_tensor generation:  0.0005447864532470703
mini_batch_src_global generation:  0.0010988712310791016
r_  generation:  0.010406017303466797
local_output_nid generation:  0.0008640289306640625
local_in_edges_tensor generation:  0.0005526542663574219
mini_batch_src_global generation:  0.0011796951293945312
r_  generation:  0.01020050048828125
local_output_nid generation:  0.0008745193481445312
local_in_edges_tensor generation:  0.0005633831024169922
mini_batch_src_global generation:  0.0011434555053710938
r_  generation:  0.010159730911254883
local_output_nid generation:  0.0008726119995117188
local_in_edges_tensor generation:  0.0005521774291992188
mini_batch_src_global generation:  0.0011425018310546875
r_  generation:  0.010233640670776367
----------------------check_connections_block total spend ----------------------------- 0.5140218734741211
generate_one_block  0.03292131423950195
generate_one_block  0.020008563995361328
generate_one_block  0.018523693084716797
generate_one_block  0.017076492309570312
generate_one_block  0.017963647842407227
generate_one_block  0.018590450286865234
generate_one_block  0.01732492446899414
generate_one_block  0.01711893081665039
generate_one_block  0.017604351043701172
generate_one_block  0.017182350158691406
generate_one_block  0.017589569091796875
generate_one_block  0.01689624786376953
generate_one_block  0.016857624053955078
generate_one_block  0.01751089096069336
generate_one_block  0.01830577850341797
generate_one_block  0.017425537109375
generate_one_block  0.017647266387939453
generate_one_block  0.017315149307250977
generate_one_block  0.017076969146728516
generate_one_block  0.017781972885131836
generate_one_block  0.01723647117614746
generate_one_block  0.016806364059448242
generate_one_block  0.017368078231811523
generate_one_block  0.017381668090820312
generate_one_block  0.017660856246948242
generate_one_block  0.017072200775146484
generate_one_block  0.0176999568939209
generate_one_block  0.01717376708984375
generate_one_block  0.017447710037231445
generate_one_block  0.017376422882080078
generate_one_block  0.01705622673034668
generate_one_block  0.01725459098815918
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03361940383911133
gen group dst list time:  0.02187633514404297
time for parepare:  0.019118785858154297
local_output_nid generation:  0.005110979080200195
local_in_edges_tensor generation:  0.013108968734741211
mini_batch_src_global generation:  0.013005495071411133
r_  generation:  0.13355183601379395
local_output_nid generation:  0.0077130794525146484
local_in_edges_tensor generation:  0.011127948760986328
mini_batch_src_global generation:  0.017110824584960938
r_  generation:  0.14188122749328613
local_output_nid generation:  0.007778167724609375
local_in_edges_tensor generation:  0.028133630752563477
mini_batch_src_global generation:  0.01653432846069336
r_  generation:  0.14780044555664062
local_output_nid generation:  0.00780034065246582
local_in_edges_tensor generation:  0.0076177120208740234
mini_batch_src_global generation:  0.0163271427154541
r_  generation:  0.14054322242736816
local_output_nid generation:  0.008493900299072266
local_in_edges_tensor generation:  0.008719682693481445
mini_batch_src_global generation:  0.018503427505493164
r_  generation:  0.1515505313873291
local_output_nid generation:  0.00894784927368164
local_in_edges_tensor generation:  0.010850906372070312
mini_batch_src_global generation:  0.01963496208190918
r_  generation:  0.1569211483001709
local_output_nid generation:  0.008527517318725586
local_in_edges_tensor generation:  0.008083105087280273
mini_batch_src_global generation:  0.01839923858642578
r_  generation:  0.15087676048278809
local_output_nid generation:  0.008188247680664062
local_in_edges_tensor generation:  0.009273290634155273
mini_batch_src_global generation:  0.018032312393188477
r_  generation:  0.1513991355895996
local_output_nid generation:  0.008343935012817383
local_in_edges_tensor generation:  0.008457183837890625
mini_batch_src_global generation:  0.019390344619750977
r_  generation:  0.15099501609802246
local_output_nid generation:  0.008494853973388672
local_in_edges_tensor generation:  0.010788440704345703
mini_batch_src_global generation:  0.01829242706298828
r_  generation:  0.15000414848327637
local_output_nid generation:  0.008841753005981445
local_in_edges_tensor generation:  0.00949716567993164
mini_batch_src_global generation:  0.0185239315032959
r_  generation:  0.15457868576049805
local_output_nid generation:  0.008452892303466797
local_in_edges_tensor generation:  0.007922172546386719
mini_batch_src_global generation:  0.0209352970123291
r_  generation:  0.14667439460754395
local_output_nid generation:  0.008720874786376953
local_in_edges_tensor generation:  0.008171319961547852
mini_batch_src_global generation:  0.01864314079284668
r_  generation:  0.14990830421447754
local_output_nid generation:  0.008942842483520508
local_in_edges_tensor generation:  0.010974407196044922
mini_batch_src_global generation:  0.0200960636138916
r_  generation:  0.15661048889160156
local_output_nid generation:  0.009186029434204102
local_in_edges_tensor generation:  0.011052608489990234
mini_batch_src_global generation:  0.023166418075561523
r_  generation:  0.1634209156036377
local_output_nid generation:  0.00879669189453125
local_in_edges_tensor generation:  0.008309125900268555
mini_batch_src_global generation:  0.01859140396118164
r_  generation:  0.15231919288635254
local_output_nid generation:  0.009084224700927734
local_in_edges_tensor generation:  0.008817911148071289
mini_batch_src_global generation:  0.018790721893310547
r_  generation:  0.15532135963439941
local_output_nid generation:  0.008941650390625
local_in_edges_tensor generation:  0.008419036865234375
mini_batch_src_global generation:  0.022579669952392578
r_  generation:  0.15461349487304688
local_output_nid generation:  0.008519172668457031
local_in_edges_tensor generation:  0.010734796524047852
mini_batch_src_global generation:  0.019657135009765625
r_  generation:  0.15840458869934082
local_output_nid generation:  0.008525371551513672
local_in_edges_tensor generation:  0.0109710693359375
mini_batch_src_global generation:  0.019727468490600586
r_  generation:  0.15964889526367188
local_output_nid generation:  0.008640289306640625
local_in_edges_tensor generation:  0.008849382400512695
mini_batch_src_global generation:  0.023059844970703125
r_  generation:  0.15814900398254395
local_output_nid generation:  0.00932002067565918
local_in_edges_tensor generation:  0.011321544647216797
mini_batch_src_global generation:  0.027895212173461914
r_  generation:  0.1518700122833252
local_output_nid generation:  0.008516073226928711
local_in_edges_tensor generation:  0.013692140579223633
mini_batch_src_global generation:  0.022511005401611328
r_  generation:  0.1572408676147461
local_output_nid generation:  0.009942293167114258
local_in_edges_tensor generation:  0.009968280792236328
mini_batch_src_global generation:  0.018929481506347656
r_  generation:  0.1551074981689453
local_output_nid generation:  0.009160995483398438
local_in_edges_tensor generation:  0.011763572692871094
mini_batch_src_global generation:  0.018895626068115234
r_  generation:  0.16117000579833984
local_output_nid generation:  0.0087432861328125
local_in_edges_tensor generation:  0.00956869125366211
mini_batch_src_global generation:  0.022203683853149414
r_  generation:  0.15271830558776855
local_output_nid generation:  0.009058237075805664
local_in_edges_tensor generation:  0.009019136428833008
mini_batch_src_global generation:  0.019027233123779297
r_  generation:  0.1596059799194336
local_output_nid generation:  0.00887918472290039
local_in_edges_tensor generation:  0.008739233016967773
mini_batch_src_global generation:  0.01865386962890625
r_  generation:  0.15478134155273438
local_output_nid generation:  0.0090484619140625
local_in_edges_tensor generation:  0.010673761367797852
mini_batch_src_global generation:  0.01886606216430664
r_  generation:  0.15804433822631836
local_output_nid generation:  0.008892059326171875
local_in_edges_tensor generation:  0.011198282241821289
mini_batch_src_global generation:  0.021555423736572266
r_  generation:  0.15669655799865723
local_output_nid generation:  0.00869131088256836
local_in_edges_tensor generation:  0.00868988037109375
mini_batch_src_global generation:  0.03372073173522949
r_  generation:  0.15372943878173828
local_output_nid generation:  0.00874781608581543
local_in_edges_tensor generation:  0.008663415908813477
mini_batch_src_global generation:  0.021526813507080078
r_  generation:  0.15328311920166016
----------------------check_connections_block total spend ----------------------------- 7.316041946411133
generate_one_block  0.20892572402954102
generate_one_block  0.20051050186157227
generate_one_block  0.20636415481567383
generate_one_block  0.1874990463256836
generate_one_block  0.2318861484527588
generate_one_block  0.2187495231628418
generate_one_block  0.2036426067352295
generate_one_block  0.2006852626800537
generate_one_block  0.20474648475646973
generate_one_block  0.19769001007080078
generate_one_block  0.20432829856872559
generate_one_block  0.1892082691192627
generate_one_block  0.1938791275024414
generate_one_block  0.20861458778381348
generate_one_block  0.21538782119750977
generate_one_block  0.19489431381225586
generate_one_block  0.1964409351348877
generate_one_block  0.1976327896118164
generate_one_block  0.19653773307800293
generate_one_block  0.20644736289978027
generate_one_block  0.20363259315490723
generate_one_block  0.19011950492858887
generate_one_block  0.20297932624816895
generate_one_block  0.20000433921813965
generate_one_block  0.21165680885314941
generate_one_block  0.1939682960510254
generate_one_block  0.2025587558746338
generate_one_block  0.19759869575500488
generate_one_block  0.20072126388549805
generate_one_block  0.20478606224060059
generate_one_block  0.19651412963867188
generate_one_block  0.1973106861114502
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04646039009094238
gen group dst list time:  0.10329961776733398
time for parepare:  0.017680883407592773
local_output_nid generation:  0.023257732391357422
local_in_edges_tensor generation:  0.05359077453613281
mini_batch_src_global generation:  0.04311800003051758
r_  generation:  0.39564061164855957
local_output_nid generation:  0.028286218643188477
local_in_edges_tensor generation:  0.04103279113769531
mini_batch_src_global generation:  0.04867982864379883
r_  generation:  0.4020395278930664
local_output_nid generation:  0.027614355087280273
local_in_edges_tensor generation:  0.03419303894042969
mini_batch_src_global generation:  0.04574847221374512
r_  generation:  0.40427064895629883
local_output_nid generation:  0.02669072151184082
local_in_edges_tensor generation:  0.026658058166503906
mini_batch_src_global generation:  0.046566009521484375
r_  generation:  0.3976259231567383
local_output_nid generation:  0.027110815048217773
local_in_edges_tensor generation:  0.030437231063842773
mini_batch_src_global generation:  0.04764986038208008
r_  generation:  0.41523218154907227
local_output_nid generation:  0.027091503143310547
local_in_edges_tensor generation:  0.030773401260375977
mini_batch_src_global generation:  0.0503537654876709
r_  generation:  0.41062498092651367
local_output_nid generation:  0.026886940002441406
local_in_edges_tensor generation:  0.03404831886291504
mini_batch_src_global generation:  0.04812288284301758
r_  generation:  0.4092442989349365
local_output_nid generation:  0.026641130447387695
local_in_edges_tensor generation:  0.030694007873535156
mini_batch_src_global generation:  0.04874777793884277
r_  generation:  0.4070618152618408
local_output_nid generation:  0.027055978775024414
local_in_edges_tensor generation:  0.03415846824645996
mini_batch_src_global generation:  0.048540353775024414
r_  generation:  0.41237306594848633
local_output_nid generation:  0.026934385299682617
local_in_edges_tensor generation:  0.033193349838256836
mini_batch_src_global generation:  0.04865694046020508
r_  generation:  0.4057490825653076
local_output_nid generation:  0.0269317626953125
local_in_edges_tensor generation:  0.030244112014770508
mini_batch_src_global generation:  0.04822683334350586
r_  generation:  0.407930850982666
local_output_nid generation:  0.026563405990600586
local_in_edges_tensor generation:  0.03036212921142578
mini_batch_src_global generation:  0.04811811447143555
r_  generation:  0.3985157012939453
local_output_nid generation:  0.026968002319335938
local_in_edges_tensor generation:  0.034032583236694336
mini_batch_src_global generation:  0.04828166961669922
r_  generation:  0.40790557861328125
local_output_nid generation:  0.027153968811035156
local_in_edges_tensor generation:  0.030110836029052734
mini_batch_src_global generation:  0.051294565200805664
r_  generation:  0.4092988967895508
local_output_nid generation:  0.02753615379333496
local_in_edges_tensor generation:  0.035400390625
mini_batch_src_global generation:  0.048360347747802734
r_  generation:  0.41367292404174805
local_output_nid generation:  0.02741241455078125
local_in_edges_tensor generation:  0.03040289878845215
mini_batch_src_global generation:  0.049120426177978516
r_  generation:  0.4097473621368408
local_output_nid generation:  0.02852916717529297
local_in_edges_tensor generation:  0.03138232231140137
mini_batch_src_global generation:  0.05153989791870117
r_  generation:  0.41240572929382324
local_output_nid generation:  0.02726578712463379
local_in_edges_tensor generation:  0.030831575393676758
mini_batch_src_global generation:  0.0492863655090332
r_  generation:  0.4126758575439453
local_output_nid generation:  0.027355670928955078
local_in_edges_tensor generation:  0.030713796615600586
mini_batch_src_global generation:  0.04809236526489258
r_  generation:  0.4092717170715332
local_output_nid generation:  0.027729034423828125
local_in_edges_tensor generation:  0.03398561477661133
mini_batch_src_global generation:  0.04870319366455078
r_  generation:  0.4181523323059082
local_output_nid generation:  0.02764749526977539
local_in_edges_tensor generation:  0.03835415840148926
mini_batch_src_global generation:  0.05438423156738281
r_  generation:  0.41074371337890625
local_output_nid generation:  0.027296066284179688
local_in_edges_tensor generation:  0.033028602600097656
mini_batch_src_global generation:  0.04932355880737305
r_  generation:  0.40330028533935547
local_output_nid generation:  0.02744007110595703
local_in_edges_tensor generation:  0.027816057205200195
mini_batch_src_global generation:  0.048293113708496094
r_  generation:  0.4100518226623535
local_output_nid generation:  0.02748584747314453
local_in_edges_tensor generation:  0.03740382194519043
mini_batch_src_global generation:  0.0483555793762207
r_  generation:  0.41699767112731934
local_output_nid generation:  0.029204368591308594
local_in_edges_tensor generation:  0.030841350555419922
mini_batch_src_global generation:  0.051403045654296875
r_  generation:  0.4136488437652588
local_output_nid generation:  0.027782440185546875
local_in_edges_tensor generation:  0.027875900268554688
mini_batch_src_global generation:  0.0487523078918457
r_  generation:  0.40506935119628906
local_output_nid generation:  0.027932167053222656
local_in_edges_tensor generation:  0.03093409538269043
mini_batch_src_global generation:  0.050978660583496094
r_  generation:  0.4125089645385742
local_output_nid generation:  0.028048992156982422
local_in_edges_tensor generation:  0.03496050834655762
mini_batch_src_global generation:  0.04873204231262207
r_  generation:  0.40801000595092773
local_output_nid generation:  0.02814960479736328
local_in_edges_tensor generation:  0.02702951431274414
mini_batch_src_global generation:  0.04860734939575195
r_  generation:  0.409686803817749
local_output_nid generation:  0.0281524658203125
local_in_edges_tensor generation:  0.030907630920410156
mini_batch_src_global generation:  0.04915213584899902
r_  generation:  0.40750646591186523
local_output_nid generation:  0.027687549591064453
local_in_edges_tensor generation:  0.027399301528930664
mini_batch_src_global generation:  0.048662424087524414
r_  generation:  0.40708065032958984
local_output_nid generation:  0.028087615966796875
local_in_edges_tensor generation:  0.03387093544006348
mini_batch_src_global generation:  0.0488278865814209
r_  generation:  0.4119696617126465
----------------------check_connections_block total spend ----------------------------- 19.436677932739258
generate_one_block  0.5470867156982422
generate_one_block  0.5828208923339844
generate_one_block  0.5478835105895996
generate_one_block  0.5334267616271973
generate_one_block  0.6535577774047852
generate_one_block  0.5566167831420898
generate_one_block  0.547163724899292
generate_one_block  0.5364787578582764
generate_one_block  0.5494675636291504
generate_one_block  0.5337743759155273
generate_one_block  0.5442295074462891
generate_one_block  0.530428409576416
generate_one_block  0.5427165031433105
generate_one_block  0.5539975166320801
generate_one_block  0.5636022090911865
generate_one_block  0.5384082794189453
generate_one_block  0.597625732421875
generate_one_block  0.5479960441589355
generate_one_block  0.5428431034088135
generate_one_block  0.5657711029052734
generate_one_block  0.580543041229248
generate_one_block  0.5545005798339844
generate_one_block  0.557157039642334
generate_one_block  0.5528738498687744
generate_one_block  0.5823268890380859
generate_one_block  0.5540297031402588
generate_one_block  0.560675859451294
generate_one_block  0.5577168464660645
generate_one_block  0.5582921504974365
generate_one_block  0.5698482990264893
generate_one_block  0.5544731616973877
generate_one_block  0.5585460662841797
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 0.10948562622070312  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

connection checking time:  26.75271987915039
block generation total time  24.322799921035767
average batch blocks generation time:  0.7600874975323677
block dataloader generation time/epoch 54.2711443901062
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 0.09134387969970703  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

torch.Size([145879, 128])
torch.Size([101663, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 13.125439167022705  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 0.0910654067993164  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

torch.Size([146801, 128])
torch.Size([103471, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 13.267138004302979  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 0.09143829345703125  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

torch.Size([146000, 128])
torch.Size([102288, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 13.327980995178223  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 0.09084558486938477  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

torch.Size([146548, 128])
torch.Size([101668, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 12.94523286819458  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 0.09141397476196289  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

torch.Size([146622, 128])
torch.Size([103464, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 13.411727905273438  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 0.09117507934570312  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

torch.Size([146800, 128])
torch.Size([103659, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 13.514105319976807  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 0.0913701057434082  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

torch.Size([146684, 128])
torch.Size([102780, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 13.27536916732788  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 0.09057950973510742  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

torch.Size([145865, 128])
torch.Size([101606, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 13.12219524383545  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 0.09137487411499023  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

torch.Size([146632, 128])
torch.Size([102961, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 13.260344982147217  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 0.09087657928466797  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

torch.Size([146457, 128])
torch.Size([102021, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 13.126503944396973  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 0.09141683578491211  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

torch.Size([146111, 128])
torch.Size([101841, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 13.308752536773682  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 0.09023714065551758  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

torch.Size([145270, 128])
torch.Size([99903, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 12.870450019836426  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 0.0913243293762207  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

torch.Size([146035, 128])
torch.Size([100956, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 13.059848308563232  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 0.09067344665527344  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

torch.Size([145877, 128])
torch.Size([102313, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 13.369560718536377  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3572998046875 GB
    Memory Allocated: 0.09150314331054688  GigaBytes
Max Memory Allocated: 13.590878009796143  GigaBytes

torch.Size([146168, 128])
torch.Size([103428, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3709716796875 GB
    Memory Allocated: 13.584382057189941  GigaBytes
Max Memory Allocated: 13.607642650604248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3709716796875 GB
    Memory Allocated: 0.09081172943115234  GigaBytes
Max Memory Allocated: 13.607642650604248  GigaBytes

torch.Size([146290, 128])
torch.Size([102014, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3709716796875 GB
    Memory Allocated: 13.229211330413818  GigaBytes
Max Memory Allocated: 13.607642650604248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3709716796875 GB
    Memory Allocated: 0.0913848876953125  GigaBytes
Max Memory Allocated: 13.607642650604248  GigaBytes

torch.Size([146737, 128])
torch.Size([103662, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3709716796875 GB
    Memory Allocated: 13.31160306930542  GigaBytes
Max Memory Allocated: 13.607642650604248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3709716796875 GB
    Memory Allocated: 0.0905461311340332  GigaBytes
Max Memory Allocated: 13.607642650604248  GigaBytes

torch.Size([145692, 128])
torch.Size([101742, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3709716796875 GB
    Memory Allocated: 13.240169525146484  GigaBytes
Max Memory Allocated: 13.607642650604248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3709716796875 GB
    Memory Allocated: 0.09136533737182617  GigaBytes
Max Memory Allocated: 13.607642650604248  GigaBytes

torch.Size([146098, 128])
torch.Size([101631, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3709716796875 GB
    Memory Allocated: 13.179090976715088  GigaBytes
Max Memory Allocated: 13.607642650604248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3709716796875 GB
    Memory Allocated: 0.0909566879272461  GigaBytes
Max Memory Allocated: 13.607642650604248  GigaBytes

torch.Size([146507, 128])
torch.Size([102613, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3709716796875 GB
    Memory Allocated: 13.3003830909729  GigaBytes
Max Memory Allocated: 13.607642650604248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3709716796875 GB
    Memory Allocated: 0.09140300750732422  GigaBytes
Max Memory Allocated: 13.607642650604248  GigaBytes

torch.Size([146236, 128])
torch.Size([102127, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3709716796875 GB
    Memory Allocated: 13.273552417755127  GigaBytes
Max Memory Allocated: 13.607642650604248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3709716796875 GB
    Memory Allocated: 0.09051752090454102  GigaBytes
Max Memory Allocated: 13.607642650604248  GigaBytes

torch.Size([145792, 128])
torch.Size([100481, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3709716796875 GB
    Memory Allocated: 12.935271263122559  GigaBytes
Max Memory Allocated: 13.607642650604248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3709716796875 GB
    Memory Allocated: 0.09137439727783203  GigaBytes
Max Memory Allocated: 13.607642650604248  GigaBytes

torch.Size([146182, 128])
torch.Size([102299, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3709716796875 GB
    Memory Allocated: 13.213309288024902  GigaBytes
Max Memory Allocated: 13.607642650604248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3709716796875 GB
    Memory Allocated: 0.0908660888671875  GigaBytes
Max Memory Allocated: 13.607642650604248  GigaBytes

torch.Size([146387, 128])
torch.Size([102339, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3709716796875 GB
    Memory Allocated: 13.198488712310791  GigaBytes
Max Memory Allocated: 13.607642650604248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3709716796875 GB
    Memory Allocated: 0.09142923355102539  GigaBytes
Max Memory Allocated: 13.607642650604248  GigaBytes

torch.Size([146866, 128])
torch.Size([103554, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3709716796875 GB
    Memory Allocated: 13.398594856262207  GigaBytes
Max Memory Allocated: 13.607642650604248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3709716796875 GB
    Memory Allocated: 0.0906224250793457  GigaBytes
Max Memory Allocated: 13.607642650604248  GigaBytes

torch.Size([145931, 128])
torch.Size([101732, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3709716796875 GB
    Memory Allocated: 13.152597427368164  GigaBytes
Max Memory Allocated: 13.607642650604248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3709716796875 GB
    Memory Allocated: 0.09142160415649414  GigaBytes
Max Memory Allocated: 13.607642650604248  GigaBytes

torch.Size([146181, 128])
torch.Size([102462, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3709716796875 GB
    Memory Allocated: 13.379537582397461  GigaBytes
Max Memory Allocated: 13.607642650604248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3709716796875 GB
    Memory Allocated: 0.09100675582885742  GigaBytes
Max Memory Allocated: 13.607642650604248  GigaBytes

torch.Size([146710, 128])
torch.Size([102492, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3709716796875 GB
    Memory Allocated: 13.192923069000244  GigaBytes
Max Memory Allocated: 13.607642650604248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3709716796875 GB
    Memory Allocated: 0.09139728546142578  GigaBytes
Max Memory Allocated: 13.607642650604248  GigaBytes

torch.Size([145938, 128])
torch.Size([102291, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3709716796875 GB
    Memory Allocated: 13.255589008331299  GigaBytes
Max Memory Allocated: 13.607642650604248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3709716796875 GB
    Memory Allocated: 0.09078359603881836  GigaBytes
Max Memory Allocated: 13.607642650604248  GigaBytes

torch.Size([146163, 128])
torch.Size([102402, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3709716796875 GB
    Memory Allocated: 13.280866146087646  GigaBytes
Max Memory Allocated: 13.607642650604248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3709716796875 GB
    Memory Allocated: 0.09134435653686523  GigaBytes
Max Memory Allocated: 13.607642650604248  GigaBytes

torch.Size([146034, 128])
torch.Size([101504, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3709716796875 GB
    Memory Allocated: 13.10500431060791  GigaBytes
Max Memory Allocated: 13.607642650604248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3709716796875 GB
    Memory Allocated: 0.09067440032958984  GigaBytes
Max Memory Allocated: 13.607642650604248  GigaBytes

torch.Size([145989, 128])
torch.Size([102011, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3709716796875 GB
    Memory Allocated: 13.207565784454346  GigaBytes
Max Memory Allocated: 13.607642650604248  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.026823215186595917 |0.01629512757062912 |0.3921153098344803 |9.837746620178223e-05 |0.6642165035009384 |0.006673574447631836 |
----------------------------------------------------------pseudo_mini_loss sum 3.308943271636963
Total (block generation + training)time/epoch 89.51098585128784
Training time/epoch 35.23959255218506
Training time without block to device /epoch 34.71814846992493
Training time without total dataloading part /epoch 33.81243968009949
load block tensor time/epoch 0.8583428859710693
block to device time/epoch 0.5214440822601318
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  8790454
Number of first layer input nodes during this epoch:  4679482
