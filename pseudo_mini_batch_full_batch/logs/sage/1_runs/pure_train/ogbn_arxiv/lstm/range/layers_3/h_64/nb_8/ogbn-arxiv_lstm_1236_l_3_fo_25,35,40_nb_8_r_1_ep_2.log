Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648468986.7205372
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025180578231811523
range selection method range initialization spend 0.013817787170410156
time for parepare:  0.017582178115844727
local_output_nid generation:  0.0026085376739501953
local_in_edges_tensor generation:  0.0045223236083984375
mini_batch_src_global generation:  0.0033257007598876953
r_  generation:  0.03738880157470703
local_output_nid generation:  0.003062725067138672
local_in_edges_tensor generation:  0.0016217231750488281
mini_batch_src_global generation:  0.004163265228271484
r_  generation:  0.03852725028991699
local_output_nid generation:  0.0031075477600097656
local_in_edges_tensor generation:  0.0016171932220458984
mini_batch_src_global generation:  0.002933979034423828
r_  generation:  0.039453744888305664
local_output_nid generation:  0.0030939579010009766
local_in_edges_tensor generation:  0.0016350746154785156
mini_batch_src_global generation:  0.0030062198638916016
r_  generation:  0.0399172306060791
local_output_nid generation:  0.003110647201538086
local_in_edges_tensor generation:  0.0016238689422607422
mini_batch_src_global generation:  0.0030670166015625
r_  generation:  0.04087090492248535
local_output_nid generation:  0.0031044483184814453
local_in_edges_tensor generation:  0.0016143321990966797
mini_batch_src_global generation:  0.0032215118408203125
r_  generation:  0.04073333740234375
local_output_nid generation:  0.0031647682189941406
local_in_edges_tensor generation:  0.0016160011291503906
mini_batch_src_global generation:  0.003211498260498047
r_  generation:  0.041335344314575195
local_output_nid generation:  0.003136157989501953
local_in_edges_tensor generation:  0.0016710758209228516
mini_batch_src_global generation:  0.003370523452758789
r_  generation:  0.04175829887390137
----------------------check_connections_block total spend ----------------------------- 0.47191286087036133
generate_one_block  0.05391073226928711
generate_one_block  0.054068803787231445
generate_one_block  0.05555558204650879
generate_one_block  0.05452847480773926
generate_one_block  0.05794954299926758
generate_one_block  0.05634593963623047
generate_one_block  0.05677223205566406
generate_one_block  0.058458805084228516
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03976106643676758
gen group dst list time:  0.015280485153198242
time for parepare:  0.019477367401123047
local_output_nid generation:  0.010379314422607422
local_in_edges_tensor generation:  0.02837347984313965
mini_batch_src_global generation:  0.030294179916381836
r_  generation:  0.29676103591918945
local_output_nid generation:  0.015666723251342773
local_in_edges_tensor generation:  0.026625394821166992
mini_batch_src_global generation:  0.034575700759887695
r_  generation:  0.29383063316345215
local_output_nid generation:  0.015668153762817383
local_in_edges_tensor generation:  0.01912975311279297
mini_batch_src_global generation:  0.040091514587402344
r_  generation:  0.30246853828430176
local_output_nid generation:  0.016118288040161133
local_in_edges_tensor generation:  0.024647951126098633
mini_batch_src_global generation:  0.035129547119140625
r_  generation:  0.30455780029296875
local_output_nid generation:  0.016370296478271484
local_in_edges_tensor generation:  0.021937847137451172
mini_batch_src_global generation:  0.03573417663574219
r_  generation:  0.3060760498046875
local_output_nid generation:  0.016497135162353516
local_in_edges_tensor generation:  0.01707005500793457
mini_batch_src_global generation:  0.03912639617919922
r_  generation:  0.3104987144470215
local_output_nid generation:  0.016689538955688477
local_in_edges_tensor generation:  0.022728919982910156
mini_batch_src_global generation:  0.03887152671813965
r_  generation:  0.30912280082702637
local_output_nid generation:  0.016750335693359375
local_in_edges_tensor generation:  0.019932031631469727
mini_batch_src_global generation:  0.03755068778991699
r_  generation:  0.31442737579345703
----------------------check_connections_block total spend ----------------------------- 3.57711124420166
generate_one_block  0.3934152126312256
generate_one_block  0.3813059329986572
generate_one_block  0.391582727432251
generate_one_block  0.40268707275390625
generate_one_block  0.42406702041625977
generate_one_block  0.42102718353271484
generate_one_block  0.4038426876068115
generate_one_block  0.40830254554748535
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0851602554321289
gen group dst list time:  0.03666520118713379
time for parepare:  0.02067875862121582
local_output_nid generation:  0.026073932647705078
local_in_edges_tensor generation:  0.06731557846069336
mini_batch_src_global generation:  0.046622276306152344
r_  generation:  0.471163272857666
local_output_nid generation:  0.0336606502532959
local_in_edges_tensor generation:  0.049057960510253906
mini_batch_src_global generation:  0.052963972091674805
r_  generation:  0.49565625190734863
local_output_nid generation:  0.03209376335144043
local_in_edges_tensor generation:  0.03582143783569336
mini_batch_src_global generation:  0.05069684982299805
r_  generation:  0.500006914138794
local_output_nid generation:  0.03397965431213379
local_in_edges_tensor generation:  0.05178523063659668
mini_batch_src_global generation:  0.06969189643859863
r_  generation:  0.4845263957977295
local_output_nid generation:  0.034601449966430664
local_in_edges_tensor generation:  0.038311004638671875
mini_batch_src_global generation:  0.052536964416503906
r_  generation:  0.4940185546875
local_output_nid generation:  0.034226417541503906
local_in_edges_tensor generation:  0.044808387756347656
mini_batch_src_global generation:  0.054462432861328125
r_  generation:  0.4863474369049072
local_output_nid generation:  0.03413057327270508
local_in_edges_tensor generation:  0.03676724433898926
mini_batch_src_global generation:  0.05310559272766113
r_  generation:  0.4983348846435547
local_output_nid generation:  0.03422904014587402
local_in_edges_tensor generation:  0.036605119705200195
mini_batch_src_global generation:  0.05832076072692871
r_  generation:  0.4889030456542969
----------------------check_connections_block total spend ----------------------------- 5.859811067581177
generate_one_block  0.6143646240234375
generate_one_block  0.6320078372955322
generate_one_block  0.6058688163757324
generate_one_block  0.6104390621185303
generate_one_block  0.6055881977081299
generate_one_block  0.6090447902679443
generate_one_block  0.646066427230835
generate_one_block  0.6156265735626221
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

connection checking time:  9.436922311782837
block generation total time  8.165236711502075
average batch blocks generation time:  1.0206545889377594
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.09639978408813477  GigaBytes
Max Memory Allocated: 0.09639978408813477  GigaBytes

torch.Size([160411, 128])
torch.Size([141225, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.7362060546875 GB
    Memory Allocated: 15.276633262634277  GigaBytes
Max Memory Allocated: 15.303646564483643  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2010498046875 GB
    Memory Allocated: 0.09996366500854492  GigaBytes
Max Memory Allocated: 15.303646564483643  GigaBytes

torch.Size([160460, 128])
torch.Size([141131, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2010498046875 GB
    Memory Allocated: 15.225714683532715  GigaBytes
Max Memory Allocated: 15.303646564483643  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2010498046875 GB
    Memory Allocated: 0.09949588775634766  GigaBytes
Max Memory Allocated: 15.303646564483643  GigaBytes

torch.Size([160443, 128])
torch.Size([141050, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2147216796875 GB
    Memory Allocated: 15.26238203048706  GigaBytes
Max Memory Allocated: 15.303646564483643  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2147216796875 GB
    Memory Allocated: 0.09946107864379883  GigaBytes
Max Memory Allocated: 15.303646564483643  GigaBytes

torch.Size([160364, 128])
torch.Size([140885, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2147216796875 GB
    Memory Allocated: 15.27399730682373  GigaBytes
Max Memory Allocated: 15.303646564483643  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2147216796875 GB
    Memory Allocated: 0.09971475601196289  GigaBytes
Max Memory Allocated: 15.303646564483643  GigaBytes

torch.Size([160469, 128])
torch.Size([140974, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2147216796875 GB
    Memory Allocated: 15.25952959060669  GigaBytes
Max Memory Allocated: 15.303646564483643  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2147216796875 GB
    Memory Allocated: 0.09962034225463867  GigaBytes
Max Memory Allocated: 15.303646564483643  GigaBytes

torch.Size([160558, 128])
torch.Size([141187, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2147216796875 GB
    Memory Allocated: 15.324376583099365  GigaBytes
Max Memory Allocated: 15.353496551513672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2147216796875 GB
    Memory Allocated: 0.09975910186767578  GigaBytes
Max Memory Allocated: 15.353496551513672  GigaBytes

torch.Size([160538, 128])
torch.Size([141383, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 15.326399803161621  GigaBytes
Max Memory Allocated: 15.355906009674072  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2420654296875 GB
    Memory Allocated: 0.0998392105102539  GigaBytes
Max Memory Allocated: 15.355906009674072  GigaBytes

torch.Size([160641, 128])
torch.Size([141321, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2557373046875 GB
    Memory Allocated: 15.354912757873535  GigaBytes
Max Memory Allocated: 15.384644508361816  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04551360011100769 |0.05627289414405823 |0.38509929180145264 |0.00013071298599243164 |0.3412134349346161 |0.00914764404296875 |
----------------------------------------------------------pseudo_mini_loss sum 4.946617126464844
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  2955497
Number of first layer input nodes during this epoch:  1283884
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 17.2557373046875 GB
    Memory Allocated: 0.13276433944702148  GigaBytes
Max Memory Allocated: 15.384644508361816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.08496594429016113
range selection method range initialization spend 0.015291929244995117
time for parepare:  0.017089366912841797
local_output_nid generation:  0.002895355224609375
local_in_edges_tensor generation:  0.006376981735229492
mini_batch_src_global generation:  0.0039825439453125
r_  generation:  0.03880786895751953
local_output_nid generation:  0.003487825393676758
local_in_edges_tensor generation:  0.001672506332397461
mini_batch_src_global generation:  0.003963947296142578
r_  generation:  0.03872537612915039
local_output_nid generation:  0.003466367721557617
local_in_edges_tensor generation:  0.0016260147094726562
mini_batch_src_global generation:  0.0027360916137695312
r_  generation:  0.039517879486083984
local_output_nid generation:  0.003566741943359375
local_in_edges_tensor generation:  0.0016431808471679688
mini_batch_src_global generation:  0.002868175506591797
r_  generation:  0.04161548614501953
local_output_nid generation:  0.0035698413848876953
local_in_edges_tensor generation:  0.0016429424285888672
mini_batch_src_global generation:  0.0030088424682617188
r_  generation:  0.044115543365478516
local_output_nid generation:  0.003909111022949219
local_in_edges_tensor generation:  0.0026319026947021484
mini_batch_src_global generation:  0.004195451736450195
r_  generation:  0.04209589958190918
local_output_nid generation:  0.003687143325805664
local_in_edges_tensor generation:  0.002134561538696289
mini_batch_src_global generation:  0.0031304359436035156
r_  generation:  0.041754961013793945
local_output_nid generation:  0.0038318634033203125
local_in_edges_tensor generation:  0.002084970474243164
mini_batch_src_global generation:  0.0031609535217285156
r_  generation:  0.044959306716918945
----------------------check_connections_block total spend ----------------------------- 0.5137956142425537
generate_one_block  0.07022833824157715
generate_one_block  0.060217857360839844
generate_one_block  0.06075406074523926
generate_one_block  0.06938743591308594
generate_one_block  0.061716318130493164
generate_one_block  0.06263041496276855
generate_one_block  0.06751227378845215
generate_one_block  0.06137824058532715
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.049207448959350586
gen group dst list time:  0.015585899353027344
time for parepare:  0.018947362899780273
local_output_nid generation:  0.010899066925048828
local_in_edges_tensor generation:  0.038448333740234375
mini_batch_src_global generation:  0.027802705764770508
r_  generation:  0.3011021614074707
local_output_nid generation:  0.015605449676513672
local_in_edges_tensor generation:  0.026942014694213867
mini_batch_src_global generation:  0.03684520721435547
r_  generation:  0.30042243003845215
local_output_nid generation:  0.016057968139648438
local_in_edges_tensor generation:  0.02270197868347168
mini_batch_src_global generation:  0.038313865661621094
r_  generation:  0.3070659637451172
local_output_nid generation:  0.017900943756103516
local_in_edges_tensor generation:  0.018561124801635742
mini_batch_src_global generation:  0.03650712966918945
r_  generation:  0.3299543857574463
local_output_nid generation:  0.020374059677124023
local_in_edges_tensor generation:  0.03323650360107422
mini_batch_src_global generation:  0.04224538803100586
r_  generation:  0.31219911575317383
local_output_nid generation:  0.018117427825927734
local_in_edges_tensor generation:  0.025706768035888672
mini_batch_src_global generation:  0.037497520446777344
r_  generation:  0.3222231864929199
local_output_nid generation:  0.017421245574951172
local_in_edges_tensor generation:  0.0207369327545166
mini_batch_src_global generation:  0.03764510154724121
r_  generation:  0.31442904472351074
local_output_nid generation:  0.017884016036987305
local_in_edges_tensor generation:  0.023651838302612305
mini_batch_src_global generation:  0.0374908447265625
r_  generation:  0.31262755393981934
----------------------check_connections_block total spend ----------------------------- 3.68772292137146
generate_one_block  0.44781947135925293
generate_one_block  0.41241455078125
generate_one_block  0.41628408432006836
generate_one_block  0.4359719753265381
generate_one_block  0.42110681533813477
generate_one_block  0.4128751754760742
generate_one_block  0.4072108268737793
generate_one_block  0.43772459030151367
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.036005258560180664
gen group dst list time:  0.03571891784667969
time for parepare:  0.019514799118041992
local_output_nid generation:  0.027637720108032227
local_in_edges_tensor generation:  0.05630993843078613
mini_batch_src_global generation:  0.04555773735046387
r_  generation:  0.49423956871032715
local_output_nid generation:  0.03272724151611328
local_in_edges_tensor generation:  0.052008867263793945
mini_batch_src_global generation:  0.05538058280944824
r_  generation:  0.49337196350097656
local_output_nid generation:  0.034166574478149414
local_in_edges_tensor generation:  0.04743194580078125
mini_batch_src_global generation:  0.050759315490722656
r_  generation:  0.5109560489654541
local_output_nid generation:  0.035367727279663086
local_in_edges_tensor generation:  0.04633975028991699
mini_batch_src_global generation:  0.060883283615112305
r_  generation:  0.4891471862792969
local_output_nid generation:  0.035311222076416016
local_in_edges_tensor generation:  0.0374295711517334
mini_batch_src_global generation:  0.052855491638183594
r_  generation:  0.4941532611846924
local_output_nid generation:  0.03474020957946777
local_in_edges_tensor generation:  0.04242587089538574
mini_batch_src_global generation:  0.05435037612915039
r_  generation:  0.49533653259277344
local_output_nid generation:  0.03458213806152344
local_in_edges_tensor generation:  0.033489227294921875
mini_batch_src_global generation:  0.05503273010253906
r_  generation:  0.5005168914794922
local_output_nid generation:  0.034399986267089844
local_in_edges_tensor generation:  0.03943204879760742
mini_batch_src_global generation:  0.058762311935424805
r_  generation:  0.49858903884887695
----------------------check_connections_block total spend ----------------------------- 5.940083265304565
generate_one_block  0.6405842304229736
generate_one_block  0.627941370010376
generate_one_block  0.6329784393310547
generate_one_block  0.6277012825012207
generate_one_block  0.6253395080566406
generate_one_block  0.628471851348877
generate_one_block  0.6192643642425537
generate_one_block  0.6373395919799805
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.2557373046875 GB
    Memory Allocated: 0.13276433944702148  GigaBytes
Max Memory Allocated: 15.384644508361816  GigaBytes

connection checking time:  9.627806186676025
block generation total time  8.431028127670288
average batch blocks generation time:  1.053878515958786
block dataloader generation time/epoch 20.30560064315796
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2557373046875 GB
    Memory Allocated: 0.1015315055847168  GigaBytes
Max Memory Allocated: 15.384644508361816  GigaBytes

torch.Size([160811, 128])
torch.Size([141447, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9705810546875 GB
    Memory Allocated: 15.365981578826904  GigaBytes
Max Memory Allocated: 15.395390033721924  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9705810546875 GB
    Memory Allocated: 0.10144996643066406  GigaBytes
Max Memory Allocated: 15.395390033721924  GigaBytes

torch.Size([160404, 128])
torch.Size([140988, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9705810546875 GB
    Memory Allocated: 15.241961002349854  GigaBytes
Max Memory Allocated: 15.395390033721924  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9705810546875 GB
    Memory Allocated: 0.10136222839355469  GigaBytes
Max Memory Allocated: 15.395390033721924  GigaBytes

torch.Size([160609, 128])
torch.Size([141622, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9705810546875 GB
    Memory Allocated: 15.336160659790039  GigaBytes
Max Memory Allocated: 15.395390033721924  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9705810546875 GB
    Memory Allocated: 0.10146045684814453  GigaBytes
Max Memory Allocated: 15.395390033721924  GigaBytes

torch.Size([160574, 128])
torch.Size([141191, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9705810546875 GB
    Memory Allocated: 15.337971687316895  GigaBytes
Max Memory Allocated: 15.395390033721924  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9705810546875 GB
    Memory Allocated: 0.10132455825805664  GigaBytes
Max Memory Allocated: 15.395390033721924  GigaBytes

torch.Size([160311, 128])
torch.Size([140883, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9705810546875 GB
    Memory Allocated: 15.282127857208252  GigaBytes
Max Memory Allocated: 15.395390033721924  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9705810546875 GB
    Memory Allocated: 0.10146427154541016  GigaBytes
Max Memory Allocated: 15.395390033721924  GigaBytes

torch.Size([160590, 128])
torch.Size([141231, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9705810546875 GB
    Memory Allocated: 15.311197280883789  GigaBytes
Max Memory Allocated: 15.395390033721924  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9705810546875 GB
    Memory Allocated: 0.10116910934448242  GigaBytes
Max Memory Allocated: 15.395390033721924  GigaBytes

torch.Size([160331, 128])
torch.Size([140543, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9705810546875 GB
    Memory Allocated: 15.250560283660889  GigaBytes
Max Memory Allocated: 15.395390033721924  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9705810546875 GB
    Memory Allocated: 0.10129976272583008  GigaBytes
Max Memory Allocated: 15.395390033721924  GigaBytes

torch.Size([160554, 128])
torch.Size([141213, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9705810546875 GB
    Memory Allocated: 15.29689073562622  GigaBytes
Max Memory Allocated: 15.395390033721924  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04863178730010986 |0.018928080797195435 |0.27285701036453247 |0.00010538101196289062 |0.3461070656776428 |0.004515409469604492 |
----------------------------------------------------------pseudo_mini_loss sum 3.8056516647338867
Total (block generation + training)time/epoch 25.834278106689453
Training time/epoch 5.528444766998291
Training time without block to device /epoch 5.3770201206207275
Training time without total dataloading part /epoch 4.95707106590271
load block tensor time/epoch 0.3890542984008789
block to device time/epoch 0.15142464637756348
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  2956569
Number of first layer input nodes during this epoch:  1284184
