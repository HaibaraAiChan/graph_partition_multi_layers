Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648476419.4573035
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0213623046875 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026758432388305664
range selection method range initialization spend 0.013867616653442383
time for parepare:  0.017839431762695312
local_output_nid generation:  0.0007240772247314453
local_in_edges_tensor generation:  0.0028939247131347656
mini_batch_src_global generation:  0.0015773773193359375
r_  generation:  0.011293649673461914
local_output_nid generation:  0.0008351802825927734
local_in_edges_tensor generation:  0.0006589889526367188
mini_batch_src_global generation:  0.0015380382537841797
r_  generation:  0.009754180908203125
local_output_nid generation:  0.0008134841918945312
local_in_edges_tensor generation:  0.0005638599395751953
mini_batch_src_global generation:  0.0009448528289794922
r_  generation:  0.009495258331298828
local_output_nid generation:  0.000789642333984375
local_in_edges_tensor generation:  0.0005257129669189453
mini_batch_src_global generation:  0.0008544921875
r_  generation:  0.008933067321777344
local_output_nid generation:  0.0007920265197753906
local_in_edges_tensor generation:  0.0005459785461425781
mini_batch_src_global generation:  0.0009214878082275391
r_  generation:  0.00932168960571289
local_output_nid generation:  0.0007703304290771484
local_in_edges_tensor generation:  0.0005075931549072266
mini_batch_src_global generation:  0.0009019374847412109
r_  generation:  0.009446144104003906
local_output_nid generation:  0.0007748603820800781
local_in_edges_tensor generation:  0.0005171298980712891
mini_batch_src_global generation:  0.0009310245513916016
r_  generation:  0.009417533874511719
local_output_nid generation:  0.000766754150390625
local_in_edges_tensor generation:  0.0005021095275878906
mini_batch_src_global generation:  0.000946044921875
r_  generation:  0.010026693344116211
local_output_nid generation:  0.0007662773132324219
local_in_edges_tensor generation:  0.00048661231994628906
mini_batch_src_global generation:  0.0009353160858154297
r_  generation:  0.009603500366210938
local_output_nid generation:  0.0007543563842773438
local_in_edges_tensor generation:  0.0005228519439697266
mini_batch_src_global generation:  0.0010044574737548828
r_  generation:  0.00995492935180664
local_output_nid generation:  0.0007636547088623047
local_in_edges_tensor generation:  0.0004878044128417969
mini_batch_src_global generation:  0.0010116100311279297
r_  generation:  0.010119438171386719
local_output_nid generation:  0.0007562637329101562
local_in_edges_tensor generation:  0.00048160552978515625
mini_batch_src_global generation:  0.0010218620300292969
r_  generation:  0.010108232498168945
local_output_nid generation:  0.0007617473602294922
local_in_edges_tensor generation:  0.00049591064453125
mini_batch_src_global generation:  0.0010280609130859375
r_  generation:  0.010098457336425781
local_output_nid generation:  0.000762939453125
local_in_edges_tensor generation:  0.00048542022705078125
mini_batch_src_global generation:  0.0011496543884277344
r_  generation:  0.01026773452758789
local_output_nid generation:  0.0007607936859130859
local_in_edges_tensor generation:  0.0004851818084716797
mini_batch_src_global generation:  0.0010564327239990234
r_  generation:  0.01045680046081543
local_output_nid generation:  0.000774383544921875
local_in_edges_tensor generation:  0.00048065185546875
mini_batch_src_global generation:  0.0010120868682861328
r_  generation:  0.009786605834960938
local_output_nid generation:  0.0007665157318115234
local_in_edges_tensor generation:  0.0004820823669433594
mini_batch_src_global generation:  0.0010066032409667969
r_  generation:  0.00960850715637207
local_output_nid generation:  0.0007734298706054688
local_in_edges_tensor generation:  0.0004937648773193359
mini_batch_src_global generation:  0.001111745834350586
r_  generation:  0.010336637496948242
local_output_nid generation:  0.0007598400115966797
local_in_edges_tensor generation:  0.0004787445068359375
mini_batch_src_global generation:  0.0010104179382324219
r_  generation:  0.009801149368286133
local_output_nid generation:  0.00075531005859375
local_in_edges_tensor generation:  0.00047898292541503906
mini_batch_src_global generation:  0.0009717941284179688
r_  generation:  0.009893178939819336
local_output_nid generation:  0.0007457733154296875
local_in_edges_tensor generation:  0.00048351287841796875
mini_batch_src_global generation:  0.0009996891021728516
r_  generation:  0.009886980056762695
local_output_nid generation:  0.0007579326629638672
local_in_edges_tensor generation:  0.0004696846008300781
mini_batch_src_global generation:  0.001027822494506836
r_  generation:  0.010173559188842773
local_output_nid generation:  0.0007708072662353516
local_in_edges_tensor generation:  0.0004665851593017578
mini_batch_src_global generation:  0.0009963512420654297
r_  generation:  0.009963274002075195
local_output_nid generation:  0.0007698535919189453
local_in_edges_tensor generation:  0.000518798828125
mini_batch_src_global generation:  0.0010044574737548828
r_  generation:  0.009593963623046875
local_output_nid generation:  0.0008203983306884766
local_in_edges_tensor generation:  0.0004999637603759766
mini_batch_src_global generation:  0.0010199546813964844
r_  generation:  0.010203123092651367
local_output_nid generation:  0.0007526874542236328
local_in_edges_tensor generation:  0.0004775524139404297
mini_batch_src_global generation:  0.0010364055633544922
r_  generation:  0.010176897048950195
local_output_nid generation:  0.0007617473602294922
local_in_edges_tensor generation:  0.0004851818084716797
mini_batch_src_global generation:  0.0009942054748535156
r_  generation:  0.009747505187988281
local_output_nid generation:  0.0007677078247070312
local_in_edges_tensor generation:  0.0004780292510986328
mini_batch_src_global generation:  0.0010151863098144531
r_  generation:  0.01002955436706543
local_output_nid generation:  0.000766754150390625
local_in_edges_tensor generation:  0.00047397613525390625
mini_batch_src_global generation:  0.0010173320770263672
r_  generation:  0.010172843933105469
local_output_nid generation:  0.0007538795471191406
local_in_edges_tensor generation:  0.004399776458740234
mini_batch_src_global generation:  0.0011811256408691406
r_  generation:  0.009949922561645508
local_output_nid generation:  0.0007936954498291016
local_in_edges_tensor generation:  0.0005283355712890625
mini_batch_src_global generation:  0.001041412353515625
r_  generation:  0.009685754776000977
local_output_nid generation:  0.0007951259613037109
local_in_edges_tensor generation:  0.0004899501800537109
mini_batch_src_global generation:  0.0010342597961425781
r_  generation:  0.01025390625
----------------------check_connections_block total spend ----------------------------- 0.48885607719421387
generate_one_block  0.015840530395507812
generate_one_block  0.01525115966796875
generate_one_block  0.014908552169799805
generate_one_block  0.013937950134277344
generate_one_block  0.014871358871459961
generate_one_block  0.014635086059570312
generate_one_block  0.01447916030883789
generate_one_block  0.015321493148803711
generate_one_block  0.0146942138671875
generate_one_block  0.015210628509521484
generate_one_block  0.015035629272460938
generate_one_block  0.015237569808959961
generate_one_block  0.015099525451660156
generate_one_block  0.015415191650390625
generate_one_block  0.015953779220581055
generate_one_block  0.014843940734863281
generate_one_block  0.014406681060791016
generate_one_block  0.01570439338684082
generate_one_block  0.014662981033325195
generate_one_block  0.01470041275024414
generate_one_block  0.01500082015991211
generate_one_block  0.015199899673461914
generate_one_block  0.014713525772094727
generate_one_block  0.014177560806274414
generate_one_block  0.015135765075683594
generate_one_block  0.014976263046264648
generate_one_block  0.014570474624633789
generate_one_block  0.014898538589477539
generate_one_block  0.014912128448486328
generate_one_block  0.014422178268432617
generate_one_block  0.014776468276977539
generate_one_block  0.015234708786010742
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.041677236557006836
gen group dst list time:  0.023708343505859375
time for parepare:  0.019382238388061523
local_output_nid generation:  0.004399299621582031
local_in_edges_tensor generation:  0.012082815170288086
mini_batch_src_global generation:  0.016889095306396484
r_  generation:  0.1641378402709961
local_output_nid generation:  0.007017612457275391
local_in_edges_tensor generation:  0.013920783996582031
mini_batch_src_global generation:  0.02077317237854004
r_  generation:  0.1673579216003418
local_output_nid generation:  0.0071926116943359375
local_in_edges_tensor generation:  0.011182546615600586
mini_batch_src_global generation:  0.01934671401977539
r_  generation:  0.17639708518981934
local_output_nid generation:  0.006783962249755859
local_in_edges_tensor generation:  0.009570837020874023
mini_batch_src_global generation:  0.0193023681640625
r_  generation:  0.16437911987304688
local_output_nid generation:  0.007280826568603516
local_in_edges_tensor generation:  0.011694669723510742
mini_batch_src_global generation:  0.021010637283325195
r_  generation:  0.17443275451660156
local_output_nid generation:  0.0072977542877197266
local_in_edges_tensor generation:  0.011619329452514648
mini_batch_src_global generation:  0.021532297134399414
r_  generation:  0.17348074913024902
local_output_nid generation:  0.007400989532470703
local_in_edges_tensor generation:  0.010235309600830078
mini_batch_src_global generation:  0.021630287170410156
r_  generation:  0.18208003044128418
local_output_nid generation:  0.00785207748413086
local_in_edges_tensor generation:  0.010607004165649414
mini_batch_src_global generation:  0.02413153648376465
r_  generation:  0.18465852737426758
local_output_nid generation:  0.0075719356536865234
local_in_edges_tensor generation:  0.010364770889282227
mini_batch_src_global generation:  0.022260189056396484
r_  generation:  0.17857050895690918
local_output_nid generation:  0.0077936649322509766
local_in_edges_tensor generation:  0.010567665100097656
mini_batch_src_global generation:  0.023601531982421875
r_  generation:  0.18201231956481934
local_output_nid generation:  0.007907390594482422
local_in_edges_tensor generation:  0.012355566024780273
mini_batch_src_global generation:  0.024214744567871094
r_  generation:  0.18414640426635742
local_output_nid generation:  0.007963895797729492
local_in_edges_tensor generation:  0.011080026626586914
mini_batch_src_global generation:  0.02306079864501953
r_  generation:  0.18529748916625977
local_output_nid generation:  0.007928848266601562
local_in_edges_tensor generation:  0.009181022644042969
mini_batch_src_global generation:  0.02312493324279785
r_  generation:  0.18245911598205566
local_output_nid generation:  0.008064746856689453
local_in_edges_tensor generation:  0.012222766876220703
mini_batch_src_global generation:  0.0233151912689209
r_  generation:  0.1896204948425293
local_output_nid generation:  0.008263349533081055
local_in_edges_tensor generation:  0.011199474334716797
mini_batch_src_global generation:  0.025266170501708984
r_  generation:  0.18848371505737305
local_output_nid generation:  0.007778644561767578
local_in_edges_tensor generation:  0.009413957595825195
mini_batch_src_global generation:  0.02264237403869629
r_  generation:  0.18064188957214355
local_output_nid generation:  0.007851839065551758
local_in_edges_tensor generation:  0.009313583374023438
mini_batch_src_global generation:  0.022255897521972656
r_  generation:  0.17428016662597656
local_output_nid generation:  0.008342981338500977
local_in_edges_tensor generation:  0.010980367660522461
mini_batch_src_global generation:  0.024853229522705078
r_  generation:  0.19273138046264648
local_output_nid generation:  0.008057117462158203
local_in_edges_tensor generation:  0.009499311447143555
mini_batch_src_global generation:  0.022892475128173828
r_  generation:  0.18138480186462402
local_output_nid generation:  0.008021116256713867
local_in_edges_tensor generation:  0.009387731552124023
mini_batch_src_global generation:  0.022569894790649414
r_  generation:  0.17964839935302734
local_output_nid generation:  0.008011102676391602
local_in_edges_tensor generation:  0.012512445449829102
mini_batch_src_global generation:  0.024387359619140625
r_  generation:  0.1845080852508545
local_output_nid generation:  0.008252859115600586
local_in_edges_tensor generation:  0.012764930725097656
mini_batch_src_global generation:  0.024900436401367188
r_  generation:  0.19253134727478027
local_output_nid generation:  0.007900714874267578
local_in_edges_tensor generation:  0.009325504302978516
mini_batch_src_global generation:  0.022493600845336914
r_  generation:  0.1783761978149414
local_output_nid generation:  0.007837772369384766
local_in_edges_tensor generation:  0.009133577346801758
mini_batch_src_global generation:  0.021671056747436523
r_  generation:  0.17398810386657715
local_output_nid generation:  0.0081939697265625
local_in_edges_tensor generation:  0.011018753051757812
mini_batch_src_global generation:  0.02295541763305664
r_  generation:  0.1859130859375
local_output_nid generation:  0.008152246475219727
local_in_edges_tensor generation:  0.010877847671508789
mini_batch_src_global generation:  0.02280902862548828
r_  generation:  0.18242931365966797
local_output_nid generation:  0.008028507232666016
local_in_edges_tensor generation:  0.009139537811279297
mini_batch_src_global generation:  0.022466421127319336
r_  generation:  0.17818307876586914
local_output_nid generation:  0.008222341537475586
local_in_edges_tensor generation:  0.010556697845458984
mini_batch_src_global generation:  0.02297496795654297
r_  generation:  0.1852855682373047
local_output_nid generation:  0.008188247680664062
local_in_edges_tensor generation:  0.010976791381835938
mini_batch_src_global generation:  0.022638559341430664
r_  generation:  0.1801764965057373
local_output_nid generation:  0.00798177719116211
local_in_edges_tensor generation:  0.01289510726928711
mini_batch_src_global generation:  0.02255558967590332
r_  generation:  0.1789078712463379
local_output_nid generation:  0.007870912551879883
local_in_edges_tensor generation:  0.010008096694946289
mini_batch_src_global generation:  0.021787643432617188
r_  generation:  0.1784827709197998
local_output_nid generation:  0.008292198181152344
local_in_edges_tensor generation:  0.014284849166870117
mini_batch_src_global generation:  0.024516582489013672
r_  generation:  0.18703651428222656
----------------------check_connections_block total spend ----------------------------- 8.396060705184937
generate_one_block  0.23548412322998047
generate_one_block  0.2258739471435547
generate_one_block  0.2466592788696289
generate_one_block  0.21279025077819824
generate_one_block  0.2349104881286621
generate_one_block  0.22582077980041504
generate_one_block  0.2241966724395752
generate_one_block  0.237626314163208
generate_one_block  0.2231884002685547
generate_one_block  0.22798705101013184
generate_one_block  0.23852920532226562
generate_one_block  0.23637032508850098
generate_one_block  0.23111915588378906
generate_one_block  0.2376089096069336
generate_one_block  0.2438499927520752
generate_one_block  0.24872612953186035
generate_one_block  0.21753978729248047
generate_one_block  0.24454641342163086
generate_one_block  0.22611284255981445
generate_one_block  0.22328734397888184
generate_one_block  0.23099017143249512
generate_one_block  0.24222707748413086
generate_one_block  0.22084927558898926
generate_one_block  0.21620631217956543
generate_one_block  0.23659420013427734
generate_one_block  0.23337960243225098
generate_one_block  0.2226390838623047
generate_one_block  0.23432230949401855
generate_one_block  0.23303651809692383
generate_one_block  0.2257237434387207
generate_one_block  0.22854375839233398
generate_one_block  0.24083280563354492
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04798150062561035
gen group dst list time:  0.12467503547668457
time for parepare:  0.026991605758666992
local_output_nid generation:  0.02260136604309082
local_in_edges_tensor generation:  0.054692983627319336
mini_batch_src_global generation:  0.06275820732116699
r_  generation:  0.44260144233703613
local_output_nid generation:  0.03335690498352051
local_in_edges_tensor generation:  0.049451351165771484
mini_batch_src_global generation:  0.053411006927490234
r_  generation:  0.44127964973449707
local_output_nid generation:  0.03430485725402832
local_in_edges_tensor generation:  0.04107213020324707
mini_batch_src_global generation:  0.04747438430786133
r_  generation:  0.4420018196105957
local_output_nid generation:  0.031501054763793945
local_in_edges_tensor generation:  0.04172348976135254
mini_batch_src_global generation:  0.05353832244873047
r_  generation:  0.4407470226287842
local_output_nid generation:  0.02923417091369629
local_in_edges_tensor generation:  0.034182071685791016
mini_batch_src_global generation:  0.04939579963684082
r_  generation:  0.4496431350708008
local_output_nid generation:  0.02818441390991211
local_in_edges_tensor generation:  0.0373692512512207
mini_batch_src_global generation:  0.05046725273132324
r_  generation:  0.4402186870574951
local_output_nid generation:  0.03209257125854492
local_in_edges_tensor generation:  0.029292583465576172
mini_batch_src_global generation:  0.051392316818237305
r_  generation:  0.4414682388305664
local_output_nid generation:  0.02912592887878418
local_in_edges_tensor generation:  0.034507036209106445
mini_batch_src_global generation:  0.0506742000579834
r_  generation:  0.46443915367126465
local_output_nid generation:  0.028746604919433594
local_in_edges_tensor generation:  0.03865361213684082
mini_batch_src_global generation:  0.056733131408691406
r_  generation:  0.4397892951965332
local_output_nid generation:  0.030237913131713867
local_in_edges_tensor generation:  0.034207820892333984
mini_batch_src_global generation:  0.05065727233886719
r_  generation:  0.43570947647094727
local_output_nid generation:  0.028584718704223633
local_in_edges_tensor generation:  0.03742575645446777
mini_batch_src_global generation:  0.050235748291015625
r_  generation:  0.439866304397583
local_output_nid generation:  0.02879023551940918
local_in_edges_tensor generation:  0.03131890296936035
mini_batch_src_global generation:  0.05084586143493652
r_  generation:  0.4483060836791992
local_output_nid generation:  0.02929067611694336
local_in_edges_tensor generation:  0.029375076293945312
mini_batch_src_global generation:  0.05062985420227051
r_  generation:  0.4395253658294678
local_output_nid generation:  0.028652667999267578
local_in_edges_tensor generation:  0.03343653678894043
mini_batch_src_global generation:  0.05274224281311035
r_  generation:  0.43853187561035156
local_output_nid generation:  0.028943538665771484
local_in_edges_tensor generation:  0.0453031063079834
mini_batch_src_global generation:  0.06438517570495605
r_  generation:  0.44319748878479004
local_output_nid generation:  0.028644800186157227
local_in_edges_tensor generation:  0.03526496887207031
mini_batch_src_global generation:  0.05247855186462402
r_  generation:  0.44187259674072266
local_output_nid generation:  0.030041217803955078
local_in_edges_tensor generation:  0.026678085327148438
mini_batch_src_global generation:  0.04998469352722168
r_  generation:  0.44001102447509766
local_output_nid generation:  0.029085636138916016
local_in_edges_tensor generation:  0.034911155700683594
mini_batch_src_global generation:  0.04954051971435547
r_  generation:  0.43988537788391113
local_output_nid generation:  0.02876114845275879
local_in_edges_tensor generation:  0.030516386032104492
mini_batch_src_global generation:  0.04998302459716797
r_  generation:  0.4488534927368164
local_output_nid generation:  0.028690576553344727
local_in_edges_tensor generation:  0.026151418685913086
mini_batch_src_global generation:  0.04961991310119629
r_  generation:  0.43315768241882324
local_output_nid generation:  0.02867436408996582
local_in_edges_tensor generation:  0.026717185974121094
mini_batch_src_global generation:  0.049663543701171875
r_  generation:  0.4399886131286621
local_output_nid generation:  0.028882980346679688
local_in_edges_tensor generation:  0.03437328338623047
mini_batch_src_global generation:  0.04991412162780762
r_  generation:  0.43880677223205566
local_output_nid generation:  0.02827930450439453
local_in_edges_tensor generation:  0.026699304580688477
mini_batch_src_global generation:  0.04945182800292969
r_  generation:  0.43148159980773926
local_output_nid generation:  0.028263330459594727
local_in_edges_tensor generation:  0.029594898223876953
mini_batch_src_global generation:  0.04910445213317871
r_  generation:  0.43526387214660645
local_output_nid generation:  0.032062530517578125
local_in_edges_tensor generation:  0.035662174224853516
mini_batch_src_global generation:  0.050580739974975586
r_  generation:  0.4365067481994629
local_output_nid generation:  0.028583049774169922
local_in_edges_tensor generation:  0.034353017807006836
mini_batch_src_global generation:  0.05252552032470703
r_  generation:  0.4562845230102539
local_output_nid generation:  0.028770923614501953
local_in_edges_tensor generation:  0.03680992126464844
mini_batch_src_global generation:  0.057073116302490234
r_  generation:  0.43877291679382324
local_output_nid generation:  0.029825210571289062
local_in_edges_tensor generation:  0.0391993522644043
mini_batch_src_global generation:  0.05069613456726074
r_  generation:  0.436978816986084
local_output_nid generation:  0.02882099151611328
local_in_edges_tensor generation:  0.033299922943115234
mini_batch_src_global generation:  0.050360918045043945
r_  generation:  0.44313836097717285
local_output_nid generation:  0.028590917587280273
local_in_edges_tensor generation:  0.026276826858520508
mini_batch_src_global generation:  0.050115108489990234
r_  generation:  0.4351637363433838
local_output_nid generation:  0.0285341739654541
local_in_edges_tensor generation:  0.030005931854248047
mini_batch_src_global generation:  0.05004596710205078
r_  generation:  0.44568943977355957
local_output_nid generation:  0.02888321876525879
local_in_edges_tensor generation:  0.03403329849243164
mini_batch_src_global generation:  0.05212521553039551
r_  generation:  0.44589948654174805
----------------------check_connections_block total spend ----------------------------- 20.996793508529663
generate_one_block  0.7151186466217041
generate_one_block  0.5606753826141357
generate_one_block  0.5659286975860596
generate_one_block  0.5424859523773193
generate_one_block  0.5579462051391602
generate_one_block  0.5721478462219238
generate_one_block  0.555821418762207
generate_one_block  0.5719280242919922
generate_one_block  0.5508475303649902
generate_one_block  0.551133394241333
generate_one_block  0.5730769634246826
generate_one_block  0.5653743743896484
generate_one_block  0.5466647148132324
generate_one_block  0.5613641738891602
generate_one_block  0.5659596920013428
generate_one_block  0.5533323287963867
generate_one_block  0.5524837970733643
generate_one_block  0.5724174976348877
generate_one_block  0.5490443706512451
generate_one_block  0.5651228427886963
generate_one_block  0.5732429027557373
generate_one_block  0.5659503936767578
generate_one_block  0.5421712398529053
generate_one_block  0.5406351089477539
generate_one_block  0.5747683048248291
generate_one_block  0.5600631237030029
generate_one_block  0.555351734161377
generate_one_block  0.5644159317016602
generate_one_block  0.5548000335693359
generate_one_block  0.5470566749572754
generate_one_block  0.5426228046417236
generate_one_block  0.5665969848632812
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0213623046875 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

connection checking time:  29.3928542137146
block generation total time  25.44412136077881
average batch blocks generation time:  0.7951287925243378
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.09044933319091797  GigaBytes
Max Memory Allocated: 0.09044933319091797  GigaBytes

torch.Size([148399, 128])
torch.Size([109773, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.0936279296875 GB
    Memory Allocated: 19.208762168884277  GigaBytes
Max Memory Allocated: 19.308146476745605  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1678466796875 GB
    Memory Allocated: 0.0963129997253418  GigaBytes
Max Memory Allocated: 19.308146476745605  GigaBytes

torch.Size([149149, 128])
torch.Size([110047, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1678466796875 GB
    Memory Allocated: 18.910377979278564  GigaBytes
Max Memory Allocated: 19.308146476745605  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1678466796875 GB
    Memory Allocated: 0.09630966186523438  GigaBytes
Max Memory Allocated: 19.308146476745605  GigaBytes

torch.Size([149142, 128])
torch.Size([110518, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8143310546875 GB
    Memory Allocated: 18.868844985961914  GigaBytes
Max Memory Allocated: 19.308146476745605  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8143310546875 GB
    Memory Allocated: 0.09560298919677734  GigaBytes
Max Memory Allocated: 19.308146476745605  GigaBytes

torch.Size([148418, 128])
torch.Size([108259, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8143310546875 GB
    Memory Allocated: 18.29399061203003  GigaBytes
Max Memory Allocated: 19.308146476745605  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8143310546875 GB
    Memory Allocated: 0.09630107879638672  GigaBytes
Max Memory Allocated: 19.308146476745605  GigaBytes

torch.Size([149082, 128])
torch.Size([109733, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8143310546875 GB
    Memory Allocated: 18.943642139434814  GigaBytes
Max Memory Allocated: 19.308146476745605  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8143310546875 GB
    Memory Allocated: 0.09623908996582031  GigaBytes
Max Memory Allocated: 19.308146476745605  GigaBytes

torch.Size([149146, 128])
torch.Size([109929, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8143310546875 GB
    Memory Allocated: 18.761724948883057  GigaBytes
Max Memory Allocated: 19.308146476745605  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8143310546875 GB
    Memory Allocated: 0.09593391418457031  GigaBytes
Max Memory Allocated: 19.308146476745605  GigaBytes

torch.Size([148630, 128])
torch.Size([109061, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8143310546875 GB
    Memory Allocated: 18.666781902313232  GigaBytes
Max Memory Allocated: 19.308146476745605  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8143310546875 GB
    Memory Allocated: 0.09682750701904297  GigaBytes
Max Memory Allocated: 19.308146476745605  GigaBytes

torch.Size([149810, 128])
torch.Size([111660, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4647216796875 GB
    Memory Allocated: 19.32148551940918  GigaBytes
Max Memory Allocated: 19.410489559173584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4647216796875 GB
    Memory Allocated: 0.09596061706542969  GigaBytes
Max Memory Allocated: 19.410489559173584  GigaBytes

torch.Size([148512, 128])
torch.Size([109478, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4647216796875 GB
    Memory Allocated: 18.818753242492676  GigaBytes
Max Memory Allocated: 19.410489559173584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4647216796875 GB
    Memory Allocated: 0.09609842300415039  GigaBytes
Max Memory Allocated: 19.410489559173584  GigaBytes

torch.Size([148779, 128])
torch.Size([109547, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4647216796875 GB
    Memory Allocated: 18.79457664489746  GigaBytes
Max Memory Allocated: 19.410489559173584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4647216796875 GB
    Memory Allocated: 0.09620809555053711  GigaBytes
Max Memory Allocated: 19.410489559173584  GigaBytes

torch.Size([148583, 128])
torch.Size([110233, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4647216796875 GB
    Memory Allocated: 19.249215126037598  GigaBytes
Max Memory Allocated: 19.410489559173584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4647216796875 GB
    Memory Allocated: 0.09642410278320312  GigaBytes
Max Memory Allocated: 19.410489559173584  GigaBytes

torch.Size([148964, 128])
torch.Size([110956, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4647216796875 GB
    Memory Allocated: 19.25658416748047  GigaBytes
Max Memory Allocated: 19.410489559173584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4647216796875 GB
    Memory Allocated: 0.09596443176269531  GigaBytes
Max Memory Allocated: 19.410489559173584  GigaBytes

torch.Size([148330, 128])
torch.Size([109347, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4647216796875 GB
    Memory Allocated: 19.056251525878906  GigaBytes
Max Memory Allocated: 19.410489559173584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4647216796875 GB
    Memory Allocated: 0.09657812118530273  GigaBytes
Max Memory Allocated: 19.410489559173584  GigaBytes

torch.Size([149351, 128])
torch.Size([110658, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4647216796875 GB
    Memory Allocated: 19.211432456970215  GigaBytes
Max Memory Allocated: 19.410489559173584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4647216796875 GB
    Memory Allocated: 0.09659719467163086  GigaBytes
Max Memory Allocated: 19.410489559173584  GigaBytes

torch.Size([149191, 128])
torch.Size([110551, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4647216796875 GB
    Memory Allocated: 19.438921451568604  GigaBytes
Max Memory Allocated: 19.53566837310791  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4647216796875 GB
    Memory Allocated: 0.09609222412109375  GigaBytes
Max Memory Allocated: 19.53566837310791  GigaBytes

torch.Size([148764, 128])
torch.Size([109323, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4666748046875 GB
    Memory Allocated: 18.874136924743652  GigaBytes
Max Memory Allocated: 19.53566837310791  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4686279296875 GB
    Memory Allocated: 0.09614372253417969  GigaBytes
Max Memory Allocated: 19.53566837310791  GigaBytes

torch.Size([149186, 128])
torch.Size([110209, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4686279296875 GB
    Memory Allocated: 18.574939250946045  GigaBytes
Max Memory Allocated: 19.53566837310791  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4686279296875 GB
    Memory Allocated: 0.09664392471313477  GigaBytes
Max Memory Allocated: 19.53566837310791  GigaBytes

torch.Size([149159, 128])
torch.Size([111191, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4686279296875 GB
    Memory Allocated: 19.497153282165527  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4686279296875 GB
    Memory Allocated: 0.0960392951965332  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

torch.Size([148569, 128])
torch.Size([109731, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4686279296875 GB
    Memory Allocated: 18.916664600372314  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4686279296875 GB
    Memory Allocated: 0.0961918830871582  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

torch.Size([149031, 128])
torch.Size([109757, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4686279296875 GB
    Memory Allocated: 18.74067449569702  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4686279296875 GB
    Memory Allocated: 0.09606742858886719  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

torch.Size([148462, 128])
torch.Size([109847, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4764404296875 GB
    Memory Allocated: 19.09487295150757  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4803466796875 GB
    Memory Allocated: 0.09644603729248047  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

torch.Size([148902, 128])
torch.Size([110969, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4803466796875 GB
    Memory Allocated: 19.36299467086792  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4803466796875 GB
    Memory Allocated: 0.09570646286010742  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

torch.Size([148315, 128])
torch.Size([108334, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4803466796875 GB
    Memory Allocated: 18.56331777572632  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4803466796875 GB
    Memory Allocated: 0.09557914733886719  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

torch.Size([148250, 128])
torch.Size([108606, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4803466796875 GB
    Memory Allocated: 18.31600570678711  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4803466796875 GB
    Memory Allocated: 0.09629392623901367  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

torch.Size([148905, 128])
torch.Size([110114, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4803466796875 GB
    Memory Allocated: 19.144893646240234  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4803466796875 GB
    Memory Allocated: 0.09595394134521484  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

torch.Size([148402, 128])
torch.Size([109127, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4803466796875 GB
    Memory Allocated: 18.888720512390137  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4803466796875 GB
    Memory Allocated: 0.09609270095825195  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

torch.Size([148921, 128])
torch.Size([109490, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4803466796875 GB
    Memory Allocated: 18.71716022491455  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4803466796875 GB
    Memory Allocated: 0.09636592864990234  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

torch.Size([149050, 128])
torch.Size([110480, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4803466796875 GB
    Memory Allocated: 19.111531257629395  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4803466796875 GB
    Memory Allocated: 0.09621858596801758  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

torch.Size([148979, 128])
torch.Size([110199, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4803466796875 GB
    Memory Allocated: 18.96196174621582  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4803466796875 GB
    Memory Allocated: 0.09580802917480469  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

torch.Size([148504, 128])
torch.Size([108960, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4803466796875 GB
    Memory Allocated: 18.47468614578247  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4803466796875 GB
    Memory Allocated: 0.09579181671142578  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

torch.Size([148482, 128])
torch.Size([108764, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4803466796875 GB
    Memory Allocated: 18.538333892822266  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4803466796875 GB
    Memory Allocated: 0.09625911712646484  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

torch.Size([148734, 128])
torch.Size([110419, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4803466796875 GB
    Memory Allocated: 19.196463108062744  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.029025480151176453 |0.03131972998380661 |0.5947194695472717 |0.0001079663634300232 |1.1004495024681091 |0.013381719589233398 |
----------------------------------------------------------pseudo_mini_loss sum 5.390954494476318
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9117218
Number of first layer input nodes during this epoch:  4762101
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.4803466796875 GB
    Memory Allocated: 0.12709999084472656  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023842573165893555
range selection method range initialization spend 0.013295173645019531
time for parepare:  0.018002748489379883
local_output_nid generation:  0.0009064674377441406
local_in_edges_tensor generation:  0.0038177967071533203
mini_batch_src_global generation:  0.0016813278198242188
r_  generation:  0.010700702667236328
local_output_nid generation:  0.0009865760803222656
local_in_edges_tensor generation:  0.0006899833679199219
mini_batch_src_global generation:  0.001562356948852539
r_  generation:  0.010522603988647461
local_output_nid generation:  0.0009069442749023438
local_in_edges_tensor generation:  0.0006074905395507812
mini_batch_src_global generation:  0.0010669231414794922
r_  generation:  0.009802103042602539
local_output_nid generation:  0.0008785724639892578
local_in_edges_tensor generation:  0.0005812644958496094
mini_batch_src_global generation:  0.0010390281677246094
r_  generation:  0.009662151336669922
local_output_nid generation:  0.0008690357208251953
local_in_edges_tensor generation:  0.0005774497985839844
mini_batch_src_global generation:  0.00101470947265625
r_  generation:  0.009456157684326172
local_output_nid generation:  0.0008935928344726562
local_in_edges_tensor generation:  0.0005993843078613281
mini_batch_src_global generation:  0.0012276172637939453
r_  generation:  0.010571956634521484
local_output_nid generation:  0.0008473396301269531
local_in_edges_tensor generation:  0.0005726814270019531
mini_batch_src_global generation:  0.0010938644409179688
r_  generation:  0.009997367858886719
local_output_nid generation:  0.0008962154388427734
local_in_edges_tensor generation:  0.0005853176116943359
mini_batch_src_global generation:  0.0010662078857421875
r_  generation:  0.009923696517944336
local_output_nid generation:  0.0008471012115478516
local_in_edges_tensor generation:  0.0005688667297363281
mini_batch_src_global generation:  0.0011096000671386719
r_  generation:  0.009996175765991211
local_output_nid generation:  0.0008637905120849609
local_in_edges_tensor generation:  0.000614166259765625
mini_batch_src_global generation:  0.0012001991271972656
r_  generation:  0.010379314422607422
local_output_nid generation:  0.0008635520935058594
local_in_edges_tensor generation:  0.0005936622619628906
mini_batch_src_global generation:  0.0011374950408935547
r_  generation:  0.010713815689086914
local_output_nid generation:  0.0008878707885742188
local_in_edges_tensor generation:  0.0005817413330078125
mini_batch_src_global generation:  0.0011875629425048828
r_  generation:  0.010254621505737305
local_output_nid generation:  0.0008704662322998047
local_in_edges_tensor generation:  0.0005826950073242188
mini_batch_src_global generation:  0.0011239051818847656
r_  generation:  0.010638236999511719
local_output_nid generation:  0.0008528232574462891
local_in_edges_tensor generation:  0.0005779266357421875
mini_batch_src_global generation:  0.0011150836944580078
r_  generation:  0.01023554801940918
local_output_nid generation:  0.0008442401885986328
local_in_edges_tensor generation:  0.0005700588226318359
mini_batch_src_global generation:  0.001077890396118164
r_  generation:  0.010096311569213867
local_output_nid generation:  0.0008733272552490234
local_in_edges_tensor generation:  0.0005576610565185547
mini_batch_src_global generation:  0.0011105537414550781
r_  generation:  0.010105609893798828
local_output_nid generation:  0.0008511543273925781
local_in_edges_tensor generation:  0.0005710124969482422
mini_batch_src_global generation:  0.0010967254638671875
r_  generation:  0.010212421417236328
local_output_nid generation:  0.0008816719055175781
local_in_edges_tensor generation:  0.0005781650543212891
mini_batch_src_global generation:  0.001093149185180664
r_  generation:  0.00999760627746582
local_output_nid generation:  0.0008628368377685547
local_in_edges_tensor generation:  0.0005648136138916016
mini_batch_src_global generation:  0.0011439323425292969
r_  generation:  0.010263919830322266
local_output_nid generation:  0.000896453857421875
local_in_edges_tensor generation:  0.0005633831024169922
mini_batch_src_global generation:  0.0010652542114257812
r_  generation:  0.010011434555053711
local_output_nid generation:  0.0008776187896728516
local_in_edges_tensor generation:  0.0005617141723632812
mini_batch_src_global generation:  0.0011224746704101562
r_  generation:  0.01040792465209961
local_output_nid generation:  0.0009222030639648438
local_in_edges_tensor generation:  0.0005595684051513672
mini_batch_src_global generation:  0.0011150836944580078
r_  generation:  0.010152101516723633
local_output_nid generation:  0.0008585453033447266
local_in_edges_tensor generation:  0.0005905628204345703
mini_batch_src_global generation:  0.0011546611785888672
r_  generation:  0.010546445846557617
local_output_nid generation:  0.0008816719055175781
local_in_edges_tensor generation:  0.0005962848663330078
mini_batch_src_global generation:  0.0011780261993408203
r_  generation:  0.010926961898803711
local_output_nid generation:  0.0008649826049804688
local_in_edges_tensor generation:  0.0005779266357421875
mini_batch_src_global generation:  0.0011515617370605469
r_  generation:  0.010360956192016602
local_output_nid generation:  0.0008561611175537109
local_in_edges_tensor generation:  0.0005712509155273438
mini_batch_src_global generation:  0.0011343955993652344
r_  generation:  0.010249614715576172
local_output_nid generation:  0.00086212158203125
local_in_edges_tensor generation:  0.0005605220794677734
mini_batch_src_global generation:  0.0011518001556396484
r_  generation:  0.010353565216064453
local_output_nid generation:  0.0008492469787597656
local_in_edges_tensor generation:  0.0005636215209960938
mini_batch_src_global generation:  0.0011134147644042969
r_  generation:  0.010126829147338867
local_output_nid generation:  0.0008716583251953125
local_in_edges_tensor generation:  0.0005717277526855469
mini_batch_src_global generation:  0.0011076927185058594
r_  generation:  0.010273933410644531
local_output_nid generation:  0.0008597373962402344
local_in_edges_tensor generation:  0.000560760498046875
mini_batch_src_global generation:  0.0011310577392578125
r_  generation:  0.010169267654418945
local_output_nid generation:  0.0008742809295654297
local_in_edges_tensor generation:  0.0005669593811035156
mini_batch_src_global generation:  0.0011243820190429688
r_  generation:  0.010408639907836914
local_output_nid generation:  0.00086212158203125
local_in_edges_tensor generation:  0.0005581378936767578
mini_batch_src_global generation:  0.0011475086212158203
r_  generation:  0.01055145263671875
----------------------check_connections_block total spend ----------------------------- 0.512108564376831
generate_one_block  0.024434566497802734
generate_one_block  0.02071070671081543
generate_one_block  0.018659114837646484
generate_one_block  0.018075942993164062
generate_one_block  0.017821550369262695
generate_one_block  0.019298315048217773
generate_one_block  0.018092870712280273
generate_one_block  0.01811361312866211
generate_one_block  0.01850128173828125
generate_one_block  0.018996477127075195
generate_one_block  0.019080638885498047
generate_one_block  0.01871490478515625
generate_one_block  0.01901721954345703
generate_one_block  0.018554210662841797
generate_one_block  0.018080949783325195
generate_one_block  0.018229246139526367
generate_one_block  0.017999649047851562
generate_one_block  0.017965078353881836
generate_one_block  0.01821136474609375
generate_one_block  0.017979145050048828
generate_one_block  0.01830291748046875
generate_one_block  0.018242835998535156
generate_one_block  0.01873183250427246
generate_one_block  0.01891613006591797
generate_one_block  0.018267393112182617
generate_one_block  0.017981529235839844
generate_one_block  0.018387556076049805
generate_one_block  0.017940521240234375
generate_one_block  0.018258333206176758
generate_one_block  0.017979860305786133
generate_one_block  0.018333911895751953
generate_one_block  0.018419742584228516
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04116988182067871
gen group dst list time:  0.02165985107421875
time for parepare:  0.020538806915283203
local_output_nid generation:  0.0053234100341796875
local_in_edges_tensor generation:  0.011876583099365234
mini_batch_src_global generation:  0.015925168991088867
r_  generation:  0.1603097915649414
local_output_nid generation:  0.008954524993896484
local_in_edges_tensor generation:  0.010792255401611328
mini_batch_src_global generation:  0.020441532135009766
r_  generation:  0.1706678867340088
local_output_nid generation:  0.009321451187133789
local_in_edges_tensor generation:  0.029506206512451172
mini_batch_src_global generation:  0.01920795440673828
r_  generation:  0.1723799705505371
local_output_nid generation:  0.009654760360717773
local_in_edges_tensor generation:  0.011295557022094727
mini_batch_src_global generation:  0.022675275802612305
r_  generation:  0.17466235160827637
local_output_nid generation:  0.010114669799804688
local_in_edges_tensor generation:  0.008331775665283203
mini_batch_src_global generation:  0.02034449577331543
r_  generation:  0.17340612411499023
local_output_nid generation:  0.010972738265991211
local_in_edges_tensor generation:  0.012524127960205078
mini_batch_src_global generation:  0.02624201774597168
r_  generation:  0.18961453437805176
local_output_nid generation:  0.010585546493530273
local_in_edges_tensor generation:  0.008596658706665039
mini_batch_src_global generation:  0.021620512008666992
r_  generation:  0.17734909057617188
local_output_nid generation:  0.010465383529663086
local_in_edges_tensor generation:  0.008814334869384766
mini_batch_src_global generation:  0.02199554443359375
r_  generation:  0.17786478996276855
local_output_nid generation:  0.01050114631652832
local_in_edges_tensor generation:  0.009951591491699219
mini_batch_src_global generation:  0.021880626678466797
r_  generation:  0.18152141571044922
local_output_nid generation:  0.01105952262878418
local_in_edges_tensor generation:  0.01220083236694336
mini_batch_src_global generation:  0.02271270751953125
r_  generation:  0.18809723854064941
local_output_nid generation:  0.011524677276611328
local_in_edges_tensor generation:  0.012208700180053711
mini_batch_src_global generation:  0.024524688720703125
r_  generation:  0.18909025192260742
local_output_nid generation:  0.011197566986083984
local_in_edges_tensor generation:  0.010440826416015625
mini_batch_src_global generation:  0.02563023567199707
r_  generation:  0.18355870246887207
local_output_nid generation:  0.011395454406738281
local_in_edges_tensor generation:  0.010745763778686523
mini_batch_src_global generation:  0.024821043014526367
r_  generation:  0.1914048194885254
local_output_nid generation:  0.011252164840698242
local_in_edges_tensor generation:  0.0089874267578125
mini_batch_src_global generation:  0.02281975746154785
r_  generation:  0.18120312690734863
local_output_nid generation:  0.011066436767578125
local_in_edges_tensor generation:  0.008999824523925781
mini_batch_src_global generation:  0.022286176681518555
r_  generation:  0.17959880828857422
local_output_nid generation:  0.011214017868041992
local_in_edges_tensor generation:  0.009017467498779297
mini_batch_src_global generation:  0.022652626037597656
r_  generation:  0.1847853660583496
local_output_nid generation:  0.011080026626586914
local_in_edges_tensor generation:  0.009120464324951172
mini_batch_src_global generation:  0.022490739822387695
r_  generation:  0.18008160591125488
local_output_nid generation:  0.011045217514038086
local_in_edges_tensor generation:  0.00880885124206543
mini_batch_src_global generation:  0.022542238235473633
r_  generation:  0.18112945556640625
local_output_nid generation:  0.010708093643188477
local_in_edges_tensor generation:  0.01022791862487793
mini_batch_src_global generation:  0.023743152618408203
r_  generation:  0.1800086498260498
local_output_nid generation:  0.010587692260742188
local_in_edges_tensor generation:  0.009055137634277344
mini_batch_src_global generation:  0.021899938583374023
r_  generation:  0.18311548233032227
local_output_nid generation:  0.010813236236572266
local_in_edges_tensor generation:  0.009042978286743164
mini_batch_src_global generation:  0.022317886352539062
r_  generation:  0.18402814865112305
local_output_nid generation:  0.010975837707519531
local_in_edges_tensor generation:  0.012284278869628906
mini_batch_src_global generation:  0.024161815643310547
r_  generation:  0.18453025817871094
local_output_nid generation:  0.011171579360961914
local_in_edges_tensor generation:  0.00939178466796875
mini_batch_src_global generation:  0.024456024169921875
r_  generation:  0.18693804740905762
local_output_nid generation:  0.011278152465820312
local_in_edges_tensor generation:  0.011042118072509766
mini_batch_src_global generation:  0.025037050247192383
r_  generation:  0.19220590591430664
local_output_nid generation:  0.011048078536987305
local_in_edges_tensor generation:  0.012014627456665039
mini_batch_src_global generation:  0.024933338165283203
r_  generation:  0.1859760284423828
local_output_nid generation:  0.012141227722167969
local_in_edges_tensor generation:  0.012666463851928711
mini_batch_src_global generation:  0.030626296997070312
r_  generation:  0.18414640426635742
local_output_nid generation:  0.012279510498046875
local_in_edges_tensor generation:  0.014143228530883789
mini_batch_src_global generation:  0.03000617027282715
r_  generation:  0.1877148151397705
local_output_nid generation:  0.011049270629882812
local_in_edges_tensor generation:  0.009869813919067383
mini_batch_src_global generation:  0.022605419158935547
r_  generation:  0.18179726600646973
local_output_nid generation:  0.011107444763183594
local_in_edges_tensor generation:  0.00957489013671875
mini_batch_src_global generation:  0.02397632598876953
r_  generation:  0.18275785446166992
local_output_nid generation:  0.011019468307495117
local_in_edges_tensor generation:  0.011482954025268555
mini_batch_src_global generation:  0.022975921630859375
r_  generation:  0.1810142993927002
local_output_nid generation:  0.011298179626464844
local_in_edges_tensor generation:  0.009455204010009766
mini_batch_src_global generation:  0.02240753173828125
r_  generation:  0.18123412132263184
local_output_nid generation:  0.011379480361938477
local_in_edges_tensor generation:  0.012937545776367188
mini_batch_src_global generation:  0.023013591766357422
r_  generation:  0.18391060829162598
----------------------check_connections_block total spend ----------------------------- 8.58630108833313
generate_one_block  0.24804353713989258
generate_one_block  0.24147462844848633
generate_one_block  0.239271879196167
generate_one_block  0.24136853218078613
generate_one_block  0.2677910327911377
generate_one_block  0.25851917266845703
generate_one_block  0.23964524269104004
generate_one_block  0.24056243896484375
generate_one_block  0.24228525161743164
generate_one_block  0.2546696662902832
generate_one_block  0.2582888603210449
generate_one_block  0.2541823387145996
generate_one_block  0.26306867599487305
generate_one_block  0.23830270767211914
generate_one_block  0.2381429672241211
generate_one_block  0.2472848892211914
generate_one_block  0.24204778671264648
generate_one_block  0.24163174629211426
generate_one_block  0.24163103103637695
generate_one_block  0.24493098258972168
generate_one_block  0.2453904151916504
generate_one_block  0.24724721908569336
generate_one_block  0.25522780418395996
generate_one_block  0.26106905937194824
generate_one_block  0.24862408638000488
generate_one_block  0.24485349655151367
generate_one_block  0.2541615962982178
generate_one_block  0.23926734924316406
generate_one_block  0.24688935279846191
generate_one_block  0.2443714141845703
generate_one_block  0.24399852752685547
generate_one_block  0.25145387649536133
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04564666748046875
gen group dst list time:  0.10222244262695312
time for parepare:  0.01779627799987793
local_output_nid generation:  0.024594545364379883
local_in_edges_tensor generation:  0.0507509708404541
mini_batch_src_global generation:  0.04149985313415527
r_  generation:  0.4249708652496338
local_output_nid generation:  0.030570507049560547
local_in_edges_tensor generation:  0.044765472412109375
mini_batch_src_global generation:  0.04821634292602539
r_  generation:  0.4373464584350586
local_output_nid generation:  0.02938699722290039
local_in_edges_tensor generation:  0.03652143478393555
mini_batch_src_global generation:  0.04744100570678711
r_  generation:  0.43271636962890625
local_output_nid generation:  0.028348684310913086
local_in_edges_tensor generation:  0.02870631217956543
mini_batch_src_global generation:  0.04778790473937988
r_  generation:  0.42897772789001465
local_output_nid generation:  0.028867721557617188
local_in_edges_tensor generation:  0.036031246185302734
mini_batch_src_global generation:  0.04812502861022949
r_  generation:  0.4372591972351074
local_output_nid generation:  0.02890467643737793
local_in_edges_tensor generation:  0.03303956985473633
mini_batch_src_global generation:  0.04955101013183594
r_  generation:  0.4376547336578369
local_output_nid generation:  0.028934240341186523
local_in_edges_tensor generation:  0.032937049865722656
mini_batch_src_global generation:  0.04907417297363281
r_  generation:  0.4367403984069824
local_output_nid generation:  0.02931523323059082
local_in_edges_tensor generation:  0.03316998481750488
mini_batch_src_global generation:  0.05011749267578125
r_  generation:  0.44411635398864746
local_output_nid generation:  0.029387235641479492
local_in_edges_tensor generation:  0.03305816650390625
mini_batch_src_global generation:  0.05279397964477539
r_  generation:  0.44072651863098145
local_output_nid generation:  0.029580116271972656
local_in_edges_tensor generation:  0.0369875431060791
mini_batch_src_global generation:  0.05030202865600586
r_  generation:  0.4401741027832031
local_output_nid generation:  0.029720306396484375
local_in_edges_tensor generation:  0.03324723243713379
mini_batch_src_global generation:  0.050013065338134766
r_  generation:  0.4433612823486328
local_output_nid generation:  0.02923727035522461
local_in_edges_tensor generation:  0.030684709548950195
mini_batch_src_global generation:  0.05160665512084961
r_  generation:  0.43627452850341797
local_output_nid generation:  0.02927994728088379
local_in_edges_tensor generation:  0.0353550910949707
mini_batch_src_global generation:  0.04936838150024414
r_  generation:  0.44351720809936523
local_output_nid generation:  0.02930593490600586
local_in_edges_tensor generation:  0.03273153305053711
mini_batch_src_global generation:  0.04953598976135254
r_  generation:  0.43409013748168945
local_output_nid generation:  0.02899765968322754
local_in_edges_tensor generation:  0.03661608695983887
mini_batch_src_global generation:  0.04894876480102539
r_  generation:  0.43835020065307617
local_output_nid generation:  0.029297351837158203
local_in_edges_tensor generation:  0.033277273178100586
mini_batch_src_global generation:  0.05327773094177246
r_  generation:  0.4377140998840332
local_output_nid generation:  0.029334545135498047
local_in_edges_tensor generation:  0.03331446647644043
mini_batch_src_global generation:  0.049939870834350586
r_  generation:  0.44153785705566406
local_output_nid generation:  0.02915644645690918
local_in_edges_tensor generation:  0.03352522850036621
mini_batch_src_global generation:  0.04986572265625
r_  generation:  0.4381883144378662
local_output_nid generation:  0.02913498878479004
local_in_edges_tensor generation:  0.032576560974121094
mini_batch_src_global generation:  0.04956650733947754
r_  generation:  0.4327883720397949
local_output_nid generation:  0.02931356430053711
local_in_edges_tensor generation:  0.03334689140319824
mini_batch_src_global generation:  0.04963207244873047
r_  generation:  0.4382972717285156
local_output_nid generation:  0.029176950454711914
local_in_edges_tensor generation:  0.04045677185058594
mini_batch_src_global generation:  0.04917144775390625
r_  generation:  0.4369518756866455
local_output_nid generation:  0.029407978057861328
local_in_edges_tensor generation:  0.033013105392456055
mini_batch_src_global generation:  0.05054044723510742
r_  generation:  0.44077301025390625
local_output_nid generation:  0.030020952224731445
local_in_edges_tensor generation:  0.037554025650024414
mini_batch_src_global generation:  0.049163818359375
r_  generation:  0.44240474700927734
local_output_nid generation:  0.02940988540649414
local_in_edges_tensor generation:  0.03007030487060547
mini_batch_src_global generation:  0.049956560134887695
r_  generation:  0.4418184757232666
local_output_nid generation:  0.03288102149963379
local_in_edges_tensor generation:  0.034742116928100586
mini_batch_src_global generation:  0.0526123046875
r_  generation:  0.44266510009765625
local_output_nid generation:  0.029579639434814453
local_in_edges_tensor generation:  0.030089378356933594
mini_batch_src_global generation:  0.05013418197631836
r_  generation:  0.4395596981048584
local_output_nid generation:  0.029340744018554688
local_in_edges_tensor generation:  0.029608964920043945
mini_batch_src_global generation:  0.05070638656616211
r_  generation:  0.44197940826416016
local_output_nid generation:  0.029297590255737305
local_in_edges_tensor generation:  0.03300762176513672
mini_batch_src_global generation:  0.05155467987060547
r_  generation:  0.4466068744659424
local_output_nid generation:  0.0292661190032959
local_in_edges_tensor generation:  0.036946773529052734
mini_batch_src_global generation:  0.05042123794555664
r_  generation:  0.43823695182800293
local_output_nid generation:  0.029695510864257812
local_in_edges_tensor generation:  0.03280210494995117
mini_batch_src_global generation:  0.05059814453125
r_  generation:  0.4395565986633301
local_output_nid generation:  0.029444217681884766
local_in_edges_tensor generation:  0.03743767738342285
mini_batch_src_global generation:  0.049932003021240234
r_  generation:  0.4439280033111572
local_output_nid generation:  0.02944207191467285
local_in_edges_tensor generation:  0.03295469284057617
mini_batch_src_global generation:  0.05480527877807617
r_  generation:  0.43936657905578613
----------------------check_connections_block total spend ----------------------------- 20.758052110671997
generate_one_block  0.5794382095336914
generate_one_block  0.5753250122070312
generate_one_block  0.5755152702331543
generate_one_block  0.5728633403778076
generate_one_block  0.6646444797515869
generate_one_block  0.5882606506347656
generate_one_block  0.5730381011962891
generate_one_block  0.5857977867126465
generate_one_block  0.5916604995727539
generate_one_block  0.5883290767669678
generate_one_block  0.5792701244354248
generate_one_block  0.5688173770904541
generate_one_block  0.5749936103820801
generate_one_block  0.5687029361724854
generate_one_block  0.5760636329650879
generate_one_block  0.5994260311126709
generate_one_block  0.5834505558013916
generate_one_block  0.5741727352142334
generate_one_block  0.567418098449707
generate_one_block  0.5878658294677734
generate_one_block  0.575798511505127
generate_one_block  0.5866038799285889
generate_one_block  0.5929791927337646
generate_one_block  0.5843722820281982
generate_one_block  0.5989727973937988
generate_one_block  0.5709574222564697
generate_one_block  0.5758295059204102
generate_one_block  0.5799925327301025
generate_one_block  0.5738275051116943
generate_one_block  0.5776371955871582
generate_one_block  0.6486001014709473
generate_one_block  0.6168725490570068
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.4803466796875 GB
    Memory Allocated: 0.12709999084472656  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

connection checking time:  29.344353199005127
block generation total time  26.683194398880005
average batch blocks generation time:  0.8338498249650002
block dataloader generation time/epoch 59.45909094810486
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4803466796875 GB
    Memory Allocated: 0.10665225982666016  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

torch.Size([149059, 128])
torch.Size([109602, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4803466796875 GB
    Memory Allocated: 18.822486400604248  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4803466796875 GB
    Memory Allocated: 0.10648918151855469  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

torch.Size([148602, 128])
torch.Size([109711, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4803466796875 GB
    Memory Allocated: 18.89078187942505  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4803466796875 GB
    Memory Allocated: 0.10667610168457031  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

torch.Size([149234, 128])
torch.Size([109723, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4803466796875 GB
    Memory Allocated: 18.624186992645264  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4803466796875 GB
    Memory Allocated: 0.10567235946655273  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

torch.Size([147231, 128])
torch.Size([107221, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4803466796875 GB
    Memory Allocated: 18.62669563293457  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4803466796875 GB
    Memory Allocated: 0.10632658004760742  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

torch.Size([148637, 128])
torch.Size([108927, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4803466796875 GB
    Memory Allocated: 18.5575532913208  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4803466796875 GB
    Memory Allocated: 0.10681581497192383  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

torch.Size([148685, 128])
torch.Size([109905, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4803466796875 GB
    Memory Allocated: 19.442944526672363  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4803466796875 GB
    Memory Allocated: 0.10628128051757812  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

torch.Size([148452, 128])
torch.Size([108735, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4803466796875 GB
    Memory Allocated: 18.614781856536865  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4803466796875 GB
    Memory Allocated: 0.10666990280151367  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

torch.Size([149127, 128])
torch.Size([110498, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4803466796875 GB
    Memory Allocated: 18.742984771728516  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4803466796875 GB
    Memory Allocated: 0.10790443420410156  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

torch.Size([149602, 128])
torch.Size([110970, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4803466796875 GB
    Memory Allocated: 18.884331703186035  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4803466796875 GB
    Memory Allocated: 0.10684919357299805  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

torch.Size([148891, 128])
torch.Size([110672, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4803466796875 GB
    Memory Allocated: 19.37269639968872  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4803466796875 GB
    Memory Allocated: 0.10700654983520508  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

torch.Size([149153, 128])
torch.Size([110927, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4803466796875 GB
    Memory Allocated: 19.35141611099243  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4803466796875 GB
    Memory Allocated: 0.1064004898071289  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

torch.Size([148380, 128])
torch.Size([109322, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4803466796875 GB
    Memory Allocated: 18.943843364715576  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4803466796875 GB
    Memory Allocated: 0.10673141479492188  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

torch.Size([148600, 128])
torch.Size([109942, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 19.372745990753174  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4979248046875 GB
    Memory Allocated: 0.10642576217651367  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

torch.Size([148719, 128])
torch.Size([109234, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4979248046875 GB
    Memory Allocated: 18.62306499481201  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4979248046875 GB
    Memory Allocated: 0.10622072219848633  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

torch.Size([148359, 128])
torch.Size([108921, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4979248046875 GB
    Memory Allocated: 18.630260467529297  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4979248046875 GB
    Memory Allocated: 0.10678863525390625  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

torch.Size([149114, 128])
torch.Size([109856, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4979248046875 GB
    Memory Allocated: 19.022006511688232  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4979248046875 GB
    Memory Allocated: 0.10656309127807617  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

torch.Size([148843, 128])
torch.Size([110216, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4979248046875 GB
    Memory Allocated: 18.78921604156494  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4979248046875 GB
    Memory Allocated: 0.1063232421875  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

torch.Size([148446, 128])
torch.Size([109315, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4979248046875 GB
    Memory Allocated: 18.716763019561768  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4979248046875 GB
    Memory Allocated: 0.10627079010009766  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

torch.Size([148392, 128])
torch.Size([109109, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4979248046875 GB
    Memory Allocated: 18.625224113464355  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4979248046875 GB
    Memory Allocated: 0.1065378189086914  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

torch.Size([148958, 128])
torch.Size([109798, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4979248046875 GB
    Memory Allocated: 18.654632568359375  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4979248046875 GB
    Memory Allocated: 0.10653877258300781  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

torch.Size([148916, 128])
torch.Size([109181, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4979248046875 GB
    Memory Allocated: 18.709228038787842  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4979248046875 GB
    Memory Allocated: 0.10683679580688477  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

torch.Size([149265, 128])
torch.Size([110613, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4979248046875 GB
    Memory Allocated: 18.91396951675415  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4979248046875 GB
    Memory Allocated: 0.10687971115112305  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

torch.Size([149073, 128])
torch.Size([110709, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4979248046875 GB
    Memory Allocated: 19.174187660217285  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4979248046875 GB
    Memory Allocated: 0.10683155059814453  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

torch.Size([148738, 128])
torch.Size([110234, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4979248046875 GB
    Memory Allocated: 19.42660093307495  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4979248046875 GB
    Memory Allocated: 0.10694646835327148  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

torch.Size([149255, 128])
torch.Size([110823, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4979248046875 GB
    Memory Allocated: 19.167300701141357  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4979248046875 GB
    Memory Allocated: 0.10649538040161133  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

torch.Size([148511, 128])
torch.Size([109829, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4979248046875 GB
    Memory Allocated: 19.030427932739258  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4979248046875 GB
    Memory Allocated: 0.106689453125  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

torch.Size([148744, 128])
torch.Size([109533, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4979248046875 GB
    Memory Allocated: 19.16854476928711  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4979248046875 GB
    Memory Allocated: 0.10668230056762695  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

torch.Size([149073, 128])
torch.Size([110024, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4979248046875 GB
    Memory Allocated: 18.904058933258057  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4979248046875 GB
    Memory Allocated: 0.10646772384643555  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

torch.Size([148511, 128])
torch.Size([109374, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4979248046875 GB
    Memory Allocated: 18.930434703826904  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4979248046875 GB
    Memory Allocated: 0.10682153701782227  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

torch.Size([149313, 128])
torch.Size([110193, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4979248046875 GB
    Memory Allocated: 18.868608951568604  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4979248046875 GB
    Memory Allocated: 0.10656356811523438  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

torch.Size([148754, 128])
torch.Size([109782, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4979248046875 GB
    Memory Allocated: 18.827855110168457  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4979248046875 GB
    Memory Allocated: 0.10646820068359375  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

torch.Size([148370, 128])
torch.Size([109437, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4979248046875 GB
    Memory Allocated: 19.116316318511963  GigaBytes
Max Memory Allocated: 19.598307609558105  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0237908735871315 |0.020937204360961914 |0.566668376326561 |9.860843420028687e-05 |1.0840363875031471 |0.005474567413330078 |
----------------------------------------------------------pseudo_mini_loss sum 3.959303855895996
Total (block generation + training)time/epoch 113.78630304336548
Training time/epoch 54.32691287994385
Training time without block to device /epoch 53.656922340393066
Training time without total dataloading part /epoch 52.8311824798584
load block tensor time/epoch 0.761307954788208
block to device time/epoch 0.6699905395507812
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9113120
Number of first layer input nodes during this epoch:  4761007
