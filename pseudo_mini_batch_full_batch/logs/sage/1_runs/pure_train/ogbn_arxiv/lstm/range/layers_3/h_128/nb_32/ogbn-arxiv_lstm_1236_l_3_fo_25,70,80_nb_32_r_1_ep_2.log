Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648473605.4058383
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017633438110351562  GigaBytes
Max Memory Allocated: 0.0017633438110351562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.028290748596191406
range selection method range initialization spend 0.013361454010009766
time for parepare:  0.01820230484008789
local_output_nid generation:  0.0007011890411376953
local_in_edges_tensor generation:  0.00399017333984375
mini_batch_src_global generation:  0.0014083385467529297
r_  generation:  0.009891986846923828
local_output_nid generation:  0.0007457733154296875
local_in_edges_tensor generation:  0.0005712509155273438
mini_batch_src_global generation:  0.0014715194702148438
r_  generation:  0.009456396102905273
local_output_nid generation:  0.0007390975952148438
local_in_edges_tensor generation:  0.000518798828125
mini_batch_src_global generation:  0.0009570121765136719
r_  generation:  0.009085416793823242
local_output_nid generation:  0.0007598400115966797
local_in_edges_tensor generation:  0.0004925727844238281
mini_batch_src_global generation:  0.0009167194366455078
r_  generation:  0.009220123291015625
local_output_nid generation:  0.0007417201995849609
local_in_edges_tensor generation:  0.0004987716674804688
mini_batch_src_global generation:  0.0009369850158691406
r_  generation:  0.00995016098022461
local_output_nid generation:  0.0007536411285400391
local_in_edges_tensor generation:  0.0004999637603759766
mini_batch_src_global generation:  0.0009615421295166016
r_  generation:  0.009711503982543945
local_output_nid generation:  0.0007436275482177734
local_in_edges_tensor generation:  0.00048542022705078125
mini_batch_src_global generation:  0.0009608268737792969
r_  generation:  0.009588479995727539
local_output_nid generation:  0.0007565021514892578
local_in_edges_tensor generation:  0.00048422813415527344
mini_batch_src_global generation:  0.0009503364562988281
r_  generation:  0.009684324264526367
local_output_nid generation:  0.0007450580596923828
local_in_edges_tensor generation:  0.00047588348388671875
mini_batch_src_global generation:  0.0010750293731689453
r_  generation:  0.010190248489379883
local_output_nid generation:  0.0007665157318115234
local_in_edges_tensor generation:  0.0004813671112060547
mini_batch_src_global generation:  0.0009524822235107422
r_  generation:  0.00958108901977539
local_output_nid generation:  0.0007491111755371094
local_in_edges_tensor generation:  0.00047588348388671875
mini_batch_src_global generation:  0.0009605884552001953
r_  generation:  0.009694099426269531
local_output_nid generation:  0.0007538795471191406
local_in_edges_tensor generation:  0.00047206878662109375
mini_batch_src_global generation:  0.000942230224609375
r_  generation:  0.00971531867980957
local_output_nid generation:  0.0007488727569580078
local_in_edges_tensor generation:  0.0004706382751464844
mini_batch_src_global generation:  0.0009722709655761719
r_  generation:  0.009848594665527344
local_output_nid generation:  0.0007579326629638672
local_in_edges_tensor generation:  0.0004780292510986328
mini_batch_src_global generation:  0.0009644031524658203
r_  generation:  0.009703874588012695
local_output_nid generation:  0.0007545948028564453
local_in_edges_tensor generation:  0.00047469139099121094
mini_batch_src_global generation:  0.0009834766387939453
r_  generation:  0.010224342346191406
local_output_nid generation:  0.0007424354553222656
local_in_edges_tensor generation:  0.0004813671112060547
mini_batch_src_global generation:  0.0009353160858154297
r_  generation:  0.009639978408813477
local_output_nid generation:  0.0007722377777099609
local_in_edges_tensor generation:  0.0004792213439941406
mini_batch_src_global generation:  0.0009846687316894531
r_  generation:  0.009742259979248047
local_output_nid generation:  0.0007619857788085938
local_in_edges_tensor generation:  0.0004897117614746094
mini_batch_src_global generation:  0.0009918212890625
r_  generation:  0.010151386260986328
local_output_nid generation:  0.0007622241973876953
local_in_edges_tensor generation:  0.00047779083251953125
mini_batch_src_global generation:  0.0009791851043701172
r_  generation:  0.010074377059936523
local_output_nid generation:  0.0007610321044921875
local_in_edges_tensor generation:  0.00047707557678222656
mini_batch_src_global generation:  0.000995635986328125
r_  generation:  0.009826898574829102
local_output_nid generation:  0.0007500648498535156
local_in_edges_tensor generation:  0.00047659873962402344
mini_batch_src_global generation:  0.0010318756103515625
r_  generation:  0.010525226593017578
local_output_nid generation:  0.0007507801055908203
local_in_edges_tensor generation:  0.00047516822814941406
mini_batch_src_global generation:  0.0010144710540771484
r_  generation:  0.009793281555175781
local_output_nid generation:  0.0007660388946533203
local_in_edges_tensor generation:  0.0004820823669433594
mini_batch_src_global generation:  0.0010285377502441406
r_  generation:  0.010539770126342773
local_output_nid generation:  0.0007572174072265625
local_in_edges_tensor generation:  0.00047969818115234375
mini_batch_src_global generation:  0.0010199546813964844
r_  generation:  0.00986170768737793
local_output_nid generation:  0.0007638931274414062
local_in_edges_tensor generation:  0.00047016143798828125
mini_batch_src_global generation:  0.001007080078125
r_  generation:  0.010098695755004883
local_output_nid generation:  0.0007815361022949219
local_in_edges_tensor generation:  0.0004978179931640625
mini_batch_src_global generation:  0.0010058879852294922
r_  generation:  0.009982585906982422
local_output_nid generation:  0.0007624626159667969
local_in_edges_tensor generation:  0.00047469139099121094
mini_batch_src_global generation:  0.0011076927185058594
r_  generation:  0.009769678115844727
local_output_nid generation:  0.0007524490356445312
local_in_edges_tensor generation:  0.0004763603210449219
mini_batch_src_global generation:  0.0010039806365966797
r_  generation:  0.009853124618530273
local_output_nid generation:  0.0007510185241699219
local_in_edges_tensor generation:  0.00046944618225097656
mini_batch_src_global generation:  0.0010085105895996094
r_  generation:  0.009886980056762695
local_output_nid generation:  0.0007424354553222656
local_in_edges_tensor generation:  0.00425267219543457
mini_batch_src_global generation:  0.0011687278747558594
r_  generation:  0.009842395782470703
local_output_nid generation:  0.0008156299591064453
local_in_edges_tensor generation:  0.0005116462707519531
mini_batch_src_global generation:  0.0010476112365722656
r_  generation:  0.009846210479736328
local_output_nid generation:  0.0007793903350830078
local_in_edges_tensor generation:  0.0004863739013671875
mini_batch_src_global generation:  0.0010151863098144531
r_  generation:  0.009998798370361328
----------------------check_connections_block total spend ----------------------------- 0.48547816276550293
generate_one_block  0.014730453491210938
generate_one_block  0.014795541763305664
generate_one_block  0.014581680297851562
generate_one_block  0.014697074890136719
generate_one_block  0.015671491622924805
generate_one_block  0.01501774787902832
generate_one_block  0.014819622039794922
generate_one_block  0.015311479568481445
generate_one_block  0.015241861343383789
generate_one_block  0.014459609985351562
generate_one_block  0.014701128005981445
generate_one_block  0.014292478561401367
generate_one_block  0.014897584915161133
generate_one_block  0.01446533203125
generate_one_block  0.015389442443847656
generate_one_block  0.014072895050048828
generate_one_block  0.014463663101196289
generate_one_block  0.01520681381225586
generate_one_block  0.014694690704345703
generate_one_block  0.014513969421386719
generate_one_block  0.0156705379486084
generate_one_block  0.01452946662902832
generate_one_block  0.015240907669067383
generate_one_block  0.014627695083618164
generate_one_block  0.014887809753417969
generate_one_block  0.014721870422363281
generate_one_block  0.014432668685913086
generate_one_block  0.014628410339355469
generate_one_block  0.014918088912963867
generate_one_block  0.014404773712158203
generate_one_block  0.014873981475830078
generate_one_block  0.014923572540283203
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.044055938720703125
gen group dst list time:  0.023311138153076172
time for parepare:  0.019756555557250977
local_output_nid generation:  0.0042307376861572266
local_in_edges_tensor generation:  0.013647079467773438
mini_batch_src_global generation:  0.01580810546875
r_  generation:  0.15732860565185547
local_output_nid generation:  0.008146524429321289
local_in_edges_tensor generation:  0.014309167861938477
mini_batch_src_global generation:  0.020034313201904297
r_  generation:  0.16436314582824707
local_output_nid generation:  0.008854150772094727
local_in_edges_tensor generation:  0.01182103157043457
mini_batch_src_global generation:  0.019453048706054688
r_  generation:  0.17003107070922852
local_output_nid generation:  0.008644580841064453
local_in_edges_tensor generation:  0.010673046112060547
mini_batch_src_global generation:  0.02043914794921875
r_  generation:  0.17505645751953125
local_output_nid generation:  0.009117603302001953
local_in_edges_tensor generation:  0.014603853225708008
mini_batch_src_global generation:  0.02209782600402832
r_  generation:  0.18448686599731445
local_output_nid generation:  0.009176492691040039
local_in_edges_tensor generation:  0.009990930557250977
mini_batch_src_global generation:  0.02213144302368164
r_  generation:  0.1795053482055664
local_output_nid generation:  0.009134054183959961
local_in_edges_tensor generation:  0.01076960563659668
mini_batch_src_global generation:  0.02216649055480957
r_  generation:  0.1807262897491455
local_output_nid generation:  0.00934457778930664
local_in_edges_tensor generation:  0.012765884399414062
mini_batch_src_global generation:  0.02274155616760254
r_  generation:  0.1853780746459961
local_output_nid generation:  0.009563922882080078
local_in_edges_tensor generation:  0.013204574584960938
mini_batch_src_global generation:  0.0228884220123291
r_  generation:  0.18390512466430664
local_output_nid generation:  0.009056568145751953
local_in_edges_tensor generation:  0.009449958801269531
mini_batch_src_global generation:  0.021578073501586914
r_  generation:  0.16962790489196777
local_output_nid generation:  0.009391546249389648
local_in_edges_tensor generation:  0.00968623161315918
mini_batch_src_global generation:  0.021919727325439453
r_  generation:  0.17797327041625977
local_output_nid generation:  0.00937199592590332
local_in_edges_tensor generation:  0.011705636978149414
mini_batch_src_global generation:  0.021979808807373047
r_  generation:  0.17435836791992188
local_output_nid generation:  0.009690523147583008
local_in_edges_tensor generation:  0.013005495071411133
mini_batch_src_global generation:  0.023441791534423828
r_  generation:  0.18454456329345703
local_output_nid generation:  0.009509801864624023
local_in_edges_tensor generation:  0.010904073715209961
mini_batch_src_global generation:  0.022154808044433594
r_  generation:  0.17426204681396484
local_output_nid generation:  0.009829998016357422
local_in_edges_tensor generation:  0.011542081832885742
mini_batch_src_global generation:  0.02436995506286621
r_  generation:  0.1873927116394043
local_output_nid generation:  0.009366989135742188
local_in_edges_tensor generation:  0.009688854217529297
mini_batch_src_global generation:  0.0227663516998291
r_  generation:  0.17477846145629883
local_output_nid generation:  0.009537935256958008
local_in_edges_tensor generation:  0.011029481887817383
mini_batch_src_global generation:  0.02381300926208496
r_  generation:  0.17809033393859863
local_output_nid generation:  0.009901285171508789
local_in_edges_tensor generation:  0.014723062515258789
mini_batch_src_global generation:  0.024973154067993164
r_  generation:  0.1878204345703125
local_output_nid generation:  0.009520530700683594
local_in_edges_tensor generation:  0.00992274284362793
mini_batch_src_global generation:  0.02296304702758789
r_  generation:  0.17935633659362793
local_output_nid generation:  0.009586572647094727
local_in_edges_tensor generation:  0.011012554168701172
mini_batch_src_global generation:  0.02290487289428711
r_  generation:  0.17895054817199707
local_output_nid generation:  0.01023101806640625
local_in_edges_tensor generation:  0.01217508316040039
mini_batch_src_global generation:  0.02504134178161621
r_  generation:  0.1910996437072754
local_output_nid generation:  0.009606122970581055
local_in_edges_tensor generation:  0.010240554809570312
mini_batch_src_global generation:  0.022638320922851562
r_  generation:  0.18097925186157227
local_output_nid generation:  0.010161876678466797
local_in_edges_tensor generation:  0.010326623916625977
mini_batch_src_global generation:  0.0230863094329834
r_  generation:  0.18293309211730957
local_output_nid generation:  0.009684562683105469
local_in_edges_tensor generation:  0.012959957122802734
mini_batch_src_global generation:  0.023014068603515625
r_  generation:  0.1789257526397705
local_output_nid generation:  0.010049104690551758
local_in_edges_tensor generation:  0.01179957389831543
mini_batch_src_global generation:  0.024317026138305664
r_  generation:  0.18260431289672852
local_output_nid generation:  0.00968480110168457
local_in_edges_tensor generation:  0.012843847274780273
mini_batch_src_global generation:  0.022808551788330078
r_  generation:  0.18065524101257324
local_output_nid generation:  0.009633779525756836
local_in_edges_tensor generation:  0.009603500366210938
mini_batch_src_global generation:  0.022266387939453125
r_  generation:  0.1792290210723877
local_output_nid generation:  0.00974130630493164
local_in_edges_tensor generation:  0.010270357131958008
mini_batch_src_global generation:  0.023333072662353516
r_  generation:  0.18149185180664062
local_output_nid generation:  0.010129213333129883
local_in_edges_tensor generation:  0.013087272644042969
mini_batch_src_global generation:  0.022756338119506836
r_  generation:  0.18109703063964844
local_output_nid generation:  0.00952291488647461
local_in_edges_tensor generation:  0.009772539138793945
mini_batch_src_global generation:  0.021956920623779297
r_  generation:  0.17952919006347656
local_output_nid generation:  0.009758472442626953
local_in_edges_tensor generation:  0.010825872421264648
mini_batch_src_global generation:  0.022291183471679688
r_  generation:  0.1785573959350586
local_output_nid generation:  0.009743690490722656
local_in_edges_tensor generation:  0.012774467468261719
mini_batch_src_global generation:  0.023072242736816406
r_  generation:  0.1816709041595459
----------------------check_connections_block total spend ----------------------------- 8.427886009216309
generate_one_block  0.2236473560333252
generate_one_block  0.2220017910003662
generate_one_block  0.24891424179077148
generate_one_block  0.231001615524292
generate_one_block  0.24071407318115234
generate_one_block  0.23465514183044434
generate_one_block  0.22194743156433105
generate_one_block  0.23450732231140137
generate_one_block  0.23918581008911133
generate_one_block  0.21173548698425293
generate_one_block  0.22061872482299805
generate_one_block  0.21844744682312012
generate_one_block  0.23152923583984375
generate_one_block  0.2184159755706787
generate_one_block  0.24176359176635742
generate_one_block  0.23816156387329102
generate_one_block  0.2206711769104004
generate_one_block  0.24222421646118164
generate_one_block  0.22488093376159668
generate_one_block  0.22048568725585938
generate_one_block  0.24167609214782715
generate_one_block  0.21809887886047363
generate_one_block  0.23711156845092773
generate_one_block  0.2257540225982666
generate_one_block  0.23100829124450684
generate_one_block  0.2289433479309082
generate_one_block  0.22309255599975586
generate_one_block  0.2310028076171875
generate_one_block  0.22900080680847168
generate_one_block  0.21942138671875
generate_one_block  0.220841646194458
generate_one_block  0.23073649406433105
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03622245788574219
gen group dst list time:  0.10150551795959473
time for parepare:  0.019151926040649414
local_output_nid generation:  0.02170419692993164
local_in_edges_tensor generation:  0.04017972946166992
mini_batch_src_global generation:  0.04224133491516113
r_  generation:  0.40924739837646484
local_output_nid generation:  0.028469562530517578
local_in_edges_tensor generation:  0.042772531509399414
mini_batch_src_global generation:  0.049111127853393555
r_  generation:  0.41764187812805176
local_output_nid generation:  0.028928518295288086
local_in_edges_tensor generation:  0.035982370376586914
mini_batch_src_global generation:  0.04809427261352539
r_  generation:  0.43179750442504883
local_output_nid generation:  0.027224063873291016
local_in_edges_tensor generation:  0.03203392028808594
mini_batch_src_global generation:  0.04897046089172363
r_  generation:  0.42624568939208984
local_output_nid generation:  0.02754378318786621
local_in_edges_tensor generation:  0.03551077842712402
mini_batch_src_global generation:  0.05299091339111328
r_  generation:  0.4313316345214844
local_output_nid generation:  0.02751445770263672
local_in_edges_tensor generation:  0.03171038627624512
mini_batch_src_global generation:  0.05028891563415527
r_  generation:  0.4328629970550537
local_output_nid generation:  0.02716684341430664
local_in_edges_tensor generation:  0.029278039932250977
mini_batch_src_global generation:  0.05125069618225098
r_  generation:  0.4299468994140625
local_output_nid generation:  0.027863264083862305
local_in_edges_tensor generation:  0.029578685760498047
mini_batch_src_global generation:  0.0505366325378418
r_  generation:  0.43170714378356934
local_output_nid generation:  0.0277252197265625
local_in_edges_tensor generation:  0.03349161148071289
mini_batch_src_global generation:  0.051352500915527344
r_  generation:  0.4382598400115967
local_output_nid generation:  0.030710935592651367
local_in_edges_tensor generation:  0.027726173400878906
mini_batch_src_global generation:  0.05075716972351074
r_  generation:  0.42803382873535156
local_output_nid generation:  0.027714967727661133
local_in_edges_tensor generation:  0.0330662727355957
mini_batch_src_global generation:  0.0534517765045166
r_  generation:  0.43950629234313965
local_output_nid generation:  0.027382850646972656
local_in_edges_tensor generation:  0.03534698486328125
mini_batch_src_global generation:  0.05001068115234375
r_  generation:  0.42921876907348633
local_output_nid generation:  0.028037071228027344
local_in_edges_tensor generation:  0.03628993034362793
mini_batch_src_global generation:  0.05439257621765137
r_  generation:  0.439133882522583
local_output_nid generation:  0.027675390243530273
local_in_edges_tensor generation:  0.04199361801147461
mini_batch_src_global generation:  0.05223584175109863
r_  generation:  0.42877745628356934
local_output_nid generation:  0.028062105178833008
local_in_edges_tensor generation:  0.03390383720397949
mini_batch_src_global generation:  0.05012106895446777
r_  generation:  0.446699857711792
local_output_nid generation:  0.027584075927734375
local_in_edges_tensor generation:  0.026076316833496094
mini_batch_src_global generation:  0.05062508583068848
r_  generation:  0.43098878860473633
local_output_nid generation:  0.02773737907409668
local_in_edges_tensor generation:  0.026526451110839844
mini_batch_src_global generation:  0.05057978630065918
r_  generation:  0.43106913566589355
local_output_nid generation:  0.02796149253845215
local_in_edges_tensor generation:  0.03824949264526367
mini_batch_src_global generation:  0.05014371871948242
r_  generation:  0.43533968925476074
local_output_nid generation:  0.02787327766418457
local_in_edges_tensor generation:  0.027754545211791992
mini_batch_src_global generation:  0.0500178337097168
r_  generation:  0.442263126373291
local_output_nid generation:  0.028884172439575195
local_in_edges_tensor generation:  0.027022361755371094
mini_batch_src_global generation:  0.050963640213012695
r_  generation:  0.4314308166503906
local_output_nid generation:  0.02817988395690918
local_in_edges_tensor generation:  0.03441739082336426
mini_batch_src_global generation:  0.0533297061920166
r_  generation:  0.4378981590270996
local_output_nid generation:  0.027602672576904297
local_in_edges_tensor generation:  0.029478073120117188
mini_batch_src_global generation:  0.05070781707763672
r_  generation:  0.43869590759277344
local_output_nid generation:  0.02853989601135254
local_in_edges_tensor generation:  0.033657073974609375
mini_batch_src_global generation:  0.0543060302734375
r_  generation:  0.4399271011352539
local_output_nid generation:  0.02779364585876465
local_in_edges_tensor generation:  0.03349876403808594
mini_batch_src_global generation:  0.05085897445678711
r_  generation:  0.4360654354095459
local_output_nid generation:  0.028141260147094727
local_in_edges_tensor generation:  0.03016948699951172
mini_batch_src_global generation:  0.051149845123291016
r_  generation:  0.4440786838531494
local_output_nid generation:  0.027854442596435547
local_in_edges_tensor generation:  0.03789496421813965
mini_batch_src_global generation:  0.05776262283325195
r_  generation:  0.43402743339538574
local_output_nid generation:  0.027920961380004883
local_in_edges_tensor generation:  0.03120875358581543
mini_batch_src_global generation:  0.052558183670043945
r_  generation:  0.43124914169311523
local_output_nid generation:  0.02803325653076172
local_in_edges_tensor generation:  0.030438661575317383
mini_batch_src_global generation:  0.050736427307128906
r_  generation:  0.4531710147857666
local_output_nid generation:  0.030907630920410156
local_in_edges_tensor generation:  0.034592628479003906
mini_batch_src_global generation:  0.05218648910522461
r_  generation:  0.4338531494140625
local_output_nid generation:  0.028392314910888672
local_in_edges_tensor generation:  0.028598546981811523
mini_batch_src_global generation:  0.05119752883911133
r_  generation:  0.43237829208374023
local_output_nid generation:  0.028953075408935547
local_in_edges_tensor generation:  0.02728724479675293
mini_batch_src_global generation:  0.053406476974487305
r_  generation:  0.4387483596801758
local_output_nid generation:  0.029144763946533203
local_in_edges_tensor generation:  0.03394961357116699
mini_batch_src_global generation:  0.05102086067199707
r_  generation:  0.4367330074310303
----------------------check_connections_block total spend ----------------------------- 20.577247142791748
generate_one_block  0.6510236263275146
generate_one_block  0.5616528987884521
generate_one_block  0.5590860843658447
generate_one_block  0.5681648254394531
generate_one_block  0.5692138671875
generate_one_block  0.5560991764068604
generate_one_block  0.5471599102020264
generate_one_block  0.5513880252838135
generate_one_block  0.5631954669952393
generate_one_block  0.5402898788452148
generate_one_block  0.5503199100494385
generate_one_block  0.5463142395019531
generate_one_block  0.5764434337615967
generate_one_block  0.5429530143737793
generate_one_block  0.5657210350036621
generate_one_block  0.5411217212677002
generate_one_block  0.5462143421173096
generate_one_block  0.5732691287994385
generate_one_block  0.5518193244934082
generate_one_block  0.5515890121459961
generate_one_block  0.5873920917510986
generate_one_block  0.5433087348937988
generate_one_block  0.5625810623168945
generate_one_block  0.5568523406982422
generate_one_block  0.5613274574279785
generate_one_block  0.5513250827789307
generate_one_block  0.5455904006958008
generate_one_block  0.5596110820770264
generate_one_block  0.5583662986755371
generate_one_block  0.5477588176727295
generate_one_block  0.5601212978363037
generate_one_block  0.5609939098358154
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017633438110351562  GigaBytes
Max Memory Allocated: 0.0017633438110351562  GigaBytes

connection checking time:  29.005133152008057
block generation total time  25.230464220046997
average batch blocks generation time:  0.7884520068764687
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1756591796875 GB
    Memory Allocated: 0.08684635162353516  GigaBytes
Max Memory Allocated: 0.08684635162353516  GigaBytes

torch.Size([148665, 128])
torch.Size([109069, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8807373046875 GB
    Memory Allocated: 14.36557149887085  GigaBytes
Max Memory Allocated: 14.417343616485596  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3963623046875 GB
    Memory Allocated: 0.08946514129638672  GigaBytes
Max Memory Allocated: 14.417343616485596  GigaBytes

torch.Size([149330, 128])
torch.Size([110411, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0428466796875 GB
    Memory Allocated: 14.510926723480225  GigaBytes
Max Memory Allocated: 14.553483486175537  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0428466796875 GB
    Memory Allocated: 0.0893239974975586  GigaBytes
Max Memory Allocated: 14.553483486175537  GigaBytes

torch.Size([149062, 128])
torch.Size([110083, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0955810546875 GB
    Memory Allocated: 14.516821384429932  GigaBytes
Max Memory Allocated: 14.564887046813965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0955810546875 GB
    Memory Allocated: 0.08906984329223633  GigaBytes
Max Memory Allocated: 14.564887046813965  GigaBytes

torch.Size([148377, 128])
torch.Size([109767, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0955810546875 GB
    Memory Allocated: 14.558672904968262  GigaBytes
Max Memory Allocated: 14.608617782592773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0955810546875 GB
    Memory Allocated: 0.08977794647216797  GigaBytes
Max Memory Allocated: 14.608617782592773  GigaBytes

torch.Size([149272, 128])
torch.Size([111048, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7440185546875 GB
    Memory Allocated: 14.875091075897217  GigaBytes
Max Memory Allocated: 14.923794269561768  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7440185546875 GB
    Memory Allocated: 0.08980989456176758  GigaBytes
Max Memory Allocated: 14.923794269561768  GigaBytes

torch.Size([149721, 128])
torch.Size([110910, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8065185546875 GB
    Memory Allocated: 14.703812599182129  GigaBytes
Max Memory Allocated: 14.923794269561768  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8065185546875 GB
    Memory Allocated: 0.08913993835449219  GigaBytes
Max Memory Allocated: 14.923794269561768  GigaBytes

torch.Size([148738, 128])
torch.Size([109128, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8065185546875 GB
    Memory Allocated: 14.454122543334961  GigaBytes
Max Memory Allocated: 14.923794269561768  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8065185546875 GB
    Memory Allocated: 0.0895853042602539  GigaBytes
Max Memory Allocated: 14.923794269561768  GigaBytes

torch.Size([149202, 128])
torch.Size([111154, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8065185546875 GB
    Memory Allocated: 14.721272468566895  GigaBytes
Max Memory Allocated: 14.923794269561768  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8065185546875 GB
    Memory Allocated: 0.08941793441772461  GigaBytes
Max Memory Allocated: 14.923794269561768  GigaBytes

torch.Size([148725, 128])
torch.Size([110355, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8280029296875 GB
    Memory Allocated: 14.752392292022705  GigaBytes
Max Memory Allocated: 14.923794269561768  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8280029296875 GB
    Memory Allocated: 0.08843803405761719  GigaBytes
Max Memory Allocated: 14.923794269561768  GigaBytes

torch.Size([147916, 128])
torch.Size([107676, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8280029296875 GB
    Memory Allocated: 14.0940260887146  GigaBytes
Max Memory Allocated: 14.923794269561768  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8280029296875 GB
    Memory Allocated: 0.08932828903198242  GigaBytes
Max Memory Allocated: 14.923794269561768  GigaBytes

torch.Size([149029, 128])
torch.Size([110388, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8280029296875 GB
    Memory Allocated: 14.5299391746521  GigaBytes
Max Memory Allocated: 14.923794269561768  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8280029296875 GB
    Memory Allocated: 0.08873891830444336  GigaBytes
Max Memory Allocated: 14.923794269561768  GigaBytes

torch.Size([148173, 128])
torch.Size([108467, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8280029296875 GB
    Memory Allocated: 14.256467342376709  GigaBytes
Max Memory Allocated: 14.923794269561768  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8280029296875 GB
    Memory Allocated: 0.08970403671264648  GigaBytes
Max Memory Allocated: 14.923794269561768  GigaBytes

torch.Size([149489, 128])
torch.Size([111100, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8280029296875 GB
    Memory Allocated: 14.696258068084717  GigaBytes
Max Memory Allocated: 14.923794269561768  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8280029296875 GB
    Memory Allocated: 0.08912181854248047  GigaBytes
Max Memory Allocated: 14.923794269561768  GigaBytes

torch.Size([148910, 128])
torch.Size([109290, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8280029296875 GB
    Memory Allocated: 14.370633602142334  GigaBytes
Max Memory Allocated: 14.923794269561768  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8280029296875 GB
    Memory Allocated: 0.08946371078491211  GigaBytes
Max Memory Allocated: 14.923794269561768  GigaBytes

torch.Size([148909, 128])
torch.Size([110881, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8280029296875 GB
    Memory Allocated: 14.72245454788208  GigaBytes
Max Memory Allocated: 14.923794269561768  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8280029296875 GB
    Memory Allocated: 0.08878612518310547  GigaBytes
Max Memory Allocated: 14.923794269561768  GigaBytes

torch.Size([148436, 128])
torch.Size([108515, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8280029296875 GB
    Memory Allocated: 14.233712673187256  GigaBytes
Max Memory Allocated: 14.923794269561768  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8280029296875 GB
    Memory Allocated: 0.0890355110168457  GigaBytes
Max Memory Allocated: 14.923794269561768  GigaBytes

torch.Size([148673, 128])
torch.Size([109146, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8280029296875 GB
    Memory Allocated: 14.390467643737793  GigaBytes
Max Memory Allocated: 14.923794269561768  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8280029296875 GB
    Memory Allocated: 0.08939886093139648  GigaBytes
Max Memory Allocated: 14.923794269561768  GigaBytes

torch.Size([148589, 128])
torch.Size([110498, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 14.800620555877686  GigaBytes
Max Memory Allocated: 14.923794269561768  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 0.08919000625610352  GigaBytes
Max Memory Allocated: 14.923794269561768  GigaBytes

torch.Size([148857, 128])
torch.Size([109478, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 14.44082260131836  GigaBytes
Max Memory Allocated: 14.923794269561768  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 0.08909797668457031  GigaBytes
Max Memory Allocated: 14.923794269561768  GigaBytes

torch.Size([148740, 128])
torch.Size([109388, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 14.408661842346191  GigaBytes
Max Memory Allocated: 14.923794269561768  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 0.0897684097290039  GigaBytes
Max Memory Allocated: 14.923794269561768  GigaBytes

torch.Size([149270, 128])
torch.Size([111297, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 14.886266708374023  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 0.08909416198730469  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

torch.Size([148860, 128])
torch.Size([109402, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 14.281251430511475  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 0.08951377868652344  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

torch.Size([149064, 128])
torch.Size([110764, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 14.70918893814087  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 0.08898067474365234  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

torch.Size([148426, 128])
torch.Size([109369, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 14.463959693908691  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 0.08954524993896484  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

torch.Size([149320, 128])
torch.Size([110877, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 14.628829002380371  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 0.08919382095336914  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

torch.Size([148743, 128])
torch.Size([109559, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 14.514684200286865  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 0.0889434814453125  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

torch.Size([148420, 128])
torch.Size([108732, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 14.397811889648438  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 0.08935689926147461  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

torch.Size([148973, 128])
torch.Size([110517, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 14.604605197906494  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 0.08934402465820312  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

torch.Size([149052, 128])
torch.Size([110293, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 14.54509973526001  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 0.08882474899291992  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

torch.Size([148351, 128])
torch.Size([108594, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 14.35530948638916  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 0.0892634391784668  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

torch.Size([149017, 128])
torch.Size([110222, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 14.458746433258057  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 0.0892491340637207  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

torch.Size([148875, 128])
torch.Size([109745, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 14.530624866485596  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03693466633558273 |0.03245984762907028 |0.5491742193698883 |0.00010553747415542603 |0.9315302893519402 |0.013077735900878906 |
----------------------------------------------------------pseudo_mini_loss sum 5.0058207511901855
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9119686
Number of first layer input nodes during this epoch:  4763184
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 0.1128835678100586  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.033127784729003906
range selection method range initialization spend 0.016724586486816406
time for parepare:  0.018735170364379883
local_output_nid generation:  0.0009412765502929688
local_in_edges_tensor generation:  0.004282951354980469
mini_batch_src_global generation:  0.0021359920501708984
r_  generation:  0.01227879524230957
local_output_nid generation:  0.0010864734649658203
local_in_edges_tensor generation:  0.0006580352783203125
mini_batch_src_global generation:  0.0016057491302490234
r_  generation:  0.010540008544921875
local_output_nid generation:  0.0010280609130859375
local_in_edges_tensor generation:  0.0006165504455566406
mini_batch_src_global generation:  0.0010962486267089844
r_  generation:  0.01010274887084961
local_output_nid generation:  0.0009915828704833984
local_in_edges_tensor generation:  0.0005788803100585938
mini_batch_src_global generation:  0.0010552406311035156
r_  generation:  0.009490728378295898
local_output_nid generation:  0.0009708404541015625
local_in_edges_tensor generation:  0.0005936622619628906
mini_batch_src_global generation:  0.0010542869567871094
r_  generation:  0.009891748428344727
local_output_nid generation:  0.0009715557098388672
local_in_edges_tensor generation:  0.000591278076171875
mini_batch_src_global generation:  0.0012021064758300781
r_  generation:  0.010683298110961914
local_output_nid generation:  0.0009691715240478516
local_in_edges_tensor generation:  0.0005824565887451172
mini_batch_src_global generation:  0.001085042953491211
r_  generation:  0.009884119033813477
local_output_nid generation:  0.0009465217590332031
local_in_edges_tensor generation:  0.0005698204040527344
mini_batch_src_global generation:  0.0010459423065185547
r_  generation:  0.00987696647644043
local_output_nid generation:  0.0009684562683105469
local_in_edges_tensor generation:  0.0005714893341064453
mini_batch_src_global generation:  0.0010995864868164062
r_  generation:  0.010098695755004883
local_output_nid generation:  0.0009493827819824219
local_in_edges_tensor generation:  0.0005662441253662109
mini_batch_src_global generation:  0.001068115234375
r_  generation:  0.010030031204223633
local_output_nid generation:  0.0009839534759521484
local_in_edges_tensor generation:  0.0005929470062255859
mini_batch_src_global generation:  0.0011234283447265625
r_  generation:  0.010373115539550781
local_output_nid generation:  0.0009639263153076172
local_in_edges_tensor generation:  0.0005655288696289062
mini_batch_src_global generation:  0.0010516643524169922
r_  generation:  0.009787797927856445
local_output_nid generation:  0.0009567737579345703
local_in_edges_tensor generation:  0.0005679130554199219
mini_batch_src_global generation:  0.00113677978515625
r_  generation:  0.00979924201965332
local_output_nid generation:  0.0009472370147705078
local_in_edges_tensor generation:  0.0005667209625244141
mini_batch_src_global generation:  0.0010881423950195312
r_  generation:  0.010190963745117188
local_output_nid generation:  0.0009503364562988281
local_in_edges_tensor generation:  0.0005898475646972656
mini_batch_src_global generation:  0.001153707504272461
r_  generation:  0.010707855224609375
local_output_nid generation:  0.0009629726409912109
local_in_edges_tensor generation:  0.0005822181701660156
mini_batch_src_global generation:  0.0011589527130126953
r_  generation:  0.010305643081665039
local_output_nid generation:  0.0009448528289794922
local_in_edges_tensor generation:  0.0005795955657958984
mini_batch_src_global generation:  0.0012192726135253906
r_  generation:  0.010525941848754883
local_output_nid generation:  0.0009775161743164062
local_in_edges_tensor generation:  0.0005674362182617188
mini_batch_src_global generation:  0.0011339187622070312
r_  generation:  0.010370969772338867
local_output_nid generation:  0.0009553432464599609
local_in_edges_tensor generation:  0.0005674362182617188
mini_batch_src_global generation:  0.0011489391326904297
r_  generation:  0.0100250244140625
local_output_nid generation:  0.0009560585021972656
local_in_edges_tensor generation:  0.0005795955657958984
mini_batch_src_global generation:  0.0011572837829589844
r_  generation:  0.010432958602905273
local_output_nid generation:  0.0009548664093017578
local_in_edges_tensor generation:  0.0005667209625244141
mini_batch_src_global generation:  0.0011632442474365234
r_  generation:  0.010259866714477539
local_output_nid generation:  0.0009431838989257812
local_in_edges_tensor generation:  0.0005636215209960938
mini_batch_src_global generation:  0.0010852813720703125
r_  generation:  0.010037660598754883
local_output_nid generation:  0.0009419918060302734
local_in_edges_tensor generation:  0.0005533695220947266
mini_batch_src_global generation:  0.0011861324310302734
r_  generation:  0.010234594345092773
local_output_nid generation:  0.0009374618530273438
local_in_edges_tensor generation:  0.0005674362182617188
mini_batch_src_global generation:  0.0011110305786132812
r_  generation:  0.010322332382202148
local_output_nid generation:  0.0009458065032958984
local_in_edges_tensor generation:  0.0005655288696289062
mini_batch_src_global generation:  0.0011372566223144531
r_  generation:  0.010440826416015625
local_output_nid generation:  0.0009586811065673828
local_in_edges_tensor generation:  0.0005838871002197266
mini_batch_src_global generation:  0.0011057853698730469
r_  generation:  0.010294914245605469
local_output_nid generation:  0.0009367465972900391
local_in_edges_tensor generation:  0.0005633831024169922
mini_batch_src_global generation:  0.001190185546875
r_  generation:  0.010492086410522461
local_output_nid generation:  0.0009236335754394531
local_in_edges_tensor generation:  0.0005605220794677734
mini_batch_src_global generation:  0.0010941028594970703
r_  generation:  0.01012277603149414
local_output_nid generation:  0.0009264945983886719
local_in_edges_tensor generation:  0.0005431175231933594
mini_batch_src_global generation:  0.0011069774627685547
r_  generation:  0.010476827621459961
local_output_nid generation:  0.0009410381317138672
local_in_edges_tensor generation:  0.0005614757537841797
mini_batch_src_global generation:  0.0011925697326660156
r_  generation:  0.010315418243408203
local_output_nid generation:  0.000934600830078125
local_in_edges_tensor generation:  0.0005671977996826172
mini_batch_src_global generation:  0.001176595687866211
r_  generation:  0.010078907012939453
local_output_nid generation:  0.0009417533874511719
local_in_edges_tensor generation:  0.0005629062652587891
mini_batch_src_global generation:  0.0011162757873535156
r_  generation:  0.010266542434692383
----------------------check_connections_block total spend ----------------------------- 0.516127347946167
generate_one_block  0.03442645072937012
generate_one_block  0.02050495147705078
generate_one_block  0.019156217575073242
generate_one_block  0.01770329475402832
generate_one_block  0.01848602294921875
generate_one_block  0.019242048263549805
generate_one_block  0.017833471298217773
generate_one_block  0.017766475677490234
generate_one_block  0.020006179809570312
generate_one_block  0.021584033966064453
generate_one_block  0.018273353576660156
generate_one_block  0.017466068267822266
generate_one_block  0.017561674118041992
generate_one_block  0.018261194229125977
generate_one_block  0.02164626121520996
generate_one_block  0.01800990104675293
generate_one_block  0.01838064193725586
generate_one_block  0.0182192325592041
generate_one_block  0.017733097076416016
generate_one_block  0.020130634307861328
generate_one_block  0.01808333396911621
generate_one_block  0.01754617691040039
generate_one_block  0.018126249313354492
generate_one_block  0.01819586753845215
generate_one_block  0.018517732620239258
generate_one_block  0.019412994384765625
generate_one_block  0.01823592185974121
generate_one_block  0.01786065101623535
generate_one_block  0.018251419067382812
generate_one_block  0.018027305603027344
generate_one_block  0.017722368240356445
generate_one_block  0.019494056701660156
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04105186462402344
gen group dst list time:  0.022063732147216797
time for parepare:  0.019992589950561523
local_output_nid generation:  0.005299568176269531
local_in_edges_tensor generation:  0.016457796096801758
mini_batch_src_global generation:  0.024509668350219727
r_  generation:  0.16963934898376465
local_output_nid generation:  0.00804281234741211
local_in_edges_tensor generation:  0.011142730712890625
mini_batch_src_global generation:  0.022098064422607422
r_  generation:  0.17858242988586426
local_output_nid generation:  0.008214235305786133
local_in_edges_tensor generation:  0.037815093994140625
mini_batch_src_global generation:  0.020883798599243164
r_  generation:  0.1871168613433838
local_output_nid generation:  0.008419990539550781
local_in_edges_tensor generation:  0.00903940200805664
mini_batch_src_global generation:  0.020969390869140625
r_  generation:  0.1731557846069336
local_output_nid generation:  0.008885383605957031
local_in_edges_tensor generation:  0.00916147232055664
mini_batch_src_global generation:  0.023694276809692383
r_  generation:  0.1899251937866211
local_output_nid generation:  0.009459972381591797
local_in_edges_tensor generation:  0.013835906982421875
mini_batch_src_global generation:  0.023762226104736328
r_  generation:  0.19655847549438477
local_output_nid generation:  0.012073516845703125
local_in_edges_tensor generation:  0.009691238403320312
mini_batch_src_global generation:  0.02429962158203125
r_  generation:  0.20016860961914062
local_output_nid generation:  0.00953221321105957
local_in_edges_tensor generation:  0.017550230026245117
mini_batch_src_global generation:  0.031158447265625
r_  generation:  0.18582725524902344
local_output_nid generation:  0.010093212127685547
local_in_edges_tensor generation:  0.01168203353881836
mini_batch_src_global generation:  0.025373458862304688
r_  generation:  0.18700551986694336
local_output_nid generation:  0.009380817413330078
local_in_edges_tensor generation:  0.012343406677246094
mini_batch_src_global generation:  0.023782730102539062
r_  generation:  0.18552875518798828
local_output_nid generation:  0.009801626205444336
local_in_edges_tensor generation:  0.012827157974243164
mini_batch_src_global generation:  0.024521589279174805
r_  generation:  0.1915738582611084
local_output_nid generation:  0.009294271469116211
local_in_edges_tensor generation:  0.009252071380615234
mini_batch_src_global generation:  0.02347874641418457
r_  generation:  0.19083046913146973
local_output_nid generation:  0.009294748306274414
local_in_edges_tensor generation:  0.009142637252807617
mini_batch_src_global generation:  0.023478984832763672
r_  generation:  0.18788576126098633
local_output_nid generation:  0.009717464447021484
local_in_edges_tensor generation:  0.012604713439941406
mini_batch_src_global generation:  0.02416372299194336
r_  generation:  0.19259071350097656
local_output_nid generation:  0.010046243667602539
local_in_edges_tensor generation:  0.022055864334106445
mini_batch_src_global generation:  0.025705814361572266
r_  generation:  0.20306968688964844
local_output_nid generation:  0.009700536727905273
local_in_edges_tensor generation:  0.012513875961303711
mini_batch_src_global generation:  0.024404287338256836
r_  generation:  0.19240903854370117
local_output_nid generation:  0.010076284408569336
local_in_edges_tensor generation:  0.011060476303100586
mini_batch_src_global generation:  0.02622699737548828
r_  generation:  0.19981956481933594
local_output_nid generation:  0.010626792907714844
local_in_edges_tensor generation:  0.029241323471069336
mini_batch_src_global generation:  0.02624821662902832
r_  generation:  0.20660090446472168
local_output_nid generation:  0.01105809211730957
local_in_edges_tensor generation:  0.011310577392578125
mini_batch_src_global generation:  0.023484468460083008
r_  generation:  0.1815943717956543
local_output_nid generation:  0.00895547866821289
local_in_edges_tensor generation:  0.012104272842407227
mini_batch_src_global generation:  0.024379491806030273
r_  generation:  0.18459200859069824
local_output_nid generation:  0.00893092155456543
local_in_edges_tensor generation:  0.012038707733154297
mini_batch_src_global generation:  0.02294635772705078
r_  generation:  0.18674397468566895
local_output_nid generation:  0.008704662322998047
local_in_edges_tensor generation:  0.010556936264038086
mini_batch_src_global generation:  0.02266526222229004
r_  generation:  0.17742586135864258
local_output_nid generation:  0.008847951889038086
local_in_edges_tensor generation:  0.009709358215332031
mini_batch_src_global generation:  0.022426366806030273
r_  generation:  0.19315791130065918
local_output_nid generation:  0.008995532989501953
local_in_edges_tensor generation:  0.010277032852172852
mini_batch_src_global generation:  0.02395486831665039
r_  generation:  0.18200206756591797
local_output_nid generation:  0.009192466735839844
local_in_edges_tensor generation:  0.012067317962646484
mini_batch_src_global generation:  0.02329540252685547
r_  generation:  0.18738365173339844
local_output_nid generation:  0.008791446685791016
local_in_edges_tensor generation:  0.008928298950195312
mini_batch_src_global generation:  0.022719860076904297
r_  generation:  0.18326663970947266
local_output_nid generation:  0.009018898010253906
local_in_edges_tensor generation:  0.009350776672363281
mini_batch_src_global generation:  0.023186683654785156
r_  generation:  0.18567991256713867
local_output_nid generation:  0.008991718292236328
local_in_edges_tensor generation:  0.010333061218261719
mini_batch_src_global generation:  0.02299666404724121
r_  generation:  0.1891005039215088
local_output_nid generation:  0.009119749069213867
local_in_edges_tensor generation:  0.010385990142822266
mini_batch_src_global generation:  0.024214506149291992
r_  generation:  0.18895292282104492
local_output_nid generation:  0.008929252624511719
local_in_edges_tensor generation:  0.012027502059936523
mini_batch_src_global generation:  0.022928953170776367
r_  generation:  0.18624258041381836
local_output_nid generation:  0.008788108825683594
local_in_edges_tensor generation:  0.008943796157836914
mini_batch_src_global generation:  0.022654294967651367
r_  generation:  0.18485617637634277
local_output_nid generation:  0.008922338485717773
local_in_edges_tensor generation:  0.008667945861816406
mini_batch_src_global generation:  0.022428035736083984
r_  generation:  0.1877884864807129
----------------------check_connections_block total spend ----------------------------- 8.867633819580078
generate_one_block  0.2515408992767334
generate_one_block  0.2434825897216797
generate_one_block  0.2622978687286377
generate_one_block  0.23283720016479492
generate_one_block  0.29011106491088867
generate_one_block  0.2580699920654297
generate_one_block  0.24244284629821777
generate_one_block  0.2362990379333496
generate_one_block  0.24738073348999023
generate_one_block  0.2402667999267578
generate_one_block  0.25375914573669434
generate_one_block  0.2298297882080078
generate_one_block  0.2340855598449707
generate_one_block  0.2523064613342285
generate_one_block  0.2628183364868164
generate_one_block  0.2418501377105713
generate_one_block  0.24740982055664062
generate_one_block  0.2450852394104004
generate_one_block  0.23810839653015137
generate_one_block  0.2584362030029297
generate_one_block  0.25084948539733887
generate_one_block  0.2320551872253418
generate_one_block  0.25045180320739746
generate_one_block  0.24484920501708984
generate_one_block  0.251145601272583
generate_one_block  0.2389543056488037
generate_one_block  0.24956107139587402
generate_one_block  0.24016785621643066
generate_one_block  0.2476341724395752
generate_one_block  0.2490246295928955
generate_one_block  0.23792552947998047
generate_one_block  0.24514174461364746
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03917717933654785
gen group dst list time:  0.10524129867553711
time for parepare:  0.017925500869750977
local_output_nid generation:  0.025014162063598633
local_in_edges_tensor generation:  0.04873538017272949
mini_batch_src_global generation:  0.041436195373535156
r_  generation:  0.4272279739379883
local_output_nid generation:  0.030518293380737305
local_in_edges_tensor generation:  0.044527292251586914
mini_batch_src_global generation:  0.049477577209472656
r_  generation:  0.4223666191101074
local_output_nid generation:  0.029736757278442383
local_in_edges_tensor generation:  0.035787105560302734
mini_batch_src_global generation:  0.047869205474853516
r_  generation:  0.4305269718170166
local_output_nid generation:  0.028725147247314453
local_in_edges_tensor generation:  0.028645038604736328
mini_batch_src_global generation:  0.04912304878234863
r_  generation:  0.42943572998046875
local_output_nid generation:  0.029317140579223633
local_in_edges_tensor generation:  0.0322573184967041
mini_batch_src_global generation:  0.049422264099121094
r_  generation:  0.43974900245666504
local_output_nid generation:  0.029488086700439453
local_in_edges_tensor generation:  0.03248405456542969
mini_batch_src_global generation:  0.05132722854614258
r_  generation:  0.43990349769592285
local_output_nid generation:  0.03136730194091797
local_in_edges_tensor generation:  0.03226161003112793
mini_batch_src_global generation:  0.05000424385070801
r_  generation:  0.4376208782196045
local_output_nid generation:  0.029173612594604492
local_in_edges_tensor generation:  0.032232046127319336
mini_batch_src_global generation:  0.050862789154052734
r_  generation:  0.4356529712677002
local_output_nid generation:  0.029501676559448242
local_in_edges_tensor generation:  0.03661823272705078
mini_batch_src_global generation:  0.051721811294555664
r_  generation:  0.44110655784606934
local_output_nid generation:  0.029254436492919922
local_in_edges_tensor generation:  0.028520584106445312
mini_batch_src_global generation:  0.051299333572387695
r_  generation:  0.4437990188598633
local_output_nid generation:  0.029316186904907227
local_in_edges_tensor generation:  0.03223562240600586
mini_batch_src_global generation:  0.0534820556640625
r_  generation:  0.4470367431640625
local_output_nid generation:  0.02939915657043457
local_in_edges_tensor generation:  0.03252673149108887
mini_batch_src_global generation:  0.050628662109375
r_  generation:  0.4321169853210449
local_output_nid generation:  0.029358386993408203
local_in_edges_tensor generation:  0.03217267990112305
mini_batch_src_global generation:  0.05309557914733887
r_  generation:  0.4361584186553955
local_output_nid generation:  0.03049778938293457
local_in_edges_tensor generation:  0.03531169891357422
mini_batch_src_global generation:  0.05739283561706543
r_  generation:  0.45454978942871094
local_output_nid generation:  0.03097701072692871
local_in_edges_tensor generation:  0.040790557861328125
mini_batch_src_global generation:  0.05090069770812988
r_  generation:  0.44880127906799316
local_output_nid generation:  0.03156852722167969
local_in_edges_tensor generation:  0.032149314880371094
mini_batch_src_global generation:  0.053182363510131836
r_  generation:  0.43474650382995605
local_output_nid generation:  0.030774831771850586
local_in_edges_tensor generation:  0.029243946075439453
mini_batch_src_global generation:  0.05376076698303223
r_  generation:  0.44039177894592285
local_output_nid generation:  0.030292987823486328
local_in_edges_tensor generation:  0.032540082931518555
mini_batch_src_global generation:  0.05100059509277344
r_  generation:  0.4354367256164551
local_output_nid generation:  0.030385971069335938
local_in_edges_tensor generation:  0.02859044075012207
mini_batch_src_global generation:  0.053143978118896484
r_  generation:  0.4376261234283447
local_output_nid generation:  0.030388593673706055
local_in_edges_tensor generation:  0.03637576103210449
mini_batch_src_global generation:  0.05056166648864746
r_  generation:  0.43624377250671387
local_output_nid generation:  0.030696868896484375
local_in_edges_tensor generation:  0.03323721885681152
mini_batch_src_global generation:  0.05080270767211914
r_  generation:  0.43992018699645996
local_output_nid generation:  0.030452966690063477
local_in_edges_tensor generation:  0.03161120414733887
mini_batch_src_global generation:  0.05021095275878906
r_  generation:  0.4307231903076172
local_output_nid generation:  0.030451059341430664
local_in_edges_tensor generation:  0.03290247917175293
mini_batch_src_global generation:  0.050356149673461914
r_  generation:  0.43816614151000977
local_output_nid generation:  0.0306088924407959
local_in_edges_tensor generation:  0.03588151931762695
mini_batch_src_global generation:  0.05131101608276367
r_  generation:  0.436065673828125
local_output_nid generation:  0.030731678009033203
local_in_edges_tensor generation:  0.03224372863769531
mini_batch_src_global generation:  0.056519508361816406
r_  generation:  0.44061875343322754
local_output_nid generation:  0.030656814575195312
local_in_edges_tensor generation:  0.03230547904968262
mini_batch_src_global generation:  0.05111241340637207
r_  generation:  0.4362025260925293
local_output_nid generation:  0.030548572540283203
local_in_edges_tensor generation:  0.032688140869140625
mini_batch_src_global generation:  0.050522565841674805
r_  generation:  0.437288761138916
local_output_nid generation:  0.031060218811035156
local_in_edges_tensor generation:  0.03657841682434082
mini_batch_src_global generation:  0.05070686340332031
r_  generation:  0.43590593338012695
local_output_nid generation:  0.03068065643310547
local_in_edges_tensor generation:  0.029310941696166992
mini_batch_src_global generation:  0.05083107948303223
r_  generation:  0.4418199062347412
local_output_nid generation:  0.030546188354492188
local_in_edges_tensor generation:  0.03573870658874512
mini_batch_src_global generation:  0.0509791374206543
r_  generation:  0.43566370010375977
local_output_nid generation:  0.030269384384155273
local_in_edges_tensor generation:  0.03271365165710449
mini_batch_src_global generation:  0.050641536712646484
r_  generation:  0.43976712226867676
local_output_nid generation:  0.030342578887939453
local_in_edges_tensor generation:  0.032414913177490234
mini_batch_src_global generation:  0.054102420806884766
r_  generation:  0.437152624130249
----------------------check_connections_block total spend ----------------------------- 20.803508281707764
generate_one_block  0.5870354175567627
generate_one_block  0.59267258644104
generate_one_block  0.5836210250854492
generate_one_block  0.5717074871063232
generate_one_block  0.6857357025146484
generate_one_block  0.5895555019378662
generate_one_block  0.5896100997924805
generate_one_block  0.5723316669464111
generate_one_block  0.5864338874816895
generate_one_block  0.5706055164337158
generate_one_block  0.5793654918670654
generate_one_block  0.5816333293914795
generate_one_block  0.5791792869567871
generate_one_block  0.5882306098937988
generate_one_block  0.617556095123291
generate_one_block  0.5702095031738281
generate_one_block  0.5900912284851074
generate_one_block  0.57718825340271
generate_one_block  0.5703966617584229
generate_one_block  0.58306884765625
generate_one_block  0.585080623626709
generate_one_block  0.5656430721282959
generate_one_block  0.5851655006408691
generate_one_block  0.6115574836730957
generate_one_block  0.6061961650848389
generate_one_block  0.5720930099487305
generate_one_block  0.5862226486206055
generate_one_block  0.5900590419769287
generate_one_block  0.5729551315307617
generate_one_block  0.578322172164917
generate_one_block  0.5741467475891113
generate_one_block  0.6338465213775635
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 0.1128835678100586  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

connection checking time:  29.671142101287842
block generation total time  26.733695030212402
average batch blocks generation time:  0.8354279696941376
block dataloader generation time/epoch 59.91313815116882
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 0.09240341186523438  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

torch.Size([148357, 128])
torch.Size([109196, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 14.398983001708984  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 0.09305477142333984  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

torch.Size([149382, 128])
torch.Size([110947, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 14.59213638305664  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 0.09277677536010742  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

torch.Size([148553, 128])
torch.Size([109773, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 14.705221176147461  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 0.09262561798095703  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

torch.Size([149080, 128])
torch.Size([109648, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 14.283477306365967  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 0.09304618835449219  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

torch.Size([149196, 128])
torch.Size([110740, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 14.648028373718262  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 0.0932931900024414  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

torch.Size([149364, 128])
torch.Size([110888, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 14.82804250717163  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 0.09293365478515625  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

torch.Size([149186, 128])
torch.Size([110097, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 14.538196086883545  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 0.09238529205322266  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

torch.Size([148352, 128])
torch.Size([109129, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 14.374724388122559  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 0.09293842315673828  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

torch.Size([149164, 128])
torch.Size([110537, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 14.577901363372803  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 0.0926513671875  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

torch.Size([148824, 128])
torch.Size([109455, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 14.401391983032227  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 0.09272480010986328  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

torch.Size([148608, 128])
torch.Size([109308, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 14.572088241577148  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 0.09198904037475586  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

torch.Size([147959, 128])
torch.Size([107752, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 14.085718631744385  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 0.09239864349365234  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

torch.Size([148458, 128])
torch.Size([108501, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 14.318957328796387  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 0.09265565872192383  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

torch.Size([148373, 128])
torch.Size([109519, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 14.654318809509277  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 0.09308433532714844  GigaBytes
Max Memory Allocated: 14.930688858032227  GigaBytes

torch.Size([148712, 128])
torch.Size([110665, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 14.929189682006836  GigaBytes
Max Memory Allocated: 14.98653507232666  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 0.09268856048583984  GigaBytes
Max Memory Allocated: 14.98653507232666  GigaBytes

torch.Size([148746, 128])
torch.Size([109691, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 14.5111403465271  GigaBytes
Max Memory Allocated: 14.98653507232666  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 0.09301567077636719  GigaBytes
Max Memory Allocated: 14.98653507232666  GigaBytes

torch.Size([149190, 128])
torch.Size([111216, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 14.637399673461914  GigaBytes
Max Memory Allocated: 14.98653507232666  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 0.09247159957885742  GigaBytes
Max Memory Allocated: 14.98653507232666  GigaBytes

torch.Size([148245, 128])
torch.Size([109035, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 14.505644798278809  GigaBytes
Max Memory Allocated: 14.98653507232666  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 0.09255838394165039  GigaBytes
Max Memory Allocated: 14.98653507232666  GigaBytes

torch.Size([148553, 128])
torch.Size([109100, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 14.448618412017822  GigaBytes
Max Memory Allocated: 14.98653507232666  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 0.09287548065185547  GigaBytes
Max Memory Allocated: 14.98653507232666  GigaBytes

torch.Size([148932, 128])
torch.Size([110068, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 14.621731281280518  GigaBytes
Max Memory Allocated: 14.98653507232666  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 0.09291219711303711  GigaBytes
Max Memory Allocated: 14.98653507232666  GigaBytes

torch.Size([148977, 128])
torch.Size([109847, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 14.621010780334473  GigaBytes
Max Memory Allocated: 14.98653507232666  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 0.0922093391418457  GigaBytes
Max Memory Allocated: 14.98653507232666  GigaBytes

torch.Size([148339, 128])
torch.Size([108068, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 14.144522666931152  GigaBytes
Max Memory Allocated: 14.98653507232666  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 0.09272098541259766  GigaBytes
Max Memory Allocated: 14.98653507232666  GigaBytes

torch.Size([148822, 128])
torch.Size([109810, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 14.507140636444092  GigaBytes
Max Memory Allocated: 14.98653507232666  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 0.09283256530761719  GigaBytes
Max Memory Allocated: 14.98653507232666  GigaBytes

torch.Size([149026, 128])
torch.Size([109888, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 14.491096019744873  GigaBytes
Max Memory Allocated: 14.98653507232666  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 0.09319734573364258  GigaBytes
Max Memory Allocated: 14.98653507232666  GigaBytes

torch.Size([149395, 128])
torch.Size([110984, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 14.732490539550781  GigaBytes
Max Memory Allocated: 14.98653507232666  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 0.09240436553955078  GigaBytes
Max Memory Allocated: 14.98653507232666  GigaBytes

torch.Size([148380, 128])
torch.Size([109229, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 14.384482860565186  GigaBytes
Max Memory Allocated: 14.98653507232666  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 0.09278249740600586  GigaBytes
Max Memory Allocated: 14.98653507232666  GigaBytes

torch.Size([148711, 128])
torch.Size([109718, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 14.620108604431152  GigaBytes
Max Memory Allocated: 14.98653507232666  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 0.09293127059936523  GigaBytes
Max Memory Allocated: 14.98653507232666  GigaBytes

torch.Size([149315, 128])
torch.Size([109987, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 14.466938972473145  GigaBytes
Max Memory Allocated: 14.98653507232666  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 0.09258794784545898  GigaBytes
Max Memory Allocated: 14.98653507232666  GigaBytes

torch.Size([148459, 128])
torch.Size([109533, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 14.527797222137451  GigaBytes
Max Memory Allocated: 14.98653507232666  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 0.09274959564208984  GigaBytes
Max Memory Allocated: 14.98653507232666  GigaBytes

torch.Size([148752, 128])
torch.Size([109752, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 14.557620525360107  GigaBytes
Max Memory Allocated: 14.98653507232666  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 0.09254026412963867  GigaBytes
Max Memory Allocated: 14.98653507232666  GigaBytes

torch.Size([148595, 128])
torch.Size([109266, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 14.39088487625122  GigaBytes
Max Memory Allocated: 14.98653507232666  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 0.09261322021484375  GigaBytes
Max Memory Allocated: 14.98653507232666  GigaBytes

torch.Size([148594, 128])
torch.Size([109530, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 14.474844455718994  GigaBytes
Max Memory Allocated: 14.98653507232666  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.033267781138420105 |0.02164052426815033 |0.5270078405737877 |9.859353303909302e-05 |0.9138992205262184 |0.006376743316650391 |
----------------------------------------------------------pseudo_mini_loss sum 3.3157029151916504
Total (block generation + training)time/epoch 107.84903502464294
Training time/epoch 47.93559956550598
Training time without block to device /epoch 47.24310278892517
Training time without total dataloading part /epoch 46.1185576915741
load block tensor time/epoch 1.0645689964294434
block to device time/epoch 0.6924967765808105
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9111036
Number of first layer input nodes during this epoch:  4760599
