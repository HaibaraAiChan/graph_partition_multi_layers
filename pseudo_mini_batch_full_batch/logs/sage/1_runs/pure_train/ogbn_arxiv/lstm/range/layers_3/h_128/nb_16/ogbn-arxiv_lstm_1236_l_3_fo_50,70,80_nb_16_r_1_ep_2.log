Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648474275.153257
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017633438110351562  GigaBytes
Max Memory Allocated: 0.0017633438110351562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.029315710067749023
range selection method range initialization spend 0.01658153533935547
time for parepare:  0.017943620681762695
local_output_nid generation:  0.0013723373413085938
local_in_edges_tensor generation:  0.004135847091674805
mini_batch_src_global generation:  0.002247333526611328
r_  generation:  0.021651506423950195
local_output_nid generation:  0.0014157295227050781
local_in_edges_tensor generation:  0.0009315013885498047
mini_batch_src_global generation:  0.002760648727416992
r_  generation:  0.022049903869628906
local_output_nid generation:  0.001447916030883789
local_in_edges_tensor generation:  0.0009379386901855469
mini_batch_src_global generation:  0.001893758773803711
r_  generation:  0.02272343635559082
local_output_nid generation:  0.0014584064483642578
local_in_edges_tensor generation:  0.0009183883666992188
mini_batch_src_global generation:  0.0018887519836425781
r_  generation:  0.022175073623657227
local_output_nid generation:  0.0015180110931396484
local_in_edges_tensor generation:  0.0009565353393554688
mini_batch_src_global generation:  0.0018918514251708984
r_  generation:  0.022070646286010742
local_output_nid generation:  0.0015835762023925781
local_in_edges_tensor generation:  0.0008804798126220703
mini_batch_src_global generation:  0.0031299591064453125
r_  generation:  0.024106740951538086
local_output_nid generation:  0.0015149116516113281
local_in_edges_tensor generation:  0.0008640289306640625
mini_batch_src_global generation:  0.0016012191772460938
r_  generation:  0.021046876907348633
local_output_nid generation:  0.0014948844909667969
local_in_edges_tensor generation:  0.0008656978607177734
mini_batch_src_global generation:  0.001649618148803711
r_  generation:  0.0211794376373291
local_output_nid generation:  0.0014941692352294922
local_in_edges_tensor generation:  0.0008878707885742188
mini_batch_src_global generation:  0.0016663074493408203
r_  generation:  0.021453380584716797
local_output_nid generation:  0.0015015602111816406
local_in_edges_tensor generation:  0.000843048095703125
mini_batch_src_global generation:  0.00164031982421875
r_  generation:  0.021396875381469727
local_output_nid generation:  0.0015041828155517578
local_in_edges_tensor generation:  0.0008742809295654297
mini_batch_src_global generation:  0.0017781257629394531
r_  generation:  0.021961212158203125
local_output_nid generation:  0.001506805419921875
local_in_edges_tensor generation:  0.0008666515350341797
mini_batch_src_global generation:  0.0017251968383789062
r_  generation:  0.021558046340942383
local_output_nid generation:  0.0014989376068115234
local_in_edges_tensor generation:  0.0008704662322998047
mini_batch_src_global generation:  0.0017063617706298828
r_  generation:  0.021518468856811523
local_output_nid generation:  0.0015130043029785156
local_in_edges_tensor generation:  0.0008823871612548828
mini_batch_src_global generation:  0.001758575439453125
r_  generation:  0.021138668060302734
local_output_nid generation:  0.0015048980712890625
local_in_edges_tensor generation:  0.0008881092071533203
mini_batch_src_global generation:  0.0016973018646240234
r_  generation:  0.021013736724853516
local_output_nid generation:  0.00151824951171875
local_in_edges_tensor generation:  0.0008611679077148438
mini_batch_src_global generation:  0.0016918182373046875
r_  generation:  0.021361112594604492
----------------------check_connections_block total spend ----------------------------- 0.520129919052124
generate_one_block  0.030438899993896484
generate_one_block  0.03155803680419922
generate_one_block  0.034050703048706055
generate_one_block  0.03162741661071777
generate_one_block  0.031022310256958008
generate_one_block  0.03071880340576172
generate_one_block  0.03117060661315918
generate_one_block  0.03104257583618164
generate_one_block  0.03171968460083008
generate_one_block  0.03102588653564453
generate_one_block  0.031867027282714844
generate_one_block  0.03167891502380371
generate_one_block  0.03192615509033203
generate_one_block  0.030971050262451172
generate_one_block  0.03121495246887207
generate_one_block  0.031261444091796875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04090404510498047
gen group dst list time:  0.02113819122314453
time for parepare:  0.01999187469482422
local_output_nid generation:  0.007396221160888672
local_in_edges_tensor generation:  0.019328594207763672
mini_batch_src_global generation:  0.027238130569458008
r_  generation:  0.246962308883667
local_output_nid generation:  0.013197898864746094
local_in_edges_tensor generation:  0.022440195083618164
mini_batch_src_global generation:  0.031943559646606445
r_  generation:  0.25884079933166504
local_output_nid generation:  0.014355897903442383
local_in_edges_tensor generation:  0.019478559494018555
mini_batch_src_global generation:  0.03424882888793945
r_  generation:  0.26935911178588867
local_output_nid generation:  0.014330625534057617
local_in_edges_tensor generation:  0.01652050018310547
mini_batch_src_global generation:  0.03261685371398926
r_  generation:  0.26767563819885254
local_output_nid generation:  0.01457667350769043
local_in_edges_tensor generation:  0.014015913009643555
mini_batch_src_global generation:  0.03709745407104492
r_  generation:  0.2733588218688965
local_output_nid generation:  0.015080690383911133
local_in_edges_tensor generation:  0.01580047607421875
mini_batch_src_global generation:  0.03371167182922363
r_  generation:  0.2658655643463135
local_output_nid generation:  0.015141725540161133
local_in_edges_tensor generation:  0.019161462783813477
mini_batch_src_global generation:  0.03372955322265625
r_  generation:  0.27248406410217285
local_output_nid generation:  0.015253543853759766
local_in_edges_tensor generation:  0.019186735153198242
mini_batch_src_global generation:  0.03451228141784668
r_  generation:  0.27052927017211914
local_output_nid generation:  0.015288829803466797
local_in_edges_tensor generation:  0.0189669132232666
mini_batch_src_global generation:  0.03433036804199219
r_  generation:  0.2753148078918457
local_output_nid generation:  0.015176773071289062
local_in_edges_tensor generation:  0.013967752456665039
mini_batch_src_global generation:  0.034340620040893555
r_  generation:  0.2717130184173584
local_output_nid generation:  0.015616178512573242
local_in_edges_tensor generation:  0.015294075012207031
mini_batch_src_global generation:  0.0366666316986084
r_  generation:  0.2782621383666992
local_output_nid generation:  0.015455484390258789
local_in_edges_tensor generation:  0.02185511589050293
mini_batch_src_global generation:  0.03460526466369629
r_  generation:  0.27370405197143555
local_output_nid generation:  0.015514373779296875
local_in_edges_tensor generation:  0.01518702507019043
mini_batch_src_global generation:  0.03505349159240723
r_  generation:  0.27393341064453125
local_output_nid generation:  0.015343666076660156
local_in_edges_tensor generation:  0.01477360725402832
mini_batch_src_global generation:  0.034540414810180664
r_  generation:  0.2729780673980713
local_output_nid generation:  0.015362739562988281
local_in_edges_tensor generation:  0.016924381256103516
mini_batch_src_global generation:  0.0342402458190918
r_  generation:  0.27008509635925293
local_output_nid generation:  0.015444040298461914
local_in_edges_tensor generation:  0.016530752182006836
mini_batch_src_global generation:  0.03606891632080078
r_  generation:  0.2736039161682129
----------------------check_connections_block total spend ----------------------------- 6.325462818145752
generate_one_block  0.3540689945220947
generate_one_block  0.3501927852630615
generate_one_block  0.37175726890563965
generate_one_block  0.36281561851501465
generate_one_block  0.37198424339294434
generate_one_block  0.3464028835296631
generate_one_block  0.353773832321167
generate_one_block  0.3551046848297119
generate_one_block  0.359666109085083
generate_one_block  0.35591745376586914
generate_one_block  0.3665158748626709
generate_one_block  0.3581418991088867
generate_one_block  0.3577594757080078
generate_one_block  0.3513801097869873
generate_one_block  0.3631007671356201
generate_one_block  0.35454630851745605
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04217219352722168
gen group dst list time:  0.06497001647949219
time for parepare:  0.01889634132385254
local_output_nid generation:  0.025286197662353516
local_in_edges_tensor generation:  0.04236435890197754
mini_batch_src_global generation:  0.04990243911743164
r_  generation:  0.5149478912353516
local_output_nid generation:  0.031455278396606445
local_in_edges_tensor generation:  0.0526118278503418
mini_batch_src_global generation:  0.06177783012390137
r_  generation:  0.5246140956878662
local_output_nid generation:  0.03140711784362793
local_in_edges_tensor generation:  0.04799342155456543
mini_batch_src_global generation:  0.05848336219787598
r_  generation:  0.5360243320465088
local_output_nid generation:  0.03148818016052246
local_in_edges_tensor generation:  0.0350193977355957
mini_batch_src_global generation:  0.05967283248901367
r_  generation:  0.5317234992980957
local_output_nid generation:  0.03141427040100098
local_in_edges_tensor generation:  0.03404951095581055
mini_batch_src_global generation:  0.06038665771484375
r_  generation:  0.5371770858764648
local_output_nid generation:  0.031557559967041016
local_in_edges_tensor generation:  0.039208173751831055
mini_batch_src_global generation:  0.06175041198730469
r_  generation:  0.5364260673522949
local_output_nid generation:  0.03162097930908203
local_in_edges_tensor generation:  0.04393339157104492
mini_batch_src_global generation:  0.06513285636901855
r_  generation:  0.5421113967895508
local_output_nid generation:  0.03193521499633789
local_in_edges_tensor generation:  0.03892040252685547
mini_batch_src_global generation:  0.06257438659667969
r_  generation:  0.5402045249938965
local_output_nid generation:  0.032027482986450195
local_in_edges_tensor generation:  0.0354609489440918
mini_batch_src_global generation:  0.06237959861755371
r_  generation:  0.539435863494873
local_output_nid generation:  0.032299041748046875
local_in_edges_tensor generation:  0.03922915458679199
mini_batch_src_global generation:  0.06193065643310547
r_  generation:  0.544741153717041
local_output_nid generation:  0.032351016998291016
local_in_edges_tensor generation:  0.044538021087646484
mini_batch_src_global generation:  0.06602644920349121
r_  generation:  0.5387144088745117
local_output_nid generation:  0.03209114074707031
local_in_edges_tensor generation:  0.03919553756713867
mini_batch_src_global generation:  0.06197714805603027
r_  generation:  0.546762228012085
local_output_nid generation:  0.03240823745727539
local_in_edges_tensor generation:  0.03899574279785156
mini_batch_src_global generation:  0.06265783309936523
r_  generation:  0.5394854545593262
local_output_nid generation:  0.0318751335144043
local_in_edges_tensor generation:  0.038828134536743164
mini_batch_src_global generation:  0.06228828430175781
r_  generation:  0.5394175052642822
local_output_nid generation:  0.03152966499328613
local_in_edges_tensor generation:  0.03949141502380371
mini_batch_src_global generation:  0.06277728080749512
r_  generation:  0.5441515445709229
local_output_nid generation:  0.031630516052246094
local_in_edges_tensor generation:  0.06282377243041992
mini_batch_src_global generation:  0.06229543685913086
r_  generation:  0.5384354591369629
----------------------check_connections_block total spend ----------------------------- 12.649612665176392
generate_one_block  0.6743617057800293
generate_one_block  0.686547040939331
generate_one_block  0.6910738945007324
generate_one_block  0.6950266361236572
generate_one_block  0.6757411956787109
generate_one_block  0.6924343109130859
generate_one_block  0.756333589553833
generate_one_block  0.6826112270355225
generate_one_block  0.6851475238800049
generate_one_block  0.687025785446167
generate_one_block  0.7060937881469727
generate_one_block  0.6933746337890625
generate_one_block  0.7224867343902588
generate_one_block  0.7244663238525391
generate_one_block  0.675283670425415
generate_one_block  0.6995322704315186
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017633438110351562  GigaBytes
Max Memory Allocated: 0.0017633438110351562  GigaBytes

connection checking time:  18.975075483322144
block generation total time  16.88066864013672
average batch blocks generation time:  1.055041790008545
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.09795045852661133  GigaBytes
Max Memory Allocated: 0.09795045852661133  GigaBytes

torch.Size([157752, 128])
torch.Size([129769, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3104248046875 GB
    Memory Allocated: 19.75709056854248  GigaBytes
Max Memory Allocated: 19.789278507232666  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5291748046875 GB
    Memory Allocated: 0.09910154342651367  GigaBytes
Max Memory Allocated: 19.789278507232666  GigaBytes

torch.Size([157519, 128])
torch.Size([129904, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4100341796875 GB
    Memory Allocated: 19.839866638183594  GigaBytes
Max Memory Allocated: 19.873476028442383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4100341796875 GB
    Memory Allocated: 0.10048484802246094  GigaBytes
Max Memory Allocated: 19.873476028442383  GigaBytes

torch.Size([158081, 128])
torch.Size([131227, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.8299560546875 GB
    Memory Allocated: 20.127521514892578  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.09925317764282227  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

torch.Size([157665, 128])
torch.Size([130134, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 19.907769203186035  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.09900617599487305  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

torch.Size([157349, 128])
torch.Size([129149, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 19.821521759033203  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.09908294677734375  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

torch.Size([157586, 128])
torch.Size([130009, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 19.77480459213257  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.10016918182373047  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

torch.Size([158043, 128])
torch.Size([130557, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 19.831841468811035  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.09906196594238281  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

torch.Size([157436, 128])
torch.Size([129972, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1326904296875 GB
    Memory Allocated: 19.830439567565918  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1326904296875 GB
    Memory Allocated: 0.09915494918823242  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

torch.Size([157441, 128])
torch.Size([129888, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1912841796875 GB
    Memory Allocated: 19.909523963928223  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1912841796875 GB
    Memory Allocated: 0.0990762710571289  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

torch.Size([157590, 128])
torch.Size([129660, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 19.789767265319824  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 0.10032939910888672  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

torch.Size([158048, 128])
torch.Size([130753, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 19.98480463027954  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 0.09918689727783203  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

torch.Size([157490, 128])
torch.Size([130317, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 19.90285873413086  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 0.10022735595703125  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

torch.Size([157802, 128])
torch.Size([130268, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 19.88000249862671  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 0.09895563125610352  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

torch.Size([157251, 128])
torch.Size([129496, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 19.817466735839844  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 0.0990133285522461  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

torch.Size([157496, 128])
torch.Size([129630, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 19.736305236816406  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 0.09906387329101562  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

torch.Size([157502, 128])
torch.Size([129901, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 19.800123691558838  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03961494565010071 |0.04730616509914398 |0.8221561312675476 |0.00011615455150604248 |1.2400586158037186 |0.01641988754272461 |
----------------------------------------------------------pseudo_mini_loss sum 4.99104118347168
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5333349
Number of first layer input nodes during this epoch:  2522051
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 0.1311960220336914  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02871108055114746
range selection method range initialization spend 0.012995719909667969
time for parepare:  0.01759052276611328
local_output_nid generation:  0.0019292831420898438
local_in_edges_tensor generation:  0.006813764572143555
mini_batch_src_global generation:  0.002065420150756836
r_  generation:  0.02027297019958496
local_output_nid generation:  0.0018625259399414062
local_in_edges_tensor generation:  0.0010750293731689453
mini_batch_src_global generation:  0.0024585723876953125
r_  generation:  0.031002283096313477
local_output_nid generation:  0.002514362335205078
local_in_edges_tensor generation:  0.0012860298156738281
mini_batch_src_global generation:  0.002105712890625
r_  generation:  0.024468421936035156
local_output_nid generation:  0.0039675235748291016
local_in_edges_tensor generation:  0.002005338668823242
mini_batch_src_global generation:  0.0033953189849853516
r_  generation:  0.025345563888549805
local_output_nid generation:  0.0019347667694091797
local_in_edges_tensor generation:  0.001033782958984375
mini_batch_src_global generation:  0.0016465187072753906
r_  generation:  0.021282196044921875
local_output_nid generation:  0.0018630027770996094
local_in_edges_tensor generation:  0.0009872913360595703
mini_batch_src_global generation:  0.0016796588897705078
r_  generation:  0.02108621597290039
local_output_nid generation:  0.0018515586853027344
local_in_edges_tensor generation:  0.0009844303131103516
mini_batch_src_global generation:  0.001691579818725586
r_  generation:  0.021433353424072266
local_output_nid generation:  0.0017867088317871094
local_in_edges_tensor generation:  0.0009551048278808594
mini_batch_src_global generation:  0.0017309188842773438
r_  generation:  0.022522687911987305
local_output_nid generation:  0.0017745494842529297
local_in_edges_tensor generation:  0.0009622573852539062
mini_batch_src_global generation:  0.0017194747924804688
r_  generation:  0.02259063720703125
local_output_nid generation:  0.0017807483673095703
local_in_edges_tensor generation:  0.0009741783142089844
mini_batch_src_global generation:  0.0017576217651367188
r_  generation:  0.02233290672302246
local_output_nid generation:  0.0017566680908203125
local_in_edges_tensor generation:  0.0010094642639160156
mini_batch_src_global generation:  0.0017647743225097656
r_  generation:  0.02213263511657715
local_output_nid generation:  0.0017268657684326172
local_in_edges_tensor generation:  0.0009253025054931641
mini_batch_src_global generation:  0.0017502307891845703
r_  generation:  0.022718429565429688
local_output_nid generation:  0.0017714500427246094
local_in_edges_tensor generation:  0.0010352134704589844
mini_batch_src_global generation:  0.0018362998962402344
r_  generation:  0.022661924362182617
local_output_nid generation:  0.0017664432525634766
local_in_edges_tensor generation:  0.0009729862213134766
mini_batch_src_global generation:  0.0018711090087890625
r_  generation:  0.022403717041015625
local_output_nid generation:  0.0017230510711669922
local_in_edges_tensor generation:  0.0009601116180419922
mini_batch_src_global generation:  0.0018413066864013672
r_  generation:  0.022860050201416016
local_output_nid generation:  0.0017528533935546875
local_in_edges_tensor generation:  0.0010030269622802734
mini_batch_src_global generation:  0.0018007755279541016
r_  generation:  0.02227163314819336
----------------------check_connections_block total spend ----------------------------- 0.5609209537506104
generate_one_block  0.04532122611999512
generate_one_block  0.039731502532958984
generate_one_block  0.044014692306518555
generate_one_block  0.03955554962158203
generate_one_block  0.040354013442993164
generate_one_block  0.041491031646728516
generate_one_block  0.040242671966552734
generate_one_block  0.04161667823791504
generate_one_block  0.040700435638427734
generate_one_block  0.040322065353393555
generate_one_block  0.03915810585021973
generate_one_block  0.04010796546936035
generate_one_block  0.0402069091796875
generate_one_block  0.04070091247558594
generate_one_block  0.04122567176818848
generate_one_block  0.039844512939453125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04401564598083496
gen group dst list time:  0.032256364822387695
time for parepare:  0.021740436553955078
local_output_nid generation:  0.009799718856811523
local_in_edges_tensor generation:  0.024596452713012695
mini_batch_src_global generation:  0.025634765625
r_  generation:  0.27161478996276855
local_output_nid generation:  0.015022516250610352
local_in_edges_tensor generation:  0.024529695510864258
mini_batch_src_global generation:  0.03763532638549805
r_  generation:  0.277249813079834
local_output_nid generation:  0.0162503719329834
local_in_edges_tensor generation:  0.019955158233642578
mini_batch_src_global generation:  0.03494596481323242
r_  generation:  0.3063669204711914
local_output_nid generation:  0.018995285034179688
local_in_edges_tensor generation:  0.027463674545288086
mini_batch_src_global generation:  0.042020320892333984
r_  generation:  0.2763199806213379
local_output_nid generation:  0.016772747039794922
local_in_edges_tensor generation:  0.020452499389648438
mini_batch_src_global generation:  0.03492569923400879
r_  generation:  0.29610300064086914
local_output_nid generation:  0.01618480682373047
local_in_edges_tensor generation:  0.019725322723388672
mini_batch_src_global generation:  0.034601688385009766
r_  generation:  0.2811307907104492
local_output_nid generation:  0.01678943634033203
local_in_edges_tensor generation:  0.01773238182067871
mini_batch_src_global generation:  0.03576970100402832
r_  generation:  0.2915768623352051
local_output_nid generation:  0.018049955368041992
local_in_edges_tensor generation:  0.017536640167236328
mini_batch_src_global generation:  0.036046504974365234
r_  generation:  0.3017268180847168
local_output_nid generation:  0.017615079879760742
local_in_edges_tensor generation:  0.028752803802490234
mini_batch_src_global generation:  0.03695321083068848
r_  generation:  0.30182456970214844
local_output_nid generation:  0.0212399959564209
local_in_edges_tensor generation:  0.0185699462890625
mini_batch_src_global generation:  0.03839898109436035
r_  generation:  0.27513575553894043
local_output_nid generation:  0.013763189315795898
local_in_edges_tensor generation:  0.018419981002807617
mini_batch_src_global generation:  0.03431344032287598
r_  generation:  0.28275275230407715
local_output_nid generation:  0.013945579528808594
local_in_edges_tensor generation:  0.016178131103515625
mini_batch_src_global generation:  0.03403496742248535
r_  generation:  0.2781047821044922
local_output_nid generation:  0.013957500457763672
local_in_edges_tensor generation:  0.021008729934692383
mini_batch_src_global generation:  0.03443503379821777
r_  generation:  0.27783727645874023
local_output_nid generation:  0.014028787612915039
local_in_edges_tensor generation:  0.01627516746520996
mini_batch_src_global generation:  0.03507423400878906
r_  generation:  0.28339409828186035
local_output_nid generation:  0.01407170295715332
local_in_edges_tensor generation:  0.014497518539428711
mini_batch_src_global generation:  0.03518342971801758
r_  generation:  0.2791166305541992
local_output_nid generation:  0.013761758804321289
local_in_edges_tensor generation:  0.014036178588867188
mini_batch_src_global generation:  0.03404426574707031
r_  generation:  0.2771263122558594
----------------------check_connections_block total spend ----------------------------- 6.713069438934326
generate_one_block  0.4170536994934082
generate_one_block  0.3958721160888672
generate_one_block  0.4007911682128906
generate_one_block  0.3798232078552246
generate_one_block  0.3856546878814697
generate_one_block  0.38428711891174316
generate_one_block  0.43691515922546387
generate_one_block  0.39553356170654297
generate_one_block  0.3875143527984619
generate_one_block  0.38413023948669434
generate_one_block  0.38002610206604004
generate_one_block  0.3838942050933838
generate_one_block  0.3888702392578125
generate_one_block  0.38757848739624023
generate_one_block  0.3897111415863037
generate_one_block  0.37335872650146484
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.07894015312194824
gen group dst list time:  0.06690168380737305
time for parepare:  0.02023029327392578
local_output_nid generation:  0.02623605728149414
local_in_edges_tensor generation:  0.06075692176818848
mini_batch_src_global generation:  0.054490089416503906
r_  generation:  0.5161099433898926
local_output_nid generation:  0.03182363510131836
local_in_edges_tensor generation:  0.05258512496948242
mini_batch_src_global generation:  0.061408042907714844
r_  generation:  0.522376537322998
local_output_nid generation:  0.03232169151306152
local_in_edges_tensor generation:  0.04386615753173828
mini_batch_src_global generation:  0.05852174758911133
r_  generation:  0.5355861186981201
local_output_nid generation:  0.031801462173461914
local_in_edges_tensor generation:  0.038738250732421875
mini_batch_src_global generation:  0.06015491485595703
r_  generation:  0.5317533016204834
local_output_nid generation:  0.032575368881225586
local_in_edges_tensor generation:  0.0899343490600586
mini_batch_src_global generation:  0.060235023498535156
r_  generation:  0.5449967384338379
local_output_nid generation:  0.03242087364196777
local_in_edges_tensor generation:  0.034874677658081055
mini_batch_src_global generation:  0.0612034797668457
r_  generation:  0.5334088802337646
local_output_nid generation:  0.03296065330505371
local_in_edges_tensor generation:  0.04178786277770996
mini_batch_src_global generation:  0.06124520301818848
r_  generation:  0.5516760349273682
local_output_nid generation:  0.0346980094909668
local_in_edges_tensor generation:  0.04495525360107422
mini_batch_src_global generation:  0.0649118423461914
r_  generation:  0.5446188449859619
local_output_nid generation:  0.03350830078125
local_in_edges_tensor generation:  0.04386758804321289
mini_batch_src_global generation:  0.06142425537109375
r_  generation:  0.5633888244628906
local_output_nid generation:  0.03437519073486328
local_in_edges_tensor generation:  0.04710102081298828
mini_batch_src_global generation:  0.07072591781616211
r_  generation:  0.5443680286407471
local_output_nid generation:  0.035639286041259766
local_in_edges_tensor generation:  0.04255867004394531
mini_batch_src_global generation:  0.06525039672851562
r_  generation:  0.5467493534088135
local_output_nid generation:  0.034323930740356445
local_in_edges_tensor generation:  0.038077354431152344
mini_batch_src_global generation:  0.06569099426269531
r_  generation:  0.540130615234375
local_output_nid generation:  0.03457355499267578
local_in_edges_tensor generation:  0.044925689697265625
mini_batch_src_global generation:  0.06492924690246582
r_  generation:  0.5473074913024902
local_output_nid generation:  0.03423810005187988
local_in_edges_tensor generation:  0.03922271728515625
mini_batch_src_global generation:  0.06279563903808594
r_  generation:  0.5425751209259033
local_output_nid generation:  0.03440713882446289
local_in_edges_tensor generation:  0.03543591499328613
mini_batch_src_global generation:  0.0620574951171875
r_  generation:  0.5496852397918701
local_output_nid generation:  0.03395342826843262
local_in_edges_tensor generation:  0.03498196601867676
mini_batch_src_global generation:  0.06252193450927734
r_  generation:  0.5416114330291748
----------------------check_connections_block total spend ----------------------------- 12.819312572479248
generate_one_block  0.7885723114013672
generate_one_block  0.7261478900909424
generate_one_block  0.7317221164703369
generate_one_block  0.7349169254302979
generate_one_block  0.7343928813934326
generate_one_block  0.7126343250274658
generate_one_block  0.7128555774688721
generate_one_block  0.7371525764465332
generate_one_block  0.7718667984008789
generate_one_block  0.7227463722229004
generate_one_block  0.7092595100402832
generate_one_block  0.7321469783782959
generate_one_block  0.7312338352203369
generate_one_block  0.7216296195983887
generate_one_block  0.7082834243774414
generate_one_block  0.7090837955474854
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 0.1311960220336914  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

connection checking time:  19.532382011413574
block generation total time  17.95565915107727
average batch blocks generation time:  1.1222286969423294
block dataloader generation time/epoch 40.700685024261475
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 0.1026005744934082  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

torch.Size([157518, 128])
torch.Size([130051, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 19.822043895721436  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 0.10260820388793945  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

torch.Size([157583, 128])
torch.Size([129825, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 19.76806354522705  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 0.10393524169921875  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

torch.Size([157768, 128])
torch.Size([130440, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 20.042142868041992  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 0.10252904891967773  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

torch.Size([157403, 128])
torch.Size([129600, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 19.799020767211914  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 0.10371875762939453  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

torch.Size([157829, 128])
torch.Size([130655, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2030029296875 GB
    Memory Allocated: 19.834075450897217  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2030029296875 GB
    Memory Allocated: 0.10229158401489258  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

torch.Size([157119, 128])
torch.Size([128643, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2030029296875 GB
    Memory Allocated: 19.701573371887207  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2030029296875 GB
    Memory Allocated: 0.1025686264038086  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

torch.Size([157426, 128])
torch.Size([129099, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2030029296875 GB
    Memory Allocated: 19.82559633255005  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2030029296875 GB
    Memory Allocated: 0.10275030136108398  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

torch.Size([157347, 128])
torch.Size([129980, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2030029296875 GB
    Memory Allocated: 20.015155792236328  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2030029296875 GB
    Memory Allocated: 0.10272026062011719  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

torch.Size([157566, 128])
torch.Size([130001, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2030029296875 GB
    Memory Allocated: 19.880155086517334  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2030029296875 GB
    Memory Allocated: 0.10277128219604492  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

torch.Size([157759, 128])
torch.Size([130050, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2030029296875 GB
    Memory Allocated: 19.848133087158203  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2030029296875 GB
    Memory Allocated: 0.10364627838134766  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

torch.Size([157733, 128])
torch.Size([129772, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2030029296875 GB
    Memory Allocated: 19.819923877716064  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2030029296875 GB
    Memory Allocated: 0.10262155532836914  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

torch.Size([157521, 128])
torch.Size([130151, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2030029296875 GB
    Memory Allocated: 19.81462335586548  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2030029296875 GB
    Memory Allocated: 0.10376167297363281  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

torch.Size([157719, 128])
torch.Size([130184, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2030029296875 GB
    Memory Allocated: 19.91683530807495  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2030029296875 GB
    Memory Allocated: 0.10283756256103516  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

torch.Size([157814, 128])
torch.Size([130054, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2030029296875 GB
    Memory Allocated: 19.89699697494507  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2030029296875 GB
    Memory Allocated: 0.1027669906616211  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

torch.Size([157634, 128])
torch.Size([130033, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2030029296875 GB
    Memory Allocated: 19.91887617111206  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2030029296875 GB
    Memory Allocated: 0.1024322509765625  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

torch.Size([157336, 128])
torch.Size([129242, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2030029296875 GB
    Memory Allocated: 19.745381832122803  GigaBytes
Max Memory Allocated: 20.1625714302063  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.033082857728004456 |0.023565024137496948 |0.6461849063634872 |0.00010508298873901367 |1.1901412606239319 |0.006259918212890625 |
----------------------------------------------------------pseudo_mini_loss sum 3.3170199394226074
Total (block generation + training)time/epoch 71.0566463470459
Training time/epoch 30.35550022125244
Training time without block to device /epoch 29.97845983505249
Training time without total dataloading part /epoch 29.38915991783142
load block tensor time/epoch 0.5293257236480713
block to device time/epoch 0.37704038619995117
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5329175
Number of first layer input nodes during this epoch:  2521075
