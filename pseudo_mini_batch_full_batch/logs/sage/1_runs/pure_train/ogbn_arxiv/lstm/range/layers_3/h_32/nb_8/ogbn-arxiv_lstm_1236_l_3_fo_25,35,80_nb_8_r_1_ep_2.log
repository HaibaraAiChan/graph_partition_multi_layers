Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648466391.5396385
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02741718292236328
range selection method range initialization spend 0.012935876846313477
time for parepare:  0.01790618896484375
local_output_nid generation:  0.002682209014892578
local_in_edges_tensor generation:  0.005084514617919922
mini_batch_src_global generation:  0.0036547183990478516
r_  generation:  0.04145002365112305
local_output_nid generation:  0.0029528141021728516
local_in_edges_tensor generation:  0.0017020702362060547
mini_batch_src_global generation:  0.0045549869537353516
r_  generation:  0.04367780685424805
local_output_nid generation:  0.0031321048736572266
local_in_edges_tensor generation:  0.00167083740234375
mini_batch_src_global generation:  0.003211498260498047
r_  generation:  0.04291176795959473
local_output_nid generation:  0.003198385238647461
local_in_edges_tensor generation:  0.0016841888427734375
mini_batch_src_global generation:  0.0031442642211914062
r_  generation:  0.0446925163269043
local_output_nid generation:  0.00316619873046875
local_in_edges_tensor generation:  0.0017099380493164062
mini_batch_src_global generation:  0.003438711166381836
r_  generation:  0.0447850227355957
local_output_nid generation:  0.003177165985107422
local_in_edges_tensor generation:  0.0017316341400146484
mini_batch_src_global generation:  0.0036203861236572266
r_  generation:  0.04734444618225098
local_output_nid generation:  0.0031881332397460938
local_in_edges_tensor generation:  0.0017211437225341797
mini_batch_src_global generation:  0.003690481185913086
r_  generation:  0.0463104248046875
local_output_nid generation:  0.0031328201293945312
local_in_edges_tensor generation:  0.0017139911651611328
mini_batch_src_global generation:  0.0038039684295654297
r_  generation:  0.04852724075317383
----------------------check_connections_block total spend ----------------------------- 0.5227904319763184
generate_one_block  0.06219744682312012
generate_one_block  0.06137895584106445
generate_one_block  0.06043553352355957
generate_one_block  0.06106209754943848
generate_one_block  0.06293773651123047
generate_one_block  0.0614781379699707
generate_one_block  0.06116914749145508
generate_one_block  0.06374168395996094
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03993344306945801
gen group dst list time:  0.01610255241394043
time for parepare:  0.01939845085144043
local_output_nid generation:  0.01137542724609375
local_in_edges_tensor generation:  0.032156944274902344
mini_batch_src_global generation:  0.029880523681640625
r_  generation:  0.3143148422241211
local_output_nid generation:  0.01710677146911621
local_in_edges_tensor generation:  0.031343936920166016
mini_batch_src_global generation:  0.03855466842651367
r_  generation:  0.3274495601654053
local_output_nid generation:  0.017107248306274414
local_in_edges_tensor generation:  0.02627253532409668
mini_batch_src_global generation:  0.037841796875
r_  generation:  0.32663679122924805
local_output_nid generation:  0.017803192138671875
local_in_edges_tensor generation:  0.023479700088500977
mini_batch_src_global generation:  0.04138374328613281
r_  generation:  0.3304576873779297
local_output_nid generation:  0.01802659034729004
local_in_edges_tensor generation:  0.021248579025268555
mini_batch_src_global generation:  0.03978228569030762
r_  generation:  0.3350710868835449
local_output_nid generation:  0.01831674575805664
local_in_edges_tensor generation:  0.024518251419067383
mini_batch_src_global generation:  0.041669368743896484
r_  generation:  0.3474996089935303
local_output_nid generation:  0.018312454223632812
local_in_edges_tensor generation:  0.027260303497314453
mini_batch_src_global generation:  0.04079842567443848
r_  generation:  0.3553478717803955
local_output_nid generation:  0.018609046936035156
local_in_edges_tensor generation:  0.029223203659057617
mini_batch_src_global generation:  0.043776750564575195
r_  generation:  0.35258030891418457
----------------------check_connections_block total spend ----------------------------- 3.958948850631714
generate_one_block  0.4712038040161133
generate_one_block  0.4775807857513428
generate_one_block  0.4535348415374756
generate_one_block  0.4377706050872803
generate_one_block  0.46173572540283203
generate_one_block  0.49045681953430176
generate_one_block  0.4437432289123535
generate_one_block  0.4473261833190918
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.052617549896240234
gen group dst list time:  0.04163408279418945
time for parepare:  0.019792795181274414
local_output_nid generation:  0.02642083168029785
local_in_edges_tensor generation:  0.06964325904846191
mini_batch_src_global generation:  0.0491032600402832
r_  generation:  0.4959754943847656
local_output_nid generation:  0.03276419639587402
local_in_edges_tensor generation:  0.04967498779296875
mini_batch_src_global generation:  0.054518699645996094
r_  generation:  0.4919314384460449
local_output_nid generation:  0.03811025619506836
local_in_edges_tensor generation:  0.04273056983947754
mini_batch_src_global generation:  0.05243349075317383
r_  generation:  0.5030722618103027
local_output_nid generation:  0.03402519226074219
local_in_edges_tensor generation:  0.04424166679382324
mini_batch_src_global generation:  0.0574190616607666
r_  generation:  0.5178353786468506
local_output_nid generation:  0.03784680366516113
local_in_edges_tensor generation:  0.04058241844177246
mini_batch_src_global generation:  0.058023691177368164
r_  generation:  0.5033106803894043
local_output_nid generation:  0.03549981117248535
local_in_edges_tensor generation:  0.03808116912841797
mini_batch_src_global generation:  0.055400848388671875
r_  generation:  0.49977707862854004
local_output_nid generation:  0.03543567657470703
local_in_edges_tensor generation:  0.042952537536621094
mini_batch_src_global generation:  0.054346561431884766
r_  generation:  0.500868558883667
local_output_nid generation:  0.03567647933959961
local_in_edges_tensor generation:  0.034151315689086914
mini_batch_src_global generation:  0.05539083480834961
r_  generation:  0.4962501525878906
----------------------check_connections_block total spend ----------------------------- 5.999163866043091
generate_one_block  0.6264493465423584
generate_one_block  0.622046709060669
generate_one_block  0.6252636909484863
generate_one_block  0.626084566116333
generate_one_block  0.6186981201171875
generate_one_block  0.6331110000610352
generate_one_block  0.6695139408111572
generate_one_block  0.6236114501953125
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

connection checking time:  9.958112716674805
block generation total time  8.72813081741333
average batch blocks generation time:  1.0910163521766663
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.09787273406982422  GigaBytes
Max Memory Allocated: 0.09787273406982422  GigaBytes

torch.Size([160924, 128])
torch.Size([142681, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8670654296875 GB
    Memory Allocated: 13.5387601852417  GigaBytes
Max Memory Allocated: 13.553458213806152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8807373046875 GB
    Memory Allocated: 0.1003122329711914  GigaBytes
Max Memory Allocated: 13.553458213806152  GigaBytes

torch.Size([160843, 128])
torch.Size([142756, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 13.556007862091064  GigaBytes
Max Memory Allocated: 13.572075366973877  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 0.09995651245117188  GigaBytes
Max Memory Allocated: 13.572075366973877  GigaBytes

torch.Size([160707, 128])
torch.Size([142370, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 13.504744529724121  GigaBytes
Max Memory Allocated: 13.572075366973877  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 0.10006237030029297  GigaBytes
Max Memory Allocated: 13.572075366973877  GigaBytes

torch.Size([160869, 128])
torch.Size([142677, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 13.505946159362793  GigaBytes
Max Memory Allocated: 13.572075366973877  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 0.10014772415161133  GigaBytes
Max Memory Allocated: 13.572075366973877  GigaBytes

torch.Size([161020, 128])
torch.Size([142921, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 13.525174140930176  GigaBytes
Max Memory Allocated: 13.572075366973877  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 0.10035371780395508  GigaBytes
Max Memory Allocated: 13.572075366973877  GigaBytes

torch.Size([161022, 128])
torch.Size([143089, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1444091796875 GB
    Memory Allocated: 13.589360237121582  GigaBytes
Max Memory Allocated: 13.6054105758667  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1444091796875 GB
    Memory Allocated: 0.10014963150024414  GigaBytes
Max Memory Allocated: 13.6054105758667  GigaBytes

torch.Size([160768, 128])
torch.Size([143025, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1444091796875 GB
    Memory Allocated: 13.57019853591919  GigaBytes
Max Memory Allocated: 13.6054105758667  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1444091796875 GB
    Memory Allocated: 0.10028982162475586  GigaBytes
Max Memory Allocated: 13.6054105758667  GigaBytes

torch.Size([160892, 128])
torch.Size([142861, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1444091796875 GB
    Memory Allocated: 13.578768730163574  GigaBytes
Max Memory Allocated: 13.6054105758667  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04042840003967285 |0.06503057479858398 |0.5149175524711609 |0.00011691451072692871 |0.7108979225158691 |0.010408401489257812 |
----------------------------------------------------------pseudo_mini_loss sum 4.396155834197998
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3018449
Number of first layer input nodes during this epoch:  1287045
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 15.1444091796875 GB
    Memory Allocated: 0.13338994979858398  GigaBytes
Max Memory Allocated: 13.6054105758667  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025207996368408203
range selection method range initialization spend 0.011954545974731445
time for parepare:  0.01749110221862793
local_output_nid generation:  0.0060651302337646484
local_in_edges_tensor generation:  0.005555152893066406
mini_batch_src_global generation:  0.003890514373779297
r_  generation:  0.04297018051147461
local_output_nid generation:  0.0035533905029296875
local_in_edges_tensor generation:  0.0016965866088867188
mini_batch_src_global generation:  0.00497889518737793
r_  generation:  0.044320106506347656
local_output_nid generation:  0.0035326480865478516
local_in_edges_tensor generation:  0.001817464828491211
mini_batch_src_global generation:  0.003226757049560547
r_  generation:  0.04509687423706055
local_output_nid generation:  0.003679513931274414
local_in_edges_tensor generation:  0.0017740726470947266
mini_batch_src_global generation:  0.003404855728149414
r_  generation:  0.046712398529052734
local_output_nid generation:  0.003514528274536133
local_in_edges_tensor generation:  0.0017437934875488281
mini_batch_src_global generation:  0.0035123825073242188
r_  generation:  0.0475466251373291
local_output_nid generation:  0.0035810470581054688
local_in_edges_tensor generation:  0.0017864704132080078
mini_batch_src_global generation:  0.0039212703704833984
r_  generation:  0.04950451850891113
local_output_nid generation:  0.0035436153411865234
local_in_edges_tensor generation:  0.0017611980438232422
mini_batch_src_global generation:  0.003725290298461914
r_  generation:  0.04959678649902344
local_output_nid generation:  0.0035691261291503906
local_in_edges_tensor generation:  0.0017507076263427734
mini_batch_src_global generation:  0.003941774368286133
r_  generation:  0.04966402053833008
----------------------check_connections_block total spend ----------------------------- 0.5519311428070068
generate_one_block  0.07506465911865234
generate_one_block  0.07092046737670898
generate_one_block  0.07067203521728516
generate_one_block  0.07414841651916504
generate_one_block  0.07228565216064453
generate_one_block  0.07431674003601074
generate_one_block  0.07558202743530273
generate_one_block  0.07442927360534668
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03569912910461426
gen group dst list time:  0.016573429107666016
time for parepare:  0.02187037467956543
local_output_nid generation:  0.012554645538330078
local_in_edges_tensor generation:  0.029068946838378906
mini_batch_src_global generation:  0.030620813369750977
r_  generation:  0.324324369430542
local_output_nid generation:  0.01799917221069336
local_in_edges_tensor generation:  0.029288053512573242
mini_batch_src_global generation:  0.03888344764709473
r_  generation:  0.3329956531524658
local_output_nid generation:  0.01825857162475586
local_in_edges_tensor generation:  0.023874282836914062
mini_batch_src_global generation:  0.03791356086730957
r_  generation:  0.3322417736053467
local_output_nid generation:  0.0183563232421875
local_in_edges_tensor generation:  0.021373987197875977
mini_batch_src_global generation:  0.03998875617980957
r_  generation:  0.33945536613464355
local_output_nid generation:  0.018589496612548828
local_in_edges_tensor generation:  0.02458667755126953
mini_batch_src_global generation:  0.040361881256103516
r_  generation:  0.3412203788757324
local_output_nid generation:  0.018842220306396484
local_in_edges_tensor generation:  0.022346973419189453
mini_batch_src_global generation:  0.043607234954833984
r_  generation:  0.34595417976379395
local_output_nid generation:  0.018887042999267578
local_in_edges_tensor generation:  0.02180194854736328
mini_batch_src_global generation:  0.04449892044067383
r_  generation:  0.34673237800598145
local_output_nid generation:  0.018994808197021484
local_in_edges_tensor generation:  0.021825313568115234
mini_batch_src_global generation:  0.04431772232055664
r_  generation:  0.34694862365722656
----------------------check_connections_block total spend ----------------------------- 3.9648795127868652
generate_one_block  0.4620487689971924
generate_one_block  0.4750380516052246
generate_one_block  0.4603312015533447
generate_one_block  0.46297168731689453
generate_one_block  0.4603707790374756
generate_one_block  0.4695115089416504
generate_one_block  0.4693591594696045
generate_one_block  0.4936842918395996
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.040454864501953125
gen group dst list time:  0.037448883056640625
time for parepare:  0.01949596405029297
local_output_nid generation:  0.027340173721313477
local_in_edges_tensor generation:  0.05833697319030762
mini_batch_src_global generation:  0.04454183578491211
r_  generation:  0.5071606636047363
local_output_nid generation:  0.0350184440612793
local_in_edges_tensor generation:  0.049008846282958984
mini_batch_src_global generation:  0.05572152137756348
r_  generation:  0.49310731887817383
local_output_nid generation:  0.03606700897216797
local_in_edges_tensor generation:  0.041921377182006836
mini_batch_src_global generation:  0.050740957260131836
r_  generation:  0.4966623783111572
local_output_nid generation:  0.03570199012756348
local_in_edges_tensor generation:  0.03273487091064453
mini_batch_src_global generation:  0.0546879768371582
r_  generation:  0.49336695671081543
local_output_nid generation:  0.03650069236755371
local_in_edges_tensor generation:  0.034089088439941406
mini_batch_src_global generation:  0.05678248405456543
r_  generation:  0.5122170448303223
local_output_nid generation:  0.036004066467285156
local_in_edges_tensor generation:  0.0456242561340332
mini_batch_src_global generation:  0.055228233337402344
r_  generation:  0.5021233558654785
local_output_nid generation:  0.03526115417480469
local_in_edges_tensor generation:  0.04510688781738281
mini_batch_src_global generation:  0.05329298973083496
r_  generation:  0.5078091621398926
local_output_nid generation:  0.03497600555419922
local_in_edges_tensor generation:  0.04068779945373535
mini_batch_src_global generation:  0.058026790618896484
r_  generation:  0.5137736797332764
----------------------check_connections_block total spend ----------------------------- 5.985395908355713
generate_one_block  0.6737303733825684
generate_one_block  0.6601722240447998
generate_one_block  0.6476266384124756
generate_one_block  0.6389129161834717
generate_one_block  0.6519804000854492
generate_one_block  0.6534209251403809
generate_one_block  0.6507148742675781
generate_one_block  0.6617138385772705
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 15.1444091796875 GB
    Memory Allocated: 0.13338994979858398  GigaBytes
Max Memory Allocated: 13.6054105758667  GigaBytes

connection checking time:  9.950275421142578
block generation total time  8.99158763885498
average batch blocks generation time:  1.1239484548568726
block dataloader generation time/epoch 21.33522653579712
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1444091796875 GB
    Memory Allocated: 0.10139894485473633  GigaBytes
Max Memory Allocated: 13.6054105758667  GigaBytes

torch.Size([160931, 128])
torch.Size([143042, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1444091796875 GB
    Memory Allocated: 13.56241226196289  GigaBytes
Max Memory Allocated: 13.6054105758667  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1444091796875 GB
    Memory Allocated: 0.10138273239135742  GigaBytes
Max Memory Allocated: 13.6054105758667  GigaBytes

torch.Size([160962, 128])
torch.Size([142909, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1444091796875 GB
    Memory Allocated: 13.54621410369873  GigaBytes
Max Memory Allocated: 13.6054105758667  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1444091796875 GB
    Memory Allocated: 0.1012721061706543  GigaBytes
Max Memory Allocated: 13.6054105758667  GigaBytes

torch.Size([160936, 128])
torch.Size([143159, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1444091796875 GB
    Memory Allocated: 13.513996124267578  GigaBytes
Max Memory Allocated: 13.6054105758667  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1444091796875 GB
    Memory Allocated: 0.10121011734008789  GigaBytes
Max Memory Allocated: 13.6054105758667  GigaBytes

torch.Size([160594, 128])
torch.Size([142503, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1444091796875 GB
    Memory Allocated: 13.543073177337646  GigaBytes
Max Memory Allocated: 13.6054105758667  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1444091796875 GB
    Memory Allocated: 0.10140132904052734  GigaBytes
Max Memory Allocated: 13.6054105758667  GigaBytes

torch.Size([160961, 128])
torch.Size([142964, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1444091796875 GB
    Memory Allocated: 13.54230785369873  GigaBytes
Max Memory Allocated: 13.6054105758667  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1444091796875 GB
    Memory Allocated: 0.10148096084594727  GigaBytes
Max Memory Allocated: 13.6054105758667  GigaBytes

torch.Size([160982, 128])
torch.Size([143091, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1444091796875 GB
    Memory Allocated: 13.573208808898926  GigaBytes
Max Memory Allocated: 13.6054105758667  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1444091796875 GB
    Memory Allocated: 0.10145044326782227  GigaBytes
Max Memory Allocated: 13.6054105758667  GigaBytes

torch.Size([160898, 128])
torch.Size([143120, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1444091796875 GB
    Memory Allocated: 13.580425262451172  GigaBytes
Max Memory Allocated: 13.6054105758667  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1444091796875 GB
    Memory Allocated: 0.10153675079345703  GigaBytes
Max Memory Allocated: 13.6054105758667  GigaBytes

torch.Size([161005, 128])
torch.Size([143079, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1444091796875 GB
    Memory Allocated: 13.588679313659668  GigaBytes
Max Memory Allocated: 13.6054105758667  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.039482563734054565 |0.01874297857284546 |0.4439360797405243 |9.769201278686523e-05 |0.6948319971561432 |0.005581378936767578 |
----------------------------------------------------------pseudo_mini_loss sum 3.7011985778808594
Total (block generation + training)time/epoch 30.93256402015686
Training time/epoch 9.597088098526001
Training time without block to device /epoch 9.447144269943237
Training time without total dataloading part /epoch 9.116507530212402
load block tensor time/epoch 0.3158605098724365
block to device time/epoch 0.14994382858276367
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3021185
Number of first layer input nodes during this epoch:  1287269
