Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648467196.2089648
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026093006134033203
range selection method range initialization spend 0.01359415054321289
time for parepare:  0.018024682998657227
local_output_nid generation:  0.0013325214385986328
local_in_edges_tensor generation:  0.0033049583435058594
mini_batch_src_global generation:  0.0019898414611816406
r_  generation:  0.021461009979248047
local_output_nid generation:  0.001556396484375
local_in_edges_tensor generation:  0.0009396076202392578
mini_batch_src_global generation:  0.00243377685546875
r_  generation:  0.020701169967651367
local_output_nid generation:  0.0015490055084228516
local_in_edges_tensor generation:  0.0008993148803710938
mini_batch_src_global generation:  0.0015380382537841797
r_  generation:  0.020977020263671875
local_output_nid generation:  0.00156402587890625
local_in_edges_tensor generation:  0.0008895397186279297
mini_batch_src_global generation:  0.001554727554321289
r_  generation:  0.020739078521728516
local_output_nid generation:  0.0015683174133300781
local_in_edges_tensor generation:  0.0008792877197265625
mini_batch_src_global generation:  0.001519918441772461
r_  generation:  0.020624160766601562
local_output_nid generation:  0.0015804767608642578
local_in_edges_tensor generation:  0.0008952617645263672
mini_batch_src_global generation:  0.0015730857849121094
r_  generation:  0.02121734619140625
local_output_nid generation:  0.0016124248504638672
local_in_edges_tensor generation:  0.0009529590606689453
mini_batch_src_global generation:  0.0015957355499267578
r_  generation:  0.021142244338989258
local_output_nid generation:  0.0015664100646972656
local_in_edges_tensor generation:  0.0008985996246337891
mini_batch_src_global generation:  0.0016307830810546875
r_  generation:  0.02161860466003418
local_output_nid generation:  0.0015594959259033203
local_in_edges_tensor generation:  0.0009081363677978516
mini_batch_src_global generation:  0.001590728759765625
r_  generation:  0.02152705192565918
local_output_nid generation:  0.001638174057006836
local_in_edges_tensor generation:  0.0008716583251953125
mini_batch_src_global generation:  0.0016374588012695312
r_  generation:  0.021162748336791992
local_output_nid generation:  0.0015523433685302734
local_in_edges_tensor generation:  0.0008990764617919922
mini_batch_src_global generation:  0.0016734600067138672
r_  generation:  0.021496057510375977
local_output_nid generation:  0.0015957355499267578
local_in_edges_tensor generation:  0.0008754730224609375
mini_batch_src_global generation:  0.0016770362854003906
r_  generation:  0.022140026092529297
local_output_nid generation:  0.0015685558319091797
local_in_edges_tensor generation:  0.0008997917175292969
mini_batch_src_global generation:  0.001712799072265625
r_  generation:  0.021955013275146484
local_output_nid generation:  0.0015876293182373047
local_in_edges_tensor generation:  0.0008916854858398438
mini_batch_src_global generation:  0.001703023910522461
r_  generation:  0.021243572235107422
local_output_nid generation:  0.001558542251586914
local_in_edges_tensor generation:  0.0008816719055175781
mini_batch_src_global generation:  0.001752614974975586
r_  generation:  0.024236440658569336
local_output_nid generation:  0.0015726089477539062
local_in_edges_tensor generation:  0.0009236335754394531
mini_batch_src_global generation:  0.0017504692077636719
r_  generation:  0.022373676300048828
----------------------check_connections_block total spend ----------------------------- 0.5072479248046875
generate_one_block  0.03060150146484375
generate_one_block  0.031835079193115234
generate_one_block  0.03320002555847168
generate_one_block  0.0311586856842041
generate_one_block  0.03039693832397461
generate_one_block  0.031161069869995117
generate_one_block  0.03094959259033203
generate_one_block  0.031419992446899414
generate_one_block  0.030891895294189453
generate_one_block  0.030613183975219727
generate_one_block  0.03114914894104004
generate_one_block  0.03183770179748535
generate_one_block  0.03178524971008301
generate_one_block  0.031157732009887695
generate_one_block  0.03224658966064453
generate_one_block  0.031118154525756836
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03957223892211914
gen group dst list time:  0.020984888076782227
time for parepare:  0.019124507904052734
local_output_nid generation:  0.0072917938232421875
local_in_edges_tensor generation:  0.01771068572998047
mini_batch_src_global generation:  0.027683734893798828
r_  generation:  0.24799227714538574
local_output_nid generation:  0.011754751205444336
local_in_edges_tensor generation:  0.021744966506958008
mini_batch_src_global generation:  0.0320439338684082
r_  generation:  0.24918293952941895
local_output_nid generation:  0.012392282485961914
local_in_edges_tensor generation:  0.01809072494506836
mini_batch_src_global generation:  0.039156198501586914
r_  generation:  0.26056838035583496
local_output_nid generation:  0.012496232986450195
local_in_edges_tensor generation:  0.01774430274963379
mini_batch_src_global generation:  0.03190803527832031
r_  generation:  0.25963807106018066
local_output_nid generation:  0.012865066528320312
local_in_edges_tensor generation:  0.015502214431762695
mini_batch_src_global generation:  0.0326690673828125
r_  generation:  0.26050853729248047
local_output_nid generation:  0.012936115264892578
local_in_edges_tensor generation:  0.015580892562866211
mini_batch_src_global generation:  0.03336453437805176
r_  generation:  0.26232242584228516
local_output_nid generation:  0.01296091079711914
local_in_edges_tensor generation:  0.015337467193603516
mini_batch_src_global generation:  0.033164262771606445
r_  generation:  0.25992703437805176
local_output_nid generation:  0.013254404067993164
local_in_edges_tensor generation:  0.020448923110961914
mini_batch_src_global generation:  0.03347420692443848
r_  generation:  0.2669563293457031
local_output_nid generation:  0.013354063034057617
local_in_edges_tensor generation:  0.015990734100341797
mini_batch_src_global generation:  0.03404402732849121
r_  generation:  0.264803409576416
local_output_nid generation:  0.013240575790405273
local_in_edges_tensor generation:  0.013085126876831055
mini_batch_src_global generation:  0.033914804458618164
r_  generation:  0.270768404006958
local_output_nid generation:  0.013694047927856445
local_in_edges_tensor generation:  0.018291950225830078
mini_batch_src_global generation:  0.03460335731506348
r_  generation:  0.2702333927154541
local_output_nid generation:  0.013604164123535156
local_in_edges_tensor generation:  0.02115797996520996
mini_batch_src_global generation:  0.03435873985290527
r_  generation:  0.2726914882659912
local_output_nid generation:  0.013421297073364258
local_in_edges_tensor generation:  0.013960599899291992
mini_batch_src_global generation:  0.03448772430419922
r_  generation:  0.27204203605651855
local_output_nid generation:  0.013408422470092773
local_in_edges_tensor generation:  0.013840675354003906
mini_batch_src_global generation:  0.03429293632507324
r_  generation:  0.26743364334106445
local_output_nid generation:  0.013832807540893555
local_in_edges_tensor generation:  0.018865346908569336
mini_batch_src_global generation:  0.03489542007446289
r_  generation:  0.2788822650909424
local_output_nid generation:  0.013475894927978516
local_in_edges_tensor generation:  0.018391847610473633
mini_batch_src_global generation:  0.03410482406616211
r_  generation:  0.269345760345459
----------------------check_connections_block total spend ----------------------------- 6.178742408752441
generate_one_block  0.3535294532775879
generate_one_block  0.34696531295776367
generate_one_block  0.3539748191833496
generate_one_block  0.35024261474609375
generate_one_block  0.362396240234375
generate_one_block  0.34655022621154785
generate_one_block  0.3387022018432617
generate_one_block  0.3524308204650879
generate_one_block  0.3505263328552246
generate_one_block  0.3500633239746094
generate_one_block  0.3588552474975586
generate_one_block  0.36215639114379883
generate_one_block  0.35632801055908203
generate_one_block  0.3437223434448242
generate_one_block  0.37476038932800293
generate_one_block  0.350996732711792
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.032122135162353516
gen group dst list time:  0.06513333320617676
time for parepare:  0.018771886825561523
local_output_nid generation:  0.024927139282226562
local_in_edges_tensor generation:  0.037615060806274414
mini_batch_src_global generation:  0.04159808158874512
r_  generation:  0.44766759872436523
local_output_nid generation:  0.030303478240966797
local_in_edges_tensor generation:  0.04487872123718262
mini_batch_src_global generation:  0.05213427543640137
r_  generation:  0.45833635330200195
local_output_nid generation:  0.03026437759399414
local_in_edges_tensor generation:  0.037514448165893555
mini_batch_src_global generation:  0.05022764205932617
r_  generation:  0.4704580307006836
local_output_nid generation:  0.03051280975341797
local_in_edges_tensor generation:  0.032918453216552734
mini_batch_src_global generation:  0.0542755126953125
r_  generation:  0.46389317512512207
local_output_nid generation:  0.031083345413208008
local_in_edges_tensor generation:  0.032738685607910156
mini_batch_src_global generation:  0.05228757858276367
r_  generation:  0.47140049934387207
local_output_nid generation:  0.030530691146850586
local_in_edges_tensor generation:  0.029643535614013672
mini_batch_src_global generation:  0.05256772041320801
r_  generation:  0.4724724292755127
local_output_nid generation:  0.032236576080322266
local_in_edges_tensor generation:  0.03420710563659668
mini_batch_src_global generation:  0.053008079528808594
r_  generation:  0.46959996223449707
local_output_nid generation:  0.03155636787414551
local_in_edges_tensor generation:  0.03772902488708496
mini_batch_src_global generation:  0.052529335021972656
r_  generation:  0.46843481063842773
local_output_nid generation:  0.031189441680908203
local_in_edges_tensor generation:  0.03775143623352051
mini_batch_src_global generation:  0.05307912826538086
r_  generation:  0.4732823371887207
local_output_nid generation:  0.03143167495727539
local_in_edges_tensor generation:  0.036684274673461914
mini_batch_src_global generation:  0.0667421817779541
r_  generation:  0.47209596633911133
local_output_nid generation:  0.035337209701538086
local_in_edges_tensor generation:  0.04049062728881836
mini_batch_src_global generation:  0.05820798873901367
r_  generation:  0.4760887622833252
local_output_nid generation:  0.032918453216552734
local_in_edges_tensor generation:  0.04140973091125488
mini_batch_src_global generation:  0.05376911163330078
r_  generation:  0.4740736484527588
local_output_nid generation:  0.03336906433105469
local_in_edges_tensor generation:  0.03344321250915527
mini_batch_src_global generation:  0.07054853439331055
r_  generation:  0.47709155082702637
local_output_nid generation:  0.03345227241516113
local_in_edges_tensor generation:  0.03795647621154785
mini_batch_src_global generation:  0.05766439437866211
r_  generation:  0.4740025997161865
local_output_nid generation:  0.03317070007324219
local_in_edges_tensor generation:  0.03329968452453613
mini_batch_src_global generation:  0.05591583251953125
r_  generation:  0.4768798351287842
local_output_nid generation:  0.03362107276916504
local_in_edges_tensor generation:  0.030323266983032227
mini_batch_src_global generation:  0.0537264347076416
r_  generation:  0.4922909736633301
----------------------check_connections_block total spend ----------------------------- 11.2213134765625
generate_one_block  0.6066775321960449
generate_one_block  0.609203577041626
generate_one_block  0.6072700023651123
generate_one_block  0.5905773639678955
generate_one_block  0.609307050704956
generate_one_block  0.578730583190918
generate_one_block  0.6474111080169678
generate_one_block  0.5972347259521484
generate_one_block  0.5975313186645508
generate_one_block  0.5780589580535889
generate_one_block  0.5961875915527344
generate_one_block  0.6028375625610352
generate_one_block  0.5891716480255127
generate_one_block  0.590085506439209
generate_one_block  0.5901646614074707
generate_one_block  0.589712381362915
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

connection checking time:  17.40005588531494
block generation total time  15.232362031936646
average batch blocks generation time:  0.9520226269960403
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.09316635131835938  GigaBytes
Max Memory Allocated: 0.09316635131835938  GigaBytes

torch.Size([156815, 128])
torch.Size([129759, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.3768310546875 GB
    Memory Allocated: 12.736981391906738  GigaBytes
Max Memory Allocated: 12.744256973266602  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.3885498046875 GB
    Memory Allocated: 0.0952749252319336  GigaBytes
Max Memory Allocated: 12.744256973266602  GigaBytes

torch.Size([156786, 128])
torch.Size([129659, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.6307373046875 GB
    Memory Allocated: 12.702937126159668  GigaBytes
Max Memory Allocated: 12.744256973266602  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.6307373046875 GB
    Memory Allocated: 0.09539175033569336  GigaBytes
Max Memory Allocated: 12.744256973266602  GigaBytes

torch.Size([156647, 128])
torch.Size([130077, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.6307373046875 GB
    Memory Allocated: 12.751747131347656  GigaBytes
Max Memory Allocated: 12.759814262390137  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.6307373046875 GB
    Memory Allocated: 0.09524106979370117  GigaBytes
Max Memory Allocated: 12.759814262390137  GigaBytes

torch.Size([156593, 128])
torch.Size([129275, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.6307373046875 GB
    Memory Allocated: 12.691643238067627  GigaBytes
Max Memory Allocated: 12.759814262390137  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.6307373046875 GB
    Memory Allocated: 0.0953683853149414  GigaBytes
Max Memory Allocated: 12.759814262390137  GigaBytes

torch.Size([156998, 128])
torch.Size([130199, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3280029296875 GB
    Memory Allocated: 12.711549282073975  GigaBytes
Max Memory Allocated: 12.759814262390137  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3280029296875 GB
    Memory Allocated: 0.0951070785522461  GigaBytes
Max Memory Allocated: 12.759814262390137  GigaBytes

torch.Size([156364, 128])
torch.Size([128729, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3280029296875 GB
    Memory Allocated: 12.667284488677979  GigaBytes
Max Memory Allocated: 12.759814262390137  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3280029296875 GB
    Memory Allocated: 0.09521198272705078  GigaBytes
Max Memory Allocated: 12.759814262390137  GigaBytes

torch.Size([156776, 128])
torch.Size([129592, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3280029296875 GB
    Memory Allocated: 12.689008235931396  GigaBytes
Max Memory Allocated: 12.759814262390137  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3280029296875 GB
    Memory Allocated: 0.09549093246459961  GigaBytes
Max Memory Allocated: 12.759814262390137  GigaBytes

torch.Size([157019, 128])
torch.Size([129982, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3280029296875 GB
    Memory Allocated: 12.728814601898193  GigaBytes
Max Memory Allocated: 12.759814262390137  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3280029296875 GB
    Memory Allocated: 0.09537935256958008  GigaBytes
Max Memory Allocated: 12.759814262390137  GigaBytes

torch.Size([156909, 128])
torch.Size([130010, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3280029296875 GB
    Memory Allocated: 12.712153434753418  GigaBytes
Max Memory Allocated: 12.759814262390137  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3280029296875 GB
    Memory Allocated: 0.09537649154663086  GigaBytes
Max Memory Allocated: 12.759814262390137  GigaBytes

torch.Size([156919, 128])
torch.Size([129667, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3280029296875 GB
    Memory Allocated: 12.713917255401611  GigaBytes
Max Memory Allocated: 12.759814262390137  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3280029296875 GB
    Memory Allocated: 0.09565353393554688  GigaBytes
Max Memory Allocated: 12.759814262390137  GigaBytes

torch.Size([157122, 128])
torch.Size([130419, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3338623046875 GB
    Memory Allocated: 12.782395839691162  GigaBytes
Max Memory Allocated: 12.79040002822876  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3338623046875 GB
    Memory Allocated: 0.0956416130065918  GigaBytes
Max Memory Allocated: 12.79040002822876  GigaBytes

torch.Size([157057, 128])
torch.Size([130510, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3358154296875 GB
    Memory Allocated: 12.78539514541626  GigaBytes
Max Memory Allocated: 12.793516635894775  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3358154296875 GB
    Memory Allocated: 0.09546327590942383  GigaBytes
Max Memory Allocated: 12.793516635894775  GigaBytes

torch.Size([156711, 128])
torch.Size([129943, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3494873046875 GB
    Memory Allocated: 12.76377534866333  GigaBytes
Max Memory Allocated: 12.793516635894775  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3494873046875 GB
    Memory Allocated: 0.09535360336303711  GigaBytes
Max Memory Allocated: 12.793516635894775  GigaBytes

torch.Size([156865, 128])
torch.Size([130043, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3494873046875 GB
    Memory Allocated: 12.719647884368896  GigaBytes
Max Memory Allocated: 12.793516635894775  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3494873046875 GB
    Memory Allocated: 0.09566926956176758  GigaBytes
Max Memory Allocated: 12.793516635894775  GigaBytes

torch.Size([156887, 128])
torch.Size([130177, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3592529296875 GB
    Memory Allocated: 12.79963493347168  GigaBytes
Max Memory Allocated: 12.808029174804688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3592529296875 GB
    Memory Allocated: 0.09536504745483398  GigaBytes
Max Memory Allocated: 12.808029174804688  GigaBytes

torch.Size([156801, 128])
torch.Size([129829, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3592529296875 GB
    Memory Allocated: 12.735430717468262  GigaBytes
Max Memory Allocated: 12.808029174804688  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.029214724898338318 |0.043198853731155396 |0.5906618535518646 |0.00010959804058074951 |0.904604971408844 |0.01217794418334961 |
----------------------------------------------------------pseudo_mini_loss sum 4.397955894470215
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5317429
Number of first layer input nodes during this epoch:  2509269
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 15.3592529296875 GB
    Memory Allocated: 0.12391519546508789  GigaBytes
Max Memory Allocated: 12.808029174804688  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.028473854064941406
range selection method range initialization spend 0.013460636138916016
time for parepare:  0.020353078842163086
local_output_nid generation:  0.002312183380126953
local_in_edges_tensor generation:  0.008281469345092773
mini_batch_src_global generation:  0.0022516250610351562
r_  generation:  0.02012157440185547
local_output_nid generation:  0.0019712448120117188
local_in_edges_tensor generation:  0.001172780990600586
mini_batch_src_global generation:  0.0026662349700927734
r_  generation:  0.020839452743530273
local_output_nid generation:  0.002012968063354492
local_in_edges_tensor generation:  0.0010945796966552734
mini_batch_src_global generation:  0.0015454292297363281
r_  generation:  0.020339250564575195
local_output_nid generation:  0.0020987987518310547
local_in_edges_tensor generation:  0.0011034011840820312
mini_batch_src_global generation:  0.0017600059509277344
r_  generation:  0.02075791358947754
local_output_nid generation:  0.0020599365234375
local_in_edges_tensor generation:  0.0010941028594970703
mini_batch_src_global generation:  0.0017018318176269531
r_  generation:  0.02039813995361328
local_output_nid generation:  0.0020067691802978516
local_in_edges_tensor generation:  0.0010676383972167969
mini_batch_src_global generation:  0.0017633438110351562
r_  generation:  0.020848512649536133
local_output_nid generation:  0.002093791961669922
local_in_edges_tensor generation:  0.0011789798736572266
mini_batch_src_global generation:  0.001766204833984375
r_  generation:  0.021497249603271484
local_output_nid generation:  0.002041339874267578
local_in_edges_tensor generation:  0.0011336803436279297
mini_batch_src_global generation:  0.0018029212951660156
r_  generation:  0.021297931671142578
local_output_nid generation:  0.002025604248046875
local_in_edges_tensor generation:  0.0011310577392578125
mini_batch_src_global generation:  0.001786947250366211
r_  generation:  0.021442174911499023
local_output_nid generation:  0.001981973648071289
local_in_edges_tensor generation:  0.0010387897491455078
mini_batch_src_global generation:  0.0017535686492919922
r_  generation:  0.021582841873168945
local_output_nid generation:  0.0019974708557128906
local_in_edges_tensor generation:  0.0010962486267089844
mini_batch_src_global generation:  0.0018453598022460938
r_  generation:  0.022208690643310547
local_output_nid generation:  0.0018932819366455078
local_in_edges_tensor generation:  0.0011065006256103516
mini_batch_src_global generation:  0.0018584728240966797
r_  generation:  0.022220373153686523
local_output_nid generation:  0.0032112598419189453
local_in_edges_tensor generation:  0.0013093948364257812
mini_batch_src_global generation:  0.0037059783935546875
r_  generation:  0.02373957633972168
local_output_nid generation:  0.0020263195037841797
local_in_edges_tensor generation:  0.0010006427764892578
mini_batch_src_global generation:  0.0018417835235595703
r_  generation:  0.022688865661621094
local_output_nid generation:  0.0019609928131103516
local_in_edges_tensor generation:  0.0009305477142333984
mini_batch_src_global generation:  0.0071811676025390625
r_  generation:  0.02419257164001465
local_output_nid generation:  0.0018563270568847656
local_in_edges_tensor generation:  0.0009310245513916016
mini_batch_src_global generation:  0.002254009246826172
r_  generation:  0.023032426834106445
----------------------check_connections_block total spend ----------------------------- 0.5481131076812744
generate_one_block  0.042777299880981445
generate_one_block  0.03714275360107422
generate_one_block  0.03669285774230957
generate_one_block  0.03640341758728027
generate_one_block  0.0369112491607666
generate_one_block  0.03886079788208008
generate_one_block  0.0383763313293457
generate_one_block  0.037003517150878906
generate_one_block  0.03705906867980957
generate_one_block  0.03751230239868164
generate_one_block  0.03806042671203613
generate_one_block  0.0382993221282959
generate_one_block  0.037555694580078125
generate_one_block  0.03712272644042969
generate_one_block  0.037873029708862305
generate_one_block  0.03867673873901367
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04290580749511719
gen group dst list time:  0.01999497413635254
time for parepare:  0.01905345916748047
local_output_nid generation:  0.008140087127685547
local_in_edges_tensor generation:  0.020728588104248047
mini_batch_src_global generation:  0.02695918083190918
r_  generation:  0.24788951873779297
local_output_nid generation:  0.012023210525512695
local_in_edges_tensor generation:  0.02177739143371582
mini_batch_src_global generation:  0.032045841217041016
r_  generation:  0.26020121574401855
local_output_nid generation:  0.012894392013549805
local_in_edges_tensor generation:  0.01777052879333496
mini_batch_src_global generation:  0.03271365165710449
r_  generation:  0.2686944007873535
local_output_nid generation:  0.012614011764526367
local_in_edges_tensor generation:  0.015322446823120117
mini_batch_src_global generation:  0.031805992126464844
r_  generation:  0.2637619972229004
local_output_nid generation:  0.013031244277954102
local_in_edges_tensor generation:  0.019396305084228516
mini_batch_src_global generation:  0.03243589401245117
r_  generation:  0.28205370903015137
local_output_nid generation:  0.013619661331176758
local_in_edges_tensor generation:  0.02605724334716797
mini_batch_src_global generation:  0.04353690147399902
r_  generation:  0.2715935707092285
local_output_nid generation:  0.014442682266235352
local_in_edges_tensor generation:  0.018459081649780273
mini_batch_src_global generation:  0.03523087501525879
r_  generation:  0.2718186378479004
local_output_nid generation:  0.013225317001342773
local_in_edges_tensor generation:  0.01332855224609375
mini_batch_src_global generation:  0.03428912162780762
r_  generation:  0.26708078384399414
local_output_nid generation:  0.013324975967407227
local_in_edges_tensor generation:  0.016289710998535156
mini_batch_src_global generation:  0.034084320068359375
r_  generation:  0.2703428268432617
local_output_nid generation:  0.013414621353149414
local_in_edges_tensor generation:  0.01842212677001953
mini_batch_src_global generation:  0.03456997871398926
r_  generation:  0.2713282108306885
local_output_nid generation:  0.013417720794677734
local_in_edges_tensor generation:  0.020310401916503906
mini_batch_src_global generation:  0.03453660011291504
r_  generation:  0.27514004707336426
local_output_nid generation:  0.013566255569458008
local_in_edges_tensor generation:  0.013679265975952148
mini_batch_src_global generation:  0.03480648994445801
r_  generation:  0.2740976810455322
local_output_nid generation:  0.013391971588134766
local_in_edges_tensor generation:  0.013552665710449219
mini_batch_src_global generation:  0.03464937210083008
r_  generation:  0.2792184352874756
local_output_nid generation:  0.013538599014282227
local_in_edges_tensor generation:  0.02048039436340332
mini_batch_src_global generation:  0.03481602668762207
r_  generation:  0.27875542640686035
local_output_nid generation:  0.014652252197265625
local_in_edges_tensor generation:  0.0218963623046875
mini_batch_src_global generation:  0.0373387336730957
r_  generation:  0.2846193313598633
local_output_nid generation:  0.013593673706054688
local_in_edges_tensor generation:  0.01981639862060547
mini_batch_src_global generation:  0.042632341384887695
r_  generation:  0.27898263931274414
----------------------check_connections_block total spend ----------------------------- 6.370601415634155
generate_one_block  0.3886597156524658
generate_one_block  0.3719961643218994
generate_one_block  0.3740055561065674
generate_one_block  0.3646507263183594
generate_one_block  0.36499571800231934
generate_one_block  0.36650633811950684
generate_one_block  0.40134716033935547
generate_one_block  0.37456846237182617
generate_one_block  0.3761448860168457
generate_one_block  0.3762633800506592
generate_one_block  0.37911343574523926
generate_one_block  0.37562990188598633
generate_one_block  0.37772631645202637
generate_one_block  0.3784494400024414
generate_one_block  0.38066720962524414
generate_one_block  0.38152313232421875
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.046034812927246094
gen group dst list time:  0.06388235092163086
time for parepare:  0.018792390823364258
local_output_nid generation:  0.025957345962524414
local_in_edges_tensor generation:  0.05898880958557129
mini_batch_src_global generation:  0.04623150825500488
r_  generation:  0.44860076904296875
local_output_nid generation:  0.031018495559692383
local_in_edges_tensor generation:  0.04458022117614746
mini_batch_src_global generation:  0.0521245002746582
r_  generation:  0.46189403533935547
local_output_nid generation:  0.0318913459777832
local_in_edges_tensor generation:  0.04038047790527344
mini_batch_src_global generation:  0.05108070373535156
r_  generation:  0.4672126770019531
local_output_nid generation:  0.03576469421386719
local_in_edges_tensor generation:  0.03673839569091797
mini_batch_src_global generation:  0.0556483268737793
r_  generation:  0.4846351146697998
local_output_nid generation:  0.03382062911987305
local_in_edges_tensor generation:  0.09241724014282227
mini_batch_src_global generation:  0.05617856979370117
r_  generation:  0.4723532199859619
local_output_nid generation:  0.032994747161865234
local_in_edges_tensor generation:  0.036600589752197266
mini_batch_src_global generation:  0.05297207832336426
r_  generation:  0.4707024097442627
local_output_nid generation:  0.03252863883972168
local_in_edges_tensor generation:  0.03330707550048828
mini_batch_src_global generation:  0.055876731872558594
r_  generation:  0.4737088680267334
local_output_nid generation:  0.03240513801574707
local_in_edges_tensor generation:  0.033054351806640625
mini_batch_src_global generation:  0.053575754165649414
r_  generation:  0.46982860565185547
local_output_nid generation:  0.032770633697509766
local_in_edges_tensor generation:  0.03306865692138672
mini_batch_src_global generation:  0.05893301963806152
r_  generation:  0.47770094871520996
local_output_nid generation:  0.03247976303100586
local_in_edges_tensor generation:  0.03270268440246582
mini_batch_src_global generation:  0.054106950759887695
r_  generation:  0.4733710289001465
local_output_nid generation:  0.03216981887817383
local_in_edges_tensor generation:  0.029542922973632812
mini_batch_src_global generation:  0.05395698547363281
r_  generation:  0.48904919624328613
local_output_nid generation:  0.03250694274902344
local_in_edges_tensor generation:  0.02970147132873535
mini_batch_src_global generation:  0.05317497253417969
r_  generation:  0.4779472351074219
local_output_nid generation:  0.03252530097961426
local_in_edges_tensor generation:  0.03350687026977539
mini_batch_src_global generation:  0.05674433708190918
r_  generation:  0.4799959659576416
local_output_nid generation:  0.03284311294555664
local_in_edges_tensor generation:  0.04570150375366211
mini_batch_src_global generation:  0.05331587791442871
r_  generation:  0.4759833812713623
local_output_nid generation:  0.03213953971862793
local_in_edges_tensor generation:  0.033074140548706055
mini_batch_src_global generation:  0.054137468338012695
r_  generation:  0.4821338653564453
local_output_nid generation:  0.03235507011413574
local_in_edges_tensor generation:  0.033864498138427734
mini_batch_src_global generation:  0.05725550651550293
r_  generation:  0.47475099563598633
----------------------check_connections_block total spend ----------------------------- 11.314035892486572
generate_one_block  0.6364026069641113
generate_one_block  0.6306869983673096
generate_one_block  0.6219117641448975
generate_one_block  0.6233501434326172
generate_one_block  0.6232709884643555
generate_one_block  0.6048679351806641
generate_one_block  0.6070668697357178
generate_one_block  0.6113507747650146
generate_one_block  0.6562612056732178
generate_one_block  0.6209359169006348
generate_one_block  0.6229779720306396
generate_one_block  0.6147422790527344
generate_one_block  0.6373140811920166
generate_one_block  0.6374783515930176
generate_one_block  0.6212992668151855
generate_one_block  0.6392822265625
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 15.3592529296875 GB
    Memory Allocated: 0.12391519546508789  GigaBytes
Max Memory Allocated: 12.808029174804688  GigaBytes

connection checking time:  17.684637308120728
block generation total time  16.041446924209595
average batch blocks generation time:  1.0025904327630997
block dataloader generation time/epoch 36.514641761779785
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3592529296875 GB
    Memory Allocated: 0.09658145904541016  GigaBytes
Max Memory Allocated: 12.808029174804688  GigaBytes

torch.Size([156749, 128])
torch.Size([129765, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3592529296875 GB
    Memory Allocated: 12.717408180236816  GigaBytes
Max Memory Allocated: 12.808029174804688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3592529296875 GB
    Memory Allocated: 0.0967264175415039  GigaBytes
Max Memory Allocated: 12.808029174804688  GigaBytes

torch.Size([157038, 128])
torch.Size([130401, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3592529296875 GB
    Memory Allocated: 12.749989032745361  GigaBytes
Max Memory Allocated: 12.808029174804688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3592529296875 GB
    Memory Allocated: 0.09659814834594727  GigaBytes
Max Memory Allocated: 12.808029174804688  GigaBytes

torch.Size([156763, 128])
torch.Size([129797, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3592529296875 GB
    Memory Allocated: 12.742830753326416  GigaBytes
Max Memory Allocated: 12.808029174804688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3592529296875 GB
    Memory Allocated: 0.09665155410766602  GigaBytes
Max Memory Allocated: 12.808029174804688  GigaBytes

torch.Size([157087, 128])
torch.Size([130215, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3592529296875 GB
    Memory Allocated: 12.723467350006104  GigaBytes
Max Memory Allocated: 12.808029174804688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3592529296875 GB
    Memory Allocated: 0.0966043472290039  GigaBytes
Max Memory Allocated: 12.808029174804688  GigaBytes

torch.Size([157096, 128])
torch.Size([130369, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3592529296875 GB
    Memory Allocated: 12.716830253601074  GigaBytes
Max Memory Allocated: 12.808029174804688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3592529296875 GB
    Memory Allocated: 0.09654760360717773  GigaBytes
Max Memory Allocated: 12.808029174804688  GigaBytes

torch.Size([156911, 128])
torch.Size([129835, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3592529296875 GB
    Memory Allocated: 12.689518928527832  GigaBytes
Max Memory Allocated: 12.808029174804688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3592529296875 GB
    Memory Allocated: 0.0966181755065918  GigaBytes
Max Memory Allocated: 12.808029174804688  GigaBytes

torch.Size([156819, 128])
torch.Size([129918, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3592529296875 GB
    Memory Allocated: 12.735747814178467  GigaBytes
Max Memory Allocated: 12.808029174804688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3592529296875 GB
    Memory Allocated: 0.09657096862792969  GigaBytes
Max Memory Allocated: 12.808029174804688  GigaBytes

torch.Size([156828, 128])
torch.Size([129823, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3592529296875 GB
    Memory Allocated: 12.727864265441895  GigaBytes
Max Memory Allocated: 12.808029174804688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3592529296875 GB
    Memory Allocated: 0.09675216674804688  GigaBytes
Max Memory Allocated: 12.808029174804688  GigaBytes

torch.Size([157114, 128])
torch.Size([130125, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3592529296875 GB
    Memory Allocated: 12.749459266662598  GigaBytes
Max Memory Allocated: 12.808029174804688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3592529296875 GB
    Memory Allocated: 0.09672307968139648  GigaBytes
Max Memory Allocated: 12.808029174804688  GigaBytes

torch.Size([156981, 128])
torch.Size([129760, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3592529296875 GB
    Memory Allocated: 12.74528694152832  GigaBytes
Max Memory Allocated: 12.808029174804688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3592529296875 GB
    Memory Allocated: 0.09662342071533203  GigaBytes
Max Memory Allocated: 12.808029174804688  GigaBytes

torch.Size([156736, 128])
torch.Size([130084, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3592529296875 GB
    Memory Allocated: 12.762765407562256  GigaBytes
Max Memory Allocated: 12.808029174804688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3592529296875 GB
    Memory Allocated: 0.09662055969238281  GigaBytes
Max Memory Allocated: 12.808029174804688  GigaBytes

torch.Size([156698, 128])
torch.Size([129558, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3592529296875 GB
    Memory Allocated: 12.741085052490234  GigaBytes
Max Memory Allocated: 12.808029174804688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3592529296875 GB
    Memory Allocated: 0.0967249870300293  GigaBytes
Max Memory Allocated: 12.808029174804688  GigaBytes

torch.Size([156935, 128])
torch.Size([130109, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3592529296875 GB
    Memory Allocated: 12.76615858078003  GigaBytes
Max Memory Allocated: 12.808029174804688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3592529296875 GB
    Memory Allocated: 0.09681320190429688  GigaBytes
Max Memory Allocated: 12.808029174804688  GigaBytes

torch.Size([157108, 128])
torch.Size([130612, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3592529296875 GB
    Memory Allocated: 12.770244121551514  GigaBytes
Max Memory Allocated: 12.808029174804688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3592529296875 GB
    Memory Allocated: 0.09683465957641602  GigaBytes
Max Memory Allocated: 12.808029174804688  GigaBytes

torch.Size([157077, 128])
torch.Size([130226, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3592529296875 GB
    Memory Allocated: 12.768677234649658  GigaBytes
Max Memory Allocated: 12.808029174804688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3592529296875 GB
    Memory Allocated: 0.09682035446166992  GigaBytes
Max Memory Allocated: 12.808029174804688  GigaBytes

torch.Size([156971, 128])
torch.Size([130296, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3592529296875 GB
    Memory Allocated: 12.78903579711914  GigaBytes
Max Memory Allocated: 12.808029174804688  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.027081623673439026 |0.020556747913360596 |0.5522636920213699 |0.00010341405868530273 |0.8747189193964005 |0.005289316177368164 |
----------------------------------------------------------pseudo_mini_loss sum 3.6971185207366943
Total (block generation + training)time/epoch 60.15308451652527
Training time/epoch 23.63815402984619
Training time without block to device /epoch 23.309246063232422
Training time without total dataloading part /epoch 22.83866572380066
load block tensor time/epoch 0.4333059787750244
block to device time/epoch 0.32890796661376953
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5322717
Number of first layer input nodes during this epoch:  2510911
