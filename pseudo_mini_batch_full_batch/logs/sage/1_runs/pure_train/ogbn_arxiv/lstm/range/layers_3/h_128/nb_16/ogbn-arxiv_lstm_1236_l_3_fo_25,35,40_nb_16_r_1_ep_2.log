Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648472197.520138
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017633438110351562  GigaBytes
Max Memory Allocated: 0.0017633438110351562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02494049072265625
range selection method range initialization spend 0.013390779495239258
time for parepare:  0.01773238182067871
local_output_nid generation:  0.001337289810180664
local_in_edges_tensor generation:  0.0038084983825683594
mini_batch_src_global generation:  0.0016772747039794922
r_  generation:  0.017486572265625
local_output_nid generation:  0.0014674663543701172
local_in_edges_tensor generation:  0.0009026527404785156
mini_batch_src_global generation:  0.0021147727966308594
r_  generation:  0.01741647720336914
local_output_nid generation:  0.0014524459838867188
local_in_edges_tensor generation:  0.0009026527404785156
mini_batch_src_global generation:  0.0014023780822753906
r_  generation:  0.018409013748168945
local_output_nid generation:  0.0014729499816894531
local_in_edges_tensor generation:  0.0008628368377685547
mini_batch_src_global generation:  0.0012950897216796875
r_  generation:  0.018024921417236328
local_output_nid generation:  0.0015058517456054688
local_in_edges_tensor generation:  0.0008261203765869141
mini_batch_src_global generation:  0.0013804435729980469
r_  generation:  0.017915964126586914
local_output_nid generation:  0.0014739036560058594
local_in_edges_tensor generation:  0.0008130073547363281
mini_batch_src_global generation:  0.0012965202331542969
r_  generation:  0.01813197135925293
local_output_nid generation:  0.0014603137969970703
local_in_edges_tensor generation:  0.0008568763732910156
mini_batch_src_global generation:  0.0013649463653564453
r_  generation:  0.01835465431213379
local_output_nid generation:  0.0014808177947998047
local_in_edges_tensor generation:  0.0008106231689453125
mini_batch_src_global generation:  0.0014317035675048828
r_  generation:  0.018393516540527344
local_output_nid generation:  0.0014619827270507812
local_in_edges_tensor generation:  0.0008821487426757812
mini_batch_src_global generation:  0.0014045238494873047
r_  generation:  0.018591642379760742
local_output_nid generation:  0.0014865398406982422
local_in_edges_tensor generation:  0.0008280277252197266
mini_batch_src_global generation:  0.0014536380767822266
r_  generation:  0.01837778091430664
local_output_nid generation:  0.0015053749084472656
local_in_edges_tensor generation:  0.0008094310760498047
mini_batch_src_global generation:  0.001459360122680664
r_  generation:  0.019054174423217773
local_output_nid generation:  0.0014636516571044922
local_in_edges_tensor generation:  0.0008146762847900391
mini_batch_src_global generation:  0.001489877700805664
r_  generation:  0.01878070831298828
local_output_nid generation:  0.0014657974243164062
local_in_edges_tensor generation:  0.0008580684661865234
mini_batch_src_global generation:  0.0014467239379882812
r_  generation:  0.01880025863647461
local_output_nid generation:  0.0015225410461425781
local_in_edges_tensor generation:  0.0008575916290283203
mini_batch_src_global generation:  0.0015053749084472656
r_  generation:  0.018517494201660156
local_output_nid generation:  0.0014693737030029297
local_in_edges_tensor generation:  0.0008068084716796875
mini_batch_src_global generation:  0.0014986991882324219
r_  generation:  0.018580198287963867
local_output_nid generation:  0.0014660358428955078
local_in_edges_tensor generation:  0.000835418701171875
mini_batch_src_global generation:  0.0013875961303710938
r_  generation:  0.019101858139038086
----------------------check_connections_block total spend ----------------------------- 0.44144368171691895
generate_one_block  0.026449918746948242
generate_one_block  0.027582883834838867
generate_one_block  0.029899120330810547
generate_one_block  0.02762126922607422
generate_one_block  0.027003049850463867
generate_one_block  0.02718067169189453
generate_one_block  0.027114152908325195
generate_one_block  0.02722930908203125
generate_one_block  0.027632474899291992
generate_one_block  0.02729511260986328
generate_one_block  0.027950048446655273
generate_one_block  0.027612686157226562
generate_one_block  0.027394533157348633
generate_one_block  0.027100801467895508
generate_one_block  0.02685236930847168
generate_one_block  0.027474403381347656
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.039536476135253906
gen group dst list time:  0.018668174743652344
time for parepare:  0.019447803497314453
local_output_nid generation:  0.006694793701171875
local_in_edges_tensor generation:  0.017528295516967773
mini_batch_src_global generation:  0.020088911056518555
r_  generation:  0.18987512588500977
local_output_nid generation:  0.011362791061401367
local_in_edges_tensor generation:  0.017530441284179688
mini_batch_src_global generation:  0.025619029998779297
r_  generation:  0.19787907600402832
local_output_nid generation:  0.012195110321044922
local_in_edges_tensor generation:  0.015103578567504883
mini_batch_src_global generation:  0.02331089973449707
r_  generation:  0.20615339279174805
local_output_nid generation:  0.012447118759155273
local_in_edges_tensor generation:  0.015118122100830078
mini_batch_src_global generation:  0.024022817611694336
r_  generation:  0.205427885055542
local_output_nid generation:  0.01265263557434082
local_in_edges_tensor generation:  0.011373281478881836
mini_batch_src_global generation:  0.024818897247314453
r_  generation:  0.21110796928405762
local_output_nid generation:  0.01290440559387207
local_in_edges_tensor generation:  0.013136625289916992
mini_batch_src_global generation:  0.025423288345336914
r_  generation:  0.21008729934692383
local_output_nid generation:  0.012952089309692383
local_in_edges_tensor generation:  0.015454292297363281
mini_batch_src_global generation:  0.025499820709228516
r_  generation:  0.21076345443725586
local_output_nid generation:  0.013155460357666016
local_in_edges_tensor generation:  0.015275716781616211
mini_batch_src_global generation:  0.0264129638671875
r_  generation:  0.20874834060668945
local_output_nid generation:  0.013224601745605469
local_in_edges_tensor generation:  0.011836051940917969
mini_batch_src_global generation:  0.027760028839111328
r_  generation:  0.211517333984375
local_output_nid generation:  0.013104438781738281
local_in_edges_tensor generation:  0.011815309524536133
mini_batch_src_global generation:  0.026074886322021484
r_  generation:  0.20898032188415527
local_output_nid generation:  0.013589859008789062
local_in_edges_tensor generation:  0.015975475311279297
mini_batch_src_global generation:  0.026661157608032227
r_  generation:  0.2164292335510254
local_output_nid generation:  0.01345968246459961
local_in_edges_tensor generation:  0.01216435432434082
mini_batch_src_global generation:  0.026807069778442383
r_  generation:  0.21174836158752441
local_output_nid generation:  0.013605833053588867
local_in_edges_tensor generation:  0.012256860733032227
mini_batch_src_global generation:  0.026185035705566406
r_  generation:  0.21132731437683105
local_output_nid generation:  0.013198375701904297
local_in_edges_tensor generation:  0.011780738830566406
mini_batch_src_global generation:  0.026471614837646484
r_  generation:  0.20902371406555176
local_output_nid generation:  0.013362407684326172
local_in_edges_tensor generation:  0.015270233154296875
mini_batch_src_global generation:  0.026266098022460938
r_  generation:  0.20880866050720215
local_output_nid generation:  0.013614416122436523
local_in_edges_tensor generation:  0.013589859008789062
mini_batch_src_global generation:  0.02787494659423828
r_  generation:  0.2085716724395752
----------------------check_connections_block total spend ----------------------------- 4.917850971221924
generate_one_block  0.2677340507507324
generate_one_block  0.26831793785095215
generate_one_block  0.27666687965393066
generate_one_block  0.2711219787597656
generate_one_block  0.28158092498779297
generate_one_block  0.26597118377685547
generate_one_block  0.2692387104034424
generate_one_block  0.2687983512878418
generate_one_block  0.2714846134185791
generate_one_block  0.26726627349853516
generate_one_block  0.27782392501831055
generate_one_block  0.27156662940979004
generate_one_block  0.27077436447143555
generate_one_block  0.26497983932495117
generate_one_block  0.27285003662109375
generate_one_block  0.26862668991088867
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.036435842514038086
gen group dst list time:  0.058769941329956055
time for parepare:  0.0192718505859375
local_output_nid generation:  0.023906469345092773
local_in_edges_tensor generation:  0.037528276443481445
mini_batch_src_global generation:  0.040585994720458984
r_  generation:  0.43676042556762695
local_output_nid generation:  0.03328561782836914
local_in_edges_tensor generation:  0.04465365409851074
mini_batch_src_global generation:  0.05446910858154297
r_  generation:  0.4365050792694092
local_output_nid generation:  0.03321337699890137
local_in_edges_tensor generation:  0.037636756896972656
mini_batch_src_global generation:  0.04965806007385254
r_  generation:  0.4481925964355469
local_output_nid generation:  0.03357887268066406
local_in_edges_tensor generation:  0.034130096435546875
mini_batch_src_global generation:  0.05228781700134277
r_  generation:  0.4456050395965576
local_output_nid generation:  0.03356456756591797
local_in_edges_tensor generation:  0.029561758041381836
mini_batch_src_global generation:  0.0514521598815918
r_  generation:  0.4494924545288086
local_output_nid generation:  0.0339505672454834
local_in_edges_tensor generation:  0.029474735260009766
mini_batch_src_global generation:  0.05596041679382324
r_  generation:  0.4513280391693115
local_output_nid generation:  0.03424382209777832
local_in_edges_tensor generation:  0.04175853729248047
mini_batch_src_global generation:  0.051544904708862305
r_  generation:  0.4579465389251709
local_output_nid generation:  0.034159183502197266
local_in_edges_tensor generation:  0.03383493423461914
mini_batch_src_global generation:  0.05325031280517578
r_  generation:  0.4505445957183838
local_output_nid generation:  0.0340425968170166
local_in_edges_tensor generation:  0.029318571090698242
mini_batch_src_global generation:  0.0520784854888916
r_  generation:  0.452101469039917
local_output_nid generation:  0.03446149826049805
local_in_edges_tensor generation:  0.029787778854370117
mini_batch_src_global generation:  0.05295681953430176
r_  generation:  0.4533665180206299
local_output_nid generation:  0.03451704978942871
local_in_edges_tensor generation:  0.03737926483154297
mini_batch_src_global generation:  0.05174446105957031
r_  generation:  0.4553718566894531
local_output_nid generation:  0.03433489799499512
local_in_edges_tensor generation:  0.0387117862701416
mini_batch_src_global generation:  0.05267477035522461
r_  generation:  0.44906163215637207
local_output_nid generation:  0.034189701080322266
local_in_edges_tensor generation:  0.03386425971984863
mini_batch_src_global generation:  0.052050113677978516
r_  generation:  0.4555702209472656
local_output_nid generation:  0.034120798110961914
local_in_edges_tensor generation:  0.03317856788635254
mini_batch_src_global generation:  0.052152395248413086
r_  generation:  0.4452979564666748
local_output_nid generation:  0.034383535385131836
local_in_edges_tensor generation:  0.02982473373413086
mini_batch_src_global generation:  0.051177263259887695
r_  generation:  0.45195841789245605
local_output_nid generation:  0.03435230255126953
local_in_edges_tensor generation:  0.03768348693847656
mini_batch_src_global generation:  0.052928924560546875
r_  generation:  0.45500636100769043
----------------------check_connections_block total spend ----------------------------- 10.68071699142456
generate_one_block  0.5733416080474854
generate_one_block  0.5942189693450928
generate_one_block  0.5997462272644043
generate_one_block  0.5828895568847656
generate_one_block  0.5612192153930664
generate_one_block  0.5754408836364746
generate_one_block  0.6283142566680908
generate_one_block  0.5748965740203857
generate_one_block  0.5803234577178955
generate_one_block  0.5837140083312988
generate_one_block  0.5871517658233643
generate_one_block  0.5911605358123779
generate_one_block  0.5782206058502197
generate_one_block  0.5739216804504395
generate_one_block  0.5679571628570557
generate_one_block  0.5853691101074219
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017633438110351562  GigaBytes
Max Memory Allocated: 0.0017633438110351562  GigaBytes

connection checking time:  15.598567962646484
block generation total time  13.672688007354736
average batch blocks generation time:  0.854543000459671
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.09149312973022461  GigaBytes
Max Memory Allocated: 0.09149312973022461  GigaBytes

torch.Size([154535, 128])
torch.Size([122379, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.3182373046875 GB
    Memory Allocated: 15.744477272033691  GigaBytes
Max Memory Allocated: 15.773045539855957  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9158935546875 GB
    Memory Allocated: 0.0936136245727539  GigaBytes
Max Memory Allocated: 15.773045539855957  GigaBytes

torch.Size([154422, 128])
torch.Size([122563, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0135498046875 GB
    Memory Allocated: 15.85537052154541  GigaBytes
Max Memory Allocated: 15.88530158996582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.3143310546875 GB
    Memory Allocated: 0.0943756103515625  GigaBytes
Max Memory Allocated: 15.88530158996582  GigaBytes

torch.Size([155034, 128])
torch.Size([123772, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0389404296875 GB
    Memory Allocated: 16.072501182556152  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0389404296875 GB
    Memory Allocated: 0.09365177154541016  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

torch.Size([154512, 128])
torch.Size([122610, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0389404296875 GB
    Memory Allocated: 15.87129259109497  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0389404296875 GB
    Memory Allocated: 0.09411907196044922  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

torch.Size([154167, 128])
torch.Size([121696, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0389404296875 GB
    Memory Allocated: 15.777709007263184  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0389404296875 GB
    Memory Allocated: 0.09355449676513672  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

torch.Size([154440, 128])
torch.Size([122527, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0428466796875 GB
    Memory Allocated: 15.804682731628418  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0428466796875 GB
    Memory Allocated: 0.09418678283691406  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

torch.Size([154939, 128])
torch.Size([122973, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0428466796875 GB
    Memory Allocated: 15.87867784500122  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0428466796875 GB
    Memory Allocated: 0.09355449676513672  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

torch.Size([154360, 128])
torch.Size([122554, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0604248046875 GB
    Memory Allocated: 15.852683544158936  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0604248046875 GB
    Memory Allocated: 0.09421062469482422  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

torch.Size([154260, 128])
torch.Size([122306, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0604248046875 GB
    Memory Allocated: 15.903649806976318  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0604248046875 GB
    Memory Allocated: 0.09356451034545898  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

torch.Size([154493, 128])
torch.Size([122204, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0604248046875 GB
    Memory Allocated: 15.77023983001709  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0604248046875 GB
    Memory Allocated: 0.09432125091552734  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

torch.Size([154822, 128])
torch.Size([123308, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0604248046875 GB
    Memory Allocated: 16.007752895355225  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0604248046875 GB
    Memory Allocated: 0.09365320205688477  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

torch.Size([154411, 128])
torch.Size([122885, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0604248046875 GB
    Memory Allocated: 15.930065631866455  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0604248046875 GB
    Memory Allocated: 0.09420394897460938  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

torch.Size([154666, 128])
torch.Size([122676, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0604248046875 GB
    Memory Allocated: 15.880570888519287  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0604248046875 GB
    Memory Allocated: 0.0933847427368164  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

torch.Size([154118, 128])
torch.Size([121970, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0604248046875 GB
    Memory Allocated: 15.799784660339355  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0604248046875 GB
    Memory Allocated: 0.09410285949707031  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

torch.Size([154251, 128])
torch.Size([121972, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0604248046875 GB
    Memory Allocated: 15.746673583984375  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0604248046875 GB
    Memory Allocated: 0.0935831069946289  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

torch.Size([154418, 128])
torch.Size([122666, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0604248046875 GB
    Memory Allocated: 15.850147247314453  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04179838299751282 |0.03832961618900299 |0.3034425526857376 |0.00010073184967041016 |0.3728502243757248 |0.00849294662475586 |
----------------------------------------------------------pseudo_mini_loss sum 4.987030982971191
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5094892
Number of first layer input nodes during this epoch:  2471848
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 19.0604248046875 GB
    Memory Allocated: 0.11977434158325195  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02338266372680664
range selection method range initialization spend 0.015633583068847656
time for parepare:  0.017032146453857422
local_output_nid generation:  0.0017781257629394531
local_in_edges_tensor generation:  0.006330251693725586
mini_batch_src_global generation:  0.0021543502807617188
r_  generation:  0.019768953323364258
local_output_nid generation:  0.0017538070678710938
local_in_edges_tensor generation:  0.0009922981262207031
mini_batch_src_global generation:  0.0024356842041015625
r_  generation:  0.018644332885742188
local_output_nid generation:  0.0018236637115478516
local_in_edges_tensor generation:  0.0009386539459228516
mini_batch_src_global generation:  0.0012896060943603516
r_  generation:  0.019272327423095703
local_output_nid generation:  0.0017693042755126953
local_in_edges_tensor generation:  0.0008854866027832031
mini_batch_src_global generation:  0.0014657974243164062
r_  generation:  0.01852130889892578
local_output_nid generation:  0.001674652099609375
local_in_edges_tensor generation:  0.0008809566497802734
mini_batch_src_global generation:  0.0014429092407226562
r_  generation:  0.018460512161254883
local_output_nid generation:  0.0016570091247558594
local_in_edges_tensor generation:  0.0008869171142578125
mini_batch_src_global generation:  0.0013699531555175781
r_  generation:  0.01900768280029297
local_output_nid generation:  0.0016622543334960938
local_in_edges_tensor generation:  0.0009093284606933594
mini_batch_src_global generation:  0.0015316009521484375
r_  generation:  0.01918768882751465
local_output_nid generation:  0.0016040802001953125
local_in_edges_tensor generation:  0.0008623600006103516
mini_batch_src_global generation:  0.001569509506225586
r_  generation:  0.02001047134399414
local_output_nid generation:  0.0016202926635742188
local_in_edges_tensor generation:  0.0008652210235595703
mini_batch_src_global generation:  0.001550436019897461
r_  generation:  0.019598722457885742
local_output_nid generation:  0.0016074180603027344
local_in_edges_tensor generation:  0.0008707046508789062
mini_batch_src_global generation:  0.0014286041259765625
r_  generation:  0.019757509231567383
local_output_nid generation:  0.0016410350799560547
local_in_edges_tensor generation:  0.0008904933929443359
mini_batch_src_global generation:  0.001554727554321289
r_  generation:  0.01927661895751953
local_output_nid generation:  0.0016009807586669922
local_in_edges_tensor generation:  0.0008995532989501953
mini_batch_src_global generation:  0.0015859603881835938
r_  generation:  0.02036309242248535
local_output_nid generation:  0.0026547908782958984
local_in_edges_tensor generation:  0.0010516643524169922
mini_batch_src_global generation:  0.009864330291748047
r_  generation:  0.019916057586669922
local_output_nid generation:  0.0016338825225830078
local_in_edges_tensor generation:  0.0011692047119140625
mini_batch_src_global generation:  0.0015978813171386719
r_  generation:  0.020349740982055664
local_output_nid generation:  0.0016477108001708984
local_in_edges_tensor generation:  0.0009953975677490234
mini_batch_src_global generation:  0.0016398429870605469
r_  generation:  0.021053314208984375
local_output_nid generation:  0.0018773078918457031
local_in_edges_tensor generation:  0.0013632774353027344
mini_batch_src_global generation:  0.0023546218872070312
r_  generation:  0.01988387107849121
----------------------check_connections_block total spend ----------------------------- 0.4873044490814209
generate_one_block  0.040358543395996094
generate_one_block  0.03217148780822754
generate_one_block  0.031740427017211914
generate_one_block  0.030808448791503906
generate_one_block  0.03229832649230957
generate_one_block  0.03361940383911133
generate_one_block  0.03138875961303711
generate_one_block  0.03201007843017578
generate_one_block  0.03224062919616699
generate_one_block  0.03093409538269043
generate_one_block  0.03059077262878418
generate_one_block  0.03167247772216797
generate_one_block  0.03204154968261719
generate_one_block  0.0319364070892334
generate_one_block  0.03204846382141113
generate_one_block  0.031389474868774414
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.047281503677368164
gen group dst list time:  0.018407106399536133
time for parepare:  0.02246236801147461
local_output_nid generation:  0.00831460952758789
local_in_edges_tensor generation:  0.027654647827148438
mini_batch_src_global generation:  0.018828392028808594
r_  generation:  0.19222688674926758
local_output_nid generation:  0.011736392974853516
local_in_edges_tensor generation:  0.018574237823486328
mini_batch_src_global generation:  0.023775339126586914
r_  generation:  0.19831061363220215
local_output_nid generation:  0.012940168380737305
local_in_edges_tensor generation:  0.01607680320739746
mini_batch_src_global generation:  0.02650928497314453
r_  generation:  0.21385598182678223
local_output_nid generation:  0.01262974739074707
local_in_edges_tensor generation:  0.014296770095825195
mini_batch_src_global generation:  0.0243070125579834
r_  generation:  0.20551323890686035
local_output_nid generation:  0.013150691986083984
local_in_edges_tensor generation:  0.014286518096923828
mini_batch_src_global generation:  0.024965286254882812
r_  generation:  0.20839262008666992
local_output_nid generation:  0.012774229049682617
local_in_edges_tensor generation:  0.01399850845336914
mini_batch_src_global generation:  0.02549290657043457
r_  generation:  0.2076880931854248
local_output_nid generation:  0.013008356094360352
local_in_edges_tensor generation:  0.015950679779052734
mini_batch_src_global generation:  0.025870800018310547
r_  generation:  0.2093031406402588
local_output_nid generation:  0.013092994689941406
local_in_edges_tensor generation:  0.016283273696899414
mini_batch_src_global generation:  0.026123523712158203
r_  generation:  0.2177259922027588
local_output_nid generation:  0.013239622116088867
local_in_edges_tensor generation:  0.016060352325439453
mini_batch_src_global generation:  0.025990009307861328
r_  generation:  0.2112290859222412
local_output_nid generation:  0.013163566589355469
local_in_edges_tensor generation:  0.01480555534362793
mini_batch_src_global generation:  0.02613377571105957
r_  generation:  0.20915937423706055
local_output_nid generation:  0.013178110122680664
local_in_edges_tensor generation:  0.01633453369140625
mini_batch_src_global generation:  0.025889158248901367
r_  generation:  0.21197009086608887
local_output_nid generation:  0.013269186019897461
local_in_edges_tensor generation:  0.014735221862792969
mini_batch_src_global generation:  0.026150941848754883
r_  generation:  0.209852933883667
local_output_nid generation:  0.013275146484375
local_in_edges_tensor generation:  0.016258955001831055
mini_batch_src_global generation:  0.025960683822631836
r_  generation:  0.21213436126708984
local_output_nid generation:  0.013410568237304688
local_in_edges_tensor generation:  0.016789674758911133
mini_batch_src_global generation:  0.026309728622436523
r_  generation:  0.21183228492736816
local_output_nid generation:  0.013617277145385742
local_in_edges_tensor generation:  0.01679682731628418
mini_batch_src_global generation:  0.0263671875
r_  generation:  0.2145061492919922
local_output_nid generation:  0.013206958770751953
local_in_edges_tensor generation:  0.013409137725830078
mini_batch_src_global generation:  0.026093006134033203
r_  generation:  0.2127385139465332
----------------------check_connections_block total spend ----------------------------- 4.975017786026001
generate_one_block  0.29207396507263184
generate_one_block  0.27292513847351074
generate_one_block  0.28809022903442383
generate_one_block  0.27661800384521484
generate_one_block  0.27643513679504395
generate_one_block  0.2743229866027832
generate_one_block  0.29636216163635254
generate_one_block  0.2825150489807129
generate_one_block  0.28258371353149414
generate_one_block  0.2744295597076416
generate_one_block  0.2766895294189453
generate_one_block  0.276688814163208
generate_one_block  0.277524471282959
generate_one_block  0.2812535762786865
generate_one_block  0.28090834617614746
generate_one_block  0.27675461769104004
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.045259714126586914
gen group dst list time:  0.059024810791015625
time for parepare:  0.01841282844543457
local_output_nid generation:  0.02506279945373535
local_in_edges_tensor generation:  0.043206214904785156
mini_batch_src_global generation:  0.04199481010437012
r_  generation:  0.43671178817749023
local_output_nid generation:  0.03281235694885254
local_in_edges_tensor generation:  0.04506182670593262
mini_batch_src_global generation:  0.05071115493774414
r_  generation:  0.4468977451324463
local_output_nid generation:  0.03345632553100586
local_in_edges_tensor generation:  0.04164838790893555
mini_batch_src_global generation:  0.05356311798095703
r_  generation:  0.4669492244720459
local_output_nid generation:  0.03160834312438965
local_in_edges_tensor generation:  0.04024934768676758
mini_batch_src_global generation:  0.054444313049316406
r_  generation:  0.46923112869262695
local_output_nid generation:  0.030852556228637695
local_in_edges_tensor generation:  0.08705949783325195
mini_batch_src_global generation:  0.05447793006896973
r_  generation:  0.46732640266418457
local_output_nid generation:  0.03323841094970703
local_in_edges_tensor generation:  0.034955501556396484
mini_batch_src_global generation:  0.05243802070617676
r_  generation:  0.4574880599975586
local_output_nid generation:  0.03124833106994629
local_in_edges_tensor generation:  0.03574347496032715
mini_batch_src_global generation:  0.05292940139770508
r_  generation:  0.45804572105407715
local_output_nid generation:  0.03138613700866699
local_in_edges_tensor generation:  0.04190230369567871
mini_batch_src_global generation:  0.05269169807434082
r_  generation:  0.4540233612060547
local_output_nid generation:  0.03155159950256348
local_in_edges_tensor generation:  0.030716419219970703
mini_batch_src_global generation:  0.052895307540893555
r_  generation:  0.4633324146270752
local_output_nid generation:  0.03189849853515625
local_in_edges_tensor generation:  0.03043532371520996
mini_batch_src_global generation:  0.05286097526550293
r_  generation:  0.4534335136413574
local_output_nid generation:  0.03158140182495117
local_in_edges_tensor generation:  0.03180646896362305
mini_batch_src_global generation:  0.05180191993713379
r_  generation:  0.4586493968963623
local_output_nid generation:  0.03160452842712402
local_in_edges_tensor generation:  0.038278818130493164
mini_batch_src_global generation:  0.05272698402404785
r_  generation:  0.4520854949951172
local_output_nid generation:  0.03160429000854492
local_in_edges_tensor generation:  0.03822517395019531
mini_batch_src_global generation:  0.05427861213684082
r_  generation:  0.45914506912231445
local_output_nid generation:  0.03162789344787598
local_in_edges_tensor generation:  0.033864498138427734
mini_batch_src_global generation:  0.0637216567993164
r_  generation:  0.45580077171325684
local_output_nid generation:  0.03199267387390137
local_in_edges_tensor generation:  0.03412055969238281
mini_batch_src_global generation:  0.052222490310668945
r_  generation:  0.46224546432495117
local_output_nid generation:  0.03167319297790527
local_in_edges_tensor generation:  0.030709266662597656
mini_batch_src_global generation:  0.05240964889526367
r_  generation:  0.45397281646728516
----------------------check_connections_block total spend ----------------------------- 10.896098613739014
generate_one_block  0.6234054565429688
generate_one_block  0.5941646099090576
generate_one_block  0.6012670993804932
generate_one_block  0.5876414775848389
generate_one_block  0.5872671604156494
generate_one_block  0.5722832679748535
generate_one_block  0.5899181365966797
generate_one_block  0.5960774421691895
generate_one_block  0.6157104969024658
generate_one_block  0.5869362354278564
generate_one_block  0.5762104988098145
generate_one_block  0.5903034210205078
generate_one_block  0.5931782722473145
generate_one_block  0.5914301872253418
generate_one_block  0.5887632369995117
generate_one_block  0.5836477279663086
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 19.0604248046875 GB
    Memory Allocated: 0.11977434158325195  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

connection checking time:  15.871116399765015
block generation total time  13.964380025863647
average batch blocks generation time:  0.872773751616478
block dataloader generation time/epoch 32.15295767784119
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0604248046875 GB
    Memory Allocated: 0.09769582748413086  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

torch.Size([154511, 128])
torch.Size([122751, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0604248046875 GB
    Memory Allocated: 15.877639770507812  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0604248046875 GB
    Memory Allocated: 0.09699487686157227  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

torch.Size([154361, 128])
torch.Size([122035, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0604248046875 GB
    Memory Allocated: 15.715677261352539  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0604248046875 GB
    Memory Allocated: 0.09788990020751953  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

torch.Size([154607, 128])
torch.Size([123125, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0721435546875 GB
    Memory Allocated: 16.04678249359131  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0721435546875 GB
    Memory Allocated: 0.09706592559814453  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

torch.Size([154358, 128])
torch.Size([122346, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0721435546875 GB
    Memory Allocated: 15.861145496368408  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0721435546875 GB
    Memory Allocated: 0.0976705551147461  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

torch.Size([154754, 128])
torch.Size([123091, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0721435546875 GB
    Memory Allocated: 15.856975555419922  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0721435546875 GB
    Memory Allocated: 0.09674358367919922  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

torch.Size([154006, 128])
torch.Size([121070, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0721435546875 GB
    Memory Allocated: 15.669465065002441  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0721435546875 GB
    Memory Allocated: 0.09765434265136719  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

torch.Size([154268, 128])
torch.Size([121718, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0721435546875 GB
    Memory Allocated: 15.821096897125244  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0721435546875 GB
    Memory Allocated: 0.09714317321777344  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

torch.Size([154256, 128])
torch.Size([122575, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0721435546875 GB
    Memory Allocated: 15.96846055984497  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0721435546875 GB
    Memory Allocated: 0.09772300720214844  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

torch.Size([154428, 128])
torch.Size([122610, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0721435546875 GB
    Memory Allocated: 15.881513595581055  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0721435546875 GB
    Memory Allocated: 0.09723901748657227  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

torch.Size([154731, 128])
torch.Size([122564, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0721435546875 GB
    Memory Allocated: 15.832433223724365  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0721435546875 GB
    Memory Allocated: 0.0976104736328125  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

torch.Size([154522, 128])
torch.Size([122043, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0721435546875 GB
    Memory Allocated: 15.763236999511719  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0721435546875 GB
    Memory Allocated: 0.09703922271728516  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

torch.Size([154334, 128])
torch.Size([122569, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0721435546875 GB
    Memory Allocated: 15.836992740631104  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0721435546875 GB
    Memory Allocated: 0.09770011901855469  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

torch.Size([154497, 128])
torch.Size([122424, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0721435546875 GB
    Memory Allocated: 15.860658645629883  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0721435546875 GB
    Memory Allocated: 0.09722471237182617  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

torch.Size([154627, 128])
torch.Size([122616, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0740966796875 GB
    Memory Allocated: 15.882669925689697  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0740966796875 GB
    Memory Allocated: 0.09776496887207031  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

torch.Size([154506, 128])
torch.Size([122661, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0740966796875 GB
    Memory Allocated: 15.91350793838501  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0740966796875 GB
    Memory Allocated: 0.09688568115234375  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

torch.Size([154144, 128])
torch.Size([121698, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0740966796875 GB
    Memory Allocated: 15.727363109588623  GigaBytes
Max Memory Allocated: 16.10321617126465  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.041062384843826294 |0.015025898814201355 |0.26148559153079987 |9.663403034210205e-05 |0.3717138022184372 |0.0068511962890625 |
----------------------------------------------------------pseudo_mini_loss sum 3.299562931060791
Total (block generation + training)time/epoch 43.22440791130066
Training time/epoch 11.071194648742676
Training time without block to device /epoch 10.830780267715454
Training time without total dataloading part /epoch 10.139587640762329
load block tensor time/epoch 0.6569981575012207
block to device time/epoch 0.24041438102722168
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5090208
Number of first layer input nodes during this epoch:  2470910
