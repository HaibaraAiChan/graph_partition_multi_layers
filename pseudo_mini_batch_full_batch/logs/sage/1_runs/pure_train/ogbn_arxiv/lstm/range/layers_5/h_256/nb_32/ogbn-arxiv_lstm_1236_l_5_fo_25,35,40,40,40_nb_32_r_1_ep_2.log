Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648507252.4705164
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0272216796875 GB
    Memory Allocated: 0.010137557983398438  GigaBytes
Max Memory Allocated: 0.010137557983398438  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.024927377700805664
range selection method range initialization spend 0.013591766357421875
time for parepare:  0.017703533172607422
local_output_nid generation:  0.0006935596466064453
local_in_edges_tensor generation:  0.0035724639892578125
mini_batch_src_global generation:  0.001316070556640625
r_  generation:  0.008817672729492188
local_output_nid generation:  0.0007469654083251953
local_in_edges_tensor generation:  0.0005619525909423828
mini_batch_src_global generation:  0.0013201236724853516
r_  generation:  0.00826120376586914
local_output_nid generation:  0.0007255077362060547
local_in_edges_tensor generation:  0.0004942417144775391
mini_batch_src_global generation:  0.0008301734924316406
r_  generation:  0.007781028747558594
local_output_nid generation:  0.0007243156433105469
local_in_edges_tensor generation:  0.0004661083221435547
mini_batch_src_global generation:  0.0007519721984863281
r_  generation:  0.0075953006744384766
local_output_nid generation:  0.0007071495056152344
local_in_edges_tensor generation:  0.0004649162292480469
mini_batch_src_global generation:  0.000751495361328125
r_  generation:  0.007756471633911133
local_output_nid generation:  0.0007116794586181641
local_in_edges_tensor generation:  0.0004551410675048828
mini_batch_src_global generation:  0.000736236572265625
r_  generation:  0.00752711296081543
local_output_nid generation:  0.0007059574127197266
local_in_edges_tensor generation:  0.00045680999755859375
mini_batch_src_global generation:  0.0007388591766357422
r_  generation:  0.007869720458984375
local_output_nid generation:  0.0007030963897705078
local_in_edges_tensor generation:  0.0004603862762451172
mini_batch_src_global generation:  0.000751495361328125
r_  generation:  0.007745265960693359
local_output_nid generation:  0.0007042884826660156
local_in_edges_tensor generation:  0.0004482269287109375
mini_batch_src_global generation:  0.0007534027099609375
r_  generation:  0.00782918930053711
local_output_nid generation:  0.0007033348083496094
local_in_edges_tensor generation:  0.0004496574401855469
mini_batch_src_global generation:  0.000762939453125
r_  generation:  0.007906913757324219
local_output_nid generation:  0.0007128715515136719
local_in_edges_tensor generation:  0.0004665851593017578
mini_batch_src_global generation:  0.0009088516235351562
r_  generation:  0.008048295974731445
local_output_nid generation:  0.0007245540618896484
local_in_edges_tensor generation:  0.0004954338073730469
mini_batch_src_global generation:  0.0008206367492675781
r_  generation:  0.00814676284790039
local_output_nid generation:  0.000728607177734375
local_in_edges_tensor generation:  0.0004515647888183594
mini_batch_src_global generation:  0.0007758140563964844
r_  generation:  0.00778651237487793
local_output_nid generation:  0.0007214546203613281
local_in_edges_tensor generation:  0.0004570484161376953
mini_batch_src_global generation:  0.0007908344268798828
r_  generation:  0.00799560546875
local_output_nid generation:  0.000713348388671875
local_in_edges_tensor generation:  0.00045037269592285156
mini_batch_src_global generation:  0.0008127689361572266
r_  generation:  0.00820779800415039
local_output_nid generation:  0.0007135868072509766
local_in_edges_tensor generation:  0.0004565715789794922
mini_batch_src_global generation:  0.0008068084716796875
r_  generation:  0.008043766021728516
local_output_nid generation:  0.0007126331329345703
local_in_edges_tensor generation:  0.0004470348358154297
mini_batch_src_global generation:  0.0008080005645751953
r_  generation:  0.007866382598876953
local_output_nid generation:  0.0007147789001464844
local_in_edges_tensor generation:  0.0004477500915527344
mini_batch_src_global generation:  0.0008282661437988281
r_  generation:  0.008117437362670898
local_output_nid generation:  0.00070953369140625
local_in_edges_tensor generation:  0.00046539306640625
mini_batch_src_global generation:  0.0008146762847900391
r_  generation:  0.008121013641357422
local_output_nid generation:  0.0007123947143554688
local_in_edges_tensor generation:  0.000457763671875
mini_batch_src_global generation:  0.0008282661437988281
r_  generation:  0.00844573974609375
local_output_nid generation:  0.0007278919219970703
local_in_edges_tensor generation:  0.0004487037658691406
mini_batch_src_global generation:  0.0008008480072021484
r_  generation:  0.007939815521240234
local_output_nid generation:  0.0007262229919433594
local_in_edges_tensor generation:  0.00045418739318847656
mini_batch_src_global generation:  0.0008072853088378906
r_  generation:  0.008011102676391602
local_output_nid generation:  0.000713348388671875
local_in_edges_tensor generation:  0.0004527568817138672
mini_batch_src_global generation:  0.0008335113525390625
r_  generation:  0.008381843566894531
local_output_nid generation:  0.0007202625274658203
local_in_edges_tensor generation:  0.0004477500915527344
mini_batch_src_global generation:  0.0008263587951660156
r_  generation:  0.008231639862060547
local_output_nid generation:  0.0007071495056152344
local_in_edges_tensor generation:  0.00044846534729003906
mini_batch_src_global generation:  0.0008034706115722656
r_  generation:  0.007855415344238281
local_output_nid generation:  0.0007138252258300781
local_in_edges_tensor generation:  0.0004525184631347656
mini_batch_src_global generation:  0.0008096694946289062
r_  generation:  0.008107662200927734
local_output_nid generation:  0.0007154941558837891
local_in_edges_tensor generation:  0.00045490264892578125
mini_batch_src_global generation:  0.0008440017700195312
r_  generation:  0.008365154266357422
local_output_nid generation:  0.0007259845733642578
local_in_edges_tensor generation:  0.00045609474182128906
mini_batch_src_global generation:  0.0009021759033203125
r_  generation:  0.008409500122070312
local_output_nid generation:  0.0007190704345703125
local_in_edges_tensor generation:  0.0004904270172119141
mini_batch_src_global generation:  0.0008325576782226562
r_  generation:  0.007940053939819336
local_output_nid generation:  0.0007283687591552734
local_in_edges_tensor generation:  0.0004603862762451172
mini_batch_src_global generation:  0.0008249282836914062
r_  generation:  0.008135557174682617
local_output_nid generation:  0.0007085800170898438
local_in_edges_tensor generation:  0.0039520263671875
mini_batch_src_global generation:  0.00096893310546875
r_  generation:  0.008142948150634766
local_output_nid generation:  0.0007960796356201172
local_in_edges_tensor generation:  0.0005102157592773438
mini_batch_src_global generation:  0.0009150505065917969
r_  generation:  0.008468866348266602
----------------------check_connections_block total spend ----------------------------- 0.4103827476501465
generate_one_block  0.013784646987915039
generate_one_block  0.013491153717041016
generate_one_block  0.0133209228515625
generate_one_block  0.012864351272583008
generate_one_block  0.01324915885925293
generate_one_block  0.012658834457397461
generate_one_block  0.012945175170898438
generate_one_block  0.01285409927368164
generate_one_block  0.01290440559387207
generate_one_block  0.01335597038269043
generate_one_block  0.012981176376342773
generate_one_block  0.013241052627563477
generate_one_block  0.012635469436645508
generate_one_block  0.013030767440795898
generate_one_block  0.013196706771850586
generate_one_block  0.012922525405883789
generate_one_block  0.012748956680297852
generate_one_block  0.013228654861450195
generate_one_block  0.013013839721679688
generate_one_block  0.013299942016601562
generate_one_block  0.012708425521850586
generate_one_block  0.012895345687866211
generate_one_block  0.013376951217651367
generate_one_block  0.013098716735839844
generate_one_block  0.012681245803833008
generate_one_block  0.013133764266967773
generate_one_block  0.013032913208007812
generate_one_block  0.01322317123413086
generate_one_block  0.012717247009277344
generate_one_block  0.013076066970825195
generate_one_block  0.013222932815551758
generate_one_block  0.013103961944580078
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.043019771575927734
gen group dst list time:  0.020954370498657227
time for parepare:  0.0195925235748291
local_output_nid generation:  0.003843545913696289
local_in_edges_tensor generation:  0.011686325073242188
mini_batch_src_global generation:  0.01195836067199707
r_  generation:  0.11904478073120117
local_output_nid generation:  0.007545948028564453
local_in_edges_tensor generation:  0.011792659759521484
mini_batch_src_global generation:  0.016033172607421875
r_  generation:  0.1305227279663086
local_output_nid generation:  0.007959127426147461
local_in_edges_tensor generation:  0.007432699203491211
mini_batch_src_global generation:  0.014699697494506836
r_  generation:  0.1368727684020996
local_output_nid generation:  0.008068323135375977
local_in_edges_tensor generation:  0.007433176040649414
mini_batch_src_global generation:  0.014595270156860352
r_  generation:  0.1318345069885254
local_output_nid generation:  0.00806736946105957
local_in_edges_tensor generation:  0.007551908493041992
mini_batch_src_global generation:  0.015381336212158203
r_  generation:  0.1351308822631836
local_output_nid generation:  0.007909297943115234
local_in_edges_tensor generation:  0.007446765899658203
mini_batch_src_global generation:  0.01544046401977539
r_  generation:  0.13123726844787598
local_output_nid generation:  0.008071660995483398
local_in_edges_tensor generation:  0.0076444149017333984
mini_batch_src_global generation:  0.016844987869262695
r_  generation:  0.13570189476013184
local_output_nid generation:  0.00804281234741211
local_in_edges_tensor generation:  0.007708072662353516
mini_batch_src_global generation:  0.016207456588745117
r_  generation:  0.13407444953918457
local_output_nid generation:  0.008170366287231445
local_in_edges_tensor generation:  0.009292125701904297
mini_batch_src_global generation:  0.016115188598632812
r_  generation:  0.13531255722045898
local_output_nid generation:  0.008217334747314453
local_in_edges_tensor generation:  0.00892186164855957
mini_batch_src_global generation:  0.017454147338867188
r_  generation:  0.13588976860046387
local_output_nid generation:  0.00821232795715332
local_in_edges_tensor generation:  0.008814096450805664
mini_batch_src_global generation:  0.01631784439086914
r_  generation:  0.13533425331115723
local_output_nid generation:  0.008503198623657227
local_in_edges_tensor generation:  0.010441780090332031
mini_batch_src_global generation:  0.016858577728271484
r_  generation:  0.13806366920471191
local_output_nid generation:  0.008198022842407227
local_in_edges_tensor generation:  0.007932186126708984
mini_batch_src_global generation:  0.01614236831665039
r_  generation:  0.13244843482971191
local_output_nid generation:  0.008399486541748047
local_in_edges_tensor generation:  0.00868082046508789
mini_batch_src_global generation:  0.017612218856811523
r_  generation:  0.13691115379333496
local_output_nid generation:  0.008640289306640625
local_in_edges_tensor generation:  0.009381532669067383
mini_batch_src_global generation:  0.016975879669189453
r_  generation:  0.14132905006408691
local_output_nid generation:  0.00845479965209961
local_in_edges_tensor generation:  0.010293006896972656
mini_batch_src_global generation:  0.017087936401367188
r_  generation:  0.13501787185668945
local_output_nid generation:  0.008507013320922852
local_in_edges_tensor generation:  0.010100126266479492
mini_batch_src_global generation:  0.016643047332763672
r_  generation:  0.13603711128234863
local_output_nid generation:  0.008617877960205078
local_in_edges_tensor generation:  0.008054971694946289
mini_batch_src_global generation:  0.020786046981811523
r_  generation:  0.14038395881652832
local_output_nid generation:  0.008555412292480469
local_in_edges_tensor generation:  0.011379003524780273
mini_batch_src_global generation:  0.01697373390197754
r_  generation:  0.13831305503845215
local_output_nid generation:  0.008835792541503906
local_in_edges_tensor generation:  0.008486270904541016
mini_batch_src_global generation:  0.0173189640045166
r_  generation:  0.1392655372619629
local_output_nid generation:  0.008454561233520508
local_in_edges_tensor generation:  0.008574247360229492
mini_batch_src_global generation:  0.016849040985107422
r_  generation:  0.13642430305480957
local_output_nid generation:  0.00861358642578125
local_in_edges_tensor generation:  0.009119272232055664
mini_batch_src_global generation:  0.017940998077392578
r_  generation:  0.1383957862854004
local_output_nid generation:  0.008931875228881836
local_in_edges_tensor generation:  0.00974130630493164
mini_batch_src_global generation:  0.017745256423950195
r_  generation:  0.14564180374145508
local_output_nid generation:  0.008769750595092773
local_in_edges_tensor generation:  0.00951528549194336
mini_batch_src_global generation:  0.017064332962036133
r_  generation:  0.14092063903808594
local_output_nid generation:  0.008637666702270508
local_in_edges_tensor generation:  0.00810694694519043
mini_batch_src_global generation:  0.01675105094909668
r_  generation:  0.13913655281066895
local_output_nid generation:  0.008867263793945312
local_in_edges_tensor generation:  0.010301589965820312
mini_batch_src_global generation:  0.0164487361907959
r_  generation:  0.1381382942199707
local_output_nid generation:  0.008647918701171875
local_in_edges_tensor generation:  0.009319782257080078
mini_batch_src_global generation:  0.01693892478942871
r_  generation:  0.1421523094177246
local_output_nid generation:  0.00887918472290039
local_in_edges_tensor generation:  0.01414036750793457
mini_batch_src_global generation:  0.017176151275634766
r_  generation:  0.14002752304077148
local_output_nid generation:  0.008529424667358398
local_in_edges_tensor generation:  0.008177995681762695
mini_batch_src_global generation:  0.0164794921875
r_  generation:  0.13860511779785156
local_output_nid generation:  0.008859395980834961
local_in_edges_tensor generation:  0.009208917617797852
mini_batch_src_global generation:  0.018054962158203125
r_  generation:  0.14239954948425293
local_output_nid generation:  0.008901357650756836
local_in_edges_tensor generation:  0.011557579040527344
mini_batch_src_global generation:  0.017199993133544922
r_  generation:  0.14072513580322266
local_output_nid generation:  0.008814811706542969
local_in_edges_tensor generation:  0.009439945220947266
mini_batch_src_global generation:  0.017383575439453125
r_  generation:  0.14048290252685547
----------------------check_connections_block total spend ----------------------------- 6.539803504943848
generate_one_block  0.17539501190185547
generate_one_block  0.17718768119812012
generate_one_block  0.19855189323425293
generate_one_block  0.16718673706054688
generate_one_block  0.17322611808776855
generate_one_block  0.17091751098632812
generate_one_block  0.17171168327331543
generate_one_block  0.16975903511047363
generate_one_block  0.171860933303833
generate_one_block  0.17383050918579102
generate_one_block  0.17134308815002441
generate_one_block  0.1747288703918457
generate_one_block  0.16647553443908691
generate_one_block  0.17408299446105957
generate_one_block  0.18178677558898926
generate_one_block  0.16873955726623535
generate_one_block  0.17641115188598633
generate_one_block  0.17170238494873047
generate_one_block  0.1721949577331543
generate_one_block  0.17686152458190918
generate_one_block  0.1660304069519043
generate_one_block  0.1683182716369629
generate_one_block  0.18272995948791504
generate_one_block  0.17487359046936035
generate_one_block  0.16557836532592773
generate_one_block  0.17002630233764648
generate_one_block  0.17663073539733887
generate_one_block  0.17748355865478516
generate_one_block  0.16846108436584473
generate_one_block  0.17693185806274414
generate_one_block  0.17612624168395996
generate_one_block  0.17621850967407227
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04048800468444824
gen group dst list time:  0.09325551986694336
time for parepare:  0.018849849700927734
local_output_nid generation:  0.02018904685974121
local_in_edges_tensor generation:  0.0362544059753418
mini_batch_src_global generation:  0.04688286781311035
r_  generation:  0.4526808261871338
local_output_nid generation:  0.027209997177124023
local_in_edges_tensor generation:  0.0546262264251709
mini_batch_src_global generation:  0.05701947212219238
r_  generation:  0.46834564208984375
local_output_nid generation:  0.028039216995239258
local_in_edges_tensor generation:  0.04296755790710449
mini_batch_src_global generation:  0.05837702751159668
r_  generation:  0.4556405544281006
local_output_nid generation:  0.025706768035888672
local_in_edges_tensor generation:  0.030434608459472656
mini_batch_src_global generation:  0.05355358123779297
r_  generation:  0.4439716339111328
local_output_nid generation:  0.02563762664794922
local_in_edges_tensor generation:  0.029582738876342773
mini_batch_src_global generation:  0.05663657188415527
r_  generation:  0.4578068256378174
local_output_nid generation:  0.026189327239990234
local_in_edges_tensor generation:  0.029778718948364258
mini_batch_src_global generation:  0.05706024169921875
r_  generation:  0.44376659393310547
local_output_nid generation:  0.028252124786376953
local_in_edges_tensor generation:  0.03444075584411621
mini_batch_src_global generation:  0.0570371150970459
r_  generation:  0.4544215202331543
local_output_nid generation:  0.026395320892333984
local_in_edges_tensor generation:  0.028659820556640625
mini_batch_src_global generation:  0.0562129020690918
r_  generation:  0.4448251724243164
local_output_nid generation:  0.02638721466064453
local_in_edges_tensor generation:  0.029216527938842773
mini_batch_src_global generation:  0.05691814422607422
r_  generation:  0.4513511657714844
local_output_nid generation:  0.02623748779296875
local_in_edges_tensor generation:  0.033415794372558594
mini_batch_src_global generation:  0.05815601348876953
r_  generation:  0.4546351432800293
local_output_nid generation:  0.026408672332763672
local_in_edges_tensor generation:  0.029644489288330078
mini_batch_src_global generation:  0.053994178771972656
r_  generation:  0.45493292808532715
local_output_nid generation:  0.02663588523864746
local_in_edges_tensor generation:  0.034824371337890625
mini_batch_src_global generation:  0.06062150001525879
r_  generation:  0.45476675033569336
local_output_nid generation:  0.027514934539794922
local_in_edges_tensor generation:  0.02673792839050293
mini_batch_src_global generation:  0.08116817474365234
r_  generation:  0.4594249725341797
local_output_nid generation:  0.028552532196044922
local_in_edges_tensor generation:  0.02738022804260254
mini_batch_src_global generation:  0.06453537940979004
r_  generation:  0.44830918312072754
local_output_nid generation:  0.0268402099609375
local_in_edges_tensor generation:  0.034557342529296875
mini_batch_src_global generation:  0.05376791954040527
r_  generation:  0.45998072624206543
local_output_nid generation:  0.026517868041992188
local_in_edges_tensor generation:  0.029931068420410156
mini_batch_src_global generation:  0.054831743240356445
r_  generation:  0.44651246070861816
local_output_nid generation:  0.026757001876831055
local_in_edges_tensor generation:  0.026057958602905273
mini_batch_src_global generation:  0.05412101745605469
r_  generation:  0.456052303314209
local_output_nid generation:  0.026828289031982422
local_in_edges_tensor generation:  0.034690141677856445
mini_batch_src_global generation:  0.05461883544921875
r_  generation:  0.4465446472167969
local_output_nid generation:  0.026658296585083008
local_in_edges_tensor generation:  0.029474973678588867
mini_batch_src_global generation:  0.05735516548156738
r_  generation:  0.45732808113098145
local_output_nid generation:  0.02707672119140625
local_in_edges_tensor generation:  0.034996747970581055
mini_batch_src_global generation:  0.055121660232543945
r_  generation:  0.4536752700805664
local_output_nid generation:  0.026592016220092773
local_in_edges_tensor generation:  0.025737285614013672
mini_batch_src_global generation:  0.05455923080444336
r_  generation:  0.45445799827575684
local_output_nid generation:  0.026791095733642578
local_in_edges_tensor generation:  0.025946378707885742
mini_batch_src_global generation:  0.05388283729553223
r_  generation:  0.4552738666534424
local_output_nid generation:  0.027258872985839844
local_in_edges_tensor generation:  0.03890061378479004
mini_batch_src_global generation:  0.0577852725982666
r_  generation:  0.46916842460632324
local_output_nid generation:  0.026998281478881836
local_in_edges_tensor generation:  0.03815889358520508
mini_batch_src_global generation:  0.05594611167907715
r_  generation:  0.45133471488952637
local_output_nid generation:  0.026485681533813477
local_in_edges_tensor generation:  0.025295257568359375
mini_batch_src_global generation:  0.054715633392333984
r_  generation:  0.44989848136901855
local_output_nid generation:  0.026815176010131836
local_in_edges_tensor generation:  0.026332378387451172
mini_batch_src_global generation:  0.05376434326171875
r_  generation:  0.44948744773864746
local_output_nid generation:  0.02705979347229004
local_in_edges_tensor generation:  0.04225015640258789
mini_batch_src_global generation:  0.05437016487121582
r_  generation:  0.45583271980285645
local_output_nid generation:  0.02677750587463379
local_in_edges_tensor generation:  0.02576470375061035
mini_batch_src_global generation:  0.05438685417175293
r_  generation:  0.4497978687286377
local_output_nid generation:  0.026847124099731445
local_in_edges_tensor generation:  0.032259464263916016
mini_batch_src_global generation:  0.05369281768798828
r_  generation:  0.4632878303527832
local_output_nid generation:  0.0280148983001709
local_in_edges_tensor generation:  0.030377864837646484
mini_batch_src_global generation:  0.06096053123474121
r_  generation:  0.47816038131713867
local_output_nid generation:  0.027002334594726562
local_in_edges_tensor generation:  0.040694236755371094
mini_batch_src_global generation:  0.06013989448547363
r_  generation:  0.4591701030731201
local_output_nid generation:  0.028076648712158203
local_in_edges_tensor generation:  0.03382086753845215
mini_batch_src_global generation:  0.05702352523803711
r_  generation:  0.4492783546447754
----------------------check_connections_block total spend ----------------------------- 21.414215087890625
generate_one_block  0.5941252708435059
generate_one_block  0.7002534866333008
generate_one_block  0.5954813957214355
generate_one_block  0.598583459854126
generate_one_block  0.5745131969451904
generate_one_block  0.5800468921661377
generate_one_block  0.5808184146881104
generate_one_block  0.5843732357025146
generate_one_block  0.5939433574676514
generate_one_block  0.5792796611785889
generate_one_block  0.5836153030395508
generate_one_block  0.5830132961273193
generate_one_block  0.5704560279846191
generate_one_block  0.5976274013519287
generate_one_block  0.5995445251464844
generate_one_block  0.5731050968170166
generate_one_block  0.5804812908172607
generate_one_block  0.5888738632202148
generate_one_block  0.5892179012298584
generate_one_block  0.5997719764709473
generate_one_block  0.57053542137146
generate_one_block  0.5877425670623779
generate_one_block  0.6022512912750244
generate_one_block  0.5968246459960938
generate_one_block  0.5699481964111328
generate_one_block  0.5771825313568115
generate_one_block  0.5889203548431396
generate_one_block  0.5866177082061768
generate_one_block  0.5730416774749756
generate_one_block  0.5938324928283691
generate_one_block  0.5915200710296631
generate_one_block  0.5711352825164795
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.07157778739929199
gen group dst list time:  0.16323018074035645
time for parepare:  0.018637418746948242
local_output_nid generation:  0.031998395919799805
local_in_edges_tensor generation:  0.05939173698425293
mini_batch_src_global generation:  0.04837775230407715
r_  generation:  0.5141189098358154
local_output_nid generation:  0.0375211238861084
local_in_edges_tensor generation:  0.054463863372802734
mini_batch_src_global generation:  0.06069207191467285
r_  generation:  0.520268440246582
local_output_nid generation:  0.03721213340759277
local_in_edges_tensor generation:  0.03713083267211914
mini_batch_src_global generation:  0.05650782585144043
r_  generation:  0.5254549980163574
local_output_nid generation:  0.03583955764770508
local_in_edges_tensor generation:  0.0408780574798584
mini_batch_src_global generation:  0.05602097511291504
r_  generation:  0.5295655727386475
local_output_nid generation:  0.03678488731384277
local_in_edges_tensor generation:  0.041404008865356445
mini_batch_src_global generation:  0.0607759952545166
r_  generation:  0.5362882614135742
local_output_nid generation:  0.036217451095581055
local_in_edges_tensor generation:  0.04146933555603027
mini_batch_src_global generation:  0.05828356742858887
r_  generation:  0.5305979251861572
local_output_nid generation:  0.035746097564697266
local_in_edges_tensor generation:  0.041052818298339844
mini_batch_src_global generation:  0.0585482120513916
r_  generation:  0.5337123870849609
local_output_nid generation:  0.03587794303894043
local_in_edges_tensor generation:  0.03631424903869629
mini_batch_src_global generation:  0.059886932373046875
r_  generation:  0.538161039352417
local_output_nid generation:  0.03616690635681152
local_in_edges_tensor generation:  0.04116177558898926
mini_batch_src_global generation:  0.06280207633972168
r_  generation:  0.5479066371917725
local_output_nid generation:  0.03617238998413086
local_in_edges_tensor generation:  0.036830902099609375
mini_batch_src_global generation:  0.0590670108795166
r_  generation:  0.5354375839233398
local_output_nid generation:  0.03587055206298828
local_in_edges_tensor generation:  0.04568076133728027
mini_batch_src_global generation:  0.059427738189697266
r_  generation:  0.5487291812896729
local_output_nid generation:  0.0358128547668457
local_in_edges_tensor generation:  0.043694257736206055
mini_batch_src_global generation:  0.059255123138427734
r_  generation:  0.534764289855957
local_output_nid generation:  0.03601217269897461
local_in_edges_tensor generation:  0.04093670845031738
mini_batch_src_global generation:  0.059859275817871094
r_  generation:  0.5466227531433105
local_output_nid generation:  0.03574562072753906
local_in_edges_tensor generation:  0.040349721908569336
mini_batch_src_global generation:  0.05949258804321289
r_  generation:  0.538792610168457
local_output_nid generation:  0.036264896392822266
local_in_edges_tensor generation:  0.0464322566986084
mini_batch_src_global generation:  0.06003093719482422
r_  generation:  0.5467898845672607
local_output_nid generation:  0.03610038757324219
local_in_edges_tensor generation:  0.040827035903930664
mini_batch_src_global generation:  0.05987071990966797
r_  generation:  0.5505383014678955
local_output_nid generation:  0.036022186279296875
local_in_edges_tensor generation:  0.04082822799682617
mini_batch_src_global generation:  0.05953788757324219
r_  generation:  0.5430474281311035
local_output_nid generation:  0.036136627197265625
local_in_edges_tensor generation:  0.04669785499572754
mini_batch_src_global generation:  0.06346464157104492
r_  generation:  0.538508415222168
local_output_nid generation:  0.03635883331298828
local_in_edges_tensor generation:  0.03679966926574707
mini_batch_src_global generation:  0.06277990341186523
r_  generation:  0.5423858165740967
local_output_nid generation:  0.03670763969421387
local_in_edges_tensor generation:  0.04460549354553223
mini_batch_src_global generation:  0.062154293060302734
r_  generation:  0.5405874252319336
local_output_nid generation:  0.03659820556640625
local_in_edges_tensor generation:  0.049454689025878906
mini_batch_src_global generation:  0.060021400451660156
r_  generation:  0.5361557006835938
local_output_nid generation:  0.036383867263793945
local_in_edges_tensor generation:  0.03632235527038574
mini_batch_src_global generation:  0.060079336166381836
r_  generation:  0.550997257232666
local_output_nid generation:  0.03805088996887207
local_in_edges_tensor generation:  0.046705007553100586
mini_batch_src_global generation:  0.06472134590148926
r_  generation:  0.5370757579803467
local_output_nid generation:  0.03743767738342285
local_in_edges_tensor generation:  0.04189038276672363
mini_batch_src_global generation:  0.0595402717590332
r_  generation:  0.5387825965881348
local_output_nid generation:  0.037316083908081055
local_in_edges_tensor generation:  0.03643369674682617
mini_batch_src_global generation:  0.0612339973449707
r_  generation:  0.5347411632537842
local_output_nid generation:  0.0379490852355957
local_in_edges_tensor generation:  0.04169583320617676
mini_batch_src_global generation:  0.06023812294006348
r_  generation:  0.5442054271697998
local_output_nid generation:  0.03827548027038574
local_in_edges_tensor generation:  0.0366060733795166
mini_batch_src_global generation:  0.061109304428100586
r_  generation:  0.5348672866821289
local_output_nid generation:  0.03734326362609863
local_in_edges_tensor generation:  0.04122352600097656
mini_batch_src_global generation:  0.06058478355407715
r_  generation:  0.5389080047607422
local_output_nid generation:  0.03722119331359863
local_in_edges_tensor generation:  0.03638195991516113
mini_batch_src_global generation:  0.06517910957336426
r_  generation:  0.5342836380004883
local_output_nid generation:  0.03688931465148926
local_in_edges_tensor generation:  0.04705071449279785
mini_batch_src_global generation:  0.060420989990234375
r_  generation:  0.548748254776001
local_output_nid generation:  0.03715991973876953
local_in_edges_tensor generation:  0.04626107215881348
mini_batch_src_global generation:  0.06532835960388184
r_  generation:  0.5347061157226562
local_output_nid generation:  0.03711271286010742
local_in_edges_tensor generation:  0.03674817085266113
mini_batch_src_global generation:  0.05954456329345703
r_  generation:  0.5443291664123535
----------------------check_connections_block total spend ----------------------------- 25.71530508995056
generate_one_block  0.661813497543335
generate_one_block  0.6707372665405273
generate_one_block  0.6622939109802246
generate_one_block  0.6707313060760498
generate_one_block  0.6732101440429688
generate_one_block  0.6888678073883057
generate_one_block  0.6683511734008789
generate_one_block  0.7861232757568359
generate_one_block  0.6704883575439453
generate_one_block  0.6615400314331055
generate_one_block  0.6688718795776367
generate_one_block  0.6715402603149414
generate_one_block  0.6735026836395264
generate_one_block  0.655038595199585
generate_one_block  0.6768319606781006
generate_one_block  0.6658406257629395
generate_one_block  0.667414665222168
generate_one_block  0.6811428070068359
generate_one_block  0.6577136516571045
generate_one_block  0.6701900959014893
generate_one_block  0.6718552112579346
generate_one_block  0.6541047096252441
generate_one_block  0.6745457649230957
generate_one_block  0.6760103702545166
generate_one_block  0.6534202098846436
generate_one_block  0.6703557968139648
generate_one_block  0.6555454730987549
generate_one_block  0.6700897216796875
generate_one_block  0.6735062599182129
generate_one_block  0.6717729568481445
generate_one_block  0.6755690574645996
generate_one_block  0.6664233207702637
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03847956657409668
gen group dst list time:  0.19369769096374512
time for parepare:  0.019335269927978516
local_output_nid generation:  0.03578615188598633
local_in_edges_tensor generation:  0.05273628234863281
mini_batch_src_global generation:  0.04447293281555176
r_  generation:  0.4946441650390625
local_output_nid generation:  0.04169344902038574
local_in_edges_tensor generation:  0.038701772689819336
mini_batch_src_global generation:  0.057066917419433594
r_  generation:  0.49242472648620605
local_output_nid generation:  0.041465044021606445
local_in_edges_tensor generation:  0.03629136085510254
mini_batch_src_global generation:  0.05631399154663086
r_  generation:  0.4963405132293701
local_output_nid generation:  0.04048895835876465
local_in_edges_tensor generation:  0.03412175178527832
mini_batch_src_global generation:  0.05654501914978027
r_  generation:  0.4959585666656494
local_output_nid generation:  0.038771629333496094
local_in_edges_tensor generation:  0.03694963455200195
mini_batch_src_global generation:  0.05578351020812988
r_  generation:  0.5036747455596924
local_output_nid generation:  0.039330482482910156
local_in_edges_tensor generation:  0.039679527282714844
mini_batch_src_global generation:  0.0564424991607666
r_  generation:  0.5089111328125
local_output_nid generation:  0.03917574882507324
local_in_edges_tensor generation:  0.04321551322937012
mini_batch_src_global generation:  0.05647897720336914
r_  generation:  0.5041952133178711
local_output_nid generation:  0.03936648368835449
local_in_edges_tensor generation:  0.04422616958618164
mini_batch_src_global generation:  0.06383419036865234
r_  generation:  0.5095391273498535
local_output_nid generation:  0.03946089744567871
local_in_edges_tensor generation:  0.040746450424194336
mini_batch_src_global generation:  0.05617713928222656
r_  generation:  0.5126655101776123
local_output_nid generation:  0.03953814506530762
local_in_edges_tensor generation:  0.043297529220581055
mini_batch_src_global generation:  0.056914329528808594
r_  generation:  0.5135807991027832
local_output_nid generation:  0.042221784591674805
local_in_edges_tensor generation:  0.042545318603515625
mini_batch_src_global generation:  0.06144976615905762
r_  generation:  0.5107057094573975
local_output_nid generation:  0.03962087631225586
local_in_edges_tensor generation:  0.04416346549987793
mini_batch_src_global generation:  0.05658388137817383
r_  generation:  0.5116655826568604
local_output_nid generation:  0.03909134864807129
local_in_edges_tensor generation:  0.038068294525146484
mini_batch_src_global generation:  0.05577230453491211
r_  generation:  0.5121219158172607
local_output_nid generation:  0.04431939125061035
local_in_edges_tensor generation:  0.04323077201843262
mini_batch_src_global generation:  0.06713294982910156
r_  generation:  0.5103001594543457
local_output_nid generation:  0.040628671646118164
local_in_edges_tensor generation:  0.03830289840698242
mini_batch_src_global generation:  0.0574648380279541
r_  generation:  0.515636682510376
local_output_nid generation:  0.04064130783081055
local_in_edges_tensor generation:  0.04660630226135254
mini_batch_src_global generation:  0.056654930114746094
r_  generation:  0.5148651599884033
local_output_nid generation:  0.04122042655944824
local_in_edges_tensor generation:  0.0345458984375
mini_batch_src_global generation:  0.0599360466003418
r_  generation:  0.5154538154602051
local_output_nid generation:  0.040470123291015625
local_in_edges_tensor generation:  0.03854537010192871
mini_batch_src_global generation:  0.05722999572753906
r_  generation:  0.5171210765838623
local_output_nid generation:  0.04065275192260742
local_in_edges_tensor generation:  0.038504600524902344
mini_batch_src_global generation:  0.0574185848236084
r_  generation:  0.5176980495452881
local_output_nid generation:  0.040941476821899414
local_in_edges_tensor generation:  0.03906607627868652
mini_batch_src_global generation:  0.06063675880432129
r_  generation:  0.5152871608734131
local_output_nid generation:  0.04055476188659668
local_in_edges_tensor generation:  0.04376649856567383
mini_batch_src_global generation:  0.06060671806335449
r_  generation:  0.5130577087402344
local_output_nid generation:  0.04087519645690918
local_in_edges_tensor generation:  0.03541898727416992
mini_batch_src_global generation:  0.057579755783081055
r_  generation:  0.5144681930541992
local_output_nid generation:  0.0406956672668457
local_in_edges_tensor generation:  0.035889387130737305
mini_batch_src_global generation:  0.057050466537475586
r_  generation:  0.5165951251983643
local_output_nid generation:  0.04079890251159668
local_in_edges_tensor generation:  0.03524947166442871
mini_batch_src_global generation:  0.057892560958862305
r_  generation:  0.5147082805633545
local_output_nid generation:  0.040511131286621094
local_in_edges_tensor generation:  0.04329061508178711
mini_batch_src_global generation:  0.06068706512451172
r_  generation:  0.5163300037384033
local_output_nid generation:  0.040419578552246094
local_in_edges_tensor generation:  0.04835247993469238
mini_batch_src_global generation:  0.056903839111328125
r_  generation:  0.516864538192749
local_output_nid generation:  0.04027509689331055
local_in_edges_tensor generation:  0.034751176834106445
mini_batch_src_global generation:  0.05674934387207031
r_  generation:  0.5291640758514404
local_output_nid generation:  0.040233612060546875
local_in_edges_tensor generation:  0.051302433013916016
mini_batch_src_global generation:  0.06054329872131348
r_  generation:  0.5136158466339111
local_output_nid generation:  0.04050922393798828
local_in_edges_tensor generation:  0.04406571388244629
mini_batch_src_global generation:  0.05605292320251465
r_  generation:  0.5249748229980469
local_output_nid generation:  0.04056382179260254
local_in_edges_tensor generation:  0.0426943302154541
mini_batch_src_global generation:  0.056369781494140625
r_  generation:  0.5136322975158691
local_output_nid generation:  0.04087662696838379
local_in_edges_tensor generation:  0.03966069221496582
mini_batch_src_global generation:  0.057281494140625
r_  generation:  0.5212001800537109
local_output_nid generation:  0.040956974029541016
local_in_edges_tensor generation:  0.03952217102050781
mini_batch_src_global generation:  0.06313824653625488
r_  generation:  0.5204987525939941
----------------------check_connections_block total spend ----------------------------- 24.816911458969116
generate_one_block  0.6532526016235352
generate_one_block  0.6465561389923096
generate_one_block  0.6364877223968506
generate_one_block  0.6345992088317871
generate_one_block  0.6383609771728516
generate_one_block  0.6416051387786865
generate_one_block  0.6212406158447266
generate_one_block  0.6257538795471191
generate_one_block  0.6349446773529053
generate_one_block  0.6251628398895264
generate_one_block  0.6309597492218018
generate_one_block  0.6268320083618164
generate_one_block  0.6406505107879639
generate_one_block  0.7722339630126953
generate_one_block  0.6456449031829834
generate_one_block  0.6421830654144287
generate_one_block  0.6282212734222412
generate_one_block  0.6448452472686768
generate_one_block  0.6352267265319824
generate_one_block  0.6392569541931152
generate_one_block  0.644690990447998
generate_one_block  0.6270022392272949
generate_one_block  0.6564083099365234
generate_one_block  0.6232061386108398
generate_one_block  0.6956608295440674
generate_one_block  0.6660354137420654
generate_one_block  0.643582820892334
generate_one_block  0.6417198181152344
generate_one_block  0.6537473201751709
generate_one_block  0.654327392578125
generate_one_block  0.6541662216186523
generate_one_block  0.6605393886566162
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0272216796875 GB
    Memory Allocated: 0.010137557983398438  GigaBytes
Max Memory Allocated: 0.010137557983398438  GigaBytes

connection checking time:  78.48623514175415
block generation total time  66.62058806419373
average batch blocks generation time:  2.081893377006054
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2108154296875 GB
    Memory Allocated: 0.12814664840698242  GigaBytes
Max Memory Allocated: 0.12814664840698242  GigaBytes

torch.Size([165102, 128])
torch.Size([161064, 256])
Traceback (most recent call last):
  File "pseudo_mini_batch_range_arxiv_sage.py", line 435, in <module>
    main()
  File "pseudo_mini_batch_range_arxiv_sage.py", line 431, in main
    best_test = run(args, device, data)
  File "pseudo_mini_batch_range_arxiv_sage.py", line 251, in run
    batch_pred = model(blocks, batch_inputs)#------------*
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/graph_partition_multi_layers/pseudo_mini_batch_full_batch/SAGE/graphsage_model_arxiv.py", line 182, in forward
    x = layer(block, x)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 258, in forward
    graph.update_all(msg_fn, self._lstm_reducer)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/heterograph.py", line 4849, in update_all
    ndata = core.message_passing(g, message_func, reduce_func, apply_node_func)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 337, in message_passing
    ndata = invoke_udf_reduce(g, rfunc, msgdata, orig_nid=orig_nid)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 143, in invoke_udf_reduce
    bkt_rsts.append(func(nbatch))
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 173, in _lstm_reducer
    _, (rst, _) = self.lstm(m, h)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/rnn.py", line 582, in forward
    self.dropout, self.training, self.bidirectional, self.batch_first)
RuntimeError: CUDA out of memory. Tried to allocate 16.00 MiB (GPU 0; 23.62 GiB total capacity; 22.00 GiB already allocated; 8.44 MiB free; 22.41 GiB reserved in total by PyTorch)
