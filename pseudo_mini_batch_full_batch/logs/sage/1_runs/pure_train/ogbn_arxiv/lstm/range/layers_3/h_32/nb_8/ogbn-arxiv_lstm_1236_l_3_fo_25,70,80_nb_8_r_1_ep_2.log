Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648467115.770122
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.028047561645507812
range selection method range initialization spend 0.013521909713745117
time for parepare:  0.0182037353515625
local_output_nid generation:  0.002637147903442383
local_in_edges_tensor generation:  0.00492405891418457
mini_batch_src_global generation:  0.0040531158447265625
r_  generation:  0.04221796989440918
local_output_nid generation:  0.0030968189239501953
local_in_edges_tensor generation:  0.0016465187072753906
mini_batch_src_global generation:  0.005037069320678711
r_  generation:  0.04291534423828125
local_output_nid generation:  0.0031762123107910156
local_in_edges_tensor generation:  0.001756906509399414
mini_batch_src_global generation:  0.003281831741333008
r_  generation:  0.04279756546020508
local_output_nid generation:  0.0032317638397216797
local_in_edges_tensor generation:  0.00174713134765625
mini_batch_src_global generation:  0.003343343734741211
r_  generation:  0.04464578628540039
local_output_nid generation:  0.0031669139862060547
local_in_edges_tensor generation:  0.0017561912536621094
mini_batch_src_global generation:  0.003660917282104492
r_  generation:  0.04540729522705078
local_output_nid generation:  0.0031299591064453125
local_in_edges_tensor generation:  0.0017094612121582031
mini_batch_src_global generation:  0.0037255287170410156
r_  generation:  0.047351837158203125
local_output_nid generation:  0.0031499862670898438
local_in_edges_tensor generation:  0.001720428466796875
mini_batch_src_global generation:  0.003892183303833008
r_  generation:  0.046501874923706055
local_output_nid generation:  0.0031533241271972656
local_in_edges_tensor generation:  0.0016980171203613281
mini_batch_src_global generation:  0.004007816314697266
r_  generation:  0.047989845275878906
----------------------check_connections_block total spend ----------------------------- 0.5284125804901123
generate_one_block  0.06175827980041504
generate_one_block  0.06122636795043945
generate_one_block  0.06067681312561035
generate_one_block  0.06162285804748535
generate_one_block  0.06363248825073242
generate_one_block  0.06204366683959961
generate_one_block  0.061897993087768555
generate_one_block  0.06416726112365723
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.043843984603881836
gen group dst list time:  0.016352176666259766
time for parepare:  0.020441770553588867
local_output_nid generation:  0.011664628982543945
local_in_edges_tensor generation:  0.03242349624633789
mini_batch_src_global generation:  0.037392616271972656
r_  generation:  0.3572273254394531
local_output_nid generation:  0.02007579803466797
local_in_edges_tensor generation:  0.033219099044799805
mini_batch_src_global generation:  0.05223822593688965
r_  generation:  0.37840843200683594
local_output_nid generation:  0.020980358123779297
local_in_edges_tensor generation:  0.024056673049926758
mini_batch_src_global generation:  0.050002098083496094
r_  generation:  0.37888169288635254
local_output_nid generation:  0.02458500862121582
local_in_edges_tensor generation:  0.027216672897338867
mini_batch_src_global generation:  0.047197818756103516
r_  generation:  0.3814668655395508
local_output_nid generation:  0.021731138229370117
local_in_edges_tensor generation:  0.025419235229492188
mini_batch_src_global generation:  0.04894542694091797
r_  generation:  0.39929771423339844
local_output_nid generation:  0.019352436065673828
local_in_edges_tensor generation:  0.04716944694519043
mini_batch_src_global generation:  0.0628352165222168
r_  generation:  0.3896598815917969
local_output_nid generation:  0.019863605499267578
local_in_edges_tensor generation:  0.028445720672607422
mini_batch_src_global generation:  0.0614008903503418
r_  generation:  0.3854329586029053
local_output_nid generation:  0.019125938415527344
local_in_edges_tensor generation:  0.023140668869018555
mini_batch_src_global generation:  0.05305290222167969
r_  generation:  0.3847005367279053
----------------------check_connections_block total spend ----------------------------- 4.570393323898315
generate_one_block  0.5153853893280029
generate_one_block  0.5205907821655273
generate_one_block  0.4890613555908203
generate_one_block  0.4951298236846924
generate_one_block  0.49816346168518066
generate_one_block  0.5319609642028809
generate_one_block  0.503180742263794
generate_one_block  0.5023748874664307
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.052370548248291016
gen group dst list time:  0.03749513626098633
time for parepare:  0.01953601837158203
local_output_nid generation:  0.025792360305786133
local_in_edges_tensor generation:  0.056833744049072266
mini_batch_src_global generation:  0.0493011474609375
r_  generation:  0.49852561950683594
local_output_nid generation:  0.03282523155212402
local_in_edges_tensor generation:  0.05131888389587402
mini_batch_src_global generation:  0.05875277519226074
r_  generation:  0.487943172454834
local_output_nid generation:  0.03370213508605957
local_in_edges_tensor generation:  0.04516911506652832
mini_batch_src_global generation:  0.07025265693664551
r_  generation:  0.5082249641418457
local_output_nid generation:  0.04013824462890625
local_in_edges_tensor generation:  0.047302961349487305
mini_batch_src_global generation:  0.06289219856262207
r_  generation:  0.4928152561187744
local_output_nid generation:  0.035399436950683594
local_in_edges_tensor generation:  0.05033683776855469
mini_batch_src_global generation:  0.05691051483154297
r_  generation:  0.4927709102630615
local_output_nid generation:  0.03549695014953613
local_in_edges_tensor generation:  0.039032697677612305
mini_batch_src_global generation:  0.06088685989379883
r_  generation:  0.49895739555358887
local_output_nid generation:  0.03594970703125
local_in_edges_tensor generation:  0.04361605644226074
mini_batch_src_global generation:  0.05710601806640625
r_  generation:  0.5012104511260986
local_output_nid generation:  0.03595542907714844
local_in_edges_tensor generation:  0.035104990005493164
mini_batch_src_global generation:  0.05810880661010742
r_  generation:  0.5063478946685791
----------------------check_connections_block total spend ----------------------------- 6.044900178909302
generate_one_block  0.6457614898681641
generate_one_block  0.654782772064209
generate_one_block  0.6187143325805664
generate_one_block  0.6307089328765869
generate_one_block  0.634413480758667
generate_one_block  0.6394643783569336
generate_one_block  0.6689071655273438
generate_one_block  0.6329512596130371
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

connection checking time:  10.615293502807617
block generation total time  9.181551218032837
average batch blocks generation time:  1.1476939022541046
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1990966796875 GB
    Memory Allocated: 0.10009479522705078  GigaBytes
Max Memory Allocated: 0.10009479522705078  GigaBytes

torch.Size([162145, 128])
torch.Size([145688, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3084716796875 GB
    Memory Allocated: 13.976061344146729  GigaBytes
Max Memory Allocated: 13.9904203414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6170654296875 GB
    Memory Allocated: 0.1020503044128418  GigaBytes
Max Memory Allocated: 13.9904203414917  GigaBytes

torch.Size([162132, 128])
torch.Size([145880, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6307373046875 GB
    Memory Allocated: 13.998085021972656  GigaBytes
Max Memory Allocated: 14.013998031616211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6307373046875 GB
    Memory Allocated: 0.10271883010864258  GigaBytes
Max Memory Allocated: 14.013998031616211  GigaBytes

torch.Size([162041, 128])
torch.Size([145523, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8729248046875 GB
    Memory Allocated: 13.952168464660645  GigaBytes
Max Memory Allocated: 14.013998031616211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8729248046875 GB
    Memory Allocated: 0.10194253921508789  GigaBytes
Max Memory Allocated: 14.013998031616211  GigaBytes

torch.Size([162224, 128])
torch.Size([145788, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8729248046875 GB
    Memory Allocated: 13.963605880737305  GigaBytes
Max Memory Allocated: 14.013998031616211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8729248046875 GB
    Memory Allocated: 0.10278081893920898  GigaBytes
Max Memory Allocated: 14.013998031616211  GigaBytes

torch.Size([162318, 128])
torch.Size([146006, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8729248046875 GB
    Memory Allocated: 13.969363689422607  GigaBytes
Max Memory Allocated: 14.013998031616211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8729248046875 GB
    Memory Allocated: 0.10224390029907227  GigaBytes
Max Memory Allocated: 14.013998031616211  GigaBytes

torch.Size([162294, 128])
torch.Size([146112, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6190185546875 GB
    Memory Allocated: 14.035634517669678  GigaBytes
Max Memory Allocated: 14.051684856414795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6190185546875 GB
    Memory Allocated: 0.10289144515991211  GigaBytes
Max Memory Allocated: 14.051684856414795  GigaBytes

torch.Size([162117, 128])
torch.Size([146081, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6190185546875 GB
    Memory Allocated: 14.008331775665283  GigaBytes
Max Memory Allocated: 14.051684856414795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6190185546875 GB
    Memory Allocated: 0.10216569900512695  GigaBytes
Max Memory Allocated: 14.051684856414795  GigaBytes

torch.Size([162154, 128])
torch.Size([145879, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6190185546875 GB
    Memory Allocated: 14.02115249633789  GigaBytes
Max Memory Allocated: 14.051684856414795  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.045429378747940063 |0.06754374504089355 |0.6699239909648895 |0.00012037158012390137 |1.0117904543876648 |0.013066768646240234 |
----------------------------------------------------------pseudo_mini_loss sum 4.398174285888672
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3053283
Number of first layer input nodes during this epoch:  1297425
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 16.6190185546875 GB
    Memory Allocated: 0.1380624771118164  GigaBytes
Max Memory Allocated: 14.051684856414795  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025568485260009766
range selection method range initialization spend 0.015646934509277344
time for parepare:  0.017644166946411133
local_output_nid generation:  0.003330230712890625
local_in_edges_tensor generation:  0.006912708282470703
mini_batch_src_global generation:  0.007793903350830078
r_  generation:  0.04388236999511719
local_output_nid generation:  0.007236003875732422
local_in_edges_tensor generation:  0.003500223159790039
mini_batch_src_global generation:  0.009780406951904297
r_  generation:  0.04501533508300781
local_output_nid generation:  0.003499746322631836
local_in_edges_tensor generation:  0.0018007755279541016
mini_batch_src_global generation:  0.003631114959716797
r_  generation:  0.046599626541137695
local_output_nid generation:  0.0036776065826416016
local_in_edges_tensor generation:  0.0017364025115966797
mini_batch_src_global generation:  0.0038177967071533203
r_  generation:  0.047821760177612305
local_output_nid generation:  0.0035409927368164062
local_in_edges_tensor generation:  0.0017359256744384766
mini_batch_src_global generation:  0.0039038658142089844
r_  generation:  0.04839372634887695
local_output_nid generation:  0.003567218780517578
local_in_edges_tensor generation:  0.0017583370208740234
mini_batch_src_global generation:  0.004418611526489258
r_  generation:  0.05001330375671387
local_output_nid generation:  0.0036025047302246094
local_in_edges_tensor generation:  0.0017323493957519531
mini_batch_src_global generation:  0.0042877197265625
r_  generation:  0.05030655860900879
local_output_nid generation:  0.0035674571990966797
local_in_edges_tensor generation:  0.0017528533935546875
mini_batch_src_global generation:  0.004553794860839844
r_  generation:  0.049811363220214844
----------------------check_connections_block total spend ----------------------------- 0.5834636688232422
generate_one_block  0.08672237396240234
generate_one_block  0.07396388053894043
generate_one_block  0.07388424873352051
generate_one_block  0.07555246353149414
generate_one_block  0.07795882225036621
generate_one_block  0.0771636962890625
generate_one_block  0.08175015449523926
generate_one_block  0.08065342903137207
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03936266899108887
gen group dst list time:  0.018743276596069336
time for parepare:  0.022060155868530273
local_output_nid generation:  0.012858390808105469
local_in_edges_tensor generation:  0.02956104278564453
mini_batch_src_global generation:  0.037689208984375
r_  generation:  0.3730747699737549
local_output_nid generation:  0.01977372169494629
local_in_edges_tensor generation:  0.03215384483337402
mini_batch_src_global generation:  0.05587005615234375
r_  generation:  0.4065678119659424
local_output_nid generation:  0.021762371063232422
local_in_edges_tensor generation:  0.03558659553527832
mini_batch_src_global generation:  0.04827308654785156
r_  generation:  0.3761250972747803
local_output_nid generation:  0.019414663314819336
local_in_edges_tensor generation:  0.027884721755981445
mini_batch_src_global generation:  0.049224853515625
r_  generation:  0.37587618827819824
local_output_nid generation:  0.019705772399902344
local_in_edges_tensor generation:  0.026784181594848633
mini_batch_src_global generation:  0.04860043525695801
r_  generation:  0.3830564022064209
local_output_nid generation:  0.02015376091003418
local_in_edges_tensor generation:  0.023397207260131836
mini_batch_src_global generation:  0.052382707595825195
r_  generation:  0.39197874069213867
local_output_nid generation:  0.020287513732910156
local_in_edges_tensor generation:  0.020187854766845703
mini_batch_src_global generation:  0.052237749099731445
r_  generation:  0.3880481719970703
local_output_nid generation:  0.020246267318725586
local_in_edges_tensor generation:  0.029687166213989258
mini_batch_src_global generation:  0.052434444427490234
r_  generation:  0.399364709854126
----------------------check_connections_block total spend ----------------------------- 4.549173355102539
generate_one_block  0.5442385673522949
generate_one_block  0.5539674758911133
generate_one_block  0.5400168895721436
generate_one_block  0.5220427513122559
generate_one_block  0.5215706825256348
generate_one_block  0.5320572853088379
generate_one_block  0.5276336669921875
generate_one_block  0.5660843849182129
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030448198318481445
gen group dst list time:  0.03767037391662598
time for parepare:  0.0194852352142334
local_output_nid generation:  0.02858757972717285
local_in_edges_tensor generation:  0.056343793869018555
mini_batch_src_global generation:  0.04789447784423828
r_  generation:  0.4978203773498535
local_output_nid generation:  0.033380746841430664
local_in_edges_tensor generation:  0.04801130294799805
mini_batch_src_global generation:  0.058608293533325195
r_  generation:  0.49539947509765625
local_output_nid generation:  0.03405499458312988
local_in_edges_tensor generation:  0.03579521179199219
mini_batch_src_global generation:  0.058197736740112305
r_  generation:  0.49734067916870117
local_output_nid generation:  0.03452777862548828
local_in_edges_tensor generation:  0.0330958366394043
mini_batch_src_global generation:  0.05600428581237793
r_  generation:  0.5016651153564453
local_output_nid generation:  0.0347142219543457
local_in_edges_tensor generation:  0.03161287307739258
mini_batch_src_global generation:  0.0598909854888916
r_  generation:  0.5068316459655762
local_output_nid generation:  0.034644365310668945
local_in_edges_tensor generation:  0.04410052299499512
mini_batch_src_global generation:  0.057462453842163086
r_  generation:  0.5085701942443848
local_output_nid generation:  0.03603363037109375
local_in_edges_tensor generation:  0.04734611511230469
mini_batch_src_global generation:  0.05769681930541992
r_  generation:  0.5242650508880615
local_output_nid generation:  0.038245201110839844
local_in_edges_tensor generation:  0.04463815689086914
mini_batch_src_global generation:  0.06219840049743652
r_  generation:  0.5092546939849854
----------------------check_connections_block total spend ----------------------------- 6.0545196533203125
generate_one_block  0.6845080852508545
generate_one_block  0.673450231552124
generate_one_block  0.6508021354675293
generate_one_block  0.6504120826721191
generate_one_block  0.6611728668212891
generate_one_block  0.6548683643341064
generate_one_block  0.6590499877929688
generate_one_block  0.6517238616943359
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 16.6190185546875 GB
    Memory Allocated: 0.1380624771118164  GigaBytes
Max Memory Allocated: 14.051684856414795  GigaBytes

connection checking time:  10.603693008422852
block generation total time  9.593599319458008
average batch blocks generation time:  1.199199914932251
block dataloader generation time/epoch 22.791971921920776
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6190185546875 GB
    Memory Allocated: 0.1040496826171875  GigaBytes
Max Memory Allocated: 14.051684856414795  GigaBytes

torch.Size([162255, 128])
torch.Size([146086, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6190185546875 GB
    Memory Allocated: 13.99363899230957  GigaBytes
Max Memory Allocated: 14.051684856414795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6190185546875 GB
    Memory Allocated: 0.10332250595092773  GigaBytes
Max Memory Allocated: 14.051684856414795  GigaBytes

torch.Size([162362, 128])
torch.Size([146039, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6190185546875 GB
    Memory Allocated: 13.991777896881104  GigaBytes
Max Memory Allocated: 14.051684856414795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6190185546875 GB
    Memory Allocated: 0.10391473770141602  GigaBytes
Max Memory Allocated: 14.051684856414795  GigaBytes

torch.Size([162309, 128])
torch.Size([146289, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6190185546875 GB
    Memory Allocated: 13.974649429321289  GigaBytes
Max Memory Allocated: 14.051684856414795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6190185546875 GB
    Memory Allocated: 0.10315704345703125  GigaBytes
Max Memory Allocated: 14.051684856414795  GigaBytes

torch.Size([161999, 128])
torch.Size([145697, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6190185546875 GB
    Memory Allocated: 13.975622177124023  GigaBytes
Max Memory Allocated: 14.051684856414795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6190185546875 GB
    Memory Allocated: 0.10407686233520508  GigaBytes
Max Memory Allocated: 14.051684856414795  GigaBytes

torch.Size([162310, 128])
torch.Size([146023, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6190185546875 GB
    Memory Allocated: 14.00761079788208  GigaBytes
Max Memory Allocated: 14.051684856414795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6190185546875 GB
    Memory Allocated: 0.1034231185913086  GigaBytes
Max Memory Allocated: 14.051684856414795  GigaBytes

torch.Size([162365, 128])
torch.Size([146070, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6190185546875 GB
    Memory Allocated: 14.010923862457275  GigaBytes
Max Memory Allocated: 14.051684856414795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6190185546875 GB
    Memory Allocated: 0.10414266586303711  GigaBytes
Max Memory Allocated: 14.051684856414795  GigaBytes

torch.Size([162298, 128])
torch.Size([146189, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6190185546875 GB
    Memory Allocated: 14.031335353851318  GigaBytes
Max Memory Allocated: 14.051684856414795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6190185546875 GB
    Memory Allocated: 0.1034994125366211  GigaBytes
Max Memory Allocated: 14.051684856414795  GigaBytes

torch.Size([162419, 128])
torch.Size([146242, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6190185546875 GB
    Memory Allocated: 14.038958072662354  GigaBytes
Max Memory Allocated: 14.055115222930908  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.040455758571624756 |0.026883244514465332 |0.5918394029140472 |0.0001138150691986084 |1.009187936782837 |0.007390737533569336 |
----------------------------------------------------------pseudo_mini_loss sum 3.7021777629852295
Total (block generation + training)time/epoch 36.17139720916748
Training time/epoch 13.379170656204224
Training time without block to device /epoch 13.164104700088501
Training time without total dataloading part /epoch 12.816519975662231
load block tensor time/epoch 0.32364606857299805
block to device time/epoch 0.21506595611572266
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3057014
Number of first layer input nodes during this epoch:  1298317
