Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648469597.6652703
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027215957641601562
range selection method range initialization spend 0.013394355773925781
time for parepare:  0.017820358276367188
local_output_nid generation:  0.0027179718017578125
local_in_edges_tensor generation:  0.005038261413574219
mini_batch_src_global generation:  0.0037698745727539062
r_  generation:  0.04119467735290527
local_output_nid generation:  0.0030663013458251953
local_in_edges_tensor generation:  0.0017390251159667969
mini_batch_src_global generation:  0.004557132720947266
r_  generation:  0.04244232177734375
local_output_nid generation:  0.0031609535217285156
local_in_edges_tensor generation:  0.0017769336700439453
mini_batch_src_global generation:  0.0032901763916015625
r_  generation:  0.044031381607055664
local_output_nid generation:  0.0032432079315185547
local_in_edges_tensor generation:  0.001737356185913086
mini_batch_src_global generation:  0.0032668113708496094
r_  generation:  0.04471254348754883
local_output_nid generation:  0.0031948089599609375
local_in_edges_tensor generation:  0.0017628669738769531
mini_batch_src_global generation:  0.0033915042877197266
r_  generation:  0.046134233474731445
local_output_nid generation:  0.0031785964965820312
local_in_edges_tensor generation:  0.0017325878143310547
mini_batch_src_global generation:  0.003814220428466797
r_  generation:  0.046834707260131836
local_output_nid generation:  0.0032351016998291016
local_in_edges_tensor generation:  0.001775979995727539
mini_batch_src_global generation:  0.003783702850341797
r_  generation:  0.04787921905517578
local_output_nid generation:  0.0031516551971435547
local_in_edges_tensor generation:  0.001817941665649414
mini_batch_src_global generation:  0.0040094852447509766
r_  generation:  0.04792952537536621
----------------------check_connections_block total spend ----------------------------- 0.5275800228118896
generate_one_block  0.06180882453918457
generate_one_block  0.060785770416259766
generate_one_block  0.06194877624511719
generate_one_block  0.06121110916137695
generate_one_block  0.06416845321655273
generate_one_block  0.06203889846801758
generate_one_block  0.06429553031921387
generate_one_block  0.0633995532989502
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04037022590637207
gen group dst list time:  0.016196012496948242
time for parepare:  0.019362211227416992
local_output_nid generation:  0.011327981948852539
local_in_edges_tensor generation:  0.029815196990966797
mini_batch_src_global generation:  0.03079390525817871
r_  generation:  0.31686878204345703
local_output_nid generation:  0.016512155532836914
local_in_edges_tensor generation:  0.028426408767700195
mini_batch_src_global generation:  0.038504838943481445
r_  generation:  0.33628416061401367
local_output_nid generation:  0.017226696014404297
local_in_edges_tensor generation:  0.024163246154785156
mini_batch_src_global generation:  0.04111766815185547
r_  generation:  0.3460428714752197
local_output_nid generation:  0.017432689666748047
local_in_edges_tensor generation:  0.024447202682495117
mini_batch_src_global generation:  0.04029369354248047
r_  generation:  0.36754274368286133
local_output_nid generation:  0.02247762680053711
local_in_edges_tensor generation:  0.03209805488586426
mini_batch_src_global generation:  0.046421051025390625
r_  generation:  0.34090542793273926
local_output_nid generation:  0.01870870590209961
local_in_edges_tensor generation:  0.02429652214050293
mini_batch_src_global generation:  0.04212379455566406
r_  generation:  0.3411078453063965
local_output_nid generation:  0.01911163330078125
local_in_edges_tensor generation:  0.025201797485351562
mini_batch_src_global generation:  0.041881561279296875
r_  generation:  0.3413395881652832
local_output_nid generation:  0.018982648849487305
local_in_edges_tensor generation:  0.028113603591918945
mini_batch_src_global generation:  0.04172849655151367
r_  generation:  0.34535932540893555
----------------------check_connections_block total spend ----------------------------- 4.046528577804565
generate_one_block  0.44037890434265137
generate_one_block  0.4258241653442383
generate_one_block  0.43259668350219727
generate_one_block  0.4383814334869385
generate_one_block  0.45647573471069336
generate_one_block  0.48471903800964355
generate_one_block  0.4622762203216553
generate_one_block  0.4864006042480469
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.10407662391662598
gen group dst list time:  0.04528617858886719
time for parepare:  0.020546913146972656
local_output_nid generation:  0.025895357131958008
local_in_edges_tensor generation:  0.05351066589355469
mini_batch_src_global generation:  0.048851728439331055
r_  generation:  0.4893636703491211
local_output_nid generation:  0.03618216514587402
local_in_edges_tensor generation:  0.04913687705993652
mini_batch_src_global generation:  0.0550229549407959
r_  generation:  0.477123498916626
local_output_nid generation:  0.03356361389160156
local_in_edges_tensor generation:  0.05151557922363281
mini_batch_src_global generation:  0.05484271049499512
r_  generation:  0.4881279468536377
local_output_nid generation:  0.03413128852844238
local_in_edges_tensor generation:  0.03700113296508789
mini_batch_src_global generation:  0.05434775352478027
r_  generation:  0.4905407428741455
local_output_nid generation:  0.0350034236907959
local_in_edges_tensor generation:  0.041551828384399414
mini_batch_src_global generation:  0.05417799949645996
r_  generation:  0.5078799724578857
local_output_nid generation:  0.03642439842224121
local_in_edges_tensor generation:  0.04360079765319824
mini_batch_src_global generation:  0.05584001541137695
r_  generation:  0.49237823486328125
local_output_nid generation:  0.034529924392700195
local_in_edges_tensor generation:  0.045350074768066406
mini_batch_src_global generation:  0.05429244041442871
r_  generation:  0.4988589286804199
local_output_nid generation:  0.034703731536865234
local_in_edges_tensor generation:  0.0411372184753418
mini_batch_src_global generation:  0.05576276779174805
r_  generation:  0.4989001750946045
----------------------check_connections_block total spend ----------------------------- 5.925216913223267
generate_one_block  0.6323032379150391
generate_one_block  0.6301980018615723
generate_one_block  0.615776777267456
generate_one_block  0.612518310546875
generate_one_block  0.6101665496826172
generate_one_block  0.6273908615112305
generate_one_block  0.646676778793335
generate_one_block  0.6191143989562988
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

connection checking time:  9.971745491027832
block generation total time  8.621197700500488
average batch blocks generation time:  1.077649712562561
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.09804773330688477  GigaBytes
Max Memory Allocated: 0.09804773330688477  GigaBytes

torch.Size([160791, 128])
torch.Size([142970, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2537841796875 GB
    Memory Allocated: 15.825740814208984  GigaBytes
Max Memory Allocated: 15.856653690338135  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7713623046875 GB
    Memory Allocated: 0.10088205337524414  GigaBytes
Max Memory Allocated: 15.856653690338135  GigaBytes

torch.Size([160745, 128])
torch.Size([142601, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7713623046875 GB
    Memory Allocated: 15.687153816223145  GigaBytes
Max Memory Allocated: 15.856653690338135  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7713623046875 GB
    Memory Allocated: 0.10055351257324219  GigaBytes
Max Memory Allocated: 15.856653690338135  GigaBytes

torch.Size([160789, 128])
torch.Size([142784, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7791748046875 GB
    Memory Allocated: 15.779676914215088  GigaBytes
Max Memory Allocated: 15.856653690338135  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0291748046875 GB
    Memory Allocated: 0.10055685043334961  GigaBytes
Max Memory Allocated: 15.856653690338135  GigaBytes

torch.Size([160808, 128])
torch.Size([142558, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7479248046875 GB
    Memory Allocated: 15.766128063201904  GigaBytes
Max Memory Allocated: 15.856653690338135  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7479248046875 GB
    Memory Allocated: 0.10051345825195312  GigaBytes
Max Memory Allocated: 15.856653690338135  GigaBytes

torch.Size([160685, 128])
torch.Size([142408, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7479248046875 GB
    Memory Allocated: 15.772447109222412  GigaBytes
Max Memory Allocated: 15.856653690338135  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7479248046875 GB
    Memory Allocated: 0.10116004943847656  GigaBytes
Max Memory Allocated: 15.856653690338135  GigaBytes

torch.Size([160861, 128])
torch.Size([142832, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7479248046875 GB
    Memory Allocated: 15.836825847625732  GigaBytes
Max Memory Allocated: 15.869563579559326  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7479248046875 GB
    Memory Allocated: 0.10127544403076172  GigaBytes
Max Memory Allocated: 15.869563579559326  GigaBytes

torch.Size([160956, 128])
torch.Size([142963, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7479248046875 GB
    Memory Allocated: 15.89063549041748  GigaBytes
Max Memory Allocated: 15.92423963546753  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7479248046875 GB
    Memory Allocated: 0.10116767883300781  GigaBytes
Max Memory Allocated: 15.92423963546753  GigaBytes

torch.Size([161000, 128])
torch.Size([143151, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7479248046875 GB
    Memory Allocated: 15.91801404953003  GigaBytes
Max Memory Allocated: 15.951599597930908  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03687945008277893 |0.0629081130027771 |0.5272984504699707 |0.00011971592903137207 |0.9154699146747589 |0.009853363037109375 |
----------------------------------------------------------pseudo_mini_loss sum 4.945369720458984
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3017748
Number of first layer input nodes during this epoch:  1286635
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 18.7479248046875 GB
    Memory Allocated: 0.1353464126586914  GigaBytes
Max Memory Allocated: 15.951599597930908  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024531841278076172
range selection method range initialization spend 0.015422821044921875
time for parepare:  0.016932964324951172
local_output_nid generation:  0.0031647682189941406
local_in_edges_tensor generation:  0.010716438293457031
mini_batch_src_global generation:  0.003969430923461914
r_  generation:  0.0423583984375
local_output_nid generation:  0.0034341812133789062
local_in_edges_tensor generation:  0.0018236637115478516
mini_batch_src_global generation:  0.007844686508178711
r_  generation:  0.0481874942779541
local_output_nid generation:  0.00394129753112793
local_in_edges_tensor generation:  0.0019366741180419922
mini_batch_src_global generation:  0.003681659698486328
r_  generation:  0.045812368392944336
local_output_nid generation:  0.0039103031158447266
local_in_edges_tensor generation:  0.001968860626220703
mini_batch_src_global generation:  0.003751039505004883
r_  generation:  0.0486605167388916
local_output_nid generation:  0.003928661346435547
local_in_edges_tensor generation:  0.001971721649169922
mini_batch_src_global generation:  0.0038704872131347656
r_  generation:  0.04744315147399902
local_output_nid generation:  0.006399631500244141
local_in_edges_tensor generation:  0.0019519329071044922
mini_batch_src_global generation:  0.004094362258911133
r_  generation:  0.04995918273925781
local_output_nid generation:  0.003977060317993164
local_in_edges_tensor generation:  0.0019104480743408203
mini_batch_src_global generation:  0.00394129753112793
r_  generation:  0.04874229431152344
local_output_nid generation:  0.003983497619628906
local_in_edges_tensor generation:  0.001873016357421875
mini_batch_src_global generation:  0.004124641418457031
r_  generation:  0.04789113998413086
----------------------check_connections_block total spend ----------------------------- 0.5746328830718994
generate_one_block  0.08165287971496582
generate_one_block  0.07456612586975098
generate_one_block  0.07823491096496582
generate_one_block  0.07756853103637695
generate_one_block  0.07601666450500488
generate_one_block  0.07785177230834961
generate_one_block  0.0796506404876709
generate_one_block  0.07900118827819824
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.038756608963012695
gen group dst list time:  0.016963958740234375
time for parepare:  0.022183895111083984
local_output_nid generation:  0.013262271881103516
local_in_edges_tensor generation:  0.035393476486206055
mini_batch_src_global generation:  0.030688762664794922
r_  generation:  0.323772668838501
local_output_nid generation:  0.018500804901123047
local_in_edges_tensor generation:  0.03224635124206543
mini_batch_src_global generation:  0.03982973098754883
r_  generation:  0.3284740447998047
local_output_nid generation:  0.018368244171142578
local_in_edges_tensor generation:  0.02732086181640625
mini_batch_src_global generation:  0.03902244567871094
r_  generation:  0.3359055519104004
local_output_nid generation:  0.01882767677307129
local_in_edges_tensor generation:  0.024415254592895508
mini_batch_src_global generation:  0.04559969902038574
r_  generation:  0.37680959701538086
local_output_nid generation:  0.027360200881958008
local_in_edges_tensor generation:  0.029115676879882812
mini_batch_src_global generation:  0.04874372482299805
r_  generation:  0.4003181457519531
local_output_nid generation:  0.03228902816772461
local_in_edges_tensor generation:  0.03377079963684082
mini_batch_src_global generation:  0.056027889251708984
r_  generation:  0.3671228885650635
local_output_nid generation:  0.0316767692565918
local_in_edges_tensor generation:  0.03464365005493164
mini_batch_src_global generation:  0.047608137130737305
r_  generation:  0.36930322647094727
local_output_nid generation:  0.0314638614654541
local_in_edges_tensor generation:  0.028441905975341797
mini_batch_src_global generation:  0.04826712608337402
r_  generation:  0.37452125549316406
----------------------check_connections_block total spend ----------------------------- 4.374941349029541
generate_one_block  0.4908726215362549
generate_one_block  0.5178425312042236
generate_one_block  0.47136807441711426
generate_one_block  0.47142577171325684
generate_one_block  0.4663844108581543
generate_one_block  0.45632004737854004
generate_one_block  0.46093273162841797
generate_one_block  0.527388334274292
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03483939170837402
gen group dst list time:  0.041187286376953125
time for parepare:  0.019526958465576172
local_output_nid generation:  0.029333829879760742
local_in_edges_tensor generation:  0.052590131759643555
mini_batch_src_global generation:  0.04807305335998535
r_  generation:  0.47542476654052734
local_output_nid generation:  0.032631874084472656
local_in_edges_tensor generation:  0.04780912399291992
mini_batch_src_global generation:  0.054616689682006836
r_  generation:  0.48383307456970215
local_output_nid generation:  0.03340005874633789
local_in_edges_tensor generation:  0.03879189491271973
mini_batch_src_global generation:  0.05147981643676758
r_  generation:  0.4982173442840576
local_output_nid generation:  0.03507208824157715
local_in_edges_tensor generation:  0.04006767272949219
mini_batch_src_global generation:  0.054474592208862305
r_  generation:  0.5072922706604004
local_output_nid generation:  0.03445601463317871
local_in_edges_tensor generation:  0.038927555084228516
mini_batch_src_global generation:  0.059325218200683594
r_  generation:  0.5063154697418213
local_output_nid generation:  0.03737378120422363
local_in_edges_tensor generation:  0.039560556411743164
mini_batch_src_global generation:  0.05537676811218262
r_  generation:  0.49198007583618164
local_output_nid generation:  0.035242319107055664
local_in_edges_tensor generation:  0.034760236740112305
mini_batch_src_global generation:  0.0545506477355957
r_  generation:  0.49626779556274414
local_output_nid generation:  0.035268306732177734
local_in_edges_tensor generation:  0.03459572792053223
mini_batch_src_global generation:  0.05890083312988281
r_  generation:  0.4965479373931885
----------------------check_connections_block total spend ----------------------------- 5.88287615776062
generate_one_block  0.6423826217651367
generate_one_block  0.6545758247375488
generate_one_block  0.6677665710449219
generate_one_block  0.6460645198822021
generate_one_block  0.6319818496704102
generate_one_block  0.6466464996337891
generate_one_block  0.6457443237304688
generate_one_block  0.6438367366790771
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 18.7479248046875 GB
    Memory Allocated: 0.1353464126586914  GigaBytes
Max Memory Allocated: 15.951599597930908  GigaBytes

connection checking time:  10.257817506790161
block generation total time  9.041533470153809
average batch blocks generation time:  1.130191683769226
block dataloader generation time/epoch 21.774907112121582
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7479248046875 GB
    Memory Allocated: 0.10284996032714844  GigaBytes
Max Memory Allocated: 15.951599597930908  GigaBytes

torch.Size([161132, 128])
torch.Size([143125, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7479248046875 GB
    Memory Allocated: 15.882354259490967  GigaBytes
Max Memory Allocated: 15.951599597930908  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7479248046875 GB
    Memory Allocated: 0.1026611328125  GigaBytes
Max Memory Allocated: 15.951599597930908  GigaBytes

torch.Size([160798, 128])
torch.Size([142952, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7479248046875 GB
    Memory Allocated: 15.807296752929688  GigaBytes
Max Memory Allocated: 15.951599597930908  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7479248046875 GB
    Memory Allocated: 0.1025242805480957  GigaBytes
Max Memory Allocated: 15.951599597930908  GigaBytes

torch.Size([161072, 128])
torch.Size([143466, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.4686279296875 GB
    Memory Allocated: 15.883042335510254  GigaBytes
Max Memory Allocated: 15.951599597930908  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.4686279296875 GB
    Memory Allocated: 0.10277366638183594  GigaBytes
Max Memory Allocated: 15.951599597930908  GigaBytes

torch.Size([161006, 128])
torch.Size([142983, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.4783935546875 GB
    Memory Allocated: 15.808612823486328  GigaBytes
Max Memory Allocated: 15.951599597930908  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.4783935546875 GB
    Memory Allocated: 0.10217618942260742  GigaBytes
Max Memory Allocated: 15.951599597930908  GigaBytes

torch.Size([160618, 128])
torch.Size([142485, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.4783935546875 GB
    Memory Allocated: 15.749028205871582  GigaBytes
Max Memory Allocated: 15.951599597930908  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.4783935546875 GB
    Memory Allocated: 0.10248899459838867  GigaBytes
Max Memory Allocated: 15.951599597930908  GigaBytes

torch.Size([161004, 128])
torch.Size([143016, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.4783935546875 GB
    Memory Allocated: 15.800685405731201  GigaBytes
Max Memory Allocated: 15.951599597930908  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.4783935546875 GB
    Memory Allocated: 0.10222101211547852  GigaBytes
Max Memory Allocated: 15.951599597930908  GigaBytes

torch.Size([160748, 128])
torch.Size([142337, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.4783935546875 GB
    Memory Allocated: 15.762042045593262  GigaBytes
Max Memory Allocated: 15.951599597930908  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.4783935546875 GB
    Memory Allocated: 0.10192298889160156  GigaBytes
Max Memory Allocated: 15.951599597930908  GigaBytes

torch.Size([160914, 128])
torch.Size([142778, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.4783935546875 GB
    Memory Allocated: 15.81069564819336  GigaBytes
Max Memory Allocated: 15.951599597930908  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03883552551269531 |0.021943241357803345 |0.4428461492061615 |0.00010824203491210938 |0.8925523459911346 |0.005259275436401367 |
----------------------------------------------------------pseudo_mini_loss sum 3.8022782802581787
Total (block generation + training)time/epoch 32.96557855606079
Training time/epoch 11.190386295318604
Training time without block to device /epoch 11.014840364456177
Training time without total dataloading part /epoch 10.689313173294067
load block tensor time/epoch 0.3106842041015625
block to device time/epoch 0.17554593086242676
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3019859
Number of first layer input nodes during this epoch:  1287292
