Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648467067.7456832
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.028058290481567383
range selection method range initialization spend 0.013446569442749023
time for parepare:  0.018279314041137695
local_output_nid generation:  0.005416154861450195
local_in_edges_tensor generation:  0.0065135955810546875
mini_batch_src_global generation:  0.0075914859771728516
r_  generation:  0.09049701690673828
local_output_nid generation:  0.0060956478118896484
local_in_edges_tensor generation:  0.003120899200439453
mini_batch_src_global generation:  0.009550333023071289
r_  generation:  0.09511280059814453
local_output_nid generation:  0.0062558650970458984
local_in_edges_tensor generation:  0.003242969512939453
mini_batch_src_global generation:  0.007561922073364258
r_  generation:  0.09971356391906738
local_output_nid generation:  0.006151676177978516
local_in_edges_tensor generation:  0.003145933151245117
mini_batch_src_global generation:  0.008331775665283203
r_  generation:  0.10251402854919434
----------------------check_connections_block total spend ----------------------------- 0.5569322109222412
generate_one_block  0.11498904228210449
generate_one_block  0.11450624465942383
generate_one_block  0.11597919464111328
generate_one_block  0.11725187301635742
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04621410369873047
gen group dst list time:  0.011860132217407227
time for parepare:  0.019015789031982422
local_output_nid generation:  0.015254974365234375
local_in_edges_tensor generation:  0.03756594657897949
mini_batch_src_global generation:  0.044326066970825195
r_  generation:  0.462369441986084
local_output_nid generation:  0.022531509399414062
local_in_edges_tensor generation:  0.0436093807220459
mini_batch_src_global generation:  0.05607962608337402
r_  generation:  0.47267580032348633
local_output_nid generation:  0.023236751556396484
local_in_edges_tensor generation:  0.04076027870178223
mini_batch_src_global generation:  0.06250882148742676
r_  generation:  0.4848017692565918
local_output_nid generation:  0.023815631866455078
local_in_edges_tensor generation:  0.028070688247680664
mini_batch_src_global generation:  0.06043100357055664
r_  generation:  0.48986387252807617
----------------------check_connections_block total spend ----------------------------- 2.7941925525665283
generate_one_block  0.6641895771026611
generate_one_block  0.6326727867126465
generate_one_block  0.634807825088501
generate_one_block  0.6333997249603271
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03291606903076172
gen group dst list time:  0.021402835845947266
time for parepare:  0.01876664161682129
local_output_nid generation:  0.02455878257751465
local_in_edges_tensor generation:  0.037636518478393555
mini_batch_src_global generation:  0.044611215591430664
r_  generation:  0.4950063228607178
local_output_nid generation:  0.033188581466674805
local_in_edges_tensor generation:  0.04554486274719238
mini_batch_src_global generation:  0.05682778358459473
r_  generation:  0.5039467811584473
local_output_nid generation:  0.03430438041687012
local_in_edges_tensor generation:  0.04201483726501465
mini_batch_src_global generation:  0.05977010726928711
r_  generation:  0.5111994743347168
local_output_nid generation:  0.034776926040649414
local_in_edges_tensor generation:  0.04854583740234375
mini_batch_src_global generation:  0.056014299392700195
r_  generation:  0.5125658512115479
----------------------check_connections_block total spend ----------------------------- 2.9988937377929688
generate_one_block  0.629561185836792
generate_one_block  0.6416745185852051
generate_one_block  0.6515722274780273
generate_one_block  0.663677453994751
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

connection checking time:  5.793086290359497
block generation total time  5.151555299758911
average batch blocks generation time:  1.2878888249397278
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2030029296875 GB
    Memory Allocated: 0.10471057891845703  GigaBytes
Max Memory Allocated: 0.10471057891845703  GigaBytes

torch.Size([165560, 128])
torch.Size([157314, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4666748046875 GB
    Memory Allocated: 15.136948108673096  GigaBytes
Max Memory Allocated: 15.165452003479004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0487060546875 GB
    Memory Allocated: 0.10889196395874023  GigaBytes
Max Memory Allocated: 15.165452003479004  GigaBytes

torch.Size([165460, 128])
torch.Size([157142, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7889404296875 GB
    Memory Allocated: 15.12168836593628  GigaBytes
Max Memory Allocated: 15.165452003479004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7889404296875 GB
    Memory Allocated: 0.10895490646362305  GigaBytes
Max Memory Allocated: 15.165452003479004  GigaBytes

torch.Size([165550, 128])
torch.Size([157486, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7967529296875 GB
    Memory Allocated: 15.160891056060791  GigaBytes
Max Memory Allocated: 15.192565441131592  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7967529296875 GB
    Memory Allocated: 0.10888004302978516  GigaBytes
Max Memory Allocated: 15.192565441131592  GigaBytes

torch.Size([165327, 128])
torch.Size([157259, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8006591796875 GB
    Memory Allocated: 15.162295818328857  GigaBytes
Max Memory Allocated: 15.194478511810303  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.042586684226989746 |0.10496854782104492 |0.7738189101219177 |0.00013977289199829102 |0.9131330251693726 |0.00997471809387207 |
----------------------------------------------------------pseudo_mini_loss sum 4.389122009277344
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1720511
Number of first layer input nodes during this epoch:  661897
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 17.8006591796875 GB
    Memory Allocated: 0.1518540382385254  GigaBytes
Max Memory Allocated: 15.194478511810303  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.031762123107910156
range selection method range initialization spend 0.012893438339233398
time for parepare:  0.0174105167388916
local_output_nid generation:  0.00534820556640625
local_in_edges_tensor generation:  0.010178327560424805
mini_batch_src_global generation:  0.007753133773803711
r_  generation:  0.08953309059143066
local_output_nid generation:  0.006152153015136719
local_in_edges_tensor generation:  0.0055539608001708984
mini_batch_src_global generation:  0.009792804718017578
r_  generation:  0.0957787036895752
local_output_nid generation:  0.006155729293823242
local_in_edges_tensor generation:  0.003332853317260742
mini_batch_src_global generation:  0.007806062698364258
r_  generation:  0.10370826721191406
local_output_nid generation:  0.0062487125396728516
local_in_edges_tensor generation:  0.003284454345703125
mini_batch_src_global generation:  0.008518218994140625
r_  generation:  0.10535049438476562
----------------------check_connections_block total spend ----------------------------- 0.5713052749633789
generate_one_block  0.13568830490112305
generate_one_block  0.13129520416259766
generate_one_block  0.13317012786865234
generate_one_block  0.13452506065368652
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.042469024658203125
gen group dst list time:  0.011870384216308594
time for parepare:  0.019691944122314453
local_output_nid generation:  0.014880180358886719
local_in_edges_tensor generation:  0.03819441795349121
mini_batch_src_global generation:  0.04650735855102539
r_  generation:  0.4707202911376953
local_output_nid generation:  0.022225618362426758
local_in_edges_tensor generation:  0.04302334785461426
mini_batch_src_global generation:  0.05616164207458496
r_  generation:  0.48125529289245605
local_output_nid generation:  0.023314476013183594
local_in_edges_tensor generation:  0.03550362586975098
mini_batch_src_global generation:  0.05616593360900879
r_  generation:  0.4911215305328369
local_output_nid generation:  0.02377915382385254
local_in_edges_tensor generation:  0.031297922134399414
mini_batch_src_global generation:  0.06339025497436523
r_  generation:  0.4946117401123047
----------------------check_connections_block total spend ----------------------------- 2.8259618282318115
generate_one_block  0.6891555786132812
generate_one_block  0.6732017993927002
generate_one_block  0.7024252414703369
generate_one_block  0.7493600845336914
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.045104265213012695
gen group dst list time:  0.02570819854736328
time for parepare:  0.01957869529724121
local_output_nid generation:  0.0247189998626709
local_in_edges_tensor generation:  0.05012321472167969
mini_batch_src_global generation:  0.04889535903930664
r_  generation:  0.5120232105255127
local_output_nid generation:  0.03779292106628418
local_in_edges_tensor generation:  0.05036139488220215
mini_batch_src_global generation:  0.056665658950805664
r_  generation:  0.5159716606140137
local_output_nid generation:  0.0350337028503418
local_in_edges_tensor generation:  0.05307888984680176
mini_batch_src_global generation:  0.059652090072631836
r_  generation:  0.5295231342315674
local_output_nid generation:  0.03822016716003418
local_in_edges_tensor generation:  0.045606374740600586
mini_batch_src_global generation:  0.058432817459106445
r_  generation:  0.5093462467193604
----------------------check_connections_block total spend ----------------------------- 3.111729383468628
generate_one_block  0.6985046863555908
generate_one_block  0.6772186756134033
generate_one_block  0.6747393608093262
generate_one_block  0.6893246173858643
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.8006591796875 GB
    Memory Allocated: 0.1518540382385254  GigaBytes
Max Memory Allocated: 15.194478511810303  GigaBytes

connection checking time:  5.9376912117004395
block generation total time  5.553930044174194
average batch blocks generation time:  1.3884825110435486
block dataloader generation time/epoch 13.71261715888977
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8006591796875 GB
    Memory Allocated: 0.1102151870727539  GigaBytes
Max Memory Allocated: 15.194478511810303  GigaBytes

torch.Size([165661, 128])
torch.Size([157499, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8006591796875 GB
    Memory Allocated: 15.154694080352783  GigaBytes
Max Memory Allocated: 15.194478511810303  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8006591796875 GB
    Memory Allocated: 0.11007881164550781  GigaBytes
Max Memory Allocated: 15.194478511810303  GigaBytes

torch.Size([165401, 128])
torch.Size([157337, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8006591796875 GB
    Memory Allocated: 15.128800868988037  GigaBytes
Max Memory Allocated: 15.194478511810303  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8006591796875 GB
    Memory Allocated: 0.11021614074707031  GigaBytes
Max Memory Allocated: 15.194478511810303  GigaBytes

torch.Size([165621, 128])
torch.Size([157601, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8006591796875 GB
    Memory Allocated: 15.163146495819092  GigaBytes
Max Memory Allocated: 15.195104598999023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8006591796875 GB
    Memory Allocated: 0.11022233963012695  GigaBytes
Max Memory Allocated: 15.195104598999023  GigaBytes

torch.Size([165622, 128])
torch.Size([157564, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8045654296875 GB
    Memory Allocated: 15.173031330108643  GigaBytes
Max Memory Allocated: 15.20508861541748  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04070448875427246 |0.027005553245544434 |0.5781747698783875 |0.00011736154556274414 |0.9120365977287292 |0.008059263229370117 |
----------------------------------------------------------pseudo_mini_loss sum 3.7054591178894043
Total (block generation + training)time/epoch 19.974540948867798
Training time/epoch 6.261654376983643
Training time without block to device /epoch 6.153632164001465
Training time without total dataloading part /epoch 5.969374179840088
load block tensor time/epoch 0.16281795501708984
block to device time/epoch 0.10802221298217773
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  1722536
Number of first layer input nodes during this epoch:  662305
