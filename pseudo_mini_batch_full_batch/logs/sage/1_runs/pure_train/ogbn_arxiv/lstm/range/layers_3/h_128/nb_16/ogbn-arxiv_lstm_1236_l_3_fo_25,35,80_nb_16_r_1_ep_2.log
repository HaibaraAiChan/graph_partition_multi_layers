Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648472790.864558
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017633438110351562  GigaBytes
Max Memory Allocated: 0.0017633438110351562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027102947235107422
range selection method range initialization spend 0.013100862503051758
time for parepare:  0.018107891082763672
local_output_nid generation:  0.0013358592987060547
local_in_edges_tensor generation:  0.004091024398803711
mini_batch_src_global generation:  0.00193023681640625
r_  generation:  0.01955437660217285
local_output_nid generation:  0.0014352798461914062
local_in_edges_tensor generation:  0.0009200572967529297
mini_batch_src_global generation:  0.0023801326751708984
r_  generation:  0.019650936126708984
local_output_nid generation:  0.0014607906341552734
local_in_edges_tensor generation:  0.0009195804595947266
mini_batch_src_global generation:  0.0015294551849365234
r_  generation:  0.020944833755493164
local_output_nid generation:  0.0015411376953125
local_in_edges_tensor generation:  0.0009546279907226562
mini_batch_src_global generation:  0.0015556812286376953
r_  generation:  0.02036452293395996
local_output_nid generation:  0.001562356948852539
local_in_edges_tensor generation:  0.0008802413940429688
mini_batch_src_global generation:  0.001508474349975586
r_  generation:  0.02016472816467285
local_output_nid generation:  0.0015058517456054688
local_in_edges_tensor generation:  0.000865936279296875
mini_batch_src_global generation:  0.0016016960144042969
r_  generation:  0.020314455032348633
local_output_nid generation:  0.001499176025390625
local_in_edges_tensor generation:  0.0008628368377685547
mini_batch_src_global generation:  0.001554250717163086
r_  generation:  0.020853757858276367
local_output_nid generation:  0.0014824867248535156
local_in_edges_tensor generation:  0.0008802413940429688
mini_batch_src_global generation:  0.0016314983367919922
r_  generation:  0.020719528198242188
local_output_nid generation:  0.0014929771423339844
local_in_edges_tensor generation:  0.0008859634399414062
mini_batch_src_global generation:  0.0015919208526611328
r_  generation:  0.02148580551147461
local_output_nid generation:  0.00152587890625
local_in_edges_tensor generation:  0.0008707046508789062
mini_batch_src_global generation:  0.0016474723815917969
r_  generation:  0.021204710006713867
local_output_nid generation:  0.0015027523040771484
local_in_edges_tensor generation:  0.0008916854858398438
mini_batch_src_global generation:  0.0017743110656738281
r_  generation:  0.0219423770904541
local_output_nid generation:  0.0015108585357666016
local_in_edges_tensor generation:  0.0008742809295654297
mini_batch_src_global generation:  0.0017287731170654297
r_  generation:  0.02158212661743164
local_output_nid generation:  0.001506805419921875
local_in_edges_tensor generation:  0.0008749961853027344
mini_batch_src_global generation:  0.0017693042755126953
r_  generation:  0.02139592170715332
local_output_nid generation:  0.0015184879302978516
local_in_edges_tensor generation:  0.0008764266967773438
mini_batch_src_global generation:  0.0017032623291015625
r_  generation:  0.021127700805664062
local_output_nid generation:  0.001506805419921875
local_in_edges_tensor generation:  0.0008757114410400391
mini_batch_src_global generation:  0.0016634464263916016
r_  generation:  0.02109694480895996
local_output_nid generation:  0.001524209976196289
local_in_edges_tensor generation:  0.00086212158203125
mini_batch_src_global generation:  0.0017032623291015625
r_  generation:  0.02137923240661621
----------------------check_connections_block total spend ----------------------------- 0.49458765983581543
generate_one_block  0.029834508895874023
generate_one_block  0.031250715255737305
generate_one_block  0.034133195877075195
generate_one_block  0.03166484832763672
generate_one_block  0.030979156494140625
generate_one_block  0.030341386795043945
generate_one_block  0.03138875961303711
generate_one_block  0.031078338623046875
generate_one_block  0.03131723403930664
generate_one_block  0.031097888946533203
generate_one_block  0.03180551528930664
generate_one_block  0.03136181831359863
generate_one_block  0.031058311462402344
generate_one_block  0.03114008903503418
generate_one_block  0.03072381019592285
generate_one_block  0.0313105583190918
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0404813289642334
gen group dst list time:  0.020540952682495117
time for parepare:  0.019275665283203125
local_output_nid generation:  0.007429838180541992
local_in_edges_tensor generation:  0.016646862030029297
mini_batch_src_global generation:  0.02094864845275879
r_  generation:  0.2155604362487793
local_output_nid generation:  0.011055469512939453
local_in_edges_tensor generation:  0.020725488662719727
mini_batch_src_global generation:  0.02871561050415039
r_  generation:  0.22887516021728516
local_output_nid generation:  0.011653423309326172
local_in_edges_tensor generation:  0.019817590713500977
mini_batch_src_global generation:  0.027036190032958984
r_  generation:  0.2405719757080078
local_output_nid generation:  0.011924266815185547
local_in_edges_tensor generation:  0.015869140625
mini_batch_src_global generation:  0.027766704559326172
r_  generation:  0.23750710487365723
local_output_nid generation:  0.011834144592285156
local_in_edges_tensor generation:  0.013641595840454102
mini_batch_src_global generation:  0.031180381774902344
r_  generation:  0.24071550369262695
local_output_nid generation:  0.012076377868652344
local_in_edges_tensor generation:  0.020577430725097656
mini_batch_src_global generation:  0.03025650978088379
r_  generation:  0.25200891494750977
local_output_nid generation:  0.015453815460205078
local_in_edges_tensor generation:  0.0331728458404541
mini_batch_src_global generation:  0.028924942016601562
r_  generation:  0.23692536354064941
local_output_nid generation:  0.012619733810424805
local_in_edges_tensor generation:  0.016774892807006836
mini_batch_src_global generation:  0.02896571159362793
r_  generation:  0.23376703262329102
local_output_nid generation:  0.012675762176513672
local_in_edges_tensor generation:  0.016876697540283203
mini_batch_src_global generation:  0.029308319091796875
r_  generation:  0.23573660850524902
local_output_nid generation:  0.012597084045410156
local_in_edges_tensor generation:  0.013067007064819336
mini_batch_src_global generation:  0.02888178825378418
r_  generation:  0.2321920394897461
local_output_nid generation:  0.013128995895385742
local_in_edges_tensor generation:  0.014635562896728516
mini_batch_src_global generation:  0.02924346923828125
r_  generation:  0.2414414882659912
local_output_nid generation:  0.012843847274780273
local_in_edges_tensor generation:  0.019071102142333984
mini_batch_src_global generation:  0.028907299041748047
r_  generation:  0.23772287368774414
local_output_nid generation:  0.012749910354614258
local_in_edges_tensor generation:  0.014815568923950195
mini_batch_src_global generation:  0.0289156436920166
r_  generation:  0.23545241355895996
local_output_nid generation:  0.012665748596191406
local_in_edges_tensor generation:  0.013634920120239258
mini_batch_src_global generation:  0.02896571159362793
r_  generation:  0.23412251472473145
local_output_nid generation:  0.01279592514038086
local_in_edges_tensor generation:  0.014249801635742188
mini_batch_src_global generation:  0.02912116050720215
r_  generation:  0.23175573348999023
local_output_nid generation:  0.01288294792175293
local_in_edges_tensor generation:  0.01442408561706543
mini_batch_src_global generation:  0.028856992721557617
r_  generation:  0.23235630989074707
----------------------check_connections_block total spend ----------------------------- 5.587812423706055
generate_one_block  0.3081820011138916
generate_one_block  0.32660984992980957
generate_one_block  0.3268704414367676
generate_one_block  0.3318469524383545
generate_one_block  0.3422994613647461
generate_one_block  0.2999000549316406
generate_one_block  0.3068239688873291
generate_one_block  0.30512475967407227
generate_one_block  0.3116016387939453
generate_one_block  0.31090664863586426
generate_one_block  0.3155953884124756
generate_one_block  0.3088846206665039
generate_one_block  0.3044281005859375
generate_one_block  0.2991766929626465
generate_one_block  0.30595827102661133
generate_one_block  0.30507802963256836
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04535508155822754
gen group dst list time:  0.06158161163330078
time for parepare:  0.021437644958496094
local_output_nid generation:  0.024625539779663086
local_in_edges_tensor generation:  0.05223894119262695
mini_batch_src_global generation:  0.044837236404418945
r_  generation:  0.45110511779785156
local_output_nid generation:  0.030651092529296875
local_in_edges_tensor generation:  0.046445369720458984
mini_batch_src_global generation:  0.0517427921295166
r_  generation:  0.45249271392822266
local_output_nid generation:  0.030429363250732422
local_in_edges_tensor generation:  0.05274677276611328
mini_batch_src_global generation:  0.05140280723571777
r_  generation:  0.4618492126464844
local_output_nid generation:  0.03151297569274902
local_in_edges_tensor generation:  0.03612017631530762
mini_batch_src_global generation:  0.05215334892272949
r_  generation:  0.47204113006591797
local_output_nid generation:  0.034009695053100586
local_in_edges_tensor generation:  0.04481387138366699
mini_batch_src_global generation:  0.053381919860839844
r_  generation:  0.4547407627105713
local_output_nid generation:  0.03198885917663574
local_in_edges_tensor generation:  0.03724527359008789
mini_batch_src_global generation:  0.05265212059020996
r_  generation:  0.4564955234527588
local_output_nid generation:  0.0324859619140625
local_in_edges_tensor generation:  0.038930416107177734
mini_batch_src_global generation:  0.05289435386657715
r_  generation:  0.4739396572113037
local_output_nid generation:  0.03236222267150879
local_in_edges_tensor generation:  0.03551912307739258
mini_batch_src_global generation:  0.05394911766052246
r_  generation:  0.462632417678833
local_output_nid generation:  0.03296613693237305
local_in_edges_tensor generation:  0.03264141082763672
mini_batch_src_global generation:  0.05344033241271973
r_  generation:  0.4620957374572754
local_output_nid generation:  0.03232741355895996
local_in_edges_tensor generation:  0.03267979621887207
mini_batch_src_global generation:  0.05618119239807129
r_  generation:  0.46166443824768066
local_output_nid generation:  0.03358268737792969
local_in_edges_tensor generation:  0.05138516426086426
mini_batch_src_global generation:  0.05347251892089844
r_  generation:  0.4660046100616455
local_output_nid generation:  0.03246426582336426
local_in_edges_tensor generation:  0.0413966178894043
mini_batch_src_global generation:  0.05323457717895508
r_  generation:  0.4580390453338623
local_output_nid generation:  0.032512664794921875
local_in_edges_tensor generation:  0.03947091102600098
mini_batch_src_global generation:  0.07565116882324219
r_  generation:  0.46494388580322266
local_output_nid generation:  0.03350377082824707
local_in_edges_tensor generation:  0.03446149826049805
mini_batch_src_global generation:  0.05339956283569336
r_  generation:  0.45893383026123047
local_output_nid generation:  0.03264474868774414
local_in_edges_tensor generation:  0.0323331356048584
mini_batch_src_global generation:  0.052263736724853516
r_  generation:  0.4699242115020752
local_output_nid generation:  0.03260660171508789
local_in_edges_tensor generation:  0.03785896301269531
mini_batch_src_global generation:  0.05316424369812012
r_  generation:  0.46007704734802246
----------------------check_connections_block total spend ----------------------------- 11.034131288528442
generate_one_block  0.6017208099365234
generate_one_block  0.5932810306549072
generate_one_block  0.6039979457855225
generate_one_block  0.58890700340271
generate_one_block  0.5775787830352783
generate_one_block  0.6098318099975586
generate_one_block  0.6406500339508057
generate_one_block  0.595106840133667
generate_one_block  0.5896642208099365
generate_one_block  0.5820319652557373
generate_one_block  0.6035768985748291
generate_one_block  0.598261833190918
generate_one_block  0.5999398231506348
generate_one_block  0.5802652835845947
generate_one_block  0.5913994312286377
generate_one_block  0.594743013381958
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017633438110351562  GigaBytes
Max Memory Allocated: 0.0017633438110351562  GigaBytes

connection checking time:  16.621943712234497
block generation total time  14.560243606567383
average batch blocks generation time:  0.9100152254104614
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.09233903884887695  GigaBytes
Max Memory Allocated: 0.09233903884887695  GigaBytes

torch.Size([155081, 128])
torch.Size([124635, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2655029296875 GB
    Memory Allocated: 16.66232442855835  GigaBytes
Max Memory Allocated: 16.694825172424316  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.9530029296875 GB
    Memory Allocated: 0.09467887878417969  GigaBytes
Max Memory Allocated: 16.694825172424316  GigaBytes

torch.Size([154948, 128])
torch.Size([124812, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 16.706429958343506  GigaBytes
Max Memory Allocated: 16.740590572357178  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.09528112411499023  GigaBytes
Max Memory Allocated: 16.740590572357178  GigaBytes

torch.Size([155655, 128])
torch.Size([126271, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4080810546875 GB
    Memory Allocated: 16.95343828201294  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4080810546875 GB
    Memory Allocated: 0.09508609771728516  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

torch.Size([155097, 128])
torch.Size([125085, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4080810546875 GB
    Memory Allocated: 16.773250579833984  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4080810546875 GB
    Memory Allocated: 0.09454107284545898  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

torch.Size([154721, 128])
torch.Size([123980, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4080810546875 GB
    Memory Allocated: 16.661237716674805  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4080810546875 GB
    Memory Allocated: 0.0949716567993164  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

torch.Size([155031, 128])
torch.Size([124987, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4080810546875 GB
    Memory Allocated: 16.654951095581055  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4080810546875 GB
    Memory Allocated: 0.09491634368896484  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

torch.Size([155434, 128])
torch.Size([125496, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4080810546875 GB
    Memory Allocated: 16.69371461868286  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4080810546875 GB
    Memory Allocated: 0.09501457214355469  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

torch.Size([154861, 128])
torch.Size([125033, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4080810546875 GB
    Memory Allocated: 16.704861640930176  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4080810546875 GB
    Memory Allocated: 0.09465408325195312  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

torch.Size([154766, 128])
torch.Size([124687, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4080810546875 GB
    Memory Allocated: 16.74754762649536  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4080810546875 GB
    Memory Allocated: 0.09495258331298828  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

torch.Size([154995, 128])
torch.Size([124523, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4490966796875 GB
    Memory Allocated: 16.63176441192627  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4490966796875 GB
    Memory Allocated: 0.09506940841674805  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

torch.Size([155423, 128])
torch.Size([125892, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4490966796875 GB
    Memory Allocated: 16.86759328842163  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4490966796875 GB
    Memory Allocated: 0.09511184692382812  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

torch.Size([154927, 128])
torch.Size([125379, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5037841796875 GB
    Memory Allocated: 16.795084476470947  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5037841796875 GB
    Memory Allocated: 0.09484481811523438  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

torch.Size([155170, 128])
torch.Size([125209, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5037841796875 GB
    Memory Allocated: 16.760375499725342  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5037841796875 GB
    Memory Allocated: 0.09496593475341797  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

torch.Size([154590, 128])
torch.Size([124211, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5037841796875 GB
    Memory Allocated: 16.63656759262085  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5037841796875 GB
    Memory Allocated: 0.09456777572631836  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

torch.Size([154839, 128])
torch.Size([124534, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5037841796875 GB
    Memory Allocated: 16.661109924316406  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5037841796875 GB
    Memory Allocated: 0.0949850082397461  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

torch.Size([154869, 128])
torch.Size([124879, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5037841796875 GB
    Memory Allocated: 16.668004989624023  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.035657599568367004 |0.04183122515678406 |0.47485676407814026 |0.00011087954044342041 |0.7792162448167801 |0.01056814193725586 |
----------------------------------------------------------pseudo_mini_loss sum 4.9953837394714355
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5211178
Number of first layer input nodes during this epoch:  2480407
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.5037841796875 GB
    Memory Allocated: 0.12247848510742188  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0243222713470459
range selection method range initialization spend 0.012782096862792969
time for parepare:  0.017428874969482422
local_output_nid generation:  0.001821756362915039
local_in_edges_tensor generation:  0.004166841506958008
mini_batch_src_global generation:  0.002057313919067383
r_  generation:  0.020429372787475586
local_output_nid generation:  0.001863241195678711
local_in_edges_tensor generation:  0.001058816909790039
mini_batch_src_global generation:  0.0024187564849853516
r_  generation:  0.02103877067565918
local_output_nid generation:  0.0017900466918945312
local_in_edges_tensor generation:  0.0009760856628417969
mini_batch_src_global generation:  0.0015747547149658203
r_  generation:  0.02172565460205078
local_output_nid generation:  0.0018053054809570312
local_in_edges_tensor generation:  0.0009667873382568359
mini_batch_src_global generation:  0.0016510486602783203
r_  generation:  0.02057957649230957
local_output_nid generation:  0.0017688274383544922
local_in_edges_tensor generation:  0.0009698867797851562
mini_batch_src_global generation:  0.0015938282012939453
r_  generation:  0.021552562713623047
local_output_nid generation:  0.0017933845520019531
local_in_edges_tensor generation:  0.0009667873382568359
mini_batch_src_global generation:  0.0016460418701171875
r_  generation:  0.021303415298461914
local_output_nid generation:  0.0017244815826416016
local_in_edges_tensor generation:  0.0009577274322509766
mini_batch_src_global generation:  0.0016682147979736328
r_  generation:  0.021574020385742188
local_output_nid generation:  0.0017600059509277344
local_in_edges_tensor generation:  0.0009205341339111328
mini_batch_src_global generation:  0.001741647720336914
r_  generation:  0.022605180740356445
local_output_nid generation:  0.0017547607421875
local_in_edges_tensor generation:  0.000926971435546875
mini_batch_src_global generation:  0.0017082691192626953
r_  generation:  0.022555112838745117
local_output_nid generation:  0.0017452239990234375
local_in_edges_tensor generation:  0.0009937286376953125
mini_batch_src_global generation:  0.0017142295837402344
r_  generation:  0.022072315216064453
local_output_nid generation:  0.001767873764038086
local_in_edges_tensor generation:  0.0008914470672607422
mini_batch_src_global generation:  0.001737356185913086
r_  generation:  0.021918535232543945
local_output_nid generation:  0.0017349720001220703
local_in_edges_tensor generation:  0.0009253025054931641
mini_batch_src_global generation:  0.0017864704132080078
r_  generation:  0.02226424217224121
local_output_nid generation:  0.0017826557159423828
local_in_edges_tensor generation:  0.0009076595306396484
mini_batch_src_global generation:  0.0017447471618652344
r_  generation:  0.022457122802734375
local_output_nid generation:  0.0017139911651611328
local_in_edges_tensor generation:  0.0009083747863769531
mini_batch_src_global generation:  0.0017616748809814453
r_  generation:  0.022517681121826172
local_output_nid generation:  0.001737356185913086
local_in_edges_tensor generation:  0.0009357929229736328
mini_batch_src_global generation:  0.0018241405487060547
r_  generation:  0.022625207901000977
local_output_nid generation:  0.0018258094787597656
local_in_edges_tensor generation:  0.0009229183197021484
mini_batch_src_global generation:  0.0017905235290527344
r_  generation:  0.022649526596069336
----------------------check_connections_block total spend ----------------------------- 0.519813060760498
generate_one_block  0.043733835220336914
generate_one_block  0.03636050224304199
generate_one_block  0.03848743438720703
generate_one_block  0.03624463081359863
generate_one_block  0.03664040565490723
generate_one_block  0.03788638114929199
generate_one_block  0.03647041320800781
generate_one_block  0.03749847412109375
generate_one_block  0.037526845932006836
generate_one_block  0.037161827087402344
generate_one_block  0.036054134368896484
generate_one_block  0.04290008544921875
generate_one_block  0.037798404693603516
generate_one_block  0.03724503517150879
generate_one_block  0.03792238235473633
generate_one_block  0.03737664222717285
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.037119150161743164
gen group dst list time:  0.019660234451293945
time for parepare:  0.020023345947265625
local_output_nid generation:  0.008978128433227539
local_in_edges_tensor generation:  0.01780843734741211
mini_batch_src_global generation:  0.021096467971801758
r_  generation:  0.21967458724975586
local_output_nid generation:  0.01198577880859375
local_in_edges_tensor generation:  0.02454233169555664
mini_batch_src_global generation:  0.028756380081176758
r_  generation:  0.2281036376953125
local_output_nid generation:  0.01359868049621582
local_in_edges_tensor generation:  0.020635366439819336
mini_batch_src_global generation:  0.0279080867767334
r_  generation:  0.2443540096282959
local_output_nid generation:  0.014562368392944336
local_in_edges_tensor generation:  0.01897573471069336
mini_batch_src_global generation:  0.027753829956054688
r_  generation:  0.2281782627105713
local_output_nid generation:  0.013406753540039062
local_in_edges_tensor generation:  0.01836848258972168
mini_batch_src_global generation:  0.028626203536987305
r_  generation:  0.23374462127685547
local_output_nid generation:  0.013039350509643555
local_in_edges_tensor generation:  0.016934871673583984
mini_batch_src_global generation:  0.0285947322845459
r_  generation:  0.2290194034576416
local_output_nid generation:  0.013098478317260742
local_in_edges_tensor generation:  0.01736736297607422
mini_batch_src_global generation:  0.028712749481201172
r_  generation:  0.23180294036865234
local_output_nid generation:  0.013458251953125
local_in_edges_tensor generation:  0.018198490142822266
mini_batch_src_global generation:  0.02921915054321289
r_  generation:  0.23776626586914062
local_output_nid generation:  0.013567924499511719
local_in_edges_tensor generation:  0.015943527221679688
mini_batch_src_global generation:  0.029471874237060547
r_  generation:  0.23653674125671387
local_output_nid generation:  0.013453483581542969
local_in_edges_tensor generation:  0.015505790710449219
mini_batch_src_global generation:  0.029324769973754883
r_  generation:  0.23649048805236816
local_output_nid generation:  0.013342142105102539
local_in_edges_tensor generation:  0.01362156867980957
mini_batch_src_global generation:  0.02951812744140625
r_  generation:  0.23289847373962402
local_output_nid generation:  0.013521194458007812
local_in_edges_tensor generation:  0.01716446876525879
mini_batch_src_global generation:  0.02905130386352539
r_  generation:  0.2350611686706543
local_output_nid generation:  0.013589859008789062
local_in_edges_tensor generation:  0.018170595169067383
mini_batch_src_global generation:  0.029827356338500977
r_  generation:  0.24040937423706055
local_output_nid generation:  0.013726472854614258
local_in_edges_tensor generation:  0.01828932762145996
mini_batch_src_global generation:  0.03222036361694336
r_  generation:  0.23694825172424316
local_output_nid generation:  0.01375889778137207
local_in_edges_tensor generation:  0.015692710876464844
mini_batch_src_global generation:  0.033901214599609375
r_  generation:  0.24080228805541992
local_output_nid generation:  0.013395547866821289
local_in_edges_tensor generation:  0.014291524887084961
mini_batch_src_global generation:  0.031949520111083984
r_  generation:  0.23979687690734863
----------------------check_connections_block total spend ----------------------------- 5.551856279373169
generate_one_block  0.3282451629638672
generate_one_block  0.31844329833984375
generate_one_block  0.3312060832977295
generate_one_block  0.31711673736572266
generate_one_block  0.3247201442718506
generate_one_block  0.3112959861755371
generate_one_block  0.3458445072174072
generate_one_block  0.32970333099365234
generate_one_block  0.3294517993927002
generate_one_block  0.3240044116973877
generate_one_block  0.31722450256347656
generate_one_block  0.32221484184265137
generate_one_block  0.3222830295562744
generate_one_block  0.3270750045776367
generate_one_block  0.32759523391723633
generate_one_block  0.3115105628967285
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04111886024475098
gen group dst list time:  0.0604701042175293
time for parepare:  0.01856064796447754
local_output_nid generation:  0.024845600128173828
local_in_edges_tensor generation:  0.05204176902770996
mini_batch_src_global generation:  0.047647714614868164
r_  generation:  0.4410057067871094
local_output_nid generation:  0.030390501022338867
local_in_edges_tensor generation:  0.04159665107727051
mini_batch_src_global generation:  0.05115652084350586
r_  generation:  0.44797325134277344
local_output_nid generation:  0.031346797943115234
local_in_edges_tensor generation:  0.03894472122192383
mini_batch_src_global generation:  0.05028796195983887
r_  generation:  0.45888423919677734
local_output_nid generation:  0.03150296211242676
local_in_edges_tensor generation:  0.03423595428466797
mini_batch_src_global generation:  0.05324673652648926
r_  generation:  0.4560112953186035
local_output_nid generation:  0.03177928924560547
local_in_edges_tensor generation:  0.07590270042419434
mini_batch_src_global generation:  0.05554938316345215
r_  generation:  0.4613456726074219
local_output_nid generation:  0.031572818756103516
local_in_edges_tensor generation:  0.030825376510620117
mini_batch_src_global generation:  0.053009986877441406
r_  generation:  0.45363616943359375
local_output_nid generation:  0.0316164493560791
local_in_edges_tensor generation:  0.030878067016601562
mini_batch_src_global generation:  0.05418825149536133
r_  generation:  0.4593641757965088
local_output_nid generation:  0.032056570053100586
local_in_edges_tensor generation:  0.03866839408874512
mini_batch_src_global generation:  0.052907466888427734
r_  generation:  0.4654998779296875
local_output_nid generation:  0.03166055679321289
local_in_edges_tensor generation:  0.03446483612060547
mini_batch_src_global generation:  0.05254006385803223
r_  generation:  0.47000885009765625
local_output_nid generation:  0.032059669494628906
local_in_edges_tensor generation:  0.03398013114929199
mini_batch_src_global generation:  0.05317950248718262
r_  generation:  0.4655027389526367
local_output_nid generation:  0.032747745513916016
local_in_edges_tensor generation:  0.033547163009643555
mini_batch_src_global generation:  0.05260920524597168
r_  generation:  0.4646573066711426
local_output_nid generation:  0.032079458236694336
local_in_edges_tensor generation:  0.03322958946228027
mini_batch_src_global generation:  0.05266380310058594
r_  generation:  0.4579436779022217
local_output_nid generation:  0.03156328201293945
local_in_edges_tensor generation:  0.04919576644897461
mini_batch_src_global generation:  0.06282639503479004
r_  generation:  0.4609527587890625
local_output_nid generation:  0.0322418212890625
local_in_edges_tensor generation:  0.03318595886230469
mini_batch_src_global generation:  0.053328752517700195
r_  generation:  0.4661214351654053
local_output_nid generation:  0.03325533866882324
local_in_edges_tensor generation:  0.035434722900390625
mini_batch_src_global generation:  0.05208754539489746
r_  generation:  0.4676699638366699
local_output_nid generation:  0.03297901153564453
local_in_edges_tensor generation:  0.030744075775146484
mini_batch_src_global generation:  0.05334067344665527
r_  generation:  0.4608304500579834
----------------------check_connections_block total spend ----------------------------- 10.957808017730713
generate_one_block  0.6088018417358398
generate_one_block  0.620297908782959
generate_one_block  0.6099214553833008
generate_one_block  0.6039144992828369
generate_one_block  0.6026198863983154
generate_one_block  0.599841833114624
generate_one_block  0.6100656986236572
generate_one_block  0.6088972091674805
generate_one_block  0.6560423374176025
generate_one_block  0.5971584320068359
generate_one_block  0.5932726860046387
generate_one_block  0.6078002452850342
generate_one_block  0.6074674129486084
generate_one_block  0.6115550994873047
generate_one_block  0.5908284187316895
generate_one_block  0.5935308933258057
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.5037841796875 GB
    Memory Allocated: 0.12247848510742188  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

connection checking time:  16.509664297103882
block generation total time  14.909950494766235
average batch blocks generation time:  0.9318719059228897
block dataloader generation time/epoch 34.06399202346802
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5037841796875 GB
    Memory Allocated: 0.09821557998657227  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

torch.Size([155050, 128])
torch.Size([125108, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5037841796875 GB
    Memory Allocated: 16.67915153503418  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5037841796875 GB
    Memory Allocated: 0.0984487533569336  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

torch.Size([154992, 128])
torch.Size([124513, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5037841796875 GB
    Memory Allocated: 16.642868041992188  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5037841796875 GB
    Memory Allocated: 0.09862899780273438  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

torch.Size([155316, 128])
torch.Size([125692, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5037841796875 GB
    Memory Allocated: 16.93750524520874  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5037841796875 GB
    Memory Allocated: 0.09847640991210938  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

torch.Size([154907, 128])
torch.Size([124587, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5037841796875 GB
    Memory Allocated: 16.642356395721436  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5037841796875 GB
    Memory Allocated: 0.09840536117553711  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

torch.Size([155379, 128])
torch.Size([125701, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5037841796875 GB
    Memory Allocated: 16.70109987258911  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5037841796875 GB
    Memory Allocated: 0.09839153289794922  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

torch.Size([154548, 128])
torch.Size([123671, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5037841796875 GB
    Memory Allocated: 16.56624174118042  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5037841796875 GB
    Memory Allocated: 0.09814119338989258  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

torch.Size([154851, 128])
torch.Size([124229, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5037841796875 GB
    Memory Allocated: 16.686172485351562  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5037841796875 GB
    Memory Allocated: 0.09871101379394531  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

torch.Size([154875, 128])
torch.Size([125209, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5037841796875 GB
    Memory Allocated: 16.86288356781006  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5037841796875 GB
    Memory Allocated: 0.09831809997558594  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

torch.Size([155030, 128])
torch.Size([125141, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5037841796875 GB
    Memory Allocated: 16.784226417541504  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5037841796875 GB
    Memory Allocated: 0.09854412078857422  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

torch.Size([155189, 128])
torch.Size([124973, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5037841796875 GB
    Memory Allocated: 16.705565929412842  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5037841796875 GB
    Memory Allocated: 0.09818506240844727  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

torch.Size([155097, 128])
torch.Size([124478, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5057373046875 GB
    Memory Allocated: 16.587955951690674  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5057373046875 GB
    Memory Allocated: 0.09851646423339844  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

torch.Size([154874, 128])
torch.Size([125007, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5057373046875 GB
    Memory Allocated: 16.673187732696533  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5057373046875 GB
    Memory Allocated: 0.09835481643676758  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

torch.Size([155167, 128])
torch.Size([125068, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5057373046875 GB
    Memory Allocated: 16.75114154815674  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5057373046875 GB
    Memory Allocated: 0.09860610961914062  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

torch.Size([155333, 128])
torch.Size([125220, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5057373046875 GB
    Memory Allocated: 16.77810287475586  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5057373046875 GB
    Memory Allocated: 0.09832239151000977  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

torch.Size([155055, 128])
torch.Size([125031, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5057373046875 GB
    Memory Allocated: 16.767155647277832  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5057373046875 GB
    Memory Allocated: 0.0984334945678711  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

torch.Size([154698, 128])
torch.Size([124088, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5057373046875 GB
    Memory Allocated: 16.59281826019287  GigaBytes
Max Memory Allocated: 16.98911190032959  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03265802562236786 |0.017349213361740112 |0.43211954832077026 |0.00010538101196289062 |0.75938780605793 |0.008405208587646484 |
----------------------------------------------------------pseudo_mini_loss sum 3.309901714324951
Total (block generation + training)time/epoch 53.972541093826294
Training time/epoch 19.90827703475952
Training time without block to device /epoch 19.63068962097168
Training time without total dataloading part /epoch 19.074208974838257
load block tensor time/epoch 0.5225284099578857
block to device time/epoch 0.2775874137878418
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5208441
Number of first layer input nodes during this epoch:  2480361
