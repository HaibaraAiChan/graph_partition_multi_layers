Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648469046.58736
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025925636291503906
range selection method range initialization spend 0.013147592544555664
time for parepare:  0.017933368682861328
local_output_nid generation:  0.0013475418090820312
local_in_edges_tensor generation:  0.0038139820098876953
mini_batch_src_global generation:  0.0017316341400146484
r_  generation:  0.017649173736572266
local_output_nid generation:  0.0014150142669677734
local_in_edges_tensor generation:  0.0009534358978271484
mini_batch_src_global generation:  0.001961231231689453
r_  generation:  0.017721891403198242
local_output_nid generation:  0.0014562606811523438
local_in_edges_tensor generation:  0.0008533000946044922
mini_batch_src_global generation:  0.0012958049774169922
r_  generation:  0.017366647720336914
local_output_nid generation:  0.0015263557434082031
local_in_edges_tensor generation:  0.0008442401885986328
mini_batch_src_global generation:  0.00133514404296875
r_  generation:  0.017465829849243164
local_output_nid generation:  0.0014989376068115234
local_in_edges_tensor generation:  0.0008249282836914062
mini_batch_src_global generation:  0.0012514591217041016
r_  generation:  0.017679929733276367
local_output_nid generation:  0.001497030258178711
local_in_edges_tensor generation:  0.0008344650268554688
mini_batch_src_global generation:  0.0014688968658447266
r_  generation:  0.018581867218017578
local_output_nid generation:  0.0014984607696533203
local_in_edges_tensor generation:  0.0008339881896972656
mini_batch_src_global generation:  0.0013804435729980469
r_  generation:  0.018131494522094727
local_output_nid generation:  0.0015549659729003906
local_in_edges_tensor generation:  0.0008535385131835938
mini_batch_src_global generation:  0.0014386177062988281
r_  generation:  0.01836991310119629
local_output_nid generation:  0.0014891624450683594
local_in_edges_tensor generation:  0.0008382797241210938
mini_batch_src_global generation:  0.0013709068298339844
r_  generation:  0.018609285354614258
local_output_nid generation:  0.0015006065368652344
local_in_edges_tensor generation:  0.0008399486541748047
mini_batch_src_global generation:  0.0014941692352294922
r_  generation:  0.018968582153320312
local_output_nid generation:  0.0015015602111816406
local_in_edges_tensor generation:  0.0008342266082763672
mini_batch_src_global generation:  0.0014531612396240234
r_  generation:  0.018713951110839844
local_output_nid generation:  0.0015053749084472656
local_in_edges_tensor generation:  0.0008199214935302734
mini_batch_src_global generation:  0.0015048980712890625
r_  generation:  0.01898646354675293
local_output_nid generation:  0.0015244483947753906
local_in_edges_tensor generation:  0.0008280277252197266
mini_batch_src_global generation:  0.0015189647674560547
r_  generation:  0.019338369369506836
local_output_nid generation:  0.0014905929565429688
local_in_edges_tensor generation:  0.0008804798126220703
mini_batch_src_global generation:  0.0014564990997314453
r_  generation:  0.018708467483520508
local_output_nid generation:  0.0015010833740234375
local_in_edges_tensor generation:  0.0008153915405273438
mini_batch_src_global generation:  0.00151824951171875
r_  generation:  0.01936030387878418
local_output_nid generation:  0.0015125274658203125
local_in_edges_tensor generation:  0.0008141994476318359
mini_batch_src_global generation:  0.0015327930450439453
r_  generation:  0.019392728805541992
----------------------check_connections_block total spend ----------------------------- 0.4433436393737793
generate_one_block  0.0268399715423584
generate_one_block  0.027791500091552734
generate_one_block  0.028278827667236328
generate_one_block  0.02754998207092285
generate_one_block  0.026996612548828125
generate_one_block  0.027927875518798828
generate_one_block  0.02719855308532715
generate_one_block  0.027146339416503906
generate_one_block  0.027060270309448242
generate_one_block  0.027538299560546875
generate_one_block  0.027643680572509766
generate_one_block  0.027322053909301758
generate_one_block  0.02790236473083496
generate_one_block  0.02730703353881836
generate_one_block  0.02765822410583496
generate_one_block  0.02800607681274414
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04008221626281738
gen group dst list time:  0.018737316131591797
time for parepare:  0.018892526626586914
local_output_nid generation:  0.00664520263671875
local_in_edges_tensor generation:  0.015299797058105469
mini_batch_src_global generation:  0.018120765686035156
r_  generation:  0.19046473503112793
local_output_nid generation:  0.010074138641357422
local_in_edges_tensor generation:  0.018341779708862305
mini_batch_src_global generation:  0.023736238479614258
r_  generation:  0.19976186752319336
local_output_nid generation:  0.010146141052246094
local_in_edges_tensor generation:  0.014268159866333008
mini_batch_src_global generation:  0.02264690399169922
r_  generation:  0.2051401138305664
local_output_nid generation:  0.010727167129516602
local_in_edges_tensor generation:  0.013672828674316406
mini_batch_src_global generation:  0.02866983413696289
r_  generation:  0.21096587181091309
local_output_nid generation:  0.010624170303344727
local_in_edges_tensor generation:  0.013680696487426758
mini_batch_src_global generation:  0.02733325958251953
r_  generation:  0.21099853515625
local_output_nid generation:  0.011044979095458984
local_in_edges_tensor generation:  0.01511073112487793
mini_batch_src_global generation:  0.025460243225097656
r_  generation:  0.2158658504486084
local_output_nid generation:  0.010925531387329102
local_in_edges_tensor generation:  0.01357126235961914
mini_batch_src_global generation:  0.025171756744384766
r_  generation:  0.22617435455322266
local_output_nid generation:  0.014044761657714844
local_in_edges_tensor generation:  0.026211261749267578
mini_batch_src_global generation:  0.030187129974365234
r_  generation:  0.20997953414916992
local_output_nid generation:  0.011657238006591797
local_in_edges_tensor generation:  0.01515650749206543
mini_batch_src_global generation:  0.025954484939575195
r_  generation:  0.2143535614013672
local_output_nid generation:  0.011695623397827148
local_in_edges_tensor generation:  0.013442754745483398
mini_batch_src_global generation:  0.025880098342895508
r_  generation:  0.2110605239868164
local_output_nid generation:  0.011679410934448242
local_in_edges_tensor generation:  0.015398025512695312
mini_batch_src_global generation:  0.025865793228149414
r_  generation:  0.21436095237731934
local_output_nid generation:  0.011626005172729492
local_in_edges_tensor generation:  0.013481616973876953
mini_batch_src_global generation:  0.025784730911254883
r_  generation:  0.21312808990478516
local_output_nid generation:  0.01172494888305664
local_in_edges_tensor generation:  0.01340484619140625
mini_batch_src_global generation:  0.027831077575683594
r_  generation:  0.21495723724365234
local_output_nid generation:  0.011702299118041992
local_in_edges_tensor generation:  0.01163172721862793
mini_batch_src_global generation:  0.026406049728393555
r_  generation:  0.21336960792541504
local_output_nid generation:  0.011873483657836914
local_in_edges_tensor generation:  0.015499591827392578
mini_batch_src_global generation:  0.028323650360107422
r_  generation:  0.21725130081176758
local_output_nid generation:  0.011804819107055664
local_in_edges_tensor generation:  0.013790130615234375
mini_batch_src_global generation:  0.02682209014892578
r_  generation:  0.21668124198913574
----------------------check_connections_block total spend ----------------------------- 4.994303464889526
generate_one_block  0.27277636528015137
generate_one_block  0.26868534088134766
generate_one_block  0.2654597759246826
generate_one_block  0.26825857162475586
generate_one_block  0.2824993133544922
generate_one_block  0.27106571197509766
generate_one_block  0.27103471755981445
generate_one_block  0.2698209285736084
generate_one_block  0.2710731029510498
generate_one_block  0.26871538162231445
generate_one_block  0.27193140983581543
generate_one_block  0.2715010643005371
generate_one_block  0.2738029956817627
generate_one_block  0.2711760997772217
generate_one_block  0.2924494743347168
generate_one_block  0.2917051315307617
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.058638811111450195
gen group dst list time:  0.06131315231323242
time for parepare:  0.020493507385253906
local_output_nid generation:  0.024073362350463867
local_in_edges_tensor generation:  0.049259185791015625
mini_batch_src_global generation:  0.0421290397644043
r_  generation:  0.4801468849182129
local_output_nid generation:  0.034035682678222656
local_in_edges_tensor generation:  0.05410170555114746
mini_batch_src_global generation:  0.051668405532836914
r_  generation:  0.44745826721191406
local_output_nid generation:  0.030579328536987305
local_in_edges_tensor generation:  0.03824305534362793
mini_batch_src_global generation:  0.05124354362487793
r_  generation:  0.452376127243042
local_output_nid generation:  0.030761241912841797
local_in_edges_tensor generation:  0.035604000091552734
mini_batch_src_global generation:  0.05167675018310547
r_  generation:  0.44956207275390625
local_output_nid generation:  0.030741453170776367
local_in_edges_tensor generation:  0.03528094291687012
mini_batch_src_global generation:  0.05150866508483887
r_  generation:  0.46034789085388184
local_output_nid generation:  0.03080129623413086
local_in_edges_tensor generation:  0.04017901420593262
mini_batch_src_global generation:  0.05619978904724121
r_  generation:  0.4526829719543457
local_output_nid generation:  0.031018733978271484
local_in_edges_tensor generation:  0.0319056510925293
mini_batch_src_global generation:  0.05148744583129883
r_  generation:  0.4590420722961426
local_output_nid generation:  0.031085729598999023
local_in_edges_tensor generation:  0.03621816635131836
mini_batch_src_global generation:  0.053223371505737305
r_  generation:  0.4733238220214844
local_output_nid generation:  0.03158378601074219
local_in_edges_tensor generation:  0.0434412956237793
mini_batch_src_global generation:  0.05498194694519043
r_  generation:  0.4660794734954834
local_output_nid generation:  0.030643701553344727
local_in_edges_tensor generation:  0.0467226505279541
mini_batch_src_global generation:  0.052324771881103516
r_  generation:  0.48142099380493164
local_output_nid generation:  0.033159732818603516
local_in_edges_tensor generation:  0.038785457611083984
mini_batch_src_global generation:  0.05656003952026367
r_  generation:  0.4598207473754883
local_output_nid generation:  0.03064894676208496
local_in_edges_tensor generation:  0.037256479263305664
mini_batch_src_global generation:  0.0525357723236084
r_  generation:  0.4565305709838867
local_output_nid generation:  0.030478477478027344
local_in_edges_tensor generation:  0.036590576171875
mini_batch_src_global generation:  0.05219578742980957
r_  generation:  0.4666905403137207
local_output_nid generation:  0.03074502944946289
local_in_edges_tensor generation:  0.027756690979003906
mini_batch_src_global generation:  0.0527348518371582
r_  generation:  0.45218896865844727
local_output_nid generation:  0.031186342239379883
local_in_edges_tensor generation:  0.04381871223449707
mini_batch_src_global generation:  0.05280590057373047
r_  generation:  0.4620242118835449
local_output_nid generation:  0.03205513954162598
local_in_edges_tensor generation:  0.03244805335998535
mini_batch_src_global generation:  0.05302023887634277
r_  generation:  0.45671582221984863
----------------------check_connections_block total spend ----------------------------- 10.95503306388855
generate_one_block  0.5978090763092041
generate_one_block  0.580009937286377
generate_one_block  0.5679328441619873
generate_one_block  0.5833332538604736
generate_one_block  0.5699713230133057
generate_one_block  0.5754990577697754
generate_one_block  0.6235685348510742
generate_one_block  0.5747604370117188
generate_one_block  0.5790810585021973
generate_one_block  0.5616142749786377
generate_one_block  0.5678386688232422
generate_one_block  0.5940051078796387
generate_one_block  0.5716674327850342
generate_one_block  0.5624191761016846
generate_one_block  0.5842435359954834
generate_one_block  0.5751979351043701
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

connection checking time:  15.949336528778076
block generation total time  13.650907039642334
average batch blocks generation time:  0.8531816899776459
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1756591796875 GB
    Memory Allocated: 0.09062910079956055  GigaBytes
Max Memory Allocated: 0.09062910079956055  GigaBytes

torch.Size([154406, 128])
torch.Size([122677, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5760498046875 GB
    Memory Allocated: 13.208198070526123  GigaBytes
Max Memory Allocated: 13.221982955932617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8846435546875 GB
    Memory Allocated: 0.09178543090820312  GigaBytes
Max Memory Allocated: 13.221982955932617  GigaBytes

torch.Size([154430, 128])
torch.Size([122769, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8846435546875 GB
    Memory Allocated: 13.22599458694458  GigaBytes
Max Memory Allocated: 13.240654945373535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8846435546875 GB
    Memory Allocated: 0.09221649169921875  GigaBytes
Max Memory Allocated: 13.240654945373535  GigaBytes

torch.Size([154420, 128])
torch.Size([122227, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8846435546875 GB
    Memory Allocated: 13.100858688354492  GigaBytes
Max Memory Allocated: 13.240654945373535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8846435546875 GB
    Memory Allocated: 0.09171533584594727  GigaBytes
Max Memory Allocated: 13.240654945373535  GigaBytes

torch.Size([154483, 128])
torch.Size([122542, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8846435546875 GB
    Memory Allocated: 13.155520915985107  GigaBytes
Max Memory Allocated: 13.240654945373535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8846435546875 GB
    Memory Allocated: 0.09226036071777344  GigaBytes
Max Memory Allocated: 13.240654945373535  GigaBytes

torch.Size([154318, 128])
torch.Size([122042, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8905029296875 GB
    Memory Allocated: 13.148394107818604  GigaBytes
Max Memory Allocated: 13.240654945373535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8905029296875 GB
    Memory Allocated: 0.091766357421875  GigaBytes
Max Memory Allocated: 13.240654945373535  GigaBytes

torch.Size([154416, 128])
torch.Size([122449, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8905029296875 GB
    Memory Allocated: 13.19257640838623  GigaBytes
Max Memory Allocated: 13.240654945373535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8905029296875 GB
    Memory Allocated: 0.09224224090576172  GigaBytes
Max Memory Allocated: 13.240654945373535  GigaBytes

torch.Size([154388, 128])
torch.Size([122140, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8905029296875 GB
    Memory Allocated: 13.118991374969482  GigaBytes
Max Memory Allocated: 13.240654945373535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8905029296875 GB
    Memory Allocated: 0.09169912338256836  GigaBytes
Max Memory Allocated: 13.240654945373535  GigaBytes

torch.Size([154357, 128])
torch.Size([121956, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8905029296875 GB
    Memory Allocated: 13.181796550750732  GigaBytes
Max Memory Allocated: 13.240654945373535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8905029296875 GB
    Memory Allocated: 0.09238338470458984  GigaBytes
Max Memory Allocated: 13.240654945373535  GigaBytes

torch.Size([154465, 128])
torch.Size([122565, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9061279296875 GB
    Memory Allocated: 13.229633808135986  GigaBytes
Max Memory Allocated: 13.244256496429443  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9061279296875 GB
    Memory Allocated: 0.09174346923828125  GigaBytes
Max Memory Allocated: 13.244256496429443  GigaBytes

torch.Size([154522, 128])
torch.Size([122422, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9061279296875 GB
    Memory Allocated: 13.150589942932129  GigaBytes
Max Memory Allocated: 13.244256496429443  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9061279296875 GB
    Memory Allocated: 0.09239006042480469  GigaBytes
Max Memory Allocated: 13.244256496429443  GigaBytes

torch.Size([154420, 128])
torch.Size([122467, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9061279296875 GB
    Memory Allocated: 13.217814445495605  GigaBytes
Max Memory Allocated: 13.244256496429443  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9061279296875 GB
    Memory Allocated: 0.09184551239013672  GigaBytes
Max Memory Allocated: 13.244256496429443  GigaBytes

torch.Size([154552, 128])
torch.Size([122543, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9061279296875 GB
    Memory Allocated: 13.203081130981445  GigaBytes
Max Memory Allocated: 13.244256496429443  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9061279296875 GB
    Memory Allocated: 0.09243488311767578  GigaBytes
Max Memory Allocated: 13.244256496429443  GigaBytes

torch.Size([154298, 128])
torch.Size([122434, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9061279296875 GB
    Memory Allocated: 13.255827903747559  GigaBytes
Max Memory Allocated: 13.270802021026611  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9061279296875 GB
    Memory Allocated: 0.09186220169067383  GigaBytes
Max Memory Allocated: 13.270802021026611  GigaBytes

torch.Size([154625, 128])
torch.Size([122506, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9061279296875 GB
    Memory Allocated: 13.185932159423828  GigaBytes
Max Memory Allocated: 13.270802021026611  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9061279296875 GB
    Memory Allocated: 0.09253215789794922  GigaBytes
Max Memory Allocated: 13.270802021026611  GigaBytes

torch.Size([154642, 128])
torch.Size([123054, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6014404296875 GB
    Memory Allocated: 13.327419757843018  GigaBytes
Max Memory Allocated: 13.34233570098877  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6014404296875 GB
    Memory Allocated: 0.09202861785888672  GigaBytes
Max Memory Allocated: 13.34233570098877  GigaBytes

torch.Size([154654, 128])
torch.Size([123195, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6014404296875 GB
    Memory Allocated: 13.300233840942383  GigaBytes
Max Memory Allocated: 13.34233570098877  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0382891446352005 |0.03737476468086243 |0.28648367524147034 |0.0001033097505569458 |0.3240903317928314 |0.007093191146850586 |
----------------------------------------------------------pseudo_mini_loss sum 4.960140705108643
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5092611
Number of first layer input nodes during this epoch:  2471396
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 15.6014404296875 GB
    Memory Allocated: 0.1175069808959961  GigaBytes
Max Memory Allocated: 13.34233570098877  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021787405014038086
range selection method range initialization spend 0.012735128402709961
time for parepare:  0.0184023380279541
local_output_nid generation:  0.0017442703247070312
local_in_edges_tensor generation:  0.006220102310180664
mini_batch_src_global generation:  0.0018572807312011719
r_  generation:  0.018364667892456055
local_output_nid generation:  0.0020880699157714844
local_in_edges_tensor generation:  0.0010411739349365234
mini_batch_src_global generation:  0.0021514892578125
r_  generation:  0.019420862197875977
local_output_nid generation:  0.002086162567138672
local_in_edges_tensor generation:  0.0009591579437255859
mini_batch_src_global generation:  0.0013508796691894531
r_  generation:  0.018116474151611328
local_output_nid generation:  0.0019450187683105469
local_in_edges_tensor generation:  0.0009059906005859375
mini_batch_src_global generation:  0.0013468265533447266
r_  generation:  0.018651962280273438
local_output_nid generation:  0.0018877983093261719
local_in_edges_tensor generation:  0.0009129047393798828
mini_batch_src_global generation:  0.0013566017150878906
r_  generation:  0.018958330154418945
local_output_nid generation:  0.00194549560546875
local_in_edges_tensor generation:  0.0009417533874511719
mini_batch_src_global generation:  0.0014536380767822266
r_  generation:  0.030367136001586914
local_output_nid generation:  0.0023941993713378906
local_in_edges_tensor generation:  0.0010590553283691406
mini_batch_src_global generation:  0.0018830299377441406
r_  generation:  0.021760225296020508
local_output_nid generation:  0.0019686222076416016
local_in_edges_tensor generation:  0.0009360313415527344
mini_batch_src_global generation:  0.0018856525421142578
r_  generation:  0.02150249481201172
local_output_nid generation:  0.0018656253814697266
local_in_edges_tensor generation:  0.0009093284606933594
mini_batch_src_global generation:  0.0018188953399658203
r_  generation:  0.021728992462158203
local_output_nid generation:  0.0017642974853515625
local_in_edges_tensor generation:  0.0008640289306640625
mini_batch_src_global generation:  0.0018911361694335938
r_  generation:  0.02181529998779297
local_output_nid generation:  0.0017664432525634766
local_in_edges_tensor generation:  0.0008878707885742188
mini_batch_src_global generation:  0.0019006729125976562
r_  generation:  0.022568464279174805
local_output_nid generation:  0.0017538070678710938
local_in_edges_tensor generation:  0.0008540153503417969
mini_batch_src_global generation:  0.0019230842590332031
r_  generation:  0.031600236892700195
local_output_nid generation:  0.0018658638000488281
local_in_edges_tensor generation:  0.0009412765502929688
mini_batch_src_global generation:  0.0015895366668701172
r_  generation:  0.019993305206298828
local_output_nid generation:  0.0018434524536132812
local_in_edges_tensor generation:  0.0009729862213134766
mini_batch_src_global generation:  0.0014412403106689453
r_  generation:  0.019048690795898438
local_output_nid generation:  0.0017404556274414062
local_in_edges_tensor generation:  0.0008623600006103516
mini_batch_src_global generation:  0.001611948013305664
r_  generation:  0.019351482391357422
local_output_nid generation:  0.0017347335815429688
local_in_edges_tensor generation:  0.0008399486541748047
mini_batch_src_global generation:  0.001575469970703125
r_  generation:  0.019392013549804688
----------------------check_connections_block total spend ----------------------------- 0.5159528255462646
generate_one_block  0.0380711555480957
generate_one_block  0.03252816200256348
generate_one_block  0.030290603637695312
generate_one_block  0.03076004981994629
generate_one_block  0.032469749450683594
generate_one_block  0.033345699310302734
generate_one_block  0.031702518463134766
generate_one_block  0.03123188018798828
generate_one_block  0.031449317932128906
generate_one_block  0.03087782859802246
generate_one_block  0.03457784652709961
generate_one_block  0.030703067779541016
generate_one_block  0.031131505966186523
generate_one_block  0.030855894088745117
generate_one_block  0.03310894966125488
generate_one_block  0.0319058895111084
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03863024711608887
gen group dst list time:  0.019938230514526367
time for parepare:  0.019685983657836914
local_output_nid generation:  0.007451534271240234
local_in_edges_tensor generation:  0.017238616943359375
mini_batch_src_global generation:  0.02012467384338379
r_  generation:  0.20991039276123047
local_output_nid generation:  0.01417994499206543
local_in_edges_tensor generation:  0.02417469024658203
mini_batch_src_global generation:  0.027148008346557617
r_  generation:  0.20833826065063477
local_output_nid generation:  0.012542247772216797
local_in_edges_tensor generation:  0.016295909881591797
mini_batch_src_global generation:  0.023122549057006836
r_  generation:  0.20253300666809082
local_output_nid generation:  0.012982606887817383
local_in_edges_tensor generation:  0.0171966552734375
mini_batch_src_global generation:  0.02413177490234375
r_  generation:  0.20758605003356934
local_output_nid generation:  0.013196229934692383
local_in_edges_tensor generation:  0.016847610473632812
mini_batch_src_global generation:  0.026889801025390625
r_  generation:  0.21425819396972656
local_output_nid generation:  0.01307058334350586
local_in_edges_tensor generation:  0.01297307014465332
mini_batch_src_global generation:  0.025662660598754883
r_  generation:  0.21109652519226074
local_output_nid generation:  0.013038396835327148
local_in_edges_tensor generation:  0.014213800430297852
mini_batch_src_global generation:  0.026034832000732422
r_  generation:  0.2138211727142334
local_output_nid generation:  0.013173580169677734
local_in_edges_tensor generation:  0.015377044677734375
mini_batch_src_global generation:  0.029056787490844727
r_  generation:  0.21625590324401855
local_output_nid generation:  0.013154029846191406
local_in_edges_tensor generation:  0.017285823822021484
mini_batch_src_global generation:  0.0265347957611084
r_  generation:  0.21599483489990234
local_output_nid generation:  0.012856245040893555
local_in_edges_tensor generation:  0.016811370849609375
mini_batch_src_global generation:  0.025560855865478516
r_  generation:  0.21110081672668457
local_output_nid generation:  0.013185977935791016
local_in_edges_tensor generation:  0.015443086624145508
mini_batch_src_global generation:  0.02811717987060547
r_  generation:  0.21608877182006836
local_output_nid generation:  0.015107154846191406
local_in_edges_tensor generation:  0.015321731567382812
mini_batch_src_global generation:  0.026473045349121094
r_  generation:  0.21544742584228516
local_output_nid generation:  0.013144493103027344
local_in_edges_tensor generation:  0.015040397644042969
mini_batch_src_global generation:  0.027691364288330078
r_  generation:  0.21871137619018555
local_output_nid generation:  0.0156862735748291
local_in_edges_tensor generation:  0.024223804473876953
mini_batch_src_global generation:  0.027195453643798828
r_  generation:  0.21551012992858887
local_output_nid generation:  0.012357711791992188
local_in_edges_tensor generation:  0.016615629196166992
mini_batch_src_global generation:  0.030945777893066406
r_  generation:  0.2255256175994873
local_output_nid generation:  0.012969493865966797
local_in_edges_tensor generation:  0.015743732452392578
mini_batch_src_global generation:  0.029470205307006836
r_  generation:  0.21570634841918945
----------------------check_connections_block total spend ----------------------------- 5.110856533050537
generate_one_block  0.2906155586242676
generate_one_block  0.2831594944000244
generate_one_block  0.27271580696105957
generate_one_block  0.2818944454193115
generate_one_block  0.28319573402404785
generate_one_block  0.2748134136199951
generate_one_block  0.30875658988952637
generate_one_block  0.2795829772949219
generate_one_block  0.28435444831848145
generate_one_block  0.2961447238922119
generate_one_block  0.28213977813720703
generate_one_block  0.3026771545410156
generate_one_block  0.2909824848175049
generate_one_block  0.2928502559661865
generate_one_block  0.28170061111450195
generate_one_block  0.2775719165802002
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04807114601135254
gen group dst list time:  0.06686973571777344
time for parepare:  0.0187222957611084
local_output_nid generation:  0.025648117065429688
local_in_edges_tensor generation:  0.05194997787475586
mini_batch_src_global generation:  0.04357099533081055
r_  generation:  0.43250250816345215
local_output_nid generation:  0.03122425079345703
local_in_edges_tensor generation:  0.04621767997741699
mini_batch_src_global generation:  0.05055356025695801
r_  generation:  0.44863271713256836
local_output_nid generation:  0.03163480758666992
local_in_edges_tensor generation:  0.042816877365112305
mini_batch_src_global generation:  0.04948735237121582
r_  generation:  0.45287060737609863
local_output_nid generation:  0.03252696990966797
local_in_edges_tensor generation:  0.030817747116088867
mini_batch_src_global generation:  0.051689863204956055
r_  generation:  0.4665989875793457
local_output_nid generation:  0.033141136169433594
local_in_edges_tensor generation:  0.0762479305267334
mini_batch_src_global generation:  0.05410599708557129
r_  generation:  0.45592236518859863
local_output_nid generation:  0.03878211975097656
local_in_edges_tensor generation:  0.03582262992858887
mini_batch_src_global generation:  0.0529789924621582
r_  generation:  0.4826650619506836
local_output_nid generation:  0.03326892852783203
local_in_edges_tensor generation:  0.04773306846618652
mini_batch_src_global generation:  0.06200003623962402
r_  generation:  0.4659304618835449
local_output_nid generation:  0.03225994110107422
local_in_edges_tensor generation:  0.0419008731842041
mini_batch_src_global generation:  0.05284881591796875
r_  generation:  0.46730756759643555
local_output_nid generation:  0.03206372261047363
local_in_edges_tensor generation:  0.04341769218444824
mini_batch_src_global generation:  0.05173516273498535
r_  generation:  0.45877933502197266
local_output_nid generation:  0.032129526138305664
local_in_edges_tensor generation:  0.03142571449279785
mini_batch_src_global generation:  0.052644968032836914
r_  generation:  0.4571986198425293
local_output_nid generation:  0.03589630126953125
local_in_edges_tensor generation:  0.03531932830810547
mini_batch_src_global generation:  0.052082061767578125
r_  generation:  0.46312785148620605
local_output_nid generation:  0.03162813186645508
local_in_edges_tensor generation:  0.05231356620788574
mini_batch_src_global generation:  0.05291748046875
r_  generation:  0.46409082412719727
local_output_nid generation:  0.03162026405334473
local_in_edges_tensor generation:  0.03181004524230957
mini_batch_src_global generation:  0.05225825309753418
r_  generation:  0.45849108695983887
local_output_nid generation:  0.031795501708984375
local_in_edges_tensor generation:  0.03158450126647949
mini_batch_src_global generation:  0.05189657211303711
r_  generation:  0.4601571559906006
local_output_nid generation:  0.03188753128051758
local_in_edges_tensor generation:  0.03567147254943848
mini_batch_src_global generation:  0.05145120620727539
r_  generation:  0.46106839179992676
local_output_nid generation:  0.0328066349029541
local_in_edges_tensor generation:  0.03300070762634277
mini_batch_src_global generation:  0.05198860168457031
r_  generation:  0.48590803146362305
----------------------check_connections_block total spend ----------------------------- 10.992610216140747
generate_one_block  0.6047613620758057
generate_one_block  0.6018362045288086
generate_one_block  0.5840394496917725
generate_one_block  0.5949001312255859
generate_one_block  0.60809326171875
generate_one_block  0.5940675735473633
generate_one_block  0.5829427242279053
generate_one_block  0.5891010761260986
generate_one_block  0.62687087059021
generate_one_block  0.5960254669189453
generate_one_block  0.592219352722168
generate_one_block  0.5919630527496338
generate_one_block  0.5911836624145508
generate_one_block  0.588935136795044
generate_one_block  0.606788158416748
generate_one_block  0.5921156406402588
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 15.6014404296875 GB
    Memory Allocated: 0.1175069808959961  GigaBytes
Max Memory Allocated: 13.34233570098877  GigaBytes

connection checking time:  16.103466749191284
block generation total time  14.128998517990112
average batch blocks generation time:  0.883062407374382
block dataloader generation time/epoch 32.61942982673645
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6014404296875 GB
    Memory Allocated: 0.09408044815063477  GigaBytes
Max Memory Allocated: 13.34233570098877  GigaBytes

torch.Size([154344, 128])
torch.Size([122204, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6014404296875 GB
    Memory Allocated: 13.214261531829834  GigaBytes
Max Memory Allocated: 13.34233570098877  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6014404296875 GB
    Memory Allocated: 0.09370899200439453  GigaBytes
Max Memory Allocated: 13.34233570098877  GigaBytes

torch.Size([154606, 128])
torch.Size([122932, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6014404296875 GB
    Memory Allocated: 13.307655334472656  GigaBytes
Max Memory Allocated: 13.34233570098877  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6014404296875 GB
    Memory Allocated: 0.09395694732666016  GigaBytes
Max Memory Allocated: 13.34233570098877  GigaBytes

torch.Size([154627, 128])
torch.Size([122515, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6014404296875 GB
    Memory Allocated: 13.134933471679688  GigaBytes
Max Memory Allocated: 13.34233570098877  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6014404296875 GB
    Memory Allocated: 0.09341955184936523  GigaBytes
Max Memory Allocated: 13.34233570098877  GigaBytes

torch.Size([154435, 128])
torch.Size([122104, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6014404296875 GB
    Memory Allocated: 13.178359508514404  GigaBytes
Max Memory Allocated: 13.34233570098877  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6014404296875 GB
    Memory Allocated: 0.09420490264892578  GigaBytes
Max Memory Allocated: 13.34233570098877  GigaBytes

torch.Size([154470, 128])
torch.Size([123115, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6014404296875 GB
    Memory Allocated: 13.297022819519043  GigaBytes
Max Memory Allocated: 13.34233570098877  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6014404296875 GB
    Memory Allocated: 0.09363698959350586  GigaBytes
Max Memory Allocated: 13.34233570098877  GigaBytes

torch.Size([154871, 128])
torch.Size([122639, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6014404296875 GB
    Memory Allocated: 13.177272319793701  GigaBytes
Max Memory Allocated: 13.34233570098877  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6014404296875 GB
    Memory Allocated: 0.09407234191894531  GigaBytes
Max Memory Allocated: 13.34233570098877  GigaBytes

torch.Size([154309, 128])
torch.Size([122114, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6014404296875 GB
    Memory Allocated: 13.196492195129395  GigaBytes
Max Memory Allocated: 13.34233570098877  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6014404296875 GB
    Memory Allocated: 0.09360027313232422  GigaBytes
Max Memory Allocated: 13.34233570098877  GigaBytes

torch.Size([154602, 128])
torch.Size([122657, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6014404296875 GB
    Memory Allocated: 13.202134132385254  GigaBytes
Max Memory Allocated: 13.34233570098877  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6014404296875 GB
    Memory Allocated: 0.09410572052001953  GigaBytes
Max Memory Allocated: 13.34233570098877  GigaBytes

torch.Size([154427, 128])
torch.Size([122287, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6014404296875 GB
    Memory Allocated: 13.208847999572754  GigaBytes
Max Memory Allocated: 13.34233570098877  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6014404296875 GB
    Memory Allocated: 0.09337663650512695  GigaBytes
Max Memory Allocated: 13.34233570098877  GigaBytes

torch.Size([154481, 128])
torch.Size([122302, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6014404296875 GB
    Memory Allocated: 13.12462329864502  GigaBytes
Max Memory Allocated: 13.34233570098877  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6014404296875 GB
    Memory Allocated: 0.09412670135498047  GigaBytes
Max Memory Allocated: 13.34233570098877  GigaBytes

torch.Size([154492, 128])
torch.Size([122737, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6014404296875 GB
    Memory Allocated: 13.240166187286377  GigaBytes
Max Memory Allocated: 13.34233570098877  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6014404296875 GB
    Memory Allocated: 0.09346866607666016  GigaBytes
Max Memory Allocated: 13.34233570098877  GigaBytes

torch.Size([154546, 128])
torch.Size([122290, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6014404296875 GB
    Memory Allocated: 13.155404090881348  GigaBytes
Max Memory Allocated: 13.34233570098877  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6014404296875 GB
    Memory Allocated: 0.09404182434082031  GigaBytes
Max Memory Allocated: 13.34233570098877  GigaBytes

torch.Size([154208, 128])
torch.Size([121838, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6014404296875 GB
    Memory Allocated: 13.195164203643799  GigaBytes
Max Memory Allocated: 13.34233570098877  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6014404296875 GB
    Memory Allocated: 0.09334993362426758  GigaBytes
Max Memory Allocated: 13.34233570098877  GigaBytes

torch.Size([154381, 128])
torch.Size([122199, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6014404296875 GB
    Memory Allocated: 13.134166240692139  GigaBytes
Max Memory Allocated: 13.34233570098877  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6014404296875 GB
    Memory Allocated: 0.0941009521484375  GigaBytes
Max Memory Allocated: 13.34233570098877  GigaBytes

torch.Size([154473, 128])
torch.Size([122502, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6014404296875 GB
    Memory Allocated: 13.21949815750122  GigaBytes
Max Memory Allocated: 13.34233570098877  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6014404296875 GB
    Memory Allocated: 0.09348773956298828  GigaBytes
Max Memory Allocated: 13.34233570098877  GigaBytes

torch.Size([154598, 128])
torch.Size([122191, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6014404296875 GB
    Memory Allocated: 13.160617351531982  GigaBytes
Max Memory Allocated: 13.34233570098877  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03472048044204712 |0.01537381112575531 |0.2447468489408493 |9.489059448242188e-05 |0.3236718624830246 |0.006505727767944336 |
----------------------------------------------------------pseudo_mini_loss sum 3.8093912601470947
Total (block generation + training)time/epoch 42.555922508239746
Training time/epoch 9.936229944229126
Training time without block to device /epoch 9.690248966217041
Training time without total dataloading part /epoch 9.102723360061646
load block tensor time/epoch 0.5555276870727539
block to device time/epoch 0.24598097801208496
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5091785
Number of first layer input nodes during this epoch:  2471870
