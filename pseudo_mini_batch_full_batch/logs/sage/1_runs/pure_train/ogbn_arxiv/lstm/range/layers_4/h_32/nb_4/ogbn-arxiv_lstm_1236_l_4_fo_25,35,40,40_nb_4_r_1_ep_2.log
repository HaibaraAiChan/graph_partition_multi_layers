Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648487749.0847244
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006489753723144531  GigaBytes
Max Memory Allocated: 0.0006489753723144531  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.024718284606933594
range selection method range initialization spend 0.013087987899780273
time for parepare:  0.01782512664794922
local_output_nid generation:  0.0051691532135009766
local_in_edges_tensor generation:  0.005984306335449219
mini_batch_src_global generation:  0.006445407867431641
r_  generation:  0.08154034614562988
local_output_nid generation:  0.005979061126708984
local_in_edges_tensor generation:  0.002990245819091797
mini_batch_src_global generation:  0.008358478546142578
r_  generation:  0.0870809555053711
local_output_nid generation:  0.006035327911376953
local_in_edges_tensor generation:  0.002983570098876953
mini_batch_src_global generation:  0.006552457809448242
r_  generation:  0.0879065990447998
local_output_nid generation:  0.0060577392578125
local_in_edges_tensor generation:  0.0031430721282958984
mini_batch_src_global generation:  0.006977081298828125
r_  generation:  0.09098529815673828
----------------------check_connections_block total spend ----------------------------- 0.5009970664978027
generate_one_block  0.101531982421875
generate_one_block  0.10173606872558594
generate_one_block  0.10278177261352539
generate_one_block  0.1015326976776123
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0404810905456543
gen group dst list time:  0.011259794235229492
time for parepare:  0.018904685974121094
local_output_nid generation:  0.014123201370239258
local_in_edges_tensor generation:  0.037984371185302734
mini_batch_src_global generation:  0.04089045524597168
r_  generation:  0.4021766185760498
local_output_nid generation:  0.021169185638427734
local_in_edges_tensor generation:  0.03637409210205078
mini_batch_src_global generation:  0.04819202423095703
r_  generation:  0.4125964641571045
local_output_nid generation:  0.021924734115600586
local_in_edges_tensor generation:  0.030341625213623047
mini_batch_src_global generation:  0.05172228813171387
r_  generation:  0.4268834590911865
local_output_nid generation:  0.022257566452026367
local_in_edges_tensor generation:  0.02709054946899414
mini_batch_src_global generation:  0.04878377914428711
r_  generation:  0.4206254482269287
----------------------check_connections_block total spend ----------------------------- 2.4358625411987305
generate_one_block  0.5575053691864014
generate_one_block  0.5435855388641357
generate_one_block  0.5487432479858398
generate_one_block  0.5291707515716553
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03601336479187012
gen group dst list time:  0.020505905151367188
time for parepare:  0.01926112174987793
local_output_nid generation:  0.025092124938964844
local_in_edges_tensor generation:  0.04205679893493652
mini_batch_src_global generation:  0.05176234245300293
r_  generation:  0.5241906642913818
local_output_nid generation:  0.03624987602233887
local_in_edges_tensor generation:  0.051828622817993164
mini_batch_src_global generation:  0.059558868408203125
r_  generation:  0.5288345813751221
local_output_nid generation:  0.03784823417663574
local_in_edges_tensor generation:  0.04366779327392578
mini_batch_src_global generation:  0.05563211441040039
r_  generation:  0.5436437129974365
local_output_nid generation:  0.03881096839904785
local_in_edges_tensor generation:  0.03415393829345703
mini_batch_src_global generation:  0.055405378341674805
r_  generation:  0.5499050617218018
----------------------check_connections_block total spend ----------------------------- 3.161686658859253
generate_one_block  0.6956548690795898
generate_one_block  0.7012879848480225
generate_one_block  0.7005748748779297
generate_one_block  0.6773850917816162
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.027695894241333008
gen group dst list time:  0.023329973220825195
time for parepare:  0.01840662956237793
local_output_nid generation:  0.027047395706176758
local_in_edges_tensor generation:  0.03725242614746094
mini_batch_src_global generation:  0.045355796813964844
r_  generation:  0.5154728889465332
local_output_nid generation:  0.03475379943847656
local_in_edges_tensor generation:  0.05069398880004883
mini_batch_src_global generation:  0.05763649940490723
r_  generation:  0.5099565982818604
local_output_nid generation:  0.03528141975402832
local_in_edges_tensor generation:  0.03832101821899414
mini_batch_src_global generation:  0.060988664627075195
r_  generation:  0.5127396583557129
local_output_nid generation:  0.03511333465576172
local_in_edges_tensor generation:  0.036418914794921875
mini_batch_src_global generation:  0.06012320518493652
r_  generation:  0.5223898887634277
----------------------check_connections_block total spend ----------------------------- 3.0578646659851074
generate_one_block  0.6807956695556641
generate_one_block  0.6501555442810059
generate_one_block  0.649125337600708
generate_one_block  0.6435444355010986
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006489753723144531  GigaBytes
Max Memory Allocated: 0.0006489753723144531  GigaBytes

connection checking time:  8.65541386604309
block generation total time  7.577528715133667
average batch blocks generation time:  1.8943821787834167
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2030029296875 GB
    Memory Allocated: 0.11648035049438477  GigaBytes
Max Memory Allocated: 0.11648035049438477  GigaBytes

torch.Size([166670, 128])
torch.Size([164693, 32])
torch.Size([155097, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3084716796875 GB
    Memory Allocated: 17.96467113494873  GigaBytes
Max Memory Allocated: 17.989135265350342  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.2049560546875 GB
    Memory Allocated: 0.12105703353881836  GigaBytes
Max Memory Allocated: 17.989135265350342  GigaBytes

torch.Size([166665, 128])
torch.Size([164747, 32])
torch.Size([155104, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.2147216796875 GB
    Memory Allocated: 18.00931167602539  GigaBytes
Max Memory Allocated: 18.037277221679688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.2147216796875 GB
    Memory Allocated: 0.12168025970458984  GigaBytes
Max Memory Allocated: 18.037277221679688  GigaBytes

torch.Size([166725, 128])
torch.Size([164823, 32])
torch.Size([155134, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4744873046875 GB
    Memory Allocated: 18.032231330871582  GigaBytes
Max Memory Allocated: 18.06047010421753  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4744873046875 GB
    Memory Allocated: 0.12104463577270508  GigaBytes
Max Memory Allocated: 18.06047010421753  GigaBytes

torch.Size([166659, 128])
torch.Size([164703, 32])
torch.Size([154860, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4744873046875 GB
    Memory Allocated: 17.993924617767334  GigaBytes
Max Memory Allocated: 18.06047010421753  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.051100969314575195 |0.11372476816177368 |0.5778670907020569 |0.00011998414993286133 |0.49941402673721313 |0.009308338165283203 |
----------------------------------------------------------pseudo_mini_loss sum 4.484679222106934
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  2351444
Number of first layer input nodes during this epoch:  666719
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.4744873046875 GB
    Memory Allocated: 0.1873302459716797  GigaBytes
Max Memory Allocated: 18.06047010421753  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.02912282943725586
range selection method range initialization spend 0.011637210845947266
time for parepare:  0.017366886138916016
local_output_nid generation:  0.005245208740234375
local_in_edges_tensor generation:  0.006944179534912109
mini_batch_src_global generation:  0.007021188735961914
r_  generation:  0.07928943634033203
local_output_nid generation:  0.005979776382446289
local_in_edges_tensor generation:  0.005559444427490234
mini_batch_src_global generation:  0.008819103240966797
r_  generation:  0.08883452415466309
local_output_nid generation:  0.00604557991027832
local_in_edges_tensor generation:  0.0030870437622070312
mini_batch_src_global generation:  0.006498575210571289
r_  generation:  0.08899378776550293
local_output_nid generation:  0.006071805953979492
local_in_edges_tensor generation:  0.0032143592834472656
mini_batch_src_global generation:  0.006864786148071289
r_  generation:  0.0910336971282959
----------------------check_connections_block total spend ----------------------------- 0.5100054740905762
generate_one_block  0.1159675121307373
generate_one_block  0.11414432525634766
generate_one_block  0.11389040946960449
generate_one_block  0.11379337310791016
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04122161865234375
gen group dst list time:  0.010846853256225586
time for parepare:  0.019066810607910156
local_output_nid generation:  0.014652729034423828
local_in_edges_tensor generation:  0.03499722480773926
mini_batch_src_global generation:  0.0376131534576416
r_  generation:  0.4027276039123535
local_output_nid generation:  0.021901845932006836
local_in_edges_tensor generation:  0.03891634941101074
mini_batch_src_global generation:  0.05096006393432617
r_  generation:  0.41916966438293457
local_output_nid generation:  0.022297143936157227
local_in_edges_tensor generation:  0.03645682334899902
mini_batch_src_global generation:  0.04865765571594238
r_  generation:  0.42487144470214844
local_output_nid generation:  0.022595882415771484
local_in_edges_tensor generation:  0.0254671573638916
mini_batch_src_global generation:  0.05032062530517578
r_  generation:  0.42992353439331055
----------------------check_connections_block total spend ----------------------------- 2.4620490074157715
generate_one_block  0.5742087364196777
generate_one_block  0.5675313472747803
generate_one_block  0.5885999202728271
generate_one_block  0.5605831146240234
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03629803657531738
gen group dst list time:  0.020678043365478516
time for parepare:  0.01921534538269043
local_output_nid generation:  0.024561405181884766
local_in_edges_tensor generation:  0.04319262504577637
mini_batch_src_global generation:  0.0527195930480957
r_  generation:  0.5352139472961426
local_output_nid generation:  0.0332188606262207
local_in_edges_tensor generation:  0.05265069007873535
mini_batch_src_global generation:  0.060217857360839844
r_  generation:  0.54148268699646
local_output_nid generation:  0.03684544563293457
local_in_edges_tensor generation:  0.04352903366088867
mini_batch_src_global generation:  0.056075096130371094
r_  generation:  0.5560357570648193
local_output_nid generation:  0.03686952590942383
local_in_edges_tensor generation:  0.04027295112609863
mini_batch_src_global generation:  0.055901527404785156
r_  generation:  0.5554015636444092
----------------------check_connections_block total spend ----------------------------- 3.2092490196228027
generate_one_block  0.7381792068481445
generate_one_block  0.7411627769470215
generate_one_block  0.7330317497253418
generate_one_block  0.7099630832672119
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.056990623474121094
gen group dst list time:  0.02894449234008789
time for parepare:  0.018970966339111328
local_output_nid generation:  0.02877497673034668
local_in_edges_tensor generation:  0.05007123947143555
mini_batch_src_global generation:  0.04578661918640137
r_  generation:  0.5100789070129395
local_output_nid generation:  0.034833431243896484
local_in_edges_tensor generation:  0.04720664024353027
mini_batch_src_global generation:  0.057474374771118164
r_  generation:  0.5340869426727295
local_output_nid generation:  0.03577780723571777
local_in_edges_tensor generation:  0.04509258270263672
mini_batch_src_global generation:  0.057559967041015625
r_  generation:  0.5479736328125
local_output_nid generation:  0.0418851375579834
local_in_edges_tensor generation:  0.052782297134399414
mini_batch_src_global generation:  0.06295037269592285
r_  generation:  0.5248129367828369
----------------------check_connections_block total spend ----------------------------- 3.1672117710113525
generate_one_block  0.7167446613311768
generate_one_block  0.6800508499145508
generate_one_block  0.7139036655426025
generate_one_block  0.6993615627288818
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.4744873046875 GB
    Memory Allocated: 0.1873302459716797  GigaBytes
Max Memory Allocated: 18.06047010421753  GigaBytes

connection checking time:  8.838509798049927
block generation total time  8.02332067489624
average batch blocks generation time:  2.00583016872406
block dataloader generation time/epoch 19.123777389526367
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4744873046875 GB
    Memory Allocated: 0.12294292449951172  GigaBytes
Max Memory Allocated: 18.06047010421753  GigaBytes

torch.Size([166723, 128])
torch.Size([164740, 32])
torch.Size([155064, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4744873046875 GB
    Memory Allocated: 18.005101680755615  GigaBytes
Max Memory Allocated: 18.06047010421753  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4744873046875 GB
    Memory Allocated: 0.12281036376953125  GigaBytes
Max Memory Allocated: 18.06047010421753  GigaBytes

torch.Size([166586, 128])
torch.Size([164565, 32])
torch.Size([154771, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4744873046875 GB
    Memory Allocated: 18.015499114990234  GigaBytes
Max Memory Allocated: 18.06047010421753  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4744873046875 GB
    Memory Allocated: 0.1229562759399414  GigaBytes
Max Memory Allocated: 18.06047010421753  GigaBytes

torch.Size([166636, 128])
torch.Size([164714, 32])
torch.Size([155103, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4744873046875 GB
    Memory Allocated: 18.014806747436523  GigaBytes
Max Memory Allocated: 18.06047010421753  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4744873046875 GB
    Memory Allocated: 0.12233161926269531  GigaBytes
Max Memory Allocated: 18.06047010421753  GigaBytes

torch.Size([166650, 128])
torch.Size([164705, 32])
torch.Size([154989, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4744873046875 GB
    Memory Allocated: 18.002034187316895  GigaBytes
Max Memory Allocated: 18.06047010421753  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04595214128494263 |0.0343470573425293 |0.36496490240097046 |0.00010389089584350586 |0.5029727816581726 |0.008188486099243164 |
----------------------------------------------------------pseudo_mini_loss sum 3.9614574909210205
Total (block generation + training)time/epoch 22.941821336746216
Training time/epoch 3.8178157806396484
Training time without block to device /epoch 3.6804275512695312
Training time without total dataloading part /epoch 3.4803547859191895
load block tensor time/epoch 0.1838085651397705
block to device time/epoch 0.1373882293701172
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  2350668
Number of first layer input nodes during this epoch:  666595
