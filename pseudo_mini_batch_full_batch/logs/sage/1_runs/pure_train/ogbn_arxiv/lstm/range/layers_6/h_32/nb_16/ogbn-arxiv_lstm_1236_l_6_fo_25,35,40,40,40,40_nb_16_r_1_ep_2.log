Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648525308.5695682
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007319450378417969  GigaBytes
Max Memory Allocated: 0.0007319450378417969  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.02500176429748535
range selection method range initialization spend 0.013536214828491211
time for parepare:  0.0180208683013916
local_output_nid generation:  0.0013375282287597656
local_in_edges_tensor generation:  0.003922462463378906
mini_batch_src_global generation:  0.0016963481903076172
r_  generation:  0.017762184143066406
local_output_nid generation:  0.0013959407806396484
local_in_edges_tensor generation:  0.0009248256683349609
mini_batch_src_global generation:  0.0021147727966308594
r_  generation:  0.01776123046875
local_output_nid generation:  0.0014522075653076172
local_in_edges_tensor generation:  0.0009067058563232422
mini_batch_src_global generation:  0.0014030933380126953
r_  generation:  0.017450332641601562
local_output_nid generation:  0.0015170574188232422
local_in_edges_tensor generation:  0.0009019374847412109
mini_batch_src_global generation:  0.0012531280517578125
r_  generation:  0.01761460304260254
local_output_nid generation:  0.0014643669128417969
local_in_edges_tensor generation:  0.000827789306640625
mini_batch_src_global generation:  0.0014405250549316406
r_  generation:  0.017566919326782227
local_output_nid generation:  0.0014615058898925781
local_in_edges_tensor generation:  0.0008258819580078125
mini_batch_src_global generation:  0.0013835430145263672
r_  generation:  0.01874566078186035
local_output_nid generation:  0.0014863014221191406
local_in_edges_tensor generation:  0.0008625984191894531
mini_batch_src_global generation:  0.0015034675598144531
r_  generation:  0.01899433135986328
local_output_nid generation:  0.0014657974243164062
local_in_edges_tensor generation:  0.0008547306060791016
mini_batch_src_global generation:  0.0013554096221923828
r_  generation:  0.018068313598632812
local_output_nid generation:  0.0014743804931640625
local_in_edges_tensor generation:  0.0008170604705810547
mini_batch_src_global generation:  0.0015087127685546875
r_  generation:  0.018712759017944336
local_output_nid generation:  0.0014688968658447266
local_in_edges_tensor generation:  0.0008111000061035156
mini_batch_src_global generation:  0.0014901161193847656
r_  generation:  0.018780231475830078
local_output_nid generation:  0.0014972686767578125
local_in_edges_tensor generation:  0.0008409023284912109
mini_batch_src_global generation:  0.0013921260833740234
r_  generation:  0.018744468688964844
local_output_nid generation:  0.0015304088592529297
local_in_edges_tensor generation:  0.0008747577667236328
mini_batch_src_global generation:  0.0015132427215576172
r_  generation:  0.019402503967285156
local_output_nid generation:  0.0015926361083984375
local_in_edges_tensor generation:  0.00093841552734375
mini_batch_src_global generation:  0.0015223026275634766
r_  generation:  0.01938915252685547
local_output_nid generation:  0.001573324203491211
local_in_edges_tensor generation:  0.0009188652038574219
mini_batch_src_global generation:  0.0015592575073242188
r_  generation:  0.019783973693847656
local_output_nid generation:  0.0015919208526611328
local_in_edges_tensor generation:  0.0009469985961914062
mini_batch_src_global generation:  0.0015499591827392578
r_  generation:  0.019086360931396484
local_output_nid generation:  0.0015516281127929688
local_in_edges_tensor generation:  0.0008585453033447266
mini_batch_src_global generation:  0.0016372203826904297
r_  generation:  0.019512653350830078
----------------------check_connections_block total spend ----------------------------- 0.4479329586029053
generate_one_block  0.026819467544555664
generate_one_block  0.027850866317749023
generate_one_block  0.026575326919555664
generate_one_block  0.028664112091064453
generate_one_block  0.027254581451416016
generate_one_block  0.0278778076171875
generate_one_block  0.027533292770385742
generate_one_block  0.027475833892822266
generate_one_block  0.02763986587524414
generate_one_block  0.028098106384277344
generate_one_block  0.027629613876342773
generate_one_block  0.028190135955810547
generate_one_block  0.027413129806518555
generate_one_block  0.02816939353942871
generate_one_block  0.027972698211669922
generate_one_block  0.02847599983215332
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.04017829895019531
gen group dst list time:  0.019286632537841797
time for parepare:  0.018871784210205078
local_output_nid generation:  0.006619453430175781
local_in_edges_tensor generation:  0.015540122985839844
mini_batch_src_global generation:  0.019634485244750977
r_  generation:  0.19522523880004883
local_output_nid generation:  0.010242462158203125
local_in_edges_tensor generation:  0.017874956130981445
mini_batch_src_global generation:  0.02503061294555664
r_  generation:  0.21288847923278809
local_output_nid generation:  0.010159730911254883
local_in_edges_tensor generation:  0.011182546615600586
mini_batch_src_global generation:  0.023853302001953125
r_  generation:  0.20443964004516602
local_output_nid generation:  0.010605096817016602
local_in_edges_tensor generation:  0.014867544174194336
mini_batch_src_global generation:  0.0252225399017334
r_  generation:  0.21560454368591309
local_output_nid generation:  0.010662555694580078
local_in_edges_tensor generation:  0.011485576629638672
mini_batch_src_global generation:  0.03440666198730469
r_  generation:  0.21597075462341309
local_output_nid generation:  0.011139392852783203
local_in_edges_tensor generation:  0.015477180480957031
mini_batch_src_global generation:  0.02870631217956543
r_  generation:  0.2171337604522705
local_output_nid generation:  0.011083841323852539
local_in_edges_tensor generation:  0.015446901321411133
mini_batch_src_global generation:  0.027936697006225586
r_  generation:  0.22024774551391602
local_output_nid generation:  0.010980367660522461
local_in_edges_tensor generation:  0.013499021530151367
mini_batch_src_global generation:  0.02735280990600586
r_  generation:  0.21317267417907715
local_output_nid generation:  0.011201620101928711
local_in_edges_tensor generation:  0.013887643814086914
mini_batch_src_global generation:  0.02884054183959961
r_  generation:  0.21898150444030762
local_output_nid generation:  0.01131296157836914
local_in_edges_tensor generation:  0.013653755187988281
mini_batch_src_global generation:  0.029015064239501953
r_  generation:  0.21732091903686523
local_output_nid generation:  0.011314868927001953
local_in_edges_tensor generation:  0.011665105819702148
mini_batch_src_global generation:  0.02725386619567871
r_  generation:  0.21956729888916016
local_output_nid generation:  0.011336088180541992
local_in_edges_tensor generation:  0.01373434066772461
mini_batch_src_global generation:  0.02915167808532715
r_  generation:  0.2173457145690918
local_output_nid generation:  0.011335611343383789
local_in_edges_tensor generation:  0.01217198371887207
mini_batch_src_global generation:  0.027260541915893555
r_  generation:  0.2170734405517578
local_output_nid generation:  0.011525630950927734
local_in_edges_tensor generation:  0.01595926284790039
mini_batch_src_global generation:  0.028157711029052734
r_  generation:  0.22011232376098633
local_output_nid generation:  0.011444330215454102
local_in_edges_tensor generation:  0.018092632293701172
mini_batch_src_global generation:  0.03210568428039551
r_  generation:  0.22662615776062012
local_output_nid generation:  0.011451244354248047
local_in_edges_tensor generation:  0.014169692993164062
mini_batch_src_global generation:  0.02796459197998047
r_  generation:  0.2202467918395996
----------------------check_connections_block total spend ----------------------------- 5.085082292556763
generate_one_block  0.27444934844970703
generate_one_block  0.2769584655761719
generate_one_block  0.2695751190185547
generate_one_block  0.272869348526001
generate_one_block  0.2939586639404297
generate_one_block  0.2803473472595215
generate_one_block  0.2901773452758789
generate_one_block  0.27205634117126465
generate_one_block  0.2805671691894531
generate_one_block  0.2823352813720703
generate_one_block  0.27658534049987793
generate_one_block  0.28009772300720215
generate_one_block  0.2777235507965088
generate_one_block  0.2893810272216797
generate_one_block  0.2847568988800049
generate_one_block  0.28829312324523926
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.03879690170288086
gen group dst list time:  0.06047821044921875
time for parepare:  0.018970251083374023
local_output_nid generation:  0.023853063583374023
local_in_edges_tensor generation:  0.03960371017456055
mini_batch_src_global generation:  0.04784107208251953
r_  generation:  0.48203444480895996
local_output_nid generation:  0.029612064361572266
local_in_edges_tensor generation:  0.04923605918884277
mini_batch_src_global generation:  0.05860424041748047
r_  generation:  0.49355220794677734
local_output_nid generation:  0.0293886661529541
local_in_edges_tensor generation:  0.03210759162902832
mini_batch_src_global generation:  0.05675458908081055
r_  generation:  0.4960019588470459
local_output_nid generation:  0.029732942581176758
local_in_edges_tensor generation:  0.03572249412536621
mini_batch_src_global generation:  0.05812215805053711
r_  generation:  0.4923567771911621
local_output_nid generation:  0.029716014862060547
local_in_edges_tensor generation:  0.04074215888977051
mini_batch_src_global generation:  0.05843377113342285
r_  generation:  0.4996821880340576
local_output_nid generation:  0.029854536056518555
local_in_edges_tensor generation:  0.041008949279785156
mini_batch_src_global generation:  0.06679344177246094
r_  generation:  0.49537086486816406
local_output_nid generation:  0.03038334846496582
local_in_edges_tensor generation:  0.031564950942993164
mini_batch_src_global generation:  0.06192612648010254
r_  generation:  0.5070819854736328
local_output_nid generation:  0.0300748348236084
local_in_edges_tensor generation:  0.03776264190673828
mini_batch_src_global generation:  0.06067609786987305
r_  generation:  0.5199897289276123
local_output_nid generation:  0.03139495849609375
local_in_edges_tensor generation:  0.04934883117675781
mini_batch_src_global generation:  0.06483078002929688
r_  generation:  0.502659797668457
local_output_nid generation:  0.030394792556762695
local_in_edges_tensor generation:  0.04148387908935547
mini_batch_src_global generation:  0.059172630310058594
r_  generation:  0.5093827247619629
local_output_nid generation:  0.030295610427856445
local_in_edges_tensor generation:  0.03417086601257324
mini_batch_src_global generation:  0.0624692440032959
r_  generation:  0.5228488445281982
local_output_nid generation:  0.033155202865600586
local_in_edges_tensor generation:  0.03827238082885742
mini_batch_src_global generation:  0.059961795806884766
r_  generation:  0.5037491321563721
local_output_nid generation:  0.03133583068847656
local_in_edges_tensor generation:  0.029859066009521484
mini_batch_src_global generation:  0.06000876426696777
r_  generation:  0.5049397945404053
local_output_nid generation:  0.031510353088378906
local_in_edges_tensor generation:  0.03848123550415039
mini_batch_src_global generation:  0.05920839309692383
r_  generation:  0.5060081481933594
local_output_nid generation:  0.03137707710266113
local_in_edges_tensor generation:  0.03969454765319824
mini_batch_src_global generation:  0.05854344367980957
r_  generation:  0.5103864669799805
local_output_nid generation:  0.03137063980102539
local_in_edges_tensor generation:  0.029916048049926758
mini_batch_src_global generation:  0.07298564910888672
r_  generation:  0.5067272186279297
----------------------check_connections_block total spend ----------------------------- 11.843367099761963
generate_one_block  0.6519460678100586
generate_one_block  0.6669065952301025
generate_one_block  0.6323647499084473
generate_one_block  0.6447029113769531
generate_one_block  0.6497054100036621
generate_one_block  0.6565032005310059
generate_one_block  0.7297458648681641
generate_one_block  0.6336896419525146
generate_one_block  0.6502463817596436
generate_one_block  0.6539943218231201
generate_one_block  0.6546266078948975
generate_one_block  0.6491804122924805
generate_one_block  0.6340475082397461
generate_one_block  0.6567027568817139
generate_one_block  0.6530351638793945
generate_one_block  0.6537277698516846
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.06320500373840332
gen group dst list time:  0.08825516700744629
time for parepare:  0.01960158348083496
local_output_nid generation:  0.03197741508483887
local_in_edges_tensor generation:  0.07076525688171387
mini_batch_src_global generation:  0.05487680435180664
r_  generation:  0.5429248809814453
local_output_nid generation:  0.037019968032836914
local_in_edges_tensor generation:  0.05417609214782715
mini_batch_src_global generation:  0.06295180320739746
r_  generation:  0.5407564640045166
local_output_nid generation:  0.03665947914123535
local_in_edges_tensor generation:  0.04003596305847168
mini_batch_src_global generation:  0.059418678283691406
r_  generation:  0.5485010147094727
local_output_nid generation:  0.03688240051269531
local_in_edges_tensor generation:  0.0451045036315918
mini_batch_src_global generation:  0.05917000770568848
r_  generation:  0.5458016395568848
local_output_nid generation:  0.03665971755981445
local_in_edges_tensor generation:  0.0400850772857666
mini_batch_src_global generation:  0.0590362548828125
r_  generation:  0.5537700653076172
local_output_nid generation:  0.036942481994628906
local_in_edges_tensor generation:  0.035566091537475586
mini_batch_src_global generation:  0.05985403060913086
r_  generation:  0.5523254871368408
local_output_nid generation:  0.03710031509399414
local_in_edges_tensor generation:  0.05014324188232422
mini_batch_src_global generation:  0.06067657470703125
r_  generation:  0.5629229545593262
local_output_nid generation:  0.037525177001953125
local_in_edges_tensor generation:  0.04143953323364258
mini_batch_src_global generation:  0.06162619590759277
r_  generation:  0.5613782405853271
local_output_nid generation:  0.037344932556152344
local_in_edges_tensor generation:  0.04102611541748047
mini_batch_src_global generation:  0.06100010871887207
r_  generation:  0.5665144920349121
local_output_nid generation:  0.03728771209716797
local_in_edges_tensor generation:  0.03603172302246094
mini_batch_src_global generation:  0.06162095069885254
r_  generation:  0.5780432224273682
local_output_nid generation:  0.03763556480407715
local_in_edges_tensor generation:  0.04543614387512207
mini_batch_src_global generation:  0.07035231590270996
r_  generation:  0.5671627521514893
local_output_nid generation:  0.037232160568237305
local_in_edges_tensor generation:  0.04471087455749512
mini_batch_src_global generation:  0.06229972839355469
r_  generation:  0.5584228038787842
local_output_nid generation:  0.03734922409057617
local_in_edges_tensor generation:  0.03999209403991699
mini_batch_src_global generation:  0.06593680381774902
r_  generation:  0.5648016929626465
local_output_nid generation:  0.03738689422607422
local_in_edges_tensor generation:  0.0506742000579834
mini_batch_src_global generation:  0.06177115440368652
r_  generation:  0.5716235637664795
local_output_nid generation:  0.04047584533691406
local_in_edges_tensor generation:  0.0450441837310791
mini_batch_src_global generation:  0.06862902641296387
r_  generation:  0.566612958908081
local_output_nid generation:  0.038323402404785156
local_in_edges_tensor generation:  0.03534388542175293
mini_batch_src_global generation:  0.06294894218444824
r_  generation:  0.5629615783691406
----------------------check_connections_block total spend ----------------------------- 13.357495546340942
generate_one_block  0.6941471099853516
generate_one_block  0.7065796852111816
generate_one_block  0.6877260208129883
generate_one_block  0.7803616523742676
generate_one_block  0.7043952941894531
generate_one_block  0.7069437503814697
generate_one_block  0.7028923034667969
generate_one_block  0.6874029636383057
generate_one_block  0.712726354598999
generate_one_block  0.6861462593078613
generate_one_block  0.7082052230834961
generate_one_block  0.7021291255950928
generate_one_block  0.7063615322113037
generate_one_block  0.7295324802398682
generate_one_block  0.7049086093902588
generate_one_block  0.6987805366516113
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0397183895111084
gen group dst list time:  0.0977625846862793
time for parepare:  0.01959514617919922
local_output_nid generation:  0.03525567054748535
local_in_edges_tensor generation:  0.045404672622680664
mini_batch_src_global generation:  0.0489194393157959
r_  generation:  0.5357410907745361
local_output_nid generation:  0.04008603096008301
local_in_edges_tensor generation:  0.03944969177246094
mini_batch_src_global generation:  0.06265735626220703
r_  generation:  0.5407326221466064
local_output_nid generation:  0.037973642349243164
local_in_edges_tensor generation:  0.03500962257385254
mini_batch_src_global generation:  0.06329059600830078
r_  generation:  0.539254903793335
local_output_nid generation:  0.0393979549407959
local_in_edges_tensor generation:  0.03584408760070801
mini_batch_src_global generation:  0.06225132942199707
r_  generation:  0.5409221649169922
local_output_nid generation:  0.03856682777404785
local_in_edges_tensor generation:  0.035269975662231445
mini_batch_src_global generation:  0.06206226348876953
r_  generation:  0.545081615447998
local_output_nid generation:  0.03852438926696777
local_in_edges_tensor generation:  0.03567051887512207
mini_batch_src_global generation:  0.06264019012451172
r_  generation:  0.5443236827850342
local_output_nid generation:  0.03929734230041504
local_in_edges_tensor generation:  0.040032148361206055
mini_batch_src_global generation:  0.06126999855041504
r_  generation:  0.5441040992736816
local_output_nid generation:  0.039075374603271484
local_in_edges_tensor generation:  0.04038691520690918
mini_batch_src_global generation:  0.06133913993835449
r_  generation:  0.543604850769043
local_output_nid generation:  0.038878679275512695
local_in_edges_tensor generation:  0.04485058784484863
mini_batch_src_global generation:  0.061687469482421875
r_  generation:  0.5457520484924316
local_output_nid generation:  0.039031267166137695
local_in_edges_tensor generation:  0.03504467010498047
mini_batch_src_global generation:  0.06225275993347168
r_  generation:  0.5491809844970703
local_output_nid generation:  0.03905177116394043
local_in_edges_tensor generation:  0.04625725746154785
mini_batch_src_global generation:  0.061502695083618164
r_  generation:  0.5497438907623291
local_output_nid generation:  0.038665056228637695
local_in_edges_tensor generation:  0.03562331199645996
mini_batch_src_global generation:  0.06222200393676758
r_  generation:  0.551480770111084
local_output_nid generation:  0.0387575626373291
local_in_edges_tensor generation:  0.0451502799987793
mini_batch_src_global generation:  0.06125497817993164
r_  generation:  0.5512330532073975
local_output_nid generation:  0.03906130790710449
local_in_edges_tensor generation:  0.04985475540161133
mini_batch_src_global generation:  0.06046652793884277
r_  generation:  0.5586321353912354
local_output_nid generation:  0.03945469856262207
local_in_edges_tensor generation:  0.045092105865478516
mini_batch_src_global generation:  0.08566427230834961
r_  generation:  0.5659749507904053
local_output_nid generation:  0.0422515869140625
local_in_edges_tensor generation:  0.0451054573059082
mini_batch_src_global generation:  0.06546258926391602
r_  generation:  0.5535283088684082
----------------------check_connections_block total spend ----------------------------- 13.143755912780762
generate_one_block  0.6787493228912354
generate_one_block  0.6871566772460938
generate_one_block  0.6984124183654785
generate_one_block  0.6996796131134033
generate_one_block  0.7022151947021484
generate_one_block  0.679541826248169
generate_one_block  0.7499945163726807
generate_one_block  0.696284294128418
generate_one_block  0.711540937423706
generate_one_block  0.6782047748565674
generate_one_block  0.6972572803497314
generate_one_block  0.6849627494812012
generate_one_block  0.7097771167755127
generate_one_block  0.7117385864257812
generate_one_block  0.6766200065612793
generate_one_block  0.6770594120025635
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03796696662902832
gen group dst list time:  0.09762215614318848
time for parepare:  0.019499778747558594
local_output_nid generation:  0.03666949272155762
local_in_edges_tensor generation:  0.04930901527404785
mini_batch_src_global generation:  0.04552721977233887
r_  generation:  0.5144422054290771
local_output_nid generation:  0.041834354400634766
local_in_edges_tensor generation:  0.040667057037353516
mini_batch_src_global generation:  0.05794572830200195
r_  generation:  0.505150556564331
local_output_nid generation:  0.04180335998535156
local_in_edges_tensor generation:  0.03560042381286621
mini_batch_src_global generation:  0.05905270576477051
r_  generation:  0.5057058334350586
local_output_nid generation:  0.04000568389892578
local_in_edges_tensor generation:  0.049396514892578125
mini_batch_src_global generation:  0.057909488677978516
r_  generation:  0.5050535202026367
local_output_nid generation:  0.03949689865112305
local_in_edges_tensor generation:  0.04012584686279297
mini_batch_src_global generation:  0.058800697326660156
r_  generation:  0.5037317276000977
local_output_nid generation:  0.040036678314208984
local_in_edges_tensor generation:  0.03810381889343262
mini_batch_src_global generation:  0.05838775634765625
r_  generation:  0.5135498046875
local_output_nid generation:  0.0403447151184082
local_in_edges_tensor generation:  0.036720991134643555
mini_batch_src_global generation:  0.062001943588256836
r_  generation:  0.5044667720794678
local_output_nid generation:  0.0405123233795166
local_in_edges_tensor generation:  0.041188955307006836
mini_batch_src_global generation:  0.062059640884399414
r_  generation:  0.5096266269683838
local_output_nid generation:  0.04034733772277832
local_in_edges_tensor generation:  0.042159318923950195
mini_batch_src_global generation:  0.05897378921508789
r_  generation:  0.5096225738525391
local_output_nid generation:  0.04055476188659668
local_in_edges_tensor generation:  0.035921335220336914
mini_batch_src_global generation:  0.05952572822570801
r_  generation:  0.509192705154419
local_output_nid generation:  0.0405116081237793
local_in_edges_tensor generation:  0.040787696838378906
mini_batch_src_global generation:  0.06254863739013672
r_  generation:  0.5117688179016113
local_output_nid generation:  0.04065394401550293
local_in_edges_tensor generation:  0.05210542678833008
mini_batch_src_global generation:  0.05839681625366211
r_  generation:  0.5109601020812988
local_output_nid generation:  0.04037308692932129
local_in_edges_tensor generation:  0.0365595817565918
mini_batch_src_global generation:  0.05954599380493164
r_  generation:  0.5097148418426514
local_output_nid generation:  0.040651559829711914
local_in_edges_tensor generation:  0.04925727844238281
mini_batch_src_global generation:  0.05812382698059082
r_  generation:  0.5092871189117432
local_output_nid generation:  0.04204583168029785
local_in_edges_tensor generation:  0.03619956970214844
mini_batch_src_global generation:  0.05879831314086914
r_  generation:  0.5122287273406982
local_output_nid generation:  0.0403749942779541
local_in_edges_tensor generation:  0.036363840103149414
mini_batch_src_global generation:  0.058823347091674805
r_  generation:  0.5116212368011475
----------------------check_connections_block total spend ----------------------------- 12.365216493606567
generate_one_block  0.652881383895874
generate_one_block  0.637963056564331
generate_one_block  0.6346096992492676
generate_one_block  0.6430130004882812
generate_one_block  0.6430861949920654
generate_one_block  0.6303660869598389
generate_one_block  0.6487596035003662
generate_one_block  0.6595954895019531
generate_one_block  0.717585563659668
generate_one_block  0.6288480758666992
generate_one_block  0.6368598937988281
generate_one_block  0.6630589962005615
generate_one_block  0.6304817199707031
generate_one_block  0.6461892127990723
generate_one_block  0.6327359676361084
generate_one_block  0.6456456184387207
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007319450378417969  GigaBytes
Max Memory Allocated: 0.0007319450378417969  GigaBytes

connection checking time:  55.794917345047
block generation total time  47.77137064933777
average batch blocks generation time:  2.9857106655836105
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2205810546875 GB
    Memory Allocated: 0.13561153411865234  GigaBytes
Max Memory Allocated: 0.13561153411865234  GigaBytes

torch.Size([167194, 128])
torch.Size([166458, 32])
torch.Size([164203, 32])
torch.Size([156190, 32])
torch.Size([124131, 32])
Traceback (most recent call last):
  File "pseudo_mini_batch_range_arxiv_sage.py", line 438, in <module>
    main()
  File "pseudo_mini_batch_range_arxiv_sage.py", line 434, in main
    best_test = run(args, device, data)
  File "pseudo_mini_batch_range_arxiv_sage.py", line 253, in run
    batch_pred = model(blocks, batch_inputs)#------------*
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/graph_partition_multi_layers/pseudo_mini_batch_full_batch/SAGE/graphsage_model_arxiv.py", line 182, in forward
    x = layer(block, x)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 258, in forward
    graph.update_all(msg_fn, self._lstm_reducer)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/heterograph.py", line 4849, in update_all
    ndata = core.message_passing(g, message_func, reduce_func, apply_node_func)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 337, in message_passing
    ndata = invoke_udf_reduce(g, rfunc, msgdata, orig_nid=orig_nid)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 138, in invoke_udf_reduce
    for k, msg in msgdata_bkt.items():
  File "/usr/lib/python3.6/_collections_abc.py", line 744, in __iter__
    yield (key, self._mapping[key])
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/frame.py", line 393, in __getitem__
    return self._columns[name].data
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/frame.py", line 122, in data
    self.storage = F.gather_row(self.storage, self.index)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/backend/pytorch/tensor.py", line 186, in gather_row
    return th.index_select(data, 0, row_index.long())
RuntimeError: CUDA out of memory. Tried to allocate 2.00 MiB (GPU 0; 23.62 GiB total capacity; 22.38 GiB already allocated; 2.44 MiB free; 22.42 GiB reserved in total by PyTorch)
