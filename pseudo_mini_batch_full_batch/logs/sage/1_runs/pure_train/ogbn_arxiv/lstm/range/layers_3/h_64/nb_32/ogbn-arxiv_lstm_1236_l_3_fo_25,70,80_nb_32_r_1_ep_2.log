Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648470549.197602
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02682042121887207
range selection method range initialization spend 0.01316380500793457
time for parepare:  0.018291950225830078
local_output_nid generation:  0.0006914138793945312
local_in_edges_tensor generation:  0.003890514373779297
mini_batch_src_global generation:  0.0014235973358154297
r_  generation:  0.009732246398925781
local_output_nid generation:  0.0007255077362060547
local_in_edges_tensor generation:  0.0005614757537841797
mini_batch_src_global generation:  0.0014753341674804688
r_  generation:  0.009426355361938477
local_output_nid generation:  0.0007412433624267578
local_in_edges_tensor generation:  0.0005235671997070312
mini_batch_src_global generation:  0.0010373592376708984
r_  generation:  0.009183168411254883
local_output_nid generation:  0.0007278919219970703
local_in_edges_tensor generation:  0.0004951953887939453
mini_batch_src_global generation:  0.0009837150573730469
r_  generation:  0.009418964385986328
local_output_nid generation:  0.0007269382476806641
local_in_edges_tensor generation:  0.0004913806915283203
mini_batch_src_global generation:  0.0009524822235107422
r_  generation:  0.009000301361083984
local_output_nid generation:  0.0007474422454833984
local_in_edges_tensor generation:  0.0004897117614746094
mini_batch_src_global generation:  0.0009419918060302734
r_  generation:  0.009191036224365234
local_output_nid generation:  0.0007259845733642578
local_in_edges_tensor generation:  0.0004897117614746094
mini_batch_src_global generation:  0.0010404586791992188
r_  generation:  0.009595155715942383
local_output_nid generation:  0.0007221698760986328
local_in_edges_tensor generation:  0.00046896934509277344
mini_batch_src_global generation:  0.0009627342224121094
r_  generation:  0.009088516235351562
local_output_nid generation:  0.0007293224334716797
local_in_edges_tensor generation:  0.0004761219024658203
mini_batch_src_global generation:  0.0010657310485839844
r_  generation:  0.009609699249267578
local_output_nid generation:  0.0007302761077880859
local_in_edges_tensor generation:  0.00047135353088378906
mini_batch_src_global generation:  0.0009694099426269531
r_  generation:  0.009338855743408203
local_output_nid generation:  0.0007202625274658203
local_in_edges_tensor generation:  0.0005214214324951172
mini_batch_src_global generation:  0.0012063980102539062
r_  generation:  0.010009050369262695
local_output_nid generation:  0.000736236572265625
local_in_edges_tensor generation:  0.00047969818115234375
mini_batch_src_global generation:  0.0010433197021484375
r_  generation:  0.009907245635986328
local_output_nid generation:  0.0007364749908447266
local_in_edges_tensor generation:  0.00047397613525390625
mini_batch_src_global generation:  0.001031637191772461
r_  generation:  0.009653806686401367
local_output_nid generation:  0.0007305145263671875
local_in_edges_tensor generation:  0.0004725456237792969
mini_batch_src_global generation:  0.0009860992431640625
r_  generation:  0.00940251350402832
local_output_nid generation:  0.0007340908050537109
local_in_edges_tensor generation:  0.0004799365997314453
mini_batch_src_global generation:  0.0010547637939453125
r_  generation:  0.00992441177368164
local_output_nid generation:  0.0007433891296386719
local_in_edges_tensor generation:  0.0004658699035644531
mini_batch_src_global generation:  0.0010554790496826172
r_  generation:  0.009522676467895508
local_output_nid generation:  0.0007350444793701172
local_in_edges_tensor generation:  0.0004711151123046875
mini_batch_src_global generation:  0.0009913444519042969
r_  generation:  0.009456872940063477
local_output_nid generation:  0.0007355213165283203
local_in_edges_tensor generation:  0.0004773139953613281
mini_batch_src_global generation:  0.001073598861694336
r_  generation:  0.009961366653442383
local_output_nid generation:  0.0007846355438232422
local_in_edges_tensor generation:  0.0004668235778808594
mini_batch_src_global generation:  0.0010418891906738281
r_  generation:  0.009808778762817383
local_output_nid generation:  0.0007266998291015625
local_in_edges_tensor generation:  0.0004737377166748047
mini_batch_src_global generation:  0.0010845661163330078
r_  generation:  0.009948492050170898
local_output_nid generation:  0.000736236572265625
local_in_edges_tensor generation:  0.00046634674072265625
mini_batch_src_global generation:  0.0010962486267089844
r_  generation:  0.009923934936523438
local_output_nid generation:  0.0007369518280029297
local_in_edges_tensor generation:  0.00047588348388671875
mini_batch_src_global generation:  0.0010423660278320312
r_  generation:  0.009708404541015625
local_output_nid generation:  0.0007359981536865234
local_in_edges_tensor generation:  0.00046634674072265625
mini_batch_src_global generation:  0.001074075698852539
r_  generation:  0.009692192077636719
local_output_nid generation:  0.0007479190826416016
local_in_edges_tensor generation:  0.00048422813415527344
mini_batch_src_global generation:  0.0011739730834960938
r_  generation:  0.009970664978027344
local_output_nid generation:  0.0007412433624267578
local_in_edges_tensor generation:  0.0004830360412597656
mini_batch_src_global generation:  0.0010685920715332031
r_  generation:  0.010184764862060547
local_output_nid generation:  0.0007510185241699219
local_in_edges_tensor generation:  0.00048089027404785156
mini_batch_src_global generation:  0.0010716915130615234
r_  generation:  0.01009988784790039
local_output_nid generation:  0.0007541179656982422
local_in_edges_tensor generation:  0.00047707557678222656
mini_batch_src_global generation:  0.0010502338409423828
r_  generation:  0.009805679321289062
local_output_nid generation:  0.0007455348968505859
local_in_edges_tensor generation:  0.0004878044128417969
mini_batch_src_global generation:  0.0010755062103271484
r_  generation:  0.010083675384521484
local_output_nid generation:  0.0007364749908447266
local_in_edges_tensor generation:  0.0004749298095703125
mini_batch_src_global generation:  0.0010852813720703125
r_  generation:  0.010564804077148438
local_output_nid generation:  0.0007796287536621094
local_in_edges_tensor generation:  0.004323244094848633
mini_batch_src_global generation:  0.0012710094451904297
r_  generation:  0.01031041145324707
local_output_nid generation:  0.0007970333099365234
local_in_edges_tensor generation:  0.0005109310150146484
mini_batch_src_global generation:  0.0011448860168457031
r_  generation:  0.010149955749511719
local_output_nid generation:  0.000774383544921875
local_in_edges_tensor generation:  0.0004885196685791016
mini_batch_src_global generation:  0.0010960102081298828
r_  generation:  0.00991511344909668
----------------------check_connections_block total spend ----------------------------- 0.4848771095275879
generate_one_block  0.015103578567504883
generate_one_block  0.014959096908569336
generate_one_block  0.014656543731689453
generate_one_block  0.015117883682250977
generate_one_block  0.014394283294677734
generate_one_block  0.014297723770141602
generate_one_block  0.014940738677978516
generate_one_block  0.0141448974609375
generate_one_block  0.014941215515136719
generate_one_block  0.014432430267333984
generate_one_block  0.015377998352050781
generate_one_block  0.014926910400390625
generate_one_block  0.014939069747924805
generate_one_block  0.014224052429199219
generate_one_block  0.015314579010009766
generate_one_block  0.014237403869628906
generate_one_block  0.01436471939086914
generate_one_block  0.015208959579467773
generate_one_block  0.014664411544799805
generate_one_block  0.015173912048339844
generate_one_block  0.014987707138061523
generate_one_block  0.014639854431152344
generate_one_block  0.014628887176513672
generate_one_block  0.015239715576171875
generate_one_block  0.015353918075561523
generate_one_block  0.01522970199584961
generate_one_block  0.015114068984985352
generate_one_block  0.015014171600341797
generate_one_block  0.015501976013183594
generate_one_block  0.014980077743530273
generate_one_block  0.015478134155273438
generate_one_block  0.014879941940307617
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04477405548095703
gen group dst list time:  0.02342534065246582
time for parepare:  0.020426273345947266
local_output_nid generation:  0.0044667720794677734
local_in_edges_tensor generation:  0.03248882293701172
mini_batch_src_global generation:  0.01590418815612793
r_  generation:  0.15243077278137207
local_output_nid generation:  0.008452892303466797
local_in_edges_tensor generation:  0.014269590377807617
mini_batch_src_global generation:  0.022129535675048828
r_  generation:  0.16579842567443848
local_output_nid generation:  0.008916616439819336
local_in_edges_tensor generation:  0.011409759521484375
mini_batch_src_global generation:  0.019360780715942383
r_  generation:  0.16511249542236328
local_output_nid generation:  0.009052276611328125
local_in_edges_tensor generation:  0.01191091537475586
mini_batch_src_global generation:  0.02063131332397461
r_  generation:  0.1725163459777832
local_output_nid generation:  0.008908748626708984
local_in_edges_tensor generation:  0.011377811431884766
mini_batch_src_global generation:  0.021233558654785156
r_  generation:  0.1705152988433838
local_output_nid generation:  0.009021759033203125
local_in_edges_tensor generation:  0.009918451309204102
mini_batch_src_global generation:  0.02068781852722168
r_  generation:  0.1672534942626953
local_output_nid generation:  0.00937199592590332
local_in_edges_tensor generation:  0.011836767196655273
mini_batch_src_global generation:  0.021570205688476562
r_  generation:  0.17614245414733887
local_output_nid generation:  0.009214639663696289
local_in_edges_tensor generation:  0.008888721466064453
mini_batch_src_global generation:  0.020798921585083008
r_  generation:  0.16658782958984375
local_output_nid generation:  0.009374856948852539
local_in_edges_tensor generation:  0.01034402847290039
mini_batch_src_global generation:  0.023177385330200195
r_  generation:  0.17459535598754883
local_output_nid generation:  0.009263038635253906
local_in_edges_tensor generation:  0.010409832000732422
mini_batch_src_global generation:  0.021149158477783203
r_  generation:  0.16699433326721191
local_output_nid generation:  0.009705066680908203
local_in_edges_tensor generation:  0.012536287307739258
mini_batch_src_global generation:  0.022096872329711914
r_  generation:  0.17729854583740234
local_output_nid generation:  0.009641170501708984
local_in_edges_tensor generation:  0.010909318923950195
mini_batch_src_global generation:  0.02268242835998535
r_  generation:  0.17301249504089355
local_output_nid generation:  0.009520292282104492
local_in_edges_tensor generation:  0.010520696640014648
mini_batch_src_global generation:  0.023751258850097656
r_  generation:  0.17757678031921387
local_output_nid generation:  0.009416341781616211
local_in_edges_tensor generation:  0.009302616119384766
mini_batch_src_global generation:  0.02171015739440918
r_  generation:  0.16826629638671875
local_output_nid generation:  0.009909629821777344
local_in_edges_tensor generation:  0.009547948837280273
mini_batch_src_global generation:  0.022937774658203125
r_  generation:  0.1857147216796875
local_output_nid generation:  0.009358644485473633
local_in_edges_tensor generation:  0.009164094924926758
mini_batch_src_global generation:  0.021530866622924805
r_  generation:  0.16936182975769043
local_output_nid generation:  0.009493350982666016
local_in_edges_tensor generation:  0.00913691520690918
mini_batch_src_global generation:  0.021719932556152344
r_  generation:  0.16950678825378418
local_output_nid generation:  0.010015010833740234
local_in_edges_tensor generation:  0.013542652130126953
mini_batch_src_global generation:  0.02324676513671875
r_  generation:  0.1840357780456543
local_output_nid generation:  0.00973653793334961
local_in_edges_tensor generation:  0.011805534362792969
mini_batch_src_global generation:  0.022256135940551758
r_  generation:  0.1732780933380127
local_output_nid generation:  0.009985685348510742
local_in_edges_tensor generation:  0.009361743927001953
mini_batch_src_global generation:  0.02251577377319336
r_  generation:  0.1763930320739746
local_output_nid generation:  0.00982809066772461
local_in_edges_tensor generation:  0.01255941390991211
mini_batch_src_global generation:  0.023015975952148438
r_  generation:  0.17810606956481934
local_output_nid generation:  0.0097198486328125
local_in_edges_tensor generation:  0.01233673095703125
mini_batch_src_global generation:  0.023099422454833984
r_  generation:  0.17515230178833008
local_output_nid generation:  0.009935617446899414
local_in_edges_tensor generation:  0.013053417205810547
mini_batch_src_global generation:  0.02245187759399414
r_  generation:  0.174238920211792
local_output_nid generation:  0.01004481315612793
local_in_edges_tensor generation:  0.011570930480957031
mini_batch_src_global generation:  0.024194717407226562
r_  generation:  0.17916107177734375
local_output_nid generation:  0.010059118270874023
local_in_edges_tensor generation:  0.012359380722045898
mini_batch_src_global generation:  0.023464679718017578
r_  generation:  0.17915129661560059
local_output_nid generation:  0.010182857513427734
local_in_edges_tensor generation:  0.012531757354736328
mini_batch_src_global generation:  0.023503780364990234
r_  generation:  0.18123364448547363
local_output_nid generation:  0.010065793991088867
local_in_edges_tensor generation:  0.010975360870361328
mini_batch_src_global generation:  0.02324080467224121
r_  generation:  0.17872142791748047
local_output_nid generation:  0.010040521621704102
local_in_edges_tensor generation:  0.010964632034301758
mini_batch_src_global generation:  0.02307724952697754
r_  generation:  0.1823725700378418
local_output_nid generation:  0.0103912353515625
local_in_edges_tensor generation:  0.013047456741333008
mini_batch_src_global generation:  0.024239778518676758
r_  generation:  0.18414759635925293
local_output_nid generation:  0.010034322738647461
local_in_edges_tensor generation:  0.00931692123413086
mini_batch_src_global generation:  0.023721933364868164
r_  generation:  0.18424129486083984
local_output_nid generation:  0.01005864143371582
local_in_edges_tensor generation:  0.010788917541503906
mini_batch_src_global generation:  0.02497386932373047
r_  generation:  0.18637323379516602
local_output_nid generation:  0.010020732879638672
local_in_edges_tensor generation:  0.009496450424194336
mini_batch_src_global generation:  0.022783517837524414
r_  generation:  0.17606019973754883
----------------------check_connections_block total spend ----------------------------- 8.304741382598877
generate_one_block  0.22433137893676758
generate_one_block  0.22597789764404297
generate_one_block  0.24198412895202637
generate_one_block  0.23301339149475098
generate_one_block  0.22390174865722656
generate_one_block  0.22179794311523438
generate_one_block  0.22627711296081543
generate_one_block  0.21712517738342285
generate_one_block  0.2247011661529541
generate_one_block  0.21726083755493164
generate_one_block  0.23071575164794922
generate_one_block  0.22339129447937012
generate_one_block  0.2275245189666748
generate_one_block  0.2185976505279541
generate_one_block  0.24273014068603516
generate_one_block  0.23720574378967285
generate_one_block  0.2173786163330078
generate_one_block  0.24317264556884766
generate_one_block  0.2178819179534912
generate_one_block  0.22414779663085938
generate_one_block  0.23224163055419922
generate_one_block  0.22634220123291016
generate_one_block  0.22131085395812988
generate_one_block  0.23885178565979004
generate_one_block  0.23370575904846191
generate_one_block  0.23552370071411133
generate_one_block  0.23464369773864746
generate_one_block  0.23114228248596191
generate_one_block  0.2417469024658203
generate_one_block  0.2312154769897461
generate_one_block  0.23935294151306152
generate_one_block  0.2268507480621338
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.037467241287231445
gen group dst list time:  0.10039019584655762
time for parepare:  0.019449949264526367
local_output_nid generation:  0.022188186645507812
local_in_edges_tensor generation:  0.03751683235168457
mini_batch_src_global generation:  0.04355621337890625
r_  generation:  0.4114096164703369
local_output_nid generation:  0.027894020080566406
local_in_edges_tensor generation:  0.04238557815551758
mini_batch_src_global generation:  0.04958772659301758
r_  generation:  0.41605138778686523
local_output_nid generation:  0.028327226638793945
local_in_edges_tensor generation:  0.03129720687866211
mini_batch_src_global generation:  0.04926729202270508
r_  generation:  0.42414093017578125
local_output_nid generation:  0.02695775032043457
local_in_edges_tensor generation:  0.03554081916809082
mini_batch_src_global generation:  0.0494387149810791
r_  generation:  0.4235265254974365
local_output_nid generation:  0.026823759078979492
local_in_edges_tensor generation:  0.03185009956359863
mini_batch_src_global generation:  0.0500798225402832
r_  generation:  0.41996121406555176
local_output_nid generation:  0.026640653610229492
local_in_edges_tensor generation:  0.03466057777404785
mini_batch_src_global generation:  0.0502622127532959
r_  generation:  0.42255258560180664
local_output_nid generation:  0.030875205993652344
local_in_edges_tensor generation:  0.031455278396606445
mini_batch_src_global generation:  0.050911664962768555
r_  generation:  0.4294881820678711
local_output_nid generation:  0.027237892150878906
local_in_edges_tensor generation:  0.0319523811340332
mini_batch_src_global generation:  0.05099987983703613
r_  generation:  0.4251983165740967
local_output_nid generation:  0.02719569206237793
local_in_edges_tensor generation:  0.03125739097595215
mini_batch_src_global generation:  0.050954341888427734
r_  generation:  0.42916083335876465
local_output_nid generation:  0.026999711990356445
local_in_edges_tensor generation:  0.027493715286254883
mini_batch_src_global generation:  0.05165457725524902
r_  generation:  0.42700839042663574
local_output_nid generation:  0.027284860610961914
local_in_edges_tensor generation:  0.03548479080200195
mini_batch_src_global generation:  0.053537607192993164
r_  generation:  0.4316093921661377
local_output_nid generation:  0.027261734008789062
local_in_edges_tensor generation:  0.02869105339050293
mini_batch_src_global generation:  0.050971269607543945
r_  generation:  0.42655515670776367
local_output_nid generation:  0.027172327041625977
local_in_edges_tensor generation:  0.03190493583679199
mini_batch_src_global generation:  0.05116152763366699
r_  generation:  0.43221426010131836
local_output_nid generation:  0.026993751525878906
local_in_edges_tensor generation:  0.03899359703063965
mini_batch_src_global generation:  0.06026053428649902
r_  generation:  0.4247262477874756
local_output_nid generation:  0.027248144149780273
local_in_edges_tensor generation:  0.03399252891540527
mini_batch_src_global generation:  0.05499529838562012
r_  generation:  0.4376101493835449
local_output_nid generation:  0.02824091911315918
local_in_edges_tensor generation:  0.03689217567443848
mini_batch_src_global generation:  0.05373334884643555
r_  generation:  0.44298648834228516
local_output_nid generation:  0.027619123458862305
local_in_edges_tensor generation:  0.03190279006958008
mini_batch_src_global generation:  0.05157947540283203
r_  generation:  0.42795801162719727
local_output_nid generation:  0.028369426727294922
local_in_edges_tensor generation:  0.037268638610839844
mini_batch_src_global generation:  0.05428194999694824
r_  generation:  0.43022751808166504
local_output_nid generation:  0.028273582458496094
local_in_edges_tensor generation:  0.033957719802856445
mini_batch_src_global generation:  0.0506443977355957
r_  generation:  0.43163633346557617
local_output_nid generation:  0.030020952224731445
local_in_edges_tensor generation:  0.026729106903076172
mini_batch_src_global generation:  0.05147838592529297
r_  generation:  0.4228861331939697
local_output_nid generation:  0.028055191040039062
local_in_edges_tensor generation:  0.026610136032104492
mini_batch_src_global generation:  0.053821563720703125
r_  generation:  0.43085455894470215
local_output_nid generation:  0.027923107147216797
local_in_edges_tensor generation:  0.03404951095581055
mini_batch_src_global generation:  0.05109596252441406
r_  generation:  0.43113088607788086
local_output_nid generation:  0.028352975845336914
local_in_edges_tensor generation:  0.029771804809570312
mini_batch_src_global generation:  0.06341838836669922
r_  generation:  0.43114709854125977
local_output_nid generation:  0.028212785720825195
local_in_edges_tensor generation:  0.03317093849182129
mini_batch_src_global generation:  0.05260777473449707
r_  generation:  0.4293060302734375
local_output_nid generation:  0.02806830406188965
local_in_edges_tensor generation:  0.02869248390197754
mini_batch_src_global generation:  0.0536799430847168
r_  generation:  0.43253231048583984
local_output_nid generation:  0.028387069702148438
local_in_edges_tensor generation:  0.02942800521850586
mini_batch_src_global generation:  0.0545201301574707
r_  generation:  0.4313993453979492
local_output_nid generation:  0.02826404571533203
local_in_edges_tensor generation:  0.03759407997131348
mini_batch_src_global generation:  0.05302119255065918
r_  generation:  0.4338040351867676
local_output_nid generation:  0.02842426300048828
local_in_edges_tensor generation:  0.02900838851928711
mini_batch_src_global generation:  0.051204681396484375
r_  generation:  0.4324452877044678
local_output_nid generation:  0.02856755256652832
local_in_edges_tensor generation:  0.02958512306213379
mini_batch_src_global generation:  0.05684041976928711
r_  generation:  0.43909668922424316
local_output_nid generation:  0.02930164337158203
local_in_edges_tensor generation:  0.03304862976074219
mini_batch_src_global generation:  0.051937103271484375
r_  generation:  0.4317512512207031
local_output_nid generation:  0.028362274169921875
local_in_edges_tensor generation:  0.027297019958496094
mini_batch_src_global generation:  0.0675652027130127
r_  generation:  0.4401569366455078
local_output_nid generation:  0.030931711196899414
local_in_edges_tensor generation:  0.03699851036071777
mini_batch_src_global generation:  0.0862882137298584
r_  generation:  0.4333689212799072
----------------------check_connections_block total spend ----------------------------- 20.558550596237183
generate_one_block  0.674299955368042
generate_one_block  0.5527782440185547
generate_one_block  0.588545560836792
generate_one_block  0.599639892578125
generate_one_block  0.6042804718017578
generate_one_block  0.585191011428833
generate_one_block  0.5794391632080078
generate_one_block  0.6075904369354248
generate_one_block  0.600604772567749
generate_one_block  0.5704927444458008
generate_one_block  0.5774822235107422
generate_one_block  0.5690479278564453
generate_one_block  0.5790660381317139
generate_one_block  0.5588276386260986
generate_one_block  0.562793493270874
generate_one_block  0.5679702758789062
generate_one_block  0.5545773506164551
generate_one_block  0.5861296653747559
generate_one_block  0.549175500869751
generate_one_block  0.546295166015625
generate_one_block  0.5884346961975098
generate_one_block  0.5677223205566406
generate_one_block  0.5651240348815918
generate_one_block  0.5740115642547607
generate_one_block  0.5537521839141846
generate_one_block  0.5725359916687012
generate_one_block  0.5590059757232666
generate_one_block  0.5541749000549316
generate_one_block  0.5720150470733643
generate_one_block  0.5622563362121582
generate_one_block  0.5612189769744873
generate_one_block  0.5698134899139404
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

connection checking time:  28.86329197883606
block generation total time  25.746337890625
average batch blocks generation time:  0.8045730590820312
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1737060546875 GB
    Memory Allocated: 0.08732271194458008  GigaBytes
Max Memory Allocated: 0.08732271194458008  GigaBytes

torch.Size([149536, 128])
torch.Size([110719, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7381591796875 GB
    Memory Allocated: 12.322319507598877  GigaBytes
Max Memory Allocated: 12.342172145843506  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7479248046875 GB
    Memory Allocated: 0.08725643157958984  GigaBytes
Max Memory Allocated: 12.342172145843506  GigaBytes

torch.Size([148420, 128])
torch.Size([109489, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0819091796875 GB
    Memory Allocated: 12.34468412399292  GigaBytes
Max Memory Allocated: 12.367645740509033  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0838623046875 GB
    Memory Allocated: 0.0870356559753418  GigaBytes
Max Memory Allocated: 12.367645740509033  GigaBytes

torch.Size([148251, 128])
torch.Size([109155, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0838623046875 GB
    Memory Allocated: 12.308425903320312  GigaBytes
Max Memory Allocated: 12.367645740509033  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0838623046875 GB
    Memory Allocated: 0.08764505386352539  GigaBytes
Max Memory Allocated: 12.367645740509033  GigaBytes

torch.Size([148999, 128])
torch.Size([110485, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7713623046875 GB
    Memory Allocated: 12.433746337890625  GigaBytes
Max Memory Allocated: 12.456816673278809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7733154296875 GB
    Memory Allocated: 0.08709192276000977  GigaBytes
Max Memory Allocated: 12.456816673278809  GigaBytes

torch.Size([148339, 128])
torch.Size([109166, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7733154296875 GB
    Memory Allocated: 12.25170087814331  GigaBytes
Max Memory Allocated: 12.456816673278809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7733154296875 GB
    Memory Allocated: 0.08716869354248047  GigaBytes
Max Memory Allocated: 12.456816673278809  GigaBytes

torch.Size([148790, 128])
torch.Size([108884, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7733154296875 GB
    Memory Allocated: 12.115785121917725  GigaBytes
Max Memory Allocated: 12.456816673278809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7733154296875 GB
    Memory Allocated: 0.08752870559692383  GigaBytes
Max Memory Allocated: 12.456816673278809  GigaBytes

torch.Size([149049, 128])
torch.Size([110145, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7733154296875 GB
    Memory Allocated: 12.330680847167969  GigaBytes
Max Memory Allocated: 12.456816673278809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7733154296875 GB
    Memory Allocated: 0.08725929260253906  GigaBytes
Max Memory Allocated: 12.456816673278809  GigaBytes

torch.Size([149080, 128])
torch.Size([109350, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7733154296875 GB
    Memory Allocated: 12.11030626296997  GigaBytes
Max Memory Allocated: 12.456816673278809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7733154296875 GB
    Memory Allocated: 0.08696651458740234  GigaBytes
Max Memory Allocated: 12.456816673278809  GigaBytes

torch.Size([148060, 128])
torch.Size([109057, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7733154296875 GB
    Memory Allocated: 12.295982837677002  GigaBytes
Max Memory Allocated: 12.456816673278809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7733154296875 GB
    Memory Allocated: 0.08684873580932617  GigaBytes
Max Memory Allocated: 12.456816673278809  GigaBytes

torch.Size([148229, 128])
torch.Size([108640, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7733154296875 GB
    Memory Allocated: 12.148723125457764  GigaBytes
Max Memory Allocated: 12.456816673278809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7733154296875 GB
    Memory Allocated: 0.08739995956420898  GigaBytes
Max Memory Allocated: 12.456816673278809  GigaBytes

torch.Size([148647, 128])
torch.Size([110220, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7733154296875 GB
    Memory Allocated: 12.364620208740234  GigaBytes
Max Memory Allocated: 12.456816673278809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7733154296875 GB
    Memory Allocated: 0.08725690841674805  GigaBytes
Max Memory Allocated: 12.456816673278809  GigaBytes

torch.Size([148641, 128])
torch.Size([109808, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7733154296875 GB
    Memory Allocated: 12.313193321228027  GigaBytes
Max Memory Allocated: 12.456816673278809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7733154296875 GB
    Memory Allocated: 0.08733272552490234  GigaBytes
Max Memory Allocated: 12.456816673278809  GigaBytes

torch.Size([148646, 128])
torch.Size([109662, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7733154296875 GB
    Memory Allocated: 12.333553791046143  GigaBytes
Max Memory Allocated: 12.456816673278809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7733154296875 GB
    Memory Allocated: 0.08714914321899414  GigaBytes
Max Memory Allocated: 12.456816673278809  GigaBytes

torch.Size([148777, 128])
torch.Size([109145, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7733154296875 GB
    Memory Allocated: 12.180500030517578  GigaBytes
Max Memory Allocated: 12.456816673278809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7733154296875 GB
    Memory Allocated: 0.08745336532592773  GigaBytes
Max Memory Allocated: 12.456816673278809  GigaBytes

torch.Size([148617, 128])
torch.Size([109644, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7733154296875 GB
    Memory Allocated: 12.413823127746582  GigaBytes
Max Memory Allocated: 12.456816673278809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7733154296875 GB
    Memory Allocated: 0.08710908889770508  GigaBytes
Max Memory Allocated: 12.456816673278809  GigaBytes

torch.Size([148781, 128])
torch.Size([108882, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7733154296875 GB
    Memory Allocated: 12.07387924194336  GigaBytes
Max Memory Allocated: 12.456816673278809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7733154296875 GB
    Memory Allocated: 0.08690881729125977  GigaBytes
Max Memory Allocated: 12.456816673278809  GigaBytes

torch.Size([148231, 128])
torch.Size([108555, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7733154296875 GB
    Memory Allocated: 12.186639308929443  GigaBytes
Max Memory Allocated: 12.456816673278809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7733154296875 GB
    Memory Allocated: 0.08784103393554688  GigaBytes
Max Memory Allocated: 12.456816673278809  GigaBytes

torch.Size([149146, 128])
torch.Size([110760, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4334716796875 GB
    Memory Allocated: 12.51342248916626  GigaBytes
Max Memory Allocated: 12.539352893829346  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4354248046875 GB
    Memory Allocated: 0.08741092681884766  GigaBytes
Max Memory Allocated: 12.539352893829346  GigaBytes

torch.Size([149142, 128])
torch.Size([109763, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4354248046875 GB
    Memory Allocated: 12.237722396850586  GigaBytes
Max Memory Allocated: 12.539352893829346  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4354248046875 GB
    Memory Allocated: 0.08720636367797852  GigaBytes
Max Memory Allocated: 12.539352893829346  GigaBytes

torch.Size([148613, 128])
torch.Size([109196, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4354248046875 GB
    Memory Allocated: 12.152678966522217  GigaBytes
Max Memory Allocated: 12.539352893829346  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4354248046875 GB
    Memory Allocated: 0.0874323844909668  GigaBytes
Max Memory Allocated: 12.539352893829346  GigaBytes

torch.Size([148721, 128])
torch.Size([109872, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4354248046875 GB
    Memory Allocated: 12.37524938583374  GigaBytes
Max Memory Allocated: 12.539352893829346  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4354248046875 GB
    Memory Allocated: 0.08745288848876953  GigaBytes
Max Memory Allocated: 12.539352893829346  GigaBytes

torch.Size([149000, 128])
torch.Size([109384, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4354248046875 GB
    Memory Allocated: 12.287298202514648  GigaBytes
Max Memory Allocated: 12.539352893829346  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4354248046875 GB
    Memory Allocated: 0.08754539489746094  GigaBytes
Max Memory Allocated: 12.539352893829346  GigaBytes

torch.Size([149222, 128])
torch.Size([110294, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4354248046875 GB
    Memory Allocated: 12.333482265472412  GigaBytes
Max Memory Allocated: 12.539352893829346  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4354248046875 GB
    Memory Allocated: 0.08746671676635742  GigaBytes
Max Memory Allocated: 12.539352893829346  GigaBytes

torch.Size([148715, 128])
torch.Size([109954, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4354248046875 GB
    Memory Allocated: 12.411877632141113  GigaBytes
Max Memory Allocated: 12.539352893829346  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4354248046875 GB
    Memory Allocated: 0.08749723434448242  GigaBytes
Max Memory Allocated: 12.539352893829346  GigaBytes

torch.Size([148853, 128])
torch.Size([109691, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4354248046875 GB
    Memory Allocated: 12.351015567779541  GigaBytes
Max Memory Allocated: 12.539352893829346  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4354248046875 GB
    Memory Allocated: 0.08755016326904297  GigaBytes
Max Memory Allocated: 12.539352893829346  GigaBytes

torch.Size([148794, 128])
torch.Size([110498, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4354248046875 GB
    Memory Allocated: 12.436833381652832  GigaBytes
Max Memory Allocated: 12.539352893829346  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4354248046875 GB
    Memory Allocated: 0.08763408660888672  GigaBytes
Max Memory Allocated: 12.539352893829346  GigaBytes

torch.Size([149094, 128])
torch.Size([109781, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4354248046875 GB
    Memory Allocated: 12.399961948394775  GigaBytes
Max Memory Allocated: 12.539352893829346  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4354248046875 GB
    Memory Allocated: 0.08750581741333008  GigaBytes
Max Memory Allocated: 12.539352893829346  GigaBytes

torch.Size([148847, 128])
torch.Size([109896, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4354248046875 GB
    Memory Allocated: 12.360663414001465  GigaBytes
Max Memory Allocated: 12.539352893829346  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4354248046875 GB
    Memory Allocated: 0.08790302276611328  GigaBytes
Max Memory Allocated: 12.539352893829346  GigaBytes

torch.Size([149248, 128])
torch.Size([110752, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4412841796875 GB
    Memory Allocated: 12.53101634979248  GigaBytes
Max Memory Allocated: 12.554371356964111  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4432373046875 GB
    Memory Allocated: 0.08738279342651367  GigaBytes
Max Memory Allocated: 12.554371356964111  GigaBytes

torch.Size([148545, 128])
torch.Size([109629, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4432373046875 GB
    Memory Allocated: 12.380678176879883  GigaBytes
Max Memory Allocated: 12.554371356964111  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4432373046875 GB
    Memory Allocated: 0.08782434463500977  GigaBytes
Max Memory Allocated: 12.554371356964111  GigaBytes

torch.Size([149159, 128])
torch.Size([110592, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4432373046875 GB
    Memory Allocated: 12.499066829681396  GigaBytes
Max Memory Allocated: 12.554371356964111  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4432373046875 GB
    Memory Allocated: 0.08739614486694336  GigaBytes
Max Memory Allocated: 12.554371356964111  GigaBytes

torch.Size([148819, 128])
torch.Size([110209, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4432373046875 GB
    Memory Allocated: 12.350298404693604  GigaBytes
Max Memory Allocated: 12.554371356964111  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.035076215863227844 |0.03305259346961975 |0.5542321726679802 |0.00010748952627182007 |0.8678219094872475 |0.013483524322509766 |
----------------------------------------------------------pseudo_mini_loss sum 4.958934783935547
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9111468
Number of first layer input nodes during this epoch:  4761011
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 15.4432373046875 GB
    Memory Allocated: 0.10919904708862305  GigaBytes
Max Memory Allocated: 12.554371356964111  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.028818607330322266
range selection method range initialization spend 0.015448570251464844
time for parepare:  0.01813054084777832
local_output_nid generation:  0.0009343624114990234
local_in_edges_tensor generation:  0.006544589996337891
mini_batch_src_global generation:  0.001783132553100586
r_  generation:  0.011209487915039062
local_output_nid generation:  0.0010273456573486328
local_in_edges_tensor generation:  0.0007069110870361328
mini_batch_src_global generation:  0.001603841781616211
r_  generation:  0.010688066482543945
local_output_nid generation:  0.0009453296661376953
local_in_edges_tensor generation:  0.0006248950958251953
mini_batch_src_global generation:  0.00112152099609375
r_  generation:  0.010016441345214844
local_output_nid generation:  0.000919342041015625
local_in_edges_tensor generation:  0.0006151199340820312
mini_batch_src_global generation:  0.0011754035949707031
r_  generation:  0.010492086410522461
local_output_nid generation:  0.0008924007415771484
local_in_edges_tensor generation:  0.0005962848663330078
mini_batch_src_global generation:  0.001154184341430664
r_  generation:  0.009876489639282227
local_output_nid generation:  0.0008847713470458984
local_in_edges_tensor generation:  0.0005848407745361328
mini_batch_src_global generation:  0.0010654926300048828
r_  generation:  0.009859085083007812
local_output_nid generation:  0.0008835792541503906
local_in_edges_tensor generation:  0.0005779266357421875
mini_batch_src_global generation:  0.0011022090911865234
r_  generation:  0.01013326644897461
local_output_nid generation:  0.0008709430694580078
local_in_edges_tensor generation:  0.0005917549133300781
mini_batch_src_global generation:  0.0011322498321533203
r_  generation:  0.010261058807373047
local_output_nid generation:  0.0009083747863769531
local_in_edges_tensor generation:  0.0006349086761474609
mini_batch_src_global generation:  0.0011985301971435547
r_  generation:  0.010740518569946289
local_output_nid generation:  0.0008881092071533203
local_in_edges_tensor generation:  0.0005855560302734375
mini_batch_src_global generation:  0.001138448715209961
r_  generation:  0.00998687744140625
local_output_nid generation:  0.0009217262268066406
local_in_edges_tensor generation:  0.0005941390991210938
mini_batch_src_global generation:  0.0011916160583496094
r_  generation:  0.010729074478149414
local_output_nid generation:  0.0008854866027832031
local_in_edges_tensor generation:  0.0005688667297363281
mini_batch_src_global generation:  0.0010962486267089844
r_  generation:  0.009729623794555664
local_output_nid generation:  0.0008673667907714844
local_in_edges_tensor generation:  0.0005784034729003906
mini_batch_src_global generation:  0.001230001449584961
r_  generation:  0.010395050048828125
local_output_nid generation:  0.0008678436279296875
local_in_edges_tensor generation:  0.0005812644958496094
mini_batch_src_global generation:  0.0011756420135498047
r_  generation:  0.010294675827026367
local_output_nid generation:  0.0008697509765625
local_in_edges_tensor generation:  0.0005900859832763672
mini_batch_src_global generation:  0.0012497901916503906
r_  generation:  0.010411977767944336
local_output_nid generation:  0.0008797645568847656
local_in_edges_tensor generation:  0.0005745887756347656
mini_batch_src_global generation:  0.0011124610900878906
r_  generation:  0.01025247573852539
local_output_nid generation:  0.0008616447448730469
local_in_edges_tensor generation:  0.0005664825439453125
mini_batch_src_global generation:  0.0012466907501220703
r_  generation:  0.010707378387451172
local_output_nid generation:  0.0008642673492431641
local_in_edges_tensor generation:  0.0005691051483154297
mini_batch_src_global generation:  0.001149892807006836
r_  generation:  0.010320663452148438
local_output_nid generation:  0.0008635520935058594
local_in_edges_tensor generation:  0.0005841255187988281
mini_batch_src_global generation:  0.0011754035949707031
r_  generation:  0.010147809982299805
local_output_nid generation:  0.0008640289306640625
local_in_edges_tensor generation:  0.0005645751953125
mini_batch_src_global generation:  0.0010960102081298828
r_  generation:  0.009866476058959961
local_output_nid generation:  0.0008718967437744141
local_in_edges_tensor generation:  0.0005784034729003906
mini_batch_src_global generation:  0.001169443130493164
r_  generation:  0.010187625885009766
local_output_nid generation:  0.0008628368377685547
local_in_edges_tensor generation:  0.0005910396575927734
mini_batch_src_global generation:  0.001186370849609375
r_  generation:  0.010693788528442383
local_output_nid generation:  0.0008726119995117188
local_in_edges_tensor generation:  0.0005588531494140625
mini_batch_src_global generation:  0.0011522769927978516
r_  generation:  0.00995945930480957
local_output_nid generation:  0.0008714199066162109
local_in_edges_tensor generation:  0.000579833984375
mini_batch_src_global generation:  0.001268148422241211
r_  generation:  0.010505914688110352
local_output_nid generation:  0.0008738040924072266
local_in_edges_tensor generation:  0.0005793571472167969
mini_batch_src_global generation:  0.0012640953063964844
r_  generation:  0.010162591934204102
local_output_nid generation:  0.0008809566497802734
local_in_edges_tensor generation:  0.0005681514739990234
mini_batch_src_global generation:  0.0011513233184814453
r_  generation:  0.010396718978881836
local_output_nid generation:  0.0008759498596191406
local_in_edges_tensor generation:  0.0005686283111572266
mini_batch_src_global generation:  0.0011136531829833984
r_  generation:  0.009901762008666992
local_output_nid generation:  0.0008707046508789062
local_in_edges_tensor generation:  0.0005743503570556641
mini_batch_src_global generation:  0.0011343955993652344
r_  generation:  0.010060787200927734
local_output_nid generation:  0.0008625984191894531
local_in_edges_tensor generation:  0.0005679130554199219
mini_batch_src_global generation:  0.001125335693359375
r_  generation:  0.010143518447875977
local_output_nid generation:  0.0008666515350341797
local_in_edges_tensor generation:  0.0005848407745361328
mini_batch_src_global generation:  0.0011975765228271484
r_  generation:  0.010682106018066406
local_output_nid generation:  0.000873565673828125
local_in_edges_tensor generation:  0.0005691051483154297
mini_batch_src_global generation:  0.0011284351348876953
r_  generation:  0.010047197341918945
local_output_nid generation:  0.0008783340454101562
local_in_edges_tensor generation:  0.0005795955657958984
mini_batch_src_global generation:  0.0011372566223144531
r_  generation:  0.010100364685058594
----------------------check_connections_block total spend ----------------------------- 0.5195662975311279
generate_one_block  0.02495265007019043
generate_one_block  0.02072453498840332
generate_one_block  0.018923282623291016
generate_one_block  0.01947021484375
generate_one_block  0.018230438232421875
generate_one_block  0.018053531646728516
generate_one_block  0.01813030242919922
generate_one_block  0.01840662956237793
generate_one_block  0.01912093162536621
generate_one_block  0.01796865463256836
generate_one_block  0.01873469352722168
generate_one_block  0.017441272735595703
generate_one_block  0.018704891204833984
generate_one_block  0.020023107528686523
generate_one_block  0.01885199546813965
generate_one_block  0.018166542053222656
generate_one_block  0.01862955093383789
generate_one_block  0.018117427825927734
generate_one_block  0.017828702926635742
generate_one_block  0.018978357315063477
generate_one_block  0.01822185516357422
generate_one_block  0.018758773803710938
generate_one_block  0.01775360107421875
generate_one_block  0.018380165100097656
generate_one_block  0.018064498901367188
generate_one_block  0.01825237274169922
generate_one_block  0.017507553100585938
generate_one_block  0.01787567138671875
generate_one_block  0.017716169357299805
generate_one_block  0.018777132034301758
generate_one_block  0.019487857818603516
generate_one_block  0.018308639526367188
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.041031599044799805
gen group dst list time:  0.021826982498168945
time for parepare:  0.023736000061035156
local_output_nid generation:  0.006841897964477539
local_in_edges_tensor generation:  0.015630483627319336
mini_batch_src_global generation:  0.018074512481689453
r_  generation:  0.17367339134216309
local_output_nid generation:  0.010271549224853516
local_in_edges_tensor generation:  0.014397859573364258
mini_batch_src_global generation:  0.02188730239868164
r_  generation:  0.18579769134521484
local_output_nid generation:  0.011629581451416016
local_in_edges_tensor generation:  0.043871164321899414
mini_batch_src_global generation:  0.02208089828491211
r_  generation:  0.17548060417175293
local_output_nid generation:  0.011042118072509766
local_in_edges_tensor generation:  0.011321067810058594
mini_batch_src_global generation:  0.023313045501708984
r_  generation:  0.1800830364227295
local_output_nid generation:  0.010976791381835938
local_in_edges_tensor generation:  0.01078653335571289
mini_batch_src_global generation:  0.021921873092651367
r_  generation:  0.17769527435302734
local_output_nid generation:  0.010866641998291016
local_in_edges_tensor generation:  0.008783102035522461
mini_batch_src_global generation:  0.022191524505615234
r_  generation:  0.17459344863891602
local_output_nid generation:  0.010577678680419922
local_in_edges_tensor generation:  0.009522199630737305
mini_batch_src_global generation:  0.023990869522094727
r_  generation:  0.17980551719665527
local_output_nid generation:  0.010938882827758789
local_in_edges_tensor generation:  0.01210641860961914
mini_batch_src_global generation:  0.023142099380493164
r_  generation:  0.18067693710327148
local_output_nid generation:  0.011599063873291016
local_in_edges_tensor generation:  0.011208772659301758
mini_batch_src_global generation:  0.025423526763916016
r_  generation:  0.19076943397521973
local_output_nid generation:  0.01118612289428711
local_in_edges_tensor generation:  0.008739709854125977
mini_batch_src_global generation:  0.022998571395874023
r_  generation:  0.1799149513244629
local_output_nid generation:  0.011464834213256836
local_in_edges_tensor generation:  0.009590864181518555
mini_batch_src_global generation:  0.023619413375854492
r_  generation:  0.18857407569885254
local_output_nid generation:  0.011040687561035156
local_in_edges_tensor generation:  0.00866389274597168
mini_batch_src_global generation:  0.02253556251525879
r_  generation:  0.1742401123046875
local_output_nid generation:  0.011614322662353516
local_in_edges_tensor generation:  0.010392427444458008
mini_batch_src_global generation:  0.02518606185913086
r_  generation:  0.18875455856323242
local_output_nid generation:  0.011317014694213867
local_in_edges_tensor generation:  0.011806726455688477
mini_batch_src_global generation:  0.023479223251342773
r_  generation:  0.18250417709350586
local_output_nid generation:  0.01162099838256836
local_in_edges_tensor generation:  0.012154579162597656
mini_batch_src_global generation:  0.025030136108398438
r_  generation:  0.18586373329162598
local_output_nid generation:  0.011500835418701172
local_in_edges_tensor generation:  0.009193181991577148
mini_batch_src_global generation:  0.02314472198486328
r_  generation:  0.18607425689697266
local_output_nid generation:  0.01180267333984375
local_in_edges_tensor generation:  0.009105682373046875
mini_batch_src_global generation:  0.0241086483001709
r_  generation:  0.18999052047729492
local_output_nid generation:  0.011299848556518555
local_in_edges_tensor generation:  0.012389898300170898
mini_batch_src_global generation:  0.023823261260986328
r_  generation:  0.1844635009765625
local_output_nid generation:  0.011303424835205078
local_in_edges_tensor generation:  0.009094715118408203
mini_batch_src_global generation:  0.02276754379272461
r_  generation:  0.17949414253234863
local_output_nid generation:  0.010879278182983398
local_in_edges_tensor generation:  0.008911371231079102
mini_batch_src_global generation:  0.022707700729370117
r_  generation:  0.1792306900024414
local_output_nid generation:  0.011029958724975586
local_in_edges_tensor generation:  0.010642051696777344
mini_batch_src_global generation:  0.024425506591796875
r_  generation:  0.18197250366210938
local_output_nid generation:  0.011224031448364258
local_in_edges_tensor generation:  0.012300252914428711
mini_batch_src_global generation:  0.024090290069580078
r_  generation:  0.18788623809814453
local_output_nid generation:  0.010939836502075195
local_in_edges_tensor generation:  0.009125709533691406
mini_batch_src_global generation:  0.023366928100585938
r_  generation:  0.17923355102539062
local_output_nid generation:  0.011137962341308594
local_in_edges_tensor generation:  0.010561704635620117
mini_batch_src_global generation:  0.024905681610107422
r_  generation:  0.1864147186279297
local_output_nid generation:  0.010843038558959961
local_in_edges_tensor generation:  0.01208353042602539
mini_batch_src_global generation:  0.023214340209960938
r_  generation:  0.1852705478668213
local_output_nid generation:  0.011114358901977539
local_in_edges_tensor generation:  0.010802268981933594
mini_batch_src_global generation:  0.025267839431762695
r_  generation:  0.18523406982421875
local_output_nid generation:  0.010747671127319336
local_in_edges_tensor generation:  0.009183168411254883
mini_batch_src_global generation:  0.02402043342590332
r_  generation:  0.1816258430480957
local_output_nid generation:  0.011073112487792969
local_in_edges_tensor generation:  0.009196281433105469
mini_batch_src_global generation:  0.023461341857910156
r_  generation:  0.18629789352416992
local_output_nid generation:  0.011125802993774414
local_in_edges_tensor generation:  0.009487152099609375
mini_batch_src_global generation:  0.023299455642700195
r_  generation:  0.18282747268676758
local_output_nid generation:  0.011408567428588867
local_in_edges_tensor generation:  0.0107421875
mini_batch_src_global generation:  0.024624347686767578
r_  generation:  0.1961350440979004
local_output_nid generation:  0.010252952575683594
local_in_edges_tensor generation:  0.020742177963256836
mini_batch_src_global generation:  0.02325129508972168
r_  generation:  0.19104313850402832
local_output_nid generation:  0.010873556137084961
local_in_edges_tensor generation:  0.012428998947143555
mini_batch_src_global generation:  0.02619481086730957
r_  generation:  0.18520617485046387
----------------------check_connections_block total spend ----------------------------- 8.728958368301392
generate_one_block  0.26180243492126465
generate_one_block  0.24987554550170898
generate_one_block  0.24673891067504883
generate_one_block  0.25555896759033203
generate_one_block  0.2727046012878418
generate_one_block  0.234771728515625
generate_one_block  0.24553632736206055
generate_one_block  0.24468445777893066
generate_one_block  0.26301050186157227
generate_one_block  0.24392390251159668
generate_one_block  0.2608017921447754
generate_one_block  0.23656082153320312
generate_one_block  0.27043724060058594
generate_one_block  0.2449798583984375
generate_one_block  0.25531959533691406
generate_one_block  0.2412092685699463
generate_one_block  0.25772690773010254
generate_one_block  0.23967194557189941
generate_one_block  0.233931303024292
generate_one_block  0.24179792404174805
generate_one_block  0.2399280071258545
generate_one_block  0.2597219944000244
generate_one_block  0.23845243453979492
generate_one_block  0.24731707572937012
generate_one_block  0.24715447425842285
generate_one_block  0.25524330139160156
generate_one_block  0.2375342845916748
generate_one_block  0.25007009506225586
generate_one_block  0.24210047721862793
generate_one_block  0.2604811191558838
generate_one_block  0.23548674583435059
generate_one_block  0.24728798866271973
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.049222469329833984
gen group dst list time:  0.11664605140686035
time for parepare:  0.018410444259643555
local_output_nid generation:  0.025649070739746094
local_in_edges_tensor generation:  0.05772805213928223
mini_batch_src_global generation:  0.041040658950805664
r_  generation:  0.42133450508117676
local_output_nid generation:  0.030161380767822266
local_in_edges_tensor generation:  0.04471588134765625
mini_batch_src_global generation:  0.05178403854370117
r_  generation:  0.4236161708831787
local_output_nid generation:  0.029280424118041992
local_in_edges_tensor generation:  0.04113435745239258
mini_batch_src_global generation:  0.05357646942138672
r_  generation:  0.4307899475097656
local_output_nid generation:  0.02855992317199707
local_in_edges_tensor generation:  0.04115104675292969
mini_batch_src_global generation:  0.05108761787414551
r_  generation:  0.4306488037109375
local_output_nid generation:  0.028943538665771484
local_in_edges_tensor generation:  0.0378873348236084
mini_batch_src_global generation:  0.05186796188354492
r_  generation:  0.4366490840911865
local_output_nid generation:  0.028607845306396484
local_in_edges_tensor generation:  0.030101537704467773
mini_batch_src_global generation:  0.06619071960449219
r_  generation:  0.43515992164611816
local_output_nid generation:  0.02894306182861328
local_in_edges_tensor generation:  0.029577970504760742
mini_batch_src_global generation:  0.05175447463989258
r_  generation:  0.43647027015686035
local_output_nid generation:  0.028886795043945312
local_in_edges_tensor generation:  0.03267955780029297
mini_batch_src_global generation:  0.05249738693237305
r_  generation:  0.4330730438232422
local_output_nid generation:  0.029223918914794922
local_in_edges_tensor generation:  0.0424799919128418
mini_batch_src_global generation:  0.05525779724121094
r_  generation:  0.4420328140258789
local_output_nid generation:  0.02893209457397461
local_in_edges_tensor generation:  0.03034520149230957
mini_batch_src_global generation:  0.052713871002197266
r_  generation:  0.4387514591217041
local_output_nid generation:  0.02942061424255371
local_in_edges_tensor generation:  0.02994680404663086
mini_batch_src_global generation:  0.052764892578125
r_  generation:  0.4439387321472168
local_output_nid generation:  0.02885270118713379
local_in_edges_tensor generation:  0.029980897903442383
mini_batch_src_global generation:  0.05258011817932129
r_  generation:  0.43181824684143066
local_output_nid generation:  0.031675100326538086
local_in_edges_tensor generation:  0.030002832412719727
mini_batch_src_global generation:  0.05270504951477051
r_  generation:  0.43889737129211426
local_output_nid generation:  0.029058218002319336
local_in_edges_tensor generation:  0.041217803955078125
mini_batch_src_global generation:  0.0524754524230957
r_  generation:  0.43672728538513184
local_output_nid generation:  0.029423952102661133
local_in_edges_tensor generation:  0.03392601013183594
mini_batch_src_global generation:  0.05585741996765137
r_  generation:  0.4500739574432373
local_output_nid generation:  0.02928018569946289
local_in_edges_tensor generation:  0.03151512145996094
mini_batch_src_global generation:  0.05271649360656738
r_  generation:  0.4413745403289795
local_output_nid generation:  0.02971959114074707
local_in_edges_tensor generation:  0.031145572662353516
mini_batch_src_global generation:  0.055738210678100586
r_  generation:  0.44538164138793945
local_output_nid generation:  0.03128623962402344
local_in_edges_tensor generation:  0.03151226043701172
mini_batch_src_global generation:  0.05310392379760742
r_  generation:  0.4344151020050049
local_output_nid generation:  0.029404163360595703
local_in_edges_tensor generation:  0.034507036209106445
mini_batch_src_global generation:  0.05475330352783203
r_  generation:  0.4362447261810303
local_output_nid generation:  0.029381752014160156
local_in_edges_tensor generation:  0.03947329521179199
mini_batch_src_global generation:  0.05217432975769043
r_  generation:  0.43831467628479004
local_output_nid generation:  0.029338598251342773
local_in_edges_tensor generation:  0.03767824172973633
mini_batch_src_global generation:  0.05172109603881836
r_  generation:  0.44163966178894043
local_output_nid generation:  0.030514955520629883
local_in_edges_tensor generation:  0.03143453598022461
mini_batch_src_global generation:  0.05559897422790527
r_  generation:  0.4519026279449463
local_output_nid generation:  0.029250144958496094
local_in_edges_tensor generation:  0.040010929107666016
mini_batch_src_global generation:  0.05951833724975586
r_  generation:  0.4356982707977295
local_output_nid generation:  0.029536724090576172
local_in_edges_tensor generation:  0.043221235275268555
mini_batch_src_global generation:  0.06279969215393066
r_  generation:  0.4430065155029297
local_output_nid generation:  0.031136035919189453
local_in_edges_tensor generation:  0.03797292709350586
mini_batch_src_global generation:  0.05198407173156738
r_  generation:  0.43779778480529785
local_output_nid generation:  0.029961109161376953
local_in_edges_tensor generation:  0.030585527420043945
mini_batch_src_global generation:  0.052109479904174805
r_  generation:  0.438387393951416
local_output_nid generation:  0.030060529708862305
local_in_edges_tensor generation:  0.035877227783203125
mini_batch_src_global generation:  0.05121111869812012
r_  generation:  0.4417757987976074
local_output_nid generation:  0.030578136444091797
local_in_edges_tensor generation:  0.0346221923828125
mini_batch_src_global generation:  0.05321145057678223
r_  generation:  0.4412503242492676
local_output_nid generation:  0.03023386001586914
local_in_edges_tensor generation:  0.041477203369140625
mini_batch_src_global generation:  0.05178022384643555
r_  generation:  0.438586950302124
local_output_nid generation:  0.030560970306396484
local_in_edges_tensor generation:  0.034334659576416016
mini_batch_src_global generation:  0.07167172431945801
r_  generation:  0.4470479488372803
local_output_nid generation:  0.030092716217041016
local_in_edges_tensor generation:  0.0301973819732666
mini_batch_src_global generation:  0.05207705497741699
r_  generation:  0.43967366218566895
local_output_nid generation:  0.030124902725219727
local_in_edges_tensor generation:  0.0375211238861084
mini_batch_src_global generation:  0.05478167533874512
r_  generation:  0.44805026054382324
----------------------check_connections_block total spend ----------------------------- 21.027909517288208
generate_one_block  0.5947647094726562
generate_one_block  0.5808875560760498
generate_one_block  0.5940361022949219
generate_one_block  0.5880281925201416
generate_one_block  0.6904606819152832
generate_one_block  0.5723648071289062
generate_one_block  0.5853836536407471
generate_one_block  0.5846385955810547
generate_one_block  0.5996267795562744
generate_one_block  0.5848708152770996
generate_one_block  0.5934288501739502
generate_one_block  0.5696780681610107
generate_one_block  0.5849423408508301
generate_one_block  0.6101579666137695
generate_one_block  0.5874907970428467
generate_one_block  0.5791378021240234
generate_one_block  0.6177628040313721
generate_one_block  0.5886733531951904
generate_one_block  0.5791366100311279
generate_one_block  0.5764679908752441
generate_one_block  0.5783786773681641
generate_one_block  0.5981221199035645
generate_one_block  0.5852344036102295
generate_one_block  0.5833649635314941
generate_one_block  0.6041080951690674
generate_one_block  0.5915277004241943
generate_one_block  0.5888078212738037
generate_one_block  0.6091532707214355
generate_one_block  0.5732641220092773
generate_one_block  0.5866744518280029
generate_one_block  0.5715081691741943
generate_one_block  0.5837743282318115
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 15.4432373046875 GB
    Memory Allocated: 0.10919904708862305  GigaBytes
Max Memory Allocated: 12.554371356964111  GigaBytes

connection checking time:  29.7568678855896
block generation total time  26.877678632736206
average batch blocks generation time:  0.8399274572730064
block dataloader generation time/epoch 60.120434522628784
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4432373046875 GB
    Memory Allocated: 0.08905601501464844  GigaBytes
Max Memory Allocated: 12.554371356964111  GigaBytes

torch.Size([148577, 128])
torch.Size([109765, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4432373046875 GB
    Memory Allocated: 12.367527484893799  GigaBytes
Max Memory Allocated: 12.554371356964111  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4432373046875 GB
    Memory Allocated: 0.08901548385620117  GigaBytes
Max Memory Allocated: 12.554371356964111  GigaBytes

torch.Size([148545, 128])
torch.Size([109424, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4432373046875 GB
    Memory Allocated: 12.312678337097168  GigaBytes
Max Memory Allocated: 12.554371356964111  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4432373046875 GB
    Memory Allocated: 0.08926010131835938  GigaBytes
Max Memory Allocated: 12.554371356964111  GigaBytes

torch.Size([148936, 128])
torch.Size([110107, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4432373046875 GB
    Memory Allocated: 12.382919311523438  GigaBytes
Max Memory Allocated: 12.554371356964111  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4432373046875 GB
    Memory Allocated: 0.08941841125488281  GigaBytes
Max Memory Allocated: 12.554371356964111  GigaBytes

torch.Size([149008, 128])
torch.Size([110291, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4432373046875 GB
    Memory Allocated: 12.480585098266602  GigaBytes
Max Memory Allocated: 12.554371356964111  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4432373046875 GB
    Memory Allocated: 0.089447021484375  GigaBytes
Max Memory Allocated: 12.554371356964111  GigaBytes

torch.Size([149492, 128])
torch.Size([110357, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4432373046875 GB
    Memory Allocated: 12.39087438583374  GigaBytes
Max Memory Allocated: 12.554371356964111  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4432373046875 GB
    Memory Allocated: 0.0887594223022461  GigaBytes
Max Memory Allocated: 12.554371356964111  GigaBytes

torch.Size([148424, 128])
torch.Size([108963, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4432373046875 GB
    Memory Allocated: 12.213517189025879  GigaBytes
Max Memory Allocated: 12.554371356964111  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4432373046875 GB
    Memory Allocated: 0.08916187286376953  GigaBytes
Max Memory Allocated: 12.554371356964111  GigaBytes

torch.Size([148870, 128])
torch.Size([109496, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4432373046875 GB
    Memory Allocated: 12.346062183380127  GigaBytes
Max Memory Allocated: 12.554371356964111  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4432373046875 GB
    Memory Allocated: 0.08911752700805664  GigaBytes
Max Memory Allocated: 12.554371356964111  GigaBytes

torch.Size([148891, 128])
torch.Size([109530, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4432373046875 GB
    Memory Allocated: 12.311149597167969  GigaBytes
Max Memory Allocated: 12.554371356964111  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4432373046875 GB
    Memory Allocated: 0.09080123901367188  GigaBytes
Max Memory Allocated: 12.554371356964111  GigaBytes

torch.Size([149613, 128])
torch.Size([111823, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0936279296875 GB
    Memory Allocated: 12.621597290039062  GigaBytes
Max Memory Allocated: 12.646070957183838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0936279296875 GB
    Memory Allocated: 0.08893728256225586  GigaBytes
Max Memory Allocated: 12.646070957183838  GigaBytes

torch.Size([148633, 128])
torch.Size([109583, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0936279296875 GB
    Memory Allocated: 12.270714282989502  GigaBytes
Max Memory Allocated: 12.646070957183838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0936279296875 GB
    Memory Allocated: 0.08954858779907227  GigaBytes
Max Memory Allocated: 12.646070957183838  GigaBytes

torch.Size([149361, 128])
torch.Size([111177, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0936279296875 GB
    Memory Allocated: 12.47684097290039  GigaBytes
Max Memory Allocated: 12.646070957183838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0936279296875 GB
    Memory Allocated: 0.08860445022583008  GigaBytes
Max Memory Allocated: 12.646070957183838  GigaBytes

torch.Size([148459, 128])
torch.Size([108233, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0936279296875 GB
    Memory Allocated: 12.103935718536377  GigaBytes
Max Memory Allocated: 12.646070957183838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0936279296875 GB
    Memory Allocated: 0.08919906616210938  GigaBytes
Max Memory Allocated: 12.646070957183838  GigaBytes

torch.Size([148718, 128])
torch.Size([109544, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0936279296875 GB
    Memory Allocated: 12.384302616119385  GigaBytes
Max Memory Allocated: 12.646070957183838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0936279296875 GB
    Memory Allocated: 0.0890192985534668  GigaBytes
Max Memory Allocated: 12.646070957183838  GigaBytes

torch.Size([148665, 128])
torch.Size([109616, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0936279296875 GB
    Memory Allocated: 12.332391738891602  GigaBytes
Max Memory Allocated: 12.646070957183838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0936279296875 GB
    Memory Allocated: 0.08934211730957031  GigaBytes
Max Memory Allocated: 12.646070957183838  GigaBytes

torch.Size([149116, 128])
torch.Size([110359, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0936279296875 GB
    Memory Allocated: 12.383964538574219  GigaBytes
Max Memory Allocated: 12.646070957183838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0936279296875 GB
    Memory Allocated: 0.08924055099487305  GigaBytes
Max Memory Allocated: 12.646070957183838  GigaBytes

torch.Size([149237, 128])
torch.Size([109775, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0936279296875 GB
    Memory Allocated: 12.203332901000977  GigaBytes
Max Memory Allocated: 12.646070957183838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0936279296875 GB
    Memory Allocated: 0.08943796157836914  GigaBytes
Max Memory Allocated: 12.646070957183838  GigaBytes

torch.Size([148949, 128])
torch.Size([110881, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0936279296875 GB
    Memory Allocated: 12.51386833190918  GigaBytes
Max Memory Allocated: 12.646070957183838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0936279296875 GB
    Memory Allocated: 0.0887455940246582  GigaBytes
Max Memory Allocated: 12.646070957183838  GigaBytes

torch.Size([148231, 128])
torch.Size([108750, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0936279296875 GB
    Memory Allocated: 12.236883640289307  GigaBytes
Max Memory Allocated: 12.646070957183838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0936279296875 GB
    Memory Allocated: 0.08905935287475586  GigaBytes
Max Memory Allocated: 12.646070957183838  GigaBytes

torch.Size([149057, 128])
torch.Size([109602, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0936279296875 GB
    Memory Allocated: 12.238050937652588  GigaBytes
Max Memory Allocated: 12.646070957183838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0936279296875 GB
    Memory Allocated: 0.08879804611206055  GigaBytes
Max Memory Allocated: 12.646070957183838  GigaBytes

torch.Size([148545, 128])
torch.Size([108851, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0936279296875 GB
    Memory Allocated: 12.201465606689453  GigaBytes
Max Memory Allocated: 12.646070957183838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0936279296875 GB
    Memory Allocated: 0.08896017074584961  GigaBytes
Max Memory Allocated: 12.646070957183838  GigaBytes

torch.Size([148687, 128])
torch.Size([109862, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0936279296875 GB
    Memory Allocated: 12.298454284667969  GigaBytes
Max Memory Allocated: 12.646070957183838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0936279296875 GB
    Memory Allocated: 0.08937263488769531  GigaBytes
Max Memory Allocated: 12.646070957183838  GigaBytes

torch.Size([149036, 128])
torch.Size([110337, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0936279296875 GB
    Memory Allocated: 12.430157661437988  GigaBytes
Max Memory Allocated: 12.646070957183838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0936279296875 GB
    Memory Allocated: 0.08884477615356445  GigaBytes
Max Memory Allocated: 12.646070957183838  GigaBytes

torch.Size([148515, 128])
torch.Size([109023, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0936279296875 GB
    Memory Allocated: 12.242853164672852  GigaBytes
Max Memory Allocated: 12.646070957183838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0936279296875 GB
    Memory Allocated: 0.08927011489868164  GigaBytes
Max Memory Allocated: 12.646070957183838  GigaBytes

torch.Size([149039, 128])
torch.Size([110138, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0936279296875 GB
    Memory Allocated: 12.375186443328857  GigaBytes
Max Memory Allocated: 12.646070957183838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0936279296875 GB
    Memory Allocated: 0.08907938003540039  GigaBytes
Max Memory Allocated: 12.646070957183838  GigaBytes

torch.Size([148805, 128])
torch.Size([109577, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0936279296875 GB
    Memory Allocated: 12.329474925994873  GigaBytes
Max Memory Allocated: 12.646070957183838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0936279296875 GB
    Memory Allocated: 0.08887481689453125  GigaBytes
Max Memory Allocated: 12.646070957183838  GigaBytes

torch.Size([148412, 128])
torch.Size([108991, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0936279296875 GB
    Memory Allocated: 12.283940315246582  GigaBytes
Max Memory Allocated: 12.646070957183838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0936279296875 GB
    Memory Allocated: 0.08882617950439453  GigaBytes
Max Memory Allocated: 12.646070957183838  GigaBytes

torch.Size([148636, 128])
torch.Size([108766, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0936279296875 GB
    Memory Allocated: 12.219433784484863  GigaBytes
Max Memory Allocated: 12.646070957183838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0936279296875 GB
    Memory Allocated: 0.08954906463623047  GigaBytes
Max Memory Allocated: 12.646070957183838  GigaBytes

torch.Size([149634, 128])
torch.Size([111294, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0936279296875 GB
    Memory Allocated: 12.386911869049072  GigaBytes
Max Memory Allocated: 12.646070957183838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0936279296875 GB
    Memory Allocated: 0.08916282653808594  GigaBytes
Max Memory Allocated: 12.646070957183838  GigaBytes

torch.Size([149194, 128])
torch.Size([109649, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0936279296875 GB
    Memory Allocated: 12.27933406829834  GigaBytes
Max Memory Allocated: 12.646070957183838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0936279296875 GB
    Memory Allocated: 0.08942556381225586  GigaBytes
Max Memory Allocated: 12.646070957183838  GigaBytes

torch.Size([148859, 128])
torch.Size([110991, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0936279296875 GB
    Memory Allocated: 12.537923812866211  GigaBytes
Max Memory Allocated: 12.646070957183838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0936279296875 GB
    Memory Allocated: 0.08892345428466797  GigaBytes
Max Memory Allocated: 12.646070957183838  GigaBytes

torch.Size([148970, 128])
torch.Size([108783, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0936279296875 GB
    Memory Allocated: 12.082629680633545  GigaBytes
Max Memory Allocated: 12.646070957183838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0936279296875 GB
    Memory Allocated: 0.08919048309326172  GigaBytes
Max Memory Allocated: 12.646070957183838  GigaBytes

torch.Size([148934, 128])
torch.Size([109934, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0936279296875 GB
    Memory Allocated: 12.359508514404297  GigaBytes
Max Memory Allocated: 12.646070957183838  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.030147694051265717 |0.021466828882694244 |0.5286900028586388 |9.720027446746826e-05 |0.8339027240872383 |0.007840394973754883 |
----------------------------------------------------------pseudo_mini_loss sum 3.791058301925659
Total (block generation + training)time/epoch 105.44523000717163
Training time/epoch 45.32452726364136
Training time without block to device /epoch 44.63758873939514
Training time without total dataloading part /epoch 43.61391806602478
load block tensor time/epoch 0.9647262096405029
block to device time/epoch 0.6869385242462158
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9117141
Number of first layer input nodes during this epoch:  4764048
