Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648489906.3739357
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002379894256591797  GigaBytes
Max Memory Allocated: 0.002379894256591797  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.024850845336914062
range selection method range initialization spend 0.01343679428100586
time for parepare:  0.017676115036010742
local_output_nid generation:  0.0006933212280273438
local_in_edges_tensor generation:  0.0034368038177490234
mini_batch_src_global generation:  0.0013194084167480469
r_  generation:  0.008726119995117188
local_output_nid generation:  0.0007579326629638672
local_in_edges_tensor generation:  0.0005776882171630859
mini_batch_src_global generation:  0.00130462646484375
r_  generation:  0.008102178573608398
local_output_nid generation:  0.0007431507110595703
local_in_edges_tensor generation:  0.0005106925964355469
mini_batch_src_global generation:  0.0008525848388671875
r_  generation:  0.0075397491455078125
local_output_nid generation:  0.0007104873657226562
local_in_edges_tensor generation:  0.0004763603210449219
mini_batch_src_global generation:  0.0007619857788085938
r_  generation:  0.0076639652252197266
local_output_nid generation:  0.0006999969482421875
local_in_edges_tensor generation:  0.00047206878662109375
mini_batch_src_global generation:  0.0007672309875488281
r_  generation:  0.007697343826293945
local_output_nid generation:  0.0007088184356689453
local_in_edges_tensor generation:  0.00045943260192871094
mini_batch_src_global generation:  0.0007700920104980469
r_  generation:  0.007945060729980469
local_output_nid generation:  0.0007026195526123047
local_in_edges_tensor generation:  0.0004591941833496094
mini_batch_src_global generation:  0.0007734298706054688
r_  generation:  0.007997989654541016
local_output_nid generation:  0.0007131099700927734
local_in_edges_tensor generation:  0.00046062469482421875
mini_batch_src_global generation:  0.0008676052093505859
r_  generation:  0.007930994033813477
local_output_nid generation:  0.0007562637329101562
local_in_edges_tensor generation:  0.00047898292541503906
mini_batch_src_global generation:  0.0008254051208496094
r_  generation:  0.008078813552856445
local_output_nid generation:  0.0007040500640869141
local_in_edges_tensor generation:  0.000461578369140625
mini_batch_src_global generation:  0.0008196830749511719
r_  generation:  0.008051395416259766
local_output_nid generation:  0.0007116794586181641
local_in_edges_tensor generation:  0.0004525184631347656
mini_batch_src_global generation:  0.0008141994476318359
r_  generation:  0.008157730102539062
local_output_nid generation:  0.000701904296875
local_in_edges_tensor generation:  0.00045752525329589844
mini_batch_src_global generation:  0.0007984638214111328
r_  generation:  0.008147239685058594
local_output_nid generation:  0.0007104873657226562
local_in_edges_tensor generation:  0.0004780292510986328
mini_batch_src_global generation:  0.0008134841918945312
r_  generation:  0.007735252380371094
local_output_nid generation:  0.0007410049438476562
local_in_edges_tensor generation:  0.0004467964172363281
mini_batch_src_global generation:  0.0008175373077392578
r_  generation:  0.007895708084106445
local_output_nid generation:  0.0007238388061523438
local_in_edges_tensor generation:  0.00046706199645996094
mini_batch_src_global generation:  0.0007851123809814453
r_  generation:  0.008111238479614258
local_output_nid generation:  0.0006954669952392578
local_in_edges_tensor generation:  0.0004563331604003906
mini_batch_src_global generation:  0.0007822513580322266
r_  generation:  0.007972002029418945
local_output_nid generation:  0.0007150173187255859
local_in_edges_tensor generation:  0.0004634857177734375
mini_batch_src_global generation:  0.0009367465972900391
r_  generation:  0.008100509643554688
local_output_nid generation:  0.0007126331329345703
local_in_edges_tensor generation:  0.00045800209045410156
mini_batch_src_global generation:  0.0008056163787841797
r_  generation:  0.007972002029418945
local_output_nid generation:  0.0007202625274658203
local_in_edges_tensor generation:  0.0004467964172363281
mini_batch_src_global generation:  0.0007944107055664062
r_  generation:  0.007905960083007812
local_output_nid generation:  0.0007050037384033203
local_in_edges_tensor generation:  0.0004482269287109375
mini_batch_src_global generation:  0.0008037090301513672
r_  generation:  0.008034229278564453
local_output_nid generation:  0.0007364749908447266
local_in_edges_tensor generation:  0.00044274330139160156
mini_batch_src_global generation:  0.0007939338684082031
r_  generation:  0.007908821105957031
local_output_nid generation:  0.0007073879241943359
local_in_edges_tensor generation:  0.0004489421844482422
mini_batch_src_global generation:  0.0008749961853027344
r_  generation:  0.008180379867553711
local_output_nid generation:  0.0007050037384033203
local_in_edges_tensor generation:  0.0004467964172363281
mini_batch_src_global generation:  0.000797271728515625
r_  generation:  0.00807499885559082
local_output_nid generation:  0.0007128715515136719
local_in_edges_tensor generation:  0.0004410743713378906
mini_batch_src_global generation:  0.0007939338684082031
r_  generation:  0.007959842681884766
local_output_nid generation:  0.0006945133209228516
local_in_edges_tensor generation:  0.0004515647888183594
mini_batch_src_global generation:  0.0008211135864257812
r_  generation:  0.008347749710083008
local_output_nid generation:  0.0006973743438720703
local_in_edges_tensor generation:  0.0004839897155761719
mini_batch_src_global generation:  0.0008378028869628906
r_  generation:  0.008110761642456055
local_output_nid generation:  0.0007174015045166016
local_in_edges_tensor generation:  0.00044989585876464844
mini_batch_src_global generation:  0.0008001327514648438
r_  generation:  0.008138656616210938
local_output_nid generation:  0.0006988048553466797
local_in_edges_tensor generation:  0.0004439353942871094
mini_batch_src_global generation:  0.0007917881011962891
r_  generation:  0.007863998413085938
local_output_nid generation:  0.0007081031799316406
local_in_edges_tensor generation:  0.0004582405090332031
mini_batch_src_global generation:  0.0008199214935302734
r_  generation:  0.00811147689819336
local_output_nid generation:  0.0006990432739257812
local_in_edges_tensor generation:  0.0004558563232421875
mini_batch_src_global generation:  0.0008165836334228516
r_  generation:  0.008354425430297852
local_output_nid generation:  0.0007123947143554688
local_in_edges_tensor generation:  0.00395512580871582
mini_batch_src_global generation:  0.0009746551513671875
r_  generation:  0.007863521575927734
local_output_nid generation:  0.0007660388946533203
local_in_edges_tensor generation:  0.0004754066467285156
mini_batch_src_global generation:  0.0008680820465087891
r_  generation:  0.007833003997802734
----------------------check_connections_block total spend ----------------------------- 0.4092731475830078
generate_one_block  0.013853311538696289
generate_one_block  0.013189077377319336
generate_one_block  0.012836933135986328
generate_one_block  0.013018608093261719
generate_one_block  0.013224601745605469
generate_one_block  0.013050556182861328
generate_one_block  0.013124465942382812
generate_one_block  0.013231515884399414
generate_one_block  0.013304471969604492
generate_one_block  0.013481378555297852
generate_one_block  0.01335597038269043
generate_one_block  0.012979984283447266
generate_one_block  0.012539863586425781
generate_one_block  0.01272726058959961
generate_one_block  0.013049125671386719
generate_one_block  0.01281595230102539
generate_one_block  0.013193845748901367
generate_one_block  0.012909650802612305
generate_one_block  0.01291656494140625
generate_one_block  0.013122081756591797
generate_one_block  0.012861251831054688
generate_one_block  0.013124465942382812
generate_one_block  0.013049602508544922
generate_one_block  0.013114452362060547
generate_one_block  0.013564586639404297
generate_one_block  0.012923479080200195
generate_one_block  0.0130462646484375
generate_one_block  0.012781381607055664
generate_one_block  0.013107061386108398
generate_one_block  0.013319253921508789
generate_one_block  0.012889385223388672
generate_one_block  0.012773275375366211
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.043488502502441406
gen group dst list time:  0.02135157585144043
time for parepare:  0.01898336410522461
local_output_nid generation:  0.003807544708251953
local_in_edges_tensor generation:  0.011855602264404297
mini_batch_src_global generation:  0.011972427368164062
r_  generation:  0.12139225006103516
local_output_nid generation:  0.006353139877319336
local_in_edges_tensor generation:  0.010126352310180664
mini_batch_src_global generation:  0.015151500701904297
r_  generation:  0.12830305099487305
local_output_nid generation:  0.006451606750488281
local_in_edges_tensor generation:  0.007973670959472656
mini_batch_src_global generation:  0.013669967651367188
r_  generation:  0.12624049186706543
local_output_nid generation:  0.0063669681549072266
local_in_edges_tensor generation:  0.007930278778076172
mini_batch_src_global generation:  0.014889717102050781
r_  generation:  0.12935733795166016
local_output_nid generation:  0.006499052047729492
local_in_edges_tensor generation:  0.009338617324829102
mini_batch_src_global generation:  0.01586294174194336
r_  generation:  0.1347653865814209
local_output_nid generation:  0.0064313411712646484
local_in_edges_tensor generation:  0.009119987487792969
mini_batch_src_global generation:  0.015494346618652344
r_  generation:  0.1323859691619873
local_output_nid generation:  0.00661015510559082
local_in_edges_tensor generation:  0.0072002410888671875
mini_batch_src_global generation:  0.01635122299194336
r_  generation:  0.13560938835144043
local_output_nid generation:  0.006655693054199219
local_in_edges_tensor generation:  0.009356021881103516
mini_batch_src_global generation:  0.01652669906616211
r_  generation:  0.13876700401306152
local_output_nid generation:  0.006691694259643555
local_in_edges_tensor generation:  0.009528875350952148
mini_batch_src_global generation:  0.016605615615844727
r_  generation:  0.1406707763671875
local_output_nid generation:  0.006801128387451172
local_in_edges_tensor generation:  0.008579492568969727
mini_batch_src_global generation:  0.01703953742980957
r_  generation:  0.1397242546081543
local_output_nid generation:  0.006775856018066406
local_in_edges_tensor generation:  0.00959014892578125
mini_batch_src_global generation:  0.016602754592895508
r_  generation:  0.13723111152648926
local_output_nid generation:  0.006737470626831055
local_in_edges_tensor generation:  0.007438182830810547
mini_batch_src_global generation:  0.016451120376586914
r_  generation:  0.13582253456115723
local_output_nid generation:  0.006611824035644531
local_in_edges_tensor generation:  0.009100914001464844
mini_batch_src_global generation:  0.0162503719329834
r_  generation:  0.13248944282531738
local_output_nid generation:  0.006766557693481445
local_in_edges_tensor generation:  0.007530927658081055
mini_batch_src_global generation:  0.017380475997924805
r_  generation:  0.1373310089111328
local_output_nid generation:  0.006987810134887695
local_in_edges_tensor generation:  0.00958871841430664
mini_batch_src_global generation:  0.016591548919677734
r_  generation:  0.1377396583557129
local_output_nid generation:  0.006736040115356445
local_in_edges_tensor generation:  0.007237672805786133
mini_batch_src_global generation:  0.016539573669433594
r_  generation:  0.13518905639648438
local_output_nid generation:  0.006971597671508789
local_in_edges_tensor generation:  0.009647607803344727
mini_batch_src_global generation:  0.0175020694732666
r_  generation:  0.13674640655517578
local_output_nid generation:  0.006936311721801758
local_in_edges_tensor generation:  0.008786678314208984
mini_batch_src_global generation:  0.016936779022216797
r_  generation:  0.13718509674072266
local_output_nid generation:  0.006974935531616211
local_in_edges_tensor generation:  0.00969552993774414
mini_batch_src_global generation:  0.016967058181762695
r_  generation:  0.14034223556518555
local_output_nid generation:  0.0070455074310302734
local_in_edges_tensor generation:  0.008663177490234375
mini_batch_src_global generation:  0.016600608825683594
r_  generation:  0.13924789428710938
local_output_nid generation:  0.006921529769897461
local_in_edges_tensor generation:  0.00743865966796875
mini_batch_src_global generation:  0.0160524845123291
r_  generation:  0.13410139083862305
local_output_nid generation:  0.0070743560791015625
local_in_edges_tensor generation:  0.008152484893798828
mini_batch_src_global generation:  0.017508506774902344
r_  generation:  0.13919305801391602
local_output_nid generation:  0.006925106048583984
local_in_edges_tensor generation:  0.009927511215209961
mini_batch_src_global generation:  0.01721978187561035
r_  generation:  0.1393144130706787
local_output_nid generation:  0.006955385208129883
local_in_edges_tensor generation:  0.009816169738769531
mini_batch_src_global generation:  0.016996145248413086
r_  generation:  0.1405935287475586
local_output_nid generation:  0.00705409049987793
local_in_edges_tensor generation:  0.0099945068359375
mini_batch_src_global generation:  0.01711106300354004
r_  generation:  0.14142489433288574
local_output_nid generation:  0.0070552825927734375
local_in_edges_tensor generation:  0.007796764373779297
mini_batch_src_global generation:  0.016555070877075195
r_  generation:  0.1371169090270996
local_output_nid generation:  0.007065534591674805
local_in_edges_tensor generation:  0.008603572845458984
mini_batch_src_global generation:  0.01631307601928711
r_  generation:  0.13776111602783203
local_output_nid generation:  0.006965160369873047
local_in_edges_tensor generation:  0.007693052291870117
mini_batch_src_global generation:  0.016669034957885742
r_  generation:  0.13702178001403809
local_output_nid generation:  0.007155418395996094
local_in_edges_tensor generation:  0.009505748748779297
mini_batch_src_global generation:  0.01671624183654785
r_  generation:  0.1446361541748047
local_output_nid generation:  0.00717926025390625
local_in_edges_tensor generation:  0.009983539581298828
mini_batch_src_global generation:  0.017174720764160156
r_  generation:  0.14285492897033691
local_output_nid generation:  0.006782054901123047
local_in_edges_tensor generation:  0.007514476776123047
mini_batch_src_global generation:  0.016292095184326172
r_  generation:  0.13380813598632812
local_output_nid generation:  0.006961822509765625
local_in_edges_tensor generation:  0.008319616317749023
mini_batch_src_global generation:  0.01604914665222168
r_  generation:  0.1372671127319336
----------------------check_connections_block total spend ----------------------------- 6.439290523529053
generate_one_block  0.17737460136413574
generate_one_block  0.17215418815612793
generate_one_block  0.18804264068603516
generate_one_block  0.17168116569519043
generate_one_block  0.17697548866271973
generate_one_block  0.1676168441772461
generate_one_block  0.17416977882385254
generate_one_block  0.18153619766235352
generate_one_block  0.17420458793640137
generate_one_block  0.17514300346374512
generate_one_block  0.17674970626831055
generate_one_block  0.16930007934570312
generate_one_block  0.1633589267730713
generate_one_block  0.16812944412231445
generate_one_block  0.1820535659790039
generate_one_block  0.17908453941345215
generate_one_block  0.17962241172790527
generate_one_block  0.17512989044189453
generate_one_block  0.17725586891174316
generate_one_block  0.177293062210083
generate_one_block  0.16678905487060547
generate_one_block  0.1743464469909668
generate_one_block  0.1800990104675293
generate_one_block  0.17321228981018066
generate_one_block  0.1795485019683838
generate_one_block  0.17006516456604004
generate_one_block  0.17274022102355957
generate_one_block  0.1689760684967041
generate_one_block  0.18134331703186035
generate_one_block  0.18599557876586914
generate_one_block  0.16320300102233887
generate_one_block  0.1702721118927002
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04034018516540527
gen group dst list time:  0.09548020362854004
time for parepare:  0.018884897232055664
local_output_nid generation:  0.019539594650268555
local_in_edges_tensor generation:  0.036174774169921875
mini_batch_src_global generation:  0.04398012161254883
r_  generation:  0.42092204093933105
local_output_nid generation:  0.02649211883544922
local_in_edges_tensor generation:  0.04324150085449219
mini_batch_src_global generation:  0.054535627365112305
r_  generation:  0.42736315727233887
local_output_nid generation:  0.026900053024291992
local_in_edges_tensor generation:  0.032263994216918945
mini_batch_src_global generation:  0.05105757713317871
r_  generation:  0.4463067054748535
local_output_nid generation:  0.025175809860229492
local_in_edges_tensor generation:  0.031661033630371094
mini_batch_src_global generation:  0.052004337310791016
r_  generation:  0.4358997344970703
local_output_nid generation:  0.02534317970275879
local_in_edges_tensor generation:  0.049054622650146484
mini_batch_src_global generation:  0.06111502647399902
r_  generation:  0.44034814834594727
local_output_nid generation:  0.026248693466186523
local_in_edges_tensor generation:  0.04244542121887207
mini_batch_src_global generation:  0.06722903251647949
r_  generation:  0.4368114471435547
local_output_nid generation:  0.02899479866027832
local_in_edges_tensor generation:  0.03789258003234863
mini_batch_src_global generation:  0.06225180625915527
r_  generation:  0.4415009021759033
local_output_nid generation:  0.0267486572265625
local_in_edges_tensor generation:  0.03438210487365723
mini_batch_src_global generation:  0.05314373970031738
r_  generation:  0.4402616024017334
local_output_nid generation:  0.026071786880493164
local_in_edges_tensor generation:  0.029745101928710938
mini_batch_src_global generation:  0.06715512275695801
r_  generation:  0.4377775192260742
local_output_nid generation:  0.026353836059570312
local_in_edges_tensor generation:  0.028942108154296875
mini_batch_src_global generation:  0.059067726135253906
r_  generation:  0.43917250633239746
local_output_nid generation:  0.02613377571105957
local_in_edges_tensor generation:  0.03114151954650879
mini_batch_src_global generation:  0.052838802337646484
r_  generation:  0.44217514991760254
local_output_nid generation:  0.025904178619384766
local_in_edges_tensor generation:  0.025452136993408203
mini_batch_src_global generation:  0.055371761322021484
r_  generation:  0.4369845390319824
local_output_nid generation:  0.025766372680664062
local_in_edges_tensor generation:  0.0324862003326416
mini_batch_src_global generation:  0.05218958854675293
r_  generation:  0.44037652015686035
local_output_nid generation:  0.027125120162963867
local_in_edges_tensor generation:  0.03651094436645508
mini_batch_src_global generation:  0.06886410713195801
r_  generation:  0.437946081161499
local_output_nid generation:  0.027327537536621094
local_in_edges_tensor generation:  0.034345149993896484
mini_batch_src_global generation:  0.057366371154785156
r_  generation:  0.44693493843078613
local_output_nid generation:  0.026148319244384766
local_in_edges_tensor generation:  0.03485870361328125
mini_batch_src_global generation:  0.0528562068939209
r_  generation:  0.43639636039733887
local_output_nid generation:  0.026362180709838867
local_in_edges_tensor generation:  0.02951192855834961
mini_batch_src_global generation:  0.052596330642700195
r_  generation:  0.4456367492675781
local_output_nid generation:  0.02635359764099121
local_in_edges_tensor generation:  0.032918453216552734
mini_batch_src_global generation:  0.05290818214416504
r_  generation:  0.4442625045776367
local_output_nid generation:  0.026407718658447266
local_in_edges_tensor generation:  0.02532672882080078
mini_batch_src_global generation:  0.05272936820983887
r_  generation:  0.44386744499206543
local_output_nid generation:  0.0263826847076416
local_in_edges_tensor generation:  0.029522418975830078
mini_batch_src_global generation:  0.05296921730041504
r_  generation:  0.4464726448059082
local_output_nid generation:  0.02594161033630371
local_in_edges_tensor generation:  0.031894683837890625
mini_batch_src_global generation:  0.05391979217529297
r_  generation:  0.4338092803955078
local_output_nid generation:  0.027436256408691406
local_in_edges_tensor generation:  0.03630948066711426
mini_batch_src_global generation:  0.06660747528076172
r_  generation:  0.4456758499145508
local_output_nid generation:  0.0282900333404541
local_in_edges_tensor generation:  0.03397822380065918
mini_batch_src_global generation:  0.05928754806518555
r_  generation:  0.44210267066955566
local_output_nid generation:  0.026147842407226562
local_in_edges_tensor generation:  0.0347437858581543
mini_batch_src_global generation:  0.05338621139526367
r_  generation:  0.4439096450805664
local_output_nid generation:  0.026346683502197266
local_in_edges_tensor generation:  0.029859304428100586
mini_batch_src_global generation:  0.053171396255493164
r_  generation:  0.4419362545013428
local_output_nid generation:  0.026029348373413086
local_in_edges_tensor generation:  0.02904963493347168
mini_batch_src_global generation:  0.053105831146240234
r_  generation:  0.4365997314453125
local_output_nid generation:  0.026246070861816406
local_in_edges_tensor generation:  0.03408074378967285
mini_batch_src_global generation:  0.05253887176513672
r_  generation:  0.4390575885772705
local_output_nid generation:  0.026304006576538086
local_in_edges_tensor generation:  0.025557518005371094
mini_batch_src_global generation:  0.05250668525695801
r_  generation:  0.4376802444458008
local_output_nid generation:  0.026924610137939453
local_in_edges_tensor generation:  0.03267526626586914
mini_batch_src_global generation:  0.056700944900512695
r_  generation:  0.4595630168914795
local_output_nid generation:  0.026740312576293945
local_in_edges_tensor generation:  0.037291765213012695
mini_batch_src_global generation:  0.05440545082092285
r_  generation:  0.43951916694641113
local_output_nid generation:  0.02611851692199707
local_in_edges_tensor generation:  0.02576279640197754
mini_batch_src_global generation:  0.05292201042175293
r_  generation:  0.43802523612976074
local_output_nid generation:  0.0266263484954834
local_in_edges_tensor generation:  0.029111385345458984
mini_batch_src_global generation:  0.05322837829589844
r_  generation:  0.43944692611694336
----------------------check_connections_block total spend ----------------------------- 20.837100744247437
generate_one_block  0.6673469543457031
generate_one_block  0.5869026184082031
generate_one_block  0.5621495246887207
generate_one_block  0.5660099983215332
generate_one_block  0.5728285312652588
generate_one_block  0.5626342296600342
generate_one_block  0.5874650478363037
generate_one_block  0.5816318988800049
generate_one_block  0.5661795139312744
generate_one_block  0.5769836902618408
generate_one_block  0.5712597370147705
generate_one_block  0.5709950923919678
generate_one_block  0.5621223449707031
generate_one_block  0.5692789554595947
generate_one_block  0.5750560760498047
generate_one_block  0.5682711601257324
generate_one_block  0.5862016677856445
generate_one_block  0.5743858814239502
generate_one_block  0.5716695785522461
generate_one_block  0.5788822174072266
generate_one_block  0.5693652629852295
generate_one_block  0.5842161178588867
generate_one_block  0.5738515853881836
generate_one_block  0.5645856857299805
generate_one_block  0.5885586738586426
generate_one_block  0.5605270862579346
generate_one_block  0.5678653717041016
generate_one_block  0.5745677947998047
generate_one_block  0.5830049514770508
generate_one_block  0.5832576751708984
generate_one_block  0.5540165901184082
generate_one_block  0.5579452514648438
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05420947074890137
gen group dst list time:  0.17479586601257324
time for parepare:  0.019481897354125977
local_output_nid generation:  0.03240013122558594
local_in_edges_tensor generation:  0.055376529693603516
mini_batch_src_global generation:  0.04767274856567383
r_  generation:  0.5024838447570801
local_output_nid generation:  0.038343191146850586
local_in_edges_tensor generation:  0.05149340629577637
mini_batch_src_global generation:  0.055896759033203125
r_  generation:  0.4887049198150635
local_output_nid generation:  0.03697085380554199
local_in_edges_tensor generation:  0.04735851287841797
mini_batch_src_global generation:  0.0529937744140625
r_  generation:  0.49385833740234375
local_output_nid generation:  0.03567314147949219
local_in_edges_tensor generation:  0.046427249908447266
mini_batch_src_global generation:  0.05153632164001465
r_  generation:  0.4951472282409668
local_output_nid generation:  0.03592634201049805
local_in_edges_tensor generation:  0.03492617607116699
mini_batch_src_global generation:  0.05489468574523926
r_  generation:  0.49992823600769043
local_output_nid generation:  0.036965131759643555
local_in_edges_tensor generation:  0.04769277572631836
mini_batch_src_global generation:  0.052414894104003906
r_  generation:  0.5172553062438965
local_output_nid generation:  0.03625798225402832
local_in_edges_tensor generation:  0.04588890075683594
mini_batch_src_global generation:  0.054801225662231445
r_  generation:  0.5003454685211182
local_output_nid generation:  0.0370638370513916
local_in_edges_tensor generation:  0.041216135025024414
mini_batch_src_global generation:  0.054152727127075195
r_  generation:  0.5000951290130615
local_output_nid generation:  0.037050724029541016
local_in_edges_tensor generation:  0.036660194396972656
mini_batch_src_global generation:  0.053397178649902344
r_  generation:  0.5005242824554443
local_output_nid generation:  0.0373687744140625
local_in_edges_tensor generation:  0.03501081466674805
mini_batch_src_global generation:  0.05445432662963867
r_  generation:  0.5021357536315918
local_output_nid generation:  0.038091421127319336
local_in_edges_tensor generation:  0.047594308853149414
mini_batch_src_global generation:  0.05717301368713379
r_  generation:  0.5046889781951904
local_output_nid generation:  0.037181854248046875
local_in_edges_tensor generation:  0.035234689712524414
mini_batch_src_global generation:  0.05430293083190918
r_  generation:  0.5015907287597656
local_output_nid generation:  0.03710198402404785
local_in_edges_tensor generation:  0.034056663513183594
mini_batch_src_global generation:  0.05417180061340332
r_  generation:  0.5049355030059814
local_output_nid generation:  0.0372622013092041
local_in_edges_tensor generation:  0.043649911880493164
mini_batch_src_global generation:  0.05373430252075195
r_  generation:  0.5053157806396484
local_output_nid generation:  0.03766751289367676
local_in_edges_tensor generation:  0.04797029495239258
mini_batch_src_global generation:  0.05394101142883301
r_  generation:  0.5079576969146729
local_output_nid generation:  0.03734707832336426
local_in_edges_tensor generation:  0.035227060317993164
mini_batch_src_global generation:  0.05479598045349121
r_  generation:  0.5063626766204834
local_output_nid generation:  0.03750419616699219
local_in_edges_tensor generation:  0.043670654296875
mini_batch_src_global generation:  0.054443359375
r_  generation:  0.5054788589477539
local_output_nid generation:  0.0372622013092041
local_in_edges_tensor generation:  0.043544769287109375
mini_batch_src_global generation:  0.05802750587463379
r_  generation:  0.5073063373565674
local_output_nid generation:  0.03775644302368164
local_in_edges_tensor generation:  0.052464962005615234
mini_batch_src_global generation:  0.05457615852355957
r_  generation:  0.5045030117034912
local_output_nid generation:  0.057033538818359375
local_in_edges_tensor generation:  0.03894805908203125
mini_batch_src_global generation:  0.05560445785522461
r_  generation:  0.5048749446868896
local_output_nid generation:  0.037671566009521484
local_in_edges_tensor generation:  0.03460431098937988
mini_batch_src_global generation:  0.05574464797973633
r_  generation:  0.5048737525939941
local_output_nid generation:  0.03766322135925293
local_in_edges_tensor generation:  0.043280839920043945
mini_batch_src_global generation:  0.055031776428222656
r_  generation:  0.5060961246490479
local_output_nid generation:  0.037436485290527344
local_in_edges_tensor generation:  0.03512072563171387
mini_batch_src_global generation:  0.06206464767456055
r_  generation:  0.5018637180328369
local_output_nid generation:  0.037714481353759766
local_in_edges_tensor generation:  0.03593039512634277
mini_batch_src_global generation:  0.05529665946960449
r_  generation:  0.5048296451568604
local_output_nid generation:  0.037587881088256836
local_in_edges_tensor generation:  0.03568291664123535
mini_batch_src_global generation:  0.055272579193115234
r_  generation:  0.5122132301330566
local_output_nid generation:  0.037833213806152344
local_in_edges_tensor generation:  0.03962206840515137
mini_batch_src_global generation:  0.05626678466796875
r_  generation:  0.5047297477722168
local_output_nid generation:  0.03754758834838867
local_in_edges_tensor generation:  0.0429837703704834
mini_batch_src_global generation:  0.057694435119628906
r_  generation:  0.5031867027282715
local_output_nid generation:  0.03771543502807617
local_in_edges_tensor generation:  0.050824642181396484
mini_batch_src_global generation:  0.054874420166015625
r_  generation:  0.5088214874267578
local_output_nid generation:  0.03858828544616699
local_in_edges_tensor generation:  0.036637067794799805
mini_batch_src_global generation:  0.056572675704956055
r_  generation:  0.5092496871948242
local_output_nid generation:  0.03743124008178711
local_in_edges_tensor generation:  0.036620140075683594
mini_batch_src_global generation:  0.056260108947753906
r_  generation:  0.5078809261322021
local_output_nid generation:  0.03777480125427246
local_in_edges_tensor generation:  0.033941030502319336
mini_batch_src_global generation:  0.055599212646484375
r_  generation:  0.5021975040435791
local_output_nid generation:  0.03747892379760742
local_in_edges_tensor generation:  0.03253746032714844
mini_batch_src_global generation:  0.05898618698120117
r_  generation:  0.5136837959289551
----------------------check_connections_block total spend ----------------------------- 24.219168663024902
generate_one_block  0.6387150287628174
generate_one_block  0.6124861240386963
generate_one_block  0.6248345375061035
generate_one_block  0.6157476902008057
generate_one_block  0.6316962242126465
generate_one_block  0.6205389499664307
generate_one_block  0.7513301372528076
generate_one_block  0.6241989135742188
generate_one_block  0.6199288368225098
generate_one_block  0.6146354675292969
generate_one_block  0.6355495452880859
generate_one_block  0.6111099720001221
generate_one_block  0.6116006374359131
generate_one_block  0.6334853172302246
generate_one_block  0.6408247947692871
generate_one_block  0.6204624176025391
generate_one_block  0.6096949577331543
generate_one_block  0.6162035465240479
generate_one_block  0.6297578811645508
generate_one_block  0.6161158084869385
generate_one_block  0.6173861026763916
generate_one_block  0.6461565494537354
generate_one_block  0.6291773319244385
generate_one_block  0.6112973690032959
generate_one_block  0.6149826049804688
generate_one_block  0.6137113571166992
generate_one_block  0.6508402824401855
generate_one_block  0.6298487186431885
generate_one_block  0.6274752616882324
generate_one_block  0.6081080436706543
generate_one_block  0.6081275939941406
generate_one_block  0.6151199340820312
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002379894256591797  GigaBytes
Max Memory Allocated: 0.002379894256591797  GigaBytes

connection checking time:  51.49555993080139
block generation total time  44.06463146209717
average batch blocks generation time:  1.3770197331905365
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2010498046875 GB
    Memory Allocated: 0.10402059555053711  GigaBytes
Max Memory Allocated: 0.10402059555053711  GigaBytes

torch.Size([160381, 128])
torch.Size([146536, 128])
Traceback (most recent call last):
  File "pseudo_mini_batch_range_arxiv_sage.py", line 435, in <module>
    main()
  File "pseudo_mini_batch_range_arxiv_sage.py", line 431, in main
    best_test = run(args, device, data)
  File "pseudo_mini_batch_range_arxiv_sage.py", line 251, in run
    batch_pred = model(blocks, batch_inputs)#------------*
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/graph_partition_multi_layers/pseudo_mini_batch_full_batch/SAGE/graphsage_model_arxiv.py", line 182, in forward
    x = layer(block, x)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 258, in forward
    graph.update_all(msg_fn, self._lstm_reducer)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/heterograph.py", line 4849, in update_all
    ndata = core.message_passing(g, message_func, reduce_func, apply_node_func)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 337, in message_passing
    ndata = invoke_udf_reduce(g, rfunc, msgdata, orig_nid=orig_nid)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 143, in invoke_udf_reduce
    bkt_rsts.append(func(nbatch))
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 173, in _lstm_reducer
    _, (rst, _) = self.lstm(m, h)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/rnn.py", line 582, in forward
    self.dropout, self.training, self.bidirectional, self.batch_first)
RuntimeError: CUDA out of memory. Tried to allocate 22.00 MiB (GPU 0; 23.62 GiB total capacity; 22.29 GiB already allocated; 8.44 MiB free; 22.42 GiB reserved in total by PyTorch)
