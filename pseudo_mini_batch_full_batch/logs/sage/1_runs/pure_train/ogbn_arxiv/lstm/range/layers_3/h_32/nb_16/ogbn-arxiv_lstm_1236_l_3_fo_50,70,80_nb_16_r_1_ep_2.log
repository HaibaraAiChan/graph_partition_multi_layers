Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648468111.345448
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027070283889770508
range selection method range initialization spend 0.017314910888671875
time for parepare:  0.018008708953857422
local_output_nid generation:  0.0013871192932128906
local_in_edges_tensor generation:  0.003740549087524414
mini_batch_src_global generation:  0.0023632049560546875
r_  generation:  0.023414134979248047
local_output_nid generation:  0.001588582992553711
local_in_edges_tensor generation:  0.0009839534759521484
mini_batch_src_global generation:  0.0026221275329589844
r_  generation:  0.020974159240722656
local_output_nid generation:  0.0015947818756103516
local_in_edges_tensor generation:  0.0009217262268066406
mini_batch_src_global generation:  0.0015571117401123047
r_  generation:  0.021079540252685547
local_output_nid generation:  0.0016312599182128906
local_in_edges_tensor generation:  0.0009310245513916016
mini_batch_src_global generation:  0.0015583038330078125
r_  generation:  0.02064657211303711
local_output_nid generation:  0.0015804767608642578
local_in_edges_tensor generation:  0.0008962154388427734
mini_batch_src_global generation:  0.0015087127685546875
r_  generation:  0.02063131332397461
local_output_nid generation:  0.0015718936920166016
local_in_edges_tensor generation:  0.0008764266967773438
mini_batch_src_global generation:  0.0015840530395507812
r_  generation:  0.021364450454711914
local_output_nid generation:  0.0015704631805419922
local_in_edges_tensor generation:  0.0009143352508544922
mini_batch_src_global generation:  0.0016262531280517578
r_  generation:  0.02149653434753418
local_output_nid generation:  0.0015680789947509766
local_in_edges_tensor generation:  0.0008783340454101562
mini_batch_src_global generation:  0.0016484260559082031
r_  generation:  0.022151470184326172
local_output_nid generation:  0.0016317367553710938
local_in_edges_tensor generation:  0.0009253025054931641
mini_batch_src_global generation:  0.001622915267944336
r_  generation:  0.021715164184570312
local_output_nid generation:  0.0015785694122314453
local_in_edges_tensor generation:  0.0008645057678222656
mini_batch_src_global generation:  0.0016775131225585938
r_  generation:  0.021500825881958008
local_output_nid generation:  0.0015833377838134766
local_in_edges_tensor generation:  0.0009083747863769531
mini_batch_src_global generation:  0.0017056465148925781
r_  generation:  0.02199101448059082
local_output_nid generation:  0.0015909671783447266
local_in_edges_tensor generation:  0.0008885860443115234
mini_batch_src_global generation:  0.0017218589782714844
r_  generation:  0.022492408752441406
local_output_nid generation:  0.0016036033630371094
local_in_edges_tensor generation:  0.0008990764617919922
mini_batch_src_global generation:  0.0017278194427490234
r_  generation:  0.022337913513183594
local_output_nid generation:  0.0015878677368164062
local_in_edges_tensor generation:  0.0008847713470458984
mini_batch_src_global generation:  0.001726388931274414
r_  generation:  0.022054672241210938
local_output_nid generation:  0.0016243457794189453
local_in_edges_tensor generation:  0.0008995532989501953
mini_batch_src_global generation:  0.0017774105072021484
r_  generation:  0.02338409423828125
local_output_nid generation:  0.00159454345703125
local_in_edges_tensor generation:  0.0009675025939941406
mini_batch_src_global generation:  0.001783609390258789
r_  generation:  0.022620439529418945
----------------------check_connections_block total spend ----------------------------- 0.5160460472106934
generate_one_block  0.031048059463500977
generate_one_block  0.032239437103271484
generate_one_block  0.03368353843688965
generate_one_block  0.03158974647521973
generate_one_block  0.0309293270111084
generate_one_block  0.03162813186645508
generate_one_block  0.03096914291381836
generate_one_block  0.03174924850463867
generate_one_block  0.03148770332336426
generate_one_block  0.031121492385864258
generate_one_block  0.03182339668273926
generate_one_block  0.032215118408203125
generate_one_block  0.03231620788574219
generate_one_block  0.03161764144897461
generate_one_block  0.0328822135925293
generate_one_block  0.0314793586730957
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04026675224304199
gen group dst list time:  0.020781517028808594
time for parepare:  0.01945805549621582
local_output_nid generation:  0.00755763053894043
local_in_edges_tensor generation:  0.019551753997802734
mini_batch_src_global generation:  0.027372121810913086
r_  generation:  0.25340938568115234
local_output_nid generation:  0.012406349182128906
local_in_edges_tensor generation:  0.02195143699645996
mini_batch_src_global generation:  0.03194832801818848
r_  generation:  0.26427221298217773
local_output_nid generation:  0.013060331344604492
local_in_edges_tensor generation:  0.017770767211914062
mini_batch_src_global generation:  0.03325796127319336
r_  generation:  0.27742552757263184
local_output_nid generation:  0.013178586959838867
local_in_edges_tensor generation:  0.015248537063598633
mini_batch_src_global generation:  0.0322265625
r_  generation:  0.2699873447418213
local_output_nid generation:  0.01349496841430664
local_in_edges_tensor generation:  0.01807856559753418
mini_batch_src_global generation:  0.03321528434753418
r_  generation:  0.2746868133544922
local_output_nid generation:  0.013588905334472656
local_in_edges_tensor generation:  0.01886916160583496
mini_batch_src_global generation:  0.03361630439758301
r_  generation:  0.2741541862487793
local_output_nid generation:  0.014075756072998047
local_in_edges_tensor generation:  0.013492584228515625
mini_batch_src_global generation:  0.047361135482788086
r_  generation:  0.289914608001709
local_output_nid generation:  0.01699376106262207
local_in_edges_tensor generation:  0.028924942016601562
mini_batch_src_global generation:  0.03664970397949219
r_  generation:  0.2708282470703125
local_output_nid generation:  0.014202356338500977
local_in_edges_tensor generation:  0.0203399658203125
mini_batch_src_global generation:  0.03831195831298828
r_  generation:  0.27013683319091797
local_output_nid generation:  0.014279365539550781
local_in_edges_tensor generation:  0.016243934631347656
mini_batch_src_global generation:  0.03410983085632324
r_  generation:  0.26976656913757324
local_output_nid generation:  0.014603137969970703
local_in_edges_tensor generation:  0.02136993408203125
mini_batch_src_global generation:  0.034772634506225586
r_  generation:  0.2768890857696533
local_output_nid generation:  0.014474153518676758
local_in_edges_tensor generation:  0.014458894729614258
mini_batch_src_global generation:  0.03544425964355469
r_  generation:  0.27851057052612305
local_output_nid generation:  0.01462244987487793
local_in_edges_tensor generation:  0.016515493392944336
mini_batch_src_global generation:  0.038770198822021484
r_  generation:  0.2784292697906494
local_output_nid generation:  0.014264345169067383
local_in_edges_tensor generation:  0.014609336853027344
mini_batch_src_global generation:  0.03495502471923828
r_  generation:  0.2702467441558838
local_output_nid generation:  0.014890909194946289
local_in_edges_tensor generation:  0.01699662208557129
mini_batch_src_global generation:  0.03547549247741699
r_  generation:  0.28491806983947754
local_output_nid generation:  0.014351129531860352
local_in_edges_tensor generation:  0.016724348068237305
mini_batch_src_global generation:  0.035512685775756836
r_  generation:  0.2735133171081543
----------------------check_connections_block total spend ----------------------------- 6.424937009811401
generate_one_block  0.3760383129119873
generate_one_block  0.3528478145599365
generate_one_block  0.36071300506591797
generate_one_block  0.35516810417175293
generate_one_block  0.37024593353271484
generate_one_block  0.3622448444366455
generate_one_block  0.3486199378967285
generate_one_block  0.35550808906555176
generate_one_block  0.35544848442077637
generate_one_block  0.35245561599731445
generate_one_block  0.3687875270843506
generate_one_block  0.376025915145874
generate_one_block  0.3695695400238037
generate_one_block  0.366100549697876
generate_one_block  0.3902461528778076
generate_one_block  0.3631477355957031
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.07019829750061035
gen group dst list time:  0.0715792179107666
time for parepare:  0.021480798721313477
local_output_nid generation:  0.02542567253112793
local_in_edges_tensor generation:  0.05425763130187988
mini_batch_src_global generation:  0.050545692443847656
r_  generation:  0.5367956161499023
local_output_nid generation:  0.030920982360839844
local_in_edges_tensor generation:  0.0507814884185791
mini_batch_src_global generation:  0.062355756759643555
r_  generation:  0.5349173545837402
local_output_nid generation:  0.03094792366027832
local_in_edges_tensor generation:  0.051166534423828125
mini_batch_src_global generation:  0.06287741661071777
r_  generation:  0.5431065559387207
local_output_nid generation:  0.03239107131958008
local_in_edges_tensor generation:  0.043183326721191406
mini_batch_src_global generation:  0.062014102935791016
r_  generation:  0.5506420135498047
local_output_nid generation:  0.03460812568664551
local_in_edges_tensor generation:  0.04013872146606445
mini_batch_src_global generation:  0.06494593620300293
r_  generation:  0.5409543514251709
local_output_nid generation:  0.03260970115661621
local_in_edges_tensor generation:  0.03314661979675293
mini_batch_src_global generation:  0.06126093864440918
r_  generation:  0.5411376953125
local_output_nid generation:  0.032946109771728516
local_in_edges_tensor generation:  0.038007259368896484
mini_batch_src_global generation:  0.0703730583190918
r_  generation:  0.5444595813751221
local_output_nid generation:  0.03284740447998047
local_in_edges_tensor generation:  0.04242968559265137
mini_batch_src_global generation:  0.06539773941040039
r_  generation:  0.5453596115112305
local_output_nid generation:  0.03286099433898926
local_in_edges_tensor generation:  0.04990196228027344
mini_batch_src_global generation:  0.062163352966308594
r_  generation:  0.5471429824829102
local_output_nid generation:  0.03280472755432129
local_in_edges_tensor generation:  0.035836219787597656
mini_batch_src_global generation:  0.062186241149902344
r_  generation:  0.5437467098236084
local_output_nid generation:  0.033347129821777344
local_in_edges_tensor generation:  0.04131913185119629
mini_batch_src_global generation:  0.06208300590515137
r_  generation:  0.5502395629882812
local_output_nid generation:  0.03316688537597656
local_in_edges_tensor generation:  0.03662586212158203
mini_batch_src_global generation:  0.06441974639892578
r_  generation:  0.5514841079711914
local_output_nid generation:  0.034189462661743164
local_in_edges_tensor generation:  0.04028129577636719
mini_batch_src_global generation:  0.08281540870666504
r_  generation:  0.5542011260986328
local_output_nid generation:  0.03542494773864746
local_in_edges_tensor generation:  0.0411829948425293
mini_batch_src_global generation:  0.06579971313476562
r_  generation:  0.5512022972106934
local_output_nid generation:  0.033307790756225586
local_in_edges_tensor generation:  0.04447150230407715
mini_batch_src_global generation:  0.0614323616027832
r_  generation:  0.5497918128967285
local_output_nid generation:  0.032989501953125
local_in_edges_tensor generation:  0.03609776496887207
mini_batch_src_global generation:  0.06258797645568848
r_  generation:  0.5514142513275146
----------------------check_connections_block total spend ----------------------------- 12.906684398651123
generate_one_block  0.7216413021087646
generate_one_block  0.7040643692016602
generate_one_block  0.7023313045501709
generate_one_block  0.6810252666473389
generate_one_block  0.7092065811157227
generate_one_block  0.6782238483428955
generate_one_block  0.7384788990020752
generate_one_block  0.7023718357086182
generate_one_block  0.702897310256958
generate_one_block  0.693967342376709
generate_one_block  0.6994972229003906
generate_one_block  0.6898858547210693
generate_one_block  0.7039775848388672
generate_one_block  0.6867437362670898
generate_one_block  0.7117438316345215
generate_one_block  0.6944072246551514
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

connection checking time:  19.331621408462524
block generation total time  17.043631076812744
average batch blocks generation time:  1.0652269423007965
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.09575986862182617  GigaBytes
Max Memory Allocated: 0.09575986862182617  GigaBytes

torch.Size([157534, 128])
torch.Size([129786, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 14.606008529663086  GigaBytes
Max Memory Allocated: 14.61328411102295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4139404296875 GB
    Memory Allocated: 0.09664201736450195  GigaBytes
Max Memory Allocated: 14.61328411102295  GigaBytes

torch.Size([157443, 128])
torch.Size([129535, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.9393310546875 GB
    Memory Allocated: 14.580727577209473  GigaBytes
Max Memory Allocated: 14.61328411102295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.9393310546875 GB
    Memory Allocated: 0.09686422348022461  GigaBytes
Max Memory Allocated: 14.61328411102295  GigaBytes

torch.Size([157445, 128])
torch.Size([130112, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7596435546875 GB
    Memory Allocated: 14.632845878601074  GigaBytes
Max Memory Allocated: 14.640913009643555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7596435546875 GB
    Memory Allocated: 0.09668922424316406  GigaBytes
Max Memory Allocated: 14.640913009643555  GigaBytes

torch.Size([157410, 128])
torch.Size([129261, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7596435546875 GB
    Memory Allocated: 14.5567626953125  GigaBytes
Max Memory Allocated: 14.640913009643555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7596435546875 GB
    Memory Allocated: 0.0977783203125  GigaBytes
Max Memory Allocated: 14.640913009643555  GigaBytes

torch.Size([157731, 128])
torch.Size([130234, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7596435546875 GB
    Memory Allocated: 14.58165979385376  GigaBytes
Max Memory Allocated: 14.640913009643555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7596435546875 GB
    Memory Allocated: 0.0965414047241211  GigaBytes
Max Memory Allocated: 14.640913009643555  GigaBytes

torch.Size([157146, 128])
torch.Size([128771, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7596435546875 GB
    Memory Allocated: 14.53369951248169  GigaBytes
Max Memory Allocated: 14.640913009643555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7596435546875 GB
    Memory Allocated: 0.09662866592407227  GigaBytes
Max Memory Allocated: 14.640913009643555  GigaBytes

torch.Size([157531, 128])
torch.Size([129591, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7596435546875 GB
    Memory Allocated: 14.567265510559082  GigaBytes
Max Memory Allocated: 14.640913009643555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7596435546875 GB
    Memory Allocated: 0.0968775749206543  GigaBytes
Max Memory Allocated: 14.640913009643555  GigaBytes

torch.Size([157705, 128])
torch.Size([129953, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7596435546875 GB
    Memory Allocated: 14.608092308044434  GigaBytes
Max Memory Allocated: 14.640913009643555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7596435546875 GB
    Memory Allocated: 0.09678220748901367  GigaBytes
Max Memory Allocated: 14.640913009643555  GigaBytes

torch.Size([157573, 128])
torch.Size([129934, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7596435546875 GB
    Memory Allocated: 14.605398654937744  GigaBytes
Max Memory Allocated: 14.640913009643555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7596435546875 GB
    Memory Allocated: 0.09677839279174805  GigaBytes
Max Memory Allocated: 14.640913009643555  GigaBytes

torch.Size([157619, 128])
torch.Size([129784, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7596435546875 GB
    Memory Allocated: 14.586867809295654  GigaBytes
Max Memory Allocated: 14.640913009643555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7596435546875 GB
    Memory Allocated: 0.09803581237792969  GigaBytes
Max Memory Allocated: 14.640913009643555  GigaBytes

torch.Size([157856, 128])
torch.Size([130461, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7596435546875 GB
    Memory Allocated: 14.666915893554688  GigaBytes
Max Memory Allocated: 14.674920082092285  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7596435546875 GB
    Memory Allocated: 0.09704017639160156  GigaBytes
Max Memory Allocated: 14.674920082092285  GigaBytes

torch.Size([157714, 128])
torch.Size([130441, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7655029296875 GB
    Memory Allocated: 14.637889385223389  GigaBytes
Max Memory Allocated: 14.674920082092285  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7655029296875 GB
    Memory Allocated: 0.09692573547363281  GigaBytes
Max Memory Allocated: 14.674920082092285  GigaBytes

torch.Size([157522, 128])
torch.Size([130000, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7811279296875 GB
    Memory Allocated: 14.62898302078247  GigaBytes
Max Memory Allocated: 14.674920082092285  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7811279296875 GB
    Memory Allocated: 0.09675931930541992  GigaBytes
Max Memory Allocated: 14.674920082092285  GigaBytes

torch.Size([157569, 128])
torch.Size([130066, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7811279296875 GB
    Memory Allocated: 14.588395595550537  GigaBytes
Max Memory Allocated: 14.674920082092285  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7811279296875 GB
    Memory Allocated: 0.09709835052490234  GigaBytes
Max Memory Allocated: 14.674920082092285  GigaBytes

torch.Size([157590, 128])
torch.Size([130179, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7889404296875 GB
    Memory Allocated: 14.655922412872314  GigaBytes
Max Memory Allocated: 14.674920082092285  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7889404296875 GB
    Memory Allocated: 0.0967874526977539  GigaBytes
Max Memory Allocated: 14.674920082092285  GigaBytes

torch.Size([157530, 128])
torch.Size([129805, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7889404296875 GB
    Memory Allocated: 14.600171566009521  GigaBytes
Max Memory Allocated: 14.674920082092285  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.032520756125450134 |0.04597640037536621 |0.6914127320051193 |0.00012795627117156982 |1.1021165251731873 |0.015155792236328125 |
----------------------------------------------------------pseudo_mini_loss sum 4.3982253074646
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5329332
Number of first layer input nodes during this epoch:  2520918
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 17.7889404296875 GB
    Memory Allocated: 0.12648773193359375  GigaBytes
Max Memory Allocated: 14.674920082092285  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026593446731567383
range selection method range initialization spend 0.012968063354492188
time for parepare:  0.017412900924682617
local_output_nid generation:  0.0018782615661621094
local_in_edges_tensor generation:  0.006377696990966797
mini_batch_src_global generation:  0.0021135807037353516
r_  generation:  0.020885944366455078
local_output_nid generation:  0.0019006729125976562
local_in_edges_tensor generation:  0.0010290145874023438
mini_batch_src_global generation:  0.002437591552734375
r_  generation:  0.034483909606933594
local_output_nid generation:  0.0030448436737060547
local_in_edges_tensor generation:  0.0012502670288085938
mini_batch_src_global generation:  0.0017108917236328125
r_  generation:  0.02162909507751465
local_output_nid generation:  0.002410411834716797
local_in_edges_tensor generation:  0.0010848045349121094
mini_batch_src_global generation:  0.001786947250366211
r_  generation:  0.021477937698364258
local_output_nid generation:  0.002182483673095703
local_in_edges_tensor generation:  0.0010175704956054688
mini_batch_src_global generation:  0.0016918182373046875
r_  generation:  0.021385669708251953
local_output_nid generation:  0.0021734237670898438
local_in_edges_tensor generation:  0.0009963512420654297
mini_batch_src_global generation:  0.0017690658569335938
r_  generation:  0.02172565460205078
local_output_nid generation:  0.002128124237060547
local_in_edges_tensor generation:  0.0010340213775634766
mini_batch_src_global generation:  0.0017900466918945312
r_  generation:  0.02251267433166504
local_output_nid generation:  0.0021169185638427734
local_in_edges_tensor generation:  0.0010221004486083984
mini_batch_src_global generation:  0.0018320083618164062
r_  generation:  0.0221407413482666
local_output_nid generation:  0.0020246505737304688
local_in_edges_tensor generation:  0.0010662078857421875
mini_batch_src_global generation:  0.0018353462219238281
r_  generation:  0.02223992347717285
local_output_nid generation:  0.0023336410522460938
local_in_edges_tensor generation:  0.0010607242584228516
mini_batch_src_global generation:  0.002292633056640625
r_  generation:  0.023427724838256836
local_output_nid generation:  0.001890420913696289
local_in_edges_tensor generation:  0.001065969467163086
mini_batch_src_global generation:  0.0017881393432617188
r_  generation:  0.022722482681274414
local_output_nid generation:  0.001804351806640625
local_in_edges_tensor generation:  0.0009806156158447266
mini_batch_src_global generation:  0.0018231868743896484
r_  generation:  0.02290058135986328
local_output_nid generation:  0.0017774105072021484
local_in_edges_tensor generation:  0.0009720325469970703
mini_batch_src_global generation:  0.001779794692993164
r_  generation:  0.022305965423583984
local_output_nid generation:  0.0018203258514404297
local_in_edges_tensor generation:  0.0009791851043701172
mini_batch_src_global generation:  0.001783132553100586
r_  generation:  0.022890329360961914
local_output_nid generation:  0.0017502307891845703
local_in_edges_tensor generation:  0.0009214878082275391
mini_batch_src_global generation:  0.0018646717071533203
r_  generation:  0.02289891242980957
local_output_nid generation:  0.0017261505126953125
local_in_edges_tensor generation:  0.0009856224060058594
mini_batch_src_global generation:  0.0018734931945800781
r_  generation:  0.02304863929748535
----------------------check_connections_block total spend ----------------------------- 0.5543665885925293
generate_one_block  0.04403948783874512
generate_one_block  0.03833508491516113
generate_one_block  0.03797507286071777
generate_one_block  0.037685394287109375
generate_one_block  0.038159847259521484
generate_one_block  0.03985762596130371
generate_one_block  0.038861751556396484
generate_one_block  0.03826498985290527
generate_one_block  0.03831028938293457
generate_one_block  0.03839707374572754
generate_one_block  0.03929448127746582
generate_one_block  0.039621829986572266
generate_one_block  0.03860044479370117
generate_one_block  0.03899216651916504
generate_one_block  0.03954362869262695
generate_one_block  0.040265560150146484
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04310488700866699
gen group dst list time:  0.01957416534423828
time for parepare:  0.019134998321533203
local_output_nid generation:  0.008483409881591797
local_in_edges_tensor generation:  0.02344989776611328
mini_batch_src_global generation:  0.024665117263793945
r_  generation:  0.25064826011657715
local_output_nid generation:  0.012369394302368164
local_in_edges_tensor generation:  0.022394895553588867
mini_batch_src_global generation:  0.03490757942199707
r_  generation:  0.2689344882965088
local_output_nid generation:  0.01522684097290039
local_in_edges_tensor generation:  0.018136024475097656
mini_batch_src_global generation:  0.03309178352355957
r_  generation:  0.26956915855407715
local_output_nid generation:  0.012914896011352539
local_in_edges_tensor generation:  0.014000177383422852
mini_batch_src_global generation:  0.03469681739807129
r_  generation:  0.2673780918121338
local_output_nid generation:  0.013058900833129883
local_in_edges_tensor generation:  0.018321514129638672
mini_batch_src_global generation:  0.03262495994567871
r_  generation:  0.2722635269165039
local_output_nid generation:  0.015639066696166992
local_in_edges_tensor generation:  0.014172554016113281
mini_batch_src_global generation:  0.03319406509399414
r_  generation:  0.2715334892272949
local_output_nid generation:  0.013114213943481445
local_in_edges_tensor generation:  0.01862955093383789
mini_batch_src_global generation:  0.033888816833496094
r_  generation:  0.2771155834197998
local_output_nid generation:  0.013195991516113281
local_in_edges_tensor generation:  0.0166170597076416
mini_batch_src_global generation:  0.03751945495605469
r_  generation:  0.2926630973815918
local_output_nid generation:  0.014234542846679688
local_in_edges_tensor generation:  0.026306629180908203
mini_batch_src_global generation:  0.040595293045043945
r_  generation:  0.2783169746398926
local_output_nid generation:  0.014794349670410156
local_in_edges_tensor generation:  0.01949310302734375
mini_batch_src_global generation:  0.04301953315734863
r_  generation:  0.2740902900695801
local_output_nid generation:  0.013839006423950195
local_in_edges_tensor generation:  0.016904115676879883
mini_batch_src_global generation:  0.03647041320800781
r_  generation:  0.277752161026001
local_output_nid generation:  0.013818502426147461
local_in_edges_tensor generation:  0.016711950302124023
mini_batch_src_global generation:  0.0350649356842041
r_  generation:  0.2770817279815674
local_output_nid generation:  0.013815879821777344
local_in_edges_tensor generation:  0.01653575897216797
mini_batch_src_global generation:  0.034897565841674805
r_  generation:  0.2748749256134033
local_output_nid generation:  0.013846635818481445
local_in_edges_tensor generation:  0.018950939178466797
mini_batch_src_global generation:  0.03497028350830078
r_  generation:  0.27448153495788574
local_output_nid generation:  0.013970613479614258
local_in_edges_tensor generation:  0.0170290470123291
mini_batch_src_global generation:  0.034757137298583984
r_  generation:  0.27826857566833496
local_output_nid generation:  0.013993501663208008
local_in_edges_tensor generation:  0.018884658813476562
mini_batch_src_global generation:  0.03768754005432129
r_  generation:  0.2975118160247803
----------------------check_connections_block total spend ----------------------------- 6.433999538421631
generate_one_block  0.4012925624847412
generate_one_block  0.38077521324157715
generate_one_block  0.38770508766174316
generate_one_block  0.37387871742248535
generate_one_block  0.3763408660888672
generate_one_block  0.40618038177490234
generate_one_block  0.41668057441711426
generate_one_block  0.375002384185791
generate_one_block  0.3881113529205322
generate_one_block  0.3873014450073242
generate_one_block  0.3855886459350586
generate_one_block  0.380002498626709
generate_one_block  0.3804931640625
generate_one_block  0.3889729976654053
generate_one_block  0.406768798828125
generate_one_block  0.39070725440979004
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05180096626281738
gen group dst list time:  0.06591963768005371
time for parepare:  0.01883864402770996
local_output_nid generation:  0.02837085723876953
local_in_edges_tensor generation:  0.06181502342224121
mini_batch_src_global generation:  0.05661344528198242
r_  generation:  0.5221006870269775
local_output_nid generation:  0.03195691108703613
local_in_edges_tensor generation:  0.05135512351989746
mini_batch_src_global generation:  0.06597614288330078
r_  generation:  0.5342950820922852
local_output_nid generation:  0.03217744827270508
local_in_edges_tensor generation:  0.037758588790893555
mini_batch_src_global generation:  0.058980703353881836
r_  generation:  0.5379600524902344
local_output_nid generation:  0.032861948013305664
local_in_edges_tensor generation:  0.04280877113342285
mini_batch_src_global generation:  0.06383156776428223
r_  generation:  0.5464451313018799
local_output_nid generation:  0.03256559371948242
local_in_edges_tensor generation:  0.08210921287536621
mini_batch_src_global generation:  0.06028890609741211
r_  generation:  0.5511698722839355
local_output_nid generation:  0.03387928009033203
local_in_edges_tensor generation:  0.04225945472717285
mini_batch_src_global generation:  0.06219363212585449
r_  generation:  0.5602493286132812
local_output_nid generation:  0.033711910247802734
local_in_edges_tensor generation:  0.046175479888916016
mini_batch_src_global generation:  0.07083678245544434
r_  generation:  0.554387092590332
local_output_nid generation:  0.03500723838806152
local_in_edges_tensor generation:  0.033159494400024414
mini_batch_src_global generation:  0.06188082695007324
r_  generation:  0.5452451705932617
local_output_nid generation:  0.034203290939331055
local_in_edges_tensor generation:  0.03802227973937988
mini_batch_src_global generation:  0.06506919860839844
r_  generation:  0.5476269721984863
local_output_nid generation:  0.03392529487609863
local_in_edges_tensor generation:  0.033533573150634766
mini_batch_src_global generation:  0.06208062171936035
r_  generation:  0.5439081192016602
local_output_nid generation:  0.03399920463562012
local_in_edges_tensor generation:  0.038246870040893555
mini_batch_src_global generation:  0.06802010536193848
r_  generation:  0.5504193305969238
local_output_nid generation:  0.033994436264038086
local_in_edges_tensor generation:  0.03677964210510254
mini_batch_src_global generation:  0.062157630920410156
r_  generation:  0.5472376346588135
local_output_nid generation:  0.03424429893493652
local_in_edges_tensor generation:  0.03856325149536133
mini_batch_src_global generation:  0.06569027900695801
r_  generation:  0.5527167320251465
local_output_nid generation:  0.03420066833496094
local_in_edges_tensor generation:  0.047662973403930664
mini_batch_src_global generation:  0.06139230728149414
r_  generation:  0.5469381809234619
local_output_nid generation:  0.0340576171875
local_in_edges_tensor generation:  0.038306474685668945
mini_batch_src_global generation:  0.06276631355285645
r_  generation:  0.5620849132537842
local_output_nid generation:  0.034399986267089844
local_in_edges_tensor generation:  0.03790616989135742
mini_batch_src_global generation:  0.06651115417480469
r_  generation:  0.5470080375671387
----------------------check_connections_block total spend ----------------------------- 12.93826174736023
generate_one_block  0.7322049140930176
generate_one_block  0.73158860206604
generate_one_block  0.7246890068054199
generate_one_block  0.7315452098846436
generate_one_block  0.7072632312774658
generate_one_block  0.719372034072876
generate_one_block  0.7298588752746582
generate_one_block  0.7100393772125244
generate_one_block  0.7564399242401123
generate_one_block  0.7109377384185791
generate_one_block  0.7358105182647705
generate_one_block  0.7208194732666016
generate_one_block  0.7906179428100586
generate_one_block  0.7711501121520996
generate_one_block  0.7120532989501953
generate_one_block  0.7219662666320801
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.7889404296875 GB
    Memory Allocated: 0.12648773193359375  GigaBytes
Max Memory Allocated: 14.674920082092285  GigaBytes

connection checking time:  19.37226128578186
block generation total time  17.93215847015381
average batch blocks generation time:  1.120759904384613
block dataloader generation time/epoch 40.3650062084198
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7889404296875 GB
    Memory Allocated: 0.09798383712768555  GigaBytes
Max Memory Allocated: 14.674920082092285  GigaBytes

torch.Size([157474, 128])
torch.Size([129732, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7889404296875 GB
    Memory Allocated: 14.590362548828125  GigaBytes
Max Memory Allocated: 14.674920082092285  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7889404296875 GB
    Memory Allocated: 0.09814786911010742  GigaBytes
Max Memory Allocated: 14.674920082092285  GigaBytes

torch.Size([157731, 128])
torch.Size([130392, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7889404296875 GB
    Memory Allocated: 14.618368148803711  GigaBytes
Max Memory Allocated: 14.674920082092285  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7889404296875 GB
    Memory Allocated: 0.09801912307739258  GigaBytes
Max Memory Allocated: 14.674920082092285  GigaBytes

torch.Size([157487, 128])
torch.Size([129786, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7889404296875 GB
    Memory Allocated: 14.611310482025146  GigaBytes
Max Memory Allocated: 14.674920082092285  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7889404296875 GB
    Memory Allocated: 0.09806966781616211  GigaBytes
Max Memory Allocated: 14.674920082092285  GigaBytes

torch.Size([157775, 128])
torch.Size([130217, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7889404296875 GB
    Memory Allocated: 14.598217487335205  GigaBytes
Max Memory Allocated: 14.674920082092285  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7889404296875 GB
    Memory Allocated: 0.09893608093261719  GigaBytes
Max Memory Allocated: 14.674920082092285  GigaBytes

torch.Size([157758, 128])
torch.Size([130252, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7889404296875 GB
    Memory Allocated: 14.583040237426758  GigaBytes
Max Memory Allocated: 14.674920082092285  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7889404296875 GB
    Memory Allocated: 0.09795284271240234  GigaBytes
Max Memory Allocated: 14.674920082092285  GigaBytes

torch.Size([157614, 128])
torch.Size([129913, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7889404296875 GB
    Memory Allocated: 14.587583065032959  GigaBytes
Max Memory Allocated: 14.674920082092285  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7889404296875 GB
    Memory Allocated: 0.0980224609375  GigaBytes
Max Memory Allocated: 14.674920082092285  GigaBytes

torch.Size([157492, 128])
torch.Size([129957, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7889404296875 GB
    Memory Allocated: 14.611580848693848  GigaBytes
Max Memory Allocated: 14.674920082092285  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7889404296875 GB
    Memory Allocated: 0.0979619026184082  GigaBytes
Max Memory Allocated: 14.674920082092285  GigaBytes

torch.Size([157509, 128])
torch.Size([129821, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7889404296875 GB
    Memory Allocated: 14.597489833831787  GigaBytes
Max Memory Allocated: 14.674920082092285  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7889404296875 GB
    Memory Allocated: 0.09909629821777344  GigaBytes
Max Memory Allocated: 14.674920082092285  GigaBytes

torch.Size([157752, 128])
torch.Size([130033, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7889404296875 GB
    Memory Allocated: 14.607523918151855  GigaBytes
Max Memory Allocated: 14.674920082092285  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7889404296875 GB
    Memory Allocated: 0.0981588363647461  GigaBytes
Max Memory Allocated: 14.674920082092285  GigaBytes

torch.Size([157760, 128])
torch.Size([129651, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7889404296875 GB
    Memory Allocated: 14.615779399871826  GigaBytes
Max Memory Allocated: 14.674920082092285  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7889404296875 GB
    Memory Allocated: 0.0980682373046875  GigaBytes
Max Memory Allocated: 14.674920082092285  GigaBytes

torch.Size([157464, 128])
torch.Size([130051, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7889404296875 GB
    Memory Allocated: 14.623049259185791  GigaBytes
Max Memory Allocated: 14.674920082092285  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7889404296875 GB
    Memory Allocated: 0.09802103042602539  GigaBytes
Max Memory Allocated: 14.674920082092285  GigaBytes

torch.Size([157445, 128])
torch.Size([129528, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7889404296875 GB
    Memory Allocated: 14.602731704711914  GigaBytes
Max Memory Allocated: 14.674920082092285  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7889404296875 GB
    Memory Allocated: 0.09813356399536133  GigaBytes
Max Memory Allocated: 14.674920082092285  GigaBytes

torch.Size([157629, 128])
torch.Size([130032, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7889404296875 GB
    Memory Allocated: 14.626036167144775  GigaBytes
Max Memory Allocated: 14.674920082092285  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7889404296875 GB
    Memory Allocated: 0.0982213020324707  GigaBytes
Max Memory Allocated: 14.674920082092285  GigaBytes

torch.Size([157771, 128])
torch.Size([130597, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7889404296875 GB
    Memory Allocated: 14.633341789245605  GigaBytes
Max Memory Allocated: 14.674920082092285  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7889404296875 GB
    Memory Allocated: 0.09818363189697266  GigaBytes
Max Memory Allocated: 14.674920082092285  GigaBytes

torch.Size([157678, 128])
torch.Size([130167, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7889404296875 GB
    Memory Allocated: 14.636598110198975  GigaBytes
Max Memory Allocated: 14.674920082092285  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7889404296875 GB
    Memory Allocated: 0.09820413589477539  GigaBytes
Max Memory Allocated: 14.674920082092285  GigaBytes

torch.Size([157601, 128])
torch.Size([130216, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7889404296875 GB
    Memory Allocated: 14.647322177886963  GigaBytes
Max Memory Allocated: 14.674920082092285  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02248549461364746 |0.022380009293556213 |0.6312388777732849 |0.00010545551776885986 |1.079273834824562 |0.004267215728759766 |
----------------------------------------------------------pseudo_mini_loss sum 3.6975557804107666
Total (block generation + training)time/epoch 68.50526547431946
Training time/epoch 28.13999891281128
Training time without block to device /epoch 27.78191876411438
Training time without total dataloading part /epoch 27.374157905578613
load block tensor time/epoch 0.3597679138183594
block to device time/epoch 0.3580801486968994
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5333258
Number of first layer input nodes during this epoch:  2521940
