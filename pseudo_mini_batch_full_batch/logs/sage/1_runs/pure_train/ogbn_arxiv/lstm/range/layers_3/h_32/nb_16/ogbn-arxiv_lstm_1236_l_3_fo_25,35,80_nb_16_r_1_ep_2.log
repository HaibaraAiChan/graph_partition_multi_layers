Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648466461.845816
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02811408042907715
range selection method range initialization spend 0.012909889221191406
time for parepare:  0.01833486557006836
local_output_nid generation:  0.001338958740234375
local_in_edges_tensor generation:  0.0043833255767822266
mini_batch_src_global generation:  0.0019769668579101562
r_  generation:  0.019704103469848633
local_output_nid generation:  0.0014185905456542969
local_in_edges_tensor generation:  0.0009438991546630859
mini_batch_src_global generation:  0.0023403167724609375
r_  generation:  0.0196077823638916
local_output_nid generation:  0.0014657974243164062
local_in_edges_tensor generation:  0.0008835792541503906
mini_batch_src_global generation:  0.0015201568603515625
r_  generation:  0.01987147331237793
local_output_nid generation:  0.0015702247619628906
local_in_edges_tensor generation:  0.0008854866027832031
mini_batch_src_global generation:  0.001512289047241211
r_  generation:  0.019591808319091797
local_output_nid generation:  0.0015134811401367188
local_in_edges_tensor generation:  0.0008482933044433594
mini_batch_src_global generation:  0.001508474349975586
r_  generation:  0.019452333450317383
local_output_nid generation:  0.0014996528625488281
local_in_edges_tensor generation:  0.0008575916290283203
mini_batch_src_global generation:  0.0015020370483398438
r_  generation:  0.020441532135009766
local_output_nid generation:  0.0015075206756591797
local_in_edges_tensor generation:  0.0008420944213867188
mini_batch_src_global generation:  0.0016100406646728516
r_  generation:  0.020412683486938477
local_output_nid generation:  0.0015146732330322266
local_in_edges_tensor generation:  0.0008373260498046875
mini_batch_src_global generation:  0.0015888214111328125
r_  generation:  0.02098393440246582
local_output_nid generation:  0.001508474349975586
local_in_edges_tensor generation:  0.0008423328399658203
mini_batch_src_global generation:  0.001573801040649414
r_  generation:  0.02034282684326172
local_output_nid generation:  0.0015692710876464844
local_in_edges_tensor generation:  0.0008845329284667969
mini_batch_src_global generation:  0.0015888214111328125
r_  generation:  0.020648717880249023
local_output_nid generation:  0.0015170574188232422
local_in_edges_tensor generation:  0.0008919239044189453
mini_batch_src_global generation:  0.001630544662475586
r_  generation:  0.020937681198120117
local_output_nid generation:  0.0015134811401367188
local_in_edges_tensor generation:  0.0008502006530761719
mini_batch_src_global generation:  0.0017635822296142578
r_  generation:  0.021467208862304688
local_output_nid generation:  0.0015311241149902344
local_in_edges_tensor generation:  0.0008525848388671875
mini_batch_src_global generation:  0.0017080307006835938
r_  generation:  0.02126765251159668
local_output_nid generation:  0.001514434814453125
local_in_edges_tensor generation:  0.0008497238159179688
mini_batch_src_global generation:  0.001699686050415039
r_  generation:  0.021229028701782227
local_output_nid generation:  0.0015826225280761719
local_in_edges_tensor generation:  0.0008859634399414062
mini_batch_src_global generation:  0.0017130374908447266
r_  generation:  0.02231001853942871
local_output_nid generation:  0.001501321792602539
local_in_edges_tensor generation:  0.0008687973022460938
mini_batch_src_global generation:  0.0017676353454589844
r_  generation:  0.021526575088500977
----------------------check_connections_block total spend ----------------------------- 0.4900655746459961
generate_one_block  0.030937910079956055
generate_one_block  0.03130173683166504
generate_one_block  0.03304886817932129
generate_one_block  0.03087615966796875
generate_one_block  0.030445337295532227
generate_one_block  0.03057408332824707
generate_one_block  0.030600309371948242
generate_one_block  0.03092050552368164
generate_one_block  0.030762434005737305
generate_one_block  0.030774354934692383
generate_one_block  0.03103041648864746
generate_one_block  0.0313572883605957
generate_one_block  0.0315554141998291
generate_one_block  0.0305635929107666
generate_one_block  0.03207135200500488
generate_one_block  0.030905723571777344
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03753185272216797
gen group dst list time:  0.02075791358947754
time for parepare:  0.019985437393188477
local_output_nid generation:  0.007459163665771484
local_in_edges_tensor generation:  0.020772218704223633
mini_batch_src_global generation:  0.02308344841003418
r_  generation:  0.2137150764465332
local_output_nid generation:  0.013768911361694336
local_in_edges_tensor generation:  0.019771337509155273
mini_batch_src_global generation:  0.026130199432373047
r_  generation:  0.21593594551086426
local_output_nid generation:  0.014727354049682617
local_in_edges_tensor generation:  0.019065141677856445
mini_batch_src_global generation:  0.02605915069580078
r_  generation:  0.2263016700744629
local_output_nid generation:  0.014979362487792969
local_in_edges_tensor generation:  0.016955137252807617
mini_batch_src_global generation:  0.02682018280029297
r_  generation:  0.223801851272583
local_output_nid generation:  0.015298604965209961
local_in_edges_tensor generation:  0.012935161590576172
mini_batch_src_global generation:  0.027298450469970703
r_  generation:  0.23418426513671875
local_output_nid generation:  0.015557050704956055
local_in_edges_tensor generation:  0.016810894012451172
mini_batch_src_global generation:  0.028636932373046875
r_  generation:  0.23019909858703613
local_output_nid generation:  0.01574254035949707
local_in_edges_tensor generation:  0.013049125671386719
mini_batch_src_global generation:  0.02809619903564453
r_  generation:  0.2261660099029541
local_output_nid generation:  0.01577019691467285
local_in_edges_tensor generation:  0.017132282257080078
mini_batch_src_global generation:  0.028759479522705078
r_  generation:  0.22996926307678223
local_output_nid generation:  0.01610875129699707
local_in_edges_tensor generation:  0.015546321868896484
mini_batch_src_global generation:  0.02931523323059082
r_  generation:  0.23264312744140625
local_output_nid generation:  0.015938758850097656
local_in_edges_tensor generation:  0.015177726745605469
mini_batch_src_global generation:  0.02881479263305664
r_  generation:  0.2313098907470703
local_output_nid generation:  0.01650094985961914
local_in_edges_tensor generation:  0.01783299446105957
mini_batch_src_global generation:  0.02996683120727539
r_  generation:  0.24215197563171387
local_output_nid generation:  0.016460895538330078
local_in_edges_tensor generation:  0.019431352615356445
mini_batch_src_global generation:  0.029773712158203125
r_  generation:  0.23768162727355957
local_output_nid generation:  0.01641106605529785
local_in_edges_tensor generation:  0.01556849479675293
mini_batch_src_global generation:  0.02987957000732422
r_  generation:  0.23439884185791016
local_output_nid generation:  0.01592850685119629
local_in_edges_tensor generation:  0.013513803482055664
mini_batch_src_global generation:  0.029072999954223633
r_  generation:  0.23132681846618652
local_output_nid generation:  0.01684856414794922
local_in_edges_tensor generation:  0.015650272369384766
mini_batch_src_global generation:  0.030213594436645508
r_  generation:  0.23967242240905762
local_output_nid generation:  0.01633286476135254
local_in_edges_tensor generation:  0.015566825866699219
mini_batch_src_global generation:  0.030070066452026367
r_  generation:  0.2346813678741455
----------------------check_connections_block total spend ----------------------------- 5.477191686630249
generate_one_block  0.3159654140472412
generate_one_block  0.2994556427001953
generate_one_block  0.3068974018096924
generate_one_block  0.3031625747680664
generate_one_block  0.311215877532959
generate_one_block  0.30340576171875
generate_one_block  0.30449676513671875
generate_one_block  0.3072390556335449
generate_one_block  0.30438876152038574
generate_one_block  0.2955052852630615
generate_one_block  0.3152506351470947
generate_one_block  0.31243252754211426
generate_one_block  0.30875110626220703
generate_one_block  0.3017303943634033
generate_one_block  0.32187557220458984
generate_one_block  0.3029053211212158
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03593564033508301
gen group dst list time:  0.06195259094238281
time for parepare:  0.01873159408569336
local_output_nid generation:  0.02403712272644043
local_in_edges_tensor generation:  0.03427267074584961
mini_batch_src_global generation:  0.04181385040283203
r_  generation:  0.43747568130493164
local_output_nid generation:  0.030736923217773438
local_in_edges_tensor generation:  0.04604291915893555
mini_batch_src_global generation:  0.05189657211303711
r_  generation:  0.4503157138824463
local_output_nid generation:  0.030878067016601562
local_in_edges_tensor generation:  0.039107322692871094
mini_batch_src_global generation:  0.05001664161682129
r_  generation:  0.4538540840148926
local_output_nid generation:  0.03055596351623535
local_in_edges_tensor generation:  0.03207564353942871
mini_batch_src_global generation:  0.0526883602142334
r_  generation:  0.4496326446533203
local_output_nid generation:  0.031166553497314453
local_in_edges_tensor generation:  0.039131879806518555
mini_batch_src_global generation:  0.05098557472229004
r_  generation:  0.46189236640930176
local_output_nid generation:  0.031054258346557617
local_in_edges_tensor generation:  0.031813859939575195
mini_batch_src_global generation:  0.05310416221618652
r_  generation:  0.45052480697631836
local_output_nid generation:  0.030719280242919922
local_in_edges_tensor generation:  0.031821489334106445
mini_batch_src_global generation:  0.05170297622680664
r_  generation:  0.4625580310821533
local_output_nid generation:  0.03119349479675293
local_in_edges_tensor generation:  0.03986692428588867
mini_batch_src_global generation:  0.05305171012878418
r_  generation:  0.45673561096191406
local_output_nid generation:  0.03142666816711426
local_in_edges_tensor generation:  0.03563332557678223
mini_batch_src_global generation:  0.052350759506225586
r_  generation:  0.4687039852142334
local_output_nid generation:  0.03141021728515625
local_in_edges_tensor generation:  0.03566932678222656
mini_batch_src_global generation:  0.05322909355163574
r_  generation:  0.4524562358856201
local_output_nid generation:  0.031369686126708984
local_in_edges_tensor generation:  0.040560245513916016
mini_batch_src_global generation:  0.05525016784667969
r_  generation:  0.46472907066345215
local_output_nid generation:  0.03145790100097656
local_in_edges_tensor generation:  0.03658413887023926
mini_batch_src_global generation:  0.05314946174621582
r_  generation:  0.45374631881713867
local_output_nid generation:  0.03149700164794922
local_in_edges_tensor generation:  0.03288722038269043
mini_batch_src_global generation:  0.05372786521911621
r_  generation:  0.46543192863464355
local_output_nid generation:  0.0315096378326416
local_in_edges_tensor generation:  0.03574204444885254
mini_batch_src_global generation:  0.05661273002624512
r_  generation:  0.4658851623535156
local_output_nid generation:  0.0317692756652832
local_in_edges_tensor generation:  0.037075042724609375
mini_batch_src_global generation:  0.05579662322998047
r_  generation:  0.4667525291442871
local_output_nid generation:  0.0316619873046875
local_in_edges_tensor generation:  0.031446218490600586
mini_batch_src_global generation:  0.05380606651306152
r_  generation:  0.4590568542480469
----------------------check_connections_block total spend ----------------------------- 10.833746433258057
generate_one_block  0.5802061557769775
generate_one_block  0.5882186889648438
generate_one_block  0.5827722549438477
generate_one_block  0.5859665870666504
generate_one_block  0.5923826694488525
generate_one_block  0.5697708129882812
generate_one_block  0.6288750171661377
generate_one_block  0.5937352180480957
generate_one_block  0.5881974697113037
generate_one_block  0.5779368877410889
generate_one_block  0.6079564094543457
generate_one_block  0.5926902294158936
generate_one_block  0.5934817790985107
generate_one_block  0.594200849533081
generate_one_block  0.5899720191955566
generate_one_block  0.5890138149261475
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

connection checking time:  16.310938119888306
block generation total time  14.370054960250854
average batch blocks generation time:  0.8981284350156784
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1756591796875 GB
    Memory Allocated: 0.09133768081665039  GigaBytes
Max Memory Allocated: 0.09133768081665039  GigaBytes

torch.Size([155035, 128])
torch.Size([124866, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7830810546875 GB
    Memory Allocated: 12.238500118255615  GigaBytes
Max Memory Allocated: 12.245775699615479  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7928466796875 GB
    Memory Allocated: 0.0922861099243164  GigaBytes
Max Memory Allocated: 12.245775699615479  GigaBytes

torch.Size([154998, 128])
torch.Size([124606, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0330810546875 GB
    Memory Allocated: 12.221503257751465  GigaBytes
Max Memory Allocated: 12.245775699615479  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0330810546875 GB
    Memory Allocated: 0.09278392791748047  GigaBytes
Max Memory Allocated: 12.245775699615479  GigaBytes

torch.Size([154848, 128])
torch.Size([125138, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0330810546875 GB
    Memory Allocated: 12.264482498168945  GigaBytes
Max Memory Allocated: 12.272549629211426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0330810546875 GB
    Memory Allocated: 0.09222936630249023  GigaBytes
Max Memory Allocated: 12.272549629211426  GigaBytes

torch.Size([154807, 128])
torch.Size([124140, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0330810546875 GB
    Memory Allocated: 12.223255634307861  GigaBytes
Max Memory Allocated: 12.272549629211426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0330810546875 GB
    Memory Allocated: 0.09260082244873047  GigaBytes
Max Memory Allocated: 12.272549629211426  GigaBytes

torch.Size([155234, 128])
torch.Size([125244, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0330810546875 GB
    Memory Allocated: 12.232504844665527  GigaBytes
Max Memory Allocated: 12.272549629211426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0330810546875 GB
    Memory Allocated: 0.09207487106323242  GigaBytes
Max Memory Allocated: 12.272549629211426  GigaBytes

torch.Size([154525, 128])
torch.Size([123760, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0330810546875 GB
    Memory Allocated: 12.187487125396729  GigaBytes
Max Memory Allocated: 12.272549629211426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0330810546875 GB
    Memory Allocated: 0.09256649017333984  GigaBytes
Max Memory Allocated: 12.272549629211426  GigaBytes

torch.Size([154970, 128])
torch.Size([124594, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0330810546875 GB
    Memory Allocated: 12.187575817108154  GigaBytes
Max Memory Allocated: 12.272549629211426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0330810546875 GB
    Memory Allocated: 0.09246253967285156  GigaBytes
Max Memory Allocated: 12.272549629211426  GigaBytes

torch.Size([155120, 128])
torch.Size([124949, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0330810546875 GB
    Memory Allocated: 12.249041557312012  GigaBytes
Max Memory Allocated: 12.272549629211426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0330810546875 GB
    Memory Allocated: 0.09265899658203125  GigaBytes
Max Memory Allocated: 12.272549629211426  GigaBytes

torch.Size([155000, 128])
torch.Size([124874, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0330810546875 GB
    Memory Allocated: 12.234293937683105  GigaBytes
Max Memory Allocated: 12.272549629211426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0330810546875 GB
    Memory Allocated: 0.09235095977783203  GigaBytes
Max Memory Allocated: 12.272549629211426  GigaBytes

torch.Size([155058, 128])
torch.Size([124687, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0330810546875 GB
    Memory Allocated: 12.23531723022461  GigaBytes
Max Memory Allocated: 12.272549629211426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0330810546875 GB
    Memory Allocated: 0.0928640365600586  GigaBytes
Max Memory Allocated: 12.272549629211426  GigaBytes

torch.Size([155431, 128])
torch.Size([125516, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7166748046875 GB
    Memory Allocated: 12.308049201965332  GigaBytes
Max Memory Allocated: 12.31605339050293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7166748046875 GB
    Memory Allocated: 0.09261560440063477  GigaBytes
Max Memory Allocated: 12.31605339050293  GigaBytes

torch.Size([155175, 128])
torch.Size([125469, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7166748046875 GB
    Memory Allocated: 12.297692775726318  GigaBytes
Max Memory Allocated: 12.31605339050293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7166748046875 GB
    Memory Allocated: 0.09282588958740234  GigaBytes
Max Memory Allocated: 12.31605339050293  GigaBytes

torch.Size([154930, 128])
torch.Size([125049, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7166748046875 GB
    Memory Allocated: 12.285068035125732  GigaBytes
Max Memory Allocated: 12.31605339050293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7166748046875 GB
    Memory Allocated: 0.09237098693847656  GigaBytes
Max Memory Allocated: 12.31605339050293  GigaBytes

torch.Size([155054, 128])
torch.Size([125177, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7166748046875 GB
    Memory Allocated: 12.234259605407715  GigaBytes
Max Memory Allocated: 12.31605339050293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7166748046875 GB
    Memory Allocated: 0.09295654296875  GigaBytes
Max Memory Allocated: 12.31605339050293  GigaBytes

torch.Size([155119, 128])
torch.Size([125431, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7166748046875 GB
    Memory Allocated: 12.32911205291748  GigaBytes
Max Memory Allocated: 12.337506294250488  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7166748046875 GB
    Memory Allocated: 0.09239053726196289  GigaBytes
Max Memory Allocated: 12.337506294250488  GigaBytes

torch.Size([154983, 128])
torch.Size([124850, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7166748046875 GB
    Memory Allocated: 12.259676456451416  GigaBytes
Max Memory Allocated: 12.337506294250488  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03717204928398132 |0.043212682008743286 |0.4644080549478531 |0.00011776387691497803 |0.6596223562955856 |0.010621309280395508 |
----------------------------------------------------------pseudo_mini_loss sum 4.4007978439331055
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5209096
Number of first layer input nodes during this epoch:  2480287
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 14.7166748046875 GB
    Memory Allocated: 0.11806821823120117  GigaBytes
Max Memory Allocated: 12.337506294250488  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.029630422592163086
range selection method range initialization spend 0.012887239456176758
time for parepare:  0.0171811580657959
local_output_nid generation:  0.001947164535522461
local_in_edges_tensor generation:  0.006536960601806641
mini_batch_src_global generation:  0.0021338462829589844
r_  generation:  0.021150588989257812
local_output_nid generation:  0.0019123554229736328
local_in_edges_tensor generation:  0.0010466575622558594
mini_batch_src_global generation:  0.0025072097778320312
r_  generation:  0.02095508575439453
local_output_nid generation:  0.0018644332885742188
local_in_edges_tensor generation:  0.0010030269622802734
mini_batch_src_global generation:  0.0015947818756103516
r_  generation:  0.020760059356689453
local_output_nid generation:  0.0017766952514648438
local_in_edges_tensor generation:  0.0009500980377197266
mini_batch_src_global generation:  0.0016472339630126953
r_  generation:  0.02095961570739746
local_output_nid generation:  0.0017566680908203125
local_in_edges_tensor generation:  0.0010313987731933594
mini_batch_src_global generation:  0.0016412734985351562
r_  generation:  0.021123409271240234
local_output_nid generation:  0.001766204833984375
local_in_edges_tensor generation:  0.0009541511535644531
mini_batch_src_global generation:  0.001695394515991211
r_  generation:  0.02136087417602539
local_output_nid generation:  0.0018107891082763672
local_in_edges_tensor generation:  0.0009980201721191406
mini_batch_src_global generation:  0.0016939640045166016
r_  generation:  0.021950483322143555
local_output_nid generation:  0.0017800331115722656
local_in_edges_tensor generation:  0.0009553432464599609
mini_batch_src_global generation:  0.001744985580444336
r_  generation:  0.021923303604125977
local_output_nid generation:  0.001760244369506836
local_in_edges_tensor generation:  0.0009222030639648438
mini_batch_src_global generation:  0.0017414093017578125
r_  generation:  0.021755218505859375
local_output_nid generation:  0.0018258094787597656
local_in_edges_tensor generation:  0.0009434223175048828
mini_batch_src_global generation:  0.0017712116241455078
r_  generation:  0.02211761474609375
local_output_nid generation:  0.001741647720336914
local_in_edges_tensor generation:  0.0009329319000244141
mini_batch_src_global generation:  0.0018820762634277344
r_  generation:  0.0228726863861084
local_output_nid generation:  0.0017709732055664062
local_in_edges_tensor generation:  0.0009367465972900391
mini_batch_src_global generation:  0.0018467903137207031
r_  generation:  0.022919654846191406
local_output_nid generation:  0.0017671585083007812
local_in_edges_tensor generation:  0.0009319782257080078
mini_batch_src_global generation:  0.0017549991607666016
r_  generation:  0.022786855697631836
local_output_nid generation:  0.0017807483673095703
local_in_edges_tensor generation:  0.000934600830078125
mini_batch_src_global generation:  0.0017991065979003906
r_  generation:  0.02260303497314453
local_output_nid generation:  0.0017383098602294922
local_in_edges_tensor generation:  0.0010890960693359375
mini_batch_src_global generation:  0.0018939971923828125
r_  generation:  0.022962331771850586
local_output_nid generation:  0.0017271041870117188
local_in_edges_tensor generation:  0.0009815692901611328
mini_batch_src_global generation:  0.0017952919006347656
r_  generation:  0.022458791732788086
----------------------check_connections_block total spend ----------------------------- 0.52817702293396
generate_one_block  0.045966386795043945
generate_one_block  0.036794185638427734
generate_one_block  0.03654909133911133
generate_one_block  0.03637194633483887
generate_one_block  0.036705970764160156
generate_one_block  0.038112640380859375
generate_one_block  0.037560224533081055
generate_one_block  0.03707313537597656
generate_one_block  0.03707289695739746
generate_one_block  0.03755807876586914
generate_one_block  0.037717580795288086
generate_one_block  0.038170814514160156
generate_one_block  0.036730051040649414
generate_one_block  0.03737211227416992
generate_one_block  0.03798818588256836
generate_one_block  0.03822946548461914
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03758740425109863
gen group dst list time:  0.019925355911254883
time for parepare:  0.019295930862426758
local_output_nid generation:  0.008656978607177734
local_in_edges_tensor generation:  0.021128177642822266
mini_batch_src_global generation:  0.024064302444458008
r_  generation:  0.21390581130981445
local_output_nid generation:  0.012469053268432617
local_in_edges_tensor generation:  0.01998734474182129
mini_batch_src_global generation:  0.02923417091369629
r_  generation:  0.22319698333740234
local_output_nid generation:  0.012580633163452148
local_in_edges_tensor generation:  0.018491029739379883
mini_batch_src_global generation:  0.028902769088745117
r_  generation:  0.22946882247924805
local_output_nid generation:  0.013225555419921875
local_in_edges_tensor generation:  0.014500856399536133
mini_batch_src_global generation:  0.02735590934753418
r_  generation:  0.2274188995361328
local_output_nid generation:  0.015311241149902344
local_in_edges_tensor generation:  0.016704082489013672
mini_batch_src_global generation:  0.02778792381286621
r_  generation:  0.23011040687561035
local_output_nid generation:  0.013028144836425781
local_in_edges_tensor generation:  0.016811609268188477
mini_batch_src_global generation:  0.028647661209106445
r_  generation:  0.2309434413909912
local_output_nid generation:  0.01319432258605957
local_in_edges_tensor generation:  0.016851186752319336
mini_batch_src_global generation:  0.030616283416748047
r_  generation:  0.23534846305847168
local_output_nid generation:  0.013165712356567383
local_in_edges_tensor generation:  0.015021085739135742
mini_batch_src_global generation:  0.028809309005737305
r_  generation:  0.23473119735717773
local_output_nid generation:  0.013187408447265625
local_in_edges_tensor generation:  0.015297412872314453
mini_batch_src_global generation:  0.029236555099487305
r_  generation:  0.23693132400512695
local_output_nid generation:  0.013195276260375977
local_in_edges_tensor generation:  0.015166044235229492
mini_batch_src_global generation:  0.02948141098022461
r_  generation:  0.23756957054138184
local_output_nid generation:  0.013525247573852539
local_in_edges_tensor generation:  0.01517486572265625
mini_batch_src_global generation:  0.029925107955932617
r_  generation:  0.23690104484558105
local_output_nid generation:  0.01346588134765625
local_in_edges_tensor generation:  0.017462491989135742
mini_batch_src_global generation:  0.032915353775024414
r_  generation:  0.2406141757965088
local_output_nid generation:  0.013390541076660156
local_in_edges_tensor generation:  0.015578985214233398
mini_batch_src_global generation:  0.029767751693725586
r_  generation:  0.24101901054382324
local_output_nid generation:  0.01349496841430664
local_in_edges_tensor generation:  0.018248558044433594
mini_batch_src_global generation:  0.037831783294677734
r_  generation:  0.24303817749023438
local_output_nid generation:  0.014432668685913086
local_in_edges_tensor generation:  0.021811723709106445
mini_batch_src_global generation:  0.03899645805358887
r_  generation:  0.2415022850036621
local_output_nid generation:  0.015161275863647461
local_in_edges_tensor generation:  0.01864790916442871
mini_batch_src_global generation:  0.030949831008911133
r_  generation:  0.24096465110778809
----------------------check_connections_block total spend ----------------------------- 5.565349817276001
generate_one_block  0.32700037956237793
generate_one_block  0.3229541778564453
generate_one_block  0.3200850486755371
generate_one_block  0.31652212142944336
generate_one_block  0.31473803520202637
generate_one_block  0.31600427627563477
generate_one_block  0.34856629371643066
generate_one_block  0.32070326805114746
generate_one_block  0.3206188678741455
generate_one_block  0.3477175235748291
generate_one_block  0.3259859085083008
generate_one_block  0.3228757381439209
generate_one_block  0.32067418098449707
generate_one_block  0.32131409645080566
generate_one_block  0.323178768157959
generate_one_block  0.32656335830688477
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04519796371459961
gen group dst list time:  0.06235146522521973
time for parepare:  0.018555164337158203
local_output_nid generation:  0.02634286880493164
local_in_edges_tensor generation:  0.05015277862548828
mini_batch_src_global generation:  0.044403076171875
r_  generation:  0.4405851364135742
local_output_nid generation:  0.03051924705505371
local_in_edges_tensor generation:  0.04574275016784668
mini_batch_src_global generation:  0.05394792556762695
r_  generation:  0.44704174995422363
local_output_nid generation:  0.03094005584716797
local_in_edges_tensor generation:  0.030472517013549805
mini_batch_src_global generation:  0.05077552795410156
r_  generation:  0.4555232524871826
local_output_nid generation:  0.03150439262390137
local_in_edges_tensor generation:  0.034158945083618164
mini_batch_src_global generation:  0.05541229248046875
r_  generation:  0.46046018600463867
local_output_nid generation:  0.03144049644470215
local_in_edges_tensor generation:  0.08121752738952637
mini_batch_src_global generation:  0.051764488220214844
r_  generation:  0.4720795154571533
local_output_nid generation:  0.03084397315979004
local_in_edges_tensor generation:  0.0328221321105957
mini_batch_src_global generation:  0.0539853572845459
r_  generation:  0.45992159843444824
local_output_nid generation:  0.032766103744506836
local_in_edges_tensor generation:  0.0365297794342041
mini_batch_src_global generation:  0.05294394493103027
r_  generation:  0.4613461494445801
local_output_nid generation:  0.031780242919921875
local_in_edges_tensor generation:  0.03905963897705078
mini_batch_src_global generation:  0.05589437484741211
r_  generation:  0.4749274253845215
local_output_nid generation:  0.03322649002075195
local_in_edges_tensor generation:  0.04399251937866211
mini_batch_src_global generation:  0.058418989181518555
r_  generation:  0.46300625801086426
local_output_nid generation:  0.03271818161010742
local_in_edges_tensor generation:  0.03631448745727539
mini_batch_src_global generation:  0.0559539794921875
r_  generation:  0.4654707908630371
local_output_nid generation:  0.032723426818847656
local_in_edges_tensor generation:  0.030966758728027344
mini_batch_src_global generation:  0.0527646541595459
r_  generation:  0.4658381938934326
local_output_nid generation:  0.03223896026611328
local_in_edges_tensor generation:  0.030758380889892578
mini_batch_src_global generation:  0.05584406852722168
r_  generation:  0.4566683769226074
local_output_nid generation:  0.03277873992919922
local_in_edges_tensor generation:  0.03512763977050781
mini_batch_src_global generation:  0.059060096740722656
r_  generation:  0.47397541999816895
local_output_nid generation:  0.0332489013671875
local_in_edges_tensor generation:  0.039504051208496094
mini_batch_src_global generation:  0.053189754486083984
r_  generation:  0.46628236770629883
local_output_nid generation:  0.03290271759033203
local_in_edges_tensor generation:  0.03546595573425293
mini_batch_src_global generation:  0.05284309387207031
r_  generation:  0.4669158458709717
local_output_nid generation:  0.032706260681152344
local_in_edges_tensor generation:  0.03470897674560547
mini_batch_src_global generation:  0.05691051483154297
r_  generation:  0.4601736068725586
----------------------check_connections_block total spend ----------------------------- 11.03079080581665
generate_one_block  0.6384131908416748
generate_one_block  0.6142518520355225
generate_one_block  0.6096432209014893
generate_one_block  0.6086091995239258
generate_one_block  0.6138088703155518
generate_one_block  0.5955178737640381
generate_one_block  0.6049609184265137
generate_one_block  0.6106600761413574
generate_one_block  0.6395680904388428
generate_one_block  0.5979626178741455
generate_one_block  0.6176800727844238
generate_one_block  0.5953254699707031
generate_one_block  0.6229479312896729
generate_one_block  0.6198265552520752
generate_one_block  0.6011495590209961
generate_one_block  0.609527587890625
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 14.7166748046875 GB
    Memory Allocated: 0.11806821823120117  GigaBytes
Max Memory Allocated: 12.337506294250488  GigaBytes

connection checking time:  16.59614062309265
block generation total time  14.995355129241943
average batch blocks generation time:  0.9372096955776215
block dataloader generation time/epoch 34.325738191604614
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7166748046875 GB
    Memory Allocated: 0.09393548965454102  GigaBytes
Max Memory Allocated: 12.337506294250488  GigaBytes

torch.Size([155035, 128])
torch.Size([124822, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7166748046875 GB
    Memory Allocated: 12.235296726226807  GigaBytes
Max Memory Allocated: 12.337506294250488  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7166748046875 GB
    Memory Allocated: 0.09369373321533203  GigaBytes
Max Memory Allocated: 12.337506294250488  GigaBytes

torch.Size([155134, 128])
torch.Size([125342, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7166748046875 GB
    Memory Allocated: 12.258281707763672  GigaBytes
Max Memory Allocated: 12.337506294250488  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7166748046875 GB
    Memory Allocated: 0.09391117095947266  GigaBytes
Max Memory Allocated: 12.337506294250488  GigaBytes

torch.Size([154898, 128])
torch.Size([124642, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7166748046875 GB
    Memory Allocated: 12.229548454284668  GigaBytes
Max Memory Allocated: 12.337506294250488  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7166748046875 GB
    Memory Allocated: 0.09369564056396484  GigaBytes
Max Memory Allocated: 12.337506294250488  GigaBytes

torch.Size([155310, 128])
torch.Size([125065, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7166748046875 GB
    Memory Allocated: 12.227884292602539  GigaBytes
Max Memory Allocated: 12.337506294250488  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7166748046875 GB
    Memory Allocated: 0.09378814697265625  GigaBytes
Max Memory Allocated: 12.337506294250488  GigaBytes

torch.Size([155254, 128])
torch.Size([125074, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7166748046875 GB
    Memory Allocated: 12.208334922790527  GigaBytes
Max Memory Allocated: 12.337506294250488  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7166748046875 GB
    Memory Allocated: 0.09353446960449219  GigaBytes
Max Memory Allocated: 12.337506294250488  GigaBytes

torch.Size([155072, 128])
torch.Size([124783, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7166748046875 GB
    Memory Allocated: 12.201948642730713  GigaBytes
Max Memory Allocated: 12.337506294250488  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7166748046875 GB
    Memory Allocated: 0.09390544891357422  GigaBytes
Max Memory Allocated: 12.337506294250488  GigaBytes

torch.Size([154974, 128])
torch.Size([124792, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7166748046875 GB
    Memory Allocated: 12.228915214538574  GigaBytes
Max Memory Allocated: 12.337506294250488  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7166748046875 GB
    Memory Allocated: 0.09358787536621094  GigaBytes
Max Memory Allocated: 12.337506294250488  GigaBytes

torch.Size([155006, 128])
torch.Size([124841, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7205810546875 GB
    Memory Allocated: 12.231932163238525  GigaBytes
Max Memory Allocated: 12.337506294250488  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7205810546875 GB
    Memory Allocated: 0.0939178466796875  GigaBytes
Max Memory Allocated: 12.337506294250488  GigaBytes

torch.Size([155223, 128])
torch.Size([124979, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7205810546875 GB
    Memory Allocated: 12.241442203521729  GigaBytes
Max Memory Allocated: 12.337506294250488  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7205810546875 GB
    Memory Allocated: 0.09369325637817383  GigaBytes
Max Memory Allocated: 12.337506294250488  GigaBytes

torch.Size([155173, 128])
torch.Size([124586, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7205810546875 GB
    Memory Allocated: 12.257057189941406  GigaBytes
Max Memory Allocated: 12.337506294250488  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7205810546875 GB
    Memory Allocated: 0.09398174285888672  GigaBytes
Max Memory Allocated: 12.337506294250488  GigaBytes

torch.Size([154996, 128])
torch.Size([125111, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7205810546875 GB
    Memory Allocated: 12.264053344726562  GigaBytes
Max Memory Allocated: 12.337506294250488  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7205810546875 GB
    Memory Allocated: 0.09357881546020508  GigaBytes
Max Memory Allocated: 12.337506294250488  GigaBytes

torch.Size([154875, 128])
torch.Size([124419, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7205810546875 GB
    Memory Allocated: 12.225420475006104  GigaBytes
Max Memory Allocated: 12.337506294250488  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7205810546875 GB
    Memory Allocated: 0.0939779281616211  GigaBytes
Max Memory Allocated: 12.337506294250488  GigaBytes

torch.Size([155096, 128])
torch.Size([124939, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7205810546875 GB
    Memory Allocated: 12.27767562866211  GigaBytes
Max Memory Allocated: 12.337506294250488  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7205810546875 GB
    Memory Allocated: 0.09384679794311523  GigaBytes
Max Memory Allocated: 12.337506294250488  GigaBytes

torch.Size([155329, 128])
torch.Size([125615, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7205810546875 GB
    Memory Allocated: 12.274649143218994  GigaBytes
Max Memory Allocated: 12.337506294250488  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7205810546875 GB
    Memory Allocated: 0.09400177001953125  GigaBytes
Max Memory Allocated: 12.337506294250488  GigaBytes

torch.Size([155246, 128])
torch.Size([125173, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7205810546875 GB
    Memory Allocated: 12.271429538726807  GigaBytes
Max Memory Allocated: 12.337506294250488  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7205810546875 GB
    Memory Allocated: 0.09377765655517578  GigaBytes
Max Memory Allocated: 12.337506294250488  GigaBytes

torch.Size([155102, 128])
torch.Size([125264, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7225341796875 GB
    Memory Allocated: 12.283549785614014  GigaBytes
Max Memory Allocated: 12.337506294250488  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03146405518054962 |0.017924100160598755 |0.4288138896226883 |0.0001024007797241211 |0.6391547322273254 |0.005902767181396484 |
----------------------------------------------------------pseudo_mini_loss sum 3.6920113563537598
Total (block generation + training)time/epoch 52.24014067649841
Training time/epoch 17.91417121887207
Training time without block to device /epoch 17.62738561630249
Training time without total dataloading part /epoch 17.095039129257202
load block tensor time/epoch 0.503424882888794
block to device time/epoch 0.2867856025695801
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5212011
Number of first layer input nodes during this epoch:  2481723
