Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1647774803.3717043
ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.028248310089111328
range selection method range initialization spend 0.01731586456298828
time for parepare:  0.01784205436706543
local_output_nid generation:  0.005324602127075195
local_in_edges_tensor generation:  0.0065593719482421875
mini_batch_src_global generation:  0.009067296981811523
r_  generation:  0.09351825714111328
local_output_nid generation:  0.0059814453125
local_in_edges_tensor generation:  0.003173351287841797
mini_batch_src_global generation:  0.00982046127319336
r_  generation:  0.09988737106323242
local_output_nid generation:  0.00605320930480957
local_in_edges_tensor generation:  0.0031685829162597656
mini_batch_src_global generation:  0.007680654525756836
r_  generation:  0.10296916961669922
local_output_nid generation:  0.006085872650146484
local_in_edges_tensor generation:  0.003159046173095703
mini_batch_src_global generation:  0.008540153503417969
r_  generation:  0.10538196563720703
----------------------check_connections_block total spend ----------------------------- 0.5744290351867676
generate_one_block  0.11556100845336914
generate_one_block  0.11690497398376465
generate_one_block  0.1176140308380127
generate_one_block  0.11891436576843262
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04452824592590332
gen group dst list time:  0.012198209762573242
time for parepare:  0.01920914649963379
local_output_nid generation:  0.015275001525878906
local_in_edges_tensor generation:  0.04079484939575195
mini_batch_src_global generation:  0.04591035842895508
r_  generation:  0.47234559059143066
local_output_nid generation:  0.025812625885009766
local_in_edges_tensor generation:  0.04267096519470215
mini_batch_src_global generation:  0.05692768096923828
r_  generation:  0.5144007205963135
local_output_nid generation:  0.027502059936523438
local_in_edges_tensor generation:  0.05791974067687988
mini_batch_src_global generation:  0.08029365539550781
r_  generation:  0.48836779594421387
local_output_nid generation:  0.02489328384399414
local_in_edges_tensor generation:  0.035051584243774414
mini_batch_src_global generation:  0.05834364891052246
r_  generation:  0.48651885986328125
----------------------check_connections_block total spend ----------------------------- 2.910278797149658
generate_one_block  0.6579532623291016
generate_one_block  0.6664385795593262
generate_one_block  0.6625280380249023
generate_one_block  0.6904962062835693
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04110908508300781
gen group dst list time:  0.026153087615966797
time for parepare:  0.02339482307434082
local_output_nid generation:  0.025940418243408203
local_in_edges_tensor generation:  0.050067901611328125
mini_batch_src_global generation:  0.048442840576171875
r_  generation:  0.50054931640625
local_output_nid generation:  0.03317689895629883
local_in_edges_tensor generation:  0.04744315147399902
mini_batch_src_global generation:  0.057691097259521484
r_  generation:  0.5228538513183594
local_output_nid generation:  0.03498506546020508
local_in_edges_tensor generation:  0.04068303108215332
mini_batch_src_global generation:  0.05841660499572754
r_  generation:  0.5202174186706543
local_output_nid generation:  0.03650999069213867
local_in_edges_tensor generation:  0.04127216339111328
mini_batch_src_global generation:  0.0641775131225586
r_  generation:  0.524498701095581
----------------------check_connections_block total spend ----------------------------- 3.1022119522094727
generate_one_block  0.6470861434936523
generate_one_block  0.6461994647979736
generate_one_block  0.6551239490509033
generate_one_block  0.6370985507965088
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  6.012490749359131
block generation total time  5.2629241943359375
average batch blocks generation time:  1.3157310485839844
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2030029296875 GB
    Memory Allocated: 0.10483026504516602  GigaBytes
Max Memory Allocated: 0.10483026504516602  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6893310546875 GB
    Memory Allocated: 1.135960578918457  GigaBytes
Max Memory Allocated: 1.2293319702148438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.10925102233886719  GigaBytes
Max Memory Allocated: 1.3390140533447266  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.1428961753845215  GigaBytes
Max Memory Allocated: 1.3390140533447266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.10978984832763672  GigaBytes
Max Memory Allocated: 1.348137378692627  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.1376657485961914  GigaBytes
Max Memory Allocated: 1.348137378692627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.10928058624267578  GigaBytes
Max Memory Allocated: 1.348137378692627  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.1370234489440918  GigaBytes
Max Memory Allocated: 1.348137378692627  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06725442409515381 |0.0986211895942688 |0.2006981372833252 |0.00011980533599853516 |0.023538947105407715 |0.00450587272644043 |
----------------------------------------------------------pseudo_mini_loss sum 6.171882629394531
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1720873
Number of first layer input nodes during this epoch:  661903
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.1514143943786621  GigaBytes
Max Memory Allocated: 1.348137378692627  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03231620788574219
range selection method range initialization spend 0.013692855834960938
time for parepare:  0.01741933822631836
local_output_nid generation:  0.005109071731567383
local_in_edges_tensor generation:  0.012427330017089844
mini_batch_src_global generation:  0.007946252822875977
r_  generation:  0.0920414924621582
local_output_nid generation:  0.006041049957275391
local_in_edges_tensor generation:  0.0034935474395751953
mini_batch_src_global generation:  0.009804487228393555
r_  generation:  0.09754180908203125
local_output_nid generation:  0.0061376094818115234
local_in_edges_tensor generation:  0.0033278465270996094
mini_batch_src_global generation:  0.010291814804077148
r_  generation:  0.10110259056091309
local_output_nid generation:  0.006100177764892578
local_in_edges_tensor generation:  0.0032753944396972656
mini_batch_src_global generation:  0.008349180221557617
r_  generation:  0.10764122009277344
----------------------check_connections_block total spend ----------------------------- 0.5783007144927979
generate_one_block  0.12331295013427734
generate_one_block  0.11412572860717773
generate_one_block  0.11475133895874023
generate_one_block  0.11738801002502441
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0348663330078125
gen group dst list time:  0.011737585067749023
time for parepare:  0.019114255905151367
local_output_nid generation:  0.01499629020690918
local_in_edges_tensor generation:  0.037919044494628906
mini_batch_src_global generation:  0.05056142807006836
r_  generation:  0.48018455505371094
local_output_nid generation:  0.02234792709350586
local_in_edges_tensor generation:  0.0426182746887207
mini_batch_src_global generation:  0.05613517761230469
r_  generation:  0.4845123291015625
local_output_nid generation:  0.0234987735748291
local_in_edges_tensor generation:  0.03714728355407715
mini_batch_src_global generation:  0.05594301223754883
r_  generation:  0.5187864303588867
local_output_nid generation:  0.027362346649169922
local_in_edges_tensor generation:  0.046152353286743164
mini_batch_src_global generation:  0.06461787223815918
r_  generation:  0.4954833984375
----------------------check_connections_block total spend ----------------------------- 2.8946681022644043
generate_one_block  0.6518950462341309
generate_one_block  0.6239626407623291
generate_one_block  0.6586756706237793
generate_one_block  0.6312322616577148
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.08659052848815918
gen group dst list time:  0.025531768798828125
time for parepare:  0.019962549209594727
local_output_nid generation:  0.025409460067749023
local_in_edges_tensor generation:  0.06147360801696777
mini_batch_src_global generation:  0.04539036750793457
r_  generation:  0.514751672744751
local_output_nid generation:  0.037285566329956055
local_in_edges_tensor generation:  0.04316854476928711
mini_batch_src_global generation:  0.05793333053588867
r_  generation:  0.5014150142669678
local_output_nid generation:  0.0367884635925293
local_in_edges_tensor generation:  0.03587150573730469
mini_batch_src_global generation:  0.05954337120056152
r_  generation:  0.49968576431274414
local_output_nid generation:  0.035384416580200195
local_in_edges_tensor generation:  0.036569833755493164
mini_batch_src_global generation:  0.05818533897399902
r_  generation:  0.5037796497344971
----------------------check_connections_block total spend ----------------------------- 3.0198066234588623
generate_one_block  0.6273670196533203
generate_one_block  0.6283583641052246
generate_one_block  0.6332495212554932
generate_one_block  0.633244514465332
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.1514143943786621  GigaBytes
Max Memory Allocated: 1.348137378692627  GigaBytes

connection checking time:  5.914474725723267
block generation total time  5.087985038757324
average batch blocks generation time:  1.271996259689331
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.11095380783081055  GigaBytes
Max Memory Allocated: 1.348137378692627  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1436948776245117  GigaBytes
Max Memory Allocated: 1.348137378692627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.11084175109863281  GigaBytes
Max Memory Allocated: 1.348701000213623  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.1388468742370605  GigaBytes
Max Memory Allocated: 1.348701000213623  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.11087989807128906  GigaBytes
Max Memory Allocated: 1.348701000213623  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.1444573402404785  GigaBytes
Max Memory Allocated: 1.348701000213623  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.11089849472045898  GigaBytes
Max Memory Allocated: 1.3493280410766602  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.1441373825073242  GigaBytes
Max Memory Allocated: 1.3493280410766602  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08574569225311279 |0.023190438747406006 |0.0037720799446105957 |0.00010401010513305664 |0.01698291301727295 |0.001810312271118164 |
----------------------------------------------------------pseudo_mini_loss sum 3.243075132369995
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  1722240
Number of first layer input nodes during this epoch:  662046
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.15193843841552734  GigaBytes
Max Memory Allocated: 1.3493280410766602  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02910637855529785
range selection method range initialization spend 0.013291120529174805
time for parepare:  0.017941951751708984
local_output_nid generation:  0.005368232727050781
local_in_edges_tensor generation:  0.009461164474487305
mini_batch_src_global generation:  0.007633686065673828
r_  generation:  0.09670186042785645
local_output_nid generation:  0.0061626434326171875
local_in_edges_tensor generation:  0.003566741943359375
mini_batch_src_global generation:  0.009989500045776367
r_  generation:  0.10042047500610352
local_output_nid generation:  0.006182432174682617
local_in_edges_tensor generation:  0.0032808780670166016
mini_batch_src_global generation:  0.008841514587402344
r_  generation:  0.10409188270568848
local_output_nid generation:  0.00615239143371582
local_in_edges_tensor generation:  0.003220796585083008
mini_batch_src_global generation:  0.008324146270751953
r_  generation:  0.10662508010864258
----------------------check_connections_block total spend ----------------------------- 0.5842633247375488
generate_one_block  0.11747550964355469
generate_one_block  0.1151423454284668
generate_one_block  0.11690735816955566
generate_one_block  0.11450982093811035
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04293656349182129
gen group dst list time:  0.01188802719116211
time for parepare:  0.019278287887573242
local_output_nid generation:  0.01596236228942871
local_in_edges_tensor generation:  0.03727889060974121
mini_batch_src_global generation:  0.047765254974365234
r_  generation:  0.48413944244384766
local_output_nid generation:  0.02366781234741211
local_in_edges_tensor generation:  0.03239250183105469
mini_batch_src_global generation:  0.056284189224243164
r_  generation:  0.4946880340576172
local_output_nid generation:  0.02426934242248535
local_in_edges_tensor generation:  0.03677105903625488
mini_batch_src_global generation:  0.057343244552612305
r_  generation:  0.5185446739196777
local_output_nid generation:  0.025502681732177734
local_in_edges_tensor generation:  0.038184165954589844
mini_batch_src_global generation:  0.05941367149353027
r_  generation:  0.5049083232879639
----------------------check_connections_block total spend ----------------------------- 2.9069161415100098
generate_one_block  0.6401591300964355
generate_one_block  0.6523292064666748
generate_one_block  0.6560299396514893
generate_one_block  0.6304824352264404
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028423309326171875
gen group dst list time:  0.022619009017944336
time for parepare:  0.019211769104003906
local_output_nid generation:  0.025261640548706055
local_in_edges_tensor generation:  0.0504148006439209
mini_batch_src_global generation:  0.04525613784790039
r_  generation:  0.5015876293182373
local_output_nid generation:  0.035598039627075195
local_in_edges_tensor generation:  0.039786338806152344
mini_batch_src_global generation:  0.057248592376708984
r_  generation:  0.5175364017486572
local_output_nid generation:  0.035674095153808594
local_in_edges_tensor generation:  0.042751312255859375
mini_batch_src_global generation:  0.05959582328796387
r_  generation:  0.5310444831848145
local_output_nid generation:  0.03943896293640137
local_in_edges_tensor generation:  0.0381162166595459
mini_batch_src_global generation:  0.05785775184631348
r_  generation:  0.5208592414855957
----------------------check_connections_block total spend ----------------------------- 3.0668740272521973
generate_one_block  0.6367373466491699
generate_one_block  0.6468160152435303
generate_one_block  0.6522030830383301
generate_one_block  0.6271495819091797
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.15193843841552734  GigaBytes
Max Memory Allocated: 1.3493280410766602  GigaBytes

connection checking time:  5.973790168762207
block generation total time  5.14190673828125
average batch blocks generation time:  1.2854766845703125
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.11133766174316406  GigaBytes
Max Memory Allocated: 1.3493280410766602  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.1439175605773926  GigaBytes
Max Memory Allocated: 1.3493280410766602  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.11089706420898438  GigaBytes
Max Memory Allocated: 1.3493280410766602  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.1392955780029297  GigaBytes
Max Memory Allocated: 1.3493280410766602  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.11102485656738281  GigaBytes
Max Memory Allocated: 1.3493280410766602  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.1448569297790527  GigaBytes
Max Memory Allocated: 1.3493280410766602  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.11074972152709961  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.1359186172485352  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07886391878128052 |0.02042973041534424 |0.0088958740234375 |9.709596633911133e-05 |0.01192927360534668 |0.002051830291748047 |
----------------------------------------------------------pseudo_mini_loss sum 2.610806941986084
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  1721687
Number of first layer input nodes during this epoch:  661993
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.15099620819091797  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02322840690612793
range selection method range initialization spend 0.011653900146484375
time for parepare:  0.01848125457763672
local_output_nid generation:  0.0053403377532958984
local_in_edges_tensor generation:  0.0073070526123046875
mini_batch_src_global generation:  0.0076220035552978516
r_  generation:  0.09152793884277344
local_output_nid generation:  0.006106138229370117
local_in_edges_tensor generation:  0.003165721893310547
mini_batch_src_global generation:  0.00979924201965332
r_  generation:  0.09778451919555664
local_output_nid generation:  0.0061604976654052734
local_in_edges_tensor generation:  0.00359344482421875
mini_batch_src_global generation:  0.007781982421875
r_  generation:  0.10239243507385254
local_output_nid generation:  0.006140708923339844
local_in_edges_tensor generation:  0.0035479068756103516
mini_batch_src_global generation:  0.010332345962524414
r_  generation:  0.1087334156036377
----------------------check_connections_block total spend ----------------------------- 0.5758702754974365
generate_one_block  0.11325931549072266
generate_one_block  0.11349010467529297
generate_one_block  0.11858987808227539
generate_one_block  0.11937665939331055
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.044327497482299805
gen group dst list time:  0.012170076370239258
time for parepare:  0.020944833755493164
local_output_nid generation:  0.016078472137451172
local_in_edges_tensor generation:  0.03695511817932129
mini_batch_src_global generation:  0.04548478126525879
r_  generation:  0.4674530029296875
local_output_nid generation:  0.02651834487915039
local_in_edges_tensor generation:  0.0385894775390625
mini_batch_src_global generation:  0.055823564529418945
r_  generation:  0.48329901695251465
local_output_nid generation:  0.023764610290527344
local_in_edges_tensor generation:  0.03319382667541504
mini_batch_src_global generation:  0.0552980899810791
r_  generation:  0.5018911361694336
local_output_nid generation:  0.0254976749420166
local_in_edges_tensor generation:  0.027189016342163086
mini_batch_src_global generation:  0.05610036849975586
r_  generation:  0.49018192291259766
----------------------check_connections_block total spend ----------------------------- 2.822463274002075
generate_one_block  0.6251752376556396
generate_one_block  0.6189830303192139
generate_one_block  0.6574306488037109
generate_one_block  0.6266238689422607
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.031093597412109375
gen group dst list time:  0.022008657455444336
time for parepare:  0.020663976669311523
local_output_nid generation:  0.025742292404174805
local_in_edges_tensor generation:  0.042656898498535156
mini_batch_src_global generation:  0.0474698543548584
r_  generation:  0.49653124809265137
local_output_nid generation:  0.03488492965698242
local_in_edges_tensor generation:  0.03722739219665527
mini_batch_src_global generation:  0.056467294692993164
r_  generation:  0.5056359767913818
local_output_nid generation:  0.03563404083251953
local_in_edges_tensor generation:  0.03494739532470703
mini_batch_src_global generation:  0.05850553512573242
r_  generation:  0.5052142143249512
local_output_nid generation:  0.0358736515045166
local_in_edges_tensor generation:  0.036025047302246094
mini_batch_src_global generation:  0.05533647537231445
r_  generation:  0.5097191333770752
----------------------check_connections_block total spend ----------------------------- 2.9820070266723633
generate_one_block  0.6259400844573975
generate_one_block  0.6331179141998291
generate_one_block  0.6391818523406982
generate_one_block  0.627122163772583
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.15099620819091797  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

connection checking time:  5.8044703006744385
block generation total time  5.053574800491333
average batch blocks generation time:  1.2633937001228333
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.11089563369750977  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.1400713920593262  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.11078929901123047  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.13767671585083  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.11092853546142578  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.144880771636963  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.11149406433105469  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.1387991905212402  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09220743179321289 |0.014748454093933105 |0.0035929083824157715 |9.804964065551758e-05 |0.0037261247634887695 |0.0031402111053466797 |
----------------------------------------------------------pseudo_mini_loss sum 2.3767459392547607
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  1721311
Number of first layer input nodes during this epoch:  662039
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.1513824462890625  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0176851749420166
range selection method range initialization spend 0.011841058731079102
time for parepare:  0.017309188842773438
local_output_nid generation:  0.005251407623291016
local_in_edges_tensor generation:  0.0057430267333984375
mini_batch_src_global generation:  0.0077512264251708984
r_  generation:  0.09195423126220703
local_output_nid generation:  0.006124019622802734
local_in_edges_tensor generation:  0.0031707286834716797
mini_batch_src_global generation:  0.010042428970336914
r_  generation:  0.09831452369689941
local_output_nid generation:  0.0060787200927734375
local_in_edges_tensor generation:  0.0031876564025878906
mini_batch_src_global generation:  0.007664203643798828
r_  generation:  0.10338973999023438
local_output_nid generation:  0.006155490875244141
local_in_edges_tensor generation:  0.0032796859741210938
mini_batch_src_global generation:  0.008168220520019531
r_  generation:  0.10472750663757324
----------------------check_connections_block total spend ----------------------------- 0.5680115222930908
generate_one_block  0.11500215530395508
generate_one_block  0.11565852165222168
generate_one_block  0.1174476146697998
generate_one_block  0.11602044105529785
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.036108970642089844
gen group dst list time:  0.011817693710327148
time for parepare:  0.019582033157348633
local_output_nid generation:  0.015617132186889648
local_in_edges_tensor generation:  0.03383231163024902
mini_batch_src_global generation:  0.06023693084716797
r_  generation:  0.47458767890930176
local_output_nid generation:  0.023241758346557617
local_in_edges_tensor generation:  0.02989816665649414
mini_batch_src_global generation:  0.05830740928649902
r_  generation:  0.4897725582122803
local_output_nid generation:  0.023618221282958984
local_in_edges_tensor generation:  0.02955174446105957
mini_batch_src_global generation:  0.056588172912597656
r_  generation:  0.4900054931640625
local_output_nid generation:  0.023986339569091797
local_in_edges_tensor generation:  0.026153564453125
mini_batch_src_global generation:  0.05742073059082031
r_  generation:  0.4992992877960205
----------------------check_connections_block total spend ----------------------------- 2.818470001220703
generate_one_block  0.6169190406799316
generate_one_block  0.6235966682434082
generate_one_block  0.6460330486297607
generate_one_block  0.624004602432251
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.025377273559570312
gen group dst list time:  0.022097110748291016
time for parepare:  0.019073486328125
local_output_nid generation:  0.02430272102355957
local_in_edges_tensor generation:  0.03859877586364746
mini_batch_src_global generation:  0.044989824295043945
r_  generation:  0.49887990951538086
local_output_nid generation:  0.033507585525512695
local_in_edges_tensor generation:  0.03380584716796875
mini_batch_src_global generation:  0.056529998779296875
r_  generation:  0.5102500915527344
local_output_nid generation:  0.03451704978942871
local_in_edges_tensor generation:  0.0339963436126709
mini_batch_src_global generation:  0.056387901306152344
r_  generation:  0.5075562000274658
local_output_nid generation:  0.03504300117492676
local_in_edges_tensor generation:  0.034302711486816406
mini_batch_src_global generation:  0.056176185607910156
r_  generation:  0.5153441429138184
----------------------check_connections_block total spend ----------------------------- 2.972553253173828
generate_one_block  0.6252367496490479
generate_one_block  0.6267256736755371
generate_one_block  0.6278345584869385
generate_one_block  0.6301019191741943
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.1513824462890625  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

connection checking time:  5.791023254394531
block generation total time  5.020452260971069
average batch blocks generation time:  1.2551130652427673
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.11087656021118164  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.1399335861206055  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.11088848114013672  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.1397762298583984  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.11093425750732422  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.144679069519043  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.11081981658935547  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.1405839920043945  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09127640724182129 |0.015364885330200195 |0.003628671169281006 |9.065866470336914e-05 |0.003682553768157959 |0.0016193389892578125 |
----------------------------------------------------------pseudo_mini_loss sum 2.115917205810547
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  1721764
Number of first layer input nodes during this epoch:  661966
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.15171051025390625  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019884824752807617
range selection method range initialization spend 0.011881589889526367
time for parepare:  0.01719832420349121
local_output_nid generation:  0.005382061004638672
local_in_edges_tensor generation:  0.005559206008911133
mini_batch_src_global generation:  0.007814407348632812
r_  generation:  0.09257936477661133
local_output_nid generation:  0.006119966506958008
local_in_edges_tensor generation:  0.0031919479370117188
mini_batch_src_global generation:  0.010342121124267578
r_  generation:  0.10031580924987793
local_output_nid generation:  0.00906991958618164
local_in_edges_tensor generation:  0.0032050609588623047
mini_batch_src_global generation:  0.007889032363891602
r_  generation:  0.10539412498474121
local_output_nid generation:  0.006209850311279297
local_in_edges_tensor generation:  0.003567934036254883
mini_batch_src_global generation:  0.008208990097045898
r_  generation:  0.10501980781555176
----------------------check_connections_block total spend ----------------------------- 0.5779838562011719
generate_one_block  0.11271524429321289
generate_one_block  0.11789536476135254
generate_one_block  0.11489105224609375
generate_one_block  0.11556029319763184
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.037972211837768555
gen group dst list time:  0.011844873428344727
time for parepare:  0.01944255828857422
local_output_nid generation:  0.01627349853515625
local_in_edges_tensor generation:  0.026855945587158203
mini_batch_src_global generation:  0.04502296447753906
r_  generation:  0.47011256217956543
local_output_nid generation:  0.024103879928588867
local_in_edges_tensor generation:  0.027004003524780273
mini_batch_src_global generation:  0.05611991882324219
r_  generation:  0.485013484954834
local_output_nid generation:  0.023586034774780273
local_in_edges_tensor generation:  0.028835058212280273
mini_batch_src_global generation:  0.05600261688232422
r_  generation:  0.4855988025665283
local_output_nid generation:  0.024266958236694336
local_in_edges_tensor generation:  0.027746915817260742
mini_batch_src_global generation:  0.05683469772338867
r_  generation:  0.4877505302429199
----------------------check_connections_block total spend ----------------------------- 2.7681901454925537
generate_one_block  0.6185305118560791
generate_one_block  0.6245059967041016
generate_one_block  0.6488161087036133
generate_one_block  0.6131067276000977
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.027128934860229492
gen group dst list time:  0.022094249725341797
time for parepare:  0.019292354583740234
local_output_nid generation:  0.026271581649780273
local_in_edges_tensor generation:  0.037519216537475586
mini_batch_src_global generation:  0.045777320861816406
r_  generation:  0.5000729560852051
local_output_nid generation:  0.03463029861450195
local_in_edges_tensor generation:  0.03993678092956543
mini_batch_src_global generation:  0.06154942512512207
r_  generation:  0.5061342716217041
local_output_nid generation:  0.035791873931884766
local_in_edges_tensor generation:  0.03425884246826172
mini_batch_src_global generation:  0.05644059181213379
r_  generation:  0.5159347057342529
local_output_nid generation:  0.03577899932861328
local_in_edges_tensor generation:  0.0368952751159668
mini_batch_src_global generation:  0.05681443214416504
r_  generation:  0.5071110725402832
----------------------check_connections_block total spend ----------------------------- 2.9948930740356445
generate_one_block  0.6423101425170898
generate_one_block  0.6362051963806152
generate_one_block  0.6326823234558105
generate_one_block  0.631169319152832
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.15171051025390625  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

connection checking time:  5.763083219528198
block generation total time  5.047326326370239
average batch blocks generation time:  1.2618315815925598
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.11124515533447266  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.1401777267456055  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.1110239028930664  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.144312858581543  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.11083459854125977  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.1388072967529297  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.1108236312866211  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.1386003494262695  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09379088878631592 |0.01930379867553711 |0.003624260425567627 |8.994340896606445e-05 |0.003713369369506836 |0.0027170181274414062 |
----------------------------------------------------------pseudo_mini_loss sum 1.961225152015686
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  1721440
Number of first layer input nodes during this epoch:  661988
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.15118741989135742  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019794464111328125
range selection method range initialization spend 0.011817216873168945
time for parepare:  0.017120361328125
local_output_nid generation:  0.005258083343505859
local_in_edges_tensor generation:  0.007137775421142578
mini_batch_src_global generation:  0.00784158706665039
r_  generation:  0.09252524375915527
local_output_nid generation:  0.0060427188873291016
local_in_edges_tensor generation:  0.0033380985260009766
mini_batch_src_global generation:  0.009885311126708984
r_  generation:  0.09936952590942383
local_output_nid generation:  0.006051540374755859
local_in_edges_tensor generation:  0.0032362937927246094
mini_batch_src_global generation:  0.007836341857910156
r_  generation:  0.10404300689697266
local_output_nid generation:  0.006148099899291992
local_in_edges_tensor generation:  0.0031785964965820312
mini_batch_src_global generation:  0.008491992950439453
r_  generation:  0.1065833568572998
----------------------check_connections_block total spend ----------------------------- 0.5738041400909424
generate_one_block  0.11281919479370117
generate_one_block  0.11464166641235352
generate_one_block  0.11679887771606445
generate_one_block  0.11830592155456543
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03837704658508301
gen group dst list time:  0.011806011199951172
time for parepare:  0.019394397735595703
local_output_nid generation:  0.01645493507385254
local_in_edges_tensor generation:  0.03166317939758301
mini_batch_src_global generation:  0.04541277885437012
r_  generation:  0.4708688259124756
local_output_nid generation:  0.024097919464111328
local_in_edges_tensor generation:  0.02757573127746582
mini_batch_src_global generation:  0.056580543518066406
r_  generation:  0.4819204807281494
local_output_nid generation:  0.02401900291442871
local_in_edges_tensor generation:  0.025660991668701172
mini_batch_src_global generation:  0.05640888214111328
r_  generation:  0.4851059913635254
local_output_nid generation:  0.02460455894470215
local_in_edges_tensor generation:  0.027782440185546875
mini_batch_src_global generation:  0.05854225158691406
r_  generation:  0.49045228958129883
----------------------check_connections_block total spend ----------------------------- 2.7686166763305664
generate_one_block  0.6261579990386963
generate_one_block  0.6259374618530273
generate_one_block  0.6462137699127197
generate_one_block  0.6266002655029297
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.025661468505859375
gen group dst list time:  0.02239251136779785
time for parepare:  0.01874232292175293
local_output_nid generation:  0.025007963180541992
local_in_edges_tensor generation:  0.037107229232788086
mini_batch_src_global generation:  0.044774532318115234
r_  generation:  0.5020291805267334
local_output_nid generation:  0.034093618392944336
local_in_edges_tensor generation:  0.034088850021362305
mini_batch_src_global generation:  0.056696414947509766
r_  generation:  0.5064983367919922
local_output_nid generation:  0.034914493560791016
local_in_edges_tensor generation:  0.031725168228149414
mini_batch_src_global generation:  0.05649161338806152
r_  generation:  0.507502555847168
local_output_nid generation:  0.03462719917297363
local_in_edges_tensor generation:  0.03360128402709961
mini_batch_src_global generation:  0.05549955368041992
r_  generation:  0.5089099407196045
----------------------check_connections_block total spend ----------------------------- 2.9612441062927246
generate_one_block  0.6219747066497803
generate_one_block  0.6307110786437988
generate_one_block  0.6300382614135742
generate_one_block  0.6278026103973389
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.15118741989135742  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

connection checking time:  5.729860782623291
block generation total time  5.035436153411865
average batch blocks generation time:  1.2588590383529663
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.11082887649536133  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.1445555686950684  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.11085748672485352  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.1399245262145996  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.11113405227661133  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.138526439666748  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.1109466552734375  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.1437082290649414  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08998948335647583 |0.014305591583251953 |0.0036166906356811523 |9.691715240478516e-05 |0.0032843947410583496 |0.0013663768768310547 |
----------------------------------------------------------pseudo_mini_loss sum 1.8823236227035522
 Run 0| Epoch 6 |
Number of nodes for computation during this epoch:  1721815
Number of first layer input nodes during this epoch:  661934
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.15150976181030273  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02040719985961914
range selection method range initialization spend 0.011882781982421875
time for parepare:  0.017187833786010742
local_output_nid generation:  0.005326271057128906
local_in_edges_tensor generation:  0.005677938461303711
mini_batch_src_global generation:  0.00774073600769043
r_  generation:  0.09085321426391602
local_output_nid generation:  0.006125926971435547
local_in_edges_tensor generation:  0.003549337387084961
mini_batch_src_global generation:  0.013092041015625
r_  generation:  0.09932589530944824
local_output_nid generation:  0.006429910659790039
local_in_edges_tensor generation:  0.0032966136932373047
mini_batch_src_global generation:  0.007835865020751953
r_  generation:  0.10397577285766602
local_output_nid generation:  0.0063555240631103516
local_in_edges_tensor generation:  0.0033364295959472656
mini_batch_src_global generation:  0.008518695831298828
r_  generation:  0.10747480392456055
----------------------check_connections_block total spend ----------------------------- 0.5788276195526123
generate_one_block  0.11294317245483398
generate_one_block  0.11495041847229004
generate_one_block  0.11918020248413086
generate_one_block  0.11791777610778809
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03997039794921875
gen group dst list time:  0.012095451354980469
time for parepare:  0.020366191864013672
local_output_nid generation:  0.016262292861938477
local_in_edges_tensor generation:  0.031026124954223633
mini_batch_src_global generation:  0.047669410705566406
r_  generation:  0.4785120487213135
local_output_nid generation:  0.023598909378051758
local_in_edges_tensor generation:  0.028685808181762695
mini_batch_src_global generation:  0.06331562995910645
r_  generation:  0.48560428619384766
local_output_nid generation:  0.024123668670654297
local_in_edges_tensor generation:  0.0301973819732666
mini_batch_src_global generation:  0.07039546966552734
r_  generation:  0.4967331886291504
local_output_nid generation:  0.026484251022338867
local_in_edges_tensor generation:  0.03255200386047363
mini_batch_src_global generation:  0.059899091720581055
r_  generation:  0.4935150146484375
----------------------check_connections_block total spend ----------------------------- 2.836564540863037
generate_one_block  0.6276223659515381
generate_one_block  0.6175861358642578
generate_one_block  0.663597583770752
generate_one_block  0.6297993659973145
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02382063865661621
gen group dst list time:  0.02237248420715332
time for parepare:  0.018918752670288086
local_output_nid generation:  0.024667024612426758
local_in_edges_tensor generation:  0.0437471866607666
mini_batch_src_global generation:  0.04742312431335449
r_  generation:  0.4956016540527344
local_output_nid generation:  0.03377532958984375
local_in_edges_tensor generation:  0.03927350044250488
mini_batch_src_global generation:  0.055557966232299805
r_  generation:  0.5067217350006104
local_output_nid generation:  0.03517341613769531
local_in_edges_tensor generation:  0.03395676612854004
mini_batch_src_global generation:  0.05630826950073242
r_  generation:  0.5100405216217041
local_output_nid generation:  0.03556394577026367
local_in_edges_tensor generation:  0.03506803512573242
mini_batch_src_global generation:  0.055365800857543945
r_  generation:  0.5111074447631836
----------------------check_connections_block total spend ----------------------------- 2.978713274002075
generate_one_block  0.6283137798309326
generate_one_block  0.628657341003418
generate_one_block  0.6373851299285889
generate_one_block  0.6372337341308594
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.15150976181030273  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

connection checking time:  5.815277814865112
block generation total time  5.070195436477661
average batch blocks generation time:  1.2675488591194153
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.1109161376953125  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.1376776695251465  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.11086416244506836  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.1391873359680176  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.11084604263305664  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.1444201469421387  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.11092281341552734  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.1444787979125977  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0920293927192688 |0.01510709524154663 |0.0037454962730407715 |9.59634780883789e-05 |0.003743767738342285 |0.0015227794647216797 |
----------------------------------------------------------pseudo_mini_loss sum 1.7928088903427124
 Run 0| Epoch 7 |
Number of nodes for computation during this epoch:  1721871
Number of first layer input nodes during this epoch:  662237
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.1518993377685547  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02029132843017578
range selection method range initialization spend 0.011925220489501953
time for parepare:  0.017351388931274414
local_output_nid generation:  0.005357265472412109
local_in_edges_tensor generation:  0.006003141403198242
mini_batch_src_global generation:  0.007742166519165039
r_  generation:  0.09280133247375488
local_output_nid generation:  0.006028652191162109
local_in_edges_tensor generation:  0.0032160282135009766
mini_batch_src_global generation:  0.010218143463134766
r_  generation:  0.1019127368927002
local_output_nid generation:  0.006064176559448242
local_in_edges_tensor generation:  0.003307342529296875
mini_batch_src_global generation:  0.007610321044921875
r_  generation:  0.10430121421813965
local_output_nid generation:  0.006141185760498047
local_in_edges_tensor generation:  0.0031659603118896484
mini_batch_src_global generation:  0.008687496185302734
r_  generation:  0.10697627067565918
----------------------check_connections_block total spend ----------------------------- 0.5769715309143066
generate_one_block  0.11271476745605469
generate_one_block  0.11720800399780273
generate_one_block  0.11616921424865723
generate_one_block  0.11791801452636719
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04069209098815918
gen group dst list time:  0.012058734893798828
time for parepare:  0.019339561462402344
local_output_nid generation:  0.016138792037963867
local_in_edges_tensor generation:  0.0333552360534668
mini_batch_src_global generation:  0.04634594917297363
r_  generation:  0.4728236198425293
local_output_nid generation:  0.023384809494018555
local_in_edges_tensor generation:  0.031639814376831055
mini_batch_src_global generation:  0.058441162109375
r_  generation:  0.4883732795715332
local_output_nid generation:  0.023334503173828125
local_in_edges_tensor generation:  0.02858257293701172
mini_batch_src_global generation:  0.05584549903869629
r_  generation:  0.4905259609222412
local_output_nid generation:  0.023848295211791992
local_in_edges_tensor generation:  0.025773286819458008
mini_batch_src_global generation:  0.05988287925720215
r_  generation:  0.5021114349365234
----------------------check_connections_block total spend ----------------------------- 2.801835536956787
generate_one_block  0.6148016452789307
generate_one_block  0.6319580078125
generate_one_block  0.6501197814941406
generate_one_block  0.6225051879882812
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.024705171585083008
gen group dst list time:  0.02237415313720703
time for parepare:  0.01896357536315918
local_output_nid generation:  0.024757862091064453
local_in_edges_tensor generation:  0.035796165466308594
mini_batch_src_global generation:  0.04614734649658203
r_  generation:  0.4975268840789795
local_output_nid generation:  0.03328680992126465
local_in_edges_tensor generation:  0.03249549865722656
mini_batch_src_global generation:  0.05554771423339844
r_  generation:  0.5136284828186035
local_output_nid generation:  0.03486275672912598
local_in_edges_tensor generation:  0.03745532035827637
mini_batch_src_global generation:  0.056741952896118164
r_  generation:  0.5123741626739502
local_output_nid generation:  0.03467559814453125
local_in_edges_tensor generation:  0.03502535820007324
mini_batch_src_global generation:  0.05578923225402832
r_  generation:  0.5146136283874512
----------------------check_connections_block total spend ----------------------------- 2.9801881313323975
generate_one_block  0.6280081272125244
generate_one_block  0.6367230415344238
generate_one_block  0.6269214153289795
generate_one_block  0.6247332096099854
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.1518993377685547  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

connection checking time:  5.782023668289185
block generation total time  5.035770416259766
average batch blocks generation time:  1.2589426040649414
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.1110692024230957  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.1360864639282227  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.11098098754882812  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.1438002586364746  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.11082124710083008  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.1390604972839355  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.11101818084716797  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.1442255973815918  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08698707818984985 |0.016681551933288574 |0.0035058259963989258 |9.137392044067383e-05 |0.0029526948928833008 |0.0014998912811279297 |
----------------------------------------------------------pseudo_mini_loss sum 1.7021936178207397
 Run 0| Epoch 8 |
Number of nodes for computation during this epoch:  1720509
Number of first layer input nodes during this epoch:  661683
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.15175962448120117  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02058577537536621
range selection method range initialization spend 0.011949300765991211
time for parepare:  0.017935991287231445
local_output_nid generation:  0.005433320999145508
local_in_edges_tensor generation:  0.00567626953125
mini_batch_src_global generation:  0.007704973220825195
r_  generation:  0.09360623359680176
local_output_nid generation:  0.006697893142700195
local_in_edges_tensor generation:  0.0031766891479492188
mini_batch_src_global generation:  0.010185956954956055
r_  generation:  0.09831714630126953
local_output_nid generation:  0.00669097900390625
local_in_edges_tensor generation:  0.0036907196044921875
mini_batch_src_global generation:  0.0078125
r_  generation:  0.10243582725524902
local_output_nid generation:  0.006684541702270508
local_in_edges_tensor generation:  0.003172636032104492
mini_batch_src_global generation:  0.008484601974487305
r_  generation:  0.10564875602722168
----------------------check_connections_block total spend ----------------------------- 0.5767900943756104
generate_one_block  0.11227083206176758
generate_one_block  0.11588811874389648
generate_one_block  0.11669635772705078
generate_one_block  0.11643862724304199
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04043173789978027
gen group dst list time:  0.011970281600952148
time for parepare:  0.01949906349182129
local_output_nid generation:  0.015733003616333008
local_in_edges_tensor generation:  0.03803753852844238
mini_batch_src_global generation:  0.04572272300720215
r_  generation:  0.4707367420196533
local_output_nid generation:  0.02355813980102539
local_in_edges_tensor generation:  0.02878546714782715
mini_batch_src_global generation:  0.05541515350341797
r_  generation:  0.48016929626464844
local_output_nid generation:  0.024015188217163086
local_in_edges_tensor generation:  0.027599334716796875
mini_batch_src_global generation:  0.05588984489440918
r_  generation:  0.49030375480651855
local_output_nid generation:  0.024327754974365234
local_in_edges_tensor generation:  0.0294952392578125
mini_batch_src_global generation:  0.059920549392700195
r_  generation:  0.49118971824645996
----------------------check_connections_block total spend ----------------------------- 2.7845239639282227
generate_one_block  0.620619535446167
generate_one_block  0.6244325637817383
generate_one_block  0.6503708362579346
generate_one_block  0.6297645568847656
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029816865921020508
gen group dst list time:  0.02256178855895996
time for parepare:  0.01903676986694336
local_output_nid generation:  0.024596691131591797
local_in_edges_tensor generation:  0.034596920013427734
mini_batch_src_global generation:  0.0457761287689209
r_  generation:  0.5035524368286133
local_output_nid generation:  0.03398847579956055
local_in_edges_tensor generation:  0.03588676452636719
mini_batch_src_global generation:  0.05635380744934082
r_  generation:  0.5073461532592773
local_output_nid generation:  0.0342254638671875
local_in_edges_tensor generation:  0.03414797782897949
mini_batch_src_global generation:  0.0570681095123291
r_  generation:  0.5087802410125732
local_output_nid generation:  0.035279273986816406
local_in_edges_tensor generation:  0.03475618362426758
mini_batch_src_global generation:  0.055478572845458984
r_  generation:  0.5119762420654297
----------------------check_connections_block total spend ----------------------------- 2.9723312854766846
generate_one_block  0.6213748455047607
generate_one_block  0.633342981338501
generate_one_block  0.6297671794891357
generate_one_block  0.6294074058532715
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.15175962448120117  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

connection checking time:  5.756855249404907
block generation total time  5.039079904556274
average batch blocks generation time:  1.2597699761390686
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.1108708381652832  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.138474464416504  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.11082315444946289  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.1396093368530273  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.11152076721191406  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.1436305046081543  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.11092138290405273  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.1439847946166992  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09318113327026367 |0.01452714204788208 |0.0037575364112854004 |9.769201278686523e-05 |0.0036829710006713867 |0.0015451908111572266 |
----------------------------------------------------------pseudo_mini_loss sum 1.636794090270996
 Run 0| Epoch 9 |
Number of nodes for computation during this epoch:  1721321
Number of first layer input nodes during this epoch:  661851
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.15157794952392578  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.017603635787963867
range selection method range initialization spend 0.011829853057861328
time for parepare:  0.016838788986206055
local_output_nid generation:  0.005377769470214844
local_in_edges_tensor generation:  0.005633115768432617
mini_batch_src_global generation:  0.007866621017456055
r_  generation:  0.09308052062988281
local_output_nid generation:  0.0061130523681640625
local_in_edges_tensor generation:  0.003221273422241211
mini_batch_src_global generation:  0.010105371475219727
r_  generation:  0.09772205352783203
local_output_nid generation:  0.006269693374633789
local_in_edges_tensor generation:  0.003303050994873047
mini_batch_src_global generation:  0.0077571868896484375
r_  generation:  0.1029348373413086
local_output_nid generation:  0.0062024593353271484
local_in_edges_tensor generation:  0.0031685829162597656
mini_batch_src_global generation:  0.008168935775756836
r_  generation:  0.10526251792907715
----------------------check_connections_block total spend ----------------------------- 0.569016695022583
generate_one_block  0.11468863487243652
generate_one_block  0.11344790458679199
generate_one_block  0.11640501022338867
generate_one_block  0.11717510223388672
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.030955791473388672
gen group dst list time:  0.011867523193359375
time for parepare:  0.019541025161743164
local_output_nid generation:  0.016367673873901367
local_in_edges_tensor generation:  0.030542850494384766
mini_batch_src_global generation:  0.04609274864196777
r_  generation:  0.47565555572509766
local_output_nid generation:  0.023929595947265625
local_in_edges_tensor generation:  0.028109312057495117
mini_batch_src_global generation:  0.056153059005737305
r_  generation:  0.4843580722808838
local_output_nid generation:  0.024034738540649414
local_in_edges_tensor generation:  0.029257535934448242
mini_batch_src_global generation:  0.05884742736816406
r_  generation:  0.49699854850769043
local_output_nid generation:  0.02446126937866211
local_in_edges_tensor generation:  0.025918245315551758
mini_batch_src_global generation:  0.05701494216918945
r_  generation:  0.49414801597595215
----------------------check_connections_block total spend ----------------------------- 2.796597480773926
generate_one_block  0.6230678558349609
generate_one_block  0.6170809268951416
generate_one_block  0.6526124477386475
generate_one_block  0.6218447685241699
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.024809837341308594
gen group dst list time:  0.02252030372619629
time for parepare:  0.018980741500854492
local_output_nid generation:  0.02549910545349121
local_in_edges_tensor generation:  0.033326148986816406
mini_batch_src_global generation:  0.04547834396362305
r_  generation:  0.4984402656555176
local_output_nid generation:  0.034348249435424805
local_in_edges_tensor generation:  0.034116506576538086
mini_batch_src_global generation:  0.0561220645904541
r_  generation:  0.5010702610015869
local_output_nid generation:  0.03493690490722656
local_in_edges_tensor generation:  0.03638482093811035
mini_batch_src_global generation:  0.05727958679199219
r_  generation:  0.5096886157989502
local_output_nid generation:  0.035604238510131836
local_in_edges_tensor generation:  0.03439807891845703
mini_batch_src_global generation:  0.05761003494262695
r_  generation:  0.5096712112426758
----------------------check_connections_block total spend ----------------------------- 2.961186647415161
generate_one_block  0.6271946430206299
generate_one_block  0.6268496513366699
generate_one_block  0.6319842338562012
generate_one_block  0.633558988571167
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.15157794952392578  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

connection checking time:  5.757784128189087
block generation total time  5.034193515777588
average batch blocks generation time:  1.258548378944397
block dataloader generation time/epoch 12.624401092529297
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.11092138290405273  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.1436309814453125  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.1108403205871582  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.1386065483093262  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.11083316802978516  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.144282341003418  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.11086797714233398  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.140498161315918  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08831143379211426 |0.01443338394165039 |0.0035196542739868164 |9.053945541381836e-05 |0.003163754940032959 |0.0028405189514160156 |
----------------------------------------------------------pseudo_mini_loss sum 1.592149257659912
Total (block generation + training)time/epoch 13.155503273010254
Training time/epoch 0.5308620929718018
Training time without block to device /epoch 0.4731285572052002
Training time without total dataloading part /epoch 0.02993631362915039
load block tensor time/epoch 0.35324573516845703
block to device time/epoch 0.05773353576660156
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 10 |
Number of nodes for computation during this epoch:  1721287
Number of first layer input nodes during this epoch:  661897
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.15186691284179688  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.017486095428466797
range selection method range initialization spend 0.0117034912109375
time for parepare:  0.017278671264648438
local_output_nid generation:  0.005422353744506836
local_in_edges_tensor generation:  0.005543947219848633
mini_batch_src_global generation:  0.007870674133300781
r_  generation:  0.09288740158081055
local_output_nid generation:  0.0060579776763916016
local_in_edges_tensor generation:  0.003213167190551758
mini_batch_src_global generation:  0.010001897811889648
r_  generation:  0.09882116317749023
local_output_nid generation:  0.006138324737548828
local_in_edges_tensor generation:  0.0031747817993164062
mini_batch_src_global generation:  0.007841110229492188
r_  generation:  0.10211491584777832
local_output_nid generation:  0.0061206817626953125
local_in_edges_tensor generation:  0.0031883716583251953
mini_batch_src_global generation:  0.00811457633972168
r_  generation:  0.1053922176361084
----------------------check_connections_block total spend ----------------------------- 0.5692784786224365
generate_one_block  0.11449861526489258
generate_one_block  0.11492228507995605
generate_one_block  0.11578178405761719
generate_one_block  0.11639618873596191
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.027546405792236328
gen group dst list time:  0.011954307556152344
time for parepare:  0.020043373107910156
local_output_nid generation:  0.016417980194091797
local_in_edges_tensor generation:  0.027094602584838867
mini_batch_src_global generation:  0.04625678062438965
r_  generation:  0.4747917652130127
local_output_nid generation:  0.023563623428344727
local_in_edges_tensor generation:  0.025324106216430664
mini_batch_src_global generation:  0.055750370025634766
r_  generation:  0.4880826473236084
local_output_nid generation:  0.023937225341796875
local_in_edges_tensor generation:  0.026556015014648438
mini_batch_src_global generation:  0.05637192726135254
r_  generation:  0.4881443977355957
local_output_nid generation:  0.02418065071105957
local_in_edges_tensor generation:  0.03020191192626953
mini_batch_src_global generation:  0.05593419075012207
r_  generation:  0.4936859607696533
----------------------check_connections_block total spend ----------------------------- 2.777587890625
generate_one_block  0.621483325958252
generate_one_block  0.619940996170044
generate_one_block  0.6460447311401367
generate_one_block  0.617180585861206
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.024697065353393555
gen group dst list time:  0.022656917572021484
time for parepare:  0.019457578659057617
local_output_nid generation:  0.0248415470123291
local_in_edges_tensor generation:  0.03328680992126465
mini_batch_src_global generation:  0.047150373458862305
r_  generation:  0.49626803398132324
local_output_nid generation:  0.03323626518249512
local_in_edges_tensor generation:  0.031241178512573242
mini_batch_src_global generation:  0.05600380897521973
r_  generation:  0.5049459934234619
local_output_nid generation:  0.03469061851501465
local_in_edges_tensor generation:  0.03215622901916504
mini_batch_src_global generation:  0.05693650245666504
r_  generation:  0.5114750862121582
local_output_nid generation:  0.03525567054748535
local_in_edges_tensor generation:  0.031563520431518555
mini_batch_src_global generation:  0.05577206611633301
r_  generation:  0.5155119895935059
----------------------check_connections_block total spend ----------------------------- 2.959644317626953
generate_one_block  0.63031005859375
generate_one_block  0.6267955303192139
generate_one_block  0.6313276290893555
generate_one_block  0.6275849342346191
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.15186691284179688  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

connection checking time:  5.737232208251953
block generation total time  5.020667791366577
average batch blocks generation time:  1.2551669478416443
block dataloader generation time/epoch 12.590426564216614
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.11133241653442383  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.1435065269470215  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.11082887649536133  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.1390461921691895  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.11094522476196289  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.1437082290649414  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.11093473434448242  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.139493465423584  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09065449237823486 |0.016160130500793457 |0.003647923469543457 |8.916854858398438e-05 |0.0037285685539245605 |0.001604318618774414 |
----------------------------------------------------------pseudo_mini_loss sum 1.5542428493499756
Total (block generation + training)time/epoch 13.13032865524292
Training time/epoch 0.5484926700592041
Training time without block to device /epoch 0.4838521480560303
Training time without total dataloading part /epoch 0.03146696090698242
load block tensor time/epoch 0.36261796951293945
block to device time/epoch 0.06464052200317383
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 11 |
Number of nodes for computation during this epoch:  1721461
Number of first layer input nodes during this epoch:  661940
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.15135955810546875  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019998550415039062
range selection method range initialization spend 0.011872053146362305
time for parepare:  0.0169374942779541
local_output_nid generation:  0.005518913269042969
local_in_edges_tensor generation:  0.005722522735595703
mini_batch_src_global generation:  0.007953166961669922
r_  generation:  0.09605097770690918
local_output_nid generation:  0.0060863494873046875
local_in_edges_tensor generation:  0.003240346908569336
mini_batch_src_global generation:  0.01024770736694336
r_  generation:  0.10070681571960449
local_output_nid generation:  0.00606989860534668
local_in_edges_tensor generation:  0.0031795501708984375
mini_batch_src_global generation:  0.00748753547668457
r_  generation:  0.10271191596984863
local_output_nid generation:  0.006119966506958008
local_in_edges_tensor generation:  0.0031867027282714844
mini_batch_src_global generation:  0.00827932357788086
r_  generation:  0.10663628578186035
----------------------check_connections_block total spend ----------------------------- 0.5765213966369629
generate_one_block  0.11497068405151367
generate_one_block  0.11503076553344727
generate_one_block  0.11569571495056152
generate_one_block  0.11756563186645508
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02761244773864746
gen group dst list time:  0.011911630630493164
time for parepare:  0.019495487213134766
local_output_nid generation:  0.01626110076904297
local_in_edges_tensor generation:  0.029877901077270508
mini_batch_src_global generation:  0.045987844467163086
r_  generation:  0.4761514663696289
local_output_nid generation:  0.024162769317626953
local_in_edges_tensor generation:  0.029449939727783203
mini_batch_src_global generation:  0.056119680404663086
r_  generation:  0.4887809753417969
local_output_nid generation:  0.024306297302246094
local_in_edges_tensor generation:  0.026074647903442383
mini_batch_src_global generation:  0.05612325668334961
r_  generation:  0.4883291721343994
local_output_nid generation:  0.024424076080322266
local_in_edges_tensor generation:  0.03175950050354004
mini_batch_src_global generation:  0.05646157264709473
r_  generation:  0.48858213424682617
----------------------check_connections_block total spend ----------------------------- 2.7897677421569824
generate_one_block  0.6288402080535889
generate_one_block  0.6216945648193359
generate_one_block  0.6454265117645264
generate_one_block  0.624211311340332
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.026935100555419922
gen group dst list time:  0.022407054901123047
time for parepare:  0.020279407501220703
local_output_nid generation:  0.02494955062866211
local_in_edges_tensor generation:  0.03690457344055176
mini_batch_src_global generation:  0.045918941497802734
r_  generation:  0.5030043125152588
local_output_nid generation:  0.03354334831237793
local_in_edges_tensor generation:  0.03879570960998535
mini_batch_src_global generation:  0.05638909339904785
r_  generation:  0.5117628574371338
local_output_nid generation:  0.034804582595825195
local_in_edges_tensor generation:  0.04112577438354492
mini_batch_src_global generation:  0.059036970138549805
r_  generation:  0.5146856307983398
local_output_nid generation:  0.034769296646118164
local_in_edges_tensor generation:  0.03873467445373535
mini_batch_src_global generation:  0.05588507652282715
r_  generation:  0.5108611583709717
----------------------check_connections_block total spend ----------------------------- 2.9997589588165283
generate_one_block  0.6279435157775879
generate_one_block  0.6288886070251465
generate_one_block  0.6305973529815674
generate_one_block  0.6324739456176758
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.15135955810546875  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

connection checking time:  5.789526700973511
block generation total time  5.040076017379761
average batch blocks generation time:  1.2600190043449402
block dataloader generation time/epoch 12.61821174621582
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.11091136932373047  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.1447205543518066  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.11080169677734375  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.1398544311523438  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.11109495162963867  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.139017105102539  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.11090087890625  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.1403861045837402  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08831220865249634 |0.015864670276641846 |0.003475487232208252 |8.845329284667969e-05 |0.003244936466217041 |0.0018072128295898438 |
----------------------------------------------------------pseudo_mini_loss sum 1.5143063068389893
Total (block generation + training)time/epoch 13.156763633092245
Training time/epoch 0.5356435775756836
Training time without block to device /epoch 0.4721848964691162
Training time without total dataloading part /epoch 0.029042720794677734
load block tensor time/epoch 0.35324883460998535
block to device time/epoch 0.06345868110656738
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 12 |
Number of nodes for computation during this epoch:  1721663
Number of first layer input nodes during this epoch:  661920
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.15135526657104492  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021047592163085938
range selection method range initialization spend 0.01176762580871582
time for parepare:  0.018200397491455078
local_output_nid generation:  0.005327939987182617
local_in_edges_tensor generation:  0.007550239562988281
mini_batch_src_global generation:  0.007908344268798828
r_  generation:  0.09114408493041992
local_output_nid generation:  0.006009101867675781
local_in_edges_tensor generation:  0.003163576126098633
mini_batch_src_global generation:  0.010244369506835938
r_  generation:  0.09761977195739746
local_output_nid generation:  0.006045341491699219
local_in_edges_tensor generation:  0.0035009384155273438
mini_batch_src_global generation:  0.007853031158447266
r_  generation:  0.10092473030090332
local_output_nid generation:  0.006060123443603516
local_in_edges_tensor generation:  0.003800630569458008
mini_batch_src_global generation:  0.008469581604003906
r_  generation:  0.10428261756896973
----------------------check_connections_block total spend ----------------------------- 0.568603515625
generate_one_block  0.11264252662658691
generate_one_block  0.11462783813476562
generate_one_block  0.11567306518554688
generate_one_block  0.1173255443572998
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03585386276245117
gen group dst list time:  0.01172184944152832
time for parepare:  0.019501924514770508
local_output_nid generation:  0.016086339950561523
local_in_edges_tensor generation:  0.034477949142456055
mini_batch_src_global generation:  0.04973626136779785
r_  generation:  0.4647367000579834
local_output_nid generation:  0.024214506149291992
local_in_edges_tensor generation:  0.027142047882080078
mini_batch_src_global generation:  0.05703568458557129
r_  generation:  0.48429346084594727
local_output_nid generation:  0.024078845977783203
local_in_edges_tensor generation:  0.027016401290893555
mini_batch_src_global generation:  0.05774283409118652
r_  generation:  0.4945089817047119
local_output_nid generation:  0.024319171905517578
local_in_edges_tensor generation:  0.02874445915222168
mini_batch_src_global generation:  0.06363725662231445
r_  generation:  0.49889063835144043
----------------------check_connections_block total spend ----------------------------- 2.8017513751983643
generate_one_block  0.6305439472198486
generate_one_block  0.6212587356567383
generate_one_block  0.6479568481445312
generate_one_block  0.6278908252716064
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.025967836380004883
gen group dst list time:  0.0223848819732666
time for parepare:  0.018671751022338867
local_output_nid generation:  0.025440454483032227
local_in_edges_tensor generation:  0.03617691993713379
mini_batch_src_global generation:  0.04639101028442383
r_  generation:  0.49823570251464844
local_output_nid generation:  0.03400111198425293
local_in_edges_tensor generation:  0.03354048728942871
mini_batch_src_global generation:  0.0568995475769043
r_  generation:  0.5042495727539062
local_output_nid generation:  0.0347442626953125
local_in_edges_tensor generation:  0.03417062759399414
mini_batch_src_global generation:  0.0579071044921875
r_  generation:  0.5048172473907471
local_output_nid generation:  0.03470659255981445
local_in_edges_tensor generation:  0.034482717514038086
mini_batch_src_global generation:  0.05698418617248535
r_  generation:  0.5069785118103027
----------------------check_connections_block total spend ----------------------------- 2.9620277881622314
generate_one_block  0.6244029998779297
generate_one_block  0.624168872833252
generate_one_block  0.6238086223602295
generate_one_block  0.6279685497283936
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.15135526657104492  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

connection checking time:  5.763779163360596
block generation total time  5.027999401092529
average batch blocks generation time:  1.2569998502731323
block dataloader generation time/epoch 12.622942447662354
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.1108856201171875  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.1401581764221191  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.11089801788330078  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.1390914916992188  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.11084890365600586  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.1444621086120605  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.11089181900024414  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.1438560485839844  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08663177490234375 |0.014769017696380615 |0.004371047019958496 |0.00012618303298950195 |0.0028150081634521484 |0.0013196468353271484 |
----------------------------------------------------------pseudo_mini_loss sum 1.483180046081543
Total (block generation + training)time/epoch 13.158917963504791
Training time/epoch 0.5279839038848877
Training time without block to device /epoch 0.46890783309936523
Training time without total dataloading part /epoch 0.030568599700927734
load block tensor time/epoch 0.346527099609375
block to device time/epoch 0.05907607078552246
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 13 |
Number of nodes for computation during this epoch:  1722018
Number of first layer input nodes during this epoch:  662256
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.15189504623413086  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020543575286865234
range selection method range initialization spend 0.011779308319091797
time for parepare:  0.0168612003326416
local_output_nid generation:  0.005306720733642578
local_in_edges_tensor generation:  0.00634765625
mini_batch_src_global generation:  0.007907390594482422
r_  generation:  0.09302854537963867
local_output_nid generation:  0.005934953689575195
local_in_edges_tensor generation:  0.0032079219818115234
mini_batch_src_global generation:  0.010083436965942383
r_  generation:  0.09639859199523926
local_output_nid generation:  0.006066322326660156
local_in_edges_tensor generation:  0.00382232666015625
mini_batch_src_global generation:  0.008012533187866211
r_  generation:  0.1014862060546875
local_output_nid generation:  0.0061492919921875
local_in_edges_tensor generation:  0.0032434463500976562
mini_batch_src_global generation:  0.008173942565917969
r_  generation:  0.1042945384979248
----------------------check_connections_block total spend ----------------------------- 0.5661177635192871
generate_one_block  0.11333131790161133
generate_one_block  0.11568665504455566
generate_one_block  0.11554074287414551
generate_one_block  0.11613750457763672
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.028430461883544922
gen group dst list time:  0.011683464050292969
time for parepare:  0.019448041915893555
local_output_nid generation:  0.015666723251342773
local_in_edges_tensor generation:  0.026340007781982422
mini_batch_src_global generation:  0.04610037803649902
r_  generation:  0.476243257522583
local_output_nid generation:  0.024007320404052734
local_in_edges_tensor generation:  0.02455592155456543
mini_batch_src_global generation:  0.058292388916015625
r_  generation:  0.4983351230621338
local_output_nid generation:  0.024843931198120117
local_in_edges_tensor generation:  0.040657758712768555
mini_batch_src_global generation:  0.05900073051452637
r_  generation:  0.5278608798980713
local_output_nid generation:  0.026753902435302734
local_in_edges_tensor generation:  0.03719305992126465
mini_batch_src_global generation:  0.05716300010681152
r_  generation:  0.49422383308410645
----------------------check_connections_block total spend ----------------------------- 2.869340658187866
generate_one_block  0.6387488842010498
generate_one_block  0.647327184677124
generate_one_block  0.6578865051269531
generate_one_block  0.6411950588226318
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.025931596755981445
gen group dst list time:  0.02534794807434082
time for parepare:  0.018975257873535156
local_output_nid generation:  0.027500629425048828
local_in_edges_tensor generation:  0.04711508750915527
mini_batch_src_global generation:  0.04598283767700195
r_  generation:  0.4917023181915283
local_output_nid generation:  0.03359270095825195
local_in_edges_tensor generation:  0.03872537612915039
mini_batch_src_global generation:  0.06875491142272949
r_  generation:  0.5044817924499512
local_output_nid generation:  0.03439950942993164
local_in_edges_tensor generation:  0.038347721099853516
mini_batch_src_global generation:  0.05664873123168945
r_  generation:  0.5048975944519043
local_output_nid generation:  0.034833669662475586
local_in_edges_tensor generation:  0.03528738021850586
mini_batch_src_global generation:  0.05865645408630371
r_  generation:  0.5098202228546143
----------------------check_connections_block total spend ----------------------------- 2.998591661453247
generate_one_block  0.6410853862762451
generate_one_block  0.6406543254852295
generate_one_block  0.6440157890319824
generate_one_block  0.6271934509277344
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.15189504623413086  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

connection checking time:  5.867932319641113
block generation total time  5.13810658454895
average batch blocks generation time:  1.2845266461372375
block dataloader generation time/epoch 12.668168210983277
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.1113576889038086  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.1387152671813965  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.11097955703735352  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.1446480751037598  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.11109590530395508  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 1.1401968002319336  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.1109156608581543  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7283935546875 GB
    Memory Allocated: 1.1447834968566895  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08591574430465698 |0.021040737628936768 |0.010128140449523926 |9.775161743164062e-05 |0.016853809356689453 |0.003141164779663086 |
----------------------------------------------------------pseudo_mini_loss sum 1.449114203453064
Total (block generation + training)time/epoch 13.212208795547486
Training time/epoch 0.5760164260864258
Training time without block to device /epoch 0.4918534755706787
Training time without total dataloading part /epoch 0.11145997047424316
load block tensor time/epoch 0.34366297721862793
block to device time/epoch 0.08416295051574707
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 14 |
Number of nodes for computation during this epoch:  1723019
Number of first layer input nodes during this epoch:  662224
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15147876739501953  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020349979400634766
range selection method range initialization spend 0.011646509170532227
time for parepare:  0.016593456268310547
local_output_nid generation:  0.005506992340087891
local_in_edges_tensor generation:  0.006935596466064453
mini_batch_src_global generation:  0.00784158706665039
r_  generation:  0.09050679206848145
local_output_nid generation:  0.0062677860260009766
local_in_edges_tensor generation:  0.0032072067260742188
mini_batch_src_global generation:  0.00999760627746582
r_  generation:  0.09759092330932617
local_output_nid generation:  0.006083488464355469
local_in_edges_tensor generation:  0.0033223628997802734
mini_batch_src_global generation:  0.007814884185791016
r_  generation:  0.10384964942932129
local_output_nid generation:  0.0061724185943603516
local_in_edges_tensor generation:  0.0033278465270996094
mini_batch_src_global generation:  0.008242130279541016
r_  generation:  0.10689711570739746
----------------------check_connections_block total spend ----------------------------- 0.5711135864257812
generate_one_block  0.11827397346496582
generate_one_block  0.11478877067565918
generate_one_block  0.11652874946594238
generate_one_block  0.11611485481262207
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04192161560058594
gen group dst list time:  0.012881755828857422
time for parepare:  0.020879268646240234
local_output_nid generation:  0.017348527908325195
local_in_edges_tensor generation:  0.04119062423706055
mini_batch_src_global generation:  0.05197477340698242
r_  generation:  0.49492955207824707
local_output_nid generation:  0.03133368492126465
local_in_edges_tensor generation:  0.03383588790893555
mini_batch_src_global generation:  0.06155562400817871
r_  generation:  0.5098419189453125
local_output_nid generation:  0.031050443649291992
local_in_edges_tensor generation:  0.03507375717163086
mini_batch_src_global generation:  0.06108236312866211
r_  generation:  0.5392630100250244
local_output_nid generation:  0.033087968826293945
local_in_edges_tensor generation:  0.04329562187194824
mini_batch_src_global generation:  0.06471729278564453
r_  generation:  0.5008223056793213
----------------------check_connections_block total spend ----------------------------- 3.036900043487549
generate_one_block  0.6341285705566406
generate_one_block  0.6348328590393066
generate_one_block  0.6627628803253174
generate_one_block  0.6493690013885498
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03320598602294922
gen group dst list time:  0.023327112197875977
time for parepare:  0.019163131713867188
local_output_nid generation:  0.025320768356323242
local_in_edges_tensor generation:  0.04892921447753906
mini_batch_src_global generation:  0.05022430419921875
r_  generation:  0.5025925636291504
local_output_nid generation:  0.03592729568481445
local_in_edges_tensor generation:  0.03945422172546387
mini_batch_src_global generation:  0.057308197021484375
r_  generation:  0.5166294574737549
local_output_nid generation:  0.03594708442687988
local_in_edges_tensor generation:  0.04757404327392578
mini_batch_src_global generation:  0.07270455360412598
r_  generation:  0.5079433917999268
local_output_nid generation:  0.037699222564697266
local_in_edges_tensor generation:  0.039489030838012695
mini_batch_src_global generation:  0.05626845359802246
r_  generation:  0.509960412979126
----------------------check_connections_block total spend ----------------------------- 3.05684232711792
generate_one_block  0.631976842880249
generate_one_block  0.6349222660064697
generate_one_block  0.6556961536407471
generate_one_block  0.6459949016571045
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15147876739501953  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

connection checking time:  6.093742370605469
block generation total time  5.149683475494385
average batch blocks generation time:  1.2874208688735962
block dataloader generation time/epoch 12.755287090937296
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11082744598388672  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.139108657836914  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11124038696289062  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1386055946350098  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11086177825927734  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1432232856750488  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11093330383300781  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1436128616333008  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09327274560928345 |0.020508885383605957 |0.0037204623222351074 |9.757280349731445e-05 |0.0038945674896240234 |0.0014672279357910156 |
----------------------------------------------------------pseudo_mini_loss sum 1.4282082319259644
Total (block generation + training)time/epoch 13.30526610215505
Training time/epoch 0.5794029235839844
Training time without block to device /epoch 0.49736738204956055
Training time without total dataloading part /epoch 0.0323176383972168
load block tensor time/epoch 0.3730909824371338
block to device time/epoch 0.08203554153442383
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 15 |
Number of nodes for computation during this epoch:  1720545
Number of first layer input nodes during this epoch:  661898
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15146207809448242  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021187782287597656
range selection method range initialization spend 0.01176142692565918
time for parepare:  0.016615867614746094
local_output_nid generation:  0.005375385284423828
local_in_edges_tensor generation:  0.006408214569091797
mini_batch_src_global generation:  0.00765681266784668
r_  generation:  0.09252262115478516
local_output_nid generation:  0.006050825119018555
local_in_edges_tensor generation:  0.003216266632080078
mini_batch_src_global generation:  0.010264158248901367
r_  generation:  0.0984334945678711
local_output_nid generation:  0.0061283111572265625
local_in_edges_tensor generation:  0.0032663345336914062
mini_batch_src_global generation:  0.0077686309814453125
r_  generation:  0.101898193359375
local_output_nid generation:  0.006102323532104492
local_in_edges_tensor generation:  0.003381967544555664
mini_batch_src_global generation:  0.008534669876098633
r_  generation:  0.10657787322998047
----------------------check_connections_block total spend ----------------------------- 0.5698449611663818
generate_one_block  0.11150550842285156
generate_one_block  0.11563611030578613
generate_one_block  0.11454272270202637
generate_one_block  0.11858558654785156
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04262566566467285
gen group dst list time:  0.011858940124511719
time for parepare:  0.020163536071777344
local_output_nid generation:  0.015643596649169922
local_in_edges_tensor generation:  0.03625202178955078
mini_batch_src_global generation:  0.04573988914489746
r_  generation:  0.46929097175598145
local_output_nid generation:  0.023308515548706055
local_in_edges_tensor generation:  0.03396749496459961
mini_batch_src_global generation:  0.0565190315246582
r_  generation:  0.4886600971221924
local_output_nid generation:  0.023758411407470703
local_in_edges_tensor generation:  0.039861440658569336
mini_batch_src_global generation:  0.06689167022705078
r_  generation:  0.486574649810791
local_output_nid generation:  0.0258786678314209
local_in_edges_tensor generation:  0.0318455696105957
mini_batch_src_global generation:  0.05724072456359863
r_  generation:  0.49292588233947754
----------------------check_connections_block total spend ----------------------------- 2.825266122817993
generate_one_block  0.6220607757568359
generate_one_block  0.6286418437957764
generate_one_block  0.6538910865783691
generate_one_block  0.6318886280059814
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.026166915893554688
gen group dst list time:  0.0223081111907959
time for parepare:  0.018847942352294922
local_output_nid generation:  0.02448248863220215
local_in_edges_tensor generation:  0.049654483795166016
mini_batch_src_global generation:  0.04536557197570801
r_  generation:  0.49422335624694824
local_output_nid generation:  0.03349924087524414
local_in_edges_tensor generation:  0.03330421447753906
mini_batch_src_global generation:  0.056726932525634766
r_  generation:  0.49910998344421387
local_output_nid generation:  0.03523874282836914
local_in_edges_tensor generation:  0.03377103805541992
mini_batch_src_global generation:  0.05738234519958496
r_  generation:  0.5037519931793213
local_output_nid generation:  0.0349273681640625
local_in_edges_tensor generation:  0.03444957733154297
mini_batch_src_global generation:  0.05628395080566406
r_  generation:  0.5057685375213623
----------------------check_connections_block total spend ----------------------------- 2.957911252975464
generate_one_block  0.62526535987854
generate_one_block  0.632500171661377
generate_one_block  0.6355311870574951
generate_one_block  0.6325900554656982
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15146207809448242  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

connection checking time:  5.783177375793457
block generation total time  5.062369108200073
average batch blocks generation time:  1.2655922770500183
block dataloader generation time/epoch 12.758363076618739
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11082124710083008  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1370277404785156  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11089324951171875  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1410298347473145  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.1114659309387207  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.138139247894287  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11101484298706055  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1444311141967773  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09379351139068604 |0.014619529247283936 |0.0036649107933044434 |9.626150131225586e-05 |0.0038520097732543945 |0.0014262199401855469 |
----------------------------------------------------------pseudo_mini_loss sum 1.3949816226959229
Total (block generation + training)time/epoch 13.309411219188146
Training time/epoch 0.5572671890258789
Training time without block to device /epoch 0.49878907203674316
Training time without total dataloading part /epoch 0.03187894821166992
load block tensor time/epoch 0.37517404556274414
block to device time/epoch 0.05847811698913574
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 16 |
Number of nodes for computation during this epoch:  1721206
Number of first layer input nodes during this epoch:  662034
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.1517324447631836  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020076751708984375
range selection method range initialization spend 0.011959552764892578
time for parepare:  0.01689887046813965
local_output_nid generation:  0.005273580551147461
local_in_edges_tensor generation:  0.005731344223022461
mini_batch_src_global generation:  0.0077168941497802734
r_  generation:  0.09072494506835938
local_output_nid generation:  0.006151676177978516
local_in_edges_tensor generation:  0.0032384395599365234
mini_batch_src_global generation:  0.010183095932006836
r_  generation:  0.09936308860778809
local_output_nid generation:  0.0060803890228271484
local_in_edges_tensor generation:  0.0031862258911132812
mini_batch_src_global generation:  0.007634162902832031
r_  generation:  0.10000753402709961
local_output_nid generation:  0.006081581115722656
local_in_edges_tensor generation:  0.0031647682189941406
mini_batch_src_global generation:  0.008209466934204102
r_  generation:  0.10320425033569336
----------------------check_connections_block total spend ----------------------------- 0.5647170543670654
generate_one_block  0.11208343505859375
generate_one_block  0.11353731155395508
generate_one_block  0.11479401588439941
generate_one_block  0.11580896377563477
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03569841384887695
gen group dst list time:  0.011701583862304688
time for parepare:  0.01921820640563965
local_output_nid generation:  0.015664339065551758
local_in_edges_tensor generation:  0.03213858604431152
mini_batch_src_global generation:  0.04712629318237305
r_  generation:  0.4752185344696045
local_output_nid generation:  0.023174047470092773
local_in_edges_tensor generation:  0.02828526496887207
mini_batch_src_global generation:  0.055719614028930664
r_  generation:  0.4869387149810791
local_output_nid generation:  0.023263931274414062
local_in_edges_tensor generation:  0.027924299240112305
mini_batch_src_global generation:  0.05620002746582031
r_  generation:  0.4899437427520752
local_output_nid generation:  0.024009227752685547
local_in_edges_tensor generation:  0.029143571853637695
mini_batch_src_global generation:  0.05638551712036133
r_  generation:  0.4916560649871826
----------------------check_connections_block total spend ----------------------------- 2.7841978073120117
generate_one_block  0.6154983043670654
generate_one_block  0.6192402839660645
generate_one_block  0.6452815532684326
generate_one_block  0.624502420425415
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.027484655380249023
gen group dst list time:  0.022154808044433594
time for parepare:  0.01850414276123047
local_output_nid generation:  0.02474808692932129
local_in_edges_tensor generation:  0.036477088928222656
mini_batch_src_global generation:  0.0455782413482666
r_  generation:  0.49840283393859863
local_output_nid generation:  0.033675432205200195
local_in_edges_tensor generation:  0.043123722076416016
mini_batch_src_global generation:  0.05615639686584473
r_  generation:  0.5065121650695801
local_output_nid generation:  0.03461408615112305
local_in_edges_tensor generation:  0.044112443923950195
mini_batch_src_global generation:  0.0574643611907959
r_  generation:  0.5059497356414795
local_output_nid generation:  0.036012887954711914
local_in_edges_tensor generation:  0.03509163856506348
mini_batch_src_global generation:  0.05644655227661133
r_  generation:  0.5029253959655762
----------------------check_connections_block total spend ----------------------------- 2.976696491241455
generate_one_block  0.6334846019744873
generate_one_block  0.6307966709136963
generate_one_block  0.6311256885528564
generate_one_block  0.6213545799255371
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.1517324447631836  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

connection checking time:  5.760894298553467
block generation total time  5.021284103393555
average batch blocks generation time:  1.2553210258483887
block dataloader generation time/epoch 12.742726147174835
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11084890365600586  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1395163536071777  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11081123352050781  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1399359703063965  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11083412170410156  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1401820182800293  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11088275909423828  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1390094757080078  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09512519836425781 |0.018168151378631592 |0.0036217570304870605 |9.22083854675293e-05 |0.0037575364112854004 |0.0019507408142089844 |
----------------------------------------------------------pseudo_mini_loss sum 1.3737177848815918
Total (block generation + training)time/epoch 13.296840965747833
Training time/epoch 0.5754029750823975
Training time without block to device /epoch 0.5027303695678711
Training time without total dataloading part /epoch 0.031836748123168945
load block tensor time/epoch 0.38050079345703125
block to device time/epoch 0.07267260551452637
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 17 |
Number of nodes for computation during this epoch:  1720581
Number of first layer input nodes during this epoch:  661793
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15183544158935547  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02315354347229004
range selection method range initialization spend 0.012088298797607422
time for parepare:  0.016643762588500977
local_output_nid generation:  0.005496025085449219
local_in_edges_tensor generation:  0.0070536136627197266
mini_batch_src_global generation:  0.007611274719238281
r_  generation:  0.09002041816711426
local_output_nid generation:  0.006195783615112305
local_in_edges_tensor generation:  0.0031676292419433594
mini_batch_src_global generation:  0.01028132438659668
r_  generation:  0.09808039665222168
local_output_nid generation:  0.005991697311401367
local_in_edges_tensor generation:  0.003505229949951172
mini_batch_src_global generation:  0.008157014846801758
r_  generation:  0.10358095169067383
local_output_nid generation:  0.006080150604248047
local_in_edges_tensor generation:  0.0032196044921875
mini_batch_src_global generation:  0.008311033248901367
r_  generation:  0.10452938079833984
----------------------check_connections_block total spend ----------------------------- 0.5690507888793945
generate_one_block  0.11225199699401855
generate_one_block  0.11492347717285156
generate_one_block  0.12099742889404297
generate_one_block  0.116180419921875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03732013702392578
gen group dst list time:  0.011596918106079102
time for parepare:  0.019356727600097656
local_output_nid generation:  0.015590906143188477
local_in_edges_tensor generation:  0.03267097473144531
mini_batch_src_global generation:  0.048137664794921875
r_  generation:  0.4728703498840332
local_output_nid generation:  0.023855924606323242
local_in_edges_tensor generation:  0.02832341194152832
mini_batch_src_global generation:  0.05903959274291992
r_  generation:  0.4917466640472412
local_output_nid generation:  0.023720741271972656
local_in_edges_tensor generation:  0.02952265739440918
mini_batch_src_global generation:  0.056700706481933594
r_  generation:  0.49518704414367676
local_output_nid generation:  0.02378058433532715
local_in_edges_tensor generation:  0.02529120445251465
mini_batch_src_global generation:  0.057211875915527344
r_  generation:  0.4932677745819092
----------------------check_connections_block total spend ----------------------------- 2.802004337310791
generate_one_block  0.6201865673065186
generate_one_block  0.6232514381408691
generate_one_block  0.6434733867645264
generate_one_block  0.6206417083740234
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.025792598724365234
gen group dst list time:  0.02225947380065918
time for parepare:  0.018463134765625
local_output_nid generation:  0.02451157569885254
local_in_edges_tensor generation:  0.0377657413482666
mini_batch_src_global generation:  0.04587507247924805
r_  generation:  0.49193859100341797
local_output_nid generation:  0.03311944007873535
local_in_edges_tensor generation:  0.035141944885253906
mini_batch_src_global generation:  0.05639815330505371
r_  generation:  0.5033268928527832
local_output_nid generation:  0.03387308120727539
local_in_edges_tensor generation:  0.032063961029052734
mini_batch_src_global generation:  0.05777907371520996
r_  generation:  0.5004837512969971
local_output_nid generation:  0.034189462661743164
local_in_edges_tensor generation:  0.032289743423461914
mini_batch_src_global generation:  0.05542755126953125
r_  generation:  0.5104072093963623
----------------------check_connections_block total spend ----------------------------- 2.943316698074341
generate_one_block  0.6237845420837402
generate_one_block  0.6280050277709961
generate_one_block  0.6260316371917725
generate_one_block  0.6264100074768066
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15183544158935547  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

connection checking time:  5.745321035385132
block generation total time  5.011784315109253
average batch blocks generation time:  1.2529460787773132
block dataloader generation time/epoch 12.730707857343885
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11127328872680664  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1376953125  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11098480224609375  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1440186500549316  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11088037490844727  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.139556884765625  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11085844039916992  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.138845443725586  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09426027536392212 |0.01639646291732788 |0.00360029935836792 |9.363889694213867e-05 |0.0037353038787841797 |0.0019142627716064453 |
----------------------------------------------------------pseudo_mini_loss sum 1.3540587425231934
Total (block generation + training)time/epoch 13.285921653111776
Training time/epoch 0.5637798309326172
Training time without block to device /epoch 0.49819397926330566
Training time without total dataloading part /epoch 0.0316312313079834
load block tensor time/epoch 0.3770411014556885
block to device time/epoch 0.06558585166931152
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 18 |
Number of nodes for computation during this epoch:  1720754
Number of first layer input nodes during this epoch:  662032
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.1513204574584961  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019751310348510742
range selection method range initialization spend 0.011601686477661133
time for parepare:  0.017008304595947266
local_output_nid generation:  0.005266427993774414
local_in_edges_tensor generation:  0.005524396896362305
mini_batch_src_global generation:  0.007831573486328125
r_  generation:  0.09190607070922852
local_output_nid generation:  0.006026506423950195
local_in_edges_tensor generation:  0.0031647682189941406
mini_batch_src_global generation:  0.010115385055541992
r_  generation:  0.09757113456726074
local_output_nid generation:  0.006025552749633789
local_in_edges_tensor generation:  0.003283977508544922
mini_batch_src_global generation:  0.007851600646972656
r_  generation:  0.10124063491821289
local_output_nid generation:  0.0060694217681884766
local_in_edges_tensor generation:  0.0036225318908691406
mini_batch_src_global generation:  0.008318424224853516
r_  generation:  0.10412883758544922
----------------------check_connections_block total spend ----------------------------- 0.5649328231811523
generate_one_block  0.11198639869689941
generate_one_block  0.11790966987609863
generate_one_block  0.11730337142944336
generate_one_block  0.11567282676696777
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.036216020584106445
gen group dst list time:  0.01172494888305664
time for parepare:  0.020830631256103516
local_output_nid generation:  0.01570749282836914
local_in_edges_tensor generation:  0.03799843788146973
mini_batch_src_global generation:  0.04657554626464844
r_  generation:  0.4706428050994873
local_output_nid generation:  0.023797988891601562
local_in_edges_tensor generation:  0.02952861785888672
mini_batch_src_global generation:  0.05711007118225098
r_  generation:  0.48685288429260254
local_output_nid generation:  0.02340245246887207
local_in_edges_tensor generation:  0.02948617935180664
mini_batch_src_global generation:  0.05931544303894043
r_  generation:  0.4879629611968994
local_output_nid generation:  0.02385258674621582
local_in_edges_tensor generation:  0.027777671813964844
mini_batch_src_global generation:  0.0576939582824707
r_  generation:  0.4937458038330078
----------------------check_connections_block total spend ----------------------------- 2.7962331771850586
generate_one_block  0.6303186416625977
generate_one_block  0.6204321384429932
generate_one_block  0.6622438430786133
generate_one_block  0.6234762668609619
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02614140510559082
gen group dst list time:  0.022497177124023438
time for parepare:  0.020554304122924805
local_output_nid generation:  0.02503347396850586
local_in_edges_tensor generation:  0.04322457313537598
mini_batch_src_global generation:  0.04751920700073242
r_  generation:  0.4973454475402832
local_output_nid generation:  0.035162925720214844
local_in_edges_tensor generation:  0.03877902030944824
mini_batch_src_global generation:  0.056371450424194336
r_  generation:  0.5069410800933838
local_output_nid generation:  0.03480243682861328
local_in_edges_tensor generation:  0.03425312042236328
mini_batch_src_global generation:  0.05740666389465332
r_  generation:  0.5030887126922607
local_output_nid generation:  0.03496074676513672
local_in_edges_tensor generation:  0.037252187728881836
mini_batch_src_global generation:  0.05562448501586914
r_  generation:  0.5061807632446289
----------------------check_connections_block total spend ----------------------------- 2.9762449264526367
generate_one_block  0.6226909160614014
generate_one_block  0.6314849853515625
generate_one_block  0.6296370029449463
generate_one_block  0.6334273815155029
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.1513204574584961  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

connection checking time:  5.772478103637695
block generation total time  5.053711175918579
average batch blocks generation time:  1.2634277939796448
block dataloader generation time/epoch 12.724146246910095
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.1108393669128418  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1444907188415527  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11083078384399414  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1438875198364258  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11127328872680664  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.14044189453125  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11087369918823242  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1393561363220215  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09177523851394653 |0.0142555832862854 |0.003544032573699951 |8.875131607055664e-05 |0.0036199092864990234 |0.0025703907012939453 |
----------------------------------------------------------pseudo_mini_loss sum 1.3421299457550049
Total (block generation + training)time/epoch 13.278290367126464
Training time/epoch 0.5442521572113037
Training time without block to device /epoch 0.4872298240661621
Training time without total dataloading part /epoch 0.03158116340637207
load block tensor time/epoch 0.36710095405578613
block to device time/epoch 0.0570223331451416
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 19 |
Number of nodes for computation during this epoch:  1722277
Number of first layer input nodes during this epoch:  661978
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15133953094482422  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019897937774658203
range selection method range initialization spend 0.01541757583618164
time for parepare:  0.016710281372070312
local_output_nid generation:  0.005333662033081055
local_in_edges_tensor generation:  0.0059163570404052734
mini_batch_src_global generation:  0.011615514755249023
r_  generation:  0.09289884567260742
local_output_nid generation:  0.005982398986816406
local_in_edges_tensor generation:  0.0032248497009277344
mini_batch_src_global generation:  0.01200556755065918
r_  generation:  0.10196375846862793
local_output_nid generation:  0.006059169769287109
local_in_edges_tensor generation:  0.003360748291015625
mini_batch_src_global generation:  0.0077397823333740234
r_  generation:  0.1038978099822998
local_output_nid generation:  0.006112337112426758
local_in_edges_tensor generation:  0.003190755844116211
mini_batch_src_global generation:  0.008692502975463867
r_  generation:  0.10621070861816406
----------------------check_connections_block total spend ----------------------------- 0.5827541351318359
generate_one_block  0.11551666259765625
generate_one_block  0.11605954170227051
generate_one_block  0.1166985034942627
generate_one_block  0.11867761611938477
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03247880935668945
gen group dst list time:  0.011751174926757812
time for parepare:  0.019534587860107422
local_output_nid generation:  0.016466856002807617
local_in_edges_tensor generation:  0.029819488525390625
mini_batch_src_global generation:  0.046029090881347656
r_  generation:  0.47083091735839844
local_output_nid generation:  0.02439713478088379
local_in_edges_tensor generation:  0.03267073631286621
mini_batch_src_global generation:  0.057111263275146484
r_  generation:  0.4987168312072754
local_output_nid generation:  0.024323701858520508
local_in_edges_tensor generation:  0.03232431411743164
mini_batch_src_global generation:  0.05658459663391113
r_  generation:  0.49773645401000977
local_output_nid generation:  0.025291919708251953
local_in_edges_tensor generation:  0.03227114677429199
mini_batch_src_global generation:  0.05993342399597168
r_  generation:  0.5114946365356445
----------------------check_connections_block total spend ----------------------------- 2.864264965057373
generate_one_block  0.6475276947021484
generate_one_block  0.6441614627838135
generate_one_block  0.6589040756225586
generate_one_block  0.6243307590484619
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03166818618774414
gen group dst list time:  0.0225372314453125
time for parepare:  0.01928853988647461
local_output_nid generation:  0.025525808334350586
local_in_edges_tensor generation:  0.04836392402648926
mini_batch_src_global generation:  0.047963619232177734
r_  generation:  0.5122506618499756
local_output_nid generation:  0.03487753868103027
local_in_edges_tensor generation:  0.04156970977783203
mini_batch_src_global generation:  0.0561525821685791
r_  generation:  0.5161755084991455
local_output_nid generation:  0.03699231147766113
local_in_edges_tensor generation:  0.04172563552856445
mini_batch_src_global generation:  0.05872488021850586
r_  generation:  0.5179195404052734
local_output_nid generation:  0.03691840171813965
local_in_edges_tensor generation:  0.04902768135070801
mini_batch_src_global generation:  0.07120728492736816
r_  generation:  0.5314178466796875
----------------------check_connections_block total spend ----------------------------- 3.0957794189453125
generate_one_block  0.6335868835449219
generate_one_block  0.6437540054321289
generate_one_block  0.6344015598297119
generate_one_block  0.6277456283569336
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15133953094482422  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

connection checking time:  5.9600443840026855
block generation total time  5.114412069320679
average batch blocks generation time:  1.2786030173301697
block dataloader generation time/epoch 12.746044527400624
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11075687408447266  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.136000633239746  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11092853546142578  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.143716812133789  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11091756820678711  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1400556564331055  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11086320877075195  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1438570022583008  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09456974267959595 |0.019931435585021973 |0.0037174224853515625 |9.870529174804688e-05 |0.003790915012359619 |0.0019049644470214844 |
----------------------------------------------------------pseudo_mini_loss sum 1.3305847644805908
Total (block generation + training)time/epoch 13.302837133407593
Training time/epoch 0.5830850601196289
Training time without block to device /epoch 0.503359317779541
Training time without total dataloading part /epoch 0.0323331356048584
load block tensor time/epoch 0.3782789707183838
block to device time/epoch 0.07972574234008789
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 20 |
Number of nodes for computation during this epoch:  1720698
Number of first layer input nodes during this epoch:  661842
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15186166763305664  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027472972869873047
range selection method range initialization spend 0.011798620223999023
time for parepare:  0.0169832706451416
local_output_nid generation:  0.0053272247314453125
local_in_edges_tensor generation:  0.007719278335571289
mini_batch_src_global generation:  0.00791621208190918
r_  generation:  0.09235548973083496
local_output_nid generation:  0.005976200103759766
local_in_edges_tensor generation:  0.003232717514038086
mini_batch_src_global generation:  0.010377645492553711
r_  generation:  0.09846758842468262
local_output_nid generation:  0.006006956100463867
local_in_edges_tensor generation:  0.0031845569610595703
mini_batch_src_global generation:  0.007778167724609375
r_  generation:  0.10275125503540039
local_output_nid generation:  0.0060770511627197266
local_in_edges_tensor generation:  0.0031523704528808594
mini_batch_src_global generation:  0.008611917495727539
r_  generation:  0.10513782501220703
----------------------check_connections_block total spend ----------------------------- 0.5724291801452637
generate_one_block  0.11349701881408691
generate_one_block  0.11645817756652832
generate_one_block  0.11762690544128418
generate_one_block  0.11714005470275879
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03470945358276367
gen group dst list time:  0.01163339614868164
time for parepare:  0.019541501998901367
local_output_nid generation:  0.016172170639038086
local_in_edges_tensor generation:  0.03340458869934082
mini_batch_src_global generation:  0.04859018325805664
r_  generation:  0.4716770648956299
local_output_nid generation:  0.024483203887939453
local_in_edges_tensor generation:  0.03248739242553711
mini_batch_src_global generation:  0.05769467353820801
r_  generation:  0.4853353500366211
local_output_nid generation:  0.02418684959411621
local_in_edges_tensor generation:  0.02886033058166504
mini_batch_src_global generation:  0.05792713165283203
r_  generation:  0.49088239669799805
local_output_nid generation:  0.024683237075805664
local_in_edges_tensor generation:  0.031217336654663086
mini_batch_src_global generation:  0.05749368667602539
r_  generation:  0.49198460578918457
----------------------check_connections_block total spend ----------------------------- 2.804001808166504
generate_one_block  0.6222352981567383
generate_one_block  0.6274130344390869
generate_one_block  0.6547377109527588
generate_one_block  0.643834114074707
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03377890586853027
gen group dst list time:  0.022672653198242188
time for parepare:  0.020292997360229492
local_output_nid generation:  0.026026248931884766
local_in_edges_tensor generation:  0.03758406639099121
mini_batch_src_global generation:  0.048154354095458984
r_  generation:  0.4993741512298584
local_output_nid generation:  0.03461456298828125
local_in_edges_tensor generation:  0.03441214561462402
mini_batch_src_global generation:  0.05698871612548828
r_  generation:  0.5191948413848877
local_output_nid generation:  0.03518247604370117
local_in_edges_tensor generation:  0.03806591033935547
mini_batch_src_global generation:  0.06221318244934082
r_  generation:  0.5192952156066895
local_output_nid generation:  0.03656816482543945
local_in_edges_tensor generation:  0.03969264030456543
mini_batch_src_global generation:  0.06393694877624512
r_  generation:  0.5102839469909668
----------------------check_connections_block total spend ----------------------------- 3.0297484397888184
generate_one_block  0.6303586959838867
generate_one_block  0.6359095573425293
generate_one_block  0.6299011707305908
generate_one_block  0.6326131820678711
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15186166763305664  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

connection checking time:  5.833750247955322
block generation total time  5.077002763748169
average batch blocks generation time:  1.2692506909370422
block dataloader generation time/epoch 12.752107401688894
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11135482788085938  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1397771835327148  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11093473434448242  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1394286155700684  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11089754104614258  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.138923168182373  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11097860336303711  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1439247131347656  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09555262327194214 |0.01932460069656372 |0.0037124156951904297 |9.781122207641602e-05 |0.0038695335388183594 |0.0014979839324951172 |
----------------------------------------------------------pseudo_mini_loss sum 1.3102184534072876
Total (block generation + training)time/epoch 13.310756027698517
Training time/epoch 0.5788748264312744
Training time without block to device /epoch 0.5015764236450195
Training time without total dataloading part /epoch 0.03221702575683594
load block tensor time/epoch 0.38221049308776855
block to device time/epoch 0.07729840278625488
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 21 |
Number of nodes for computation during this epoch:  1721673
Number of first layer input nodes during this epoch:  662260
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15149211883544922  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.017254352569580078
range selection method range initialization spend 0.011790752410888672
time for parepare:  0.018825531005859375
local_output_nid generation:  0.005481243133544922
local_in_edges_tensor generation:  0.009140968322753906
mini_batch_src_global generation:  0.007911920547485352
r_  generation:  0.0926365852355957
local_output_nid generation:  0.006024599075317383
local_in_edges_tensor generation:  0.0032036304473876953
mini_batch_src_global generation:  0.009957313537597656
r_  generation:  0.10085725784301758
local_output_nid generation:  0.006017923355102539
local_in_edges_tensor generation:  0.003162860870361328
mini_batch_src_global generation:  0.007750988006591797
r_  generation:  0.10216879844665527
local_output_nid generation:  0.006070613861083984
local_in_edges_tensor generation:  0.0032601356506347656
mini_batch_src_global generation:  0.008286237716674805
r_  generation:  0.10702991485595703
----------------------check_connections_block total spend ----------------------------- 0.5781185626983643
generate_one_block  0.1139070987701416
generate_one_block  0.11685562133789062
generate_one_block  0.11574983596801758
generate_one_block  0.11715459823608398
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03237748146057129
gen group dst list time:  0.011829853057861328
time for parepare:  0.019629716873168945
local_output_nid generation:  0.016321897506713867
local_in_edges_tensor generation:  0.03406047821044922
mini_batch_src_global generation:  0.04623699188232422
r_  generation:  0.4797055721282959
local_output_nid generation:  0.024233341217041016
local_in_edges_tensor generation:  0.02851080894470215
mini_batch_src_global generation:  0.0588376522064209
r_  generation:  0.4942936897277832
local_output_nid generation:  0.024021625518798828
local_in_edges_tensor generation:  0.027924299240112305
mini_batch_src_global generation:  0.056371212005615234
r_  generation:  0.49384427070617676
local_output_nid generation:  0.02441692352294922
local_in_edges_tensor generation:  0.029047727584838867
mini_batch_src_global generation:  0.0587003231048584
r_  generation:  0.49544739723205566
----------------------check_connections_block total spend ----------------------------- 2.8182833194732666
generate_one_block  0.6306214332580566
generate_one_block  0.627852201461792
generate_one_block  0.6411526203155518
generate_one_block  0.6245336532592773
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.024802684783935547
gen group dst list time:  0.02246999740600586
time for parepare:  0.019307613372802734
local_output_nid generation:  0.02474355697631836
local_in_edges_tensor generation:  0.03442502021789551
mini_batch_src_global generation:  0.04529118537902832
r_  generation:  0.4965689182281494
local_output_nid generation:  0.03359270095825195
local_in_edges_tensor generation:  0.04224705696105957
mini_batch_src_global generation:  0.055699825286865234
r_  generation:  0.5093951225280762
local_output_nid generation:  0.034169912338256836
local_in_edges_tensor generation:  0.03289198875427246
mini_batch_src_global generation:  0.05771613121032715
r_  generation:  0.5055205821990967
local_output_nid generation:  0.03494524955749512
local_in_edges_tensor generation:  0.036362409591674805
mini_batch_src_global generation:  0.05541682243347168
r_  generation:  0.5080182552337646
----------------------check_connections_block total spend ----------------------------- 2.9656903743743896
generate_one_block  0.6291975975036621
generate_one_block  0.6457266807556152
generate_one_block  0.6285960674285889
generate_one_block  0.6335341930389404
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15149211883544922  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

connection checking time:  5.783973693847656
block generation total time  5.061214447021484
average batch blocks generation time:  1.265303611755371
block dataloader generation time/epoch 12.748614769715529
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11088752746582031  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1444892883300781  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11089611053466797  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1444511413574219  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11113786697387695  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1361150741577148  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11090803146362305  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1434850692749023  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08712911605834961 |0.016827046871185303 |0.0035148262977600098 |9.059906005859375e-05 |0.0032913684844970703 |0.0013551712036132812 |
----------------------------------------------------------pseudo_mini_loss sum 1.2928217649459839
Total (block generation + training)time/epoch 13.305449742537279
Training time/epoch 0.5349321365356445
Training time without block to device /epoch 0.4676239490509033
Training time without total dataloading part /epoch 0.028942346572875977
load block tensor time/epoch 0.34851646423339844
block to device time/epoch 0.06730818748474121
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 22 |
Number of nodes for computation during this epoch:  1721638
Number of first layer input nodes during this epoch:  661951
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15145397186279297  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023808717727661133
range selection method range initialization spend 0.011630773544311523
time for parepare:  0.01715850830078125
local_output_nid generation:  0.005318880081176758
local_in_edges_tensor generation:  0.005742788314819336
mini_batch_src_global generation:  0.008035659790039062
r_  generation:  0.0950169563293457
local_output_nid generation:  0.006148099899291992
local_in_edges_tensor generation:  0.0031757354736328125
mini_batch_src_global generation:  0.0102691650390625
r_  generation:  0.0984346866607666
local_output_nid generation:  0.006018161773681641
local_in_edges_tensor generation:  0.003246784210205078
mini_batch_src_global generation:  0.007703542709350586
r_  generation:  0.1056833267211914
local_output_nid generation:  0.006256580352783203
local_in_edges_tensor generation:  0.003301382064819336
mini_batch_src_global generation:  0.008501052856445312
r_  generation:  0.10457301139831543
----------------------check_connections_block total spend ----------------------------- 0.5755195617675781
generate_one_block  0.11515474319458008
generate_one_block  0.11540460586547852
generate_one_block  0.11626648902893066
generate_one_block  0.11611104011535645
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.039902687072753906
gen group dst list time:  0.011577606201171875
time for parepare:  0.019620895385742188
local_output_nid generation:  0.0160369873046875
local_in_edges_tensor generation:  0.034184932708740234
mini_batch_src_global generation:  0.05163073539733887
r_  generation:  0.4736945629119873
local_output_nid generation:  0.024022817611694336
local_in_edges_tensor generation:  0.03144502639770508
mini_batch_src_global generation:  0.05699491500854492
r_  generation:  0.501934289932251
local_output_nid generation:  0.02380084991455078
local_in_edges_tensor generation:  0.027570724487304688
mini_batch_src_global generation:  0.056643009185791016
r_  generation:  0.49881577491760254
local_output_nid generation:  0.026471853256225586
local_in_edges_tensor generation:  0.026749849319458008
mini_batch_src_global generation:  0.06247091293334961
r_  generation:  0.4959719181060791
----------------------check_connections_block total spend ----------------------------- 2.833599805831909
generate_one_block  0.6204874515533447
generate_one_block  0.6218650341033936
generate_one_block  0.6474974155426025
generate_one_block  0.6193265914916992
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.025818824768066406
gen group dst list time:  0.02251720428466797
time for parepare:  0.01860523223876953
local_output_nid generation:  0.025279521942138672
local_in_edges_tensor generation:  0.04384803771972656
mini_batch_src_global generation:  0.045655250549316406
r_  generation:  0.4977269172668457
local_output_nid generation:  0.034743547439575195
local_in_edges_tensor generation:  0.037780046463012695
mini_batch_src_global generation:  0.056508541107177734
r_  generation:  0.5051062107086182
local_output_nid generation:  0.03551769256591797
local_in_edges_tensor generation:  0.034317731857299805
mini_batch_src_global generation:  0.059513092041015625
r_  generation:  0.5066683292388916
local_output_nid generation:  0.035436153411865234
local_in_edges_tensor generation:  0.03428483009338379
mini_batch_src_global generation:  0.055433034896850586
r_  generation:  0.512263298034668
----------------------check_connections_block total spend ----------------------------- 2.9832651615142822
generate_one_block  0.6304614543914795
generate_one_block  0.6392087936401367
generate_one_block  0.6335408687591553
generate_one_block  0.6381595134735107
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15145397186279297  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

connection checking time:  5.816864967346191
block generation total time  5.050547122955322
average batch blocks generation time:  1.2626367807388306
block dataloader generation time/epoch 12.747923851013184
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.1110382080078125  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1441993713378906  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11082696914672852  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1383132934570312  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11083030700683594  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1387476921081543  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11079645156860352  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1404714584350586  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08830565214157104 |0.014564692974090576 |0.0036693811416625977 |9.936094284057617e-05 |0.003536820411682129 |0.0017583370208740234 |
----------------------------------------------------------pseudo_mini_loss sum 1.2796316146850586
Total (block generation + training)time/epoch 13.302870001111712
Training time/epoch 0.5301127433776855
Training time without block to device /epoch 0.47185397148132324
Training time without total dataloading part /epoch 0.030980587005615234
load block tensor time/epoch 0.3532226085662842
block to device time/epoch 0.058258771896362305
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 23 |
Number of nodes for computation during this epoch:  1720962
Number of first layer input nodes during this epoch:  661914
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15179204940795898  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020315170288085938
range selection method range initialization spend 0.011794090270996094
time for parepare:  0.016950607299804688
local_output_nid generation:  0.005396842956542969
local_in_edges_tensor generation:  0.005551338195800781
mini_batch_src_global generation:  0.007841110229492188
r_  generation:  0.09159564971923828
local_output_nid generation:  0.006093740463256836
local_in_edges_tensor generation:  0.003174304962158203
mini_batch_src_global generation:  0.009925603866577148
r_  generation:  0.10012650489807129
local_output_nid generation:  0.006095170974731445
local_in_edges_tensor generation:  0.0031523704528808594
mini_batch_src_global generation:  0.007926225662231445
r_  generation:  0.10176825523376465
local_output_nid generation:  0.006086587905883789
local_in_edges_tensor generation:  0.0032224655151367188
mini_batch_src_global generation:  0.00829172134399414
r_  generation:  0.10513806343078613
----------------------check_connections_block total spend ----------------------------- 0.5691182613372803
generate_one_block  0.11356663703918457
generate_one_block  0.1156775951385498
generate_one_block  0.11646366119384766
generate_one_block  0.11765217781066895
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03719925880432129
gen group dst list time:  0.011552572250366211
time for parepare:  0.019481182098388672
local_output_nid generation:  0.0163729190826416
local_in_edges_tensor generation:  0.028328418731689453
mini_batch_src_global generation:  0.048040151596069336
r_  generation:  0.47036218643188477
local_output_nid generation:  0.024402618408203125
local_in_edges_tensor generation:  0.029566049575805664
mini_batch_src_global generation:  0.058057546615600586
r_  generation:  0.4890933036804199
local_output_nid generation:  0.02379441261291504
local_in_edges_tensor generation:  0.03005242347717285
mini_batch_src_global generation:  0.05615377426147461
r_  generation:  0.48688220977783203
local_output_nid generation:  0.024276018142700195
local_in_edges_tensor generation:  0.026328325271606445
mini_batch_src_global generation:  0.056559085845947266
r_  generation:  0.49212145805358887
----------------------check_connections_block total spend ----------------------------- 2.7839581966400146
generate_one_block  0.623072624206543
generate_one_block  0.6219034194946289
generate_one_block  0.6477839946746826
generate_one_block  0.6268985271453857
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029491662979125977
gen group dst list time:  0.02258157730102539
time for parepare:  0.018646717071533203
local_output_nid generation:  0.025426626205444336
local_in_edges_tensor generation:  0.033805131912231445
mini_batch_src_global generation:  0.04541921615600586
r_  generation:  0.4967689514160156
local_output_nid generation:  0.03506875038146973
local_in_edges_tensor generation:  0.03573298454284668
mini_batch_src_global generation:  0.061547040939331055
r_  generation:  0.5100347995758057
local_output_nid generation:  0.03480029106140137
local_in_edges_tensor generation:  0.032865285873413086
mini_batch_src_global generation:  0.059262752532958984
r_  generation:  0.5047218799591064
local_output_nid generation:  0.03471016883850098
local_in_edges_tensor generation:  0.03258562088012695
mini_batch_src_global generation:  0.058568716049194336
r_  generation:  0.5153408050537109
----------------------check_connections_block total spend ----------------------------- 2.9752397537231445
generate_one_block  0.6260590553283691
generate_one_block  0.6269998550415039
generate_one_block  0.628035306930542
generate_one_block  0.6248757839202881
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15179204940795898  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

connection checking time:  5.759197950363159
block generation total time  5.025628566741943
average batch blocks generation time:  1.2564071416854858
block dataloader generation time/epoch 12.741097577412923
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11143636703491211  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1384897232055664  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11090898513793945  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.143836498260498  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11084461212158203  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1434712409973145  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11096000671386719  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.143808364868164  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08829659223556519 |0.016073286533355713 |0.0034584999084472656 |9.09566879272461e-05 |0.0032910704612731934 |0.0013806819915771484 |
----------------------------------------------------------pseudo_mini_loss sum 1.2703558206558228
Total (block generation + training)time/epoch 13.294731791814169
Training time/epoch 0.5350968837738037
Training time without block to device /epoch 0.47080373764038086
Training time without total dataloading part /epoch 0.02874279022216797
load block tensor time/epoch 0.35318636894226074
block to device time/epoch 0.06429314613342285
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 24 |
Number of nodes for computation during this epoch:  1721909
Number of first layer input nodes during this epoch:  661825
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15154314041137695  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.030064821243286133
range selection method range initialization spend 0.013180017471313477
time for parepare:  0.017724275588989258
local_output_nid generation:  0.0054814815521240234
local_in_edges_tensor generation:  0.008155107498168945
mini_batch_src_global generation:  0.008051872253417969
r_  generation:  0.09186220169067383
local_output_nid generation:  0.005979776382446289
local_in_edges_tensor generation:  0.003176450729370117
mini_batch_src_global generation:  0.015431404113769531
r_  generation:  0.10126137733459473
local_output_nid generation:  0.0060350894927978516
local_in_edges_tensor generation:  0.003336668014526367
mini_batch_src_global generation:  0.007950067520141602
r_  generation:  0.10269594192504883
local_output_nid generation:  0.006044149398803711
local_in_edges_tensor generation:  0.0033495426177978516
mini_batch_src_global generation:  0.008420228958129883
r_  generation:  0.10551834106445312
----------------------check_connections_block total spend ----------------------------- 0.5823867321014404
generate_one_block  0.1152193546295166
generate_one_block  0.1146538257598877
generate_one_block  0.11846303939819336
generate_one_block  0.11582732200622559
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04275035858154297
gen group dst list time:  0.011637210845947266
time for parepare:  0.019832134246826172
local_output_nid generation:  0.016177892684936523
local_in_edges_tensor generation:  0.03493309020996094
mini_batch_src_global generation:  0.05929446220397949
r_  generation:  0.47359299659729004
local_output_nid generation:  0.024631500244140625
local_in_edges_tensor generation:  0.030594587326049805
mini_batch_src_global generation:  0.05669260025024414
r_  generation:  0.48331332206726074
local_output_nid generation:  0.024326324462890625
local_in_edges_tensor generation:  0.025720834732055664
mini_batch_src_global generation:  0.06528472900390625
r_  generation:  0.4915320873260498
local_output_nid generation:  0.024337291717529297
local_in_edges_tensor generation:  0.026204824447631836
mini_batch_src_global generation:  0.05733942985534668
r_  generation:  0.49228739738464355
----------------------check_connections_block total spend ----------------------------- 2.8133466243743896
generate_one_block  0.6332082748413086
generate_one_block  0.619596004486084
generate_one_block  0.6523637771606445
generate_one_block  0.6280674934387207
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.027368545532226562
gen group dst list time:  0.022505760192871094
time for parepare:  0.01887345314025879
local_output_nid generation:  0.025582551956176758
local_in_edges_tensor generation:  0.03481245040893555
mini_batch_src_global generation:  0.045433759689331055
r_  generation:  0.4998934268951416
local_output_nid generation:  0.03480076789855957
local_in_edges_tensor generation:  0.04153180122375488
mini_batch_src_global generation:  0.05695462226867676
r_  generation:  0.5139296054840088
local_output_nid generation:  0.03568696975708008
local_in_edges_tensor generation:  0.03703618049621582
mini_batch_src_global generation:  0.05745291709899902
r_  generation:  0.5111536979675293
local_output_nid generation:  0.03594207763671875
local_in_edges_tensor generation:  0.03281235694885254
mini_batch_src_global generation:  0.05660414695739746
r_  generation:  0.5099403858184814
----------------------check_connections_block total spend ----------------------------- 2.9931724071502686
generate_one_block  0.6262927055358887
generate_one_block  0.6342511177062988
generate_one_block  0.6431550979614258
generate_one_block  0.6278853416442871
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15154314041137695  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

connection checking time:  5.806519031524658
block generation total time  5.064819812774658
average batch blocks generation time:  1.2662049531936646
block dataloader generation time/epoch 12.742721483111382
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11087608337402344  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1442437171936035  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11084604263305664  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1380510330200195  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11154651641845703  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1445212364196777  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11084413528442383  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1385703086853027  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09183907508850098 |0.014480531215667725 |0.0037313103675842285 |0.00010478496551513672 |0.0037978291511535645 |0.0016548633575439453 |
----------------------------------------------------------pseudo_mini_loss sum 1.2539446353912354
Total (block generation + training)time/epoch 13.296020939946175
Training time/epoch 0.548039436340332
Training time without block to device /epoch 0.49011731147766113
Training time without total dataloading part /epoch 0.032190561294555664
load block tensor time/epoch 0.3673563003540039
block to device time/epoch 0.0579221248626709
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 25 |
Number of nodes for computation during this epoch:  1721480
Number of first layer input nodes during this epoch:  662243
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15125751495361328  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022273540496826172
range selection method range initialization spend 0.011709928512573242
time for parepare:  0.016849756240844727
local_output_nid generation:  0.005644083023071289
local_in_edges_tensor generation:  0.006422758102416992
mini_batch_src_global generation:  0.007909536361694336
r_  generation:  0.09360265731811523
local_output_nid generation:  0.006090402603149414
local_in_edges_tensor generation:  0.003198385238647461
mini_batch_src_global generation:  0.010007619857788086
r_  generation:  0.09914207458496094
local_output_nid generation:  0.006185054779052734
local_in_edges_tensor generation:  0.0033202171325683594
mini_batch_src_global generation:  0.007811546325683594
r_  generation:  0.10360050201416016
local_output_nid generation:  0.006198406219482422
local_in_edges_tensor generation:  0.0032303333282470703
mini_batch_src_global generation:  0.008359670639038086
r_  generation:  0.10533356666564941
----------------------check_connections_block total spend ----------------------------- 0.5736672878265381
generate_one_block  0.1167595386505127
generate_one_block  0.11536312103271484
generate_one_block  0.11618518829345703
generate_one_block  0.11569738388061523
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03458285331726074
gen group dst list time:  0.011601924896240234
time for parepare:  0.01974630355834961
local_output_nid generation:  0.015711545944213867
local_in_edges_tensor generation:  0.028642892837524414
mini_batch_src_global generation:  0.04622364044189453
r_  generation:  0.4814157485961914
local_output_nid generation:  0.024182558059692383
local_in_edges_tensor generation:  0.030989646911621094
mini_batch_src_global generation:  0.056899309158325195
r_  generation:  0.48330235481262207
local_output_nid generation:  0.02426886558532715
local_in_edges_tensor generation:  0.02563190460205078
mini_batch_src_global generation:  0.057408809661865234
r_  generation:  0.4953453540802002
local_output_nid generation:  0.024011611938476562
local_in_edges_tensor generation:  0.026744842529296875
mini_batch_src_global generation:  0.05905342102050781
r_  generation:  0.488694429397583
----------------------check_connections_block total spend ----------------------------- 2.794739007949829
generate_one_block  0.6169202327728271
generate_one_block  0.6180479526519775
generate_one_block  0.6545894145965576
generate_one_block  0.6195647716522217
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.027960538864135742
gen group dst list time:  0.022253990173339844
time for parepare:  0.018616199493408203
local_output_nid generation:  0.0249481201171875
local_in_edges_tensor generation:  0.03427529335021973
mini_batch_src_global generation:  0.04560518264770508
r_  generation:  0.5026299953460693
local_output_nid generation:  0.03388810157775879
local_in_edges_tensor generation:  0.03290987014770508
mini_batch_src_global generation:  0.05704784393310547
r_  generation:  0.5075910091400146
local_output_nid generation:  0.03499150276184082
local_in_edges_tensor generation:  0.032562255859375
mini_batch_src_global generation:  0.058001041412353516
r_  generation:  0.5087294578552246
local_output_nid generation:  0.03539776802062988
local_in_edges_tensor generation:  0.0327000617980957
mini_batch_src_global generation:  0.056509971618652344
r_  generation:  0.5163164138793945
----------------------check_connections_block total spend ----------------------------- 2.9764060974121094
generate_one_block  0.6300201416015625
generate_one_block  0.6343326568603516
generate_one_block  0.6338222026824951
generate_one_block  0.632455587387085
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15125751495361328  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

connection checking time:  5.7711451053619385
block generation total time  5.039752960205078
average batch blocks generation time:  1.2599382400512695
block dataloader generation time/epoch 12.739260266808902
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11083364486694336  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1388559341430664  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11081600189208984  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1383795738220215  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.1109466552734375  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1458101272583008  GigaBytes
Max Memory Allocated: 1.3505473136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.1108241081237793  GigaBytes
Max Memory Allocated: 1.3508548736572266  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.140416145324707  GigaBytes
Max Memory Allocated: 1.3508548736572266  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07432681322097778 |0.014249920845031738 |0.003476440906524658 |8.976459503173828e-05 |0.016726374626159668 |0.0027039051055908203 |
----------------------------------------------------------pseudo_mini_loss sum 1.242055892944336
Total (block generation + training)time/epoch 13.290847904541913
Training time/epoch 0.5240249633789062
Training time without block to device /epoch 0.4670252799987793
Training time without total dataloading part /epoch 0.08387422561645508
load block tensor time/epoch 0.29730725288391113
block to device time/epoch 0.05699968338012695
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 26 |
Number of nodes for computation during this epoch:  1721064
Number of first layer input nodes during this epoch:  661933
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15157222747802734  GigaBytes
Max Memory Allocated: 1.3508548736572266  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018999576568603516
range selection method range initialization spend 0.011635541915893555
time for parepare:  0.016962051391601562
local_output_nid generation:  0.00562596321105957
local_in_edges_tensor generation:  0.008058547973632812
mini_batch_src_global generation:  0.007833480834960938
r_  generation:  0.09167265892028809
local_output_nid generation:  0.006056070327758789
local_in_edges_tensor generation:  0.0032160282135009766
mini_batch_src_global generation:  0.010245323181152344
r_  generation:  0.09980630874633789
local_output_nid generation:  0.00610804557800293
local_in_edges_tensor generation:  0.0032279491424560547
mini_batch_src_global generation:  0.007540702819824219
r_  generation:  0.10169219970703125
local_output_nid generation:  0.006124258041381836
local_in_edges_tensor generation:  0.0032651424407958984
mini_batch_src_global generation:  0.008438587188720703
r_  generation:  0.10636472702026367
----------------------check_connections_block total spend ----------------------------- 0.5746474266052246
generate_one_block  0.11383414268493652
generate_one_block  0.11642241477966309
generate_one_block  0.1165616512298584
generate_one_block  0.11741757392883301
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029410123825073242
gen group dst list time:  0.011587381362915039
time for parepare:  0.019654512405395508
local_output_nid generation:  0.01589202880859375
local_in_edges_tensor generation:  0.027288198471069336
mini_batch_src_global generation:  0.04583477973937988
r_  generation:  0.46964550018310547
local_output_nid generation:  0.023812532424926758
local_in_edges_tensor generation:  0.024178266525268555
mini_batch_src_global generation:  0.05599856376647949
r_  generation:  0.48506808280944824
local_output_nid generation:  0.02324819564819336
local_in_edges_tensor generation:  0.0257415771484375
mini_batch_src_global generation:  0.05663466453552246
r_  generation:  0.4860553741455078
local_output_nid generation:  0.023931026458740234
local_in_edges_tensor generation:  0.025150060653686523
mini_batch_src_global generation:  0.05688619613647461
r_  generation:  0.4952883720397949
----------------------check_connections_block total spend ----------------------------- 2.764277219772339
generate_one_block  0.6184906959533691
generate_one_block  0.6307721138000488
generate_one_block  0.6406354904174805
generate_one_block  0.6217527389526367
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.022822856903076172
gen group dst list time:  0.0226132869720459
time for parepare:  0.018815994262695312
local_output_nid generation:  0.025348901748657227
local_in_edges_tensor generation:  0.03433585166931152
mini_batch_src_global generation:  0.04607200622558594
r_  generation:  0.4991300106048584
local_output_nid generation:  0.034055471420288086
local_in_edges_tensor generation:  0.03164935111999512
mini_batch_src_global generation:  0.05649232864379883
r_  generation:  0.511080265045166
local_output_nid generation:  0.03519320487976074
local_in_edges_tensor generation:  0.03255963325500488
mini_batch_src_global generation:  0.05843377113342285
r_  generation:  0.506263017654419
local_output_nid generation:  0.0353388786315918
local_in_edges_tensor generation:  0.03276205062866211
mini_batch_src_global generation:  0.05635952949523926
r_  generation:  0.5099465847015381
----------------------check_connections_block total spend ----------------------------- 2.9687585830688477
generate_one_block  0.6297869682312012
generate_one_block  0.6267461776733398
generate_one_block  0.6340830326080322
generate_one_block  0.6400682926177979
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15157222747802734  GigaBytes
Max Memory Allocated: 1.3508548736572266  GigaBytes

connection checking time:  5.7330358028411865
block generation total time  5.042335510253906
average batch blocks generation time:  1.2605838775634766
block dataloader generation time/epoch 12.731196178330315
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11114692687988281  GigaBytes
Max Memory Allocated: 1.3508548736572266  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1389307975769043  GigaBytes
Max Memory Allocated: 1.3508548736572266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11090946197509766  GigaBytes
Max Memory Allocated: 1.3508548736572266  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.143570899963379  GigaBytes
Max Memory Allocated: 1.3508548736572266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.1108255386352539  GigaBytes
Max Memory Allocated: 1.3508548736572266  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1384038925170898  GigaBytes
Max Memory Allocated: 1.3508548736572266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.1108846664428711  GigaBytes
Max Memory Allocated: 1.3508548736572266  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.143570899963379  GigaBytes
Max Memory Allocated: 1.3508548736572266  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09431147575378418 |0.01589137315750122 |0.003579437732696533 |8.934736251831055e-05 |0.003702998161315918 |0.0012671947479248047 |
----------------------------------------------------------pseudo_mini_loss sum 1.2317991256713867
Total (block generation + training)time/epoch 13.283351553810967
Training time/epoch 0.5616366863250732
Training time without block to device /epoch 0.49807119369506836
Training time without total dataloading part /epoch 0.03075432777404785
load block tensor time/epoch 0.3772459030151367
block to device time/epoch 0.06356549263000488
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 27 |
Number of nodes for computation during this epoch:  1721021
Number of first layer input nodes during this epoch:  661744
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15143537521362305  GigaBytes
Max Memory Allocated: 1.3508548736572266  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02099752426147461
range selection method range initialization spend 0.012200117111206055
time for parepare:  0.016791820526123047
local_output_nid generation:  0.005529165267944336
local_in_edges_tensor generation:  0.006319522857666016
mini_batch_src_global generation:  0.007926464080810547
r_  generation:  0.09151387214660645
local_output_nid generation:  0.005958080291748047
local_in_edges_tensor generation:  0.0032639503479003906
mini_batch_src_global generation:  0.010460615158081055
r_  generation:  0.1003580093383789
local_output_nid generation:  0.0060901641845703125
local_in_edges_tensor generation:  0.00324249267578125
mini_batch_src_global generation:  0.0079193115234375
r_  generation:  0.10330367088317871
local_output_nid generation:  0.006098747253417969
local_in_edges_tensor generation:  0.0032532215118408203
mini_batch_src_global generation:  0.00820469856262207
r_  generation:  0.1059272289276123
----------------------check_connections_block total spend ----------------------------- 0.5734977722167969
generate_one_block  0.11213421821594238
generate_one_block  0.11688375473022461
generate_one_block  0.11635875701904297
generate_one_block  0.11585569381713867
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03795599937438965
gen group dst list time:  0.011436939239501953
time for parepare:  0.019542217254638672
local_output_nid generation:  0.01626420021057129
local_in_edges_tensor generation:  0.03095722198486328
mini_batch_src_global generation:  0.04697060585021973
r_  generation:  0.4693872928619385
local_output_nid generation:  0.02452874183654785
local_in_edges_tensor generation:  0.02631855010986328
mini_batch_src_global generation:  0.057188987731933594
r_  generation:  0.48957228660583496
local_output_nid generation:  0.024293899536132812
local_in_edges_tensor generation:  0.03230762481689453
mini_batch_src_global generation:  0.057453155517578125
r_  generation:  0.4931952953338623
local_output_nid generation:  0.02476811408996582
local_in_edges_tensor generation:  0.027550220489501953
mini_batch_src_global generation:  0.057677507400512695
r_  generation:  0.502765417098999
----------------------check_connections_block total spend ----------------------------- 2.8164937496185303
generate_one_block  0.640120267868042
generate_one_block  0.6291177272796631
generate_one_block  0.6523909568786621
generate_one_block  0.6212198734283447
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030456066131591797
gen group dst list time:  0.02239084243774414
time for parepare:  0.018369674682617188
local_output_nid generation:  0.02534174919128418
local_in_edges_tensor generation:  0.037993669509887695
mini_batch_src_global generation:  0.0459902286529541
r_  generation:  0.5006606578826904
local_output_nid generation:  0.03483700752258301
local_in_edges_tensor generation:  0.03338027000427246
mini_batch_src_global generation:  0.05700492858886719
r_  generation:  0.509432315826416
local_output_nid generation:  0.03496074676513672
local_in_edges_tensor generation:  0.0326237678527832
mini_batch_src_global generation:  0.05883955955505371
r_  generation:  0.5076553821563721
local_output_nid generation:  0.035074472427368164
local_in_edges_tensor generation:  0.03465080261230469
mini_batch_src_global generation:  0.05862903594970703
r_  generation:  0.5220153331756592
----------------------check_connections_block total spend ----------------------------- 2.9898595809936523
generate_one_block  0.6290969848632812
generate_one_block  0.6313252449035645
generate_one_block  0.6309239864349365
generate_one_block  0.6323955059051514
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15143537521362305  GigaBytes
Max Memory Allocated: 1.3508548736572266  GigaBytes

connection checking time:  5.806353330612183
block generation total time  5.0665905475616455
average batch blocks generation time:  1.2666476368904114
block dataloader generation time/epoch 12.731391668319702
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11081504821777344  GigaBytes
Max Memory Allocated: 1.3508548736572266  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1383404731750488  GigaBytes
Max Memory Allocated: 1.3508548736572266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11090993881225586  GigaBytes
Max Memory Allocated: 1.3508548736572266  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1442646980285645  GigaBytes
Max Memory Allocated: 1.3508548736572266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11150121688842773  GigaBytes
Max Memory Allocated: 1.3508548736572266  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1401548385620117  GigaBytes
Max Memory Allocated: 1.3508548736572266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11089706420898438  GigaBytes
Max Memory Allocated: 1.3508548736572266  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1435675621032715  GigaBytes
Max Memory Allocated: 1.3508548736572266  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09083342552185059 |0.01487886905670166 |0.003638923168182373 |9.620189666748047e-05 |0.003576219081878662 |0.0017833709716796875 |
----------------------------------------------------------pseudo_mini_loss sum 1.2169644832611084
Total (block generation + training)time/epoch 13.28312927798221
Training time/epoch 0.5439391136169434
Training time without block to device /epoch 0.4844236373901367
Training time without total dataloading part /epoch 0.03102874755859375
load block tensor time/epoch 0.36333370208740234
block to device time/epoch 0.05951547622680664
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 28 |
Number of nodes for computation during this epoch:  1721678
Number of first layer input nodes during this epoch:  662003
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15136194229125977  GigaBytes
Max Memory Allocated: 1.3508548736572266  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02196049690246582
range selection method range initialization spend 0.01179361343383789
time for parepare:  0.01687479019165039
local_output_nid generation:  0.005644798278808594
local_in_edges_tensor generation:  0.0065000057220458984
mini_batch_src_global generation:  0.008190155029296875
r_  generation:  0.09117913246154785
local_output_nid generation:  0.0060808658599853516
local_in_edges_tensor generation:  0.0032701492309570312
mini_batch_src_global generation:  0.010405302047729492
r_  generation:  0.09819221496582031
local_output_nid generation:  0.006009578704833984
local_in_edges_tensor generation:  0.003348827362060547
mini_batch_src_global generation:  0.00791621208190918
r_  generation:  0.10197234153747559
local_output_nid generation:  0.006159782409667969
local_in_edges_tensor generation:  0.0032052993774414062
mini_batch_src_global generation:  0.008594989776611328
r_  generation:  0.1068575382232666
----------------------check_connections_block total spend ----------------------------- 0.5715382099151611
generate_one_block  0.1178426742553711
generate_one_block  0.11510515213012695
generate_one_block  0.11808276176452637
generate_one_block  0.1191873550415039
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03710484504699707
gen group dst list time:  0.011572122573852539
time for parepare:  0.019780635833740234
local_output_nid generation:  0.01645493507385254
local_in_edges_tensor generation:  0.03070521354675293
mini_batch_src_global generation:  0.047178030014038086
r_  generation:  0.47870492935180664
local_output_nid generation:  0.024041175842285156
local_in_edges_tensor generation:  0.026999235153198242
mini_batch_src_global generation:  0.058509111404418945
r_  generation:  0.4882235527038574
local_output_nid generation:  0.023905515670776367
local_in_edges_tensor generation:  0.025856494903564453
mini_batch_src_global generation:  0.05720639228820801
r_  generation:  0.49870872497558594
local_output_nid generation:  0.023933887481689453
local_in_edges_tensor generation:  0.029715776443481445
mini_batch_src_global generation:  0.057096242904663086
r_  generation:  0.492995023727417
----------------------check_connections_block total spend ----------------------------- 2.80556058883667
generate_one_block  0.6291646957397461
generate_one_block  0.614572286605835
generate_one_block  0.6452577114105225
generate_one_block  0.6286294460296631
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.026221752166748047
gen group dst list time:  0.022499799728393555
time for parepare:  0.0186307430267334
local_output_nid generation:  0.02593231201171875
local_in_edges_tensor generation:  0.035582780838012695
mini_batch_src_global generation:  0.0464169979095459
r_  generation:  0.5029253959655762
local_output_nid generation:  0.034502267837524414
local_in_edges_tensor generation:  0.03302597999572754
mini_batch_src_global generation:  0.05693650245666504
r_  generation:  0.5113153457641602
local_output_nid generation:  0.0353085994720459
local_in_edges_tensor generation:  0.03351187705993652
mini_batch_src_global generation:  0.05826258659362793
r_  generation:  0.511120080947876
local_output_nid generation:  0.03550577163696289
local_in_edges_tensor generation:  0.034065961837768555
mini_batch_src_global generation:  0.05633282661437988
r_  generation:  0.5165436267852783
----------------------check_connections_block total spend ----------------------------- 2.9871139526367188
generate_one_block  0.6300497055053711
generate_one_block  0.6256930828094482
generate_one_block  0.6344103813171387
generate_one_block  0.6441903114318848
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15136194229125977  GigaBytes
Max Memory Allocated: 1.3508548736572266  GigaBytes

connection checking time:  5.792674541473389
block generation total time  5.051967620849609
average batch blocks generation time:  1.2629919052124023
block dataloader generation time/epoch 12.730714190006257
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11090612411499023  GigaBytes
Max Memory Allocated: 1.3508548736572266  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.14393949508667  GigaBytes
Max Memory Allocated: 1.3508548736572266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.1107931137084961  GigaBytes
Max Memory Allocated: 1.3508548736572266  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1370344161987305  GigaBytes
Max Memory Allocated: 1.3508548736572266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11090850830078125  GigaBytes
Max Memory Allocated: 1.3508548736572266  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.140202522277832  GigaBytes
Max Memory Allocated: 1.3508548736572266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.1109628677368164  GigaBytes
Max Memory Allocated: 1.3508548736572266  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1435527801513672  GigaBytes
Max Memory Allocated: 1.3508548736572266  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08738285303115845 |0.014419198036193848 |0.003464937210083008 |9.310245513916016e-05 |0.003430664539337158 |0.0014805793762207031 |
----------------------------------------------------------pseudo_mini_loss sum 1.206795334815979
Total (block generation + training)time/epoch 13.281189072132111
Training time/epoch 0.5262725353240967
Training time without block to device /epoch 0.4685957431793213
Training time without total dataloading part /epoch 0.029435396194458008
load block tensor time/epoch 0.3495314121246338
block to device time/epoch 0.05767679214477539
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 29 |
Number of nodes for computation during this epoch:  1721673
Number of first layer input nodes during this epoch:  662081
