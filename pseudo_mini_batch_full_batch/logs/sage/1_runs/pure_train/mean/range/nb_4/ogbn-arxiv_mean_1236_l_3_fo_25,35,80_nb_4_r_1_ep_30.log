Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1647770848.4174864
ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027350664138793945
range selection method range initialization spend 0.013115882873535156
time for parepare:  0.018128395080566406
local_output_nid generation:  0.005300045013427734
local_in_edges_tensor generation:  0.006388664245605469
mini_batch_src_global generation:  0.007310152053833008
r_  generation:  0.09020590782165527
local_output_nid generation:  0.0060117244720458984
local_in_edges_tensor generation:  0.0031251907348632812
mini_batch_src_global generation:  0.009816169738769531
r_  generation:  0.09717226028442383
local_output_nid generation:  0.0060155391693115234
local_in_edges_tensor generation:  0.0032122135162353516
mini_batch_src_global generation:  0.007454872131347656
r_  generation:  0.10118484497070312
local_output_nid generation:  0.006026744842529297
local_in_edges_tensor generation:  0.003137350082397461
mini_batch_src_global generation:  0.00824117660522461
r_  generation:  0.10358810424804688
----------------------check_connections_block total spend ----------------------------- 0.559689998626709
generate_one_block  0.11526799201965332
generate_one_block  0.11662530899047852
generate_one_block  0.11759519577026367
generate_one_block  0.11864519119262695
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04040932655334473
gen group dst list time:  0.01214289665222168
time for parepare:  0.018912315368652344
local_output_nid generation:  0.014789342880249023
local_in_edges_tensor generation:  0.035109758377075195
mini_batch_src_global generation:  0.03904104232788086
r_  generation:  0.42072319984436035
local_output_nid generation:  0.02593684196472168
local_in_edges_tensor generation:  0.041387319564819336
mini_batch_src_global generation:  0.05193638801574707
r_  generation:  0.4462008476257324
local_output_nid generation:  0.023556232452392578
local_in_edges_tensor generation:  0.0339202880859375
mini_batch_src_global generation:  0.05023813247680664
r_  generation:  0.4683408737182617
local_output_nid generation:  0.02859187126159668
local_in_edges_tensor generation:  0.04429030418395996
mini_batch_src_global generation:  0.05821585655212402
r_  generation:  0.4418630599975586
----------------------check_connections_block total spend ----------------------------- 2.640702724456787
generate_one_block  0.6070072650909424
generate_one_block  0.5710339546203613
generate_one_block  0.5761294364929199
generate_one_block  0.576221227645874
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05196237564086914
gen group dst list time:  0.02138209342956543
time for parepare:  0.019190311431884766
local_output_nid generation:  0.023454666137695312
local_in_edges_tensor generation:  0.06026911735534668
mini_batch_src_global generation:  0.04582858085632324
r_  generation:  0.503403902053833
local_output_nid generation:  0.03466320037841797
local_in_edges_tensor generation:  0.05850338935852051
mini_batch_src_global generation:  0.055520057678222656
r_  generation:  0.5213649272918701
local_output_nid generation:  0.03692483901977539
local_in_edges_tensor generation:  0.05026721954345703
mini_batch_src_global generation:  0.0651559829711914
r_  generation:  0.507530689239502
local_output_nid generation:  0.035340309143066406
local_in_edges_tensor generation:  0.04132843017578125
mini_batch_src_global generation:  0.05249428749084473
r_  generation:  0.5147593021392822
----------------------check_connections_block total spend ----------------------------- 3.0728864669799805
generate_one_block  0.6841721534729004
generate_one_block  0.6559441089630127
generate_one_block  0.6432456970214844
generate_one_block  0.6684565544128418
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  5.713589191436768
block generation total time  4.982210397720337
average batch blocks generation time:  1.2455525994300842
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2030029296875 GB
    Memory Allocated: 0.10298347473144531  GigaBytes
Max Memory Allocated: 0.10298347473144531  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6776123046875 GB
    Memory Allocated: 1.126162052154541  GigaBytes
Max Memory Allocated: 1.2196907997131348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.10808753967285156  GigaBytes
Max Memory Allocated: 1.3295307159423828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6990966796875 GB
    Memory Allocated: 1.1325984001159668  GigaBytes
Max Memory Allocated: 1.3295307159423828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8514404296875 GB
    Memory Allocated: 0.10749483108520508  GigaBytes
Max Memory Allocated: 1.3378915786743164  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8514404296875 GB
    Memory Allocated: 1.1274218559265137  GigaBytes
Max Memory Allocated: 1.3378915786743164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8514404296875 GB
    Memory Allocated: 0.10762262344360352  GigaBytes
Max Memory Allocated: 1.3378915786743164  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8514404296875 GB
    Memory Allocated: 1.127519130706787  GigaBytes
Max Memory Allocated: 1.3378915786743164  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06713902950286865 |0.10778570175170898 |0.20033103227615356 |0.0001290440559387207 |0.022040128707885742 |0.002192974090576172 |
----------------------------------------------------------pseudo_mini_loss sum 6.172946929931641
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1710477
Number of first layer input nodes during this epoch:  658257
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8533935546875 GB
    Memory Allocated: 0.1473240852355957  GigaBytes
Max Memory Allocated: 1.3378915786743164  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023732423782348633
range selection method range initialization spend 0.012461185455322266
time for parepare:  0.016852617263793945
local_output_nid generation:  0.005203962326049805
local_in_edges_tensor generation:  0.0063669681549072266
mini_batch_src_global generation:  0.011741161346435547
r_  generation:  0.08908581733703613
local_output_nid generation:  0.006097316741943359
local_in_edges_tensor generation:  0.005162239074707031
mini_batch_src_global generation:  0.009842872619628906
r_  generation:  0.09706711769104004
local_output_nid generation:  0.006087541580200195
local_in_edges_tensor generation:  0.003181934356689453
mini_batch_src_global generation:  0.007521867752075195
r_  generation:  0.10090327262878418
local_output_nid generation:  0.005933523178100586
local_in_edges_tensor generation:  0.003233671188354492
mini_batch_src_global generation:  0.008196353912353516
r_  generation:  0.10464000701904297
----------------------check_connections_block total spend ----------------------------- 0.567915678024292
generate_one_block  0.12074398994445801
generate_one_block  0.11436080932617188
generate_one_block  0.11637210845947266
generate_one_block  0.11851310729980469
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0399174690246582
gen group dst list time:  0.012057304382324219
time for parepare:  0.01877284049987793
local_output_nid generation:  0.017741680145263672
local_in_edges_tensor generation:  0.03460192680358887
mini_batch_src_global generation:  0.04331493377685547
r_  generation:  0.4414522647857666
local_output_nid generation:  0.02839040756225586
local_in_edges_tensor generation:  0.04382944107055664
mini_batch_src_global generation:  0.0580599308013916
r_  generation:  0.4397585391998291
local_output_nid generation:  0.024273157119750977
local_in_edges_tensor generation:  0.034604549407958984
mini_batch_src_global generation:  0.05175662040710449
r_  generation:  0.4380612373352051
local_output_nid generation:  0.024224519729614258
local_in_edges_tensor generation:  0.028179168701171875
mini_batch_src_global generation:  0.05359220504760742
r_  generation:  0.4635474681854248
----------------------check_connections_block total spend ----------------------------- 2.637006998062134
generate_one_block  0.5808093547821045
generate_one_block  0.5651612281799316
generate_one_block  0.6103148460388184
generate_one_block  0.5657908916473389
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04184579849243164
gen group dst list time:  0.021751880645751953
time for parepare:  0.018700361251831055
local_output_nid generation:  0.02390122413635254
local_in_edges_tensor generation:  0.0547332763671875
mini_batch_src_global generation:  0.05440688133239746
r_  generation:  0.5129034519195557
local_output_nid generation:  0.03672599792480469
local_in_edges_tensor generation:  0.057711124420166016
mini_batch_src_global generation:  0.05735039710998535
r_  generation:  0.493255615234375
local_output_nid generation:  0.03443622589111328
local_in_edges_tensor generation:  0.04196000099182129
mini_batch_src_global generation:  0.05768871307373047
r_  generation:  0.5005683898925781
local_output_nid generation:  0.03460216522216797
local_in_edges_tensor generation:  0.039530038833618164
mini_batch_src_global generation:  0.05131244659423828
r_  generation:  0.5211482048034668
----------------------check_connections_block total spend ----------------------------- 3.0283608436584473
generate_one_block  0.6528384685516357
generate_one_block  0.6284174919128418
generate_one_block  0.6221611499786377
generate_one_block  0.6365740299224854
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8533935546875 GB
    Memory Allocated: 0.1473240852355957  GigaBytes
Max Memory Allocated: 1.3378915786743164  GigaBytes

connection checking time:  5.665367841720581
block generation total time  4.862067461013794
average batch blocks generation time:  1.2155168652534485
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8533935546875 GB
    Memory Allocated: 0.10972166061401367  GigaBytes
Max Memory Allocated: 1.3378915786743164  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8533935546875 GB
    Memory Allocated: 1.134171485900879  GigaBytes
Max Memory Allocated: 1.3378915786743164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10920381546020508  GigaBytes
Max Memory Allocated: 1.3392291069030762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.128319263458252  GigaBytes
Max Memory Allocated: 1.3392291069030762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10924625396728516  GigaBytes
Max Memory Allocated: 1.3392291069030762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1345009803771973  GigaBytes
Max Memory Allocated: 1.3392291069030762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.1092996597290039  GigaBytes
Max Memory Allocated: 1.3394012451171875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1340570449829102  GigaBytes
Max Memory Allocated: 1.3394012451171875  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08081471920013428 |0.019036531448364258 |0.0036655664443969727 |9.912252426147461e-05 |0.017393529415130615 |0.0017447471618652344 |
----------------------------------------------------------pseudo_mini_loss sum 3.230605125427246
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  1711355
Number of first layer input nodes during this epoch:  658299
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.14716100692749023  GigaBytes
Max Memory Allocated: 1.3394012451171875  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03570914268493652
range selection method range initialization spend 0.011818647384643555
time for parepare:  0.01859426498413086
local_output_nid generation:  0.0051991939544677734
local_in_edges_tensor generation:  0.007582664489746094
mini_batch_src_global generation:  0.007639646530151367
r_  generation:  0.08896660804748535
local_output_nid generation:  0.005947589874267578
local_in_edges_tensor generation:  0.003484487533569336
mini_batch_src_global generation:  0.009873628616333008
r_  generation:  0.09622907638549805
local_output_nid generation:  0.005929231643676758
local_in_edges_tensor generation:  0.0031812191009521484
mini_batch_src_global generation:  0.00783085823059082
r_  generation:  0.10062026977539062
local_output_nid generation:  0.006024360656738281
local_in_edges_tensor generation:  0.003238201141357422
mini_batch_src_global generation:  0.008192300796508789
r_  generation:  0.10217452049255371
----------------------check_connections_block total spend ----------------------------- 0.561509370803833
generate_one_block  0.11243200302124023
generate_one_block  0.11330819129943848
generate_one_block  0.11585044860839844
generate_one_block  0.11700630187988281
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0665593147277832
gen group dst list time:  0.012167215347290039
time for parepare:  0.018996000289916992
local_output_nid generation:  0.0159299373626709
local_in_edges_tensor generation:  0.03598308563232422
mini_batch_src_global generation:  0.04315686225891113
r_  generation:  0.424027681350708
local_output_nid generation:  0.022793054580688477
local_in_edges_tensor generation:  0.03187203407287598
mini_batch_src_global generation:  0.04919242858886719
r_  generation:  0.42671918869018555
local_output_nid generation:  0.023602008819580078
local_in_edges_tensor generation:  0.02725815773010254
mini_batch_src_global generation:  0.049465179443359375
r_  generation:  0.4380526542663574
local_output_nid generation:  0.023392915725708008
local_in_edges_tensor generation:  0.0321650505065918
mini_batch_src_global generation:  0.05013775825500488
r_  generation:  0.42981958389282227
----------------------check_connections_block total spend ----------------------------- 2.51015567779541
generate_one_block  0.5481748580932617
generate_one_block  0.5535728931427002
generate_one_block  0.5767052173614502
generate_one_block  0.5418224334716797
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0287625789642334
gen group dst list time:  0.02228999137878418
time for parepare:  0.018497228622436523
local_output_nid generation:  0.0247957706451416
local_in_edges_tensor generation:  0.03364682197570801
mini_batch_src_global generation:  0.044008493423461914
r_  generation:  0.49135804176330566
local_output_nid generation:  0.03355765342712402
local_in_edges_tensor generation:  0.03680062294006348
mini_batch_src_global generation:  0.05554676055908203
r_  generation:  0.49680447578430176
local_output_nid generation:  0.03422379493713379
local_in_edges_tensor generation:  0.047859907150268555
mini_batch_src_global generation:  0.0537109375
r_  generation:  0.5009207725524902
local_output_nid generation:  0.0341341495513916
local_in_edges_tensor generation:  0.03192329406738281
mini_batch_src_global generation:  0.051241159439086914
r_  generation:  0.5096614360809326
----------------------check_connections_block total spend ----------------------------- 2.923332929611206
generate_one_block  0.616450309753418
generate_one_block  0.6298584938049316
generate_one_block  0.6366579532623291
generate_one_block  0.6224751472473145
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.14716100692749023  GigaBytes
Max Memory Allocated: 1.3394012451171875  GigaBytes

connection checking time:  5.433488607406616
block generation total time  4.725717306137085
average batch blocks generation time:  1.1814293265342712
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.1092691421508789  GigaBytes
Max Memory Allocated: 1.3394012451171875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1333484649658203  GigaBytes
Max Memory Allocated: 1.3394012451171875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10913610458374023  GigaBytes
Max Memory Allocated: 1.3394012451171875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.129277229309082  GigaBytes
Max Memory Allocated: 1.3394012451171875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.1093287467956543  GigaBytes
Max Memory Allocated: 1.3394012451171875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1360716819763184  GigaBytes
Max Memory Allocated: 1.3394012451171875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10890436172485352  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1261000633239746  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08058571815490723 |0.013595342636108398 |0.008994102478027344 |9.387731552124023e-05 |0.012348532676696777 |0.0016217231750488281 |
----------------------------------------------------------pseudo_mini_loss sum 2.6088788509368896
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  1711138
Number of first layer input nodes during this epoch:  658294
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.14738225936889648  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018685579299926758
range selection method range initialization spend 0.012407541275024414
time for parepare:  0.017389774322509766
local_output_nid generation:  0.005250453948974609
local_in_edges_tensor generation:  0.005670785903930664
mini_batch_src_global generation:  0.00776362419128418
r_  generation:  0.09107017517089844
local_output_nid generation:  0.00854349136352539
local_in_edges_tensor generation:  0.003133058547973633
mini_batch_src_global generation:  0.00958871841430664
r_  generation:  0.09630894660949707
local_output_nid generation:  0.0069332122802734375
local_in_edges_tensor generation:  0.0031647682189941406
mini_batch_src_global generation:  0.007781982421875
r_  generation:  0.10079693794250488
local_output_nid generation:  0.006864786148071289
local_in_edges_tensor generation:  0.003203868865966797
mini_batch_src_global generation:  0.008225202560424805
r_  generation:  0.10259199142456055
----------------------check_connections_block total spend ----------------------------- 0.5635166168212891
generate_one_block  0.11168026924133301
generate_one_block  0.1125497817993164
generate_one_block  0.11571478843688965
generate_one_block  0.11636829376220703
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.037824392318725586
gen group dst list time:  0.012365579605102539
time for parepare:  0.01912689208984375
local_output_nid generation:  0.015511751174926758
local_in_edges_tensor generation:  0.030136585235595703
mini_batch_src_global generation:  0.03949880599975586
r_  generation:  0.4197545051574707
local_output_nid generation:  0.02317500114440918
local_in_edges_tensor generation:  0.024278879165649414
mini_batch_src_global generation:  0.049649953842163086
r_  generation:  0.43625569343566895
local_output_nid generation:  0.023473501205444336
local_in_edges_tensor generation:  0.025242328643798828
mini_batch_src_global generation:  0.05060291290283203
r_  generation:  0.4463682174682617
local_output_nid generation:  0.023820877075195312
local_in_edges_tensor generation:  0.027965068817138672
mini_batch_src_global generation:  0.05031633377075195
r_  generation:  0.4445171356201172
----------------------check_connections_block total spend ----------------------------- 2.522193670272827
generate_one_block  0.5613172054290771
generate_one_block  0.5527644157409668
generate_one_block  0.5871758460998535
generate_one_block  0.5541412830352783
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03973245620727539
gen group dst list time:  0.022954702377319336
time for parepare:  0.018682479858398438
local_output_nid generation:  0.02435302734375
local_in_edges_tensor generation:  0.03696608543395996
mini_batch_src_global generation:  0.04446697235107422
r_  generation:  0.495084285736084
local_output_nid generation:  0.03365468978881836
local_in_edges_tensor generation:  0.04246377944946289
mini_batch_src_global generation:  0.055150508880615234
r_  generation:  0.49839353561401367
local_output_nid generation:  0.03380870819091797
local_in_edges_tensor generation:  0.042500972747802734
mini_batch_src_global generation:  0.056025028228759766
r_  generation:  0.501101016998291
local_output_nid generation:  0.03769803047180176
local_in_edges_tensor generation:  0.044538021087646484
mini_batch_src_global generation:  0.05180931091308594
r_  generation:  0.5122642517089844
----------------------check_connections_block total spend ----------------------------- 2.9553470611572266
generate_one_block  0.6136398315429688
generate_one_block  0.6321823596954346
generate_one_block  0.6233580112457275
generate_one_block  0.6303222179412842
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.14738225936889648  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

connection checking time:  5.477540731430054
block generation total time  4.754901170730591
average batch blocks generation time:  1.1887252926826477
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10933256149291992  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1296982765197754  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10959863662719727  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1289949417114258  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.11035013198852539  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1357221603393555  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10901737213134766  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1289644241333008  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08961659669876099 |0.01887577772140503 |0.003680586814880371 |9.870529174804688e-05 |0.0034124255180358887 |0.0024597644805908203 |
----------------------------------------------------------pseudo_mini_loss sum 2.3887569904327393
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  1710450
Number of first layer input nodes during this epoch:  658187
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.1466689109802246  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01816082000732422
range selection method range initialization spend 0.01181483268737793
time for parepare:  0.017052650451660156
local_output_nid generation:  0.0053234100341796875
local_in_edges_tensor generation:  0.006218910217285156
mini_batch_src_global generation:  0.007600307464599609
r_  generation:  0.08841633796691895
local_output_nid generation:  0.005991458892822266
local_in_edges_tensor generation:  0.0032715797424316406
mini_batch_src_global generation:  0.00993037223815918
r_  generation:  0.0973975658416748
local_output_nid generation:  0.006055355072021484
local_in_edges_tensor generation:  0.0035932064056396484
mini_batch_src_global generation:  0.007620096206665039
r_  generation:  0.10180854797363281
local_output_nid generation:  0.0060214996337890625
local_in_edges_tensor generation:  0.0034363269805908203
mini_batch_src_global generation:  0.008156776428222656
r_  generation:  0.10501503944396973
----------------------check_connections_block total spend ----------------------------- 0.5634033679962158
generate_one_block  0.1149892807006836
generate_one_block  0.11892008781433105
generate_one_block  0.11917614936828613
generate_one_block  0.12119555473327637
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03119659423828125
gen group dst list time:  0.012284040451049805
time for parepare:  0.019344329833984375
local_output_nid generation:  0.01568007469177246
local_in_edges_tensor generation:  0.037719011306762695
mini_batch_src_global generation:  0.04238271713256836
r_  generation:  0.427654504776001
local_output_nid generation:  0.02360987663269043
local_in_edges_tensor generation:  0.027686357498168945
mini_batch_src_global generation:  0.0513463020324707
r_  generation:  0.43180131912231445
local_output_nid generation:  0.023880958557128906
local_in_edges_tensor generation:  0.02641582489013672
mini_batch_src_global generation:  0.04888463020324707
r_  generation:  0.4389488697052002
local_output_nid generation:  0.024042844772338867
local_in_edges_tensor generation:  0.024398088455200195
mini_batch_src_global generation:  0.05230712890625
r_  generation:  0.44235730171203613
----------------------check_connections_block total spend ----------------------------- 2.526125907897949
generate_one_block  0.5536792278289795
generate_one_block  0.5581307411193848
generate_one_block  0.5933389663696289
generate_one_block  0.5648105144500732
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03204512596130371
gen group dst list time:  0.023955821990966797
time for parepare:  0.021241426467895508
local_output_nid generation:  0.025101900100708008
local_in_edges_tensor generation:  0.06141495704650879
mini_batch_src_global generation:  0.04743623733520508
r_  generation:  0.5172743797302246
local_output_nid generation:  0.03668951988220215
local_in_edges_tensor generation:  0.04376626014709473
mini_batch_src_global generation:  0.05547332763671875
r_  generation:  0.5027170181274414
local_output_nid generation:  0.0355224609375
local_in_edges_tensor generation:  0.043060302734375
mini_batch_src_global generation:  0.054906368255615234
r_  generation:  0.5065581798553467
local_output_nid generation:  0.03534650802612305
local_in_edges_tensor generation:  0.03443288803100586
mini_batch_src_global generation:  0.05089879035949707
r_  generation:  0.5193452835083008
----------------------check_connections_block total spend ----------------------------- 3.0322229862213135
generate_one_block  0.6353645324707031
generate_one_block  0.6382503509521484
generate_one_block  0.6353168487548828
generate_one_block  0.6325430870056152
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.1466689109802246  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

connection checking time:  5.558348894119263
block generation total time  4.811434268951416
average batch blocks generation time:  1.202858567237854
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10898351669311523  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1293025016784668  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10917997360229492  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.129748821258545  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10975456237792969  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1350646018981934  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.1090860366821289  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1294636726379395  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09199565649032593 |0.026722371578216553 |0.0037824511528015137 |0.00010341405868530273 |0.0037020444869995117 |0.0029273033142089844 |
----------------------------------------------------------pseudo_mini_loss sum 2.110913038253784
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  1710388
Number of first layer input nodes during this epoch:  658104
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.14681386947631836  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0361781120300293
range selection method range initialization spend 0.01250910758972168
time for parepare:  0.01777815818786621
local_output_nid generation:  0.005274772644042969
local_in_edges_tensor generation:  0.009067296981811523
mini_batch_src_global generation:  0.007579326629638672
r_  generation:  0.09154868125915527
local_output_nid generation:  0.006027936935424805
local_in_edges_tensor generation:  0.003181934356689453
mini_batch_src_global generation:  0.009940147399902344
r_  generation:  0.10243916511535645
local_output_nid generation:  0.006051540374755859
local_in_edges_tensor generation:  0.003231048583984375
mini_batch_src_global generation:  0.0076541900634765625
r_  generation:  0.10321688652038574
local_output_nid generation:  0.006020545959472656
local_in_edges_tensor generation:  0.003149747848510742
mini_batch_src_global generation:  0.008235931396484375
r_  generation:  0.10587787628173828
----------------------check_connections_block total spend ----------------------------- 0.5754175186157227
generate_one_block  0.122711181640625
generate_one_block  0.11891460418701172
generate_one_block  0.11683464050292969
generate_one_block  0.11743402481079102
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.042253732681274414
gen group dst list time:  0.012042760848999023
time for parepare:  0.020750045776367188
local_output_nid generation:  0.01584792137145996
local_in_edges_tensor generation:  0.04040241241455078
mini_batch_src_global generation:  0.04169869422912598
r_  generation:  0.43192028999328613
local_output_nid generation:  0.026822328567504883
local_in_edges_tensor generation:  0.03357124328613281
mini_batch_src_global generation:  0.050482988357543945
r_  generation:  0.47612738609313965
local_output_nid generation:  0.0267179012298584
local_in_edges_tensor generation:  0.04124784469604492
mini_batch_src_global generation:  0.057860374450683594
r_  generation:  0.4393010139465332
local_output_nid generation:  0.024990081787109375
local_in_edges_tensor generation:  0.032514333724975586
mini_batch_src_global generation:  0.050498008728027344
r_  generation:  0.4583921432495117
----------------------check_connections_block total spend ----------------------------- 2.652369737625122
generate_one_block  0.57379150390625
generate_one_block  0.5753638744354248
generate_one_block  0.6000232696533203
generate_one_block  0.5469276905059814
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.034284114837646484
gen group dst list time:  0.022167444229125977
time for parepare:  0.020236492156982422
local_output_nid generation:  0.025403738021850586
local_in_edges_tensor generation:  0.045870065689086914
mini_batch_src_global generation:  0.0480961799621582
r_  generation:  0.49335145950317383
local_output_nid generation:  0.03393816947937012
local_in_edges_tensor generation:  0.04326581954956055
mini_batch_src_global generation:  0.05890321731567383
r_  generation:  0.5054821968078613
local_output_nid generation:  0.0341644287109375
local_in_edges_tensor generation:  0.03212237358093262
mini_batch_src_global generation:  0.05484437942504883
r_  generation:  0.50539231300354
local_output_nid generation:  0.03499603271484375
local_in_edges_tensor generation:  0.03452897071838379
mini_batch_src_global generation:  0.05095314979553223
r_  generation:  0.5255115032196045
----------------------check_connections_block total spend ----------------------------- 2.9727370738983154
generate_one_block  0.6319944858551025
generate_one_block  0.6402804851531982
generate_one_block  0.620417594909668
generate_one_block  0.630669116973877
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.14681386947631836  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

connection checking time:  5.6251068115234375
block generation total time  4.819468021392822
average batch blocks generation time:  1.2048670053482056
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10923576354980469  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1305232048034668  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10947036743164062  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1348991394042969  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10903024673461914  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1281919479370117  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10914468765258789  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.128039836883545  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09592205286026001 |0.02114570140838623 |0.003677070140838623 |9.876489639282227e-05 |0.0038498640060424805 |0.003346681594848633 |
----------------------------------------------------------pseudo_mini_loss sum 1.960412621498108
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  1710535
Number of first layer input nodes during this epoch:  658325
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.1466817855834961  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02557992935180664
range selection method range initialization spend 0.011883020401000977
time for parepare:  0.019465208053588867
local_output_nid generation:  0.005326986312866211
local_in_edges_tensor generation:  0.007722139358520508
mini_batch_src_global generation:  0.0076410770416259766
r_  generation:  0.08943724632263184
local_output_nid generation:  0.0060613155364990234
local_in_edges_tensor generation:  0.003221273422241211
mini_batch_src_global generation:  0.009841203689575195
r_  generation:  0.0974583625793457
local_output_nid generation:  0.006047248840332031
local_in_edges_tensor generation:  0.003262758255004883
mini_batch_src_global generation:  0.007695674896240234
r_  generation:  0.10028958320617676
local_output_nid generation:  0.006103992462158203
local_in_edges_tensor generation:  0.0031952857971191406
mini_batch_src_global generation:  0.008383750915527344
r_  generation:  0.1041405200958252
----------------------check_connections_block total spend ----------------------------- 0.564647912979126
generate_one_block  0.11370325088500977
generate_one_block  0.11488151550292969
generate_one_block  0.11586451530456543
generate_one_block  0.11750984191894531
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.035614967346191406
gen group dst list time:  0.011803388595581055
time for parepare:  0.0194091796875
local_output_nid generation:  0.0157163143157959
local_in_edges_tensor generation:  0.03285717964172363
mini_batch_src_global generation:  0.041457176208496094
r_  generation:  0.42542386054992676
local_output_nid generation:  0.024532079696655273
local_in_edges_tensor generation:  0.03234076499938965
mini_batch_src_global generation:  0.051956892013549805
r_  generation:  0.44252610206604004
local_output_nid generation:  0.024212360382080078
local_in_edges_tensor generation:  0.025961637496948242
mini_batch_src_global generation:  0.05008745193481445
r_  generation:  0.44782590866088867
local_output_nid generation:  0.02471327781677246
local_in_edges_tensor generation:  0.02638530731201172
mini_batch_src_global generation:  0.05297517776489258
r_  generation:  0.45142173767089844
----------------------check_connections_block total spend ----------------------------- 2.568061590194702
generate_one_block  0.562758207321167
generate_one_block  0.5543317794799805
generate_one_block  0.5867798328399658
generate_one_block  0.5611007213592529
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03361058235168457
gen group dst list time:  0.022871732711791992
time for parepare:  0.02089524269104004
local_output_nid generation:  0.02530050277709961
local_in_edges_tensor generation:  0.044240713119506836
mini_batch_src_global generation:  0.04542350769042969
r_  generation:  0.5209922790527344
local_output_nid generation:  0.03761935234069824
local_in_edges_tensor generation:  0.03899192810058594
mini_batch_src_global generation:  0.0556330680847168
r_  generation:  0.5027322769165039
local_output_nid generation:  0.03592109680175781
local_in_edges_tensor generation:  0.03509044647216797
mini_batch_src_global generation:  0.05427384376525879
r_  generation:  0.5089535713195801
local_output_nid generation:  0.03575015068054199
local_in_edges_tensor generation:  0.035187721252441406
mini_batch_src_global generation:  0.051846981048583984
r_  generation:  0.521099328994751
----------------------check_connections_block total spend ----------------------------- 3.007864475250244
generate_one_block  0.6244082450866699
generate_one_block  0.6348726749420166
generate_one_block  0.6473360061645508
generate_one_block  0.6301555633544922
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.1466817855834961  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

connection checking time:  5.575926065444946
block generation total time  4.801743030548096
average batch blocks generation time:  1.200435757637024
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10927867889404297  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.134749412536621  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10910224914550781  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.129563808441162  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10913801193237305  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1287951469421387  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10927343368530273  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1341156959533691  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09273755550384521 |0.019554734230041504 |0.0037044286727905273 |9.72747802734375e-05 |0.003838062286376953 |0.0013995170593261719 |
----------------------------------------------------------pseudo_mini_loss sum 1.8780362606048584
 Run 0| Epoch 6 |
Number of nodes for computation during this epoch:  1711113
Number of first layer input nodes during this epoch:  658159
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.14754104614257812  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021246910095214844
range selection method range initialization spend 0.011797189712524414
time for parepare:  0.01721954345703125
local_output_nid generation:  0.005331516265869141
local_in_edges_tensor generation:  0.00816035270690918
mini_batch_src_global generation:  0.00755620002746582
r_  generation:  0.09362220764160156
local_output_nid generation:  0.00610661506652832
local_in_edges_tensor generation:  0.0035386085510253906
mini_batch_src_global generation:  0.009824991226196289
r_  generation:  0.10042738914489746
local_output_nid generation:  0.006155729293823242
local_in_edges_tensor generation:  0.0038595199584960938
mini_batch_src_global generation:  0.00811004638671875
r_  generation:  0.10382223129272461
local_output_nid generation:  0.006186008453369141
local_in_edges_tensor generation:  0.0032160282135009766
mini_batch_src_global generation:  0.008409738540649414
r_  generation:  0.10631179809570312
----------------------check_connections_block total spend ----------------------------- 0.5775246620178223
generate_one_block  0.11220240592956543
generate_one_block  0.11687970161437988
generate_one_block  0.12134480476379395
generate_one_block  0.1185154914855957
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03664684295654297
gen group dst list time:  0.012191295623779297
time for parepare:  0.019472599029541016
local_output_nid generation:  0.015666961669921875
local_in_edges_tensor generation:  0.03390383720397949
mini_batch_src_global generation:  0.03958439826965332
r_  generation:  0.4357948303222656
local_output_nid generation:  0.025792837142944336
local_in_edges_tensor generation:  0.030982494354248047
mini_batch_src_global generation:  0.049570560455322266
r_  generation:  0.43251490592956543
local_output_nid generation:  0.024385690689086914
local_in_edges_tensor generation:  0.029064655303955078
mini_batch_src_global generation:  0.050176143646240234
r_  generation:  0.44977521896362305
local_output_nid generation:  0.024948835372924805
local_in_edges_tensor generation:  0.024791479110717773
mini_batch_src_global generation:  0.05137753486633301
r_  generation:  0.44266605377197266
----------------------check_connections_block total spend ----------------------------- 2.5493481159210205
generate_one_block  0.5482492446899414
generate_one_block  0.5517721176147461
generate_one_block  0.589404821395874
generate_one_block  0.5546526908874512
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03523683547973633
gen group dst list time:  0.022284507751464844
time for parepare:  0.01901102066040039
local_output_nid generation:  0.024672508239746094
local_in_edges_tensor generation:  0.040426015853881836
mini_batch_src_global generation:  0.04785656929016113
r_  generation:  0.4965662956237793
local_output_nid generation:  0.03375363349914551
local_in_edges_tensor generation:  0.04095864295959473
mini_batch_src_global generation:  0.05589938163757324
r_  generation:  0.5027542114257812
local_output_nid generation:  0.03441429138183594
local_in_edges_tensor generation:  0.036150217056274414
mini_batch_src_global generation:  0.05472445487976074
r_  generation:  0.5113174915313721
local_output_nid generation:  0.03461480140686035
local_in_edges_tensor generation:  0.03712344169616699
mini_batch_src_global generation:  0.0540771484375
r_  generation:  0.520132303237915
----------------------check_connections_block total spend ----------------------------- 2.972234010696411
generate_one_block  0.6294267177581787
generate_one_block  0.622485876083374
generate_one_block  0.6296706199645996
generate_one_block  0.6279468536376953
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.14754104614257812  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

connection checking time:  5.521582126617432
block generation total time  4.75360894203186
average batch blocks generation time:  1.188402235507965
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10913276672363281  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1272563934326172  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.1092081069946289  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1299757957458496  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10946130752563477  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1335506439208984  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10924911499023438  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1339688301086426  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08904492855072021 |0.013628542423248291 |0.003659844398498535 |9.66787338256836e-05 |0.0034938454627990723 |0.0015931129455566406 |
----------------------------------------------------------pseudo_mini_loss sum 1.7997636795043945
 Run 0| Epoch 7 |
Number of nodes for computation during this epoch:  1711107
Number of first layer input nodes during this epoch:  658520
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.14693498611450195  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023645639419555664
range selection method range initialization spend 0.012446880340576172
time for parepare:  0.016936302185058594
local_output_nid generation:  0.005300283432006836
local_in_edges_tensor generation:  0.005507707595825195
mini_batch_src_global generation:  0.007532835006713867
r_  generation:  0.09194064140319824
local_output_nid generation:  0.006100893020629883
local_in_edges_tensor generation:  0.0032050609588623047
mini_batch_src_global generation:  0.009990453720092773
r_  generation:  0.0987095832824707
local_output_nid generation:  0.00617218017578125
local_in_edges_tensor generation:  0.0033190250396728516
mini_batch_src_global generation:  0.007613420486450195
r_  generation:  0.10220050811767578
local_output_nid generation:  0.006127357482910156
local_in_edges_tensor generation:  0.003261089324951172
mini_batch_src_global generation:  0.008348703384399414
r_  generation:  0.10476803779602051
----------------------check_connections_block total spend ----------------------------- 0.5670077800750732
generate_one_block  0.11102962493896484
generate_one_block  0.117095947265625
generate_one_block  0.1149289608001709
generate_one_block  0.11655116081237793
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.027472496032714844
gen group dst list time:  0.01214456558227539
time for parepare:  0.019065141677856445
local_output_nid generation:  0.015496015548706055
local_in_edges_tensor generation:  0.025786638259887695
mini_batch_src_global generation:  0.03892803192138672
r_  generation:  0.41846513748168945
local_output_nid generation:  0.023436784744262695
local_in_edges_tensor generation:  0.027013063430786133
mini_batch_src_global generation:  0.04941296577453613
r_  generation:  0.4371635913848877
local_output_nid generation:  0.023461341857910156
local_in_edges_tensor generation:  0.02528858184814453
mini_batch_src_global generation:  0.052377939224243164
r_  generation:  0.4376230239868164
local_output_nid generation:  0.025112152099609375
local_in_edges_tensor generation:  0.024712562561035156
mini_batch_src_global generation:  0.05021309852600098
r_  generation:  0.4476964473724365
----------------------check_connections_block total spend ----------------------------- 2.512258529663086
generate_one_block  0.5578598976135254
generate_one_block  0.5563292503356934
generate_one_block  0.5777111053466797
generate_one_block  0.5611932277679443
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04227328300476074
gen group dst list time:  0.022149085998535156
time for parepare:  0.01920795440673828
local_output_nid generation:  0.024066686630249023
local_in_edges_tensor generation:  0.04020094871520996
mini_batch_src_global generation:  0.04737544059753418
r_  generation:  0.49645495414733887
local_output_nid generation:  0.03338289260864258
local_in_edges_tensor generation:  0.03727364540100098
mini_batch_src_global generation:  0.054955482482910156
r_  generation:  0.5040159225463867
local_output_nid generation:  0.03403973579406738
local_in_edges_tensor generation:  0.038407325744628906
mini_batch_src_global generation:  0.05528998374938965
r_  generation:  0.51468825340271
local_output_nid generation:  0.03426814079284668
local_in_edges_tensor generation:  0.03695535659790039
mini_batch_src_global generation:  0.05538368225097656
r_  generation:  0.5273792743682861
----------------------check_connections_block total spend ----------------------------- 2.9848687648773193
generate_one_block  0.632007360458374
generate_one_block  0.6253814697265625
generate_one_block  0.6273801326751709
generate_one_block  0.6267800331115723
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.14693498611450195  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

connection checking time:  5.497127294540405
block generation total time  4.7646424770355225
average batch blocks generation time:  1.1911606192588806
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10895061492919922  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1263446807861328  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10943460464477539  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1336679458618164  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.1091771125793457  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.129523754119873  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10935544967651367  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1343793869018555  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08853501081466675 |0.018438518047332764 |0.0034770965576171875 |9.369850158691406e-05 |0.0033951997756958008 |0.0012738704681396484 |
----------------------------------------------------------pseudo_mini_loss sum 1.7027826309204102
 Run 0| Epoch 8 |
Number of nodes for computation during this epoch:  1710377
Number of first layer input nodes during this epoch:  658353
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.14768457412719727  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.017295360565185547
range selection method range initialization spend 0.011665821075439453
time for parepare:  0.01796245574951172
local_output_nid generation:  0.005274295806884766
local_in_edges_tensor generation:  0.0065460205078125
mini_batch_src_global generation:  0.007658481597900391
r_  generation:  0.09374046325683594
local_output_nid generation:  0.006049156188964844
local_in_edges_tensor generation:  0.003310680389404297
mini_batch_src_global generation:  0.009857177734375
r_  generation:  0.0984799861907959
local_output_nid generation:  0.006047964096069336
local_in_edges_tensor generation:  0.0032639503479003906
mini_batch_src_global generation:  0.007678508758544922
r_  generation:  0.10054993629455566
local_output_nid generation:  0.00611567497253418
local_in_edges_tensor generation:  0.003223419189453125
mini_batch_src_global generation:  0.008261680603027344
r_  generation:  0.10508346557617188
----------------------check_connections_block total spend ----------------------------- 0.5687859058380127
generate_one_block  0.11653804779052734
generate_one_block  0.1199500560760498
generate_one_block  0.11556339263916016
generate_one_block  0.11629319190979004
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.032018184661865234
gen group dst list time:  0.01221919059753418
time for parepare:  0.019026994705200195
local_output_nid generation:  0.015508651733398438
local_in_edges_tensor generation:  0.042246341705322266
mini_batch_src_global generation:  0.04022550582885742
r_  generation:  0.4242520332336426
local_output_nid generation:  0.023772239685058594
local_in_edges_tensor generation:  0.026626110076904297
mini_batch_src_global generation:  0.051157236099243164
r_  generation:  0.4381749629974365
local_output_nid generation:  0.023703336715698242
local_in_edges_tensor generation:  0.026929378509521484
mini_batch_src_global generation:  0.051146745681762695
r_  generation:  0.4430844783782959
local_output_nid generation:  0.02409839630126953
local_in_edges_tensor generation:  0.029015064239501953
mini_batch_src_global generation:  0.05018901824951172
r_  generation:  0.4481983184814453
----------------------check_connections_block total spend ----------------------------- 2.5466372966766357
generate_one_block  0.5491397380828857
generate_one_block  0.5512053966522217
generate_one_block  0.5794463157653809
generate_one_block  0.5557756423950195
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0247805118560791
gen group dst list time:  0.022305727005004883
time for parepare:  0.0188596248626709
local_output_nid generation:  0.02432107925415039
local_in_edges_tensor generation:  0.034255266189575195
mini_batch_src_global generation:  0.044836997985839844
r_  generation:  0.49532365798950195
local_output_nid generation:  0.0337066650390625
local_in_edges_tensor generation:  0.040174007415771484
mini_batch_src_global generation:  0.05527949333190918
r_  generation:  0.501516580581665
local_output_nid generation:  0.03445243835449219
local_in_edges_tensor generation:  0.03502988815307617
mini_batch_src_global generation:  0.05578804016113281
r_  generation:  0.509181022644043
local_output_nid generation:  0.03476572036743164
local_in_edges_tensor generation:  0.03275942802429199
mini_batch_src_global generation:  0.05272388458251953
r_  generation:  0.5129833221435547
----------------------check_connections_block total spend ----------------------------- 2.9421956539154053
generate_one_block  0.6204161643981934
generate_one_block  0.6227166652679443
generate_one_block  0.623089075088501
generate_one_block  0.627286434173584
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.14768457412719727  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

connection checking time:  5.488832950592041
block generation total time  4.7290754318237305
average batch blocks generation time:  1.1822688579559326
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10904836654663086  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1282463073730469  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10923290252685547  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.129244327545166  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10973978042602539  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1340627670288086  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10931682586669922  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.13383150100708  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09244543313980103 |0.013982772827148438 |0.0035864710807800293 |9.679794311523438e-05 |0.0038670897483825684 |0.001468658447265625 |
----------------------------------------------------------pseudo_mini_loss sum 1.6343716382980347
 Run 0| Epoch 9 |
Number of nodes for computation during this epoch:  1710512
Number of first layer input nodes during this epoch:  658257
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.14713096618652344  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.043825387954711914
range selection method range initialization spend 0.018613576889038086
time for parepare:  0.01804804801940918
local_output_nid generation:  0.005394935607910156
local_in_edges_tensor generation:  0.0074825286865234375
mini_batch_src_global generation:  0.009328842163085938
r_  generation:  0.09342265129089355
local_output_nid generation:  0.00609278678894043
local_in_edges_tensor generation:  0.003837108612060547
mini_batch_src_global generation:  0.012859582901000977
r_  generation:  0.09835958480834961
local_output_nid generation:  0.006211996078491211
local_in_edges_tensor generation:  0.004177093505859375
mini_batch_src_global generation:  0.008116006851196289
r_  generation:  0.10251259803771973
local_output_nid generation:  0.00606536865234375
local_in_edges_tensor generation:  0.0038671493530273438
mini_batch_src_global generation:  0.008298635482788086
r_  generation:  0.10433316230773926
----------------------check_connections_block total spend ----------------------------- 0.5860249996185303
generate_one_block  0.1150517463684082
generate_one_block  0.11398887634277344
generate_one_block  0.11788606643676758
generate_one_block  0.11837601661682129
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03913474082946777
gen group dst list time:  0.015748023986816406
time for parepare:  0.027064800262451172
local_output_nid generation:  0.03310680389404297
local_in_edges_tensor generation:  0.042170047760009766
mini_batch_src_global generation:  0.0424504280090332
r_  generation:  0.4286611080169678
local_output_nid generation:  0.029113292694091797
local_in_edges_tensor generation:  0.03259587287902832
mini_batch_src_global generation:  0.05199575424194336
r_  generation:  0.4384124279022217
local_output_nid generation:  0.029517412185668945
local_in_edges_tensor generation:  0.027553081512451172
mini_batch_src_global generation:  0.05352926254272461
r_  generation:  0.45468997955322266
local_output_nid generation:  0.029690027236938477
local_in_edges_tensor generation:  0.026422500610351562
mini_batch_src_global generation:  0.05261349678039551
r_  generation:  0.44798922538757324
----------------------check_connections_block total spend ----------------------------- 2.628028392791748
generate_one_block  0.5752696990966797
generate_one_block  0.5578939914703369
generate_one_block  0.605400800704956
generate_one_block  0.5701279640197754
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03183484077453613
gen group dst list time:  0.02530956268310547
time for parepare:  0.01936173439025879
local_output_nid generation:  0.02492976188659668
local_in_edges_tensor generation:  0.04752039909362793
mini_batch_src_global generation:  0.05975055694580078
r_  generation:  0.523399829864502
local_output_nid generation:  0.03478741645812988
local_in_edges_tensor generation:  0.040967702865600586
mini_batch_src_global generation:  0.05951547622680664
r_  generation:  0.5270235538482666
local_output_nid generation:  0.03524899482727051
local_in_edges_tensor generation:  0.04677104949951172
mini_batch_src_global generation:  0.09444856643676758
r_  generation:  0.5349001884460449
local_output_nid generation:  0.03717827796936035
local_in_edges_tensor generation:  0.0364382266998291
mini_batch_src_global generation:  0.055375099182128906
r_  generation:  0.5472886562347412
----------------------check_connections_block total spend ----------------------------- 3.2200307846069336
generate_one_block  0.6463379859924316
generate_one_block  0.639883279800415
generate_one_block  0.6521997451782227
generate_one_block  0.629605770111084
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.14713096618652344  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

connection checking time:  5.848059177398682
block generation total time  4.876719236373901
average batch blocks generation time:  1.2191798090934753
block dataloader generation time/epoch 12.62618899345398
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.109222412109375  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1333942413330078  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10906791687011719  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1282844543457031  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10926198959350586  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.130338191986084  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10969305038452148  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1305179595947266  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08816665410995483 |0.018808424472808838 |0.003694891929626465 |9.953975677490234e-05 |0.0032899975776672363 |0.0017926692962646484 |
----------------------------------------------------------pseudo_mini_loss sum 1.5930132865905762
Total (block generation + training)time/epoch 13.178125858306885
Training time/epoch 0.5516579151153564
Training time without block to device /epoch 0.4764242172241211
Training time without total dataloading part /epoch 0.030130386352539062
load block tensor time/epoch 0.35266661643981934
block to device time/epoch 0.07523369789123535
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 10 |
Number of nodes for computation during this epoch:  1710006
Number of first layer input nodes during this epoch:  658011
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.14763498306274414  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022884130477905273
range selection method range initialization spend 0.01207590103149414
time for parepare:  0.0169830322265625
local_output_nid generation:  0.005317211151123047
local_in_edges_tensor generation:  0.006379604339599609
mini_batch_src_global generation:  0.00776982307434082
r_  generation:  0.09105300903320312
local_output_nid generation:  0.006006717681884766
local_in_edges_tensor generation:  0.004220485687255859
mini_batch_src_global generation:  0.009788990020751953
r_  generation:  0.09847354888916016
local_output_nid generation:  0.005995273590087891
local_in_edges_tensor generation:  0.0032477378845214844
mini_batch_src_global generation:  0.007875442504882812
r_  generation:  0.10100603103637695
local_output_nid generation:  0.006073474884033203
local_in_edges_tensor generation:  0.003240346908569336
mini_batch_src_global generation:  0.008491754531860352
r_  generation:  0.10473442077636719
----------------------check_connections_block total spend ----------------------------- 0.5662815570831299
generate_one_block  0.11410975456237793
generate_one_block  0.12181901931762695
generate_one_block  0.1172020435333252
generate_one_block  0.1158757209777832
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.037604570388793945
gen group dst list time:  0.011974811553955078
time for parepare:  0.019213199615478516
local_output_nid generation:  0.015799999237060547
local_in_edges_tensor generation:  0.032082319259643555
mini_batch_src_global generation:  0.0416712760925293
r_  generation:  0.4251887798309326
local_output_nid generation:  0.023810148239135742
local_in_edges_tensor generation:  0.026784896850585938
mini_batch_src_global generation:  0.04991888999938965
r_  generation:  0.43517589569091797
local_output_nid generation:  0.023484468460083008
local_in_edges_tensor generation:  0.025987863540649414
mini_batch_src_global generation:  0.04984426498413086
r_  generation:  0.4388008117675781
local_output_nid generation:  0.02353358268737793
local_in_edges_tensor generation:  0.025266647338867188
mini_batch_src_global generation:  0.05030989646911621
r_  generation:  0.44179201126098633
----------------------check_connections_block total spend ----------------------------- 2.5207056999206543
generate_one_block  0.5566093921661377
generate_one_block  0.5537540912628174
generate_one_block  0.5808298587799072
generate_one_block  0.5535609722137451
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029648542404174805
gen group dst list time:  0.023448705673217773
time for parepare:  0.018860816955566406
local_output_nid generation:  0.02494645118713379
local_in_edges_tensor generation:  0.03458261489868164
mini_batch_src_global generation:  0.04617500305175781
r_  generation:  0.49776220321655273
local_output_nid generation:  0.03515267372131348
local_in_edges_tensor generation:  0.036073923110961914
mini_batch_src_global generation:  0.0711674690246582
r_  generation:  0.5063598155975342
local_output_nid generation:  0.035002708435058594
local_in_edges_tensor generation:  0.03411269187927246
mini_batch_src_global generation:  0.05629467964172363
r_  generation:  0.5082385540008545
local_output_nid generation:  0.037998199462890625
local_in_edges_tensor generation:  0.040049076080322266
mini_batch_src_global generation:  0.052613258361816406
r_  generation:  0.5263738632202148
----------------------check_connections_block total spend ----------------------------- 3.0002033710479736
generate_one_block  0.6362392902374268
generate_one_block  0.6314465999603271
generate_one_block  0.6254761219024658
generate_one_block  0.6296823024749756
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.14763498306274414  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

connection checking time:  5.520909070968628
block generation total time  4.767598628997803
average batch blocks generation time:  1.1918996572494507
block dataloader generation time/epoch 12.40103554725647
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10928630828857422  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1332154273986816  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.1091160774230957  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1288771629333496  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.1092386245727539  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1340222358703613  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10933256149291992  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1308517456054688  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09037506580352783 |0.018666982650756836 |0.0036945343017578125 |9.816884994506836e-05 |0.0037751197814941406 |0.0013949871063232422 |
----------------------------------------------------------pseudo_mini_loss sum 1.5487357378005981
Total (block generation + training)time/epoch 12.95525848865509
Training time/epoch 0.5562312602996826
Training time without block to device /epoch 0.4815633296966553
Training time without total dataloading part /epoch 0.03166627883911133
load block tensor time/epoch 0.36150026321411133
block to device time/epoch 0.07466793060302734
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 11 |
Number of nodes for computation during this epoch:  1710345
Number of first layer input nodes during this epoch:  658213
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.14695405960083008  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020275115966796875
range selection method range initialization spend 0.011837959289550781
time for parepare:  0.017141103744506836
local_output_nid generation:  0.005419015884399414
local_in_edges_tensor generation:  0.008797407150268555
mini_batch_src_global generation:  0.008406877517700195
r_  generation:  0.09131073951721191
local_output_nid generation:  0.005998849868774414
local_in_edges_tensor generation:  0.0031714439392089844
mini_batch_src_global generation:  0.009887218475341797
r_  generation:  0.09770750999450684
local_output_nid generation:  0.006066322326660156
local_in_edges_tensor generation:  0.0031936168670654297
mini_batch_src_global generation:  0.007545948028564453
r_  generation:  0.10018539428710938
local_output_nid generation:  0.006075859069824219
local_in_edges_tensor generation:  0.0035545825958251953
mini_batch_src_global generation:  0.00817251205444336
r_  generation:  0.10474276542663574
----------------------check_connections_block total spend ----------------------------- 0.5692441463470459
generate_one_block  0.12186551094055176
generate_one_block  0.11533570289611816
generate_one_block  0.11468863487243652
generate_one_block  0.11644268035888672
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03597903251647949
gen group dst list time:  0.011916160583496094
time for parepare:  0.019357919692993164
local_output_nid generation:  0.016124248504638672
local_in_edges_tensor generation:  0.030618667602539062
mini_batch_src_global generation:  0.041028499603271484
r_  generation:  0.42679810523986816
local_output_nid generation:  0.024263620376586914
local_in_edges_tensor generation:  0.02706599235534668
mini_batch_src_global generation:  0.05014681816101074
r_  generation:  0.43994760513305664
local_output_nid generation:  0.023834943771362305
local_in_edges_tensor generation:  0.026022672653198242
mini_batch_src_global generation:  0.049889326095581055
r_  generation:  0.43883705139160156
local_output_nid generation:  0.024304628372192383
local_in_edges_tensor generation:  0.026213884353637695
mini_batch_src_global generation:  0.05078315734863281
r_  generation:  0.4430098533630371
----------------------check_connections_block total spend ----------------------------- 2.532506227493286
generate_one_block  0.557631254196167
generate_one_block  0.5511696338653564
generate_one_block  0.5749800205230713
generate_one_block  0.5537087917327881
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03110337257385254
gen group dst list time:  0.022085905075073242
time for parepare:  0.018904685974121094
local_output_nid generation:  0.02474665641784668
local_in_edges_tensor generation:  0.03416275978088379
mini_batch_src_global generation:  0.04420876502990723
r_  generation:  0.49457788467407227
local_output_nid generation:  0.0335385799407959
local_in_edges_tensor generation:  0.038687705993652344
mini_batch_src_global generation:  0.05543780326843262
r_  generation:  0.506195068359375
local_output_nid generation:  0.03521084785461426
local_in_edges_tensor generation:  0.03364682197570801
mini_batch_src_global generation:  0.05436897277832031
r_  generation:  0.5087301731109619
local_output_nid generation:  0.03502941131591797
local_in_edges_tensor generation:  0.03773808479309082
mini_batch_src_global generation:  0.05140185356140137
r_  generation:  0.5148646831512451
----------------------check_connections_block total spend ----------------------------- 2.950368881225586
generate_one_block  0.6229746341705322
generate_one_block  0.6248071193695068
generate_one_block  0.6226537227630615
generate_one_block  0.627903938293457
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.14695405960083008  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

connection checking time:  5.482875108718872
block generation total time  4.73582911491394
average batch blocks generation time:  1.183957278728485
block dataloader generation time/epoch 12.299684683481852
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10947132110595703  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1337928771972656  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10900354385375977  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1290888786315918  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10913991928100586  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1291499137878418  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10927486419677734  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.130784511566162  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09456813335418701 |0.021729469299316406 |0.0035759806632995605 |9.560585021972656e-05 |0.0038095712661743164 |0.0013260841369628906 |
----------------------------------------------------------pseudo_mini_loss sum 1.5165965557098389
Total (block generation + training)time/epoch 12.865187565485636
Training time/epoch 0.5878448486328125
Training time without block to device /epoch 0.5009269714355469
Training time without total dataloading part /epoch 0.031250715255737305
load block tensor time/epoch 0.37827253341674805
block to device time/epoch 0.08691787719726562
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 12 |
Number of nodes for computation during this epoch:  1710855
Number of first layer input nodes during this epoch:  658259
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.14766931533813477  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02268695831298828
range selection method range initialization spend 0.01203775405883789
time for parepare:  0.016836166381835938
local_output_nid generation:  0.0054721832275390625
local_in_edges_tensor generation:  0.005705118179321289
mini_batch_src_global generation:  0.0076940059661865234
r_  generation:  0.09026646614074707
local_output_nid generation:  0.0061419010162353516
local_in_edges_tensor generation:  0.0038957595825195312
mini_batch_src_global generation:  0.01616215705871582
r_  generation:  0.09841203689575195
local_output_nid generation:  0.0065076351165771484
local_in_edges_tensor generation:  0.003234386444091797
mini_batch_src_global generation:  0.007631063461303711
r_  generation:  0.10169005393981934
local_output_nid generation:  0.006554841995239258
local_in_edges_tensor generation:  0.003209352493286133
mini_batch_src_global generation:  0.008387088775634766
r_  generation:  0.10390257835388184
----------------------check_connections_block total spend ----------------------------- 0.5871634483337402
generate_one_block  0.11191010475158691
generate_one_block  0.11460256576538086
generate_one_block  0.11604547500610352
generate_one_block  0.11857795715332031
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.033948659896850586
gen group dst list time:  0.011831283569335938
time for parepare:  0.019344806671142578
local_output_nid generation:  0.015800952911376953
local_in_edges_tensor generation:  0.03544974327087402
mini_batch_src_global generation:  0.0464177131652832
r_  generation:  0.4204895496368408
local_output_nid generation:  0.02385544776916504
local_in_edges_tensor generation:  0.031713247299194336
mini_batch_src_global generation:  0.04947376251220703
r_  generation:  0.4334428310394287
local_output_nid generation:  0.02346348762512207
local_in_edges_tensor generation:  0.025986433029174805
mini_batch_src_global generation:  0.049857378005981445
r_  generation:  0.4417297840118408
local_output_nid generation:  0.023593902587890625
local_in_edges_tensor generation:  0.025757551193237305
mini_batch_src_global generation:  0.053785085678100586
r_  generation:  0.4504256248474121
----------------------check_connections_block total spend ----------------------------- 2.5384602546691895
generate_one_block  0.5569121837615967
generate_one_block  0.5469582080841064
generate_one_block  0.5816659927368164
generate_one_block  0.5576643943786621
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02922844886779785
gen group dst list time:  0.022167444229125977
time for parepare:  0.018467426300048828
local_output_nid generation:  0.024589061737060547
local_in_edges_tensor generation:  0.03436875343322754
mini_batch_src_global generation:  0.04418468475341797
r_  generation:  0.4923896789550781
local_output_nid generation:  0.03336215019226074
local_in_edges_tensor generation:  0.039656639099121094
mini_batch_src_global generation:  0.05600929260253906
r_  generation:  0.5018749237060547
local_output_nid generation:  0.03401994705200195
local_in_edges_tensor generation:  0.03407430648803711
mini_batch_src_global generation:  0.053524017333984375
r_  generation:  0.5063321590423584
local_output_nid generation:  0.03419780731201172
local_in_edges_tensor generation:  0.032837629318237305
mini_batch_src_global generation:  0.051915645599365234
r_  generation:  0.514042854309082
----------------------check_connections_block total spend ----------------------------- 2.9345452785491943
generate_one_block  0.6258776187896729
generate_one_block  0.6383366584777832
generate_one_block  0.6289589405059814
generate_one_block  0.6229777336120605
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.14766931533813477  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

connection checking time:  5.473005533218384
block generation total time  4.75935173034668
average batch blocks generation time:  1.18983793258667
block dataloader generation time/epoch 12.251497268676758
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10930967330932617  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1304750442504883  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10924720764160156  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1297941207885742  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10943078994750977  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1334428787231445  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10922527313232422  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1326837539672852  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09246605634689331 |0.013720452785491943 |0.0036169886589050293 |9.483098983764648e-05 |0.0038852691650390625 |0.0028390884399414062 |
----------------------------------------------------------pseudo_mini_loss sum 1.4836623668670654
Total (block generation + training)time/epoch 12.812427401542664
Training time/epoch 0.5470306873321533
Training time without block to device /epoch 0.49214887619018555
Training time without total dataloading part /epoch 0.03322744369506836
load block tensor time/epoch 0.36986422538757324
block to device time/epoch 0.05488181114196777
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 13 |
Number of nodes for computation during this epoch:  1711245
Number of first layer input nodes during this epoch:  658534
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.1472315788269043  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01739192008972168
range selection method range initialization spend 0.011626720428466797
time for parepare:  0.016851186752319336
local_output_nid generation:  0.0054340362548828125
local_in_edges_tensor generation:  0.005777597427368164
mini_batch_src_global generation:  0.007869243621826172
r_  generation:  0.08991599082946777
local_output_nid generation:  0.005975246429443359
local_in_edges_tensor generation:  0.003561258316040039
mini_batch_src_global generation:  0.009887218475341797
r_  generation:  0.09824728965759277
local_output_nid generation:  0.005936145782470703
local_in_edges_tensor generation:  0.003194570541381836
mini_batch_src_global generation:  0.007843494415283203
r_  generation:  0.10250139236450195
local_output_nid generation:  0.0059947967529296875
local_in_edges_tensor generation:  0.0032036304473876953
mini_batch_src_global generation:  0.008408308029174805
r_  generation:  0.1042318344116211
----------------------check_connections_block total spend ----------------------------- 0.5643310546875
generate_one_block  0.11402559280395508
generate_one_block  0.1157217025756836
generate_one_block  0.11543726921081543
generate_one_block  0.11569905281066895
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.028586864471435547
gen group dst list time:  0.011969327926635742
time for parepare:  0.019275665283203125
local_output_nid generation:  0.015561342239379883
local_in_edges_tensor generation:  0.027538776397705078
mini_batch_src_global generation:  0.03963875770568848
r_  generation:  0.43387317657470703
local_output_nid generation:  0.023908615112304688
local_in_edges_tensor generation:  0.02346181869506836
mini_batch_src_global generation:  0.050487518310546875
r_  generation:  0.4441080093383789
local_output_nid generation:  0.023362159729003906
local_in_edges_tensor generation:  0.02433609962463379
mini_batch_src_global generation:  0.04989433288574219
r_  generation:  0.4423985481262207
local_output_nid generation:  0.02357649803161621
local_in_edges_tensor generation:  0.02424907684326172
mini_batch_src_global generation:  0.05068254470825195
r_  generation:  0.44455838203430176
----------------------check_connections_block total spend ----------------------------- 2.5298304557800293
generate_one_block  0.555391788482666
generate_one_block  0.553870677947998
generate_one_block  0.5761973857879639
generate_one_block  0.5565152168273926
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.025597095489501953
gen group dst list time:  0.0221097469329834
time for parepare:  0.018543243408203125
local_output_nid generation:  0.024312973022460938
local_in_edges_tensor generation:  0.03561806678771973
mini_batch_src_global generation:  0.0465083122253418
r_  generation:  0.4945049285888672
local_output_nid generation:  0.033377885818481445
local_in_edges_tensor generation:  0.033712148666381836
mini_batch_src_global generation:  0.05548095703125
r_  generation:  0.506129264831543
local_output_nid generation:  0.03416132926940918
local_in_edges_tensor generation:  0.03545260429382324
mini_batch_src_global generation:  0.05462908744812012
r_  generation:  0.505645751953125
local_output_nid generation:  0.034589290618896484
local_in_edges_tensor generation:  0.03184914588928223
mini_batch_src_global generation:  0.05142045021057129
r_  generation:  0.5150995254516602
----------------------check_connections_block total spend ----------------------------- 2.940443277359009
generate_one_block  0.6229245662689209
generate_one_block  0.6240267753601074
generate_one_block  0.6203272342681885
generate_one_block  0.6222081184387207
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.1472315788269043  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

connection checking time:  5.470273733139038
block generation total time  4.731461763381958
average batch blocks generation time:  1.1828654408454895
block dataloader generation time/epoch 12.20580358505249
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10934209823608398  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1287450790405273  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10925674438476562  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1348772048950195  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10907840728759766  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1302075386047363  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10922956466674805  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.133915901184082  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0938224196434021 |0.013918578624725342 |0.00351792573928833 |9.1552734375e-05 |0.0036586523056030273 |0.0017321109771728516 |
----------------------------------------------------------pseudo_mini_loss sum 1.4517087936401367
Total (block generation + training)time/epoch 12.764744329452515
Training time/epoch 0.5507550239562988
Training time without block to device /epoch 0.49508070945739746
Training time without total dataloading part /epoch 0.03080463409423828
load block tensor time/epoch 0.3752896785736084
block to device time/epoch 0.05567431449890137
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 14 |
Number of nodes for computation during this epoch:  1711966
Number of first layer input nodes during this epoch:  658396
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.1474895477294922  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02162313461303711
range selection method range initialization spend 0.011798620223999023
time for parepare:  0.017174482345581055
local_output_nid generation:  0.005442380905151367
local_in_edges_tensor generation:  0.0056645870208740234
mini_batch_src_global generation:  0.00786733627319336
r_  generation:  0.09041929244995117
local_output_nid generation:  0.006445884704589844
local_in_edges_tensor generation:  0.00319671630859375
mini_batch_src_global generation:  0.009765863418579102
r_  generation:  0.09709358215332031
local_output_nid generation:  0.006472110748291016
local_in_edges_tensor generation:  0.003587484359741211
mini_batch_src_global generation:  0.007798194885253906
r_  generation:  0.10319662094116211
local_output_nid generation:  0.006482362747192383
local_in_edges_tensor generation:  0.0034894943237304688
mini_batch_src_global generation:  0.008287668228149414
r_  generation:  0.10505819320678711
----------------------check_connections_block total spend ----------------------------- 0.5676679611206055
generate_one_block  0.11121630668640137
generate_one_block  0.12050938606262207
generate_one_block  0.11899614334106445
generate_one_block  0.12058329582214355
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.030374765396118164
gen group dst list time:  0.011853456497192383
time for parepare:  0.0198819637298584
local_output_nid generation:  0.02009725570678711
local_in_edges_tensor generation:  0.03596353530883789
mini_batch_src_global generation:  0.04182267189025879
r_  generation:  0.4391813278198242
local_output_nid generation:  0.031966209411621094
local_in_edges_tensor generation:  0.03086709976196289
mini_batch_src_global generation:  0.04985857009887695
r_  generation:  0.434356689453125
local_output_nid generation:  0.02702164649963379
local_in_edges_tensor generation:  0.028348445892333984
mini_batch_src_global generation:  0.05002951622009277
r_  generation:  0.44094014167785645
local_output_nid generation:  0.02745199203491211
local_in_edges_tensor generation:  0.026290178298950195
mini_batch_src_global generation:  0.0503382682800293
r_  generation:  0.4408600330352783
----------------------check_connections_block total spend ----------------------------- 2.5747804641723633
generate_one_block  0.5556280612945557
generate_one_block  0.5672402381896973
generate_one_block  0.5875649452209473
generate_one_block  0.5573811531066895
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.032212018966674805
gen group dst list time:  0.02385425567626953
time for parepare:  0.019074678421020508
local_output_nid generation:  0.025015592575073242
local_in_edges_tensor generation:  0.04614591598510742
mini_batch_src_global generation:  0.046835899353027344
r_  generation:  0.4922640323638916
local_output_nid generation:  0.0363469123840332
local_in_edges_tensor generation:  0.04355502128601074
mini_batch_src_global generation:  0.05609273910522461
r_  generation:  0.5144014358520508
local_output_nid generation:  0.03713178634643555
local_in_edges_tensor generation:  0.036214351654052734
mini_batch_src_global generation:  0.05520296096801758
r_  generation:  0.5130405426025391
local_output_nid generation:  0.04177522659301758
local_in_edges_tensor generation:  0.04773521423339844
mini_batch_src_global generation:  0.05677938461303711
r_  generation:  0.5390896797180176
----------------------check_connections_block total spend ----------------------------- 3.046196222305298
generate_one_block  0.6415016651153564
generate_one_block  0.6346209049224854
generate_one_block  0.6270890235900879
generate_one_block  0.6521501541137695
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.1474895477294922  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

connection checking time:  5.620976686477661
block generation total time  4.823176145553589
average batch blocks generation time:  1.2057940363883972
block dataloader generation time/epoch 12.223721663157145
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.1091618537902832  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1287217140197754  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10924053192138672  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1291275024414062  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10965490341186523  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1307616233825684  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10947036743164062  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1339068412780762  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09423869848251343 |0.019333600997924805 |0.0036963820457458496 |9.840726852416992e-05 |0.003885030746459961 |0.0014252662658691406 |
----------------------------------------------------------pseudo_mini_loss sum 1.4218688011169434
Total (block generation + training)time/epoch 12.785253882408142
Training time/epoch 0.5742416381835938
Training time without block to device /epoch 0.49690723419189453
Training time without total dataloading part /epoch 0.03214454650878906
load block tensor time/epoch 0.3769547939300537
block to device time/epoch 0.07733440399169922
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 15 |
Number of nodes for computation during this epoch:  1710053
Number of first layer input nodes during this epoch:  658320
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.14694690704345703  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027119874954223633
range selection method range initialization spend 0.011861562728881836
time for parepare:  0.017737865447998047
local_output_nid generation:  0.005271434783935547
local_in_edges_tensor generation:  0.00655055046081543
mini_batch_src_global generation:  0.007748126983642578
r_  generation:  0.08967781066894531
local_output_nid generation:  0.005990266799926758
local_in_edges_tensor generation:  0.003921031951904297
mini_batch_src_global generation:  0.010109663009643555
r_  generation:  0.09873342514038086
local_output_nid generation:  0.0076029300689697266
local_in_edges_tensor generation:  0.003312826156616211
mini_batch_src_global generation:  0.00778508186340332
r_  generation:  0.0996408462524414
local_output_nid generation:  0.006127357482910156
local_in_edges_tensor generation:  0.0032973289489746094
mini_batch_src_global generation:  0.008353471755981445
r_  generation:  0.10486888885498047
----------------------check_connections_block total spend ----------------------------- 0.5678107738494873
generate_one_block  0.11155581474304199
generate_one_block  0.11850309371948242
generate_one_block  0.11555171012878418
generate_one_block  0.11770820617675781
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03490710258483887
gen group dst list time:  0.012115955352783203
time for parepare:  0.033176422119140625
local_output_nid generation:  0.01807236671447754
local_in_edges_tensor generation:  0.06350493431091309
mini_batch_src_global generation:  0.05677938461303711
r_  generation:  0.4670083522796631
local_output_nid generation:  0.03126096725463867
local_in_edges_tensor generation:  0.03664255142211914
mini_batch_src_global generation:  0.08089089393615723
r_  generation:  0.46384382247924805
local_output_nid generation:  0.035451412200927734
local_in_edges_tensor generation:  0.02767777442932129
mini_batch_src_global generation:  0.05223894119262695
r_  generation:  0.46335911750793457
local_output_nid generation:  0.0327906608581543
local_in_edges_tensor generation:  0.032778263092041016
mini_batch_src_global generation:  0.05415940284729004
r_  generation:  0.4637715816497803
----------------------check_connections_block total spend ----------------------------- 2.8149030208587646
generate_one_block  0.5563416481018066
generate_one_block  0.5540680885314941
generate_one_block  0.582594633102417
generate_one_block  0.5690968036651611
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028159379959106445
gen group dst list time:  0.022428512573242188
time for parepare:  0.0198976993560791
local_output_nid generation:  0.025884628295898438
local_in_edges_tensor generation:  0.0464780330657959
mini_batch_src_global generation:  0.046794891357421875
r_  generation:  0.49273061752319336
local_output_nid generation:  0.0370793342590332
local_in_edges_tensor generation:  0.04047107696533203
mini_batch_src_global generation:  0.05748558044433594
r_  generation:  0.5079421997070312
local_output_nid generation:  0.037590980529785156
local_in_edges_tensor generation:  0.03635549545288086
mini_batch_src_global generation:  0.059325456619262695
r_  generation:  0.5177397727966309
local_output_nid generation:  0.03708338737487793
local_in_edges_tensor generation:  0.03643465042114258
mini_batch_src_global generation:  0.05395174026489258
r_  generation:  0.5369529724121094
----------------------check_connections_block total spend ----------------------------- 3.0275933742523193
generate_one_block  0.6383531093597412
generate_one_block  0.6340193748474121
generate_one_block  0.6454977989196777
generate_one_block  0.6356959342956543
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.14694690704345703  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

connection checking time:  5.842496395111084
block generation total time  4.815667390823364
average batch blocks generation time:  1.203916847705841
block dataloader generation time/epoch 12.269672700337
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10911273956298828  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1275873184204102  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10938739776611328  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1336536407470703  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10914421081542969  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1283388137817383  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10939407348632812  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.134645938873291  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09354394674301147 |0.01820594072341919 |0.0036264657974243164 |9.66787338256836e-05 |0.0038728713989257812 |0.003100872039794922 |
----------------------------------------------------------pseudo_mini_loss sum 1.3936125040054321
Total (block generation + training)time/epoch 12.832187584468297
Training time/epoch 0.5681343078613281
Training time without block to device /epoch 0.49531054496765137
Training time without total dataloading part /epoch 0.03348493576049805
load block tensor time/epoch 0.3741757869720459
block to device time/epoch 0.07282376289367676
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 16 |
Number of nodes for computation during this epoch:  1710962
Number of first layer input nodes during this epoch:  658453
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.14761114120483398  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02654743194580078
range selection method range initialization spend 0.01187896728515625
time for parepare:  0.01695108413696289
local_output_nid generation:  0.00533604621887207
local_in_edges_tensor generation:  0.009621381759643555
mini_batch_src_global generation:  0.007783651351928711
r_  generation:  0.09108448028564453
local_output_nid generation:  0.006127834320068359
local_in_edges_tensor generation:  0.004618167877197266
mini_batch_src_global generation:  0.009853124618530273
r_  generation:  0.10097265243530273
local_output_nid generation:  0.0064280033111572266
local_in_edges_tensor generation:  0.003209829330444336
mini_batch_src_global generation:  0.016279935836791992
r_  generation:  0.09940028190612793
local_output_nid generation:  0.006476640701293945
local_in_edges_tensor generation:  0.003436565399169922
mini_batch_src_global generation:  0.00817108154296875
r_  generation:  0.10261106491088867
----------------------check_connections_block total spend ----------------------------- 0.5856964588165283
generate_one_block  0.11212348937988281
generate_one_block  0.1141653060913086
generate_one_block  0.11357879638671875
generate_one_block  0.1143178939819336
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03560018539428711
gen group dst list time:  0.011819124221801758
time for parepare:  0.018973350524902344
local_output_nid generation:  0.015591621398925781
local_in_edges_tensor generation:  0.03747725486755371
mini_batch_src_global generation:  0.041802167892456055
r_  generation:  0.4156827926635742
local_output_nid generation:  0.023592472076416016
local_in_edges_tensor generation:  0.03072071075439453
mini_batch_src_global generation:  0.04933643341064453
r_  generation:  0.42688703536987305
local_output_nid generation:  0.023507356643676758
local_in_edges_tensor generation:  0.025623559951782227
mini_batch_src_global generation:  0.04960775375366211
r_  generation:  0.43112921714782715
local_output_nid generation:  0.02392864227294922
local_in_edges_tensor generation:  0.02625298500061035
mini_batch_src_global generation:  0.050156593322753906
r_  generation:  0.43312788009643555
----------------------check_connections_block total spend ----------------------------- 2.4880318641662598
generate_one_block  0.5458788871765137
generate_one_block  0.5483450889587402
generate_one_block  0.5770392417907715
generate_one_block  0.5486078262329102
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.032584190368652344
gen group dst list time:  0.02196669578552246
time for parepare:  0.018812179565429688
local_output_nid generation:  0.024067163467407227
local_in_edges_tensor generation:  0.035346269607543945
mini_batch_src_global generation:  0.04400205612182617
r_  generation:  0.48405885696411133
local_output_nid generation:  0.03304123878479004
local_in_edges_tensor generation:  0.03461050987243652
mini_batch_src_global generation:  0.05500459671020508
r_  generation:  0.49988317489624023
local_output_nid generation:  0.03386950492858887
local_in_edges_tensor generation:  0.03334975242614746
mini_batch_src_global generation:  0.05614209175109863
r_  generation:  0.498215913772583
local_output_nid generation:  0.03432750701904297
local_in_edges_tensor generation:  0.03142189979553223
mini_batch_src_global generation:  0.05161452293395996
r_  generation:  0.5140864849090576
----------------------check_connections_block total spend ----------------------------- 2.9085259437561035
generate_one_block  0.6187219619750977
generate_one_block  0.6193337440490723
generate_one_block  0.6188068389892578
generate_one_block  0.6192975044250488
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.14761114120483398  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

connection checking time:  5.396557807922363
block generation total time  4.696031093597412
average batch blocks generation time:  1.174007773399353
block dataloader generation time/epoch 12.23726886510849
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10906791687011719  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1295394897460938  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10919332504272461  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1323695182800293  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10935449600219727  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.131296157836914  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10918045043945312  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1285662651062012  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08630836009979248 |0.014766156673431396 |0.0034862160682678223 |9.441375732421875e-05 |0.003284752368927002 |0.0017104148864746094 |
----------------------------------------------------------pseudo_mini_loss sum 1.372826099395752
Total (block generation + training)time/epoch 12.795015513896942
Training time/epoch 0.5241062641143799
Training time without block to device /epoch 0.4650416374206543
Training time without total dataloading part /epoch 0.02917194366455078
load block tensor time/epoch 0.3452334403991699
block to device time/epoch 0.059064626693725586
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 17 |
Number of nodes for computation during this epoch:  1710653
Number of first layer input nodes during this epoch:  658318
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.14685964584350586  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027413606643676758
range selection method range initialization spend 0.011781692504882812
time for parepare:  0.01706242561340332
local_output_nid generation:  0.0054552555084228516
local_in_edges_tensor generation:  0.006280183792114258
mini_batch_src_global generation:  0.00822591781616211
r_  generation:  0.09013533592224121
local_output_nid generation:  0.006331920623779297
local_in_edges_tensor generation:  0.0041697025299072266
mini_batch_src_global generation:  0.012633085250854492
r_  generation:  0.09710860252380371
local_output_nid generation:  0.006140708923339844
local_in_edges_tensor generation:  0.0038831233978271484
mini_batch_src_global generation:  0.007623910903930664
r_  generation:  0.10080838203430176
local_output_nid generation:  0.0061609745025634766
local_in_edges_tensor generation:  0.0038459300994873047
mini_batch_src_global generation:  0.008359193801879883
r_  generation:  0.1023099422454834
----------------------check_connections_block total spend ----------------------------- 0.5684523582458496
generate_one_block  0.11139225959777832
generate_one_block  0.11398172378540039
generate_one_block  0.11523175239562988
generate_one_block  0.1146538257598877
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03594255447387695
gen group dst list time:  0.012008190155029297
time for parepare:  0.021492481231689453
local_output_nid generation:  0.015311956405639648
local_in_edges_tensor generation:  0.03203558921813965
mini_batch_src_global generation:  0.041146039962768555
r_  generation:  0.41513895988464355
local_output_nid generation:  0.02599620819091797
local_in_edges_tensor generation:  0.031049251556396484
mini_batch_src_global generation:  0.051042795181274414
r_  generation:  0.43187856674194336
local_output_nid generation:  0.026302337646484375
local_in_edges_tensor generation:  0.023034095764160156
mini_batch_src_global generation:  0.04883837699890137
r_  generation:  0.4349839687347412
local_output_nid generation:  0.02624344825744629
local_in_edges_tensor generation:  0.024346590042114258
mini_batch_src_global generation:  0.051836252212524414
r_  generation:  0.44151735305786133
----------------------check_connections_block total spend ----------------------------- 2.508002996444702
generate_one_block  0.5520992279052734
generate_one_block  0.5565919876098633
generate_one_block  0.5836098194122314
generate_one_block  0.551058292388916
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03406929969787598
gen group dst list time:  0.022176504135131836
time for parepare:  0.018581390380859375
local_output_nid generation:  0.024252653121948242
local_in_edges_tensor generation:  0.042634010314941406
mini_batch_src_global generation:  0.04978632926940918
r_  generation:  0.48847174644470215
local_output_nid generation:  0.03316760063171387
local_in_edges_tensor generation:  0.04103279113769531
mini_batch_src_global generation:  0.055300235748291016
r_  generation:  0.49953222274780273
local_output_nid generation:  0.0341184139251709
local_in_edges_tensor generation:  0.036795854568481445
mini_batch_src_global generation:  0.05398058891296387
r_  generation:  0.5001537799835205
local_output_nid generation:  0.033944129943847656
local_in_edges_tensor generation:  0.03283095359802246
mini_batch_src_global generation:  0.05091118812561035
r_  generation:  0.5104560852050781
----------------------check_connections_block total spend ----------------------------- 2.9312033653259277
generate_one_block  0.617912769317627
generate_one_block  0.6245095729827881
generate_one_block  0.623668909072876
generate_one_block  0.617255687713623
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.14685964584350586  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

connection checking time:  5.43920636177063
block generation total time  4.726706266403198
average batch blocks generation time:  1.1816765666007996
block dataloader generation time/epoch 12.211231840981377
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10913610458374023  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.127884864807129  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10931015014648438  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.13392972946167  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10919618606567383  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1299991607666016  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10915565490722656  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1288022994995117  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09459871053695679 |0.013896048069000244 |0.003598153591156006 |9.375810623168945e-05 |0.003624141216278076 |0.002867460250854492 |
----------------------------------------------------------pseudo_mini_loss sum 1.3568025827407837
Total (block generation + training)time/epoch 12.76843335893419
Training time/epoch 0.5525736808776855
Training time without block to device /epoch 0.49698948860168457
Training time without total dataloading part /epoch 0.03213167190551758
load block tensor time/epoch 0.37839484214782715
block to device time/epoch 0.05558419227600098
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 18 |
Number of nodes for computation during this epoch:  1710096
Number of first layer input nodes during this epoch:  658233
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.1468043327331543  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018103599548339844
range selection method range initialization spend 0.011723041534423828
time for parepare:  0.016855239868164062
local_output_nid generation:  0.005295753479003906
local_in_edges_tensor generation:  0.005400896072387695
mini_batch_src_global generation:  0.0078046321868896484
r_  generation:  0.0893697738647461
local_output_nid generation:  0.005964994430541992
local_in_edges_tensor generation:  0.0031676292419433594
mini_batch_src_global generation:  0.009644746780395508
r_  generation:  0.0958552360534668
local_output_nid generation:  0.005985260009765625
local_in_edges_tensor generation:  0.003299713134765625
mini_batch_src_global generation:  0.007833242416381836
r_  generation:  0.10009932518005371
local_output_nid generation:  0.006083965301513672
local_in_edges_tensor generation:  0.0031480789184570312
mini_batch_src_global generation:  0.008174896240234375
r_  generation:  0.10230708122253418
----------------------check_connections_block total spend ----------------------------- 0.555708646774292
generate_one_block  0.11166691780090332
generate_one_block  0.1127932071685791
generate_one_block  0.11629843711853027
generate_one_block  0.1157066822052002
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.030625343322753906
gen group dst list time:  0.011742353439331055
time for parepare:  0.019314289093017578
local_output_nid generation:  0.01567554473876953
local_in_edges_tensor generation:  0.03003406524658203
mini_batch_src_global generation:  0.0414583683013916
r_  generation:  0.41791868209838867
local_output_nid generation:  0.02386617660522461
local_in_edges_tensor generation:  0.027578353881835938
mini_batch_src_global generation:  0.04955482482910156
r_  generation:  0.43250370025634766
local_output_nid generation:  0.023679256439208984
local_in_edges_tensor generation:  0.02404308319091797
mini_batch_src_global generation:  0.04930996894836426
r_  generation:  0.4347717761993408
local_output_nid generation:  0.023712873458862305
local_in_edges_tensor generation:  0.02439713478088379
mini_batch_src_global generation:  0.04952287673950195
r_  generation:  0.4365217685699463
----------------------check_connections_block total spend ----------------------------- 2.488947868347168
generate_one_block  0.55287766456604
generate_one_block  0.5464315414428711
generate_one_block  0.5732753276824951
generate_one_block  0.5454545021057129
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03159785270690918
gen group dst list time:  0.022520065307617188
time for parepare:  0.018670082092285156
local_output_nid generation:  0.024069547653198242
local_in_edges_tensor generation:  0.03302288055419922
mini_batch_src_global generation:  0.0450437068939209
r_  generation:  0.48883724212646484
local_output_nid generation:  0.03310275077819824
local_in_edges_tensor generation:  0.034334421157836914
mini_batch_src_global generation:  0.05481410026550293
r_  generation:  0.4930000305175781
local_output_nid generation:  0.03358960151672363
local_in_edges_tensor generation:  0.0323636531829834
mini_batch_src_global generation:  0.05432558059692383
r_  generation:  0.5041980743408203
local_output_nid generation:  0.03442716598510742
local_in_edges_tensor generation:  0.032097578048706055
mini_batch_src_global generation:  0.05213475227355957
r_  generation:  0.5119554996490479
----------------------check_connections_block total spend ----------------------------- 2.9060490131378174
generate_one_block  0.6249141693115234
generate_one_block  0.6310567855834961
generate_one_block  0.6174280643463135
generate_one_block  0.6175744533538818
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.1468043327331543  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

connection checking time:  5.394996881484985
block generation total time  4.709012508392334
average batch blocks generation time:  1.1772531270980835
block dataloader generation time/epoch 12.181869506835938
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10928153991699219  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1345171928405762  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10920429229736328  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.133450984954834  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10919713973999023  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1326680183410645  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.1091165542602539  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1286530494689941  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0873221755027771 |0.013401269912719727 |0.0033172965049743652 |8.851289749145508e-05 |0.003412902355194092 |0.0012004375457763672 |
----------------------------------------------------------pseudo_mini_loss sum 1.344041347503662
Total (block generation + training)time/epoch 12.735323786735535
Training time/epoch 0.519608736038208
Training time without block to device /epoch 0.4660036563873291
Training time without total dataloading part /epoch 0.028475284576416016
load block tensor time/epoch 0.3492887020111084
block to device time/epoch 0.053605079650878906
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 19 |
Number of nodes for computation during this epoch:  1711509
Number of first layer input nodes during this epoch:  658256
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.14680814743041992  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018258333206176758
range selection method range initialization spend 0.012167692184448242
time for parepare:  0.016589879989624023
local_output_nid generation:  0.00544428825378418
local_in_edges_tensor generation:  0.0056171417236328125
mini_batch_src_global generation:  0.007594108581542969
r_  generation:  0.0875101089477539
local_output_nid generation:  0.005957365036010742
local_in_edges_tensor generation:  0.003156900405883789
mini_batch_src_global generation:  0.009971380233764648
r_  generation:  0.09655404090881348
local_output_nid generation:  0.005954742431640625
local_in_edges_tensor generation:  0.0032052993774414062
mini_batch_src_global generation:  0.007591962814331055
r_  generation:  0.09919118881225586
local_output_nid generation:  0.006092548370361328
local_in_edges_tensor generation:  0.003184795379638672
mini_batch_src_global generation:  0.008485555648803711
r_  generation:  0.10241889953613281
----------------------check_connections_block total spend ----------------------------- 0.5537393093109131
generate_one_block  0.10989165306091309
generate_one_block  0.11573195457458496
generate_one_block  0.11860132217407227
generate_one_block  0.1193084716796875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.026200532913208008
gen group dst list time:  0.012094974517822266
time for parepare:  0.02089548110961914
local_output_nid generation:  0.01562952995300293
local_in_edges_tensor generation:  0.025562763214111328
mini_batch_src_global generation:  0.03931069374084473
r_  generation:  0.416576623916626
local_output_nid generation:  0.023493289947509766
local_in_edges_tensor generation:  0.023102283477783203
mini_batch_src_global generation:  0.049349308013916016
r_  generation:  0.430875301361084
local_output_nid generation:  0.023122787475585938
local_in_edges_tensor generation:  0.024378538131713867
mini_batch_src_global generation:  0.04906105995178223
r_  generation:  0.4353797435760498
local_output_nid generation:  0.023533105850219727
local_in_edges_tensor generation:  0.024860382080078125
mini_batch_src_global generation:  0.049864768981933594
r_  generation:  0.43607115745544434
----------------------check_connections_block total spend ----------------------------- 2.4832441806793213
generate_one_block  0.5524611473083496
generate_one_block  0.5579824447631836
generate_one_block  0.5665061473846436
generate_one_block  0.548569917678833
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029059171676635742
gen group dst list time:  0.022112607955932617
time for parepare:  0.01915764808654785
local_output_nid generation:  0.02435922622680664
local_in_edges_tensor generation:  0.03356480598449707
mini_batch_src_global generation:  0.04462027549743652
r_  generation:  0.4911530017852783
local_output_nid generation:  0.03270840644836426
local_in_edges_tensor generation:  0.030451536178588867
mini_batch_src_global generation:  0.054473161697387695
r_  generation:  0.5000789165496826
local_output_nid generation:  0.03353476524353027
local_in_edges_tensor generation:  0.03372001647949219
mini_batch_src_global generation:  0.05414128303527832
r_  generation:  0.49788784980773926
local_output_nid generation:  0.03414630889892578
local_in_edges_tensor generation:  0.03162980079650879
mini_batch_src_global generation:  0.05060577392578125
r_  generation:  0.5132005214691162
----------------------check_connections_block total spend ----------------------------- 2.9020564556121826
generate_one_block  0.62813401222229
generate_one_block  0.6188271045684814
generate_one_block  0.6282410621643066
generate_one_block  0.6263172626495361
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.14680814743041992  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

connection checking time:  5.385300636291504
block generation total time  4.727039098739624
average batch blocks generation time:  1.181759774684906
block dataloader generation time/epoch 12.154392740943216
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10914421081542969  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.126145362854004  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10929203033447266  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1338496208190918  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10970592498779297  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1306891441345215  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10885143280029297  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1325883865356445  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09186947345733643 |0.018727540969848633 |0.003466784954071045 |8.618831634521484e-05 |0.003787994384765625 |0.0017380714416503906 |
----------------------------------------------------------pseudo_mini_loss sum 1.3265044689178467
Total (block generation + training)time/epoch 12.708819736133922
Training time/epoch 0.5639653205871582
Training time without block to device /epoch 0.48905515670776367
Training time without total dataloading part /epoch 0.03110194206237793
load block tensor time/epoch 0.3674778938293457
block to device time/epoch 0.07491016387939453
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 20 |
Number of nodes for computation during this epoch:  1710081
Number of first layer input nodes during this epoch:  658220
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.14679622650146484  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02042365074157715
range selection method range initialization spend 0.01182246208190918
time for parepare:  0.017385244369506836
local_output_nid generation:  0.005419731140136719
local_in_edges_tensor generation:  0.009136438369750977
mini_batch_src_global generation:  0.007704973220825195
r_  generation:  0.09067678451538086
local_output_nid generation:  0.006003379821777344
local_in_edges_tensor generation:  0.004021883010864258
mini_batch_src_global generation:  0.010223388671875
r_  generation:  0.09676837921142578
local_output_nid generation:  0.006162166595458984
local_in_edges_tensor generation:  0.0032384395599365234
mini_batch_src_global generation:  0.007733345031738281
r_  generation:  0.10004019737243652
local_output_nid generation:  0.006036043167114258
local_in_edges_tensor generation:  0.0032486915588378906
mini_batch_src_global generation:  0.008044242858886719
r_  generation:  0.10284638404846191
----------------------check_connections_block total spend ----------------------------- 0.5655372142791748
generate_one_block  0.11149263381958008
generate_one_block  0.1142880916595459
generate_one_block  0.11526060104370117
generate_one_block  0.11547398567199707
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0299532413482666
gen group dst list time:  0.0117645263671875
time for parepare:  0.019160985946655273
local_output_nid generation:  0.015327930450439453
local_in_edges_tensor generation:  0.03058147430419922
mini_batch_src_global generation:  0.04003405570983887
r_  generation:  0.4186267852783203
local_output_nid generation:  0.023637771606445312
local_in_edges_tensor generation:  0.028703927993774414
mini_batch_src_global generation:  0.048978567123413086
r_  generation:  0.4306156635284424
local_output_nid generation:  0.023313045501708984
local_in_edges_tensor generation:  0.0243680477142334
mini_batch_src_global generation:  0.05121421813964844
r_  generation:  0.4351167678833008
local_output_nid generation:  0.023987531661987305
local_in_edges_tensor generation:  0.02416682243347168
mini_batch_src_global generation:  0.050051212310791016
r_  generation:  0.43893003463745117
----------------------check_connections_block total spend ----------------------------- 2.496755361557007
generate_one_block  0.5453462600708008
generate_one_block  0.5544483661651611
generate_one_block  0.5722334384918213
generate_one_block  0.5504705905914307
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.024524450302124023
gen group dst list time:  0.022283315658569336
time for parepare:  0.01825737953186035
local_output_nid generation:  0.0242617130279541
local_in_edges_tensor generation:  0.03465843200683594
mini_batch_src_global generation:  0.04402780532836914
r_  generation:  0.4900376796722412
local_output_nid generation:  0.032800912857055664
local_in_edges_tensor generation:  0.03681015968322754
mini_batch_src_global generation:  0.054945945739746094
r_  generation:  0.49617648124694824
local_output_nid generation:  0.03376150131225586
local_in_edges_tensor generation:  0.03637504577636719
mini_batch_src_global generation:  0.054241180419921875
r_  generation:  0.5007126331329346
local_output_nid generation:  0.03395414352416992
local_in_edges_tensor generation:  0.03343391418457031
mini_batch_src_global generation:  0.051323890686035156
r_  generation:  0.510993480682373
----------------------check_connections_block total spend ----------------------------- 2.912757158279419
generate_one_block  0.6245574951171875
generate_one_block  0.6185410022735596
generate_one_block  0.621516227722168
generate_one_block  0.6243934631347656
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.14679622650146484  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

connection checking time:  5.409512519836426
block generation total time  4.7115068435668945
average batch blocks generation time:  1.1778767108917236
block dataloader generation time/epoch 12.136599580446878
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10922479629516602  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1308765411376953  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10927677154541016  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1289410591125488  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10921621322631836  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1292710304260254  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10977411270141602  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.134892463684082  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08810734748840332 |0.013498187065124512 |0.003483295440673828 |9.02414321899414e-05 |0.0031986236572265625 |0.0012810230255126953 |
----------------------------------------------------------pseudo_mini_loss sum 1.3074439764022827
Total (block generation + training)time/epoch 12.688414553801218
Training time/epoch 0.5228400230407715
Training time without block to device /epoch 0.46884727478027344
Training time without total dataloading part /epoch 0.028369665145874023
load block tensor time/epoch 0.3524293899536133
block to device time/epoch 0.05399274826049805
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 21 |
Number of nodes for computation during this epoch:  1710969
Number of first layer input nodes during this epoch:  658414
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.1474895477294922  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019869327545166016
range selection method range initialization spend 0.011862039566040039
time for parepare:  0.016533374786376953
local_output_nid generation:  0.005381107330322266
local_in_edges_tensor generation:  0.005627870559692383
mini_batch_src_global generation:  0.0077364444732666016
r_  generation:  0.0896153450012207
local_output_nid generation:  0.005902290344238281
local_in_edges_tensor generation:  0.003310680389404297
mini_batch_src_global generation:  0.010122060775756836
r_  generation:  0.09645771980285645
local_output_nid generation:  0.00601649284362793
local_in_edges_tensor generation:  0.0031538009643554688
mini_batch_src_global generation:  0.007726192474365234
r_  generation:  0.09860396385192871
local_output_nid generation:  0.006044864654541016
local_in_edges_tensor generation:  0.003198385238647461
mini_batch_src_global generation:  0.008293628692626953
r_  generation:  0.10216403007507324
----------------------check_connections_block total spend ----------------------------- 0.5553491115570068
generate_one_block  0.11251449584960938
generate_one_block  0.11471366882324219
generate_one_block  0.11506009101867676
generate_one_block  0.11478042602539062
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03046274185180664
gen group dst list time:  0.011896133422851562
time for parepare:  0.01914668083190918
local_output_nid generation:  0.015887737274169922
local_in_edges_tensor generation:  0.026726961135864258
mini_batch_src_global generation:  0.04063773155212402
r_  generation:  0.42072153091430664
local_output_nid generation:  0.02431464195251465
local_in_edges_tensor generation:  0.02322983741760254
mini_batch_src_global generation:  0.05151820182800293
r_  generation:  0.4290494918823242
local_output_nid generation:  0.02376556396484375
local_in_edges_tensor generation:  0.023212432861328125
mini_batch_src_global generation:  0.04922032356262207
r_  generation:  0.43402814865112305
local_output_nid generation:  0.024236202239990234
local_in_edges_tensor generation:  0.02709221839904785
mini_batch_src_global generation:  0.05112719535827637
r_  generation:  0.4381070137023926
----------------------check_connections_block total spend ----------------------------- 2.492321252822876
generate_one_block  0.5498440265655518
generate_one_block  0.547602653503418
generate_one_block  0.566063642501831
generate_one_block  0.553044319152832
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.026834726333618164
gen group dst list time:  0.022710800170898438
time for parepare:  0.01891160011291504
local_output_nid generation:  0.024600982666015625
local_in_edges_tensor generation:  0.03604435920715332
mini_batch_src_global generation:  0.04452252388000488
r_  generation:  0.48818111419677734
local_output_nid generation:  0.033803701400756836
local_in_edges_tensor generation:  0.03936362266540527
mini_batch_src_global generation:  0.054784297943115234
r_  generation:  0.49649810791015625
local_output_nid generation:  0.034996986389160156
local_in_edges_tensor generation:  0.03423595428466797
mini_batch_src_global generation:  0.05454754829406738
r_  generation:  0.5019590854644775
local_output_nid generation:  0.03473210334777832
local_in_edges_tensor generation:  0.03717827796936035
mini_batch_src_global generation:  0.05142974853515625
r_  generation:  0.5126035213470459
----------------------check_connections_block total spend ----------------------------- 2.9271483421325684
generate_one_block  0.6157419681549072
generate_one_block  0.6132283210754395
generate_one_block  0.6196119785308838
generate_one_block  0.6246259212493896
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.1474895477294922  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

connection checking time:  5.419469594955444
block generation total time  4.689762830734253
average batch blocks generation time:  1.1724407076835632
block dataloader generation time/epoch 12.118958271466768
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10914421081542969  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1331005096435547  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10925865173339844  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1343297958374023  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10893917083740234  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1264638900756836  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.1092982292175293  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.133687973022461  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08796250820159912 |0.01779162883758545 |0.0034469962120056152 |9.560585021972656e-05 |0.0033016204833984375 |0.002856016159057617 |
----------------------------------------------------------pseudo_mini_loss sum 1.293652057647705
Total (block generation + training)time/epoch 12.670115122428307
Training time/epoch 0.5430560111999512
Training time without block to device /epoch 0.4718894958496094
Training time without total dataloading part /epoch 0.030232906341552734
load block tensor time/epoch 0.3518500328063965
block to device time/epoch 0.0711665153503418
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 22 |
Number of nodes for computation during this epoch:  1711234
Number of first layer input nodes during this epoch:  658335
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.1473078727722168  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020824670791625977
range selection method range initialization spend 0.011741399765014648
time for parepare:  0.017096281051635742
local_output_nid generation:  0.005491971969604492
local_in_edges_tensor generation:  0.00655055046081543
mini_batch_src_global generation:  0.007870197296142578
r_  generation:  0.08952975273132324
local_output_nid generation:  0.005987405776977539
local_in_edges_tensor generation:  0.0032150745391845703
mini_batch_src_global generation:  0.010052204132080078
r_  generation:  0.09582066535949707
local_output_nid generation:  0.0060460567474365234
local_in_edges_tensor generation:  0.0032494068145751953
mini_batch_src_global generation:  0.007949590682983398
r_  generation:  0.09923267364501953
local_output_nid generation:  0.0060329437255859375
local_in_edges_tensor generation:  0.003193378448486328
mini_batch_src_global generation:  0.008132457733154297
r_  generation:  0.10480499267578125
----------------------check_connections_block total spend ----------------------------- 0.5602109432220459
generate_one_block  0.11479473114013672
generate_one_block  0.1140282154083252
generate_one_block  0.11500835418701172
generate_one_block  0.1147768497467041
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04255175590515137
gen group dst list time:  0.011775493621826172
time for parepare:  0.019342660903930664
local_output_nid generation:  0.015581607818603516
local_in_edges_tensor generation:  0.029391765594482422
mini_batch_src_global generation:  0.040102481842041016
r_  generation:  0.4188263416290283
local_output_nid generation:  0.024502992630004883
local_in_edges_tensor generation:  0.023211002349853516
mini_batch_src_global generation:  0.05026578903198242
r_  generation:  0.42513179779052734
local_output_nid generation:  0.024393320083618164
local_in_edges_tensor generation:  0.024518251419067383
mini_batch_src_global generation:  0.04972362518310547
r_  generation:  0.4328575134277344
local_output_nid generation:  0.024980545043945312
local_in_edges_tensor generation:  0.025754213333129883
mini_batch_src_global generation:  0.050701141357421875
r_  generation:  0.43668437004089355
----------------------check_connections_block total spend ----------------------------- 2.4895191192626953
generate_one_block  0.5501000881195068
generate_one_block  0.5469090938568115
generate_one_block  0.5657010078430176
generate_one_block  0.5514168739318848
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.037671804428100586
gen group dst list time:  0.02238941192626953
time for parepare:  0.019744396209716797
local_output_nid generation:  0.02456068992614746
local_in_edges_tensor generation:  0.03938794136047363
mini_batch_src_global generation:  0.04707980155944824
r_  generation:  0.4878230094909668
local_output_nid generation:  0.03311872482299805
local_in_edges_tensor generation:  0.04238319396972656
mini_batch_src_global generation:  0.055619239807128906
r_  generation:  0.5043938159942627
local_output_nid generation:  0.0340118408203125
local_in_edges_tensor generation:  0.03489398956298828
mini_batch_src_global generation:  0.057134389877319336
r_  generation:  0.49642491340637207
local_output_nid generation:  0.03386569023132324
local_in_edges_tensor generation:  0.04119086265563965
mini_batch_src_global generation:  0.05615115165710449
r_  generation:  0.5107040405273438
----------------------check_connections_block total spend ----------------------------- 2.950650215148926
generate_one_block  0.6158397197723389
generate_one_block  0.6180484294891357
generate_one_block  0.6357321739196777
generate_one_block  0.626490592956543
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.1473078727722168  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

connection checking time:  5.440169334411621
block generation total time  4.710237979888916
average batch blocks generation time:  1.177559494972229
block dataloader generation time/epoch 12.108893990516663
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10978555679321289  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1347427368164062  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10906457901000977  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.127272129058838  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10921955108642578  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1290254592895508  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10965251922607422  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1310310363769531  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08931571245193481 |0.01618194580078125 |0.0033669471740722656 |8.940696716308594e-05 |0.003558337688446045 |0.0016553401947021484 |
----------------------------------------------------------pseudo_mini_loss sum 1.276576042175293
Total (block generation + training)time/epoch 12.65945988042014
Training time/epoch 0.5426769256591797
Training time without block to device /epoch 0.4779491424560547
Training time without total dataloading part /epoch 0.029714107513427734
load block tensor time/epoch 0.35726284980773926
block to device time/epoch 0.064727783203125
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 23 |
Number of nodes for computation during this epoch:  1710098
Number of first layer input nodes during this epoch:  658217
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.14751005172729492  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01946878433227539
range selection method range initialization spend 0.011664152145385742
time for parepare:  0.016582965850830078
local_output_nid generation:  0.0054132938385009766
local_in_edges_tensor generation:  0.00859522819519043
mini_batch_src_global generation:  0.007742643356323242
r_  generation:  0.08902788162231445
local_output_nid generation:  0.006013631820678711
local_in_edges_tensor generation:  0.0032782554626464844
mini_batch_src_global generation:  0.009717941284179688
r_  generation:  0.09821677207946777
local_output_nid generation:  0.006025075912475586
local_in_edges_tensor generation:  0.003278970718383789
mini_batch_src_global generation:  0.0077321529388427734
r_  generation:  0.09976506233215332
local_output_nid generation:  0.006162166595458984
local_in_edges_tensor generation:  0.0033254623413085938
mini_batch_src_global generation:  0.00828409194946289
r_  generation:  0.1020345687866211
----------------------check_connections_block total spend ----------------------------- 0.5609500408172607
generate_one_block  0.11509561538696289
generate_one_block  0.11430001258850098
generate_one_block  0.11487841606140137
generate_one_block  0.11585688591003418
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.031530141830444336
gen group dst list time:  0.011857986450195312
time for parepare:  0.019214868545532227
local_output_nid generation:  0.015408515930175781
local_in_edges_tensor generation:  0.030454635620117188
mini_batch_src_global generation:  0.03958535194396973
r_  generation:  0.41814327239990234
local_output_nid generation:  0.023689985275268555
local_in_edges_tensor generation:  0.02454090118408203
mini_batch_src_global generation:  0.05302858352661133
r_  generation:  0.4273653030395508
local_output_nid generation:  0.023258209228515625
local_in_edges_tensor generation:  0.026673555374145508
mini_batch_src_global generation:  0.0497279167175293
r_  generation:  0.4336683750152588
local_output_nid generation:  0.023636579513549805
local_in_edges_tensor generation:  0.024909019470214844
mini_batch_src_global generation:  0.05311417579650879
r_  generation:  0.43758273124694824
----------------------check_connections_block total spend ----------------------------- 2.4908876419067383
generate_one_block  0.5543394088745117
generate_one_block  0.5454819202423096
generate_one_block  0.5676918029785156
generate_one_block  0.5520350933074951
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.026185035705566406
gen group dst list time:  0.021900415420532227
time for parepare:  0.0183413028717041
local_output_nid generation:  0.024495601654052734
local_in_edges_tensor generation:  0.033976078033447266
mini_batch_src_global generation:  0.044465065002441406
r_  generation:  0.4887411594390869
local_output_nid generation:  0.032735347747802734
local_in_edges_tensor generation:  0.037834882736206055
mini_batch_src_global generation:  0.05515289306640625
r_  generation:  0.4949839115142822
local_output_nid generation:  0.03379988670349121
local_in_edges_tensor generation:  0.0369267463684082
mini_batch_src_global generation:  0.05299687385559082
r_  generation:  0.5057110786437988
local_output_nid generation:  0.03419637680053711
local_in_edges_tensor generation:  0.03380560874938965
mini_batch_src_global generation:  0.05089855194091797
r_  generation:  0.5114035606384277
----------------------check_connections_block total spend ----------------------------- 2.9150969982147217
generate_one_block  0.6159317493438721
generate_one_block  0.6156904697418213
generate_one_block  0.6168229579925537
generate_one_block  0.634324312210083
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.14751005172729492  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

connection checking time:  5.40598464012146
block generation total time  4.702317714691162
average batch blocks generation time:  1.1755794286727905
block dataloader generation time/epoch 12.094841051101685
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10925579071044922  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1280698776245117  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10923433303833008  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1337356567382812  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10916948318481445  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.132652759552002  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10932350158691406  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1340522766113281  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09326958656311035 |0.01351773738861084 |0.0036107897758483887 |9.524822235107422e-05 |0.003814518451690674 |0.0027909278869628906 |
----------------------------------------------------------pseudo_mini_loss sum 1.265842318534851
Total (block generation + training)time/epoch 12.645326137542725
Training time/epoch 0.5491681098937988
Training time without block to device /epoch 0.49509716033935547
Training time without total dataloading part /epoch 0.03287315368652344
load block tensor time/epoch 0.3730783462524414
block to device time/epoch 0.05407094955444336
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 24 |
Number of nodes for computation during this epoch:  1711136
Number of first layer input nodes during this epoch:  658315
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.14756298065185547  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01891613006591797
range selection method range initialization spend 0.011701822280883789
time for parepare:  0.016709327697753906
local_output_nid generation:  0.005409717559814453
local_in_edges_tensor generation:  0.00559687614440918
mini_batch_src_global generation:  0.0077974796295166016
r_  generation:  0.09094095230102539
local_output_nid generation:  0.006077289581298828
local_in_edges_tensor generation:  0.0032796859741210938
mini_batch_src_global generation:  0.00989222526550293
r_  generation:  0.0970156192779541
local_output_nid generation:  0.005860805511474609
local_in_edges_tensor generation:  0.003232717514038086
mini_batch_src_global generation:  0.0077571868896484375
r_  generation:  0.10128355026245117
local_output_nid generation:  0.005980968475341797
local_in_edges_tensor generation:  0.003216266632080078
mini_batch_src_global generation:  0.007992982864379883
r_  generation:  0.10251569747924805
----------------------check_connections_block total spend ----------------------------- 0.5601727962493896
generate_one_block  0.11528801918029785
generate_one_block  0.11371111869812012
generate_one_block  0.11682915687561035
generate_one_block  0.11638712882995605
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02851104736328125
gen group dst list time:  0.011646747589111328
time for parepare:  0.019345760345458984
local_output_nid generation:  0.015584468841552734
local_in_edges_tensor generation:  0.025278806686401367
mini_batch_src_global generation:  0.039833784103393555
r_  generation:  0.4315829277038574
local_output_nid generation:  0.023372411727905273
local_in_edges_tensor generation:  0.023657798767089844
mini_batch_src_global generation:  0.04874110221862793
r_  generation:  0.4364128112792969
local_output_nid generation:  0.02378058433532715
local_in_edges_tensor generation:  0.024698734283447266
mini_batch_src_global generation:  0.04954028129577637
r_  generation:  0.4450998306274414
local_output_nid generation:  0.023108482360839844
local_in_edges_tensor generation:  0.025330781936645508
mini_batch_src_global generation:  0.05092430114746094
r_  generation:  0.448810338973999
----------------------check_connections_block total spend ----------------------------- 2.5215466022491455
generate_one_block  0.5468230247497559
generate_one_block  0.5388996601104736
generate_one_block  0.5684020519256592
generate_one_block  0.5481076240539551
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.027497291564941406
gen group dst list time:  0.022661447525024414
time for parepare:  0.018370866775512695
local_output_nid generation:  0.025302886962890625
local_in_edges_tensor generation:  0.03457379341125488
mini_batch_src_global generation:  0.04448366165161133
r_  generation:  0.4867842197418213
local_output_nid generation:  0.033307552337646484
local_in_edges_tensor generation:  0.03077983856201172
mini_batch_src_global generation:  0.05466198921203613
r_  generation:  0.49489355087280273
local_output_nid generation:  0.03390836715698242
local_in_edges_tensor generation:  0.03198075294494629
mini_batch_src_global generation:  0.054230451583862305
r_  generation:  0.49646520614624023
local_output_nid generation:  0.03403735160827637
local_in_edges_tensor generation:  0.031743526458740234
mini_batch_src_global generation:  0.050827980041503906
r_  generation:  0.5180089473724365
----------------------check_connections_block total spend ----------------------------- 2.901668071746826
generate_one_block  0.6225793361663818
generate_one_block  0.6203296184539795
generate_one_block  0.6186230182647705
generate_one_block  0.6177849769592285
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.14756298065185547  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

connection checking time:  5.423214673995972
block generation total time  4.681549310684204
average batch blocks generation time:  1.170387327671051
block dataloader generation time/epoch 12.083179593086243
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10923528671264648  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1332950592041016  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.1090688705444336  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.127795696258545  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.1096034049987793  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1348586082458496  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10911035537719727  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1282148361206055  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09288299083709717 |0.014649510383605957 |0.0034610629081726074 |8.749961853027344e-05 |0.0037384629249572754 |0.0017809867858886719 |
----------------------------------------------------------pseudo_mini_loss sum 1.252690076828003
Total (block generation + training)time/epoch 12.633732587099075
Training time/epoch 0.5513601303100586
Training time without block to device /epoch 0.49276208877563477
Training time without total dataloading part /epoch 0.030929088592529297
load block tensor time/epoch 0.37153196334838867
block to device time/epoch 0.05859804153442383
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 25 |
Number of nodes for computation during this epoch:  1710930
Number of first layer input nodes during this epoch:  658493
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.1468372344970703  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02020406723022461
range selection method range initialization spend 0.011639833450317383
time for parepare:  0.016588211059570312
local_output_nid generation:  0.0054471492767333984
local_in_edges_tensor generation:  0.005633115768432617
mini_batch_src_global generation:  0.007842540740966797
r_  generation:  0.09001541137695312
local_output_nid generation:  0.0064394474029541016
local_in_edges_tensor generation:  0.0036096572875976562
mini_batch_src_global generation:  0.010124921798706055
r_  generation:  0.09897708892822266
local_output_nid generation:  0.006397247314453125
local_in_edges_tensor generation:  0.003231525421142578
mini_batch_src_global generation:  0.007797956466674805
r_  generation:  0.10002732276916504
local_output_nid generation:  0.006425142288208008
local_in_edges_tensor generation:  0.003246307373046875
mini_batch_src_global generation:  0.008238792419433594
r_  generation:  0.10311365127563477
----------------------check_connections_block total spend ----------------------------- 0.5626089572906494
generate_one_block  0.11349964141845703
generate_one_block  0.1157999038696289
generate_one_block  0.11550617218017578
generate_one_block  0.11445307731628418
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02853083610534668
gen group dst list time:  0.011734724044799805
time for parepare:  0.019298791885375977
local_output_nid generation:  0.015449047088623047
local_in_edges_tensor generation:  0.028397560119628906
mini_batch_src_global generation:  0.03977346420288086
r_  generation:  0.4172499179840088
local_output_nid generation:  0.023352384567260742
local_in_edges_tensor generation:  0.02354717254638672
mini_batch_src_global generation:  0.049512624740600586
r_  generation:  0.4256591796875
local_output_nid generation:  0.023293256759643555
local_in_edges_tensor generation:  0.025404930114746094
mini_batch_src_global generation:  0.0496368408203125
r_  generation:  0.4396848678588867
local_output_nid generation:  0.02323603630065918
local_in_edges_tensor generation:  0.02433609962463379
mini_batch_src_global generation:  0.05036735534667969
r_  generation:  0.4352071285247803
----------------------check_connections_block total spend ----------------------------- 2.483720302581787
generate_one_block  0.5508270263671875
generate_one_block  0.5538845062255859
generate_one_block  0.5747647285461426
generate_one_block  0.5512731075286865
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02825164794921875
gen group dst list time:  0.022334814071655273
time for parepare:  0.018668651580810547
local_output_nid generation:  0.02423858642578125
local_in_edges_tensor generation:  0.03846335411071777
mini_batch_src_global generation:  0.045151710510253906
r_  generation:  0.4923839569091797
local_output_nid generation:  0.03253459930419922
local_in_edges_tensor generation:  0.038066864013671875
mini_batch_src_global generation:  0.05554032325744629
r_  generation:  0.49948835372924805
local_output_nid generation:  0.03362226486206055
local_in_edges_tensor generation:  0.03381633758544922
mini_batch_src_global generation:  0.0544891357421875
r_  generation:  0.5127089023590088
local_output_nid generation:  0.033554792404174805
local_in_edges_tensor generation:  0.03581738471984863
mini_batch_src_global generation:  0.051465511322021484
r_  generation:  0.5089688301086426
----------------------check_connections_block total spend ----------------------------- 2.9415974617004395
generate_one_block  0.6167364120483398
generate_one_block  0.6178183555603027
generate_one_block  0.6213393211364746
generate_one_block  0.6301000118255615
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.1468372344970703  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

connection checking time:  5.425317764282227
block generation total time  4.716743469238281
average batch blocks generation time:  1.1791858673095703
block dataloader generation time/epoch 12.07719745355494
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10921239852905273  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.129702091217041  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.1096334457397461  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.129593849182129  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.11040878295898438  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1359381675720215  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.1090397834777832  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.130359172821045  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08740794658660889 |0.018054425716400146 |0.003997325897216797 |9.590387344360352e-05 |0.0035762786865234375 |0.0012707710266113281 |
----------------------------------------------------------pseudo_mini_loss sum 1.240911602973938
Total (block generation + training)time/epoch 12.627365575117224
Training time/epoch 0.543825626373291
Training time without block to device /epoch 0.47160792350769043
Training time without total dataloading part /epoch 0.03194880485534668
load block tensor time/epoch 0.34963178634643555
block to device time/epoch 0.07221770286560059
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 26 |
Number of nodes for computation during this epoch:  1710580
Number of first layer input nodes during this epoch:  658341
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.14687252044677734  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0193023681640625
range selection method range initialization spend 0.011864423751831055
time for parepare:  0.016657352447509766
local_output_nid generation:  0.0055391788482666016
local_in_edges_tensor generation:  0.006145000457763672
mini_batch_src_global generation:  0.007755279541015625
r_  generation:  0.08998513221740723
local_output_nid generation:  0.0061609745025634766
local_in_edges_tensor generation:  0.0034067630767822266
mini_batch_src_global generation:  0.010001897811889648
r_  generation:  0.09708881378173828
local_output_nid generation:  0.006134033203125
local_in_edges_tensor generation:  0.0033731460571289062
mini_batch_src_global generation:  0.0075283050537109375
r_  generation:  0.10122442245483398
local_output_nid generation:  0.006033182144165039
local_in_edges_tensor generation:  0.0031807422637939453
mini_batch_src_global generation:  0.008237838745117188
r_  generation:  0.10155797004699707
----------------------check_connections_block total spend ----------------------------- 0.5599539279937744
generate_one_block  0.11183762550354004
generate_one_block  0.11505341529846191
generate_one_block  0.11522197723388672
generate_one_block  0.11870360374450684
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03424715995788574
gen group dst list time:  0.011899471282958984
time for parepare:  0.019896268844604492
local_output_nid generation:  0.015526056289672852
local_in_edges_tensor generation:  0.027815580368041992
mini_batch_src_global generation:  0.04093027114868164
r_  generation:  0.42017030715942383
local_output_nid generation:  0.023673534393310547
local_in_edges_tensor generation:  0.029593944549560547
mini_batch_src_global generation:  0.05002880096435547
r_  generation:  0.43451738357543945
local_output_nid generation:  0.02333974838256836
local_in_edges_tensor generation:  0.025726318359375
mini_batch_src_global generation:  0.050214529037475586
r_  generation:  0.4370565414428711
local_output_nid generation:  0.023484230041503906
local_in_edges_tensor generation:  0.028483152389526367
mini_batch_src_global generation:  0.05032920837402344
r_  generation:  0.4399139881134033
----------------------check_connections_block total spend ----------------------------- 2.5059847831726074
generate_one_block  0.5654675960540771
generate_one_block  0.560706615447998
generate_one_block  0.5991291999816895
generate_one_block  0.5662262439727783
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.033899784088134766
gen group dst list time:  0.03666996955871582
time for parepare:  0.022368669509887695
local_output_nid generation:  0.031510353088378906
local_in_edges_tensor generation:  0.06037592887878418
mini_batch_src_global generation:  0.05019855499267578
r_  generation:  0.5353896617889404
local_output_nid generation:  0.039112091064453125
local_in_edges_tensor generation:  0.04508829116821289
mini_batch_src_global generation:  0.06403636932373047
r_  generation:  0.5355257987976074
local_output_nid generation:  0.040376901626586914
local_in_edges_tensor generation:  0.04636240005493164
mini_batch_src_global generation:  0.06760454177856445
r_  generation:  0.5590307712554932
local_output_nid generation:  0.042929887771606445
local_in_edges_tensor generation:  0.048516273498535156
mini_batch_src_global generation:  0.06001543998718262
r_  generation:  0.5272560119628906
----------------------check_connections_block total spend ----------------------------- 3.263594150543213
generate_one_block  0.6408610343933105
generate_one_block  0.6341891288757324
generate_one_block  0.6351687908172607
generate_one_block  0.6467123031616211
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.14687252044677734  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

connection checking time:  5.76957893371582
block generation total time  4.848460912704468
average batch blocks generation time:  1.212115228176117
block dataloader generation time/epoch 12.098055693838331
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.1091923713684082  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1288623809814453  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10928583145141602  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1337275505065918  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10970687866210938  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1291923522949219  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.11031818389892578  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.134404182434082  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09334343671798706 |0.01925957202911377 |0.0036779046058654785 |9.930133819580078e-05 |0.0039261579513549805 |0.001539468765258789 |
----------------------------------------------------------pseudo_mini_loss sum 1.229207992553711
Total (block generation + training)time/epoch 12.649523033036125
Training time/epoch 0.5733232498168945
Training time without block to device /epoch 0.49628496170043945
Training time without total dataloading part /epoch 0.03235292434692383
load block tensor time/epoch 0.37337374687194824
block to device time/epoch 0.07703828811645508
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 27 |
Number of nodes for computation during this epoch:  1710665
Number of first layer input nodes during this epoch:  658339
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.14816617965698242  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022069931030273438
range selection method range initialization spend 0.012164115905761719
time for parepare:  0.016838788986206055
local_output_nid generation:  0.0056095123291015625
local_in_edges_tensor generation:  0.008041620254516602
mini_batch_src_global generation:  0.007765769958496094
r_  generation:  0.09134721755981445
local_output_nid generation:  0.006227970123291016
local_in_edges_tensor generation:  0.0037386417388916016
mini_batch_src_global generation:  0.009928226470947266
r_  generation:  0.09874868392944336
local_output_nid generation:  0.0061321258544921875
local_in_edges_tensor generation:  0.004042387008666992
mini_batch_src_global generation:  0.007801532745361328
r_  generation:  0.10273885726928711
local_output_nid generation:  0.006128787994384766
local_in_edges_tensor generation:  0.0032935142517089844
mini_batch_src_global generation:  0.008363962173461914
r_  generation:  0.10405755043029785
----------------------check_connections_block total spend ----------------------------- 0.5715389251708984
generate_one_block  0.11198258399963379
generate_one_block  0.11754965782165527
generate_one_block  0.12225770950317383
generate_one_block  0.11749601364135742
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03664875030517578
gen group dst list time:  0.011954307556152344
time for parepare:  0.01916646957397461
local_output_nid generation:  0.016030073165893555
local_in_edges_tensor generation:  0.04788041114807129
mini_batch_src_global generation:  0.04358673095703125
r_  generation:  0.4204697608947754
local_output_nid generation:  0.0241696834564209
local_in_edges_tensor generation:  0.031086444854736328
mini_batch_src_global generation:  0.04915356636047363
r_  generation:  0.4367990493774414
local_output_nid generation:  0.024245738983154297
local_in_edges_tensor generation:  0.025883913040161133
mini_batch_src_global generation:  0.05125784873962402
r_  generation:  0.4371469020843506
local_output_nid generation:  0.024463176727294922
local_in_edges_tensor generation:  0.026517391204833984
mini_batch_src_global generation:  0.04998922348022461
r_  generation:  0.43889737129211426
----------------------check_connections_block total spend ----------------------------- 2.5371387004852295
generate_one_block  0.5568592548370361
generate_one_block  0.5534031391143799
generate_one_block  0.5814614295959473
generate_one_block  0.5516066551208496
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.034627437591552734
gen group dst list time:  0.022376537322998047
time for parepare:  0.018480300903320312
local_output_nid generation:  0.024765729904174805
local_in_edges_tensor generation:  0.03728008270263672
mini_batch_src_global generation:  0.0461125373840332
r_  generation:  0.4933013916015625
local_output_nid generation:  0.03345775604248047
local_in_edges_tensor generation:  0.045052289962768555
mini_batch_src_global generation:  0.05526161193847656
r_  generation:  0.5037376880645752
local_output_nid generation:  0.03445625305175781
local_in_edges_tensor generation:  0.03457760810852051
mini_batch_src_global generation:  0.0559842586517334
r_  generation:  0.5093767642974854
local_output_nid generation:  0.034681081771850586
local_in_edges_tensor generation:  0.03309369087219238
mini_batch_src_global generation:  0.050778865814208984
r_  generation:  0.5172185897827148
----------------------check_connections_block total spend ----------------------------- 2.959606409072876
generate_one_block  0.6285250186920166
generate_one_block  0.6302902698516846
generate_one_block  0.6393485069274902
generate_one_block  0.6481075286865234
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.14816617965698242  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

connection checking time:  5.4967451095581055
block generation total time  4.789601802825928
average batch blocks generation time:  1.197400450706482
block dataloader generation time/epoch 12.102033188468532
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10912513732910156  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1289167404174805  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10930728912353516  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1334185600280762  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10931015014648438  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.129793643951416  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10919809341430664  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.133016586303711  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.1000140905380249 |0.021966934204101562 |0.003747284412384033 |0.00010097026824951172 |0.003935694694519043 |0.0028290748596191406 |
----------------------------------------------------------pseudo_mini_loss sum 1.2226147651672363
Total (block generation + training)time/epoch 12.656578829413967
Training time/epoch 0.6096889972686768
Training time without block to device /epoch 0.5218212604522705
Training time without total dataloading part /epoch 0.03396487236022949
load block tensor time/epoch 0.4000563621520996
block to device time/epoch 0.08786773681640625
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 28 |
Number of nodes for computation during this epoch:  1711033
Number of first layer input nodes during this epoch:  658353
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.14697694778442383  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023945093154907227
range selection method range initialization spend 0.011959552764892578
time for parepare:  0.01743483543395996
local_output_nid generation:  0.005744218826293945
local_in_edges_tensor generation:  0.009853363037109375
mini_batch_src_global generation:  0.008143424987792969
r_  generation:  0.09260010719299316
local_output_nid generation:  0.006291627883911133
local_in_edges_tensor generation:  0.003387928009033203
mini_batch_src_global generation:  0.010100603103637695
r_  generation:  0.09687304496765137
local_output_nid generation:  0.006073951721191406
local_in_edges_tensor generation:  0.0036547183990478516
mini_batch_src_global generation:  0.007954120635986328
r_  generation:  0.10235714912414551
local_output_nid generation:  0.006166696548461914
local_in_edges_tensor generation:  0.003556489944458008
mini_batch_src_global generation:  0.00839686393737793
r_  generation:  0.10485267639160156
----------------------check_connections_block total spend ----------------------------- 0.5739142894744873
generate_one_block  0.11486077308654785
generate_one_block  0.11504173278808594
generate_one_block  0.11652135848999023
generate_one_block  0.11655831336975098
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.033052682876586914
gen group dst list time:  0.011785268783569336
time for parepare:  0.01930069923400879
local_output_nid generation:  0.016102313995361328
local_in_edges_tensor generation:  0.03502321243286133
mini_batch_src_global generation:  0.040107011795043945
r_  generation:  0.4315032958984375
local_output_nid generation:  0.024299144744873047
local_in_edges_tensor generation:  0.02821516990661621
mini_batch_src_global generation:  0.049382686614990234
r_  generation:  0.43190574645996094
local_output_nid generation:  0.02423691749572754
local_in_edges_tensor generation:  0.02498936653137207
mini_batch_src_global generation:  0.05117511749267578
r_  generation:  0.44069814682006836
local_output_nid generation:  0.024204492568969727
local_in_edges_tensor generation:  0.027637243270874023
mini_batch_src_global generation:  0.05045628547668457
r_  generation:  0.44245266914367676
----------------------check_connections_block total spend ----------------------------- 2.5328762531280518
generate_one_block  0.5599114894866943
generate_one_block  0.5564985275268555
generate_one_block  0.5763487815856934
generate_one_block  0.558333158493042
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02343606948852539
gen group dst list time:  0.022384166717529297
time for parepare:  0.018746614456176758
local_output_nid generation:  0.024783849716186523
local_in_edges_tensor generation:  0.03404641151428223
mini_batch_src_global generation:  0.054529666900634766
r_  generation:  0.49600768089294434
local_output_nid generation:  0.033884286880493164
local_in_edges_tensor generation:  0.03782153129577637
mini_batch_src_global generation:  0.05535006523132324
r_  generation:  0.5065586566925049
local_output_nid generation:  0.034369707107543945
local_in_edges_tensor generation:  0.035390377044677734
mini_batch_src_global generation:  0.05413222312927246
r_  generation:  0.508216142654419
local_output_nid generation:  0.0350492000579834
local_in_edges_tensor generation:  0.03880596160888672
mini_batch_src_global generation:  0.051323890686035156
r_  generation:  0.5199179649353027
----------------------check_connections_block total spend ----------------------------- 2.9662792682647705
generate_one_block  0.6218299865722656
generate_one_block  0.6213231086730957
generate_one_block  0.6213583946228027
generate_one_block  0.6354033946990967
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.14697694778442383  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

connection checking time:  5.499155521392822
block generation total time  4.751006841659546
average batch blocks generation time:  1.1877517104148865
block dataloader generation time/epoch 12.102931118011474
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10927581787109375  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1335082054138184  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.1090388298034668  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1268510818481445  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10931110382080078  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.130845069885254  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.10936546325683594  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.1335582733154297  GigaBytes
Max Memory Allocated: 1.3417015075683594  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08763974905014038 |0.013689637184143066 |0.003632664680480957 |9.995698928833008e-05 |0.003363311290740967 |0.0019588470458984375 |
----------------------------------------------------------pseudo_mini_loss sum 1.2103780508041382
Total (block generation + training)time/epoch 12.65602113008499
Training time/epoch 0.5251655578613281
Training time without block to device /epoch 0.47040700912475586
Training time without total dataloading part /epoch 0.030342578887939453
load block tensor time/epoch 0.3505589962005615
block to device time/epoch 0.054758548736572266
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 29 |
Number of nodes for computation during this epoch:  1710843
Number of first layer input nodes during this epoch:  658327
