Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1647768044.2596898
ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023053407669067383
range selection method range initialization spend 0.013662099838256836
time for parepare:  0.01781773567199707
local_output_nid generation:  0.0013294219970703125
local_in_edges_tensor generation:  0.003194570541381836
mini_batch_src_global generation:  0.0017342567443847656
r_  generation:  0.018521547317504883
local_output_nid generation:  0.0015344619750976562
local_in_edges_tensor generation:  0.0009083747863769531
mini_batch_src_global generation:  0.002160787582397461
r_  generation:  0.01845097541809082
local_output_nid generation:  0.0015301704406738281
local_in_edges_tensor generation:  0.0008363723754882812
mini_batch_src_global generation:  0.001325845718383789
r_  generation:  0.017844200134277344
local_output_nid generation:  0.0015325546264648438
local_in_edges_tensor generation:  0.0008361339569091797
mini_batch_src_global generation:  0.0013194084167480469
r_  generation:  0.018041133880615234
local_output_nid generation:  0.0015575885772705078
local_in_edges_tensor generation:  0.0008511543273925781
mini_batch_src_global generation:  0.0013036727905273438
r_  generation:  0.01849651336669922
local_output_nid generation:  0.0015320777893066406
local_in_edges_tensor generation:  0.0008192062377929688
mini_batch_src_global generation:  0.0013799667358398438
r_  generation:  0.018401622772216797
local_output_nid generation:  0.001512765884399414
local_in_edges_tensor generation:  0.0008237361907958984
mini_batch_src_global generation:  0.0014061927795410156
r_  generation:  0.0204622745513916
local_output_nid generation:  0.001505136489868164
local_in_edges_tensor generation:  0.0008294582366943359
mini_batch_src_global generation:  0.0016567707061767578
r_  generation:  0.01933908462524414
local_output_nid generation:  0.0015494823455810547
local_in_edges_tensor generation:  0.0008668899536132812
mini_batch_src_global generation:  0.001398324966430664
r_  generation:  0.01997685432434082
local_output_nid generation:  0.0015156269073486328
local_in_edges_tensor generation:  0.0008242130279541016
mini_batch_src_global generation:  0.0017180442810058594
r_  generation:  0.020891904830932617
local_output_nid generation:  0.0014824867248535156
local_in_edges_tensor generation:  0.0008378028869628906
mini_batch_src_global generation:  0.0017533302307128906
r_  generation:  0.021311044692993164
local_output_nid generation:  0.0014920234680175781
local_in_edges_tensor generation:  0.0008411407470703125
mini_batch_src_global generation:  0.0017993450164794922
r_  generation:  0.02164936065673828
local_output_nid generation:  0.0014879703521728516
local_in_edges_tensor generation:  0.0008285045623779297
mini_batch_src_global generation:  0.0017969608306884766
r_  generation:  0.021281957626342773
local_output_nid generation:  0.001519918441772461
local_in_edges_tensor generation:  0.0008213520050048828
mini_batch_src_global generation:  0.0017855167388916016
r_  generation:  0.021144628524780273
local_output_nid generation:  0.0014922618865966797
local_in_edges_tensor generation:  0.0008141994476318359
mini_batch_src_global generation:  0.0017762184143066406
r_  generation:  0.021134138107299805
local_output_nid generation:  0.0014834403991699219
local_in_edges_tensor generation:  0.0008075237274169922
mini_batch_src_global generation:  0.0018155574798583984
r_  generation:  0.019269704818725586
----------------------check_connections_block total spend ----------------------------- 0.4741027355194092
generate_one_block  0.026488065719604492
generate_one_block  0.028679370880126953
generate_one_block  0.029056787490844727
generate_one_block  0.028188228607177734
generate_one_block  0.02800774574279785
generate_one_block  0.027381420135498047
generate_one_block  0.027675867080688477
generate_one_block  0.0269777774810791
generate_one_block  0.028138160705566406
generate_one_block  0.027523279190063477
generate_one_block  0.02758622169494629
generate_one_block  0.02830195426940918
generate_one_block  0.027649879455566406
generate_one_block  0.027771949768066406
generate_one_block  0.02790045738220215
generate_one_block  0.027776718139648438
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03607487678527832
gen group dst list time:  0.01888442039489746
time for parepare:  0.018806934356689453
local_output_nid generation:  0.006438493728637695
local_in_edges_tensor generation:  0.014407157897949219
mini_batch_src_global generation:  0.019044160842895508
r_  generation:  0.18941307067871094
local_output_nid generation:  0.010186195373535156
local_in_edges_tensor generation:  0.017931699752807617
mini_batch_src_global generation:  0.03503847122192383
r_  generation:  0.20189929008483887
local_output_nid generation:  0.01041102409362793
local_in_edges_tensor generation:  0.01395559310913086
mini_batch_src_global generation:  0.022536516189575195
r_  generation:  0.19661521911621094
local_output_nid generation:  0.010573387145996094
local_in_edges_tensor generation:  0.012539863586425781
mini_batch_src_global generation:  0.03628849983215332
r_  generation:  0.20137619972229004
local_output_nid generation:  0.010927438735961914
local_in_edges_tensor generation:  0.01435542106628418
mini_batch_src_global generation:  0.024825096130371094
r_  generation:  0.20541620254516602
local_output_nid generation:  0.011090993881225586
local_in_edges_tensor generation:  0.014815807342529297
mini_batch_src_global generation:  0.0344388484954834
r_  generation:  0.21038126945495605
local_output_nid generation:  0.011075973510742188
local_in_edges_tensor generation:  0.012781143188476562
mini_batch_src_global generation:  0.027502775192260742
r_  generation:  0.20954656600952148
local_output_nid generation:  0.011043548583984375
local_in_edges_tensor generation:  0.011120080947875977
mini_batch_src_global generation:  0.02591395378112793
r_  generation:  0.20589017868041992
local_output_nid generation:  0.011136293411254883
local_in_edges_tensor generation:  0.010962963104248047
mini_batch_src_global generation:  0.02711009979248047
r_  generation:  0.20582270622253418
local_output_nid generation:  0.011143207550048828
local_in_edges_tensor generation:  0.014746665954589844
mini_batch_src_global generation:  0.025514602661132812
r_  generation:  0.20797991752624512
local_output_nid generation:  0.011397838592529297
local_in_edges_tensor generation:  0.013303518295288086
mini_batch_src_global generation:  0.026325464248657227
r_  generation:  0.20833921432495117
local_output_nid generation:  0.011579275131225586
local_in_edges_tensor generation:  0.014894485473632812
mini_batch_src_global generation:  0.02661418914794922
r_  generation:  0.2123410701751709
local_output_nid generation:  0.011290311813354492
local_in_edges_tensor generation:  0.015037059783935547
mini_batch_src_global generation:  0.026164531707763672
r_  generation:  0.21158337593078613
local_output_nid generation:  0.011349201202392578
local_in_edges_tensor generation:  0.011235475540161133
mini_batch_src_global generation:  0.026279211044311523
r_  generation:  0.20777297019958496
local_output_nid generation:  0.011389493942260742
local_in_edges_tensor generation:  0.011359453201293945
mini_batch_src_global generation:  0.027518749237060547
r_  generation:  0.2108173370361328
local_output_nid generation:  0.011337995529174805
local_in_edges_tensor generation:  0.014895439147949219
mini_batch_src_global generation:  0.02807450294494629
r_  generation:  0.21135711669921875
----------------------check_connections_block total spend ----------------------------- 4.873085260391235
generate_one_block  0.2681393623352051
generate_one_block  0.26717424392700195
generate_one_block  0.2563624382019043
generate_one_block  0.26508355140686035
generate_one_block  0.2787199020385742
generate_one_block  0.26659154891967773
generate_one_block  0.26853084564208984
generate_one_block  0.26293039321899414
generate_one_block  0.26436591148376465
generate_one_block  0.2642958164215088
generate_one_block  0.26900172233581543
generate_one_block  0.27516746520996094
generate_one_block  0.2677013874053955
generate_one_block  0.2613229751586914
generate_one_block  0.27426838874816895
generate_one_block  0.2712595462799072
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.035314083099365234
gen group dst list time:  0.058553457260131836
time for parepare:  0.01870131492614746
local_output_nid generation:  0.02381587028503418
local_in_edges_tensor generation:  0.03758740425109863
mini_batch_src_global generation:  0.04038119316101074
r_  generation:  0.4347350597381592
local_output_nid generation:  0.02952718734741211
local_in_edges_tensor generation:  0.043782949447631836
mini_batch_src_global generation:  0.05069112777709961
r_  generation:  0.4435248374938965
local_output_nid generation:  0.029288530349731445
local_in_edges_tensor generation:  0.029096603393554688
mini_batch_src_global generation:  0.05015206336975098
r_  generation:  0.4538559913635254
local_output_nid generation:  0.029657602310180664
local_in_edges_tensor generation:  0.0322418212890625
mini_batch_src_global generation:  0.05122804641723633
r_  generation:  0.4448413848876953
local_output_nid generation:  0.029622316360473633
local_in_edges_tensor generation:  0.04050803184509277
mini_batch_src_global generation:  0.05392146110534668
r_  generation:  0.45215463638305664
local_output_nid generation:  0.029796123504638672
local_in_edges_tensor generation:  0.02961897850036621
mini_batch_src_global generation:  0.05188322067260742
r_  generation:  0.4488856792449951
local_output_nid generation:  0.029905319213867188
local_in_edges_tensor generation:  0.03249073028564453
mini_batch_src_global generation:  0.0552978515625
r_  generation:  0.45798182487487793
local_output_nid generation:  0.029954910278320312
local_in_edges_tensor generation:  0.029822349548339844
mini_batch_src_global generation:  0.051749467849731445
r_  generation:  0.44776201248168945
local_output_nid generation:  0.02985548973083496
local_in_edges_tensor generation:  0.029094934463500977
mini_batch_src_global generation:  0.05247044563293457
r_  generation:  0.4565119743347168
local_output_nid generation:  0.030376911163330078
local_in_edges_tensor generation:  0.036661624908447266
mini_batch_src_global generation:  0.0531313419342041
r_  generation:  0.4567148685455322
local_output_nid generation:  0.030389785766601562
local_in_edges_tensor generation:  0.037297964096069336
mini_batch_src_global generation:  0.052808284759521484
r_  generation:  0.45822763442993164
local_output_nid generation:  0.03040790557861328
local_in_edges_tensor generation:  0.03714561462402344
mini_batch_src_global generation:  0.05191612243652344
r_  generation:  0.4532620906829834
local_output_nid generation:  0.030925989151000977
local_in_edges_tensor generation:  0.039574384689331055
mini_batch_src_global generation:  0.05214834213256836
r_  generation:  0.48407435417175293
local_output_nid generation:  0.03298306465148926
local_in_edges_tensor generation:  0.043771982192993164
mini_batch_src_global generation:  0.05646848678588867
r_  generation:  0.45207762718200684
local_output_nid generation:  0.030829906463623047
local_in_edges_tensor generation:  0.03308391571044922
mini_batch_src_global generation:  0.05150794982910156
r_  generation:  0.4582946300506592
local_output_nid generation:  0.030851125717163086
local_in_edges_tensor generation:  0.03627610206604004
mini_batch_src_global generation:  0.05222153663635254
r_  generation:  0.44910597801208496
----------------------check_connections_block total spend ----------------------------- 10.698407411575317
generate_one_block  0.5683834552764893
generate_one_block  0.5841679573059082
generate_one_block  0.5631957054138184
generate_one_block  0.5708229541778564
generate_one_block  0.58400559425354
generate_one_block  0.5606997013092041
generate_one_block  0.6244218349456787
generate_one_block  0.5703778266906738
generate_one_block  0.570514440536499
generate_one_block  0.5805540084838867
generate_one_block  0.6393887996673584
generate_one_block  0.6079213619232178
generate_one_block  0.5818040370941162
generate_one_block  0.5994136333465576
generate_one_block  0.598543643951416
generate_one_block  0.6093542575836182
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  15.571492671966553
block generation total time  13.69448471069336
average batch blocks generation time:  0.855905294418335
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1756591796875 GB
    Memory Allocated: 0.09060049057006836  GigaBytes
Max Memory Allocated: 0.09060049057006836  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1678466796875 GB
    Memory Allocated: 0.715519905090332  GigaBytes
Max Memory Allocated: 0.7527828216552734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4530029296875 GB
    Memory Allocated: 0.09181594848632812  GigaBytes
Max Memory Allocated: 0.7940621376037598  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4530029296875 GB
    Memory Allocated: 0.7184324264526367  GigaBytes
Max Memory Allocated: 0.7940621376037598  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5701904296875 GB
    Memory Allocated: 0.09212207794189453  GigaBytes
Max Memory Allocated: 0.7981047630310059  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5701904296875 GB
    Memory Allocated: 0.71343994140625  GigaBytes
Max Memory Allocated: 0.7981047630310059  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5701904296875 GB
    Memory Allocated: 0.09167337417602539  GigaBytes
Max Memory Allocated: 0.7981047630310059  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5701904296875 GB
    Memory Allocated: 0.7147326469421387  GigaBytes
Max Memory Allocated: 0.7981047630310059  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5701904296875 GB
    Memory Allocated: 0.09229469299316406  GigaBytes
Max Memory Allocated: 0.7981047630310059  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0487060546875 GB
    Memory Allocated: 0.7188835144042969  GigaBytes
Max Memory Allocated: 0.7981047630310059  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.09163618087768555  GigaBytes
Max Memory Allocated: 0.7981324195861816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.7157354354858398  GigaBytes
Max Memory Allocated: 0.7981324195861816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.09237957000732422  GigaBytes
Max Memory Allocated: 0.7981324195861816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.71783447265625  GigaBytes
Max Memory Allocated: 0.7981324195861816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.09152889251708984  GigaBytes
Max Memory Allocated: 0.7981324195861816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.7134132385253906  GigaBytes
Max Memory Allocated: 0.7981324195861816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.09218502044677734  GigaBytes
Max Memory Allocated: 0.7981324195861816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.7152314186096191  GigaBytes
Max Memory Allocated: 0.7981324195861816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.0917820930480957  GigaBytes
Max Memory Allocated: 0.7981324195861816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.7144479751586914  GigaBytes
Max Memory Allocated: 0.7981324195861816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.0922689437866211  GigaBytes
Max Memory Allocated: 0.7981324195861816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.7161993980407715  GigaBytes
Max Memory Allocated: 0.7981324195861816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.0917520523071289  GigaBytes
Max Memory Allocated: 0.7981324195861816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.7214221954345703  GigaBytes
Max Memory Allocated: 0.7981324195861816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.09226799011230469  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.7158613204956055  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.09160852432250977  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.7151327133178711  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.09226322174072266  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.7161850929260254  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.09172916412353516  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.715939998626709  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06054079532623291 |0.03493143618106842 |0.04951363801956177 |9.88394021987915e-05 |0.006908968091011047 |0.0027844905853271484 |
----------------------------------------------------------pseudo_mini_loss sum 6.253016948699951
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5090885
Number of first layer input nodes during this epoch:  2471247
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.1153111457824707  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018001317977905273
range selection method range initialization spend 0.011449813842773438
time for parepare:  0.017598867416381836
local_output_nid generation:  0.0013589859008789062
local_in_edges_tensor generation:  0.0042285919189453125
mini_batch_src_global generation:  0.0017116069793701172
r_  generation:  0.017696142196655273
local_output_nid generation:  0.001519918441772461
local_in_edges_tensor generation:  0.0009527206420898438
mini_batch_src_global generation:  0.002066373825073242
r_  generation:  0.01815056800842285
local_output_nid generation:  0.0015423297882080078
local_in_edges_tensor generation:  0.0008568763732910156
mini_batch_src_global generation:  0.0013790130615234375
r_  generation:  0.018649816513061523
local_output_nid generation:  0.0016427040100097656
local_in_edges_tensor generation:  0.0009276866912841797
mini_batch_src_global generation:  0.0013310909271240234
r_  generation:  0.01809406280517578
local_output_nid generation:  0.0015823841094970703
local_in_edges_tensor generation:  0.0008475780487060547
mini_batch_src_global generation:  0.0013608932495117188
r_  generation:  0.018456220626831055
local_output_nid generation:  0.0015630722045898438
local_in_edges_tensor generation:  0.0008742809295654297
mini_batch_src_global generation:  0.0013997554779052734
r_  generation:  0.018890380859375
local_output_nid generation:  0.00154876708984375
local_in_edges_tensor generation:  0.0008563995361328125
mini_batch_src_global generation:  0.0014240741729736328
r_  generation:  0.018829345703125
local_output_nid generation:  0.0015788078308105469
local_in_edges_tensor generation:  0.0008304119110107422
mini_batch_src_global generation:  0.0013895034790039062
r_  generation:  0.01863718032836914
local_output_nid generation:  0.001554250717163086
local_in_edges_tensor generation:  0.0008924007415771484
mini_batch_src_global generation:  0.0013740062713623047
r_  generation:  0.018719196319580078
local_output_nid generation:  0.001505136489868164
local_in_edges_tensor generation:  0.0008232593536376953
mini_batch_src_global generation:  0.0014274120330810547
r_  generation:  0.019264698028564453
local_output_nid generation:  0.0015940666198730469
local_in_edges_tensor generation:  0.0008263587951660156
mini_batch_src_global generation:  0.0014505386352539062
r_  generation:  0.019065380096435547
local_output_nid generation:  0.00153350830078125
local_in_edges_tensor generation:  0.0008287429809570312
mini_batch_src_global generation:  0.0014567375183105469
r_  generation:  0.019331693649291992
local_output_nid generation:  0.0016193389892578125
local_in_edges_tensor generation:  0.0008602142333984375
mini_batch_src_global generation:  0.0014863014221191406
r_  generation:  0.019532442092895508
local_output_nid generation:  0.0016489028930664062
local_in_edges_tensor generation:  0.0008654594421386719
mini_batch_src_global generation:  0.0014972686767578125
r_  generation:  0.01966094970703125
local_output_nid generation:  0.0016019344329833984
local_in_edges_tensor generation:  0.0008494853973388672
mini_batch_src_global generation:  0.0014753341674804688
r_  generation:  0.019356489181518555
local_output_nid generation:  0.003785371780395508
local_in_edges_tensor generation:  0.0009353160858154297
mini_batch_src_global generation:  0.0014786720275878906
r_  generation:  0.019163131713867188
----------------------check_connections_block total spend ----------------------------- 0.4572169780731201
generate_one_block  0.0309293270111084
generate_one_block  0.028325557708740234
generate_one_block  0.028122663497924805
generate_one_block  0.02769327163696289
generate_one_block  0.027331113815307617
generate_one_block  0.028850555419921875
generate_one_block  0.02975773811340332
generate_one_block  0.026485681533813477
generate_one_block  0.0271303653717041
generate_one_block  0.030650615692138672
generate_one_block  0.02768707275390625
generate_one_block  0.027756214141845703
generate_one_block  0.02783203125
generate_one_block  0.0314486026763916
generate_one_block  0.028872013092041016
generate_one_block  0.02794957160949707
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.051970481872558594
gen group dst list time:  0.019455909729003906
time for parepare:  0.020780563354492188
local_output_nid generation:  0.00671696662902832
local_in_edges_tensor generation:  0.028195858001708984
mini_batch_src_global generation:  0.02172088623046875
r_  generation:  0.19035935401916504
local_output_nid generation:  0.0097808837890625
local_in_edges_tensor generation:  0.017459630966186523
mini_batch_src_global generation:  0.02359485626220703
r_  generation:  0.2024250030517578
local_output_nid generation:  0.010798454284667969
local_in_edges_tensor generation:  0.01636052131652832
mini_batch_src_global generation:  0.02337932586669922
r_  generation:  0.21040987968444824
local_output_nid generation:  0.010945796966552734
local_in_edges_tensor generation:  0.01247406005859375
mini_batch_src_global generation:  0.02411365509033203
r_  generation:  0.20546460151672363
local_output_nid generation:  0.01082611083984375
local_in_edges_tensor generation:  0.012767553329467773
mini_batch_src_global generation:  0.026593446731567383
r_  generation:  0.2186429500579834
local_output_nid generation:  0.01073598861694336
local_in_edges_tensor generation:  0.011377334594726562
mini_batch_src_global generation:  0.02535557746887207
r_  generation:  0.20523333549499512
local_output_nid generation:  0.010636329650878906
local_in_edges_tensor generation:  0.012892723083496094
mini_batch_src_global generation:  0.02588057518005371
r_  generation:  0.20751667022705078
local_output_nid generation:  0.010598182678222656
local_in_edges_tensor generation:  0.011230707168579102
mini_batch_src_global generation:  0.02549600601196289
r_  generation:  0.2031879425048828
local_output_nid generation:  0.010952949523925781
local_in_edges_tensor generation:  0.021989107131958008
mini_batch_src_global generation:  0.026442766189575195
r_  generation:  0.22375750541687012
local_output_nid generation:  0.01427602767944336
local_in_edges_tensor generation:  0.01831841468811035
mini_batch_src_global generation:  0.02822709083557129
r_  generation:  0.2105867862701416
local_output_nid generation:  0.011298656463623047
local_in_edges_tensor generation:  0.013669013977050781
mini_batch_src_global generation:  0.025740385055541992
r_  generation:  0.2056124210357666
local_output_nid generation:  0.011705160140991211
local_in_edges_tensor generation:  0.014963150024414062
mini_batch_src_global generation:  0.027587890625
r_  generation:  0.21111178398132324
local_output_nid generation:  0.011673450469970703
local_in_edges_tensor generation:  0.016977548599243164
mini_batch_src_global generation:  0.026644229888916016
r_  generation:  0.21416258811950684
local_output_nid generation:  0.011665105819702148
local_in_edges_tensor generation:  0.013744115829467773
mini_batch_src_global generation:  0.04259800910949707
r_  generation:  0.2091665267944336
local_output_nid generation:  0.011516332626342773
local_in_edges_tensor generation:  0.013329744338989258
mini_batch_src_global generation:  0.028249263763427734
r_  generation:  0.22054100036621094
local_output_nid generation:  0.011542797088623047
local_in_edges_tensor generation:  0.012011051177978516
mini_batch_src_global generation:  0.026343584060668945
r_  generation:  0.20946764945983887
----------------------check_connections_block total spend ----------------------------- 4.963569641113281
generate_one_block  0.2759971618652344
generate_one_block  0.2766125202178955
generate_one_block  0.2891726493835449
generate_one_block  0.2656588554382324
generate_one_block  0.2661607265472412
generate_one_block  0.2633247375488281
generate_one_block  0.2943851947784424
generate_one_block  0.2597620487213135
generate_one_block  0.26375246047973633
generate_one_block  0.2770042419433594
generate_one_block  0.2652618885040283
generate_one_block  0.27156519889831543
generate_one_block  0.2890815734863281
generate_one_block  0.2686195373535156
generate_one_block  0.2731449604034424
generate_one_block  0.2672762870788574
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.07620906829833984
gen group dst list time:  0.059351444244384766
time for parepare:  0.01805400848388672
local_output_nid generation:  0.023115158081054688
local_in_edges_tensor generation:  0.04780697822570801
mini_batch_src_global generation:  0.04396390914916992
r_  generation:  0.43372297286987305
local_output_nid generation:  0.02857685089111328
local_in_edges_tensor generation:  0.044302940368652344
mini_batch_src_global generation:  0.05054759979248047
r_  generation:  0.43863964080810547
local_output_nid generation:  0.02897191047668457
local_in_edges_tensor generation:  0.03883504867553711
mini_batch_src_global generation:  0.04970669746398926
r_  generation:  0.44576168060302734
local_output_nid generation:  0.02968573570251465
local_in_edges_tensor generation:  0.03242349624633789
mini_batch_src_global generation:  0.054262399673461914
r_  generation:  0.44735264778137207
local_output_nid generation:  0.029994964599609375
local_in_edges_tensor generation:  0.07377099990844727
mini_batch_src_global generation:  0.054116010665893555
r_  generation:  0.4776618480682373
local_output_nid generation:  0.03398323059082031
local_in_edges_tensor generation:  0.043517112731933594
mini_batch_src_global generation:  0.05530858039855957
r_  generation:  0.4496309757232666
local_output_nid generation:  0.03069472312927246
local_in_edges_tensor generation:  0.03403353691101074
mini_batch_src_global generation:  0.054886579513549805
r_  generation:  0.4522264003753662
local_output_nid generation:  0.030858993530273438
local_in_edges_tensor generation:  0.02903270721435547
mini_batch_src_global generation:  0.05278635025024414
r_  generation:  0.44843053817749023
local_output_nid generation:  0.0307924747467041
local_in_edges_tensor generation:  0.03344559669494629
mini_batch_src_global generation:  0.05144047737121582
r_  generation:  0.4553399085998535
local_output_nid generation:  0.03096747398376465
local_in_edges_tensor generation:  0.037660837173461914
mini_batch_src_global generation:  0.05238699913024902
r_  generation:  0.4509866237640381
local_output_nid generation:  0.030608654022216797
local_in_edges_tensor generation:  0.029378414154052734
mini_batch_src_global generation:  0.051937103271484375
r_  generation:  0.4539802074432373
local_output_nid generation:  0.03122091293334961
local_in_edges_tensor generation:  0.03314375877380371
mini_batch_src_global generation:  0.07229900360107422
r_  generation:  0.4488074779510498
local_output_nid generation:  0.031171560287475586
local_in_edges_tensor generation:  0.04535055160522461
mini_batch_src_global generation:  0.05164599418640137
r_  generation:  0.4611170291900635
local_output_nid generation:  0.03180551528930664
local_in_edges_tensor generation:  0.042676687240600586
mini_batch_src_global generation:  0.0524907112121582
r_  generation:  0.45035219192504883
local_output_nid generation:  0.030942678451538086
local_in_edges_tensor generation:  0.028069257736206055
mini_batch_src_global generation:  0.05155444145202637
r_  generation:  0.45558953285217285
local_output_nid generation:  0.03092479705810547
local_in_edges_tensor generation:  0.02798175811767578
mini_batch_src_global generation:  0.05229687690734863
r_  generation:  0.4532160758972168
----------------------check_connections_block total spend ----------------------------- 10.760759592056274
generate_one_block  0.5740184783935547
generate_one_block  0.6020748615264893
generate_one_block  0.5706887245178223
generate_one_block  0.5739803314208984
generate_one_block  0.5755269527435303
generate_one_block  0.5619246959686279
generate_one_block  0.5627181529998779
generate_one_block  0.5692102909088135
generate_one_block  0.6019091606140137
generate_one_block  0.5820331573486328
generate_one_block  0.5630362033843994
generate_one_block  0.5679941177368164
generate_one_block  0.5916256904602051
generate_one_block  0.5781981945037842
generate_one_block  0.5731868743896484
generate_one_block  0.5643713474273682
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.1153111457824707  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

connection checking time:  15.724329233169556
block generation total time  13.579277276992798
average batch blocks generation time:  0.8487048298120499
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.09396696090698242  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.7195758819580078  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09333181381225586  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7170319557189941  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09401702880859375  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.720646858215332  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09333562850952148  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7163071632385254  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09387397766113281  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7180356979370117  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0931096076965332  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7127413749694824  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0938568115234375  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7162017822265625  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09323501586914062  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7137980461120605  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09384536743164062  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7170352935791016  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09356832504272461  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7215533256530762  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09373283386230469  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7105770111083984  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09322977066040039  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.719024658203125  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09407329559326172  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7225503921508789  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0933065414428711  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7175202369689941  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09397315979003906  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7193217277526855  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09316778182983398  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7152872085571289  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05551311373710632 |0.011096686124801636 |0.0036665797233581543 |8.924305438995361e-05 |0.006630107760429382 |0.0013930797576904297 |
----------------------------------------------------------pseudo_mini_loss sum 3.242194175720215
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5088426
Number of first layer input nodes during this epoch:  2470754
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11489009857177734  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022294044494628906
range selection method range initialization spend 0.01210331916809082
time for parepare:  0.01669001579284668
local_output_nid generation:  0.0013895034790039062
local_in_edges_tensor generation:  0.006155729293823242
mini_batch_src_global generation:  0.0015971660614013672
r_  generation:  0.018407583236694336
local_output_nid generation:  0.0015704631805419922
local_in_edges_tensor generation:  0.0009429454803466797
mini_batch_src_global generation:  0.002247333526611328
r_  generation:  0.018924236297607422
local_output_nid generation:  0.0016031265258789062
local_in_edges_tensor generation:  0.0009205341339111328
mini_batch_src_global generation:  0.0014071464538574219
r_  generation:  0.018576383590698242
local_output_nid generation:  0.0015308856964111328
local_in_edges_tensor generation:  0.0009131431579589844
mini_batch_src_global generation:  0.0013785362243652344
r_  generation:  0.01873183250427246
local_output_nid generation:  0.001565694808959961
local_in_edges_tensor generation:  0.0009570121765136719
mini_batch_src_global generation:  0.0014519691467285156
r_  generation:  0.019026994705200195
local_output_nid generation:  0.0016148090362548828
local_in_edges_tensor generation:  0.0009131431579589844
mini_batch_src_global generation:  0.0014688968658447266
r_  generation:  0.03314638137817383
local_output_nid generation:  0.002016305923461914
local_in_edges_tensor generation:  0.0011229515075683594
mini_batch_src_global generation:  0.0016181468963623047
r_  generation:  0.01949453353881836
local_output_nid generation:  0.0019605159759521484
local_in_edges_tensor generation:  0.0010199546813964844
mini_batch_src_global generation:  0.0014226436614990234
r_  generation:  0.01880168914794922
local_output_nid generation:  0.0019102096557617188
local_in_edges_tensor generation:  0.0010149478912353516
mini_batch_src_global generation:  0.001520395278930664
r_  generation:  0.019255399703979492
local_output_nid generation:  0.0018718242645263672
local_in_edges_tensor generation:  0.0009770393371582031
mini_batch_src_global generation:  0.0015628337860107422
r_  generation:  0.01929950714111328
local_output_nid generation:  0.0018091201782226562
local_in_edges_tensor generation:  0.000972747802734375
mini_batch_src_global generation:  0.0015423297882080078
r_  generation:  0.019554615020751953
local_output_nid generation:  0.001817941665649414
local_in_edges_tensor generation:  0.0010139942169189453
mini_batch_src_global generation:  0.0016155242919921875
r_  generation:  0.019800186157226562
local_output_nid generation:  0.0017709732055664062
local_in_edges_tensor generation:  0.0009872913360595703
mini_batch_src_global generation:  0.001600027084350586
r_  generation:  0.019201040267944336
local_output_nid generation:  0.0017285346984863281
local_in_edges_tensor generation:  0.0009794235229492188
mini_batch_src_global generation:  0.0015861988067626953
r_  generation:  0.019666671752929688
local_output_nid generation:  0.0018038749694824219
local_in_edges_tensor generation:  0.0009746551513671875
mini_batch_src_global generation:  0.0015897750854492188
r_  generation:  0.01919865608215332
local_output_nid generation:  0.0017786026000976562
local_in_edges_tensor generation:  0.0009899139404296875
mini_batch_src_global generation:  0.001577615737915039
r_  generation:  0.019155025482177734
----------------------check_connections_block total spend ----------------------------- 0.4837973117828369
generate_one_block  0.04064130783081055
generate_one_block  0.028866052627563477
generate_one_block  0.027530670166015625
generate_one_block  0.027975797653198242
generate_one_block  0.028023481369018555
generate_one_block  0.030885934829711914
generate_one_block  0.03161215782165527
generate_one_block  0.029556751251220703
generate_one_block  0.04326272010803223
generate_one_block  0.034154415130615234
generate_one_block  0.027991056442260742
generate_one_block  0.028242111206054688
generate_one_block  0.027967453002929688
generate_one_block  0.028077125549316406
generate_one_block  0.027655601501464844
generate_one_block  0.028051137924194336
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03410935401916504
gen group dst list time:  0.016911745071411133
time for parepare:  0.019106626510620117
local_output_nid generation:  0.0066907405853271484
local_in_edges_tensor generation:  0.022641420364379883
mini_batch_src_global generation:  0.01968526840209961
r_  generation:  0.1937267780303955
local_output_nid generation:  0.010202884674072266
local_in_edges_tensor generation:  0.012663602828979492
mini_batch_src_global generation:  0.02413153648376465
r_  generation:  0.2017498016357422
local_output_nid generation:  0.010677814483642578
local_in_edges_tensor generation:  0.01242375373840332
mini_batch_src_global generation:  0.022996902465820312
r_  generation:  0.2063584327697754
local_output_nid generation:  0.010921239852905273
local_in_edges_tensor generation:  0.017111778259277344
mini_batch_src_global generation:  0.02427840232849121
r_  generation:  0.2303633689880371
local_output_nid generation:  0.011382818222045898
local_in_edges_tensor generation:  0.015961885452270508
mini_batch_src_global generation:  0.026740074157714844
r_  generation:  0.21623945236206055
local_output_nid generation:  0.01105642318725586
local_in_edges_tensor generation:  0.017073392868041992
mini_batch_src_global generation:  0.025517940521240234
r_  generation:  0.21899914741516113
local_output_nid generation:  0.012411832809448242
local_in_edges_tensor generation:  0.010960102081298828
mini_batch_src_global generation:  0.028598546981811523
r_  generation:  0.22292494773864746
local_output_nid generation:  0.013776302337646484
local_in_edges_tensor generation:  0.013344764709472656
mini_batch_src_global generation:  0.025670528411865234
r_  generation:  0.20760703086853027
local_output_nid generation:  0.012021780014038086
local_in_edges_tensor generation:  0.011762380599975586
mini_batch_src_global generation:  0.025969266891479492
r_  generation:  0.2146914005279541
local_output_nid generation:  0.01160287857055664
local_in_edges_tensor generation:  0.012952804565429688
mini_batch_src_global generation:  0.026528120040893555
r_  generation:  0.214738130569458
local_output_nid generation:  0.011427879333496094
local_in_edges_tensor generation:  0.011320352554321289
mini_batch_src_global generation:  0.026067495346069336
r_  generation:  0.21230673789978027
local_output_nid generation:  0.011789560317993164
local_in_edges_tensor generation:  0.01173710823059082
mini_batch_src_global generation:  0.02765345573425293
r_  generation:  0.21811747550964355
local_output_nid generation:  0.011443138122558594
local_in_edges_tensor generation:  0.01162576675415039
mini_batch_src_global generation:  0.0379180908203125
r_  generation:  0.21590614318847656
local_output_nid generation:  0.01166081428527832
local_in_edges_tensor generation:  0.011731386184692383
mini_batch_src_global generation:  0.027606487274169922
r_  generation:  0.21479558944702148
local_output_nid generation:  0.011664867401123047
local_in_edges_tensor generation:  0.012466669082641602
mini_batch_src_global generation:  0.029432296752929688
r_  generation:  0.2124309539794922
local_output_nid generation:  0.013701438903808594
local_in_edges_tensor generation:  0.011588335037231445
mini_batch_src_global generation:  0.02683258056640625
r_  generation:  0.21413397789001465
----------------------check_connections_block total spend ----------------------------- 5.027427434921265
generate_one_block  0.2806670665740967
generate_one_block  0.2742154598236084
generate_one_block  0.27060699462890625
generate_one_block  0.2724926471710205
generate_one_block  0.27761387825012207
generate_one_block  0.26897716522216797
generate_one_block  0.29250168800354004
generate_one_block  0.2745354175567627
generate_one_block  0.2730898857116699
generate_one_block  0.2718772888183594
generate_one_block  0.2662217617034912
generate_one_block  0.27406930923461914
generate_one_block  0.2631106376647949
generate_one_block  0.26894569396972656
generate_one_block  0.2622370719909668
generate_one_block  0.2648482322692871
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04186534881591797
gen group dst list time:  0.06664872169494629
time for parepare:  0.018895864486694336
local_output_nid generation:  0.02413320541381836
local_in_edges_tensor generation:  0.054944515228271484
mini_batch_src_global generation:  0.04402756690979004
r_  generation:  0.43834996223449707
local_output_nid generation:  0.028595447540283203
local_in_edges_tensor generation:  0.04038524627685547
mini_batch_src_global generation:  0.05143380165100098
r_  generation:  0.44741368293762207
local_output_nid generation:  0.029893159866333008
local_in_edges_tensor generation:  0.03142881393432617
mini_batch_src_global generation:  0.0505375862121582
r_  generation:  0.45070958137512207
local_output_nid generation:  0.029537439346313477
local_in_edges_tensor generation:  0.03239274024963379
mini_batch_src_global generation:  0.05219602584838867
r_  generation:  0.45400285720825195
local_output_nid generation:  0.02977752685546875
local_in_edges_tensor generation:  0.0862131118774414
mini_batch_src_global generation:  0.05160832405090332
r_  generation:  0.46381258964538574
local_output_nid generation:  0.02995014190673828
local_in_edges_tensor generation:  0.03421640396118164
mini_batch_src_global generation:  0.05270051956176758
r_  generation:  0.45896148681640625
local_output_nid generation:  0.029880285263061523
local_in_edges_tensor generation:  0.041275978088378906
mini_batch_src_global generation:  0.05298423767089844
r_  generation:  0.46088385581970215
local_output_nid generation:  0.03056955337524414
local_in_edges_tensor generation:  0.03395199775695801
mini_batch_src_global generation:  0.06978392601013184
r_  generation:  0.4745304584503174
local_output_nid generation:  0.03535199165344238
local_in_edges_tensor generation:  0.03142738342285156
mini_batch_src_global generation:  0.05592775344848633
r_  generation:  0.45798397064208984
local_output_nid generation:  0.03166937828063965
local_in_edges_tensor generation:  0.03480243682861328
mini_batch_src_global generation:  0.05322694778442383
r_  generation:  0.45362091064453125
local_output_nid generation:  0.03186440467834473
local_in_edges_tensor generation:  0.03151679039001465
mini_batch_src_global generation:  0.05157113075256348
r_  generation:  0.45909571647644043
local_output_nid generation:  0.03215599060058594
local_in_edges_tensor generation:  0.03184676170349121
mini_batch_src_global generation:  0.05569314956665039
r_  generation:  0.4603264331817627
local_output_nid generation:  0.03144645690917969
local_in_edges_tensor generation:  0.030633211135864258
mini_batch_src_global generation:  0.05123281478881836
r_  generation:  0.4687669277191162
local_output_nid generation:  0.03223705291748047
local_in_edges_tensor generation:  0.030472517013549805
mini_batch_src_global generation:  0.05402708053588867
r_  generation:  0.45725083351135254
local_output_nid generation:  0.03211665153503418
local_in_edges_tensor generation:  0.03398895263671875
mini_batch_src_global generation:  0.051405906677246094
r_  generation:  0.4563889503479004
local_output_nid generation:  0.03240346908569336
local_in_edges_tensor generation:  0.032933712005615234
mini_batch_src_global generation:  0.05227255821228027
r_  generation:  0.4523191452026367
----------------------check_connections_block total spend ----------------------------- 10.866705894470215
generate_one_block  0.5802836418151855
generate_one_block  0.5840601921081543
generate_one_block  0.5727934837341309
generate_one_block  0.5767266750335693
generate_one_block  0.5877726078033447
generate_one_block  0.5781576633453369
generate_one_block  0.5789766311645508
generate_one_block  0.5727002620697021
generate_one_block  0.6504764556884766
generate_one_block  0.5896017551422119
generate_one_block  0.5695388317108154
generate_one_block  0.5979702472686768
generate_one_block  0.5771007537841797
generate_one_block  0.5826709270477295
generate_one_block  0.5767972469329834
generate_one_block  0.5661277770996094
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11489009857177734  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

connection checking time:  15.89413332939148
block generation total time  13.697765350341797
average batch blocks generation time:  0.8561103343963623
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09395742416381836  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.718231201171875  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09338712692260742  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7192535400390625  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09388160705566406  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7181315422058105  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09341716766357422  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7180380821228027  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09398841857910156  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7194714546203613  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09321212768554688  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7157497406005859  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09385395050048828  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7162289619445801  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09309959411621094  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7112460136413574  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09392642974853516  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7196769714355469  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09338951110839844  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7190799713134766  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09386348724365234  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7171115875244141  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09348154067993164  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7235069274902344  GigaBytes
Max Memory Allocated: 0.8022279739379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09380626678466797  GigaBytes
Max Memory Allocated: 0.8042850494384766  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7161736488342285  GigaBytes
Max Memory Allocated: 0.8042850494384766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0931553840637207  GigaBytes
Max Memory Allocated: 0.8042850494384766  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7178492546081543  GigaBytes
Max Memory Allocated: 0.8042850494384766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09380054473876953  GigaBytes
Max Memory Allocated: 0.8042850494384766  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7160053253173828  GigaBytes
Max Memory Allocated: 0.8042850494384766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09324789047241211  GigaBytes
Max Memory Allocated: 0.8042850494384766  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7154874801635742  GigaBytes
Max Memory Allocated: 0.8042850494384766  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06029751896858215 |0.012250661849975586 |0.003416895866394043 |9.171664714813232e-05 |0.003198370337486267 |0.0014543533325195312 |
----------------------------------------------------------pseudo_mini_loss sum 2.61094331741333
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  5089262
Number of first layer input nodes during this epoch:  2469744
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11491680145263672  GigaBytes
Max Memory Allocated: 0.8042850494384766  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021723031997680664
range selection method range initialization spend 0.012299776077270508
time for parepare:  0.017492294311523438
local_output_nid generation:  0.001409292221069336
local_in_edges_tensor generation:  0.006355762481689453
mini_batch_src_global generation:  0.001516580581665039
r_  generation:  0.018294572830200195
local_output_nid generation:  0.0015423297882080078
local_in_edges_tensor generation:  0.0009365081787109375
mini_batch_src_global generation:  0.001848459243774414
r_  generation:  0.019281625747680664
local_output_nid generation:  0.0015206336975097656
local_in_edges_tensor generation:  0.0008852481842041016
mini_batch_src_global generation:  0.001422882080078125
r_  generation:  0.018697738647460938
local_output_nid generation:  0.0016591548919677734
local_in_edges_tensor generation:  0.0008840560913085938
mini_batch_src_global generation:  0.0013935565948486328
r_  generation:  0.01914048194885254
local_output_nid generation:  0.0015628337860107422
local_in_edges_tensor generation:  0.0009315013885498047
mini_batch_src_global generation:  0.001476287841796875
r_  generation:  0.018786907196044922
local_output_nid generation:  0.001538991928100586
local_in_edges_tensor generation:  0.0008804798126220703
mini_batch_src_global generation:  0.0014748573303222656
r_  generation:  0.018883466720581055
local_output_nid generation:  0.001558542251586914
local_in_edges_tensor generation:  0.0008790493011474609
mini_batch_src_global generation:  0.0015065670013427734
r_  generation:  0.019077301025390625
local_output_nid generation:  0.0015459060668945312
local_in_edges_tensor generation:  0.0008707046508789062
mini_batch_src_global generation:  0.001470804214477539
r_  generation:  0.019351482391357422
local_output_nid generation:  0.0015323162078857422
local_in_edges_tensor generation:  0.0008676052093505859
mini_batch_src_global generation:  0.0015230178833007812
r_  generation:  0.019313812255859375
local_output_nid generation:  0.0015282630920410156
local_in_edges_tensor generation:  0.0008642673492431641
mini_batch_src_global generation:  0.0015053749084472656
r_  generation:  0.02000117301940918
local_output_nid generation:  0.001558065414428711
local_in_edges_tensor generation:  0.0008699893951416016
mini_batch_src_global generation:  0.0015082359313964844
r_  generation:  0.019574880599975586
local_output_nid generation:  0.0015337467193603516
local_in_edges_tensor generation:  0.00086212158203125
mini_batch_src_global generation:  0.0015759468078613281
r_  generation:  0.0194854736328125
local_output_nid generation:  0.0015234947204589844
local_in_edges_tensor generation:  0.0008671283721923828
mini_batch_src_global generation:  0.001523733139038086
r_  generation:  0.01942896842956543
local_output_nid generation:  0.0015282630920410156
local_in_edges_tensor generation:  0.0008652210235595703
mini_batch_src_global generation:  0.0015289783477783203
r_  generation:  0.019984960556030273
local_output_nid generation:  0.0015347003936767578
local_in_edges_tensor generation:  0.0008935928344726562
mini_batch_src_global generation:  0.0015180110931396484
r_  generation:  0.01935887336730957
local_output_nid generation:  0.0015485286712646484
local_in_edges_tensor generation:  0.0009741783142089844
mini_batch_src_global generation:  0.001462697982788086
r_  generation:  0.019635438919067383
----------------------check_connections_block total spend ----------------------------- 0.46498775482177734
generate_one_block  0.026971817016601562
generate_one_block  0.02823925018310547
generate_one_block  0.027526378631591797
generate_one_block  0.028071165084838867
generate_one_block  0.028204679489135742
generate_one_block  0.029701709747314453
generate_one_block  0.02767324447631836
generate_one_block  0.0278928279876709
generate_one_block  0.027884721755981445
generate_one_block  0.028504133224487305
generate_one_block  0.027692556381225586
generate_one_block  0.027486324310302734
generate_one_block  0.027899742126464844
generate_one_block  0.02858281135559082
generate_one_block  0.02830028533935547
generate_one_block  0.028428316116333008
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03617525100708008
gen group dst list time:  0.016889095306396484
time for parepare:  0.01960587501525879
local_output_nid generation:  0.006877899169921875
local_in_edges_tensor generation:  0.020171165466308594
mini_batch_src_global generation:  0.019417524337768555
r_  generation:  0.18946242332458496
local_output_nid generation:  0.010345935821533203
local_in_edges_tensor generation:  0.013709068298339844
mini_batch_src_global generation:  0.02545475959777832
r_  generation:  0.20227956771850586
local_output_nid generation:  0.010553359985351562
local_in_edges_tensor generation:  0.012639284133911133
mini_batch_src_global generation:  0.023336410522460938
r_  generation:  0.20521235466003418
local_output_nid generation:  0.01124882698059082
local_in_edges_tensor generation:  0.01153254508972168
mini_batch_src_global generation:  0.02467036247253418
r_  generation:  0.21147990226745605
local_output_nid generation:  0.011478900909423828
local_in_edges_tensor generation:  0.0117645263671875
mini_batch_src_global generation:  0.024746417999267578
r_  generation:  0.20500421524047852
local_output_nid generation:  0.01146388053894043
local_in_edges_tensor generation:  0.011240482330322266
mini_batch_src_global generation:  0.027678489685058594
r_  generation:  0.20740771293640137
local_output_nid generation:  0.011674642562866211
local_in_edges_tensor generation:  0.011140823364257812
mini_batch_src_global generation:  0.04056096076965332
r_  generation:  0.21211671829223633
local_output_nid generation:  0.012295722961425781
local_in_edges_tensor generation:  0.01132965087890625
mini_batch_src_global generation:  0.026292085647583008
r_  generation:  0.21217775344848633
local_output_nid generation:  0.013730764389038086
local_in_edges_tensor generation:  0.012166738510131836
mini_batch_src_global generation:  0.027118682861328125
r_  generation:  0.21232056617736816
local_output_nid generation:  0.012610197067260742
local_in_edges_tensor generation:  0.012887001037597656
mini_batch_src_global generation:  0.026889562606811523
r_  generation:  0.21696066856384277
local_output_nid generation:  0.012230634689331055
local_in_edges_tensor generation:  0.013374567031860352
mini_batch_src_global generation:  0.026395320892333984
r_  generation:  0.21483469009399414
local_output_nid generation:  0.011838912963867188
local_in_edges_tensor generation:  0.012732744216918945
mini_batch_src_global generation:  0.02703070640563965
r_  generation:  0.21756601333618164
local_output_nid generation:  0.011864662170410156
local_in_edges_tensor generation:  0.011722087860107422
mini_batch_src_global generation:  0.026730060577392578
r_  generation:  0.21811556816101074
local_output_nid generation:  0.011761188507080078
local_in_edges_tensor generation:  0.012756586074829102
mini_batch_src_global generation:  0.027607202529907227
r_  generation:  0.21640348434448242
local_output_nid generation:  0.011989831924438477
local_in_edges_tensor generation:  0.011931180953979492
mini_batch_src_global generation:  0.026396512985229492
r_  generation:  0.21337389945983887
local_output_nid generation:  0.011857032775878906
local_in_edges_tensor generation:  0.01168203353881836
mini_batch_src_global generation:  0.0263674259185791
r_  generation:  0.2132878303527832
----------------------check_connections_block total spend ----------------------------- 4.942659854888916
generate_one_block  0.2695183753967285
generate_one_block  0.26487064361572266
generate_one_block  0.26630473136901855
generate_one_block  0.27069592475891113
generate_one_block  0.25784778594970703
generate_one_block  0.26035380363464355
generate_one_block  0.28547000885009766
generate_one_block  0.2711060047149658
generate_one_block  0.2630653381347656
generate_one_block  0.2735557556152344
generate_one_block  0.27089953422546387
generate_one_block  0.26842761039733887
generate_one_block  0.2706334590911865
generate_one_block  0.26894450187683105
generate_one_block  0.2694833278656006
generate_one_block  0.2673299312591553
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0353550910949707
gen group dst list time:  0.06016850471496582
time for parepare:  0.017908573150634766
local_output_nid generation:  0.024593591690063477
local_in_edges_tensor generation:  0.04266095161437988
mini_batch_src_global generation:  0.04209399223327637
r_  generation:  0.43657970428466797
local_output_nid generation:  0.032501935958862305
local_in_edges_tensor generation:  0.036210060119628906
mini_batch_src_global generation:  0.05329728126525879
r_  generation:  0.4428596496582031
local_output_nid generation:  0.02991962432861328
local_in_edges_tensor generation:  0.034102439880371094
mini_batch_src_global generation:  0.04998373985290527
r_  generation:  0.44902706146240234
local_output_nid generation:  0.0300295352935791
local_in_edges_tensor generation:  0.03242921829223633
mini_batch_src_global generation:  0.051956892013549805
r_  generation:  0.45002269744873047
local_output_nid generation:  0.029921770095825195
local_in_edges_tensor generation:  0.07105231285095215
mini_batch_src_global generation:  0.050909996032714844
r_  generation:  0.45170021057128906
local_output_nid generation:  0.030124664306640625
local_in_edges_tensor generation:  0.029799222946166992
mini_batch_src_global generation:  0.052132368087768555
r_  generation:  0.4496302604675293
local_output_nid generation:  0.030392885208129883
local_in_edges_tensor generation:  0.034139156341552734
mini_batch_src_global generation:  0.051149845123291016
r_  generation:  0.45662689208984375
local_output_nid generation:  0.03037714958190918
local_in_edges_tensor generation:  0.032137393951416016
mini_batch_src_global generation:  0.0533442497253418
r_  generation:  0.4482741355895996
local_output_nid generation:  0.03058624267578125
local_in_edges_tensor generation:  0.030390024185180664
mini_batch_src_global generation:  0.05179190635681152
r_  generation:  0.4551389217376709
local_output_nid generation:  0.03127479553222656
local_in_edges_tensor generation:  0.03611564636230469
mini_batch_src_global generation:  0.05443239212036133
r_  generation:  0.4570465087890625
local_output_nid generation:  0.030761003494262695
local_in_edges_tensor generation:  0.03008294105529785
mini_batch_src_global generation:  0.05295419692993164
r_  generation:  0.4618196487426758
local_output_nid generation:  0.030416011810302734
local_in_edges_tensor generation:  0.02930474281311035
mini_batch_src_global generation:  0.05341601371765137
r_  generation:  0.4500386714935303
local_output_nid generation:  0.03211164474487305
local_in_edges_tensor generation:  0.029593229293823242
mini_batch_src_global generation:  0.052262306213378906
r_  generation:  0.4597656726837158
local_output_nid generation:  0.030582666397094727
local_in_edges_tensor generation:  0.035837650299072266
mini_batch_src_global generation:  0.053351640701293945
r_  generation:  0.4522993564605713
local_output_nid generation:  0.03097677230834961
local_in_edges_tensor generation:  0.03357672691345215
mini_batch_src_global generation:  0.05365252494812012
r_  generation:  0.46026158332824707
local_output_nid generation:  0.030896902084350586
local_in_edges_tensor generation:  0.02966928482055664
mini_batch_src_global generation:  0.053240060806274414
r_  generation:  0.45958995819091797
----------------------check_connections_block total spend ----------------------------- 10.709759950637817
generate_one_block  0.5677030086517334
generate_one_block  0.5770444869995117
generate_one_block  0.5732758045196533
generate_one_block  0.574059247970581
generate_one_block  0.5697112083435059
generate_one_block  0.5667910575866699
generate_one_block  0.5745844841003418
generate_one_block  0.5782670974731445
generate_one_block  0.6045150756835938
generate_one_block  0.5803160667419434
generate_one_block  0.5744898319244385
generate_one_block  0.5675501823425293
generate_one_block  0.5759274959564209
generate_one_block  0.5827033519744873
generate_one_block  0.57761549949646
generate_one_block  0.5701546669006348
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11491680145263672  GigaBytes
Max Memory Allocated: 0.8042850494384766  GigaBytes

connection checking time:  15.652419805526733
block generation total time  13.51321530342102
average batch blocks generation time:  0.8445759564638138
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0938267707824707  GigaBytes
Max Memory Allocated: 0.8042850494384766  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.712806224822998  GigaBytes
Max Memory Allocated: 0.8042850494384766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09342718124389648  GigaBytes
Max Memory Allocated: 0.8042850494384766  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7188601493835449  GigaBytes
Max Memory Allocated: 0.8042850494384766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09391403198242188  GigaBytes
Max Memory Allocated: 0.8042850494384766  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7180538177490234  GigaBytes
Max Memory Allocated: 0.8042850494384766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09360265731811523  GigaBytes
Max Memory Allocated: 0.8042850494384766  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7212963104248047  GigaBytes
Max Memory Allocated: 0.8042850494384766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0937032699584961  GigaBytes
Max Memory Allocated: 0.8042850494384766  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7117323875427246  GigaBytes
Max Memory Allocated: 0.8042850494384766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0933070182800293  GigaBytes
Max Memory Allocated: 0.8042850494384766  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7158946990966797  GigaBytes
Max Memory Allocated: 0.8042850494384766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09382915496826172  GigaBytes
Max Memory Allocated: 0.8042850494384766  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7164301872253418  GigaBytes
Max Memory Allocated: 0.8042850494384766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0931844711303711  GigaBytes
Max Memory Allocated: 0.8042850494384766  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.716392993927002  GigaBytes
Max Memory Allocated: 0.8042850494384766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.093841552734375  GigaBytes
Max Memory Allocated: 0.8042850494384766  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7179241180419922  GigaBytes
Max Memory Allocated: 0.8042850494384766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09367609024047852  GigaBytes
Max Memory Allocated: 0.8042850494384766  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.725316047668457  GigaBytes
Max Memory Allocated: 0.8042850494384766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09398174285888672  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7186160087585449  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0934605598449707  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7177839279174805  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09396839141845703  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7199201583862305  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0934896469116211  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7183585166931152  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09395503997802734  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7182440757751465  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09318780899047852  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.716644287109375  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06164570152759552 |0.01152433454990387 |0.003690868616104126 |9.223818778991699e-05 |0.005292460322380066 |0.0029435157775878906 |
----------------------------------------------------------pseudo_mini_loss sum 2.357964515686035
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  5095237
Number of first layer input nodes during this epoch:  2473295
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11500740051269531  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021828413009643555
range selection method range initialization spend 0.013121843338012695
time for parepare:  0.01688981056213379
local_output_nid generation:  0.0013918876647949219
local_in_edges_tensor generation:  0.0031833648681640625
mini_batch_src_global generation:  0.0016047954559326172
r_  generation:  0.018723249435424805
local_output_nid generation:  0.001580953598022461
local_in_edges_tensor generation:  0.0009365081787109375
mini_batch_src_global generation:  0.0017457008361816406
r_  generation:  0.019224882125854492
local_output_nid generation:  0.001512765884399414
local_in_edges_tensor generation:  0.0008854866027832031
mini_batch_src_global generation:  0.0015032291412353516
r_  generation:  0.01922321319580078
local_output_nid generation:  0.0015492439270019531
local_in_edges_tensor generation:  0.0008883476257324219
mini_batch_src_global generation:  0.0014424324035644531
r_  generation:  0.0185699462890625
local_output_nid generation:  0.0015854835510253906
local_in_edges_tensor generation:  0.0008997917175292969
mini_batch_src_global generation:  0.0015349388122558594
r_  generation:  0.01930093765258789
local_output_nid generation:  0.0015492439270019531
local_in_edges_tensor generation:  0.0008890628814697266
mini_batch_src_global generation:  0.0015301704406738281
r_  generation:  0.019264936447143555
local_output_nid generation:  0.0015573501586914062
local_in_edges_tensor generation:  0.0008833408355712891
mini_batch_src_global generation:  0.0015323162078857422
r_  generation:  0.019418954849243164
local_output_nid generation:  0.0015895366668701172
local_in_edges_tensor generation:  0.0008866786956787109
mini_batch_src_global generation:  0.0015347003936767578
r_  generation:  0.01937699317932129
local_output_nid generation:  0.001566171646118164
local_in_edges_tensor generation:  0.000881195068359375
mini_batch_src_global generation:  0.001528024673461914
r_  generation:  0.019636154174804688
local_output_nid generation:  0.0015676021575927734
local_in_edges_tensor generation:  0.0009055137634277344
mini_batch_src_global generation:  0.0015895366668701172
r_  generation:  0.01975250244140625
local_output_nid generation:  0.0015997886657714844
local_in_edges_tensor generation:  0.0009088516235351562
mini_batch_src_global generation:  0.0015611648559570312
r_  generation:  0.01930713653564453
local_output_nid generation:  0.0015499591827392578
local_in_edges_tensor generation:  0.0008623600006103516
mini_batch_src_global generation:  0.0015637874603271484
r_  generation:  0.019847393035888672
local_output_nid generation:  0.0015871524810791016
local_in_edges_tensor generation:  0.0009202957153320312
mini_batch_src_global generation:  0.0015401840209960938
r_  generation:  0.019415616989135742
local_output_nid generation:  0.0015311241149902344
local_in_edges_tensor generation:  0.0009472370147705078
mini_batch_src_global generation:  0.0015292167663574219
r_  generation:  0.019361257553100586
local_output_nid generation:  0.0015535354614257812
local_in_edges_tensor generation:  0.0008921623229980469
mini_batch_src_global generation:  0.0015294551849365234
r_  generation:  0.019135236740112305
local_output_nid generation:  0.0015556812286376953
local_in_edges_tensor generation:  0.0009012222290039062
mini_batch_src_global generation:  0.0015540122985839844
r_  generation:  0.019613027572631836
----------------------check_connections_block total spend ----------------------------- 0.46349477767944336
generate_one_block  0.0274200439453125
generate_one_block  0.027956247329711914
generate_one_block  0.028079986572265625
generate_one_block  0.0273895263671875
generate_one_block  0.028172016143798828
generate_one_block  0.02994847297668457
generate_one_block  0.0279386043548584
generate_one_block  0.028113126754760742
generate_one_block  0.028437376022338867
generate_one_block  0.028005599975585938
generate_one_block  0.0277557373046875
generate_one_block  0.028136730194091797
generate_one_block  0.027677059173583984
generate_one_block  0.02819371223449707
generate_one_block  0.027688264846801758
generate_one_block  0.02840900421142578
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03315472602844238
gen group dst list time:  0.016649723052978516
time for parepare:  0.0192410945892334
local_output_nid generation:  0.0068645477294921875
local_in_edges_tensor generation:  0.015733957290649414
mini_batch_src_global generation:  0.019007205963134766
r_  generation:  0.19656848907470703
local_output_nid generation:  0.010844707489013672
local_in_edges_tensor generation:  0.01313161849975586
mini_batch_src_global generation:  0.025679349899291992
r_  generation:  0.19972538948059082
local_output_nid generation:  0.010830402374267578
local_in_edges_tensor generation:  0.011866331100463867
mini_batch_src_global generation:  0.0233917236328125
r_  generation:  0.20666122436523438
local_output_nid generation:  0.010792016983032227
local_in_edges_tensor generation:  0.010994434356689453
mini_batch_src_global generation:  0.023876667022705078
r_  generation:  0.202101469039917
local_output_nid generation:  0.011472940444946289
local_in_edges_tensor generation:  0.01096796989440918
mini_batch_src_global generation:  0.02629542350769043
r_  generation:  0.21210217475891113
local_output_nid generation:  0.011630773544311523
local_in_edges_tensor generation:  0.011055946350097656
mini_batch_src_global generation:  0.02555680274963379
r_  generation:  0.21068716049194336
local_output_nid generation:  0.011630773544311523
local_in_edges_tensor generation:  0.013473749160766602
mini_batch_src_global generation:  0.026319503784179688
r_  generation:  0.21094012260437012
local_output_nid generation:  0.011908292770385742
local_in_edges_tensor generation:  0.012234210968017578
mini_batch_src_global generation:  0.02606511116027832
r_  generation:  0.21289801597595215
local_output_nid generation:  0.01206827163696289
local_in_edges_tensor generation:  0.012286663055419922
mini_batch_src_global generation:  0.027202129364013672
r_  generation:  0.21506118774414062
local_output_nid generation:  0.011972427368164062
local_in_edges_tensor generation:  0.011478900909423828
mini_batch_src_global generation:  0.026320219039916992
r_  generation:  0.21236157417297363
local_output_nid generation:  0.011947393417358398
local_in_edges_tensor generation:  0.011057376861572266
mini_batch_src_global generation:  0.02713632583618164
r_  generation:  0.21164703369140625
local_output_nid generation:  0.011508941650390625
local_in_edges_tensor generation:  0.01122593879699707
mini_batch_src_global generation:  0.0264894962310791
r_  generation:  0.2160036563873291
local_output_nid generation:  0.011304140090942383
local_in_edges_tensor generation:  0.01236581802368164
mini_batch_src_global generation:  0.030839920043945312
r_  generation:  0.2121584415435791
local_output_nid generation:  0.011383295059204102
local_in_edges_tensor generation:  0.0124053955078125
mini_batch_src_global generation:  0.026790857315063477
r_  generation:  0.2176222801208496
local_output_nid generation:  0.011327266693115234
local_in_edges_tensor generation:  0.013375043869018555
mini_batch_src_global generation:  0.029984712600708008
r_  generation:  0.21445322036743164
local_output_nid generation:  0.012574195861816406
local_in_edges_tensor generation:  0.011955738067626953
mini_batch_src_global generation:  0.03190279006958008
r_  generation:  0.21533656120300293
----------------------check_connections_block total spend ----------------------------- 4.9201133251190186
generate_one_block  0.27063846588134766
generate_one_block  0.2641756534576416
generate_one_block  0.2723710536956787
generate_one_block  0.26039695739746094
generate_one_block  0.2733333110809326
generate_one_block  0.2636454105377197
generate_one_block  0.2931234836578369
generate_one_block  0.28018617630004883
generate_one_block  0.275219202041626
generate_one_block  0.2655651569366455
generate_one_block  0.26384735107421875
generate_one_block  0.2791910171508789
generate_one_block  0.2686939239501953
generate_one_block  0.2729794979095459
generate_one_block  0.26634836196899414
generate_one_block  0.270733118057251
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02999281883239746
gen group dst list time:  0.059848785400390625
time for parepare:  0.016959190368652344
local_output_nid generation:  0.02399921417236328
local_in_edges_tensor generation:  0.05549216270446777
mini_batch_src_global generation:  0.04250502586364746
r_  generation:  0.4399995803833008
local_output_nid generation:  0.029774188995361328
local_in_edges_tensor generation:  0.03464102745056152
mini_batch_src_global generation:  0.05161786079406738
r_  generation:  0.4443943500518799
local_output_nid generation:  0.029776334762573242
local_in_edges_tensor generation:  0.028723478317260742
mini_batch_src_global generation:  0.05042266845703125
r_  generation:  0.44984889030456543
local_output_nid generation:  0.0299835205078125
local_in_edges_tensor generation:  0.028556346893310547
mini_batch_src_global generation:  0.05352187156677246
r_  generation:  0.44705772399902344
local_output_nid generation:  0.030182600021362305
local_in_edges_tensor generation:  0.06967782974243164
mini_batch_src_global generation:  0.05274701118469238
r_  generation:  0.45256567001342773
local_output_nid generation:  0.030206918716430664
local_in_edges_tensor generation:  0.030776023864746094
mini_batch_src_global generation:  0.05428123474121094
r_  generation:  0.4509427547454834
local_output_nid generation:  0.030269622802734375
local_in_edges_tensor generation:  0.028820037841796875
mini_batch_src_global generation:  0.051560401916503906
r_  generation:  0.45291686058044434
local_output_nid generation:  0.032113075256347656
local_in_edges_tensor generation:  0.03481459617614746
mini_batch_src_global generation:  0.05253481864929199
r_  generation:  0.4527266025543213
local_output_nid generation:  0.030804872512817383
local_in_edges_tensor generation:  0.032013654708862305
mini_batch_src_global generation:  0.05182695388793945
r_  generation:  0.4580376148223877
local_output_nid generation:  0.030770301818847656
local_in_edges_tensor generation:  0.030918359756469727
mini_batch_src_global generation:  0.05323910713195801
r_  generation:  0.4514455795288086
local_output_nid generation:  0.030872106552124023
local_in_edges_tensor generation:  0.030710935592651367
mini_batch_src_global generation:  0.05178046226501465
r_  generation:  0.4569580554962158
local_output_nid generation:  0.030696630477905273
local_in_edges_tensor generation:  0.033475637435913086
mini_batch_src_global generation:  0.05260157585144043
r_  generation:  0.454296350479126
local_output_nid generation:  0.03055572509765625
local_in_edges_tensor generation:  0.028683900833129883
mini_batch_src_global generation:  0.051302433013916016
r_  generation:  0.45601463317871094
local_output_nid generation:  0.030754566192626953
local_in_edges_tensor generation:  0.029122591018676758
mini_batch_src_global generation:  0.05317211151123047
r_  generation:  0.4555211067199707
local_output_nid generation:  0.0306699275970459
local_in_edges_tensor generation:  0.030755281448364258
mini_batch_src_global generation:  0.05169534683227539
r_  generation:  0.4568049907684326
local_output_nid generation:  0.03065943717956543
local_in_edges_tensor generation:  0.03068709373474121
mini_batch_src_global generation:  0.05288362503051758
r_  generation:  0.4537370204925537
----------------------check_connections_block total spend ----------------------------- 10.6825532913208
generate_one_block  0.5695042610168457
generate_one_block  0.5700440406799316
generate_one_block  0.5681829452514648
generate_one_block  0.569878101348877
generate_one_block  0.5751044750213623
generate_one_block  0.5746042728424072
generate_one_block  0.5747988224029541
generate_one_block  0.577782154083252
generate_one_block  0.6362133026123047
generate_one_block  0.5696065425872803
generate_one_block  0.5727760791778564
generate_one_block  0.5796072483062744
generate_one_block  0.5721399784088135
generate_one_block  0.583197832107544
generate_one_block  0.5792474746704102
generate_one_block  0.5776913166046143
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11500740051269531  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

connection checking time:  15.60266661643982
block generation total time  13.590826988220215
average batch blocks generation time:  0.8494266867637634
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09395360946655273  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.71942138671875  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0934286117553711  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.715705394744873  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09394359588623047  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7205324172973633  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09311485290527344  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7111477851867676  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09395122528076172  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7190055847167969  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09320545196533203  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7163009643554688  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0938863754272461  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7168726921081543  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09339570999145508  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7177505493164062  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09399986267089844  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7198514938354492  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09332752227783203  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7172188758850098  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0938262939453125  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7172155380249023  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09340715408325195  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7193846702575684  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0938405990600586  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.716883659362793  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09357070922851562  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7211570739746094  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09387874603271484  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7170672416687012  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09326362609863281  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7168498039245605  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05879233777523041 |0.009282469749450684 |0.0034946203231811523 |9.156763553619385e-05 |0.003172144293785095 |0.0030486583709716797 |
----------------------------------------------------------pseudo_mini_loss sum 2.098151206970215
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  5092172
Number of first layer input nodes during this epoch:  2471664
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.1151432991027832  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02022409439086914
range selection method range initialization spend 0.012326717376708984
time for parepare:  0.01826310157775879
local_output_nid generation:  0.0014486312866210938
local_in_edges_tensor generation:  0.0032808780670166016
mini_batch_src_global generation:  0.0015141963958740234
r_  generation:  0.018067359924316406
local_output_nid generation:  0.001567840576171875
local_in_edges_tensor generation:  0.0010089874267578125
mini_batch_src_global generation:  0.001771688461303711
r_  generation:  0.01966571807861328
local_output_nid generation:  0.0015606880187988281
local_in_edges_tensor generation:  0.0009100437164306641
mini_batch_src_global generation:  0.0015027523040771484
r_  generation:  0.019639968872070312
local_output_nid generation:  0.0015881061553955078
local_in_edges_tensor generation:  0.0009250640869140625
mini_batch_src_global generation:  0.0014982223510742188
r_  generation:  0.018807172775268555
local_output_nid generation:  0.0015740394592285156
local_in_edges_tensor generation:  0.0008902549743652344
mini_batch_src_global generation:  0.001476287841796875
r_  generation:  0.019191503524780273
local_output_nid generation:  0.0015559196472167969
local_in_edges_tensor generation:  0.0008766651153564453
mini_batch_src_global generation:  0.0014705657958984375
r_  generation:  0.019542217254638672
local_output_nid generation:  0.0015654563903808594
local_in_edges_tensor generation:  0.0009005069732666016
mini_batch_src_global generation:  0.0015137195587158203
r_  generation:  0.019744157791137695
local_output_nid generation:  0.0015912055969238281
local_in_edges_tensor generation:  0.0008957386016845703
mini_batch_src_global generation:  0.0015568733215332031
r_  generation:  0.01979660987854004
local_output_nid generation:  0.0015976428985595703
local_in_edges_tensor generation:  0.0009076595306396484
mini_batch_src_global generation:  0.001558065414428711
r_  generation:  0.019209861755371094
local_output_nid generation:  0.0015518665313720703
local_in_edges_tensor generation:  0.0008807182312011719
mini_batch_src_global generation:  0.0014412403106689453
r_  generation:  0.019340991973876953
local_output_nid generation:  0.0015726089477539062
local_in_edges_tensor generation:  0.0008718967437744141
mini_batch_src_global generation:  0.0015189647674560547
r_  generation:  0.019622325897216797
local_output_nid generation:  0.0015583038330078125
local_in_edges_tensor generation:  0.0008666515350341797
mini_batch_src_global generation:  0.0014939308166503906
r_  generation:  0.019433021545410156
local_output_nid generation:  0.0015578269958496094
local_in_edges_tensor generation:  0.000965118408203125
mini_batch_src_global generation:  0.0014793872833251953
r_  generation:  0.019507408142089844
local_output_nid generation:  0.0016102790832519531
local_in_edges_tensor generation:  0.0008435249328613281
mini_batch_src_global generation:  0.0014672279357910156
r_  generation:  0.019197702407836914
local_output_nid generation:  0.0015625953674316406
local_in_edges_tensor generation:  0.0008537769317626953
mini_batch_src_global generation:  0.0015001296997070312
r_  generation:  0.019703388214111328
local_output_nid generation:  0.0016484260559082031
local_in_edges_tensor generation:  0.0008568763732910156
mini_batch_src_global generation:  0.001514434814453125
r_  generation:  0.01945662498474121
----------------------check_connections_block total spend ----------------------------- 0.46367359161376953
generate_one_block  0.02710866928100586
generate_one_block  0.028227567672729492
generate_one_block  0.028174400329589844
generate_one_block  0.027909040451049805
generate_one_block  0.027545928955078125
generate_one_block  0.030137062072753906
generate_one_block  0.027989625930786133
generate_one_block  0.0279543399810791
generate_one_block  0.027495861053466797
generate_one_block  0.027692794799804688
generate_one_block  0.02768993377685547
generate_one_block  0.027619600296020508
generate_one_block  0.027671098709106445
generate_one_block  0.027637958526611328
generate_one_block  0.028493642807006836
generate_one_block  0.03096914291381836
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03536033630371094
gen group dst list time:  0.01617121696472168
time for parepare:  0.019587993621826172
local_output_nid generation:  0.006594657897949219
local_in_edges_tensor generation:  0.016637802124023438
mini_batch_src_global generation:  0.01954483985900879
r_  generation:  0.18587088584899902
local_output_nid generation:  0.009958267211914062
local_in_edges_tensor generation:  0.014099836349487305
mini_batch_src_global generation:  0.027144193649291992
r_  generation:  0.2005770206451416
local_output_nid generation:  0.01040339469909668
local_in_edges_tensor generation:  0.012795448303222656
mini_batch_src_global generation:  0.02814030647277832
r_  generation:  0.20978188514709473
local_output_nid generation:  0.011094093322753906
local_in_edges_tensor generation:  0.01616501808166504
mini_batch_src_global generation:  0.028121232986450195
r_  generation:  0.20720171928405762
local_output_nid generation:  0.011278152465820312
local_in_edges_tensor generation:  0.014420270919799805
mini_batch_src_global generation:  0.02519989013671875
r_  generation:  0.20739412307739258
local_output_nid generation:  0.011672735214233398
local_in_edges_tensor generation:  0.012439966201782227
mini_batch_src_global generation:  0.02593231201171875
r_  generation:  0.2117633819580078
local_output_nid generation:  0.011448144912719727
local_in_edges_tensor generation:  0.011142730712890625
mini_batch_src_global generation:  0.025812864303588867
r_  generation:  0.20795202255249023
local_output_nid generation:  0.011777877807617188
local_in_edges_tensor generation:  0.011463165283203125
mini_batch_src_global generation:  0.026187658309936523
r_  generation:  0.21253299713134766
local_output_nid generation:  0.011637449264526367
local_in_edges_tensor generation:  0.012185096740722656
mini_batch_src_global generation:  0.027149200439453125
r_  generation:  0.20999836921691895
local_output_nid generation:  0.0116119384765625
local_in_edges_tensor generation:  0.010945320129394531
mini_batch_src_global generation:  0.025800466537475586
r_  generation:  0.20885944366455078
local_output_nid generation:  0.01154017448425293
local_in_edges_tensor generation:  0.012178659439086914
mini_batch_src_global generation:  0.02689528465270996
r_  generation:  0.21378707885742188
local_output_nid generation:  0.01167154312133789
local_in_edges_tensor generation:  0.011244058609008789
mini_batch_src_global generation:  0.02593541145324707
r_  generation:  0.21045804023742676
local_output_nid generation:  0.011404991149902344
local_in_edges_tensor generation:  0.011407136917114258
mini_batch_src_global generation:  0.025913238525390625
r_  generation:  0.2070634365081787
local_output_nid generation:  0.011215686798095703
local_in_edges_tensor generation:  0.011599302291870117
mini_batch_src_global generation:  0.02614426612854004
r_  generation:  0.20926713943481445
local_output_nid generation:  0.011346817016601562
local_in_edges_tensor generation:  0.01325845718383789
mini_batch_src_global generation:  0.0271756649017334
r_  generation:  0.21385526657104492
local_output_nid generation:  0.011136054992675781
local_in_edges_tensor generation:  0.011518716812133789
mini_batch_src_global generation:  0.026067495346069336
r_  generation:  0.20840191841125488
----------------------check_connections_block total spend ----------------------------- 4.874831676483154
generate_one_block  0.25934910774230957
generate_one_block  0.2684135437011719
generate_one_block  0.2765035629272461
generate_one_block  0.26529741287231445
generate_one_block  0.26772618293762207
generate_one_block  0.2701127529144287
generate_one_block  0.2833695411682129
generate_one_block  0.271587610244751
generate_one_block  0.2679283618927002
generate_one_block  0.2689540386199951
generate_one_block  0.2656373977661133
generate_one_block  0.2677266597747803
generate_one_block  0.2581367492675781
generate_one_block  0.26543450355529785
generate_one_block  0.26987719535827637
generate_one_block  0.26313233375549316
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03407001495361328
gen group dst list time:  0.06214499473571777
time for parepare:  0.018939733505249023
local_output_nid generation:  0.023608922958374023
local_in_edges_tensor generation:  0.04422807693481445
mini_batch_src_global generation:  0.051578521728515625
r_  generation:  0.46349167823791504
local_output_nid generation:  0.03141307830810547
local_in_edges_tensor generation:  0.03867077827453613
mini_batch_src_global generation:  0.05301070213317871
r_  generation:  0.4535191059112549
local_output_nid generation:  0.030945301055908203
local_in_edges_tensor generation:  0.03287649154663086
mini_batch_src_global generation:  0.05151557922363281
r_  generation:  0.4589564800262451
local_output_nid generation:  0.03179335594177246
local_in_edges_tensor generation:  0.030763626098632812
mini_batch_src_global generation:  0.0530858039855957
r_  generation:  0.45446228981018066
local_output_nid generation:  0.033690690994262695
local_in_edges_tensor generation:  0.08031725883483887
mini_batch_src_global generation:  0.053655385971069336
r_  generation:  0.46346378326416016
local_output_nid generation:  0.031758785247802734
local_in_edges_tensor generation:  0.0286865234375
mini_batch_src_global generation:  0.05284571647644043
r_  generation:  0.4585909843444824
local_output_nid generation:  0.031380414962768555
local_in_edges_tensor generation:  0.032887935638427734
mini_batch_src_global generation:  0.054917335510253906
r_  generation:  0.4651627540588379
local_output_nid generation:  0.03361344337463379
local_in_edges_tensor generation:  0.03848695755004883
mini_batch_src_global generation:  0.05559515953063965
r_  generation:  0.46647214889526367
local_output_nid generation:  0.031096696853637695
local_in_edges_tensor generation:  0.03317999839782715
mini_batch_src_global generation:  0.05401730537414551
r_  generation:  0.47354650497436523
local_output_nid generation:  0.033261775970458984
local_in_edges_tensor generation:  0.031670570373535156
mini_batch_src_global generation:  0.05511975288391113
r_  generation:  0.45635199546813965
local_output_nid generation:  0.03363752365112305
local_in_edges_tensor generation:  0.03004932403564453
mini_batch_src_global generation:  0.05201220512390137
r_  generation:  0.4765055179595947
local_output_nid generation:  0.031554222106933594
local_in_edges_tensor generation:  0.029492616653442383
mini_batch_src_global generation:  0.052892208099365234
r_  generation:  0.45563650131225586
local_output_nid generation:  0.0314640998840332
local_in_edges_tensor generation:  0.03504037857055664
mini_batch_src_global generation:  0.05194449424743652
r_  generation:  0.4618053436279297
local_output_nid generation:  0.033583879470825195
local_in_edges_tensor generation:  0.031938791275024414
mini_batch_src_global generation:  0.05472993850708008
r_  generation:  0.45615530014038086
local_output_nid generation:  0.03193473815917969
local_in_edges_tensor generation:  0.03485679626464844
mini_batch_src_global generation:  0.05418515205383301
r_  generation:  0.4606335163116455
local_output_nid generation:  0.031867265701293945
local_in_edges_tensor generation:  0.029491186141967773
mini_batch_src_global generation:  0.052884817123413086
r_  generation:  0.4565141201019287
----------------------check_connections_block total spend ----------------------------- 10.961631298065186
generate_one_block  0.5927798748016357
generate_one_block  0.5819902420043945
generate_one_block  0.5950243473052979
generate_one_block  0.5869753360748291
generate_one_block  0.5775835514068604
generate_one_block  0.5774104595184326
generate_one_block  0.5699870586395264
generate_one_block  0.5791027545928955
generate_one_block  0.6064441204071045
generate_one_block  0.5870988368988037
generate_one_block  0.5950231552124023
generate_one_block  0.572145938873291
generate_one_block  0.5809707641601562
generate_one_block  0.577143669128418
generate_one_block  0.5790133476257324
generate_one_block  0.5748381614685059
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.1151432991027832  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

connection checking time:  15.83646297454834
block generation total time  13.622718572616577
average batch blocks generation time:  0.8514199107885361
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09376192092895508  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7117414474487305  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09332895278930664  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7170238494873047  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09409523010253906  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7214593887329102  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09351873397827148  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7181248664855957  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09390544891357422  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.718785285949707  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09358501434326172  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7210278511047363  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09381866455078125  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.716637134552002  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09344720840454102  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7193989753723145  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09387779235839844  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7163801193237305  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09330224990844727  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.717559814453125  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09389305114746094  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7180523872375488  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09322500228881836  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7159910202026367  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09374332427978516  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7160806655883789  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09322547912597656  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7165374755859375  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0939493179321289  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7216882705688477  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09323692321777344  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7154502868652344  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06238998472690582 |0.011581942439079285 |0.003568410873413086 |9.235739707946777e-05 |0.0036857426166534424 |0.003141641616821289 |
----------------------------------------------------------pseudo_mini_loss sum 1.9516079425811768
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  5091491
Number of first layer input nodes during this epoch:  2471506
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11495256423950195  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02466583251953125
range selection method range initialization spend 0.01198577880859375
time for parepare:  0.017688512802124023
local_output_nid generation:  0.0014421939849853516
local_in_edges_tensor generation:  0.006714344024658203
mini_batch_src_global generation:  0.0015749931335449219
r_  generation:  0.018620014190673828
local_output_nid generation:  0.0015835762023925781
local_in_edges_tensor generation:  0.0009284019470214844
mini_batch_src_global generation:  0.001827239990234375
r_  generation:  0.019707918167114258
local_output_nid generation:  0.0015645027160644531
local_in_edges_tensor generation:  0.0009262561798095703
mini_batch_src_global generation:  0.001497030258178711
r_  generation:  0.018929243087768555
local_output_nid generation:  0.0016160011291503906
local_in_edges_tensor generation:  0.0009343624114990234
mini_batch_src_global generation:  0.0014736652374267578
r_  generation:  0.018714189529418945
local_output_nid generation:  0.001560211181640625
local_in_edges_tensor generation:  0.0009484291076660156
mini_batch_src_global generation:  0.0014450550079345703
r_  generation:  0.019083023071289062
local_output_nid generation:  0.0015807151794433594
local_in_edges_tensor generation:  0.0009169578552246094
mini_batch_src_global generation:  0.0015180110931396484
r_  generation:  0.019002199172973633
local_output_nid generation:  0.0015401840209960938
local_in_edges_tensor generation:  0.0009105205535888672
mini_batch_src_global generation:  0.0015130043029785156
r_  generation:  0.019512653350830078
local_output_nid generation:  0.0016508102416992188
local_in_edges_tensor generation:  0.0009005069732666016
mini_batch_src_global generation:  0.0015072822570800781
r_  generation:  0.019490957260131836
local_output_nid generation:  0.0015711784362792969
local_in_edges_tensor generation:  0.0008845329284667969
mini_batch_src_global generation:  0.0015301704406738281
r_  generation:  0.0198366641998291
local_output_nid generation:  0.0015919208526611328
local_in_edges_tensor generation:  0.0009562969207763672
mini_batch_src_global generation:  0.00162506103515625
r_  generation:  0.019270896911621094
local_output_nid generation:  0.0015764236450195312
local_in_edges_tensor generation:  0.0009906291961669922
mini_batch_src_global generation:  0.0016732215881347656
r_  generation:  0.019761085510253906
local_output_nid generation:  0.0016245841979980469
local_in_edges_tensor generation:  0.0009126663208007812
mini_batch_src_global generation:  0.0015611648559570312
r_  generation:  0.019693613052368164
local_output_nid generation:  0.0015799999237060547
local_in_edges_tensor generation:  0.0009050369262695312
mini_batch_src_global generation:  0.0015103816986083984
r_  generation:  0.019608736038208008
local_output_nid generation:  0.0015535354614257812
local_in_edges_tensor generation:  0.0009036064147949219
mini_batch_src_global generation:  0.0015177726745605469
r_  generation:  0.01953411102294922
local_output_nid generation:  0.0015637874603271484
local_in_edges_tensor generation:  0.0009267330169677734
mini_batch_src_global generation:  0.0015444755554199219
r_  generation:  0.019630908966064453
local_output_nid generation:  0.00154876708984375
local_in_edges_tensor generation:  0.0009026527404785156
mini_batch_src_global generation:  0.001562356948852539
r_  generation:  0.019603729248046875
----------------------check_connections_block total spend ----------------------------- 0.4673030376434326
generate_one_block  0.027550220489501953
generate_one_block  0.02838897705078125
generate_one_block  0.027847766876220703
generate_one_block  0.02756810188293457
generate_one_block  0.0275270938873291
generate_one_block  0.029259681701660156
generate_one_block  0.027892112731933594
generate_one_block  0.027775049209594727
generate_one_block  0.02799057960510254
generate_one_block  0.027379274368286133
generate_one_block  0.028046846389770508
generate_one_block  0.027948617935180664
generate_one_block  0.02807307243347168
generate_one_block  0.02781820297241211
generate_one_block  0.027976512908935547
generate_one_block  0.028095483779907227
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.040967464447021484
gen group dst list time:  0.018741846084594727
time for parepare:  0.019905805587768555
local_output_nid generation:  0.0067691802978515625
local_in_edges_tensor generation:  0.05135703086853027
mini_batch_src_global generation:  0.020860910415649414
r_  generation:  0.2190842628479004
local_output_nid generation:  0.014237642288208008
local_in_edges_tensor generation:  0.01751852035522461
mini_batch_src_global generation:  0.02738022804260254
r_  generation:  0.2219233512878418
local_output_nid generation:  0.01259756088256836
local_in_edges_tensor generation:  0.01189279556274414
mini_batch_src_global generation:  0.024865150451660156
r_  generation:  0.21277832984924316
local_output_nid generation:  0.011516809463500977
local_in_edges_tensor generation:  0.011417150497436523
mini_batch_src_global generation:  0.025968551635742188
r_  generation:  0.2165355682373047
local_output_nid generation:  0.011870145797729492
local_in_edges_tensor generation:  0.011175870895385742
mini_batch_src_global generation:  0.02669501304626465
r_  generation:  0.22161197662353516
local_output_nid generation:  0.011900663375854492
local_in_edges_tensor generation:  0.014749288558959961
mini_batch_src_global generation:  0.028508663177490234
r_  generation:  0.2178177833557129
local_output_nid generation:  0.012139081954956055
local_in_edges_tensor generation:  0.011783599853515625
mini_batch_src_global generation:  0.028189420700073242
r_  generation:  0.2248220443725586
local_output_nid generation:  0.012159347534179688
local_in_edges_tensor generation:  0.012292623519897461
mini_batch_src_global generation:  0.02797389030456543
r_  generation:  0.22088003158569336
local_output_nid generation:  0.012367010116577148
local_in_edges_tensor generation:  0.011428356170654297
mini_batch_src_global generation:  0.02847123146057129
r_  generation:  0.22764015197753906
local_output_nid generation:  0.01207590103149414
local_in_edges_tensor generation:  0.011643648147583008
mini_batch_src_global generation:  0.028146982192993164
r_  generation:  0.2254962921142578
local_output_nid generation:  0.01245880126953125
local_in_edges_tensor generation:  0.01205897331237793
mini_batch_src_global generation:  0.028807401657104492
r_  generation:  0.23283147811889648
local_output_nid generation:  0.012208223342895508
local_in_edges_tensor generation:  0.012568950653076172
mini_batch_src_global generation:  0.028522014617919922
r_  generation:  0.22711443901062012
local_output_nid generation:  0.012432575225830078
local_in_edges_tensor generation:  0.015114068984985352
mini_batch_src_global generation:  0.029248714447021484
r_  generation:  0.23343253135681152
local_output_nid generation:  0.011889457702636719
local_in_edges_tensor generation:  0.012364864349365234
mini_batch_src_global generation:  0.028932809829711914
r_  generation:  0.22568750381469727
local_output_nid generation:  0.011803150177001953
local_in_edges_tensor generation:  0.011626720428466797
mini_batch_src_global generation:  0.028844833374023438
r_  generation:  0.23254084587097168
local_output_nid generation:  0.011903524398803711
local_in_edges_tensor generation:  0.011873960494995117
mini_batch_src_global generation:  0.03182697296142578
r_  generation:  0.22730612754821777
----------------------check_connections_block total spend ----------------------------- 5.275986194610596
generate_one_block  0.27643346786499023
generate_one_block  0.27309536933898926
generate_one_block  0.2721977233886719
generate_one_block  0.2733170986175537
generate_one_block  0.2729780673980713
generate_one_block  0.27079343795776367
generate_one_block  0.2984912395477295
generate_one_block  0.2726016044616699
generate_one_block  0.2760634422302246
generate_one_block  0.2695329189300537
generate_one_block  0.27381396293640137
generate_one_block  0.2708883285522461
generate_one_block  0.2741050720214844
generate_one_block  0.266038179397583
generate_one_block  0.2730731964111328
generate_one_block  0.26674318313598633
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03732013702392578
gen group dst list time:  0.06597590446472168
time for parepare:  0.020158767700195312
local_output_nid generation:  0.02526259422302246
local_in_edges_tensor generation:  0.05185437202453613
mini_batch_src_global generation:  0.04261326789855957
r_  generation:  0.44559168815612793
local_output_nid generation:  0.029720067977905273
local_in_edges_tensor generation:  0.03507184982299805
mini_batch_src_global generation:  0.051911354064941406
r_  generation:  0.44904661178588867
local_output_nid generation:  0.030455827713012695
local_in_edges_tensor generation:  0.031201601028442383
mini_batch_src_global generation:  0.07418680191040039
r_  generation:  0.4580368995666504
local_output_nid generation:  0.030897140502929688
local_in_edges_tensor generation:  0.030416250228881836
mini_batch_src_global generation:  0.05208754539489746
r_  generation:  0.45833897590637207
local_output_nid generation:  0.03106403350830078
local_in_edges_tensor generation:  0.07571744918823242
mini_batch_src_global generation:  0.05167579650878906
r_  generation:  0.4610931873321533
local_output_nid generation:  0.03162527084350586
local_in_edges_tensor generation:  0.03081822395324707
mini_batch_src_global generation:  0.0526735782623291
r_  generation:  0.4564549922943115
local_output_nid generation:  0.03104543685913086
local_in_edges_tensor generation:  0.03317570686340332
mini_batch_src_global generation:  0.0536801815032959
r_  generation:  0.46000003814697266
local_output_nid generation:  0.030802488327026367
local_in_edges_tensor generation:  0.03364276885986328
mini_batch_src_global generation:  0.0522007942199707
r_  generation:  0.45610857009887695
local_output_nid generation:  0.030512332916259766
local_in_edges_tensor generation:  0.033441781997680664
mini_batch_src_global generation:  0.05378437042236328
r_  generation:  0.45909929275512695
local_output_nid generation:  0.0313572883605957
local_in_edges_tensor generation:  0.03743171691894531
mini_batch_src_global generation:  0.054430246353149414
r_  generation:  0.4709951877593994
local_output_nid generation:  0.03235912322998047
local_in_edges_tensor generation:  0.03083515167236328
mini_batch_src_global generation:  0.05557966232299805
r_  generation:  0.46486616134643555
local_output_nid generation:  0.03290438652038574
local_in_edges_tensor generation:  0.02982783317565918
mini_batch_src_global generation:  0.054679155349731445
r_  generation:  0.46306371688842773
local_output_nid generation:  0.0316462516784668
local_in_edges_tensor generation:  0.02866840362548828
mini_batch_src_global generation:  0.053345680236816406
r_  generation:  0.4586811065673828
local_output_nid generation:  0.03167319297790527
local_in_edges_tensor generation:  0.0296475887298584
mini_batch_src_global generation:  0.05249452590942383
r_  generation:  0.45824527740478516
local_output_nid generation:  0.03231620788574219
local_in_edges_tensor generation:  0.03139925003051758
mini_batch_src_global generation:  0.05170106887817383
r_  generation:  0.4856700897216797
local_output_nid generation:  0.03224015235900879
local_in_edges_tensor generation:  0.03241539001464844
mini_batch_src_global generation:  0.05263876914978027
r_  generation:  0.462998628616333
----------------------check_connections_block total spend ----------------------------- 10.893332719802856
generate_one_block  0.5808804035186768
generate_one_block  0.5754079818725586
generate_one_block  0.5789227485656738
generate_one_block  0.5812897682189941
generate_one_block  0.5758757591247559
generate_one_block  0.5763888359069824
generate_one_block  0.577561616897583
generate_one_block  0.5769064426422119
generate_one_block  0.6466848850250244
generate_one_block  0.5852298736572266
generate_one_block  0.5898933410644531
generate_one_block  0.5727369785308838
generate_one_block  0.5835103988647461
generate_one_block  0.5711236000061035
generate_one_block  0.5755393505096436
generate_one_block  0.5815353393554688
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11495256423950195  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

connection checking time:  16.169318914413452
block generation total time  13.709653615951538
average batch blocks generation time:  0.8568533509969711
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09384298324584961  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7169733047485352  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09337568283081055  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7182731628417969  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09389305114746094  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7177944183349609  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09343290328979492  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7187013626098633  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09391212463378906  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7184100151062012  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09327840805053711  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7159485816955566  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09393501281738281  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7179431915283203  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0933690071105957  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7171754837036133  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09393024444580078  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7175970077514648  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09330415725708008  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7144598960876465  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.093994140625  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7198748588562012  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09344148635864258  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7183103561401367  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09398365020751953  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7202162742614746  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09339570999145508  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7166194915771484  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.093994140625  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7204709053039551  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09339237213134766  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7173986434936523  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06317268311977386 |0.015679553151130676 |0.0036222338676452637 |9.423494338989258e-05 |0.0037133395671844482 |0.001909017562866211 |
----------------------------------------------------------pseudo_mini_loss sum 1.8720793724060059
 Run 0| Epoch 6 |
Number of nodes for computation during this epoch:  5095328
Number of first layer input nodes during this epoch:  2472907
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11516046524047852  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022640705108642578
range selection method range initialization spend 0.012086868286132812
time for parepare:  0.019283294677734375
local_output_nid generation:  0.0014109611511230469
local_in_edges_tensor generation:  0.007193326950073242
mini_batch_src_global generation:  0.0019838809967041016
r_  generation:  0.018491268157958984
local_output_nid generation:  0.0015902519226074219
local_in_edges_tensor generation:  0.0009512901306152344
mini_batch_src_global generation:  0.0019807815551757812
r_  generation:  0.0194699764251709
local_output_nid generation:  0.0015876293182373047
local_in_edges_tensor generation:  0.0009057521820068359
mini_batch_src_global generation:  0.0014598369598388672
r_  generation:  0.01869964599609375
local_output_nid generation:  0.0016086101531982422
local_in_edges_tensor generation:  0.0008962154388427734
mini_batch_src_global generation:  0.0014328956604003906
r_  generation:  0.018436193466186523
local_output_nid generation:  0.0016446113586425781
local_in_edges_tensor generation:  0.0009942054748535156
mini_batch_src_global generation:  0.0014986991882324219
r_  generation:  0.018956422805786133
local_output_nid generation:  0.0015673637390136719
local_in_edges_tensor generation:  0.0009105205535888672
mini_batch_src_global generation:  0.001478433609008789
r_  generation:  0.019112586975097656
local_output_nid generation:  0.001589059829711914
local_in_edges_tensor generation:  0.0008976459503173828
mini_batch_src_global generation:  0.0015270709991455078
r_  generation:  0.019509553909301758
local_output_nid generation:  0.001644134521484375
local_in_edges_tensor generation:  0.000865936279296875
mini_batch_src_global generation:  0.001516103744506836
r_  generation:  0.019271373748779297
local_output_nid generation:  0.0015578269958496094
local_in_edges_tensor generation:  0.0009045600891113281
mini_batch_src_global generation:  0.001516103744506836
r_  generation:  0.019451379776000977
local_output_nid generation:  0.001546621322631836
local_in_edges_tensor generation:  0.0008797645568847656
mini_batch_src_global generation:  0.001543283462524414
r_  generation:  0.01959967613220215
local_output_nid generation:  0.001543283462524414
local_in_edges_tensor generation:  0.0008823871612548828
mini_batch_src_global generation:  0.001512289047241211
r_  generation:  0.019505023956298828
local_output_nid generation:  0.0015974044799804688
local_in_edges_tensor generation:  0.0008764266967773438
mini_batch_src_global generation:  0.0015327930450439453
r_  generation:  0.019318819046020508
local_output_nid generation:  0.0015583038330078125
local_in_edges_tensor generation:  0.0008461475372314453
mini_batch_src_global generation:  0.0015096664428710938
r_  generation:  0.01945209503173828
local_output_nid generation:  0.0015780925750732422
local_in_edges_tensor generation:  0.0008721351623535156
mini_batch_src_global generation:  0.0015056133270263672
r_  generation:  0.019661903381347656
local_output_nid generation:  0.0016269683837890625
local_in_edges_tensor generation:  0.0008971691131591797
mini_batch_src_global generation:  0.0014789104461669922
r_  generation:  0.01878499984741211
local_output_nid generation:  0.0015799999237060547
local_in_edges_tensor generation:  0.000919342041015625
mini_batch_src_global generation:  0.0015056133270263672
r_  generation:  0.01952195167541504
----------------------check_connections_block total spend ----------------------------- 0.4662044048309326
generate_one_block  0.027011632919311523
generate_one_block  0.03001236915588379
generate_one_block  0.027795076370239258
generate_one_block  0.027368545532226562
generate_one_block  0.027993440628051758
generate_one_block  0.030832529067993164
generate_one_block  0.03520846366882324
generate_one_block  0.028126955032348633
generate_one_block  0.028368473052978516
generate_one_block  0.02796649932861328
generate_one_block  0.028142452239990234
generate_one_block  0.027492523193359375
generate_one_block  0.0279996395111084
generate_one_block  0.027936935424804688
generate_one_block  0.02767348289489746
generate_one_block  0.0298917293548584
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.033493995666503906
gen group dst list time:  0.016422271728515625
time for parepare:  0.019005775451660156
local_output_nid generation:  0.006652116775512695
local_in_edges_tensor generation:  0.01824951171875
mini_batch_src_global generation:  0.019974470138549805
r_  generation:  0.19123148918151855
local_output_nid generation:  0.010117292404174805
local_in_edges_tensor generation:  0.013948440551757812
mini_batch_src_global generation:  0.023784875869750977
r_  generation:  0.19751667976379395
local_output_nid generation:  0.010303497314453125
local_in_edges_tensor generation:  0.01157379150390625
mini_batch_src_global generation:  0.02414393424987793
r_  generation:  0.20411133766174316
local_output_nid generation:  0.011025428771972656
local_in_edges_tensor generation:  0.013959169387817383
mini_batch_src_global generation:  0.024633169174194336
r_  generation:  0.20172643661499023
local_output_nid generation:  0.011350154876708984
local_in_edges_tensor generation:  0.011288642883300781
mini_batch_src_global generation:  0.02505183219909668
r_  generation:  0.20854401588439941
local_output_nid generation:  0.01100778579711914
local_in_edges_tensor generation:  0.01114344596862793
mini_batch_src_global generation:  0.025429248809814453
r_  generation:  0.20714116096496582
local_output_nid generation:  0.011723041534423828
local_in_edges_tensor generation:  0.01227712631225586
mini_batch_src_global generation:  0.026591777801513672
r_  generation:  0.2135167121887207
local_output_nid generation:  0.01177215576171875
local_in_edges_tensor generation:  0.01150655746459961
mini_batch_src_global generation:  0.027917861938476562
r_  generation:  0.20996308326721191
local_output_nid generation:  0.011966705322265625
local_in_edges_tensor generation:  0.011781930923461914
mini_batch_src_global generation:  0.028876304626464844
r_  generation:  0.22130203247070312
local_output_nid generation:  0.011891603469848633
local_in_edges_tensor generation:  0.014339447021484375
mini_batch_src_global generation:  0.026292085647583008
r_  generation:  0.21887707710266113
local_output_nid generation:  0.013104677200317383
local_in_edges_tensor generation:  0.014882564544677734
mini_batch_src_global generation:  0.02729344367980957
r_  generation:  0.22151684761047363
local_output_nid generation:  0.011661767959594727
local_in_edges_tensor generation:  0.011766672134399414
mini_batch_src_global generation:  0.04108619689941406
r_  generation:  0.2283320426940918
local_output_nid generation:  0.012321233749389648
local_in_edges_tensor generation:  0.01512455940246582
mini_batch_src_global generation:  0.029916048049926758
r_  generation:  0.22893285751342773
local_output_nid generation:  0.011918783187866211
local_in_edges_tensor generation:  0.01675868034362793
mini_batch_src_global generation:  0.03218841552734375
r_  generation:  0.21787095069885254
local_output_nid generation:  0.012815475463867188
local_in_edges_tensor generation:  0.014488935470581055
mini_batch_src_global generation:  0.02630472183227539
r_  generation:  0.21456646919250488
local_output_nid generation:  0.01210165023803711
local_in_edges_tensor generation:  0.012660980224609375
mini_batch_src_global generation:  0.02629542350769043
r_  generation:  0.21576499938964844
----------------------check_connections_block total spend ----------------------------- 5.027225017547607
generate_one_block  0.27025341987609863
generate_one_block  0.26633191108703613
generate_one_block  0.27186012268066406
generate_one_block  0.26338791847229004
generate_one_block  0.26879072189331055
generate_one_block  0.2689096927642822
generate_one_block  0.2977619171142578
generate_one_block  0.2625620365142822
generate_one_block  0.2767932415008545
generate_one_block  0.2692301273345947
generate_one_block  0.2992584705352783
generate_one_block  0.27332186698913574
generate_one_block  0.27633213996887207
generate_one_block  0.27097105979919434
generate_one_block  0.27009153366088867
generate_one_block  0.2755773067474365
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03636503219604492
gen group dst list time:  0.06279635429382324
time for parepare:  0.0181119441986084
local_output_nid generation:  0.02384352684020996
local_in_edges_tensor generation:  0.05964922904968262
mini_batch_src_global generation:  0.04165244102478027
r_  generation:  0.45794129371643066
local_output_nid generation:  0.029239177703857422
local_in_edges_tensor generation:  0.039429664611816406
mini_batch_src_global generation:  0.056978464126586914
r_  generation:  0.46884918212890625
local_output_nid generation:  0.03235673904418945
local_in_edges_tensor generation:  0.0295870304107666
mini_batch_src_global generation:  0.054624319076538086
r_  generation:  0.45326757431030273
local_output_nid generation:  0.03046250343322754
local_in_edges_tensor generation:  0.03139376640319824
mini_batch_src_global generation:  0.051950931549072266
r_  generation:  0.44865918159484863
local_output_nid generation:  0.03077554702758789
local_in_edges_tensor generation:  0.08379268646240234
mini_batch_src_global generation:  0.05173921585083008
r_  generation:  0.45571470260620117
local_output_nid generation:  0.0300137996673584
local_in_edges_tensor generation:  0.03246593475341797
mini_batch_src_global generation:  0.051897525787353516
r_  generation:  0.45352888107299805
local_output_nid generation:  0.030639171600341797
local_in_edges_tensor generation:  0.028597354888916016
mini_batch_src_global generation:  0.05199432373046875
r_  generation:  0.46761059761047363
local_output_nid generation:  0.03141164779663086
local_in_edges_tensor generation:  0.029644012451171875
mini_batch_src_global generation:  0.054633140563964844
r_  generation:  0.4530198574066162
local_output_nid generation:  0.030453920364379883
local_in_edges_tensor generation:  0.029181957244873047
mini_batch_src_global generation:  0.05190396308898926
r_  generation:  0.45648717880249023
local_output_nid generation:  0.0304262638092041
local_in_edges_tensor generation:  0.030784130096435547
mini_batch_src_global generation:  0.052622079849243164
r_  generation:  0.4739069938659668
local_output_nid generation:  0.03131365776062012
local_in_edges_tensor generation:  0.031682491302490234
mini_batch_src_global generation:  0.05467867851257324
r_  generation:  0.46567606925964355
local_output_nid generation:  0.030768394470214844
local_in_edges_tensor generation:  0.02945113182067871
mini_batch_src_global generation:  0.05274510383605957
r_  generation:  0.4572112560272217
local_output_nid generation:  0.031192779541015625
local_in_edges_tensor generation:  0.03295278549194336
mini_batch_src_global generation:  0.05412912368774414
r_  generation:  0.4645388126373291
local_output_nid generation:  0.030941247940063477
local_in_edges_tensor generation:  0.029272079467773438
mini_batch_src_global generation:  0.0531620979309082
r_  generation:  0.45853185653686523
local_output_nid generation:  0.03087472915649414
local_in_edges_tensor generation:  0.030931472778320312
mini_batch_src_global generation:  0.05205941200256348
r_  generation:  0.4656505584716797
local_output_nid generation:  0.031455278396606445
local_in_edges_tensor generation:  0.029942035675048828
mini_batch_src_global generation:  0.0535123348236084
r_  generation:  0.4633457660675049
----------------------check_connections_block total spend ----------------------------- 10.872287273406982
generate_one_block  0.5878057479858398
generate_one_block  0.5851373672485352
generate_one_block  0.5826880931854248
generate_one_block  0.583308219909668
generate_one_block  0.5924174785614014
generate_one_block  0.5974786281585693
generate_one_block  0.5835392475128174
generate_one_block  0.5798852443695068
generate_one_block  0.6100907325744629
generate_one_block  0.5842199325561523
generate_one_block  0.5851230621337891
generate_one_block  0.5733294486999512
generate_one_block  0.5963709354400635
generate_one_block  0.5871891975402832
generate_one_block  0.5778460502624512
generate_one_block  0.5872747898101807
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11516046524047852  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

connection checking time:  15.89951229095459
block generation total time  13.775137662887573
average batch blocks generation time:  0.8609461039304733
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0939326286315918  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7178339958190918  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09350299835205078  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7169404029846191  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0939340591430664  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7170925140380859  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09316492080688477  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7146191596984863  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09391117095947266  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.718696117401123  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09333229064941406  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7156124114990234  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09395599365234375  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7190127372741699  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09336423873901367  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7173275947570801  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09400558471679688  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7199287414550781  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09336519241333008  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7170476913452148  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0940694808959961  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7245402336120605  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09333944320678711  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7169361114501953  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09398746490478516  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7210135459899902  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09324836730957031  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7179036140441895  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09380722045898438  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7166309356689453  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09340906143188477  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7193293571472168  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06328380107879639 |0.012176752090454102 |0.003569379448890686 |9.238719940185547e-05 |0.003705337643623352 |0.0016226768493652344 |
----------------------------------------------------------pseudo_mini_loss sum 1.7860203981399536
 Run 0| Epoch 7 |
Number of nodes for computation during this epoch:  5094147
Number of first layer input nodes during this epoch:  2472553
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11532974243164062  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02051830291748047
range selection method range initialization spend 0.012468099594116211
time for parepare:  0.018110990524291992
local_output_nid generation:  0.0014183521270751953
local_in_edges_tensor generation:  0.006418704986572266
mini_batch_src_global generation:  0.0015537738800048828
r_  generation:  0.018326282501220703
local_output_nid generation:  0.0015320777893066406
local_in_edges_tensor generation:  0.001001119613647461
mini_batch_src_global generation:  0.00193023681640625
r_  generation:  0.020255327224731445
local_output_nid generation:  0.001573324203491211
local_in_edges_tensor generation:  0.0009140968322753906
mini_batch_src_global generation:  0.0014529228210449219
r_  generation:  0.01851367950439453
local_output_nid generation:  0.00157928466796875
local_in_edges_tensor generation:  0.0009410381317138672
mini_batch_src_global generation:  0.0014328956604003906
r_  generation:  0.018869638442993164
local_output_nid generation:  0.0015439987182617188
local_in_edges_tensor generation:  0.0008952617645263672
mini_batch_src_global generation:  0.00152587890625
r_  generation:  0.01889514923095703
local_output_nid generation:  0.0015552043914794922
local_in_edges_tensor generation:  0.0008916854858398438
mini_batch_src_global generation:  0.001482248306274414
r_  generation:  0.019461393356323242
local_output_nid generation:  0.0015611648559570312
local_in_edges_tensor generation:  0.0008997917175292969
mini_batch_src_global generation:  0.0015916824340820312
r_  generation:  0.02001023292541504
local_output_nid generation:  0.0015745162963867188
local_in_edges_tensor generation:  0.0009245872497558594
mini_batch_src_global generation:  0.001561880111694336
r_  generation:  0.019623279571533203
local_output_nid generation:  0.0015625953674316406
local_in_edges_tensor generation:  0.0009133815765380859
mini_batch_src_global generation:  0.0015337467193603516
r_  generation:  0.019242048263549805
local_output_nid generation:  0.0015594959259033203
local_in_edges_tensor generation:  0.0009162425994873047
mini_batch_src_global generation:  0.0015273094177246094
r_  generation:  0.028142213821411133
local_output_nid generation:  0.0028977394104003906
local_in_edges_tensor generation:  0.0015916824340820312
mini_batch_src_global generation:  0.001954317092895508
r_  generation:  0.02046513557434082
local_output_nid generation:  0.001909494400024414
local_in_edges_tensor generation:  0.0010399818420410156
mini_batch_src_global generation:  0.0016417503356933594
r_  generation:  0.019833803176879883
local_output_nid generation:  0.0018949508666992188
local_in_edges_tensor generation:  0.0010330677032470703
mini_batch_src_global generation:  0.0016262531280517578
r_  generation:  0.019654512405395508
local_output_nid generation:  0.0017969608306884766
local_in_edges_tensor generation:  0.0010342597961425781
mini_batch_src_global generation:  0.0016789436340332031
r_  generation:  0.020053625106811523
local_output_nid generation:  0.001786947250366211
local_in_edges_tensor generation:  0.0010466575622558594
mini_batch_src_global generation:  0.0016820430755615234
r_  generation:  0.020126819610595703
local_output_nid generation:  0.0018112659454345703
local_in_edges_tensor generation:  0.0010461807250976562
mini_batch_src_global generation:  0.0016455650329589844
r_  generation:  0.02029561996459961
----------------------check_connections_block total spend ----------------------------- 0.48774266242980957
generate_one_block  0.028759479522705078
generate_one_block  0.029478073120117188
generate_one_block  0.028603315353393555
generate_one_block  0.028836488723754883
generate_one_block  0.02929401397705078
generate_one_block  0.03184056282043457
generate_one_block  0.029639720916748047
generate_one_block  0.029407501220703125
generate_one_block  0.028817176818847656
generate_one_block  0.028755664825439453
generate_one_block  0.028624296188354492
generate_one_block  0.02888941764831543
generate_one_block  0.02873706817626953
generate_one_block  0.029279232025146484
generate_one_block  0.029654741287231445
generate_one_block  0.028970003128051758
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0406947135925293
gen group dst list time:  0.01963329315185547
time for parepare:  0.0217587947845459
local_output_nid generation:  0.008036136627197266
local_in_edges_tensor generation:  0.023189544677734375
mini_batch_src_global generation:  0.02068781852722168
r_  generation:  0.20345330238342285
local_output_nid generation:  0.012662887573242188
local_in_edges_tensor generation:  0.01626873016357422
mini_batch_src_global generation:  0.02894449234008789
r_  generation:  0.2185678482055664
local_output_nid generation:  0.013817071914672852
local_in_edges_tensor generation:  0.012404203414916992
mini_batch_src_global generation:  0.02665424346923828
r_  generation:  0.20796823501586914
local_output_nid generation:  0.013580083847045898
local_in_edges_tensor generation:  0.01533651351928711
mini_batch_src_global generation:  0.028829574584960938
r_  generation:  0.21380281448364258
local_output_nid generation:  0.014635324478149414
local_in_edges_tensor generation:  0.012188911437988281
mini_batch_src_global generation:  0.031890153884887695
r_  generation:  0.226057767868042
local_output_nid generation:  0.014449357986450195
local_in_edges_tensor generation:  0.015571355819702148
mini_batch_src_global generation:  0.027614593505859375
r_  generation:  0.21894216537475586
local_output_nid generation:  0.017644166946411133
local_in_edges_tensor generation:  0.013271093368530273
mini_batch_src_global generation:  0.027758359909057617
r_  generation:  0.22417259216308594
local_output_nid generation:  0.01476740837097168
local_in_edges_tensor generation:  0.012453556060791016
mini_batch_src_global generation:  0.027673721313476562
r_  generation:  0.2200028896331787
local_output_nid generation:  0.014696121215820312
local_in_edges_tensor generation:  0.012306928634643555
mini_batch_src_global generation:  0.02782726287841797
r_  generation:  0.22697949409484863
local_output_nid generation:  0.014939069747924805
local_in_edges_tensor generation:  0.01251363754272461
mini_batch_src_global generation:  0.030487537384033203
r_  generation:  0.22286462783813477
local_output_nid generation:  0.014840364456176758
local_in_edges_tensor generation:  0.013428211212158203
mini_batch_src_global generation:  0.027833223342895508
r_  generation:  0.22221159934997559
local_output_nid generation:  0.014900445938110352
local_in_edges_tensor generation:  0.013196468353271484
mini_batch_src_global generation:  0.029768943786621094
r_  generation:  0.22356295585632324
local_output_nid generation:  0.01481008529663086
local_in_edges_tensor generation:  0.013434410095214844
mini_batch_src_global generation:  0.028055906295776367
r_  generation:  0.26558828353881836
local_output_nid generation:  0.014838218688964844
local_in_edges_tensor generation:  0.012919902801513672
mini_batch_src_global generation:  0.029264211654663086
r_  generation:  0.22339558601379395
local_output_nid generation:  0.014652490615844727
local_in_edges_tensor generation:  0.01457357406616211
mini_batch_src_global generation:  0.028688907623291016
r_  generation:  0.2263801097869873
local_output_nid generation:  0.014489889144897461
local_in_edges_tensor generation:  0.014116764068603516
mini_batch_src_global generation:  0.029018163681030273
r_  generation:  0.22502875328063965
----------------------check_connections_block total spend ----------------------------- 5.314153432846069
generate_one_block  0.2796485424041748
generate_one_block  0.27245593070983887
generate_one_block  0.26455259323120117
generate_one_block  0.2721731662750244
generate_one_block  0.27774548530578613
generate_one_block  0.27744174003601074
generate_one_block  0.3083212375640869
generate_one_block  0.27018046379089355
generate_one_block  0.27202486991882324
generate_one_block  0.268646240234375
generate_one_block  0.2841372489929199
generate_one_block  0.28151988983154297
generate_one_block  0.26976990699768066
generate_one_block  0.2812659740447998
generate_one_block  0.2803828716278076
generate_one_block  0.27878665924072266
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.033669233322143555
gen group dst list time:  0.06536579132080078
time for parepare:  0.018260717391967773
local_output_nid generation:  0.02419424057006836
local_in_edges_tensor generation:  0.044974565505981445
mini_batch_src_global generation:  0.04601931571960449
r_  generation:  0.44240379333496094
local_output_nid generation:  0.03045797348022461
local_in_edges_tensor generation:  0.03937387466430664
mini_batch_src_global generation:  0.05142021179199219
r_  generation:  0.46472907066345215
local_output_nid generation:  0.03307533264160156
local_in_edges_tensor generation:  0.03264045715332031
mini_batch_src_global generation:  0.0552515983581543
r_  generation:  0.4515247344970703
local_output_nid generation:  0.031222105026245117
local_in_edges_tensor generation:  0.029064655303955078
mini_batch_src_global generation:  0.052188873291015625
r_  generation:  0.45335888862609863
local_output_nid generation:  0.03174185752868652
local_in_edges_tensor generation:  0.08396458625793457
mini_batch_src_global generation:  0.05209970474243164
r_  generation:  0.4620969295501709
local_output_nid generation:  0.030955791473388672
local_in_edges_tensor generation:  0.032706260681152344
mini_batch_src_global generation:  0.053011178970336914
r_  generation:  0.4558432102203369
local_output_nid generation:  0.030330181121826172
local_in_edges_tensor generation:  0.030860185623168945
mini_batch_src_global generation:  0.05209827423095703
r_  generation:  0.45861339569091797
local_output_nid generation:  0.030384302139282227
local_in_edges_tensor generation:  0.0421907901763916
mini_batch_src_global generation:  0.05281949043273926
r_  generation:  0.4586760997772217
local_output_nid generation:  0.031051158905029297
local_in_edges_tensor generation:  0.030857324600219727
mini_batch_src_global generation:  0.05426335334777832
r_  generation:  0.46416234970092773
local_output_nid generation:  0.030792713165283203
local_in_edges_tensor generation:  0.029087305068969727
mini_batch_src_global generation:  0.05296444892883301
r_  generation:  0.454237699508667
local_output_nid generation:  0.03159523010253906
local_in_edges_tensor generation:  0.0352940559387207
mini_batch_src_global generation:  0.05255889892578125
r_  generation:  0.45943140983581543
local_output_nid generation:  0.030744075775146484
local_in_edges_tensor generation:  0.03018927574157715
mini_batch_src_global generation:  0.05278825759887695
r_  generation:  0.4589524269104004
local_output_nid generation:  0.031154632568359375
local_in_edges_tensor generation:  0.03250455856323242
mini_batch_src_global generation:  0.051493167877197266
r_  generation:  0.4587249755859375
local_output_nid generation:  0.031310319900512695
local_in_edges_tensor generation:  0.03055262565612793
mini_batch_src_global generation:  0.0580594539642334
r_  generation:  0.4572634696960449
local_output_nid generation:  0.031099557876586914
local_in_edges_tensor generation:  0.033333539962768555
mini_batch_src_global generation:  0.05401802062988281
r_  generation:  0.47536349296569824
local_output_nid generation:  0.03268074989318848
local_in_edges_tensor generation:  0.036084651947021484
mini_batch_src_global generation:  0.05438733100891113
r_  generation:  0.46048665046691895
----------------------check_connections_block total spend ----------------------------- 10.872618675231934
generate_one_block  0.5861170291900635
generate_one_block  0.569441556930542
generate_one_block  0.5706589221954346
generate_one_block  0.5733675956726074
generate_one_block  0.5873188972473145
generate_one_block  0.5821475982666016
generate_one_block  0.5894608497619629
generate_one_block  0.580639123916626
generate_one_block  0.6514899730682373
generate_one_block  0.5783874988555908
generate_one_block  0.5746927261352539
generate_one_block  0.5855453014373779
generate_one_block  0.5868360996246338
generate_one_block  0.5817186832427979
generate_one_block  0.5844886302947998
generate_one_block  0.5843844413757324
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11532974243164062  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

connection checking time:  16.186772108078003
block generation total time  13.805747747421265
average batch blocks generation time:  0.862859234213829
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09379053115844727  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7120456695556641  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09332799911499023  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7183146476745605  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09369277954101562  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7147555351257324  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09313488006591797  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7148499488830566  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09400558471679688  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7215776443481445  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09352493286132812  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7173361778259277  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09397125244140625  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7198648452758789  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09335851669311523  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7179884910583496  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09393692016601562  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7181038856506348  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09321784973144531  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7166733741760254  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0938405990600586  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7135591506958008  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09346342086791992  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7190141677856445  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09379863739013672  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7164840698242188  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09333515167236328  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7177300453186035  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09400749206542969  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7211189270019531  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09360313415527344  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7206721305847168  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06062094867229462 |0.013110250234603882 |0.003942549228668213 |0.00010149180889129639 |0.003588467836380005 |0.0039637088775634766 |
----------------------------------------------------------pseudo_mini_loss sum 1.6955156326293945
 Run 0| Epoch 8 |
Number of nodes for computation during this epoch:  5093666
Number of first layer input nodes during this epoch:  2472049
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11570215225219727  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022040367126464844
range selection method range initialization spend 0.01225137710571289
time for parepare:  0.02129507064819336
local_output_nid generation:  0.0015289783477783203
local_in_edges_tensor generation:  0.009054422378540039
mini_batch_src_global generation:  0.0018961429595947266
r_  generation:  0.018659353256225586
local_output_nid generation:  0.0017538070678710938
local_in_edges_tensor generation:  0.0009603500366210938
mini_batch_src_global generation:  0.0020856857299804688
r_  generation:  0.01932811737060547
local_output_nid generation:  0.0017521381378173828
local_in_edges_tensor generation:  0.0009272098541259766
mini_batch_src_global generation:  0.0015082359313964844
r_  generation:  0.019516944885253906
local_output_nid generation:  0.0018432140350341797
local_in_edges_tensor generation:  0.0012180805206298828
mini_batch_src_global generation:  0.0015382766723632812
r_  generation:  0.01908278465270996
local_output_nid generation:  0.001739501953125
local_in_edges_tensor generation:  0.0008831024169921875
mini_batch_src_global generation:  0.001546621322631836
r_  generation:  0.01963639259338379
local_output_nid generation:  0.0017056465148925781
local_in_edges_tensor generation:  0.0009043216705322266
mini_batch_src_global generation:  0.0015234947204589844
r_  generation:  0.01939535140991211
local_output_nid generation:  0.0017249584197998047
local_in_edges_tensor generation:  0.0008988380432128906
mini_batch_src_global generation:  0.0015420913696289062
r_  generation:  0.019786596298217773
local_output_nid generation:  0.0017173290252685547
local_in_edges_tensor generation:  0.0009176731109619141
mini_batch_src_global generation:  0.001556396484375
r_  generation:  0.019026994705200195
local_output_nid generation:  0.0017254352569580078
local_in_edges_tensor generation:  0.0009169578552246094
mini_batch_src_global generation:  0.0014960765838623047
r_  generation:  0.0191652774810791
local_output_nid generation:  0.0017049312591552734
local_in_edges_tensor generation:  0.0009164810180664062
mini_batch_src_global generation:  0.00152587890625
r_  generation:  0.01948261260986328
local_output_nid generation:  0.0016984939575195312
local_in_edges_tensor generation:  0.0008828639984130859
mini_batch_src_global generation:  0.0015406608581542969
r_  generation:  0.01965808868408203
local_output_nid generation:  0.0016772747039794922
local_in_edges_tensor generation:  0.00089263916015625
mini_batch_src_global generation:  0.0016071796417236328
r_  generation:  0.01977372169494629
local_output_nid generation:  0.0016167163848876953
local_in_edges_tensor generation:  0.0008666515350341797
mini_batch_src_global generation:  0.0015325546264648438
r_  generation:  0.019803285598754883
local_output_nid generation:  0.0016164779663085938
local_in_edges_tensor generation:  0.0009253025054931641
mini_batch_src_global generation:  0.0015637874603271484
r_  generation:  0.01952672004699707
local_output_nid generation:  0.0016252994537353516
local_in_edges_tensor generation:  0.0008792877197265625
mini_batch_src_global generation:  0.0015380382537841797
r_  generation:  0.019635438919067383
local_output_nid generation:  0.001669168472290039
local_in_edges_tensor generation:  0.0009176731109619141
mini_batch_src_global generation:  0.0015926361083984375
r_  generation:  0.01986527442932129
----------------------check_connections_block total spend ----------------------------- 0.47921204566955566
generate_one_block  0.026981830596923828
generate_one_block  0.027959823608398438
generate_one_block  0.027605056762695312
generate_one_block  0.028027057647705078
generate_one_block  0.028148174285888672
generate_one_block  0.02987360954284668
generate_one_block  0.02838444709777832
generate_one_block  0.02725386619567871
generate_one_block  0.02721714973449707
generate_one_block  0.028016090393066406
generate_one_block  0.027940988540649414
generate_one_block  0.028127670288085938
generate_one_block  0.02805471420288086
generate_one_block  0.02763223648071289
generate_one_block  0.028000593185424805
generate_one_block  0.028941869735717773
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.033869028091430664
gen group dst list time:  0.016374588012695312
time for parepare:  0.020129680633544922
local_output_nid generation:  0.0068933963775634766
local_in_edges_tensor generation:  0.02074742317199707
mini_batch_src_global generation:  0.01988673210144043
r_  generation:  0.18981599807739258
local_output_nid generation:  0.010219573974609375
local_in_edges_tensor generation:  0.012494802474975586
mini_batch_src_global generation:  0.02369832992553711
r_  generation:  0.19824767112731934
local_output_nid generation:  0.010364532470703125
local_in_edges_tensor generation:  0.010697603225708008
mini_batch_src_global generation:  0.02414226531982422
r_  generation:  0.20320415496826172
local_output_nid generation:  0.011005163192749023
local_in_edges_tensor generation:  0.011735677719116211
mini_batch_src_global generation:  0.023832321166992188
r_  generation:  0.2071230411529541
local_output_nid generation:  0.01158595085144043
local_in_edges_tensor generation:  0.012907266616821289
mini_batch_src_global generation:  0.025487661361694336
r_  generation:  0.2130265235900879
local_output_nid generation:  0.011517763137817383
local_in_edges_tensor generation:  0.011319875717163086
mini_batch_src_global generation:  0.02563953399658203
r_  generation:  0.20957064628601074
local_output_nid generation:  0.011908292770385742
local_in_edges_tensor generation:  0.012157201766967773
mini_batch_src_global generation:  0.027441024780273438
r_  generation:  0.2172245979309082
local_output_nid generation:  0.01177978515625
local_in_edges_tensor generation:  0.011445999145507812
mini_batch_src_global generation:  0.029279708862304688
r_  generation:  0.20923161506652832
local_output_nid generation:  0.011707067489624023
local_in_edges_tensor generation:  0.011279106140136719
mini_batch_src_global generation:  0.028421878814697266
r_  generation:  0.20889067649841309
local_output_nid generation:  0.011979818344116211
local_in_edges_tensor generation:  0.01105189323425293
mini_batch_src_global generation:  0.02684473991394043
r_  generation:  0.21599245071411133
local_output_nid generation:  0.011662483215332031
local_in_edges_tensor generation:  0.012408733367919922
mini_batch_src_global generation:  0.02741241455078125
r_  generation:  0.21539831161499023
local_output_nid generation:  0.01178884506225586
local_in_edges_tensor generation:  0.011359691619873047
mini_batch_src_global generation:  0.027759313583374023
r_  generation:  0.21753191947937012
local_output_nid generation:  0.012176036834716797
local_in_edges_tensor generation:  0.01160120964050293
mini_batch_src_global generation:  0.028122425079345703
r_  generation:  0.21895933151245117
local_output_nid generation:  0.012039422988891602
local_in_edges_tensor generation:  0.011175394058227539
mini_batch_src_global generation:  0.026386022567749023
r_  generation:  0.21608638763427734
local_output_nid generation:  0.011703968048095703
local_in_edges_tensor generation:  0.014361858367919922
mini_batch_src_global generation:  0.026710987091064453
r_  generation:  0.21942996978759766
local_output_nid generation:  0.011458635330200195
local_in_edges_tensor generation:  0.012684106826782227
mini_batch_src_global generation:  0.026607036590576172
r_  generation:  0.21756196022033691
----------------------check_connections_block total spend ----------------------------- 4.936324834823608
generate_one_block  0.27712202072143555
generate_one_block  0.2646470069885254
generate_one_block  0.2685208320617676
generate_one_block  0.27597784996032715
generate_one_block  0.27397871017456055
generate_one_block  0.27446651458740234
generate_one_block  0.306011438369751
generate_one_block  0.26860857009887695
generate_one_block  0.26502013206481934
generate_one_block  0.2710611820220947
generate_one_block  0.26859211921691895
generate_one_block  0.27524685859680176
generate_one_block  0.2752976417541504
generate_one_block  0.26459574699401855
generate_one_block  0.2725708484649658
generate_one_block  0.2727532386779785
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.034890174865722656
gen group dst list time:  0.061482906341552734
time for parepare:  0.018494844436645508
local_output_nid generation:  0.024973630905151367
local_in_edges_tensor generation:  0.0511174201965332
mini_batch_src_global generation:  0.04357314109802246
r_  generation:  0.44293999671936035
local_output_nid generation:  0.029851436614990234
local_in_edges_tensor generation:  0.037244319915771484
mini_batch_src_global generation:  0.05185961723327637
r_  generation:  0.4580211639404297
local_output_nid generation:  0.03007793426513672
local_in_edges_tensor generation:  0.031749725341796875
mini_batch_src_global generation:  0.05058932304382324
r_  generation:  0.45566463470458984
local_output_nid generation:  0.029820680618286133
local_in_edges_tensor generation:  0.03259587287902832
mini_batch_src_global generation:  0.05367159843444824
r_  generation:  0.45322442054748535
local_output_nid generation:  0.031246423721313477
local_in_edges_tensor generation:  0.07871747016906738
mini_batch_src_global generation:  0.0541539192199707
r_  generation:  0.4605259895324707
local_output_nid generation:  0.030375003814697266
local_in_edges_tensor generation:  0.03793907165527344
mini_batch_src_global generation:  0.054047584533691406
r_  generation:  0.45890331268310547
local_output_nid generation:  0.030754804611206055
local_in_edges_tensor generation:  0.034673213958740234
mini_batch_src_global generation:  0.054402828216552734
r_  generation:  0.4594595432281494
local_output_nid generation:  0.0303037166595459
local_in_edges_tensor generation:  0.03518199920654297
mini_batch_src_global generation:  0.05582284927368164
r_  generation:  0.45290231704711914
local_output_nid generation:  0.030703306198120117
local_in_edges_tensor generation:  0.03385305404663086
mini_batch_src_global generation:  0.05361294746398926
r_  generation:  0.45642828941345215
local_output_nid generation:  0.030636310577392578
local_in_edges_tensor generation:  0.03715252876281738
mini_batch_src_global generation:  0.05476832389831543
r_  generation:  0.46923828125
local_output_nid generation:  0.033495426177978516
local_in_edges_tensor generation:  0.03695964813232422
mini_batch_src_global generation:  0.054409027099609375
r_  generation:  0.45783281326293945
local_output_nid generation:  0.031410932540893555
local_in_edges_tensor generation:  0.03251218795776367
mini_batch_src_global generation:  0.053548574447631836
r_  generation:  0.4552602767944336
local_output_nid generation:  0.03150296211242676
local_in_edges_tensor generation:  0.03177905082702637
mini_batch_src_global generation:  0.05197262763977051
r_  generation:  0.4605722427368164
local_output_nid generation:  0.03162693977355957
local_in_edges_tensor generation:  0.0343174934387207
mini_batch_src_global generation:  0.05278778076171875
r_  generation:  0.45736217498779297
local_output_nid generation:  0.031856536865234375
local_in_edges_tensor generation:  0.0377504825592041
mini_batch_src_global generation:  0.05367398262023926
r_  generation:  0.460186243057251
local_output_nid generation:  0.03187394142150879
local_in_edges_tensor generation:  0.03536844253540039
mini_batch_src_global generation:  0.06411623954772949
r_  generation:  0.46087074279785156
----------------------check_connections_block total spend ----------------------------- 10.894072771072388
generate_one_block  0.5870177745819092
generate_one_block  0.5750067234039307
generate_one_block  0.5727035999298096
generate_one_block  0.5779628753662109
generate_one_block  0.5822837352752686
generate_one_block  0.5805318355560303
generate_one_block  0.5854372978210449
generate_one_block  0.5767598152160645
generate_one_block  0.6026716232299805
generate_one_block  0.5792102813720703
generate_one_block  0.5749740600585938
generate_one_block  0.5823149681091309
generate_one_block  0.5856966972351074
generate_one_block  0.5816314220428467
generate_one_block  0.579613447189331
generate_one_block  0.5786888599395752
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11570215225219727  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

connection checking time:  15.830397605895996
block generation total time  13.676975727081299
average batch blocks generation time:  0.8548109829425812
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09381437301635742  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7158122062683105  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09340429306030273  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7173070907592773  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09387874603271484  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.716670036315918  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09321451187133789  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7130341529846191  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09399223327636719  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7195525169372559  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09326410293579102  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7165260314941406  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09399986267089844  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7207903861999512  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09333467483520508  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7161364555358887  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09374332427978516  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.715294361114502  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0934290885925293  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7179937362670898  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09388446807861328  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7175884246826172  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09349727630615234  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7193198204040527  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0939788818359375  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7188277244567871  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09343481063842773  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7171039581298828  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09398460388183594  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7204513549804688  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09322261810302734  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7184262275695801  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06403878331184387 |0.014251887798309326 |0.0036573857069015503 |9.407103061676025e-05 |0.0037692785263061523 |0.0018990039825439453 |
----------------------------------------------------------pseudo_mini_loss sum 1.6318281888961792
 Run 0| Epoch 9 |
Number of nodes for computation during this epoch:  5092615
Number of first layer input nodes during this epoch:  2472170
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11513566970825195  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020979642868041992
range selection method range initialization spend 0.012098312377929688
time for parepare:  0.019268035888671875
local_output_nid generation:  0.001428842544555664
local_in_edges_tensor generation:  0.006338834762573242
mini_batch_src_global generation:  0.0019354820251464844
r_  generation:  0.018915176391601562
local_output_nid generation:  0.0015599727630615234
local_in_edges_tensor generation:  0.0009603500366210938
mini_batch_src_global generation:  0.002041339874267578
r_  generation:  0.020058870315551758
local_output_nid generation:  0.0015969276428222656
local_in_edges_tensor generation:  0.0009279251098632812
mini_batch_src_global generation:  0.0015366077423095703
r_  generation:  0.019209623336791992
local_output_nid generation:  0.001645803451538086
local_in_edges_tensor generation:  0.0008933544158935547
mini_batch_src_global generation:  0.0016515254974365234
r_  generation:  0.019506216049194336
local_output_nid generation:  0.001573801040649414
local_in_edges_tensor generation:  0.0009164810180664062
mini_batch_src_global generation:  0.0015714168548583984
r_  generation:  0.018755435943603516
local_output_nid generation:  0.0015664100646972656
local_in_edges_tensor generation:  0.0009100437164306641
mini_batch_src_global generation:  0.0014967918395996094
r_  generation:  0.01935744285583496
local_output_nid generation:  0.0015859603881835938
local_in_edges_tensor generation:  0.0009403228759765625
mini_batch_src_global generation:  0.0015764236450195312
r_  generation:  0.019472122192382812
local_output_nid generation:  0.0015780925750732422
local_in_edges_tensor generation:  0.0009059906005859375
mini_batch_src_global generation:  0.0015039443969726562
r_  generation:  0.01950359344482422
local_output_nid generation:  0.0015840530395507812
local_in_edges_tensor generation:  0.00092315673828125
mini_batch_src_global generation:  0.0015058517456054688
r_  generation:  0.01945209503173828
local_output_nid generation:  0.0015625953674316406
local_in_edges_tensor generation:  0.0009148120880126953
mini_batch_src_global generation:  0.0015692710876464844
r_  generation:  0.01994013786315918
local_output_nid generation:  0.0015826225280761719
local_in_edges_tensor generation:  0.0008780956268310547
mini_batch_src_global generation:  0.0015878677368164062
r_  generation:  0.01946258544921875
local_output_nid generation:  0.0015761852264404297
local_in_edges_tensor generation:  0.0009188652038574219
mini_batch_src_global generation:  0.0015382766723632812
r_  generation:  0.01992511749267578
local_output_nid generation:  0.0015718936920166016
local_in_edges_tensor generation:  0.0008890628814697266
mini_batch_src_global generation:  0.0015490055084228516
r_  generation:  0.01951146125793457
local_output_nid generation:  0.001569986343383789
local_in_edges_tensor generation:  0.0009160041809082031
mini_batch_src_global generation:  0.0015597343444824219
r_  generation:  0.020020484924316406
local_output_nid generation:  0.0015685558319091797
local_in_edges_tensor generation:  0.0009138584136962891
mini_batch_src_global generation:  0.0015439987182617188
r_  generation:  0.019336938858032227
local_output_nid generation:  0.0015714168548583984
local_in_edges_tensor generation:  0.0009248256683349609
mini_batch_src_global generation:  0.0015435218811035156
r_  generation:  0.019562959671020508
----------------------check_connections_block total spend ----------------------------- 0.4721999168395996
generate_one_block  0.027312278747558594
generate_one_block  0.028162002563476562
generate_one_block  0.02774357795715332
generate_one_block  0.028347492218017578
generate_one_block  0.027541160583496094
generate_one_block  0.029295921325683594
generate_one_block  0.027790546417236328
generate_one_block  0.02727341651916504
generate_one_block  0.027744054794311523
generate_one_block  0.028142213821411133
generate_one_block  0.027912378311157227
generate_one_block  0.02785778045654297
generate_one_block  0.02774524688720703
generate_one_block  0.027690649032592773
generate_one_block  0.027801036834716797
generate_one_block  0.028285980224609375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03716897964477539
gen group dst list time:  0.01660752296447754
time for parepare:  0.019997835159301758
local_output_nid generation:  0.006911039352416992
local_in_edges_tensor generation:  0.02050185203552246
mini_batch_src_global generation:  0.02049565315246582
r_  generation:  0.19302010536193848
local_output_nid generation:  0.010024309158325195
local_in_edges_tensor generation:  0.013942480087280273
mini_batch_src_global generation:  0.0243070125579834
r_  generation:  0.20294451713562012
local_output_nid generation:  0.010434865951538086
local_in_edges_tensor generation:  0.011046171188354492
mini_batch_src_global generation:  0.023851871490478516
r_  generation:  0.20763707160949707
local_output_nid generation:  0.010990381240844727
local_in_edges_tensor generation:  0.011162996292114258
mini_batch_src_global generation:  0.02465987205505371
r_  generation:  0.21462655067443848
local_output_nid generation:  0.011234521865844727
local_in_edges_tensor generation:  0.013311386108398438
mini_batch_src_global generation:  0.025618553161621094
r_  generation:  0.21521878242492676
local_output_nid generation:  0.011402130126953125
local_in_edges_tensor generation:  0.011335372924804688
mini_batch_src_global generation:  0.025852203369140625
r_  generation:  0.21271491050720215
local_output_nid generation:  0.01153874397277832
local_in_edges_tensor generation:  0.01347970962524414
mini_batch_src_global generation:  0.027415752410888672
r_  generation:  0.21627163887023926
local_output_nid generation:  0.011693954467773438
local_in_edges_tensor generation:  0.0121917724609375
mini_batch_src_global generation:  0.026055335998535156
r_  generation:  0.20960640907287598
local_output_nid generation:  0.011857271194458008
local_in_edges_tensor generation:  0.011538982391357422
mini_batch_src_global generation:  0.02792525291442871
r_  generation:  0.21646809577941895
local_output_nid generation:  0.011921405792236328
local_in_edges_tensor generation:  0.012398242950439453
mini_batch_src_global generation:  0.02649378776550293
r_  generation:  0.21828532218933105
local_output_nid generation:  0.011644601821899414
local_in_edges_tensor generation:  0.013715744018554688
mini_batch_src_global generation:  0.02647089958190918
r_  generation:  0.21760797500610352
local_output_nid generation:  0.01171731948852539
local_in_edges_tensor generation:  0.012037038803100586
mini_batch_src_global generation:  0.02664041519165039
r_  generation:  0.2176804542541504
local_output_nid generation:  0.014259815216064453
local_in_edges_tensor generation:  0.014474868774414062
mini_batch_src_global generation:  0.027002334594726562
r_  generation:  0.21554923057556152
local_output_nid generation:  0.013075828552246094
local_in_edges_tensor generation:  0.014734506607055664
mini_batch_src_global generation:  0.02676844596862793
r_  generation:  0.21658611297607422
local_output_nid generation:  0.011802196502685547
local_in_edges_tensor generation:  0.01333928108215332
mini_batch_src_global generation:  0.026728391647338867
r_  generation:  0.21257972717285156
local_output_nid generation:  0.01137995719909668
local_in_edges_tensor generation:  0.012255191802978516
mini_batch_src_global generation:  0.027953147888183594
r_  generation:  0.21643996238708496
----------------------check_connections_block total spend ----------------------------- 4.973159074783325
generate_one_block  0.281813383102417
generate_one_block  0.27228808403015137
generate_one_block  0.27382802963256836
generate_one_block  0.276139497756958
generate_one_block  0.27099037170410156
generate_one_block  0.2675039768218994
generate_one_block  0.2967183589935303
generate_one_block  0.2633476257324219
generate_one_block  0.2735285758972168
generate_one_block  0.27451062202453613
generate_one_block  0.26882290840148926
generate_one_block  0.27309083938598633
generate_one_block  0.2655782699584961
generate_one_block  0.27494120597839355
generate_one_block  0.2637162208557129
generate_one_block  0.26706433296203613
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.034702301025390625
gen group dst list time:  0.0619502067565918
time for parepare:  0.01755499839782715
local_output_nid generation:  0.024700164794921875
local_in_edges_tensor generation:  0.04925823211669922
mini_batch_src_global generation:  0.041595458984375
r_  generation:  0.45566725730895996
local_output_nid generation:  0.029109477996826172
local_in_edges_tensor generation:  0.03625035285949707
mini_batch_src_global generation:  0.051548004150390625
r_  generation:  0.4542505741119385
local_output_nid generation:  0.029767751693725586
local_in_edges_tensor generation:  0.02818012237548828
mini_batch_src_global generation:  0.0507807731628418
r_  generation:  0.4585268497467041
local_output_nid generation:  0.03010082244873047
local_in_edges_tensor generation:  0.03200650215148926
mini_batch_src_global generation:  0.05278921127319336
r_  generation:  0.45769667625427246
local_output_nid generation:  0.03064250946044922
local_in_edges_tensor generation:  0.07535505294799805
mini_batch_src_global generation:  0.05106949806213379
r_  generation:  0.4591536521911621
local_output_nid generation:  0.03183341026306152
local_in_edges_tensor generation:  0.03471016883850098
mini_batch_src_global generation:  0.05291271209716797
r_  generation:  0.45430445671081543
local_output_nid generation:  0.030574798583984375
local_in_edges_tensor generation:  0.035767555236816406
mini_batch_src_global generation:  0.051931142807006836
r_  generation:  0.46145105361938477
local_output_nid generation:  0.03097057342529297
local_in_edges_tensor generation:  0.03258943557739258
mini_batch_src_global generation:  0.05241799354553223
r_  generation:  0.4629693031311035
local_output_nid generation:  0.031366825103759766
local_in_edges_tensor generation:  0.03573942184448242
mini_batch_src_global generation:  0.054096221923828125
r_  generation:  0.472914457321167
local_output_nid generation:  0.03156614303588867
local_in_edges_tensor generation:  0.03793525695800781
mini_batch_src_global generation:  0.06342744827270508
r_  generation:  0.4666869640350342
local_output_nid generation:  0.033239126205444336
local_in_edges_tensor generation:  0.03292369842529297
mini_batch_src_global generation:  0.05240988731384277
r_  generation:  0.46714305877685547
local_output_nid generation:  0.03211331367492676
local_in_edges_tensor generation:  0.031122684478759766
mini_batch_src_global generation:  0.05330967903137207
r_  generation:  0.45429205894470215
local_output_nid generation:  0.03142595291137695
local_in_edges_tensor generation:  0.03058791160583496
mini_batch_src_global generation:  0.0516972541809082
r_  generation:  0.4573204517364502
local_output_nid generation:  0.03165006637573242
local_in_edges_tensor generation:  0.03136849403381348
mini_batch_src_global generation:  0.05342912673950195
r_  generation:  0.4567527770996094
local_output_nid generation:  0.03163576126098633
local_in_edges_tensor generation:  0.028796672821044922
mini_batch_src_global generation:  0.05228924751281738
r_  generation:  0.4591786861419678
local_output_nid generation:  0.03232908248901367
local_in_edges_tensor generation:  0.02941751480102539
mini_batch_src_global generation:  0.053313255310058594
r_  generation:  0.45883917808532715
----------------------check_connections_block total spend ----------------------------- 10.894046783447266
generate_one_block  0.5786781311035156
generate_one_block  0.5739874839782715
generate_one_block  0.5757052898406982
generate_one_block  0.5896611213684082
generate_one_block  0.5825519561767578
generate_one_block  0.5769193172454834
generate_one_block  0.5769264698028564
generate_one_block  0.5876593589782715
generate_one_block  0.645075798034668
generate_one_block  0.586298942565918
generate_one_block  0.5846843719482422
generate_one_block  0.5809726715087891
generate_one_block  0.5731778144836426
generate_one_block  0.5827817916870117
generate_one_block  0.5690820217132568
generate_one_block  0.5813698768615723
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11513566970825195  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

connection checking time:  15.86720585823059
block generation total time  13.709414720535278
average batch blocks generation time:  0.8568384200334549
block dataloader generation time/epoch 31.57451295852661
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09390497207641602  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7191357612609863  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09327268600463867  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.716315746307373  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09388542175292969  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.719111442565918  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09351444244384766  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7189993858337402  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09388446807861328  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7159485816955566  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09328746795654297  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.717137336730957  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.093902587890625  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7182559967041016  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09328031539916992  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.71588134765625  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09391975402832031  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7189197540283203  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09354352951049805  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7190079689025879  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09391498565673828  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7183375358581543  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09331750869750977  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7178921699523926  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09385299682617188  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7178359031677246  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09362077713012695  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7214374542236328  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09379768371582031  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7149248123168945  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09342622756958008  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7164573669433594  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05894133448600769 |0.011987537145614624 |0.003600582480430603 |9.12696123123169e-05 |0.0031047463417053223 |0.0016133785247802734 |
----------------------------------------------------------pseudo_mini_loss sum 1.5939264297485352
Total (block generation + training)time/epoch 32.883695125579834
Training time/epoch 1.3088994026184082
Training time without block to device /epoch 1.1170988082885742
Training time without total dataloading part /epoch 0.11035895347595215
load block tensor time/epoch 0.943061351776123
block to device time/epoch 0.19180059432983398
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 10 |
Number of nodes for computation during this epoch:  5093705
Number of first layer input nodes during this epoch:  2472344
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11524486541748047  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02215099334716797
range selection method range initialization spend 0.011994600296020508
time for parepare:  0.016117095947265625
local_output_nid generation:  0.0014164447784423828
local_in_edges_tensor generation:  0.004910707473754883
mini_batch_src_global generation:  0.0015985965728759766
r_  generation:  0.018430709838867188
local_output_nid generation:  0.0015375614166259766
local_in_edges_tensor generation:  0.0009443759918212891
mini_batch_src_global generation:  0.0018045902252197266
r_  generation:  0.019979000091552734
local_output_nid generation:  0.0015649795532226562
local_in_edges_tensor generation:  0.0009152889251708984
mini_batch_src_global generation:  0.00148773193359375
r_  generation:  0.0193021297454834
local_output_nid generation:  0.0016262531280517578
local_in_edges_tensor generation:  0.0009608268737792969
mini_batch_src_global generation:  0.0015256404876708984
r_  generation:  0.01878046989440918
local_output_nid generation:  0.0015604496002197266
local_in_edges_tensor generation:  0.0009090900421142578
mini_batch_src_global generation:  0.0015194416046142578
r_  generation:  0.0192720890045166
local_output_nid generation:  0.0015408992767333984
local_in_edges_tensor generation:  0.0009162425994873047
mini_batch_src_global generation:  0.0015480518341064453
r_  generation:  0.019599437713623047
local_output_nid generation:  0.0015544891357421875
local_in_edges_tensor generation:  0.00089263916015625
mini_batch_src_global generation:  0.0015892982482910156
r_  generation:  0.019841432571411133
local_output_nid generation:  0.0015604496002197266
local_in_edges_tensor generation:  0.00091552734375
mini_batch_src_global generation:  0.0015680789947509766
r_  generation:  0.019471406936645508
local_output_nid generation:  0.0015397071838378906
local_in_edges_tensor generation:  0.0009407997131347656
mini_batch_src_global generation:  0.0015289783477783203
r_  generation:  0.019697189331054688
local_output_nid generation:  0.0015513896942138672
local_in_edges_tensor generation:  0.0009005069732666016
mini_batch_src_global generation:  0.001562356948852539
r_  generation:  0.019676685333251953
local_output_nid generation:  0.0015382766723632812
local_in_edges_tensor generation:  0.0008947849273681641
mini_batch_src_global generation:  0.0015652179718017578
r_  generation:  0.019773483276367188
local_output_nid generation:  0.0015592575073242188
local_in_edges_tensor generation:  0.0009441375732421875
mini_batch_src_global generation:  0.001547098159790039
r_  generation:  0.01942729949951172
local_output_nid generation:  0.0016033649444580078
local_in_edges_tensor generation:  0.0009295940399169922
mini_batch_src_global generation:  0.001516103744506836
r_  generation:  0.019361495971679688
local_output_nid generation:  0.0015277862548828125
local_in_edges_tensor generation:  0.0008916854858398438
mini_batch_src_global generation:  0.00151824951171875
r_  generation:  0.019504308700561523
local_output_nid generation:  0.0015740394592285156
local_in_edges_tensor generation:  0.0008766651153564453
mini_batch_src_global generation:  0.0015528202056884766
r_  generation:  0.019761323928833008
local_output_nid generation:  0.0015773773193359375
local_in_edges_tensor generation:  0.0009293556213378906
mini_batch_src_global generation:  0.0015544891357421875
r_  generation:  0.01936173439025879
----------------------check_connections_block total spend ----------------------------- 0.4656341075897217
generate_one_block  0.027220726013183594
generate_one_block  0.028404951095581055
generate_one_block  0.028066396713256836
generate_one_block  0.027968883514404297
generate_one_block  0.02822709083557129
generate_one_block  0.02979731559753418
generate_one_block  0.028750181198120117
generate_one_block  0.02751445770263672
generate_one_block  0.028080224990844727
generate_one_block  0.02770400047302246
generate_one_block  0.028338193893432617
generate_one_block  0.027449846267700195
generate_one_block  0.02756500244140625
generate_one_block  0.027598857879638672
generate_one_block  0.028146743774414062
generate_one_block  0.028255224227905273
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03325986862182617
gen group dst list time:  0.01618790626525879
time for parepare:  0.020970821380615234
local_output_nid generation:  0.0068738460540771484
local_in_edges_tensor generation:  0.01925063133239746
mini_batch_src_global generation:  0.020766258239746094
r_  generation:  0.19201922416687012
local_output_nid generation:  0.010240316390991211
local_in_edges_tensor generation:  0.013333320617675781
mini_batch_src_global generation:  0.024705171585083008
r_  generation:  0.20026087760925293
local_output_nid generation:  0.010425090789794922
local_in_edges_tensor generation:  0.011274337768554688
mini_batch_src_global generation:  0.025072813034057617
r_  generation:  0.21536517143249512
local_output_nid generation:  0.013271331787109375
local_in_edges_tensor generation:  0.012047290802001953
mini_batch_src_global generation:  0.0251924991607666
r_  generation:  0.2080678939819336
local_output_nid generation:  0.011762857437133789
local_in_edges_tensor generation:  0.011196374893188477
mini_batch_src_global generation:  0.026768922805786133
r_  generation:  0.2122199535369873
local_output_nid generation:  0.011600494384765625
local_in_edges_tensor generation:  0.013792276382446289
mini_batch_src_global generation:  0.025883197784423828
r_  generation:  0.21218395233154297
local_output_nid generation:  0.012050867080688477
local_in_edges_tensor generation:  0.012098550796508789
mini_batch_src_global generation:  0.026827335357666016
r_  generation:  0.217576265335083
local_output_nid generation:  0.012002229690551758
local_in_edges_tensor generation:  0.013715744018554688
mini_batch_src_global generation:  0.025960683822631836
r_  generation:  0.20917844772338867
local_output_nid generation:  0.012201070785522461
local_in_edges_tensor generation:  0.011562824249267578
mini_batch_src_global generation:  0.026712417602539062
r_  generation:  0.21652007102966309
local_output_nid generation:  0.012252092361450195
local_in_edges_tensor generation:  0.012254953384399414
mini_batch_src_global generation:  0.02622365951538086
r_  generation:  0.214555025100708
local_output_nid generation:  0.011966228485107422
local_in_edges_tensor generation:  0.011628866195678711
mini_batch_src_global generation:  0.02686619758605957
r_  generation:  0.21515560150146484
local_output_nid generation:  0.011652231216430664
local_in_edges_tensor generation:  0.011673688888549805
mini_batch_src_global generation:  0.026103734970092773
r_  generation:  0.20813870429992676
local_output_nid generation:  0.012215137481689453
local_in_edges_tensor generation:  0.011851072311401367
mini_batch_src_global generation:  0.0265810489654541
r_  generation:  0.21204876899719238
local_output_nid generation:  0.012354373931884766
local_in_edges_tensor generation:  0.011132240295410156
mini_batch_src_global generation:  0.02628612518310547
r_  generation:  0.21269464492797852
local_output_nid generation:  0.012270927429199219
local_in_edges_tensor generation:  0.011348724365234375
mini_batch_src_global generation:  0.030169248580932617
r_  generation:  0.2161860466003418
local_output_nid generation:  0.0116424560546875
local_in_edges_tensor generation:  0.011484861373901367
mini_batch_src_global generation:  0.026575326919555664
r_  generation:  0.21167278289794922
----------------------check_connections_block total spend ----------------------------- 4.9379425048828125
generate_one_block  0.2747645378112793
generate_one_block  0.26693201065063477
generate_one_block  0.2683296203613281
generate_one_block  0.26575493812561035
generate_one_block  0.2686734199523926
generate_one_block  0.2699143886566162
generate_one_block  0.29619288444519043
generate_one_block  0.2654380798339844
generate_one_block  0.27086782455444336
generate_one_block  0.27267980575561523
generate_one_block  0.2706749439239502
generate_one_block  0.26100802421569824
generate_one_block  0.2643575668334961
generate_one_block  0.2681107521057129
generate_one_block  0.2720797061920166
generate_one_block  0.2665848731994629
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03587794303894043
gen group dst list time:  0.06134653091430664
time for parepare:  0.018314123153686523
local_output_nid generation:  0.023755788803100586
local_in_edges_tensor generation:  0.05017662048339844
mini_batch_src_global generation:  0.04186677932739258
r_  generation:  0.45240330696105957
local_output_nid generation:  0.02939295768737793
local_in_edges_tensor generation:  0.03234052658081055
mini_batch_src_global generation:  0.05211305618286133
r_  generation:  0.44719767570495605
local_output_nid generation:  0.029602766036987305
local_in_edges_tensor generation:  0.028285741806030273
mini_batch_src_global generation:  0.050867557525634766
r_  generation:  0.46076369285583496
local_output_nid generation:  0.02985358238220215
local_in_edges_tensor generation:  0.03129243850708008
mini_batch_src_global generation:  0.05389666557312012
r_  generation:  0.45055341720581055
local_output_nid generation:  0.0295867919921875
local_in_edges_tensor generation:  0.07078814506530762
mini_batch_src_global generation:  0.051419734954833984
r_  generation:  0.45641040802001953
local_output_nid generation:  0.030170202255249023
local_in_edges_tensor generation:  0.030537128448486328
mini_batch_src_global generation:  0.05235028266906738
r_  generation:  0.4565856456756592
local_output_nid generation:  0.030431509017944336
local_in_edges_tensor generation:  0.03241395950317383
mini_batch_src_global generation:  0.05179095268249512
r_  generation:  0.45755624771118164
local_output_nid generation:  0.030262231826782227
local_in_edges_tensor generation:  0.031221628189086914
mini_batch_src_global generation:  0.05272102355957031
r_  generation:  0.45203399658203125
local_output_nid generation:  0.03079056739807129
local_in_edges_tensor generation:  0.03117203712463379
mini_batch_src_global generation:  0.05384492874145508
r_  generation:  0.46149158477783203
local_output_nid generation:  0.030791759490966797
local_in_edges_tensor generation:  0.03325033187866211
mini_batch_src_global generation:  0.05284476280212402
r_  generation:  0.4583628177642822
local_output_nid generation:  0.030541181564331055
local_in_edges_tensor generation:  0.02873706817626953
mini_batch_src_global generation:  0.0523684024810791
r_  generation:  0.465456485748291
local_output_nid generation:  0.030584335327148438
local_in_edges_tensor generation:  0.029295682907104492
mini_batch_src_global generation:  0.05287909507751465
r_  generation:  0.45184826850891113
local_output_nid generation:  0.03072047233581543
local_in_edges_tensor generation:  0.02918076515197754
mini_batch_src_global generation:  0.053907155990600586
r_  generation:  0.45903968811035156
local_output_nid generation:  0.03061676025390625
local_in_edges_tensor generation:  0.033097267150878906
mini_batch_src_global generation:  0.0561373233795166
r_  generation:  0.4527251720428467
local_output_nid generation:  0.03075575828552246
local_in_edges_tensor generation:  0.029540538787841797
mini_batch_src_global generation:  0.05184531211853027
r_  generation:  0.4589400291442871
local_output_nid generation:  0.03057074546813965
local_in_edges_tensor generation:  0.02889275550842285
mini_batch_src_global generation:  0.053228139877319336
r_  generation:  0.45986056327819824
----------------------check_connections_block total spend ----------------------------- 10.748946905136108
generate_one_block  0.5734550952911377
generate_one_block  0.5737719535827637
generate_one_block  0.5756440162658691
generate_one_block  0.5732262134552002
generate_one_block  0.5768115520477295
generate_one_block  0.5737314224243164
generate_one_block  0.5731477737426758
generate_one_block  0.5766839981079102
generate_one_block  0.613070011138916
generate_one_block  0.5773770809173584
generate_one_block  0.5773546695709229
generate_one_block  0.570805549621582
generate_one_block  0.5762367248535156
generate_one_block  0.5823178291320801
generate_one_block  0.5780503749847412
generate_one_block  0.5746254920959473
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11524486541748047  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

connection checking time:  15.686889410018921
block generation total time  13.568673133850098
average batch blocks generation time:  0.8480420708656311
block dataloader generation time/epoch 31.404911279678345
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09394407272338867  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7176055908203125  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0933380126953125  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7187881469726562  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09393119812011719  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7191877365112305  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0931558609008789  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7162632942199707  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09393882751464844  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7189102172851562  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0931997299194336  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7176313400268555  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09406375885009766  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7197713851928711  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09318780899047852  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7155055999755859  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09398746490478516  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7201457023620605  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09349966049194336  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7195310592651367  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0939340591430664  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7182769775390625  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09299373626708984  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7143449783325195  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09383010864257812  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7172336578369141  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09334087371826172  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7159709930419922  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09398460388183594  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.718538761138916  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0932149887084961  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7154340744018555  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05997547507286072 |0.010470032691955566 |0.0035107582807540894 |9.296834468841553e-05 |0.0031566321849823 |0.0014040470123291016 |
----------------------------------------------------------pseudo_mini_loss sum 1.5480377674102783
Total (block generation + training)time/epoch 32.70766198635101
Training time/epoch 1.2960162162780762
Training time without block to device /epoch 1.128495693206787
Training time without total dataloading part /epoch 0.10956978797912598
load block tensor time/epoch 0.9596076011657715
block to device time/epoch 0.16752052307128906
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 11 |
Number of nodes for computation during this epoch:  5090451
Number of first layer input nodes during this epoch:  2470625
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11490678787231445  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0203855037689209
range selection method range initialization spend 0.0120849609375
time for parepare:  0.018708229064941406
local_output_nid generation:  0.001417398452758789
local_in_edges_tensor generation:  0.003290891647338867
mini_batch_src_global generation:  0.0016756057739257812
r_  generation:  0.01953601837158203
local_output_nid generation:  0.0015959739685058594
local_in_edges_tensor generation:  0.0009596347808837891
mini_batch_src_global generation:  0.0018067359924316406
r_  generation:  0.01914501190185547
local_output_nid generation:  0.0016083717346191406
local_in_edges_tensor generation:  0.0009527206420898438
mini_batch_src_global generation:  0.0014941692352294922
r_  generation:  0.019713163375854492
local_output_nid generation:  0.0016298294067382812
local_in_edges_tensor generation:  0.0009369850158691406
mini_batch_src_global generation:  0.0015141963958740234
r_  generation:  0.019114017486572266
local_output_nid generation:  0.0015933513641357422
local_in_edges_tensor generation:  0.000978708267211914
mini_batch_src_global generation:  0.0015037059783935547
r_  generation:  0.01910400390625
local_output_nid generation:  0.0016012191772460938
local_in_edges_tensor generation:  0.0009036064147949219
mini_batch_src_global generation:  0.0014824867248535156
r_  generation:  0.019019126892089844
local_output_nid generation:  0.0015900135040283203
local_in_edges_tensor generation:  0.0009303092956542969
mini_batch_src_global generation:  0.0015408992767333984
r_  generation:  0.019939661026000977
local_output_nid generation:  0.0015799999237060547
local_in_edges_tensor generation:  0.0009031295776367188
mini_batch_src_global generation:  0.0015633106231689453
r_  generation:  0.01940131187438965
local_output_nid generation:  0.0015859603881835938
local_in_edges_tensor generation:  0.0009975433349609375
mini_batch_src_global generation:  0.001547098159790039
r_  generation:  0.019934892654418945
local_output_nid generation:  0.0016295909881591797
local_in_edges_tensor generation:  0.0009260177612304688
mini_batch_src_global generation:  0.0015320777893066406
r_  generation:  0.019243717193603516
local_output_nid generation:  0.0016045570373535156
local_in_edges_tensor generation:  0.0009100437164306641
mini_batch_src_global generation:  0.0015544891357421875
r_  generation:  0.0202329158782959
local_output_nid generation:  0.0016961097717285156
local_in_edges_tensor generation:  0.0009839534759521484
mini_batch_src_global generation:  0.0015900135040283203
r_  generation:  0.022501707077026367
local_output_nid generation:  0.0016438961029052734
local_in_edges_tensor generation:  0.0009589195251464844
mini_batch_src_global generation:  0.0018301010131835938
r_  generation:  0.01936793327331543
local_output_nid generation:  0.0016388893127441406
local_in_edges_tensor generation:  0.0009541511535644531
mini_batch_src_global generation:  0.0015025138854980469
r_  generation:  0.0191190242767334
local_output_nid generation:  0.0016164779663085938
local_in_edges_tensor generation:  0.0009162425994873047
mini_batch_src_global generation:  0.0015077590942382812
r_  generation:  0.019712209701538086
local_output_nid generation:  0.0016062259674072266
local_in_edges_tensor generation:  0.0009701251983642578
mini_batch_src_global generation:  0.0015411376953125
r_  generation:  0.019200801849365234
----------------------check_connections_block total spend ----------------------------- 0.4705653190612793
generate_one_block  0.027919292449951172
generate_one_block  0.028147459030151367
generate_one_block  0.027849197387695312
generate_one_block  0.02754998207092285
generate_one_block  0.02741074562072754
generate_one_block  0.02927231788635254
generate_one_block  0.02806258201599121
generate_one_block  0.02784109115600586
generate_one_block  0.027976512908935547
generate_one_block  0.0273745059967041
generate_one_block  0.02759718894958496
generate_one_block  0.02709817886352539
generate_one_block  0.027538537979125977
generate_one_block  0.0275421142578125
generate_one_block  0.02790069580078125
generate_one_block  0.027889013290405273
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.032769203186035156
gen group dst list time:  0.01569509506225586
time for parepare:  0.01942753791809082
local_output_nid generation:  0.0066547393798828125
local_in_edges_tensor generation:  0.020355701446533203
mini_batch_src_global generation:  0.0212249755859375
r_  generation:  0.20273637771606445
local_output_nid generation:  0.010436058044433594
local_in_edges_tensor generation:  0.016144514083862305
mini_batch_src_global generation:  0.025653839111328125
r_  generation:  0.20007562637329102
local_output_nid generation:  0.01089787483215332
local_in_edges_tensor generation:  0.01147770881652832
mini_batch_src_global generation:  0.02522754669189453
r_  generation:  0.2064368724822998
local_output_nid generation:  0.01122593879699707
local_in_edges_tensor generation:  0.011962890625
mini_batch_src_global generation:  0.024610042572021484
r_  generation:  0.208510160446167
local_output_nid generation:  0.011671781539916992
local_in_edges_tensor generation:  0.014474630355834961
mini_batch_src_global generation:  0.026874780654907227
r_  generation:  0.20684099197387695
local_output_nid generation:  0.011687040328979492
local_in_edges_tensor generation:  0.012239694595336914
mini_batch_src_global generation:  0.025605201721191406
r_  generation:  0.2119302749633789
local_output_nid generation:  0.011955499649047852
local_in_edges_tensor generation:  0.014133214950561523
mini_batch_src_global generation:  0.026067256927490234
r_  generation:  0.21284222602844238
local_output_nid generation:  0.011963605880737305
local_in_edges_tensor generation:  0.011611700057983398
mini_batch_src_global generation:  0.02575397491455078
r_  generation:  0.21010971069335938
local_output_nid generation:  0.012247085571289062
local_in_edges_tensor generation:  0.011606454849243164
mini_batch_src_global generation:  0.027102231979370117
r_  generation:  0.21598458290100098
local_output_nid generation:  0.011992931365966797
local_in_edges_tensor generation:  0.011566638946533203
mini_batch_src_global generation:  0.026102781295776367
r_  generation:  0.2081313133239746
local_output_nid generation:  0.011887311935424805
local_in_edges_tensor generation:  0.011073112487792969
mini_batch_src_global generation:  0.02656722068786621
r_  generation:  0.2122492790222168
local_output_nid generation:  0.011872529983520508
local_in_edges_tensor generation:  0.011449098587036133
mini_batch_src_global generation:  0.026027202606201172
r_  generation:  0.20858502388000488
local_output_nid generation:  0.012209892272949219
local_in_edges_tensor generation:  0.013968706130981445
mini_batch_src_global generation:  0.026278972625732422
r_  generation:  0.21184492111206055
local_output_nid generation:  0.012222766876220703
local_in_edges_tensor generation:  0.011585235595703125
mini_batch_src_global generation:  0.026441335678100586
r_  generation:  0.21186304092407227
local_output_nid generation:  0.012418508529663086
local_in_edges_tensor generation:  0.012494325637817383
mini_batch_src_global generation:  0.028072595596313477
r_  generation:  0.21590375900268555
local_output_nid generation:  0.011607885360717773
local_in_edges_tensor generation:  0.011543512344360352
mini_batch_src_global generation:  0.026374101638793945
r_  generation:  0.2111058235168457
----------------------check_connections_block total spend ----------------------------- 4.920064687728882
generate_one_block  0.27696704864501953
generate_one_block  0.27462053298950195
generate_one_block  0.2744579315185547
generate_one_block  0.2683568000793457
generate_one_block  0.26666784286499023
generate_one_block  0.2629988193511963
generate_one_block  0.2910592555999756
generate_one_block  0.26334691047668457
generate_one_block  0.27495813369750977
generate_one_block  0.2617824077606201
generate_one_block  0.2682511806488037
generate_one_block  0.2624483108520508
generate_one_block  0.2675442695617676
generate_one_block  0.26758885383605957
generate_one_block  0.27382874488830566
generate_one_block  0.26523447036743164
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03336524963378906
gen group dst list time:  0.06185793876647949
time for parepare:  0.01809072494506836
local_output_nid generation:  0.02431511878967285
local_in_edges_tensor generation:  0.041310787200927734
mini_batch_src_global generation:  0.04202914237976074
r_  generation:  0.4606618881225586
local_output_nid generation:  0.03335070610046387
local_in_edges_tensor generation:  0.03724193572998047
mini_batch_src_global generation:  0.051764488220214844
r_  generation:  0.4470503330230713
local_output_nid generation:  0.03165102005004883
local_in_edges_tensor generation:  0.029695987701416016
mini_batch_src_global generation:  0.05061507225036621
r_  generation:  0.4553952217102051
local_output_nid generation:  0.03141975402832031
local_in_edges_tensor generation:  0.03350186347961426
mini_batch_src_global generation:  0.052022695541381836
r_  generation:  0.4531989097595215
local_output_nid generation:  0.03169608116149902
local_in_edges_tensor generation:  0.07811832427978516
mini_batch_src_global generation:  0.050969839096069336
r_  generation:  0.4550013542175293
local_output_nid generation:  0.03055882453918457
local_in_edges_tensor generation:  0.028512239456176758
mini_batch_src_global generation:  0.05239129066467285
r_  generation:  0.44928812980651855
local_output_nid generation:  0.03103327751159668
local_in_edges_tensor generation:  0.03024005889892578
mini_batch_src_global generation:  0.05224752426147461
r_  generation:  0.4566330909729004
local_output_nid generation:  0.03062748908996582
local_in_edges_tensor generation:  0.028815507888793945
mini_batch_src_global generation:  0.05247020721435547
r_  generation:  0.45117735862731934
local_output_nid generation:  0.031245708465576172
local_in_edges_tensor generation:  0.0356748104095459
mini_batch_src_global generation:  0.05186772346496582
r_  generation:  0.45667123794555664
local_output_nid generation:  0.030724525451660156
local_in_edges_tensor generation:  0.03112626075744629
mini_batch_src_global generation:  0.05301713943481445
r_  generation:  0.44981813430786133
local_output_nid generation:  0.03162264823913574
local_in_edges_tensor generation:  0.03011322021484375
mini_batch_src_global generation:  0.05129742622375488
r_  generation:  0.4580566883087158
local_output_nid generation:  0.03117966651916504
local_in_edges_tensor generation:  0.028619050979614258
mini_batch_src_global generation:  0.05222034454345703
r_  generation:  0.4499809741973877
local_output_nid generation:  0.031124114990234375
local_in_edges_tensor generation:  0.031005859375
mini_batch_src_global generation:  0.0515599250793457
r_  generation:  0.4586508274078369
local_output_nid generation:  0.031054973602294922
local_in_edges_tensor generation:  0.029659032821655273
mini_batch_src_global generation:  0.05264163017272949
r_  generation:  0.4506542682647705
local_output_nid generation:  0.031006574630737305
local_in_edges_tensor generation:  0.032813310623168945
mini_batch_src_global generation:  0.0534822940826416
r_  generation:  0.45679140090942383
local_output_nid generation:  0.030966997146606445
local_in_edges_tensor generation:  0.028653383255004883
mini_batch_src_global generation:  0.052678585052490234
r_  generation:  0.4539952278137207
----------------------check_connections_block total spend ----------------------------- 10.720928430557251
generate_one_block  0.5716342926025391
generate_one_block  0.5704038143157959
generate_one_block  0.5694551467895508
generate_one_block  0.5762686729431152
generate_one_block  0.5695583820343018
generate_one_block  0.5625460147857666
generate_one_block  0.5709357261657715
generate_one_block  0.5841693878173828
generate_one_block  0.636218786239624
generate_one_block  0.5652189254760742
generate_one_block  0.5774829387664795
generate_one_block  0.5657176971435547
generate_one_block  0.5823404788970947
generate_one_block  0.5760602951049805
generate_one_block  0.5778462886810303
generate_one_block  0.5692410469055176
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11490678787231445  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

connection checking time:  15.640993118286133
block generation total time  13.545209407806396
average batch blocks generation time:  0.8465755879878998
block dataloader generation time/epoch 31.319496154785156
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09411859512329102  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7201833724975586  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09348773956298828  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7171430587768555  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09398746490478516  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.720679759979248  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09361553192138672  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7204480171203613  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09384346008300781  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7178969383239746  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09331274032592773  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7157397270202637  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09389114379882812  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7176051139831543  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09328365325927734  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7166461944580078  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09399700164794922  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.720766544342041  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09302663803100586  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7101211547851562  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09389209747314453  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7201008796691895  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09326696395874023  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7151141166687012  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09383296966552734  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7169227600097656  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09335994720458984  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.716895580291748  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0939493179321289  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7188386917114258  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09332132339477539  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7166962623596191  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.058729708194732666 |0.009160995483398438 |0.0034728795289993286 |8.989870548248291e-05 |0.0030799657106399536 |0.0028603076934814453 |
----------------------------------------------------------pseudo_mini_loss sum 1.5133808851242065
Total (block generation + training)time/epoch 32.60659170150757
Training time/epoch 1.2555959224700928
Training time without block to device /epoch 1.1090199947357178
Training time without total dataloading part /epoch 0.10914421081542969
load block tensor time/epoch 0.9396753311157227
block to device time/epoch 0.146575927734375
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 12 |
Number of nodes for computation during this epoch:  5092831
Number of first layer input nodes during this epoch:  2472548
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11507511138916016  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.017539024353027344
range selection method range initialization spend 0.012069463729858398
time for parepare:  0.017200469970703125
local_output_nid generation:  0.0014200210571289062
local_in_edges_tensor generation:  0.0055429935455322266
mini_batch_src_global generation:  0.0015492439270019531
r_  generation:  0.018445253372192383
local_output_nid generation:  0.0015399456024169922
local_in_edges_tensor generation:  0.0009541511535644531
mini_batch_src_global generation:  0.0017976760864257812
r_  generation:  0.019687175750732422
local_output_nid generation:  0.0015430450439453125
local_in_edges_tensor generation:  0.0008966922760009766
mini_batch_src_global generation:  0.0014774799346923828
r_  generation:  0.018590211868286133
local_output_nid generation:  0.0015473365783691406
local_in_edges_tensor generation:  0.0009112358093261719
mini_batch_src_global generation:  0.0014884471893310547
r_  generation:  0.01868724822998047
local_output_nid generation:  0.0015749931335449219
local_in_edges_tensor generation:  0.0009238719940185547
mini_batch_src_global generation:  0.0014688968658447266
r_  generation:  0.0187225341796875
local_output_nid generation:  0.0015387535095214844
local_in_edges_tensor generation:  0.0008909702301025391
mini_batch_src_global generation:  0.0014896392822265625
r_  generation:  0.018880128860473633
local_output_nid generation:  0.0015451908111572266
local_in_edges_tensor generation:  0.000985860824584961
mini_batch_src_global generation:  0.0016210079193115234
r_  generation:  0.019847869873046875
local_output_nid generation:  0.0015838146209716797
local_in_edges_tensor generation:  0.0008847713470458984
mini_batch_src_global generation:  0.001535177230834961
r_  generation:  0.019171714782714844
local_output_nid generation:  0.0015845298767089844
local_in_edges_tensor generation:  0.0008928775787353516
mini_batch_src_global generation:  0.0014920234680175781
r_  generation:  0.019205093383789062
local_output_nid generation:  0.0015363693237304688
local_in_edges_tensor generation:  0.0009014606475830078
mini_batch_src_global generation:  0.00151824951171875
r_  generation:  0.019213199615478516
local_output_nid generation:  0.0015416145324707031
local_in_edges_tensor generation:  0.0008802413940429688
mini_batch_src_global generation:  0.0014982223510742188
r_  generation:  0.01936197280883789
local_output_nid generation:  0.0015683174133300781
local_in_edges_tensor generation:  0.0008852481842041016
mini_batch_src_global generation:  0.0015347003936767578
r_  generation:  0.019295215606689453
local_output_nid generation:  0.0015666484832763672
local_in_edges_tensor generation:  0.0008809566497802734
mini_batch_src_global generation:  0.0015017986297607422
r_  generation:  0.01919841766357422
local_output_nid generation:  0.0015332698822021484
local_in_edges_tensor generation:  0.0009322166442871094
mini_batch_src_global generation:  0.001499176025390625
r_  generation:  0.019145488739013672
local_output_nid generation:  0.001524209976196289
local_in_edges_tensor generation:  0.0008676052093505859
mini_batch_src_global generation:  0.0014719963073730469
r_  generation:  0.019113779067993164
local_output_nid generation:  0.0015482902526855469
local_in_edges_tensor generation:  0.0009379386901855469
mini_batch_src_global generation:  0.0015246868133544922
r_  generation:  0.019227981567382812
----------------------check_connections_block total spend ----------------------------- 0.45947718620300293
generate_one_block  0.026813745498657227
generate_one_block  0.028400897979736328
generate_one_block  0.027256488800048828
generate_one_block  0.027750253677368164
generate_one_block  0.027332305908203125
generate_one_block  0.029119014739990234
generate_one_block  0.028333663940429688
generate_one_block  0.027245283126831055
generate_one_block  0.027512073516845703
generate_one_block  0.028061389923095703
generate_one_block  0.027584552764892578
generate_one_block  0.027667760848999023
generate_one_block  0.02789902687072754
generate_one_block  0.027338027954101562
generate_one_block  0.027661800384521484
generate_one_block  0.02827286720275879
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029842853546142578
gen group dst list time:  0.015581130981445312
time for parepare:  0.019527196884155273
local_output_nid generation:  0.006616830825805664
local_in_edges_tensor generation:  0.016556501388549805
mini_batch_src_global generation:  0.019617557525634766
r_  generation:  0.18705987930297852
local_output_nid generation:  0.009987831115722656
local_in_edges_tensor generation:  0.012361288070678711
mini_batch_src_global generation:  0.025413990020751953
r_  generation:  0.2004401683807373
local_output_nid generation:  0.010072708129882812
local_in_edges_tensor generation:  0.010901212692260742
mini_batch_src_global generation:  0.023347139358520508
r_  generation:  0.2005023956298828
local_output_nid generation:  0.010710477828979492
local_in_edges_tensor generation:  0.011014938354492188
mini_batch_src_global generation:  0.02419590950012207
r_  generation:  0.20465683937072754
local_output_nid generation:  0.011317968368530273
local_in_edges_tensor generation:  0.011062383651733398
mini_batch_src_global generation:  0.025254249572753906
r_  generation:  0.20699691772460938
local_output_nid generation:  0.01096200942993164
local_in_edges_tensor generation:  0.011925935745239258
mini_batch_src_global generation:  0.02660346031188965
r_  generation:  0.20768141746520996
local_output_nid generation:  0.011624574661254883
local_in_edges_tensor generation:  0.01316523551940918
mini_batch_src_global generation:  0.02779245376586914
r_  generation:  0.21381855010986328
local_output_nid generation:  0.011461734771728516
local_in_edges_tensor generation:  0.011508703231811523
mini_batch_src_global generation:  0.026207447052001953
r_  generation:  0.20953774452209473
local_output_nid generation:  0.01168203353881836
local_in_edges_tensor generation:  0.011711359024047852
mini_batch_src_global generation:  0.027068614959716797
r_  generation:  0.21393489837646484
local_output_nid generation:  0.011842489242553711
local_in_edges_tensor generation:  0.011704683303833008
mini_batch_src_global generation:  0.026530981063842773
r_  generation:  0.21654105186462402
local_output_nid generation:  0.011414766311645508
local_in_edges_tensor generation:  0.011438846588134766
mini_batch_src_global generation:  0.027099609375
r_  generation:  0.2127666473388672
local_output_nid generation:  0.011372566223144531
local_in_edges_tensor generation:  0.011246681213378906
mini_batch_src_global generation:  0.026429414749145508
r_  generation:  0.20971918106079102
local_output_nid generation:  0.01184535026550293
local_in_edges_tensor generation:  0.012052774429321289
mini_batch_src_global generation:  0.027037858963012695
r_  generation:  0.2147212028503418
local_output_nid generation:  0.011809110641479492
local_in_edges_tensor generation:  0.011383056640625
mini_batch_src_global generation:  0.02684783935546875
r_  generation:  0.2129991054534912
local_output_nid generation:  0.011868000030517578
local_in_edges_tensor generation:  0.011190176010131836
mini_batch_src_global generation:  0.02651667594909668
r_  generation:  0.21202611923217773
local_output_nid generation:  0.011467456817626953
local_in_edges_tensor generation:  0.011319160461425781
mini_batch_src_global generation:  0.02620387077331543
r_  generation:  0.21172451972961426
----------------------check_connections_block total spend ----------------------------- 4.870542287826538
generate_one_block  0.2624642848968506
generate_one_block  0.2674856185913086
generate_one_block  0.2613818645477295
generate_one_block  0.26637935638427734
generate_one_block  0.2629566192626953
generate_one_block  0.2636394500732422
generate_one_block  0.295562744140625
generate_one_block  0.2636301517486572
generate_one_block  0.26989150047302246
generate_one_block  0.26935362815856934
generate_one_block  0.26784372329711914
generate_one_block  0.2634589672088623
generate_one_block  0.2713320255279541
generate_one_block  0.2714812755584717
generate_one_block  0.26749396324157715
generate_one_block  0.26627397537231445
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.031141281127929688
gen group dst list time:  0.06254100799560547
time for parepare:  0.01917123794555664
local_output_nid generation:  0.02431321144104004
local_in_edges_tensor generation:  0.036740779876708984
mini_batch_src_global generation:  0.03981471061706543
r_  generation:  0.44425392150878906
local_output_nid generation:  0.02982330322265625
local_in_edges_tensor generation:  0.03612947463989258
mini_batch_src_global generation:  0.05354928970336914
r_  generation:  0.4476466178894043
local_output_nid generation:  0.029393672943115234
local_in_edges_tensor generation:  0.028890371322631836
mini_batch_src_global generation:  0.05825614929199219
r_  generation:  0.455303430557251
local_output_nid generation:  0.029684066772460938
local_in_edges_tensor generation:  0.030150175094604492
mini_batch_src_global generation:  0.053763389587402344
r_  generation:  0.45220398902893066
local_output_nid generation:  0.030215740203857422
local_in_edges_tensor generation:  0.06961393356323242
mini_batch_src_global generation:  0.05115675926208496
r_  generation:  0.4526512622833252
local_output_nid generation:  0.029923439025878906
local_in_edges_tensor generation:  0.02966785430908203
mini_batch_src_global generation:  0.0522761344909668
r_  generation:  0.44683265686035156
local_output_nid generation:  0.03003835678100586
local_in_edges_tensor generation:  0.03133344650268555
mini_batch_src_global generation:  0.05478239059448242
r_  generation:  0.45738768577575684
local_output_nid generation:  0.03005218505859375
local_in_edges_tensor generation:  0.030753612518310547
mini_batch_src_global generation:  0.054233551025390625
r_  generation:  0.44916224479675293
local_output_nid generation:  0.03003215789794922
local_in_edges_tensor generation:  0.029741525650024414
mini_batch_src_global generation:  0.05728316307067871
r_  generation:  0.4577665328979492
local_output_nid generation:  0.03025674819946289
local_in_edges_tensor generation:  0.034847259521484375
mini_batch_src_global generation:  0.05669212341308594
r_  generation:  0.4764893054962158
local_output_nid generation:  0.03281569480895996
local_in_edges_tensor generation:  0.029744625091552734
mini_batch_src_global generation:  0.05300307273864746
r_  generation:  0.45110607147216797
local_output_nid generation:  0.030785799026489258
local_in_edges_tensor generation:  0.030313968658447266
mini_batch_src_global generation:  0.05462837219238281
r_  generation:  0.45687031745910645
local_output_nid generation:  0.03141975402832031
local_in_edges_tensor generation:  0.03057575225830078
mini_batch_src_global generation:  0.053949594497680664
r_  generation:  0.4594838619232178
local_output_nid generation:  0.0309903621673584
local_in_edges_tensor generation:  0.03230690956115723
mini_batch_src_global generation:  0.0527951717376709
r_  generation:  0.45262908935546875
local_output_nid generation:  0.03088092803955078
local_in_edges_tensor generation:  0.028730154037475586
mini_batch_src_global generation:  0.052022457122802734
r_  generation:  0.4559152126312256
local_output_nid generation:  0.03141903877258301
local_in_edges_tensor generation:  0.030022621154785156
mini_batch_src_global generation:  0.05502676963806152
r_  generation:  0.45467448234558105
----------------------check_connections_block total spend ----------------------------- 10.728386640548706
generate_one_block  0.5723257064819336
generate_one_block  0.5735371112823486
generate_one_block  0.5698239803314209
generate_one_block  0.6055834293365479
generate_one_block  0.5823402404785156
generate_one_block  0.5761370658874512
generate_one_block  0.6013259887695312
generate_one_block  0.5922741889953613
generate_one_block  0.6325061321258545
generate_one_block  0.5926253795623779
generate_one_block  0.5783383846282959
generate_one_block  0.5739624500274658
generate_one_block  0.5817959308624268
generate_one_block  0.5880842208862305
generate_one_block  0.5899088382720947
generate_one_block  0.592660665512085
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11507511138916016  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

connection checking time:  15.598928928375244
block generation total time  13.693858861923218
average batch blocks generation time:  0.8558661788702011
block dataloader generation time/epoch 31.301807463169098
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09379053115844727  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7134809494018555  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09333992004394531  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.717989444732666  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09379100799560547  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7172818183898926  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09336519241333008  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7171282768249512  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09380340576171875  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7165117263793945  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09295654296875  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7099919319152832  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09403133392333984  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7205452919006348  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09334039688110352  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7158637046813965  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09398365020751953  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7190852165222168  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09327316284179688  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7184977531433105  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0939188003540039  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7174010276794434  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09313726425170898  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7164392471313477  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09398269653320312  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7188191413879395  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09335803985595703  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.717158317565918  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09386539459228516  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7179670333862305  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0932779312133789  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7173500061035156  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05853456258773804 |0.015132993459701538 |0.0035467445850372314 |9.274482727050781e-05 |0.003315761685371399 |0.0014412403106689453 |
----------------------------------------------------------pseudo_mini_loss sum 1.4814021587371826
Total (block generation + training)time/epoch 32.60572552680969
Training time/epoch 1.3541021347045898
Training time without block to device /epoch 1.1119742393493652
Training time without total dataloading part /epoch 0.11272525787353516
load block tensor time/epoch 0.9365530014038086
block to device time/epoch 0.2421278953552246
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 13 |
Number of nodes for computation during this epoch:  5087159
Number of first layer input nodes during this epoch:  2469780
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11509370803833008  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021221160888671875
range selection method range initialization spend 0.015105009078979492
time for parepare:  0.01790904998779297
local_output_nid generation:  0.0015130043029785156
local_in_edges_tensor generation:  0.00699615478515625
mini_batch_src_global generation:  0.0015900135040283203
r_  generation:  0.0186307430267334
local_output_nid generation:  0.0016202926635742188
local_in_edges_tensor generation:  0.0009565353393554688
mini_batch_src_global generation:  0.0017647743225097656
r_  generation:  0.01958441734313965
local_output_nid generation:  0.0016238689422607422
local_in_edges_tensor generation:  0.0009326934814453125
mini_batch_src_global generation:  0.001463174819946289
r_  generation:  0.018683910369873047
local_output_nid generation:  0.0016107559204101562
local_in_edges_tensor generation:  0.0009379386901855469
mini_batch_src_global generation:  0.0015747547149658203
r_  generation:  0.019344568252563477
local_output_nid generation:  0.0015537738800048828
local_in_edges_tensor generation:  0.0008814334869384766
mini_batch_src_global generation:  0.0015282630920410156
r_  generation:  0.019276857376098633
local_output_nid generation:  0.001584768295288086
local_in_edges_tensor generation:  0.0009028911590576172
mini_batch_src_global generation:  0.0015320777893066406
r_  generation:  0.019505977630615234
local_output_nid generation:  0.0016283988952636719
local_in_edges_tensor generation:  0.0009603500366210938
mini_batch_src_global generation:  0.0015594959259033203
r_  generation:  0.019841670989990234
local_output_nid generation:  0.0017590522766113281
local_in_edges_tensor generation:  0.0009636878967285156
mini_batch_src_global generation:  0.0015711784362792969
r_  generation:  0.01958632469177246
local_output_nid generation:  0.0016751289367675781
local_in_edges_tensor generation:  0.0009474754333496094
mini_batch_src_global generation:  0.0015172958374023438
r_  generation:  0.019369840621948242
local_output_nid generation:  0.0016655921936035156
local_in_edges_tensor generation:  0.000904083251953125
mini_batch_src_global generation:  0.0015573501586914062
r_  generation:  0.02010059356689453
local_output_nid generation:  0.0016872882843017578
local_in_edges_tensor generation:  0.0009090900421142578
mini_batch_src_global generation:  0.0015766620635986328
r_  generation:  0.019673824310302734
local_output_nid generation:  0.0016925334930419922
local_in_edges_tensor generation:  0.0009229183197021484
mini_batch_src_global generation:  0.0015447139739990234
r_  generation:  0.0195004940032959
local_output_nid generation:  0.0016903877258300781
local_in_edges_tensor generation:  0.0009517669677734375
mini_batch_src_global generation:  0.0015401840209960938
r_  generation:  0.01913142204284668
local_output_nid generation:  0.001676797866821289
local_in_edges_tensor generation:  0.0009398460388183594
mini_batch_src_global generation:  0.0015134811401367188
r_  generation:  0.023459911346435547
local_output_nid generation:  0.0017027854919433594
local_in_edges_tensor generation:  0.0010924339294433594
mini_batch_src_global generation:  0.0015645027160644531
r_  generation:  0.019411087036132812
local_output_nid generation:  0.0016598701477050781
local_in_edges_tensor generation:  0.0008833408355712891
mini_batch_src_global generation:  0.001522064208984375
r_  generation:  0.020082712173461914
----------------------check_connections_block total spend ----------------------------- 0.47947049140930176
generate_one_block  0.02802300453186035
generate_one_block  0.02802586555480957
generate_one_block  0.02778458595275879
generate_one_block  0.028046846389770508
generate_one_block  0.027607202529907227
generate_one_block  0.029771804809570312
generate_one_block  0.028104066848754883
generate_one_block  0.027557849884033203
generate_one_block  0.02773761749267578
generate_one_block  0.027960777282714844
generate_one_block  0.02770543098449707
generate_one_block  0.02749490737915039
generate_one_block  0.027326583862304688
generate_one_block  0.027731895446777344
generate_one_block  0.02769613265991211
generate_one_block  0.028254985809326172
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03263521194458008
gen group dst list time:  0.01688838005065918
time for parepare:  0.01964116096496582
local_output_nid generation:  0.006809711456298828
local_in_edges_tensor generation:  0.023654699325561523
mini_batch_src_global generation:  0.02056288719177246
r_  generation:  0.1946091651916504
local_output_nid generation:  0.010050773620605469
local_in_edges_tensor generation:  0.014065742492675781
mini_batch_src_global generation:  0.025498628616333008
r_  generation:  0.19786453247070312
local_output_nid generation:  0.010481595993041992
local_in_edges_tensor generation:  0.014219045639038086
mini_batch_src_global generation:  0.024297475814819336
r_  generation:  0.20466899871826172
local_output_nid generation:  0.01112055778503418
local_in_edges_tensor generation:  0.012172222137451172
mini_batch_src_global generation:  0.02579212188720703
r_  generation:  0.21187114715576172
local_output_nid generation:  0.011410713195800781
local_in_edges_tensor generation:  0.011287450790405273
mini_batch_src_global generation:  0.025687217712402344
r_  generation:  0.2117142677307129
local_output_nid generation:  0.011629819869995117
local_in_edges_tensor generation:  0.012289285659790039
mini_batch_src_global generation:  0.026255130767822266
r_  generation:  0.2127528190612793
local_output_nid generation:  0.011857986450195312
local_in_edges_tensor generation:  0.012234687805175781
mini_batch_src_global generation:  0.026276826858520508
r_  generation:  0.21451210975646973
local_output_nid generation:  0.011772871017456055
local_in_edges_tensor generation:  0.011555671691894531
mini_batch_src_global generation:  0.02709794044494629
r_  generation:  0.2130293846130371
local_output_nid generation:  0.011794805526733398
local_in_edges_tensor generation:  0.012625455856323242
mini_batch_src_global generation:  0.026355981826782227
r_  generation:  0.2150421142578125
local_output_nid generation:  0.011929750442504883
local_in_edges_tensor generation:  0.011629104614257812
mini_batch_src_global generation:  0.026440858840942383
r_  generation:  0.21636700630187988
local_output_nid generation:  0.011993646621704102
local_in_edges_tensor generation:  0.01135110855102539
mini_batch_src_global generation:  0.02645134925842285
r_  generation:  0.21499419212341309
local_output_nid generation:  0.011693716049194336
local_in_edges_tensor generation:  0.011335134506225586
mini_batch_src_global generation:  0.02640843391418457
r_  generation:  0.21461224555969238
local_output_nid generation:  0.011921882629394531
local_in_edges_tensor generation:  0.013332128524780273
mini_batch_src_global generation:  0.026296615600585938
r_  generation:  0.21038413047790527
local_output_nid generation:  0.011938810348510742
local_in_edges_tensor generation:  0.01127934455871582
mini_batch_src_global generation:  0.026274442672729492
r_  generation:  0.2178211212158203
local_output_nid generation:  0.012099504470825195
local_in_edges_tensor generation:  0.011777639389038086
mini_batch_src_global generation:  0.026678085327148438
r_  generation:  0.21560382843017578
local_output_nid generation:  0.01172327995300293
local_in_edges_tensor generation:  0.013346433639526367
mini_batch_src_global generation:  0.02810978889465332
r_  generation:  0.21920299530029297
----------------------check_connections_block total spend ----------------------------- 4.95141339302063
generate_one_block  0.27807164192199707
generate_one_block  0.2645702362060547
generate_one_block  0.26727724075317383
generate_one_block  0.2768898010253906
generate_one_block  0.2710592746734619
generate_one_block  0.2703695297241211
generate_one_block  0.29894495010375977
generate_one_block  0.2695937156677246
generate_one_block  0.2665066719055176
generate_one_block  0.27529168128967285
generate_one_block  0.27413153648376465
generate_one_block  0.26703739166259766
generate_one_block  0.2691495418548584
generate_one_block  0.27350640296936035
generate_one_block  0.2709777355194092
generate_one_block  0.2758002281188965
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04293680191040039
gen group dst list time:  0.06394648551940918
time for parepare:  0.018360376358032227
local_output_nid generation:  0.0253293514251709
local_in_edges_tensor generation:  0.04429292678833008
mini_batch_src_global generation:  0.041717529296875
r_  generation:  0.4509613513946533
local_output_nid generation:  0.030075550079345703
local_in_edges_tensor generation:  0.03619384765625
mini_batch_src_global generation:  0.05181002616882324
r_  generation:  0.4493401050567627
local_output_nid generation:  0.030793428421020508
local_in_edges_tensor generation:  0.03772902488708496
mini_batch_src_global generation:  0.05285048484802246
r_  generation:  0.47193408012390137
local_output_nid generation:  0.031002521514892578
local_in_edges_tensor generation:  0.034423112869262695
mini_batch_src_global generation:  0.058850765228271484
r_  generation:  0.45417261123657227
local_output_nid generation:  0.03194093704223633
local_in_edges_tensor generation:  0.0820775032043457
mini_batch_src_global generation:  0.05205416679382324
r_  generation:  0.45626401901245117
local_output_nid generation:  0.03035426139831543
local_in_edges_tensor generation:  0.02888035774230957
mini_batch_src_global generation:  0.05283617973327637
r_  generation:  0.45323824882507324
local_output_nid generation:  0.030364990234375
local_in_edges_tensor generation:  0.034972429275512695
mini_batch_src_global generation:  0.0521245002746582
r_  generation:  0.45636534690856934
local_output_nid generation:  0.030611753463745117
local_in_edges_tensor generation:  0.029307126998901367
mini_batch_src_global generation:  0.052675485610961914
r_  generation:  0.4550943374633789
local_output_nid generation:  0.030660629272460938
local_in_edges_tensor generation:  0.02849435806274414
mini_batch_src_global generation:  0.054443359375
r_  generation:  0.4536173343658447
local_output_nid generation:  0.030574560165405273
local_in_edges_tensor generation:  0.031273841857910156
mini_batch_src_global generation:  0.05356860160827637
r_  generation:  0.4535975456237793
local_output_nid generation:  0.0308229923248291
local_in_edges_tensor generation:  0.03046894073486328
mini_batch_src_global generation:  0.05162692070007324
r_  generation:  0.458282470703125
local_output_nid generation:  0.030777692794799805
local_in_edges_tensor generation:  0.03431987762451172
mini_batch_src_global generation:  0.05247187614440918
r_  generation:  0.4521341323852539
local_output_nid generation:  0.030802011489868164
local_in_edges_tensor generation:  0.03059101104736328
mini_batch_src_global generation:  0.05192112922668457
r_  generation:  0.4565432071685791
local_output_nid generation:  0.031084060668945312
local_in_edges_tensor generation:  0.03145718574523926
mini_batch_src_global generation:  0.05286598205566406
r_  generation:  0.45327234268188477
local_output_nid generation:  0.030797958374023438
local_in_edges_tensor generation:  0.02852177619934082
mini_batch_src_global generation:  0.05194687843322754
r_  generation:  0.45566582679748535
local_output_nid generation:  0.030837535858154297
local_in_edges_tensor generation:  0.03073883056640625
mini_batch_src_global generation:  0.05279707908630371
r_  generation:  0.453326940536499
----------------------check_connections_block total spend ----------------------------- 10.76887059211731
generate_one_block  0.5819542407989502
generate_one_block  0.5699121952056885
generate_one_block  0.5808842182159424
generate_one_block  0.5802278518676758
generate_one_block  0.5740444660186768
generate_one_block  0.5801482200622559
generate_one_block  0.5842795372009277
generate_one_block  0.5847537517547607
generate_one_block  0.6511998176574707
generate_one_block  0.6087825298309326
generate_one_block  0.592355489730835
generate_one_block  0.578162670135498
generate_one_block  0.5765442848205566
generate_one_block  0.5890111923217773
generate_one_block  0.590357780456543
generate_one_block  0.5950877666473389
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11509370803833008  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

connection checking time:  15.72028398513794
block generation total time  13.78688359260559
average batch blocks generation time:  0.8616802245378494
block dataloader generation time/epoch 31.345444250106812
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09398984909057617  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7209978103637695  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09314393997192383  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7094392776489258  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09392547607421875  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7192287445068359  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09348440170288086  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7190179824829102  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09393310546875  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7195520401000977  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09338617324829102  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7183012962341309  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0939788818359375  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7209224700927734  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09331750869750977  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.716339111328125  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09383106231689453  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7132821083068848  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09334945678710938  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7185306549072266  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09392642974853516  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7180089950561523  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0933523178100586  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7165603637695312  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0937490463256836  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7162203788757324  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0934300422668457  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7165427207946777  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0938558578491211  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7168064117431641  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09346246719360352  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7184739112854004  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06341394782066345 |0.014739349484443665 |0.0035754740238189697 |9.441375732421875e-05 |0.0037227869033813477 |0.0028662681579589844 |
----------------------------------------------------------pseudo_mini_loss sum 1.4531550407409668
Total (block generation + training)time/epoch 32.67470798492432
Training time/epoch 1.4304289817810059
Training time without block to device /epoch 1.1945993900299072
Training time without total dataloading part /epoch 0.12114906311035156
load block tensor time/epoch 1.0146231651306152
block to device time/epoch 0.23582959175109863
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 14 |
Number of nodes for computation during this epoch:  5093538
Number of first layer input nodes during this epoch:  2472206
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11556577682495117  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02001333236694336
range selection method range initialization spend 0.012075662612915039
time for parepare:  0.01917719841003418
local_output_nid generation:  0.0014834403991699219
local_in_edges_tensor generation:  0.0041353702545166016
mini_batch_src_global generation:  0.0018668174743652344
r_  generation:  0.017871379852294922
local_output_nid generation:  0.0015714168548583984
local_in_edges_tensor generation:  0.0009963512420654297
mini_batch_src_global generation:  0.002068042755126953
r_  generation:  0.01960158348083496
local_output_nid generation:  0.0015633106231689453
local_in_edges_tensor generation:  0.0009407997131347656
mini_batch_src_global generation:  0.0015025138854980469
r_  generation:  0.018519163131713867
local_output_nid generation:  0.0016007423400878906
local_in_edges_tensor generation:  0.0009317398071289062
mini_batch_src_global generation:  0.0016040802001953125
r_  generation:  0.019206762313842773
local_output_nid generation:  0.0015599727630615234
local_in_edges_tensor generation:  0.0009171962738037109
mini_batch_src_global generation:  0.0014865398406982422
r_  generation:  0.018385887145996094
local_output_nid generation:  0.0015816688537597656
local_in_edges_tensor generation:  0.000926971435546875
mini_batch_src_global generation:  0.0015180110931396484
r_  generation:  0.01900315284729004
local_output_nid generation:  0.001566171646118164
local_in_edges_tensor generation:  0.0009026527404785156
mini_batch_src_global generation:  0.0015575885772705078
r_  generation:  0.01943683624267578
local_output_nid generation:  0.0015645027160644531
local_in_edges_tensor generation:  0.0009431838989257812
mini_batch_src_global generation:  0.0015590190887451172
r_  generation:  0.01961207389831543
local_output_nid generation:  0.0015895366668701172
local_in_edges_tensor generation:  0.0009961128234863281
mini_batch_src_global generation:  0.0015490055084228516
r_  generation:  0.01968860626220703
local_output_nid generation:  0.0015597343444824219
local_in_edges_tensor generation:  0.0011167526245117188
mini_batch_src_global generation:  0.0015919208526611328
r_  generation:  0.02009272575378418
local_output_nid generation:  0.0016171932220458984
local_in_edges_tensor generation:  0.0009145736694335938
mini_batch_src_global generation:  0.0015888214111328125
r_  generation:  0.01930999755859375
local_output_nid generation:  0.001567840576171875
local_in_edges_tensor generation:  0.0009560585021972656
mini_batch_src_global generation:  0.0015790462493896484
r_  generation:  0.020011186599731445
local_output_nid generation:  0.001561880111694336
local_in_edges_tensor generation:  0.0009288787841796875
mini_batch_src_global generation:  0.001575469970703125
r_  generation:  0.019753217697143555
local_output_nid generation:  0.001554250717163086
local_in_edges_tensor generation:  0.0009524822235107422
mini_batch_src_global generation:  0.0015621185302734375
r_  generation:  0.019187450408935547
local_output_nid generation:  0.0015690326690673828
local_in_edges_tensor generation:  0.000957489013671875
mini_batch_src_global generation:  0.001531839370727539
r_  generation:  0.019340038299560547
local_output_nid generation:  0.0015790462493896484
local_in_edges_tensor generation:  0.0009043216705322266
mini_batch_src_global generation:  0.0015883445739746094
r_  generation:  0.020000457763671875
----------------------check_connections_block total spend ----------------------------- 0.4725944995880127
generate_one_block  0.027197599411010742
generate_one_block  0.02823472023010254
generate_one_block  0.027364492416381836
generate_one_block  0.02811884880065918
generate_one_block  0.02720928192138672
generate_one_block  0.029331445693969727
generate_one_block  0.027780532836914062
generate_one_block  0.028172969818115234
generate_one_block  0.028348684310913086
generate_one_block  0.0286557674407959
generate_one_block  0.027927398681640625
generate_one_block  0.028224468231201172
generate_one_block  0.027800321578979492
generate_one_block  0.027660846710205078
generate_one_block  0.0279388427734375
generate_one_block  0.029147863388061523
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03198838233947754
gen group dst list time:  0.016748666763305664
time for parepare:  0.019854307174682617
local_output_nid generation:  0.006765127182006836
local_in_edges_tensor generation:  0.019303321838378906
mini_batch_src_global generation:  0.019960403442382812
r_  generation:  0.18912649154663086
local_output_nid generation:  0.010129928588867188
local_in_edges_tensor generation:  0.013862848281860352
mini_batch_src_global generation:  0.025232553482055664
r_  generation:  0.20020389556884766
local_output_nid generation:  0.01038503646850586
local_in_edges_tensor generation:  0.010872125625610352
mini_batch_src_global generation:  0.022990703582763672
r_  generation:  0.2012465000152588
local_output_nid generation:  0.011173248291015625
local_in_edges_tensor generation:  0.012677907943725586
mini_batch_src_global generation:  0.024560213088989258
r_  generation:  0.209259033203125
local_output_nid generation:  0.011291027069091797
local_in_edges_tensor generation:  0.011087894439697266
mini_batch_src_global generation:  0.0251157283782959
r_  generation:  0.20656991004943848
local_output_nid generation:  0.011487007141113281
local_in_edges_tensor generation:  0.011319160461425781
mini_batch_src_global generation:  0.025679349899291992
r_  generation:  0.20946502685546875
local_output_nid generation:  0.01151418685913086
local_in_edges_tensor generation:  0.010806798934936523
mini_batch_src_global generation:  0.025606870651245117
r_  generation:  0.21114492416381836
local_output_nid generation:  0.01188516616821289
local_in_edges_tensor generation:  0.012135028839111328
mini_batch_src_global generation:  0.02736043930053711
r_  generation:  0.21559572219848633
local_output_nid generation:  0.011822223663330078
local_in_edges_tensor generation:  0.013072013854980469
mini_batch_src_global generation:  0.026322364807128906
r_  generation:  0.21623992919921875
local_output_nid generation:  0.011911869049072266
local_in_edges_tensor generation:  0.011257648468017578
mini_batch_src_global generation:  0.027524232864379883
r_  generation:  0.21585917472839355
local_output_nid generation:  0.011706829071044922
local_in_edges_tensor generation:  0.011872529983520508
mini_batch_src_global generation:  0.026494741439819336
r_  generation:  0.21559524536132812
local_output_nid generation:  0.01196742057800293
local_in_edges_tensor generation:  0.012900590896606445
mini_batch_src_global generation:  0.027843952178955078
r_  generation:  0.2186286449432373
local_output_nid generation:  0.012061357498168945
local_in_edges_tensor generation:  0.011787176132202148
mini_batch_src_global generation:  0.026525259017944336
r_  generation:  0.21506524085998535
local_output_nid generation:  0.012024641036987305
local_in_edges_tensor generation:  0.011499881744384766
mini_batch_src_global generation:  0.026293516159057617
r_  generation:  0.2130446434020996
local_output_nid generation:  0.01214909553527832
local_in_edges_tensor generation:  0.011652469635009766
mini_batch_src_global generation:  0.026334762573242188
r_  generation:  0.21271514892578125
local_output_nid generation:  0.011743783950805664
local_in_edges_tensor generation:  0.011521577835083008
mini_batch_src_global generation:  0.02713799476623535
r_  generation:  0.21989965438842773
----------------------check_connections_block total spend ----------------------------- 4.919128894805908
generate_one_block  0.26274633407592773
generate_one_block  0.2648186683654785
generate_one_block  0.26410460472106934
generate_one_block  0.2791624069213867
generate_one_block  0.2597057819366455
generate_one_block  0.26616930961608887
generate_one_block  0.2871849536895752
generate_one_block  0.27489256858825684
generate_one_block  0.27283477783203125
generate_one_block  0.2720661163330078
generate_one_block  0.2683546543121338
generate_one_block  0.27261877059936523
generate_one_block  0.2682952880859375
generate_one_block  0.26533937454223633
generate_one_block  0.26396608352661133
generate_one_block  0.2773911952972412
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.027284860610961914
gen group dst list time:  0.061115264892578125
time for parepare:  0.017763853073120117
local_output_nid generation:  0.024301528930664062
local_in_edges_tensor generation:  0.04431319236755371
mini_batch_src_global generation:  0.048931121826171875
r_  generation:  0.45323729515075684
local_output_nid generation:  0.0290679931640625
local_in_edges_tensor generation:  0.03081035614013672
mini_batch_src_global generation:  0.051911115646362305
r_  generation:  0.44550323486328125
local_output_nid generation:  0.029994726181030273
local_in_edges_tensor generation:  0.032257795333862305
mini_batch_src_global generation:  0.05098915100097656
r_  generation:  0.45610618591308594
local_output_nid generation:  0.030250072479248047
local_in_edges_tensor generation:  0.030644893646240234
mini_batch_src_global generation:  0.05256080627441406
r_  generation:  0.4489743709564209
local_output_nid generation:  0.030559539794921875
local_in_edges_tensor generation:  0.07619976997375488
mini_batch_src_global generation:  0.05156064033508301
r_  generation:  0.45395541191101074
local_output_nid generation:  0.030510902404785156
local_in_edges_tensor generation:  0.030957937240600586
mini_batch_src_global generation:  0.052956342697143555
r_  generation:  0.449568510055542
local_output_nid generation:  0.030316829681396484
local_in_edges_tensor generation:  0.03068828582763672
mini_batch_src_global generation:  0.05191397666931152
r_  generation:  0.4586775302886963
local_output_nid generation:  0.030317068099975586
local_in_edges_tensor generation:  0.03080272674560547
mini_batch_src_global generation:  0.060404062271118164
r_  generation:  0.4510219097137451
local_output_nid generation:  0.03078460693359375
local_in_edges_tensor generation:  0.029075145721435547
mini_batch_src_global generation:  0.05269455909729004
r_  generation:  0.46692490577697754
local_output_nid generation:  0.03067493438720703
local_in_edges_tensor generation:  0.03264808654785156
mini_batch_src_global generation:  0.053349971771240234
r_  generation:  0.45182204246520996
local_output_nid generation:  0.030615568161010742
local_in_edges_tensor generation:  0.030647754669189453
mini_batch_src_global generation:  0.05303168296813965
r_  generation:  0.45800209045410156
local_output_nid generation:  0.03081035614013672
local_in_edges_tensor generation:  0.02888655662536621
mini_batch_src_global generation:  0.053466081619262695
r_  generation:  0.4546492099761963
local_output_nid generation:  0.03058910369873047
local_in_edges_tensor generation:  0.030284643173217773
mini_batch_src_global generation:  0.05282902717590332
r_  generation:  0.4558436870574951
local_output_nid generation:  0.03075718879699707
local_in_edges_tensor generation:  0.029364347457885742
mini_batch_src_global generation:  0.05382275581359863
r_  generation:  0.45430850982666016
local_output_nid generation:  0.03040289878845215
local_in_edges_tensor generation:  0.028507232666015625
mini_batch_src_global generation:  0.05244088172912598
r_  generation:  0.4590721130371094
local_output_nid generation:  0.030793428421020508
local_in_edges_tensor generation:  0.029462337493896484
mini_batch_src_global generation:  0.05329418182373047
r_  generation:  0.4576716423034668
----------------------check_connections_block total spend ----------------------------- 10.733184099197388
generate_one_block  0.5688502788543701
generate_one_block  0.57232666015625
generate_one_block  0.5763599872589111
generate_one_block  0.5697641372680664
generate_one_block  0.5677523612976074
generate_one_block  0.57261061668396
generate_one_block  0.5714080333709717
generate_one_block  0.5775232315063477
generate_one_block  0.6179828643798828
generate_one_block  0.5781402587890625
generate_one_block  0.5791692733764648
generate_one_block  0.5825803279876709
generate_one_block  0.5775637626647949
generate_one_block  0.5796663761138916
generate_one_block  0.5722677707672119
generate_one_block  0.5785961151123047
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11556577682495117  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

connection checking time:  15.652312994003296
block generation total time  13.562212944030762
average batch blocks generation time:  0.8476383090019226
block dataloader generation time/epoch 31.320416688919067
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09379053115844727  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7150998115539551  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09313201904296875  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7154445648193359  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0937957763671875  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7164492607116699  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09345102310180664  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7191901206970215  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09375476837158203  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7149853706359863  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09322738647460938  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7167234420776367  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09383678436279297  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7157888412475586  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09322214126586914  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7148761749267578  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09397506713867188  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7191405296325684  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09341573715209961  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7191500663757324  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09393501281738281  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7180366516113281  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09356164932250977  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7249140739440918  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09391117095947266  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7186193466186523  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0934152603149414  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7169361114501953  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09380912780761719  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7174520492553711  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09355306625366211  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.724524974822998  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06301321089267731 |0.010888412594795227 |0.003562256693840027 |9.299814701080322e-05 |0.003733903169631958 |0.0017611980438232422 |
----------------------------------------------------------pseudo_mini_loss sum 1.4254084825515747
Total (block generation + training)time/epoch 32.65514818827311
Training time/epoch 1.3617916107177734
Training time without block to device /epoch 1.1875770092010498
Training time without total dataloading part /epoch 0.11998772621154785
load block tensor time/epoch 1.008211374282837
block to device time/epoch 0.17421460151672363
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 15 |
Number of nodes for computation during this epoch:  5091851
Number of first layer input nodes during this epoch:  2471083
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.116668701171875  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01864027976989746
range selection method range initialization spend 0.012725591659545898
time for parepare:  0.016139507293701172
local_output_nid generation:  0.0014662742614746094
local_in_edges_tensor generation:  0.003516674041748047
mini_batch_src_global generation:  0.0016012191772460938
r_  generation:  0.018065690994262695
local_output_nid generation:  0.0015249252319335938
local_in_edges_tensor generation:  0.0009462833404541016
mini_batch_src_global generation:  0.0019779205322265625
r_  generation:  0.019798755645751953
local_output_nid generation:  0.0015742778778076172
local_in_edges_tensor generation:  0.0009136199951171875
mini_batch_src_global generation:  0.001516103744506836
r_  generation:  0.018612146377563477
local_output_nid generation:  0.0015788078308105469
local_in_edges_tensor generation:  0.0009586811065673828
mini_batch_src_global generation:  0.0015125274658203125
r_  generation:  0.018793821334838867
local_output_nid generation:  0.001546621322631836
local_in_edges_tensor generation:  0.0009558200836181641
mini_batch_src_global generation:  0.0015840530395507812
r_  generation:  0.019064664840698242
local_output_nid generation:  0.0017442703247070312
local_in_edges_tensor generation:  0.0011413097381591797
mini_batch_src_global generation:  0.0015988349914550781
r_  generation:  0.019702672958374023
local_output_nid generation:  0.0016579627990722656
local_in_edges_tensor generation:  0.0009853839874267578
mini_batch_src_global generation:  0.001608133316040039
r_  generation:  0.0197603702545166
local_output_nid generation:  0.0015811920166015625
local_in_edges_tensor generation:  0.0010023117065429688
mini_batch_src_global generation:  0.0016202926635742188
r_  generation:  0.019811630249023438
local_output_nid generation:  0.0016021728515625
local_in_edges_tensor generation:  0.0009660720825195312
mini_batch_src_global generation:  0.0016007423400878906
r_  generation:  0.019675731658935547
local_output_nid generation:  0.0015943050384521484
local_in_edges_tensor generation:  0.0009732246398925781
mini_batch_src_global generation:  0.0015876293182373047
r_  generation:  0.019484281539916992
local_output_nid generation:  0.001619100570678711
local_in_edges_tensor generation:  0.0009877681732177734
mini_batch_src_global generation:  0.00151824951171875
r_  generation:  0.019348621368408203
local_output_nid generation:  0.0016155242919921875
local_in_edges_tensor generation:  0.0010356903076171875
mini_batch_src_global generation:  0.0015664100646972656
r_  generation:  0.019176483154296875
local_output_nid generation:  0.0015761852264404297
local_in_edges_tensor generation:  0.000972747802734375
mini_batch_src_global generation:  0.0015337467193603516
r_  generation:  0.01994919776916504
local_output_nid generation:  0.001592874526977539
local_in_edges_tensor generation:  0.0009784698486328125
mini_batch_src_global generation:  0.0015769004821777344
r_  generation:  0.01953291893005371
local_output_nid generation:  0.0015866756439208984
local_in_edges_tensor generation:  0.000949859619140625
mini_batch_src_global generation:  0.001569509506225586
r_  generation:  0.019823789596557617
local_output_nid generation:  0.0016102790832519531
local_in_edges_tensor generation:  0.000995635986328125
mini_batch_src_global generation:  0.00157928466796875
r_  generation:  0.019442319869995117
----------------------check_connections_block total spend ----------------------------- 0.46651148796081543
generate_one_block  0.027248144149780273
generate_one_block  0.02841949462890625
generate_one_block  0.027462482452392578
generate_one_block  0.02749466896057129
generate_one_block  0.027673721313476562
generate_one_block  0.030141353607177734
generate_one_block  0.028165102005004883
generate_one_block  0.028261423110961914
generate_one_block  0.02789473533630371
generate_one_block  0.027727365493774414
generate_one_block  0.02749943733215332
generate_one_block  0.027772903442382812
generate_one_block  0.028456926345825195
generate_one_block  0.028059959411621094
generate_one_block  0.02836132049560547
generate_one_block  0.028375864028930664
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.09546780586242676
gen group dst list time:  0.018331050872802734
time for parepare:  0.019596338272094727
local_output_nid generation:  0.006764411926269531
local_in_edges_tensor generation:  0.01759958267211914
mini_batch_src_global generation:  0.02022099494934082
r_  generation:  0.18679428100585938
local_output_nid generation:  0.010129213333129883
local_in_edges_tensor generation:  0.014021873474121094
mini_batch_src_global generation:  0.025105714797973633
r_  generation:  0.2013380527496338
local_output_nid generation:  0.010144710540771484
local_in_edges_tensor generation:  0.014029502868652344
mini_batch_src_global generation:  0.023032188415527344
r_  generation:  0.20318317413330078
local_output_nid generation:  0.011144638061523438
local_in_edges_tensor generation:  0.012619972229003906
mini_batch_src_global generation:  0.027340412139892578
r_  generation:  0.20865654945373535
local_output_nid generation:  0.011425256729125977
local_in_edges_tensor generation:  0.011778831481933594
mini_batch_src_global generation:  0.02533555030822754
r_  generation:  0.21029090881347656
local_output_nid generation:  0.011477231979370117
local_in_edges_tensor generation:  0.011458635330200195
mini_batch_src_global generation:  0.029057979583740234
r_  generation:  0.21440505981445312
local_output_nid generation:  0.011768579483032227
local_in_edges_tensor generation:  0.012242794036865234
mini_batch_src_global generation:  0.030144214630126953
r_  generation:  0.21645092964172363
local_output_nid generation:  0.011777162551879883
local_in_edges_tensor generation:  0.012298583984375
mini_batch_src_global generation:  0.027516603469848633
r_  generation:  0.21564698219299316
local_output_nid generation:  0.011945009231567383
local_in_edges_tensor generation:  0.011948585510253906
mini_batch_src_global generation:  0.026512861251831055
r_  generation:  0.21293926239013672
local_output_nid generation:  0.011991500854492188
local_in_edges_tensor generation:  0.011899471282958984
mini_batch_src_global generation:  0.027173995971679688
r_  generation:  0.2088167667388916
local_output_nid generation:  0.011435508728027344
local_in_edges_tensor generation:  0.01226663589477539
mini_batch_src_global generation:  0.025794506072998047
r_  generation:  0.21027278900146484
local_output_nid generation:  0.011440038681030273
local_in_edges_tensor generation:  0.011288166046142578
mini_batch_src_global generation:  0.02633357048034668
r_  generation:  0.21666789054870605
local_output_nid generation:  0.012208700180053711
local_in_edges_tensor generation:  0.011641502380371094
mini_batch_src_global generation:  0.036289215087890625
r_  generation:  0.2191770076751709
local_output_nid generation:  0.013315439224243164
local_in_edges_tensor generation:  0.012209177017211914
mini_batch_src_global generation:  0.02655196189880371
r_  generation:  0.21641755104064941
local_output_nid generation:  0.012495756149291992
local_in_edges_tensor generation:  0.012556314468383789
mini_batch_src_global generation:  0.027223587036132812
r_  generation:  0.21921491622924805
local_output_nid generation:  0.012344598770141602
local_in_edges_tensor generation:  0.01135563850402832
mini_batch_src_global generation:  0.0268404483795166
r_  generation:  0.21414828300476074
----------------------check_connections_block total spend ----------------------------- 4.9504406452178955
generate_one_block  0.25980496406555176
generate_one_block  0.26641035079956055
generate_one_block  0.2644081115722656
generate_one_block  0.26891517639160156
generate_one_block  0.2686648368835449
generate_one_block  0.26888322830200195
generate_one_block  0.2942984104156494
generate_one_block  0.2693607807159424
generate_one_block  0.26897335052490234
generate_one_block  0.2616550922393799
generate_one_block  0.26180315017700195
generate_one_block  0.2795236110687256
generate_one_block  0.27385950088500977
generate_one_block  0.26829051971435547
generate_one_block  0.27722835540771484
generate_one_block  0.26818370819091797
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03237485885620117
gen group dst list time:  0.0613250732421875
time for parepare:  0.01791977882385254
local_output_nid generation:  0.02440810203552246
local_in_edges_tensor generation:  0.04605293273925781
mini_batch_src_global generation:  0.04359936714172363
r_  generation:  0.44361138343811035
local_output_nid generation:  0.029492855072021484
local_in_edges_tensor generation:  0.036785125732421875
mini_batch_src_global generation:  0.05269575119018555
r_  generation:  0.44649815559387207
local_output_nid generation:  0.029807090759277344
local_in_edges_tensor generation:  0.030747413635253906
mini_batch_src_global generation:  0.05095481872558594
r_  generation:  0.4547407627105713
local_output_nid generation:  0.030212879180908203
local_in_edges_tensor generation:  0.031980276107788086
mini_batch_src_global generation:  0.05488419532775879
r_  generation:  0.45526647567749023
local_output_nid generation:  0.03012561798095703
local_in_edges_tensor generation:  0.07293844223022461
mini_batch_src_global generation:  0.05113959312438965
r_  generation:  0.45801687240600586
local_output_nid generation:  0.03047800064086914
local_in_edges_tensor generation:  0.03232693672180176
mini_batch_src_global generation:  0.05293679237365723
r_  generation:  0.4548046588897705
local_output_nid generation:  0.03036189079284668
local_in_edges_tensor generation:  0.030402183532714844
mini_batch_src_global generation:  0.05113101005554199
r_  generation:  0.4647202491760254
local_output_nid generation:  0.031221866607666016
local_in_edges_tensor generation:  0.02861499786376953
mini_batch_src_global generation:  0.0557703971862793
r_  generation:  0.45442867279052734
local_output_nid generation:  0.030492782592773438
local_in_edges_tensor generation:  0.029059410095214844
mini_batch_src_global generation:  0.05209231376647949
r_  generation:  0.4585418701171875
local_output_nid generation:  0.03057122230529785
local_in_edges_tensor generation:  0.029024600982666016
mini_batch_src_global generation:  0.052466630935668945
r_  generation:  0.456650972366333
local_output_nid generation:  0.030407190322875977
local_in_edges_tensor generation:  0.031462907791137695
mini_batch_src_global generation:  0.05173826217651367
r_  generation:  0.4557762145996094
local_output_nid generation:  0.030637025833129883
local_in_edges_tensor generation:  0.03322196006774902
mini_batch_src_global generation:  0.05300331115722656
r_  generation:  0.45185017585754395
local_output_nid generation:  0.030700206756591797
local_in_edges_tensor generation:  0.03123950958251953
mini_batch_src_global generation:  0.051233530044555664
r_  generation:  0.46389293670654297
local_output_nid generation:  0.034279823303222656
local_in_edges_tensor generation:  0.03306150436401367
mini_batch_src_global generation:  0.05218076705932617
r_  generation:  0.4600827693939209
local_output_nid generation:  0.0312349796295166
local_in_edges_tensor generation:  0.033368825912475586
mini_batch_src_global generation:  0.05202460289001465
r_  generation:  0.46538805961608887
local_output_nid generation:  0.03090381622314453
local_in_edges_tensor generation:  0.030762672424316406
mini_batch_src_global generation:  0.05195140838623047
r_  generation:  0.45570826530456543
----------------------check_connections_block total spend ----------------------------- 10.758320093154907
generate_one_block  0.5754461288452148
generate_one_block  0.5763931274414062
generate_one_block  0.5730888843536377
generate_one_block  0.5742607116699219
generate_one_block  0.5722017288208008
generate_one_block  0.57135009765625
generate_one_block  0.576263427734375
generate_one_block  0.5771934986114502
generate_one_block  0.6320657730102539
generate_one_block  0.5727658271789551
generate_one_block  0.5748894214630127
generate_one_block  0.5851154327392578
generate_one_block  0.580894947052002
generate_one_block  0.5790576934814453
generate_one_block  0.5830771923065186
generate_one_block  0.5720531940460205
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.116668701171875  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

connection checking time:  15.708760738372803
block generation total time  13.596380233764648
average batch blocks generation time:  0.8497737646102905
block dataloader generation time/epoch 31.323911053793772
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09375238418579102  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7154479026794434  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09330511093139648  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7166042327880859  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09384536743164062  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7166919708251953  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09331321716308594  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7176909446716309  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09390640258789062  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7173776626586914  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09348106384277344  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.719080924987793  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09393119812011719  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7183241844177246  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09341907501220703  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7190442085266113  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09389972686767578  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7183394432067871  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09320545196533203  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7159790992736816  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0937490463256836  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7109174728393555  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09321165084838867  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7165508270263672  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09401702880859375  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7206048965454102  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09337234497070312  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7176594734191895  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09409904479980469  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7233462333679199  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09317588806152344  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7168717384338379  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0636271983385086 |0.012223467230796814 |0.003558516502380371 |9.232759475708008e-05 |0.003731250762939453 |0.0028541088104248047 |
----------------------------------------------------------pseudo_mini_loss sum 1.3966283798217773
Total (block generation + training)time/epoch 32.67934332575117
Training time/epoch 1.4794011116027832
Training time without block to device /epoch 1.2838256359100342
Training time without total dataloading part /epoch 0.12096762657165527
load block tensor time/epoch 1.0180351734161377
block to device time/epoch 0.19557547569274902
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 16 |
Number of nodes for computation during this epoch:  5089993
Number of first layer input nodes during this epoch:  2470791
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11496114730834961  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03978323936462402
range selection method range initialization spend 0.015753746032714844
time for parepare:  0.015950441360473633
local_output_nid generation:  0.001444101333618164
local_in_edges_tensor generation:  0.003518342971801758
mini_batch_src_global generation:  0.0019118785858154297
r_  generation:  0.020488977432250977
local_output_nid generation:  0.0015676021575927734
local_in_edges_tensor generation:  0.0010557174682617188
mini_batch_src_global generation:  0.002145051956176758
r_  generation:  0.02197575569152832
local_output_nid generation:  0.0015857219696044922
local_in_edges_tensor generation:  0.0008943080902099609
mini_batch_src_global generation:  0.0018134117126464844
r_  generation:  0.01914072036743164
local_output_nid generation:  0.001583099365234375
local_in_edges_tensor generation:  0.0009493827819824219
mini_batch_src_global generation:  0.0015232563018798828
r_  generation:  0.019052743911743164
local_output_nid generation:  0.0015735626220703125
local_in_edges_tensor generation:  0.0009355545043945312
mini_batch_src_global generation:  0.0014829635620117188
r_  generation:  0.019072771072387695
local_output_nid generation:  0.0015597343444824219
local_in_edges_tensor generation:  0.000881195068359375
mini_batch_src_global generation:  0.001531362533569336
r_  generation:  0.019411563873291016
local_output_nid generation:  0.0016107559204101562
local_in_edges_tensor generation:  0.0008685588836669922
mini_batch_src_global generation:  0.0015420913696289062
r_  generation:  0.01956486701965332
local_output_nid generation:  0.001552581787109375
local_in_edges_tensor generation:  0.0008699893951416016
mini_batch_src_global generation:  0.0015344619750976562
r_  generation:  0.019553661346435547
local_output_nid generation:  0.0015742778778076172
local_in_edges_tensor generation:  0.0009086132049560547
mini_batch_src_global generation:  0.0015246868133544922
r_  generation:  0.01926398277282715
local_output_nid generation:  0.0015451908111572266
local_in_edges_tensor generation:  0.0008730888366699219
mini_batch_src_global generation:  0.0015511512756347656
r_  generation:  0.019501447677612305
local_output_nid generation:  0.001569986343383789
local_in_edges_tensor generation:  0.0009186267852783203
mini_batch_src_global generation:  0.0015108585357666016
r_  generation:  0.019380569458007812
local_output_nid generation:  0.0015506744384765625
local_in_edges_tensor generation:  0.0008785724639892578
mini_batch_src_global generation:  0.0015287399291992188
r_  generation:  0.019566059112548828
local_output_nid generation:  0.0016474723815917969
local_in_edges_tensor generation:  0.0008757114410400391
mini_batch_src_global generation:  0.0015146732330322266
r_  generation:  0.019356727600097656
local_output_nid generation:  0.001529693603515625
local_in_edges_tensor generation:  0.0008549690246582031
mini_batch_src_global generation:  0.0015354156494140625
r_  generation:  0.019394874572753906
local_output_nid generation:  0.0015530586242675781
local_in_edges_tensor generation:  0.0008878707885742188
mini_batch_src_global generation:  0.001531839370727539
r_  generation:  0.019699573516845703
local_output_nid generation:  0.0015528202056884766
local_in_edges_tensor generation:  0.0008635520935058594
mini_batch_src_global generation:  0.0015459060668945312
r_  generation:  0.020217418670654297
----------------------check_connections_block total spend ----------------------------- 0.47002601623535156
generate_one_block  0.02702617645263672
generate_one_block  0.028510570526123047
generate_one_block  0.028011560440063477
generate_one_block  0.02766108512878418
generate_one_block  0.02768850326538086
generate_one_block  0.02980208396911621
generate_one_block  0.0283205509185791
generate_one_block  0.027554988861083984
generate_one_block  0.028002500534057617
generate_one_block  0.02750873565673828
generate_one_block  0.027652740478515625
generate_one_block  0.027864456176757812
generate_one_block  0.02791762351989746
generate_one_block  0.027725696563720703
generate_one_block  0.027703523635864258
generate_one_block  0.02838921546936035
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03317070007324219
gen group dst list time:  0.015578269958496094
time for parepare:  0.01946401596069336
local_output_nid generation:  0.0067598819732666016
local_in_edges_tensor generation:  0.0181272029876709
mini_batch_src_global generation:  0.02040386199951172
r_  generation:  0.19146108627319336
local_output_nid generation:  0.010204076766967773
local_in_edges_tensor generation:  0.013626575469970703
mini_batch_src_global generation:  0.024854183197021484
r_  generation:  0.20520758628845215
local_output_nid generation:  0.010219812393188477
local_in_edges_tensor generation:  0.011082649230957031
mini_batch_src_global generation:  0.024788618087768555
r_  generation:  0.20344281196594238
local_output_nid generation:  0.011116743087768555
local_in_edges_tensor generation:  0.012162923812866211
mini_batch_src_global generation:  0.027221202850341797
r_  generation:  0.20749592781066895
local_output_nid generation:  0.011245250701904297
local_in_edges_tensor generation:  0.011963129043579102
mini_batch_src_global generation:  0.03284049034118652
r_  generation:  0.21340608596801758
local_output_nid generation:  0.012259960174560547
local_in_edges_tensor generation:  0.011364459991455078
mini_batch_src_global generation:  0.033884286880493164
r_  generation:  0.2121129035949707
local_output_nid generation:  0.011903524398803711
local_in_edges_tensor generation:  0.011605024337768555
mini_batch_src_global generation:  0.026256084442138672
r_  generation:  0.21372628211975098
local_output_nid generation:  0.011983871459960938
local_in_edges_tensor generation:  0.013128280639648438
mini_batch_src_global generation:  0.028411388397216797
r_  generation:  0.20925235748291016
local_output_nid generation:  0.012114763259887695
local_in_edges_tensor generation:  0.01132345199584961
mini_batch_src_global generation:  0.03120255470275879
r_  generation:  0.21495604515075684
local_output_nid generation:  0.012089252471923828
local_in_edges_tensor generation:  0.011372804641723633
mini_batch_src_global generation:  0.026365280151367188
r_  generation:  0.21206307411193848
local_output_nid generation:  0.01188039779663086
local_in_edges_tensor generation:  0.01197504997253418
mini_batch_src_global generation:  0.028807640075683594
r_  generation:  0.21078801155090332
local_output_nid generation:  0.012064456939697266
local_in_edges_tensor generation:  0.013240814208984375
mini_batch_src_global generation:  0.027770280838012695
r_  generation:  0.21208715438842773
local_output_nid generation:  0.012242555618286133
local_in_edges_tensor generation:  0.011575460433959961
mini_batch_src_global generation:  0.02884054183959961
r_  generation:  0.21345829963684082
local_output_nid generation:  0.012318849563598633
local_in_edges_tensor generation:  0.011942386627197266
mini_batch_src_global generation:  0.03222179412841797
r_  generation:  0.2114408016204834
local_output_nid generation:  0.012372016906738281
local_in_edges_tensor generation:  0.01216578483581543
mini_batch_src_global generation:  0.027553796768188477
r_  generation:  0.21625423431396484
local_output_nid generation:  0.012191534042358398
local_in_edges_tensor generation:  0.011727094650268555
mini_batch_src_global generation:  0.026747465133666992
r_  generation:  0.2165508270263672
----------------------check_connections_block total spend ----------------------------- 4.954387426376343
generate_one_block  0.2726459503173828
generate_one_block  0.2698969841003418
generate_one_block  0.26453518867492676
generate_one_block  0.26747918128967285
generate_one_block  0.27065157890319824
generate_one_block  0.27051639556884766
generate_one_block  0.2888917922973633
generate_one_block  0.2620882987976074
generate_one_block  0.2684495449066162
generate_one_block  0.26793527603149414
generate_one_block  0.264556884765625
generate_one_block  0.2688944339752197
generate_one_block  0.2664005756378174
generate_one_block  0.26752376556396484
generate_one_block  0.27346014976501465
generate_one_block  0.2748582363128662
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03483128547668457
gen group dst list time:  0.0615081787109375
time for parepare:  0.01930069923400879
local_output_nid generation:  0.024816513061523438
local_in_edges_tensor generation:  0.05032157897949219
mini_batch_src_global generation:  0.04004836082458496
r_  generation:  0.44402074813842773
local_output_nid generation:  0.030072450637817383
local_in_edges_tensor generation:  0.03577899932861328
mini_batch_src_global generation:  0.0521547794342041
r_  generation:  0.45050954818725586
local_output_nid generation:  0.02975916862487793
local_in_edges_tensor generation:  0.030538082122802734
mini_batch_src_global generation:  0.05341696739196777
r_  generation:  0.4544079303741455
local_output_nid generation:  0.03139233589172363
local_in_edges_tensor generation:  0.02875685691833496
mini_batch_src_global generation:  0.052031755447387695
r_  generation:  0.45810437202453613
local_output_nid generation:  0.030570507049560547
local_in_edges_tensor generation:  0.07415556907653809
mini_batch_src_global generation:  0.05191159248352051
r_  generation:  0.46010494232177734
local_output_nid generation:  0.03041863441467285
local_in_edges_tensor generation:  0.03135180473327637
mini_batch_src_global generation:  0.05339837074279785
r_  generation:  0.4582998752593994
local_output_nid generation:  0.03085041046142578
local_in_edges_tensor generation:  0.031047821044921875
mini_batch_src_global generation:  0.05200052261352539
r_  generation:  0.4620523452758789
local_output_nid generation:  0.03081202507019043
local_in_edges_tensor generation:  0.03170609474182129
mini_batch_src_global generation:  0.05323052406311035
r_  generation:  0.45130109786987305
local_output_nid generation:  0.031124591827392578
local_in_edges_tensor generation:  0.031033039093017578
mini_batch_src_global generation:  0.05136919021606445
r_  generation:  0.45812463760375977
local_output_nid generation:  0.03093862533569336
local_in_edges_tensor generation:  0.035894155502319336
mini_batch_src_global generation:  0.055054426193237305
r_  generation:  0.457629919052124
local_output_nid generation:  0.03101515769958496
local_in_edges_tensor generation:  0.03166794776916504
mini_batch_src_global generation:  0.05212068557739258
r_  generation:  0.45821642875671387
local_output_nid generation:  0.030821561813354492
local_in_edges_tensor generation:  0.031882286071777344
mini_batch_src_global generation:  0.05238747596740723
r_  generation:  0.4513845443725586
local_output_nid generation:  0.030262231826782227
local_in_edges_tensor generation:  0.029256105422973633
mini_batch_src_global generation:  0.05168461799621582
r_  generation:  0.45664381980895996
local_output_nid generation:  0.030962228775024414
local_in_edges_tensor generation:  0.029362916946411133
mini_batch_src_global generation:  0.05265927314758301
r_  generation:  0.4540135860443115
local_output_nid generation:  0.03080296516418457
local_in_edges_tensor generation:  0.03043651580810547
mini_batch_src_global generation:  0.05306077003479004
r_  generation:  0.46387648582458496
local_output_nid generation:  0.03076481819152832
local_in_edges_tensor generation:  0.03272104263305664
mini_batch_src_global generation:  0.05292940139770508
r_  generation:  0.45726609230041504
----------------------check_connections_block total spend ----------------------------- 10.770299196243286
generate_one_block  0.5739402770996094
generate_one_block  0.5754196643829346
generate_one_block  0.5691328048706055
generate_one_block  0.5864577293395996
generate_one_block  0.5857405662536621
generate_one_block  0.573185920715332
generate_one_block  0.579251766204834
generate_one_block  0.5747265815734863
generate_one_block  0.6238536834716797
generate_one_block  0.5732800960540771
generate_one_block  0.594792366027832
generate_one_block  0.5949692726135254
generate_one_block  0.5827422142028809
generate_one_block  0.5816006660461426
generate_one_block  0.588468074798584
generate_one_block  0.575918436050415
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11496114730834961  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

connection checking time:  15.724686622619629
block generation total time  13.65226435661316
average batch blocks generation time:  0.8532665222883224
block dataloader generation time/epoch 31.327636033296585
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09386396408081055  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7172684669494629  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09341716766357422  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7202434539794922  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0938568115234375  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7182297706604004  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09340047836303711  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7164955139160156  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09398365020751953  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7189979553222656  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09333992004394531  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7184023857116699  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09389972686767578  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.718325138092041  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09315872192382812  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7107882499694824  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09392547607421875  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.718752384185791  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09321355819702148  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7163410186767578  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09383773803710938  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7176337242126465  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09323263168334961  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7167119979858398  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09384918212890625  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.712669849395752  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09328794479370117  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7176413536071777  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09398746490478516  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7185449600219727  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09338569641113281  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7170181274414062  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0643245279788971 |0.012950748205184937 |0.003580644726753235 |9.338557720184326e-05 |0.0037603825330734253 |0.0017027854919433594 |
----------------------------------------------------------pseudo_mini_loss sum 1.3781253099441528
Total (block generation + training)time/epoch 32.69085696339607
Training time/epoch 1.4174623489379883
Training time without block to device /epoch 1.2102503776550293
Training time without total dataloading part /epoch 0.12065339088439941
load block tensor time/epoch 1.0291924476623535
block to device time/epoch 0.20721197128295898
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 17 |
Number of nodes for computation during this epoch:  5089453
Number of first layer input nodes during this epoch:  2471530
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11527490615844727  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021045207977294922
range selection method range initialization spend 0.01216888427734375
time for parepare:  0.01762104034423828
local_output_nid generation:  0.0014371871948242188
local_in_edges_tensor generation:  0.007238149642944336
mini_batch_src_global generation:  0.0019230842590332031
r_  generation:  0.018715381622314453
local_output_nid generation:  0.0015766620635986328
local_in_edges_tensor generation:  0.0009698867797851562
mini_batch_src_global generation:  0.002172708511352539
r_  generation:  0.02019500732421875
local_output_nid generation:  0.0015511512756347656
local_in_edges_tensor generation:  0.0008828639984130859
mini_batch_src_global generation:  0.0014836788177490234
r_  generation:  0.018757343292236328
local_output_nid generation:  0.0016107559204101562
local_in_edges_tensor generation:  0.0009171962738037109
mini_batch_src_global generation:  0.0014965534210205078
r_  generation:  0.01926255226135254
local_output_nid generation:  0.0015723705291748047
local_in_edges_tensor generation:  0.0009076595306396484
mini_batch_src_global generation:  0.0015039443969726562
r_  generation:  0.01910114288330078
local_output_nid generation:  0.0015401840209960938
local_in_edges_tensor generation:  0.0009369850158691406
mini_batch_src_global generation:  0.0015587806701660156
r_  generation:  0.0201723575592041
local_output_nid generation:  0.0016644001007080078
local_in_edges_tensor generation:  0.0009756088256835938
mini_batch_src_global generation:  0.0015497207641601562
r_  generation:  0.01906752586364746
local_output_nid generation:  0.0015599727630615234
local_in_edges_tensor generation:  0.0009112358093261719
mini_batch_src_global generation:  0.0014982223510742188
r_  generation:  0.019265413284301758
local_output_nid generation:  0.0016350746154785156
local_in_edges_tensor generation:  0.0009229183197021484
mini_batch_src_global generation:  0.0015213489532470703
r_  generation:  0.01948380470275879
local_output_nid generation:  0.0015225410461425781
local_in_edges_tensor generation:  0.0009217262268066406
mini_batch_src_global generation:  0.0015437602996826172
r_  generation:  0.01970982551574707
local_output_nid generation:  0.0015549659729003906
local_in_edges_tensor generation:  0.0008828639984130859
mini_batch_src_global generation:  0.0016140937805175781
r_  generation:  0.020110130310058594
local_output_nid generation:  0.0015516281127929688
local_in_edges_tensor generation:  0.0008823871612548828
mini_batch_src_global generation:  0.001522064208984375
r_  generation:  0.019736051559448242
local_output_nid generation:  0.001546621322631836
local_in_edges_tensor generation:  0.0009169578552246094
mini_batch_src_global generation:  0.001573324203491211
r_  generation:  0.019533157348632812
local_output_nid generation:  0.0016372203826904297
local_in_edges_tensor generation:  0.0009465217590332031
mini_batch_src_global generation:  0.0015213489532470703
r_  generation:  0.019843101501464844
local_output_nid generation:  0.0015473365783691406
local_in_edges_tensor generation:  0.0008625984191894531
mini_batch_src_global generation:  0.0015544891357421875
r_  generation:  0.019886493682861328
local_output_nid generation:  0.0015652179718017578
local_in_edges_tensor generation:  0.0008969306945800781
mini_batch_src_global generation:  0.0015225410461425781
r_  generation:  0.019744873046875
----------------------check_connections_block total spend ----------------------------- 0.47223782539367676
generate_one_block  0.027619361877441406
generate_one_block  0.028964519500732422
generate_one_block  0.027847766876220703
generate_one_block  0.028153657913208008
generate_one_block  0.02808976173400879
generate_one_block  0.030313730239868164
generate_one_block  0.02758312225341797
generate_one_block  0.027475833892822266
generate_one_block  0.028405189514160156
generate_one_block  0.02777266502380371
generate_one_block  0.028792142868041992
generate_one_block  0.027496337890625
generate_one_block  0.027834415435791016
generate_one_block  0.02824091911315918
generate_one_block  0.02859950065612793
generate_one_block  0.028162717819213867
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.12102150917053223
gen group dst list time:  0.01911616325378418
time for parepare:  0.019596099853515625
local_output_nid generation:  0.006684064865112305
local_in_edges_tensor generation:  0.022484779357910156
mini_batch_src_global generation:  0.02227950096130371
r_  generation:  0.18959522247314453
local_output_nid generation:  0.01020669937133789
local_in_edges_tensor generation:  0.01407170295715332
mini_batch_src_global generation:  0.025848865509033203
r_  generation:  0.20763516426086426
local_output_nid generation:  0.01053309440612793
local_in_edges_tensor generation:  0.01237630844116211
mini_batch_src_global generation:  0.023654460906982422
r_  generation:  0.20594453811645508
local_output_nid generation:  0.011163473129272461
local_in_edges_tensor generation:  0.011703252792358398
mini_batch_src_global generation:  0.026743412017822266
r_  generation:  0.2172684669494629
local_output_nid generation:  0.011535882949829102
local_in_edges_tensor generation:  0.011326789855957031
mini_batch_src_global generation:  0.028727054595947266
r_  generation:  0.2126610279083252
local_output_nid generation:  0.011225700378417969
local_in_edges_tensor generation:  0.01125335693359375
mini_batch_src_global generation:  0.028093576431274414
r_  generation:  0.21175312995910645
local_output_nid generation:  0.011417388916015625
local_in_edges_tensor generation:  0.011052131652832031
mini_batch_src_global generation:  0.02586078643798828
r_  generation:  0.21231484413146973
local_output_nid generation:  0.011700868606567383
local_in_edges_tensor generation:  0.012641429901123047
mini_batch_src_global generation:  0.025650978088378906
r_  generation:  0.20833969116210938
local_output_nid generation:  0.0118408203125
local_in_edges_tensor generation:  0.011303901672363281
mini_batch_src_global generation:  0.026581764221191406
r_  generation:  0.21585583686828613
local_output_nid generation:  0.011628389358520508
local_in_edges_tensor generation:  0.011132478713989258
mini_batch_src_global generation:  0.02716851234436035
r_  generation:  0.21091890335083008
local_output_nid generation:  0.011625528335571289
local_in_edges_tensor generation:  0.011520624160766602
mini_batch_src_global generation:  0.026716947555541992
r_  generation:  0.21712350845336914
local_output_nid generation:  0.011534929275512695
local_in_edges_tensor generation:  0.012149810791015625
mini_batch_src_global generation:  0.026372909545898438
r_  generation:  0.2133479118347168
local_output_nid generation:  0.011992931365966797
local_in_edges_tensor generation:  0.012126445770263672
mini_batch_src_global generation:  0.02649974822998047
r_  generation:  0.21226859092712402
local_output_nid generation:  0.011964797973632812
local_in_edges_tensor generation:  0.012919902801513672
mini_batch_src_global generation:  0.026521682739257812
r_  generation:  0.2186422348022461
local_output_nid generation:  0.011964797973632812
local_in_edges_tensor generation:  0.01232004165649414
mini_batch_src_global generation:  0.02662205696105957
r_  generation:  0.21874737739562988
local_output_nid generation:  0.011739015579223633
local_in_edges_tensor generation:  0.011396408081054688
mini_batch_src_global generation:  0.026447057723999023
r_  generation:  0.2130584716796875
----------------------check_connections_block total spend ----------------------------- 4.958155155181885
generate_one_block  0.2707555294036865
generate_one_block  0.27237749099731445
generate_one_block  0.26912355422973633
generate_one_block  0.2680199146270752
generate_one_block  0.26824450492858887
generate_one_block  0.2696514129638672
generate_one_block  0.2830791473388672
generate_one_block  0.26154208183288574
generate_one_block  0.2718167304992676
generate_one_block  0.26259565353393555
generate_one_block  0.27126097679138184
generate_one_block  0.26482582092285156
generate_one_block  0.26515650749206543
generate_one_block  0.26834797859191895
generate_one_block  0.27289390563964844
generate_one_block  0.2643165588378906
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0276029109954834
gen group dst list time:  0.06213021278381348
time for parepare:  0.017585277557373047
local_output_nid generation:  0.02423834800720215
local_in_edges_tensor generation:  0.045705556869506836
mini_batch_src_global generation:  0.041670799255371094
r_  generation:  0.44420289993286133
local_output_nid generation:  0.030225515365600586
local_in_edges_tensor generation:  0.028932809829711914
mini_batch_src_global generation:  0.05664324760437012
r_  generation:  0.44745421409606934
local_output_nid generation:  0.030274391174316406
local_in_edges_tensor generation:  0.036614179611206055
mini_batch_src_global generation:  0.05174064636230469
r_  generation:  0.4529745578765869
local_output_nid generation:  0.03035736083984375
local_in_edges_tensor generation:  0.030437707901000977
mini_batch_src_global generation:  0.05418872833251953
r_  generation:  0.44771766662597656
local_output_nid generation:  0.030551671981811523
local_in_edges_tensor generation:  0.07547259330749512
mini_batch_src_global generation:  0.05109739303588867
r_  generation:  0.4565308094024658
local_output_nid generation:  0.030640602111816406
local_in_edges_tensor generation:  0.03178668022155762
mini_batch_src_global generation:  0.05334615707397461
r_  generation:  0.45146918296813965
local_output_nid generation:  0.03002023696899414
local_in_edges_tensor generation:  0.02929091453552246
mini_batch_src_global generation:  0.052025794982910156
r_  generation:  0.45719075202941895
local_output_nid generation:  0.030806303024291992
local_in_edges_tensor generation:  0.028101682662963867
mini_batch_src_global generation:  0.052866220474243164
r_  generation:  0.4502556324005127
local_output_nid generation:  0.030242204666137695
local_in_edges_tensor generation:  0.02849745750427246
mini_batch_src_global generation:  0.05171465873718262
r_  generation:  0.4574599266052246
local_output_nid generation:  0.030300140380859375
local_in_edges_tensor generation:  0.03317880630493164
mini_batch_src_global generation:  0.05269145965576172
r_  generation:  0.4481470584869385
local_output_nid generation:  0.031154870986938477
local_in_edges_tensor generation:  0.03397321701049805
mini_batch_src_global generation:  0.051758766174316406
r_  generation:  0.45732879638671875
local_output_nid generation:  0.030126333236694336
local_in_edges_tensor generation:  0.029810667037963867
mini_batch_src_global generation:  0.05271172523498535
r_  generation:  0.45308709144592285
local_output_nid generation:  0.031352996826171875
local_in_edges_tensor generation:  0.034346580505371094
mini_batch_src_global generation:  0.05164837837219238
r_  generation:  0.45636701583862305
local_output_nid generation:  0.030588626861572266
local_in_edges_tensor generation:  0.034381866455078125
mini_batch_src_global generation:  0.05242037773132324
r_  generation:  0.45049571990966797
local_output_nid generation:  0.030611038208007812
local_in_edges_tensor generation:  0.028537511825561523
mini_batch_src_global generation:  0.0514070987701416
r_  generation:  0.4612283706665039
local_output_nid generation:  0.030733346939086914
local_in_edges_tensor generation:  0.031911611557006836
mini_batch_src_global generation:  0.05292010307312012
r_  generation:  0.44915270805358887
----------------------check_connections_block total spend ----------------------------- 10.693069696426392
generate_one_block  0.5736479759216309
generate_one_block  0.5746281147003174
generate_one_block  0.5688016414642334
generate_one_block  0.5790493488311768
generate_one_block  0.5726499557495117
generate_one_block  0.5756189823150635
generate_one_block  0.571394681930542
generate_one_block  0.5796756744384766
generate_one_block  0.6289224624633789
generate_one_block  0.5789780616760254
generate_one_block  0.5753774642944336
generate_one_block  0.5721361637115479
generate_one_block  0.5739941596984863
generate_one_block  0.5753962993621826
generate_one_block  0.5734231472015381
generate_one_block  0.5767478942871094
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11527490615844727  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

connection checking time:  15.651224851608276
block generation total time  13.554449796676636
average batch blocks generation time:  0.8471531122922897
block dataloader generation time/epoch 31.324649837281967
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09381532669067383  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7162680625915527  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09343528747558594  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7211723327636719  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09391498565673828  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7170953750610352  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09346914291381836  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7189993858337402  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09393882751464844  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.717991828918457  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09346437454223633  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7199530601501465  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09383392333984375  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7149991989135742  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09350156784057617  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7172775268554688  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09390735626220703  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7194709777832031  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09341001510620117  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7147045135498047  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.093994140625  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7228837013244629  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09328269958496094  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7149868011474609  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09387969970703125  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7165699005126953  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09325027465820312  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7166156768798828  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09398746490478516  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7194018363952637  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09334659576416016  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7172355651855469  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06250400841236115 |0.011686980724334717 |0.0035495012998580933 |9.326636791229248e-05 |0.0037413984537124634 |0.0031151771545410156 |
----------------------------------------------------------pseudo_mini_loss sum 1.3517941236495972
Total (block generation + training)time/epoch 32.688368029064605
Training time/epoch 1.3674578666687012
Training time without block to device /epoch 1.1804661750793457
Training time without total dataloading part /epoch 0.1212618350982666
load block tensor time/epoch 1.0000641345977783
block to device time/epoch 0.18699169158935547
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 18 |
Number of nodes for computation during this epoch:  5091820
Number of first layer input nodes during this epoch:  2472020
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11509943008422852  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021022796630859375
range selection method range initialization spend 0.012177467346191406
time for parepare:  0.015965938568115234
local_output_nid generation:  0.0014121532440185547
local_in_edges_tensor generation:  0.0049953460693359375
mini_batch_src_global generation:  0.0015633106231689453
r_  generation:  0.018670320510864258
local_output_nid generation:  0.001550912857055664
local_in_edges_tensor generation:  0.000993967056274414
mini_batch_src_global generation:  0.001768350601196289
r_  generation:  0.019232749938964844
local_output_nid generation:  0.0015153884887695312
local_in_edges_tensor generation:  0.0009284019470214844
mini_batch_src_global generation:  0.0014650821685791016
r_  generation:  0.01853013038635254
local_output_nid generation:  0.0016269683837890625
local_in_edges_tensor generation:  0.000881195068359375
mini_batch_src_global generation:  0.0015125274658203125
r_  generation:  0.018978595733642578
local_output_nid generation:  0.0016219615936279297
local_in_edges_tensor generation:  0.0008985996246337891
mini_batch_src_global generation:  0.0014410018920898438
r_  generation:  0.01894688606262207
local_output_nid generation:  0.0015571117401123047
local_in_edges_tensor generation:  0.0009286403656005859
mini_batch_src_global generation:  0.0014715194702148438
r_  generation:  0.018619775772094727
local_output_nid generation:  0.0015697479248046875
local_in_edges_tensor generation:  0.0009145736694335938
mini_batch_src_global generation:  0.0015134811401367188
r_  generation:  0.019219398498535156
local_output_nid generation:  0.001558542251586914
local_in_edges_tensor generation:  0.0008857250213623047
mini_batch_src_global generation:  0.0015423297882080078
r_  generation:  0.019063949584960938
local_output_nid generation:  0.0015838146209716797
local_in_edges_tensor generation:  0.0009596347808837891
mini_batch_src_global generation:  0.0014967918395996094
r_  generation:  0.019137859344482422
local_output_nid generation:  0.0015554428100585938
local_in_edges_tensor generation:  0.0008692741394042969
mini_batch_src_global generation:  0.0015053749084472656
r_  generation:  0.019734621047973633
local_output_nid generation:  0.001580953598022461
local_in_edges_tensor generation:  0.0008711814880371094
mini_batch_src_global generation:  0.0015354156494140625
r_  generation:  0.019607067108154297
local_output_nid generation:  0.0015554428100585938
local_in_edges_tensor generation:  0.0008523464202880859
mini_batch_src_global generation:  0.0015027523040771484
r_  generation:  0.019381284713745117
local_output_nid generation:  0.001615285873413086
local_in_edges_tensor generation:  0.0009045600891113281
mini_batch_src_global generation:  0.001474142074584961
r_  generation:  0.01927661895751953
local_output_nid generation:  0.0016086101531982422
local_in_edges_tensor generation:  0.00086212158203125
mini_batch_src_global generation:  0.0014653205871582031
r_  generation:  0.01930522918701172
local_output_nid generation:  0.0015349388122558594
local_in_edges_tensor generation:  0.0009150505065917969
mini_batch_src_global generation:  0.0015189647674560547
r_  generation:  0.018881797790527344
local_output_nid generation:  0.0015497207641601562
local_in_edges_tensor generation:  0.0008947849273681641
mini_batch_src_global generation:  0.0014519691467285156
r_  generation:  0.01927804946899414
----------------------check_connections_block total spend ----------------------------- 0.4610879421234131
generate_one_block  0.032622337341308594
generate_one_block  0.028176307678222656
generate_one_block  0.02738213539123535
generate_one_block  0.02774834632873535
generate_one_block  0.027930498123168945
generate_one_block  0.02876448631286621
generate_one_block  0.02785491943359375
generate_one_block  0.02740955352783203
generate_one_block  0.027693510055541992
generate_one_block  0.02815699577331543
generate_one_block  0.028083324432373047
generate_one_block  0.02784109115600586
generate_one_block  0.027498960494995117
generate_one_block  0.02762150764465332
generate_one_block  0.02864980697631836
generate_one_block  0.02838587760925293
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03427290916442871
gen group dst list time:  0.015408515930175781
time for parepare:  0.019115924835205078
local_output_nid generation:  0.009954452514648438
local_in_edges_tensor generation:  0.02176952362060547
mini_batch_src_global generation:  0.01969742774963379
r_  generation:  0.19247794151306152
local_output_nid generation:  0.010079622268676758
local_in_edges_tensor generation:  0.016274690628051758
mini_batch_src_global generation:  0.02519679069519043
r_  generation:  0.20459246635437012
local_output_nid generation:  0.010323762893676758
local_in_edges_tensor generation:  0.014185667037963867
mini_batch_src_global generation:  0.02530527114868164
r_  generation:  0.20457768440246582
local_output_nid generation:  0.011659383773803711
local_in_edges_tensor generation:  0.013332366943359375
mini_batch_src_global generation:  0.02555251121520996
r_  generation:  0.2149970531463623
local_output_nid generation:  0.011487722396850586
local_in_edges_tensor generation:  0.012217521667480469
mini_batch_src_global generation:  0.02676224708557129
r_  generation:  0.22243499755859375
local_output_nid generation:  0.01309967041015625
local_in_edges_tensor generation:  0.018372297286987305
mini_batch_src_global generation:  0.02561783790588379
r_  generation:  0.20493316650390625
local_output_nid generation:  0.012016773223876953
local_in_edges_tensor generation:  0.011707782745361328
mini_batch_src_global generation:  0.025879621505737305
r_  generation:  0.20781350135803223
local_output_nid generation:  0.012002944946289062
local_in_edges_tensor generation:  0.011374950408935547
mini_batch_src_global generation:  0.02608323097229004
r_  generation:  0.21221613883972168
local_output_nid generation:  0.012058019638061523
local_in_edges_tensor generation:  0.011570215225219727
mini_batch_src_global generation:  0.026124954223632812
r_  generation:  0.21115684509277344
local_output_nid generation:  0.01230168342590332
local_in_edges_tensor generation:  0.013041973114013672
mini_batch_src_global generation:  0.027646541595458984
r_  generation:  0.21422457695007324
local_output_nid generation:  0.012063741683959961
local_in_edges_tensor generation:  0.012286663055419922
mini_batch_src_global generation:  0.026726484298706055
r_  generation:  0.21643877029418945
local_output_nid generation:  0.011945962905883789
local_in_edges_tensor generation:  0.011557340621948242
mini_batch_src_global generation:  0.026263952255249023
r_  generation:  0.21349048614501953
local_output_nid generation:  0.012138128280639648
local_in_edges_tensor generation:  0.011791467666625977
mini_batch_src_global generation:  0.02607250213623047
r_  generation:  0.2079775333404541
local_output_nid generation:  0.01235818862915039
local_in_edges_tensor generation:  0.014473676681518555
mini_batch_src_global generation:  0.027895450592041016
r_  generation:  0.21730709075927734
local_output_nid generation:  0.012120962142944336
local_in_edges_tensor generation:  0.012599468231201172
mini_batch_src_global generation:  0.026566743850708008
r_  generation:  0.22487926483154297
local_output_nid generation:  0.015309810638427734
local_in_edges_tensor generation:  0.012174129486083984
mini_batch_src_global generation:  0.027484893798828125
r_  generation:  0.21738505363464355
----------------------check_connections_block total spend ----------------------------- 4.976643323898315
generate_one_block  0.2830958366394043
generate_one_block  0.2756509780883789
generate_one_block  0.27036356925964355
generate_one_block  0.2763047218322754
generate_one_block  0.2791106700897217
generate_one_block  0.27011775970458984
generate_one_block  0.2936234474182129
generate_one_block  0.27737903594970703
generate_one_block  0.26996707916259766
generate_one_block  0.2718367576599121
generate_one_block  0.27543044090270996
generate_one_block  0.26790690422058105
generate_one_block  0.26357173919677734
generate_one_block  0.2763855457305908
generate_one_block  0.26629638671875
generate_one_block  0.2743673324584961
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03407645225524902
gen group dst list time:  0.06683683395385742
time for parepare:  0.018380165100097656
local_output_nid generation:  0.02522444725036621
local_in_edges_tensor generation:  0.0558013916015625
mini_batch_src_global generation:  0.042222023010253906
r_  generation:  0.44394731521606445
local_output_nid generation:  0.029396772384643555
local_in_edges_tensor generation:  0.03620457649230957
mini_batch_src_global generation:  0.051552772521972656
r_  generation:  0.4556276798248291
local_output_nid generation:  0.02951836585998535
local_in_edges_tensor generation:  0.030414104461669922
mini_batch_src_global generation:  0.05325031280517578
r_  generation:  0.45191144943237305
local_output_nid generation:  0.029955625534057617
local_in_edges_tensor generation:  0.030574798583984375
mini_batch_src_global generation:  0.051905155181884766
r_  generation:  0.45160746574401855
local_output_nid generation:  0.0306549072265625
local_in_edges_tensor generation:  0.0744626522064209
mini_batch_src_global generation:  0.05316162109375
r_  generation:  0.4626028537750244
local_output_nid generation:  0.03025984764099121
local_in_edges_tensor generation:  0.033693552017211914
mini_batch_src_global generation:  0.054477691650390625
r_  generation:  0.45505666732788086
local_output_nid generation:  0.029946088790893555
local_in_edges_tensor generation:  0.03159213066101074
mini_batch_src_global generation:  0.05181574821472168
r_  generation:  0.4588806629180908
local_output_nid generation:  0.030182838439941406
local_in_edges_tensor generation:  0.039602041244506836
mini_batch_src_global generation:  0.055197715759277344
r_  generation:  0.45287108421325684
local_output_nid generation:  0.03003549575805664
local_in_edges_tensor generation:  0.03276348114013672
mini_batch_src_global generation:  0.05369901657104492
r_  generation:  0.45281004905700684
local_output_nid generation:  0.03090047836303711
local_in_edges_tensor generation:  0.03433489799499512
mini_batch_src_global generation:  0.05449628829956055
r_  generation:  0.47679591178894043
local_output_nid generation:  0.03490591049194336
local_in_edges_tensor generation:  0.03382563591003418
mini_batch_src_global generation:  0.05347633361816406
r_  generation:  0.4634277820587158
local_output_nid generation:  0.03152275085449219
local_in_edges_tensor generation:  0.030231475830078125
mini_batch_src_global generation:  0.05277824401855469
r_  generation:  0.4542958736419678
local_output_nid generation:  0.031144380569458008
local_in_edges_tensor generation:  0.0292513370513916
mini_batch_src_global generation:  0.05180764198303223
r_  generation:  0.45180773735046387
local_output_nid generation:  0.03163933753967285
local_in_edges_tensor generation:  0.029585838317871094
mini_batch_src_global generation:  0.05426764488220215
r_  generation:  0.4539616107940674
local_output_nid generation:  0.031040191650390625
local_in_edges_tensor generation:  0.03136444091796875
mini_batch_src_global generation:  0.05236625671386719
r_  generation:  0.4568495750427246
local_output_nid generation:  0.03137373924255371
local_in_edges_tensor generation:  0.029817819595336914
mini_batch_src_global generation:  0.05429363250732422
r_  generation:  0.45136284828186035
----------------------check_connections_block total spend ----------------------------- 10.79968786239624
generate_one_block  0.5892493724822998
generate_one_block  0.5804975032806396
generate_one_block  0.5780205726623535
generate_one_block  0.5816645622253418
generate_one_block  0.5869007110595703
generate_one_block  0.569406270980835
generate_one_block  0.5722227096557617
generate_one_block  0.5881421566009521
generate_one_block  0.6160571575164795
generate_one_block  0.5814259052276611
generate_one_block  0.5870668888092041
generate_one_block  0.5799148082733154
generate_one_block  0.5660145282745361
generate_one_block  0.5732550621032715
generate_one_block  0.5668118000030518
generate_one_block  0.5807571411132812
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11509943008422852  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

connection checking time:  15.776331186294556
block generation total time  13.688815355300903
average batch blocks generation time:  0.8555509597063065
block dataloader generation time/epoch 31.34000709056854
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09401655197143555  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7202792167663574  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09344768524169922  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7173113822937012  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09378528594970703  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.711977481842041  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09337043762207031  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7192296981811523  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0939483642578125  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7185940742492676  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09307622909545898  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7145886421203613  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09384536743164062  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7185053825378418  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09330463409423828  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7171564102172852  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09384536743164062  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7120380401611328  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09328222274780273  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7200493812561035  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09400749206542969  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7197566032409668  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09343433380126953  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7179622650146484  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.093719482421875  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7111625671386719  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09343242645263672  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7188515663146973  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09377002716064453  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.715395450592041  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09351778030395508  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7182564735412598  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0630793422460556 |0.012060686945915222 |0.0035425275564193726 |9.052455425262451e-05 |0.003737151622772217 |0.0018758773803710938 |
----------------------------------------------------------pseudo_mini_loss sum 1.3403681516647339
Total (block generation + training)time/epoch 32.70548112392426
Training time/epoch 1.3810393810272217
Training time without block to device /epoch 1.1880683898925781
Training time without total dataloading part /epoch 0.11979913711547852
load block tensor time/epoch 1.0092694759368896
block to device time/epoch 0.19297099113464355
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 19 |
Number of nodes for computation during this epoch:  5089930
Number of first layer input nodes during this epoch:  2471074
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11542320251464844  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021898746490478516
range selection method range initialization spend 0.011989593505859375
time for parepare:  0.017986774444580078
local_output_nid generation:  0.001439809799194336
local_in_edges_tensor generation:  0.00398707389831543
mini_batch_src_global generation:  0.0015802383422851562
r_  generation:  0.018615007400512695
local_output_nid generation:  0.0015482902526855469
local_in_edges_tensor generation:  0.0009529590606689453
mini_batch_src_global generation:  0.001772165298461914
r_  generation:  0.01936173439025879
local_output_nid generation:  0.0015332698822021484
local_in_edges_tensor generation:  0.0009756088256835938
mini_batch_src_global generation:  0.0014269351959228516
r_  generation:  0.01823115348815918
local_output_nid generation:  0.001634359359741211
local_in_edges_tensor generation:  0.0008769035339355469
mini_batch_src_global generation:  0.001399993896484375
r_  generation:  0.01819467544555664
local_output_nid generation:  0.001556396484375
local_in_edges_tensor generation:  0.0009057521820068359
mini_batch_src_global generation:  0.001466512680053711
r_  generation:  0.018573522567749023
local_output_nid generation:  0.0015954971313476562
local_in_edges_tensor generation:  0.0008857250213623047
mini_batch_src_global generation:  0.0015172958374023438
r_  generation:  0.019493818283081055
local_output_nid generation:  0.001523733139038086
local_in_edges_tensor generation:  0.0008673667907714844
mini_batch_src_global generation:  0.0015223026275634766
r_  generation:  0.01952505111694336
local_output_nid generation:  0.0015349388122558594
local_in_edges_tensor generation:  0.0008928775787353516
mini_batch_src_global generation:  0.0014882087707519531
r_  generation:  0.01923394203186035
local_output_nid generation:  0.0015647411346435547
local_in_edges_tensor generation:  0.0009562969207763672
mini_batch_src_global generation:  0.001500844955444336
r_  generation:  0.01893472671508789
local_output_nid generation:  0.0015561580657958984
local_in_edges_tensor generation:  0.0009338855743408203
mini_batch_src_global generation:  0.0014605522155761719
r_  generation:  0.019155025482177734
local_output_nid generation:  0.0015442371368408203
local_in_edges_tensor generation:  0.0009410381317138672
mini_batch_src_global generation:  0.0015339851379394531
r_  generation:  0.019275903701782227
local_output_nid generation:  0.001575469970703125
local_in_edges_tensor generation:  0.0008628368377685547
mini_batch_src_global generation:  0.0015044212341308594
r_  generation:  0.019410133361816406
local_output_nid generation:  0.0016245841979980469
local_in_edges_tensor generation:  0.0009076595306396484
mini_batch_src_global generation:  0.0015609264373779297
r_  generation:  0.019126176834106445
local_output_nid generation:  0.0015659332275390625
local_in_edges_tensor generation:  0.0009357929229736328
mini_batch_src_global generation:  0.0015232563018798828
r_  generation:  0.019639968872070312
local_output_nid generation:  0.001537322998046875
local_in_edges_tensor generation:  0.0008873939514160156
mini_batch_src_global generation:  0.0015139579772949219
r_  generation:  0.018823623657226562
local_output_nid generation:  0.0017070770263671875
local_in_edges_tensor generation:  0.0009777545928955078
mini_batch_src_global generation:  0.0015361309051513672
r_  generation:  0.019855976104736328
----------------------check_connections_block total spend ----------------------------- 0.4606153964996338
generate_one_block  0.027659177780151367
generate_one_block  0.02814340591430664
generate_one_block  0.02676534652709961
generate_one_block  0.026998281478881836
generate_one_block  0.027443647384643555
generate_one_block  0.029931306838989258
generate_one_block  0.028163433074951172
generate_one_block  0.027112722396850586
generate_one_block  0.027399778366088867
generate_one_block  0.027446508407592773
generate_one_block  0.02810049057006836
generate_one_block  0.02839517593383789
generate_one_block  0.027460813522338867
generate_one_block  0.028151750564575195
generate_one_block  0.02839493751525879
generate_one_block  0.029425382614135742
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.046050071716308594
gen group dst list time:  0.01864767074584961
time for parepare:  0.020499229431152344
local_output_nid generation:  0.006815910339355469
local_in_edges_tensor generation:  0.019118070602416992
mini_batch_src_global generation:  0.020398616790771484
r_  generation:  0.1968696117401123
local_output_nid generation:  0.011645317077636719
local_in_edges_tensor generation:  0.013920307159423828
mini_batch_src_global generation:  0.030406951904296875
r_  generation:  0.20259571075439453
local_output_nid generation:  0.010224342346191406
local_in_edges_tensor generation:  0.013759851455688477
mini_batch_src_global generation:  0.023874759674072266
r_  generation:  0.2012343406677246
local_output_nid generation:  0.011031866073608398
local_in_edges_tensor generation:  0.010523080825805664
mini_batch_src_global generation:  0.023755788803100586
r_  generation:  0.20545625686645508
local_output_nid generation:  0.011677265167236328
local_in_edges_tensor generation:  0.01117253303527832
mini_batch_src_global generation:  0.025062084197998047
r_  generation:  0.21165752410888672
local_output_nid generation:  0.011574268341064453
local_in_edges_tensor generation:  0.012566804885864258
mini_batch_src_global generation:  0.02592635154724121
r_  generation:  0.2169802188873291
local_output_nid generation:  0.011952400207519531
local_in_edges_tensor generation:  0.011459589004516602
mini_batch_src_global generation:  0.026575565338134766
r_  generation:  0.21564793586730957
local_output_nid generation:  0.011687278747558594
local_in_edges_tensor generation:  0.010912656784057617
mini_batch_src_global generation:  0.02607250213623047
r_  generation:  0.206923246383667
local_output_nid generation:  0.011825799942016602
local_in_edges_tensor generation:  0.011049270629882812
mini_batch_src_global generation:  0.0261080265045166
r_  generation:  0.20914316177368164
local_output_nid generation:  0.011700868606567383
local_in_edges_tensor generation:  0.010944128036499023
mini_batch_src_global generation:  0.025922298431396484
r_  generation:  0.2105879783630371
local_output_nid generation:  0.01213216781616211
local_in_edges_tensor generation:  0.011159896850585938
mini_batch_src_global generation:  0.029987335205078125
r_  generation:  0.21799206733703613
local_output_nid generation:  0.011945247650146484
local_in_edges_tensor generation:  0.011264562606811523
mini_batch_src_global generation:  0.02647686004638672
r_  generation:  0.21597933769226074
local_output_nid generation:  0.011960506439208984
local_in_edges_tensor generation:  0.012260675430297852
mini_batch_src_global generation:  0.02676701545715332
r_  generation:  0.21497225761413574
local_output_nid generation:  0.012319087982177734
local_in_edges_tensor generation:  0.012388467788696289
mini_batch_src_global generation:  0.028327226638793945
r_  generation:  0.21435952186584473
local_output_nid generation:  0.012064695358276367
local_in_edges_tensor generation:  0.011346578598022461
mini_batch_src_global generation:  0.027120590209960938
r_  generation:  0.211836576461792
local_output_nid generation:  0.012116193771362305
local_in_edges_tensor generation:  0.011651992797851562
mini_batch_src_global generation:  0.027675390243530273
r_  generation:  0.21806001663208008
----------------------check_connections_block total spend ----------------------------- 4.928357839584351
generate_one_block  0.2658572196960449
generate_one_block  0.2682349681854248
generate_one_block  0.2635982036590576
generate_one_block  0.2629990577697754
generate_one_block  0.2658345699310303
generate_one_block  0.27379679679870605
generate_one_block  0.29569220542907715
generate_one_block  0.26395106315612793
generate_one_block  0.26233935356140137
generate_one_block  0.26424455642700195
generate_one_block  0.26943492889404297
generate_one_block  0.27411770820617676
generate_one_block  0.26604771614074707
generate_one_block  0.27449846267700195
generate_one_block  0.26516294479370117
generate_one_block  0.2761256694793701
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03024601936340332
gen group dst list time:  0.06082272529602051
time for parepare:  0.017961740493774414
local_output_nid generation:  0.024418354034423828
local_in_edges_tensor generation:  0.04494595527648926
mini_batch_src_global generation:  0.041265249252319336
r_  generation:  0.44344472885131836
local_output_nid generation:  0.02951645851135254
local_in_edges_tensor generation:  0.033490896224975586
mini_batch_src_global generation:  0.05327463150024414
r_  generation:  0.4495549201965332
local_output_nid generation:  0.029795169830322266
local_in_edges_tensor generation:  0.028208494186401367
mini_batch_src_global generation:  0.05379676818847656
r_  generation:  0.45656847953796387
local_output_nid generation:  0.030468225479125977
local_in_edges_tensor generation:  0.02886056900024414
mini_batch_src_global generation:  0.0561521053314209
r_  generation:  0.45227909088134766
local_output_nid generation:  0.030521392822265625
local_in_edges_tensor generation:  0.07010912895202637
mini_batch_src_global generation:  0.05256915092468262
r_  generation:  0.4571511745452881
local_output_nid generation:  0.032231807708740234
local_in_edges_tensor generation:  0.03391265869140625
mini_batch_src_global generation:  0.05416703224182129
r_  generation:  0.45559048652648926
local_output_nid generation:  0.030309200286865234
local_in_edges_tensor generation:  0.028556108474731445
mini_batch_src_global generation:  0.05170941352844238
r_  generation:  0.4623713493347168
local_output_nid generation:  0.030478954315185547
local_in_edges_tensor generation:  0.028081417083740234
mini_batch_src_global generation:  0.05240488052368164
r_  generation:  0.4512207508087158
local_output_nid generation:  0.030829191207885742
local_in_edges_tensor generation:  0.03114628791809082
mini_batch_src_global generation:  0.052289724349975586
r_  generation:  0.4569990634918213
local_output_nid generation:  0.030403614044189453
local_in_edges_tensor generation:  0.03251361846923828
mini_batch_src_global generation:  0.051770687103271484
r_  generation:  0.4530758857727051
local_output_nid generation:  0.030520200729370117
local_in_edges_tensor generation:  0.03156685829162598
mini_batch_src_global generation:  0.052773237228393555
r_  generation:  0.45592546463012695
local_output_nid generation:  0.03100419044494629
local_in_edges_tensor generation:  0.030194759368896484
mini_batch_src_global generation:  0.05507636070251465
r_  generation:  0.4594554901123047
local_output_nid generation:  0.030461788177490234
local_in_edges_tensor generation:  0.031152009963989258
mini_batch_src_global generation:  0.05159497261047363
r_  generation:  0.46782350540161133
local_output_nid generation:  0.030826091766357422
local_in_edges_tensor generation:  0.028099775314331055
mini_batch_src_global generation:  0.05246543884277344
r_  generation:  0.44977259635925293
local_output_nid generation:  0.030994653701782227
local_in_edges_tensor generation:  0.029001474380493164
mini_batch_src_global generation:  0.052013397216796875
r_  generation:  0.4563770294189453
local_output_nid generation:  0.03088855743408203
local_in_edges_tensor generation:  0.02922511100769043
mini_batch_src_global generation:  0.05410456657409668
r_  generation:  0.4514279365539551
----------------------check_connections_block total spend ----------------------------- 10.72514271736145
generate_one_block  0.5692710876464844
generate_one_block  0.5823304653167725
generate_one_block  0.5762448310852051
generate_one_block  0.5747201442718506
generate_one_block  0.5814814567565918
generate_one_block  0.5780048370361328
generate_one_block  0.5847442150115967
generate_one_block  0.5700297355651855
generate_one_block  0.6285121440887451
generate_one_block  0.5729062557220459
generate_one_block  0.5787568092346191
generate_one_block  0.5832486152648926
generate_one_block  0.5687334537506104
generate_one_block  0.5757720470428467
generate_one_block  0.5716001987457275
generate_one_block  0.5794248580932617
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11542320251464844  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

connection checking time:  15.6535005569458
block generation total time  13.587716579437256
average batch blocks generation time:  0.8492322862148285
block dataloader generation time/epoch 31.328479701822456
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09389448165893555  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7169175148010254  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09333562850952148  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7159595489501953  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09376049041748047  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7147994041442871  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09316539764404297  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7141437530517578  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09386253356933594  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7163910865783691  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09351778030395508  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7216362953186035  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09401512145996094  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7229151725769043  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0931253433227539  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7113256454467773  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09380245208740234  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7156124114990234  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09311628341674805  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7125387191772461  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09393310546875  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7198190689086914  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09350872039794922  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7200379371643066  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09386825561523438  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7132911682128906  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09342479705810547  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7193775177001953  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09383392333984375  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7176666259765625  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0934591293334961  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7231268882751465  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06254811584949493 |0.01352335512638092 |0.0035520195960998535 |9.179115295410156e-05 |0.0037570148706436157 |0.002871274948120117 |
----------------------------------------------------------pseudo_mini_loss sum 1.3282867670059204
Total (block generation + training)time/epoch 32.696795441887595
Training time/epoch 1.3964526653289795
Training time without block to device /epoch 1.1800789833068848
Training time without total dataloading part /epoch 0.12128448486328125
load block tensor time/epoch 1.000769853591919
block to device time/epoch 0.21637368202209473
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 20 |
Number of nodes for computation during this epoch:  5089361
Number of first layer input nodes during this epoch:  2471688
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11558103561401367  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02391982078552246
range selection method range initialization spend 0.012180566787719727
time for parepare:  0.017826557159423828
local_output_nid generation:  0.0014030933380126953
local_in_edges_tensor generation:  0.004785299301147461
mini_batch_src_global generation:  0.0016603469848632812
r_  generation:  0.018586397171020508
local_output_nid generation:  0.0015227794647216797
local_in_edges_tensor generation:  0.0009508132934570312
mini_batch_src_global generation:  0.0017995834350585938
r_  generation:  0.019374370574951172
local_output_nid generation:  0.0016486644744873047
local_in_edges_tensor generation:  0.0009033679962158203
mini_batch_src_global generation:  0.0014722347259521484
r_  generation:  0.018819093704223633
local_output_nid generation:  0.0015811920166015625
local_in_edges_tensor generation:  0.0009677410125732422
mini_batch_src_global generation:  0.001493215560913086
r_  generation:  0.01856398582458496
local_output_nid generation:  0.0015406608581542969
local_in_edges_tensor generation:  0.00091552734375
mini_batch_src_global generation:  0.0014567375183105469
r_  generation:  0.018541574478149414
local_output_nid generation:  0.0016252994537353516
local_in_edges_tensor generation:  0.0008940696716308594
mini_batch_src_global generation:  0.0014679431915283203
r_  generation:  0.019144535064697266
local_output_nid generation:  0.0015642642974853516
local_in_edges_tensor generation:  0.0009639263153076172
mini_batch_src_global generation:  0.001524209976196289
r_  generation:  0.019321203231811523
local_output_nid generation:  0.0015654563903808594
local_in_edges_tensor generation:  0.0008771419525146484
mini_batch_src_global generation:  0.0015056133270263672
r_  generation:  0.019679784774780273
local_output_nid generation:  0.0015549659729003906
local_in_edges_tensor generation:  0.0008990764617919922
mini_batch_src_global generation:  0.0015337467193603516
r_  generation:  0.019519805908203125
local_output_nid generation:  0.0015828609466552734
local_in_edges_tensor generation:  0.0009391307830810547
mini_batch_src_global generation:  0.0015327930450439453
r_  generation:  0.01930546760559082
local_output_nid generation:  0.0015492439270019531
local_in_edges_tensor generation:  0.0008959770202636719
mini_batch_src_global generation:  0.0015270709991455078
r_  generation:  0.019042015075683594
local_output_nid generation:  0.0015630722045898438
local_in_edges_tensor generation:  0.0008783340454101562
mini_batch_src_global generation:  0.0015215873718261719
r_  generation:  0.01890110969543457
local_output_nid generation:  0.0016202926635742188
local_in_edges_tensor generation:  0.0009179115295410156
mini_batch_src_global generation:  0.0015411376953125
r_  generation:  0.019513368606567383
local_output_nid generation:  0.0015671253204345703
local_in_edges_tensor generation:  0.0008780956268310547
mini_batch_src_global generation:  0.0014927387237548828
r_  generation:  0.019246578216552734
local_output_nid generation:  0.0015423297882080078
local_in_edges_tensor generation:  0.0008761882781982422
mini_batch_src_global generation:  0.0014786720275878906
r_  generation:  0.01914811134338379
local_output_nid generation:  0.0015420913696289062
local_in_edges_tensor generation:  0.0008409023284912109
mini_batch_src_global generation:  0.001516580581665039
r_  generation:  0.019054651260375977
----------------------check_connections_block total spend ----------------------------- 0.4601316452026367
generate_one_block  0.03617453575134277
generate_one_block  0.027851581573486328
generate_one_block  0.02778792381286621
generate_one_block  0.027629613876342773
generate_one_block  0.027435302734375
generate_one_block  0.029566049575805664
generate_one_block  0.027842044830322266
generate_one_block  0.028180360794067383
generate_one_block  0.028616905212402344
generate_one_block  0.028034687042236328
generate_one_block  0.02751445770263672
generate_one_block  0.027774333953857422
generate_one_block  0.027783632278442383
generate_one_block  0.027591228485107422
generate_one_block  0.02766108512878418
generate_one_block  0.028096675872802734
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.034122467041015625
gen group dst list time:  0.015843868255615234
time for parepare:  0.01963949203491211
local_output_nid generation:  0.007035255432128906
local_in_edges_tensor generation:  0.01948094367980957
mini_batch_src_global generation:  0.020931720733642578
r_  generation:  0.1925818920135498
local_output_nid generation:  0.010011672973632812
local_in_edges_tensor generation:  0.013080596923828125
mini_batch_src_global generation:  0.02721095085144043
r_  generation:  0.20102858543395996
local_output_nid generation:  0.010277986526489258
local_in_edges_tensor generation:  0.01101541519165039
mini_batch_src_global generation:  0.024611473083496094
r_  generation:  0.20364880561828613
local_output_nid generation:  0.010856151580810547
local_in_edges_tensor generation:  0.010706663131713867
mini_batch_src_global generation:  0.024052143096923828
r_  generation:  0.20391464233398438
local_output_nid generation:  0.011411905288696289
local_in_edges_tensor generation:  0.011710882186889648
mini_batch_src_global generation:  0.026776790618896484
r_  generation:  0.2102658748626709
local_output_nid generation:  0.011328935623168945
local_in_edges_tensor generation:  0.011072397232055664
mini_batch_src_global generation:  0.025667667388916016
r_  generation:  0.20752167701721191
local_output_nid generation:  0.011632204055786133
local_in_edges_tensor generation:  0.011660575866699219
mini_batch_src_global generation:  0.025906085968017578
r_  generation:  0.20807838439941406
local_output_nid generation:  0.01179957389831543
local_in_edges_tensor generation:  0.013187170028686523
mini_batch_src_global generation:  0.026424407958984375
r_  generation:  0.21416616439819336
local_output_nid generation:  0.011945724487304688
local_in_edges_tensor generation:  0.01195526123046875
mini_batch_src_global generation:  0.026983261108398438
r_  generation:  0.21503663063049316
local_output_nid generation:  0.01176309585571289
local_in_edges_tensor generation:  0.011175870895385742
mini_batch_src_global generation:  0.02775406837463379
r_  generation:  0.2110440731048584
local_output_nid generation:  0.011709928512573242
local_in_edges_tensor generation:  0.011525869369506836
mini_batch_src_global generation:  0.026325225830078125
r_  generation:  0.2105090618133545
local_output_nid generation:  0.011505603790283203
local_in_edges_tensor generation:  0.01153874397277832
mini_batch_src_global generation:  0.026282548904418945
r_  generation:  0.21080732345581055
local_output_nid generation:  0.01206064224243164
local_in_edges_tensor generation:  0.012154102325439453
mini_batch_src_global generation:  0.026885986328125
r_  generation:  0.21546244621276855
local_output_nid generation:  0.011823415756225586
local_in_edges_tensor generation:  0.012870311737060547
mini_batch_src_global generation:  0.026527881622314453
r_  generation:  0.2119429111480713
local_output_nid generation:  0.011960983276367188
local_in_edges_tensor generation:  0.011471271514892578
mini_batch_src_global generation:  0.026304006576538086
r_  generation:  0.210557222366333
local_output_nid generation:  0.01216268539428711
local_in_edges_tensor generation:  0.011463403701782227
mini_batch_src_global generation:  0.02633976936340332
r_  generation:  0.21391916275024414
----------------------check_connections_block total spend ----------------------------- 4.889741897583008
generate_one_block  0.2675819396972656
generate_one_block  0.26141977310180664
generate_one_block  0.26795148849487305
generate_one_block  0.2657182216644287
generate_one_block  0.26923680305480957
generate_one_block  0.2666745185852051
generate_one_block  0.286029577255249
generate_one_block  0.269594669342041
generate_one_block  0.2754843235015869
generate_one_block  0.2681148052215576
generate_one_block  0.26246166229248047
generate_one_block  0.26520395278930664
generate_one_block  0.2738618850708008
generate_one_block  0.26729893684387207
generate_one_block  0.2624778747558594
generate_one_block  0.26966261863708496
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.027202129364013672
gen group dst list time:  0.06103348731994629
time for parepare:  0.017946243286132812
local_output_nid generation:  0.024500608444213867
local_in_edges_tensor generation:  0.04103207588195801
mini_batch_src_global generation:  0.04010367393493652
r_  generation:  0.44496583938598633
local_output_nid generation:  0.029407501220703125
local_in_edges_tensor generation:  0.0313420295715332
mini_batch_src_global generation:  0.0510563850402832
r_  generation:  0.4442265033721924
local_output_nid generation:  0.029668569564819336
local_in_edges_tensor generation:  0.03046393394470215
mini_batch_src_global generation:  0.0507352352142334
r_  generation:  0.452364444732666
local_output_nid generation:  0.03207254409790039
local_in_edges_tensor generation:  0.03128314018249512
mini_batch_src_global generation:  0.051514625549316406
r_  generation:  0.4444606304168701
local_output_nid generation:  0.03019094467163086
local_in_edges_tensor generation:  0.07282829284667969
mini_batch_src_global generation:  0.05075240135192871
r_  generation:  0.45444750785827637
local_output_nid generation:  0.030118703842163086
local_in_edges_tensor generation:  0.029893875122070312
mini_batch_src_global generation:  0.05202841758728027
r_  generation:  0.44698119163513184
local_output_nid generation:  0.03018355369567871
local_in_edges_tensor generation:  0.02782130241394043
mini_batch_src_global generation:  0.05150270462036133
r_  generation:  0.4523584842681885
local_output_nid generation:  0.030488014221191406
local_in_edges_tensor generation:  0.028397083282470703
mini_batch_src_global generation:  0.05187797546386719
r_  generation:  0.4521913528442383
local_output_nid generation:  0.03009033203125
local_in_edges_tensor generation:  0.03402376174926758
mini_batch_src_global generation:  0.051164865493774414
r_  generation:  0.4587695598602295
local_output_nid generation:  0.030946016311645508
local_in_edges_tensor generation:  0.030312061309814453
mini_batch_src_global generation:  0.05284523963928223
r_  generation:  0.4654276371002197
local_output_nid generation:  0.030795812606811523
local_in_edges_tensor generation:  0.029044151306152344
mini_batch_src_global generation:  0.05221986770629883
r_  generation:  0.4646167755126953
local_output_nid generation:  0.030609130859375
local_in_edges_tensor generation:  0.029079198837280273
mini_batch_src_global generation:  0.05226898193359375
r_  generation:  0.456500768661499
local_output_nid generation:  0.030612945556640625
local_in_edges_tensor generation:  0.03139448165893555
mini_batch_src_global generation:  0.051178932189941406
r_  generation:  0.4612886905670166
local_output_nid generation:  0.030636310577392578
local_in_edges_tensor generation:  0.02993607521057129
mini_batch_src_global generation:  0.05567216873168945
r_  generation:  0.45203518867492676
local_output_nid generation:  0.030518054962158203
local_in_edges_tensor generation:  0.029188871383666992
mini_batch_src_global generation:  0.05139422416687012
r_  generation:  0.45743894577026367
local_output_nid generation:  0.03054952621459961
local_in_edges_tensor generation:  0.02948904037475586
mini_batch_src_global generation:  0.055446624755859375
r_  generation:  0.45749902725219727
----------------------check_connections_block total spend ----------------------------- 10.69563603401184
generate_one_block  0.5732879638671875
generate_one_block  0.5691852569580078
generate_one_block  0.5747754573822021
generate_one_block  0.5732057094573975
generate_one_block  0.5729331970214844
generate_one_block  0.5747294425964355
generate_one_block  0.5758888721466064
generate_one_block  0.5790431499481201
generate_one_block  0.6193606853485107
generate_one_block  0.5707838535308838
generate_one_block  0.5757417678833008
generate_one_block  0.5698113441467285
generate_one_block  0.594658613204956
generate_one_block  0.5811374187469482
generate_one_block  0.5747935771942139
generate_one_block  0.5720219612121582
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11558103561401367  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

connection checking time:  15.585377931594849
block generation total time  13.55013132095337
average batch blocks generation time:  0.8468832075595856
block dataloader generation time/epoch 31.310078124205273
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09397459030151367  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7200217247009277  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0933675765991211  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7154335975646973  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0939178466796875  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7190589904785156  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09316492080688477  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7164626121520996  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09394645690917969  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7185091972351074  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09324312210083008  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7162408828735352  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09382247924804688  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7179040908813477  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0933370590209961  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.718895435333252  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0940408706665039  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7198624610900879  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09339714050292969  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7173848152160645  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09381675720214844  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7153706550598145  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09324502944946289  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7160782814025879  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0940389633178711  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7217350006103516  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09356975555419922  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7179241180419922  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09383201599121094  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7167644500732422  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0934290885925293  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7189006805419922  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06235766410827637 |0.010879546403884888 |0.0035119056701660156 |9.131431579589844e-05 |0.0037433356046676636 |0.002907276153564453 |
----------------------------------------------------------pseudo_mini_loss sum 1.3111186027526855
Total (block generation + training)time/epoch 32.67695587873459
Training time/epoch 1.3508729934692383
Training time without block to device /epoch 1.17680025100708
Training time without total dataloading part /epoch 0.1204521656036377
load block tensor time/epoch 0.9977226257324219
block to device time/epoch 0.1740727424621582
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 21 |
Number of nodes for computation during this epoch:  5092844
Number of first layer input nodes during this epoch:  2472150
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11525821685791016  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020750999450683594
range selection method range initialization spend 0.012068986892700195
time for parepare:  0.018248558044433594
local_output_nid generation:  0.0014424324035644531
local_in_edges_tensor generation:  0.0033698081970214844
mini_batch_src_global generation:  0.001543283462524414
r_  generation:  0.018744230270385742
local_output_nid generation:  0.0015430450439453125
local_in_edges_tensor generation:  0.0009317398071289062
mini_batch_src_global generation:  0.0017614364624023438
r_  generation:  0.020064353942871094
local_output_nid generation:  0.0015447139739990234
local_in_edges_tensor generation:  0.0009026527404785156
mini_batch_src_global generation:  0.0014832019805908203
r_  generation:  0.018743276596069336
local_output_nid generation:  0.0016560554504394531
local_in_edges_tensor generation:  0.0009183883666992188
mini_batch_src_global generation:  0.0015003681182861328
r_  generation:  0.019109010696411133
local_output_nid generation:  0.0015645027160644531
local_in_edges_tensor generation:  0.0008752346038818359
mini_batch_src_global generation:  0.0014662742614746094
r_  generation:  0.018967151641845703
local_output_nid generation:  0.0015597343444824219
local_in_edges_tensor generation:  0.0008726119995117188
mini_batch_src_global generation:  0.001482248306274414
r_  generation:  0.019947528839111328
local_output_nid generation:  0.0016126632690429688
local_in_edges_tensor generation:  0.0008995532989501953
mini_batch_src_global generation:  0.0015304088592529297
r_  generation:  0.019217491149902344
local_output_nid generation:  0.001538991928100586
local_in_edges_tensor generation:  0.0009129047393798828
mini_batch_src_global generation:  0.0015299320220947266
r_  generation:  0.019460201263427734
local_output_nid generation:  0.0015604496002197266
local_in_edges_tensor generation:  0.000911712646484375
mini_batch_src_global generation:  0.001527547836303711
r_  generation:  0.01943659782409668
local_output_nid generation:  0.0016176700592041016
local_in_edges_tensor generation:  0.0008928775787353516
mini_batch_src_global generation:  0.0014805793762207031
r_  generation:  0.018885135650634766
local_output_nid generation:  0.0015554428100585938
local_in_edges_tensor generation:  0.0008854866027832031
mini_batch_src_global generation:  0.0015316009521484375
r_  generation:  0.019649028778076172
local_output_nid generation:  0.0015511512756347656
local_in_edges_tensor generation:  0.0009007453918457031
mini_batch_src_global generation:  0.0015201568603515625
r_  generation:  0.01955556869506836
local_output_nid generation:  0.0015349388122558594
local_in_edges_tensor generation:  0.0009329319000244141
mini_batch_src_global generation:  0.0014958381652832031
r_  generation:  0.01967787742614746
local_output_nid generation:  0.0015494823455810547
local_in_edges_tensor generation:  0.0009095668792724609
mini_batch_src_global generation:  0.0015294551849365234
r_  generation:  0.01963520050048828
local_output_nid generation:  0.0015676021575927734
local_in_edges_tensor generation:  0.0009012222290039062
mini_batch_src_global generation:  0.0015497207641601562
r_  generation:  0.01895308494567871
local_output_nid generation:  0.0015366077423095703
local_in_edges_tensor generation:  0.0009007453918457031
mini_batch_src_global generation:  0.0015041828155517578
r_  generation:  0.019672632217407227
----------------------check_connections_block total spend ----------------------------- 0.462740421295166
generate_one_block  0.027436494827270508
generate_one_block  0.028170108795166016
generate_one_block  0.027521371841430664
generate_one_block  0.027552127838134766
generate_one_block  0.027707815170288086
generate_one_block  0.030207395553588867
generate_one_block  0.027708768844604492
generate_one_block  0.027460098266601562
generate_one_block  0.02795553207397461
generate_one_block  0.02672553062438965
generate_one_block  0.0283355712890625
generate_one_block  0.028458356857299805
generate_one_block  0.028143644332885742
generate_one_block  0.027872085571289062
generate_one_block  0.0273284912109375
generate_one_block  0.028013229370117188
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03783607482910156
gen group dst list time:  0.01915454864501953
time for parepare:  0.01964545249938965
local_output_nid generation:  0.006785154342651367
local_in_edges_tensor generation:  0.024306535720825195
mini_batch_src_global generation:  0.020427703857421875
r_  generation:  0.1915874481201172
local_output_nid generation:  0.010313272476196289
local_in_edges_tensor generation:  0.013999223709106445
mini_batch_src_global generation:  0.028104782104492188
r_  generation:  0.19991397857666016
local_output_nid generation:  0.010740518569946289
local_in_edges_tensor generation:  0.010988235473632812
mini_batch_src_global generation:  0.02459096908569336
r_  generation:  0.2053513526916504
local_output_nid generation:  0.011264324188232422
local_in_edges_tensor generation:  0.01178288459777832
mini_batch_src_global generation:  0.024366140365600586
r_  generation:  0.2069234848022461
local_output_nid generation:  0.011204719543457031
local_in_edges_tensor generation:  0.012981653213500977
mini_batch_src_global generation:  0.02538609504699707
r_  generation:  0.21159577369689941
local_output_nid generation:  0.011214733123779297
local_in_edges_tensor generation:  0.012006759643554688
mini_batch_src_global generation:  0.026065587997436523
r_  generation:  0.2120494842529297
local_output_nid generation:  0.011717081069946289
local_in_edges_tensor generation:  0.013896942138671875
mini_batch_src_global generation:  0.025997638702392578
r_  generation:  0.20884084701538086
local_output_nid generation:  0.01164388656616211
local_in_edges_tensor generation:  0.014415502548217773
mini_batch_src_global generation:  0.025857210159301758
r_  generation:  0.20704936981201172
local_output_nid generation:  0.011918306350708008
local_in_edges_tensor generation:  0.01123046875
mini_batch_src_global generation:  0.026454687118530273
r_  generation:  0.21602869033813477
local_output_nid generation:  0.011591196060180664
local_in_edges_tensor generation:  0.011225461959838867
mini_batch_src_global generation:  0.02563786506652832
r_  generation:  0.20441722869873047
local_output_nid generation:  0.01202392578125
local_in_edges_tensor generation:  0.011464357376098633
mini_batch_src_global generation:  0.02774190902709961
r_  generation:  0.2186417579650879
local_output_nid generation:  0.01152658462524414
local_in_edges_tensor generation:  0.011384010314941406
mini_batch_src_global generation:  0.026747465133666992
r_  generation:  0.21080660820007324
local_output_nid generation:  0.012126684188842773
local_in_edges_tensor generation:  0.01161646842956543
mini_batch_src_global generation:  0.02674245834350586
r_  generation:  0.21480393409729004
local_output_nid generation:  0.012003898620605469
local_in_edges_tensor generation:  0.012334346771240234
mini_batch_src_global generation:  0.026982784271240234
r_  generation:  0.21328067779541016
local_output_nid generation:  0.011817216873168945
local_in_edges_tensor generation:  0.011713027954101562
mini_batch_src_global generation:  0.02676081657409668
r_  generation:  0.21186017990112305
local_output_nid generation:  0.01208639144897461
local_in_edges_tensor generation:  0.011328458786010742
mini_batch_src_global generation:  0.027161598205566406
r_  generation:  0.21444129943847656
----------------------check_connections_block total spend ----------------------------- 4.907296180725098
generate_one_block  0.2685580253601074
generate_one_block  0.2706167697906494
generate_one_block  0.2664046287536621
generate_one_block  0.2688462734222412
generate_one_block  0.26795101165771484
generate_one_block  0.2706921100616455
generate_one_block  0.283905029296875
generate_one_block  0.26094603538513184
generate_one_block  0.26906490325927734
generate_one_block  0.2552344799041748
generate_one_block  0.27655816078186035
generate_one_block  0.26686573028564453
generate_one_block  0.26981449127197266
generate_one_block  0.2713947296142578
generate_one_block  0.26534509658813477
generate_one_block  0.27600932121276855
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0318148136138916
gen group dst list time:  0.06196308135986328
time for parepare:  0.01788330078125
local_output_nid generation:  0.025141239166259766
local_in_edges_tensor generation:  0.04246807098388672
mini_batch_src_global generation:  0.041611433029174805
r_  generation:  0.4473707675933838
local_output_nid generation:  0.029798507690429688
local_in_edges_tensor generation:  0.03599286079406738
mini_batch_src_global generation:  0.05364084243774414
r_  generation:  0.44618701934814453
local_output_nid generation:  0.03041529655456543
local_in_edges_tensor generation:  0.03030109405517578
mini_batch_src_global generation:  0.05169320106506348
r_  generation:  0.455491304397583
local_output_nid generation:  0.030327320098876953
local_in_edges_tensor generation:  0.03299522399902344
mini_batch_src_global generation:  0.05191802978515625
r_  generation:  0.4467036724090576
local_output_nid generation:  0.030317306518554688
local_in_edges_tensor generation:  0.07354903221130371
mini_batch_src_global generation:  0.051590919494628906
r_  generation:  0.45262742042541504
local_output_nid generation:  0.0301513671875
local_in_edges_tensor generation:  0.030419111251831055
mini_batch_src_global generation:  0.05283331871032715
r_  generation:  0.4502992630004883
local_output_nid generation:  0.029881715774536133
local_in_edges_tensor generation:  0.028791189193725586
mini_batch_src_global generation:  0.05184054374694824
r_  generation:  0.45231199264526367
local_output_nid generation:  0.030159950256347656
local_in_edges_tensor generation:  0.03082585334777832
mini_batch_src_global generation:  0.052670955657958984
r_  generation:  0.4471585750579834
local_output_nid generation:  0.030379295349121094
local_in_edges_tensor generation:  0.03072500228881836
mini_batch_src_global generation:  0.0522313117980957
r_  generation:  0.4551243782043457
local_output_nid generation:  0.030276060104370117
local_in_edges_tensor generation:  0.028538227081298828
mini_batch_src_global generation:  0.05489039421081543
r_  generation:  0.45594286918640137
local_output_nid generation:  0.03064441680908203
local_in_edges_tensor generation:  0.030970335006713867
mini_batch_src_global generation:  0.051807403564453125
r_  generation:  0.4577140808105469
local_output_nid generation:  0.030591726303100586
local_in_edges_tensor generation:  0.02986884117126465
mini_batch_src_global generation:  0.05317091941833496
r_  generation:  0.4509437084197998
local_output_nid generation:  0.03053736686706543
local_in_edges_tensor generation:  0.0290067195892334
mini_batch_src_global generation:  0.05710911750793457
r_  generation:  0.46108388900756836
local_output_nid generation:  0.031281232833862305
local_in_edges_tensor generation:  0.03165411949157715
mini_batch_src_global generation:  0.052750587463378906
r_  generation:  0.4494972229003906
local_output_nid generation:  0.03052663803100586
local_in_edges_tensor generation:  0.028943777084350586
mini_batch_src_global generation:  0.05196380615234375
r_  generation:  0.45522236824035645
local_output_nid generation:  0.030710697174072266
local_in_edges_tensor generation:  0.031982421875
mini_batch_src_global generation:  0.05269432067871094
r_  generation:  0.4567146301269531
----------------------check_connections_block total spend ----------------------------- 10.686946153640747
generate_one_block  0.5769894123077393
generate_one_block  0.5775222778320312
generate_one_block  0.5652756690979004
generate_one_block  0.5777738094329834
generate_one_block  0.5845205783843994
generate_one_block  0.5762443542480469
generate_one_block  0.5761818885803223
generate_one_block  0.5694687366485596
generate_one_block  0.6404585838317871
generate_one_block  0.5741031169891357
generate_one_block  0.5927817821502686
generate_one_block  0.5780110359191895
generate_one_block  0.5810458660125732
generate_one_block  0.5836801528930664
generate_one_block  0.5794947147369385
generate_one_block  0.5834572315216064
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11525821685791016  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

connection checking time:  15.594242334365845
block generation total time  13.625216007232666
average batch blocks generation time:  0.8515760004520416
block dataloader generation time/epoch 31.301333005611713
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09399747848510742  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7210283279418945  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09324026107788086  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7167830467224121  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09391593933105469  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7176351547241211  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09341621398925781  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7192773818969727  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09393310546875  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7188820838928223  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0933380126953125  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7191367149353027  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09383010864257812  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7165465354919434  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09302997589111328  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7116799354553223  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09395599365234375  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7200284004211426  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09279727935791016  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7065577507019043  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09405136108398438  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7219295501708984  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09313344955444336  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7116928100585938  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09393787384033203  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7193794250488281  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09322214126586914  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7168674468994141  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09384822845458984  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7159781455993652  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0934000015258789  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7195296287536621  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06286449730396271 |0.012087658047676086 |0.0035638362169265747 |9.192526340484619e-05 |0.003725096583366394 |0.0030269622802734375 |
----------------------------------------------------------pseudo_mini_loss sum 1.2919481992721558
Total (block generation + training)time/epoch 32.66918712395888
Training time/epoch 1.379378318786621
Training time without block to device /epoch 1.1859757900238037
Training time without total dataloading part /epoch 0.12112069129943848
load block tensor time/epoch 1.0058319568634033
block to device time/epoch 0.19340252876281738
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 22 |
Number of nodes for computation during this epoch:  5089071
Number of first layer input nodes during this epoch:  2469794
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11549139022827148  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019788503646850586
range selection method range initialization spend 0.012114286422729492
time for parepare:  0.017780542373657227
local_output_nid generation:  0.001428842544555664
local_in_edges_tensor generation:  0.005053997039794922
mini_batch_src_global generation:  0.001641988754272461
r_  generation:  0.019264698028564453
local_output_nid generation:  0.0016021728515625
local_in_edges_tensor generation:  0.0009601116180419922
mini_batch_src_global generation:  0.0018792152404785156
r_  generation:  0.019927263259887695
local_output_nid generation:  0.0015530586242675781
local_in_edges_tensor generation:  0.0009143352508544922
mini_batch_src_global generation:  0.0014927387237548828
r_  generation:  0.019179105758666992
local_output_nid generation:  0.0016236305236816406
local_in_edges_tensor generation:  0.0008699893951416016
mini_batch_src_global generation:  0.0014731884002685547
r_  generation:  0.01914191246032715
local_output_nid generation:  0.0015635490417480469
local_in_edges_tensor generation:  0.0009107589721679688
mini_batch_src_global generation:  0.0014679431915283203
r_  generation:  0.018925189971923828
local_output_nid generation:  0.0015418529510498047
local_in_edges_tensor generation:  0.0009005069732666016
mini_batch_src_global generation:  0.001519918441772461
r_  generation:  0.019100189208984375
local_output_nid generation:  0.0016045570373535156
local_in_edges_tensor generation:  0.0008904933929443359
mini_batch_src_global generation:  0.0015301704406738281
r_  generation:  0.01916360855102539
local_output_nid generation:  0.0016436576843261719
local_in_edges_tensor generation:  0.0009198188781738281
mini_batch_src_global generation:  0.0015230178833007812
r_  generation:  0.019161462783813477
local_output_nid generation:  0.0015416145324707031
local_in_edges_tensor generation:  0.0009620189666748047
mini_batch_src_global generation:  0.0015120506286621094
r_  generation:  0.019089937210083008
local_output_nid generation:  0.0015447139739990234
local_in_edges_tensor generation:  0.0008924007415771484
mini_batch_src_global generation:  0.0015094280242919922
r_  generation:  0.0201261043548584
local_output_nid generation:  0.0015642642974853516
local_in_edges_tensor generation:  0.0009133815765380859
mini_batch_src_global generation:  0.0015239715576171875
r_  generation:  0.019026994705200195
local_output_nid generation:  0.0015964508056640625
local_in_edges_tensor generation:  0.0009419918060302734
mini_batch_src_global generation:  0.001506805419921875
r_  generation:  0.019571542739868164
local_output_nid generation:  0.0015382766723632812
local_in_edges_tensor generation:  0.0008890628814697266
mini_batch_src_global generation:  0.001543283462524414
r_  generation:  0.019276142120361328
local_output_nid generation:  0.0015673637390136719
local_in_edges_tensor generation:  0.0008904933929443359
mini_batch_src_global generation:  0.0014951229095458984
r_  generation:  0.018955469131469727
local_output_nid generation:  0.0016088485717773438
local_in_edges_tensor generation:  0.0008966922760009766
mini_batch_src_global generation:  0.0014772415161132812
r_  generation:  0.0191648006439209
local_output_nid generation:  0.001519918441772461
local_in_edges_tensor generation:  0.0009207725524902344
mini_batch_src_global generation:  0.0015423297882080078
r_  generation:  0.019175052642822266
----------------------check_connections_block total spend ----------------------------- 0.46312999725341797
generate_one_block  0.02739882469177246
generate_one_block  0.028167247772216797
generate_one_block  0.02787494659423828
generate_one_block  0.02787327766418457
generate_one_block  0.028040647506713867
generate_one_block  0.029259204864501953
generate_one_block  0.027597427368164062
generate_one_block  0.02774786949157715
generate_one_block  0.027640104293823242
generate_one_block  0.02801346778869629
generate_one_block  0.027519702911376953
generate_one_block  0.027861833572387695
generate_one_block  0.027703523635864258
generate_one_block  0.027544021606445312
generate_one_block  0.028142452239990234
generate_one_block  0.027761220932006836
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0319976806640625
gen group dst list time:  0.01590704917907715
time for parepare:  0.019593477249145508
local_output_nid generation:  0.0068438053131103516
local_in_edges_tensor generation:  0.018816232681274414
mini_batch_src_global generation:  0.020579099655151367
r_  generation:  0.19140863418579102
local_output_nid generation:  0.010051250457763672
local_in_edges_tensor generation:  0.013992786407470703
mini_batch_src_global generation:  0.024822711944580078
r_  generation:  0.20097899436950684
local_output_nid generation:  0.01045846939086914
local_in_edges_tensor generation:  0.010899066925048828
mini_batch_src_global generation:  0.023884296417236328
r_  generation:  0.20667743682861328
local_output_nid generation:  0.01134181022644043
local_in_edges_tensor generation:  0.012764215469360352
mini_batch_src_global generation:  0.02463245391845703
r_  generation:  0.2089216709136963
local_output_nid generation:  0.011315107345581055
local_in_edges_tensor generation:  0.011090993881225586
mini_batch_src_global generation:  0.025570392608642578
r_  generation:  0.20955824851989746
local_output_nid generation:  0.01111745834350586
local_in_edges_tensor generation:  0.012945890426635742
mini_batch_src_global generation:  0.02597355842590332
r_  generation:  0.20865869522094727
local_output_nid generation:  0.011614084243774414
local_in_edges_tensor generation:  0.01125025749206543
mini_batch_src_global generation:  0.027538061141967773
r_  generation:  0.20927047729492188
local_output_nid generation:  0.011785030364990234
local_in_edges_tensor generation:  0.013028144836425781
mini_batch_src_global generation:  0.026641845703125
r_  generation:  0.21468901634216309
local_output_nid generation:  0.011632919311523438
local_in_edges_tensor generation:  0.01139378547668457
mini_batch_src_global generation:  0.02669215202331543
r_  generation:  0.21072673797607422
local_output_nid generation:  0.011808156967163086
local_in_edges_tensor generation:  0.011404037475585938
mini_batch_src_global generation:  0.026496410369873047
r_  generation:  0.21491646766662598
local_output_nid generation:  0.011782646179199219
local_in_edges_tensor generation:  0.012431621551513672
mini_batch_src_global generation:  0.026361465454101562
r_  generation:  0.2109231948852539
local_output_nid generation:  0.011804819107055664
local_in_edges_tensor generation:  0.011441469192504883
mini_batch_src_global generation:  0.026851415634155273
r_  generation:  0.2175760269165039
local_output_nid generation:  0.011774539947509766
local_in_edges_tensor generation:  0.01125788688659668
mini_batch_src_global generation:  0.02654409408569336
r_  generation:  0.21217918395996094
local_output_nid generation:  0.0118865966796875
local_in_edges_tensor generation:  0.011208295822143555
mini_batch_src_global generation:  0.025851726531982422
r_  generation:  0.20826125144958496
local_output_nid generation:  0.012014389038085938
local_in_edges_tensor generation:  0.013196229934692383
mini_batch_src_global generation:  0.027776241302490234
r_  generation:  0.21813488006591797
local_output_nid generation:  0.012000799179077148
local_in_edges_tensor generation:  0.011569738388061523
mini_batch_src_global generation:  0.030641555786132812
r_  generation:  0.21121859550476074
----------------------check_connections_block total spend ----------------------------- 4.905683517456055
generate_one_block  0.2750976085662842
generate_one_block  0.2657144069671631
generate_one_block  0.2680959701538086
generate_one_block  0.27027273178100586
generate_one_block  0.2668168544769287
generate_one_block  0.2642693519592285
generate_one_block  0.2904806137084961
generate_one_block  0.26659369468688965
generate_one_block  0.2654602527618408
generate_one_block  0.26870155334472656
generate_one_block  0.26175808906555176
generate_one_block  0.2717902660369873
generate_one_block  0.2623443603515625
generate_one_block  0.25844740867614746
generate_one_block  0.2702901363372803
generate_one_block  0.2679922580718994
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02896285057067871
gen group dst list time:  0.06060624122619629
time for parepare:  0.017281770706176758
local_output_nid generation:  0.02350592613220215
local_in_edges_tensor generation:  0.03859996795654297
mini_batch_src_global generation:  0.04027390480041504
r_  generation:  0.44464111328125
local_output_nid generation:  0.0294952392578125
local_in_edges_tensor generation:  0.03472113609313965
mini_batch_src_global generation:  0.052651405334472656
r_  generation:  0.44539666175842285
local_output_nid generation:  0.029109477996826172
local_in_edges_tensor generation:  0.031507015228271484
mini_batch_src_global generation:  0.05152773857116699
r_  generation:  0.4517662525177002
local_output_nid generation:  0.029262542724609375
local_in_edges_tensor generation:  0.029250383377075195
mini_batch_src_global generation:  0.05269050598144531
r_  generation:  0.44903087615966797
local_output_nid generation:  0.029180049896240234
local_in_edges_tensor generation:  0.0699927806854248
mini_batch_src_global generation:  0.0521702766418457
r_  generation:  0.453934907913208
local_output_nid generation:  0.02965998649597168
local_in_edges_tensor generation:  0.028281450271606445
mini_batch_src_global generation:  0.05476713180541992
r_  generation:  0.45334815979003906
local_output_nid generation:  0.029938697814941406
local_in_edges_tensor generation:  0.028659343719482422
mini_batch_src_global generation:  0.0524289608001709
r_  generation:  0.4568455219268799
local_output_nid generation:  0.029939889907836914
local_in_edges_tensor generation:  0.030108928680419922
mini_batch_src_global generation:  0.05404090881347656
r_  generation:  0.4531240463256836
local_output_nid generation:  0.03023838996887207
local_in_edges_tensor generation:  0.03165602684020996
mini_batch_src_global generation:  0.05265498161315918
r_  generation:  0.45771074295043945
local_output_nid generation:  0.029908180236816406
local_in_edges_tensor generation:  0.028188705444335938
mini_batch_src_global generation:  0.0536649227142334
r_  generation:  0.4518551826477051
local_output_nid generation:  0.029946088790893555
local_in_edges_tensor generation:  0.027951717376708984
mini_batch_src_global generation:  0.051984548568725586
r_  generation:  0.4614443778991699
local_output_nid generation:  0.029949426651000977
local_in_edges_tensor generation:  0.03228163719177246
mini_batch_src_global generation:  0.055335044860839844
r_  generation:  0.4552476406097412
local_output_nid generation:  0.030221939086914062
local_in_edges_tensor generation:  0.02881622314453125
mini_batch_src_global generation:  0.05229783058166504
r_  generation:  0.4574918746948242
local_output_nid generation:  0.029802799224853516
local_in_edges_tensor generation:  0.027725934982299805
mini_batch_src_global generation:  0.052562713623046875
r_  generation:  0.4497358798980713
local_output_nid generation:  0.030476093292236328
local_in_edges_tensor generation:  0.032224416732788086
mini_batch_src_global generation:  0.05205416679382324
r_  generation:  0.45887207984924316
local_output_nid generation:  0.03003692626953125
local_in_edges_tensor generation:  0.030576229095458984
mini_batch_src_global generation:  0.05290555953979492
r_  generation:  0.4539761543273926
----------------------check_connections_block total spend ----------------------------- 10.681344747543335
generate_one_block  0.5721795558929443
generate_one_block  0.5748193264007568
generate_one_block  0.5746932029724121
generate_one_block  0.5730347633361816
generate_one_block  0.5701234340667725
generate_one_block  0.5706117153167725
generate_one_block  0.5820388793945312
generate_one_block  0.578594446182251
generate_one_block  0.6040623188018799
generate_one_block  0.5802264213562012
generate_one_block  0.5745029449462891
generate_one_block  0.5907583236694336
generate_one_block  0.5670013427734375
generate_one_block  0.5687828063964844
generate_one_block  0.5767810344696045
generate_one_block  0.5675840377807617
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11549139022827148  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

connection checking time:  15.58702826499939
block generation total time  13.519920110702515
average batch blocks generation time:  0.8449950069189072
block dataloader generation time/epoch 31.286246640341624
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09393644332885742  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.719538688659668  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0935964584350586  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7176461219787598  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0939626693725586  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.72003173828125  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09346675872802734  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7191348075866699  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09389877319335938  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7172679901123047  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09314823150634766  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7157258987426758  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09386539459228516  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7169890403747559  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09350347518920898  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.718653678894043  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09384346008300781  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7161417007446289  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09333229064941406  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7180905342102051  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09379863739013672  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7168707847595215  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09354877471923828  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7206473350524902  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09379768371582031  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.71221923828125  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09318161010742188  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7145233154296875  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0939788818359375  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7191314697265625  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09340906143188477  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7172141075134277  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06250916421413422 |0.010754168033599854 |0.0034950971603393555 |8.951127529144287e-05 |0.003691360354423523 |0.001262664794921875 |
----------------------------------------------------------pseudo_mini_loss sum 1.2784689664840698
Total (block generation + training)time/epoch 32.65288279737745
Training time/epoch 1.3505804538726807
Training time without block to device /epoch 1.178513765335083
Training time without total dataloading part /epoch 0.11767816543579102
load block tensor time/epoch 1.0001466274261475
block to device time/epoch 0.17206668853759766
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 23 |
Number of nodes for computation during this epoch:  5091315
Number of first layer input nodes during this epoch:  2471734
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11517906188964844  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01948404312133789
range selection method range initialization spend 0.012188434600830078
time for parepare:  0.016661882400512695
local_output_nid generation:  0.0014345645904541016
local_in_edges_tensor generation:  0.003279447555541992
mini_batch_src_global generation:  0.0015637874603271484
r_  generation:  0.018305063247680664
local_output_nid generation:  0.0014986991882324219
local_in_edges_tensor generation:  0.0009438991546630859
mini_batch_src_global generation:  0.0018429756164550781
r_  generation:  0.020056962966918945
local_output_nid generation:  0.0015325546264648438
local_in_edges_tensor generation:  0.0009081363677978516
mini_batch_src_global generation:  0.0014591217041015625
r_  generation:  0.018524169921875
local_output_nid generation:  0.0016307830810546875
local_in_edges_tensor generation:  0.0008919239044189453
mini_batch_src_global generation:  0.0014712810516357422
r_  generation:  0.01935434341430664
local_output_nid generation:  0.001520395278930664
local_in_edges_tensor generation:  0.0008974075317382812
mini_batch_src_global generation:  0.0014967918395996094
r_  generation:  0.018923521041870117
local_output_nid generation:  0.0015151500701904297
local_in_edges_tensor generation:  0.0009136199951171875
mini_batch_src_global generation:  0.001529693603515625
r_  generation:  0.019370079040527344
local_output_nid generation:  0.001524209976196289
local_in_edges_tensor generation:  0.0009067058563232422
mini_batch_src_global generation:  0.0015206336975097656
r_  generation:  0.01919078826904297
local_output_nid generation:  0.0015518665313720703
local_in_edges_tensor generation:  0.0008921623229980469
mini_batch_src_global generation:  0.0014700889587402344
r_  generation:  0.019528865814208984
local_output_nid generation:  0.0015113353729248047
local_in_edges_tensor generation:  0.0009114742279052734
mini_batch_src_global generation:  0.0015041828155517578
r_  generation:  0.019121408462524414
local_output_nid generation:  0.001537322998046875
local_in_edges_tensor generation:  0.0009002685546875
mini_batch_src_global generation:  0.001552581787109375
r_  generation:  0.019433021545410156
local_output_nid generation:  0.0015611648559570312
local_in_edges_tensor generation:  0.0008904933929443359
mini_batch_src_global generation:  0.0015249252319335938
r_  generation:  0.019073009490966797
local_output_nid generation:  0.0015308856964111328
local_in_edges_tensor generation:  0.0008978843688964844
mini_batch_src_global generation:  0.0015714168548583984
r_  generation:  0.020245790481567383
local_output_nid generation:  0.0015637874603271484
local_in_edges_tensor generation:  0.0008974075317382812
mini_batch_src_global generation:  0.001529693603515625
r_  generation:  0.019804000854492188
local_output_nid generation:  0.0015528202056884766
local_in_edges_tensor generation:  0.0008814334869384766
mini_batch_src_global generation:  0.0015232563018798828
r_  generation:  0.019252777099609375
local_output_nid generation:  0.0015540122985839844
local_in_edges_tensor generation:  0.0009076595306396484
mini_batch_src_global generation:  0.0015206336975097656
r_  generation:  0.019243717193603516
local_output_nid generation:  0.0015630722045898438
local_in_edges_tensor generation:  0.0008752346038818359
mini_batch_src_global generation:  0.0015263557434082031
r_  generation:  0.01938176155090332
----------------------check_connections_block total spend ----------------------------- 0.46010684967041016
generate_one_block  0.027093887329101562
generate_one_block  0.028123140335083008
generate_one_block  0.02727222442626953
generate_one_block  0.027971744537353516
generate_one_block  0.027663707733154297
generate_one_block  0.029615402221679688
generate_one_block  0.02761387825012207
generate_one_block  0.02775287628173828
generate_one_block  0.027117490768432617
generate_one_block  0.027538299560546875
generate_one_block  0.02749490737915039
generate_one_block  0.028390884399414062
generate_one_block  0.02811884880065918
generate_one_block  0.027534961700439453
generate_one_block  0.027606964111328125
generate_one_block  0.027881145477294922
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02660369873046875
gen group dst list time:  0.015946149826049805
time for parepare:  0.019808292388916016
local_output_nid generation:  0.006684064865112305
local_in_edges_tensor generation:  0.020013093948364258
mini_batch_src_global generation:  0.020319700241088867
r_  generation:  0.19084477424621582
local_output_nid generation:  0.010116815567016602
local_in_edges_tensor generation:  0.013164997100830078
mini_batch_src_global generation:  0.030367374420166016
r_  generation:  0.20057415962219238
local_output_nid generation:  0.010337352752685547
local_in_edges_tensor generation:  0.012851953506469727
mini_batch_src_global generation:  0.02537846565246582
r_  generation:  0.20210957527160645
local_output_nid generation:  0.01138448715209961
local_in_edges_tensor generation:  0.013720512390136719
mini_batch_src_global generation:  0.029016971588134766
r_  generation:  0.21511197090148926
local_output_nid generation:  0.011536598205566406
local_in_edges_tensor generation:  0.011409282684326172
mini_batch_src_global generation:  0.025359630584716797
r_  generation:  0.2111368179321289
local_output_nid generation:  0.011663198471069336
local_in_edges_tensor generation:  0.011183977127075195
mini_batch_src_global generation:  0.03303837776184082
r_  generation:  0.21355342864990234
local_output_nid generation:  0.012176990509033203
local_in_edges_tensor generation:  0.014663457870483398
mini_batch_src_global generation:  0.03490734100341797
r_  generation:  0.213576078414917
local_output_nid generation:  0.013314962387084961
local_in_edges_tensor generation:  0.011358022689819336
mini_batch_src_global generation:  0.02974390983581543
r_  generation:  0.2151508331298828
local_output_nid generation:  0.012163400650024414
local_in_edges_tensor generation:  0.011785268783569336
mini_batch_src_global generation:  0.02593255043029785
r_  generation:  0.21204066276550293
local_output_nid generation:  0.012296199798583984
local_in_edges_tensor generation:  0.01228952407836914
mini_batch_src_global generation:  0.02738809585571289
r_  generation:  0.2145063877105713
local_output_nid generation:  0.012132883071899414
local_in_edges_tensor generation:  0.012254476547241211
mini_batch_src_global generation:  0.02710247039794922
r_  generation:  0.21103501319885254
local_output_nid generation:  0.012183189392089844
local_in_edges_tensor generation:  0.011706352233886719
mini_batch_src_global generation:  0.02777409553527832
r_  generation:  0.21615052223205566
local_output_nid generation:  0.012531042098999023
local_in_edges_tensor generation:  0.014209747314453125
mini_batch_src_global generation:  0.026867389678955078
r_  generation:  0.21950054168701172
local_output_nid generation:  0.012229681015014648
local_in_edges_tensor generation:  0.011336803436279297
mini_batch_src_global generation:  0.028377056121826172
r_  generation:  0.2095344066619873
local_output_nid generation:  0.012310266494750977
local_in_edges_tensor generation:  0.01622772216796875
mini_batch_src_global generation:  0.02684950828552246
r_  generation:  0.21303129196166992
local_output_nid generation:  0.012194633483886719
local_in_edges_tensor generation:  0.011522769927978516
mini_batch_src_global generation:  0.026346445083618164
r_  generation:  0.210618257522583
----------------------check_connections_block total spend ----------------------------- 4.9651267528533936
generate_one_block  0.2726776599884033
generate_one_block  0.2670907974243164
generate_one_block  0.26410913467407227
generate_one_block  0.27458643913269043
generate_one_block  0.26590561866760254
generate_one_block  0.2697336673736572
generate_one_block  0.2849440574645996
generate_one_block  0.27126049995422363
generate_one_block  0.2613852024078369
generate_one_block  0.26723480224609375
generate_one_block  0.26208972930908203
generate_one_block  0.2716062068939209
generate_one_block  0.27556490898132324
generate_one_block  0.2655456066131592
generate_one_block  0.26714420318603516
generate_one_block  0.2632777690887451
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030086278915405273
gen group dst list time:  0.06050276756286621
time for parepare:  0.018254995346069336
local_output_nid generation:  0.024292707443237305
local_in_edges_tensor generation:  0.046100616455078125
mini_batch_src_global generation:  0.04163002967834473
r_  generation:  0.4398610591888428
local_output_nid generation:  0.02992701530456543
local_in_edges_tensor generation:  0.03587627410888672
mini_batch_src_global generation:  0.05095553398132324
r_  generation:  0.4429917335510254
local_output_nid generation:  0.031061410903930664
local_in_edges_tensor generation:  0.029998064041137695
mini_batch_src_global generation:  0.05077695846557617
r_  generation:  0.45232462882995605
local_output_nid generation:  0.029907703399658203
local_in_edges_tensor generation:  0.03254365921020508
mini_batch_src_global generation:  0.05411052703857422
r_  generation:  0.4512951374053955
local_output_nid generation:  0.030429601669311523
local_in_edges_tensor generation:  0.06999874114990234
mini_batch_src_global generation:  0.050568342208862305
r_  generation:  0.4550657272338867
local_output_nid generation:  0.03079080581665039
local_in_edges_tensor generation:  0.03114461898803711
mini_batch_src_global generation:  0.05222797393798828
r_  generation:  0.4497873783111572
local_output_nid generation:  0.029985427856445312
local_in_edges_tensor generation:  0.029314041137695312
mini_batch_src_global generation:  0.05163860321044922
r_  generation:  0.4547252655029297
local_output_nid generation:  0.030617237091064453
local_in_edges_tensor generation:  0.0281827449798584
mini_batch_src_global generation:  0.05425763130187988
r_  generation:  0.4468417167663574
local_output_nid generation:  0.03028559684753418
local_in_edges_tensor generation:  0.029034852981567383
mini_batch_src_global generation:  0.051438331604003906
r_  generation:  0.45594000816345215
local_output_nid generation:  0.030496597290039062
local_in_edges_tensor generation:  0.030157089233398438
mini_batch_src_global generation:  0.054146528244018555
r_  generation:  0.4496269226074219
local_output_nid generation:  0.03022599220275879
local_in_edges_tensor generation:  0.030728816986083984
mini_batch_src_global generation:  0.05162930488586426
r_  generation:  0.45340585708618164
local_output_nid generation:  0.030382633209228516
local_in_edges_tensor generation:  0.028351306915283203
mini_batch_src_global generation:  0.05410575866699219
r_  generation:  0.4511680603027344
local_output_nid generation:  0.03051924705505371
local_in_edges_tensor generation:  0.03085494041442871
mini_batch_src_global generation:  0.05175423622131348
r_  generation:  0.4577047824859619
local_output_nid generation:  0.030590534210205078
local_in_edges_tensor generation:  0.0290529727935791
mini_batch_src_global generation:  0.052204132080078125
r_  generation:  0.44954395294189453
local_output_nid generation:  0.03044581413269043
local_in_edges_tensor generation:  0.028774499893188477
mini_batch_src_global generation:  0.05137324333190918
r_  generation:  0.45492100715637207
local_output_nid generation:  0.03125643730163574
local_in_edges_tensor generation:  0.03232860565185547
mini_batch_src_global generation:  0.05427718162536621
r_  generation:  0.4504683017730713
----------------------check_connections_block total spend ----------------------------- 10.648549556732178
generate_one_block  0.566361665725708
generate_one_block  0.5693531036376953
generate_one_block  0.5755326747894287
generate_one_block  0.5777616500854492
generate_one_block  0.5738458633422852
generate_one_block  0.5764391422271729
generate_one_block  0.57330322265625
generate_one_block  0.5745096206665039
generate_one_block  0.632504940032959
generate_one_block  0.5801935195922852
generate_one_block  0.5759029388427734
generate_one_block  0.5782082080841064
generate_one_block  0.580294132232666
generate_one_block  0.5732107162475586
generate_one_block  0.571375846862793
generate_one_block  0.5788123607635498
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11517906188964844  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

connection checking time:  15.613676309585571
block generation total time  13.561765909194946
average batch blocks generation time:  0.8476103693246841
block dataloader generation time/epoch 31.27227538426717
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09384584426879883  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.712888240814209  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09318017959594727  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7130274772644043  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09382820129394531  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.716270923614502  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0935063362121582  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7237420082092285  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09388065338134766  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7177548408508301  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09338521957397461  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7189631462097168  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0937814712524414  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7167367935180664  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09346532821655273  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7181191444396973  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09379959106445312  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7148551940917969  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09340429306030273  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7181568145751953  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09377861022949219  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7153935432434082  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09360122680664062  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7241311073303223  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09409618377685547  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7242674827575684  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09321737289428711  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7163081169128418  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09390830993652344  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7189664840698242  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0933218002319336  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7162060737609863  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06316334009170532 |0.012323826551437378 |0.0035329610109329224 |9.141862392425537e-05 |0.003734782338142395 |0.0016016960144042969 |
----------------------------------------------------------pseudo_mini_loss sum 1.267496109008789
Total (block generation + training)time/epoch 32.64022889137268
Training time/epoch 1.3861212730407715
Training time without block to device /epoch 1.1889400482177734
Training time without total dataloading part /epoch 0.11934828758239746
load block tensor time/epoch 1.0106134414672852
block to device time/epoch 0.19718122482299805
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 24 |
Number of nodes for computation during this epoch:  5092789
Number of first layer input nodes during this epoch:  2472031
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11504888534545898  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02009415626525879
range selection method range initialization spend 0.012320280075073242
time for parepare:  0.017780303955078125
local_output_nid generation:  0.001455068588256836
local_in_edges_tensor generation:  0.0030927658081054688
mini_batch_src_global generation:  0.001371622085571289
r_  generation:  0.018428564071655273
local_output_nid generation:  0.0016605854034423828
local_in_edges_tensor generation:  0.0010421276092529297
mini_batch_src_global generation:  0.0017673969268798828
r_  generation:  0.019739151000976562
local_output_nid generation:  0.0015594959259033203
local_in_edges_tensor generation:  0.0009014606475830078
mini_batch_src_global generation:  0.001451253890991211
r_  generation:  0.019635677337646484
local_output_nid generation:  0.001623392105102539
local_in_edges_tensor generation:  0.0009043216705322266
mini_batch_src_global generation:  0.001519918441772461
r_  generation:  0.018690109252929688
local_output_nid generation:  0.0015759468078613281
local_in_edges_tensor generation:  0.0008990764617919922
mini_batch_src_global generation:  0.0014767646789550781
r_  generation:  0.01929450035095215
local_output_nid generation:  0.0015587806701660156
local_in_edges_tensor generation:  0.0009088516235351562
mini_batch_src_global generation:  0.001432180404663086
r_  generation:  0.0189516544342041
local_output_nid generation:  0.0015454292297363281
local_in_edges_tensor generation:  0.000896453857421875
mini_batch_src_global generation:  0.0015139579772949219
r_  generation:  0.019269227981567383
local_output_nid generation:  0.0015070438385009766
local_in_edges_tensor generation:  0.0008573532104492188
mini_batch_src_global generation:  0.0015025138854980469
r_  generation:  0.01927471160888672
local_output_nid generation:  0.0015497207641601562
local_in_edges_tensor generation:  0.0009684562683105469
mini_batch_src_global generation:  0.0014357566833496094
r_  generation:  0.019675493240356445
local_output_nid generation:  0.0015633106231689453
local_in_edges_tensor generation:  0.0008742809295654297
mini_batch_src_global generation:  0.0014913082122802734
r_  generation:  0.019353151321411133
local_output_nid generation:  0.0015444755554199219
local_in_edges_tensor generation:  0.00087738037109375
mini_batch_src_global generation:  0.0015337467193603516
r_  generation:  0.019984722137451172
local_output_nid generation:  0.0015683174133300781
local_in_edges_tensor generation:  0.0008883476257324219
mini_batch_src_global generation:  0.0015680789947509766
r_  generation:  0.019328594207763672
local_output_nid generation:  0.0015587806701660156
local_in_edges_tensor generation:  0.0009348392486572266
mini_batch_src_global generation:  0.0015053749084472656
r_  generation:  0.019377708435058594
local_output_nid generation:  0.001623392105102539
local_in_edges_tensor generation:  0.0008959770202636719
mini_batch_src_global generation:  0.0015206336975097656
r_  generation:  0.019161701202392578
local_output_nid generation:  0.0015604496002197266
local_in_edges_tensor generation:  0.0008862018585205078
mini_batch_src_global generation:  0.0015039443969726562
r_  generation:  0.020051002502441406
local_output_nid generation:  0.001641988754272461
local_in_edges_tensor generation:  0.0009479522705078125
mini_batch_src_global generation:  0.0014903545379638672
r_  generation:  0.019298315048217773
----------------------check_connections_block total spend ----------------------------- 0.4616420269012451
generate_one_block  0.02707648277282715
generate_one_block  0.028371334075927734
generate_one_block  0.028064966201782227
generate_one_block  0.02764296531677246
generate_one_block  0.027710676193237305
generate_one_block  0.02987384796142578
generate_one_block  0.027492284774780273
generate_one_block  0.027696609497070312
generate_one_block  0.027538776397705078
generate_one_block  0.02764582633972168
generate_one_block  0.028280258178710938
generate_one_block  0.027924776077270508
generate_one_block  0.027480602264404297
generate_one_block  0.027431726455688477
generate_one_block  0.027782201766967773
generate_one_block  0.02787947654724121
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.08906126022338867
gen group dst list time:  0.015259504318237305
time for parepare:  0.019893169403076172
local_output_nid generation:  0.006849050521850586
local_in_edges_tensor generation:  0.022304296493530273
mini_batch_src_global generation:  0.02053070068359375
r_  generation:  0.192368745803833
local_output_nid generation:  0.01031351089477539
local_in_edges_tensor generation:  0.014168977737426758
mini_batch_src_global generation:  0.030267000198364258
r_  generation:  0.2047712802886963
local_output_nid generation:  0.010550260543823242
local_in_edges_tensor generation:  0.012657403945922852
mini_batch_src_global generation:  0.025384902954101562
r_  generation:  0.2111063003540039
local_output_nid generation:  0.012210607528686523
local_in_edges_tensor generation:  0.012907266616821289
mini_batch_src_global generation:  0.024927139282226562
r_  generation:  0.2068614959716797
local_output_nid generation:  0.011711597442626953
local_in_edges_tensor generation:  0.013062000274658203
mini_batch_src_global generation:  0.025481462478637695
r_  generation:  0.20596575736999512
local_output_nid generation:  0.011818408966064453
local_in_edges_tensor generation:  0.010947465896606445
mini_batch_src_global generation:  0.02523946762084961
r_  generation:  0.20710229873657227
local_output_nid generation:  0.012002944946289062
local_in_edges_tensor generation:  0.01110529899597168
mini_batch_src_global generation:  0.025488615036010742
r_  generation:  0.20689105987548828
local_output_nid generation:  0.012124061584472656
local_in_edges_tensor generation:  0.010997295379638672
mini_batch_src_global generation:  0.026071548461914062
r_  generation:  0.21215248107910156
local_output_nid generation:  0.012324094772338867
local_in_edges_tensor generation:  0.011030435562133789
mini_batch_src_global generation:  0.02645707130432129
r_  generation:  0.21280503273010254
local_output_nid generation:  0.012207746505737305
local_in_edges_tensor generation:  0.011157512664794922
mini_batch_src_global generation:  0.02610611915588379
r_  generation:  0.2123403549194336
local_output_nid generation:  0.012044906616210938
local_in_edges_tensor generation:  0.011624336242675781
mini_batch_src_global generation:  0.02669668197631836
r_  generation:  0.212019681930542
local_output_nid generation:  0.012092828750610352
local_in_edges_tensor generation:  0.01171731948852539
mini_batch_src_global generation:  0.029373884201049805
r_  generation:  0.2118380069732666
local_output_nid generation:  0.011998414993286133
local_in_edges_tensor generation:  0.011398553848266602
mini_batch_src_global generation:  0.029274702072143555
r_  generation:  0.20868992805480957
local_output_nid generation:  0.01219940185546875
local_in_edges_tensor generation:  0.011370658874511719
mini_batch_src_global generation:  0.02621293067932129
r_  generation:  0.21068167686462402
local_output_nid generation:  0.01246333122253418
local_in_edges_tensor generation:  0.01222372055053711
mini_batch_src_global generation:  0.028123140335083008
r_  generation:  0.2157590389251709
local_output_nid generation:  0.012163400650024414
local_in_edges_tensor generation:  0.012305021286010742
mini_batch_src_global generation:  0.02663564682006836
r_  generation:  0.2103419303894043
----------------------check_connections_block total spend ----------------------------- 4.912240505218506
generate_one_block  0.2736940383911133
generate_one_block  0.2693932056427002
generate_one_block  0.27150440216064453
generate_one_block  0.2672436237335205
generate_one_block  0.2623560428619385
generate_one_block  0.26166248321533203
generate_one_block  0.28261899948120117
generate_one_block  0.26699066162109375
generate_one_block  0.2715742588043213
generate_one_block  0.2684288024902344
generate_one_block  0.26868247985839844
generate_one_block  0.2687814235687256
generate_one_block  0.26560306549072266
generate_one_block  0.2642965316772461
generate_one_block  0.27364349365234375
generate_one_block  0.2658271789550781
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0313715934753418
gen group dst list time:  0.062067508697509766
time for parepare:  0.01779460906982422
local_output_nid generation:  0.024125099182128906
local_in_edges_tensor generation:  0.04453396797180176
mini_batch_src_global generation:  0.03963112831115723
r_  generation:  0.4394371509552002
local_output_nid generation:  0.03052234649658203
local_in_edges_tensor generation:  0.03560471534729004
mini_batch_src_global generation:  0.05521416664123535
r_  generation:  0.4477243423461914
local_output_nid generation:  0.030556201934814453
local_in_edges_tensor generation:  0.03391122817993164
mini_batch_src_global generation:  0.05050325393676758
r_  generation:  0.45285987854003906
local_output_nid generation:  0.030240297317504883
local_in_edges_tensor generation:  0.030147314071655273
mini_batch_src_global generation:  0.05201888084411621
r_  generation:  0.4446828365325928
local_output_nid generation:  0.030048370361328125
local_in_edges_tensor generation:  0.0702211856842041
mini_batch_src_global generation:  0.05084395408630371
r_  generation:  0.45102667808532715
local_output_nid generation:  0.03026556968688965
local_in_edges_tensor generation:  0.03449511528015137
mini_batch_src_global generation:  0.052315473556518555
r_  generation:  0.44559431076049805
local_output_nid generation:  0.030101776123046875
local_in_edges_tensor generation:  0.030828237533569336
mini_batch_src_global generation:  0.052570343017578125
r_  generation:  0.4493565559387207
local_output_nid generation:  0.02999567985534668
local_in_edges_tensor generation:  0.03028559684753418
mini_batch_src_global generation:  0.05472564697265625
r_  generation:  0.44582700729370117
local_output_nid generation:  0.030097484588623047
local_in_edges_tensor generation:  0.03423953056335449
mini_batch_src_global generation:  0.05164813995361328
r_  generation:  0.4538991451263428
local_output_nid generation:  0.03042292594909668
local_in_edges_tensor generation:  0.03231048583984375
mini_batch_src_global generation:  0.0529019832611084
r_  generation:  0.45000624656677246
local_output_nid generation:  0.03069448471069336
local_in_edges_tensor generation:  0.028896808624267578
mini_batch_src_global generation:  0.05167198181152344
r_  generation:  0.45210933685302734
local_output_nid generation:  0.030521631240844727
local_in_edges_tensor generation:  0.029788732528686523
mini_batch_src_global generation:  0.052228450775146484
r_  generation:  0.4475138187408447
local_output_nid generation:  0.030517578125
local_in_edges_tensor generation:  0.033213138580322266
mini_batch_src_global generation:  0.052008867263793945
r_  generation:  0.4510781764984131
local_output_nid generation:  0.030504465103149414
local_in_edges_tensor generation:  0.028943777084350586
mini_batch_src_global generation:  0.052614688873291016
r_  generation:  0.45195603370666504
local_output_nid generation:  0.030509233474731445
local_in_edges_tensor generation:  0.03033733367919922
mini_batch_src_global generation:  0.05203056335449219
r_  generation:  0.4588801860809326
local_output_nid generation:  0.0305330753326416
local_in_edges_tensor generation:  0.028337955474853516
mini_batch_src_global generation:  0.053209543228149414
r_  generation:  0.4516448974609375
----------------------check_connections_block total spend ----------------------------- 10.639416217803955
generate_one_block  0.5705204010009766
generate_one_block  0.5679636001586914
generate_one_block  0.5784006118774414
generate_one_block  0.571096658706665
generate_one_block  0.565770149230957
generate_one_block  0.5731139183044434
generate_one_block  0.5676462650299072
generate_one_block  0.5722014904022217
generate_one_block  0.6031954288482666
generate_one_block  0.5762577056884766
generate_one_block  0.5683701038360596
generate_one_block  0.5781073570251465
generate_one_block  0.5774109363555908
generate_one_block  0.5844254493713379
generate_one_block  0.5829215049743652
generate_one_block  0.5820221900939941
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11504888534545898  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

connection checking time:  15.551656723022461
block generation total time  13.521724462509155
average batch blocks generation time:  0.8451077789068222
block dataloader generation time/epoch 31.26081082224846
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0938725471496582  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7167568206787109  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09348297119140625  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7191839218139648  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09399986267089844  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7204070091247559  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09324121475219727  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7156209945678711  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09376716613769531  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7120614051818848  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09330129623413086  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7166790962219238  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0937643051147461  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7160367965698242  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09331989288330078  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7167158126831055  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09394550323486328  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7196598052978516  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09330511093139648  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7179398536682129  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09391498565673828  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7190027236938477  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09334993362426758  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7166204452514648  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09374046325683594  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7104439735412598  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09314250946044922  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7157688140869141  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09399032592773438  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7196221351623535  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09321212768554688  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7159156799316406  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06466701626777649 |0.012841477990150452 |0.0036145001649856567 |9.299814701080322e-05 |0.0037582963705062866 |0.0028619766235351562 |
----------------------------------------------------------pseudo_mini_loss sum 1.254658579826355
Total (block generation + training)time/epoch 32.6320726275444
Training time/epoch 1.4205749034881592
Training time without block to device /epoch 1.215111255645752
Training time without total dataloading part /epoch 0.1223146915435791
load block tensor time/epoch 1.0346722602844238
block to device time/epoch 0.20546364784240723
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 25 |
Number of nodes for computation during this epoch:  5086245
Number of first layer input nodes during this epoch:  2471055
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11493635177612305  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022127866744995117
range selection method range initialization spend 0.012213706970214844
time for parepare:  0.017704248428344727
local_output_nid generation:  0.0015020370483398438
local_in_edges_tensor generation:  0.0062406063079833984
mini_batch_src_global generation:  0.001837015151977539
r_  generation:  0.01828622817993164
local_output_nid generation:  0.0015475749969482422
local_in_edges_tensor generation:  0.0009770393371582031
mini_batch_src_global generation:  0.0021164417266845703
r_  generation:  0.019687414169311523
local_output_nid generation:  0.0015764236450195312
local_in_edges_tensor generation:  0.0009322166442871094
mini_batch_src_global generation:  0.0014562606811523438
r_  generation:  0.01896190643310547
local_output_nid generation:  0.0015535354614257812
local_in_edges_tensor generation:  0.0009105205535888672
mini_batch_src_global generation:  0.0014760494232177734
r_  generation:  0.018982410430908203
local_output_nid generation:  0.0015871524810791016
local_in_edges_tensor generation:  0.0009012222290039062
mini_batch_src_global generation:  0.0014238357543945312
r_  generation:  0.019069194793701172
local_output_nid generation:  0.0015878677368164062
local_in_edges_tensor generation:  0.0008962154388427734
mini_batch_src_global generation:  0.001489400863647461
r_  generation:  0.018909692764282227
local_output_nid generation:  0.0015196800231933594
local_in_edges_tensor generation:  0.0009198188781738281
mini_batch_src_global generation:  0.00151824951171875
r_  generation:  0.01947951316833496
local_output_nid generation:  0.0015244483947753906
local_in_edges_tensor generation:  0.0008962154388427734
mini_batch_src_global generation:  0.0014753341674804688
r_  generation:  0.019156932830810547
local_output_nid generation:  0.0015044212341308594
local_in_edges_tensor generation:  0.0009109973907470703
mini_batch_src_global generation:  0.0014560222625732422
r_  generation:  0.018743276596069336
local_output_nid generation:  0.0015227794647216797
local_in_edges_tensor generation:  0.0008676052093505859
mini_batch_src_global generation:  0.0015327930450439453
r_  generation:  0.01969003677368164
local_output_nid generation:  0.0015456676483154297
local_in_edges_tensor generation:  0.0008683204650878906
mini_batch_src_global generation:  0.0014946460723876953
r_  generation:  0.019275188446044922
local_output_nid generation:  0.0015251636505126953
local_in_edges_tensor generation:  0.0008883476257324219
mini_batch_src_global generation:  0.0015411376953125
r_  generation:  0.01957249641418457
local_output_nid generation:  0.0015230178833007812
local_in_edges_tensor generation:  0.0008864402770996094
mini_batch_src_global generation:  0.0015528202056884766
r_  generation:  0.0193789005279541
local_output_nid generation:  0.0015075206756591797
local_in_edges_tensor generation:  0.0008935928344726562
mini_batch_src_global generation:  0.0014843940734863281
r_  generation:  0.01935100555419922
local_output_nid generation:  0.0015361309051513672
local_in_edges_tensor generation:  0.0008671283721923828
mini_batch_src_global generation:  0.0015034675598144531
r_  generation:  0.019672870635986328
local_output_nid generation:  0.0015265941619873047
local_in_edges_tensor generation:  0.0008981227874755859
mini_batch_src_global generation:  0.0015244483947753906
r_  generation:  0.018795013427734375
----------------------check_connections_block total spend ----------------------------- 0.463346004486084
generate_one_block  0.02729630470275879
generate_one_block  0.027945280075073242
generate_one_block  0.027703285217285156
generate_one_block  0.02817058563232422
generate_one_block  0.027759552001953125
generate_one_block  0.029454946517944336
generate_one_block  0.028049468994140625
generate_one_block  0.027273178100585938
generate_one_block  0.02716541290283203
generate_one_block  0.028418779373168945
generate_one_block  0.027812719345092773
generate_one_block  0.027957677841186523
generate_one_block  0.027800798416137695
generate_one_block  0.027625560760498047
generate_one_block  0.02805185317993164
generate_one_block  0.028037548065185547
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.033859968185424805
gen group dst list time:  0.016703128814697266
time for parepare:  0.020177125930786133
local_output_nid generation:  0.006893634796142578
local_in_edges_tensor generation:  0.020244359970092773
mini_batch_src_global generation:  0.020940303802490234
r_  generation:  0.19324922561645508
local_output_nid generation:  0.010167360305786133
local_in_edges_tensor generation:  0.014187097549438477
mini_batch_src_global generation:  0.025366783142089844
r_  generation:  0.19930124282836914
local_output_nid generation:  0.010476350784301758
local_in_edges_tensor generation:  0.011971235275268555
mini_batch_src_global generation:  0.023960113525390625
r_  generation:  0.20399045944213867
local_output_nid generation:  0.011448144912719727
local_in_edges_tensor generation:  0.01323556900024414
mini_batch_src_global generation:  0.024725914001464844
r_  generation:  0.208543062210083
local_output_nid generation:  0.011649131774902344
local_in_edges_tensor generation:  0.012109041213989258
mini_batch_src_global generation:  0.02637505531311035
r_  generation:  0.20817971229553223
local_output_nid generation:  0.011400938034057617
local_in_edges_tensor generation:  0.011463165283203125
mini_batch_src_global generation:  0.026171445846557617
r_  generation:  0.21048283576965332
local_output_nid generation:  0.01178741455078125
local_in_edges_tensor generation:  0.011294364929199219
mini_batch_src_global generation:  0.026561498641967773
r_  generation:  0.2102508544921875
local_output_nid generation:  0.011589527130126953
local_in_edges_tensor generation:  0.011105775833129883
mini_batch_src_global generation:  0.025769948959350586
r_  generation:  0.21106600761413574
local_output_nid generation:  0.011868476867675781
local_in_edges_tensor generation:  0.011428594589233398
mini_batch_src_global generation:  0.026432275772094727
r_  generation:  0.2096269130706787
local_output_nid generation:  0.01218271255493164
local_in_edges_tensor generation:  0.011739730834960938
mini_batch_src_global generation:  0.02671051025390625
r_  generation:  0.21742844581604004
local_output_nid generation:  0.011673688888549805
local_in_edges_tensor generation:  0.012315988540649414
mini_batch_src_global generation:  0.02704000473022461
r_  generation:  0.21421337127685547
local_output_nid generation:  0.012139081954956055
local_in_edges_tensor generation:  0.012476205825805664
mini_batch_src_global generation:  0.0276796817779541
r_  generation:  0.2166748046875
local_output_nid generation:  0.012137889862060547
local_in_edges_tensor generation:  0.01156473159790039
mini_batch_src_global generation:  0.02698540687561035
r_  generation:  0.21539664268493652
local_output_nid generation:  0.012085199356079102
local_in_edges_tensor generation:  0.011443614959716797
mini_batch_src_global generation:  0.02671527862548828
r_  generation:  0.2152843475341797
local_output_nid generation:  0.01222848892211914
local_in_edges_tensor generation:  0.01160883903503418
mini_batch_src_global generation:  0.02762460708618164
r_  generation:  0.21599459648132324
local_output_nid generation:  0.011826515197753906
local_in_edges_tensor generation:  0.01137542724609375
mini_batch_src_global generation:  0.02674412727355957
r_  generation:  0.2104511260986328
----------------------check_connections_block total spend ----------------------------- 4.915961265563965
generate_one_block  0.27559876441955566
generate_one_block  0.2632603645324707
generate_one_block  0.2663540840148926
generate_one_block  0.27018070220947266
generate_one_block  0.268740177154541
generate_one_block  0.2634122371673584
generate_one_block  0.28897976875305176
generate_one_block  0.2676396369934082
generate_one_block  0.2615022659301758
generate_one_block  0.2752389907836914
generate_one_block  0.2704031467437744
generate_one_block  0.2720451354980469
generate_one_block  0.2671220302581787
generate_one_block  0.26787281036376953
generate_one_block  0.27149248123168945
generate_one_block  0.25942373275756836
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028850555419921875
gen group dst list time:  0.06129646301269531
time for parepare:  0.017987489700317383
local_output_nid generation:  0.024931907653808594
local_in_edges_tensor generation:  0.04307818412780762
mini_batch_src_global generation:  0.041817426681518555
r_  generation:  0.4429903030395508
local_output_nid generation:  0.031630516052246094
local_in_edges_tensor generation:  0.029799699783325195
mini_batch_src_global generation:  0.05421805381774902
r_  generation:  0.446460485458374
local_output_nid generation:  0.030099153518676758
local_in_edges_tensor generation:  0.03509640693664551
mini_batch_src_global generation:  0.05260419845581055
r_  generation:  0.45356011390686035
local_output_nid generation:  0.03003978729248047
local_in_edges_tensor generation:  0.02866959571838379
mini_batch_src_global generation:  0.05200672149658203
r_  generation:  0.4497108459472656
local_output_nid generation:  0.030552148818969727
local_in_edges_tensor generation:  0.0734255313873291
mini_batch_src_global generation:  0.053983449935913086
r_  generation:  0.45619797706604004
local_output_nid generation:  0.03026604652404785
local_in_edges_tensor generation:  0.02840900421142578
mini_batch_src_global generation:  0.05297994613647461
r_  generation:  0.4493672847747803
local_output_nid generation:  0.030483007431030273
local_in_edges_tensor generation:  0.030147790908813477
mini_batch_src_global generation:  0.0520024299621582
r_  generation:  0.45404601097106934
local_output_nid generation:  0.0303497314453125
local_in_edges_tensor generation:  0.028330087661743164
mini_batch_src_global generation:  0.05296206474304199
r_  generation:  0.4501228332519531
local_output_nid generation:  0.030519962310791016
local_in_edges_tensor generation:  0.030018091201782227
mini_batch_src_global generation:  0.05344414710998535
r_  generation:  0.4542510509490967
local_output_nid generation:  0.03068852424621582
local_in_edges_tensor generation:  0.02873706817626953
mini_batch_src_global generation:  0.05285978317260742
r_  generation:  0.4525129795074463
local_output_nid generation:  0.030538082122802734
local_in_edges_tensor generation:  0.03214120864868164
mini_batch_src_global generation:  0.051644086837768555
r_  generation:  0.4564216136932373
local_output_nid generation:  0.030483484268188477
local_in_edges_tensor generation:  0.030382871627807617
mini_batch_src_global generation:  0.05479097366333008
r_  generation:  0.4545271396636963
local_output_nid generation:  0.030582427978515625
local_in_edges_tensor generation:  0.03317379951477051
mini_batch_src_global generation:  0.053963422775268555
r_  generation:  0.4587585926055908
local_output_nid generation:  0.030437469482421875
local_in_edges_tensor generation:  0.03449845314025879
mini_batch_src_global generation:  0.05253863334655762
r_  generation:  0.4496595859527588
local_output_nid generation:  0.030852079391479492
local_in_edges_tensor generation:  0.031096935272216797
mini_batch_src_global generation:  0.052237749099731445
r_  generation:  0.4567592144012451
local_output_nid generation:  0.030227184295654297
local_in_edges_tensor generation:  0.03249406814575195
mini_batch_src_global generation:  0.06378865242004395
r_  generation:  0.4500877857208252
----------------------check_connections_block total spend ----------------------------- 10.712662696838379
generate_one_block  0.5728757381439209
generate_one_block  0.5760636329650879
generate_one_block  0.5710115432739258
generate_one_block  0.5797843933105469
generate_one_block  0.5759429931640625
generate_one_block  0.5706968307495117
generate_one_block  0.5850532054901123
generate_one_block  0.5697681903839111
generate_one_block  0.6590383052825928
generate_one_block  0.5800678730010986
generate_one_block  0.5819621086120605
generate_one_block  0.5828721523284912
generate_one_block  0.5731608867645264
generate_one_block  0.5728213787078857
generate_one_block  0.5762238502502441
generate_one_block  0.5715501308441162
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11493635177612305  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

connection checking time:  15.628623962402344
block generation total time  13.60815954208374
average batch blocks generation time:  0.8505099713802338
block dataloader generation time/epoch 31.257376362295712
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09396600723266602  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7190556526184082  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09316778182983398  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7117257118225098  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09391307830810547  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7190852165222168  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09330606460571289  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7183451652526855  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09388351440429688  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7187108993530273  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09319639205932617  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7157583236694336  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0939016342163086  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7182965278625488  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09312963485717773  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7124800682067871  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0937814712524414  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7166295051574707  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09363555908203125  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7210960388183594  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09397506713867188  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7172660827636719  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09366416931152344  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7226066589355469  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09391212463378906  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7185835838317871  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09329795837402344  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7172894477844238  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09398746490478516  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7206673622131348  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09300994873046875  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7092924118041992  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06258203089237213 |0.011295154690742493 |0.0035637766122817993 |9.199976921081543e-05 |0.0037589222192764282 |0.0015947818756103516 |
----------------------------------------------------------pseudo_mini_loss sum 1.2431495189666748
Total (block generation + training)time/epoch 32.628041071050305
Training time/epoch 1.360823392868042
Training time without block to device /epoch 1.180100917816162
Training time without total dataloading part /epoch 0.12022995948791504
load block tensor time/epoch 1.001312494277954
block to device time/epoch 0.18072247505187988
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 26 |
Number of nodes for computation during this epoch:  5092516
Number of first layer input nodes during this epoch:  2471425
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11447381973266602  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01968836784362793
range selection method range initialization spend 0.012391328811645508
time for parepare:  0.018245935440063477
local_output_nid generation:  0.0014452934265136719
local_in_edges_tensor generation:  0.007283926010131836
mini_batch_src_global generation:  0.001336812973022461
r_  generation:  0.017993688583374023
local_output_nid generation:  0.0016300678253173828
local_in_edges_tensor generation:  0.0009593963623046875
mini_batch_src_global generation:  0.001832723617553711
r_  generation:  0.01973700523376465
local_output_nid generation:  0.0015854835510253906
local_in_edges_tensor generation:  0.0009293556213378906
mini_batch_src_global generation:  0.0014500617980957031
r_  generation:  0.018634319305419922
local_output_nid generation:  0.0016252994537353516
local_in_edges_tensor generation:  0.0009171962738037109
mini_batch_src_global generation:  0.0014538764953613281
r_  generation:  0.01924419403076172
local_output_nid generation:  0.0016071796417236328
local_in_edges_tensor generation:  0.0009055137634277344
mini_batch_src_global generation:  0.0014519691467285156
r_  generation:  0.018445730209350586
local_output_nid generation:  0.0015866756439208984
local_in_edges_tensor generation:  0.0008962154388427734
mini_batch_src_global generation:  0.0014710426330566406
r_  generation:  0.019642114639282227
local_output_nid generation:  0.0015990734100341797
local_in_edges_tensor generation:  0.0010056495666503906
mini_batch_src_global generation:  0.0014955997467041016
r_  generation:  0.019600629806518555
local_output_nid generation:  0.0015697479248046875
local_in_edges_tensor generation:  0.0009140968322753906
mini_batch_src_global generation:  0.0015454292297363281
r_  generation:  0.01971721649169922
local_output_nid generation:  0.0015721321105957031
local_in_edges_tensor generation:  0.0009121894836425781
mini_batch_src_global generation:  0.0015094280242919922
r_  generation:  0.01904010772705078
local_output_nid generation:  0.0016133785247802734
local_in_edges_tensor generation:  0.0009567737579345703
mini_batch_src_global generation:  0.0014731884002685547
r_  generation:  0.019727706909179688
local_output_nid generation:  0.0016410350799560547
local_in_edges_tensor generation:  0.0009908676147460938
mini_batch_src_global generation:  0.0014996528625488281
r_  generation:  0.019121885299682617
local_output_nid generation:  0.0015935897827148438
local_in_edges_tensor generation:  0.0009500980377197266
mini_batch_src_global generation:  0.0015408992767333984
r_  generation:  0.019768238067626953
local_output_nid generation:  0.0015871524810791016
local_in_edges_tensor generation:  0.0009794235229492188
mini_batch_src_global generation:  0.00150299072265625
r_  generation:  0.02002739906311035
local_output_nid generation:  0.0017282962799072266
local_in_edges_tensor generation:  0.0011746883392333984
mini_batch_src_global generation:  0.030159711837768555
r_  generation:  0.021548032760620117
local_output_nid generation:  0.0020198822021484375
local_in_edges_tensor generation:  0.001142740249633789
mini_batch_src_global generation:  0.0016498565673828125
r_  generation:  0.019173383712768555
local_output_nid generation:  0.0018782615661621094
local_in_edges_tensor generation:  0.0010225772857666016
mini_batch_src_global generation:  0.0015418529510498047
r_  generation:  0.018890380859375
----------------------check_connections_block total spend ----------------------------- 0.5017032623291016
generate_one_block  0.030139684677124023
generate_one_block  0.02800273895263672
generate_one_block  0.027946949005126953
generate_one_block  0.028450965881347656
generate_one_block  0.0296475887298584
generate_one_block  0.04414224624633789
generate_one_block  0.029915332794189453
generate_one_block  0.02782750129699707
generate_one_block  0.02751779556274414
generate_one_block  0.028024911880493164
generate_one_block  0.027884721755981445
generate_one_block  0.028117656707763672
generate_one_block  0.028220176696777344
generate_one_block  0.028006553649902344
generate_one_block  0.02767348289489746
generate_one_block  0.02781391143798828
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03655576705932617
gen group dst list time:  0.015426874160766602
time for parepare:  0.020328044891357422
local_output_nid generation:  0.006916999816894531
local_in_edges_tensor generation:  0.020989656448364258
mini_batch_src_global generation:  0.020786285400390625
r_  generation:  0.19051432609558105
local_output_nid generation:  0.010239839553833008
local_in_edges_tensor generation:  0.013729095458984375
mini_batch_src_global generation:  0.024173498153686523
r_  generation:  0.1991896629333496
local_output_nid generation:  0.010510683059692383
local_in_edges_tensor generation:  0.012354135513305664
mini_batch_src_global generation:  0.024816513061523438
r_  generation:  0.20398592948913574
local_output_nid generation:  0.011396646499633789
local_in_edges_tensor generation:  0.010947465896606445
mini_batch_src_global generation:  0.024533987045288086
r_  generation:  0.20681214332580566
local_output_nid generation:  0.011341094970703125
local_in_edges_tensor generation:  0.01271820068359375
mini_batch_src_global generation:  0.025789737701416016
r_  generation:  0.20613646507263184
local_output_nid generation:  0.011574745178222656
local_in_edges_tensor generation:  0.011582136154174805
mini_batch_src_global generation:  0.02639484405517578
r_  generation:  0.21236944198608398
local_output_nid generation:  0.01438593864440918
local_in_edges_tensor generation:  0.014133214950561523
mini_batch_src_global generation:  0.026541709899902344
r_  generation:  0.2166905403137207
local_output_nid generation:  0.014714241027832031
local_in_edges_tensor generation:  0.01239776611328125
mini_batch_src_global generation:  0.02728128433227539
r_  generation:  0.21845698356628418
local_output_nid generation:  0.015205621719360352
local_in_edges_tensor generation:  0.014721393585205078
mini_batch_src_global generation:  0.026901960372924805
r_  generation:  0.2236618995666504
local_output_nid generation:  0.014253616333007812
local_in_edges_tensor generation:  0.011757850646972656
mini_batch_src_global generation:  0.02655792236328125
r_  generation:  0.21204447746276855
local_output_nid generation:  0.012042045593261719
local_in_edges_tensor generation:  0.0115966796875
mini_batch_src_global generation:  0.02657938003540039
r_  generation:  0.2090456485748291
local_output_nid generation:  0.012246847152709961
local_in_edges_tensor generation:  0.01241445541381836
mini_batch_src_global generation:  0.02787947654724121
r_  generation:  0.21168875694274902
local_output_nid generation:  0.012674808502197266
local_in_edges_tensor generation:  0.014180421829223633
mini_batch_src_global generation:  0.028605937957763672
r_  generation:  0.21461176872253418
local_output_nid generation:  0.012552738189697266
local_in_edges_tensor generation:  0.013326883316040039
mini_batch_src_global generation:  0.02698230743408203
r_  generation:  0.21855568885803223
local_output_nid generation:  0.01223897933959961
local_in_edges_tensor generation:  0.011777639389038086
mini_batch_src_global generation:  0.027184486389160156
r_  generation:  0.21163725852966309
local_output_nid generation:  0.012232780456542969
local_in_edges_tensor generation:  0.013343334197998047
mini_batch_src_global generation:  0.029411792755126953
r_  generation:  0.2122352123260498
----------------------check_connections_block total spend ----------------------------- 4.955437183380127
generate_one_block  0.27457618713378906
generate_one_block  0.2685129642486572
generate_one_block  0.26910972595214844
generate_one_block  0.273587703704834
generate_one_block  0.2647693157196045
generate_one_block  0.27436065673828125
generate_one_block  0.29962825775146484
generate_one_block  0.2774660587310791
generate_one_block  0.271198034286499
generate_one_block  0.2715916633605957
generate_one_block  0.26886487007141113
generate_one_block  0.2723104953765869
generate_one_block  0.27672624588012695
generate_one_block  0.27811551094055176
generate_one_block  0.272564172744751
generate_one_block  0.2663421630859375
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03404855728149414
gen group dst list time:  0.0676116943359375
time for parepare:  0.01783013343811035
local_output_nid generation:  0.024825334548950195
local_in_edges_tensor generation:  0.05105710029602051
mini_batch_src_global generation:  0.041651248931884766
r_  generation:  0.44100451469421387
local_output_nid generation:  0.030507564544677734
local_in_edges_tensor generation:  0.0338292121887207
mini_batch_src_global generation:  0.05350232124328613
r_  generation:  0.4426412582397461
local_output_nid generation:  0.029654502868652344
local_in_edges_tensor generation:  0.028754711151123047
mini_batch_src_global generation:  0.05083441734313965
r_  generation:  0.4522559642791748
local_output_nid generation:  0.030300378799438477
local_in_edges_tensor generation:  0.03327608108520508
mini_batch_src_global generation:  0.052744150161743164
r_  generation:  0.45888209342956543
local_output_nid generation:  0.030313730239868164
local_in_edges_tensor generation:  0.07044410705566406
mini_batch_src_global generation:  0.05090904235839844
r_  generation:  0.4596743583679199
local_output_nid generation:  0.03201603889465332
local_in_edges_tensor generation:  0.03127121925354004
mini_batch_src_global generation:  0.05316162109375
r_  generation:  0.4592306613922119
local_output_nid generation:  0.03111743927001953
local_in_edges_tensor generation:  0.031737565994262695
mini_batch_src_global generation:  0.05610299110412598
r_  generation:  0.4609487056732178
local_output_nid generation:  0.0306854248046875
local_in_edges_tensor generation:  0.03353261947631836
mini_batch_src_global generation:  0.06705594062805176
r_  generation:  0.5030865669250488
local_output_nid generation:  0.03538179397583008
local_in_edges_tensor generation:  0.0391840934753418
mini_batch_src_global generation:  0.05930900573730469
r_  generation:  0.4923384189605713
local_output_nid generation:  0.03531694412231445
local_in_edges_tensor generation:  0.035791635513305664
mini_batch_src_global generation:  0.05618166923522949
r_  generation:  0.458160400390625
local_output_nid generation:  0.03207993507385254
local_in_edges_tensor generation:  0.03410005569458008
mini_batch_src_global generation:  0.05428767204284668
r_  generation:  0.47202205657958984
local_output_nid generation:  0.03191375732421875
local_in_edges_tensor generation:  0.032837629318237305
mini_batch_src_global generation:  0.05564427375793457
r_  generation:  0.4588172435760498
local_output_nid generation:  0.03501415252685547
local_in_edges_tensor generation:  0.03161334991455078
mini_batch_src_global generation:  0.05596446990966797
r_  generation:  0.47143030166625977
local_output_nid generation:  0.0325169563293457
local_in_edges_tensor generation:  0.03688669204711914
mini_batch_src_global generation:  0.06818747520446777
r_  generation:  0.474926233291626
local_output_nid generation:  0.032601118087768555
local_in_edges_tensor generation:  0.04218602180480957
mini_batch_src_global generation:  0.06715106964111328
r_  generation:  0.46994495391845703
local_output_nid generation:  0.03333449363708496
local_in_edges_tensor generation:  0.03350996971130371
mini_batch_src_global generation:  0.05583691596984863
r_  generation:  0.4557647705078125
----------------------check_connections_block total spend ----------------------------- 11.103867053985596
generate_one_block  0.5800356864929199
generate_one_block  0.5786957740783691
generate_one_block  0.5772972106933594
generate_one_block  0.5992324352264404
generate_one_block  0.5938501358032227
generate_one_block  0.595494270324707
generate_one_block  0.5941872596740723
generate_one_block  0.6028079986572266
generate_one_block  0.6149835586547852
generate_one_block  0.5755605697631836
generate_one_block  0.5730876922607422
generate_one_block  0.5792038440704346
generate_one_block  0.586144208908081
generate_one_block  0.5814754962921143
generate_one_block  0.5906393527984619
generate_one_block  0.5832242965698242
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11447381973266602  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

connection checking time:  16.059304237365723
block generation total time  13.785643815994263
average batch blocks generation time:  0.8616027384996414
block dataloader generation time/epoch 31.293680561913384
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09386777877807617  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7170629501342773  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09331226348876953  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7160358428955078  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09388923645019531  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7177982330322266  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0935516357421875  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7203965187072754  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.093780517578125  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7152132987976074  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09351873397827148  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7200984954833984  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09397697448730469  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7201323509216309  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09342098236083984  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.718233585357666  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09387016296386719  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7168574333190918  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09316873550415039  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.713346004486084  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09380149841308594  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7164468765258789  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09336709976196289  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7181801795959473  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09404945373535156  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7212305068969727  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09355878829956055  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.721743106842041  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0938253402709961  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7157540321350098  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09330987930297852  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7166004180908203  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.062296196818351746 |0.012927636504173279 |0.003580346703529358 |9.496510028839111e-05 |0.003716513514518738 |0.0014276504516601562 |
----------------------------------------------------------pseudo_mini_loss sum 1.2296770811080933
Total (block generation + training)time/epoch 32.665070586734345
Training time/epoch 1.3835151195526123
Training time without block to device /epoch 1.1766729354858398
Training time without total dataloading part /epoch 0.11969685554504395
load block tensor time/epoch 0.9967391490936279
block to device time/epoch 0.20684218406677246
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 27 |
Number of nodes for computation during this epoch:  5094731
Number of first layer input nodes during this epoch:  2472867
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11495685577392578  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022230863571166992
range selection method range initialization spend 0.01210331916809082
time for parepare:  0.016943931579589844
local_output_nid generation:  0.0014102458953857422
local_in_edges_tensor generation:  0.007475852966308594
mini_batch_src_global generation:  0.001573324203491211
r_  generation:  0.018864154815673828
local_output_nid generation:  0.001589059829711914
local_in_edges_tensor generation:  0.0009474754333496094
mini_batch_src_global generation:  0.0017726421356201172
r_  generation:  0.020012617111206055
local_output_nid generation:  0.0015952587127685547
local_in_edges_tensor generation:  0.0008840560913085938
mini_batch_src_global generation:  0.0014803409576416016
r_  generation:  0.018725156784057617
local_output_nid generation:  0.0016324520111083984
local_in_edges_tensor generation:  0.0009047985076904297
mini_batch_src_global generation:  0.0014369487762451172
r_  generation:  0.018451929092407227
local_output_nid generation:  0.0016682147979736328
local_in_edges_tensor generation:  0.0009348392486572266
mini_batch_src_global generation:  0.0016326904296875
r_  generation:  0.019442319869995117
local_output_nid generation:  0.0016586780548095703
local_in_edges_tensor generation:  0.0008959770202636719
mini_batch_src_global generation:  0.0015671253204345703
r_  generation:  0.0194091796875
local_output_nid generation:  0.0016131401062011719
local_in_edges_tensor generation:  0.0008902549743652344
mini_batch_src_global generation:  0.0015785694122314453
r_  generation:  0.019904136657714844
local_output_nid generation:  0.001634359359741211
local_in_edges_tensor generation:  0.0008807182312011719
mini_batch_src_global generation:  0.0015475749969482422
r_  generation:  0.019254446029663086
local_output_nid generation:  0.0015707015991210938
local_in_edges_tensor generation:  0.0009357929229736328
mini_batch_src_global generation:  0.0015158653259277344
r_  generation:  0.021129131317138672
local_output_nid generation:  0.0016169548034667969
local_in_edges_tensor generation:  0.0009377002716064453
mini_batch_src_global generation:  0.0015718936920166016
r_  generation:  0.019741296768188477
local_output_nid generation:  0.0016069412231445312
local_in_edges_tensor generation:  0.0008859634399414062
mini_batch_src_global generation:  0.0015671253204345703
r_  generation:  0.019759654998779297
local_output_nid generation:  0.0015826225280761719
local_in_edges_tensor generation:  0.0008795261383056641
mini_batch_src_global generation:  0.00152587890625
r_  generation:  0.019893407821655273
local_output_nid generation:  0.0016317367553710938
local_in_edges_tensor generation:  0.00090789794921875
mini_batch_src_global generation:  0.0015201568603515625
r_  generation:  0.0190732479095459
local_output_nid generation:  0.0015881061553955078
local_in_edges_tensor generation:  0.0008935928344726562
mini_batch_src_global generation:  0.001560211181640625
r_  generation:  0.020122289657592773
local_output_nid generation:  0.001596689224243164
local_in_edges_tensor generation:  0.0009696483612060547
mini_batch_src_global generation:  0.0015630722045898438
r_  generation:  0.01955127716064453
local_output_nid generation:  0.0015826225280761719
local_in_edges_tensor generation:  0.0009114742279052734
mini_batch_src_global generation:  0.0015053749084472656
r_  generation:  0.019207239151000977
----------------------check_connections_block total spend ----------------------------- 0.4712047576904297
generate_one_block  0.027512311935424805
generate_one_block  0.02833700180053711
generate_one_block  0.027169227600097656
generate_one_block  0.02693009376525879
generate_one_block  0.028348207473754883
generate_one_block  0.02971482276916504
generate_one_block  0.030427217483520508
generate_one_block  0.027889013290405273
generate_one_block  0.027873516082763672
generate_one_block  0.027856826782226562
generate_one_block  0.028100013732910156
generate_one_block  0.02807164192199707
generate_one_block  0.02775859832763672
generate_one_block  0.028487205505371094
generate_one_block  0.027856826782226562
generate_one_block  0.02755427360534668
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.030650854110717773
gen group dst list time:  0.015726089477539062
time for parepare:  0.021818161010742188
local_output_nid generation:  0.006974935531616211
local_in_edges_tensor generation:  0.02109694480895996
mini_batch_src_global generation:  0.02095651626586914
r_  generation:  0.19619512557983398
local_output_nid generation:  0.010279178619384766
local_in_edges_tensor generation:  0.014330148696899414
mini_batch_src_global generation:  0.02579498291015625
r_  generation:  0.20834779739379883
local_output_nid generation:  0.010316610336303711
local_in_edges_tensor generation:  0.015306472778320312
mini_batch_src_global generation:  0.024594545364379883
r_  generation:  0.20152783393859863
local_output_nid generation:  0.010514497756958008
local_in_edges_tensor generation:  0.012073755264282227
mini_batch_src_global generation:  0.023732900619506836
r_  generation:  0.2031726837158203
local_output_nid generation:  0.011472463607788086
local_in_edges_tensor generation:  0.012173652648925781
mini_batch_src_global generation:  0.027245283126831055
r_  generation:  0.22324252128601074
local_output_nid generation:  0.012274742126464844
local_in_edges_tensor generation:  0.01358342170715332
mini_batch_src_global generation:  0.026807308197021484
r_  generation:  0.21287226676940918
local_output_nid generation:  0.013458013534545898
local_in_edges_tensor generation:  0.012469053268432617
mini_batch_src_global generation:  0.026830673217773438
r_  generation:  0.21798133850097656
local_output_nid generation:  0.012215137481689453
local_in_edges_tensor generation:  0.011512994766235352
mini_batch_src_global generation:  0.026385068893432617
r_  generation:  0.2116537094116211
local_output_nid generation:  0.01232004165649414
local_in_edges_tensor generation:  0.011420488357543945
mini_batch_src_global generation:  0.026171207427978516
r_  generation:  0.21309256553649902
local_output_nid generation:  0.012307167053222656
local_in_edges_tensor generation:  0.01115727424621582
mini_batch_src_global generation:  0.026525259017944336
r_  generation:  0.21534466743469238
local_output_nid generation:  0.011955022811889648
local_in_edges_tensor generation:  0.012456178665161133
mini_batch_src_global generation:  0.027096033096313477
r_  generation:  0.21570825576782227
local_output_nid generation:  0.012135982513427734
local_in_edges_tensor generation:  0.011602640151977539
mini_batch_src_global generation:  0.026543140411376953
r_  generation:  0.21401524543762207
local_output_nid generation:  0.012315750122070312
local_in_edges_tensor generation:  0.011880874633789062
mini_batch_src_global generation:  0.026482820510864258
r_  generation:  0.21270251274108887
local_output_nid generation:  0.01253819465637207
local_in_edges_tensor generation:  0.011574506759643555
mini_batch_src_global generation:  0.027276992797851562
r_  generation:  0.21734213829040527
local_output_nid generation:  0.012308120727539062
local_in_edges_tensor generation:  0.011860370635986328
mini_batch_src_global generation:  0.027068614959716797
r_  generation:  0.21467018127441406
local_output_nid generation:  0.01213383674621582
local_in_edges_tensor generation:  0.011600255966186523
mini_batch_src_global generation:  0.025682449340820312
r_  generation:  0.20801115036010742
----------------------check_connections_block total spend ----------------------------- 4.961371660232544
generate_one_block  0.272228479385376
generate_one_block  0.274181604385376
generate_one_block  0.2629995346069336
generate_one_block  0.2612338066101074
generate_one_block  0.2752242088317871
generate_one_block  0.2640957832336426
generate_one_block  0.296680212020874
generate_one_block  0.27048778533935547
generate_one_block  0.26689743995666504
generate_one_block  0.27063727378845215
generate_one_block  0.2749321460723877
generate_one_block  0.2785654067993164
generate_one_block  0.2676963806152344
generate_one_block  0.2756998538970947
generate_one_block  0.26588010787963867
generate_one_block  0.2627239227294922
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028275728225708008
gen group dst list time:  0.06132102012634277
time for parepare:  0.01791667938232422
local_output_nid generation:  0.02435612678527832
local_in_edges_tensor generation:  0.05027961730957031
mini_batch_src_global generation:  0.04232072830200195
r_  generation:  0.4579761028289795
local_output_nid generation:  0.030397891998291016
local_in_edges_tensor generation:  0.03461647033691406
mini_batch_src_global generation:  0.05136442184448242
r_  generation:  0.4515244960784912
local_output_nid generation:  0.0297698974609375
local_in_edges_tensor generation:  0.02873992919921875
mini_batch_src_global generation:  0.050940752029418945
r_  generation:  0.4650137424468994
local_output_nid generation:  0.03006291389465332
local_in_edges_tensor generation:  0.029550552368164062
mini_batch_src_global generation:  0.05342984199523926
r_  generation:  0.4538452625274658
local_output_nid generation:  0.030208587646484375
local_in_edges_tensor generation:  0.07112765312194824
mini_batch_src_global generation:  0.053143978118896484
r_  generation:  0.4618551731109619
local_output_nid generation:  0.030454635620117188
local_in_edges_tensor generation:  0.032186031341552734
mini_batch_src_global generation:  0.05255270004272461
r_  generation:  0.4560966491699219
local_output_nid generation:  0.03011608123779297
local_in_edges_tensor generation:  0.02907872200012207
mini_batch_src_global generation:  0.05186629295349121
r_  generation:  0.4628453254699707
local_output_nid generation:  0.030538558959960938
local_in_edges_tensor generation:  0.03286099433898926
mini_batch_src_global generation:  0.05327916145324707
r_  generation:  0.4535493850708008
local_output_nid generation:  0.030458927154541016
local_in_edges_tensor generation:  0.031252384185791016
mini_batch_src_global generation:  0.05215907096862793
r_  generation:  0.46213865280151367
local_output_nid generation:  0.030466318130493164
local_in_edges_tensor generation:  0.03140377998352051
mini_batch_src_global generation:  0.05376768112182617
r_  generation:  0.4571843147277832
local_output_nid generation:  0.030749797821044922
local_in_edges_tensor generation:  0.03502821922302246
mini_batch_src_global generation:  0.05280423164367676
r_  generation:  0.4644327163696289
local_output_nid generation:  0.030768394470214844
local_in_edges_tensor generation:  0.03248190879821777
mini_batch_src_global generation:  0.053238868713378906
r_  generation:  0.4577150344848633
local_output_nid generation:  0.030631303787231445
local_in_edges_tensor generation:  0.032787322998046875
mini_batch_src_global generation:  0.052620887756347656
r_  generation:  0.4615743160247803
local_output_nid generation:  0.030847787857055664
local_in_edges_tensor generation:  0.03008413314819336
mini_batch_src_global generation:  0.0551447868347168
r_  generation:  0.45847463607788086
local_output_nid generation:  0.030803203582763672
local_in_edges_tensor generation:  0.03177809715270996
mini_batch_src_global generation:  0.05266094207763672
r_  generation:  0.46159934997558594
local_output_nid generation:  0.030802488327026367
local_in_edges_tensor generation:  0.02987957000732422
mini_batch_src_global generation:  0.05364513397216797
r_  generation:  0.4572150707244873
----------------------check_connections_block total spend ----------------------------- 10.822390794754028
generate_one_block  0.5798795223236084
generate_one_block  0.5779690742492676
generate_one_block  0.5780858993530273
generate_one_block  0.5754349231719971
generate_one_block  0.5847411155700684
generate_one_block  0.5772519111633301
generate_one_block  0.5851984024047852
generate_one_block  0.5793099403381348
generate_one_block  0.638434886932373
generate_one_block  0.5850942134857178
generate_one_block  0.5851657390594482
generate_one_block  0.5816869735717773
generate_one_block  0.5826380252838135
generate_one_block  0.5764288902282715
generate_one_block  0.5915923118591309
generate_one_block  0.5745372772216797
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11495685577392578  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

connection checking time:  15.783762454986572
block generation total time  13.693613052368164
average batch blocks generation time:  0.8558508157730103
block dataloader generation time/epoch 31.304340751547564
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09398126602172852  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7197175025939941  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09324502944946289  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7185664176940918  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09379291534423828  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7150983810424805  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09307575225830078  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7106771469116211  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09401607513427734  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7199525833129883  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09310245513916016  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7158627510070801  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09399604797363281  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7200922966003418  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09342575073242188  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7169356346130371  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09388065338134766  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.717470645904541  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09340572357177734  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7183642387390137  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09397697448730469  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7191324234008789  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09318065643310547  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7169861793518066  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09385299682617188  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7171730995178223  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09334659576416016  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7222161293029785  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09386253356933594  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7179431915283203  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09314346313476562  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7143144607543945  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05807852745056152 |0.01338869333267212 |0.003565177321434021 |9.435415267944336e-05 |0.003248155117034912 |0.0014526844024658203 |
----------------------------------------------------------pseudo_mini_loss sum 1.2184100151062012
Total (block generation + training)time/epoch 32.672877399544966
Training time/epoch 1.3168988227844238
Training time without block to device /epoch 1.10267972946167
Training time without total dataloading part /epoch 0.11197566986083984
load block tensor time/epoch 0.9292564392089844
block to device time/epoch 0.2142190933227539
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 28 |
Number of nodes for computation during this epoch:  5088135
Number of first layer input nodes during this epoch:  2469784
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11461687088012695  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02007269859313965
range selection method range initialization spend 0.012213468551635742
time for parepare:  0.01798534393310547
local_output_nid generation:  0.0014443397521972656
local_in_edges_tensor generation:  0.029846906661987305
mini_batch_src_global generation:  0.001943826675415039
r_  generation:  0.018561840057373047
local_output_nid generation:  0.0019185543060302734
local_in_edges_tensor generation:  0.0010755062103271484
mini_batch_src_global generation:  0.002041339874267578
r_  generation:  0.01986527442932129
local_output_nid generation:  0.0019655227661132812
local_in_edges_tensor generation:  0.00107574462890625
mini_batch_src_global generation:  0.0015039443969726562
r_  generation:  0.01784348487854004
local_output_nid generation:  0.0019669532775878906
local_in_edges_tensor generation:  0.0010497570037841797
mini_batch_src_global generation:  0.0015537738800048828
r_  generation:  0.018172264099121094
local_output_nid generation:  0.0019075870513916016
local_in_edges_tensor generation:  0.0011141300201416016
mini_batch_src_global generation:  0.0015184879302978516
r_  generation:  0.017568349838256836
local_output_nid generation:  0.0018966197967529297
local_in_edges_tensor generation:  0.0009925365447998047
mini_batch_src_global generation:  0.0014829635620117188
r_  generation:  0.018207550048828125
local_output_nid generation:  0.0019228458404541016
local_in_edges_tensor generation:  0.0010209083557128906
mini_batch_src_global generation:  0.0016109943389892578
r_  generation:  0.019134521484375
local_output_nid generation:  0.0018696784973144531
local_in_edges_tensor generation:  0.0009734630584716797
mini_batch_src_global generation:  0.01519012451171875
r_  generation:  0.018407344818115234
local_output_nid generation:  0.0018427371978759766
local_in_edges_tensor generation:  0.001012563705444336
mini_batch_src_global generation:  0.0015854835510253906
r_  generation:  0.019171476364135742
local_output_nid generation:  0.0018258094787597656
local_in_edges_tensor generation:  0.0010058879852294922
mini_batch_src_global generation:  0.0015740394592285156
r_  generation:  0.01918792724609375
local_output_nid generation:  0.0019032955169677734
local_in_edges_tensor generation:  0.0010097026824951172
mini_batch_src_global generation:  0.0016469955444335938
r_  generation:  0.019357681274414062
local_output_nid generation:  0.0018455982208251953
local_in_edges_tensor generation:  0.0010035037994384766
mini_batch_src_global generation:  0.0015673637390136719
r_  generation:  0.018731117248535156
local_output_nid generation:  0.0018320083618164062
local_in_edges_tensor generation:  0.0009837150573730469
mini_batch_src_global generation:  0.0015888214111328125
r_  generation:  0.018790721893310547
local_output_nid generation:  0.0018815994262695312
local_in_edges_tensor generation:  0.0009870529174804688
mini_batch_src_global generation:  0.001619577407836914
r_  generation:  0.019395112991333008
local_output_nid generation:  0.0018453598022460938
local_in_edges_tensor generation:  0.0009906291961669922
mini_batch_src_global generation:  0.0014696121215820312
r_  generation:  0.0186460018157959
local_output_nid generation:  0.0018048286437988281
local_in_edges_tensor generation:  0.0009696483612060547
mini_batch_src_global generation:  0.001634836196899414
r_  generation:  0.01929163932800293
----------------------check_connections_block total spend ----------------------------- 0.5117514133453369
generate_one_block  0.03884530067443848
generate_one_block  0.02893829345703125
generate_one_block  0.02766251564025879
generate_one_block  0.02773118019104004
generate_one_block  0.03203248977661133
generate_one_block  0.03139758110046387
generate_one_block  0.029317855834960938
generate_one_block  0.028088808059692383
generate_one_block  0.028349876403808594
generate_one_block  0.028634309768676758
generate_one_block  0.028319835662841797
generate_one_block  0.028200626373291016
generate_one_block  0.02821826934814453
generate_one_block  0.028595447540283203
generate_one_block  0.02799820899963379
generate_one_block  0.03103470802307129
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04190802574157715
gen group dst list time:  0.019831180572509766
time for parepare:  0.024904489517211914
local_output_nid generation:  0.00873565673828125
local_in_edges_tensor generation:  0.021474599838256836
mini_batch_src_global generation:  0.02075362205505371
r_  generation:  0.2186601161956787
local_output_nid generation:  0.012572050094604492
local_in_edges_tensor generation:  0.01593780517578125
mini_batch_src_global generation:  0.03724169731140137
r_  generation:  0.22133111953735352
local_output_nid generation:  0.012603759765625
local_in_edges_tensor generation:  0.017586231231689453
mini_batch_src_global generation:  0.028493404388427734
r_  generation:  0.21590614318847656
local_output_nid generation:  0.014188051223754883
local_in_edges_tensor generation:  0.014609336853027344
mini_batch_src_global generation:  0.026814699172973633
r_  generation:  0.22379446029663086
local_output_nid generation:  0.013547420501708984
local_in_edges_tensor generation:  0.014296770095825195
mini_batch_src_global generation:  0.02784442901611328
r_  generation:  0.2271137237548828
local_output_nid generation:  0.016155242919921875
local_in_edges_tensor generation:  0.015296220779418945
mini_batch_src_global generation:  0.028342485427856445
r_  generation:  0.21788501739501953
local_output_nid generation:  0.014562368392944336
local_in_edges_tensor generation:  0.014686346054077148
mini_batch_src_global generation:  0.029695987701416016
r_  generation:  0.22910618782043457
local_output_nid generation:  0.014343738555908203
local_in_edges_tensor generation:  0.012412548065185547
mini_batch_src_global generation:  0.028624534606933594
r_  generation:  0.21856236457824707
local_output_nid generation:  0.014611959457397461
local_in_edges_tensor generation:  0.012586355209350586
mini_batch_src_global generation:  0.028998613357543945
r_  generation:  0.2233414649963379
local_output_nid generation:  0.014526128768920898
local_in_edges_tensor generation:  0.012422323226928711
mini_batch_src_global generation:  0.028673648834228516
r_  generation:  0.22330665588378906
local_output_nid generation:  0.014356613159179688
local_in_edges_tensor generation:  0.012497186660766602
mini_batch_src_global generation:  0.028356552124023438
r_  generation:  0.22330331802368164
local_output_nid generation:  0.014491558074951172
local_in_edges_tensor generation:  0.012625932693481445
mini_batch_src_global generation:  0.029985904693603516
r_  generation:  0.22208523750305176
local_output_nid generation:  0.0146942138671875
local_in_edges_tensor generation:  0.012601613998413086
mini_batch_src_global generation:  0.02873969078063965
r_  generation:  0.22637128829956055
local_output_nid generation:  0.01482701301574707
local_in_edges_tensor generation:  0.01358342170715332
mini_batch_src_global generation:  0.030379533767700195
r_  generation:  0.24428558349609375
local_output_nid generation:  0.020056724548339844
local_in_edges_tensor generation:  0.012822866439819336
mini_batch_src_global generation:  0.030035734176635742
r_  generation:  0.22379684448242188
local_output_nid generation:  0.014880657196044922
local_in_edges_tensor generation:  0.013106584548950195
mini_batch_src_global generation:  0.030222654342651367
r_  generation:  0.22974324226379395
----------------------check_connections_block total spend ----------------------------- 5.354018449783325
generate_one_block  0.28516244888305664
generate_one_block  0.27832818031311035
generate_one_block  0.2707056999206543
generate_one_block  0.2750587463378906
generate_one_block  0.26363372802734375
generate_one_block  0.27552366256713867
generate_one_block  0.3160560131072998
generate_one_block  0.26908421516418457
generate_one_block  0.269916296005249
generate_one_block  0.27276134490966797
generate_one_block  0.2696864604949951
generate_one_block  0.27387404441833496
generate_one_block  0.28607916831970215
generate_one_block  0.2769172191619873
generate_one_block  0.2701070308685303
generate_one_block  0.27718377113342285
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03564643859863281
gen group dst list time:  0.06417584419250488
time for parepare:  0.017610788345336914
local_output_nid generation:  0.025411605834960938
local_in_edges_tensor generation:  0.05307149887084961
mini_batch_src_global generation:  0.04204058647155762
r_  generation:  0.4529566764831543
local_output_nid generation:  0.031006336212158203
local_in_edges_tensor generation:  0.0391232967376709
mini_batch_src_global generation:  0.05277824401855469
r_  generation:  0.44856905937194824
local_output_nid generation:  0.030190467834472656
local_in_edges_tensor generation:  0.03422141075134277
mini_batch_src_global generation:  0.05467844009399414
r_  generation:  0.45464372634887695
local_output_nid generation:  0.030676603317260742
local_in_edges_tensor generation:  0.03285503387451172
mini_batch_src_global generation:  0.05240797996520996
r_  generation:  0.4582030773162842
local_output_nid generation:  0.03065657615661621
local_in_edges_tensor generation:  0.07360219955444336
mini_batch_src_global generation:  0.05153465270996094
r_  generation:  0.45726919174194336
local_output_nid generation:  0.03170180320739746
local_in_edges_tensor generation:  0.030620574951171875
mini_batch_src_global generation:  0.05626559257507324
r_  generation:  0.45612263679504395
local_output_nid generation:  0.030604839324951172
local_in_edges_tensor generation:  0.03580760955810547
mini_batch_src_global generation:  0.054027557373046875
r_  generation:  0.47816920280456543
local_output_nid generation:  0.03385043144226074
local_in_edges_tensor generation:  0.033416032791137695
mini_batch_src_global generation:  0.05327892303466797
r_  generation:  0.45420050621032715
local_output_nid generation:  0.03141355514526367
local_in_edges_tensor generation:  0.031488895416259766
mini_batch_src_global generation:  0.05408072471618652
r_  generation:  0.45383358001708984
local_output_nid generation:  0.031470298767089844
local_in_edges_tensor generation:  0.03299283981323242
mini_batch_src_global generation:  0.053537845611572266
r_  generation:  0.4646000862121582
local_output_nid generation:  0.03155708312988281
local_in_edges_tensor generation:  0.03063678741455078
mini_batch_src_global generation:  0.05394339561462402
r_  generation:  0.4565565586090088
local_output_nid generation:  0.03139901161193848
local_in_edges_tensor generation:  0.030096054077148438
mini_batch_src_global generation:  0.0548253059387207
r_  generation:  0.45262670516967773
local_output_nid generation:  0.031385183334350586
local_in_edges_tensor generation:  0.0308380126953125
mini_batch_src_global generation:  0.05222129821777344
r_  generation:  0.4574272632598877
local_output_nid generation:  0.03203129768371582
local_in_edges_tensor generation:  0.0313572883605957
mini_batch_src_global generation:  0.05355215072631836
r_  generation:  0.4570438861846924
local_output_nid generation:  0.031514644622802734
local_in_edges_tensor generation:  0.030016660690307617
mini_batch_src_global generation:  0.054923295974731445
r_  generation:  0.4558899402618408
local_output_nid generation:  0.03178739547729492
local_in_edges_tensor generation:  0.029676437377929688
mini_batch_src_global generation:  0.05343794822692871
r_  generation:  0.45576977729797363
----------------------check_connections_block total spend ----------------------------- 10.831902027130127
generate_one_block  0.5856003761291504
generate_one_block  0.5799803733825684
generate_one_block  0.5775198936462402
generate_one_block  0.5808391571044922
generate_one_block  0.5764355659484863
generate_one_block  0.573997974395752
generate_one_block  0.5840635299682617
generate_one_block  0.5734257698059082
generate_one_block  0.6148858070373535
generate_one_block  0.581676721572876
generate_one_block  0.5835208892822266
generate_one_block  0.5797698497772217
generate_one_block  0.5847251415252686
generate_one_block  0.6124105453491211
generate_one_block  0.5754773616790771
generate_one_block  0.5811927318572998
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11461687088012695  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

connection checking time:  16.185920476913452
block generation total time  13.775599718093872
average batch blocks generation time:  0.860974982380867
block dataloader generation time/epoch 31.341565203666686
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09393835067749023  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.719334602355957  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09331798553466797  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7190394401550293  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09380149841308594  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7155818939208984  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0934906005859375  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7188568115234375  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09365081787109375  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7144613265991211  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09333610534667969  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7168006896972656  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09401321411132812  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7217669486999512  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09317874908447266  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7158260345458984  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09391212463378906  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7184543609619141  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09339046478271484  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7181258201599121  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09389495849609375  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7176742553710938  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09342288970947266  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7166147232055664  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09386157989501953  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7171015739440918  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0936126708984375  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7206869125366211  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09380340576171875  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7162327766418457  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0934896469116211  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7192444801330566  GigaBytes
Max Memory Allocated: 0.8061351776123047  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06304600834846497 |0.013253122568130493 |0.003532811999320984 |9.451806545257568e-05 |0.0036979764699935913 |0.0014503002166748047 |
----------------------------------------------------------pseudo_mini_loss sum 1.2131699323654175
Total (block generation + training)time/epoch 32.71173173189163
Training time/epoch 1.400846004486084
Training time without block to device /epoch 1.188796043395996
Training time without total dataloading part /epoch 0.11865520477294922
load block tensor time/epoch 1.0087361335754395
block to device time/epoch 0.2120499610900879
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 29 |
Number of nodes for computation during this epoch:  5092288
Number of first layer input nodes during this epoch:  2472185
