Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1647750845.6641533
ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024799585342407227
random selection method range initialization spend 0.006403923034667969
time for parepare:  0.01860785484313965
local_output_nid generation:  0.00425410270690918
local_in_edges_tensor generation:  0.006034135818481445
mini_batch_src_global generation:  0.0034182071685791016
r_  generation:  0.037885427474975586
local_output_nid generation:  0.0057926177978515625
local_in_edges_tensor generation:  0.003274679183959961
mini_batch_src_global generation:  0.004348278045654297
r_  generation:  0.0400540828704834
local_output_nid generation:  0.006002187728881836
local_in_edges_tensor generation:  0.003281831741333008
mini_batch_src_global generation:  0.0028657913208007812
r_  generation:  0.039171695709228516
local_output_nid generation:  0.006008148193359375
local_in_edges_tensor generation:  0.0032548904418945312
mini_batch_src_global generation:  0.002938508987426758
r_  generation:  0.04026508331298828
local_output_nid generation:  0.0060214996337890625
local_in_edges_tensor generation:  0.0032951831817626953
mini_batch_src_global generation:  0.003099679946899414
r_  generation:  0.0406947135925293
local_output_nid generation:  0.005972623825073242
local_in_edges_tensor generation:  0.0032355785369873047
mini_batch_src_global generation:  0.0033020973205566406
r_  generation:  0.04188036918640137
local_output_nid generation:  0.006028413772583008
local_in_edges_tensor generation:  0.003271818161010742
mini_batch_src_global generation:  0.003299236297607422
r_  generation:  0.04123568534851074
local_output_nid generation:  0.0060040950775146484
local_in_edges_tensor generation:  0.0032596588134765625
mini_batch_src_global generation:  0.0033037662506103516
r_  generation:  0.041944026947021484
----------------------check_connections_block total spend ----------------------------- 0.5206947326660156
generate_one_block  0.05468392372131348
generate_one_block  0.05623579025268555
generate_one_block  0.05492138862609863
generate_one_block  0.054358720779418945
generate_one_block  0.05849170684814453
generate_one_block  0.05520486831665039
generate_one_block  0.05470418930053711
generate_one_block  0.0541071891784668
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0396275520324707
gen group dst list time:  0.015654563903808594
time for parepare:  0.019107580184936523
local_output_nid generation:  0.013329744338989258
local_in_edges_tensor generation:  0.03257107734680176
mini_batch_src_global generation:  0.030209779739379883
r_  generation:  0.29041147232055664
local_output_nid generation:  0.018312931060791016
local_in_edges_tensor generation:  0.029600858688354492
mini_batch_src_global generation:  0.035509586334228516
r_  generation:  0.3005974292755127
local_output_nid generation:  0.01803302764892578
local_in_edges_tensor generation:  0.02418994903564453
mini_batch_src_global generation:  0.03549599647521973
r_  generation:  0.30257701873779297
local_output_nid generation:  0.017921924591064453
local_in_edges_tensor generation:  0.01850414276123047
mini_batch_src_global generation:  0.0356905460357666
r_  generation:  0.3003671169281006
local_output_nid generation:  0.017886877059936523
local_in_edges_tensor generation:  0.02596902847290039
mini_batch_src_global generation:  0.03693652153015137
r_  generation:  0.3086705207824707
local_output_nid generation:  0.018065929412841797
local_in_edges_tensor generation:  0.02497124671936035
mini_batch_src_global generation:  0.03703474998474121
r_  generation:  0.30494093894958496
local_output_nid generation:  0.018184900283813477
local_in_edges_tensor generation:  0.022182703018188477
mini_batch_src_global generation:  0.039633989334106445
r_  generation:  0.3086073398590088
local_output_nid generation:  0.01827859878540039
local_in_edges_tensor generation:  0.0188751220703125
mini_batch_src_global generation:  0.03695178031921387
r_  generation:  0.3080432415008545
----------------------check_connections_block total spend ----------------------------- 3.5872039794921875
generate_one_block  0.3961634635925293
generate_one_block  0.39905524253845215
generate_one_block  0.389812707901001
generate_one_block  0.3812868595123291
generate_one_block  0.3923609256744385
generate_one_block  0.4088757038116455
generate_one_block  0.3912806510925293
generate_one_block  0.38433384895324707
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03679060935974121
gen group dst list time:  0.035738229751586914
time for parepare:  0.01893448829650879
local_output_nid generation:  0.028456449508666992
local_in_edges_tensor generation:  0.043453216552734375
mini_batch_src_global generation:  0.04421424865722656
r_  generation:  0.47424864768981934
local_output_nid generation:  0.03442573547363281
local_in_edges_tensor generation:  0.05242586135864258
mini_batch_src_global generation:  0.06520819664001465
r_  generation:  0.4866468906402588
local_output_nid generation:  0.03429579734802246
local_in_edges_tensor generation:  0.04389142990112305
mini_batch_src_global generation:  0.050384521484375
r_  generation:  0.49608421325683594
local_output_nid generation:  0.03441309928894043
local_in_edges_tensor generation:  0.038205862045288086
mini_batch_src_global generation:  0.05437064170837402
r_  generation:  0.48494982719421387
local_output_nid generation:  0.03389143943786621
local_in_edges_tensor generation:  0.03870368003845215
mini_batch_src_global generation:  0.053720712661743164
r_  generation:  0.5011746883392334
local_output_nid generation:  0.03459477424621582
local_in_edges_tensor generation:  0.04325151443481445
mini_batch_src_global generation:  0.0543215274810791
r_  generation:  0.48968052864074707
local_output_nid generation:  0.03432655334472656
local_in_edges_tensor generation:  0.035137176513671875
mini_batch_src_global generation:  0.05266261100769043
r_  generation:  0.5000905990600586
local_output_nid generation:  0.0342099666595459
local_in_edges_tensor generation:  0.03525519371032715
mini_batch_src_global generation:  0.05810046195983887
r_  generation:  0.48995280265808105
----------------------check_connections_block total spend ----------------------------- 5.82073712348938
generate_one_block  0.5979108810424805
generate_one_block  0.6177325248718262
generate_one_block  0.6142139434814453
generate_one_block  0.6044230461120605
generate_one_block  0.6203768253326416
generate_one_block  0.6115870475769043
generate_one_block  0.6871371269226074
generate_one_block  0.6316549777984619
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  9.407941102981567
block generation total time  8.1282057762146
average batch blocks generation time:  1.016025722026825
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.09637928009033203  GigaBytes
Max Memory Allocated: 0.09637928009033203  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3494873046875 GB
    Memory Allocated: 0.9010124206542969  GigaBytes
Max Memory Allocated: 0.9616899490356445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8319091796875 GB
    Memory Allocated: 0.09967184066772461  GigaBytes
Max Memory Allocated: 1.0302948951721191  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3787841796875 GB
    Memory Allocated: 0.9066648483276367  GigaBytes
Max Memory Allocated: 1.0302948951721191  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.09946060180664062  GigaBytes
Max Memory Allocated: 1.0367650985717773  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.8996567726135254  GigaBytes
Max Memory Allocated: 1.0367650985717773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.09948158264160156  GigaBytes
Max Memory Allocated: 1.0367650985717773  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.9004764556884766  GigaBytes
Max Memory Allocated: 1.0367650985717773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.09974384307861328  GigaBytes
Max Memory Allocated: 1.0367650985717773  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.9004940986633301  GigaBytes
Max Memory Allocated: 1.0367650985717773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.0995626449584961  GigaBytes
Max Memory Allocated: 1.0367650985717773  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.9058599472045898  GigaBytes
Max Memory Allocated: 1.0367650985717773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.09947347640991211  GigaBytes
Max Memory Allocated: 1.0367650985717773  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.901587963104248  GigaBytes
Max Memory Allocated: 1.0367650985717773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.09959697723388672  GigaBytes
Max Memory Allocated: 1.0367650985717773  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.8999457359313965  GigaBytes
Max Memory Allocated: 1.0367650985717773  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06081801652908325 |0.05892452597618103 |0.09974223375320435 |0.00010243058204650879 |0.018605440855026245 |0.002022981643676758 |
----------------------------------------------------------pseudo_mini_loss sum 6.19629430770874
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  2955535
Number of first layer input nodes during this epoch:  1284020
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.13025236129760742  GigaBytes
Max Memory Allocated: 1.0367650985717773  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02078390121459961
random selection method range initialization spend 0.0054090023040771484
time for parepare:  0.01753401756286621
local_output_nid generation:  0.004388570785522461
local_in_edges_tensor generation:  0.009434223175048828
mini_batch_src_global generation:  0.0033566951751708984
r_  generation:  0.038857460021972656
local_output_nid generation:  0.00589752197265625
local_in_edges_tensor generation:  0.0030367374420166016
mini_batch_src_global generation:  0.004151344299316406
r_  generation:  0.03914237022399902
local_output_nid generation:  0.005945920944213867
local_in_edges_tensor generation:  0.0031561851501464844
mini_batch_src_global generation:  0.0027954578399658203
r_  generation:  0.04119610786437988
local_output_nid generation:  0.0059626102447509766
local_in_edges_tensor generation:  0.003130674362182617
mini_batch_src_global generation:  0.003054380416870117
r_  generation:  0.03957486152648926
local_output_nid generation:  0.00590825080871582
local_in_edges_tensor generation:  0.003014087677001953
mini_batch_src_global generation:  0.003084421157836914
r_  generation:  0.04111433029174805
local_output_nid generation:  0.005964517593383789
local_in_edges_tensor generation:  0.003094911575317383
mini_batch_src_global generation:  0.0033457279205322266
r_  generation:  0.04064774513244629
local_output_nid generation:  0.008367300033569336
local_in_edges_tensor generation:  0.003110647201538086
mini_batch_src_global generation:  0.0034406185150146484
r_  generation:  0.04207205772399902
local_output_nid generation:  0.006035804748535156
local_in_edges_tensor generation:  0.0031583309173583984
mini_batch_src_global generation:  0.003418445587158203
r_  generation:  0.04432082176208496
----------------------check_connections_block total spend ----------------------------- 0.5298206806182861
generate_one_block  0.056704044342041016
generate_one_block  0.0539398193359375
generate_one_block  0.0538938045501709
generate_one_block  0.05518484115600586
generate_one_block  0.05484271049499512
generate_one_block  0.05507516860961914
generate_one_block  0.06250977516174316
generate_one_block  0.05418229103088379
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04094386100769043
gen group dst list time:  0.017171621322631836
time for parepare:  0.022678613662719727
local_output_nid generation:  0.01372075080871582
local_in_edges_tensor generation:  0.03787422180175781
mini_batch_src_global generation:  0.027847766876220703
r_  generation:  0.3033790588378906
local_output_nid generation:  0.021158695220947266
local_in_edges_tensor generation:  0.02847456932067871
mini_batch_src_global generation:  0.03582024574279785
r_  generation:  0.30055880546569824
local_output_nid generation:  0.018303632736206055
local_in_edges_tensor generation:  0.025858402252197266
mini_batch_src_global generation:  0.03461432456970215
r_  generation:  0.3040189743041992
local_output_nid generation:  0.018183231353759766
local_in_edges_tensor generation:  0.01822638511657715
mini_batch_src_global generation:  0.03597855567932129
r_  generation:  0.3023717403411865
local_output_nid generation:  0.018227100372314453
local_in_edges_tensor generation:  0.020066261291503906
mini_batch_src_global generation:  0.03673195838928223
r_  generation:  0.31276750564575195
local_output_nid generation:  0.018362998962402344
local_in_edges_tensor generation:  0.023396015167236328
mini_batch_src_global generation:  0.03686976432800293
r_  generation:  0.3218257427215576
local_output_nid generation:  0.01836085319519043
local_in_edges_tensor generation:  0.02335214614868164
mini_batch_src_global generation:  0.03742671012878418
r_  generation:  0.31810641288757324
local_output_nid generation:  0.018099069595336914
local_in_edges_tensor generation:  0.017746686935424805
mini_batch_src_global generation:  0.038129568099975586
r_  generation:  0.3259000778198242
----------------------check_connections_block total spend ----------------------------- 3.6631593704223633
generate_one_block  0.40678906440734863
generate_one_block  0.4029054641723633
generate_one_block  0.41056323051452637
generate_one_block  0.39159226417541504
generate_one_block  0.4172658920288086
generate_one_block  0.39702653884887695
generate_one_block  0.40027713775634766
generate_one_block  0.47006916999816895
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.044136762619018555
gen group dst list time:  0.039621591567993164
time for parepare:  0.019592761993408203
local_output_nid generation:  0.02894449234008789
local_in_edges_tensor generation:  0.055719614028930664
mini_batch_src_global generation:  0.04395794868469238
r_  generation:  0.48414087295532227
local_output_nid generation:  0.03541398048400879
local_in_edges_tensor generation:  0.05037546157836914
mini_batch_src_global generation:  0.054413795471191406
r_  generation:  0.49227094650268555
local_output_nid generation:  0.04646110534667969
local_in_edges_tensor generation:  0.046881914138793945
mini_batch_src_global generation:  0.05377483367919922
r_  generation:  0.5101215839385986
local_output_nid generation:  0.04053187370300293
local_in_edges_tensor generation:  0.04499459266662598
mini_batch_src_global generation:  0.0647733211517334
r_  generation:  0.5024056434631348
local_output_nid generation:  0.03786134719848633
local_in_edges_tensor generation:  0.0405733585357666
mini_batch_src_global generation:  0.0584261417388916
r_  generation:  0.501563549041748
local_output_nid generation:  0.036889076232910156
local_in_edges_tensor generation:  0.03746962547302246
mini_batch_src_global generation:  0.05476546287536621
r_  generation:  0.49166178703308105
local_output_nid generation:  0.0370330810546875
local_in_edges_tensor generation:  0.04245305061340332
mini_batch_src_global generation:  0.05292201042175293
r_  generation:  0.5041840076446533
local_output_nid generation:  0.0369257926940918
local_in_edges_tensor generation:  0.036039113998413086
mini_batch_src_global generation:  0.055626630783081055
r_  generation:  0.5048799514770508
----------------------check_connections_block total spend ----------------------------- 5.980289936065674
generate_one_block  0.6423370838165283
generate_one_block  0.6262364387512207
generate_one_block  0.6271018981933594
generate_one_block  0.6067399978637695
generate_one_block  0.6140789985656738
generate_one_block  0.6157114505767822
generate_one_block  0.6461329460144043
generate_one_block  0.6556940078735352
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.13025236129760742  GigaBytes
Max Memory Allocated: 1.0367650985717773  GigaBytes

connection checking time:  9.643449306488037
block generation total time  8.330521583557129
average batch blocks generation time:  1.0413151979446411
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.10165739059448242  GigaBytes
Max Memory Allocated: 1.0367650985717773  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.9101605415344238  GigaBytes
Max Memory Allocated: 1.0367650985717773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10134363174438477  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9050493240356445  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10124969482421875  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9073390960693359  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10106706619262695  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9026365280151367  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10129070281982422  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9044303894042969  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10114288330078125  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9041705131530762  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10121870040893555  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9056267738342285  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10120820999145508  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9018888473510742  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06674501299858093 |0.017002344131469727 |0.003846287727355957 |9.277462959289551e-05 |0.008699893951416016 |0.002941131591796875 |
----------------------------------------------------------pseudo_mini_loss sum 3.236593723297119
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  2958904
Number of first layer input nodes during this epoch:  1283908
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12963533401489258  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.029145240783691406
random selection method range initialization spend 0.0058248043060302734
time for parepare:  0.017952680587768555
local_output_nid generation:  0.004416942596435547
local_in_edges_tensor generation:  0.008943796157836914
mini_batch_src_global generation:  0.0035398006439208984
r_  generation:  0.03830409049987793
local_output_nid generation:  0.005991935729980469
local_in_edges_tensor generation:  0.00321197509765625
mini_batch_src_global generation:  0.004242420196533203
r_  generation:  0.040009260177612305
local_output_nid generation:  0.006068229675292969
local_in_edges_tensor generation:  0.0032105445861816406
mini_batch_src_global generation:  0.0028488636016845703
r_  generation:  0.040175676345825195
local_output_nid generation:  0.0061550140380859375
local_in_edges_tensor generation:  0.003208637237548828
mini_batch_src_global generation:  0.0030069351196289062
r_  generation:  0.04162001609802246
local_output_nid generation:  0.0060770511627197266
local_in_edges_tensor generation:  0.0032341480255126953
mini_batch_src_global generation:  0.0031206607818603516
r_  generation:  0.043267250061035156
local_output_nid generation:  0.006158351898193359
local_in_edges_tensor generation:  0.0032606124877929688
mini_batch_src_global generation:  0.003332376480102539
r_  generation:  0.0426480770111084
local_output_nid generation:  0.006123065948486328
local_in_edges_tensor generation:  0.0032634735107421875
mini_batch_src_global generation:  0.0033164024353027344
r_  generation:  0.04244065284729004
local_output_nid generation:  0.006151676177978516
local_in_edges_tensor generation:  0.0032699108123779297
mini_batch_src_global generation:  0.003471851348876953
r_  generation:  0.04390358924865723
----------------------check_connections_block total spend ----------------------------- 0.5352764129638672
generate_one_block  0.053542375564575195
generate_one_block  0.05441427230834961
generate_one_block  0.054662466049194336
generate_one_block  0.05556035041809082
generate_one_block  0.056051015853881836
generate_one_block  0.05480813980102539
generate_one_block  0.057953834533691406
generate_one_block  0.05641007423400879
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.039699554443359375
gen group dst list time:  0.015654325485229492
time for parepare:  0.019174814224243164
local_output_nid generation:  0.01355886459350586
local_in_edges_tensor generation:  0.030999422073364258
mini_batch_src_global generation:  0.029009342193603516
r_  generation:  0.28989386558532715
local_output_nid generation:  0.019472599029541016
local_in_edges_tensor generation:  0.021991252899169922
mini_batch_src_global generation:  0.035530805587768555
r_  generation:  0.30217981338500977
local_output_nid generation:  0.018857240676879883
local_in_edges_tensor generation:  0.020428895950317383
mini_batch_src_global generation:  0.035901784896850586
r_  generation:  0.3070356845855713
local_output_nid generation:  0.018419742584228516
local_in_edges_tensor generation:  0.02061939239501953
mini_batch_src_global generation:  0.03627824783325195
r_  generation:  0.31113600730895996
local_output_nid generation:  0.01835155487060547
local_in_edges_tensor generation:  0.01912832260131836
mini_batch_src_global generation:  0.03806114196777344
r_  generation:  0.31358766555786133
local_output_nid generation:  0.018223285675048828
local_in_edges_tensor generation:  0.019283533096313477
mini_batch_src_global generation:  0.03744673728942871
r_  generation:  0.3165454864501953
local_output_nid generation:  0.018272876739501953
local_in_edges_tensor generation:  0.020659685134887695
mini_batch_src_global generation:  0.03693866729736328
r_  generation:  0.3150012493133545
local_output_nid generation:  0.018456697463989258
local_in_edges_tensor generation:  0.02066779136657715
mini_batch_src_global generation:  0.03939986228942871
r_  generation:  0.31716465950012207
----------------------check_connections_block total spend ----------------------------- 3.621450185775757
generate_one_block  0.41353416442871094
generate_one_block  0.39845824241638184
generate_one_block  0.4099161624908447
generate_one_block  0.3947486877441406
generate_one_block  0.3963949680328369
generate_one_block  0.39241576194763184
generate_one_block  0.38985443115234375
generate_one_block  0.4233510494232178
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.042261600494384766
gen group dst list time:  0.03776264190673828
time for parepare:  0.021266460418701172
local_output_nid generation:  0.030268430709838867
local_in_edges_tensor generation:  0.0466313362121582
mini_batch_src_global generation:  0.045691490173339844
r_  generation:  0.4777028560638428
local_output_nid generation:  0.03543257713317871
local_in_edges_tensor generation:  0.04293966293334961
mini_batch_src_global generation:  0.05668902397155762
r_  generation:  0.48136329650878906
local_output_nid generation:  0.035073280334472656
local_in_edges_tensor generation:  0.03953981399536133
mini_batch_src_global generation:  0.050916194915771484
r_  generation:  0.4907796382904053
local_output_nid generation:  0.03508162498474121
local_in_edges_tensor generation:  0.03832745552062988
mini_batch_src_global generation:  0.05442929267883301
r_  generation:  0.48685121536254883
local_output_nid generation:  0.03706049919128418
local_in_edges_tensor generation:  0.03340506553649902
mini_batch_src_global generation:  0.05507373809814453
r_  generation:  0.5005042552947998
local_output_nid generation:  0.03779149055480957
local_in_edges_tensor generation:  0.037828683853149414
mini_batch_src_global generation:  0.059954166412353516
r_  generation:  0.5005812644958496
local_output_nid generation:  0.0411839485168457
local_in_edges_tensor generation:  0.04505300521850586
mini_batch_src_global generation:  0.06683588027954102
r_  generation:  0.5013537406921387
local_output_nid generation:  0.03657722473144531
local_in_edges_tensor generation:  0.0424044132232666
mini_batch_src_global generation:  0.05528879165649414
r_  generation:  0.4940929412841797
----------------------check_connections_block total spend ----------------------------- 5.886514902114868
generate_one_block  0.6334335803985596
generate_one_block  0.6164510250091553
generate_one_block  0.6240108013153076
generate_one_block  0.6427688598632812
generate_one_block  0.6509037017822266
generate_one_block  0.6470651626586914
generate_one_block  0.6220440864562988
generate_one_block  0.6384022235870361
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12963533401489258  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

connection checking time:  9.507965087890625
block generation total time  8.293752908706665
average batch blocks generation time:  1.0367191135883331
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10151290893554688  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9024977684020996  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1011509895324707  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9037489891052246  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10122966766357422  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9019756317138672  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1012272834777832  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.903902530670166  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10126399993896484  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9058456420898438  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10112667083740234  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9031352996826172  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10111522674560547  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9015321731567383  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10127544403076172  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9071784019470215  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0711071789264679 |0.015814930200576782 |0.0035334527492523193 |9.268522262573242e-05 |0.0033205747604370117 |0.0029036998748779297 |
----------------------------------------------------------pseudo_mini_loss sum 2.608774423599243
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  2956114
Number of first layer input nodes during this epoch:  1283532
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12999725341796875  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0262448787689209
random selection method range initialization spend 0.005931854248046875
time for parepare:  0.017093896865844727
local_output_nid generation:  0.004436016082763672
local_in_edges_tensor generation:  0.007185220718383789
mini_batch_src_global generation:  0.0036046504974365234
r_  generation:  0.03815603256225586
local_output_nid generation:  0.006057024002075195
local_in_edges_tensor generation:  0.003236055374145508
mini_batch_src_global generation:  0.004292964935302734
r_  generation:  0.04002118110656738
local_output_nid generation:  0.006197690963745117
local_in_edges_tensor generation:  0.0032575130462646484
mini_batch_src_global generation:  0.002835512161254883
r_  generation:  0.040390729904174805
local_output_nid generation:  0.00628662109375
local_in_edges_tensor generation:  0.0032341480255126953
mini_batch_src_global generation:  0.002963542938232422
r_  generation:  0.04122042655944824
local_output_nid generation:  0.006241321563720703
local_in_edges_tensor generation:  0.0032243728637695312
mini_batch_src_global generation:  0.003256082534790039
r_  generation:  0.04234743118286133
local_output_nid generation:  0.006242513656616211
local_in_edges_tensor generation:  0.0032958984375
mini_batch_src_global generation:  0.0033812522888183594
r_  generation:  0.04226040840148926
local_output_nid generation:  0.006319761276245117
local_in_edges_tensor generation:  0.0032062530517578125
mini_batch_src_global generation:  0.003329753875732422
r_  generation:  0.04228496551513672
local_output_nid generation:  0.0062618255615234375
local_in_edges_tensor generation:  0.0031991004943847656
mini_batch_src_global generation:  0.0034134387969970703
r_  generation:  0.04297065734863281
----------------------check_connections_block total spend ----------------------------- 0.5311775207519531
generate_one_block  0.06187868118286133
generate_one_block  0.05485177040100098
generate_one_block  0.05380988121032715
generate_one_block  0.05588078498840332
generate_one_block  0.05520176887512207
generate_one_block  0.05644559860229492
generate_one_block  0.05776858329772949
generate_one_block  0.05827641487121582
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.038771629333496094
gen group dst list time:  0.014546394348144531
time for parepare:  0.01968979835510254
local_output_nid generation:  0.015545368194580078
local_in_edges_tensor generation:  0.033699750900268555
mini_batch_src_global generation:  0.029261350631713867
r_  generation:  0.2978026866912842
local_output_nid generation:  0.02176356315612793
local_in_edges_tensor generation:  0.023406982421875
mini_batch_src_global generation:  0.03549504280090332
r_  generation:  0.3128633499145508
local_output_nid generation:  0.0228269100189209
local_in_edges_tensor generation:  0.02403879165649414
mini_batch_src_global generation:  0.037954092025756836
r_  generation:  0.3140997886657715
local_output_nid generation:  0.02115941047668457
local_in_edges_tensor generation:  0.024646759033203125
mini_batch_src_global generation:  0.038613319396972656
r_  generation:  0.32218360900878906
local_output_nid generation:  0.023786544799804688
local_in_edges_tensor generation:  0.021291017532348633
mini_batch_src_global generation:  0.037122249603271484
r_  generation:  0.3194918632507324
local_output_nid generation:  0.021277666091918945
local_in_edges_tensor generation:  0.01916670799255371
mini_batch_src_global generation:  0.05866289138793945
r_  generation:  0.31946611404418945
local_output_nid generation:  0.019637584686279297
local_in_edges_tensor generation:  0.01937270164489746
mini_batch_src_global generation:  0.038126230239868164
r_  generation:  0.31562352180480957
local_output_nid generation:  0.020746231079101562
local_in_edges_tensor generation:  0.024731159210205078
mini_batch_src_global generation:  0.05333375930786133
r_  generation:  0.32360196113586426
----------------------check_connections_block total spend ----------------------------- 3.7796947956085205
generate_one_block  0.4089021682739258
generate_one_block  0.3943314552307129
generate_one_block  0.41397571563720703
generate_one_block  0.4052278995513916
generate_one_block  0.4019796848297119
generate_one_block  0.4032249450683594
generate_one_block  0.3929417133331299
generate_one_block  0.42180395126342773
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0344393253326416
gen group dst list time:  0.03757882118225098
time for parepare:  0.020165205001831055
local_output_nid generation:  0.02933025360107422
local_in_edges_tensor generation:  0.05100560188293457
mini_batch_src_global generation:  0.04582095146179199
r_  generation:  0.4879496097564697
local_output_nid generation:  0.03484153747558594
local_in_edges_tensor generation:  0.04076552391052246
mini_batch_src_global generation:  0.05699276924133301
r_  generation:  0.4874308109283447
local_output_nid generation:  0.03716158866882324
local_in_edges_tensor generation:  0.04621291160583496
mini_batch_src_global generation:  0.05277657508850098
r_  generation:  0.5008869171142578
local_output_nid generation:  0.03714466094970703
local_in_edges_tensor generation:  0.04766535758972168
mini_batch_src_global generation:  0.05873703956604004
r_  generation:  0.5100336074829102
local_output_nid generation:  0.03888130187988281
local_in_edges_tensor generation:  0.04340839385986328
mini_batch_src_global generation:  0.059031009674072266
r_  generation:  0.5001683235168457
local_output_nid generation:  0.03675365447998047
local_in_edges_tensor generation:  0.03436136245727539
mini_batch_src_global generation:  0.05451345443725586
r_  generation:  0.4899437427520752
local_output_nid generation:  0.03575253486633301
local_in_edges_tensor generation:  0.04009270668029785
mini_batch_src_global generation:  0.05361032485961914
r_  generation:  0.5026278495788574
local_output_nid generation:  0.036362409591674805
local_in_edges_tensor generation:  0.03345465660095215
mini_batch_src_global generation:  0.05509781837463379
r_  generation:  0.49192309379577637
----------------------check_connections_block total spend ----------------------------- 5.914354562759399
generate_one_block  0.6302368640899658
generate_one_block  0.6179029941558838
generate_one_block  0.608344316482544
generate_one_block  0.6188411712646484
generate_one_block  0.6270501613616943
generate_one_block  0.6297712326049805
generate_one_block  0.6217193603515625
generate_one_block  0.606781005859375
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12999725341796875  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

connection checking time:  9.69404935836792
block generation total time  8.20303463935852
average batch blocks generation time:  1.025379329919815
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10129356384277344  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9035840034484863  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10109758377075195  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9049277305603027  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10135412216186523  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9025363922119141  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10139989852905273  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9035301208496094  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10135126113891602  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9041943550109863  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10120201110839844  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9062552452087402  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10107660293579102  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9021444320678711  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10158920288085938  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9061784744262695  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0773669183254242 |0.01700204610824585 |0.003848046064376831 |9.399652481079102e-05 |0.0037668943405151367 |0.0018084049224853516 |
----------------------------------------------------------pseudo_mini_loss sum 2.3722445964813232
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  2957349
Number of first layer input nodes during this epoch:  1284151
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1298685073852539  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02283620834350586
random selection method range initialization spend 0.006834268569946289
time for parepare:  0.018952131271362305
local_output_nid generation:  0.004456520080566406
local_in_edges_tensor generation:  0.007744312286376953
mini_batch_src_global generation:  0.0035009384155273438
r_  generation:  0.037847280502319336
local_output_nid generation:  0.0059893131256103516
local_in_edges_tensor generation:  0.003445863723754883
mini_batch_src_global generation:  0.004162788391113281
r_  generation:  0.03945183753967285
local_output_nid generation:  0.00605320930480957
local_in_edges_tensor generation:  0.0031931400299072266
mini_batch_src_global generation:  0.002838134765625
r_  generation:  0.03992056846618652
local_output_nid generation:  0.006147861480712891
local_in_edges_tensor generation:  0.0033240318298339844
mini_batch_src_global generation:  0.003214120864868164
r_  generation:  0.0422358512878418
local_output_nid generation:  0.00623011589050293
local_in_edges_tensor generation:  0.003192901611328125
mini_batch_src_global generation:  0.0031538009643554688
r_  generation:  0.04233598709106445
local_output_nid generation:  0.006155252456665039
local_in_edges_tensor generation:  0.0032155513763427734
mini_batch_src_global generation:  0.0033533573150634766
r_  generation:  0.044272422790527344
local_output_nid generation:  0.0062236785888671875
local_in_edges_tensor generation:  0.0032253265380859375
mini_batch_src_global generation:  0.0034220218658447266
r_  generation:  0.04218602180480957
local_output_nid generation:  0.0060498714447021484
local_in_edges_tensor generation:  0.003200531005859375
mini_batch_src_global generation:  0.0034630298614501953
r_  generation:  0.04336690902709961
----------------------check_connections_block total spend ----------------------------- 0.5367677211761475
generate_one_block  0.06238722801208496
generate_one_block  0.054491281509399414
generate_one_block  0.055736541748046875
generate_one_block  0.055333614349365234
generate_one_block  0.05651211738586426
generate_one_block  0.054818153381347656
generate_one_block  0.05781888961791992
generate_one_block  0.05564737319946289
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03375506401062012
gen group dst list time:  0.014477014541625977
time for parepare:  0.019013643264770508
local_output_nid generation:  0.013805866241455078
local_in_edges_tensor generation:  0.027979135513305664
mini_batch_src_global generation:  0.028695106506347656
r_  generation:  0.29045581817626953
local_output_nid generation:  0.019238948822021484
local_in_edges_tensor generation:  0.02277064323425293
mini_batch_src_global generation:  0.045751333236694336
r_  generation:  0.300858736038208
local_output_nid generation:  0.01933908462524414
local_in_edges_tensor generation:  0.01831650733947754
mini_batch_src_global generation:  0.034694671630859375
r_  generation:  0.3002331256866455
local_output_nid generation:  0.0189664363861084
local_in_edges_tensor generation:  0.018595218658447266
mini_batch_src_global generation:  0.03760242462158203
r_  generation:  0.3084237575531006
local_output_nid generation:  0.01849508285522461
local_in_edges_tensor generation:  0.0176239013671875
mini_batch_src_global generation:  0.03702735900878906
r_  generation:  0.3092353343963623
local_output_nid generation:  0.018177032470703125
local_in_edges_tensor generation:  0.01952052116394043
mini_batch_src_global generation:  0.03872346878051758
r_  generation:  0.30873823165893555
local_output_nid generation:  0.018313884735107422
local_in_edges_tensor generation:  0.018265485763549805
mini_batch_src_global generation:  0.03691554069519043
r_  generation:  0.3101315498352051
local_output_nid generation:  0.018477439880371094
local_in_edges_tensor generation:  0.018892288208007812
mini_batch_src_global generation:  0.04297018051147461
r_  generation:  0.3193962574005127
----------------------check_connections_block total spend ----------------------------- 3.599489450454712
generate_one_block  0.4088611602783203
generate_one_block  0.40381836891174316
generate_one_block  0.3970460891723633
generate_one_block  0.3977699279785156
generate_one_block  0.4041256904602051
generate_one_block  0.39800190925598145
generate_one_block  0.3987407684326172
generate_one_block  0.4352700710296631
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03738236427307129
gen group dst list time:  0.03910112380981445
time for parepare:  0.021178483963012695
local_output_nid generation:  0.030025959014892578
local_in_edges_tensor generation:  0.05875039100646973
mini_batch_src_global generation:  0.045862674713134766
r_  generation:  0.4890635013580322
local_output_nid generation:  0.03653669357299805
local_in_edges_tensor generation:  0.04225301742553711
mini_batch_src_global generation:  0.0543060302734375
r_  generation:  0.5071413516998291
local_output_nid generation:  0.03897285461425781
local_in_edges_tensor generation:  0.0419163703918457
mini_batch_src_global generation:  0.05544638633728027
r_  generation:  0.4907565116882324
local_output_nid generation:  0.03645467758178711
local_in_edges_tensor generation:  0.03466987609863281
mini_batch_src_global generation:  0.05416107177734375
r_  generation:  0.4846639633178711
local_output_nid generation:  0.03627133369445801
local_in_edges_tensor generation:  0.03286552429199219
mini_batch_src_global generation:  0.05218911170959473
r_  generation:  0.49575376510620117
local_output_nid generation:  0.036685943603515625
local_in_edges_tensor generation:  0.03207111358642578
mini_batch_src_global generation:  0.05479693412780762
r_  generation:  0.4876668453216553
local_output_nid generation:  0.0367588996887207
local_in_edges_tensor generation:  0.03439784049987793
mini_batch_src_global generation:  0.05314064025878906
r_  generation:  0.49632906913757324
local_output_nid generation:  0.03679847717285156
local_in_edges_tensor generation:  0.03644847869873047
mini_batch_src_global generation:  0.05491471290588379
r_  generation:  0.4851071834564209
----------------------check_connections_block total spend ----------------------------- 5.845617055892944
generate_one_block  0.6065993309020996
generate_one_block  0.62300705909729
generate_one_block  0.6148102283477783
generate_one_block  0.609067440032959
generate_one_block  0.6116220951080322
generate_one_block  0.6063563823699951
generate_one_block  0.6090936660766602
generate_one_block  0.611100435256958
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1298685073852539  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

connection checking time:  9.445106506347656
block generation total time  8.135290622711182
average batch blocks generation time:  1.0169113278388977
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10140323638916016  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9041709899902344  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10118818283081055  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9062395095825195  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10112619400024414  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9026298522949219  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.101318359375  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9052395820617676  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10112237930297852  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.902890682220459  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10113048553466797  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9028143882751465  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10125207901000977  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9039802551269531  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10138607025146484  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.906743049621582  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07883280515670776 |0.016577064990997314 |0.0037863850593566895 |9.742379188537598e-05 |0.0036503374576568604 |0.0028738975524902344 |
----------------------------------------------------------pseudo_mini_loss sum 2.096107006072998
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  2958442
Number of first layer input nodes during this epoch:  1284409
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12969684600830078  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0219423770904541
random selection method range initialization spend 0.005163669586181641
time for parepare:  0.01854085922241211
local_output_nid generation:  0.004546642303466797
local_in_edges_tensor generation:  0.008785247802734375
mini_batch_src_global generation:  0.003465890884399414
r_  generation:  0.03666257858276367
local_output_nid generation:  0.005959272384643555
local_in_edges_tensor generation:  0.003450632095336914
mini_batch_src_global generation:  0.0043032169342041016
r_  generation:  0.03943347930908203
local_output_nid generation:  0.006075143814086914
local_in_edges_tensor generation:  0.0033235549926757812
mini_batch_src_global generation:  0.0028154850006103516
r_  generation:  0.04023599624633789
local_output_nid generation:  0.006124258041381836
local_in_edges_tensor generation:  0.003305196762084961
mini_batch_src_global generation:  0.0029735565185546875
r_  generation:  0.041040658950805664
local_output_nid generation:  0.006148815155029297
local_in_edges_tensor generation:  0.0032958984375
mini_batch_src_global generation:  0.003125905990600586
r_  generation:  0.042371511459350586
local_output_nid generation:  0.006221771240234375
local_in_edges_tensor generation:  0.0032999515533447266
mini_batch_src_global generation:  0.0033032894134521484
r_  generation:  0.04318690299987793
local_output_nid generation:  0.0061492919921875
local_in_edges_tensor generation:  0.003329038619995117
mini_batch_src_global generation:  0.0034122467041015625
r_  generation:  0.042695045471191406
local_output_nid generation:  0.006153583526611328
local_in_edges_tensor generation:  0.0032510757446289062
mini_batch_src_global generation:  0.003376007080078125
r_  generation:  0.04232978820800781
----------------------check_connections_block total spend ----------------------------- 0.5325679779052734
generate_one_block  0.05377817153930664
generate_one_block  0.054560184478759766
generate_one_block  0.054982662200927734
generate_one_block  0.05490398406982422
generate_one_block  0.05570030212402344
generate_one_block  0.055704593658447266
generate_one_block  0.0586543083190918
generate_one_block  0.05521202087402344
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03516364097595215
gen group dst list time:  0.014786720275878906
time for parepare:  0.019140243530273438
local_output_nid generation:  0.013605594635009766
local_in_edges_tensor generation:  0.027608633041381836
mini_batch_src_global generation:  0.028267860412597656
r_  generation:  0.2870192527770996
local_output_nid generation:  0.019624710083007812
local_in_edges_tensor generation:  0.024776458740234375
mini_batch_src_global generation:  0.035352230072021484
r_  generation:  0.30480194091796875
local_output_nid generation:  0.01979517936706543
local_in_edges_tensor generation:  0.0201263427734375
mini_batch_src_global generation:  0.0362091064453125
r_  generation:  0.31206727027893066
local_output_nid generation:  0.018940210342407227
local_in_edges_tensor generation:  0.02001476287841797
mini_batch_src_global generation:  0.03632020950317383
r_  generation:  0.31145572662353516
local_output_nid generation:  0.019288301467895508
local_in_edges_tensor generation:  0.02035045623779297
mini_batch_src_global generation:  0.03703570365905762
r_  generation:  0.3164041042327881
local_output_nid generation:  0.01844334602355957
local_in_edges_tensor generation:  0.0190427303314209
mini_batch_src_global generation:  0.03692054748535156
r_  generation:  0.31417322158813477
local_output_nid generation:  0.018398761749267578
local_in_edges_tensor generation:  0.019917964935302734
mini_batch_src_global generation:  0.03766655921936035
r_  generation:  0.3172287940979004
local_output_nid generation:  0.018384933471679688
local_in_edges_tensor generation:  0.01860666275024414
mini_batch_src_global generation:  0.03708529472351074
r_  generation:  0.3097352981567383
----------------------check_connections_block total spend ----------------------------- 3.618276834487915
generate_one_block  0.3940730094909668
generate_one_block  0.3944203853607178
generate_one_block  0.3996262550354004
generate_one_block  0.4062333106994629
generate_one_block  0.4102485179901123
generate_one_block  0.4101684093475342
generate_one_block  0.3965432643890381
generate_one_block  0.4137299060821533
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03386425971984863
gen group dst list time:  0.03776955604553223
time for parepare:  0.02014303207397461
local_output_nid generation:  0.03049325942993164
local_in_edges_tensor generation:  0.05155634880065918
mini_batch_src_global generation:  0.04576539993286133
r_  generation:  0.46967244148254395
local_output_nid generation:  0.03585648536682129
local_in_edges_tensor generation:  0.040596961975097656
mini_batch_src_global generation:  0.057082176208496094
r_  generation:  0.48236536979675293
local_output_nid generation:  0.03625750541687012
local_in_edges_tensor generation:  0.03869915008544922
mini_batch_src_global generation:  0.05103135108947754
r_  generation:  0.4910316467285156
local_output_nid generation:  0.035843849182128906
local_in_edges_tensor generation:  0.034780263900756836
mini_batch_src_global generation:  0.05369925498962402
r_  generation:  0.4856688976287842
local_output_nid generation:  0.0359501838684082
local_in_edges_tensor generation:  0.03832268714904785
mini_batch_src_global generation:  0.052785396575927734
r_  generation:  0.4941086769104004
local_output_nid generation:  0.03619837760925293
local_in_edges_tensor generation:  0.032622575759887695
mini_batch_src_global generation:  0.05443239212036133
r_  generation:  0.5053491592407227
local_output_nid generation:  0.03616046905517578
local_in_edges_tensor generation:  0.03359198570251465
mini_batch_src_global generation:  0.055672407150268555
r_  generation:  0.5074868202209473
local_output_nid generation:  0.03701901435852051
local_in_edges_tensor generation:  0.03473925590515137
mini_batch_src_global generation:  0.05911374092102051
r_  generation:  0.5002992153167725
----------------------check_connections_block total spend ----------------------------- 5.834352016448975
generate_one_block  0.6421811580657959
generate_one_block  0.6191973686218262
generate_one_block  0.6146650314331055
generate_one_block  0.6138331890106201
generate_one_block  0.6137666702270508
generate_one_block  0.6080701351165771
generate_one_block  0.6165363788604736
generate_one_block  0.6246817111968994
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12969684600830078  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

connection checking time:  9.45262885093689
block generation total time  8.177974700927734
average batch blocks generation time:  1.0222468376159668
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10102653503417969  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.8980159759521484  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1013803482055664  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9028716087341309  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10135698318481445  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9061627388000488  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10142230987548828  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.904181957244873  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10122108459472656  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9101481437683105  GigaBytes
Max Memory Allocated: 1.0411982536315918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10128545761108398  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.904818058013916  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10122251510620117  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9035634994506836  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10107755661010742  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9020886421203613  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07487228512763977 |0.015209585428237915 |0.004102736711502075 |0.00010129809379577637 |0.003446251153945923 |0.0034279823303222656 |
----------------------------------------------------------pseudo_mini_loss sum 1.957399845123291
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  2956423
Number of first layer input nodes during this epoch:  1284390
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1300511360168457  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023087739944458008
random selection method range initialization spend 0.006594657897949219
time for parepare:  0.018262624740600586
local_output_nid generation:  0.0045986175537109375
local_in_edges_tensor generation:  0.006758451461791992
mini_batch_src_global generation:  0.0033609867095947266
r_  generation:  0.037697792053222656
local_output_nid generation:  0.005971431732177734
local_in_edges_tensor generation:  0.0030868053436279297
mini_batch_src_global generation:  0.004292964935302734
r_  generation:  0.04085683822631836
local_output_nid generation:  0.006197452545166016
local_in_edges_tensor generation:  0.0032761096954345703
mini_batch_src_global generation:  0.0028934478759765625
r_  generation:  0.04056406021118164
local_output_nid generation:  0.006120204925537109
local_in_edges_tensor generation:  0.0031304359436035156
mini_batch_src_global generation:  0.003172636032104492
r_  generation:  0.042696475982666016
local_output_nid generation:  0.006193399429321289
local_in_edges_tensor generation:  0.003201723098754883
mini_batch_src_global generation:  0.0031986236572265625
r_  generation:  0.04250764846801758
local_output_nid generation:  0.006100893020629883
local_in_edges_tensor generation:  0.003158092498779297
mini_batch_src_global generation:  0.0032808780670166016
r_  generation:  0.043324947357177734
local_output_nid generation:  0.00618290901184082
local_in_edges_tensor generation:  0.0031228065490722656
mini_batch_src_global generation:  0.003306865692138672
r_  generation:  0.041516780853271484
local_output_nid generation:  0.006130218505859375
local_in_edges_tensor generation:  0.0031435489654541016
mini_batch_src_global generation:  0.0034503936767578125
r_  generation:  0.0433497428894043
----------------------check_connections_block total spend ----------------------------- 0.5349907875061035
generate_one_block  0.05333828926086426
generate_one_block  0.05450773239135742
generate_one_block  0.0542299747467041
generate_one_block  0.0557706356048584
generate_one_block  0.05510401725769043
generate_one_block  0.054827213287353516
generate_one_block  0.05984377861022949
generate_one_block  0.05568408966064453
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03383755683898926
gen group dst list time:  0.015271902084350586
time for parepare:  0.01968836784362793
local_output_nid generation:  0.014342784881591797
local_in_edges_tensor generation:  0.03429722785949707
mini_batch_src_global generation:  0.028794050216674805
r_  generation:  0.28899478912353516
local_output_nid generation:  0.020270109176635742
local_in_edges_tensor generation:  0.026418209075927734
mini_batch_src_global generation:  0.03685641288757324
r_  generation:  0.30347752571105957
local_output_nid generation:  0.01990532875061035
local_in_edges_tensor generation:  0.022249937057495117
mini_batch_src_global generation:  0.0348820686340332
r_  generation:  0.30484604835510254
local_output_nid generation:  0.019251346588134766
local_in_edges_tensor generation:  0.021429061889648438
mini_batch_src_global generation:  0.03780531883239746
r_  generation:  0.309922456741333
local_output_nid generation:  0.01906609535217285
local_in_edges_tensor generation:  0.020226001739501953
mini_batch_src_global generation:  0.03660106658935547
r_  generation:  0.3089017868041992
local_output_nid generation:  0.01831340789794922
local_in_edges_tensor generation:  0.02004408836364746
mini_batch_src_global generation:  0.03811240196228027
r_  generation:  0.3105583190917969
local_output_nid generation:  0.01821136474609375
local_in_edges_tensor generation:  0.019983530044555664
mini_batch_src_global generation:  0.03646087646484375
r_  generation:  0.3109908103942871
local_output_nid generation:  0.018612384796142578
local_in_edges_tensor generation:  0.020032167434692383
mini_batch_src_global generation:  0.0389251708984375
r_  generation:  0.3165290355682373
----------------------check_connections_block total spend ----------------------------- 3.6155169010162354
generate_one_block  0.3968167304992676
generate_one_block  0.3999662399291992
generate_one_block  0.39707183837890625
generate_one_block  0.4013175964355469
generate_one_block  0.39768242835998535
generate_one_block  0.3897066116333008
generate_one_block  0.3837306499481201
generate_one_block  0.4175689220428467
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03509330749511719
gen group dst list time:  0.037976980209350586
time for parepare:  0.020223617553710938
local_output_nid generation:  0.029316186904907227
local_in_edges_tensor generation:  0.0490107536315918
mini_batch_src_global generation:  0.044182777404785156
r_  generation:  0.4769606590270996
local_output_nid generation:  0.035718679428100586
local_in_edges_tensor generation:  0.04135251045227051
mini_batch_src_global generation:  0.0542449951171875
r_  generation:  0.4882786273956299
local_output_nid generation:  0.03547191619873047
local_in_edges_tensor generation:  0.0442962646484375
mini_batch_src_global generation:  0.052860260009765625
r_  generation:  0.5120258331298828
local_output_nid generation:  0.038402557373046875
local_in_edges_tensor generation:  0.035614728927612305
mini_batch_src_global generation:  0.05559849739074707
r_  generation:  0.4878854751586914
local_output_nid generation:  0.03618025779724121
local_in_edges_tensor generation:  0.036556243896484375
mini_batch_src_global generation:  0.05517005920410156
r_  generation:  0.49679136276245117
local_output_nid generation:  0.03683638572692871
local_in_edges_tensor generation:  0.03418684005737305
mini_batch_src_global generation:  0.05543065071105957
r_  generation:  0.4876673221588135
local_output_nid generation:  0.03607749938964844
local_in_edges_tensor generation:  0.032798051834106445
mini_batch_src_global generation:  0.05335402488708496
r_  generation:  0.49741625785827637
local_output_nid generation:  0.03604483604431152
local_in_edges_tensor generation:  0.03455805778503418
mini_batch_src_global generation:  0.05752134323120117
r_  generation:  0.49578213691711426
----------------------check_connections_block total spend ----------------------------- 5.84617805480957
generate_one_block  0.6121807098388672
generate_one_block  0.6077725887298584
generate_one_block  0.6189818382263184
generate_one_block  0.611572265625
generate_one_block  0.6087779998779297
generate_one_block  0.6146688461303711
generate_one_block  0.6048202514648438
generate_one_block  0.6186676025390625
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1300511360168457  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

connection checking time:  9.461694955825806
block generation total time  8.081303119659424
average batch blocks generation time:  1.010162889957428
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10132122039794922  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9007053375244141  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10137462615966797  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.907404899597168  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10112762451171875  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9027395248413086  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10138607025146484  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.905482292175293  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10115671157836914  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9033503532409668  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10114908218383789  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9029560089111328  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1010141372680664  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.8989849090576172  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10147333145141602  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9082255363464355  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07637503743171692 |0.018724560737609863 |0.0037826895713806152 |9.527802467346191e-05 |0.0036996006965637207 |0.0014486312866210938 |
----------------------------------------------------------pseudo_mini_loss sum 1.8759361505508423
 Run 0| Epoch 6 |
Number of nodes for computation during this epoch:  2956860
Number of first layer input nodes during this epoch:  1284405
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1298675537109375  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02395915985107422
random selection method range initialization spend 0.005432844161987305
time for parepare:  0.018138885498046875
local_output_nid generation:  0.004541635513305664
local_in_edges_tensor generation:  0.0063245296478271484
mini_batch_src_global generation:  0.003620624542236328
r_  generation:  0.03835105895996094
local_output_nid generation:  0.006035327911376953
local_in_edges_tensor generation:  0.0031375885009765625
mini_batch_src_global generation:  0.00435185432434082
r_  generation:  0.03930473327636719
local_output_nid generation:  0.0061686038970947266
local_in_edges_tensor generation:  0.003237485885620117
mini_batch_src_global generation:  0.0029218196868896484
r_  generation:  0.04132556915283203
local_output_nid generation:  0.0061914920806884766
local_in_edges_tensor generation:  0.003246784210205078
mini_batch_src_global generation:  0.0029909610748291016
r_  generation:  0.0410003662109375
local_output_nid generation:  0.00613093376159668
local_in_edges_tensor generation:  0.0033102035522460938
mini_batch_src_global generation:  0.003228425979614258
r_  generation:  0.04203152656555176
local_output_nid generation:  0.006142854690551758
local_in_edges_tensor generation:  0.0032033920288085938
mini_batch_src_global generation:  0.0034027099609375
r_  generation:  0.04227876663208008
local_output_nid generation:  0.0061435699462890625
local_in_edges_tensor generation:  0.003173351287841797
mini_batch_src_global generation:  0.0034935474395751953
r_  generation:  0.0428164005279541
local_output_nid generation:  0.006185054779052734
local_in_edges_tensor generation:  0.003213167190551758
mini_batch_src_global generation:  0.0034818649291992188
r_  generation:  0.04262971878051758
----------------------check_connections_block total spend ----------------------------- 0.532034158706665
generate_one_block  0.054090261459350586
generate_one_block  0.05443429946899414
generate_one_block  0.054993391036987305
generate_one_block  0.05446290969848633
generate_one_block  0.05461764335632324
generate_one_block  0.05517148971557617
generate_one_block  0.058972835540771484
generate_one_block  0.055086374282836914
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03454756736755371
gen group dst list time:  0.014635086059570312
time for parepare:  0.01972222328186035
local_output_nid generation:  0.01386117935180664
local_in_edges_tensor generation:  0.031490325927734375
mini_batch_src_global generation:  0.029891252517700195
r_  generation:  0.29673290252685547
local_output_nid generation:  0.01970195770263672
local_in_edges_tensor generation:  0.020679473876953125
mini_batch_src_global generation:  0.039873361587524414
r_  generation:  0.3020908832550049
local_output_nid generation:  0.019504547119140625
local_in_edges_tensor generation:  0.01941084861755371
mini_batch_src_global generation:  0.03714251518249512
r_  generation:  0.3110940456390381
local_output_nid generation:  0.018675804138183594
local_in_edges_tensor generation:  0.017902851104736328
mini_batch_src_global generation:  0.03708672523498535
r_  generation:  0.30738306045532227
local_output_nid generation:  0.02106189727783203
local_in_edges_tensor generation:  0.01944112777709961
mini_batch_src_global generation:  0.03702139854431152
r_  generation:  0.3126497268676758
local_output_nid generation:  0.018524885177612305
local_in_edges_tensor generation:  0.019430160522460938
mini_batch_src_global generation:  0.03888201713562012
r_  generation:  0.312777042388916
local_output_nid generation:  0.018355846405029297
local_in_edges_tensor generation:  0.01925182342529297
mini_batch_src_global generation:  0.04223918914794922
r_  generation:  0.31582164764404297
local_output_nid generation:  0.018393993377685547
local_in_edges_tensor generation:  0.018343210220336914
mini_batch_src_global generation:  0.03745865821838379
r_  generation:  0.31924915313720703
----------------------check_connections_block total spend ----------------------------- 3.642462968826294
generate_one_block  0.41262316703796387
generate_one_block  0.39580440521240234
generate_one_block  0.4030916690826416
generate_one_block  0.40178751945495605
generate_one_block  0.39451098442077637
generate_one_block  0.3927879333496094
generate_one_block  0.3984386920928955
generate_one_block  0.4212367534637451
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03503680229187012
gen group dst list time:  0.03766775131225586
time for parepare:  0.020419597625732422
local_output_nid generation:  0.030001401901245117
local_in_edges_tensor generation:  0.05779433250427246
mini_batch_src_global generation:  0.04407382011413574
r_  generation:  0.4708552360534668
local_output_nid generation:  0.03583025932312012
local_in_edges_tensor generation:  0.04112863540649414
mini_batch_src_global generation:  0.05408072471618652
r_  generation:  0.4876372814178467
local_output_nid generation:  0.03555464744567871
local_in_edges_tensor generation:  0.03412270545959473
mini_batch_src_global generation:  0.0508573055267334
r_  generation:  0.49338340759277344
local_output_nid generation:  0.04715442657470703
local_in_edges_tensor generation:  0.034158945083618164
mini_batch_src_global generation:  0.05433964729309082
r_  generation:  0.49090027809143066
local_output_nid generation:  0.03566932678222656
local_in_edges_tensor generation:  0.03953194618225098
mini_batch_src_global generation:  0.054121971130371094
r_  generation:  0.5020031929016113
local_output_nid generation:  0.03690695762634277
local_in_edges_tensor generation:  0.03274178504943848
mini_batch_src_global generation:  0.05628085136413574
r_  generation:  0.49382829666137695
local_output_nid generation:  0.035405635833740234
local_in_edges_tensor generation:  0.03253531455993652
mini_batch_src_global generation:  0.0531926155090332
r_  generation:  0.499697208404541
local_output_nid generation:  0.03588223457336426
local_in_edges_tensor generation:  0.034806013107299805
mini_batch_src_global generation:  0.054924964904785156
r_  generation:  0.49559879302978516
----------------------check_connections_block total spend ----------------------------- 5.832580804824829
generate_one_block  0.6171524524688721
generate_one_block  0.61775803565979
generate_one_block  0.616194486618042
generate_one_block  0.6241767406463623
generate_one_block  0.6257202625274658
generate_one_block  0.6115837097167969
generate_one_block  0.618865966796875
generate_one_block  0.6156609058380127
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1298675537109375  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

connection checking time:  9.475043773651123
block generation total time  8.167393684387207
average batch blocks generation time:  1.0209242105484009
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1013040542602539  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9069929122924805  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10126638412475586  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9040694236755371  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10118770599365234  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9026012420654297  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10100746154785156  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9009647369384766  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10196113586425781  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9021921157836914  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10109949111938477  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9039316177368164  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10122346878051758  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9051971435546875  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10193347930908203  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9032535552978516  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07489174604415894 |0.015709102153778076 |0.003906369209289551 |9.810924530029297e-05 |0.003174901008605957 |0.0037353038787841797 |
----------------------------------------------------------pseudo_mini_loss sum 1.7937716245651245
 Run 0| Epoch 7 |
Number of nodes for computation during this epoch:  2955527
Number of first layer input nodes during this epoch:  1283966
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1294713020324707  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023338794708251953
random selection method range initialization spend 0.0053288936614990234
time for parepare:  0.01705765724182129
local_output_nid generation:  0.0048177242279052734
local_in_edges_tensor generation:  0.008803129196166992
mini_batch_src_global generation:  0.004496574401855469
r_  generation:  0.037375688552856445
local_output_nid generation:  0.006044626235961914
local_in_edges_tensor generation:  0.0032219886779785156
mini_batch_src_global generation:  0.0043566226959228516
r_  generation:  0.041556358337402344
local_output_nid generation:  0.0061342716217041016
local_in_edges_tensor generation:  0.0032830238342285156
mini_batch_src_global generation:  0.002948760986328125
r_  generation:  0.0411839485168457
local_output_nid generation:  0.0061609745025634766
local_in_edges_tensor generation:  0.0032508373260498047
mini_batch_src_global generation:  0.002989053726196289
r_  generation:  0.04336190223693848
local_output_nid generation:  0.006316184997558594
local_in_edges_tensor generation:  0.0032968521118164062
mini_batch_src_global generation:  0.003250598907470703
r_  generation:  0.04284214973449707
local_output_nid generation:  0.006189107894897461
local_in_edges_tensor generation:  0.003342151641845703
mini_batch_src_global generation:  0.00336456298828125
r_  generation:  0.04220843315124512
local_output_nid generation:  0.0062711238861083984
local_in_edges_tensor generation:  0.00325775146484375
mini_batch_src_global generation:  0.003464221954345703
r_  generation:  0.04287910461425781
local_output_nid generation:  0.006327629089355469
local_in_edges_tensor generation:  0.003270864486694336
mini_batch_src_global generation:  0.0034341812133789062
r_  generation:  0.042886972427368164
----------------------check_connections_block total spend ----------------------------- 0.5422444343566895
generate_one_block  0.05662417411804199
generate_one_block  0.05411839485168457
generate_one_block  0.055666208267211914
generate_one_block  0.055585384368896484
generate_one_block  0.055357933044433594
generate_one_block  0.054514408111572266
generate_one_block  0.05864262580871582
generate_one_block  0.054894208908081055
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03494071960449219
gen group dst list time:  0.014762163162231445
time for parepare:  0.019255638122558594
local_output_nid generation:  0.014101982116699219
local_in_edges_tensor generation:  0.03035712242126465
mini_batch_src_global generation:  0.02919626235961914
r_  generation:  0.2919423580169678
local_output_nid generation:  0.01984715461730957
local_in_edges_tensor generation:  0.023407936096191406
mini_batch_src_global generation:  0.03531312942504883
r_  generation:  0.30198168754577637
local_output_nid generation:  0.019512414932250977
local_in_edges_tensor generation:  0.025046825408935547
mini_batch_src_global generation:  0.035521507263183594
r_  generation:  0.321030855178833
local_output_nid generation:  0.02036452293395996
local_in_edges_tensor generation:  0.02151346206665039
mini_batch_src_global generation:  0.03632473945617676
r_  generation:  0.3150947093963623
local_output_nid generation:  0.019895553588867188
local_in_edges_tensor generation:  0.02396678924560547
mini_batch_src_global generation:  0.043585777282714844
r_  generation:  0.32164502143859863
local_output_nid generation:  0.018636703491210938
local_in_edges_tensor generation:  0.022498130798339844
mini_batch_src_global generation:  0.03723001480102539
r_  generation:  0.334622859954834
local_output_nid generation:  0.021422624588012695
local_in_edges_tensor generation:  0.01856851577758789
mini_batch_src_global generation:  0.042723894119262695
r_  generation:  0.31661558151245117
local_output_nid generation:  0.019039392471313477
local_in_edges_tensor generation:  0.023593902587890625
mini_batch_src_global generation:  0.03731369972229004
r_  generation:  0.30933213233947754
----------------------check_connections_block total spend ----------------------------- 3.7067220211029053
generate_one_block  0.38947439193725586
generate_one_block  0.39507126808166504
generate_one_block  0.41806864738464355
generate_one_block  0.40329861640930176
generate_one_block  0.40186190605163574
generate_one_block  0.3910348415374756
generate_one_block  0.3996760845184326
generate_one_block  0.4213886260986328
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.035433292388916016
gen group dst list time:  0.038486480712890625
time for parepare:  0.021285295486450195
local_output_nid generation:  0.02973008155822754
local_in_edges_tensor generation:  0.050496816635131836
mini_batch_src_global generation:  0.04436087608337402
r_  generation:  0.4729499816894531
local_output_nid generation:  0.03797149658203125
local_in_edges_tensor generation:  0.041805267333984375
mini_batch_src_global generation:  0.05365562438964844
r_  generation:  0.48178744316101074
local_output_nid generation:  0.0382843017578125
local_in_edges_tensor generation:  0.03779125213623047
mini_batch_src_global generation:  0.05127143859863281
r_  generation:  0.4918076992034912
local_output_nid generation:  0.03641986846923828
local_in_edges_tensor generation:  0.035443782806396484
mini_batch_src_global generation:  0.05396699905395508
r_  generation:  0.48754143714904785
local_output_nid generation:  0.03638410568237305
local_in_edges_tensor generation:  0.03709983825683594
mini_batch_src_global generation:  0.05242753028869629
r_  generation:  0.4966428279876709
local_output_nid generation:  0.03624105453491211
local_in_edges_tensor generation:  0.03493642807006836
mini_batch_src_global generation:  0.055066823959350586
r_  generation:  0.5005340576171875
local_output_nid generation:  0.0365140438079834
local_in_edges_tensor generation:  0.032579898834228516
mini_batch_src_global generation:  0.05379009246826172
r_  generation:  0.5042984485626221
local_output_nid generation:  0.03882265090942383
local_in_edges_tensor generation:  0.033858299255371094
mini_batch_src_global generation:  0.0561213493347168
r_  generation:  0.49429965019226074
----------------------check_connections_block total spend ----------------------------- 5.823292970657349
generate_one_block  0.6172945499420166
generate_one_block  0.6057906150817871
generate_one_block  0.6177401542663574
generate_one_block  0.6156010627746582
generate_one_block  0.6316466331481934
generate_one_block  0.6087188720703125
generate_one_block  0.6087276935577393
generate_one_block  0.6102750301361084
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1294713020324707  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

connection checking time:  9.530014991760254
block generation total time  8.135668992996216
average batch blocks generation time:  1.016958624124527
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10102319717407227  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9014205932617188  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10136222839355469  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.902834415435791  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10137701034545898  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9054465293884277  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10118341445922852  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9061388969421387  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10128021240234375  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9074821472167969  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10120582580566406  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9019861221313477  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10163354873657227  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9035978317260742  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10099506378173828  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.902888298034668  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07837167382240295 |0.014194369316101074 |0.003686666488647461 |9.486079216003418e-05 |0.003682851791381836 |0.0016436576843261719 |
----------------------------------------------------------pseudo_mini_loss sum 1.7089043855667114
 Run 0| Epoch 8 |
Number of nodes for computation during this epoch:  2956633
Number of first layer input nodes during this epoch:  1284060
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1297316551208496  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022617340087890625
random selection method range initialization spend 0.005730152130126953
time for parepare:  0.017374515533447266
local_output_nid generation:  0.004516124725341797
local_in_edges_tensor generation:  0.006481647491455078
mini_batch_src_global generation:  0.0034444332122802734
r_  generation:  0.03961992263793945
local_output_nid generation:  0.005938291549682617
local_in_edges_tensor generation:  0.0031435489654541016
mini_batch_src_global generation:  0.004377841949462891
r_  generation:  0.0402374267578125
local_output_nid generation:  0.006087303161621094
local_in_edges_tensor generation:  0.003259420394897461
mini_batch_src_global generation:  0.002871990203857422
r_  generation:  0.04101228713989258
local_output_nid generation:  0.006150960922241211
local_in_edges_tensor generation:  0.0031747817993164062
mini_batch_src_global generation:  0.003034353256225586
r_  generation:  0.04227256774902344
local_output_nid generation:  0.0061419010162353516
local_in_edges_tensor generation:  0.0031588077545166016
mini_batch_src_global generation:  0.004313230514526367
r_  generation:  0.041938066482543945
local_output_nid generation:  0.00615382194519043
local_in_edges_tensor generation:  0.0032885074615478516
mini_batch_src_global generation:  0.003242969512939453
r_  generation:  0.04425477981567383
local_output_nid generation:  0.006091594696044922
local_in_edges_tensor generation:  0.0031201839447021484
mini_batch_src_global generation:  0.003369569778442383
r_  generation:  0.04386496543884277
local_output_nid generation:  0.006117343902587891
local_in_edges_tensor generation:  0.0032596588134765625
mini_batch_src_global generation:  0.0033164024353027344
r_  generation:  0.043741464614868164
----------------------check_connections_block total spend ----------------------------- 0.5380549430847168
generate_one_block  0.0570981502532959
generate_one_block  0.054956912994384766
generate_one_block  0.057646751403808594
generate_one_block  0.05628609657287598
generate_one_block  0.05795121192932129
generate_one_block  0.05583548545837402
generate_one_block  0.0619962215423584
generate_one_block  0.05565500259399414
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03940105438232422
gen group dst list time:  0.015470743179321289
time for parepare:  0.020771265029907227
local_output_nid generation:  0.014173746109008789
local_in_edges_tensor generation:  0.03475046157836914
mini_batch_src_global generation:  0.03117847442626953
r_  generation:  0.2981290817260742
local_output_nid generation:  0.019251346588134766
local_in_edges_tensor generation:  0.030518054962158203
mini_batch_src_global generation:  0.03705716133117676
r_  generation:  0.32468652725219727
local_output_nid generation:  0.021905899047851562
local_in_edges_tensor generation:  0.021528244018554688
mini_batch_src_global generation:  0.035574913024902344
r_  generation:  0.30675220489501953
local_output_nid generation:  0.019356489181518555
local_in_edges_tensor generation:  0.01863551139831543
mini_batch_src_global generation:  0.03756141662597656
r_  generation:  0.31038975715637207
local_output_nid generation:  0.019298315048217773
local_in_edges_tensor generation:  0.018405914306640625
mini_batch_src_global generation:  0.03703117370605469
r_  generation:  0.30913305282592773
local_output_nid generation:  0.018662214279174805
local_in_edges_tensor generation:  0.019194364547729492
mini_batch_src_global generation:  0.03711056709289551
r_  generation:  0.3081350326538086
local_output_nid generation:  0.01885843276977539
local_in_edges_tensor generation:  0.022144079208374023
mini_batch_src_global generation:  0.03882265090942383
r_  generation:  0.3133563995361328
local_output_nid generation:  0.01851058006286621
local_in_edges_tensor generation:  0.019468069076538086
mini_batch_src_global generation:  0.03740382194519043
r_  generation:  0.31263232231140137
----------------------check_connections_block total spend ----------------------------- 3.656358480453491
generate_one_block  0.4090263843536377
generate_one_block  0.4026021957397461
generate_one_block  0.3966693878173828
generate_one_block  0.3979525566101074
generate_one_block  0.3939943313598633
generate_one_block  0.3948550224304199
generate_one_block  0.4090750217437744
generate_one_block  0.4242269992828369
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03648972511291504
gen group dst list time:  0.038500308990478516
time for parepare:  0.020056724548339844
local_output_nid generation:  0.02900075912475586
local_in_edges_tensor generation:  0.05797743797302246
mini_batch_src_global generation:  0.049154043197631836
r_  generation:  0.475355863571167
local_output_nid generation:  0.03470444679260254
local_in_edges_tensor generation:  0.04198336601257324
mini_batch_src_global generation:  0.05409693717956543
r_  generation:  0.48099613189697266
local_output_nid generation:  0.03471207618713379
local_in_edges_tensor generation:  0.034409284591674805
mini_batch_src_global generation:  0.05325055122375488
r_  generation:  0.4920053482055664
local_output_nid generation:  0.035474300384521484
local_in_edges_tensor generation:  0.03269481658935547
mini_batch_src_global generation:  0.055891990661621094
r_  generation:  0.488295316696167
local_output_nid generation:  0.03426027297973633
local_in_edges_tensor generation:  0.03309965133666992
mini_batch_src_global generation:  0.05299043655395508
r_  generation:  0.5029213428497314
local_output_nid generation:  0.034685373306274414
local_in_edges_tensor generation:  0.03446149826049805
mini_batch_src_global generation:  0.05463361740112305
r_  generation:  0.5067832469940186
local_output_nid generation:  0.036017417907714844
local_in_edges_tensor generation:  0.03468632698059082
mini_batch_src_global generation:  0.05701494216918945
r_  generation:  0.5142350196838379
local_output_nid generation:  0.03577136993408203
local_in_edges_tensor generation:  0.0352325439453125
mini_batch_src_global generation:  0.05521988868713379
r_  generation:  0.4943583011627197
----------------------check_connections_block total spend ----------------------------- 5.853804349899292
generate_one_block  0.6238577365875244
generate_one_block  0.6168968677520752
generate_one_block  0.6251111030578613
generate_one_block  0.6133096218109131
generate_one_block  0.6103115081787109
generate_one_block  0.6144485473632812
generate_one_block  0.6168885231018066
generate_one_block  0.6190793514251709
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1297316551208496  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

connection checking time:  9.510162830352783
block generation total time  8.168305158615112
average batch blocks generation time:  1.021038144826889
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10135126113891602  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.906071662902832  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10132646560668945  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9032273292541504  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10107564926147461  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.900932788848877  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1013188362121582  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9080462455749512  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10111761093139648  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.902397632598877  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10109853744506836  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.902275562286377  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10147333145141602  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.903040885925293  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10117435455322266  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9038581848144531  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07635805010795593 |0.013264089822769165 |0.003578394651412964 |9.191036224365234e-05 |0.0037566721439361572 |0.002992391586303711 |
----------------------------------------------------------pseudo_mini_loss sum 1.6359291076660156
 Run 0| Epoch 9 |
Number of nodes for computation during this epoch:  2956799
Number of first layer input nodes during this epoch:  1284413
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.13000726699829102  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023139476776123047
random selection method range initialization spend 0.0062029361724853516
time for parepare:  0.017238616943359375
local_output_nid generation:  0.004508018493652344
local_in_edges_tensor generation:  0.007016181945800781
mini_batch_src_global generation:  0.0033080577850341797
r_  generation:  0.038274526596069336
local_output_nid generation:  0.005951404571533203
local_in_edges_tensor generation:  0.003113269805908203
mini_batch_src_global generation:  0.004311561584472656
r_  generation:  0.03985238075256348
local_output_nid generation:  0.007668972015380859
local_in_edges_tensor generation:  0.0031452178955078125
mini_batch_src_global generation:  0.002967357635498047
r_  generation:  0.04080343246459961
local_output_nid generation:  0.006095170974731445
local_in_edges_tensor generation:  0.003262758255004883
mini_batch_src_global generation:  0.0029582977294921875
r_  generation:  0.04174685478210449
local_output_nid generation:  0.006087541580200195
local_in_edges_tensor generation:  0.0031495094299316406
mini_batch_src_global generation:  0.0032515525817871094
r_  generation:  0.041928768157958984
local_output_nid generation:  0.006147861480712891
local_in_edges_tensor generation:  0.0032172203063964844
mini_batch_src_global generation:  0.0034193992614746094
r_  generation:  0.04258394241333008
local_output_nid generation:  0.006058216094970703
local_in_edges_tensor generation:  0.003203153610229492
mini_batch_src_global generation:  0.0034029483795166016
r_  generation:  0.04471898078918457
local_output_nid generation:  0.006195783615112305
local_in_edges_tensor generation:  0.003515958786010742
mini_batch_src_global generation:  0.0036363601684570312
r_  generation:  0.04335784912109375
----------------------check_connections_block total spend ----------------------------- 0.5383799076080322
generate_one_block  0.05753159523010254
generate_one_block  0.05619001388549805
generate_one_block  0.05649733543395996
generate_one_block  0.05556607246398926
generate_one_block  0.056231021881103516
generate_one_block  0.05562138557434082
generate_one_block  0.05934548377990723
generate_one_block  0.05600762367248535
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.036657094955444336
gen group dst list time:  0.014950037002563477
time for parepare:  0.021198511123657227
local_output_nid generation:  0.01393270492553711
local_in_edges_tensor generation:  0.029815196990966797
mini_batch_src_global generation:  0.030039548873901367
r_  generation:  0.2923266887664795
local_output_nid generation:  0.01963639259338379
local_in_edges_tensor generation:  0.024122953414916992
mini_batch_src_global generation:  0.03704214096069336
r_  generation:  0.30903172492980957
local_output_nid generation:  0.01942586898803711
local_in_edges_tensor generation:  0.021486997604370117
mini_batch_src_global generation:  0.0356593132019043
r_  generation:  0.3121941089630127
local_output_nid generation:  0.01868152618408203
local_in_edges_tensor generation:  0.019353866577148438
mini_batch_src_global generation:  0.03601837158203125
r_  generation:  0.31988000869750977
local_output_nid generation:  0.020487070083618164
local_in_edges_tensor generation:  0.027619600296020508
mini_batch_src_global generation:  0.04910087585449219
r_  generation:  0.3201417922973633
local_output_nid generation:  0.020093441009521484
local_in_edges_tensor generation:  0.018636703491210938
mini_batch_src_global generation:  0.037384748458862305
r_  generation:  0.3109884262084961
local_output_nid generation:  0.01867508888244629
local_in_edges_tensor generation:  0.01783466339111328
mini_batch_src_global generation:  0.03909707069396973
r_  generation:  0.3122081756591797
local_output_nid generation:  0.018626928329467773
local_in_edges_tensor generation:  0.01930403709411621
mini_batch_src_global generation:  0.03755068778991699
r_  generation:  0.3146235942840576
----------------------check_connections_block total spend ----------------------------- 3.673372507095337
generate_one_block  0.39443016052246094
generate_one_block  0.3996908664703369
generate_one_block  0.39048242568969727
generate_one_block  0.39738941192626953
generate_one_block  0.4103546142578125
generate_one_block  0.3941934108734131
generate_one_block  0.4005117416381836
generate_one_block  0.4286627769470215
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03273296356201172
gen group dst list time:  0.03871417045593262
time for parepare:  0.02031421661376953
local_output_nid generation:  0.03226208686828613
local_in_edges_tensor generation:  0.05916023254394531
mini_batch_src_global generation:  0.046309471130371094
r_  generation:  0.4822421073913574
local_output_nid generation:  0.0369563102722168
local_in_edges_tensor generation:  0.042096853256225586
mini_batch_src_global generation:  0.06673359870910645
r_  generation:  0.4933888912200928
local_output_nid generation:  0.037865638732910156
local_in_edges_tensor generation:  0.03745079040527344
mini_batch_src_global generation:  0.05118155479431152
r_  generation:  0.49308061599731445
local_output_nid generation:  0.03673911094665527
local_in_edges_tensor generation:  0.03509354591369629
mini_batch_src_global generation:  0.05377793312072754
r_  generation:  0.48616814613342285
local_output_nid generation:  0.03705334663391113
local_in_edges_tensor generation:  0.03740501403808594
mini_batch_src_global generation:  0.05255389213562012
r_  generation:  0.5029420852661133
local_output_nid generation:  0.03685760498046875
local_in_edges_tensor generation:  0.03609895706176758
mini_batch_src_global generation:  0.05487656593322754
r_  generation:  0.49609994888305664
local_output_nid generation:  0.03680706024169922
local_in_edges_tensor generation:  0.03785848617553711
mini_batch_src_global generation:  0.05545496940612793
r_  generation:  0.5171473026275635
local_output_nid generation:  0.03674125671386719
local_in_edges_tensor generation:  0.03305983543395996
mini_batch_src_global generation:  0.057378530502319336
r_  generation:  0.4977595806121826
----------------------check_connections_block total spend ----------------------------- 5.904867649078369
generate_one_block  0.616297721862793
generate_one_block  0.6128714084625244
generate_one_block  0.608060359954834
generate_one_block  0.6172425746917725
generate_one_block  0.620110034942627
generate_one_block  0.6239264011383057
generate_one_block  0.609987735748291
generate_one_block  0.6119804382324219
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.13000726699829102  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

connection checking time:  9.578240156173706
block generation total time  8.136192083358765
average batch blocks generation time:  1.0170240104198456
block dataloader generation time/epoch 19.67004132270813
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10132122039794922  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9048991203308105  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10193252563476562  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9037790298461914  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10111331939697266  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9036173820495605  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10113906860351562  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.902407169342041  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10138845443725586  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9040513038635254  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.101043701171875  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9031376838684082  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10116434097290039  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9050283432006836  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10177898406982422  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9031610488891602  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07371583580970764 |0.014347672462463379 |0.0035864412784576416 |9.256601333618164e-05 |0.0037707090377807617 |0.0017070770263671875 |
----------------------------------------------------------pseudo_mini_loss sum 1.5947271585464478
Total (block generation + training)time/epoch 20.50800848007202
Training time/epoch 0.8377737998962402
Training time without block to device /epoch 0.7229924201965332
Training time without total dataloading part /epoch 0.06130480766296387
load block tensor time/epoch 0.5897266864776611
block to device time/epoch 0.11478137969970703
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 10 |
Number of nodes for computation during this epoch:  2955992
Number of first layer input nodes during this epoch:  1283456
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12953901290893555  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02153801918029785
random selection method range initialization spend 0.005789041519165039
time for parepare:  0.017605066299438477
local_output_nid generation:  0.0043981075286865234
local_in_edges_tensor generation:  0.006314277648925781
mini_batch_src_global generation:  0.003208160400390625
r_  generation:  0.037677764892578125
local_output_nid generation:  0.005855560302734375
local_in_edges_tensor generation:  0.003236055374145508
mini_batch_src_global generation:  0.004255533218383789
r_  generation:  0.0397953987121582
local_output_nid generation:  0.006034374237060547
local_in_edges_tensor generation:  0.003217458724975586
mini_batch_src_global generation:  0.0028524398803710938
r_  generation:  0.03909921646118164
local_output_nid generation:  0.00605010986328125
local_in_edges_tensor generation:  0.00325775146484375
mini_batch_src_global generation:  0.0028886795043945312
r_  generation:  0.04005289077758789
local_output_nid generation:  0.00607609748840332
local_in_edges_tensor generation:  0.0032377243041992188
mini_batch_src_global generation:  0.0031538009643554688
r_  generation:  0.04177522659301758
local_output_nid generation:  0.0060803890228271484
local_in_edges_tensor generation:  0.0031447410583496094
mini_batch_src_global generation:  0.0033235549926757812
r_  generation:  0.0414125919342041
local_output_nid generation:  0.006021261215209961
local_in_edges_tensor generation:  0.0033059120178222656
mini_batch_src_global generation:  0.003364086151123047
r_  generation:  0.04226255416870117
local_output_nid generation:  0.00609898567199707
local_in_edges_tensor generation:  0.0032269954681396484
mini_batch_src_global generation:  0.0033926963806152344
r_  generation:  0.042768239974975586
----------------------check_connections_block total spend ----------------------------- 0.5261287689208984
generate_one_block  0.0575709342956543
generate_one_block  0.05443310737609863
generate_one_block  0.053484439849853516
generate_one_block  0.05407142639160156
generate_one_block  0.054807186126708984
generate_one_block  0.054379940032958984
generate_one_block  0.05834841728210449
generate_one_block  0.05575704574584961
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.035982608795166016
gen group dst list time:  0.01464223861694336
time for parepare:  0.019358158111572266
local_output_nid generation:  0.013165712356567383
local_in_edges_tensor generation:  0.0296022891998291
mini_batch_src_global generation:  0.03024458885192871
r_  generation:  0.2905304431915283
local_output_nid generation:  0.019564390182495117
local_in_edges_tensor generation:  0.023288488388061523
mini_batch_src_global generation:  0.03704571723937988
r_  generation:  0.3016951084136963
local_output_nid generation:  0.018975019454956055
local_in_edges_tensor generation:  0.02094268798828125
mini_batch_src_global generation:  0.035675048828125
r_  generation:  0.30027008056640625
local_output_nid generation:  0.01861095428466797
local_in_edges_tensor generation:  0.017879724502563477
mini_batch_src_global generation:  0.036077260971069336
r_  generation:  0.30401134490966797
local_output_nid generation:  0.019234180450439453
local_in_edges_tensor generation:  0.017580032348632812
mini_batch_src_global generation:  0.03682351112365723
r_  generation:  0.308596134185791
local_output_nid generation:  0.018663883209228516
local_in_edges_tensor generation:  0.01916050910949707
mini_batch_src_global generation:  0.03774285316467285
r_  generation:  0.3099045753479004
local_output_nid generation:  0.018126487731933594
local_in_edges_tensor generation:  0.019130229949951172
mini_batch_src_global generation:  0.03860044479370117
r_  generation:  0.30962538719177246
local_output_nid generation:  0.018342971801757812
local_in_edges_tensor generation:  0.019765853881835938
mini_batch_src_global generation:  0.03754591941833496
r_  generation:  0.3172757625579834
----------------------check_connections_block total spend ----------------------------- 3.5893568992614746
generate_one_block  0.3903653621673584
generate_one_block  0.39118146896362305
generate_one_block  0.38668179512023926
generate_one_block  0.399824857711792
generate_one_block  0.3936300277709961
generate_one_block  0.3956732749938965
generate_one_block  0.39406561851501465
generate_one_block  0.4211404323577881
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03150629997253418
gen group dst list time:  0.03772163391113281
time for parepare:  0.018449783325195312
local_output_nid generation:  0.028794288635253906
local_in_edges_tensor generation:  0.040261030197143555
mini_batch_src_global generation:  0.043521881103515625
r_  generation:  0.47318124771118164
local_output_nid generation:  0.035614013671875
local_in_edges_tensor generation:  0.03958392143249512
mini_batch_src_global generation:  0.053194522857666016
r_  generation:  0.4783291816711426
local_output_nid generation:  0.03538823127746582
local_in_edges_tensor generation:  0.036190032958984375
mini_batch_src_global generation:  0.05015444755554199
r_  generation:  0.49102091789245605
local_output_nid generation:  0.03527235984802246
local_in_edges_tensor generation:  0.03834390640258789
mini_batch_src_global generation:  0.060813188552856445
r_  generation:  0.48452115058898926
local_output_nid generation:  0.035314083099365234
local_in_edges_tensor generation:  0.03510904312133789
mini_batch_src_global generation:  0.054439544677734375
r_  generation:  0.49901723861694336
local_output_nid generation:  0.035477638244628906
local_in_edges_tensor generation:  0.035141944885253906
mini_batch_src_global generation:  0.05421710014343262
r_  generation:  0.4927966594696045
local_output_nid generation:  0.03635573387145996
local_in_edges_tensor generation:  0.041677236557006836
mini_batch_src_global generation:  0.054856061935424805
r_  generation:  0.502410888671875
local_output_nid generation:  0.03594326972961426
local_in_edges_tensor generation:  0.0358433723449707
mini_batch_src_global generation:  0.05472588539123535
r_  generation:  0.4930243492126465
----------------------check_connections_block total spend ----------------------------- 5.796769142150879
generate_one_block  0.6179697513580322
generate_one_block  0.6066009998321533
generate_one_block  0.6132616996765137
generate_one_block  0.6112377643585205
generate_one_block  0.6075534820556641
generate_one_block  0.6093766689300537
generate_one_block  0.6171958446502686
generate_one_block  0.6120724678039551
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12953901290893555  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

connection checking time:  9.386126041412354
block generation total time  8.06783151626587
average batch blocks generation time:  1.0084789395332336
block dataloader generation time/epoch 19.520583987236023
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10117816925048828  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9044256210327148  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10126113891601562  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9039053916931152  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10100317001342773  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9006004333496094  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10104513168334961  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.901216983795166  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1017918586730957  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9018521308898926  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10118579864501953  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9050154685974121  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10138225555419922  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9062848091125488  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10156965255737305  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9130582809448242  GigaBytes
Max Memory Allocated: 1.0412554740905762  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0716758668422699 |0.012395769357681274 |0.003519713878631592 |9.176135063171387e-05 |0.0031804442405700684 |0.0017576217651367188 |
----------------------------------------------------------pseudo_mini_loss sum 1.556536316871643
Total (block generation + training)time/epoch 20.34019935131073
Training time/epoch 0.8009862899780273
Training time without block to device /epoch 0.7018201351165771
Training time without total dataloading part /epoch 0.05609297752380371
load block tensor time/epoch 0.5734069347381592
block to device time/epoch 0.0991661548614502
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 11 |
Number of nodes for computation during this epoch:  2956180
Number of first layer input nodes during this epoch:  1283852
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.13104963302612305  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023196935653686523
random selection method range initialization spend 0.006147146224975586
time for parepare:  0.01673293113708496
local_output_nid generation:  0.004611968994140625
local_in_edges_tensor generation:  0.009148597717285156
mini_batch_src_global generation:  0.003361225128173828
r_  generation:  0.03667426109313965
local_output_nid generation:  0.005825519561767578
local_in_edges_tensor generation:  0.00310516357421875
mini_batch_src_global generation:  0.00440526008605957
r_  generation:  0.040291786193847656
local_output_nid generation:  0.006058454513549805
local_in_edges_tensor generation:  0.003444194793701172
mini_batch_src_global generation:  0.002876758575439453
r_  generation:  0.039901018142700195
local_output_nid generation:  0.006088733673095703
local_in_edges_tensor generation:  0.003301382064819336
mini_batch_src_global generation:  0.0030062198638916016
r_  generation:  0.0404508113861084
local_output_nid generation:  0.006030082702636719
local_in_edges_tensor generation:  0.003167390823364258
mini_batch_src_global generation:  0.002996206283569336
r_  generation:  0.041314125061035156
local_output_nid generation:  0.006009101867675781
local_in_edges_tensor generation:  0.0032434463500976562
mini_batch_src_global generation:  0.0032956600189208984
r_  generation:  0.04154610633850098
local_output_nid generation:  0.006059408187866211
local_in_edges_tensor generation:  0.003248453140258789
mini_batch_src_global generation:  0.003292083740234375
r_  generation:  0.04283785820007324
local_output_nid generation:  0.006028175354003906
local_in_edges_tensor generation:  0.0031921863555908203
mini_batch_src_global generation:  0.003367185592651367
r_  generation:  0.04164385795593262
----------------------check_connections_block total spend ----------------------------- 0.5287830829620361
generate_one_block  0.0597531795501709
generate_one_block  0.05476713180541992
generate_one_block  0.05369377136230469
generate_one_block  0.05356431007385254
generate_one_block  0.054692745208740234
generate_one_block  0.05464816093444824
generate_one_block  0.05861997604370117
generate_one_block  0.05419349670410156
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03363180160522461
gen group dst list time:  0.014473438262939453
time for parepare:  0.01976323127746582
local_output_nid generation:  0.013403892517089844
local_in_edges_tensor generation:  0.026742219924926758
mini_batch_src_global generation:  0.03064894676208496
r_  generation:  0.2862217426300049
local_output_nid generation:  0.019365787506103516
local_in_edges_tensor generation:  0.022850513458251953
mini_batch_src_global generation:  0.04259657859802246
r_  generation:  0.3046383857727051
local_output_nid generation:  0.01903510093688965
local_in_edges_tensor generation:  0.01943802833557129
mini_batch_src_global generation:  0.034838199615478516
r_  generation:  0.3032341003417969
local_output_nid generation:  0.018725872039794922
local_in_edges_tensor generation:  0.018572092056274414
mini_batch_src_global generation:  0.03548073768615723
r_  generation:  0.3061060905456543
local_output_nid generation:  0.0187225341796875
local_in_edges_tensor generation:  0.021502256393432617
mini_batch_src_global generation:  0.03867673873901367
r_  generation:  0.3156864643096924
local_output_nid generation:  0.017994403839111328
local_in_edges_tensor generation:  0.017909526824951172
mini_batch_src_global generation:  0.0372767448425293
r_  generation:  0.3078956604003906
local_output_nid generation:  0.018239736557006836
local_in_edges_tensor generation:  0.01825690269470215
mini_batch_src_global generation:  0.037512779235839844
r_  generation:  0.31159543991088867
local_output_nid generation:  0.017852783203125
local_in_edges_tensor generation:  0.018131732940673828
mini_batch_src_global generation:  0.03714394569396973
r_  generation:  0.3092184066772461
----------------------check_connections_block total spend ----------------------------- 3.588102102279663
generate_one_block  0.38645315170288086
generate_one_block  0.39227962493896484
generate_one_block  0.3854048252105713
generate_one_block  0.3858935832977295
generate_one_block  0.39594197273254395
generate_one_block  0.3871152400970459
generate_one_block  0.39048027992248535
generate_one_block  0.4098391532897949
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03007197380065918
gen group dst list time:  0.04022336006164551
time for parepare:  0.018976449966430664
local_output_nid generation:  0.02925848960876465
local_in_edges_tensor generation:  0.04064035415649414
mini_batch_src_global generation:  0.04418039321899414
r_  generation:  0.4697535037994385
local_output_nid generation:  0.0355076789855957
local_in_edges_tensor generation:  0.03600287437438965
mini_batch_src_global generation:  0.0571746826171875
r_  generation:  0.4798111915588379
local_output_nid generation:  0.034862518310546875
local_in_edges_tensor generation:  0.0340428352355957
mini_batch_src_global generation:  0.05069231986999512
r_  generation:  0.48469066619873047
local_output_nid generation:  0.03496503829956055
local_in_edges_tensor generation:  0.030916690826416016
mini_batch_src_global generation:  0.05326676368713379
r_  generation:  0.4825730323791504
local_output_nid generation:  0.035414695739746094
local_in_edges_tensor generation:  0.03204154968261719
mini_batch_src_global generation:  0.051717519760131836
r_  generation:  0.4974963665008545
local_output_nid generation:  0.03537273406982422
local_in_edges_tensor generation:  0.037155866622924805
mini_batch_src_global generation:  0.054169416427612305
r_  generation:  0.48630642890930176
local_output_nid generation:  0.035410165786743164
local_in_edges_tensor generation:  0.032051801681518555
mini_batch_src_global generation:  0.05271744728088379
r_  generation:  0.4960057735443115
local_output_nid generation:  0.035074710845947266
local_in_edges_tensor generation:  0.032030344009399414
mini_batch_src_global generation:  0.053929805755615234
r_  generation:  0.49044013023376465
----------------------check_connections_block total spend ----------------------------- 5.727121114730835
generate_one_block  0.6002013683319092
generate_one_block  0.6113159656524658
generate_one_block  0.6039116382598877
generate_one_block  0.6049833297729492
generate_one_block  0.614189863204956
generate_one_block  0.6154680252075195
generate_one_block  0.6082532405853271
generate_one_block  0.6031641960144043
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.13104963302612305  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

connection checking time:  9.315223217010498
block generation total time  7.9948954582214355
average batch blocks generation time:  0.9993619322776794
block dataloader generation time/epoch 19.40719437599182
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10106897354125977  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9023303985595703  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10168266296386719  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.910651683807373  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10107612609863281  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9020166397094727  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10143423080444336  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9016213417053223  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10122966766357422  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9063725471496582  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10146570205688477  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9053220748901367  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10148191452026367  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9079008102416992  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10117387771606445  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9051289558410645  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07488656044006348 |0.012974292039871216 |0.003563016653060913 |8.919835090637207e-05 |0.003792375326156616 |0.0013606548309326172 |
----------------------------------------------------------pseudo_mini_loss sum 1.5146358013153076
Total (block generation + training)time/epoch 20.23176336288452
Training time/epoch 0.8343460559844971
Training time without block to device /epoch 0.7305517196655273
Training time without total dataloading part /epoch 0.06091737747192383
load block tensor time/epoch 0.5990924835205078
block to device time/epoch 0.10379433631896973
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 12 |
Number of nodes for computation during this epoch:  2958833
Number of first layer input nodes during this epoch:  1284645
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.13001060485839844  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025438547134399414
random selection method range initialization spend 0.0060329437255859375
time for parepare:  0.018434762954711914
local_output_nid generation:  0.0046138763427734375
local_in_edges_tensor generation:  0.006143808364868164
mini_batch_src_global generation:  0.003183126449584961
r_  generation:  0.03793644905090332
local_output_nid generation:  0.005837678909301758
local_in_edges_tensor generation:  0.003156900405883789
mini_batch_src_global generation:  0.004387855529785156
r_  generation:  0.03934478759765625
local_output_nid generation:  0.006075620651245117
local_in_edges_tensor generation:  0.003258943557739258
mini_batch_src_global generation:  0.003021717071533203
r_  generation:  0.0404815673828125
local_output_nid generation:  0.006144523620605469
local_in_edges_tensor generation:  0.003350973129272461
mini_batch_src_global generation:  0.0029473304748535156
r_  generation:  0.040990352630615234
local_output_nid generation:  0.006124019622802734
local_in_edges_tensor generation:  0.0033102035522460938
mini_batch_src_global generation:  0.0031859874725341797
r_  generation:  0.04222750663757324
local_output_nid generation:  0.006105184555053711
local_in_edges_tensor generation:  0.0032317638397216797
mini_batch_src_global generation:  0.003296375274658203
r_  generation:  0.0418696403503418
local_output_nid generation:  0.006139516830444336
local_in_edges_tensor generation:  0.0032432079315185547
mini_batch_src_global generation:  0.003473997116088867
r_  generation:  0.04276752471923828
local_output_nid generation:  0.006047487258911133
local_in_edges_tensor generation:  0.0032379627227783203
mini_batch_src_global generation:  0.0033419132232666016
r_  generation:  0.04268908500671387
----------------------check_connections_block total spend ----------------------------- 0.529808521270752
generate_one_block  0.05300092697143555
generate_one_block  0.05377483367919922
generate_one_block  0.05455422401428223
generate_one_block  0.05561184883117676
generate_one_block  0.054735422134399414
generate_one_block  0.055893898010253906
generate_one_block  0.05977988243103027
generate_one_block  0.05589652061462402
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03667855262756348
gen group dst list time:  0.015362262725830078
time for parepare:  0.01943063735961914
local_output_nid generation:  0.013453960418701172
local_in_edges_tensor generation:  0.02655792236328125
mini_batch_src_global generation:  0.029805421829223633
r_  generation:  0.290027379989624
local_output_nid generation:  0.019487380981445312
local_in_edges_tensor generation:  0.0239408016204834
mini_batch_src_global generation:  0.03900933265686035
r_  generation:  0.30550360679626465
local_output_nid generation:  0.01902008056640625
local_in_edges_tensor generation:  0.018775224685668945
mini_batch_src_global generation:  0.037125349044799805
r_  generation:  0.3053250312805176
local_output_nid generation:  0.018681764602661133
local_in_edges_tensor generation:  0.019796371459960938
mini_batch_src_global generation:  0.03731822967529297
r_  generation:  0.31473517417907715
local_output_nid generation:  0.019300460815429688
local_in_edges_tensor generation:  0.02077341079711914
mini_batch_src_global generation:  0.039145469665527344
r_  generation:  0.3121335506439209
local_output_nid generation:  0.01849818229675293
local_in_edges_tensor generation:  0.018704891204833984
mini_batch_src_global generation:  0.0367734432220459
r_  generation:  0.31217527389526367
local_output_nid generation:  0.01820516586303711
local_in_edges_tensor generation:  0.01889801025390625
mini_batch_src_global generation:  0.04226565361022949
r_  generation:  0.3147275447845459
local_output_nid generation:  0.018370866775512695
local_in_edges_tensor generation:  0.01939988136291504
mini_batch_src_global generation:  0.037653446197509766
r_  generation:  0.31513166427612305
----------------------check_connections_block total spend ----------------------------- 3.624241590499878
generate_one_block  0.39409565925598145
generate_one_block  0.38820695877075195
generate_one_block  0.38817572593688965
generate_one_block  0.3955984115600586
generate_one_block  0.38993024826049805
generate_one_block  0.38563990592956543
generate_one_block  0.3925142288208008
generate_one_block  0.4167928695678711
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.031006813049316406
gen group dst list time:  0.03771543502807617
time for parepare:  0.019909143447875977
local_output_nid generation:  0.028939008712768555
local_in_edges_tensor generation:  0.03967165946960449
mini_batch_src_global generation:  0.04334211349487305
r_  generation:  0.46913957595825195
local_output_nid generation:  0.03509879112243652
local_in_edges_tensor generation:  0.034957170486450195
mini_batch_src_global generation:  0.05384659767150879
r_  generation:  0.4772922992706299
local_output_nid generation:  0.03503870964050293
local_in_edges_tensor generation:  0.031954288482666016
mini_batch_src_global generation:  0.05079507827758789
r_  generation:  0.490706205368042
local_output_nid generation:  0.03525233268737793
local_in_edges_tensor generation:  0.0332028865814209
mini_batch_src_global generation:  0.054132699966430664
r_  generation:  0.48636293411254883
local_output_nid generation:  0.03490781784057617
local_in_edges_tensor generation:  0.032062530517578125
mini_batch_src_global generation:  0.05392575263977051
r_  generation:  0.49408864974975586
local_output_nid generation:  0.03533339500427246
local_in_edges_tensor generation:  0.032150983810424805
mini_batch_src_global generation:  0.0543975830078125
r_  generation:  0.485929012298584
local_output_nid generation:  0.034888505935668945
local_in_edges_tensor generation:  0.03162074089050293
mini_batch_src_global generation:  0.052954673767089844
r_  generation:  0.498030424118042
local_output_nid generation:  0.035017967224121094
local_in_edges_tensor generation:  0.032527923583984375
mini_batch_src_global generation:  0.05455207824707031
r_  generation:  0.4894063472747803
----------------------check_connections_block total spend ----------------------------- 5.721267938613892
generate_one_block  0.6032435894012451
generate_one_block  0.6124377250671387
generate_one_block  0.6016316413879395
generate_one_block  0.6061351299285889
generate_one_block  0.611046314239502
generate_one_block  0.599635124206543
generate_one_block  0.6163721084594727
generate_one_block  0.611119270324707
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.13001060485839844  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

connection checking time:  9.34550952911377
block generation total time  8.012574911117554
average batch blocks generation time:  1.0015718638896942
block dataloader generation time/epoch 19.358143389225006
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10137224197387695  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9021401405334473  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1011962890625  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9047732353210449  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1010122299194336  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9013271331787109  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10111141204833984  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9042520523071289  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10118627548217773  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9041266441345215  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1009984016418457  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9022102355957031  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10134506225585938  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9033560752868652  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10115861892700195  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9054245948791504  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07532504200935364 |0.009421885013580322 |0.0036197006702423096 |9.107589721679688e-05 |0.0037857890129089355 |0.0029442310333251953 |
----------------------------------------------------------pseudo_mini_loss sum 1.4804998636245728
Total (block generation + training)time/epoch 20.180222809314728
Training time/epoch 0.814345121383667
Training time without block to device /epoch 0.7389700412750244
Training time without total dataloading part /epoch 0.06291675567626953
load block tensor time/epoch 0.6026003360748291
block to device time/epoch 0.07537508010864258
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 13 |
Number of nodes for computation during this epoch:  2955071
Number of first layer input nodes during this epoch:  1283675
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1299734115600586  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025249958038330078
random selection method range initialization spend 0.006880283355712891
time for parepare:  0.019496917724609375
local_output_nid generation:  0.004457235336303711
local_in_edges_tensor generation:  0.00525665283203125
mini_batch_src_global generation:  0.0030829906463623047
r_  generation:  0.03792166709899902
local_output_nid generation:  0.005946636199951172
local_in_edges_tensor generation:  0.003620624542236328
mini_batch_src_global generation:  0.0043413639068603516
r_  generation:  0.03984212875366211
local_output_nid generation:  0.006089448928833008
local_in_edges_tensor generation:  0.0034074783325195312
mini_batch_src_global generation:  0.0030059814453125
r_  generation:  0.04188942909240723
local_output_nid generation:  0.006104707717895508
local_in_edges_tensor generation:  0.0034313201904296875
mini_batch_src_global generation:  0.0029914379119873047
r_  generation:  0.04172468185424805
local_output_nid generation:  0.006152153015136719
local_in_edges_tensor generation:  0.0035102367401123047
mini_batch_src_global generation:  0.003261566162109375
r_  generation:  0.04165530204772949
local_output_nid generation:  0.006190776824951172
local_in_edges_tensor generation:  0.004932880401611328
mini_batch_src_global generation:  0.0034394264221191406
r_  generation:  0.043020009994506836
local_output_nid generation:  0.006158590316772461
local_in_edges_tensor generation:  0.0034914016723632812
mini_batch_src_global generation:  0.003453493118286133
r_  generation:  0.043648481369018555
local_output_nid generation:  0.0060977935791015625
local_in_edges_tensor generation:  0.003451108932495117
mini_batch_src_global generation:  0.003431558609008789
r_  generation:  0.04313802719116211
----------------------check_connections_block total spend ----------------------------- 0.541755199432373
generate_one_block  0.052645206451416016
generate_one_block  0.0549318790435791
generate_one_block  0.05562305450439453
generate_one_block  0.0551304817199707
generate_one_block  0.05433988571166992
generate_one_block  0.055535078048706055
generate_one_block  0.06027960777282715
generate_one_block  0.060029029846191406
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03479957580566406
gen group dst list time:  0.018146038055419922
time for parepare:  0.02003955841064453
local_output_nid generation:  0.01406717300415039
local_in_edges_tensor generation:  0.029909133911132812
mini_batch_src_global generation:  0.028875112533569336
r_  generation:  0.28631091117858887
local_output_nid generation:  0.019766569137573242
local_in_edges_tensor generation:  0.023978710174560547
mini_batch_src_global generation:  0.03690505027770996
r_  generation:  0.3082737922668457
local_output_nid generation:  0.02013373374938965
local_in_edges_tensor generation:  0.023875713348388672
mini_batch_src_global generation:  0.03563737869262695
r_  generation:  0.31309008598327637
local_output_nid generation:  0.019274234771728516
local_in_edges_tensor generation:  0.019631147384643555
mini_batch_src_global generation:  0.03661179542541504
r_  generation:  0.31592583656311035
local_output_nid generation:  0.01946401596069336
local_in_edges_tensor generation:  0.017954111099243164
mini_batch_src_global generation:  0.03709697723388672
r_  generation:  0.31041383743286133
local_output_nid generation:  0.019395112991333008
local_in_edges_tensor generation:  0.018151044845581055
mini_batch_src_global generation:  0.037314653396606445
r_  generation:  0.3168168067932129
local_output_nid generation:  0.018978118896484375
local_in_edges_tensor generation:  0.02277684211730957
mini_batch_src_global generation:  0.03827834129333496
r_  generation:  0.3198966979980469
local_output_nid generation:  0.018323898315429688
local_in_edges_tensor generation:  0.017925024032592773
mini_batch_src_global generation:  0.03753852844238281
r_  generation:  0.31745481491088867
----------------------check_connections_block total spend ----------------------------- 3.65118670463562
generate_one_block  0.4043295383453369
generate_one_block  0.3982698917388916
generate_one_block  0.4008646011352539
generate_one_block  0.39377307891845703
generate_one_block  0.3841557502746582
generate_one_block  0.3943631649017334
generate_one_block  0.4039337635040283
generate_one_block  0.41655707359313965
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.033808231353759766
gen group dst list time:  0.03802037239074707
time for parepare:  0.021453857421875
local_output_nid generation:  0.031340837478637695
local_in_edges_tensor generation:  0.04675745964050293
mini_batch_src_global generation:  0.04573965072631836
r_  generation:  0.48285961151123047
local_output_nid generation:  0.03664970397949219
local_in_edges_tensor generation:  0.041085243225097656
mini_batch_src_global generation:  0.06531095504760742
r_  generation:  0.482710599899292
local_output_nid generation:  0.037267446517944336
local_in_edges_tensor generation:  0.03518819808959961
mini_batch_src_global generation:  0.0507814884185791
r_  generation:  0.49361252784729004
local_output_nid generation:  0.03683590888977051
local_in_edges_tensor generation:  0.03659820556640625
mini_batch_src_global generation:  0.054413795471191406
r_  generation:  0.4864625930786133
local_output_nid generation:  0.036217689514160156
local_in_edges_tensor generation:  0.03467702865600586
mini_batch_src_global generation:  0.05642127990722656
r_  generation:  0.500037431716919
local_output_nid generation:  0.03696012496948242
local_in_edges_tensor generation:  0.03554487228393555
mini_batch_src_global generation:  0.05698823928833008
r_  generation:  0.4892759323120117
local_output_nid generation:  0.03687644004821777
local_in_edges_tensor generation:  0.03754615783691406
mini_batch_src_global generation:  0.05343437194824219
r_  generation:  0.5044991970062256
local_output_nid generation:  0.03678011894226074
local_in_edges_tensor generation:  0.03280949592590332
mini_batch_src_global generation:  0.05597829818725586
r_  generation:  0.48929643630981445
----------------------check_connections_block total spend ----------------------------- 5.844972610473633
generate_one_block  0.627971887588501
generate_one_block  0.61358642578125
generate_one_block  0.6146335601806641
generate_one_block  0.6163268089294434
generate_one_block  0.6071491241455078
generate_one_block  0.6171424388885498
generate_one_block  0.6224784851074219
generate_one_block  0.6194384098052979
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1299734115600586  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

connection checking time:  9.496159315109253
block generation total time  8.134974002838135
average batch blocks generation time:  1.0168717503547668
block dataloader generation time/epoch 19.40819568634033
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10108470916748047  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.8980011940002441  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10114431381225586  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9046778678894043  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10126304626464844  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.907322883605957  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10142946243286133  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9056916236877441  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10101652145385742  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9002237319946289  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10129117965698242  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9038753509521484  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10141372680664062  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.906609058380127  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10138368606567383  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9027047157287598  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07553330063819885 |0.016020357608795166 |0.0037376880645751953 |9.331107139587402e-05 |0.0037276148796081543 |0.0017900466918945312 |
----------------------------------------------------------pseudo_mini_loss sum 1.4551360607147217
Total (block generation + training)time/epoch 20.23891749382019
Training time/epoch 0.8650228977203369
Training time without block to device /epoch 0.7368600368499756
Training time without total dataloading part /epoch 0.06225895881652832
load block tensor time/epoch 0.6042664051055908
block to device time/epoch 0.12816286087036133
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 14 |
Number of nodes for computation during this epoch:  2956520
Number of first layer input nodes during this epoch:  1284267
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12943410873413086  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022602558135986328
random selection method range initialization spend 0.006256818771362305
time for parepare:  0.018721818923950195
local_output_nid generation:  0.004548788070678711
local_in_edges_tensor generation:  0.009337186813354492
mini_batch_src_global generation:  0.003038167953491211
r_  generation:  0.038818359375
local_output_nid generation:  0.005992889404296875
local_in_edges_tensor generation:  0.0034821033477783203
mini_batch_src_global generation:  0.004499197006225586
r_  generation:  0.04061126708984375
local_output_nid generation:  0.0060651302337646484
local_in_edges_tensor generation:  0.003512144088745117
mini_batch_src_global generation:  0.0030367374420166016
r_  generation:  0.04143786430358887
local_output_nid generation:  0.006094217300415039
local_in_edges_tensor generation:  0.0035963058471679688
mini_batch_src_global generation:  0.0030450820922851562
r_  generation:  0.04204297065734863
local_output_nid generation:  0.006108760833740234
local_in_edges_tensor generation:  0.003506183624267578
mini_batch_src_global generation:  0.003332376480102539
r_  generation:  0.04222297668457031
local_output_nid generation:  0.006061553955078125
local_in_edges_tensor generation:  0.0034749507904052734
mini_batch_src_global generation:  0.003424406051635742
r_  generation:  0.04359841346740723
local_output_nid generation:  0.006111860275268555
local_in_edges_tensor generation:  0.0034165382385253906
mini_batch_src_global generation:  0.0035085678100585938
r_  generation:  0.042058467864990234
local_output_nid generation:  0.006061553955078125
local_in_edges_tensor generation:  0.0035398006439208984
mini_batch_src_global generation:  0.0033872127532958984
r_  generation:  0.04300856590270996
----------------------check_connections_block total spend ----------------------------- 0.5418393611907959
generate_one_block  0.053372859954833984
generate_one_block  0.054491519927978516
generate_one_block  0.05492377281188965
generate_one_block  0.05445504188537598
generate_one_block  0.05485248565673828
generate_one_block  0.055799007415771484
generate_one_block  0.057794809341430664
generate_one_block  0.054779767990112305
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0349423885345459
gen group dst list time:  0.01490163803100586
time for parepare:  0.019234895706176758
local_output_nid generation:  0.013592958450317383
local_in_edges_tensor generation:  0.02752399444580078
mini_batch_src_global generation:  0.030582666397094727
r_  generation:  0.29541444778442383
local_output_nid generation:  0.01936793327331543
local_in_edges_tensor generation:  0.024580955505371094
mini_batch_src_global generation:  0.03676319122314453
r_  generation:  0.30857253074645996
local_output_nid generation:  0.019478559494018555
local_in_edges_tensor generation:  0.020550012588500977
mini_batch_src_global generation:  0.03696918487548828
r_  generation:  0.3111884593963623
local_output_nid generation:  0.018623828887939453
local_in_edges_tensor generation:  0.018059730529785156
mini_batch_src_global generation:  0.0359501838684082
r_  generation:  0.3083043098449707
local_output_nid generation:  0.019360065460205078
local_in_edges_tensor generation:  0.01884150505065918
mini_batch_src_global generation:  0.03709840774536133
r_  generation:  0.3117549419403076
local_output_nid generation:  0.019318580627441406
local_in_edges_tensor generation:  0.01822352409362793
mini_batch_src_global generation:  0.037653446197509766
r_  generation:  0.3159670829772949
local_output_nid generation:  0.018003225326538086
local_in_edges_tensor generation:  0.018504858016967773
mini_batch_src_global generation:  0.037741899490356445
r_  generation:  0.31209349632263184
local_output_nid generation:  0.0178682804107666
local_in_edges_tensor generation:  0.017621517181396484
mini_batch_src_global generation:  0.03862953186035156
r_  generation:  0.31770753860473633
----------------------check_connections_block total spend ----------------------------- 3.6260907649993896
generate_one_block  0.41181445121765137
generate_one_block  0.4030294418334961
generate_one_block  0.4158751964569092
generate_one_block  0.39461660385131836
generate_one_block  0.38935256004333496
generate_one_block  0.4003925323486328
generate_one_block  0.39098167419433594
generate_one_block  0.4188272953033447
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0350184440612793
gen group dst list time:  0.037801504135131836
time for parepare:  0.020500659942626953
local_output_nid generation:  0.029690980911254883
local_in_edges_tensor generation:  0.06385922431945801
mini_batch_src_global generation:  0.04356265068054199
r_  generation:  0.4870004653930664
local_output_nid generation:  0.03865790367126465
local_in_edges_tensor generation:  0.043527841567993164
mini_batch_src_global generation:  0.05490565299987793
r_  generation:  0.49039459228515625
local_output_nid generation:  0.036617279052734375
local_in_edges_tensor generation:  0.03989982604980469
mini_batch_src_global generation:  0.05112576484680176
r_  generation:  0.49536561965942383
local_output_nid generation:  0.03526663780212402
local_in_edges_tensor generation:  0.04998278617858887
mini_batch_src_global generation:  0.055960893630981445
r_  generation:  0.5083580017089844
local_output_nid generation:  0.03905606269836426
local_in_edges_tensor generation:  0.04009389877319336
mini_batch_src_global generation:  0.05735325813293457
r_  generation:  0.49947547912597656
local_output_nid generation:  0.03688216209411621
local_in_edges_tensor generation:  0.037503957748413086
mini_batch_src_global generation:  0.05680370330810547
r_  generation:  0.49028658866882324
local_output_nid generation:  0.036550283432006836
local_in_edges_tensor generation:  0.03728771209716797
mini_batch_src_global generation:  0.0527498722076416
r_  generation:  0.50248122215271
local_output_nid generation:  0.03656888008117676
local_in_edges_tensor generation:  0.03541731834411621
mini_batch_src_global generation:  0.055403947830200195
r_  generation:  0.4910092353820801
----------------------check_connections_block total spend ----------------------------- 5.914208173751831
generate_one_block  0.6273281574249268
generate_one_block  0.6155667304992676
generate_one_block  0.6108067035675049
generate_one_block  0.6073079109191895
generate_one_block  0.6044814586639404
generate_one_block  0.611792802810669
generate_one_block  0.6131985187530518
generate_one_block  0.6085326671600342
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12943410873413086  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

connection checking time:  9.54029893875122
block generation total time  8.123904705047607
average batch blocks generation time:  1.015488088130951
block dataloader generation time/epoch 19.43625597159068
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10109901428222656  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.902280330657959  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10117530822753906  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9028396606445312  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10134696960449219  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9054341316223145  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10109758377075195  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9029750823974609  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1010289192199707  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9024233818054199  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10141515731811523  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9087400436401367  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10105276107788086  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9027156829833984  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10116195678710938  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9018445014953613  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07318377494812012 |0.012969404458999634 |0.0036671459674835205 |9.414553642272949e-05 |0.0037358105182647705 |0.0015804767608642578 |
----------------------------------------------------------pseudo_mini_loss sum 1.4263755083084106
Total (block generation + training)time/epoch 20.264853318532307
Training time/epoch 0.8177073001861572
Training time without block to device /epoch 0.7139520645141602
Training time without total dataloading part /epoch 0.06155729293823242
load block tensor time/epoch 0.5854701995849609
block to device time/epoch 0.10375523567199707
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 15 |
Number of nodes for computation during this epoch:  2955536
Number of first layer input nodes during this epoch:  1283475
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12960052490234375  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.028369426727294922
random selection method range initialization spend 0.005629539489746094
time for parepare:  0.01704120635986328
local_output_nid generation:  0.004482746124267578
local_in_edges_tensor generation:  0.006227254867553711
mini_batch_src_global generation:  0.003061532974243164
r_  generation:  0.039229631423950195
local_output_nid generation:  0.006003856658935547
local_in_edges_tensor generation:  0.003334522247314453
mini_batch_src_global generation:  0.004370212554931641
r_  generation:  0.0394895076751709
local_output_nid generation:  0.006087303161621094
local_in_edges_tensor generation:  0.0034742355346679688
mini_batch_src_global generation:  0.00679469108581543
r_  generation:  0.04150199890136719
local_output_nid generation:  0.006181001663208008
local_in_edges_tensor generation:  0.003574848175048828
mini_batch_src_global generation:  0.0030546188354492188
r_  generation:  0.04175138473510742
local_output_nid generation:  0.00608062744140625
local_in_edges_tensor generation:  0.003486156463623047
mini_batch_src_global generation:  0.0033037662506103516
r_  generation:  0.04220890998840332
local_output_nid generation:  0.006098747253417969
local_in_edges_tensor generation:  0.0034961700439453125
mini_batch_src_global generation:  0.003361225128173828
r_  generation:  0.042290687561035156
local_output_nid generation:  0.006105661392211914
local_in_edges_tensor generation:  0.003392934799194336
mini_batch_src_global generation:  0.003545045852661133
r_  generation:  0.04335212707519531
local_output_nid generation:  0.0061414241790771484
local_in_edges_tensor generation:  0.0034186840057373047
mini_batch_src_global generation:  0.003434896469116211
r_  generation:  0.04338574409484863
----------------------check_connections_block total spend ----------------------------- 0.5409650802612305
generate_one_block  0.054284095764160156
generate_one_block  0.05499076843261719
generate_one_block  0.0554804801940918
generate_one_block  0.05475115776062012
generate_one_block  0.05486774444580078
generate_one_block  0.05525827407836914
generate_one_block  0.06053566932678223
generate_one_block  0.05598783493041992
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03788352012634277
gen group dst list time:  0.015102148056030273
time for parepare:  0.01982569694519043
local_output_nid generation:  0.014382362365722656
local_in_edges_tensor generation:  0.03264641761779785
mini_batch_src_global generation:  0.02963542938232422
r_  generation:  0.29499220848083496
local_output_nid generation:  0.019687175750732422
local_in_edges_tensor generation:  0.023312091827392578
mini_batch_src_global generation:  0.035439252853393555
r_  generation:  0.2986934185028076
local_output_nid generation:  0.01978611946105957
local_in_edges_tensor generation:  0.02017831802368164
mini_batch_src_global generation:  0.03647565841674805
r_  generation:  0.30663442611694336
local_output_nid generation:  0.01862788200378418
local_in_edges_tensor generation:  0.01906752586364746
mini_batch_src_global generation:  0.03577446937561035
r_  generation:  0.303943395614624
local_output_nid generation:  0.019570112228393555
local_in_edges_tensor generation:  0.02033400535583496
mini_batch_src_global generation:  0.03676748275756836
r_  generation:  0.3097877502441406
local_output_nid generation:  0.019191503524780273
local_in_edges_tensor generation:  0.019867897033691406
mini_batch_src_global generation:  0.0373687744140625
r_  generation:  0.3091769218444824
local_output_nid generation:  0.0184476375579834
local_in_edges_tensor generation:  0.02127361297607422
mini_batch_src_global generation:  0.03824162483215332
r_  generation:  0.3143188953399658
local_output_nid generation:  0.01850605010986328
local_in_edges_tensor generation:  0.020034074783325195
mini_batch_src_global generation:  0.037880659103393555
r_  generation:  0.3100416660308838
----------------------check_connections_block total spend ----------------------------- 3.604788064956665
generate_one_block  0.3945434093475342
generate_one_block  0.38982081413269043
generate_one_block  0.3942420482635498
generate_one_block  0.386826753616333
generate_one_block  0.38463544845581055
generate_one_block  0.3876042366027832
generate_one_block  0.39310431480407715
generate_one_block  0.41267967224121094
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02924180030822754
gen group dst list time:  0.03725743293762207
time for parepare:  0.019118785858154297
local_output_nid generation:  0.029425382614135742
local_in_edges_tensor generation:  0.04575538635253906
mini_batch_src_global generation:  0.04517388343811035
r_  generation:  0.4730558395385742
local_output_nid generation:  0.03568077087402344
local_in_edges_tensor generation:  0.03975415229797363
mini_batch_src_global generation:  0.05391836166381836
r_  generation:  0.4794578552246094
local_output_nid generation:  0.03549337387084961
local_in_edges_tensor generation:  0.03547835350036621
mini_batch_src_global generation:  0.05108213424682617
r_  generation:  0.49141931533813477
local_output_nid generation:  0.03539013862609863
local_in_edges_tensor generation:  0.03545689582824707
mini_batch_src_global generation:  0.05424809455871582
r_  generation:  0.48462367057800293
local_output_nid generation:  0.03552079200744629
local_in_edges_tensor generation:  0.033280134201049805
mini_batch_src_global generation:  0.05528593063354492
r_  generation:  0.49925661087036133
local_output_nid generation:  0.035513877868652344
local_in_edges_tensor generation:  0.034979820251464844
mini_batch_src_global generation:  0.05503225326538086
r_  generation:  0.48920488357543945
local_output_nid generation:  0.035613059997558594
local_in_edges_tensor generation:  0.03701019287109375
mini_batch_src_global generation:  0.053347110748291016
r_  generation:  0.5015029907226562
local_output_nid generation:  0.035672903060913086
local_in_edges_tensor generation:  0.03276419639587402
mini_batch_src_global generation:  0.05514836311340332
r_  generation:  0.4920511245727539
----------------------check_connections_block total spend ----------------------------- 5.786202669143677
generate_one_block  0.6034650802612305
generate_one_block  0.6048579216003418
generate_one_block  0.6052782535552979
generate_one_block  0.6037559509277344
generate_one_block  0.6106929779052734
generate_one_block  0.6070468425750732
generate_one_block  0.6155369281768799
generate_one_block  0.6103355884552002
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12960052490234375  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

connection checking time:  9.390990734100342
block generation total time  8.00442624092102
average batch blocks generation time:  1.0005532801151276
block dataloader generation time/epoch 19.4177086012704
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10123062133789062  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9078140258789062  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10111427307128906  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9042940139770508  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10126399993896484  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.905189037322998  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1011199951171875  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9022402763366699  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10105514526367188  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9021835327148438  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10142230987548828  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.901360034942627  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10123109817504883  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9037289619445801  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10129928588867188  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9035305976867676  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07661855220794678 |0.011689424514770508 |0.0041747987270355225 |0.00010228157043457031 |0.004252731800079346 |0.0017731189727783203 |
----------------------------------------------------------pseudo_mini_loss sum 1.4013878107070923
Total (block generation + training)time/epoch 20.249325888497488
Training time/epoch 0.8494694232940674
Training time without block to device /epoch 0.7559540271759033
Training time without total dataloading part /epoch 0.07001161575317383
load block tensor time/epoch 0.6129484176635742
block to device time/epoch 0.09351539611816406
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 16 |
Number of nodes for computation during this epoch:  2956507
Number of first layer input nodes during this epoch:  1283949
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12952947616577148  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.032495737075805664
random selection method range initialization spend 0.007018327713012695
time for parepare:  0.01969289779663086
local_output_nid generation:  0.004524707794189453
local_in_edges_tensor generation:  0.007092952728271484
mini_batch_src_global generation:  0.004148721694946289
r_  generation:  0.03970050811767578
local_output_nid generation:  0.005884885787963867
local_in_edges_tensor generation:  0.0034329891204833984
mini_batch_src_global generation:  0.004448413848876953
r_  generation:  0.04037284851074219
local_output_nid generation:  0.006040811538696289
local_in_edges_tensor generation:  0.0033996105194091797
mini_batch_src_global generation:  0.0030698776245117188
r_  generation:  0.04077458381652832
local_output_nid generation:  0.00609135627746582
local_in_edges_tensor generation:  0.003466367721557617
mini_batch_src_global generation:  0.003055095672607422
r_  generation:  0.04194998741149902
local_output_nid generation:  0.006136417388916016
local_in_edges_tensor generation:  0.0034737586975097656
mini_batch_src_global generation:  0.0032880306243896484
r_  generation:  0.05633997917175293
local_output_nid generation:  0.010812044143676758
local_in_edges_tensor generation:  0.004410505294799805
mini_batch_src_global generation:  0.007433891296386719
r_  generation:  0.04388856887817383
local_output_nid generation:  0.006512880325317383
local_in_edges_tensor generation:  0.0035469532012939453
mini_batch_src_global generation:  0.0034842491149902344
r_  generation:  0.0423123836517334
local_output_nid generation:  0.006311893463134766
local_in_edges_tensor generation:  0.0034821033477783203
mini_batch_src_global generation:  0.003461599349975586
r_  generation:  0.04266953468322754
----------------------check_connections_block total spend ----------------------------- 0.5739150047302246
generate_one_block  0.0535128116607666
generate_one_block  0.05522274971008301
generate_one_block  0.05441737174987793
generate_one_block  0.055115461349487305
generate_one_block  0.055510520935058594
generate_one_block  0.05557894706726074
generate_one_block  0.058357954025268555
generate_one_block  0.055707454681396484
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03305315971374512
gen group dst list time:  0.014576435089111328
time for parepare:  0.01917576789855957
local_output_nid generation:  0.013538599014282227
local_in_edges_tensor generation:  0.02784585952758789
mini_batch_src_global generation:  0.02905416488647461
r_  generation:  0.28630757331848145
local_output_nid generation:  0.019669532775878906
local_in_edges_tensor generation:  0.023703813552856445
mini_batch_src_global generation:  0.036657094955444336
r_  generation:  0.30635976791381836
local_output_nid generation:  0.01952672004699707
local_in_edges_tensor generation:  0.01946282386779785
mini_batch_src_global generation:  0.035056114196777344
r_  generation:  0.3129236698150635
local_output_nid generation:  0.018545866012573242
local_in_edges_tensor generation:  0.019718170166015625
mini_batch_src_global generation:  0.03756594657897949
r_  generation:  0.31574559211730957
local_output_nid generation:  0.019634008407592773
local_in_edges_tensor generation:  0.02058720588684082
mini_batch_src_global generation:  0.04056572914123535
r_  generation:  0.3200991153717041
local_output_nid generation:  0.018973112106323242
local_in_edges_tensor generation:  0.018280744552612305
mini_batch_src_global generation:  0.0394587516784668
r_  generation:  0.32097530364990234
local_output_nid generation:  0.019672393798828125
local_in_edges_tensor generation:  0.02686786651611328
mini_batch_src_global generation:  0.037610769271850586
r_  generation:  0.31832408905029297
local_output_nid generation:  0.01949930191040039
local_in_edges_tensor generation:  0.02357339859008789
mini_batch_src_global generation:  0.04180264472961426
r_  generation:  0.3320300579071045
----------------------check_connections_block total spend ----------------------------- 3.6924538612365723
generate_one_block  0.39501404762268066
generate_one_block  0.39397168159484863
generate_one_block  0.38790297508239746
generate_one_block  0.39462804794311523
generate_one_block  0.39612722396850586
generate_one_block  0.39217209815979004
generate_one_block  0.38331031799316406
generate_one_block  0.42529773712158203
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03599262237548828
gen group dst list time:  0.03783583641052246
time for parepare:  0.019153356552124023
local_output_nid generation:  0.029309988021850586
local_in_edges_tensor generation:  0.055845022201538086
mini_batch_src_global generation:  0.04632902145385742
r_  generation:  0.4704709053039551
local_output_nid generation:  0.03570127487182617
local_in_edges_tensor generation:  0.041193485260009766
mini_batch_src_global generation:  0.05449223518371582
r_  generation:  0.481090784072876
local_output_nid generation:  0.035684823989868164
local_in_edges_tensor generation:  0.03482675552368164
mini_batch_src_global generation:  0.051354169845581055
r_  generation:  0.5018808841705322
local_output_nid generation:  0.03543972969055176
local_in_edges_tensor generation:  0.03428339958190918
mini_batch_src_global generation:  0.05379509925842285
r_  generation:  0.493760347366333
local_output_nid generation:  0.03653740882873535
local_in_edges_tensor generation:  0.0448455810546875
mini_batch_src_global generation:  0.0534517765045166
r_  generation:  0.508392333984375
local_output_nid generation:  0.03594970703125
local_in_edges_tensor generation:  0.03648185729980469
mini_batch_src_global generation:  0.055634260177612305
r_  generation:  0.5024323463439941
local_output_nid generation:  0.041613101959228516
local_in_edges_tensor generation:  0.044603586196899414
mini_batch_src_global generation:  0.06697726249694824
r_  generation:  0.5018837451934814
local_output_nid generation:  0.03695368766784668
local_in_edges_tensor generation:  0.03683805465698242
mini_batch_src_global generation:  0.05589866638183594
r_  generation:  0.4914052486419678
----------------------check_connections_block total spend ----------------------------- 5.897468328475952
generate_one_block  0.6186692714691162
generate_one_block  0.6123683452606201
generate_one_block  0.6094636917114258
generate_one_block  0.6133134365081787
generate_one_block  0.6087296009063721
generate_one_block  0.6059916019439697
generate_one_block  0.6068472862243652
generate_one_block  0.6258869171142578
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12952947616577148  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

connection checking time:  9.589922189712524
block generation total time  8.06969428062439
average batch blocks generation time:  1.0087117850780487
block dataloader generation time/epoch 19.44645020365715
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1009521484375  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9013862609863281  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10162019729614258  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9079189300537109  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10108327865600586  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.902801513671875  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10142326354980469  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9032063484191895  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10128259658813477  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9063472747802734  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10129547119140625  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9028019905090332  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10120391845703125  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9005579948425293  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1013479232788086  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9070596694946289  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07867825031280518 |0.014976918697357178 |0.004117101430892944 |0.00010263919830322266 |0.0035788118839263916 |0.002147674560546875 |
----------------------------------------------------------pseudo_mini_loss sum 1.3696825504302979
Total (block generation + training)time/epoch 20.28520679473877
Training time/epoch 0.8884851932525635
Training time without block to device /epoch 0.768669843673706
Training time without total dataloading part /epoch 0.06453609466552734
load block tensor time/epoch 0.6294260025024414
block to device time/epoch 0.11981534957885742
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 17 |
Number of nodes for computation during this epoch:  2957265
Number of first layer input nodes during this epoch:  1284560
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12996912002563477  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02120232582092285
random selection method range initialization spend 0.005708456039428711
time for parepare:  0.017393112182617188
local_output_nid generation:  0.004498481750488281
local_in_edges_tensor generation:  0.006202220916748047
mini_batch_src_global generation:  0.003079652786254883
r_  generation:  0.03918004035949707
local_output_nid generation:  0.005886554718017578
local_in_edges_tensor generation:  0.0032138824462890625
mini_batch_src_global generation:  0.004463672637939453
r_  generation:  0.04056739807128906
local_output_nid generation:  0.006064176559448242
local_in_edges_tensor generation:  0.0033020973205566406
mini_batch_src_global generation:  0.0030641555786132812
r_  generation:  0.04108476638793945
local_output_nid generation:  0.006151914596557617
local_in_edges_tensor generation:  0.0031659603118896484
mini_batch_src_global generation:  0.003011941909790039
r_  generation:  0.041336774826049805
local_output_nid generation:  0.006089687347412109
local_in_edges_tensor generation:  0.0033254623413085938
mini_batch_src_global generation:  0.0031566619873046875
r_  generation:  0.041787147521972656
local_output_nid generation:  0.0061533451080322266
local_in_edges_tensor generation:  0.0033311843872070312
mini_batch_src_global generation:  0.003317594528198242
r_  generation:  0.04285717010498047
local_output_nid generation:  0.006093502044677734
local_in_edges_tensor generation:  0.003261566162109375
mini_batch_src_global generation:  0.0034263134002685547
r_  generation:  0.04312467575073242
local_output_nid generation:  0.0060389041900634766
local_in_edges_tensor generation:  0.003187894821166992
mini_batch_src_global generation:  0.0033979415893554688
r_  generation:  0.04359006881713867
----------------------check_connections_block total spend ----------------------------- 0.5343351364135742
generate_one_block  0.05448722839355469
generate_one_block  0.054604291915893555
generate_one_block  0.05485701560974121
generate_one_block  0.05455493927001953
generate_one_block  0.05436420440673828
generate_one_block  0.05504608154296875
generate_one_block  0.05931258201599121
generate_one_block  0.05565619468688965
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03340339660644531
gen group dst list time:  0.014634847640991211
time for parepare:  0.01970958709716797
local_output_nid generation:  0.01415872573852539
local_in_edges_tensor generation:  0.02925419807434082
mini_batch_src_global generation:  0.03034043312072754
r_  generation:  0.2990694046020508
local_output_nid generation:  0.01980280876159668
local_in_edges_tensor generation:  0.022546052932739258
mini_batch_src_global generation:  0.04067516326904297
r_  generation:  0.30624866485595703
local_output_nid generation:  0.01968216896057129
local_in_edges_tensor generation:  0.022800922393798828
mini_batch_src_global generation:  0.03738260269165039
r_  generation:  0.32805824279785156
local_output_nid generation:  0.02417302131652832
local_in_edges_tensor generation:  0.02646017074584961
mini_batch_src_global generation:  0.036864519119262695
r_  generation:  0.3056366443634033
local_output_nid generation:  0.020343780517578125
local_in_edges_tensor generation:  0.017718076705932617
mini_batch_src_global generation:  0.036843061447143555
r_  generation:  0.3073873519897461
local_output_nid generation:  0.020066499710083008
local_in_edges_tensor generation:  0.02059650421142578
mini_batch_src_global generation:  0.03865528106689453
r_  generation:  0.31095337867736816
local_output_nid generation:  0.018652677536010742
local_in_edges_tensor generation:  0.017853736877441406
mini_batch_src_global generation:  0.03799843788146973
r_  generation:  0.3092825412750244
local_output_nid generation:  0.018753528594970703
local_in_edges_tensor generation:  0.019489526748657227
mini_batch_src_global generation:  0.039298295974731445
r_  generation:  0.3164339065551758
----------------------check_connections_block total spend ----------------------------- 3.6640706062316895
generate_one_block  0.40547633171081543
generate_one_block  0.38927555084228516
generate_one_block  0.39150190353393555
generate_one_block  0.392897367477417
generate_one_block  0.3842177391052246
generate_one_block  0.39209556579589844
generate_one_block  0.38941264152526855
generate_one_block  0.42261338233947754
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03197813034057617
gen group dst list time:  0.03849601745605469
time for parepare:  0.019281864166259766
local_output_nid generation:  0.029650211334228516
local_in_edges_tensor generation:  0.05643010139465332
mini_batch_src_global generation:  0.04410982131958008
r_  generation:  0.4766838550567627
local_output_nid generation:  0.035166025161743164
local_in_edges_tensor generation:  0.0420079231262207
mini_batch_src_global generation:  0.05391216278076172
r_  generation:  0.4863088130950928
local_output_nid generation:  0.035959720611572266
local_in_edges_tensor generation:  0.035852909088134766
mini_batch_src_global generation:  0.04983258247375488
r_  generation:  0.4980428218841553
local_output_nid generation:  0.036667823791503906
local_in_edges_tensor generation:  0.03767728805541992
mini_batch_src_global generation:  0.05794334411621094
r_  generation:  0.48708081245422363
local_output_nid generation:  0.03578996658325195
local_in_edges_tensor generation:  0.0375058650970459
mini_batch_src_global generation:  0.05271482467651367
r_  generation:  0.499739408493042
local_output_nid generation:  0.035440683364868164
local_in_edges_tensor generation:  0.038314104080200195
mini_batch_src_global generation:  0.05569958686828613
r_  generation:  0.48883581161499023
local_output_nid generation:  0.035897016525268555
local_in_edges_tensor generation:  0.03532910346984863
mini_batch_src_global generation:  0.05365443229675293
r_  generation:  0.5070886611938477
local_output_nid generation:  0.03574967384338379
local_in_edges_tensor generation:  0.03999662399291992
mini_batch_src_global generation:  0.05636310577392578
r_  generation:  0.5106947422027588
----------------------check_connections_block total spend ----------------------------- 5.875579833984375
generate_one_block  0.6194710731506348
generate_one_block  0.6117286682128906
generate_one_block  0.6095480918884277
generate_one_block  0.6110985279083252
generate_one_block  0.6107332706451416
generate_one_block  0.6166598796844482
generate_one_block  0.6219303607940674
generate_one_block  0.612288236618042
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12996912002563477  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

connection checking time:  9.539650440216064
block generation total time  8.0809485912323
average batch blocks generation time:  1.0101185739040375
block dataloader generation time/epoch 19.454537206225925
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1015162467956543  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9125552177429199  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10194683074951172  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9021234512329102  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10151147842407227  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.906196117401123  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10133934020996094  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9027347564697266  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10127592086791992  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9034519195556641  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10140800476074219  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9042263031005859  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10107612609863281  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9015026092529297  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1012425422668457  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9042091369628906  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07166233658790588 |0.013552248477935791 |0.0036773383617401123 |9.384751319885254e-05 |0.0035099685192108154 |0.001415252685546875 |
----------------------------------------------------------pseudo_mini_loss sum 1.3470832109451294
Total (block generation + training)time/epoch 20.291031546062893
Training time/epoch 0.8181660175323486
Training time without block to device /epoch 0.7097480297088623
Training time without total dataloading part /epoch 0.05966448783874512
load block tensor time/epoch 0.5732986927032471
block to device time/epoch 0.10841798782348633
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 18 |
Number of nodes for computation during this epoch:  2957434
Number of first layer input nodes during this epoch:  1284334
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.129913330078125  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02066636085510254
random selection method range initialization spend 0.005949497222900391
time for parepare:  0.01916027069091797
local_output_nid generation:  0.004832744598388672
local_in_edges_tensor generation:  0.008636951446533203
mini_batch_src_global generation:  0.0035321712493896484
r_  generation:  0.03999209403991699
local_output_nid generation:  0.0059642791748046875
local_in_edges_tensor generation:  0.0036079883575439453
mini_batch_src_global generation:  0.004244089126586914
r_  generation:  0.04006481170654297
local_output_nid generation:  0.006101131439208984
local_in_edges_tensor generation:  0.003337383270263672
mini_batch_src_global generation:  0.0031707286834716797
r_  generation:  0.04256391525268555
local_output_nid generation:  0.006114482879638672
local_in_edges_tensor generation:  0.0032434463500976562
mini_batch_src_global generation:  0.003154277801513672
r_  generation:  0.04167342185974121
local_output_nid generation:  0.006112337112426758
local_in_edges_tensor generation:  0.0032711029052734375
mini_batch_src_global generation:  0.003360748291015625
r_  generation:  0.042938947677612305
local_output_nid generation:  0.006128787994384766
local_in_edges_tensor generation:  0.0032722949981689453
mini_batch_src_global generation:  0.003578662872314453
r_  generation:  0.04373049736022949
local_output_nid generation:  0.0060884952545166016
local_in_edges_tensor generation:  0.003283262252807617
mini_batch_src_global generation:  0.0036554336547851562
r_  generation:  0.04335737228393555
local_output_nid generation:  0.0061681270599365234
local_in_edges_tensor generation:  0.003232717514038086
mini_batch_src_global generation:  0.0034983158111572266
r_  generation:  0.043356895446777344
----------------------check_connections_block total spend ----------------------------- 0.5454885959625244
generate_one_block  0.05315732955932617
generate_one_block  0.05425524711608887
generate_one_block  0.05521106719970703
generate_one_block  0.054984092712402344
generate_one_block  0.054665327072143555
generate_one_block  0.05716538429260254
generate_one_block  0.058484792709350586
generate_one_block  0.05589151382446289
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03465127944946289
gen group dst list time:  0.01433253288269043
time for parepare:  0.019854307174682617
local_output_nid generation:  0.01362466812133789
local_in_edges_tensor generation:  0.028447628021240234
mini_batch_src_global generation:  0.02907872200012207
r_  generation:  0.2865474224090576
local_output_nid generation:  0.01928257942199707
local_in_edges_tensor generation:  0.02391219139099121
mini_batch_src_global generation:  0.035161495208740234
r_  generation:  0.2973752021789551
local_output_nid generation:  0.019320249557495117
local_in_edges_tensor generation:  0.020320653915405273
mini_batch_src_global generation:  0.03694796562194824
r_  generation:  0.3084428310394287
local_output_nid generation:  0.01860189437866211
local_in_edges_tensor generation:  0.019232749938964844
mini_batch_src_global generation:  0.036414384841918945
r_  generation:  0.3133571147918701
local_output_nid generation:  0.01929020881652832
local_in_edges_tensor generation:  0.017908573150634766
mini_batch_src_global generation:  0.037273406982421875
r_  generation:  0.31230998039245605
local_output_nid generation:  0.019638538360595703
local_in_edges_tensor generation:  0.020831584930419922
mini_batch_src_global generation:  0.040174007415771484
r_  generation:  0.3182802200317383
local_output_nid generation:  0.019736528396606445
local_in_edges_tensor generation:  0.018312692642211914
mini_batch_src_global generation:  0.038095951080322266
r_  generation:  0.31525206565856934
local_output_nid generation:  0.018328428268432617
local_in_edges_tensor generation:  0.017851829528808594
mini_batch_src_global generation:  0.03898811340332031
r_  generation:  0.31902122497558594
----------------------check_connections_block total spend ----------------------------- 3.6261186599731445
generate_one_block  0.39617443084716797
generate_one_block  0.3996720314025879
generate_one_block  0.3995945453643799
generate_one_block  0.40668225288391113
generate_one_block  0.39330172538757324
generate_one_block  0.41136956214904785
generate_one_block  0.38909268379211426
generate_one_block  0.430004358291626
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03168773651123047
gen group dst list time:  0.038388967514038086
time for parepare:  0.020920991897583008
local_output_nid generation:  0.02963852882385254
local_in_edges_tensor generation:  0.05767512321472168
mini_batch_src_global generation:  0.046315670013427734
r_  generation:  0.4815099239349365
local_output_nid generation:  0.0360870361328125
local_in_edges_tensor generation:  0.042169809341430664
mini_batch_src_global generation:  0.053914546966552734
r_  generation:  0.4840269088745117
local_output_nid generation:  0.03576231002807617
local_in_edges_tensor generation:  0.035570383071899414
mini_batch_src_global generation:  0.051596879959106445
r_  generation:  0.4967992305755615
local_output_nid generation:  0.0352482795715332
local_in_edges_tensor generation:  0.040407657623291016
mini_batch_src_global generation:  0.05453085899353027
r_  generation:  0.49117374420166016
local_output_nid generation:  0.03507518768310547
local_in_edges_tensor generation:  0.03359532356262207
mini_batch_src_global generation:  0.052956581115722656
r_  generation:  0.49977540969848633
local_output_nid generation:  0.035605430603027344
local_in_edges_tensor generation:  0.035805463790893555
mini_batch_src_global generation:  0.05705118179321289
r_  generation:  0.49300646781921387
local_output_nid generation:  0.03556966781616211
local_in_edges_tensor generation:  0.0339968204498291
mini_batch_src_global generation:  0.05382847785949707
r_  generation:  0.5160317420959473
local_output_nid generation:  0.035868167877197266
local_in_edges_tensor generation:  0.033400535583496094
mini_batch_src_global generation:  0.05685091018676758
r_  generation:  0.4962637424468994
----------------------check_connections_block total spend ----------------------------- 5.860721588134766
generate_one_block  0.6176526546478271
generate_one_block  0.6140601634979248
generate_one_block  0.6113715171813965
generate_one_block  0.6204407215118408
generate_one_block  0.6173491477966309
generate_one_block  0.620337963104248
generate_one_block  0.6124565601348877
generate_one_block  0.6094260215759277
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.129913330078125  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

connection checking time:  9.48684024810791
block generation total time  8.148986339569092
average batch blocks generation time:  1.0186232924461365
block dataloader generation time/epoch 19.46672613620758
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10105037689208984  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.901519775390625  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1010890007019043  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9030447006225586  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10123634338378906  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.905764102935791  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1014857292175293  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9057855606079102  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10113811492919922  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9014272689819336  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10126066207885742  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9111156463623047  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10117673873901367  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9014444351196289  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10123872756958008  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.905052661895752  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07732149958610535 |0.014477044343948364 |0.0036780834197998047 |9.223818778991699e-05 |0.003716111183166504 |0.0014691352844238281 |
----------------------------------------------------------pseudo_mini_loss sum 1.3403536081314087
Total (block generation + training)time/epoch 20.305866861343382
Training time/epoch 0.8626997470855713
Training time without block to device /epoch 0.7468833923339844
Training time without total dataloading part /epoch 0.06136059761047363
load block tensor time/epoch 0.6185719966888428
block to device time/epoch 0.11581635475158691
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 19 |
Number of nodes for computation during this epoch:  2956935
Number of first layer input nodes during this epoch:  1283875
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12984848022460938  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.12050271034240723
random selection method range initialization spend 0.007239818572998047
time for parepare:  0.018349170684814453
local_output_nid generation:  0.004421234130859375
local_in_edges_tensor generation:  0.007995128631591797
mini_batch_src_global generation:  0.002961397171020508
r_  generation:  0.04099869728088379
local_output_nid generation:  0.006079673767089844
local_in_edges_tensor generation:  0.0031921863555908203
mini_batch_src_global generation:  0.004404544830322266
r_  generation:  0.040999412536621094
local_output_nid generation:  0.006106853485107422
local_in_edges_tensor generation:  0.003247499465942383
mini_batch_src_global generation:  0.0031805038452148438
r_  generation:  0.04164767265319824
local_output_nid generation:  0.007605075836181641
local_in_edges_tensor generation:  0.003272533416748047
mini_batch_src_global generation:  0.003075838088989258
r_  generation:  0.04266858100891113
local_output_nid generation:  0.006079912185668945
local_in_edges_tensor generation:  0.0032558441162109375
mini_batch_src_global generation:  0.0034952163696289062
r_  generation:  0.04456448554992676
local_output_nid generation:  0.006085872650146484
local_in_edges_tensor generation:  0.003244161605834961
mini_batch_src_global generation:  0.0034227371215820312
r_  generation:  0.04284238815307617
local_output_nid generation:  0.006080150604248047
local_in_edges_tensor generation:  0.0031385421752929688
mini_batch_src_global generation:  0.003614187240600586
r_  generation:  0.04294395446777344
local_output_nid generation:  0.006240129470825195
local_in_edges_tensor generation:  0.0032384395599365234
mini_batch_src_global generation:  0.0036182403564453125
r_  generation:  0.04495668411254883
----------------------check_connections_block total spend ----------------------------- 0.550147294998169
generate_one_block  0.05805516242980957
generate_one_block  0.05716872215270996
generate_one_block  0.05557084083557129
generate_one_block  0.058257341384887695
generate_one_block  0.055500030517578125
generate_one_block  0.05620145797729492
generate_one_block  0.05844712257385254
generate_one_block  0.05691266059875488
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0371701717376709
gen group dst list time:  0.014988422393798828
time for parepare:  0.020970821380615234
local_output_nid generation:  0.014356136322021484
local_in_edges_tensor generation:  0.02894759178161621
mini_batch_src_global generation:  0.03126263618469238
r_  generation:  0.301088809967041
local_output_nid generation:  0.019631624221801758
local_in_edges_tensor generation:  0.02665996551513672
mini_batch_src_global generation:  0.040694475173950195
r_  generation:  0.32715821266174316
local_output_nid generation:  0.022656679153442383
local_in_edges_tensor generation:  0.021586894989013672
mini_batch_src_global generation:  0.03588223457336426
r_  generation:  0.31037402153015137
local_output_nid generation:  0.019232988357543945
local_in_edges_tensor generation:  0.01938033103942871
mini_batch_src_global generation:  0.03608345985412598
r_  generation:  0.3080594539642334
local_output_nid generation:  0.019774198532104492
local_in_edges_tensor generation:  0.019620180130004883
mini_batch_src_global generation:  0.03732180595397949
r_  generation:  0.3133978843688965
local_output_nid generation:  0.019945859909057617
local_in_edges_tensor generation:  0.019247055053710938
mini_batch_src_global generation:  0.03726816177368164
r_  generation:  0.3117210865020752
local_output_nid generation:  0.018985986709594727
local_in_edges_tensor generation:  0.02037525177001953
mini_batch_src_global generation:  0.03749203681945801
r_  generation:  0.31209874153137207
local_output_nid generation:  0.01864767074584961
local_in_edges_tensor generation:  0.019145488739013672
mini_batch_src_global generation:  0.0373835563659668
r_  generation:  0.30718517303466797
----------------------check_connections_block total spend ----------------------------- 3.6589484214782715
generate_one_block  0.4117558002471924
generate_one_block  0.40680599212646484
generate_one_block  0.399017333984375
generate_one_block  0.396759033203125
generate_one_block  0.3942277431488037
generate_one_block  0.39748048782348633
generate_one_block  0.4051806926727295
generate_one_block  0.4177870750427246
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03492999076843262
gen group dst list time:  0.03876543045043945
time for parepare:  0.020020723342895508
local_output_nid generation:  0.03062272071838379
local_in_edges_tensor generation:  0.05866575241088867
mini_batch_src_global generation:  0.04384493827819824
r_  generation:  0.473416805267334
local_output_nid generation:  0.03557777404785156
local_in_edges_tensor generation:  0.03963875770568848
mini_batch_src_global generation:  0.05389213562011719
r_  generation:  0.4804251194000244
local_output_nid generation:  0.036026954650878906
local_in_edges_tensor generation:  0.03489494323730469
mini_batch_src_global generation:  0.05070924758911133
r_  generation:  0.49055910110473633
local_output_nid generation:  0.03599071502685547
local_in_edges_tensor generation:  0.034673213958740234
mini_batch_src_global generation:  0.05463409423828125
r_  generation:  0.48769474029541016
local_output_nid generation:  0.0360417366027832
local_in_edges_tensor generation:  0.03482222557067871
mini_batch_src_global generation:  0.05256175994873047
r_  generation:  0.4979875087738037
local_output_nid generation:  0.036144256591796875
local_in_edges_tensor generation:  0.03287220001220703
mini_batch_src_global generation:  0.05701088905334473
r_  generation:  0.49225425720214844
local_output_nid generation:  0.03725838661193848
local_in_edges_tensor generation:  0.035945892333984375
mini_batch_src_global generation:  0.05448651313781738
r_  generation:  0.5046861171722412
local_output_nid generation:  0.03781771659851074
local_in_edges_tensor generation:  0.0414884090423584
mini_batch_src_global generation:  0.05527019500732422
r_  generation:  0.490478515625
----------------------check_connections_block total spend ----------------------------- 5.830264091491699
generate_one_block  0.6164979934692383
generate_one_block  0.6187648773193359
generate_one_block  0.628101110458374
generate_one_block  0.6085081100463867
generate_one_block  0.6108124256134033
generate_one_block  0.6155397891998291
generate_one_block  0.6190948486328125
generate_one_block  0.6169865131378174
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12984848022460938  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

connection checking time:  9.48921251296997
block generation total time  8.163319826126099
average batch blocks generation time:  1.0204149782657623
block dataloader generation time/epoch 19.488438021052968
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10126781463623047  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9068522453308105  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1012420654296875  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9042844772338867  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1011667251586914  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9037222862243652  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1011667251586914  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.903907299041748  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10119819641113281  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9022336006164551  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10107135772705078  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9024367332458496  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10130977630615234  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9050073623657227  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10126924514770508  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9026060104370117  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0774746835231781 |0.015336215496063232 |0.004063844680786133 |9.98377799987793e-05 |0.0035875141620635986 |0.0029256343841552734 |
----------------------------------------------------------pseudo_mini_loss sum 1.3293040990829468
Total (block generation + training)time/epoch 20.33126915584911
Training time/epoch 0.8794670104980469
Training time without block to device /epoch 0.756777286529541
Training time without total dataloading part /epoch 0.06493520736694336
load block tensor time/epoch 0.6197974681854248
block to device time/epoch 0.12268972396850586
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 20 |
Number of nodes for computation during this epoch:  2956856
Number of first layer input nodes during this epoch:  1284491
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12956666946411133  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03047633171081543
random selection method range initialization spend 0.005357027053833008
time for parepare:  0.018326759338378906
local_output_nid generation:  0.0045397281646728516
local_in_edges_tensor generation:  0.008623361587524414
mini_batch_src_global generation:  0.002986907958984375
r_  generation:  0.0413210391998291
local_output_nid generation:  0.005975008010864258
local_in_edges_tensor generation:  0.0032432079315185547
mini_batch_src_global generation:  0.004590034484863281
r_  generation:  0.04085087776184082
local_output_nid generation:  0.006100893020629883
local_in_edges_tensor generation:  0.0032656192779541016
mini_batch_src_global generation:  0.003135204315185547
r_  generation:  0.04149985313415527
local_output_nid generation:  0.0062634944915771484
local_in_edges_tensor generation:  0.0032880306243896484
mini_batch_src_global generation:  0.002996206283569336
r_  generation:  0.041614532470703125
local_output_nid generation:  0.006159067153930664
local_in_edges_tensor generation:  0.004631996154785156
mini_batch_src_global generation:  0.0032684803009033203
r_  generation:  0.042494773864746094
local_output_nid generation:  0.006127834320068359
local_in_edges_tensor generation:  0.003237485885620117
mini_batch_src_global generation:  0.0034809112548828125
r_  generation:  0.04577350616455078
local_output_nid generation:  0.006100893020629883
local_in_edges_tensor generation:  0.003387928009033203
mini_batch_src_global generation:  0.008239269256591797
r_  generation:  0.04332232475280762
local_output_nid generation:  0.006199359893798828
local_in_edges_tensor generation:  0.003186941146850586
mini_batch_src_global generation:  0.0034723281860351562
r_  generation:  0.042672157287597656
----------------------check_connections_block total spend ----------------------------- 0.5517923831939697
generate_one_block  0.05393648147583008
generate_one_block  0.05494832992553711
generate_one_block  0.05697321891784668
generate_one_block  0.05507826805114746
generate_one_block  0.05801987648010254
generate_one_block  0.056136131286621094
generate_one_block  0.06436300277709961
generate_one_block  0.055069684982299805
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03625965118408203
gen group dst list time:  0.016822338104248047
time for parepare:  0.023090600967407227
local_output_nid generation:  0.014005184173583984
local_in_edges_tensor generation:  0.034584760665893555
mini_batch_src_global generation:  0.029644012451171875
r_  generation:  0.29100680351257324
local_output_nid generation:  0.0193634033203125
local_in_edges_tensor generation:  0.024787187576293945
mini_batch_src_global generation:  0.03857922554016113
r_  generation:  0.3092072010040283
local_output_nid generation:  0.019586801528930664
local_in_edges_tensor generation:  0.019807100296020508
mini_batch_src_global generation:  0.03633999824523926
r_  generation:  0.3055996894836426
local_output_nid generation:  0.018594026565551758
local_in_edges_tensor generation:  0.019902467727661133
mini_batch_src_global generation:  0.036072492599487305
r_  generation:  0.3081941604614258
local_output_nid generation:  0.01953411102294922
local_in_edges_tensor generation:  0.01923990249633789
mini_batch_src_global generation:  0.037407875061035156
r_  generation:  0.31041455268859863
local_output_nid generation:  0.019410371780395508
local_in_edges_tensor generation:  0.01945781707763672
mini_batch_src_global generation:  0.03885197639465332
r_  generation:  0.3198528289794922
local_output_nid generation:  0.018266916275024414
local_in_edges_tensor generation:  0.019253969192504883
mini_batch_src_global generation:  0.039154052734375
r_  generation:  0.31509923934936523
local_output_nid generation:  0.02733159065246582
local_in_edges_tensor generation:  0.018410205841064453
mini_batch_src_global generation:  0.03734016418457031
r_  generation:  0.31647658348083496
----------------------check_connections_block total spend ----------------------------- 3.6662521362304688
generate_one_block  0.41146039962768555
generate_one_block  0.4151296615600586
generate_one_block  0.3889901638031006
generate_one_block  0.38965845108032227
generate_one_block  0.39038515090942383
generate_one_block  0.39513444900512695
generate_one_block  0.39437198638916016
generate_one_block  0.41298699378967285
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03632354736328125
gen group dst list time:  0.0381472110748291
time for parepare:  0.01879143714904785
local_output_nid generation:  0.02983379364013672
local_in_edges_tensor generation:  0.05332350730895996
mini_batch_src_global generation:  0.045648813247680664
r_  generation:  0.4865150451660156
local_output_nid generation:  0.03558921813964844
local_in_edges_tensor generation:  0.040036916732788086
mini_batch_src_global generation:  0.054628610610961914
r_  generation:  0.4926619529724121
local_output_nid generation:  0.036948204040527344
local_in_edges_tensor generation:  0.037384748458862305
mini_batch_src_global generation:  0.05343770980834961
r_  generation:  0.4959452152252197
local_output_nid generation:  0.03571486473083496
local_in_edges_tensor generation:  0.044083595275878906
mini_batch_src_global generation:  0.05484366416931152
r_  generation:  0.5116405487060547
local_output_nid generation:  0.03922224044799805
local_in_edges_tensor generation:  0.04201650619506836
mini_batch_src_global generation:  0.05855298042297363
r_  generation:  0.4971141815185547
local_output_nid generation:  0.03668355941772461
local_in_edges_tensor generation:  0.03753662109375
mini_batch_src_global generation:  0.05504179000854492
r_  generation:  0.49241161346435547
local_output_nid generation:  0.03663492202758789
local_in_edges_tensor generation:  0.036821842193603516
mini_batch_src_global generation:  0.05501079559326172
r_  generation:  0.4987008571624756
local_output_nid generation:  0.036881446838378906
local_in_edges_tensor generation:  0.03469562530517578
mini_batch_src_global generation:  0.05507707595825195
r_  generation:  0.49662041664123535
----------------------check_connections_block total spend ----------------------------- 5.905189514160156
generate_one_block  0.6297376155853271
generate_one_block  0.6174287796020508
generate_one_block  0.6150760650634766
generate_one_block  0.605370283126831
generate_one_block  0.6126754283905029
generate_one_block  0.6097948551177979
generate_one_block  0.6152982711791992
generate_one_block  0.6079487800598145
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12956666946411133  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

connection checking time:  9.571441650390625
block generation total time  8.11144733428955
average batch blocks generation time:  1.0139309167861938
block dataloader generation time/epoch 19.502456188201904
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10127973556518555  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9027543067932129  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10125207901000977  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9040117263793945  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1012730598449707  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9051361083984375  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1012716293334961  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9032649993896484  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10127544403076172  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9051313400268555  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1019601821899414  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.906883716583252  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10116434097290039  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9034619331359863  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10110998153686523  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9023103713989258  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07390224933624268 |0.014009237289428711 |0.003617316484451294 |9.274482727050781e-05 |0.0035100579261779785 |0.002930164337158203 |
----------------------------------------------------------pseudo_mini_loss sum 1.3109726905822754
Total (block generation + training)time/epoch 20.344666838645935
Training time/epoch 0.8351294994354248
Training time without block to device /epoch 0.7230556011199951
Training time without total dataloading part /epoch 0.060691118240356445
load block tensor time/epoch 0.5912179946899414
block to device time/epoch 0.11207389831542969
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 21 |
Number of nodes for computation during this epoch:  2957851
Number of first layer input nodes during this epoch:  1284386
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12982892990112305  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02073192596435547
random selection method range initialization spend 0.005591869354248047
time for parepare:  0.01904153823852539
local_output_nid generation:  0.004445075988769531
local_in_edges_tensor generation:  0.006490468978881836
mini_batch_src_global generation:  0.003647327423095703
r_  generation:  0.039063215255737305
local_output_nid generation:  0.005853414535522461
local_in_edges_tensor generation:  0.0031664371490478516
mini_batch_src_global generation:  0.0042760372161865234
r_  generation:  0.03984570503234863
local_output_nid generation:  0.005986690521240234
local_in_edges_tensor generation:  0.003231525421142578
mini_batch_src_global generation:  0.003140687942504883
r_  generation:  0.04084014892578125
local_output_nid generation:  0.006061553955078125
local_in_edges_tensor generation:  0.0031099319458007812
mini_batch_src_global generation:  0.0029544830322265625
r_  generation:  0.041725873947143555
local_output_nid generation:  0.006072998046875
local_in_edges_tensor generation:  0.003208160400390625
mini_batch_src_global generation:  0.003321409225463867
r_  generation:  0.04187726974487305
local_output_nid generation:  0.0060100555419921875
local_in_edges_tensor generation:  0.0030639171600341797
mini_batch_src_global generation:  0.003389120101928711
r_  generation:  0.041724205017089844
local_output_nid generation:  0.006052970886230469
local_in_edges_tensor generation:  0.003260374069213867
mini_batch_src_global generation:  0.003501415252685547
r_  generation:  0.04200911521911621
local_output_nid generation:  0.006047487258911133
local_in_edges_tensor generation:  0.0031266212463378906
mini_batch_src_global generation:  0.003440380096435547
r_  generation:  0.04261374473571777
----------------------check_connections_block total spend ----------------------------- 0.5319106578826904
generate_one_block  0.0531003475189209
generate_one_block  0.054595947265625
generate_one_block  0.05464363098144531
generate_one_block  0.05442357063293457
generate_one_block  0.05460166931152344
generate_one_block  0.05395340919494629
generate_one_block  0.05778861045837402
generate_one_block  0.05580854415893555
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.032949209213256836
gen group dst list time:  0.014287710189819336
time for parepare:  0.019311189651489258
local_output_nid generation:  0.01335000991821289
local_in_edges_tensor generation:  0.027621984481811523
mini_batch_src_global generation:  0.029387474060058594
r_  generation:  0.2858603000640869
local_output_nid generation:  0.019087791442871094
local_in_edges_tensor generation:  0.0233614444732666
mini_batch_src_global generation:  0.036561012268066406
r_  generation:  0.2995889186859131
local_output_nid generation:  0.019078969955444336
local_in_edges_tensor generation:  0.017955303192138672
mini_batch_src_global generation:  0.03541994094848633
r_  generation:  0.3046383857727051
local_output_nid generation:  0.01851940155029297
local_in_edges_tensor generation:  0.01953434944152832
mini_batch_src_global generation:  0.03731942176818848
r_  generation:  0.30718159675598145
local_output_nid generation:  0.019181251525878906
local_in_edges_tensor generation:  0.020056486129760742
mini_batch_src_global generation:  0.036908864974975586
r_  generation:  0.31377100944519043
local_output_nid generation:  0.019308805465698242
local_in_edges_tensor generation:  0.01840806007385254
mini_batch_src_global generation:  0.03683590888977051
r_  generation:  0.31282711029052734
local_output_nid generation:  0.0179901123046875
local_in_edges_tensor generation:  0.018049001693725586
mini_batch_src_global generation:  0.03731250762939453
r_  generation:  0.31412792205810547
local_output_nid generation:  0.018206119537353516
local_in_edges_tensor generation:  0.021188020706176758
mini_batch_src_global generation:  0.03953289985656738
r_  generation:  0.32011866569519043
----------------------check_connections_block total spend ----------------------------- 3.6042141914367676
generate_one_block  0.4133622646331787
generate_one_block  0.40530824661254883
generate_one_block  0.39198756217956543
generate_one_block  0.3951070308685303
generate_one_block  0.396759033203125
generate_one_block  0.39040303230285645
generate_one_block  0.38679027557373047
generate_one_block  0.4205608367919922
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03794264793395996
gen group dst list time:  0.03844141960144043
time for parepare:  0.019823074340820312
local_output_nid generation:  0.029684066772460938
local_in_edges_tensor generation:  0.05959367752075195
mini_batch_src_global generation:  0.045229196548461914
r_  generation:  0.47393012046813965
local_output_nid generation:  0.03601670265197754
local_in_edges_tensor generation:  0.03828263282775879
mini_batch_src_global generation:  0.05625605583190918
r_  generation:  0.4819796085357666
local_output_nid generation:  0.0349278450012207
local_in_edges_tensor generation:  0.038983821868896484
mini_batch_src_global generation:  0.050769805908203125
r_  generation:  0.5011942386627197
local_output_nid generation:  0.03517460823059082
local_in_edges_tensor generation:  0.03426098823547363
mini_batch_src_global generation:  0.053375959396362305
r_  generation:  0.48800039291381836
local_output_nid generation:  0.034895896911621094
local_in_edges_tensor generation:  0.03684711456298828
mini_batch_src_global generation:  0.05350136756896973
r_  generation:  0.5015621185302734
local_output_nid generation:  0.035898447036743164
local_in_edges_tensor generation:  0.04219484329223633
mini_batch_src_global generation:  0.0569150447845459
r_  generation:  0.4930257797241211
local_output_nid generation:  0.03531241416931152
local_in_edges_tensor generation:  0.03567862510681152
mini_batch_src_global generation:  0.052649736404418945
r_  generation:  0.5011374950408936
local_output_nid generation:  0.035530805587768555
local_in_edges_tensor generation:  0.037876129150390625
mini_batch_src_global generation:  0.05940556526184082
r_  generation:  0.4979708194732666
----------------------check_connections_block total spend ----------------------------- 5.847638368606567
generate_one_block  0.6301465034484863
generate_one_block  0.6207571029663086
generate_one_block  0.6187570095062256
generate_one_block  0.606041431427002
generate_one_block  0.6112508773803711
generate_one_block  0.6032187938690186
generate_one_block  0.6066057682037354
generate_one_block  0.6244235038757324
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12982892990112305  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

connection checking time:  9.451852560043335
block generation total time  8.121479272842407
average batch blocks generation time:  1.015184909105301
block dataloader generation time/epoch 19.50078434210557
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1012420654296875  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9023194313049316  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10142946243286133  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9036293029785156  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10135889053344727  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9028830528259277  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10124444961547852  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9063906669616699  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10137271881103516  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9018101692199707  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10118341445922852  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9026412963867188  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10125494003295898  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.901484489440918  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10125970840454102  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.905576229095459  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0776292085647583 |0.012493640184402466 |0.003380417823791504 |8.982419967651367e-05 |0.003739982843399048 |0.0017240047454833984 |
----------------------------------------------------------pseudo_mini_loss sum 1.2960727214813232
Total (block generation + training)time/epoch 20.343856041248028
Training time/epoch 0.8531403541564941
Training time without block to device /epoch 0.7531912326812744
Training time without total dataloading part /epoch 0.05940580368041992
load block tensor time/epoch 0.6210336685180664
block to device time/epoch 0.09994912147521973
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 22 |
Number of nodes for computation during this epoch:  2955786
Number of first layer input nodes during this epoch:  1284166
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12978219985961914  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02176952362060547
random selection method range initialization spend 0.005353689193725586
time for parepare:  0.0176849365234375
local_output_nid generation:  0.004494190216064453
local_in_edges_tensor generation:  0.007105350494384766
mini_batch_src_global generation:  0.0031180381774902344
r_  generation:  0.0397801399230957
local_output_nid generation:  0.005948066711425781
local_in_edges_tensor generation:  0.0032587051391601562
mini_batch_src_global generation:  0.004534721374511719
r_  generation:  0.04111361503601074
local_output_nid generation:  0.006079912185668945
local_in_edges_tensor generation:  0.003377676010131836
mini_batch_src_global generation:  0.0030062198638916016
r_  generation:  0.040753841400146484
local_output_nid generation:  0.006062746047973633
local_in_edges_tensor generation:  0.0033850669860839844
mini_batch_src_global generation:  0.003023862838745117
r_  generation:  0.04176688194274902
local_output_nid generation:  0.0061266422271728516
local_in_edges_tensor generation:  0.003218412399291992
mini_batch_src_global generation:  0.0032508373260498047
r_  generation:  0.04311871528625488
local_output_nid generation:  0.006070375442504883
local_in_edges_tensor generation:  0.0032494068145751953
mini_batch_src_global generation:  0.0034198760986328125
r_  generation:  0.04304003715515137
local_output_nid generation:  0.006051540374755859
local_in_edges_tensor generation:  0.00330352783203125
mini_batch_src_global generation:  0.0034792423248291016
r_  generation:  0.0433349609375
local_output_nid generation:  0.006124734878540039
local_in_edges_tensor generation:  0.003635406494140625
mini_batch_src_global generation:  0.0034720897674560547
r_  generation:  0.04326963424682617
----------------------check_connections_block total spend ----------------------------- 0.5416233539581299
generate_one_block  0.054492950439453125
generate_one_block  0.05642223358154297
generate_one_block  0.0542445182800293
generate_one_block  0.05601167678833008
generate_one_block  0.05760383605957031
generate_one_block  0.055847883224487305
generate_one_block  0.05997920036315918
generate_one_block  0.05617094039916992
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03590679168701172
gen group dst list time:  0.014969825744628906
time for parepare:  0.021718502044677734
local_output_nid generation:  0.013604402542114258
local_in_edges_tensor generation:  0.02937150001525879
mini_batch_src_global generation:  0.03274703025817871
r_  generation:  0.29542016983032227
local_output_nid generation:  0.019565343856811523
local_in_edges_tensor generation:  0.03123617172241211
mini_batch_src_global generation:  0.043588876724243164
r_  generation:  0.30954980850219727
local_output_nid generation:  0.020647764205932617
local_in_edges_tensor generation:  0.018700361251831055
mini_batch_src_global generation:  0.035677433013916016
r_  generation:  0.3037898540496826
local_output_nid generation:  0.019347429275512695
local_in_edges_tensor generation:  0.021168231964111328
mini_batch_src_global generation:  0.03572726249694824
r_  generation:  0.3064875602722168
local_output_nid generation:  0.01983046531677246
local_in_edges_tensor generation:  0.02071380615234375
mini_batch_src_global generation:  0.03761911392211914
r_  generation:  0.3161640167236328
local_output_nid generation:  0.019335031509399414
local_in_edges_tensor generation:  0.0203549861907959
mini_batch_src_global generation:  0.03914642333984375
r_  generation:  0.3137781620025635
local_output_nid generation:  0.01856088638305664
local_in_edges_tensor generation:  0.028762340545654297
mini_batch_src_global generation:  0.037905216217041016
r_  generation:  0.3149688243865967
local_output_nid generation:  0.019990921020507812
local_in_edges_tensor generation:  0.0205538272857666
mini_batch_src_global generation:  0.040380239486694336
r_  generation:  0.314180850982666
----------------------check_connections_block total spend ----------------------------- 3.671630859375
generate_one_block  0.39603328704833984
generate_one_block  0.3978714942932129
generate_one_block  0.38941192626953125
generate_one_block  0.38647890090942383
generate_one_block  0.3951232433319092
generate_one_block  0.4007298946380615
generate_one_block  0.3966996669769287
generate_one_block  0.4335606098175049
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03417539596557617
gen group dst list time:  0.03936195373535156
time for parepare:  0.019512653350830078
local_output_nid generation:  0.03235363960266113
local_in_edges_tensor generation:  0.06754207611083984
mini_batch_src_global generation:  0.0475916862487793
r_  generation:  0.49011802673339844
local_output_nid generation:  0.03795742988586426
local_in_edges_tensor generation:  0.04398679733276367
mini_batch_src_global generation:  0.05645298957824707
r_  generation:  0.4857048988342285
local_output_nid generation:  0.03643488883972168
local_in_edges_tensor generation:  0.035924434661865234
mini_batch_src_global generation:  0.05260014533996582
r_  generation:  0.4939756393432617
local_output_nid generation:  0.03661537170410156
local_in_edges_tensor generation:  0.0458378791809082
mini_batch_src_global generation:  0.05751752853393555
r_  generation:  0.49536633491516113
local_output_nid generation:  0.03641939163208008
local_in_edges_tensor generation:  0.035112857818603516
mini_batch_src_global generation:  0.05905556678771973
r_  generation:  0.50502610206604
local_output_nid generation:  0.037378549575805664
local_in_edges_tensor generation:  0.03996682167053223
mini_batch_src_global generation:  0.058843135833740234
r_  generation:  0.4963557720184326
local_output_nid generation:  0.03667712211608887
local_in_edges_tensor generation:  0.03366661071777344
mini_batch_src_global generation:  0.05474495887756348
r_  generation:  0.5082643032073975
local_output_nid generation:  0.037276506423950195
local_in_edges_tensor generation:  0.03619742393493652
mini_batch_src_global generation:  0.05915117263793945
r_  generation:  0.4972975254058838
----------------------check_connections_block total spend ----------------------------- 5.944108963012695
generate_one_block  0.6286358833312988
generate_one_block  0.6219992637634277
generate_one_block  0.6084399223327637
generate_one_block  0.6093161106109619
generate_one_block  0.6158335208892822
generate_one_block  0.6116030216217041
generate_one_block  0.6173849105834961
generate_one_block  0.6174392700195312
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12978219985961914  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

connection checking time:  9.615739822387695
block generation total time  8.126560926437378
average batch blocks generation time:  1.0158201158046722
block dataloader generation time/epoch 19.51487578664507
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10104703903198242  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9010987281799316  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10196590423583984  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.912076473236084  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10113906860351562  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9020562171936035  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10104846954345703  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9022989273071289  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10144186019897461  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9032130241394043  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10115385055541992  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9041509628295898  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1011343002319336  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.902529239654541  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1015615463256836  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9068741798400879  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07737880945205688 |0.01268509030342102 |0.003465414047241211 |9.265542030334473e-05 |0.003772050142288208 |0.0030858516693115234 |
----------------------------------------------------------pseudo_mini_loss sum 1.281553864479065
Total (block generation + training)time/epoch 20.359179939542496
Training time/epoch 0.8600625991821289
Training time without block to device /epoch 0.7585818767547607
Training time without total dataloading part /epoch 0.06172680854797363
load block tensor time/epoch 0.6190304756164551
block to device time/epoch 0.10148072242736816
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 23 |
Number of nodes for computation during this epoch:  2956883
Number of first layer input nodes during this epoch:  1284418
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12994003295898438  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02154827117919922
random selection method range initialization spend 0.006350040435791016
time for parepare:  0.017355680465698242
local_output_nid generation:  0.004477977752685547
local_in_edges_tensor generation:  0.007942914962768555
mini_batch_src_global generation:  0.003153562545776367
r_  generation:  0.03854250907897949
local_output_nid generation:  0.0059642791748046875
local_in_edges_tensor generation:  0.0032117366790771484
mini_batch_src_global generation:  0.004422426223754883
r_  generation:  0.040418386459350586
local_output_nid generation:  0.0061452388763427734
local_in_edges_tensor generation:  0.003237485885620117
mini_batch_src_global generation:  0.003045797348022461
r_  generation:  0.041353464126586914
local_output_nid generation:  0.006104707717895508
local_in_edges_tensor generation:  0.0031986236572265625
mini_batch_src_global generation:  0.0030012130737304688
r_  generation:  0.04079270362854004
local_output_nid generation:  0.0060901641845703125
local_in_edges_tensor generation:  0.003202199935913086
mini_batch_src_global generation:  0.0032105445861816406
r_  generation:  0.04162430763244629
local_output_nid generation:  0.006013393402099609
local_in_edges_tensor generation:  0.003317117691040039
mini_batch_src_global generation:  0.003422975540161133
r_  generation:  0.04281449317932129
local_output_nid generation:  0.006130218505859375
local_in_edges_tensor generation:  0.0032503604888916016
mini_batch_src_global generation:  0.003472566604614258
r_  generation:  0.04201340675354004
local_output_nid generation:  0.006047487258911133
local_in_edges_tensor generation:  0.0032634735107421875
mini_batch_src_global generation:  0.0034525394439697266
r_  generation:  0.042757511138916016
----------------------check_connections_block total spend ----------------------------- 0.5322427749633789
generate_one_block  0.0545194149017334
generate_one_block  0.0550389289855957
generate_one_block  0.05525851249694824
generate_one_block  0.05465245246887207
generate_one_block  0.054189443588256836
generate_one_block  0.05531120300292969
generate_one_block  0.0582273006439209
generate_one_block  0.05502486228942871
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03398847579956055
gen group dst list time:  0.014410734176635742
time for parepare:  0.01938319206237793
local_output_nid generation:  0.013564109802246094
local_in_edges_tensor generation:  0.030507326126098633
mini_batch_src_global generation:  0.030170440673828125
r_  generation:  0.29592323303222656
local_output_nid generation:  0.020352840423583984
local_in_edges_tensor generation:  0.0232846736907959
mini_batch_src_global generation:  0.04000568389892578
r_  generation:  0.31102848052978516
local_output_nid generation:  0.019529342651367188
local_in_edges_tensor generation:  0.026651382446289062
mini_batch_src_global generation:  0.037481069564819336
r_  generation:  0.32951903343200684
local_output_nid generation:  0.021387338638305664
local_in_edges_tensor generation:  0.0282742977142334
mini_batch_src_global generation:  0.036374568939208984
r_  generation:  0.31008052825927734
local_output_nid generation:  0.019907712936401367
local_in_edges_tensor generation:  0.019463777542114258
mini_batch_src_global generation:  0.038519859313964844
r_  generation:  0.30707836151123047
local_output_nid generation:  0.019341707229614258
local_in_edges_tensor generation:  0.018125534057617188
mini_batch_src_global generation:  0.038771629333496094
r_  generation:  0.317333459854126
local_output_nid generation:  0.018677234649658203
local_in_edges_tensor generation:  0.01894235610961914
mini_batch_src_global generation:  0.03797149658203125
r_  generation:  0.30918049812316895
local_output_nid generation:  0.018584489822387695
local_in_edges_tensor generation:  0.018053293228149414
mini_batch_src_global generation:  0.03746914863586426
r_  generation:  0.3139626979827881
----------------------check_connections_block total spend ----------------------------- 3.6776885986328125
generate_one_block  0.40335726737976074
generate_one_block  0.39460325241088867
generate_one_block  0.39815354347229004
generate_one_block  0.39426231384277344
generate_one_block  0.3896312713623047
generate_one_block  0.39198875427246094
generate_one_block  0.3894803524017334
generate_one_block  0.41691088676452637
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.039240360260009766
gen group dst list time:  0.03865933418273926
time for parepare:  0.02090620994567871
local_output_nid generation:  0.03024768829345703
local_in_edges_tensor generation:  0.05687689781188965
mini_batch_src_global generation:  0.043840885162353516
r_  generation:  0.47240614891052246
local_output_nid generation:  0.035184383392333984
local_in_edges_tensor generation:  0.03895998001098633
mini_batch_src_global generation:  0.0539705753326416
r_  generation:  0.48857617378234863
local_output_nid generation:  0.0354311466217041
local_in_edges_tensor generation:  0.04049515724182129
mini_batch_src_global generation:  0.05513119697570801
r_  generation:  0.4948399066925049
local_output_nid generation:  0.035433292388916016
local_in_edges_tensor generation:  0.03731679916381836
mini_batch_src_global generation:  0.06766366958618164
r_  generation:  0.4933154582977295
local_output_nid generation:  0.03758120536804199
local_in_edges_tensor generation:  0.035224199295043945
mini_batch_src_global generation:  0.054335832595825195
r_  generation:  0.494016170501709
local_output_nid generation:  0.03621816635131836
local_in_edges_tensor generation:  0.03960990905761719
mini_batch_src_global generation:  0.05490994453430176
r_  generation:  0.48901820182800293
local_output_nid generation:  0.03599238395690918
local_in_edges_tensor generation:  0.03377270698547363
mini_batch_src_global generation:  0.05407595634460449
r_  generation:  0.4969174861907959
local_output_nid generation:  0.03612661361694336
local_in_edges_tensor generation:  0.03355598449707031
mini_batch_src_global generation:  0.05549955368041992
r_  generation:  0.49017810821533203
----------------------check_connections_block total spend ----------------------------- 5.84366512298584
generate_one_block  0.6031796932220459
generate_one_block  0.6125574111938477
generate_one_block  0.6231017112731934
generate_one_block  0.6056053638458252
generate_one_block  0.6049168109893799
generate_one_block  0.6165416240692139
generate_one_block  0.6085920333862305
generate_one_block  0.6134889125823975
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12994003295898438  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

connection checking time:  9.521353721618652
block generation total time  8.066371202468872
average batch blocks generation time:  1.008296400308609
block dataloader generation time/epoch 19.51548186937968
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10142135620117188  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9077515602111816  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1011495590209961  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.906003475189209  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10123252868652344  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9041266441345215  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10102462768554688  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9025759696960449  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10111761093139648  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9017415046691895  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10185575485229492  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9040818214416504  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10117721557617188  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9020123481750488  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10165071487426758  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9046168327331543  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07627665996551514 |0.01476740837097168 |0.003678739070892334 |9.313225746154785e-05 |0.0037418603897094727 |0.0013623237609863281 |
----------------------------------------------------------pseudo_mini_loss sum 1.2711197137832642
Total (block generation + training)time/epoch 20.36100761095683
Training time/epoch 0.8624129295349121
Training time without block to device /epoch 0.7442736625671387
Training time without total dataloading part /epoch 0.061472177505493164
load block tensor time/epoch 0.6102132797241211
block to device time/epoch 0.11813926696777344
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 24 |
Number of nodes for computation during this epoch:  2956996
Number of first layer input nodes during this epoch:  1284269
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12968015670776367  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026828289031982422
random selection method range initialization spend 0.00834035873413086
time for parepare:  0.01898980140686035
local_output_nid generation:  0.004480123519897461
local_in_edges_tensor generation:  0.007118701934814453
mini_batch_src_global generation:  0.004267215728759766
r_  generation:  0.03915572166442871
local_output_nid generation:  0.0058498382568359375
local_in_edges_tensor generation:  0.0033996105194091797
mini_batch_src_global generation:  0.0043528079986572266
r_  generation:  0.03980708122253418
local_output_nid generation:  0.006079196929931641
local_in_edges_tensor generation:  0.0036401748657226562
mini_batch_src_global generation:  0.0030007362365722656
r_  generation:  0.04082942008972168
local_output_nid generation:  0.0060498714447021484
local_in_edges_tensor generation:  0.0036039352416992188
mini_batch_src_global generation:  0.0030143260955810547
r_  generation:  0.0417325496673584
local_output_nid generation:  0.006088972091674805
local_in_edges_tensor generation:  0.003486156463623047
mini_batch_src_global generation:  0.0033206939697265625
r_  generation:  0.04270458221435547
local_output_nid generation:  0.006062746047973633
local_in_edges_tensor generation:  0.0034742355346679688
mini_batch_src_global generation:  0.003323078155517578
r_  generation:  0.0425565242767334
local_output_nid generation:  0.006102561950683594
local_in_edges_tensor generation:  0.003602266311645508
mini_batch_src_global generation:  0.003407001495361328
r_  generation:  0.04236435890197754
local_output_nid generation:  0.006068706512451172
local_in_edges_tensor generation:  0.003423452377319336
mini_batch_src_global generation:  0.0034265518188476562
r_  generation:  0.042922019958496094
----------------------check_connections_block total spend ----------------------------- 0.5400941371917725
generate_one_block  0.05313825607299805
generate_one_block  0.05464601516723633
generate_one_block  0.054961204528808594
generate_one_block  0.05529594421386719
generate_one_block  0.05608677864074707
generate_one_block  0.05510115623474121
generate_one_block  0.05803537368774414
generate_one_block  0.055580854415893555
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03173232078552246
gen group dst list time:  0.014324426651000977
time for parepare:  0.019301652908325195
local_output_nid generation:  0.013808012008666992
local_in_edges_tensor generation:  0.029546022415161133
mini_batch_src_global generation:  0.028951644897460938
r_  generation:  0.2890164852142334
local_output_nid generation:  0.019580364227294922
local_in_edges_tensor generation:  0.023354530334472656
mini_batch_src_global generation:  0.03550386428833008
r_  generation:  0.30522990226745605
local_output_nid generation:  0.019344091415405273
local_in_edges_tensor generation:  0.022127151489257812
mini_batch_src_global generation:  0.034661054611206055
r_  generation:  0.31123828887939453
local_output_nid generation:  0.018940210342407227
local_in_edges_tensor generation:  0.01854419708251953
mini_batch_src_global generation:  0.035813331604003906
r_  generation:  0.31473636627197266
local_output_nid generation:  0.019536972045898438
local_in_edges_tensor generation:  0.018316268920898438
mini_batch_src_global generation:  0.03801918029785156
r_  generation:  0.3152730464935303
local_output_nid generation:  0.020623207092285156
local_in_edges_tensor generation:  0.0184628963470459
mini_batch_src_global generation:  0.0374302864074707
r_  generation:  0.31652379035949707
local_output_nid generation:  0.018152236938476562
local_in_edges_tensor generation:  0.018766164779663086
mini_batch_src_global generation:  0.038777828216552734
r_  generation:  0.31583738327026367
local_output_nid generation:  0.01835799217224121
local_in_edges_tensor generation:  0.0183713436126709
mini_batch_src_global generation:  0.03680276870727539
r_  generation:  0.3142523765563965
----------------------check_connections_block total spend ----------------------------- 3.6288325786590576
generate_one_block  0.40529513359069824
generate_one_block  0.4024677276611328
generate_one_block  0.40033745765686035
generate_one_block  0.3998847007751465
generate_one_block  0.40487051010131836
generate_one_block  0.392763614654541
generate_one_block  0.3944547176361084
generate_one_block  0.41778063774108887
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.031488656997680664
gen group dst list time:  0.03823542594909668
time for parepare:  0.02063918113708496
local_output_nid generation:  0.030229806900024414
local_in_edges_tensor generation:  0.05830693244934082
mini_batch_src_global generation:  0.04973411560058594
r_  generation:  0.47927069664001465
local_output_nid generation:  0.03585696220397949
local_in_edges_tensor generation:  0.039910078048706055
mini_batch_src_global generation:  0.05397319793701172
r_  generation:  0.4845438003540039
local_output_nid generation:  0.035471439361572266
local_in_edges_tensor generation:  0.03737449645996094
mini_batch_src_global generation:  0.05247902870178223
r_  generation:  0.4976620674133301
local_output_nid generation:  0.035636186599731445
local_in_edges_tensor generation:  0.03518819808959961
mini_batch_src_global generation:  0.053702592849731445
r_  generation:  0.4991469383239746
local_output_nid generation:  0.03555631637573242
local_in_edges_tensor generation:  0.03495931625366211
mini_batch_src_global generation:  0.05161571502685547
r_  generation:  0.5112926959991455
local_output_nid generation:  0.03807187080383301
local_in_edges_tensor generation:  0.03591465950012207
mini_batch_src_global generation:  0.055855751037597656
r_  generation:  0.4888012409210205
local_output_nid generation:  0.03558063507080078
local_in_edges_tensor generation:  0.03925156593322754
mini_batch_src_global generation:  0.055263519287109375
r_  generation:  0.5028820037841797
local_output_nid generation:  0.035689353942871094
local_in_edges_tensor generation:  0.03754115104675293
mini_batch_src_global generation:  0.05559659004211426
r_  generation:  0.4864037036895752
----------------------check_connections_block total spend ----------------------------- 5.859775543212891
generate_one_block  0.6213827133178711
generate_one_block  0.6355111598968506
generate_one_block  0.6252233982086182
generate_one_block  0.6127517223358154
generate_one_block  0.6162161827087402
generate_one_block  0.6207380294799805
generate_one_block  0.6289472579956055
generate_one_block  0.6168131828308105
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12968015670776367  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

connection checking time:  9.488608121871948
block generation total time  8.195438146591187
average batch blocks generation time:  1.0244297683238983
block dataloader generation time/epoch 19.52175299823284
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10114383697509766  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9011697769165039  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10123157501220703  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9038858413696289  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10127639770507812  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9032797813415527  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10133934020996094  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9090747833251953  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10111427307128906  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9028148651123047  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10106897354125977  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9014492034912109  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1011962890625  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.905543327331543  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10124540328979492  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9015049934387207  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07065367698669434 |0.013900548219680786 |0.0040169358253479 |9.515881538391113e-05 |0.008750855922698975 |0.002953052520751953 |
----------------------------------------------------------pseudo_mini_loss sum 1.2556569576263428
Total (block generation + training)time/epoch 20.367524698376656
Training time/epoch 0.849174976348877
Training time without block to device /epoch 0.7379705905914307
Training time without total dataloading part /epoch 0.10585665702819824
load block tensor time/epoch 0.5652294158935547
block to device time/epoch 0.11120438575744629
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 25 |
Number of nodes for computation during this epoch:  2955385
Number of first layer input nodes during this epoch:  1284130
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1298203468322754  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024027109146118164
random selection method range initialization spend 0.0059261322021484375
time for parepare:  0.020285844802856445
local_output_nid generation:  0.004464864730834961
local_in_edges_tensor generation:  0.008716583251953125
mini_batch_src_global generation:  0.0035440921783447266
r_  generation:  0.04012656211853027
local_output_nid generation:  0.005928993225097656
local_in_edges_tensor generation:  0.003545522689819336
mini_batch_src_global generation:  0.004472255706787109
r_  generation:  0.04081225395202637
local_output_nid generation:  0.0060884952545166016
local_in_edges_tensor generation:  0.003231525421142578
mini_batch_src_global generation:  0.0030519962310791016
r_  generation:  0.041014909744262695
local_output_nid generation:  0.006081342697143555
local_in_edges_tensor generation:  0.0032873153686523438
mini_batch_src_global generation:  0.003004789352416992
r_  generation:  0.04124021530151367
local_output_nid generation:  0.00602412223815918
local_in_edges_tensor generation:  0.0031385421752929688
mini_batch_src_global generation:  0.0032927989959716797
r_  generation:  0.04191136360168457
local_output_nid generation:  0.006071329116821289
local_in_edges_tensor generation:  0.003247499465942383
mini_batch_src_global generation:  0.003472566604614258
r_  generation:  0.04240560531616211
local_output_nid generation:  0.0060749053955078125
local_in_edges_tensor generation:  0.00334930419921875
mini_batch_src_global generation:  0.0034606456756591797
r_  generation:  0.04182767868041992
local_output_nid generation:  0.006071805953979492
local_in_edges_tensor generation:  0.0031251907348632812
mini_batch_src_global generation:  0.0034170150756835938
r_  generation:  0.04244041442871094
----------------------check_connections_block total spend ----------------------------- 0.5386145114898682
generate_one_block  0.05374741554260254
generate_one_block  0.05511736869812012
generate_one_block  0.05472612380981445
generate_one_block  0.05458807945251465
generate_one_block  0.05470442771911621
generate_one_block  0.05478715896606445
generate_one_block  0.05778694152832031
generate_one_block  0.05505251884460449
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.034093379974365234
gen group dst list time:  0.014316320419311523
time for parepare:  0.019399642944335938
local_output_nid generation:  0.013440370559692383
local_in_edges_tensor generation:  0.02494192123413086
mini_batch_src_global generation:  0.02949357032775879
r_  generation:  0.286409854888916
local_output_nid generation:  0.019342660903930664
local_in_edges_tensor generation:  0.023578405380249023
mini_batch_src_global generation:  0.03534984588623047
r_  generation:  0.29920220375061035
local_output_nid generation:  0.0193026065826416
local_in_edges_tensor generation:  0.019374370574951172
mini_batch_src_global generation:  0.035637617111206055
r_  generation:  0.30346179008483887
local_output_nid generation:  0.018761873245239258
local_in_edges_tensor generation:  0.019355297088623047
mini_batch_src_global generation:  0.03576159477233887
r_  generation:  0.30697011947631836
local_output_nid generation:  0.019452810287475586
local_in_edges_tensor generation:  0.020223379135131836
mini_batch_src_global generation:  0.037245988845825195
r_  generation:  0.309262752532959
local_output_nid generation:  0.018991708755493164
local_in_edges_tensor generation:  0.0179901123046875
mini_batch_src_global generation:  0.03737926483154297
r_  generation:  0.3086521625518799
local_output_nid generation:  0.018010854721069336
local_in_edges_tensor generation:  0.01897573471069336
mini_batch_src_global generation:  0.0373384952545166
r_  generation:  0.30733680725097656
local_output_nid generation:  0.018248558044433594
local_in_edges_tensor generation:  0.01960277557373047
mini_batch_src_global generation:  0.03767657279968262
r_  generation:  0.31207752227783203
----------------------check_connections_block total spend ----------------------------- 3.5703704357147217
generate_one_block  0.3910713195800781
generate_one_block  0.3866446018218994
generate_one_block  0.3880581855773926
generate_one_block  0.39380407333374023
generate_one_block  0.3951115608215332
generate_one_block  0.38960742950439453
generate_one_block  0.3922464847564697
generate_one_block  0.41678953170776367
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03264498710632324
gen group dst list time:  0.03740382194519043
time for parepare:  0.02014446258544922
local_output_nid generation:  0.029840469360351562
local_in_edges_tensor generation:  0.04013633728027344
mini_batch_src_global generation:  0.043218135833740234
r_  generation:  0.47751426696777344
local_output_nid generation:  0.03537559509277344
local_in_edges_tensor generation:  0.03580069541931152
mini_batch_src_global generation:  0.0572052001953125
r_  generation:  0.4843776226043701
local_output_nid generation:  0.03503727912902832
local_in_edges_tensor generation:  0.036240577697753906
mini_batch_src_global generation:  0.05117082595825195
r_  generation:  0.4953603744506836
local_output_nid generation:  0.03519010543823242
local_in_edges_tensor generation:  0.033281564712524414
mini_batch_src_global generation:  0.05664539337158203
r_  generation:  0.494204044342041
local_output_nid generation:  0.0375981330871582
local_in_edges_tensor generation:  0.034874916076660156
mini_batch_src_global generation:  0.0565335750579834
r_  generation:  0.505223274230957
local_output_nid generation:  0.035329341888427734
local_in_edges_tensor generation:  0.04245281219482422
mini_batch_src_global generation:  0.05907940864562988
r_  generation:  0.5007054805755615
local_output_nid generation:  0.03916788101196289
local_in_edges_tensor generation:  0.040674686431884766
mini_batch_src_global generation:  0.06184673309326172
r_  generation:  0.5006062984466553
local_output_nid generation:  0.03647112846374512
local_in_edges_tensor generation:  0.036293983459472656
mini_batch_src_global generation:  0.05491995811462402
r_  generation:  0.48500871658325195
----------------------check_connections_block total spend ----------------------------- 5.854278087615967
generate_one_block  0.6101672649383545
generate_one_block  0.6079537868499756
generate_one_block  0.6093308925628662
generate_one_block  0.6027991771697998
generate_one_block  0.6099655628204346
generate_one_block  0.6345171928405762
generate_one_block  0.6156001091003418
generate_one_block  0.615931510925293
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1298203468322754  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

connection checking time:  9.424648523330688
block generation total time  8.059598684310913
average batch blocks generation time:  1.0074498355388641
block dataloader generation time/epoch 19.515060719321756
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10148239135742188  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9002523422241211  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10112714767456055  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9036402702331543  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10113668441772461  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9044723510742188  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10121870040893555  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.902400016784668  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10144424438476562  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9049272537231445  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10117387771606445  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.903872013092041  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10117149353027344  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9046497344970703  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10114669799804688  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9035439491271973  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07553538680076599 |0.015821754932403564 |0.004156887531280518 |9.91523265838623e-05 |0.0033675730228424072 |0.0019991397857666016 |
----------------------------------------------------------pseudo_mini_loss sum 1.2445666790008545
Total (block generation + training)time/epoch 20.361942515653723
Training time/epoch 0.864393949508667
Training time without block to device /epoch 0.7378199100494385
Training time without total dataloading part /epoch 0.0629880428314209
load block tensor time/epoch 0.6042830944061279
block to device time/epoch 0.12657403945922852
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 26 |
Number of nodes for computation during this epoch:  2955197
Number of first layer input nodes during this epoch:  1283957
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1298360824584961  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021013259887695312
random selection method range initialization spend 0.007016897201538086
time for parepare:  0.019594907760620117
local_output_nid generation:  0.00455164909362793
local_in_edges_tensor generation:  0.009193181991577148
mini_batch_src_global generation:  0.003545522689819336
r_  generation:  0.03905916213989258
local_output_nid generation:  0.005972862243652344
local_in_edges_tensor generation:  0.0032668113708496094
mini_batch_src_global generation:  0.0044705867767333984
r_  generation:  0.040955305099487305
local_output_nid generation:  0.0060672760009765625
local_in_edges_tensor generation:  0.003391742706298828
mini_batch_src_global generation:  0.003091573715209961
r_  generation:  0.040769338607788086
local_output_nid generation:  0.0061190128326416016
local_in_edges_tensor generation:  0.003271818161010742
mini_batch_src_global generation:  0.0030176639556884766
r_  generation:  0.0419919490814209
local_output_nid generation:  0.006098508834838867
local_in_edges_tensor generation:  0.0032792091369628906
mini_batch_src_global generation:  0.0033490657806396484
r_  generation:  0.04233884811401367
local_output_nid generation:  0.006069183349609375
local_in_edges_tensor generation:  0.003265857696533203
mini_batch_src_global generation:  0.0033931732177734375
r_  generation:  0.04262948036193848
local_output_nid generation:  0.006108283996582031
local_in_edges_tensor generation:  0.0032205581665039062
mini_batch_src_global generation:  0.0034918785095214844
r_  generation:  0.042708396911621094
local_output_nid generation:  0.0060999393463134766
local_in_edges_tensor generation:  0.0032036304473876953
mini_batch_src_global generation:  0.0034389495849609375
r_  generation:  0.04245328903198242
----------------------check_connections_block total spend ----------------------------- 0.5405623912811279
generate_one_block  0.054096221923828125
generate_one_block  0.05541419982910156
generate_one_block  0.05469250679016113
generate_one_block  0.05514812469482422
generate_one_block  0.05479836463928223
generate_one_block  0.05509138107299805
generate_one_block  0.05874037742614746
generate_one_block  0.05521559715270996
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03430986404418945
gen group dst list time:  0.01470041275024414
time for parepare:  0.019717931747436523
local_output_nid generation:  0.01439976692199707
local_in_edges_tensor generation:  0.03133034706115723
mini_batch_src_global generation:  0.02964019775390625
r_  generation:  0.2902250289916992
local_output_nid generation:  0.01982736587524414
local_in_edges_tensor generation:  0.024891376495361328
mini_batch_src_global generation:  0.03675436973571777
r_  generation:  0.30486583709716797
local_output_nid generation:  0.01976943016052246
local_in_edges_tensor generation:  0.021712541580200195
mini_batch_src_global generation:  0.03542470932006836
r_  generation:  0.3110480308532715
local_output_nid generation:  0.019221782684326172
local_in_edges_tensor generation:  0.019785404205322266
mini_batch_src_global generation:  0.03846549987792969
r_  generation:  0.3122725486755371
local_output_nid generation:  0.019849777221679688
local_in_edges_tensor generation:  0.019004344940185547
mini_batch_src_global generation:  0.039566755294799805
r_  generation:  0.31877636909484863
local_output_nid generation:  0.019443988800048828
local_in_edges_tensor generation:  0.019347667694091797
mini_batch_src_global generation:  0.037545204162597656
r_  generation:  0.3169376850128174
local_output_nid generation:  0.018621206283569336
local_in_edges_tensor generation:  0.018900394439697266
mini_batch_src_global generation:  0.038991689682006836
r_  generation:  0.3143887519836426
local_output_nid generation:  0.018764257431030273
local_in_edges_tensor generation:  0.020111799240112305
mini_batch_src_global generation:  0.03686642646789551
r_  generation:  0.31261110305786133
----------------------check_connections_block total spend ----------------------------- 3.645259380340576
generate_one_block  0.3984262943267822
generate_one_block  0.40317511558532715
generate_one_block  0.4014623165130615
generate_one_block  0.39977145195007324
generate_one_block  0.40580081939697266
generate_one_block  0.3979213237762451
generate_one_block  0.3982272148132324
generate_one_block  0.4219222068786621
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.037187814712524414
gen group dst list time:  0.03811526298522949
time for parepare:  0.0203092098236084
local_output_nid generation:  0.030149221420288086
local_in_edges_tensor generation:  0.05435633659362793
mini_batch_src_global generation:  0.04469037055969238
r_  generation:  0.4907498359680176
local_output_nid generation:  0.03555870056152344
local_in_edges_tensor generation:  0.041524410247802734
mini_batch_src_global generation:  0.05371713638305664
r_  generation:  0.4865226745605469
local_output_nid generation:  0.03642463684082031
local_in_edges_tensor generation:  0.035382986068725586
mini_batch_src_global generation:  0.051033735275268555
r_  generation:  0.5000817775726318
local_output_nid generation:  0.035800933837890625
local_in_edges_tensor generation:  0.0410616397857666
mini_batch_src_global generation:  0.055094242095947266
r_  generation:  0.4895493984222412
local_output_nid generation:  0.03532671928405762
local_in_edges_tensor generation:  0.03467226028442383
mini_batch_src_global generation:  0.05215024948120117
r_  generation:  0.49999260902404785
local_output_nid generation:  0.035474538803100586
local_in_edges_tensor generation:  0.03549480438232422
mini_batch_src_global generation:  0.05476188659667969
r_  generation:  0.49148988723754883
local_output_nid generation:  0.03561592102050781
local_in_edges_tensor generation:  0.044652462005615234
mini_batch_src_global generation:  0.05527210235595703
r_  generation:  0.5193173885345459
local_output_nid generation:  0.038622140884399414
local_in_edges_tensor generation:  0.03940081596374512
mini_batch_src_global generation:  0.05654740333557129
r_  generation:  0.4876058101654053
----------------------check_connections_block total spend ----------------------------- 5.886667013168335
generate_one_block  0.6162068843841553
generate_one_block  0.6100294589996338
generate_one_block  0.6117911338806152
generate_one_block  0.6099786758422852
generate_one_block  0.6088206768035889
generate_one_block  0.6194674968719482
generate_one_block  0.6067430973052979
generate_one_block  0.6106376647949219
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1298360824584961  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

connection checking time:  9.531926393508911
block generation total time  8.120381832122803
average batch blocks generation time:  1.0150477290153503
block dataloader generation time/epoch 19.519907236099243
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10137462615966797  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9055275917053223  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10132074356079102  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9039349555969238  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10121488571166992  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.904719352722168  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10128307342529297  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9040737152099609  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10110998153686523  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9040045738220215  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1012125015258789  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9028205871582031  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.101165771484375  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9033541679382324  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10106849670410156  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9023222923278809  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07679164409637451 |0.01324087381362915 |0.0038183927536010742 |9.566545486450195e-05 |0.003745734691619873 |0.0029811859130859375 |
----------------------------------------------------------pseudo_mini_loss sum 1.2345683574676514
Total (block generation + training)time/epoch 20.36705113781823
Training time/epoch 0.851412296295166
Training time without block to device /epoch 0.7454853057861328
Training time without total dataloading part /epoch 0.06425952911376953
load block tensor time/epoch 0.6143331527709961
block to device time/epoch 0.1059269905090332
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 27 |
Number of nodes for computation during this epoch:  2956992
Number of first layer input nodes during this epoch:  1284232
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12991046905517578  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022447824478149414
random selection method range initialization spend 0.0057086944580078125
time for parepare:  0.017682790756225586
local_output_nid generation:  0.004442930221557617
local_in_edges_tensor generation:  0.00842738151550293
mini_batch_src_global generation:  0.003063201904296875
r_  generation:  0.03927135467529297
local_output_nid generation:  0.0059626102447509766
local_in_edges_tensor generation:  0.003208160400390625
mini_batch_src_global generation:  0.00431060791015625
r_  generation:  0.0409088134765625
local_output_nid generation:  0.006113767623901367
local_in_edges_tensor generation:  0.0032668113708496094
mini_batch_src_global generation:  0.0030388832092285156
r_  generation:  0.04052376747131348
local_output_nid generation:  0.006041049957275391
local_in_edges_tensor generation:  0.0032644271850585938
mini_batch_src_global generation:  0.002980470657348633
r_  generation:  0.04142951965332031
local_output_nid generation:  0.0061147212982177734
local_in_edges_tensor generation:  0.003174304962158203
mini_batch_src_global generation:  0.0032854080200195312
r_  generation:  0.04271817207336426
local_output_nid generation:  0.006132841110229492
local_in_edges_tensor generation:  0.0032062530517578125
mini_batch_src_global generation:  0.0033740997314453125
r_  generation:  0.04306674003601074
local_output_nid generation:  0.006062984466552734
local_in_edges_tensor generation:  0.003285646438598633
mini_batch_src_global generation:  0.0034990310668945312
r_  generation:  0.04330897331237793
local_output_nid generation:  0.006100893020629883
local_in_edges_tensor generation:  0.003183603286743164
mini_batch_src_global generation:  0.0034155845642089844
r_  generation:  0.04239058494567871
----------------------check_connections_block total spend ----------------------------- 0.5360751152038574
generate_one_block  0.05406069755554199
generate_one_block  0.05541729927062988
generate_one_block  0.054148197174072266
generate_one_block  0.054999351501464844
generate_one_block  0.055036306381225586
generate_one_block  0.05573892593383789
generate_one_block  0.059101104736328125
generate_one_block  0.0545046329498291
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03318977355957031
gen group dst list time:  0.014345884323120117
time for parepare:  0.019121646881103516
local_output_nid generation:  0.013659000396728516
local_in_edges_tensor generation:  0.03077554702758789
mini_batch_src_global generation:  0.028900861740112305
r_  generation:  0.29078197479248047
local_output_nid generation:  0.01946091651916504
local_in_edges_tensor generation:  0.023424863815307617
mini_batch_src_global generation:  0.036628007888793945
r_  generation:  0.30752110481262207
local_output_nid generation:  0.019189834594726562
local_in_edges_tensor generation:  0.01844310760498047
mini_batch_src_global generation:  0.03447532653808594
r_  generation:  0.30651354789733887
local_output_nid generation:  0.01895761489868164
local_in_edges_tensor generation:  0.018439531326293945
mini_batch_src_global generation:  0.036173105239868164
r_  generation:  0.3177177906036377
local_output_nid generation:  0.020419597625732422
local_in_edges_tensor generation:  0.023778438568115234
mini_batch_src_global generation:  0.03884625434875488
r_  generation:  0.3203716278076172
local_output_nid generation:  0.021361112594604492
local_in_edges_tensor generation:  0.026560306549072266
mini_batch_src_global generation:  0.03749680519104004
r_  generation:  0.33128881454467773
local_output_nid generation:  0.021070480346679688
local_in_edges_tensor generation:  0.020877361297607422
mini_batch_src_global generation:  0.03753376007080078
r_  generation:  0.3132631778717041
local_output_nid generation:  0.01864171028137207
local_in_edges_tensor generation:  0.02156829833984375
mini_batch_src_global generation:  0.03736066818237305
r_  generation:  0.30634021759033203
----------------------check_connections_block total spend ----------------------------- 3.675428867340088
generate_one_block  0.4056665897369385
generate_one_block  0.4082775115966797
generate_one_block  0.39730167388916016
generate_one_block  0.40111303329467773
generate_one_block  0.4059717655181885
generate_one_block  0.403393030166626
generate_one_block  0.39550018310546875
generate_one_block  0.41326117515563965
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03584551811218262
gen group dst list time:  0.038280487060546875
time for parepare:  0.020052671432495117
local_output_nid generation:  0.029334306716918945
local_in_edges_tensor generation:  0.0515742301940918
mini_batch_src_global generation:  0.04483199119567871
r_  generation:  0.47523999214172363
local_output_nid generation:  0.035154104232788086
local_in_edges_tensor generation:  0.041881561279296875
mini_batch_src_global generation:  0.054268598556518555
r_  generation:  0.4870274066925049
local_output_nid generation:  0.034972190856933594
local_in_edges_tensor generation:  0.03407883644104004
mini_batch_src_global generation:  0.051667213439941406
r_  generation:  0.49625253677368164
local_output_nid generation:  0.03549504280090332
local_in_edges_tensor generation:  0.03361678123474121
mini_batch_src_global generation:  0.05447649955749512
r_  generation:  0.49141502380371094
local_output_nid generation:  0.03505587577819824
local_in_edges_tensor generation:  0.03630232810974121
mini_batch_src_global generation:  0.05354452133178711
r_  generation:  0.5028305053710938
local_output_nid generation:  0.035735130310058594
local_in_edges_tensor generation:  0.03578972816467285
mini_batch_src_global generation:  0.057810306549072266
r_  generation:  0.49358534812927246
local_output_nid generation:  0.0366976261138916
local_in_edges_tensor generation:  0.035629987716674805
mini_batch_src_global generation:  0.054071903228759766
r_  generation:  0.5056605339050293
local_output_nid generation:  0.03520083427429199
local_in_edges_tensor generation:  0.036162614822387695
mini_batch_src_global generation:  0.055995941162109375
r_  generation:  0.48835158348083496
----------------------check_connections_block total spend ----------------------------- 5.843001842498779
generate_one_block  0.6120936870574951
generate_one_block  0.6164078712463379
generate_one_block  0.6159346103668213
generate_one_block  0.6087009906768799
generate_one_block  0.6261615753173828
generate_one_block  0.6325953006744385
generate_one_block  0.634455680847168
generate_one_block  0.6126320362091064
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12991046905517578  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

connection checking time:  9.518430709838867
block generation total time  8.189466714859009
average batch blocks generation time:  1.023683339357376
block dataloader generation time/epoch 19.52553105354309
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10122823715209961  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9024152755737305  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10144948959350586  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9046659469604492  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10085630416870117  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.8990912437438965  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10112905502319336  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9050488471984863  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10114097595214844  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9035468101501465  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10114336013793945  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.905055046081543  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10131359100341797  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9064793586730957  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10105419158935547  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9015650749206543  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07010102272033691 |0.015226125717163086 |0.003639042377471924 |9.438395500183105e-05 |0.0036218762397766113 |0.0029616355895996094 |
----------------------------------------------------------pseudo_mini_loss sum 1.2241367101669312
Total (block generation + training)time/epoch 20.37078873734725
Training time/epoch 0.8110349178314209
Training time without block to device /epoch 0.6892259120941162
Training time without total dataloading part /epoch 0.06180405616760254
load block tensor time/epoch 0.5608081817626953
block to device time/epoch 0.12180900573730469
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 28 |
Number of nodes for computation during this epoch:  2954560
Number of first layer input nodes during this epoch:  1283246
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1296987533569336  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020546913146972656
random selection method range initialization spend 0.005864143371582031
time for parepare:  0.017119646072387695
local_output_nid generation:  0.004548549652099609
local_in_edges_tensor generation:  0.008992671966552734
mini_batch_src_global generation:  0.0028831958770751953
r_  generation:  0.03835415840148926
local_output_nid generation:  0.0059947967529296875
local_in_edges_tensor generation:  0.0033826828002929688
mini_batch_src_global generation:  0.004214286804199219
r_  generation:  0.0400538444519043
local_output_nid generation:  0.006036281585693359
local_in_edges_tensor generation:  0.0034558773040771484
mini_batch_src_global generation:  0.003076314926147461
r_  generation:  0.04014229774475098
local_output_nid generation:  0.006083250045776367
local_in_edges_tensor generation:  0.003371715545654297
mini_batch_src_global generation:  0.003018617630004883
r_  generation:  0.04218459129333496
local_output_nid generation:  0.006129264831542969
local_in_edges_tensor generation:  0.003224611282348633
mini_batch_src_global generation:  0.0032978057861328125
r_  generation:  0.04259920120239258
local_output_nid generation:  0.006130695343017578
local_in_edges_tensor generation:  0.003325223922729492
mini_batch_src_global generation:  0.003270864486694336
r_  generation:  0.041739463806152344
local_output_nid generation:  0.006082773208618164
local_in_edges_tensor generation:  0.0032722949981689453
mini_batch_src_global generation:  0.0034897327423095703
r_  generation:  0.04283332824707031
local_output_nid generation:  0.00621342658996582
local_in_edges_tensor generation:  0.0032546520233154297
mini_batch_src_global generation:  0.0034122467041015625
r_  generation:  0.04286336898803711
----------------------check_connections_block total spend ----------------------------- 0.5338971614837646
generate_one_block  0.0531010627746582
generate_one_block  0.05439448356628418
generate_one_block  0.053983449935913086
generate_one_block  0.055643320083618164
generate_one_block  0.05511951446533203
generate_one_block  0.054221391677856445
generate_one_block  0.05983233451843262
generate_one_block  0.0596158504486084
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04028010368347168
gen group dst list time:  0.01430368423461914
time for parepare:  0.018906354904174805
local_output_nid generation:  0.013589143753051758
local_in_edges_tensor generation:  0.030817031860351562
mini_batch_src_global generation:  0.028593063354492188
r_  generation:  0.2904975414276123
local_output_nid generation:  0.019724369049072266
local_in_edges_tensor generation:  0.02324700355529785
mini_batch_src_global generation:  0.03643631935119629
r_  generation:  0.3024623394012451
local_output_nid generation:  0.019353866577148438
local_in_edges_tensor generation:  0.01886606216430664
mini_batch_src_global generation:  0.034717559814453125
r_  generation:  0.3094809055328369
local_output_nid generation:  0.019006013870239258
local_in_edges_tensor generation:  0.019641637802124023
mini_batch_src_global generation:  0.03748655319213867
r_  generation:  0.31534743309020996
local_output_nid generation:  0.019581079483032227
local_in_edges_tensor generation:  0.019384145736694336
mini_batch_src_global generation:  0.03698015213012695
r_  generation:  0.31194114685058594
local_output_nid generation:  0.019377708435058594
local_in_edges_tensor generation:  0.018023252487182617
mini_batch_src_global generation:  0.036962270736694336
r_  generation:  0.3116588592529297
local_output_nid generation:  0.0184481143951416
local_in_edges_tensor generation:  0.01994609832763672
mini_batch_src_global generation:  0.03888130187988281
r_  generation:  0.3140885829925537
local_output_nid generation:  0.01862931251525879
local_in_edges_tensor generation:  0.017873764038085938
mini_batch_src_global generation:  0.03746294975280762
r_  generation:  0.3103761672973633
----------------------check_connections_block total spend ----------------------------- 3.6091091632843018
generate_one_block  0.3887324333190918
generate_one_block  0.3863348960876465
generate_one_block  0.390582799911499
generate_one_block  0.39368486404418945
generate_one_block  0.39159607887268066
generate_one_block  0.3835790157318115
generate_one_block  0.39801836013793945
generate_one_block  0.41513752937316895
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029677391052246094
gen group dst list time:  0.039344072341918945
time for parepare:  0.018532514572143555
local_output_nid generation:  0.02966022491455078
local_in_edges_tensor generation:  0.03884458541870117
mini_batch_src_global generation:  0.04446554183959961
r_  generation:  0.47904396057128906
local_output_nid generation:  0.0357668399810791
local_in_edges_tensor generation:  0.0396733283996582
mini_batch_src_global generation:  0.054750919342041016
r_  generation:  0.48940134048461914
local_output_nid generation:  0.035361289978027344
local_in_edges_tensor generation:  0.03285336494445801
mini_batch_src_global generation:  0.051062822341918945
r_  generation:  0.49863743782043457
local_output_nid generation:  0.03577828407287598
local_in_edges_tensor generation:  0.03619027137756348
mini_batch_src_global generation:  0.05444025993347168
r_  generation:  0.4948153495788574
local_output_nid generation:  0.035887718200683594
local_in_edges_tensor generation:  0.03544354438781738
mini_batch_src_global generation:  0.054779052734375
r_  generation:  0.5118036270141602
local_output_nid generation:  0.03540325164794922
local_in_edges_tensor generation:  0.03785538673400879
mini_batch_src_global generation:  0.05535483360290527
r_  generation:  0.49523138999938965
local_output_nid generation:  0.0358426570892334
local_in_edges_tensor generation:  0.03601527214050293
mini_batch_src_global generation:  0.05272054672241211
r_  generation:  0.5093073844909668
local_output_nid generation:  0.03584933280944824
local_in_edges_tensor generation:  0.03213191032409668
mini_batch_src_global generation:  0.05477023124694824
r_  generation:  0.49872899055480957
----------------------check_connections_block total spend ----------------------------- 5.850189208984375
generate_one_block  0.6056032180786133
generate_one_block  0.6069223880767822
generate_one_block  0.6087825298309326
generate_one_block  0.6227657794952393
generate_one_block  0.6250736713409424
generate_one_block  0.609546422958374
generate_one_block  0.613696813583374
generate_one_block  0.6118772029876709
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1296987533569336  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

connection checking time:  9.459298372268677
block generation total time  8.051934003829956
average batch blocks generation time:  1.0064917504787445
block dataloader generation time/epoch 19.51989427804947
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10152339935302734  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9010806083679199  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10124540328979492  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9035787582397461  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10125875473022461  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9019293785095215  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10156583786010742  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9048218727111816  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10124874114990234  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9056320190429688  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10107946395874023  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9039239883422852  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10137224197387695  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9073443412780762  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10115289688110352  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9047374725341797  GigaBytes
Max Memory Allocated: 1.0443916320800781  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07711687684059143 |0.01389843225479126 |0.003844708204269409 |0.00010126829147338867 |0.0038073360919952393 |0.0015146732330322266 |
----------------------------------------------------------pseudo_mini_loss sum 1.2160003185272217
Total (block generation + training)time/epoch 20.366064643859865
Training time/epoch 0.8633229732513428
Training time without block to device /epoch 0.7521355152130127
Training time without total dataloading part /epoch 0.06354117393493652
load block tensor time/epoch 0.6169350147247314
block to device time/epoch 0.11118745803833008
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 29 |
Number of nodes for computation during this epoch:  2956753
Number of first layer input nodes during this epoch:  1283807
