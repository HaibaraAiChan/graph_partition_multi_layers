Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1647762514.6394312
ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026918411254882812
random selection method range initialization spend 0.0060253143310546875
time for parepare:  0.018743038177490234
local_output_nid generation:  0.008904218673706055
local_in_edges_tensor generation:  0.009808540344238281
mini_batch_src_global generation:  0.0073699951171875
r_  generation:  0.09154129028320312
local_output_nid generation:  0.012610197067260742
local_in_edges_tensor generation:  0.006102800369262695
mini_batch_src_global generation:  0.00938105583190918
r_  generation:  0.09618115425109863
local_output_nid generation:  0.011723041534423828
local_in_edges_tensor generation:  0.006033658981323242
mini_batch_src_global generation:  0.007619619369506836
r_  generation:  0.09975123405456543
local_output_nid generation:  0.011802434921264648
local_in_edges_tensor generation:  0.0062406063079833984
mini_batch_src_global generation:  0.008234500885009766
r_  generation:  0.10279488563537598
----------------------check_connections_block total spend ----------------------------- 0.6020865440368652
generate_one_block  0.1166071891784668
generate_one_block  0.11431002616882324
generate_one_block  0.11600375175476074
generate_one_block  0.11615109443664551
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04641604423522949
gen group dst list time:  0.011519670486450195
time for parepare:  0.0189206600189209
local_output_nid generation:  0.020255565643310547
local_in_edges_tensor generation:  0.05051088333129883
mini_batch_src_global generation:  0.044814109802246094
r_  generation:  0.4677557945251465
local_output_nid generation:  0.02667713165283203
local_in_edges_tensor generation:  0.04855489730834961
mini_batch_src_global generation:  0.05629563331604004
r_  generation:  0.4876587390899658
local_output_nid generation:  0.026318788528442383
local_in_edges_tensor generation:  0.04387927055358887
mini_batch_src_global generation:  0.058973073959350586
r_  generation:  0.4856407642364502
local_output_nid generation:  0.026452064514160156
local_in_edges_tensor generation:  0.044130563735961914
mini_batch_src_global generation:  0.057543277740478516
r_  generation:  0.49197816848754883
----------------------check_connections_block total spend ----------------------------- 2.8740217685699463
generate_one_block  0.6653563976287842
generate_one_block  0.6257154941558838
generate_one_block  0.6282203197479248
generate_one_block  0.6344420909881592
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03810930252075195
gen group dst list time:  0.021201372146606445
time for parepare:  0.0189511775970459
local_output_nid generation:  0.029301881790161133
local_in_edges_tensor generation:  0.05018734931945801
mini_batch_src_global generation:  0.05706000328063965
r_  generation:  0.5629892349243164
local_output_nid generation:  0.037596940994262695
local_in_edges_tensor generation:  0.05890703201293945
mini_batch_src_global generation:  0.06465744972229004
r_  generation:  0.5705089569091797
local_output_nid generation:  0.03687429428100586
local_in_edges_tensor generation:  0.04718613624572754
mini_batch_src_global generation:  0.06642031669616699
r_  generation:  0.5747523307800293
local_output_nid generation:  0.03740835189819336
local_in_edges_tensor generation:  0.03928041458129883
mini_batch_src_global generation:  0.06549859046936035
r_  generation:  0.5728070735931396
----------------------check_connections_block total spend ----------------------------- 3.39802885055542
generate_one_block  0.7251284122467041
generate_one_block  0.7431285381317139
generate_one_block  0.7311513423919678
generate_one_block  0.7224605083465576
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  6.272050619125366
block generation total time  5.475603103637695
average batch blocks generation time:  1.3689007759094238
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2030029296875 GB
    Memory Allocated: 0.10723161697387695  GigaBytes
Max Memory Allocated: 0.10723161697387695  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 1.1464695930480957  GigaBytes
Max Memory Allocated: 1.2407097816467285  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1346435546875 GB
    Memory Allocated: 0.11111593246459961  GigaBytes
Max Memory Allocated: 1.3518671989440918  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1346435546875 GB
    Memory Allocated: 1.1415395736694336  GigaBytes
Max Memory Allocated: 1.3518671989440918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1346435546875 GB
    Memory Allocated: 0.11138534545898438  GigaBytes
Max Memory Allocated: 1.3518671989440918  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1346435546875 GB
    Memory Allocated: 1.1447319984436035  GigaBytes
Max Memory Allocated: 1.3518671989440918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1346435546875 GB
    Memory Allocated: 0.11216020584106445  GigaBytes
Max Memory Allocated: 1.3518671989440918  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1346435546875 GB
    Memory Allocated: 1.1424560546875  GigaBytes
Max Memory Allocated: 1.3518671989440918  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.065074622631073 |0.08547163009643555 |0.1891995072364807 |0.00011175870895385742 |0.02934938669204712 |0.002287626266479492 |
----------------------------------------------------------pseudo_mini_loss sum 6.177303791046143
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1723121
Number of first layer input nodes during this epoch:  663019
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1365966796875 GB
    Memory Allocated: 0.15565156936645508  GigaBytes
Max Memory Allocated: 1.3518671989440918  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04167032241821289
random selection method range initialization spend 0.0048580169677734375
time for parepare:  0.018662691116333008
local_output_nid generation:  0.013005495071411133
local_in_edges_tensor generation:  0.01824951171875
mini_batch_src_global generation:  0.011315107345581055
r_  generation:  0.09177255630493164
local_output_nid generation:  0.011698007583618164
local_in_edges_tensor generation:  0.010420083999633789
mini_batch_src_global generation:  0.009877443313598633
r_  generation:  0.09662461280822754
local_output_nid generation:  0.011963605880737305
local_in_edges_tensor generation:  0.00634765625
mini_batch_src_global generation:  0.007842540740966797
r_  generation:  0.09885668754577637
local_output_nid generation:  0.011918067932128906
local_in_edges_tensor generation:  0.006632804870605469
mini_batch_src_global generation:  0.009189367294311523
r_  generation:  0.10211324691772461
----------------------check_connections_block total spend ----------------------------- 0.6280412673950195
generate_one_block  0.12346220016479492
generate_one_block  0.11978459358215332
generate_one_block  0.11476635932922363
generate_one_block  0.1173560619354248
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.06498003005981445
gen group dst list time:  0.01187586784362793
time for parepare:  0.0190277099609375
local_output_nid generation:  0.020184755325317383
local_in_edges_tensor generation:  0.05387687683105469
mini_batch_src_global generation:  0.04976034164428711
r_  generation:  0.474071741104126
local_output_nid generation:  0.026882171630859375
local_in_edges_tensor generation:  0.04775047302246094
mini_batch_src_global generation:  0.05686759948730469
r_  generation:  0.4896233081817627
local_output_nid generation:  0.02676987648010254
local_in_edges_tensor generation:  0.03918790817260742
mini_batch_src_global generation:  0.05592226982116699
r_  generation:  0.4923210144042969
local_output_nid generation:  0.026814699172973633
local_in_edges_tensor generation:  0.041194915771484375
mini_batch_src_global generation:  0.0602114200592041
r_  generation:  0.5023460388183594
----------------------check_connections_block total spend ----------------------------- 2.9112563133239746
generate_one_block  0.656296968460083
generate_one_block  0.6414012908935547
generate_one_block  0.6972196102142334
generate_one_block  0.6344900131225586
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05535125732421875
gen group dst list time:  0.021932363510131836
time for parepare:  0.019073963165283203
local_output_nid generation:  0.03089427947998047
local_in_edges_tensor generation:  0.05643439292907715
mini_batch_src_global generation:  0.056075334548950195
r_  generation:  0.567091703414917
local_output_nid generation:  0.0382077693939209
local_in_edges_tensor generation:  0.06076359748840332
mini_batch_src_global generation:  0.06752157211303711
r_  generation:  0.58408522605896
local_output_nid generation:  0.03888821601867676
local_in_edges_tensor generation:  0.06169414520263672
mini_batch_src_global generation:  0.06862425804138184
r_  generation:  0.5873970985412598
local_output_nid generation:  0.03987598419189453
local_in_edges_tensor generation:  0.048352956771850586
mini_batch_src_global generation:  0.0635232925415039
r_  generation:  0.5800116062164307
----------------------check_connections_block total spend ----------------------------- 3.48992657661438
generate_one_block  0.7281074523925781
generate_one_block  0.744279146194458
generate_one_block  0.7270774841308594
generate_one_block  0.7241039276123047
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1365966796875 GB
    Memory Allocated: 0.15565156936645508  GigaBytes
Max Memory Allocated: 1.3518671989440918  GigaBytes

connection checking time:  6.4011828899383545
block generation total time  5.55297589302063
average batch blocks generation time:  1.3882439732551575
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1365966796875 GB
    Memory Allocated: 0.11288833618164062  GigaBytes
Max Memory Allocated: 1.3518671989440918  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1365966796875 GB
    Memory Allocated: 1.1476988792419434  GigaBytes
Max Memory Allocated: 1.3518671989440918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11299514770507812  GigaBytes
Max Memory Allocated: 1.3528189659118652  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 1.1473612785339355  GigaBytes
Max Memory Allocated: 1.3528189659118652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11372661590576172  GigaBytes
Max Memory Allocated: 1.3528189659118652  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1431446075439453  GigaBytes
Max Memory Allocated: 1.3528189659118652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11273622512817383  GigaBytes
Max Memory Allocated: 1.3528189659118652  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.144005298614502  GigaBytes
Max Memory Allocated: 1.3528189659118652  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08129090070724487 |0.022987008094787598 |0.0040528178215026855 |9.495019912719727e-05 |0.02008998394012451 |0.001558065414428711 |
----------------------------------------------------------pseudo_mini_loss sum 3.2319321632385254
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  1722757
Number of first layer input nodes during this epoch:  662992
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.15514659881591797  GigaBytes
Max Memory Allocated: 1.3528189659118652  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02569127082824707
random selection method range initialization spend 0.0050351619720458984
time for parepare:  0.018269777297973633
local_output_nid generation:  0.00856637954711914
local_in_edges_tensor generation:  0.01244974136352539
mini_batch_src_global generation:  0.0076448917388916016
r_  generation:  0.09200048446655273
local_output_nid generation:  0.011755704879760742
local_in_edges_tensor generation:  0.0065555572509765625
mini_batch_src_global generation:  0.010448694229125977
r_  generation:  0.10012197494506836
local_output_nid generation:  0.012289762496948242
local_in_edges_tensor generation:  0.0065767765045166016
mini_batch_src_global generation:  0.007863283157348633
r_  generation:  0.10278844833374023
local_output_nid generation:  0.01188516616821289
local_in_edges_tensor generation:  0.0065076351165771484
mini_batch_src_global generation:  0.008710145950317383
r_  generation:  0.10584640502929688
----------------------check_connections_block total spend ----------------------------- 0.6217062473297119
generate_one_block  0.11400651931762695
generate_one_block  0.1201925277709961
generate_one_block  0.11910581588745117
generate_one_block  0.11692214012145996
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.047521352767944336
gen group dst list time:  0.013483524322509766
time for parepare:  0.02037978172302246
local_output_nid generation:  0.021805286407470703
local_in_edges_tensor generation:  0.04763531684875488
mini_batch_src_global generation:  0.04820060729980469
r_  generation:  0.4679853916168213
local_output_nid generation:  0.028662681579589844
local_in_edges_tensor generation:  0.04513072967529297
mini_batch_src_global generation:  0.058686256408691406
r_  generation:  0.4921891689300537
local_output_nid generation:  0.029051542282104492
local_in_edges_tensor generation:  0.02984023094177246
mini_batch_src_global generation:  0.05663251876831055
r_  generation:  0.49083733558654785
local_output_nid generation:  0.02897787094116211
local_in_edges_tensor generation:  0.03220224380493164
mini_batch_src_global generation:  0.05862092971801758
r_  generation:  0.49744749069213867
----------------------check_connections_block total spend ----------------------------- 2.875504732131958
generate_one_block  0.6337621212005615
generate_one_block  0.6285526752471924
generate_one_block  0.6557521820068359
generate_one_block  0.6253588199615479
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04293465614318848
gen group dst list time:  0.022146224975585938
time for parepare:  0.01912713050842285
local_output_nid generation:  0.0312192440032959
local_in_edges_tensor generation:  0.04587602615356445
mini_batch_src_global generation:  0.053658485412597656
r_  generation:  0.5646028518676758
local_output_nid generation:  0.03947615623474121
local_in_edges_tensor generation:  0.04837322235107422
mini_batch_src_global generation:  0.06487250328063965
r_  generation:  0.5847475528717041
local_output_nid generation:  0.037769317626953125
local_in_edges_tensor generation:  0.0487215518951416
mini_batch_src_global generation:  0.0634756088256836
r_  generation:  0.5732576847076416
local_output_nid generation:  0.037722110748291016
local_in_edges_tensor generation:  0.04390764236450195
mini_batch_src_global generation:  0.06375813484191895
r_  generation:  0.5782434940338135
----------------------check_connections_block total spend ----------------------------- 3.4091904163360596
generate_one_block  0.7303891181945801
generate_one_block  0.7381646633148193
generate_one_block  0.7366740703582764
generate_one_block  0.7436041831970215
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.15514659881591797  GigaBytes
Max Memory Allocated: 1.3528189659118652  GigaBytes

connection checking time:  6.284695148468018
block generation total time  5.492257833480835
average batch blocks generation time:  1.3730644583702087
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11290693283081055  GigaBytes
Max Memory Allocated: 1.3528189659118652  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1454644203186035  GigaBytes
Max Memory Allocated: 1.3528189659118652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11384820938110352  GigaBytes
Max Memory Allocated: 1.3528189659118652  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1428937911987305  GigaBytes
Max Memory Allocated: 1.3528189659118652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11282920837402344  GigaBytes
Max Memory Allocated: 1.3528189659118652  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1478338241577148  GigaBytes
Max Memory Allocated: 1.3528189659118652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11294126510620117  GigaBytes
Max Memory Allocated: 1.353078842163086  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.145942211151123  GigaBytes
Max Memory Allocated: 1.353078842163086  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09777748584747314 |0.01604294776916504 |0.0033456087112426758 |9.185075759887695e-05 |0.0036527514457702637 |0.0030393600463867188 |
----------------------------------------------------------pseudo_mini_loss sum 2.617412567138672
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  1722061
Number of first layer input nodes during this epoch:  662731
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.15738439559936523  GigaBytes
Max Memory Allocated: 1.353078842163086  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03316378593444824
random selection method range initialization spend 0.005667686462402344
time for parepare:  0.018323898315429688
local_output_nid generation:  0.008415460586547852
local_in_edges_tensor generation:  0.008772134780883789
mini_batch_src_global generation:  0.007700443267822266
r_  generation:  0.09251093864440918
local_output_nid generation:  0.012192726135253906
local_in_edges_tensor generation:  0.0062716007232666016
mini_batch_src_global generation:  0.010252714157104492
r_  generation:  0.09839868545532227
local_output_nid generation:  0.011953353881835938
local_in_edges_tensor generation:  0.006316661834716797
mini_batch_src_global generation:  0.007934808731079102
r_  generation:  0.10341167449951172
local_output_nid generation:  0.011904478073120117
local_in_edges_tensor generation:  0.006243467330932617
mini_batch_src_global generation:  0.008939027786254883
r_  generation:  0.10514593124389648
----------------------check_connections_block total spend ----------------------------- 0.6166422367095947
generate_one_block  0.11375641822814941
generate_one_block  0.11565804481506348
generate_one_block  0.11710667610168457
generate_one_block  0.11661148071289062
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04415416717529297
gen group dst list time:  0.011631965637207031
time for parepare:  0.019819021224975586
local_output_nid generation:  0.021893978118896484
local_in_edges_tensor generation:  0.04626798629760742
mini_batch_src_global generation:  0.049213409423828125
r_  generation:  0.4775688648223877
local_output_nid generation:  0.03269195556640625
local_in_edges_tensor generation:  0.040674448013305664
mini_batch_src_global generation:  0.05998110771179199
r_  generation:  0.48650097846984863
local_output_nid generation:  0.031103134155273438
local_in_edges_tensor generation:  0.03162264823913574
mini_batch_src_global generation:  0.07723808288574219
r_  generation:  0.4923074245452881
local_output_nid generation:  0.03198814392089844
local_in_edges_tensor generation:  0.0407109260559082
mini_batch_src_global generation:  0.061557769775390625
r_  generation:  0.4913454055786133
----------------------check_connections_block total spend ----------------------------- 2.920156240463257
generate_one_block  0.6456658840179443
generate_one_block  0.6296646595001221
generate_one_block  0.657947301864624
generate_one_block  0.6228969097137451
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03521227836608887
gen group dst list time:  0.021623611450195312
time for parepare:  0.020302534103393555
local_output_nid generation:  0.03169965744018555
local_in_edges_tensor generation:  0.05302929878234863
mini_batch_src_global generation:  0.05502772331237793
r_  generation:  0.5666086673736572
local_output_nid generation:  0.04200387001037598
local_in_edges_tensor generation:  0.051156044006347656
mini_batch_src_global generation:  0.06782221794128418
r_  generation:  0.5714774131774902
local_output_nid generation:  0.04249310493469238
local_in_edges_tensor generation:  0.04903221130371094
mini_batch_src_global generation:  0.06737828254699707
r_  generation:  0.5786421298980713
local_output_nid generation:  0.04261183738708496
local_in_edges_tensor generation:  0.04118466377258301
mini_batch_src_global generation:  0.06394648551940918
r_  generation:  0.5782120227813721
----------------------check_connections_block total spend ----------------------------- 3.4328601360321045
generate_one_block  0.7263860702514648
generate_one_block  0.7257695198059082
generate_one_block  0.7322869300842285
generate_one_block  0.7269043922424316
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.15738439559936523  GigaBytes
Max Memory Allocated: 1.353078842163086  GigaBytes

connection checking time:  6.353016376495361
block generation total time  5.467521667480469
average batch blocks generation time:  1.3668804168701172
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.1138143539428711  GigaBytes
Max Memory Allocated: 1.353078842163086  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1441845893859863  GigaBytes
Max Memory Allocated: 1.353078842163086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11278295516967773  GigaBytes
Max Memory Allocated: 1.353078842163086  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.141587257385254  GigaBytes
Max Memory Allocated: 1.353078842163086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11295890808105469  GigaBytes
Max Memory Allocated: 1.353078842163086  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1496782302856445  GigaBytes
Max Memory Allocated: 1.353078842163086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11382055282592773  GigaBytes
Max Memory Allocated: 1.354738712310791  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1432652473449707  GigaBytes
Max Memory Allocated: 1.354738712310791  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08746170997619629 |0.019766390323638916 |0.004389703273773193 |0.00010627508163452148 |0.0034329891204833984 |0.0014231204986572266 |
----------------------------------------------------------pseudo_mini_loss sum 2.3772780895233154
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  1721452
Number of first layer input nodes during this epoch:  662813
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.15549087524414062  GigaBytes
Max Memory Allocated: 1.354738712310791  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02414560317993164
random selection method range initialization spend 0.0058476924896240234
time for parepare:  0.019334793090820312
local_output_nid generation:  0.008791446685791016
local_in_edges_tensor generation:  0.008948564529418945
mini_batch_src_global generation:  0.007557392120361328
r_  generation:  0.09820890426635742
local_output_nid generation:  0.011821508407592773
local_in_edges_tensor generation:  0.006360530853271484
mini_batch_src_global generation:  0.012473344802856445
r_  generation:  0.10038518905639648
local_output_nid generation:  0.012334823608398438
local_in_edges_tensor generation:  0.0064618587493896484
mini_batch_src_global generation:  0.009205102920532227
r_  generation:  0.10342836380004883
local_output_nid generation:  0.012073516845703125
local_in_edges_tensor generation:  0.006684303283691406
mini_batch_src_global generation:  0.010621309280395508
r_  generation:  0.10681343078613281
----------------------check_connections_block total spend ----------------------------- 0.6345391273498535
generate_one_block  0.11805510520935059
generate_one_block  0.1175236701965332
generate_one_block  0.12069869041442871
generate_one_block  0.11793160438537598
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04785466194152832
gen group dst list time:  0.011664152145385742
time for parepare:  0.020491838455200195
local_output_nid generation:  0.021680355072021484
local_in_edges_tensor generation:  0.05491948127746582
mini_batch_src_global generation:  0.047669172286987305
r_  generation:  0.47224974632263184
local_output_nid generation:  0.029263019561767578
local_in_edges_tensor generation:  0.042635440826416016
mini_batch_src_global generation:  0.0557401180267334
r_  generation:  0.4815938472747803
local_output_nid generation:  0.02645564079284668
local_in_edges_tensor generation:  0.036690711975097656
mini_batch_src_global generation:  0.05576133728027344
r_  generation:  0.494051456451416
local_output_nid generation:  0.027390718460083008
local_in_edges_tensor generation:  0.042233943939208984
mini_batch_src_global generation:  0.056542158126831055
r_  generation:  0.496929407119751
----------------------check_connections_block total spend ----------------------------- 2.8971033096313477
generate_one_block  0.6547179222106934
generate_one_block  0.6337692737579346
generate_one_block  0.6573319435119629
generate_one_block  0.6359570026397705
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.048979759216308594
gen group dst list time:  0.02167224884033203
time for parepare:  0.01984572410583496
local_output_nid generation:  0.030637741088867188
local_in_edges_tensor generation:  0.06028604507446289
mini_batch_src_global generation:  0.052678585052490234
r_  generation:  0.5630021095275879
local_output_nid generation:  0.03753805160522461
local_in_edges_tensor generation:  0.05216073989868164
mini_batch_src_global generation:  0.0652303695678711
r_  generation:  0.5679538249969482
local_output_nid generation:  0.04197525978088379
local_in_edges_tensor generation:  0.04809427261352539
mini_batch_src_global generation:  0.0641477108001709
r_  generation:  0.5761919021606445
local_output_nid generation:  0.0380399227142334
local_in_edges_tensor generation:  0.04641246795654297
mini_batch_src_global generation:  0.07080578804016113
r_  generation:  0.5894272327423096
----------------------check_connections_block total spend ----------------------------- 3.4332315921783447
generate_one_block  0.7356705665588379
generate_one_block  0.7296757698059082
generate_one_block  0.7271614074707031
generate_one_block  0.7311811447143555
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.15549087524414062  GigaBytes
Max Memory Allocated: 1.354738712310791  GigaBytes

connection checking time:  6.330334901809692
block generation total time  5.505465030670166
average batch blocks generation time:  1.3763662576675415
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11274194717407227  GigaBytes
Max Memory Allocated: 1.354738712310791  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1429004669189453  GigaBytes
Max Memory Allocated: 1.354738712310791  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.1129603385925293  GigaBytes
Max Memory Allocated: 1.354738712310791  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1493349075317383  GigaBytes
Max Memory Allocated: 1.354738712310791  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11384916305541992  GigaBytes
Max Memory Allocated: 1.354738712310791  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.143235206604004  GigaBytes
Max Memory Allocated: 1.354738712310791  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11283349990844727  GigaBytes
Max Memory Allocated: 1.354738712310791  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1478142738342285  GigaBytes
Max Memory Allocated: 1.354738712310791  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09077030420303345 |0.023598790168762207 |0.0035220980644226074 |9.572505950927734e-05 |0.003730177879333496 |0.0018074512481689453 |
----------------------------------------------------------pseudo_mini_loss sum 2.1122798919677734
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  1722284
Number of first layer input nodes during this epoch:  662980
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.15526580810546875  GigaBytes
Max Memory Allocated: 1.354738712310791  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025355100631713867
random selection method range initialization spend 0.005356788635253906
time for parepare:  0.01914048194885254
local_output_nid generation:  0.00841212272644043
local_in_edges_tensor generation:  0.01074838638305664
mini_batch_src_global generation:  0.0074770450592041016
r_  generation:  0.0897526741027832
local_output_nid generation:  0.011778116226196289
local_in_edges_tensor generation:  0.006516456604003906
mini_batch_src_global generation:  0.011673688888549805
r_  generation:  0.09788846969604492
local_output_nid generation:  0.012268543243408203
local_in_edges_tensor generation:  0.006197690963745117
mini_batch_src_global generation:  0.007898092269897461
r_  generation:  0.10115504264831543
local_output_nid generation:  0.011804819107055664
local_in_edges_tensor generation:  0.00826716423034668
mini_batch_src_global generation:  0.00909423828125
r_  generation:  0.10669827461242676
----------------------check_connections_block total spend ----------------------------- 0.6196644306182861
generate_one_block  0.11954545974731445
generate_one_block  0.12089705467224121
generate_one_block  0.11914706230163574
generate_one_block  0.1181802749633789
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03781771659851074
gen group dst list time:  0.011776208877563477
time for parepare:  0.02080368995666504
local_output_nid generation:  0.022216320037841797
local_in_edges_tensor generation:  0.045310258865356445
mini_batch_src_global generation:  0.04723048210144043
r_  generation:  0.4903416633605957
local_output_nid generation:  0.030579805374145508
local_in_edges_tensor generation:  0.047324180603027344
mini_batch_src_global generation:  0.056227922439575195
r_  generation:  0.49323177337646484
local_output_nid generation:  0.02774214744567871
local_in_edges_tensor generation:  0.037235260009765625
mini_batch_src_global generation:  0.055826425552368164
r_  generation:  0.4888331890106201
local_output_nid generation:  0.027337074279785156
local_in_edges_tensor generation:  0.036008358001708984
mini_batch_src_global generation:  0.056844472885131836
r_  generation:  0.5070466995239258
----------------------check_connections_block total spend ----------------------------- 2.915189027786255
generate_one_block  0.6347553730010986
generate_one_block  0.6342401504516602
generate_one_block  0.6797804832458496
generate_one_block  0.6327037811279297
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03678250312805176
gen group dst list time:  0.021856069564819336
time for parepare:  0.019610881805419922
local_output_nid generation:  0.03249192237854004
local_in_edges_tensor generation:  0.0630795955657959
mini_batch_src_global generation:  0.05259132385253906
r_  generation:  0.5671029090881348
local_output_nid generation:  0.03773307800292969
local_in_edges_tensor generation:  0.05138063430786133
mini_batch_src_global generation:  0.06578993797302246
r_  generation:  0.5757288932800293
local_output_nid generation:  0.03765559196472168
local_in_edges_tensor generation:  0.05007648468017578
mini_batch_src_global generation:  0.06438374519348145
r_  generation:  0.5909039974212646
local_output_nid generation:  0.03979134559631348
local_in_edges_tensor generation:  0.03954291343688965
mini_batch_src_global generation:  0.06474661827087402
r_  generation:  0.5934710502624512
----------------------check_connections_block total spend ----------------------------- 3.4532134532928467
generate_one_block  0.7287147045135498
generate_one_block  0.7270646095275879
generate_one_block  0.7459518909454346
generate_one_block  0.7413725852966309
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.15526580810546875  GigaBytes
Max Memory Allocated: 1.354738712310791  GigaBytes

connection checking time:  6.368402481079102
block generation total time  5.524583578109741
average batch blocks generation time:  1.3811458945274353
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.1128544807434082  GigaBytes
Max Memory Allocated: 1.354738712310791  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1427178382873535  GigaBytes
Max Memory Allocated: 1.354738712310791  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.1138763427734375  GigaBytes
Max Memory Allocated: 1.354738712310791  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1479148864746094  GigaBytes
Max Memory Allocated: 1.354738712310791  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11280393600463867  GigaBytes
Max Memory Allocated: 1.354738712310791  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.147697925567627  GigaBytes
Max Memory Allocated: 1.354738712310791  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11295461654663086  GigaBytes
Max Memory Allocated: 1.354738712310791  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1456050872802734  GigaBytes
Max Memory Allocated: 1.354738712310791  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09121942520141602 |0.02694082260131836 |0.004203617572784424 |9.608268737792969e-05 |0.00373154878616333 |0.002796649932861328 |
----------------------------------------------------------pseudo_mini_loss sum 1.9575353860855103
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  1722002
Number of first layer input nodes during this epoch:  662855
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.1574711799621582  GigaBytes
Max Memory Allocated: 1.354738712310791  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02504420280456543
random selection method range initialization spend 0.005374431610107422
time for parepare:  0.018706560134887695
local_output_nid generation:  0.00862884521484375
local_in_edges_tensor generation:  0.01020503044128418
mini_batch_src_global generation:  0.007679462432861328
r_  generation:  0.09227609634399414
local_output_nid generation:  0.011954784393310547
local_in_edges_tensor generation:  0.007202863693237305
mini_batch_src_global generation:  0.010029077529907227
r_  generation:  0.10151362419128418
local_output_nid generation:  0.012328863143920898
local_in_edges_tensor generation:  0.006804704666137695
mini_batch_src_global generation:  0.007972002029418945
r_  generation:  0.10429883003234863
local_output_nid generation:  0.012365579605102539
local_in_edges_tensor generation:  0.006245613098144531
mini_batch_src_global generation:  0.008599519729614258
r_  generation:  0.10396289825439453
----------------------check_connections_block total spend ----------------------------- 0.6222243309020996
generate_one_block  0.11281180381774902
generate_one_block  0.11531662940979004
generate_one_block  0.11484670639038086
generate_one_block  0.11414718627929688
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0358424186706543
gen group dst list time:  0.011516332626342773
time for parepare:  0.0193026065826416
local_output_nid generation:  0.021715879440307617
local_in_edges_tensor generation:  0.04247307777404785
mini_batch_src_global generation:  0.04551434516906738
r_  generation:  0.4797072410583496
local_output_nid generation:  0.028222322463989258
local_in_edges_tensor generation:  0.033464670181274414
mini_batch_src_global generation:  0.057111501693725586
r_  generation:  0.49167847633361816
local_output_nid generation:  0.027013778686523438
local_in_edges_tensor generation:  0.03222846984863281
mini_batch_src_global generation:  0.05505657196044922
r_  generation:  0.4886195659637451
local_output_nid generation:  0.026760339736938477
local_in_edges_tensor generation:  0.02863025665283203
mini_batch_src_global generation:  0.05768418312072754
r_  generation:  0.5140683650970459
----------------------check_connections_block total spend ----------------------------- 2.870654582977295
generate_one_block  0.6440386772155762
generate_one_block  0.6366522312164307
generate_one_block  0.6608467102050781
generate_one_block  0.653017520904541
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.037729740142822266
gen group dst list time:  0.024358034133911133
time for parepare:  0.0190582275390625
local_output_nid generation:  0.0317690372467041
local_in_edges_tensor generation:  0.057589054107666016
mini_batch_src_global generation:  0.05447530746459961
r_  generation:  0.5654520988464355
local_output_nid generation:  0.03879737854003906
local_in_edges_tensor generation:  0.04833984375
mini_batch_src_global generation:  0.06501412391662598
r_  generation:  0.5755715370178223
local_output_nid generation:  0.038427114486694336
local_in_edges_tensor generation:  0.04104304313659668
mini_batch_src_global generation:  0.06826019287109375
r_  generation:  0.5749337673187256
local_output_nid generation:  0.03826904296875
local_in_edges_tensor generation:  0.039862632751464844
mini_batch_src_global generation:  0.06351280212402344
r_  generation:  0.5719194412231445
----------------------check_connections_block total spend ----------------------------- 3.4001846313476562
generate_one_block  0.7377347946166992
generate_one_block  0.7268815040588379
generate_one_block  0.7330076694488525
generate_one_block  0.7330188751220703
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.1574711799621582  GigaBytes
Max Memory Allocated: 1.354738712310791  GigaBytes

connection checking time:  6.270839214324951
block generation total time  5.525197982788086
average batch blocks generation time:  1.3812994956970215
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11393594741821289  GigaBytes
Max Memory Allocated: 1.354738712310791  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1481871604919434  GigaBytes
Max Memory Allocated: 1.354738712310791  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11278438568115234  GigaBytes
Max Memory Allocated: 1.354738712310791  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1473026275634766  GigaBytes
Max Memory Allocated: 1.354738712310791  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.1129617691040039  GigaBytes
Max Memory Allocated: 1.354738712310791  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1450185775756836  GigaBytes
Max Memory Allocated: 1.354738712310791  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11374711990356445  GigaBytes
Max Memory Allocated: 1.354738712310791  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.143613338470459  GigaBytes
Max Memory Allocated: 1.354738712310791  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09295636415481567 |0.021256327629089355 |0.0035390257835388184 |9.5367431640625e-05 |0.003621399402618408 |0.001332998275756836 |
----------------------------------------------------------pseudo_mini_loss sum 1.8754160404205322
 Run 0| Epoch 6 |
Number of nodes for computation during this epoch:  1722445
Number of first layer input nodes during this epoch:  662918
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.15550518035888672  GigaBytes
Max Memory Allocated: 1.354738712310791  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026194095611572266
random selection method range initialization spend 0.005486488342285156
time for parepare:  0.01994776725769043
local_output_nid generation:  0.008585214614868164
local_in_edges_tensor generation:  0.009290218353271484
mini_batch_src_global generation:  0.007692098617553711
r_  generation:  0.09262275695800781
local_output_nid generation:  0.012160778045654297
local_in_edges_tensor generation:  0.0065462589263916016
mini_batch_src_global generation:  0.010410070419311523
r_  generation:  0.10317087173461914
local_output_nid generation:  0.011835575103759766
local_in_edges_tensor generation:  0.006364583969116211
mini_batch_src_global generation:  0.007792472839355469
r_  generation:  0.1011495590209961
local_output_nid generation:  0.012321710586547852
local_in_edges_tensor generation:  0.006266117095947266
mini_batch_src_global generation:  0.010732173919677734
r_  generation:  0.10648679733276367
----------------------check_connections_block total spend ----------------------------- 0.6247458457946777
generate_one_block  0.1137533187866211
generate_one_block  0.11575770378112793
generate_one_block  0.11542367935180664
generate_one_block  0.1169595718383789
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03449368476867676
gen group dst list time:  0.011677265167236328
time for parepare:  0.01913905143737793
local_output_nid generation:  0.02136516571044922
local_in_edges_tensor generation:  0.04206252098083496
mini_batch_src_global generation:  0.04838967323303223
r_  generation:  0.4721355438232422
local_output_nid generation:  0.027409791946411133
local_in_edges_tensor generation:  0.03378701210021973
mini_batch_src_global generation:  0.05591177940368652
r_  generation:  0.48993492126464844
local_output_nid generation:  0.02652287483215332
local_in_edges_tensor generation:  0.029745817184448242
mini_batch_src_global generation:  0.059197187423706055
r_  generation:  0.4893672466278076
local_output_nid generation:  0.028496980667114258
local_in_edges_tensor generation:  0.0283358097076416
mini_batch_src_global generation:  0.0570979118347168
r_  generation:  0.5119597911834717
----------------------check_connections_block total spend ----------------------------- 2.867391586303711
generate_one_block  0.6667916774749756
generate_one_block  0.6438884735107422
generate_one_block  0.6574296951293945
generate_one_block  0.6298820972442627
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03462076187133789
gen group dst list time:  0.022356748580932617
time for parepare:  0.0222322940826416
local_output_nid generation:  0.03259539604187012
local_in_edges_tensor generation:  0.05983424186706543
mini_batch_src_global generation:  0.0562138557434082
r_  generation:  0.584193229675293
local_output_nid generation:  0.03863787651062012
local_in_edges_tensor generation:  0.05347037315368652
mini_batch_src_global generation:  0.06745791435241699
r_  generation:  0.5900344848632812
local_output_nid generation:  0.04247164726257324
local_in_edges_tensor generation:  0.04514431953430176
mini_batch_src_global generation:  0.06658673286437988
r_  generation:  0.5909996032714844
local_output_nid generation:  0.038471221923828125
local_in_edges_tensor generation:  0.04281258583068848
mini_batch_src_global generation:  0.06341195106506348
r_  generation:  0.5896790027618408
----------------------check_connections_block total spend ----------------------------- 3.4950952529907227
generate_one_block  0.7227373123168945
generate_one_block  0.7258815765380859
generate_one_block  0.7435173988342285
generate_one_block  0.7277119159698486
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.15550518035888672  GigaBytes
Max Memory Allocated: 1.354738712310791  GigaBytes

connection checking time:  6.362486839294434
block generation total time  5.517840147018433
average batch blocks generation time:  1.3794600367546082
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11286640167236328  GigaBytes
Max Memory Allocated: 1.354738712310791  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1478080749511719  GigaBytes
Max Memory Allocated: 1.354738712310791  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11287498474121094  GigaBytes
Max Memory Allocated: 1.354738712310791  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.142746925354004  GigaBytes
Max Memory Allocated: 1.354738712310791  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11385536193847656  GigaBytes
Max Memory Allocated: 1.354738712310791  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1443285942077637  GigaBytes
Max Memory Allocated: 1.354738712310791  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.1127781867980957  GigaBytes
Max Memory Allocated: 1.354738712310791  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1434402465820312  GigaBytes
Max Memory Allocated: 1.354738712310791  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09507030248641968 |0.02214193344116211 |0.0035463571548461914 |0.00010222196578979492 |0.0038535594940185547 |0.0018625259399414062 |
----------------------------------------------------------pseudo_mini_loss sum 1.801857829093933
 Run 0| Epoch 7 |
Number of nodes for computation during this epoch:  1721577
Number of first layer input nodes during this epoch:  662877
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.1552257537841797  GigaBytes
Max Memory Allocated: 1.354738712310791  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.05630898475646973
random selection method range initialization spend 0.0071868896484375
time for parepare:  0.021151304244995117
local_output_nid generation:  0.008567094802856445
local_in_edges_tensor generation:  0.018198013305664062
mini_batch_src_global generation:  0.009102344512939453
r_  generation:  0.08983206748962402
local_output_nid generation:  0.011858224868774414
local_in_edges_tensor generation:  0.006276607513427734
mini_batch_src_global generation:  0.010420083999633789
r_  generation:  0.09830188751220703
local_output_nid generation:  0.011918067932128906
local_in_edges_tensor generation:  0.006460666656494141
mini_batch_src_global generation:  0.007822513580322266
r_  generation:  0.10151195526123047
local_output_nid generation:  0.012327194213867188
local_in_edges_tensor generation:  0.0061511993408203125
mini_batch_src_global generation:  0.009128093719482422
r_  generation:  0.1038057804107666
----------------------check_connections_block total spend ----------------------------- 0.6415321826934814
generate_one_block  0.12052440643310547
generate_one_block  0.11488556861877441
generate_one_block  0.11751103401184082
generate_one_block  0.11573195457458496
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05604982376098633
gen group dst list time:  0.011595964431762695
time for parepare:  0.01903223991394043
local_output_nid generation:  0.020908355712890625
local_in_edges_tensor generation:  0.041712284088134766
mini_batch_src_global generation:  0.04869222640991211
r_  generation:  0.4629817008972168
local_output_nid generation:  0.02686023712158203
local_in_edges_tensor generation:  0.036962270736694336
mini_batch_src_global generation:  0.05847287178039551
r_  generation:  0.48069024085998535
local_output_nid generation:  0.02647233009338379
local_in_edges_tensor generation:  0.03343462944030762
mini_batch_src_global generation:  0.056061744689941406
r_  generation:  0.49176955223083496
local_output_nid generation:  0.0275576114654541
local_in_edges_tensor generation:  0.04423832893371582
mini_batch_src_global generation:  0.05896925926208496
r_  generation:  0.48808813095092773
----------------------check_connections_block total spend ----------------------------- 2.8429031372070312
generate_one_block  0.6365289688110352
generate_one_block  0.6312644481658936
generate_one_block  0.6729793548583984
generate_one_block  0.6226096153259277
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.037123680114746094
gen group dst list time:  0.024096250534057617
time for parepare:  0.020261526107788086
local_output_nid generation:  0.030572891235351562
local_in_edges_tensor generation:  0.06199979782104492
mini_batch_src_global generation:  0.054434776306152344
r_  generation:  0.5629658699035645
local_output_nid generation:  0.03763079643249512
local_in_edges_tensor generation:  0.04411792755126953
mini_batch_src_global generation:  0.064697265625
r_  generation:  0.5772497653961182
local_output_nid generation:  0.03780078887939453
local_in_edges_tensor generation:  0.04927659034729004
mini_batch_src_global generation:  0.06747961044311523
r_  generation:  0.5872011184692383
local_output_nid generation:  0.03959345817565918
local_in_edges_tensor generation:  0.046941280364990234
mini_batch_src_global generation:  0.06824827194213867
r_  generation:  0.5840480327606201
----------------------check_connections_block total spend ----------------------------- 3.445429563522339
generate_one_block  0.719515323638916
generate_one_block  0.7199556827545166
generate_one_block  0.7299509048461914
generate_one_block  0.7200131416320801
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.1552257537841797  GigaBytes
Max Memory Allocated: 1.354738712310791  GigaBytes

connection checking time:  6.28833270072937
block generation total time  5.452817440032959
average batch blocks generation time:  1.3632043600082397
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.1128072738647461  GigaBytes
Max Memory Allocated: 1.354738712310791  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1430153846740723  GigaBytes
Max Memory Allocated: 1.354738712310791  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11390399932861328  GigaBytes
Max Memory Allocated: 1.354738712310791  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1441841125488281  GigaBytes
Max Memory Allocated: 1.354738712310791  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11285257339477539  GigaBytes
Max Memory Allocated: 1.354738712310791  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1473889350891113  GigaBytes
Max Memory Allocated: 1.354738712310791  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11297273635864258  GigaBytes
Max Memory Allocated: 1.354738712310791  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1497879028320312  GigaBytes
Max Memory Allocated: 1.354738712310791  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09508967399597168 |0.022167623043060303 |0.0035824179649353027 |9.524822235107422e-05 |0.0038079023361206055 |0.0016334056854248047 |
----------------------------------------------------------pseudo_mini_loss sum 1.7078076601028442
 Run 0| Epoch 8 |
Number of nodes for computation during this epoch:  1722054
Number of first layer input nodes during this epoch:  662889
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.15743350982666016  GigaBytes
Max Memory Allocated: 1.3548541069030762  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024622440338134766
random selection method range initialization spend 0.005280017852783203
time for parepare:  0.017609357833862305
local_output_nid generation:  0.008668184280395508
local_in_edges_tensor generation:  0.010551929473876953
mini_batch_src_global generation:  0.007922172546386719
r_  generation:  0.08970451354980469
local_output_nid generation:  0.012070655822753906
local_in_edges_tensor generation:  0.006455421447753906
mini_batch_src_global generation:  0.010053157806396484
r_  generation:  0.09975171089172363
local_output_nid generation:  0.012296676635742188
local_in_edges_tensor generation:  0.006184577941894531
mini_batch_src_global generation:  0.007960319519042969
r_  generation:  0.09806942939758301
local_output_nid generation:  0.012312173843383789
local_in_edges_tensor generation:  0.006216764450073242
mini_batch_src_global generation:  0.008711814880371094
r_  generation:  0.10310912132263184
----------------------check_connections_block total spend ----------------------------- 0.6106891632080078
generate_one_block  0.11218404769897461
generate_one_block  0.11440277099609375
generate_one_block  0.1134793758392334
generate_one_block  0.1157066822052002
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04219627380371094
gen group dst list time:  0.011513710021972656
time for parepare:  0.02077198028564453
local_output_nid generation:  0.021448850631713867
local_in_edges_tensor generation:  0.04361748695373535
mini_batch_src_global generation:  0.06369757652282715
r_  generation:  0.4662961959838867
local_output_nid generation:  0.027313947677612305
local_in_edges_tensor generation:  0.03317618370056152
mini_batch_src_global generation:  0.05651497840881348
r_  generation:  0.49094319343566895
local_output_nid generation:  0.026578903198242188
local_in_edges_tensor generation:  0.027076244354248047
mini_batch_src_global generation:  0.0579526424407959
r_  generation:  0.4889791011810303
local_output_nid generation:  0.026723384857177734
local_in_edges_tensor generation:  0.02911067008972168
mini_batch_src_global generation:  0.05729222297668457
r_  generation:  0.49515771865844727
----------------------check_connections_block total spend ----------------------------- 2.8495283126831055
generate_one_block  0.6210408210754395
generate_one_block  0.6105775833129883
generate_one_block  0.6408772468566895
generate_one_block  0.6215417385101318
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.037837982177734375
gen group dst list time:  0.021720409393310547
time for parepare:  0.020101308822631836
local_output_nid generation:  0.030883073806762695
local_in_edges_tensor generation:  0.04851722717285156
mini_batch_src_global generation:  0.05546689033508301
r_  generation:  0.5607686042785645
local_output_nid generation:  0.03750300407409668
local_in_edges_tensor generation:  0.043024539947509766
mini_batch_src_global generation:  0.06542277336120605
r_  generation:  0.5739960670471191
local_output_nid generation:  0.03813505172729492
local_in_edges_tensor generation:  0.04462146759033203
mini_batch_src_global generation:  0.06743049621582031
r_  generation:  0.5789899826049805
local_output_nid generation:  0.03758883476257324
local_in_edges_tensor generation:  0.05166983604431152
mini_batch_src_global generation:  0.06427645683288574
r_  generation:  0.5785481929779053
----------------------check_connections_block total spend ----------------------------- 3.408930778503418
generate_one_block  0.7108609676361084
generate_one_block  0.719754695892334
generate_one_block  0.72430419921875
generate_one_block  0.7176556587219238
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.15743350982666016  GigaBytes
Max Memory Allocated: 1.3548541069030762  GigaBytes

connection checking time:  6.258459091186523
block generation total time  5.366612911224365
average batch blocks generation time:  1.3416532278060913
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11382293701171875  GigaBytes
Max Memory Allocated: 1.3548541069030762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1446208953857422  GigaBytes
Max Memory Allocated: 1.3548541069030762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11276435852050781  GigaBytes
Max Memory Allocated: 1.3548541069030762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.143357276916504  GigaBytes
Max Memory Allocated: 1.3548541069030762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11292743682861328  GigaBytes
Max Memory Allocated: 1.3548541069030762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.146132469177246  GigaBytes
Max Memory Allocated: 1.3548541069030762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11383819580078125  GigaBytes
Max Memory Allocated: 1.3548541069030762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1435456275939941  GigaBytes
Max Memory Allocated: 1.3548541069030762  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09210604429244995 |0.020909905433654785 |0.0035232901573181152 |9.071826934814453e-05 |0.0036313533782958984 |0.0012803077697753906 |
----------------------------------------------------------pseudo_mini_loss sum 1.6375932693481445
 Run 0| Epoch 9 |
Number of nodes for computation during this epoch:  1722053
Number of first layer input nodes during this epoch:  662870
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.15572261810302734  GigaBytes
Max Memory Allocated: 1.3548541069030762  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022837400436401367
random selection method range initialization spend 0.005311012268066406
time for parepare:  0.017694950103759766
local_output_nid generation:  0.008980274200439453
local_in_edges_tensor generation:  0.01277780532836914
mini_batch_src_global generation:  0.00785207748413086
r_  generation:  0.08980464935302734
local_output_nid generation:  0.011940240859985352
local_in_edges_tensor generation:  0.006192922592163086
mini_batch_src_global generation:  0.00983428955078125
r_  generation:  0.09639716148376465
local_output_nid generation:  0.011922359466552734
local_in_edges_tensor generation:  0.00621342658996582
mini_batch_src_global generation:  0.007731199264526367
r_  generation:  0.09924602508544922
local_output_nid generation:  0.011908769607543945
local_in_edges_tensor generation:  0.006177425384521484
mini_batch_src_global generation:  0.008893251419067383
r_  generation:  0.10450291633605957
----------------------check_connections_block total spend ----------------------------- 0.6086738109588623
generate_one_block  0.1137228012084961
generate_one_block  0.11364579200744629
generate_one_block  0.11523270606994629
generate_one_block  0.11708354949951172
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03331947326660156
gen group dst list time:  0.011530399322509766
time for parepare:  0.019197940826416016
local_output_nid generation:  0.021027326583862305
local_in_edges_tensor generation:  0.04015707969665527
mini_batch_src_global generation:  0.04538130760192871
r_  generation:  0.47888875007629395
local_output_nid generation:  0.027559757232666016
local_in_edges_tensor generation:  0.029939651489257812
mini_batch_src_global generation:  0.05610466003417969
r_  generation:  0.47414422035217285
local_output_nid generation:  0.026128768920898438
local_in_edges_tensor generation:  0.029225587844848633
mini_batch_src_global generation:  0.055719614028930664
r_  generation:  0.48334503173828125
local_output_nid generation:  0.02627110481262207
local_in_edges_tensor generation:  0.03355741500854492
mini_batch_src_global generation:  0.057852745056152344
r_  generation:  0.4843106269836426
----------------------check_connections_block total spend ----------------------------- 2.804621934890747
generate_one_block  0.6205673217773438
generate_one_block  0.6143851280212402
generate_one_block  0.6534442901611328
generate_one_block  0.6215019226074219
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03023362159729004
gen group dst list time:  0.021656274795532227
time for parepare:  0.01878190040588379
local_output_nid generation:  0.0299832820892334
local_in_edges_tensor generation:  0.04224395751953125
mini_batch_src_global generation:  0.05421900749206543
r_  generation:  0.5568532943725586
local_output_nid generation:  0.03725695610046387
local_in_edges_tensor generation:  0.05020737648010254
mini_batch_src_global generation:  0.06760597229003906
r_  generation:  0.5646278858184814
local_output_nid generation:  0.03744626045227051
local_in_edges_tensor generation:  0.03927183151245117
mini_batch_src_global generation:  0.06442975997924805
r_  generation:  0.5649795532226562
local_output_nid generation:  0.03740096092224121
local_in_edges_tensor generation:  0.040547847747802734
mini_batch_src_global generation:  0.06402802467346191
r_  generation:  0.5721306800842285
----------------------check_connections_block total spend ----------------------------- 3.347280740737915
generate_one_block  0.70867919921875
generate_one_block  0.7168629169464111
generate_one_block  0.7123010158538818
generate_one_block  0.7077925205230713
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.15572261810302734  GigaBytes
Max Memory Allocated: 1.3548541069030762  GigaBytes

connection checking time:  6.151902675628662
block generation total time  5.355534315109253
average batch blocks generation time:  1.3388835787773132
block dataloader generation time/epoch 13.429685831069946
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11281061172485352  GigaBytes
Max Memory Allocated: 1.3548541069030762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1473326683044434  GigaBytes
Max Memory Allocated: 1.3548541069030762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.1128988265991211  GigaBytes
Max Memory Allocated: 1.3548541069030762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1443910598754883  GigaBytes
Max Memory Allocated: 1.3548541069030762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.1138296127319336  GigaBytes
Max Memory Allocated: 1.3548541069030762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1477384567260742  GigaBytes
Max Memory Allocated: 1.3548541069030762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11284112930297852  GigaBytes
Max Memory Allocated: 1.3548541069030762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1479740142822266  GigaBytes
Max Memory Allocated: 1.3548541069030762  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09002971649169922 |0.014998257160186768 |0.0034672021865844727 |9.584426879882812e-05 |0.003537595272064209 |0.0028104782104492188 |
----------------------------------------------------------pseudo_mini_loss sum 1.5958399772644043
Total (block generation + training)time/epoch 13.969740152359009
Training time/epoch 0.5398409366607666
Training time without block to device /epoch 0.47984790802001953
Training time without total dataloading part /epoch 0.031213045120239258
load block tensor time/epoch 0.3601188659667969
block to device time/epoch 0.05999302864074707
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 10 |
Number of nodes for computation during this epoch:  1722996
Number of first layer input nodes during this epoch:  662856
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.15541839599609375  GigaBytes
Max Memory Allocated: 1.3548541069030762  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01872396469116211
random selection method range initialization spend 0.0052967071533203125
time for parepare:  0.018070220947265625
local_output_nid generation:  0.008907318115234375
local_in_edges_tensor generation:  0.008694887161254883
mini_batch_src_global generation:  0.007660627365112305
r_  generation:  0.08988451957702637
local_output_nid generation:  0.011655807495117188
local_in_edges_tensor generation:  0.006519794464111328
mini_batch_src_global generation:  0.009731531143188477
r_  generation:  0.09518837928771973
local_output_nid generation:  0.011640310287475586
local_in_edges_tensor generation:  0.006188869476318359
mini_batch_src_global generation:  0.007666349411010742
r_  generation:  0.10151982307434082
local_output_nid generation:  0.011888742446899414
local_in_edges_tensor generation:  0.006192445755004883
mini_batch_src_global generation:  0.008760929107666016
r_  generation:  0.10739302635192871
----------------------check_connections_block total spend ----------------------------- 0.6078290939331055
generate_one_block  0.11402344703674316
generate_one_block  0.11370158195495605
generate_one_block  0.11495399475097656
generate_one_block  0.1160590648651123
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03205156326293945
gen group dst list time:  0.01166987419128418
time for parepare:  0.01930999755859375
local_output_nid generation:  0.021150588989257812
local_in_edges_tensor generation:  0.035895586013793945
mini_batch_src_global generation:  0.045143842697143555
r_  generation:  0.46610212326049805
local_output_nid generation:  0.027225017547607422
local_in_edges_tensor generation:  0.0313725471496582
mini_batch_src_global generation:  0.05711793899536133
r_  generation:  0.4753575325012207
local_output_nid generation:  0.026328086853027344
local_in_edges_tensor generation:  0.02945709228515625
mini_batch_src_global generation:  0.05537676811218262
r_  generation:  0.48394298553466797
local_output_nid generation:  0.026628494262695312
local_in_edges_tensor generation:  0.02808094024658203
mini_batch_src_global generation:  0.056868791580200195
r_  generation:  0.493072509765625
----------------------check_connections_block total spend ----------------------------- 2.7960729598999023
generate_one_block  0.6243171691894531
generate_one_block  0.6115894317626953
generate_one_block  0.6428096294403076
generate_one_block  0.614973783493042
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03079509735107422
gen group dst list time:  0.021907806396484375
time for parepare:  0.018750905990600586
local_output_nid generation:  0.0299837589263916
local_in_edges_tensor generation:  0.04190683364868164
mini_batch_src_global generation:  0.05189990997314453
r_  generation:  0.5629796981811523
local_output_nid generation:  0.03718376159667969
local_in_edges_tensor generation:  0.037833452224731445
mini_batch_src_global generation:  0.0654153823852539
r_  generation:  0.5651919841766357
local_output_nid generation:  0.03728628158569336
local_in_edges_tensor generation:  0.03555488586425781
mini_batch_src_global generation:  0.06398296356201172
r_  generation:  0.572706937789917
local_output_nid generation:  0.0378878116607666
local_in_edges_tensor generation:  0.03630805015563965
mini_batch_src_global generation:  0.06377720832824707
r_  generation:  0.5695641040802002
----------------------check_connections_block total spend ----------------------------- 3.3312289714813232
generate_one_block  0.7096419334411621
generate_one_block  0.7086327075958252
generate_one_block  0.720426082611084
generate_one_block  0.7173967361450195
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.15541839599609375  GigaBytes
Max Memory Allocated: 1.3548541069030762  GigaBytes

connection checking time:  6.127301931381226
block generation total time  5.349787473678589
average batch blocks generation time:  1.3374468684196472
block dataloader generation time/epoch 13.386927485466003
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.1130228042602539  GigaBytes
Max Memory Allocated: 1.3548541069030762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1496071815490723  GigaBytes
Max Memory Allocated: 1.3548541069030762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11367034912109375  GigaBytes
Max Memory Allocated: 1.3548541069030762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1397242546081543  GigaBytes
Max Memory Allocated: 1.3548541069030762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11279106140136719  GigaBytes
Max Memory Allocated: 1.3548541069030762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1435561180114746  GigaBytes
Max Memory Allocated: 1.3548541069030762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.113067626953125  GigaBytes
Max Memory Allocated: 1.3548541069030762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1502065658569336  GigaBytes
Max Memory Allocated: 1.3548541069030762  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09530854225158691 |0.018558740615844727 |0.0034626126289367676 |8.958578109741211e-05 |0.00370633602142334 |0.001558065414428711 |
----------------------------------------------------------pseudo_mini_loss sum 1.552322506904602
Total (block generation + training)time/epoch 13.945211410522461
Training time/epoch 0.5763177871704102
Training time without block to device /epoch 0.5020828247070312
Training time without total dataloading part /epoch 0.03059220314025879
load block tensor time/epoch 0.38123416900634766
block to device time/epoch 0.0742349624633789
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 11 |
Number of nodes for computation during this epoch:  1721903
Number of first layer input nodes during this epoch:  662952
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.1575932502746582  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0321807861328125
random selection method range initialization spend 0.005254268646240234
time for parepare:  0.019634246826171875
local_output_nid generation:  0.008678197860717773
local_in_edges_tensor generation:  0.008365631103515625
mini_batch_src_global generation:  0.00768589973449707
r_  generation:  0.09269976615905762
local_output_nid generation:  0.011738061904907227
local_in_edges_tensor generation:  0.0060422420501708984
mini_batch_src_global generation:  0.010032415390014648
r_  generation:  0.09875369071960449
local_output_nid generation:  0.01175832748413086
local_in_edges_tensor generation:  0.0061376094818115234
mini_batch_src_global generation:  0.007883071899414062
r_  generation:  0.10127449035644531
local_output_nid generation:  0.011773109436035156
local_in_edges_tensor generation:  0.0064504146575927734
mini_batch_src_global generation:  0.008775472640991211
r_  generation:  0.10453581809997559
----------------------check_connections_block total spend ----------------------------- 0.6129820346832275
generate_one_block  0.11184263229370117
generate_one_block  0.11294198036193848
generate_one_block  0.11633634567260742
generate_one_block  0.11777567863464355
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03553009033203125
gen group dst list time:  0.011457443237304688
time for parepare:  0.019052505493164062
local_output_nid generation:  0.021863698959350586
local_in_edges_tensor generation:  0.04052257537841797
mini_batch_src_global generation:  0.04686713218688965
r_  generation:  0.4677746295928955
local_output_nid generation:  0.027521371841430664
local_in_edges_tensor generation:  0.030188322067260742
mini_batch_src_global generation:  0.05612301826477051
r_  generation:  0.4741952419281006
local_output_nid generation:  0.02655959129333496
local_in_edges_tensor generation:  0.029944181442260742
mini_batch_src_global generation:  0.05619382858276367
r_  generation:  0.5068264007568359
local_output_nid generation:  0.028939247131347656
local_in_edges_tensor generation:  0.028018474578857422
mini_batch_src_global generation:  0.05764007568359375
r_  generation:  0.48293495178222656
----------------------check_connections_block total spend ----------------------------- 2.8161163330078125
generate_one_block  0.6169877052307129
generate_one_block  0.6128737926483154
generate_one_block  0.6434462070465088
generate_one_block  0.6147627830505371
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03543448448181152
gen group dst list time:  0.02159261703491211
time for parepare:  0.01841568946838379
local_output_nid generation:  0.030007123947143555
local_in_edges_tensor generation:  0.053705692291259766
mini_batch_src_global generation:  0.05210447311401367
r_  generation:  0.5554304122924805
local_output_nid generation:  0.03739523887634277
local_in_edges_tensor generation:  0.04284381866455078
mini_batch_src_global generation:  0.06477141380310059
r_  generation:  0.5612668991088867
local_output_nid generation:  0.03736996650695801
local_in_edges_tensor generation:  0.038146257400512695
mini_batch_src_global generation:  0.06887316703796387
r_  generation:  0.5654959678649902
local_output_nid generation:  0.03736448287963867
local_in_edges_tensor generation:  0.03771781921386719
mini_batch_src_global generation:  0.06578731536865234
r_  generation:  0.5722782611846924
----------------------check_connections_block total spend ----------------------------- 3.3378424644470215
generate_one_block  0.7174551486968994
generate_one_block  0.7096366882324219
generate_one_block  0.7132127285003662
generate_one_block  0.7193131446838379
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.1575932502746582  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

connection checking time:  6.153958797454834
block generation total time  5.3476881980896
average batch blocks generation time:  1.3369220495224
block dataloader generation time/epoch 13.39873719215393
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11386728286743164  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.147745132446289  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11261463165283203  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1399245262145996  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11305570602416992  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.149850845336914  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11387395858764648  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1492276191711426  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0922359824180603 |0.015250980854034424 |0.0034543275833129883 |9.173154830932617e-05 |0.003652215003967285 |0.0014252662658691406 |
----------------------------------------------------------pseudo_mini_loss sum 1.5221781730651855
Total (block generation + training)time/epoch 13.954788128534952
Training time/epoch 0.5513098239898682
Training time without block to device /epoch 0.49030590057373047
Training time without total dataloading part /epoch 0.03021836280822754
load block tensor time/epoch 0.3689439296722412
block to device time/epoch 0.061003923416137695
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 12 |
Number of nodes for computation during this epoch:  1722544
Number of first layer input nodes during this epoch:  663023
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.15572786331176758  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021922826766967773
random selection method range initialization spend 0.005264759063720703
time for parepare:  0.017339706420898438
local_output_nid generation:  0.009035348892211914
local_in_edges_tensor generation:  0.009225130081176758
mini_batch_src_global generation:  0.007745265960693359
r_  generation:  0.09128689765930176
local_output_nid generation:  0.011702299118041992
local_in_edges_tensor generation:  0.006323337554931641
mini_batch_src_global generation:  0.010304927825927734
r_  generation:  0.0968942642211914
local_output_nid generation:  0.011745452880859375
local_in_edges_tensor generation:  0.006106376647949219
mini_batch_src_global generation:  0.007995367050170898
r_  generation:  0.10204434394836426
local_output_nid generation:  0.011778593063354492
local_in_edges_tensor generation:  0.006108283996582031
mini_batch_src_global generation:  0.009081602096557617
r_  generation:  0.10358476638793945
----------------------check_connections_block total spend ----------------------------- 0.6093556880950928
generate_one_block  0.11028313636779785
generate_one_block  0.11434602737426758
generate_one_block  0.11412239074707031
generate_one_block  0.11535906791687012
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.038649559020996094
gen group dst list time:  0.011736869812011719
time for parepare:  0.019109249114990234
local_output_nid generation:  0.020432233810424805
local_in_edges_tensor generation:  0.033797264099121094
mini_batch_src_global generation:  0.04689431190490723
r_  generation:  0.46195435523986816
local_output_nid generation:  0.02695631980895996
local_in_edges_tensor generation:  0.029430389404296875
mini_batch_src_global generation:  0.057348012924194336
r_  generation:  0.47542357444763184
local_output_nid generation:  0.026175737380981445
local_in_edges_tensor generation:  0.029340267181396484
mini_batch_src_global generation:  0.05641651153564453
r_  generation:  0.4879426956176758
local_output_nid generation:  0.026140928268432617
local_in_edges_tensor generation:  0.029453039169311523
mini_batch_src_global generation:  0.05607414245605469
r_  generation:  0.48266029357910156
----------------------check_connections_block total spend ----------------------------- 2.781714677810669
generate_one_block  0.6094441413879395
generate_one_block  0.6118407249450684
generate_one_block  0.6424148082733154
generate_one_block  0.6141390800476074
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02590155601501465
gen group dst list time:  0.021644115447998047
time for parepare:  0.018858671188354492
local_output_nid generation:  0.030158519744873047
local_in_edges_tensor generation:  0.04118824005126953
mini_batch_src_global generation:  0.05160260200500488
r_  generation:  0.5660159587860107
local_output_nid generation:  0.03756260871887207
local_in_edges_tensor generation:  0.03510308265686035
mini_batch_src_global generation:  0.0644385814666748
r_  generation:  0.5649511814117432
local_output_nid generation:  0.03793764114379883
local_in_edges_tensor generation:  0.0362091064453125
mini_batch_src_global generation:  0.06647181510925293
r_  generation:  0.5667426586151123
local_output_nid generation:  0.03752875328063965
local_in_edges_tensor generation:  0.03856658935546875
mini_batch_src_global generation:  0.06270051002502441
r_  generation:  0.5688905715942383
----------------------check_connections_block total spend ----------------------------- 3.3259074687957764
generate_one_block  0.7070858478546143
generate_one_block  0.7214698791503906
generate_one_block  0.703467845916748
generate_one_block  0.7082443237304688
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.15572786331176758  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

connection checking time:  6.107622146606445
block generation total time  5.318106651306152
average batch blocks generation time:  1.329526662826538
block dataloader generation time/epoch 13.376571834087372
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11278295516967773  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1439433097839355  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11298942565917969  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1462411880493164  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11384868621826172  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1440320014953613  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11281204223632812  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.14738130569458  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09038865566253662 |0.015215039253234863 |0.0032584071159362793 |8.809566497802734e-05 |0.0036427974700927734 |0.0012121200561523438 |
----------------------------------------------------------pseudo_mini_loss sum 1.4843740463256836
Total (block generation + training)time/epoch 13.929461061954498
Training time/epoch 0.5431962013244629
Training time without block to device /epoch 0.48233604431152344
Training time without total dataloading part /epoch 0.029169321060180664
load block tensor time/epoch 0.3615546226501465
block to device time/epoch 0.06086015701293945
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 13 |
Number of nodes for computation during this epoch:  1722881
Number of first layer input nodes during this epoch:  663031
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.15533971786499023  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.017307519912719727
random selection method range initialization spend 0.005316972732543945
time for parepare:  0.01782393455505371
local_output_nid generation:  0.00872659683227539
local_in_edges_tensor generation:  0.008382558822631836
mini_batch_src_global generation:  0.007642269134521484
r_  generation:  0.09013199806213379
local_output_nid generation:  0.011943340301513672
local_in_edges_tensor generation:  0.006169557571411133
mini_batch_src_global generation:  0.010013818740844727
r_  generation:  0.09823060035705566
local_output_nid generation:  0.01206207275390625
local_in_edges_tensor generation:  0.006136655807495117
mini_batch_src_global generation:  0.008009672164916992
r_  generation:  0.10051608085632324
local_output_nid generation:  0.012200593948364258
local_in_edges_tensor generation:  0.005978584289550781
mini_batch_src_global generation:  0.008772850036621094
r_  generation:  0.10389161109924316
----------------------check_connections_block total spend ----------------------------- 0.6073949337005615
generate_one_block  0.11112260818481445
generate_one_block  0.11419153213500977
generate_one_block  0.11333107948303223
generate_one_block  0.11603188514709473
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.028206348419189453
gen group dst list time:  0.011539459228515625
time for parepare:  0.01907634735107422
local_output_nid generation:  0.02120184898376465
local_in_edges_tensor generation:  0.03294801712036133
mini_batch_src_global generation:  0.04502153396606445
r_  generation:  0.4727020263671875
local_output_nid generation:  0.02829885482788086
local_in_edges_tensor generation:  0.02729654312133789
mini_batch_src_global generation:  0.05651378631591797
r_  generation:  0.48011255264282227
local_output_nid generation:  0.026333332061767578
local_in_edges_tensor generation:  0.02716970443725586
mini_batch_src_global generation:  0.055617570877075195
r_  generation:  0.48252391815185547
local_output_nid generation:  0.026661396026611328
local_in_edges_tensor generation:  0.02710723876953125
mini_batch_src_global generation:  0.05599617958068848
r_  generation:  0.4861149787902832
----------------------check_connections_block total spend ----------------------------- 2.7857775688171387
generate_one_block  0.6178171634674072
generate_one_block  0.6118152141571045
generate_one_block  0.6353116035461426
generate_one_block  0.6125702857971191
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030597209930419922
gen group dst list time:  0.0217897891998291
time for parepare:  0.019231319427490234
local_output_nid generation:  0.03003072738647461
local_in_edges_tensor generation:  0.0440058708190918
mini_batch_src_global generation:  0.05158877372741699
r_  generation:  0.5520370006561279
local_output_nid generation:  0.03774738311767578
local_in_edges_tensor generation:  0.04260969161987305
mini_batch_src_global generation:  0.06482100486755371
r_  generation:  0.5628354549407959
local_output_nid generation:  0.03744649887084961
local_in_edges_tensor generation:  0.038643836975097656
mini_batch_src_global generation:  0.06421375274658203
r_  generation:  0.5624692440032959
local_output_nid generation:  0.03831195831298828
local_in_edges_tensor generation:  0.03715801239013672
mini_batch_src_global generation:  0.06322669982910156
r_  generation:  0.573138952255249
----------------------check_connections_block total spend ----------------------------- 3.32662296295166
generate_one_block  0.7152867317199707
generate_one_block  0.7074184417724609
generate_one_block  0.710770845413208
generate_one_block  0.7159738540649414
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.15533971786499023  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

connection checking time:  6.112400531768799
block generation total time  5.3269641399383545
average batch blocks generation time:  1.3317410349845886
block dataloader generation time/epoch 13.357631826400757
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11291694641113281  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.144853115081787  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11396598815917969  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1480231285095215  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11269807815551758  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1408867835998535  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11302995681762695  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1498141288757324  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09022754430770874 |0.017628908157348633 |0.0033506155014038086 |8.612871170043945e-05 |0.003701329231262207 |0.0014147758483886719 |
----------------------------------------------------------pseudo_mini_loss sum 1.4594835042953491
Total (block generation + training)time/epoch 13.910521364212036
Training time/epoch 0.5526642799377441
Training time without block to device /epoch 0.4821486473083496
Training time without total dataloading part /epoch 0.029967069625854492
load block tensor time/epoch 0.36091017723083496
block to device time/epoch 0.07051563262939453
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 14 |
Number of nodes for computation during this epoch:  1722044
Number of first layer input nodes during this epoch:  663084
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.15756893157958984  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01923990249633789
random selection method range initialization spend 0.0052950382232666016
time for parepare:  0.01729726791381836
local_output_nid generation:  0.008687257766723633
local_in_edges_tensor generation:  0.008517980575561523
mini_batch_src_global generation:  0.00775146484375
r_  generation:  0.0902714729309082
local_output_nid generation:  0.01166987419128418
local_in_edges_tensor generation:  0.00629115104675293
mini_batch_src_global generation:  0.009873151779174805
r_  generation:  0.09686517715454102
local_output_nid generation:  0.011742115020751953
local_in_edges_tensor generation:  0.006247043609619141
mini_batch_src_global generation:  0.00781393051147461
r_  generation:  0.10205841064453125
local_output_nid generation:  0.01177978515625
local_in_edges_tensor generation:  0.006281852722167969
mini_batch_src_global generation:  0.008690595626831055
r_  generation:  0.10281205177307129
----------------------check_connections_block total spend ----------------------------- 0.6078202724456787
generate_one_block  0.11215090751647949
generate_one_block  0.11438965797424316
generate_one_block  0.11589646339416504
generate_one_block  0.11400532722473145
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03096461296081543
gen group dst list time:  0.011489152908325195
time for parepare:  0.019077301025390625
local_output_nid generation:  0.02106451988220215
local_in_edges_tensor generation:  0.03412365913391113
mini_batch_src_global generation:  0.04500436782836914
r_  generation:  0.4712519645690918
local_output_nid generation:  0.027695417404174805
local_in_edges_tensor generation:  0.03603005409240723
mini_batch_src_global generation:  0.05721879005432129
r_  generation:  0.48230528831481934
local_output_nid generation:  0.026297330856323242
local_in_edges_tensor generation:  0.029384613037109375
mini_batch_src_global generation:  0.05637359619140625
r_  generation:  0.5013339519500732
local_output_nid generation:  0.02646660804748535
local_in_edges_tensor generation:  0.030634164810180664
mini_batch_src_global generation:  0.05801677703857422
r_  generation:  0.48552584648132324
----------------------check_connections_block total spend ----------------------------- 2.827571153640747
generate_one_block  0.6132354736328125
generate_one_block  0.6209986209869385
generate_one_block  0.6473195552825928
generate_one_block  0.6145720481872559
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03424263000488281
gen group dst list time:  0.021809101104736328
time for parepare:  0.019418954849243164
local_output_nid generation:  0.029874563217163086
local_in_edges_tensor generation:  0.05129504203796387
mini_batch_src_global generation:  0.055040597915649414
r_  generation:  0.563011884689331
local_output_nid generation:  0.036965370178222656
local_in_edges_tensor generation:  0.043813467025756836
mini_batch_src_global generation:  0.06528830528259277
r_  generation:  0.5719931125640869
local_output_nid generation:  0.03676033020019531
local_in_edges_tensor generation:  0.04389810562133789
mini_batch_src_global generation:  0.06692767143249512
r_  generation:  0.5737893581390381
local_output_nid generation:  0.03662896156311035
local_in_edges_tensor generation:  0.04120016098022461
mini_batch_src_global generation:  0.06359052658081055
r_  generation:  0.57271409034729
----------------------check_connections_block total spend ----------------------------- 3.373462438583374
generate_one_block  0.724043607711792
generate_one_block  0.722083568572998
generate_one_block  0.7087423801422119
generate_one_block  0.7111287117004395
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.15756893157958984  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

connection checking time:  6.201033592224121
block generation total time  5.362123966217041
average batch blocks generation time:  1.3405309915542603
block dataloader generation time/epoch 13.373007774353027
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11376142501831055  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1418490409851074  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11280584335327148  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1474552154541016  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11301469802856445  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1497488021850586  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11379146575927734  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1435046195983887  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09583675861358643 |0.01579219102859497 |0.003418147563934326 |8.738040924072266e-05 |0.0036777853965759277 |0.0023725032806396484 |
----------------------------------------------------------pseudo_mini_loss sum 1.426159381866455
Total (block generation + training)time/epoch 13.928440491358439
Training time/epoch 0.5679376125335693
Training time without block to device /epoch 0.5047688484191895
Training time without total dataloading part /epoch 0.031105756759643555
load block tensor time/epoch 0.3833470344543457
block to device time/epoch 0.06316876411437988
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 15 |
Number of nodes for computation during this epoch:  1722055
Number of first layer input nodes during this epoch:  662830
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.15548229217529297  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022188901901245117
random selection method range initialization spend 0.005365133285522461
time for parepare:  0.017728090286254883
local_output_nid generation:  0.008576154708862305
local_in_edges_tensor generation:  0.01039886474609375
mini_batch_src_global generation:  0.008007287979125977
r_  generation:  0.09156632423400879
local_output_nid generation:  0.011758089065551758
local_in_edges_tensor generation:  0.006087779998779297
mini_batch_src_global generation:  0.010128974914550781
r_  generation:  0.09842109680175781
local_output_nid generation:  0.011928319931030273
local_in_edges_tensor generation:  0.00617218017578125
mini_batch_src_global generation:  0.008103609085083008
r_  generation:  0.10053253173828125
local_output_nid generation:  0.011893033981323242
local_in_edges_tensor generation:  0.006136655807495117
mini_batch_src_global generation:  0.008963346481323242
r_  generation:  0.10452914237976074
----------------------check_connections_block total spend ----------------------------- 0.6127867698669434
generate_one_block  0.11293601989746094
generate_one_block  0.11640691757202148
generate_one_block  0.1155691146850586
generate_one_block  0.11674332618713379
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.10272645950317383
gen group dst list time:  0.014188051223754883
time for parepare:  0.019859790802001953
local_output_nid generation:  0.02189922332763672
local_in_edges_tensor generation:  0.07211637496948242
mini_batch_src_global generation:  0.04773902893066406
r_  generation:  0.47172069549560547
local_output_nid generation:  0.02828073501586914
local_in_edges_tensor generation:  0.03316020965576172
mini_batch_src_global generation:  0.058669328689575195
r_  generation:  0.4833700656890869
local_output_nid generation:  0.02703714370727539
local_in_edges_tensor generation:  0.02999591827392578
mini_batch_src_global generation:  0.058524370193481445
r_  generation:  0.48735570907592773
local_output_nid generation:  0.02689194679260254
local_in_edges_tensor generation:  0.027395009994506836
mini_batch_src_global generation:  0.05932140350341797
r_  generation:  0.5003859996795654
----------------------check_connections_block total spend ----------------------------- 2.873202085494995
generate_one_block  0.6332869529724121
generate_one_block  0.6292526721954346
generate_one_block  0.646822452545166
generate_one_block  0.6262476444244385
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03120899200439453
gen group dst list time:  0.024029254913330078
time for parepare:  0.019090890884399414
local_output_nid generation:  0.030488967895507812
local_in_edges_tensor generation:  0.04744362831115723
mini_batch_src_global generation:  0.05673027038574219
r_  generation:  0.5665616989135742
local_output_nid generation:  0.037688493728637695
local_in_edges_tensor generation:  0.0445554256439209
mini_batch_src_global generation:  0.06992888450622559
r_  generation:  0.5726330280303955
local_output_nid generation:  0.038361310958862305
local_in_edges_tensor generation:  0.03571796417236328
mini_batch_src_global generation:  0.06461238861083984
r_  generation:  0.5786116123199463
local_output_nid generation:  0.038604736328125
local_in_edges_tensor generation:  0.036448001861572266
mini_batch_src_global generation:  0.06411552429199219
r_  generation:  0.5735485553741455
----------------------check_connections_block total spend ----------------------------- 3.380901336669922
generate_one_block  0.712630033493042
generate_one_block  0.7186427116394043
generate_one_block  0.7130870819091797
generate_one_block  0.7206628322601318
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.15548229217529297  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

connection checking time:  6.254103422164917
block generation total time  5.400632381439209
average batch blocks generation time:  1.3501580953598022
block dataloader generation time/epoch 13.40950894355774
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11279964447021484  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1475744247436523  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11300516128540039  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1463685035705566  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11373329162597656  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1414852142333984  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11287212371826172  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1474666595458984  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08783429861068726 |0.014794588088989258 |0.0035248994827270508 |9.107589721679688e-05 |0.003608524799346924 |0.00281524658203125 |
----------------------------------------------------------pseudo_mini_loss sum 1.3956378698349
Total (block generation + training)time/epoch 13.961769887379237
Training time/epoch 0.5330064296722412
Training time without block to device /epoch 0.4738280773162842
Training time without total dataloading part /epoch 0.031713247299194336
load block tensor time/epoch 0.351337194442749
block to device time/epoch 0.05917835235595703
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 16 |
Number of nodes for computation during this epoch:  1722391
Number of first layer input nodes during this epoch:  663065
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.1554427146911621  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02198505401611328
random selection method range initialization spend 0.005477190017700195
time for parepare:  0.019831180572509766
local_output_nid generation:  0.00981593132019043
local_in_edges_tensor generation:  0.009873390197753906
mini_batch_src_global generation:  0.008110761642456055
r_  generation:  0.09714674949645996
local_output_nid generation:  0.01600193977355957
local_in_edges_tensor generation:  0.007830381393432617
mini_batch_src_global generation:  0.01048898696899414
r_  generation:  0.1036374568939209
local_output_nid generation:  0.016582012176513672
local_in_edges_tensor generation:  0.007958650588989258
mini_batch_src_global generation:  0.008168220520019531
r_  generation:  0.10496664047241211
local_output_nid generation:  0.01671910285949707
local_in_edges_tensor generation:  0.007994890213012695
mini_batch_src_global generation:  0.008935689926147461
r_  generation:  0.10966944694519043
----------------------check_connections_block total spend ----------------------------- 0.658301591873169
generate_one_block  0.13223576545715332
generate_one_block  0.12001466751098633
generate_one_block  0.12164831161499023
generate_one_block  0.1169881820678711
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03090667724609375
gen group dst list time:  0.011896133422851562
time for parepare:  0.020188331604003906
local_output_nid generation:  0.022272109985351562
local_in_edges_tensor generation:  0.032892465591430664
mini_batch_src_global generation:  0.045632362365722656
r_  generation:  0.474672794342041
local_output_nid generation:  0.03070664405822754
local_in_edges_tensor generation:  0.02734518051147461
mini_batch_src_global generation:  0.05666637420654297
r_  generation:  0.5000567436218262
local_output_nid generation:  0.030185937881469727
local_in_edges_tensor generation:  0.03500509262084961
mini_batch_src_global generation:  0.06170201301574707
r_  generation:  0.5235557556152344
local_output_nid generation:  0.03319430351257324
local_in_edges_tensor generation:  0.03686404228210449
mini_batch_src_global generation:  0.06433820724487305
r_  generation:  0.49400758743286133
----------------------check_connections_block total spend ----------------------------- 2.922222137451172
generate_one_block  0.6446578502655029
generate_one_block  0.6267187595367432
generate_one_block  0.6674785614013672
generate_one_block  0.6284384727478027
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03973960876464844
gen group dst list time:  0.02268242835998535
time for parepare:  0.019598007202148438
local_output_nid generation:  0.03176569938659668
local_in_edges_tensor generation:  0.06003141403198242
mini_batch_src_global generation:  0.05279111862182617
r_  generation:  0.5852019786834717
local_output_nid generation:  0.04295849800109863
local_in_edges_tensor generation:  0.047365665435791016
mini_batch_src_global generation:  0.06843829154968262
r_  generation:  0.5722763538360596
local_output_nid generation:  0.039011478424072266
local_in_edges_tensor generation:  0.03956198692321777
mini_batch_src_global generation:  0.06419992446899414
r_  generation:  0.5863831043243408
local_output_nid generation:  0.038825035095214844
local_in_edges_tensor generation:  0.03875851631164551
mini_batch_src_global generation:  0.0640101432800293
r_  generation:  0.5824952125549316
----------------------check_connections_block total spend ----------------------------- 3.445120334625244
generate_one_block  0.7262892723083496
generate_one_block  0.7282087802886963
generate_one_block  0.7207334041595459
generate_one_block  0.7514605522155762
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.1554427146911621  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

connection checking time:  6.367342472076416
block generation total time  5.493985652923584
average batch blocks generation time:  1.373496413230896
block dataloader generation time/epoch 13.481530845165253
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11294746398925781  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1496763229370117  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11386251449584961  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.144442081451416  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11284828186035156  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1472620964050293  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11292314529418945  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1458086967468262  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09454840421676636 |0.02576059103012085 |0.003692805767059326 |9.781122207641602e-05 |0.0037403106689453125 |0.0029234886169433594 |
----------------------------------------------------------pseudo_mini_loss sum 1.3658311367034912
Total (block generation + training)time/epoch 14.040367931127548
Training time/epoch 0.6045715808868408
Training time without block to device /epoch 0.5015292167663574
Training time without total dataloading part /epoch 0.03304719924926758
load block tensor time/epoch 0.37819361686706543
block to device time/epoch 0.1030423641204834
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 17 |
Number of nodes for computation during this epoch:  1722663
Number of first layer input nodes during this epoch:  662925
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.1573939323425293  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024678468704223633
random selection method range initialization spend 0.004899024963378906
time for parepare:  0.019405841827392578
local_output_nid generation:  0.008738994598388672
local_in_edges_tensor generation:  0.015396833419799805
mini_batch_src_global generation:  0.010860204696655273
r_  generation:  0.11018133163452148
local_output_nid generation:  0.013415813446044922
local_in_edges_tensor generation:  0.006626129150390625
mini_batch_src_global generation:  0.011301755905151367
r_  generation:  0.1021888256072998
local_output_nid generation:  0.012044429779052734
local_in_edges_tensor generation:  0.006398200988769531
mini_batch_src_global generation:  0.008565664291381836
r_  generation:  0.10656404495239258
local_output_nid generation:  0.014355897903442383
local_in_edges_tensor generation:  0.006415605545043945
mini_batch_src_global generation:  0.010105371475219727
r_  generation:  0.11234068870544434
----------------------check_connections_block total spend ----------------------------- 0.6711299419403076
generate_one_block  0.1230461597442627
generate_one_block  0.11769294738769531
generate_one_block  0.1174612045288086
generate_one_block  0.12050223350524902
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03855323791503906
gen group dst list time:  0.011636734008789062
time for parepare:  0.019463062286376953
local_output_nid generation:  0.022141456604003906
local_in_edges_tensor generation:  0.04114484786987305
mini_batch_src_global generation:  0.047716379165649414
r_  generation:  0.48366641998291016
local_output_nid generation:  0.029439449310302734
local_in_edges_tensor generation:  0.0420687198638916
mini_batch_src_global generation:  0.057741403579711914
r_  generation:  0.5175120830535889
local_output_nid generation:  0.0303037166595459
local_in_edges_tensor generation:  0.04187273979187012
mini_batch_src_global generation:  0.06264829635620117
r_  generation:  0.4973149299621582
local_output_nid generation:  0.027940034866333008
local_in_edges_tensor generation:  0.03193545341491699
mini_batch_src_global generation:  0.07082629203796387
r_  generation:  0.4968373775482178
----------------------check_connections_block total spend ----------------------------- 2.9558122158050537
generate_one_block  0.6554911136627197
generate_one_block  0.6498069763183594
generate_one_block  0.6587002277374268
generate_one_block  0.626049280166626
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0367279052734375
gen group dst list time:  0.021963834762573242
time for parepare:  0.02091073989868164
local_output_nid generation:  0.03135395050048828
local_in_edges_tensor generation:  0.06484794616699219
mini_batch_src_global generation:  0.054602861404418945
r_  generation:  0.5762193202972412
local_output_nid generation:  0.03788280487060547
local_in_edges_tensor generation:  0.05416703224182129
mini_batch_src_global generation:  0.06578493118286133
r_  generation:  0.5764555931091309
local_output_nid generation:  0.04043412208557129
local_in_edges_tensor generation:  0.04544234275817871
mini_batch_src_global generation:  0.06545352935791016
r_  generation:  0.5898652076721191
local_output_nid generation:  0.03968501091003418
local_in_edges_tensor generation:  0.04824399948120117
mini_batch_src_global generation:  0.06407833099365234
r_  generation:  0.5850644111633301
----------------------check_connections_block total spend ----------------------------- 3.470871925354004
generate_one_block  0.752100944519043
generate_one_block  0.72670578956604
generate_one_block  0.7277483940124512
generate_one_block  0.7268519401550293
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.1573939323425293  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

connection checking time:  6.426684141159058
block generation total time  5.523454666137695
average batch blocks generation time:  1.3808636665344238
block dataloader generation time/epoch 13.550983190536499
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.1138768196105957  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1482195854187012  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.1127781867980957  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1437840461730957  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11294984817504883  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1463356018066406  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11379289627075195  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1417303085327148  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08793091773986816 |0.020792603492736816 |0.009736835956573486 |9.542703628540039e-05 |0.003778398036956787 |0.0017313957214355469 |
----------------------------------------------------------pseudo_mini_loss sum 1.3507883548736572
Total (block generation + training)time/epoch 14.1127466890547
Training time/epoch 0.5849034786224365
Training time without block to device /epoch 0.5017330646514893
Training time without total dataloading part /epoch 0.05617403984069824
load block tensor time/epoch 0.35172367095947266
block to device time/epoch 0.08317041397094727
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 18 |
Number of nodes for computation during this epoch:  1721977
Number of first layer input nodes during this epoch:  662769
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.15555095672607422  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0237274169921875
random selection method range initialization spend 0.004886150360107422
time for parepare:  0.018466472625732422
local_output_nid generation:  0.008668184280395508
local_in_edges_tensor generation:  0.011282920837402344
mini_batch_src_global generation:  0.0077321529388427734
r_  generation:  0.0918416976928711
local_output_nid generation:  0.011811017990112305
local_in_edges_tensor generation:  0.00676417350769043
mini_batch_src_global generation:  0.01014399528503418
r_  generation:  0.09830522537231445
local_output_nid generation:  0.011841535568237305
local_in_edges_tensor generation:  0.0061092376708984375
mini_batch_src_global generation:  0.00785207748413086
r_  generation:  0.10610508918762207
local_output_nid generation:  0.011962890625
local_in_edges_tensor generation:  0.006017446517944336
mini_batch_src_global generation:  0.008996725082397461
r_  generation:  0.10768938064575195
----------------------check_connections_block total spend ----------------------------- 0.6267566680908203
generate_one_block  0.11527490615844727
generate_one_block  0.11606550216674805
generate_one_block  0.11739587783813477
generate_one_block  0.11684823036193848
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03831744194030762
gen group dst list time:  0.011592626571655273
time for parepare:  0.019629955291748047
local_output_nid generation:  0.021647214889526367
local_in_edges_tensor generation:  0.03758955001831055
mini_batch_src_global generation:  0.044899940490722656
r_  generation:  0.4701731204986572
local_output_nid generation:  0.028189897537231445
local_in_edges_tensor generation:  0.028546810150146484
mini_batch_src_global generation:  0.056674957275390625
r_  generation:  0.4898552894592285
local_output_nid generation:  0.026976823806762695
local_in_edges_tensor generation:  0.029584407806396484
mini_batch_src_global generation:  0.05643153190612793
r_  generation:  0.4944419860839844
local_output_nid generation:  0.02675151824951172
local_in_edges_tensor generation:  0.029651880264282227
mini_batch_src_global generation:  0.05852317810058594
r_  generation:  0.49133896827697754
----------------------check_connections_block total spend ----------------------------- 2.830859899520874
generate_one_block  0.6122889518737793
generate_one_block  0.6293590068817139
generate_one_block  0.651658296585083
generate_one_block  0.621243953704834
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03464913368225098
gen group dst list time:  0.02240133285522461
time for parepare:  0.019384145736694336
local_output_nid generation:  0.030811071395874023
local_in_edges_tensor generation:  0.042938232421875
mini_batch_src_global generation:  0.05444931983947754
r_  generation:  0.5663979053497314
local_output_nid generation:  0.039702415466308594
local_in_edges_tensor generation:  0.0406951904296875
mini_batch_src_global generation:  0.06530213356018066
r_  generation:  0.5711479187011719
local_output_nid generation:  0.03834104537963867
local_in_edges_tensor generation:  0.03832650184631348
mini_batch_src_global generation:  0.0695338249206543
r_  generation:  0.574634313583374
local_output_nid generation:  0.03799176216125488
local_in_edges_tensor generation:  0.04376530647277832
mini_batch_src_global generation:  0.0667574405670166
r_  generation:  0.580878734588623
----------------------check_connections_block total spend ----------------------------- 3.388718843460083
generate_one_block  0.7237229347229004
generate_one_block  0.7402198314666748
generate_one_block  0.7225251197814941
generate_one_block  0.7257077693939209
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.15555095672607422  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

connection checking time:  6.219578742980957
block generation total time  5.4267258644104
average batch blocks generation time:  1.3566814661026
block dataloader generation time/epoch 13.557004761695861
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.1126713752746582  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1433515548706055  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.113037109375  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1464142799377441  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11385965347290039  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1479296684265137  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11275291442871094  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1439313888549805  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09596985578536987 |0.02155524492263794 |0.0036405324935913086 |9.22083854675293e-05 |0.003847956657409668 |0.0013175010681152344 |
----------------------------------------------------------pseudo_mini_loss sum 1.340935468673706
Total (block generation + training)time/epoch 14.1218932390213
Training time/epoch 0.5928113460540771
Training time without block to device /epoch 0.5065903663635254
Training time without total dataloading part /epoch 0.03164029121398926
load block tensor time/epoch 0.3838794231414795
block to device time/epoch 0.08622097969055176
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 19 |
Number of nodes for computation during this epoch:  1722631
Number of first layer input nodes during this epoch:  662868
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.1552262306213379  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022092580795288086
random selection method range initialization spend 0.004832267761230469
time for parepare:  0.017611026763916016
local_output_nid generation:  0.00894927978515625
local_in_edges_tensor generation:  0.01250314712524414
mini_batch_src_global generation:  0.007859230041503906
r_  generation:  0.09158062934875488
local_output_nid generation:  0.011739253997802734
local_in_edges_tensor generation:  0.007597684860229492
mini_batch_src_global generation:  0.009961843490600586
r_  generation:  0.09999585151672363
local_output_nid generation:  0.011924028396606445
local_in_edges_tensor generation:  0.0069141387939453125
mini_batch_src_global generation:  0.007870912551879883
r_  generation:  0.1013338565826416
local_output_nid generation:  0.011924266815185547
local_in_edges_tensor generation:  0.0071713924407958984
mini_batch_src_global generation:  0.008629083633422852
r_  generation:  0.10541176795959473
----------------------check_connections_block total spend ----------------------------- 0.6202397346496582
generate_one_block  0.1144261360168457
generate_one_block  0.11681866645812988
generate_one_block  0.12029242515563965
generate_one_block  0.11601924896240234
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03737449645996094
gen group dst list time:  0.011595010757446289
time for parepare:  0.019264698028564453
local_output_nid generation:  0.021884441375732422
local_in_edges_tensor generation:  0.03835034370422363
mini_batch_src_global generation:  0.045232295989990234
r_  generation:  0.47185516357421875
local_output_nid generation:  0.028352022171020508
local_in_edges_tensor generation:  0.03173208236694336
mini_batch_src_global generation:  0.05856657028198242
r_  generation:  0.48337268829345703
local_output_nid generation:  0.026925325393676758
local_in_edges_tensor generation:  0.02951836585998535
mini_batch_src_global generation:  0.0560150146484375
r_  generation:  0.4931974411010742
local_output_nid generation:  0.026819229125976562
local_in_edges_tensor generation:  0.02982187271118164
mini_batch_src_global generation:  0.05667901039123535
r_  generation:  0.4885425567626953
----------------------check_connections_block total spend ----------------------------- 2.8251025676727295
generate_one_block  0.6243619918823242
generate_one_block  0.6255674362182617
generate_one_block  0.6423244476318359
generate_one_block  0.6321384906768799
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03242635726928711
gen group dst list time:  0.021979570388793945
time for parepare:  0.018873929977416992
local_output_nid generation:  0.03132009506225586
local_in_edges_tensor generation:  0.043036460876464844
mini_batch_src_global generation:  0.05224418640136719
r_  generation:  0.5612194538116455
local_output_nid generation:  0.03817558288574219
local_in_edges_tensor generation:  0.044641971588134766
mini_batch_src_global generation:  0.06574559211730957
r_  generation:  0.5699031352996826
local_output_nid generation:  0.03854942321777344
local_in_edges_tensor generation:  0.04584860801696777
mini_batch_src_global generation:  0.06497693061828613
r_  generation:  0.5729267597198486
local_output_nid generation:  0.03823542594909668
local_in_edges_tensor generation:  0.03644275665283203
mini_batch_src_global generation:  0.06474804878234863
r_  generation:  0.5765016078948975
----------------------check_connections_block total spend ----------------------------- 3.3705265522003174
generate_one_block  0.717937707901001
generate_one_block  0.7200961112976074
generate_one_block  0.7166562080383301
generate_one_block  0.7252700328826904
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.1552262306213379  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

connection checking time:  6.195629119873047
block generation total time  5.404352426528931
average batch blocks generation time:  1.3510881066322327
block dataloader generation time/epoch 13.555623964829879
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.1130218505859375  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.149332046508789  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11393976211547852  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1481614112854004  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11271286010742188  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1425352096557617  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11291027069091797  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1463184356689453  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08876574039459229 |0.0153999924659729 |0.003592848777770996 |9.393692016601562e-05 |0.003541886806488037 |0.0019121170043945312 |
----------------------------------------------------------pseudo_mini_loss sum 1.3279457092285156
Total (block generation + training)time/epoch 14.11821326342496
Training time/epoch 0.5394566059112549
Training time without block to device /epoch 0.4778566360473633
Training time without total dataloading part /epoch 0.030826807022094727
load block tensor time/epoch 0.35506296157836914
block to device time/epoch 0.0615999698638916
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 20 |
Number of nodes for computation during this epoch:  1722582
Number of first layer input nodes during this epoch:  663008
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.15735244750976562  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022261619567871094
random selection method range initialization spend 0.00490880012512207
time for parepare:  0.017655134201049805
local_output_nid generation:  0.008902788162231445
local_in_edges_tensor generation:  0.008326530456542969
mini_batch_src_global generation:  0.007738351821899414
r_  generation:  0.09245967864990234
local_output_nid generation:  0.011862039566040039
local_in_edges_tensor generation:  0.007571220397949219
mini_batch_src_global generation:  0.009960651397705078
r_  generation:  0.09789609909057617
local_output_nid generation:  0.011878490447998047
local_in_edges_tensor generation:  0.00609588623046875
mini_batch_src_global generation:  0.00823068618774414
r_  generation:  0.10397791862487793
local_output_nid generation:  0.011883735656738281
local_in_edges_tensor generation:  0.006776571273803711
mini_batch_src_global generation:  0.00883936882019043
r_  generation:  0.10445713996887207
----------------------check_connections_block total spend ----------------------------- 0.6211869716644287
generate_one_block  0.11360526084899902
generate_one_block  0.11667442321777344
generate_one_block  0.11825704574584961
generate_one_block  0.11554646492004395
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04222989082336426
gen group dst list time:  0.011562824249267578
time for parepare:  0.019852161407470703
local_output_nid generation:  0.022542715072631836
local_in_edges_tensor generation:  0.039714813232421875
mini_batch_src_global generation:  0.04762434959411621
r_  generation:  0.4767436981201172
local_output_nid generation:  0.02781820297241211
local_in_edges_tensor generation:  0.034879207611083984
mini_batch_src_global generation:  0.05658674240112305
r_  generation:  0.47750306129455566
local_output_nid generation:  0.028107166290283203
local_in_edges_tensor generation:  0.03136086463928223
mini_batch_src_global generation:  0.05845499038696289
r_  generation:  0.49063801765441895
local_output_nid generation:  0.030020713806152344
local_in_edges_tensor generation:  0.03267836570739746
mini_batch_src_global generation:  0.059333086013793945
r_  generation:  0.48509931564331055
----------------------check_connections_block total spend ----------------------------- 2.838160514831543
generate_one_block  0.6191859245300293
generate_one_block  0.6286609172821045
generate_one_block  0.6541404724121094
generate_one_block  0.6187586784362793
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03576469421386719
gen group dst list time:  0.022139787673950195
time for parepare:  0.01924753189086914
local_output_nid generation:  0.0321047306060791
local_in_edges_tensor generation:  0.05477714538574219
mini_batch_src_global generation:  0.054932355880737305
r_  generation:  0.5583879947662354
local_output_nid generation:  0.03836941719055176
local_in_edges_tensor generation:  0.04743528366088867
mini_batch_src_global generation:  0.06548357009887695
r_  generation:  0.5722613334655762
local_output_nid generation:  0.03842425346374512
local_in_edges_tensor generation:  0.04146313667297363
mini_batch_src_global generation:  0.06566762924194336
r_  generation:  0.5721762180328369
local_output_nid generation:  0.03849053382873535
local_in_edges_tensor generation:  0.03587746620178223
mini_batch_src_global generation:  0.06710147857666016
r_  generation:  0.5774416923522949
----------------------check_connections_block total spend ----------------------------- 3.3809804916381836
generate_one_block  0.7145383358001709
generate_one_block  0.717381477355957
generate_one_block  0.7221095561981201
generate_one_block  0.7167270183563232
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.15735244750976562  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

connection checking time:  6.219141006469727
block generation total time  5.391502380371094
average batch blocks generation time:  1.3478755950927734
block dataloader generation time/epoch 13.553616146246592
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11388254165649414  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.147590160369873  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11267948150634766  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1419429779052734  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11304283142089844  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1499261856079102  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.1137995719909668  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1424269676208496  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09686863422393799 |0.01645183563232422 |0.0036311745643615723 |9.387731552124023e-05 |0.0038567185401916504 |0.0029103755950927734 |
----------------------------------------------------------pseudo_mini_loss sum 1.3091068267822266
Total (block generation + training)time/epoch 14.117519160111746
Training time/epoch 0.5780794620513916
Training time without block to device /epoch 0.5122721195220947
Training time without total dataloading part /epoch 0.033237457275390625
load block tensor time/epoch 0.38747453689575195
block to device time/epoch 0.06580734252929688
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 21 |
Number of nodes for computation during this epoch:  1721917
Number of first layer input nodes during this epoch:  662889
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.1555161476135254  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023392915725708008
random selection method range initialization spend 0.004937648773193359
time for parepare:  0.018192052841186523
local_output_nid generation:  0.008718252182006836
local_in_edges_tensor generation:  0.008776187896728516
mini_batch_src_global generation:  0.00783085823059082
r_  generation:  0.09240484237670898
local_output_nid generation:  0.01166534423828125
local_in_edges_tensor generation:  0.007266044616699219
mini_batch_src_global generation:  0.01007080078125
r_  generation:  0.09897661209106445
local_output_nid generation:  0.011814594268798828
local_in_edges_tensor generation:  0.006318569183349609
mini_batch_src_global generation:  0.007851839065551758
r_  generation:  0.10178947448730469
local_output_nid generation:  0.011869192123413086
local_in_edges_tensor generation:  0.006545305252075195
mini_batch_src_global generation:  0.008895635604858398
r_  generation:  0.10435605049133301
----------------------check_connections_block total spend ----------------------------- 0.6149358749389648
generate_one_block  0.1130521297454834
generate_one_block  0.1146993637084961
generate_one_block  0.1162111759185791
generate_one_block  0.11646389961242676
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.039525747299194336
gen group dst list time:  0.011687278747558594
time for parepare:  0.01923656463623047
local_output_nid generation:  0.02108907699584961
local_in_edges_tensor generation:  0.03803372383117676
mini_batch_src_global generation:  0.04524374008178711
r_  generation:  0.47071337699890137
local_output_nid generation:  0.02747821807861328
local_in_edges_tensor generation:  0.030280351638793945
mini_batch_src_global generation:  0.05639910697937012
r_  generation:  0.4769010543823242
local_output_nid generation:  0.0264894962310791
local_in_edges_tensor generation:  0.02857041358947754
mini_batch_src_global generation:  0.05828237533569336
r_  generation:  0.4893002510070801
local_output_nid generation:  0.026346206665039062
local_in_edges_tensor generation:  0.031536102294921875
mini_batch_src_global generation:  0.0595247745513916
r_  generation:  0.4923124313354492
----------------------check_connections_block total spend ----------------------------- 2.8168036937713623
generate_one_block  0.613480806350708
generate_one_block  0.6171822547912598
generate_one_block  0.642120361328125
generate_one_block  0.6198215484619141
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03022909164428711
gen group dst list time:  0.021930694580078125
time for parepare:  0.01867198944091797
local_output_nid generation:  0.030453205108642578
local_in_edges_tensor generation:  0.04199528694152832
mini_batch_src_global generation:  0.05234837532043457
r_  generation:  0.5587027072906494
local_output_nid generation:  0.03850245475769043
local_in_edges_tensor generation:  0.042378902435302734
mini_batch_src_global generation:  0.06549978256225586
r_  generation:  0.5679428577423096
local_output_nid generation:  0.03793501853942871
local_in_edges_tensor generation:  0.036937713623046875
mini_batch_src_global generation:  0.06521725654602051
r_  generation:  0.5706207752227783
local_output_nid generation:  0.03839874267578125
local_in_edges_tensor generation:  0.03598976135253906
mini_batch_src_global generation:  0.0640115737915039
r_  generation:  0.5772945880889893
----------------------check_connections_block total spend ----------------------------- 3.3526406288146973
generate_one_block  0.7157342433929443
generate_one_block  0.7124624252319336
generate_one_block  0.7251818180084229
generate_one_block  0.7319290637969971
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.1555161476135254  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

connection checking time:  6.16944432258606
block generation total time  5.377912521362305
average batch blocks generation time:  1.3444781303405762
block dataloader generation time/epoch 13.548245870150053
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11277294158935547  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1433496475219727  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11288261413574219  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1455574035644531  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11389780044555664  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1438236236572266  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.1128072738647461  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1476755142211914  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09007155895233154 |0.016057968139648438 |0.0034165382385253906 |9.173154830932617e-05 |0.00347137451171875 |0.0014901161193847656 |
----------------------------------------------------------pseudo_mini_loss sum 1.2954260110855103
Total (block generation + training)time/epoch 14.11084980231065
Training time/epoch 0.5468058586120605
Training time without block to device /epoch 0.4825739860534668
Training time without total dataloading part /epoch 0.029408693313598633
load block tensor time/epoch 0.36028623580932617
block to device time/epoch 0.06423187255859375
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 22 |
Number of nodes for computation during this epoch:  1722455
Number of first layer input nodes during this epoch:  662894
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.15535211563110352  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020802974700927734
random selection method range initialization spend 0.00484919548034668
time for parepare:  0.019487619400024414
local_output_nid generation:  0.0091094970703125
local_in_edges_tensor generation:  0.008614301681518555
mini_batch_src_global generation:  0.007812738418579102
r_  generation:  0.09080886840820312
local_output_nid generation:  0.012007474899291992
local_in_edges_tensor generation:  0.0060007572174072266
mini_batch_src_global generation:  0.010196208953857422
r_  generation:  0.09661173820495605
local_output_nid generation:  0.012126445770263672
local_in_edges_tensor generation:  0.006079196929931641
mini_batch_src_global generation:  0.00782155990600586
r_  generation:  0.10214090347290039
local_output_nid generation:  0.012264013290405273
local_in_edges_tensor generation:  0.006033897399902344
mini_batch_src_global generation:  0.008713006973266602
r_  generation:  0.10537505149841309
----------------------check_connections_block total spend ----------------------------- 0.6136696338653564
generate_one_block  0.11315250396728516
generate_one_block  0.11406302452087402
generate_one_block  0.11851644515991211
generate_one_block  0.11689186096191406
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03505873680114746
gen group dst list time:  0.011548757553100586
time for parepare:  0.019453763961791992
local_output_nid generation:  0.022189617156982422
local_in_edges_tensor generation:  0.03497457504272461
mini_batch_src_global generation:  0.04503273963928223
r_  generation:  0.47385549545288086
local_output_nid generation:  0.02895641326904297
local_in_edges_tensor generation:  0.03134727478027344
mini_batch_src_global generation:  0.056601762771606445
r_  generation:  0.48238658905029297
local_output_nid generation:  0.02770853042602539
local_in_edges_tensor generation:  0.02759575843811035
mini_batch_src_global generation:  0.05620622634887695
r_  generation:  0.4873371124267578
local_output_nid generation:  0.02787303924560547
local_in_edges_tensor generation:  0.028241872787475586
mini_batch_src_global generation:  0.05696725845336914
r_  generation:  0.48743653297424316
----------------------check_connections_block total spend ----------------------------- 2.8119723796844482
generate_one_block  0.6198976039886475
generate_one_block  0.6241676807403564
generate_one_block  0.6538784503936768
generate_one_block  0.6325132846832275
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.031227827072143555
gen group dst list time:  0.022532939910888672
time for parepare:  0.01907658576965332
local_output_nid generation:  0.031111955642700195
local_in_edges_tensor generation:  0.04518628120422363
mini_batch_src_global generation:  0.05331063270568848
r_  generation:  0.5958123207092285
local_output_nid generation:  0.041357994079589844
local_in_edges_tensor generation:  0.04384136199951172
mini_batch_src_global generation:  0.07137894630432129
r_  generation:  0.572535514831543
local_output_nid generation:  0.0390625
local_in_edges_tensor generation:  0.03827810287475586
mini_batch_src_global generation:  0.06514239311218262
r_  generation:  0.5767247676849365
local_output_nid generation:  0.03904604911804199
local_in_edges_tensor generation:  0.04072880744934082
mini_batch_src_global generation:  0.06423211097717285
r_  generation:  0.5768589973449707
----------------------check_connections_block total spend ----------------------------- 3.417294502258301
generate_one_block  0.7130329608917236
generate_one_block  0.7233898639678955
generate_one_block  0.7159888744354248
generate_one_block  0.7179915904998779
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.15535211563110352  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

connection checking time:  6.229266881942749
block generation total time  5.40086030960083
average batch blocks generation time:  1.3502150774002075
block dataloader generation time/epoch 13.547449554715838
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11303329467773438  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1497130393981934  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11371755599975586  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1423168182373047  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11277437210083008  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1438164710998535  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11293363571166992  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1463227272033691  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09221506118774414 |0.016478419303894043 |0.003596067428588867 |9.447336196899414e-05 |0.0036846399307250977 |0.0016829967498779297 |
----------------------------------------------------------pseudo_mini_loss sum 1.2814559936523438
Total (block generation + training)time/epoch 14.109702604157585
Training time/epoch 0.5574080944061279
Training time without block to device /epoch 0.49149441719055176
Training time without total dataloading part /epoch 0.031183719635009766
load block tensor time/epoch 0.36886024475097656
block to device time/epoch 0.06591367721557617
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 23 |
Number of nodes for computation during this epoch:  1721933
Number of first layer input nodes during this epoch:  662786
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.15740966796875  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020949602127075195
random selection method range initialization spend 0.004874229431152344
time for parepare:  0.018491744995117188
local_output_nid generation:  0.009090662002563477
local_in_edges_tensor generation:  0.011768341064453125
mini_batch_src_global generation:  0.007992982864379883
r_  generation:  0.09328818321228027
local_output_nid generation:  0.01158452033996582
local_in_edges_tensor generation:  0.006239652633666992
mini_batch_src_global generation:  0.009995698928833008
r_  generation:  0.09854698181152344
local_output_nid generation:  0.011838436126708984
local_in_edges_tensor generation:  0.006056785583496094
mini_batch_src_global generation:  0.0077283382415771484
r_  generation:  0.10272526741027832
local_output_nid generation:  0.011702537536621094
local_in_edges_tensor generation:  0.0060749053955078125
mini_batch_src_global generation:  0.009258270263671875
r_  generation:  0.10486936569213867
----------------------check_connections_block total spend ----------------------------- 0.6185534000396729
generate_one_block  0.11912202835083008
generate_one_block  0.1154623031616211
generate_one_block  0.11471915245056152
generate_one_block  0.11651778221130371
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03959250450134277
gen group dst list time:  0.011701107025146484
time for parepare:  0.020365476608276367
local_output_nid generation:  0.021506786346435547
local_in_edges_tensor generation:  0.041165828704833984
mini_batch_src_global generation:  0.045858144760131836
r_  generation:  0.47927236557006836
local_output_nid generation:  0.02795886993408203
local_in_edges_tensor generation:  0.03259992599487305
mini_batch_src_global generation:  0.05648326873779297
r_  generation:  0.4831883907318115
local_output_nid generation:  0.026604413986206055
local_in_edges_tensor generation:  0.029041528701782227
mini_batch_src_global generation:  0.06038522720336914
r_  generation:  0.49272680282592773
local_output_nid generation:  0.02658557891845703
local_in_edges_tensor generation:  0.03213953971862793
mini_batch_src_global generation:  0.057031869888305664
r_  generation:  0.49196863174438477
----------------------check_connections_block total spend ----------------------------- 2.8455417156219482
generate_one_block  0.6167411804199219
generate_one_block  0.6174943447113037
generate_one_block  0.6455323696136475
generate_one_block  0.6173858642578125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0307919979095459
gen group dst list time:  0.022143125534057617
time for parepare:  0.02052474021911621
local_output_nid generation:  0.03198361396789551
local_in_edges_tensor generation:  0.042113304138183594
mini_batch_src_global generation:  0.05472517013549805
r_  generation:  0.5602114200592041
local_output_nid generation:  0.03884387016296387
local_in_edges_tensor generation:  0.04383707046508789
mini_batch_src_global generation:  0.06548333168029785
r_  generation:  0.57157301902771
local_output_nid generation:  0.03834986686706543
local_in_edges_tensor generation:  0.03649401664733887
mini_batch_src_global generation:  0.06522583961486816
r_  generation:  0.5752353668212891
local_output_nid generation:  0.03849291801452637
local_in_edges_tensor generation:  0.03588390350341797
mini_batch_src_global generation:  0.06372189521789551
r_  generation:  0.5775599479675293
----------------------check_connections_block total spend ----------------------------- 3.3619203567504883
generate_one_block  0.7187752723693848
generate_one_block  0.7225532531738281
generate_one_block  0.729050874710083
generate_one_block  0.7334394454956055
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.15740966796875  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

connection checking time:  6.2074620723724365
block generation total time  5.400972604751587
average batch blocks generation time:  1.3502431511878967
block dataloader generation time/epoch 13.546699317296346
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11392498016357422  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1484389305114746  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11268377304077148  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1428356170654297  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11296701431274414  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1445302963256836  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11385488510131836  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.14390230178833  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09253954887390137 |0.015994787216186523 |0.0034893155097961426 |9.1552734375e-05 |0.003747284412384033 |0.002652406692504883 |
----------------------------------------------------------pseudo_mini_loss sum 1.2721766233444214
Total (block generation + training)time/epoch 14.108588218688965
Training time/epoch 0.5565605163574219
Training time without block to device /epoch 0.4925813674926758
Training time without total dataloading part /epoch 0.031965017318725586
load block tensor time/epoch 0.37015819549560547
block to device time/epoch 0.0639791488647461
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 24 |
Number of nodes for computation during this epoch:  1722152
Number of first layer input nodes during this epoch:  662894
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.15563583374023438  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023096799850463867
random selection method range initialization spend 0.00490570068359375
time for parepare:  0.017579078674316406
local_output_nid generation:  0.008812665939331055
local_in_edges_tensor generation:  0.008306264877319336
mini_batch_src_global generation:  0.008101701736450195
r_  generation:  0.09149384498596191
local_output_nid generation:  0.011651992797851562
local_in_edges_tensor generation:  0.006064891815185547
mini_batch_src_global generation:  0.010153055191040039
r_  generation:  0.09875869750976562
local_output_nid generation:  0.011778831481933594
local_in_edges_tensor generation:  0.00610041618347168
mini_batch_src_global generation:  0.008083105087280273
r_  generation:  0.10216379165649414
local_output_nid generation:  0.011777877807617188
local_in_edges_tensor generation:  0.006033658981323242
mini_batch_src_global generation:  0.008602142333984375
r_  generation:  0.10414981842041016
----------------------check_connections_block total spend ----------------------------- 0.6124930381774902
generate_one_block  0.11160826683044434
generate_one_block  0.11545658111572266
generate_one_block  0.11605501174926758
generate_one_block  0.11659836769104004
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.034630537033081055
gen group dst list time:  0.011603832244873047
time for parepare:  0.03144192695617676
local_output_nid generation:  0.025410175323486328
local_in_edges_tensor generation:  0.04361081123352051
mini_batch_src_global generation:  0.0502018928527832
r_  generation:  0.5089871883392334
local_output_nid generation:  0.03602194786071777
local_in_edges_tensor generation:  0.0367584228515625
mini_batch_src_global generation:  0.064422607421875
r_  generation:  0.5023272037506104
local_output_nid generation:  0.03405928611755371
local_in_edges_tensor generation:  0.03472328186035156
mini_batch_src_global generation:  0.06106066703796387
r_  generation:  0.5077550411224365
local_output_nid generation:  0.033396244049072266
local_in_edges_tensor generation:  0.030101537704467773
mini_batch_src_global generation:  0.06177353858947754
r_  generation:  0.5077922344207764
----------------------check_connections_block total spend ----------------------------- 3.0224030017852783
generate_one_block  0.6562221050262451
generate_one_block  0.6458911895751953
generate_one_block  0.6692869663238525
generate_one_block  0.6259138584136963
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03722357749938965
gen group dst list time:  0.022306203842163086
time for parepare:  0.018871068954467773
local_output_nid generation:  0.03074193000793457
local_in_edges_tensor generation:  0.0511777400970459
mini_batch_src_global generation:  0.0555422306060791
r_  generation:  0.5631754398345947
local_output_nid generation:  0.038511037826538086
local_in_edges_tensor generation:  0.048415422439575195
mini_batch_src_global generation:  0.06593728065490723
r_  generation:  0.5648586750030518
local_output_nid generation:  0.03742027282714844
local_in_edges_tensor generation:  0.03884482383728027
mini_batch_src_global generation:  0.0645749568939209
r_  generation:  0.5716712474822998
local_output_nid generation:  0.038176536560058594
local_in_edges_tensor generation:  0.03747916221618652
mini_batch_src_global generation:  0.06719493865966797
r_  generation:  0.5860085487365723
----------------------check_connections_block total spend ----------------------------- 3.386038064956665
generate_one_block  0.7239580154418945
generate_one_block  0.7331454753875732
generate_one_block  0.7373273372650146
generate_one_block  0.7392442226409912
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.15563583374023438  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

connection checking time:  6.408441066741943
block generation total time  5.530989170074463
average batch blocks generation time:  1.3827472925186157
block dataloader generation time/epoch 13.565892681479454
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11278486251831055  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1437335014343262  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11308050155639648  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1514172554016113  GigaBytes
Max Memory Allocated: 1.3555150032043457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11379766464233398  GigaBytes
Max Memory Allocated: 1.356790542602539  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1428771018981934  GigaBytes
Max Memory Allocated: 1.356790542602539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11275243759155273  GigaBytes
Max Memory Allocated: 1.356790542602539  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1428780555725098  GigaBytes
Max Memory Allocated: 1.356790542602539  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08864140510559082 |0.025822937488555908 |0.009042084217071533 |9.763240814208984e-05 |0.00371628999710083 |0.002861499786376953 |
----------------------------------------------------------pseudo_mini_loss sum 1.2541344165802002
Total (block generation + training)time/epoch 14.130348429083824
Training time/epoch 0.6026797294616699
Training time without block to device /epoch 0.4993879795074463
Training time without total dataloading part /epoch 0.054285526275634766
load block tensor time/epoch 0.3545656204223633
block to device time/epoch 0.10329174995422363
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 25 |
Number of nodes for computation during this epoch:  1722736
Number of first layer input nodes during this epoch:  663083
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.15513324737548828  GigaBytes
Max Memory Allocated: 1.356790542602539  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.028927087783813477
random selection method range initialization spend 0.005455493927001953
time for parepare:  0.017340898513793945
local_output_nid generation:  0.008862733840942383
local_in_edges_tensor generation:  0.01260995864868164
mini_batch_src_global generation:  0.007952213287353516
r_  generation:  0.0907142162322998
local_output_nid generation:  0.011731147766113281
local_in_edges_tensor generation:  0.00620269775390625
mini_batch_src_global generation:  0.010428905487060547
r_  generation:  0.09819459915161133
local_output_nid generation:  0.011805534362792969
local_in_edges_tensor generation:  0.006135463714599609
mini_batch_src_global generation:  0.008160829544067383
r_  generation:  0.10255765914916992
local_output_nid generation:  0.011913776397705078
local_in_edges_tensor generation:  0.0063018798828125
mini_batch_src_global generation:  0.00892782211303711
r_  generation:  0.10339856147766113
----------------------check_connections_block total spend ----------------------------- 0.6152098178863525
generate_one_block  0.11202859878540039
generate_one_block  0.11466813087463379
generate_one_block  0.1172323226928711
generate_one_block  0.1159820556640625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04109978675842285
gen group dst list time:  0.01165008544921875
time for parepare:  0.01949620246887207
local_output_nid generation:  0.021276473999023438
local_in_edges_tensor generation:  0.038141489028930664
mini_batch_src_global generation:  0.04787707328796387
r_  generation:  0.47333216667175293
local_output_nid generation:  0.0277099609375
local_in_edges_tensor generation:  0.033391475677490234
mini_batch_src_global generation:  0.0608823299407959
r_  generation:  0.4972672462463379
local_output_nid generation:  0.027764320373535156
local_in_edges_tensor generation:  0.03067755699157715
mini_batch_src_global generation:  0.05921506881713867
r_  generation:  0.5035147666931152
local_output_nid generation:  0.03183436393737793
local_in_edges_tensor generation:  0.04365229606628418
mini_batch_src_global generation:  0.06355142593383789
r_  generation:  0.49958372116088867
----------------------check_connections_block total spend ----------------------------- 2.9188311100006104
generate_one_block  0.6372010707855225
generate_one_block  0.6224510669708252
generate_one_block  0.6559906005859375
generate_one_block  0.6372418403625488
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03197073936462402
gen group dst list time:  0.022577762603759766
time for parepare:  0.01870131492614746
local_output_nid generation:  0.034157752990722656
local_in_edges_tensor generation:  0.058933258056640625
mini_batch_src_global generation:  0.055344343185424805
r_  generation:  0.5664653778076172
local_output_nid generation:  0.04024481773376465
local_in_edges_tensor generation:  0.049605369567871094
mini_batch_src_global generation:  0.06549859046936035
r_  generation:  0.6031677722930908
local_output_nid generation:  0.03857421875
local_in_edges_tensor generation:  0.050421714782714844
mini_batch_src_global generation:  0.07014656066894531
r_  generation:  0.5888292789459229
local_output_nid generation:  0.040378570556640625
local_in_edges_tensor generation:  0.04259490966796875
mini_batch_src_global generation:  0.06310915946960449
r_  generation:  0.5746064186096191
----------------------check_connections_block total spend ----------------------------- 3.484440565109253
generate_one_block  0.719735860824585
generate_one_block  0.7157940864562988
generate_one_block  0.7228772640228271
generate_one_block  0.7417888641357422
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.15513324737548828  GigaBytes
Max Memory Allocated: 1.356790542602539  GigaBytes

connection checking time:  6.403271675109863
block generation total time  5.453080654144287
average batch blocks generation time:  1.3632701635360718
block dataloader generation time/epoch 13.580181009629193
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11285686492919922  GigaBytes
Max Memory Allocated: 1.356790542602539  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1430840492248535  GigaBytes
Max Memory Allocated: 1.356790542602539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11383914947509766  GigaBytes
Max Memory Allocated: 1.356790542602539  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1437196731567383  GigaBytes
Max Memory Allocated: 1.356790542602539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11292743682861328  GigaBytes
Max Memory Allocated: 1.356790542602539  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.148190975189209  GigaBytes
Max Memory Allocated: 1.356790542602539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11302804946899414  GigaBytes
Max Memory Allocated: 1.356790542602539  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1495146751403809  GigaBytes
Max Memory Allocated: 1.356790542602539  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08963578939437866 |0.0218430757522583 |0.003657519817352295 |9.518861770629883e-05 |0.003659188747406006 |0.0014274120330810547 |
----------------------------------------------------------pseudo_mini_loss sum 1.2473623752593994
Total (block generation + training)time/epoch 14.145005310282988
Training time/epoch 0.5704443454742432
Training time without block to device /epoch 0.48307204246520996
Training time without total dataloading part /epoch 0.031075000762939453
load block tensor time/epoch 0.35854315757751465
block to device time/epoch 0.0873723030090332
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 26 |
Number of nodes for computation during this epoch:  1722528
Number of first layer input nodes during this epoch:  663098
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.15751123428344727  GigaBytes
Max Memory Allocated: 1.356790542602539  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0221710205078125
random selection method range initialization spend 0.0048525333404541016
time for parepare:  0.017093658447265625
local_output_nid generation:  0.009118318557739258
local_in_edges_tensor generation:  0.012306928634643555
mini_batch_src_global generation:  0.007775783538818359
r_  generation:  0.09143614768981934
local_output_nid generation:  0.012062549591064453
local_in_edges_tensor generation:  0.006185770034790039
mini_batch_src_global generation:  0.010144233703613281
r_  generation:  0.09838724136352539
local_output_nid generation:  0.011848926544189453
local_in_edges_tensor generation:  0.006094932556152344
mini_batch_src_global generation:  0.007957935333251953
r_  generation:  0.10187244415283203
local_output_nid generation:  0.011889457702636719
local_in_edges_tensor generation:  0.006178855895996094
mini_batch_src_global generation:  0.00878763198852539
r_  generation:  0.10368514060974121
----------------------check_connections_block total spend ----------------------------- 0.6151905059814453
generate_one_block  0.11389446258544922
generate_one_block  0.11479949951171875
generate_one_block  0.11577105522155762
generate_one_block  0.11524200439453125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03663754463195801
gen group dst list time:  0.01152801513671875
time for parepare:  0.019395828247070312
local_output_nid generation:  0.021674394607543945
local_in_edges_tensor generation:  0.037731170654296875
mini_batch_src_global generation:  0.048218727111816406
r_  generation:  0.4737417697906494
local_output_nid generation:  0.02890300750732422
local_in_edges_tensor generation:  0.03556489944458008
mini_batch_src_global generation:  0.056240081787109375
r_  generation:  0.48824429512023926
local_output_nid generation:  0.027460098266601562
local_in_edges_tensor generation:  0.03717160224914551
mini_batch_src_global generation:  0.05620908737182617
r_  generation:  0.48720335960388184
local_output_nid generation:  0.02651810646057129
local_in_edges_tensor generation:  0.02945089340209961
mini_batch_src_global generation:  0.059107065200805664
r_  generation:  0.4906783103942871
----------------------check_connections_block total spend ----------------------------- 2.8463287353515625
generate_one_block  0.653275728225708
generate_one_block  0.6358633041381836
generate_one_block  0.645575761795044
generate_one_block  0.6236109733581543
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03536677360534668
gen group dst list time:  0.02228236198425293
time for parepare:  0.018774032592773438
local_output_nid generation:  0.031064987182617188
local_in_edges_tensor generation:  0.05040478706359863
mini_batch_src_global generation:  0.055320024490356445
r_  generation:  0.565514087677002
local_output_nid generation:  0.0384824275970459
local_in_edges_tensor generation:  0.04781031608581543
mini_batch_src_global generation:  0.06837320327758789
r_  generation:  0.5694832801818848
local_output_nid generation:  0.03849911689758301
local_in_edges_tensor generation:  0.03871297836303711
mini_batch_src_global generation:  0.06458067893981934
r_  generation:  0.5743439197540283
local_output_nid generation:  0.03820204734802246
local_in_edges_tensor generation:  0.040061235427856445
mini_batch_src_global generation:  0.063323974609375
r_  generation:  0.5719218254089355
----------------------check_connections_block total spend ----------------------------- 3.3791587352752686
generate_one_block  0.7218363285064697
generate_one_block  0.7231695652008057
generate_one_block  0.7176103591918945
generate_one_block  0.7334213256835938
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.15751123428344727  GigaBytes
Max Memory Allocated: 1.356790542602539  GigaBytes

connection checking time:  6.225487470626831
block generation total time  5.4543633460998535
average batch blocks generation time:  1.3635908365249634
block dataloader generation time/epoch 13.582406004269918
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11386728286743164  GigaBytes
Max Memory Allocated: 1.356790542602539  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1478276252746582  GigaBytes
Max Memory Allocated: 1.356790542602539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11290979385375977  GigaBytes
Max Memory Allocated: 1.356790542602539  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1478610038757324  GigaBytes
Max Memory Allocated: 1.356790542602539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11292505264282227  GigaBytes
Max Memory Allocated: 1.356790542602539  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.145749568939209  GigaBytes
Max Memory Allocated: 1.356790542602539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11377620697021484  GigaBytes
Max Memory Allocated: 1.356790542602539  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.142843246459961  GigaBytes
Max Memory Allocated: 1.356790542602539  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09616219997406006 |0.016899704933166504 |0.0036402344703674316 |9.47117805480957e-05 |0.0038616061210632324 |0.0014743804931640625 |
----------------------------------------------------------pseudo_mini_loss sum 1.23395836353302
Total (block generation + training)time/epoch 14.14771232340071
Training time/epoch 0.5732607841491699
Training time without block to device /epoch 0.5056619644165039
Training time without total dataloading part /epoch 0.0318605899810791
load block tensor time/epoch 0.38464879989624023
block to device time/epoch 0.06759881973266602
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 27 |
Number of nodes for computation during this epoch:  1722712
Number of first layer input nodes during this epoch:  663006
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.15544891357421875  GigaBytes
Max Memory Allocated: 1.356790542602539  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020400285720825195
random selection method range initialization spend 0.004818916320800781
time for parepare:  0.01922464370727539
local_output_nid generation:  0.009110450744628906
local_in_edges_tensor generation:  0.009154319763183594
mini_batch_src_global generation:  0.007958650588989258
r_  generation:  0.09216880798339844
local_output_nid generation:  0.011684656143188477
local_in_edges_tensor generation:  0.006102800369262695
mini_batch_src_global generation:  0.010079145431518555
r_  generation:  0.09731101989746094
local_output_nid generation:  0.011804819107055664
local_in_edges_tensor generation:  0.006234169006347656
mini_batch_src_global generation:  0.008104085922241211
r_  generation:  0.10226058959960938
local_output_nid generation:  0.011866569519042969
local_in_edges_tensor generation:  0.006017923355102539
mini_batch_src_global generation:  0.008545875549316406
r_  generation:  0.10344886779785156
----------------------check_connections_block total spend ----------------------------- 0.6134324073791504
generate_one_block  0.11418271064758301
generate_one_block  0.1136624813079834
generate_one_block  0.11724591255187988
generate_one_block  0.11637020111083984
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029934406280517578
gen group dst list time:  0.011362314224243164
time for parepare:  0.020012617111206055
local_output_nid generation:  0.02201056480407715
local_in_edges_tensor generation:  0.03553199768066406
mini_batch_src_global generation:  0.04525041580200195
r_  generation:  0.47119736671447754
local_output_nid generation:  0.027710437774658203
local_in_edges_tensor generation:  0.035378456115722656
mini_batch_src_global generation:  0.05602741241455078
r_  generation:  0.4925503730773926
local_output_nid generation:  0.02733135223388672
local_in_edges_tensor generation:  0.02814006805419922
mini_batch_src_global generation:  0.057944297790527344
r_  generation:  0.4925980567932129
local_output_nid generation:  0.027307987213134766
local_in_edges_tensor generation:  0.028743267059326172
mini_batch_src_global generation:  0.056374311447143555
r_  generation:  0.4983561038970947
----------------------check_connections_block total spend ----------------------------- 2.84268856048584
generate_one_block  0.6250405311584473
generate_one_block  0.618535041809082
generate_one_block  0.6451866626739502
generate_one_block  0.6249916553497314
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03416252136230469
gen group dst list time:  0.022686481475830078
time for parepare:  0.019020557403564453
local_output_nid generation:  0.030882835388183594
local_in_edges_tensor generation:  0.04526185989379883
mini_batch_src_global generation:  0.05556011199951172
r_  generation:  0.5616719722747803
local_output_nid generation:  0.03751540184020996
local_in_edges_tensor generation:  0.04770064353942871
mini_batch_src_global generation:  0.06454014778137207
r_  generation:  0.5705738067626953
local_output_nid generation:  0.037726640701293945
local_in_edges_tensor generation:  0.04636406898498535
mini_batch_src_global generation:  0.07131695747375488
r_  generation:  0.5745968818664551
local_output_nid generation:  0.037581443786621094
local_in_edges_tensor generation:  0.042282819747924805
mini_batch_src_global generation:  0.07741689682006836
r_  generation:  0.5790078639984131
----------------------check_connections_block total spend ----------------------------- 3.409719944000244
generate_one_block  0.7197220325469971
generate_one_block  0.7136847972869873
generate_one_block  0.7276706695556641
generate_one_block  0.7233140468597412
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.15544891357421875  GigaBytes
Max Memory Allocated: 1.356790542602539  GigaBytes

connection checking time:  6.252408504486084
block generation total time  5.398145437240601
average batch blocks generation time:  1.3495363593101501
block dataloader generation time/epoch 13.582260294964438
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.1128244400024414  GigaBytes
Max Memory Allocated: 1.356790542602539  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.14365816116333  GigaBytes
Max Memory Allocated: 1.356790542602539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11284780502319336  GigaBytes
Max Memory Allocated: 1.356790542602539  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1440963745117188  GigaBytes
Max Memory Allocated: 1.356790542602539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11394786834716797  GigaBytes
Max Memory Allocated: 1.356790542602539  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1446571350097656  GigaBytes
Max Memory Allocated: 1.356790542602539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11270809173583984  GigaBytes
Max Memory Allocated: 1.356790542602539  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1436843872070312  GigaBytes
Max Memory Allocated: 1.356790542602539  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09306830167770386 |0.020494043827056885 |0.0036426186561584473 |9.590387344360352e-05 |0.0031122565269470215 |0.0030357837677001953 |
----------------------------------------------------------pseudo_mini_loss sum 1.2222007513046265
Total (block generation + training)time/epoch 14.148186344849435
Training time/epoch 0.5768887996673584
Training time without block to device /epoch 0.49491262435913086
Training time without total dataloading part /epoch 0.030438899993896484
load block tensor time/epoch 0.37227320671081543
block to device time/epoch 0.08197617530822754
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 28 |
Number of nodes for computation during this epoch:  1721547
Number of first layer input nodes during this epoch:  662808
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.15506219863891602  GigaBytes
Max Memory Allocated: 1.356790542602539  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021613597869873047
random selection method range initialization spend 0.00488734245300293
time for parepare:  0.018455982208251953
local_output_nid generation:  0.009069204330444336
local_in_edges_tensor generation:  0.009231328964233398
mini_batch_src_global generation:  0.007784128189086914
r_  generation:  0.09162092208862305
local_output_nid generation:  0.011857748031616211
local_in_edges_tensor generation:  0.006180524826049805
mini_batch_src_global generation:  0.010936498641967773
r_  generation:  0.09998798370361328
local_output_nid generation:  0.011895418167114258
local_in_edges_tensor generation:  0.006643533706665039
mini_batch_src_global generation:  0.007752180099487305
r_  generation:  0.10204362869262695
local_output_nid generation:  0.011897087097167969
local_in_edges_tensor generation:  0.006478071212768555
mini_batch_src_global generation:  0.008837461471557617
r_  generation:  0.10570812225341797
----------------------check_connections_block total spend ----------------------------- 0.6188607215881348
generate_one_block  0.11193132400512695
generate_one_block  0.11492729187011719
generate_one_block  0.11422276496887207
generate_one_block  0.1175074577331543
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03754305839538574
gen group dst list time:  0.011443376541137695
time for parepare:  0.019808292388916016
local_output_nid generation:  0.021791934967041016
local_in_edges_tensor generation:  0.04156088829040527
mini_batch_src_global generation:  0.0480649471282959
r_  generation:  0.46698427200317383
local_output_nid generation:  0.02836298942565918
local_in_edges_tensor generation:  0.027570724487304688
mini_batch_src_global generation:  0.05835127830505371
r_  generation:  0.4821774959564209
local_output_nid generation:  0.027304410934448242
local_in_edges_tensor generation:  0.029799222946166992
mini_batch_src_global generation:  0.05664253234863281
r_  generation:  0.4860196113586426
local_output_nid generation:  0.026989459991455078
local_in_edges_tensor generation:  0.03275275230407715
mini_batch_src_global generation:  0.05704045295715332
r_  generation:  0.4920201301574707
----------------------check_connections_block total spend ----------------------------- 2.8212673664093018
generate_one_block  0.6182146072387695
generate_one_block  0.6204113960266113
generate_one_block  0.6416335105895996
generate_one_block  0.6265552043914795
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03044438362121582
gen group dst list time:  0.022541522979736328
time for parepare:  0.01897883415222168
local_output_nid generation:  0.030827760696411133
local_in_edges_tensor generation:  0.04240703582763672
mini_batch_src_global generation:  0.05492520332336426
r_  generation:  0.560631275177002
local_output_nid generation:  0.03756856918334961
local_in_edges_tensor generation:  0.040227413177490234
mini_batch_src_global generation:  0.06457209587097168
r_  generation:  0.5672550201416016
local_output_nid generation:  0.03745579719543457
local_in_edges_tensor generation:  0.037218570709228516
mini_batch_src_global generation:  0.06467318534851074
r_  generation:  0.5729119777679443
local_output_nid generation:  0.03760099411010742
local_in_edges_tensor generation:  0.03607773780822754
mini_batch_src_global generation:  0.0629265308380127
r_  generation:  0.5747089385986328
----------------------check_connections_block total spend ----------------------------- 3.343595027923584
generate_one_block  0.7154717445373535
generate_one_block  0.7124247550964355
generate_one_block  0.7221839427947998
generate_one_block  0.7193751335144043
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.15506219863891602  GigaBytes
Max Memory Allocated: 1.356790542602539  GigaBytes

connection checking time:  6.164862394332886
block generation total time  5.376270294189453
average batch blocks generation time:  1.3440675735473633
block dataloader generation time/epoch 13.576733434200287
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11289072036743164  GigaBytes
Max Memory Allocated: 1.356790542602539  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1447176933288574  GigaBytes
Max Memory Allocated: 1.356790542602539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11383056640625  GigaBytes
Max Memory Allocated: 1.356790542602539  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1433115005493164  GigaBytes
Max Memory Allocated: 1.356790542602539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11277437210083008  GigaBytes
Max Memory Allocated: 1.356790542602539  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1434330940246582  GigaBytes
Max Memory Allocated: 1.356790542602539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11303281784057617  GigaBytes
Max Memory Allocated: 1.356790542602539  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1502947807312012  GigaBytes
Max Memory Allocated: 1.356790542602539  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0905349850654602 |0.015692830085754395 |0.008706808090209961 |9.012222290039062e-05 |0.0036981701850891113 |0.0012819766998291016 |
----------------------------------------------------------pseudo_mini_loss sum 1.2141958475112915
Total (block generation + training)time/epoch 14.141801285743714
Training time/epoch 0.5486392974853516
Training time without block to device /epoch 0.485867977142334
Training time without total dataloading part /epoch 0.05126237869262695
load block tensor time/epoch 0.3621399402618408
block to device time/epoch 0.06277132034301758
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 29 |
Number of nodes for computation during this epoch:  1722256
Number of first layer input nodes during this epoch:  662795
