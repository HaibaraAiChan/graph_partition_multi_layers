Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1647750465.231933
ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022129535675048828
random selection method range initialization spend 0.006050586700439453
time for parepare:  0.01912212371826172
local_output_nid generation:  0.008216381072998047
local_in_edges_tensor generation:  0.007796764373779297
mini_batch_src_global generation:  0.006613731384277344
r_  generation:  0.08208322525024414
local_output_nid generation:  0.011563777923583984
local_in_edges_tensor generation:  0.0059735774993896484
mini_batch_src_global generation:  0.008651018142700195
r_  generation:  0.08692431449890137
local_output_nid generation:  0.011706352233886719
local_in_edges_tensor generation:  0.006118059158325195
mini_batch_src_global generation:  0.006577014923095703
r_  generation:  0.08907556533813477
local_output_nid generation:  0.011773109436035156
local_in_edges_tensor generation:  0.006082773208618164
mini_batch_src_global generation:  0.007187843322753906
r_  generation:  0.09117698669433594
----------------------check_connections_block total spend ----------------------------- 0.5487608909606934
generate_one_block  0.10195660591125488
generate_one_block  0.10160565376281738
generate_one_block  0.10251855850219727
generate_one_block  0.10235810279846191
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.034769535064697266
gen group dst list time:  0.011482715606689453
time for parepare:  0.01921868324279785
local_output_nid generation:  0.01889181137084961
local_in_edges_tensor generation:  0.038802146911621094
mini_batch_src_global generation:  0.036788225173950195
r_  generation:  0.39303088188171387
local_output_nid generation:  0.026024580001831055
local_in_edges_tensor generation:  0.038259267807006836
mini_batch_src_global generation:  0.04629182815551758
r_  generation:  0.402388334274292
local_output_nid generation:  0.026522397994995117
local_in_edges_tensor generation:  0.0320439338684082
mini_batch_src_global generation:  0.04897284507751465
r_  generation:  0.411968469619751
local_output_nid generation:  0.0264129638671875
local_in_edges_tensor generation:  0.02752542495727539
mini_batch_src_global generation:  0.04742550849914551
r_  generation:  0.4129631519317627
----------------------check_connections_block total spend ----------------------------- 2.4115397930145264
generate_one_block  0.5465013980865479
generate_one_block  0.5217738151550293
generate_one_block  0.5284600257873535
generate_one_block  0.5344443321228027
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028298616409301758
gen group dst list time:  0.02086019515991211
time for parepare:  0.0189516544342041
local_output_nid generation:  0.02991771697998047
local_in_edges_tensor generation:  0.043170928955078125
mini_batch_src_global generation:  0.044849395751953125
r_  generation:  0.4966259002685547
local_output_nid generation:  0.03863954544067383
local_in_edges_tensor generation:  0.05269432067871094
mini_batch_src_global generation:  0.05549025535583496
r_  generation:  0.5228526592254639
local_output_nid generation:  0.038622140884399414
local_in_edges_tensor generation:  0.05353379249572754
mini_batch_src_global generation:  0.050333499908447266
r_  generation:  0.5079245567321777
local_output_nid generation:  0.03849029541015625
local_in_edges_tensor generation:  0.035634517669677734
mini_batch_src_global generation:  0.05120515823364258
r_  generation:  0.5141139030456543
----------------------check_connections_block total spend ----------------------------- 3.0373637676239014
generate_one_block  0.6313512325286865
generate_one_block  0.6302857398986816
generate_one_block  0.6438934803009033
generate_one_block  0.6303420066833496
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  5.448903560638428
block generation total time  4.6670520305633545
average batch blocks generation time:  1.1667630076408386
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2030029296875 GB
    Memory Allocated: 0.10197019577026367  GigaBytes
Max Memory Allocated: 0.10197019577026367  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6463623046875 GB
    Memory Allocated: 1.1014761924743652  GigaBytes
Max Memory Allocated: 1.1900849342346191  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.10627126693725586  GigaBytes
Max Memory Allocated: 1.2948713302612305  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 1.101313591003418  GigaBytes
Max Memory Allocated: 1.2948713302612305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0604248046875 GB
    Memory Allocated: 0.10614395141601562  GigaBytes
Max Memory Allocated: 1.2948713302612305  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0604248046875 GB
    Memory Allocated: 1.1049041748046875  GigaBytes
Max Memory Allocated: 1.2948713302612305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0604248046875 GB
    Memory Allocated: 0.10601997375488281  GigaBytes
Max Memory Allocated: 1.2979278564453125  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0604248046875 GB
    Memory Allocated: 1.0968732833862305  GigaBytes
Max Memory Allocated: 1.2979278564453125  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05447262525558472 |0.08236664533615112 |0.19091248512268066 |0.0001291036605834961 |0.027140498161315918 |0.0038204193115234375 |
----------------------------------------------------------pseudo_mini_loss sum 6.139986991882324
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1681443
Number of first layer input nodes during this epoch:  657028
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0604248046875 GB
    Memory Allocated: 0.1442279815673828  GigaBytes
Max Memory Allocated: 1.2979278564453125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02534317970275879
random selection method range initialization spend 0.005474567413330078
time for parepare:  0.019190549850463867
local_output_nid generation:  0.00829625129699707
local_in_edges_tensor generation:  0.009241104125976562
mini_batch_src_global generation:  0.006371974945068359
r_  generation:  0.08369565010070801
local_output_nid generation:  0.011730432510375977
local_in_edges_tensor generation:  0.0060994625091552734
mini_batch_src_global generation:  0.00870203971862793
r_  generation:  0.08935117721557617
local_output_nid generation:  0.011948347091674805
local_in_edges_tensor generation:  0.006188631057739258
mini_batch_src_global generation:  0.015082359313964844
r_  generation:  0.10669136047363281
local_output_nid generation:  0.013438701629638672
local_in_edges_tensor generation:  0.013705253601074219
mini_batch_src_global generation:  0.009622573852539062
r_  generation:  0.09577035903930664
----------------------check_connections_block total spend ----------------------------- 0.6098759174346924
generate_one_block  0.10851693153381348
generate_one_block  0.10916757583618164
generate_one_block  0.13145875930786133
generate_one_block  0.10392904281616211
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.06529736518859863
gen group dst list time:  0.011467695236206055
time for parepare:  0.01950383186340332
local_output_nid generation:  0.018796682357788086
local_in_edges_tensor generation:  0.052282094955444336
mini_batch_src_global generation:  0.038155555725097656
r_  generation:  0.4002983570098877
local_output_nid generation:  0.024787187576293945
local_in_edges_tensor generation:  0.04104757308959961
mini_batch_src_global generation:  0.047183990478515625
r_  generation:  0.40994691848754883
local_output_nid generation:  0.025448083877563477
local_in_edges_tensor generation:  0.029928207397460938
mini_batch_src_global generation:  0.047231197357177734
r_  generation:  0.41617727279663086
local_output_nid generation:  0.024616241455078125
local_in_edges_tensor generation:  0.030936241149902344
mini_batch_src_global generation:  0.04761385917663574
r_  generation:  0.42644262313842773
----------------------check_connections_block total spend ----------------------------- 2.4717981815338135
generate_one_block  0.5587522983551025
generate_one_block  0.5428407192230225
generate_one_block  0.5901379585266113
generate_one_block  0.5358004570007324
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.07499217987060547
gen group dst list time:  0.02597498893737793
time for parepare:  0.022071123123168945
local_output_nid generation:  0.029093265533447266
local_in_edges_tensor generation:  0.05995059013366699
mini_batch_src_global generation:  0.048568010330200195
r_  generation:  0.5011880397796631
local_output_nid generation:  0.04074883460998535
local_in_edges_tensor generation:  0.05626678466796875
mini_batch_src_global generation:  0.05619978904724121
r_  generation:  0.5108234882354736
local_output_nid generation:  0.037419795989990234
local_in_edges_tensor generation:  0.05247759819030762
mini_batch_src_global generation:  0.05283069610595703
r_  generation:  0.5151417255401611
local_output_nid generation:  0.03738212585449219
local_in_edges_tensor generation:  0.04214596748352051
mini_batch_src_global generation:  0.05540132522583008
r_  generation:  0.5124189853668213
----------------------check_connections_block total spend ----------------------------- 3.0905189514160156
generate_one_block  0.6652133464813232
generate_one_block  0.6828720569610596
generate_one_block  0.6520860195159912
generate_one_block  0.6554570198059082
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0604248046875 GB
    Memory Allocated: 0.1442279815673828  GigaBytes
Max Memory Allocated: 1.2979278564453125  GigaBytes

connection checking time:  5.562317132949829
block generation total time  4.883159875869751
average batch blocks generation time:  1.2207899689674377
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0604248046875 GB
    Memory Allocated: 0.1086268424987793  GigaBytes
Max Memory Allocated: 1.2979278564453125  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0604248046875 GB
    Memory Allocated: 1.1032400131225586  GigaBytes
Max Memory Allocated: 1.2979278564453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10879802703857422  GigaBytes
Max Memory Allocated: 1.2979278564453125  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1063861846923828  GigaBytes
Max Memory Allocated: 1.2979278564453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10853195190429688  GigaBytes
Max Memory Allocated: 1.299356460571289  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1006946563720703  GigaBytes
Max Memory Allocated: 1.299356460571289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10853099822998047  GigaBytes
Max Memory Allocated: 1.299356460571289  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1000404357910156  GigaBytes
Max Memory Allocated: 1.299356460571289  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07835972309112549 |0.021117568016052246 |0.0037901997566223145 |9.673833847045898e-05 |0.01895684003829956 |0.0012896060943603516 |
----------------------------------------------------------pseudo_mini_loss sum 3.232545852661133
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  1680775
Number of first layer input nodes during this epoch:  656765
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.1449127197265625  GigaBytes
Max Memory Allocated: 1.299356460571289  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04932904243469238
random selection method range initialization spend 0.005618095397949219
time for parepare:  0.019770383834838867
local_output_nid generation:  0.008975982666015625
local_in_edges_tensor generation:  0.017233848571777344
mini_batch_src_global generation:  0.006789445877075195
r_  generation:  0.08853626251220703
local_output_nid generation:  0.013187408447265625
local_in_edges_tensor generation:  0.007012367248535156
mini_batch_src_global generation:  0.008733034133911133
r_  generation:  0.09315133094787598
local_output_nid generation:  0.013220071792602539
local_in_edges_tensor generation:  0.007163524627685547
mini_batch_src_global generation:  0.007000446319580078
r_  generation:  0.09325456619262695
local_output_nid generation:  0.013560771942138672
local_in_edges_tensor generation:  0.007185935974121094
mini_batch_src_global generation:  0.015481948852539062
r_  generation:  0.11434221267700195
----------------------check_connections_block total spend ----------------------------- 0.6282980442047119
generate_one_block  0.10666155815124512
generate_one_block  0.1027376651763916
generate_one_block  0.10492539405822754
generate_one_block  0.10494422912597656
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04555869102478027
gen group dst list time:  0.011504173278808594
time for parepare:  0.020185232162475586
local_output_nid generation:  0.02051544189453125
local_in_edges_tensor generation:  0.03507065773010254
mini_batch_src_global generation:  0.03889775276184082
r_  generation:  0.4038419723510742
local_output_nid generation:  0.029999971389770508
local_in_edges_tensor generation:  0.028990745544433594
mini_batch_src_global generation:  0.04935050010681152
r_  generation:  0.41129064559936523
local_output_nid generation:  0.031444549560546875
local_in_edges_tensor generation:  0.03047323226928711
mini_batch_src_global generation:  0.050290822982788086
r_  generation:  0.4363529682159424
local_output_nid generation:  0.030430078506469727
local_in_edges_tensor generation:  0.03783464431762695
mini_batch_src_global generation:  0.0626521110534668
r_  generation:  0.4131152629852295
----------------------check_connections_block total spend ----------------------------- 2.504216432571411
generate_one_block  0.5314292907714844
generate_one_block  0.5438146591186523
generate_one_block  0.5701100826263428
generate_one_block  0.5331292152404785
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04273271560668945
gen group dst list time:  0.02266240119934082
time for parepare:  0.019983291625976562
local_output_nid generation:  0.030607938766479492
local_in_edges_tensor generation:  0.05961966514587402
mini_batch_src_global generation:  0.04879951477050781
r_  generation:  0.4999868869781494
local_output_nid generation:  0.04012560844421387
local_in_edges_tensor generation:  0.04971599578857422
mini_batch_src_global generation:  0.05601096153259277
r_  generation:  0.5060160160064697
local_output_nid generation:  0.03774857521057129
local_in_edges_tensor generation:  0.047094106674194336
mini_batch_src_global generation:  0.05191159248352051
r_  generation:  0.513582706451416
local_output_nid generation:  0.03780961036682129
local_in_edges_tensor generation:  0.037518978118896484
mini_batch_src_global generation:  0.052345991134643555
r_  generation:  0.5342967510223389
----------------------check_connections_block total spend ----------------------------- 3.070699453353882
generate_one_block  0.6329851150512695
generate_one_block  0.6344332695007324
generate_one_block  0.6371028423309326
generate_one_block  0.6620988845825195
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.1449127197265625  GigaBytes
Max Memory Allocated: 1.299356460571289  GigaBytes

connection checking time:  5.574915885925293
block generation total time  4.745103359222412
average batch blocks generation time:  1.186275839805603
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10851860046386719  GigaBytes
Max Memory Allocated: 1.299356460571289  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.0980348587036133  GigaBytes
Max Memory Allocated: 1.299356460571289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10767126083374023  GigaBytes
Max Memory Allocated: 1.299356460571289  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.0980005264282227  GigaBytes
Max Memory Allocated: 1.299356460571289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10887432098388672  GigaBytes
Max Memory Allocated: 1.299356460571289  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1072797775268555  GigaBytes
Max Memory Allocated: 1.299356460571289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10868072509765625  GigaBytes
Max Memory Allocated: 1.3007159233093262  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.099614143371582  GigaBytes
Max Memory Allocated: 1.3007159233093262  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08388549089431763 |0.027369201183319092 |0.008835196495056152 |0.00010275840759277344 |0.003804326057434082 |0.0030410289764404297 |
----------------------------------------------------------pseudo_mini_loss sum 2.60183048248291
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  1680082
Number of first layer input nodes during this epoch:  656748
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.14415788650512695  GigaBytes
Max Memory Allocated: 1.3007159233093262  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02091050148010254
random selection method range initialization spend 0.005537986755371094
time for parepare:  0.017663240432739258
local_output_nid generation:  0.008744478225708008
local_in_edges_tensor generation:  0.009665250778198242
mini_batch_src_global generation:  0.006625175476074219
r_  generation:  0.0817573070526123
local_output_nid generation:  0.011820793151855469
local_in_edges_tensor generation:  0.006261587142944336
mini_batch_src_global generation:  0.008535385131835938
r_  generation:  0.08815264701843262
local_output_nid generation:  0.011928558349609375
local_in_edges_tensor generation:  0.005939006805419922
mini_batch_src_global generation:  0.006983518600463867
r_  generation:  0.0908348560333252
local_output_nid generation:  0.011969804763793945
local_in_edges_tensor generation:  0.006226539611816406
mini_batch_src_global generation:  0.00854182243347168
r_  generation:  0.09535622596740723
----------------------check_connections_block total spend ----------------------------- 0.560704231262207
generate_one_block  0.10087823867797852
generate_one_block  0.10130643844604492
generate_one_block  0.10593080520629883
generate_one_block  0.10739946365356445
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03281736373901367
gen group dst list time:  0.01095271110534668
time for parepare:  0.020882129669189453
local_output_nid generation:  0.020457744598388672
local_in_edges_tensor generation:  0.03966069221496582
mini_batch_src_global generation:  0.039864540100097656
r_  generation:  0.39852142333984375
local_output_nid generation:  0.02646780014038086
local_in_edges_tensor generation:  0.03155803680419922
mini_batch_src_global generation:  0.04725456237792969
r_  generation:  0.41148853302001953
local_output_nid generation:  0.027164459228515625
local_in_edges_tensor generation:  0.026999950408935547
mini_batch_src_global generation:  0.046857357025146484
r_  generation:  0.4167053699493408
local_output_nid generation:  0.0255129337310791
local_in_edges_tensor generation:  0.02676868438720703
mini_batch_src_global generation:  0.04788327217102051
r_  generation:  0.41825389862060547
----------------------check_connections_block total spend ----------------------------- 2.434920072555542
generate_one_block  0.5342886447906494
generate_one_block  0.5334742069244385
generate_one_block  0.5918540954589844
generate_one_block  0.5260589122772217
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.032340049743652344
gen group dst list time:  0.02122044563293457
time for parepare:  0.01928877830505371
local_output_nid generation:  0.029666423797607422
local_in_edges_tensor generation:  0.051247358322143555
mini_batch_src_global generation:  0.04496598243713379
r_  generation:  0.49192142486572266
local_output_nid generation:  0.03708314895629883
local_in_edges_tensor generation:  0.04251217842102051
mini_batch_src_global generation:  0.05729269981384277
r_  generation:  0.5044820308685303
local_output_nid generation:  0.03714275360107422
local_in_edges_tensor generation:  0.040465354919433594
mini_batch_src_global generation:  0.05437111854553223
r_  generation:  0.5143990516662598
local_output_nid generation:  0.03920292854309082
local_in_edges_tensor generation:  0.036920785903930664
mini_batch_src_global generation:  0.05324387550354004
r_  generation:  0.5292026996612549
----------------------check_connections_block total spend ----------------------------- 3.0262250900268555
generate_one_block  0.6335639953613281
generate_one_block  0.631925106048584
generate_one_block  0.6352066993713379
generate_one_block  0.6419496536254883
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.14415788650512695  GigaBytes
Max Memory Allocated: 1.3007159233093262  GigaBytes

connection checking time:  5.4611451625823975
block generation total time  4.728321313858032
average batch blocks generation time:  1.182080328464508
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10856103897094727  GigaBytes
Max Memory Allocated: 1.3007159233093262  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.0985279083251953  GigaBytes
Max Memory Allocated: 1.3007159233093262  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10772085189819336  GigaBytes
Max Memory Allocated: 1.3007159233093262  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.0980606079101562  GigaBytes
Max Memory Allocated: 1.3007159233093262  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10875797271728516  GigaBytes
Max Memory Allocated: 1.3007159233093262  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1031889915466309  GigaBytes
Max Memory Allocated: 1.3007159233093262  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10875606536865234  GigaBytes
Max Memory Allocated: 1.3007159233093262  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.0993146896362305  GigaBytes
Max Memory Allocated: 1.3007159233093262  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08943575620651245 |0.023033857345581055 |0.003658771514892578 |9.751319885253906e-05 |0.003847062587738037 |0.0019450187683105469 |
----------------------------------------------------------pseudo_mini_loss sum 2.375553846359253
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  1679631
Number of first layer input nodes during this epoch:  656920
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.14412832260131836  GigaBytes
Max Memory Allocated: 1.3007159233093262  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0215909481048584
random selection method range initialization spend 0.005505084991455078
time for parepare:  0.017647743225097656
local_output_nid generation:  0.008682489395141602
local_in_edges_tensor generation:  0.009055852890014648
mini_batch_src_global generation:  0.0065157413482666016
r_  generation:  0.08013439178466797
local_output_nid generation:  0.011663198471069336
local_in_edges_tensor generation:  0.00626373291015625
mini_batch_src_global generation:  0.0086212158203125
r_  generation:  0.08670830726623535
local_output_nid generation:  0.011941909790039062
local_in_edges_tensor generation:  0.0063626766204833984
mini_batch_src_global generation:  0.006626605987548828
r_  generation:  0.08941221237182617
local_output_nid generation:  0.012094497680664062
local_in_edges_tensor generation:  0.0060999393463134766
mini_batch_src_global generation:  0.007303714752197266
r_  generation:  0.09299707412719727
----------------------check_connections_block total spend ----------------------------- 0.5528478622436523
generate_one_block  0.10012483596801758
generate_one_block  0.1026003360748291
generate_one_block  0.10295224189758301
generate_one_block  0.10317516326904297
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03545641899108887
gen group dst list time:  0.01096343994140625
time for parepare:  0.01906418800354004
local_output_nid generation:  0.02082061767578125
local_in_edges_tensor generation:  0.03862810134887695
mini_batch_src_global generation:  0.03898501396179199
r_  generation:  0.39259862899780273
local_output_nid generation:  0.026491641998291016
local_in_edges_tensor generation:  0.03183102607727051
mini_batch_src_global generation:  0.04919099807739258
r_  generation:  0.40793490409851074
local_output_nid generation:  0.025438547134399414
local_in_edges_tensor generation:  0.0276029109954834
mini_batch_src_global generation:  0.0467219352722168
r_  generation:  0.4152379035949707
local_output_nid generation:  0.02718830108642578
local_in_edges_tensor generation:  0.030788898468017578
mini_batch_src_global generation:  0.04763603210449219
r_  generation:  0.4182603359222412
----------------------check_connections_block total spend ----------------------------- 2.423729658126831
generate_one_block  0.5287423133850098
generate_one_block  0.5239548683166504
generate_one_block  0.549647331237793
generate_one_block  0.5342741012573242
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03681349754333496
gen group dst list time:  0.021473407745361328
time for parepare:  0.02001023292541504
local_output_nid generation:  0.030678272247314453
local_in_edges_tensor generation:  0.04958534240722656
mini_batch_src_global generation:  0.049428701400756836
r_  generation:  0.4974181652069092
local_output_nid generation:  0.03783106803894043
local_in_edges_tensor generation:  0.04991436004638672
mini_batch_src_global generation:  0.06970620155334473
r_  generation:  0.5117485523223877
local_output_nid generation:  0.040644168853759766
local_in_edges_tensor generation:  0.03914451599121094
mini_batch_src_global generation:  0.052025794982910156
r_  generation:  0.5130701065063477
local_output_nid generation:  0.03837084770202637
local_in_edges_tensor generation:  0.03803277015686035
mini_batch_src_global generation:  0.051516056060791016
r_  generation:  0.516855001449585
----------------------check_connections_block total spend ----------------------------- 3.0526859760284424
generate_one_block  0.6270120143890381
generate_one_block  0.6279666423797607
generate_one_block  0.6302070617675781
generate_one_block  0.6470129489898682
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.14412832260131836  GigaBytes
Max Memory Allocated: 1.3007159233093262  GigaBytes

connection checking time:  5.476415634155273
block generation total time  4.6688172817230225
average batch blocks generation time:  1.1672043204307556
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10857677459716797  GigaBytes
Max Memory Allocated: 1.3007159233093262  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.099062442779541  GigaBytes
Max Memory Allocated: 1.3007159233093262  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.1077570915222168  GigaBytes
Max Memory Allocated: 1.3007159233093262  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.10618257522583  GigaBytes
Max Memory Allocated: 1.3007159233093262  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10873937606811523  GigaBytes
Max Memory Allocated: 1.3007159233093262  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.0984039306640625  GigaBytes
Max Memory Allocated: 1.3007159233093262  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.1088418960571289  GigaBytes
Max Memory Allocated: 1.3007159233093262  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1065406799316406  GigaBytes
Max Memory Allocated: 1.3007159233093262  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0862959623336792 |0.019844770431518555 |0.0037793517112731934 |0.0001188516616821289 |0.0035446882247924805 |0.003276348114013672 |
----------------------------------------------------------pseudo_mini_loss sum 2.1112987995147705
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  1680728
Number of first layer input nodes during this epoch:  657114
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.14420509338378906  GigaBytes
Max Memory Allocated: 1.3007159233093262  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.029824495315551758
random selection method range initialization spend 0.00544428825378418
time for parepare:  0.018483638763427734
local_output_nid generation:  0.008707761764526367
local_in_edges_tensor generation:  0.011628389358520508
mini_batch_src_global generation:  0.006704092025756836
r_  generation:  0.08053255081176758
local_output_nid generation:  0.011642217636108398
local_in_edges_tensor generation:  0.006165742874145508
mini_batch_src_global generation:  0.009057998657226562
r_  generation:  0.08861398696899414
local_output_nid generation:  0.011838436126708984
local_in_edges_tensor generation:  0.00646209716796875
mini_batch_src_global generation:  0.0066471099853515625
r_  generation:  0.09045934677124023
local_output_nid generation:  0.011726140975952148
local_in_edges_tensor generation:  0.006333589553833008
mini_batch_src_global generation:  0.007548093795776367
r_  generation:  0.09393072128295898
----------------------check_connections_block total spend ----------------------------- 0.5612509250640869
generate_one_block  0.09884238243103027
generate_one_block  0.10238242149353027
generate_one_block  0.10292315483093262
generate_one_block  0.1021881103515625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05357074737548828
gen group dst list time:  0.010802268981933594
time for parepare:  0.019164323806762695
local_output_nid generation:  0.020096778869628906
local_in_edges_tensor generation:  0.03623390197753906
mini_batch_src_global generation:  0.036437034606933594
r_  generation:  0.3915410041809082
local_output_nid generation:  0.02674078941345215
local_in_edges_tensor generation:  0.03339195251464844
mini_batch_src_global generation:  0.04671335220336914
r_  generation:  0.4083847999572754
local_output_nid generation:  0.025629520416259766
local_in_edges_tensor generation:  0.02959609031677246
mini_batch_src_global generation:  0.04885745048522949
r_  generation:  0.4159986972808838
local_output_nid generation:  0.02867865562438965
local_in_edges_tensor generation:  0.027204036712646484
mini_batch_src_global generation:  0.04960227012634277
r_  generation:  0.42202305793762207
----------------------check_connections_block total spend ----------------------------- 2.439365863800049
generate_one_block  0.5270915031433105
generate_one_block  0.5336029529571533
generate_one_block  0.5871169567108154
generate_one_block  0.5236456394195557
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030564546585083008
gen group dst list time:  0.02135491371154785
time for parepare:  0.018929719924926758
local_output_nid generation:  0.0302731990814209
local_in_edges_tensor generation:  0.0470738410949707
mini_batch_src_global generation:  0.04495120048522949
r_  generation:  0.4913485050201416
local_output_nid generation:  0.03724956512451172
local_in_edges_tensor generation:  0.04302215576171875
mini_batch_src_global generation:  0.05507850646972656
r_  generation:  0.5003411769866943
local_output_nid generation:  0.03715968132019043
local_in_edges_tensor generation:  0.04113507270812988
mini_batch_src_global generation:  0.05342411994934082
r_  generation:  0.5135109424591064
local_output_nid generation:  0.037055015563964844
local_in_edges_tensor generation:  0.03616452217102051
mini_batch_src_global generation:  0.053522348403930664
r_  generation:  0.5298933982849121
----------------------check_connections_block total spend ----------------------------- 3.0148463249206543
generate_one_block  0.6372795104980469
generate_one_block  0.6451067924499512
generate_one_block  0.6372923851013184
generate_one_block  0.6305766105651855
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.14420509338378906  GigaBytes
Max Memory Allocated: 1.3007159233093262  GigaBytes

connection checking time:  5.454212188720703
block generation total time  4.721712350845337
average batch blocks generation time:  1.1804280877113342
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10855722427368164  GigaBytes
Max Memory Allocated: 1.3007159233093262  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.097170352935791  GigaBytes
Max Memory Allocated: 1.3007159233093262  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10868215560913086  GigaBytes
Max Memory Allocated: 1.3007159233093262  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1042208671569824  GigaBytes
Max Memory Allocated: 1.3007159233093262  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10803413391113281  GigaBytes
Max Memory Allocated: 1.3007159233093262  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1039767265319824  GigaBytes
Max Memory Allocated: 1.3007159233093262  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10853910446166992  GigaBytes
Max Memory Allocated: 1.3007159233093262  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.0997533798217773  GigaBytes
Max Memory Allocated: 1.3007159233093262  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09006547927856445 |0.02065509557723999 |0.0036687254905700684 |9.560585021972656e-05 |0.003950297832489014 |0.003450632095336914 |
----------------------------------------------------------pseudo_mini_loss sum 1.9523439407348633
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  1680565
Number of first layer input nodes during this epoch:  656992
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.14492082595825195  GigaBytes
Max Memory Allocated: 1.3007159233093262  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018775224685668945
random selection method range initialization spend 0.004920005798339844
time for parepare:  0.01833176612854004
local_output_nid generation:  0.008764505386352539
local_in_edges_tensor generation:  0.011464118957519531
mini_batch_src_global generation:  0.006627082824707031
r_  generation:  0.0826413631439209
local_output_nid generation:  0.011737823486328125
local_in_edges_tensor generation:  0.005911350250244141
mini_batch_src_global generation:  0.009475231170654297
r_  generation:  0.0898129940032959
local_output_nid generation:  0.011910200119018555
local_in_edges_tensor generation:  0.006211042404174805
mini_batch_src_global generation:  0.006676197052001953
r_  generation:  0.09238839149475098
local_output_nid generation:  0.011827945709228516
local_in_edges_tensor generation:  0.0058519840240478516
mini_batch_src_global generation:  0.00750422477722168
r_  generation:  0.09346771240234375
----------------------check_connections_block total spend ----------------------------- 0.5646591186523438
generate_one_block  0.10297465324401855
generate_one_block  0.10886216163635254
generate_one_block  0.10969185829162598
generate_one_block  0.10372757911682129
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03343796730041504
gen group dst list time:  0.010900735855102539
time for parepare:  0.01897287368774414
local_output_nid generation:  0.02083873748779297
local_in_edges_tensor generation:  0.03640031814575195
mini_batch_src_global generation:  0.03691291809082031
r_  generation:  0.4040720462799072
local_output_nid generation:  0.027122020721435547
local_in_edges_tensor generation:  0.030328989028930664
mini_batch_src_global generation:  0.05138397216796875
r_  generation:  0.42110490798950195
local_output_nid generation:  0.027208566665649414
local_in_edges_tensor generation:  0.02944803237915039
mini_batch_src_global generation:  0.04683971405029297
r_  generation:  0.44593358039855957
local_output_nid generation:  0.030815839767456055
local_in_edges_tensor generation:  0.040831804275512695
mini_batch_src_global generation:  0.051056623458862305
r_  generation:  0.4175097942352295
----------------------check_connections_block total spend ----------------------------- 2.510984182357788
generate_one_block  0.5245158672332764
generate_one_block  0.5233931541442871
generate_one_block  0.5432054996490479
generate_one_block  0.5319302082061768
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03189563751220703
gen group dst list time:  0.021012544631958008
time for parepare:  0.019158601760864258
local_output_nid generation:  0.030530214309692383
local_in_edges_tensor generation:  0.07043004035949707
mini_batch_src_global generation:  0.04724574089050293
r_  generation:  0.5021603107452393
local_output_nid generation:  0.038244009017944336
local_in_edges_tensor generation:  0.04522275924682617
mini_batch_src_global generation:  0.05833864212036133
r_  generation:  0.5086648464202881
local_output_nid generation:  0.03737044334411621
local_in_edges_tensor generation:  0.04525470733642578
mini_batch_src_global generation:  0.05307197570800781
r_  generation:  0.533735990524292
local_output_nid generation:  0.04163551330566406
local_in_edges_tensor generation:  0.03835129737854004
mini_batch_src_global generation:  0.05731463432312012
r_  generation:  0.5103309154510498
----------------------check_connections_block total spend ----------------------------- 3.086174488067627
generate_one_block  0.6286640167236328
generate_one_block  0.6281981468200684
generate_one_block  0.6234548091888428
generate_one_block  0.6413590908050537
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.14492082595825195  GigaBytes
Max Memory Allocated: 1.3007159233093262  GigaBytes

connection checking time:  5.597158670425415
block generation total time  4.644720792770386
average batch blocks generation time:  1.1611801981925964
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.1085977554321289  GigaBytes
Max Memory Allocated: 1.3007159233093262  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1073188781738281  GigaBytes
Max Memory Allocated: 1.3007159233093262  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.107696533203125  GigaBytes
Max Memory Allocated: 1.3007159233093262  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1020288467407227  GigaBytes
Max Memory Allocated: 1.3007159233093262  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10857152938842773  GigaBytes
Max Memory Allocated: 1.3007159233093262  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.099036693572998  GigaBytes
Max Memory Allocated: 1.3007159233093262  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10883808135986328  GigaBytes
Max Memory Allocated: 1.3007159233093262  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.103693962097168  GigaBytes
Max Memory Allocated: 1.3007159233093262  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08795082569122314 |0.017712891101837158 |0.003659367561340332 |9.679794311523438e-05 |0.0037404298782348633 |0.001390218734741211 |
----------------------------------------------------------pseudo_mini_loss sum 1.8709568977355957
 Run 0| Epoch 6 |
Number of nodes for computation during this epoch:  1680294
Number of first layer input nodes during this epoch:  656872
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.14499759674072266  GigaBytes
Max Memory Allocated: 1.3007159233093262  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02220439910888672
random selection method range initialization spend 0.007958650588989258
time for parepare:  0.017890214920043945
local_output_nid generation:  0.008352041244506836
local_in_edges_tensor generation:  0.008893728256225586
mini_batch_src_global generation:  0.0068359375
r_  generation:  0.08091497421264648
local_output_nid generation:  0.011913776397705078
local_in_edges_tensor generation:  0.0060346126556396484
mini_batch_src_global generation:  0.008721351623535156
r_  generation:  0.08939099311828613
local_output_nid generation:  0.011987447738647461
local_in_edges_tensor generation:  0.0059967041015625
mini_batch_src_global generation:  0.006865739822387695
r_  generation:  0.09167194366455078
local_output_nid generation:  0.011820316314697266
local_in_edges_tensor generation:  0.00612640380859375
mini_batch_src_global generation:  0.00751042366027832
r_  generation:  0.09436440467834473
----------------------check_connections_block total spend ----------------------------- 0.5593993663787842
generate_one_block  0.10036277770996094
generate_one_block  0.10547614097595215
generate_one_block  0.1029207706451416
generate_one_block  0.1053767204284668
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03297567367553711
gen group dst list time:  0.011105060577392578
time for parepare:  0.019131183624267578
local_output_nid generation:  0.020401716232299805
local_in_edges_tensor generation:  0.03664445877075195
mini_batch_src_global generation:  0.03681802749633789
r_  generation:  0.3989715576171875
local_output_nid generation:  0.02729320526123047
local_in_edges_tensor generation:  0.02793264389038086
mini_batch_src_global generation:  0.04671597480773926
r_  generation:  0.41001415252685547
local_output_nid generation:  0.026671886444091797
local_in_edges_tensor generation:  0.027254343032836914
mini_batch_src_global generation:  0.04730105400085449
r_  generation:  0.4140326976776123
local_output_nid generation:  0.026198625564575195
local_in_edges_tensor generation:  0.026836633682250977
mini_batch_src_global generation:  0.04959821701049805
r_  generation:  0.41776037216186523
----------------------check_connections_block total spend ----------------------------- 2.4212262630462646
generate_one_block  0.537320613861084
generate_one_block  0.5233361721038818
generate_one_block  0.5565462112426758
generate_one_block  0.5386068820953369
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.032958984375
gen group dst list time:  0.0212857723236084
time for parepare:  0.019215822219848633
local_output_nid generation:  0.029396533966064453
local_in_edges_tensor generation:  0.04507923126220703
mini_batch_src_global generation:  0.04464364051818848
r_  generation:  0.5104012489318848
local_output_nid generation:  0.040576934814453125
local_in_edges_tensor generation:  0.03855562210083008
mini_batch_src_global generation:  0.05513358116149902
r_  generation:  0.5012173652648926
local_output_nid generation:  0.03850412368774414
local_in_edges_tensor generation:  0.03659176826477051
mini_batch_src_global generation:  0.052028656005859375
r_  generation:  0.5176801681518555
local_output_nid generation:  0.038243770599365234
local_in_edges_tensor generation:  0.03643083572387695
mini_batch_src_global generation:  0.052024126052856445
r_  generation:  0.5197570323944092
----------------------check_connections_block total spend ----------------------------- 3.020190715789795
generate_one_block  0.6409826278686523
generate_one_block  0.628709077835083
generate_one_block  0.6351382732391357
generate_one_block  0.621509313583374
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.14499759674072266  GigaBytes
Max Memory Allocated: 1.3007159233093262  GigaBytes

connection checking time:  5.44141697883606
block generation total time  4.682149171829224
average batch blocks generation time:  1.170537292957306
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10802793502807617  GigaBytes
Max Memory Allocated: 1.3007159233093262  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1073307991027832  GigaBytes
Max Memory Allocated: 1.3007159233093262  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10869598388671875  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.096165657043457  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.1085505485534668  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.0995497703552246  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10767841339111328  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.0987553596496582  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09241366386413574 |0.015918314456939697 |0.0036243796348571777 |9.578466415405273e-05 |0.0038028955459594727 |0.003270387649536133 |
----------------------------------------------------------pseudo_mini_loss sum 1.7933063507080078
 Run 0| Epoch 7 |
Number of nodes for computation during this epoch:  1679327
Number of first layer input nodes during this epoch:  656764
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.14439630508422852  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02072882652282715
random selection method range initialization spend 0.006757974624633789
time for parepare:  0.0180361270904541
local_output_nid generation:  0.00852203369140625
local_in_edges_tensor generation:  0.011233806610107422
mini_batch_src_global generation:  0.006760358810424805
r_  generation:  0.08011507987976074
local_output_nid generation:  0.011682271957397461
local_in_edges_tensor generation:  0.006163120269775391
mini_batch_src_global generation:  0.00915837287902832
r_  generation:  0.0878288745880127
local_output_nid generation:  0.01175069808959961
local_in_edges_tensor generation:  0.005900382995605469
mini_batch_src_global generation:  0.006590127944946289
r_  generation:  0.09063482284545898
local_output_nid generation:  0.011721611022949219
local_in_edges_tensor generation:  0.0058286190032958984
mini_batch_src_global generation:  0.007464170455932617
r_  generation:  0.09276056289672852
----------------------check_connections_block total spend ----------------------------- 0.5552690029144287
generate_one_block  0.09931707382202148
generate_one_block  0.10337257385253906
generate_one_block  0.1018524169921875
generate_one_block  0.10391354560852051
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03358054161071777
gen group dst list time:  0.01517486572265625
time for parepare:  0.020282268524169922
local_output_nid generation:  0.01964426040649414
local_in_edges_tensor generation:  0.03914809226989746
mini_batch_src_global generation:  0.03928852081298828
r_  generation:  0.3924093246459961
local_output_nid generation:  0.0259702205657959
local_in_edges_tensor generation:  0.03321123123168945
mini_batch_src_global generation:  0.04729938507080078
r_  generation:  0.4376518726348877
local_output_nid generation:  0.025458335876464844
local_in_edges_tensor generation:  0.02848076820373535
mini_batch_src_global generation:  0.05186271667480469
r_  generation:  0.44155001640319824
local_output_nid generation:  0.025495052337646484
local_in_edges_tensor generation:  0.03109598159790039
mini_batch_src_global generation:  0.04853415489196777
r_  generation:  0.41828346252441406
----------------------check_connections_block total spend ----------------------------- 2.496392011642456
generate_one_block  0.5224106311798096
generate_one_block  0.5298988819122314
generate_one_block  0.5666518211364746
generate_one_block  0.5557570457458496
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03275179862976074
gen group dst list time:  0.024001598358154297
time for parepare:  0.01966404914855957
local_output_nid generation:  0.030256032943725586
local_in_edges_tensor generation:  0.05382347106933594
mini_batch_src_global generation:  0.05045056343078613
r_  generation:  0.4959137439727783
local_output_nid generation:  0.037500858306884766
local_in_edges_tensor generation:  0.04246401786804199
mini_batch_src_global generation:  0.05780959129333496
r_  generation:  0.5105621814727783
local_output_nid generation:  0.0375978946685791
local_in_edges_tensor generation:  0.0384831428527832
mini_batch_src_global generation:  0.05554533004760742
r_  generation:  0.5120143890380859
local_output_nid generation:  0.03766179084777832
local_in_edges_tensor generation:  0.0384976863861084
mini_batch_src_global generation:  0.055130958557128906
r_  generation:  0.5299131870269775
----------------------check_connections_block total spend ----------------------------- 3.0510189533233643
generate_one_block  0.6385648250579834
generate_one_block  0.6327610015869141
generate_one_block  0.6573762893676758
generate_one_block  0.6334621906280518
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.14439630508422852  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

connection checking time:  5.54741096496582
block generation total time  4.73688268661499
average batch blocks generation time:  1.1842206716537476
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10857200622558594  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.0980043411254883  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10895013809204102  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.10398530960083  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10803604125976562  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1041345596313477  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10875177383422852  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1035289764404297  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09103769063949585 |0.02004086971282959 |0.0036757588386535645 |9.72747802734375e-05 |0.0037825703620910645 |0.0012917518615722656 |
----------------------------------------------------------pseudo_mini_loss sum 1.705030918121338
 Run 0| Epoch 8 |
Number of nodes for computation during this epoch:  1680711
Number of first layer input nodes during this epoch:  656886
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.1441497802734375  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021428823471069336
random selection method range initialization spend 0.005419015884399414
time for parepare:  0.018819808959960938
local_output_nid generation:  0.008378267288208008
local_in_edges_tensor generation:  0.012196063995361328
mini_batch_src_global generation:  0.006921052932739258
r_  generation:  0.08445525169372559
local_output_nid generation:  0.011827707290649414
local_in_edges_tensor generation:  0.005956172943115234
mini_batch_src_global generation:  0.009101629257202148
r_  generation:  0.08688950538635254
local_output_nid generation:  0.011914253234863281
local_in_edges_tensor generation:  0.005910396575927734
mini_batch_src_global generation:  0.0066111087799072266
r_  generation:  0.08951663970947266
local_output_nid generation:  0.01182246208190918
local_in_edges_tensor generation:  0.006031513214111328
mini_batch_src_global generation:  0.007531642913818359
r_  generation:  0.09255409240722656
----------------------check_connections_block total spend ----------------------------- 0.5615921020507812
generate_one_block  0.10067224502563477
generate_one_block  0.10300445556640625
generate_one_block  0.10570454597473145
generate_one_block  0.10318326950073242
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03244376182556152
gen group dst list time:  0.011255741119384766
time for parepare:  0.019559144973754883
local_output_nid generation:  0.020304441452026367
local_in_edges_tensor generation:  0.03661608695983887
mini_batch_src_global generation:  0.04056429862976074
r_  generation:  0.39748620986938477
local_output_nid generation:  0.026216983795166016
local_in_edges_tensor generation:  0.031058788299560547
mini_batch_src_global generation:  0.048323631286621094
r_  generation:  0.41005539894104004
local_output_nid generation:  0.025176048278808594
local_in_edges_tensor generation:  0.02491021156311035
mini_batch_src_global generation:  0.047086238861083984
r_  generation:  0.4213564395904541
local_output_nid generation:  0.02526998519897461
local_in_edges_tensor generation:  0.02650284767150879
mini_batch_src_global generation:  0.04858207702636719
r_  generation:  0.42700719833374023
----------------------check_connections_block total spend ----------------------------- 2.4446969032287598
generate_one_block  0.539055347442627
generate_one_block  0.5335195064544678
generate_one_block  0.5732936859130859
generate_one_block  0.53074049949646
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.033921241760253906
gen group dst list time:  0.02200174331665039
time for parepare:  0.019824504852294922
local_output_nid generation:  0.03026437759399414
local_in_edges_tensor generation:  0.04822993278503418
mini_batch_src_global generation:  0.04829239845275879
r_  generation:  0.4990963935852051
local_output_nid generation:  0.03772425651550293
local_in_edges_tensor generation:  0.0409846305847168
mini_batch_src_global generation:  0.0556182861328125
r_  generation:  0.5060298442840576
local_output_nid generation:  0.03727388381958008
local_in_edges_tensor generation:  0.03686785697937012
mini_batch_src_global generation:  0.05521059036254883
r_  generation:  0.5191948413848877
local_output_nid generation:  0.03750205039978027
local_in_edges_tensor generation:  0.039310455322265625
mini_batch_src_global generation:  0.05271148681640625
r_  generation:  0.5155849456787109
----------------------check_connections_block total spend ----------------------------- 3.0274012088775635
generate_one_block  0.6235928535461426
generate_one_block  0.621239423751831
generate_one_block  0.6290900707244873
generate_one_block  0.641855001449585
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.1441497802734375  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

connection checking time:  5.472098112106323
block generation total time  4.6923863887786865
average batch blocks generation time:  1.1730965971946716
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10861587524414062  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1041841506958008  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10769844055175781  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.0990405082702637  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10863876342773438  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1035175323486328  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10889005661010742  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.0998449325561523  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07286936044692993 |0.014075398445129395 |0.0036214590072631836 |9.673833847045898e-05 |0.016493916511535645 |0.0028541088104248047 |
----------------------------------------------------------pseudo_mini_loss sum 1.6338515281677246
 Run 0| Epoch 9 |
Number of nodes for computation during this epoch:  1680605
Number of first layer input nodes during this epoch:  657113
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.14542007446289062  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02029585838317871
random selection method range initialization spend 0.0056362152099609375
time for parepare:  0.019321441650390625
local_output_nid generation:  0.00876474380493164
local_in_edges_tensor generation:  0.009010553359985352
mini_batch_src_global generation:  0.0070416927337646484
r_  generation:  0.08333110809326172
local_output_nid generation:  0.011672735214233398
local_in_edges_tensor generation:  0.006043672561645508
mini_batch_src_global generation:  0.009047985076904297
r_  generation:  0.08726167678833008
local_output_nid generation:  0.014140844345092773
local_in_edges_tensor generation:  0.006057024002075195
mini_batch_src_global generation:  0.007119894027709961
r_  generation:  0.09376311302185059
local_output_nid generation:  0.011805295944213867
local_in_edges_tensor generation:  0.006134033203125
mini_batch_src_global generation:  0.007560253143310547
r_  generation:  0.09430861473083496
----------------------check_connections_block total spend ----------------------------- 0.5677428245544434
generate_one_block  0.10155653953552246
generate_one_block  0.10578441619873047
generate_one_block  0.10486292839050293
generate_one_block  0.10500693321228027
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.033598899841308594
gen group dst list time:  0.011123895645141602
time for parepare:  0.02024698257446289
local_output_nid generation:  0.020433425903320312
local_in_edges_tensor generation:  0.03379702568054199
mini_batch_src_global generation:  0.039032936096191406
r_  generation:  0.4010496139526367
local_output_nid generation:  0.02678370475769043
local_in_edges_tensor generation:  0.03186202049255371
mini_batch_src_global generation:  0.04728507995605469
r_  generation:  0.4081847667694092
local_output_nid generation:  0.025969505310058594
local_in_edges_tensor generation:  0.027428865432739258
mini_batch_src_global generation:  0.049759864807128906
r_  generation:  0.41330409049987793
local_output_nid generation:  0.025826215744018555
local_in_edges_tensor generation:  0.027744293212890625
mini_batch_src_global generation:  0.048441410064697266
r_  generation:  0.41919898986816406
----------------------check_connections_block total spend ----------------------------- 2.433688163757324
generate_one_block  0.5293736457824707
generate_one_block  0.5301380157470703
generate_one_block  0.5609889030456543
generate_one_block  0.529557466506958
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030477523803710938
gen group dst list time:  0.02198171615600586
time for parepare:  0.018815040588378906
local_output_nid generation:  0.030370235443115234
local_in_edges_tensor generation:  0.04966306686401367
mini_batch_src_global generation:  0.04898500442504883
r_  generation:  0.49388813972473145
local_output_nid generation:  0.03766489028930664
local_in_edges_tensor generation:  0.043526411056518555
mini_batch_src_global generation:  0.05550861358642578
r_  generation:  0.5037682056427002
local_output_nid generation:  0.037554264068603516
local_in_edges_tensor generation:  0.039739370346069336
mini_batch_src_global generation:  0.05270123481750488
r_  generation:  0.512028694152832
local_output_nid generation:  0.03783917427062988
local_in_edges_tensor generation:  0.03730964660644531
mini_batch_src_global generation:  0.05193781852722168
r_  generation:  0.5182325839996338
----------------------check_connections_block total spend ----------------------------- 3.0158438682556152
generate_one_block  0.6267693042755127
generate_one_block  0.6249253749847412
generate_one_block  0.6286907196044922
generate_one_block  0.6299207210540771
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.14542007446289062  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

connection checking time:  5.4495320320129395
block generation total time  4.660364151000977
average batch blocks generation time:  1.1650910377502441
block dataloader generation time/epoch 11.917243242263794
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.1079559326171875  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1037015914916992  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10877656936645508  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.0998053550720215  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10860729217529297  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1043405532836914  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10773038864135742  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1062602996826172  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08820825815200806 |0.014043867588043213 |0.0036281347274780273 |9.423494338989258e-05 |0.0038802027702331543 |0.0017538070678710938 |
----------------------------------------------------------pseudo_mini_loss sum 1.5890538692474365
Total (block generation + training)time/epoch 12.442172765731812
Training time/epoch 0.524634599685669
Training time without block to device /epoch 0.4684591293334961
Training time without total dataloading part /epoch 0.03216409683227539
load block tensor time/epoch 0.3528330326080322
block to device time/epoch 0.05617547035217285
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 10 |
Number of nodes for computation during this epoch:  1681272
Number of first layer input nodes during this epoch:  656901
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.14432477951049805  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019189834594726562
random selection method range initialization spend 0.005533456802368164
time for parepare:  0.017645835876464844
local_output_nid generation:  0.008640050888061523
local_in_edges_tensor generation:  0.009842157363891602
mini_batch_src_global generation:  0.010596275329589844
r_  generation:  0.08183646202087402
local_output_nid generation:  0.011773109436035156
local_in_edges_tensor generation:  0.006863594055175781
mini_batch_src_global generation:  0.009218931198120117
r_  generation:  0.08631205558776855
local_output_nid generation:  0.011832714080810547
local_in_edges_tensor generation:  0.00701904296875
mini_batch_src_global generation:  0.006813526153564453
r_  generation:  0.09015607833862305
local_output_nid generation:  0.011912107467651367
local_in_edges_tensor generation:  0.0068132877349853516
mini_batch_src_global generation:  0.007822990417480469
r_  generation:  0.0946662425994873
----------------------check_connections_block total spend ----------------------------- 0.5643043518066406
generate_one_block  0.10048079490661621
generate_one_block  0.10067510604858398
generate_one_block  0.10303330421447754
generate_one_block  0.1043550968170166
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.032393455505371094
gen group dst list time:  0.011173486709594727
time for parepare:  0.019402027130126953
local_output_nid generation:  0.02034163475036621
local_in_edges_tensor generation:  0.031595468521118164
mini_batch_src_global generation:  0.03986072540283203
r_  generation:  0.396151065826416
local_output_nid generation:  0.026123046875
local_in_edges_tensor generation:  0.02585601806640625
mini_batch_src_global generation:  0.045963287353515625
r_  generation:  0.4051487445831299
local_output_nid generation:  0.02557229995727539
local_in_edges_tensor generation:  0.025936126708984375
mini_batch_src_global generation:  0.04728817939758301
r_  generation:  0.4125499725341797
local_output_nid generation:  0.025255680084228516
local_in_edges_tensor generation:  0.025620460510253906
mini_batch_src_global generation:  0.04774332046508789
r_  generation:  0.4207887649536133
----------------------check_connections_block total spend ----------------------------- 2.4018516540527344
generate_one_block  0.5278308391571045
generate_one_block  0.5164370536804199
generate_one_block  0.5459046363830566
generate_one_block  0.5305933952331543
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.022803306579589844
gen group dst list time:  0.0223541259765625
time for parepare:  0.019414186477661133
local_output_nid generation:  0.03025531768798828
local_in_edges_tensor generation:  0.04036569595336914
mini_batch_src_global generation:  0.0451812744140625
r_  generation:  0.49408841133117676
local_output_nid generation:  0.03731989860534668
local_in_edges_tensor generation:  0.04034614562988281
mini_batch_src_global generation:  0.057592153549194336
r_  generation:  0.5018353462219238
local_output_nid generation:  0.04105067253112793
local_in_edges_tensor generation:  0.03719758987426758
mini_batch_src_global generation:  0.05348062515258789
r_  generation:  0.5114138126373291
local_output_nid generation:  0.037958383560180664
local_in_edges_tensor generation:  0.0373377799987793
mini_batch_src_global generation:  0.052489280700683594
r_  generation:  0.5185458660125732
----------------------check_connections_block total spend ----------------------------- 2.9972851276397705
generate_one_block  0.626406192779541
generate_one_block  0.6378140449523926
generate_one_block  0.642524003982544
generate_one_block  0.6392154693603516
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.14432477951049805  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

connection checking time:  5.399136781692505
block generation total time  4.6667256355285645
average batch blocks generation time:  1.1666814088821411
block dataloader generation time/epoch 11.880494594573975
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.1086583137512207  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.103586196899414  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10867500305175781  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.0950608253479004  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10865402221679688  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.0988683700561523  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10791349411010742  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1072325706481934  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08455103635787964 |0.018956899642944336 |0.008546590805053711 |8.827447891235352e-05 |0.011746644973754883 |0.002728700637817383 |
----------------------------------------------------------pseudo_mini_loss sum 1.5512430667877197
Total (block generation + training)time/epoch 12.410757303237915
Training time/epoch 0.5354275703430176
Training time without block to device /epoch 0.45959997177124023
Training time without total dataloading part /epoch 0.08425474166870117
load block tensor time/epoch 0.33820414543151855
block to device time/epoch 0.07582759857177734
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 11 |
Number of nodes for computation during this epoch:  1680787
Number of first layer input nodes during this epoch:  657294
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.14459753036499023  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02312493324279785
random selection method range initialization spend 0.0054607391357421875
time for parepare:  0.019503116607666016
local_output_nid generation:  0.00886845588684082
local_in_edges_tensor generation:  0.011260271072387695
mini_batch_src_global generation:  0.006748199462890625
r_  generation:  0.08102631568908691
local_output_nid generation:  0.011880159378051758
local_in_edges_tensor generation:  0.006234407424926758
mini_batch_src_global generation:  0.009404182434082031
r_  generation:  0.08793497085571289
local_output_nid generation:  0.011966228485107422
local_in_edges_tensor generation:  0.006173610687255859
mini_batch_src_global generation:  0.007101297378540039
r_  generation:  0.09058523178100586
local_output_nid generation:  0.011982917785644531
local_in_edges_tensor generation:  0.006031513214111328
mini_batch_src_global generation:  0.007656097412109375
r_  generation:  0.0978536605834961
----------------------check_connections_block total spend ----------------------------- 0.5673708915710449
generate_one_block  0.10121607780456543
generate_one_block  0.10213470458984375
generate_one_block  0.10361075401306152
generate_one_block  0.1047053337097168
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.030712604522705078
gen group dst list time:  0.010957479476928711
time for parepare:  0.019937992095947266
local_output_nid generation:  0.02091813087463379
local_in_edges_tensor generation:  0.03850603103637695
mini_batch_src_global generation:  0.03899216651916504
r_  generation:  0.4008641242980957
local_output_nid generation:  0.026785612106323242
local_in_edges_tensor generation:  0.030260324478149414
mini_batch_src_global generation:  0.046586036682128906
r_  generation:  0.4106903076171875
local_output_nid generation:  0.025499343872070312
local_in_edges_tensor generation:  0.02860426902770996
mini_batch_src_global generation:  0.04920554161071777
r_  generation:  0.41644978523254395
local_output_nid generation:  0.025836706161499023
local_in_edges_tensor generation:  0.025731563568115234
mini_batch_src_global generation:  0.04761791229248047
r_  generation:  0.417834997177124
----------------------check_connections_block total spend ----------------------------- 2.434140205383301
generate_one_block  0.5244839191436768
generate_one_block  0.5256295204162598
generate_one_block  0.5461952686309814
generate_one_block  0.5191514492034912
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.025233030319213867
gen group dst list time:  0.021963119506835938
time for parepare:  0.01920938491821289
local_output_nid generation:  0.030093908309936523
local_in_edges_tensor generation:  0.040849924087524414
mini_batch_src_global generation:  0.04911303520202637
r_  generation:  0.49486684799194336
local_output_nid generation:  0.0369572639465332
local_in_edges_tensor generation:  0.0401461124420166
mini_batch_src_global generation:  0.05811333656311035
r_  generation:  0.5034518241882324
local_output_nid generation:  0.0372471809387207
local_in_edges_tensor generation:  0.03647613525390625
mini_batch_src_global generation:  0.055425405502319336
r_  generation:  0.5133316516876221
local_output_nid generation:  0.03754162788391113
local_in_edges_tensor generation:  0.036156654357910156
mini_batch_src_global generation:  0.05216169357299805
r_  generation:  0.5199828147888184
----------------------check_connections_block total spend ----------------------------- 3.005765199661255
generate_one_block  0.6304793357849121
generate_one_block  0.6226468086242676
generate_one_block  0.6262772083282471
generate_one_block  0.6238622665405273
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.14459753036499023  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

connection checking time:  5.439905405044556
block generation total time  4.618725776672363
average batch blocks generation time:  1.1546814441680908
block dataloader generation time/epoch 11.860554933547974
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10880327224731445  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1036076545715332  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10869026184082031  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.0961055755615234  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10864782333374023  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.107419490814209  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10776329040527344  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1064934730529785  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09254169464111328 |0.013316154479980469 |0.0036055445671081543 |9.584426879882812e-05 |0.003832995891571045 |0.0018169879913330078 |
----------------------------------------------------------pseudo_mini_loss sum 1.5074965953826904
Total (block generation + training)time/epoch 12.393956581751505
Training time/epoch 0.5394134521484375
Training time without block to device /epoch 0.4861488342285156
Training time without total dataloading part /epoch 0.03195452690124512
load block tensor time/epoch 0.3701667785644531
block to device time/epoch 0.053264617919921875
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 12 |
Number of nodes for computation during this epoch:  1680883
Number of first layer input nodes during this epoch:  657048
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.14434146881103516  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019002199172973633
random selection method range initialization spend 0.00545501708984375
time for parepare:  0.017331361770629883
local_output_nid generation:  0.008671760559082031
local_in_edges_tensor generation:  0.008088111877441406
mini_batch_src_global generation:  0.006821155548095703
r_  generation:  0.0802760124206543
local_output_nid generation:  0.011733770370483398
local_in_edges_tensor generation:  0.0059435367584228516
mini_batch_src_global generation:  0.009148120880126953
r_  generation:  0.08711647987365723
local_output_nid generation:  0.011744260787963867
local_in_edges_tensor generation:  0.005879878997802734
mini_batch_src_global generation:  0.006709098815917969
r_  generation:  0.09053611755371094
local_output_nid generation:  0.011881113052368164
local_in_edges_tensor generation:  0.0059986114501953125
mini_batch_src_global generation:  0.0076024532318115234
r_  generation:  0.09528136253356934
----------------------check_connections_block total spend ----------------------------- 0.5558664798736572
generate_one_block  0.09973502159118652
generate_one_block  0.10285544395446777
generate_one_block  0.10265064239501953
generate_one_block  0.10387659072875977
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.028842449188232422
gen group dst list time:  0.011241674423217773
time for parepare:  0.019449472427368164
local_output_nid generation:  0.02081894874572754
local_in_edges_tensor generation:  0.03130602836608887
mini_batch_src_global generation:  0.03888750076293945
r_  generation:  0.39744114875793457
local_output_nid generation:  0.027347564697265625
local_in_edges_tensor generation:  0.026201248168945312
mini_batch_src_global generation:  0.0471644401550293
r_  generation:  0.4113032817840576
local_output_nid generation:  0.025774717330932617
local_in_edges_tensor generation:  0.025577545166015625
mini_batch_src_global generation:  0.0481104850769043
r_  generation:  0.41700220108032227
local_output_nid generation:  0.02604818344116211
local_in_edges_tensor generation:  0.02599501609802246
mini_batch_src_global generation:  0.04812932014465332
r_  generation:  0.4181387424468994
----------------------check_connections_block total spend ----------------------------- 2.4160571098327637
generate_one_block  0.5212714672088623
generate_one_block  0.5237829685211182
generate_one_block  0.5460562705993652
generate_one_block  0.5234706401824951
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.027454614639282227
gen group dst list time:  0.022270917892456055
time for parepare:  0.018826007843017578
local_output_nid generation:  0.030195951461791992
local_in_edges_tensor generation:  0.04029440879821777
mini_batch_src_global generation:  0.048081398010253906
r_  generation:  0.4924123287200928
local_output_nid generation:  0.03828573226928711
local_in_edges_tensor generation:  0.03470182418823242
mini_batch_src_global generation:  0.055294036865234375
r_  generation:  0.5049841403961182
local_output_nid generation:  0.03780531883239746
local_in_edges_tensor generation:  0.03795647621154785
mini_batch_src_global generation:  0.051824331283569336
r_  generation:  0.514350175857544
local_output_nid generation:  0.037133216857910156
local_in_edges_tensor generation:  0.03448176383972168
mini_batch_src_global generation:  0.0525515079498291
r_  generation:  0.5159509181976318
----------------------check_connections_block total spend ----------------------------- 2.9973690509796143
generate_one_block  0.6232204437255859
generate_one_block  0.6244442462921143
generate_one_block  0.6203174591064453
generate_one_block  0.6280050277709961
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.14434146881103516  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

connection checking time:  5.413426160812378
block generation total time  4.610568523406982
average batch blocks generation time:  1.1526421308517456
block dataloader generation time/epoch 11.840340733528137
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10857725143432617  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1034860610961914  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.1088557243347168  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1008415222167969  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.1079411506652832  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1037559509277344  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10888433456420898  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1039080619812012  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08835625648498535 |0.016748249530792236 |0.003473520278930664 |8.52346420288086e-05 |0.0037256479263305664 |0.0027227401733398438 |
----------------------------------------------------------pseudo_mini_loss sum 1.4834874868392944
Total (block generation + training)time/epoch 12.374714314937592
Training time/epoch 0.537083625793457
Training time without block to device /epoch 0.4700906276702881
Training time without total dataloading part /epoch 0.0318603515625
load block tensor time/epoch 0.3534250259399414
block to device time/epoch 0.06699299812316895
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 13 |
Number of nodes for computation during this epoch:  1680945
Number of first layer input nodes during this epoch:  657003
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.1450810432434082  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019972562789916992
random selection method range initialization spend 0.005419492721557617
time for parepare:  0.020563364028930664
local_output_nid generation:  0.00867772102355957
local_in_edges_tensor generation:  0.008157730102539062
mini_batch_src_global generation:  0.0068035125732421875
r_  generation:  0.08638715744018555
local_output_nid generation:  0.012981891632080078
local_in_edges_tensor generation:  0.006024360656738281
mini_batch_src_global generation:  0.009176254272460938
r_  generation:  0.08989119529724121
local_output_nid generation:  0.01192474365234375
local_in_edges_tensor generation:  0.006084918975830078
mini_batch_src_global generation:  0.00702667236328125
r_  generation:  0.09144115447998047
local_output_nid generation:  0.01210165023803711
local_in_edges_tensor generation:  0.005997180938720703
mini_batch_src_global generation:  0.007669210433959961
r_  generation:  0.09453701972961426
----------------------check_connections_block total spend ----------------------------- 0.5718746185302734
generate_one_block  0.09934091567993164
generate_one_block  0.1027214527130127
generate_one_block  0.10180974006652832
generate_one_block  0.10391116142272949
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03713488578796387
gen group dst list time:  0.011001110076904297
time for parepare:  0.019999027252197266
local_output_nid generation:  0.020036697387695312
local_in_edges_tensor generation:  0.038346052169799805
mini_batch_src_global generation:  0.040364742279052734
r_  generation:  0.3963644504547119
local_output_nid generation:  0.02659320831298828
local_in_edges_tensor generation:  0.029488325119018555
mini_batch_src_global generation:  0.05206918716430664
r_  generation:  0.41123175621032715
local_output_nid generation:  0.024861574172973633
local_in_edges_tensor generation:  0.024770021438598633
mini_batch_src_global generation:  0.04785490036010742
r_  generation:  0.41411590576171875
local_output_nid generation:  0.02496337890625
local_in_edges_tensor generation:  0.026937484741210938
mini_batch_src_global generation:  0.04881024360656738
r_  generation:  0.4176063537597656
----------------------check_connections_block total spend ----------------------------- 2.4304323196411133
generate_one_block  0.5233333110809326
generate_one_block  0.5395834445953369
generate_one_block  0.5480518341064453
generate_one_block  0.5275993347167969
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028393983840942383
gen group dst list time:  0.021919727325439453
time for parepare:  0.018944740295410156
local_output_nid generation:  0.031516075134277344
local_in_edges_tensor generation:  0.04445171356201172
mini_batch_src_global generation:  0.04824328422546387
r_  generation:  0.5017776489257812
local_output_nid generation:  0.03874802589416504
local_in_edges_tensor generation:  0.04324221611022949
mini_batch_src_global generation:  0.05749821662902832
r_  generation:  0.5094490051269531
local_output_nid generation:  0.03841376304626465
local_in_edges_tensor generation:  0.04649043083190918
mini_batch_src_global generation:  0.05286383628845215
r_  generation:  0.5324881076812744
local_output_nid generation:  0.04201555252075195
local_in_edges_tensor generation:  0.040338754653930664
mini_batch_src_global generation:  0.059740543365478516
r_  generation:  0.5127649307250977
----------------------check_connections_block total spend ----------------------------- 3.0713210105895996
generate_one_block  0.6250088214874268
generate_one_block  0.632617712020874
generate_one_block  0.6283600330352783
generate_one_block  0.6342258453369141
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.1450810432434082  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

connection checking time:  5.501753330230713
block generation total time  4.658780336380005
average batch blocks generation time:  1.1646950840950012
block dataloader generation time/epoch 11.863808917999268
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10784721374511719  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.0981874465942383  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10900497436523438  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.10744047164917  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10788726806640625  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.0984392166137695  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10893869400024414  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1042156219482422  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09053367376327515 |0.01799452304840088 |0.003625631332397461 |9.453296661376953e-05 |0.003858208656311035 |0.0029611587524414062 |
----------------------------------------------------------pseudo_mini_loss sum 1.4523930549621582
Total (block generation + training)time/epoch 12.401840353012085
Training time/epoch 0.5523395538330078
Training time without block to device /epoch 0.4803614616394043
Training time without total dataloading part /epoch 0.03327465057373047
load block tensor time/epoch 0.3621346950531006
block to device time/epoch 0.07197809219360352
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 14 |
Number of nodes for computation during this epoch:  1680147
Number of first layer input nodes during this epoch:  656987
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.14545965194702148  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021857261657714844
random selection method range initialization spend 0.0061032772064208984
time for parepare:  0.0192415714263916
local_output_nid generation:  0.00838613510131836
local_in_edges_tensor generation:  0.011405467987060547
mini_batch_src_global generation:  0.006890296936035156
r_  generation:  0.0803227424621582
local_output_nid generation:  0.011688470840454102
local_in_edges_tensor generation:  0.006035327911376953
mini_batch_src_global generation:  0.00950765609741211
r_  generation:  0.08649230003356934
local_output_nid generation:  0.01172947883605957
local_in_edges_tensor generation:  0.0057489871978759766
mini_batch_src_global generation:  0.006749391555786133
r_  generation:  0.0900106430053711
local_output_nid generation:  0.01179814338684082
local_in_edges_tensor generation:  0.0057942867279052734
mini_batch_src_global generation:  0.00739288330078125
r_  generation:  0.09138107299804688
----------------------check_connections_block total spend ----------------------------- 0.5541834831237793
generate_one_block  0.10250425338745117
generate_one_block  0.10156536102294922
generate_one_block  0.10266447067260742
generate_one_block  0.10556840896606445
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03649330139160156
gen group dst list time:  0.011023998260498047
time for parepare:  0.019176244735717773
local_output_nid generation:  0.019893169403076172
local_in_edges_tensor generation:  0.035369873046875
mini_batch_src_global generation:  0.04017138481140137
r_  generation:  0.3909950256347656
local_output_nid generation:  0.026045560836791992
local_in_edges_tensor generation:  0.031383514404296875
mini_batch_src_global generation:  0.04700660705566406
r_  generation:  0.4048943519592285
local_output_nid generation:  0.024966001510620117
local_in_edges_tensor generation:  0.024847745895385742
mini_batch_src_global generation:  0.04875993728637695
r_  generation:  0.41055774688720703
local_output_nid generation:  0.024694204330444336
local_in_edges_tensor generation:  0.02440667152404785
mini_batch_src_global generation:  0.04752016067504883
r_  generation:  0.4093201160430908
----------------------check_connections_block total spend ----------------------------- 2.3902769088745117
generate_one_block  0.5157911777496338
generate_one_block  0.5201022624969482
generate_one_block  0.5417366027832031
generate_one_block  0.516655683517456
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02588653564453125
gen group dst list time:  0.021686315536499023
time for parepare:  0.018689870834350586
local_output_nid generation:  0.029302120208740234
local_in_edges_tensor generation:  0.03934812545776367
mini_batch_src_global generation:  0.04549837112426758
r_  generation:  0.49690866470336914
local_output_nid generation:  0.03653287887573242
local_in_edges_tensor generation:  0.0372772216796875
mini_batch_src_global generation:  0.05733847618103027
r_  generation:  0.49924159049987793
local_output_nid generation:  0.03670787811279297
local_in_edges_tensor generation:  0.03715634346008301
mini_batch_src_global generation:  0.05239391326904297
r_  generation:  0.5108866691589355
local_output_nid generation:  0.03683114051818848
local_in_edges_tensor generation:  0.03591108322143555
mini_batch_src_global generation:  0.05140566825866699
r_  generation:  0.5152428150177002
----------------------check_connections_block total spend ----------------------------- 2.9904215335845947
generate_one_block  0.6397101879119873
generate_one_block  0.6319019794464111
generate_one_block  0.6262540817260742
generate_one_block  0.6249170303344727
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.14545965194702148  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

connection checking time:  5.3806984424591064
block generation total time  4.6170690059661865
average batch blocks generation time:  1.1542672514915466
block dataloader generation time/epoch 11.864026745160421
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10793018341064453  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.0992846488952637  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.1088705062866211  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.104020595550537  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10799837112426758  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1039800643920898  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.1087331771850586  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.0992889404296875  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08909589052200317 |0.017495930194854736 |0.0035430192947387695 |9.185075759887695e-05 |0.003729522228240967 |0.0015523433685302734 |
----------------------------------------------------------pseudo_mini_loss sum 1.4249768257141113
Total (block generation + training)time/epoch 12.40273137887319
Training time/epoch 0.5418968200683594
Training time without block to device /epoch 0.47191309928894043
Training time without total dataloading part /epoch 0.031009912490844727
load block tensor time/epoch 0.3563835620880127
block to device time/epoch 0.06998372077941895
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 15 |
Number of nodes for computation during this epoch:  1680436
Number of first layer input nodes during this epoch:  656880
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.14406490325927734  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021602630615234375
random selection method range initialization spend 0.0050241947174072266
time for parepare:  0.018600940704345703
local_output_nid generation:  0.008587121963500977
local_in_edges_tensor generation:  0.013234615325927734
mini_batch_src_global generation:  0.006823539733886719
r_  generation:  0.07981681823730469
local_output_nid generation:  0.012053489685058594
local_in_edges_tensor generation:  0.0064830780029296875
mini_batch_src_global generation:  0.009059667587280273
r_  generation:  0.08845162391662598
local_output_nid generation:  0.012793540954589844
local_in_edges_tensor generation:  0.006711006164550781
mini_batch_src_global generation:  0.006532907485961914
r_  generation:  0.09013962745666504
local_output_nid generation:  0.012326955795288086
local_in_edges_tensor generation:  0.0064160823822021484
mini_batch_src_global generation:  0.0074062347412109375
r_  generation:  0.09361839294433594
----------------------check_connections_block total spend ----------------------------- 0.5626077651977539
generate_one_block  0.1002342700958252
generate_one_block  0.10182809829711914
generate_one_block  0.10185575485229492
generate_one_block  0.10297513008117676
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03565239906311035
gen group dst list time:  0.011156320571899414
time for parepare:  0.02248668670654297
local_output_nid generation:  0.0206606388092041
local_in_edges_tensor generation:  0.03728747367858887
mini_batch_src_global generation:  0.038312673568725586
r_  generation:  0.39659643173217773
local_output_nid generation:  0.02646183967590332
local_in_edges_tensor generation:  0.031032800674438477
mini_batch_src_global generation:  0.048497676849365234
r_  generation:  0.4069552421569824
local_output_nid generation:  0.025142431259155273
local_in_edges_tensor generation:  0.025668859481811523
mini_batch_src_global generation:  0.0471804141998291
r_  generation:  0.4088327884674072
local_output_nid generation:  0.02505946159362793
local_in_edges_tensor generation:  0.026466846466064453
mini_batch_src_global generation:  0.047662973403930664
r_  generation:  0.4131753444671631
----------------------check_connections_block total spend ----------------------------- 2.407586097717285
generate_one_block  0.5242099761962891
generate_one_block  0.5155937671661377
generate_one_block  0.5349993705749512
generate_one_block  0.5216598510742188
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.026782751083374023
gen group dst list time:  0.021701574325561523
time for parepare:  0.01920461654663086
local_output_nid generation:  0.029536724090576172
local_in_edges_tensor generation:  0.04026961326599121
mini_batch_src_global generation:  0.044779300689697266
r_  generation:  0.4905228614807129
local_output_nid generation:  0.036977529525756836
local_in_edges_tensor generation:  0.03891611099243164
mini_batch_src_global generation:  0.0554506778717041
r_  generation:  0.5008220672607422
local_output_nid generation:  0.036864280700683594
local_in_edges_tensor generation:  0.03583121299743652
mini_batch_src_global generation:  0.053626060485839844
r_  generation:  0.510270357131958
local_output_nid generation:  0.03681659698486328
local_in_edges_tensor generation:  0.03377270698547363
mini_batch_src_global generation:  0.05121421813964844
r_  generation:  0.5166118144989014
----------------------check_connections_block total spend ----------------------------- 2.972620964050293
generate_one_block  0.6154108047485352
generate_one_block  0.6269941329956055
generate_one_block  0.6201672554016113
generate_one_block  0.6257224082946777
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.14406490325927734  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

connection checking time:  5.380207061767578
block generation total time  4.584757566452026
average batch blocks generation time:  1.1461893916130066
block dataloader generation time/epoch 11.847658157348633
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10859298706054688  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1043953895568848  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10775899887084961  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.0994086265563965  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10849523544311523  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.0965776443481445  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10868453979492188  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.107213020324707  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09068548679351807 |0.013062834739685059 |0.0034827589988708496 |9.34600830078125e-05 |0.0037488937377929688 |0.001522064208984375 |
----------------------------------------------------------pseudo_mini_loss sum 1.394248127937317
Total (block generation + training)time/epoch 12.385476248604911
Training time/epoch 0.5322813987731934
Training time without block to device /epoch 0.4800300598144531
Training time without total dataloading part /epoch 0.0308225154876709
load block tensor time/epoch 0.36274194717407227
block to device time/epoch 0.052251338958740234
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 16 |
Number of nodes for computation during this epoch:  1680871
Number of first layer input nodes during this epoch:  657141
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.1448512077331543  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018765926361083984
random selection method range initialization spend 0.004851341247558594
time for parepare:  0.017249345779418945
local_output_nid generation:  0.008739948272705078
local_in_edges_tensor generation:  0.008045673370361328
mini_batch_src_global generation:  0.006806373596191406
r_  generation:  0.08017134666442871
local_output_nid generation:  0.01161813735961914
local_in_edges_tensor generation:  0.006001949310302734
mini_batch_src_global generation:  0.008830070495605469
r_  generation:  0.08628249168395996
local_output_nid generation:  0.011745929718017578
local_in_edges_tensor generation:  0.0063915252685546875
mini_batch_src_global generation:  0.006699085235595703
r_  generation:  0.09241414070129395
local_output_nid generation:  0.01187443733215332
local_in_edges_tensor generation:  0.008499860763549805
mini_batch_src_global generation:  0.007992744445800781
r_  generation:  0.0928502082824707
----------------------check_connections_block total spend ----------------------------- 0.556908369064331
generate_one_block  0.09958648681640625
generate_one_block  0.10194873809814453
generate_one_block  0.10446810722351074
generate_one_block  0.10161757469177246
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.036821603775024414
gen group dst list time:  0.011044740676879883
time for parepare:  0.020003795623779297
local_output_nid generation:  0.019549131393432617
local_in_edges_tensor generation:  0.0445253849029541
mini_batch_src_global generation:  0.0420069694519043
r_  generation:  0.4089505672454834
local_output_nid generation:  0.028673648834228516
local_in_edges_tensor generation:  0.032506465911865234
mini_batch_src_global generation:  0.046439409255981445
r_  generation:  0.40303587913513184
local_output_nid generation:  0.02530837059020996
local_in_edges_tensor generation:  0.028174638748168945
mini_batch_src_global generation:  0.04906964302062988
r_  generation:  0.4085702896118164
local_output_nid generation:  0.02535223960876465
local_in_edges_tensor generation:  0.02602529525756836
mini_batch_src_global generation:  0.04788398742675781
r_  generation:  0.4107940196990967
----------------------check_connections_block total spend ----------------------------- 2.426617383956909
generate_one_block  0.5131556987762451
generate_one_block  0.516850471496582
generate_one_block  0.5471358299255371
generate_one_block  0.5242564678192139
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030165672302246094
gen group dst list time:  0.021547317504882812
time for parepare:  0.018630266189575195
local_output_nid generation:  0.02835845947265625
local_in_edges_tensor generation:  0.04757547378540039
mini_batch_src_global generation:  0.04516100883483887
r_  generation:  0.48990464210510254
local_output_nid generation:  0.036309242248535156
local_in_edges_tensor generation:  0.03944540023803711
mini_batch_src_global generation:  0.05527949333190918
r_  generation:  0.4959559440612793
local_output_nid generation:  0.03634071350097656
local_in_edges_tensor generation:  0.03533530235290527
mini_batch_src_global generation:  0.052129507064819336
r_  generation:  0.506598949432373
local_output_nid generation:  0.03632760047912598
local_in_edges_tensor generation:  0.03332710266113281
mini_batch_src_global generation:  0.05414557456970215
r_  generation:  0.5118906497955322
----------------------check_connections_block total spend ----------------------------- 2.9626054763793945
generate_one_block  0.6155121326446533
generate_one_block  0.6255819797515869
generate_one_block  0.6155717372894287
generate_one_block  0.6198878288269043
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.1448512077331543  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

connection checking time:  5.389222860336304
block generation total time  4.577952146530151
average batch blocks generation time:  1.1444880366325378
block dataloader generation time/epoch 11.831894963979721
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10793685913085938  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1063451766967773  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10863065719604492  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1003060340881348  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10799694061279297  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1025466918945312  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10856771469116211  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.100633144378662  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08675366640090942 |0.013276994228363037 |0.0035317540168762207 |9.274482727050781e-05 |0.0032659173011779785 |0.0017139911651611328 |
----------------------------------------------------------pseudo_mini_loss sum 1.368462085723877
Total (block generation + training)time/epoch 12.366864800453186
Training time/epoch 0.5147712230682373
Training time without block to device /epoch 0.46166324615478516
Training time without total dataloading part /epoch 0.02927565574645996
load block tensor time/epoch 0.3470146656036377
block to device time/epoch 0.05310797691345215
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 17 |
Number of nodes for computation during this epoch:  1680881
Number of first layer input nodes during this epoch:  656998
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.14493513107299805  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022188663482666016
random selection method range initialization spend 0.0048656463623046875
time for parepare:  0.017460107803344727
local_output_nid generation:  0.00890350341796875
local_in_edges_tensor generation:  0.008346796035766602
mini_batch_src_global generation:  0.006868839263916016
r_  generation:  0.08470606803894043
local_output_nid generation:  0.0115966796875
local_in_edges_tensor generation:  0.005865812301635742
mini_batch_src_global generation:  0.00895237922668457
r_  generation:  0.08677887916564941
local_output_nid generation:  0.011759757995605469
local_in_edges_tensor generation:  0.005795955657958984
mini_batch_src_global generation:  0.006603717803955078
r_  generation:  0.08853340148925781
local_output_nid generation:  0.011762380599975586
local_in_edges_tensor generation:  0.00600886344909668
mini_batch_src_global generation:  0.007418632507324219
r_  generation:  0.09308099746704102
----------------------check_connections_block total spend ----------------------------- 0.5552520751953125
generate_one_block  0.09903073310852051
generate_one_block  0.1017756462097168
generate_one_block  0.10196566581726074
generate_one_block  0.10328245162963867
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.030303955078125
gen group dst list time:  0.011072874069213867
time for parepare:  0.01931023597717285
local_output_nid generation:  0.0199429988861084
local_in_edges_tensor generation:  0.040142059326171875
mini_batch_src_global generation:  0.03900337219238281
r_  generation:  0.3924527168273926
local_output_nid generation:  0.026206493377685547
local_in_edges_tensor generation:  0.024321556091308594
mini_batch_src_global generation:  0.047937870025634766
r_  generation:  0.4074435234069824
local_output_nid generation:  0.024961471557617188
local_in_edges_tensor generation:  0.024721145629882812
mini_batch_src_global generation:  0.04855465888977051
r_  generation:  0.4092996120452881
local_output_nid generation:  0.024810314178466797
local_in_edges_tensor generation:  0.024596691131591797
mini_batch_src_global generation:  0.04766440391540527
r_  generation:  0.4137911796569824
----------------------check_connections_block total spend ----------------------------- 2.394165277481079
generate_one_block  0.5163624286651611
generate_one_block  0.5150408744812012
generate_one_block  0.5394032001495361
generate_one_block  0.5178134441375732
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.027789831161499023
gen group dst list time:  0.021688461303710938
time for parepare:  0.018446922302246094
local_output_nid generation:  0.02948307991027832
local_in_edges_tensor generation:  0.03851485252380371
mini_batch_src_global generation:  0.04476165771484375
r_  generation:  0.49024438858032227
local_output_nid generation:  0.03664875030517578
local_in_edges_tensor generation:  0.03659224510192871
mini_batch_src_global generation:  0.0551762580871582
r_  generation:  0.4957084655761719
local_output_nid generation:  0.03687882423400879
local_in_edges_tensor generation:  0.03413248062133789
mini_batch_src_global generation:  0.051483154296875
r_  generation:  0.5065946578979492
local_output_nid generation:  0.03647327423095703
local_in_edges_tensor generation:  0.03392195701599121
mini_batch_src_global generation:  0.051278114318847656
r_  generation:  0.5134904384613037
----------------------check_connections_block total spend ----------------------------- 2.953007459640503
generate_one_block  0.6155340671539307
generate_one_block  0.6195633411407471
generate_one_block  0.624962568283081
generate_one_block  0.631035566329956
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.14493513107299805  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

connection checking time:  5.347172737121582
block generation total time  4.5797154903411865
average batch blocks generation time:  1.1449288725852966
block dataloader generation time/epoch 11.815302663379246
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10857582092285156  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1041569709777832  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.1077275276184082  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.099233627319336  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10854625701904297  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1002278327941895  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10882377624511719  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.0992341041564941  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08746159076690674 |0.012917101383209229 |0.003319859504699707 |8.589029312133789e-05 |0.003594696521759033 |0.0026061534881591797 |
----------------------------------------------------------pseudo_mini_loss sum 1.3491544723510742
Total (block generation + training)time/epoch 12.348005268308851
Training time/epoch 0.5143935680389404
Training time without block to device /epoch 0.4627251625061035
Training time without total dataloading part /epoch 0.030607938766479492
load block tensor time/epoch 0.34984636306762695
block to device time/epoch 0.051668405532836914
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 18 |
Number of nodes for computation during this epoch:  1680458
Number of first layer input nodes during this epoch:  656968
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.14504241943359375  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.015625953674316406
random selection method range initialization spend 0.0048656463623046875
time for parepare:  0.01723480224609375
local_output_nid generation:  0.008892297744750977
local_in_edges_tensor generation:  0.008090019226074219
mini_batch_src_global generation:  0.006701946258544922
r_  generation:  0.0796971321105957
local_output_nid generation:  0.012070655822753906
local_in_edges_tensor generation:  0.005889892578125
mini_batch_src_global generation:  0.00899195671081543
r_  generation:  0.08669209480285645
local_output_nid generation:  0.012112855911254883
local_in_edges_tensor generation:  0.005859375
mini_batch_src_global generation:  0.00675511360168457
r_  generation:  0.09043717384338379
local_output_nid generation:  0.012247085571289062
local_in_edges_tensor generation:  0.005979061126708984
mini_batch_src_global generation:  0.00763249397277832
r_  generation:  0.09319591522216797
----------------------check_connections_block total spend ----------------------------- 0.5523896217346191
generate_one_block  0.09853744506835938
generate_one_block  0.10244894027709961
generate_one_block  0.10511422157287598
generate_one_block  0.10387897491455078
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0285336971282959
gen group dst list time:  0.01121377944946289
time for parepare:  0.019342660903930664
local_output_nid generation:  0.02095174789428711
local_in_edges_tensor generation:  0.029358625411987305
mini_batch_src_global generation:  0.03765106201171875
r_  generation:  0.38838887214660645
local_output_nid generation:  0.027001142501831055
local_in_edges_tensor generation:  0.0246732234954834
mini_batch_src_global generation:  0.04678511619567871
r_  generation:  0.40709495544433594
local_output_nid generation:  0.026055097579956055
local_in_edges_tensor generation:  0.025326013565063477
mini_batch_src_global generation:  0.04740095138549805
r_  generation:  0.4126315116882324
local_output_nid generation:  0.025606632232666016
local_in_edges_tensor generation:  0.02497720718383789
mini_batch_src_global generation:  0.04749417304992676
r_  generation:  0.4109225273132324
----------------------check_connections_block total spend ----------------------------- 2.3813014030456543
generate_one_block  0.5161705017089844
generate_one_block  0.5215158462524414
generate_one_block  0.5422630310058594
generate_one_block  0.5136322975158691
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.034441232681274414
gen group dst list time:  0.021735191345214844
time for parepare:  0.018891096115112305
local_output_nid generation:  0.02957749366760254
local_in_edges_tensor generation:  0.044319868087768555
mini_batch_src_global generation:  0.04563498497009277
r_  generation:  0.4892117977142334
local_output_nid generation:  0.0372164249420166
local_in_edges_tensor generation:  0.033455610275268555
mini_batch_src_global generation:  0.055170536041259766
r_  generation:  0.49857068061828613
local_output_nid generation:  0.0370028018951416
local_in_edges_tensor generation:  0.033684492111206055
mini_batch_src_global generation:  0.05227088928222656
r_  generation:  0.5039322376251221
local_output_nid generation:  0.03678441047668457
local_in_edges_tensor generation:  0.032998085021972656
mini_batch_src_global generation:  0.05197024345397949
r_  generation:  0.5092978477478027
----------------------check_connections_block total spend ----------------------------- 2.954380989074707
generate_one_block  0.6238114833831787
generate_one_block  0.6185245513916016
generate_one_block  0.6224915981292725
generate_one_block  0.6289651393890381
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.14504241943359375  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

connection checking time:  5.335682392120361
block generation total time  4.587374448776245
average batch blocks generation time:  1.1468436121940613
block dataloader generation time/epoch 11.797343230247497
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10787582397460938  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1024441719055176  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.1080465316772461  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1041374206542969  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10798406600952148  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1040887832641602  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10880184173583984  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.100569248199463  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08696693181991577 |0.018879354000091553 |0.003451824188232422 |8.374452590942383e-05 |0.003718733787536621 |0.001898050308227539 |
----------------------------------------------------------pseudo_mini_loss sum 1.340661644935608
Total (block generation + training)time/epoch 12.330569553375245
Training time/epoch 0.5378158092498779
Training time without block to device /epoch 0.4622983932495117
Training time without total dataloading part /epoch 0.030915260314941406
load block tensor time/epoch 0.3478677272796631
block to device time/epoch 0.07551741600036621
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 19 |
Number of nodes for computation during this epoch:  1681071
Number of first layer input nodes during this epoch:  657054
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.14505434036254883  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022846221923828125
random selection method range initialization spend 0.004965305328369141
time for parepare:  0.017269611358642578
local_output_nid generation:  0.00857996940612793
local_in_edges_tensor generation:  0.008036136627197266
mini_batch_src_global generation:  0.006853580474853516
r_  generation:  0.08104085922241211
local_output_nid generation:  0.011738061904907227
local_in_edges_tensor generation:  0.006157636642456055
mini_batch_src_global generation:  0.008876323699951172
r_  generation:  0.08704972267150879
local_output_nid generation:  0.01178884506225586
local_in_edges_tensor generation:  0.005845069885253906
mini_batch_src_global generation:  0.0065572261810302734
r_  generation:  0.09057855606079102
local_output_nid generation:  0.011705160140991211
local_in_edges_tensor generation:  0.0056917667388916016
mini_batch_src_global generation:  0.007264137268066406
r_  generation:  0.0924980640411377
----------------------check_connections_block total spend ----------------------------- 0.552509069442749
generate_one_block  0.09996223449707031
generate_one_block  0.1019582748413086
generate_one_block  0.10085082054138184
generate_one_block  0.10169768333435059
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.039186716079711914
gen group dst list time:  0.010959863662719727
time for parepare:  0.019210100173950195
local_output_nid generation:  0.01969170570373535
local_in_edges_tensor generation:  0.03312969207763672
mini_batch_src_global generation:  0.040215492248535156
r_  generation:  0.4081754684448242
local_output_nid generation:  0.029300212860107422
local_in_edges_tensor generation:  0.027709245681762695
mini_batch_src_global generation:  0.04728507995605469
r_  generation:  0.40564966201782227
local_output_nid generation:  0.02589559555053711
local_in_edges_tensor generation:  0.02429056167602539
mini_batch_src_global generation:  0.04778289794921875
r_  generation:  0.4065103530883789
local_output_nid generation:  0.02547478675842285
local_in_edges_tensor generation:  0.024730682373046875
mini_batch_src_global generation:  0.04752683639526367
r_  generation:  0.4111950397491455
----------------------check_connections_block total spend ----------------------------- 2.40338397026062
generate_one_block  0.5193192958831787
generate_one_block  0.5191628932952881
generate_one_block  0.543926477432251
generate_one_block  0.5239760875701904
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03246593475341797
gen group dst list time:  0.0217435359954834
time for parepare:  0.018479585647583008
local_output_nid generation:  0.029381752014160156
local_in_edges_tensor generation:  0.04326677322387695
mini_batch_src_global generation:  0.04628443717956543
r_  generation:  0.485978364944458
local_output_nid generation:  0.03671598434448242
local_in_edges_tensor generation:  0.043791770935058594
mini_batch_src_global generation:  0.055409908294677734
r_  generation:  0.5052387714385986
local_output_nid generation:  0.036408424377441406
local_in_edges_tensor generation:  0.03550982475280762
mini_batch_src_global generation:  0.0517885684967041
r_  generation:  0.5041272640228271
local_output_nid generation:  0.036371707916259766
local_in_edges_tensor generation:  0.03995370864868164
mini_batch_src_global generation:  0.052206993103027344
r_  generation:  0.5135288238525391
----------------------check_connections_block total spend ----------------------------- 2.9745700359344482
generate_one_block  0.6185488700866699
generate_one_block  0.620711088180542
generate_one_block  0.6170270442962646
generate_one_block  0.6245236396789551
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.14505434036254883  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

connection checking time:  5.377954006195068
block generation total time  4.58719539642334
average batch blocks generation time:  1.146798849105835
block dataloader generation time/epoch 11.790412295948375
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10805177688598633  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1040172576904297  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10884523391723633  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.106457233428955  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10857200622558594  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.099287986755371  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10860013961791992  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.106825828552246  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08432972431182861 |0.012971162796020508 |0.003518998622894287 |9.334087371826172e-05 |0.003286123275756836 |0.0016868114471435547 |
----------------------------------------------------------pseudo_mini_loss sum 1.3294622898101807
Total (block generation + training)time/epoch 12.321053418246182
Training time/epoch 0.5045287609100342
Training time without block to device /epoch 0.45264410972595215
Training time without total dataloading part /epoch 0.029280662536621094
load block tensor time/epoch 0.33731889724731445
block to device time/epoch 0.05188465118408203
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 20 |
Number of nodes for computation during this epoch:  1681142
Number of first layer input nodes during this epoch:  657105
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.14525222778320312  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018106698989868164
random selection method range initialization spend 0.004904985427856445
time for parepare:  0.017111539840698242
local_output_nid generation:  0.008892059326171875
local_in_edges_tensor generation:  0.00782155990600586
mini_batch_src_global generation:  0.006808042526245117
r_  generation:  0.08024382591247559
local_output_nid generation:  0.011797666549682617
local_in_edges_tensor generation:  0.0059795379638671875
mini_batch_src_global generation:  0.01015472412109375
r_  generation:  0.08546662330627441
local_output_nid generation:  0.011838436126708984
local_in_edges_tensor generation:  0.005982160568237305
mini_batch_src_global generation:  0.006710529327392578
r_  generation:  0.09066987037658691
local_output_nid generation:  0.011823892593383789
local_in_edges_tensor generation:  0.005907773971557617
mini_batch_src_global generation:  0.00750732421875
r_  generation:  0.09108757972717285
----------------------check_connections_block total spend ----------------------------- 0.5494980812072754
generate_one_block  0.09824585914611816
generate_one_block  0.10048937797546387
generate_one_block  0.10223746299743652
generate_one_block  0.10185503959655762
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.028418779373168945
gen group dst list time:  0.010835647583007812
time for parepare:  0.019201040267944336
local_output_nid generation:  0.020209789276123047
local_in_edges_tensor generation:  0.031458139419555664
mini_batch_src_global generation:  0.03795766830444336
r_  generation:  0.3985276222229004
local_output_nid generation:  0.02636241912841797
local_in_edges_tensor generation:  0.02401280403137207
mini_batch_src_global generation:  0.04669809341430664
r_  generation:  0.4032247066497803
local_output_nid generation:  0.025194406509399414
local_in_edges_tensor generation:  0.024883508682250977
mini_batch_src_global generation:  0.0492095947265625
r_  generation:  0.4134552478790283
local_output_nid generation:  0.024731159210205078
local_in_edges_tensor generation:  0.024803638458251953
mini_batch_src_global generation:  0.04770088195800781
r_  generation:  0.4116194248199463
----------------------check_connections_block total spend ----------------------------- 2.3881876468658447
generate_one_block  0.5170793533325195
generate_one_block  0.5128064155578613
generate_one_block  0.5370912551879883
generate_one_block  0.51474928855896
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02588677406311035
gen group dst list time:  0.02186870574951172
time for parepare:  0.018559694290161133
local_output_nid generation:  0.029326915740966797
local_in_edges_tensor generation:  0.03937530517578125
mini_batch_src_global generation:  0.04495573043823242
r_  generation:  0.496718168258667
local_output_nid generation:  0.036817312240600586
local_in_edges_tensor generation:  0.035368919372558594
mini_batch_src_global generation:  0.055702924728393555
r_  generation:  0.502094030380249
local_output_nid generation:  0.03689861297607422
local_in_edges_tensor generation:  0.03568124771118164
mini_batch_src_global generation:  0.05247783660888672
r_  generation:  0.5142030715942383
local_output_nid generation:  0.03656315803527832
local_in_edges_tensor generation:  0.03351855278015137
mini_batch_src_global generation:  0.05211353302001953
r_  generation:  0.5191745758056641
----------------------check_connections_block total spend ----------------------------- 2.9841771125793457
generate_one_block  0.6186120510101318
generate_one_block  0.6200721263885498
generate_one_block  0.6206073760986328
generate_one_block  0.6191339492797852
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.14525222778320312  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

connection checking time:  5.37236475944519
block generation total time  4.560151815414429
average batch blocks generation time:  1.1400379538536072
block dataloader generation time/epoch 11.77874497572581
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.1079869270324707  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.102940559387207  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10860919952392578  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1030449867248535  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.108673095703125  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1044750213623047  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10767793655395508  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.0979437828063965  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0887787938117981 |0.014354228973388672 |0.0034834742546081543 |8.702278137207031e-05 |0.003780663013458252 |0.002798795700073242 |
----------------------------------------------------------pseudo_mini_loss sum 1.305757999420166
Total (block generation + training)time/epoch 12.30928518374761
Training time/epoch 0.5292253494262695
Training time without block to device /epoch 0.47180843353271484
Training time without total dataloading part /epoch 0.03220343589782715
load block tensor time/epoch 0.3551151752471924
block to device time/epoch 0.05741691589355469
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 21 |
Number of nodes for computation during this epoch:  1680539
Number of first layer input nodes during this epoch:  657085
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.14426040649414062  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022606611251831055
random selection method range initialization spend 0.005064487457275391
time for parepare:  0.017128467559814453
local_output_nid generation:  0.008862018585205078
local_in_edges_tensor generation:  0.008045196533203125
mini_batch_src_global generation:  0.006781101226806641
r_  generation:  0.07985687255859375
local_output_nid generation:  0.011676311492919922
local_in_edges_tensor generation:  0.006232261657714844
mini_batch_src_global generation:  0.008869409561157227
r_  generation:  0.08748197555541992
local_output_nid generation:  0.01170492172241211
local_in_edges_tensor generation:  0.005964040756225586
mini_batch_src_global generation:  0.0065801143646240234
r_  generation:  0.08922934532165527
local_output_nid generation:  0.011781930923461914
local_in_edges_tensor generation:  0.005886554718017578
mini_batch_src_global generation:  0.007559776306152344
r_  generation:  0.0912175178527832
----------------------check_connections_block total spend ----------------------------- 0.5487146377563477
generate_one_block  0.10085606575012207
generate_one_block  0.10324478149414062
generate_one_block  0.10189938545227051
generate_one_block  0.10329699516296387
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03239607810974121
gen group dst list time:  0.011046409606933594
time for parepare:  0.019171953201293945
local_output_nid generation:  0.019748926162719727
local_in_edges_tensor generation:  0.03422212600708008
mini_batch_src_global generation:  0.037819862365722656
r_  generation:  0.3945128917694092
local_output_nid generation:  0.02617669105529785
local_in_edges_tensor generation:  0.02825784683227539
mini_batch_src_global generation:  0.046379804611206055
r_  generation:  0.4057302474975586
local_output_nid generation:  0.02437734603881836
local_in_edges_tensor generation:  0.024663448333740234
mini_batch_src_global generation:  0.04718136787414551
r_  generation:  0.4073829650878906
local_output_nid generation:  0.024678945541381836
local_in_edges_tensor generation:  0.024398088455200195
mini_batch_src_global generation:  0.04824018478393555
r_  generation:  0.41316723823547363
----------------------check_connections_block total spend ----------------------------- 2.386951208114624
generate_one_block  0.5210099220275879
generate_one_block  0.5168135166168213
generate_one_block  0.5419836044311523
generate_one_block  0.5180418491363525
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.032141923904418945
gen group dst list time:  0.021781206130981445
time for parepare:  0.018663883209228516
local_output_nid generation:  0.02950763702392578
local_in_edges_tensor generation:  0.039114952087402344
mini_batch_src_global generation:  0.04494047164916992
r_  generation:  0.49446654319763184
local_output_nid generation:  0.03791236877441406
local_in_edges_tensor generation:  0.041658878326416016
mini_batch_src_global generation:  0.055028676986694336
r_  generation:  0.4952070713043213
local_output_nid generation:  0.03629326820373535
local_in_edges_tensor generation:  0.042060136795043945
mini_batch_src_global generation:  0.05194449424743652
r_  generation:  0.5081353187561035
local_output_nid generation:  0.03620457649230957
local_in_edges_tensor generation:  0.03393840789794922
mini_batch_src_global generation:  0.05197739601135254
r_  generation:  0.5085964202880859
----------------------check_connections_block total spend ----------------------------- 2.968543767929077
generate_one_block  0.6276044845581055
generate_one_block  0.6156244277954102
generate_one_block  0.62436842918396
generate_one_block  0.624476432800293
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.14426040649414062  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

connection checking time:  5.355494976043701
block generation total time  4.589922666549683
average batch blocks generation time:  1.1474806666374207
block dataloader generation time/epoch 11.771397352218628
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10859012603759766  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.099128246307373  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10878658294677734  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.099959373474121  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10865306854248047  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.102287769317627  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10778522491455078  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1063103675842285  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0924789309501648 |0.018146395683288574 |0.0034527182579040527 |8.660554885864258e-05 |0.0038208365440368652 |0.0028181076049804688 |
----------------------------------------------------------pseudo_mini_loss sum 1.292229413986206
Total (block generation + training)time/epoch 12.30406144949106
Training time/epoch 0.5579373836517334
Training time without block to device /epoch 0.4853518009185791
Training time without total dataloading part /epoch 0.03225874900817871
load block tensor time/epoch 0.3699157238006592
block to device time/epoch 0.0725855827331543
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 22 |
Number of nodes for computation during this epoch:  1680719
Number of first layer input nodes during this epoch:  657130
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.14446020126342773  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.017304658889770508
random selection method range initialization spend 0.005174398422241211
time for parepare:  0.017907381057739258
local_output_nid generation:  0.009001016616821289
local_in_edges_tensor generation:  0.010594844818115234
mini_batch_src_global generation:  0.00680232048034668
r_  generation:  0.08074688911437988
local_output_nid generation:  0.011665105819702148
local_in_edges_tensor generation:  0.0058536529541015625
mini_batch_src_global generation:  0.008832931518554688
r_  generation:  0.08743095397949219
local_output_nid generation:  0.011801481246948242
local_in_edges_tensor generation:  0.005893707275390625
mini_batch_src_global generation:  0.006676197052001953
r_  generation:  0.08999872207641602
local_output_nid generation:  0.01186370849609375
local_in_edges_tensor generation:  0.0063364505767822266
mini_batch_src_global generation:  0.007387638092041016
r_  generation:  0.09297609329223633
----------------------check_connections_block total spend ----------------------------- 0.5550990104675293
generate_one_block  0.09955310821533203
generate_one_block  0.10080075263977051
generate_one_block  0.10275125503540039
generate_one_block  0.1032266616821289
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.028433799743652344
gen group dst list time:  0.010837793350219727
time for parepare:  0.019356250762939453
local_output_nid generation:  0.020351409912109375
local_in_edges_tensor generation:  0.03448796272277832
mini_batch_src_global generation:  0.03791189193725586
r_  generation:  0.3929262161254883
local_output_nid generation:  0.02600693702697754
local_in_edges_tensor generation:  0.028078317642211914
mini_batch_src_global generation:  0.04623913764953613
r_  generation:  0.4027836322784424
local_output_nid generation:  0.02530694007873535
local_in_edges_tensor generation:  0.026622295379638672
mini_batch_src_global generation:  0.04694700241088867
r_  generation:  0.41310763359069824
local_output_nid generation:  0.024808406829833984
local_in_edges_tensor generation:  0.025194883346557617
mini_batch_src_global generation:  0.05027961730957031
r_  generation:  0.41806721687316895
----------------------check_connections_block total spend ----------------------------- 2.3988311290740967
generate_one_block  0.522019624710083
generate_one_block  0.5175595283508301
generate_one_block  0.5389742851257324
generate_one_block  0.5214698314666748
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.026941776275634766
gen group dst list time:  0.02167367935180664
time for parepare:  0.018802404403686523
local_output_nid generation:  0.029307842254638672
local_in_edges_tensor generation:  0.0410003662109375
mini_batch_src_global generation:  0.0458831787109375
r_  generation:  0.49013710021972656
local_output_nid generation:  0.036463022232055664
local_in_edges_tensor generation:  0.03833603858947754
mini_batch_src_global generation:  0.0556178092956543
r_  generation:  0.4962334632873535
local_output_nid generation:  0.037047386169433594
local_in_edges_tensor generation:  0.03766298294067383
mini_batch_src_global generation:  0.05206298828125
r_  generation:  0.5160167217254639
local_output_nid generation:  0.03656625747680664
local_in_edges_tensor generation:  0.037492990493774414
mini_batch_src_global generation:  0.052574872970581055
r_  generation:  0.5099360942840576
----------------------check_connections_block total spend ----------------------------- 2.973459005355835
generate_one_block  0.6149764060974121
generate_one_block  0.61869215965271
generate_one_block  0.6157147884368896
generate_one_block  0.6197988986968994
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.14446020126342773  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

connection checking time:  5.372290134429932
block generation total time  4.5692055225372314
average batch blocks generation time:  1.1423013806343079
block dataloader generation time/epoch 11.765840888023376
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10876131057739258  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1068944931030273  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10866641998291016  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.0969500541687012  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.1086268424987793  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1038360595703125  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10771608352661133  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.102726936340332  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08878511190414429 |0.013269782066345215 |0.0035143494606018066 |9.047985076904297e-05 |0.003798067569732666 |0.0017347335815429688 |
----------------------------------------------------------pseudo_mini_loss sum 1.2738138437271118
Total (block generation + training)time/epoch 12.29822473866599
Training time/epoch 0.5285565853118896
Training time without block to device /epoch 0.4754774570465088
Training time without total dataloading part /epoch 0.03134632110595703
load block tensor time/epoch 0.35514044761657715
block to device time/epoch 0.05307912826538086
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 23 |
Number of nodes for computation during this epoch:  1680287
Number of first layer input nodes during this epoch:  656973
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.1443634033203125  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.016334056854248047
random selection method range initialization spend 0.005434274673461914
time for parepare:  0.0169827938079834
local_output_nid generation:  0.008813858032226562
local_in_edges_tensor generation:  0.00821375846862793
mini_batch_src_global generation:  0.006887674331665039
r_  generation:  0.08132743835449219
local_output_nid generation:  0.011660575866699219
local_in_edges_tensor generation:  0.005931854248046875
mini_batch_src_global generation:  0.008800268173217773
r_  generation:  0.08604741096496582
local_output_nid generation:  0.011703729629516602
local_in_edges_tensor generation:  0.00597691535949707
mini_batch_src_global generation:  0.006640911102294922
r_  generation:  0.089874267578125
local_output_nid generation:  0.011775970458984375
local_in_edges_tensor generation:  0.005808115005493164
mini_batch_src_global generation:  0.0074160099029541016
r_  generation:  0.09194779396057129
----------------------check_connections_block total spend ----------------------------- 0.5498270988464355
generate_one_block  0.09985709190368652
generate_one_block  0.10163998603820801
generate_one_block  0.10174846649169922
generate_one_block  0.10215640068054199
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02852654457092285
gen group dst list time:  0.010962486267089844
time for parepare:  0.019308805465698242
local_output_nid generation:  0.019783973693847656
local_in_edges_tensor generation:  0.029511690139770508
mini_batch_src_global generation:  0.03784751892089844
r_  generation:  0.39573025703430176
local_output_nid generation:  0.02578592300415039
local_in_edges_tensor generation:  0.025640487670898438
mini_batch_src_global generation:  0.046610116958618164
r_  generation:  0.40349721908569336
local_output_nid generation:  0.024898767471313477
local_in_edges_tensor generation:  0.023749113082885742
mini_batch_src_global generation:  0.04695582389831543
r_  generation:  0.4129328727722168
local_output_nid generation:  0.024753332138061523
local_in_edges_tensor generation:  0.02520585060119629
mini_batch_src_global generation:  0.04774665832519531
r_  generation:  0.4094665050506592
----------------------check_connections_block total spend ----------------------------- 2.3783843517303467
generate_one_block  0.5204477310180664
generate_one_block  0.5108590126037598
generate_one_block  0.5345573425292969
generate_one_block  0.516547441482544
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.025805234909057617
gen group dst list time:  0.021720170974731445
time for parepare:  0.01864933967590332
local_output_nid generation:  0.03031182289123535
local_in_edges_tensor generation:  0.039383649826049805
mini_batch_src_global generation:  0.04478168487548828
r_  generation:  0.4890015125274658
local_output_nid generation:  0.03687572479248047
local_in_edges_tensor generation:  0.033312082290649414
mini_batch_src_global generation:  0.05522513389587402
r_  generation:  0.49859166145324707
local_output_nid generation:  0.037305355072021484
local_in_edges_tensor generation:  0.03458738327026367
mini_batch_src_global generation:  0.05155801773071289
r_  generation:  0.5062668323516846
local_output_nid generation:  0.03757309913635254
local_in_edges_tensor generation:  0.03653597831726074
mini_batch_src_global generation:  0.051191091537475586
r_  generation:  0.5187027454376221
----------------------check_connections_block total spend ----------------------------- 2.96230149269104
generate_one_block  0.6157739162445068
generate_one_block  0.6161015033721924
generate_one_block  0.6221170425415039
generate_one_block  0.63912034034729
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.1443634033203125  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

connection checking time:  5.340685844421387
block generation total time  4.57552433013916
average batch blocks generation time:  1.14388108253479
block dataloader generation time/epoch 11.756458425521851
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10874176025390625  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1072754859924316  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10871076583862305  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.09844970703125  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10858774185180664  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.0989761352539062  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10770082473754883  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.0992512702941895  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08358436822891235 |0.012836098670959473 |0.0033996105194091797 |8.851289749145508e-05 |0.003229975700378418 |0.001543283462524414 |
----------------------------------------------------------pseudo_mini_loss sum 1.2689541578292847
Total (block generation + training)time/epoch 12.286639467875164
Training time/epoch 0.49916529655456543
Training time without block to device /epoch 0.44782090187072754
Training time without total dataloading part /epoch 0.028415679931640625
load block tensor time/epoch 0.3343374729156494
block to device time/epoch 0.05134439468383789
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 24 |
Number of nodes for computation during this epoch:  1680441
Number of first layer input nodes during this epoch:  656915
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.14437484741210938  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01564168930053711
random selection method range initialization spend 0.005341291427612305
time for parepare:  0.01708221435546875
local_output_nid generation:  0.00864720344543457
local_in_edges_tensor generation:  0.00809168815612793
mini_batch_src_global generation:  0.006761074066162109
r_  generation:  0.08005475997924805
local_output_nid generation:  0.011615276336669922
local_in_edges_tensor generation:  0.006089925765991211
mini_batch_src_global generation:  0.00899815559387207
r_  generation:  0.08707404136657715
local_output_nid generation:  0.011735677719116211
local_in_edges_tensor generation:  0.005964040756225586
mini_batch_src_global generation:  0.006621837615966797
r_  generation:  0.0901193618774414
local_output_nid generation:  0.01184391975402832
local_in_edges_tensor generation:  0.0060689449310302734
mini_batch_src_global generation:  0.0074422359466552734
r_  generation:  0.09066343307495117
----------------------check_connections_block total spend ----------------------------- 0.5488569736480713
generate_one_block  0.09922313690185547
generate_one_block  0.10159587860107422
generate_one_block  0.10267090797424316
generate_one_block  0.10343265533447266
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.028824806213378906
gen group dst list time:  0.010864973068237305
time for parepare:  0.019472360610961914
local_output_nid generation:  0.020092487335205078
local_in_edges_tensor generation:  0.029549598693847656
mini_batch_src_global generation:  0.03776264190673828
r_  generation:  0.3942248821258545
local_output_nid generation:  0.026772499084472656
local_in_edges_tensor generation:  0.024729251861572266
mini_batch_src_global generation:  0.04697394371032715
r_  generation:  0.4112050533294678
local_output_nid generation:  0.025305986404418945
local_in_edges_tensor generation:  0.024289369583129883
mini_batch_src_global generation:  0.04717898368835449
r_  generation:  0.4100308418273926
local_output_nid generation:  0.025168418884277344
local_in_edges_tensor generation:  0.024273395538330078
mini_batch_src_global generation:  0.04719066619873047
r_  generation:  0.41107630729675293
----------------------check_connections_block total spend ----------------------------- 2.385988473892212
generate_one_block  0.5192973613739014
generate_one_block  0.5168869495391846
generate_one_block  0.5424134731292725
generate_one_block  0.5120556354522705
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.025781631469726562
gen group dst list time:  0.021807193756103516
time for parepare:  0.01839447021484375
local_output_nid generation:  0.02934861183166504
local_in_edges_tensor generation:  0.039931535720825195
mini_batch_src_global generation:  0.04507327079772949
r_  generation:  0.49314284324645996
local_output_nid generation:  0.037096500396728516
local_in_edges_tensor generation:  0.03315377235412598
mini_batch_src_global generation:  0.05502653121948242
r_  generation:  0.503791093826294
local_output_nid generation:  0.03748822212219238
local_in_edges_tensor generation:  0.033452749252319336
mini_batch_src_global generation:  0.0514216423034668
r_  generation:  0.5127239227294922
local_output_nid generation:  0.03680682182312012
local_in_edges_tensor generation:  0.03405570983886719
mini_batch_src_global generation:  0.05242347717285156
r_  generation:  0.5120604038238525
----------------------check_connections_block total spend ----------------------------- 2.969207286834717
generate_one_block  0.6264379024505615
generate_one_block  0.6217770576477051
generate_one_block  0.6185104846954346
generate_one_block  0.6190800666809082
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.14437484741210938  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

connection checking time:  5.355195760726929
block generation total time  4.576458930969238
average batch blocks generation time:  1.1441147327423096
block dataloader generation time/epoch 11.748211488127708
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10877418518066406  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1066803932189941  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10900020599365234  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.107654094696045  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.108001708984375  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.0989952087402344  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.1088266372680664  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.098952293395996  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08198529481887817 |0.014867186546325684 |0.003338932991027832 |8.362531661987305e-05 |0.003355741500854492 |0.0015621185302734375 |
----------------------------------------------------------pseudo_mini_loss sum 1.2572685480117798
Total (block generation + training)time/epoch 12.276671946048737
Training time/epoch 0.5024404525756836
Training time without block to device /epoch 0.44297170639038086
Training time without total dataloading part /epoch 0.028675317764282227
load block tensor time/epoch 0.3279411792755127
block to device time/epoch 0.059468746185302734
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 25 |
Number of nodes for computation during this epoch:  1681310
Number of first layer input nodes during this epoch:  657477
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.1441173553466797  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.017794370651245117
random selection method range initialization spend 0.005308628082275391
time for parepare:  0.017428159713745117
local_output_nid generation:  0.008572101593017578
local_in_edges_tensor generation:  0.007964134216308594
mini_batch_src_global generation:  0.006849050521850586
r_  generation:  0.08239173889160156
local_output_nid generation:  0.011639833450317383
local_in_edges_tensor generation:  0.005819797515869141
mini_batch_src_global generation:  0.00882720947265625
r_  generation:  0.08629226684570312
local_output_nid generation:  0.011658668518066406
local_in_edges_tensor generation:  0.005877494812011719
mini_batch_src_global generation:  0.006554126739501953
r_  generation:  0.09119105339050293
local_output_nid generation:  0.011795520782470703
local_in_edges_tensor generation:  0.005873203277587891
mini_batch_src_global generation:  0.007397651672363281
r_  generation:  0.09293389320373535
----------------------check_connections_block total spend ----------------------------- 0.5540966987609863
generate_one_block  0.10016322135925293
generate_one_block  0.10306811332702637
generate_one_block  0.10295748710632324
generate_one_block  0.10229825973510742
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03956246376037598
gen group dst list time:  0.010995149612426758
time for parepare:  0.019427061080932617
local_output_nid generation:  0.01999688148498535
local_in_edges_tensor generation:  0.03934788703918457
mini_batch_src_global generation:  0.053971052169799805
r_  generation:  0.3923029899597168
local_output_nid generation:  0.027623653411865234
local_in_edges_tensor generation:  0.02935481071472168
mini_batch_src_global generation:  0.04868507385253906
r_  generation:  0.4101696014404297
local_output_nid generation:  0.02570819854736328
local_in_edges_tensor generation:  0.02674245834350586
mini_batch_src_global generation:  0.04894447326660156
r_  generation:  0.41821789741516113
local_output_nid generation:  0.025298595428466797
local_in_edges_tensor generation:  0.024470090866088867
mini_batch_src_global generation:  0.047667503356933594
r_  generation:  0.41347336769104004
----------------------check_connections_block total spend ----------------------------- 2.435624361038208
generate_one_block  0.5128402709960938
generate_one_block  0.5249228477478027
generate_one_block  0.5510070323944092
generate_one_block  0.52443528175354
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02730417251586914
gen group dst list time:  0.02191019058227539
time for parepare:  0.01894664764404297
local_output_nid generation:  0.0290372371673584
local_in_edges_tensor generation:  0.046298980712890625
mini_batch_src_global generation:  0.04758715629577637
r_  generation:  0.4909360408782959
local_output_nid generation:  0.0364384651184082
local_in_edges_tensor generation:  0.039757728576660156
mini_batch_src_global generation:  0.05587267875671387
r_  generation:  0.49738454818725586
local_output_nid generation:  0.03678178787231445
local_in_edges_tensor generation:  0.03837132453918457
mini_batch_src_global generation:  0.05201101303100586
r_  generation:  0.5082459449768066
local_output_nid generation:  0.03670978546142578
local_in_edges_tensor generation:  0.0370020866394043
mini_batch_src_global generation:  0.05454564094543457
r_  generation:  0.5142636299133301
----------------------check_connections_block total spend ----------------------------- 2.9833791255950928
generate_one_block  0.6203150749206543
generate_one_block  0.6206762790679932
generate_one_block  0.6230247020721436
generate_one_block  0.6236824989318848
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.1441173553466797  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

connection checking time:  5.419003486633301
block generation total time  4.6009039878845215
average batch blocks generation time:  1.1502259969711304
block dataloader generation time/epoch 11.74860655560213
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10861063003540039  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.0979595184326172  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10861015319824219  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1002249717712402  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10808277130126953  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1067819595336914  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10863208770751953  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1039457321166992  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08990222215652466 |0.012920677661895752 |0.003632485866546631 |9.316205978393555e-05 |0.003853738307952881 |0.0013613700866699219 |
----------------------------------------------------------pseudo_mini_loss sum 1.2416083812713623
Total (block generation + training)time/epoch 12.277108038173003
Training time/epoch 0.5289745330810547
Training time without block to device /epoch 0.4772918224334717
Training time without total dataloading part /epoch 0.03167891502380371
load block tensor time/epoch 0.35960888862609863
block to device time/epoch 0.05168271064758301
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 26 |
Number of nodes for computation during this epoch:  1680776
Number of first layer input nodes during this epoch:  657284
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.14500904083251953  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01780867576599121
random selection method range initialization spend 0.005369663238525391
time for parepare:  0.017106294631958008
local_output_nid generation:  0.008864879608154297
local_in_edges_tensor generation:  0.008068084716796875
mini_batch_src_global generation:  0.006789445877075195
r_  generation:  0.07976579666137695
local_output_nid generation:  0.01156759262084961
local_in_edges_tensor generation:  0.005907773971557617
mini_batch_src_global generation:  0.00885915756225586
r_  generation:  0.08742237091064453
local_output_nid generation:  0.011629343032836914
local_in_edges_tensor generation:  0.005768537521362305
mini_batch_src_global generation:  0.0065805912017822266
r_  generation:  0.08959794044494629
local_output_nid generation:  0.011605501174926758
local_in_edges_tensor generation:  0.0059053897857666016
mini_batch_src_global generation:  0.00730443000793457
r_  generation:  0.09188413619995117
----------------------check_connections_block total spend ----------------------------- 0.547968864440918
generate_one_block  0.09963464736938477
generate_one_block  0.10091876983642578
generate_one_block  0.10134220123291016
generate_one_block  0.10120892524719238
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.038178205490112305
gen group dst list time:  0.01087045669555664
time for parepare:  0.019264698028564453
local_output_nid generation:  0.019995927810668945
local_in_edges_tensor generation:  0.029089689254760742
mini_batch_src_global generation:  0.03936147689819336
r_  generation:  0.3926420211791992
local_output_nid generation:  0.026737689971923828
local_in_edges_tensor generation:  0.025992870330810547
mini_batch_src_global generation:  0.04687976837158203
r_  generation:  0.4060022830963135
local_output_nid generation:  0.025405168533325195
local_in_edges_tensor generation:  0.024266719818115234
mini_batch_src_global generation:  0.047164201736450195
r_  generation:  0.40958333015441895
local_output_nid generation:  0.02506732940673828
local_in_edges_tensor generation:  0.024109601974487305
mini_batch_src_global generation:  0.04922080039978027
r_  generation:  0.40916872024536133
----------------------check_connections_block total spend ----------------------------- 2.3778984546661377
generate_one_block  0.5181982517242432
generate_one_block  0.5220272541046143
generate_one_block  0.5362286567687988
generate_one_block  0.5219278335571289
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028606653213500977
gen group dst list time:  0.02155613899230957
time for parepare:  0.018508195877075195
local_output_nid generation:  0.029569149017333984
local_in_edges_tensor generation:  0.0391697883605957
mini_batch_src_global generation:  0.04487419128417969
r_  generation:  0.48907995223999023
local_output_nid generation:  0.03690052032470703
local_in_edges_tensor generation:  0.03435778617858887
mini_batch_src_global generation:  0.05982804298400879
r_  generation:  0.49602603912353516
local_output_nid generation:  0.03705477714538574
local_in_edges_tensor generation:  0.03374910354614258
mini_batch_src_global generation:  0.051450490951538086
r_  generation:  0.507016658782959
local_output_nid generation:  0.03621053695678711
local_in_edges_tensor generation:  0.03532075881958008
mini_batch_src_global generation:  0.051737308502197266
r_  generation:  0.5082154273986816
----------------------check_connections_block total spend ----------------------------- 2.9550540447235107
generate_one_block  0.6185729503631592
generate_one_block  0.6294817924499512
generate_one_block  0.6236002445220947
generate_one_block  0.6213107109069824
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.14500904083251953  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

connection checking time:  5.332952499389648
block generation total time  4.591347694396973
average batch blocks generation time:  1.1478369235992432
block dataloader generation time/epoch 11.743931690851847
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10859918594360352  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1038784980773926  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10781526565551758  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.10304594039917  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10858011245727539  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.0999665260314941  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10876226425170898  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.0984601974487305  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08406120538711548 |0.014555275440216064 |0.0034418106079101562 |8.630752563476562e-05 |0.0031015872955322266 |0.002638578414916992 |
----------------------------------------------------------pseudo_mini_loss sum 1.2252657413482666
Total (block generation + training)time/epoch 12.271339363522
Training time/epoch 0.5086045265197754
Training time without block to device /epoch 0.45038342475891113
Training time without total dataloading part /epoch 0.029157400131225586
load block tensor time/epoch 0.3362448215484619
block to device time/epoch 0.05822110176086426
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 27 |
Number of nodes for computation during this epoch:  1680695
Number of first layer input nodes during this epoch:  657040
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.14406538009643555  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020807266235351562
random selection method range initialization spend 0.005360841751098633
time for parepare:  0.018665552139282227
local_output_nid generation:  0.008886575698852539
local_in_edges_tensor generation:  0.00831913948059082
mini_batch_src_global generation:  0.006830692291259766
r_  generation:  0.08141016960144043
local_output_nid generation:  0.01171875
local_in_edges_tensor generation:  0.005848884582519531
mini_batch_src_global generation:  0.008976459503173828
r_  generation:  0.08657217025756836
local_output_nid generation:  0.011789560317993164
local_in_edges_tensor generation:  0.005903959274291992
mini_batch_src_global generation:  0.006738185882568359
r_  generation:  0.0903778076171875
local_output_nid generation:  0.011816740036010742
local_in_edges_tensor generation:  0.0060923099517822266
mini_batch_src_global generation:  0.007338523864746094
r_  generation:  0.09247922897338867
----------------------check_connections_block total spend ----------------------------- 0.5532145500183105
generate_one_block  0.09992361068725586
generate_one_block  0.10067486763000488
generate_one_block  0.10326004028320312
generate_one_block  0.10198736190795898
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03359174728393555
gen group dst list time:  0.010954618453979492
time for parepare:  0.020583629608154297
local_output_nid generation:  0.020480871200561523
local_in_edges_tensor generation:  0.031470537185668945
mini_batch_src_global generation:  0.03796720504760742
r_  generation:  0.39488840103149414
local_output_nid generation:  0.026573896408081055
local_in_edges_tensor generation:  0.026630878448486328
mini_batch_src_global generation:  0.04674863815307617
r_  generation:  0.403719425201416
local_output_nid generation:  0.025667905807495117
local_in_edges_tensor generation:  0.024816274642944336
mini_batch_src_global generation:  0.046729087829589844
r_  generation:  0.41243410110473633
local_output_nid generation:  0.025134801864624023
local_in_edges_tensor generation:  0.02494502067565918
mini_batch_src_global generation:  0.04775595664978027
r_  generation:  0.41339778900146484
----------------------check_connections_block total spend ----------------------------- 2.3884189128875732
generate_one_block  0.5174059867858887
generate_one_block  0.5111241340637207
generate_one_block  0.5400271415710449
generate_one_block  0.523392915725708
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.027866363525390625
gen group dst list time:  0.02174067497253418
time for parepare:  0.018587827682495117
local_output_nid generation:  0.029758691787719727
local_in_edges_tensor generation:  0.03908991813659668
mini_batch_src_global generation:  0.04506707191467285
r_  generation:  0.48863983154296875
local_output_nid generation:  0.037520408630371094
local_in_edges_tensor generation:  0.032961130142211914
mini_batch_src_global generation:  0.05519533157348633
r_  generation:  0.4954257011413574
local_output_nid generation:  0.03786349296569824
local_in_edges_tensor generation:  0.033796072006225586
mini_batch_src_global generation:  0.05203437805175781
r_  generation:  0.5069208145141602
local_output_nid generation:  0.037199974060058594
local_in_edges_tensor generation:  0.033715248107910156
mini_batch_src_global generation:  0.051442623138427734
r_  generation:  0.5102086067199707
----------------------check_connections_block total spend ----------------------------- 2.9479169845581055
generate_one_block  0.6183714866638184
generate_one_block  0.6145110130310059
generate_one_block  0.6288454532623291
generate_one_block  0.6254293918609619
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.14406538009643555  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

connection checking time:  5.336335897445679
block generation total time  4.5791075229644775
average batch blocks generation time:  1.1447768807411194
block dataloader generation time/epoch 11.738744095752114
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10864830017089844  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1039791107177734  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10759353637695312  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.0974845886230469  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.1087503433227539  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1035385131835938  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10876846313476562  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1062264442443848  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08580684661865234 |0.0210268497467041 |0.003626704216003418 |9.369850158691406e-05 |0.003180205821990967 |0.0018737316131591797 |
----------------------------------------------------------pseudo_mini_loss sum 1.2187228202819824
Total (block generation + training)time/epoch 12.266882231360988
Training time/epoch 0.5411548614501953
Training time without block to device /epoch 0.4570474624633789
Training time without total dataloading part /epoch 0.029476165771484375
load block tensor time/epoch 0.3432273864746094
block to device time/epoch 0.0841073989868164
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 28 |
Number of nodes for computation during this epoch:  1680241
Number of first layer input nodes during this epoch:  656953
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.14412307739257812  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020781517028808594
random selection method range initialization spend 0.006358623504638672
time for parepare:  0.01893329620361328
local_output_nid generation:  0.008858203887939453
local_in_edges_tensor generation:  0.009438037872314453
mini_batch_src_global generation:  0.008033275604248047
r_  generation:  0.08122134208679199
local_output_nid generation:  0.011777162551879883
local_in_edges_tensor generation:  0.006051301956176758
mini_batch_src_global generation:  0.00908517837524414
r_  generation:  0.08691000938415527
local_output_nid generation:  0.01186513900756836
local_in_edges_tensor generation:  0.005936622619628906
mini_batch_src_global generation:  0.015591144561767578
r_  generation:  0.09092116355895996
local_output_nid generation:  0.012764215469360352
local_in_edges_tensor generation:  0.006037473678588867
mini_batch_src_global generation:  0.007604837417602539
r_  generation:  0.09231901168823242
----------------------check_connections_block total spend ----------------------------- 0.5710830688476562
generate_one_block  0.09972572326660156
generate_one_block  0.10254788398742676
generate_one_block  0.10509824752807617
generate_one_block  0.10588860511779785
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029815673828125
gen group dst list time:  0.011020660400390625
time for parepare:  0.0196382999420166
local_output_nid generation:  0.020343303680419922
local_in_edges_tensor generation:  0.03390860557556152
mini_batch_src_global generation:  0.03804302215576172
r_  generation:  0.3972313404083252
local_output_nid generation:  0.027196407318115234
local_in_edges_tensor generation:  0.02828383445739746
mini_batch_src_global generation:  0.046770572662353516
r_  generation:  0.41138505935668945
local_output_nid generation:  0.025463342666625977
local_in_edges_tensor generation:  0.025771617889404297
mini_batch_src_global generation:  0.04718780517578125
r_  generation:  0.4145479202270508
local_output_nid generation:  0.025570154190063477
local_in_edges_tensor generation:  0.026882171630859375
mini_batch_src_global generation:  0.048166513442993164
r_  generation:  0.4176487922668457
----------------------check_connections_block total spend ----------------------------- 2.4170711040496826
generate_one_block  0.5200231075286865
generate_one_block  0.5243527889251709
generate_one_block  0.5400876998901367
generate_one_block  0.5240471363067627
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029214859008789062
gen group dst list time:  0.02188563346862793
time for parepare:  0.01874399185180664
local_output_nid generation:  0.02967214584350586
local_in_edges_tensor generation:  0.039809226989746094
mini_batch_src_global generation:  0.046903371810913086
r_  generation:  0.4926633834838867
local_output_nid generation:  0.03691267967224121
local_in_edges_tensor generation:  0.03926563262939453
mini_batch_src_global generation:  0.05539393424987793
r_  generation:  0.5064785480499268
local_output_nid generation:  0.03684377670288086
local_in_edges_tensor generation:  0.03862333297729492
mini_batch_src_global generation:  0.05376148223876953
r_  generation:  0.5191917419433594
local_output_nid generation:  0.03711366653442383
local_in_edges_tensor generation:  0.03590083122253418
mini_batch_src_global generation:  0.05188703536987305
r_  generation:  0.5193467140197754
----------------------check_connections_block total spend ----------------------------- 3.003784656524658
generate_one_block  0.6343822479248047
generate_one_block  0.6307382583618164
generate_one_block  0.6642136573791504
generate_one_block  0.6359500885009766
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.14412307739257812  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

connection checking time:  5.420855760574341
block generation total time  4.673794984817505
average batch blocks generation time:  1.1684487462043762
block dataloader generation time/epoch 11.745484471321106
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10856151580810547  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.0993132591247559  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10861730575561523  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.0992889404296875  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10797834396362305  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.102877140045166  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 0.10866022109985352  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1045494079589844  GigaBytes
Max Memory Allocated: 1.301130771636963  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08936929702758789 |0.020170748233795166 |0.0036370158195495605 |9.846687316894531e-05 |0.0034317970275878906 |0.001888275146484375 |
----------------------------------------------------------pseudo_mini_loss sum 1.2082303762435913
Total (block generation + training)time/epoch 12.275113141536712
Training time/epoch 0.557682991027832
Training time without block to device /epoch 0.47699999809265137
Training time without total dataloading part /epoch 0.03055739402770996
load block tensor time/epoch 0.35747718811035156
block to device time/epoch 0.08068299293518066
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 29 |
Number of nodes for computation during this epoch:  1680712
Number of first layer input nodes during this epoch:  657087
