Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1647758253.7776792
ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02815413475036621
random selection method range initialization spend 0.006239652633666992
time for parepare:  0.018620014190673828
local_output_nid generation:  0.008372068405151367
local_in_edges_tensor generation:  0.00943136215209961
mini_batch_src_global generation:  0.007617950439453125
r_  generation:  0.09177017211914062
local_output_nid generation:  0.011788129806518555
local_in_edges_tensor generation:  0.006036043167114258
mini_batch_src_global generation:  0.009952783584594727
r_  generation:  0.09606504440307617
local_output_nid generation:  0.011799335479736328
local_in_edges_tensor generation:  0.0060575008392333984
mini_batch_src_global generation:  0.0076961517333984375
r_  generation:  0.09961295127868652
local_output_nid generation:  0.011810779571533203
local_in_edges_tensor generation:  0.0060498714447021484
mini_batch_src_global generation:  0.008445501327514648
r_  generation:  0.10380125045776367
----------------------check_connections_block total spend ----------------------------- 0.6048803329467773
generate_one_block  0.1174306869506836
generate_one_block  0.11521196365356445
generate_one_block  0.11792612075805664
generate_one_block  0.11699247360229492
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04508638381958008
gen group dst list time:  0.012336015701293945
time for parepare:  0.01901531219482422
local_output_nid generation:  0.02061772346496582
local_in_edges_tensor generation:  0.048969268798828125
mini_batch_src_global generation:  0.045865774154663086
r_  generation:  0.474834680557251
local_output_nid generation:  0.02695751190185547
local_in_edges_tensor generation:  0.04990673065185547
mini_batch_src_global generation:  0.05715489387512207
r_  generation:  0.48898911476135254
local_output_nid generation:  0.026891231536865234
local_in_edges_tensor generation:  0.03902554512023926
mini_batch_src_global generation:  0.06315040588378906
r_  generation:  0.5158870220184326
local_output_nid generation:  0.030515432357788086
local_in_edges_tensor generation:  0.05692744255065918
mini_batch_src_global generation:  0.0856781005859375
r_  generation:  0.4859473705291748
----------------------check_connections_block total spend ----------------------------- 2.9773340225219727
generate_one_block  0.6783945560455322
generate_one_block  0.6328489780426025
generate_one_block  0.6371030807495117
generate_one_block  0.6340675354003906
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0471346378326416
gen group dst list time:  0.02243185043334961
time for parepare:  0.019227981567382812
local_output_nid generation:  0.030123233795166016
local_in_edges_tensor generation:  0.06147933006286621
mini_batch_src_global generation:  0.04697775840759277
r_  generation:  0.49445128440856934
local_output_nid generation:  0.03735518455505371
local_in_edges_tensor generation:  0.05365395545959473
mini_batch_src_global generation:  0.05693936347961426
r_  generation:  0.5096960067749023
local_output_nid generation:  0.03716301918029785
local_in_edges_tensor generation:  0.045838356018066406
mini_batch_src_global generation:  0.05709433555603027
r_  generation:  0.5084896087646484
local_output_nid generation:  0.03716111183166504
local_in_edges_tensor generation:  0.04060697555541992
mini_batch_src_global generation:  0.0669863224029541
r_  generation:  0.5208821296691895
----------------------check_connections_block total spend ----------------------------- 3.096794366836548
generate_one_block  0.6688022613525391
generate_one_block  0.6533207893371582
generate_one_block  0.6483802795410156
generate_one_block  0.6392261981964111
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  6.0741283893585205
block generation total time  5.192143678665161
average batch blocks generation time:  1.2980359196662903
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2030029296875 GB
    Memory Allocated: 0.10499238967895508  GigaBytes
Max Memory Allocated: 0.10499238967895508  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6893310546875 GB
    Memory Allocated: 1.1420636177062988  GigaBytes
Max Memory Allocated: 1.2362122535705566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.10921478271484375  GigaBytes
Max Memory Allocated: 1.3473691940307617  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.1378850936889648  GigaBytes
Max Memory Allocated: 1.3473691940307617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.1096658706665039  GigaBytes
Max Memory Allocated: 1.3473691940307617  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.1388072967529297  GigaBytes
Max Memory Allocated: 1.3473691940307617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.10929679870605469  GigaBytes
Max Memory Allocated: 1.3473691940307617  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.141733169555664  GigaBytes
Max Memory Allocated: 1.3473691940307617  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.067782461643219 |0.09890443086624146 |0.19656038284301758 |0.00012862682342529297 |0.027384161949157715 |0.002671957015991211 |
----------------------------------------------------------pseudo_mini_loss sum 6.179036617279053
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1722276
Number of first layer input nodes during this epoch:  662162
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.15148305892944336  GigaBytes
Max Memory Allocated: 1.3473691940307617  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023208141326904297
random selection method range initialization spend 0.005295753479003906
time for parepare:  0.01896071434020996
local_output_nid generation:  0.008554458618164062
local_in_edges_tensor generation:  0.010106801986694336
mini_batch_src_global generation:  0.007584333419799805
r_  generation:  0.09283638000488281
local_output_nid generation:  0.011694908142089844
local_in_edges_tensor generation:  0.008213996887207031
mini_batch_src_global generation:  0.010055303573608398
r_  generation:  0.09956097602844238
local_output_nid generation:  0.011794090270996094
local_in_edges_tensor generation:  0.006262063980102539
mini_batch_src_global generation:  0.00803828239440918
r_  generation:  0.0992288589477539
local_output_nid generation:  0.014719486236572266
local_in_edges_tensor generation:  0.0064220428466796875
mini_batch_src_global generation:  0.008625984191894531
r_  generation:  0.106292724609375
----------------------check_connections_block total spend ----------------------------- 0.6237082481384277
generate_one_block  0.13222360610961914
generate_one_block  0.11875295639038086
generate_one_block  0.12331080436706543
generate_one_block  0.11736273765563965
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0611422061920166
gen group dst list time:  0.012556314468383789
time for parepare:  0.01925039291381836
local_output_nid generation:  0.019856929779052734
local_in_edges_tensor generation:  0.07273483276367188
mini_batch_src_global generation:  0.04619145393371582
r_  generation:  0.468691349029541
local_output_nid generation:  0.026987314224243164
local_in_edges_tensor generation:  0.045737266540527344
mini_batch_src_global generation:  0.05672121047973633
r_  generation:  0.4803040027618408
local_output_nid generation:  0.02649831771850586
local_in_edges_tensor generation:  0.03675436973571777
mini_batch_src_global generation:  0.05632424354553223
r_  generation:  0.48093366622924805
local_output_nid generation:  0.026223182678222656
local_in_edges_tensor generation:  0.03213071823120117
mini_batch_src_global generation:  0.05805373191833496
r_  generation:  0.48599815368652344
----------------------check_connections_block total spend ----------------------------- 2.862217664718628
generate_one_block  0.6233808994293213
generate_one_block  0.6543319225311279
generate_one_block  0.6645872592926025
generate_one_block  0.6358580589294434
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.035891056060791016
gen group dst list time:  0.027319908142089844
time for parepare:  0.018749475479125977
local_output_nid generation:  0.030501842498779297
local_in_edges_tensor generation:  0.05543923377990723
mini_batch_src_global generation:  0.044992923736572266
r_  generation:  0.4978938102722168
local_output_nid generation:  0.03750205039978027
local_in_edges_tensor generation:  0.05516362190246582
mini_batch_src_global generation:  0.05704045295715332
r_  generation:  0.5009124279022217
local_output_nid generation:  0.03676867485046387
local_in_edges_tensor generation:  0.046224117279052734
mini_batch_src_global generation:  0.0564882755279541
r_  generation:  0.5084927082061768
local_output_nid generation:  0.03716111183166504
local_in_edges_tensor generation:  0.041741371154785156
mini_batch_src_global generation:  0.05657553672790527
r_  generation:  0.5125882625579834
----------------------check_connections_block total spend ----------------------------- 3.056445360183716
generate_one_block  0.6393377780914307
generate_one_block  0.6478052139282227
generate_one_block  0.6452927589416504
generate_one_block  0.6282310485839844
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.15148305892944336  GigaBytes
Max Memory Allocated: 1.3473691940307617  GigaBytes

connection checking time:  5.918663024902344
block generation total time  5.138824939727783
average batch blocks generation time:  1.2847062349319458
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.11098289489746094  GigaBytes
Max Memory Allocated: 1.3473691940307617  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1436405181884766  GigaBytes
Max Memory Allocated: 1.3473691940307617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1190185546875 GB
    Memory Allocated: 0.1109004020690918  GigaBytes
Max Memory Allocated: 1.348609447479248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7283935546875 GB
    Memory Allocated: 1.1410565376281738  GigaBytes
Max Memory Allocated: 1.348609447479248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11082983016967773  GigaBytes
Max Memory Allocated: 1.348609447479248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.139531135559082  GigaBytes
Max Memory Allocated: 1.348609447479248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11081361770629883  GigaBytes
Max Memory Allocated: 1.348609447479248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1437339782714844  GigaBytes
Max Memory Allocated: 1.348609447479248  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07892733812332153 |0.0197104811668396 |0.004156231880187988 |9.78708267211914e-05 |0.01901787519454956 |0.0029795169830322266 |
----------------------------------------------------------pseudo_mini_loss sum 3.2256784439086914
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  1721680
Number of first layer input nodes during this epoch:  661919
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15181398391723633  GigaBytes
Max Memory Allocated: 1.348609447479248  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.029619693756103516
random selection method range initialization spend 0.005712270736694336
time for parepare:  0.019540786743164062
local_output_nid generation:  0.008424520492553711
local_in_edges_tensor generation:  0.00929713249206543
mini_batch_src_global generation:  0.0075702667236328125
r_  generation:  0.09148693084716797
local_output_nid generation:  0.011815786361694336
local_in_edges_tensor generation:  0.006682157516479492
mini_batch_src_global generation:  0.009826183319091797
r_  generation:  0.09893965721130371
local_output_nid generation:  0.011908769607543945
local_in_edges_tensor generation:  0.006481647491455078
mini_batch_src_global generation:  0.00818777084350586
r_  generation:  0.10330867767333984
local_output_nid generation:  0.01194143295288086
local_in_edges_tensor generation:  0.006479024887084961
mini_batch_src_global generation:  0.008699655532836914
r_  generation:  0.1058051586151123
----------------------check_connections_block total spend ----------------------------- 0.6185033321380615
generate_one_block  0.11327672004699707
generate_one_block  0.11467337608337402
generate_one_block  0.11680364608764648
generate_one_block  0.11658978462219238
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.039205074310302734
gen group dst list time:  0.017044544219970703
time for parepare:  0.027157306671142578
local_output_nid generation:  0.03468751907348633
local_in_edges_tensor generation:  0.04724431037902832
mini_batch_src_global generation:  0.056387901306152344
r_  generation:  0.4823417663574219
local_output_nid generation:  0.03464818000793457
local_in_edges_tensor generation:  0.03892946243286133
mini_batch_src_global generation:  0.058954715728759766
r_  generation:  0.4902002811431885
local_output_nid generation:  0.03453803062438965
local_in_edges_tensor generation:  0.03653287887573242
mini_batch_src_global generation:  0.06190156936645508
r_  generation:  0.4957234859466553
local_output_nid generation:  0.03556203842163086
local_in_edges_tensor generation:  0.030778884887695312
mini_batch_src_global generation:  0.05926394462585449
r_  generation:  0.4944756031036377
----------------------check_connections_block total spend ----------------------------- 2.9852101802825928
generate_one_block  0.6567730903625488
generate_one_block  0.6538870334625244
generate_one_block  0.6656396389007568
generate_one_block  0.6466388702392578
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.027549028396606445
gen group dst list time:  0.03777050971984863
time for parepare:  0.02409982681274414
local_output_nid generation:  0.05504202842712402
local_in_edges_tensor generation:  0.06276369094848633
mini_batch_src_global generation:  0.04736208915710449
r_  generation:  0.5224018096923828
local_output_nid generation:  0.05093026161193848
local_in_edges_tensor generation:  0.04994559288024902
mini_batch_src_global generation:  0.061879873275756836
r_  generation:  0.5071704387664795
local_output_nid generation:  0.04722428321838379
local_in_edges_tensor generation:  0.04316139221191406
mini_batch_src_global generation:  0.0597684383392334
r_  generation:  0.5242602825164795
local_output_nid generation:  0.05083131790161133
local_in_edges_tensor generation:  0.05048108100891113
mini_batch_src_global generation:  0.05609917640686035
r_  generation:  0.5241234302520752
----------------------check_connections_block total spend ----------------------------- 3.2168097496032715
generate_one_block  0.6723709106445312
generate_one_block  0.6409051418304443
generate_one_block  0.6486213207244873
generate_one_block  0.6429188251495361
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15181398391723633  GigaBytes
Max Memory Allocated: 1.348609447479248  GigaBytes

connection checking time:  6.202019929885864
block generation total time  5.227754831314087
average batch blocks generation time:  1.3069387078285217
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11135244369506836  GigaBytes
Max Memory Allocated: 1.348609447479248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.139270305633545  GigaBytes
Max Memory Allocated: 1.348609447479248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11088228225708008  GigaBytes
Max Memory Allocated: 1.348609447479248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1389365196228027  GigaBytes
Max Memory Allocated: 1.348609447479248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.1109771728515625  GigaBytes
Max Memory Allocated: 1.348609447479248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.144216537475586  GigaBytes
Max Memory Allocated: 1.348609447479248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11087465286254883  GigaBytes
Max Memory Allocated: 1.3495402336120605  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1402077674865723  GigaBytes
Max Memory Allocated: 1.3495402336120605  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0940241813659668 |0.020875990390777588 |0.008891880512237549 |0.00010013580322265625 |0.003740370273590088 |0.0028371810913085938 |
----------------------------------------------------------pseudo_mini_loss sum 2.6113505363464355
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  1721382
Number of first layer input nodes during this epoch:  661858
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15134525299072266  GigaBytes
Max Memory Allocated: 1.3495402336120605  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02208113670349121
random selection method range initialization spend 0.004881858825683594
time for parepare:  0.01819324493408203
local_output_nid generation:  0.008553504943847656
local_in_edges_tensor generation:  0.009391307830810547
mini_batch_src_global generation:  0.007490873336791992
r_  generation:  0.09160637855529785
local_output_nid generation:  0.011776208877563477
local_in_edges_tensor generation:  0.006343364715576172
mini_batch_src_global generation:  0.009727716445922852
r_  generation:  0.09786128997802734
local_output_nid generation:  0.011792421340942383
local_in_edges_tensor generation:  0.0067119598388671875
mini_batch_src_global generation:  0.008482694625854492
r_  generation:  0.10193634033203125
local_output_nid generation:  0.011843442916870117
local_in_edges_tensor generation:  0.006342411041259766
mini_batch_src_global generation:  0.008810758590698242
r_  generation:  0.10408425331115723
----------------------check_connections_block total spend ----------------------------- 0.614382266998291
generate_one_block  0.12030982971191406
generate_one_block  0.12481546401977539
generate_one_block  0.11987090110778809
generate_one_block  0.1206820011138916
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04860877990722656
gen group dst list time:  0.013964176177978516
time for parepare:  0.020982027053833008
local_output_nid generation:  0.021873950958251953
local_in_edges_tensor generation:  0.04406094551086426
mini_batch_src_global generation:  0.04649496078491211
r_  generation:  0.482990026473999
local_output_nid generation:  0.031410932540893555
local_in_edges_tensor generation:  0.038549184799194336
mini_batch_src_global generation:  0.05686807632446289
r_  generation:  0.48456645011901855
local_output_nid generation:  0.028035879135131836
local_in_edges_tensor generation:  0.04278564453125
mini_batch_src_global generation:  0.058916330337524414
r_  generation:  0.4951636791229248
local_output_nid generation:  0.028506755828857422
local_in_edges_tensor generation:  0.03173327445983887
mini_batch_src_global generation:  0.0573732852935791
r_  generation:  0.4943399429321289
----------------------check_connections_block total spend ----------------------------- 2.905311346054077
generate_one_block  0.6689856052398682
generate_one_block  0.6376643180847168
generate_one_block  0.6708168983459473
generate_one_block  0.6366338729858398
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03258371353149414
gen group dst list time:  0.021967172622680664
time for parepare:  0.0190274715423584
local_output_nid generation:  0.03131580352783203
local_in_edges_tensor generation:  0.057127952575683594
mini_batch_src_global generation:  0.04518532752990723
r_  generation:  0.495114803314209
local_output_nid generation:  0.03896164894104004
local_in_edges_tensor generation:  0.04463958740234375
mini_batch_src_global generation:  0.059859514236450195
r_  generation:  0.512033224105835
local_output_nid generation:  0.03874397277832031
local_in_edges_tensor generation:  0.03595876693725586
mini_batch_src_global generation:  0.05711627006530762
r_  generation:  0.5085668563842773
local_output_nid generation:  0.03828263282775879
local_in_edges_tensor generation:  0.040650367736816406
mini_batch_src_global generation:  0.05730032920837402
r_  generation:  0.517507791519165
----------------------check_connections_block total spend ----------------------------- 3.063851833343506
generate_one_block  0.6491317749023438
generate_one_block  0.6371235847473145
generate_one_block  0.6325702667236328
generate_one_block  0.6298954486846924
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15134525299072266  GigaBytes
Max Memory Allocated: 1.3495402336120605  GigaBytes

connection checking time:  5.969163179397583
block generation total time  5.1628217697143555
average batch blocks generation time:  1.2907054424285889
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11078786849975586  GigaBytes
Max Memory Allocated: 1.3495402336120605  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1398673057556152  GigaBytes
Max Memory Allocated: 1.3495402336120605  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11086559295654297  GigaBytes
Max Memory Allocated: 1.3495402336120605  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1383085250854492  GigaBytes
Max Memory Allocated: 1.3495402336120605  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11144208908081055  GigaBytes
Max Memory Allocated: 1.3495402336120605  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1436185836791992  GigaBytes
Max Memory Allocated: 1.3495402336120605  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11083269119262695  GigaBytes
Max Memory Allocated: 1.3495402336120605  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1392698287963867  GigaBytes
Max Memory Allocated: 1.3495402336120605  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09351450204849243 |0.022288799285888672 |0.0037767887115478516 |0.00010448694229125977 |0.0038133859634399414 |0.0031435489654541016 |
----------------------------------------------------------pseudo_mini_loss sum 2.376939535140991
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  1720440
Number of first layer input nodes during this epoch:  661756
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.1512470245361328  GigaBytes
Max Memory Allocated: 1.3495402336120605  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020020246505737305
random selection method range initialization spend 0.006250858306884766
time for parepare:  0.020018577575683594
local_output_nid generation:  0.00866842269897461
local_in_edges_tensor generation:  0.010649919509887695
mini_batch_src_global generation:  0.008875131607055664
r_  generation:  0.09298563003540039
local_output_nid generation:  0.011810064315795898
local_in_edges_tensor generation:  0.006319284439086914
mini_batch_src_global generation:  0.011472225189208984
r_  generation:  0.09936881065368652
local_output_nid generation:  0.011858224868774414
local_in_edges_tensor generation:  0.006284236907958984
mini_batch_src_global generation:  0.009357452392578125
r_  generation:  0.10254931449890137
local_output_nid generation:  0.011991739273071289
local_in_edges_tensor generation:  0.006360292434692383
mini_batch_src_global generation:  0.008668899536132812
r_  generation:  0.10427045822143555
----------------------check_connections_block total spend ----------------------------- 0.6255784034729004
generate_one_block  0.11793684959411621
generate_one_block  0.11524796485900879
generate_one_block  0.11713600158691406
generate_one_block  0.11612582206726074
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03805875778198242
gen group dst list time:  0.011805534362792969
time for parepare:  0.019353628158569336
local_output_nid generation:  0.02179241180419922
local_in_edges_tensor generation:  0.03985333442687988
mini_batch_src_global generation:  0.045181989669799805
r_  generation:  0.468059778213501
local_output_nid generation:  0.02837371826171875
local_in_edges_tensor generation:  0.03558969497680664
mini_batch_src_global generation:  0.056784868240356445
r_  generation:  0.4888184070587158
local_output_nid generation:  0.026983976364135742
local_in_edges_tensor generation:  0.03068828582763672
mini_batch_src_global generation:  0.056288719177246094
r_  generation:  0.48636698722839355
local_output_nid generation:  0.027010679244995117
local_in_edges_tensor generation:  0.0292966365814209
mini_batch_src_global generation:  0.057462215423583984
r_  generation:  0.49352312088012695
----------------------check_connections_block total spend ----------------------------- 2.8321378231048584
generate_one_block  0.6250247955322266
generate_one_block  0.6223790645599365
generate_one_block  0.6449398994445801
generate_one_block  0.6187117099761963
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0416259765625
gen group dst list time:  0.023335695266723633
time for parepare:  0.019189834594726562
local_output_nid generation:  0.03140091896057129
local_in_edges_tensor generation:  0.040253639221191406
mini_batch_src_global generation:  0.0446932315826416
r_  generation:  0.49486827850341797
local_output_nid generation:  0.03830075263977051
local_in_edges_tensor generation:  0.040101051330566406
mini_batch_src_global generation:  0.056537628173828125
r_  generation:  0.49890685081481934
local_output_nid generation:  0.03771257400512695
local_in_edges_tensor generation:  0.034999847412109375
mini_batch_src_global generation:  0.05791497230529785
r_  generation:  0.5016443729400635
local_output_nid generation:  0.03823733329772949
local_in_edges_tensor generation:  0.03729724884033203
mini_batch_src_global generation:  0.05648994445800781
r_  generation:  0.5079965591430664
----------------------check_connections_block total spend ----------------------------- 2.9955058097839355
generate_one_block  0.6229579448699951
generate_one_block  0.6334307193756104
generate_one_block  0.6304972171783447
generate_one_block  0.6301002502441406
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.1512470245361328  GigaBytes
Max Memory Allocated: 1.3495402336120605  GigaBytes

connection checking time:  5.827643632888794
block generation total time  5.02804160118103
average batch blocks generation time:  1.2570104002952576
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11087656021118164  GigaBytes
Max Memory Allocated: 1.3495402336120605  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1391396522521973  GigaBytes
Max Memory Allocated: 1.3495402336120605  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11087894439697266  GigaBytes
Max Memory Allocated: 1.3495402336120605  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1433839797973633  GigaBytes
Max Memory Allocated: 1.3495402336120605  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11082220077514648  GigaBytes
Max Memory Allocated: 1.3495402336120605  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1389904022216797  GigaBytes
Max Memory Allocated: 1.3495402336120605  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11092376708984375  GigaBytes
Max Memory Allocated: 1.3495402336120605  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1445751190185547  GigaBytes
Max Memory Allocated: 1.3495402336120605  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08895093202590942 |0.019060194492340088 |0.0036045312881469727 |9.828805923461914e-05 |0.002863764762878418 |0.001734018325805664 |
----------------------------------------------------------pseudo_mini_loss sum 2.117290496826172
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  1721428
Number of first layer input nodes during this epoch:  661983
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15200281143188477  GigaBytes
Max Memory Allocated: 1.3497185707092285  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026276111602783203
random selection method range initialization spend 0.0052490234375
time for parepare:  0.018497705459594727
local_output_nid generation:  0.008821964263916016
local_in_edges_tensor generation:  0.012869119644165039
mini_batch_src_global generation:  0.0075800418853759766
r_  generation:  0.08987021446228027
local_output_nid generation:  0.011829853057861328
local_in_edges_tensor generation:  0.0063135623931884766
mini_batch_src_global generation:  0.01000356674194336
r_  generation:  0.09879636764526367
local_output_nid generation:  0.011915206909179688
local_in_edges_tensor generation:  0.0062029361724853516
mini_batch_src_global generation:  0.007791042327880859
r_  generation:  0.10166454315185547
local_output_nid generation:  0.011869668960571289
local_in_edges_tensor generation:  0.0067980289459228516
mini_batch_src_global generation:  0.00867915153503418
r_  generation:  0.10512757301330566
----------------------check_connections_block total spend ----------------------------- 0.6165866851806641
generate_one_block  0.11338996887207031
generate_one_block  0.1185004711151123
generate_one_block  0.11893415451049805
generate_one_block  0.11741757392883301
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.049558162689208984
gen group dst list time:  0.011746644973754883
time for parepare:  0.01934671401977539
local_output_nid generation:  0.02208423614501953
local_in_edges_tensor generation:  0.04524374008178711
mini_batch_src_global generation:  0.04507780075073242
r_  generation:  0.46816301345825195
local_output_nid generation:  0.028173208236694336
local_in_edges_tensor generation:  0.03677558898925781
mini_batch_src_global generation:  0.05684471130371094
r_  generation:  0.49167871475219727
local_output_nid generation:  0.026960134506225586
local_in_edges_tensor generation:  0.029567718505859375
mini_batch_src_global generation:  0.05631613731384277
r_  generation:  0.49754762649536133
local_output_nid generation:  0.026993274688720703
local_in_edges_tensor generation:  0.02906203269958496
mini_batch_src_global generation:  0.05759429931640625
r_  generation:  0.5059926509857178
----------------------check_connections_block total spend ----------------------------- 2.874600410461426
generate_one_block  0.62953782081604
generate_one_block  0.6465668678283691
generate_one_block  0.6669440269470215
generate_one_block  0.63490891456604
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028260231018066406
gen group dst list time:  0.021944761276245117
time for parepare:  0.018781661987304688
local_output_nid generation:  0.0315546989440918
local_in_edges_tensor generation:  0.0497128963470459
mini_batch_src_global generation:  0.044888973236083984
r_  generation:  0.49390625953674316
local_output_nid generation:  0.03762054443359375
local_in_edges_tensor generation:  0.04184246063232422
mini_batch_src_global generation:  0.05644869804382324
r_  generation:  0.5193357467651367
local_output_nid generation:  0.038598060607910156
local_in_edges_tensor generation:  0.03834342956542969
mini_batch_src_global generation:  0.05706977844238281
r_  generation:  0.5099713802337646
local_output_nid generation:  0.03959178924560547
local_in_edges_tensor generation:  0.03484845161437988
mini_batch_src_global generation:  0.05615735054016113
r_  generation:  0.5199830532073975
----------------------check_connections_block total spend ----------------------------- 3.0525906085968018
generate_one_block  0.6397304534912109
generate_one_block  0.6481335163116455
generate_one_block  0.6653449535369873
generate_one_block  0.6420376300811768
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15200281143188477  GigaBytes
Max Memory Allocated: 1.3497185707092285  GigaBytes

connection checking time:  5.9271910190582275
block generation total time  5.173204183578491
average batch blocks generation time:  1.2933010458946228
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11138391494750977  GigaBytes
Max Memory Allocated: 1.3497185707092285  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1368141174316406  GigaBytes
Max Memory Allocated: 1.3497185707092285  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11096954345703125  GigaBytes
Max Memory Allocated: 1.3497185707092285  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1439309120178223  GigaBytes
Max Memory Allocated: 1.3497185707092285  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.1109309196472168  GigaBytes
Max Memory Allocated: 1.3497185707092285  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1439647674560547  GigaBytes
Max Memory Allocated: 1.3497185707092285  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11089801788330078  GigaBytes
Max Memory Allocated: 1.3497185707092285  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.140312671661377  GigaBytes
Max Memory Allocated: 1.3497185707092285  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09650051593780518 |0.021610379219055176 |0.0037450194358825684 |9.965896606445312e-05 |0.0038788318634033203 |0.003049135208129883 |
----------------------------------------------------------pseudo_mini_loss sum 1.9626970291137695
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  1721649
Number of first layer input nodes during this epoch:  661976
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.1514735221862793  GigaBytes
Max Memory Allocated: 1.3497185707092285  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02806377410888672
random selection method range initialization spend 0.00493311882019043
time for parepare:  0.018091678619384766
local_output_nid generation:  0.008502483367919922
local_in_edges_tensor generation:  0.009774446487426758
mini_batch_src_global generation:  0.0077245235443115234
r_  generation:  0.09092926979064941
local_output_nid generation:  0.01170969009399414
local_in_edges_tensor generation:  0.006186723709106445
mini_batch_src_global generation:  0.010193586349487305
r_  generation:  0.10111284255981445
local_output_nid generation:  0.011806249618530273
local_in_edges_tensor generation:  0.0061724185943603516
mini_batch_src_global generation:  0.007961750030517578
r_  generation:  0.10108494758605957
local_output_nid generation:  0.011809825897216797
local_in_edges_tensor generation:  0.006042003631591797
mini_batch_src_global generation:  0.008552074432373047
r_  generation:  0.10347819328308105
----------------------check_connections_block total spend ----------------------------- 0.6121211051940918
generate_one_block  0.11365532875061035
generate_one_block  0.1172492504119873
generate_one_block  0.1159214973449707
generate_one_block  0.11528396606445312
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.045841217041015625
gen group dst list time:  0.012012004852294922
time for parepare:  0.019416332244873047
local_output_nid generation:  0.021810531616210938
local_in_edges_tensor generation:  0.04060006141662598
mini_batch_src_global generation:  0.04775643348693848
r_  generation:  0.4806203842163086
local_output_nid generation:  0.028101682662963867
local_in_edges_tensor generation:  0.037233591079711914
mini_batch_src_global generation:  0.05699801445007324
r_  generation:  0.49426722526550293
local_output_nid generation:  0.02720499038696289
local_in_edges_tensor generation:  0.03249239921569824
mini_batch_src_global generation:  0.05839061737060547
r_  generation:  0.4984550476074219
local_output_nid generation:  0.03172659873962402
local_in_edges_tensor generation:  0.04791545867919922
mini_batch_src_global generation:  0.0706014633178711
r_  generation:  0.4905734062194824
----------------------check_connections_block total spend ----------------------------- 2.9215052127838135
generate_one_block  0.6363487243652344
generate_one_block  0.631791353225708
generate_one_block  0.6512787342071533
generate_one_block  0.6247575283050537
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030744552612304688
gen group dst list time:  0.02229905128479004
time for parepare:  0.019187450408935547
local_output_nid generation:  0.041747331619262695
local_in_edges_tensor generation:  0.05285954475402832
mini_batch_src_global generation:  0.046956539154052734
r_  generation:  0.49784231185913086
local_output_nid generation:  0.03842735290527344
local_in_edges_tensor generation:  0.046837806701660156
mini_batch_src_global generation:  0.05982542037963867
r_  generation:  0.5119471549987793
local_output_nid generation:  0.03942394256591797
local_in_edges_tensor generation:  0.04740619659423828
mini_batch_src_global generation:  0.059798479080200195
r_  generation:  0.5196669101715088
local_output_nid generation:  0.04138636589050293
local_in_edges_tensor generation:  0.04807329177856445
mini_batch_src_global generation:  0.05792856216430664
r_  generation:  0.5057277679443359
----------------------check_connections_block total spend ----------------------------- 3.1021547317504883
generate_one_block  0.63832688331604
generate_one_block  0.639296293258667
generate_one_block  0.6384315490722656
generate_one_block  0.6310369968414307
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.1514735221862793  GigaBytes
Max Memory Allocated: 1.3497185707092285  GigaBytes

connection checking time:  6.023659944534302
block generation total time  5.091268062591553
average batch blocks generation time:  1.2728170156478882
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.1108856201171875  GigaBytes
Max Memory Allocated: 1.3497185707092285  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1445379257202148  GigaBytes
Max Memory Allocated: 1.3497185707092285  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.1108708381652832  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1408019065856934  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.1111903190612793  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1382546424865723  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.1108551025390625  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.139493465423584  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09201467037200928 |0.021880149841308594 |0.0035930871963500977 |9.679794311523438e-05 |0.003584444522857666 |0.0028111934661865234 |
----------------------------------------------------------pseudo_mini_loss sum 1.8826394081115723
 Run 0| Epoch 6 |
Number of nodes for computation during this epoch:  1721354
Number of first layer input nodes during this epoch:  661966
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15129899978637695  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020731449127197266
random selection method range initialization spend 0.005425453186035156
time for parepare:  0.018675804138183594
local_output_nid generation:  0.008426189422607422
local_in_edges_tensor generation:  0.010740518569946289
mini_batch_src_global generation:  0.007561683654785156
r_  generation:  0.09440445899963379
local_output_nid generation:  0.01180410385131836
local_in_edges_tensor generation:  0.0064907073974609375
mini_batch_src_global generation:  0.0098114013671875
r_  generation:  0.09804868698120117
local_output_nid generation:  0.011826276779174805
local_in_edges_tensor generation:  0.0061151981353759766
mini_batch_src_global generation:  0.007701396942138672
r_  generation:  0.10244393348693848
local_output_nid generation:  0.011826753616333008
local_in_edges_tensor generation:  0.0065004825592041016
mini_batch_src_global generation:  0.008550405502319336
r_  generation:  0.10802936553955078
----------------------check_connections_block total spend ----------------------------- 0.6273069381713867
generate_one_block  0.11458969116210938
generate_one_block  0.11637330055236816
generate_one_block  0.11647915840148926
generate_one_block  0.11664533615112305
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.038511037826538086
gen group dst list time:  0.011999368667602539
time for parepare:  0.019181251525878906
local_output_nid generation:  0.021576404571533203
local_in_edges_tensor generation:  0.04561114311218262
mini_batch_src_global generation:  0.04798245429992676
r_  generation:  0.47103095054626465
local_output_nid generation:  0.027151107788085938
local_in_edges_tensor generation:  0.03473019599914551
mini_batch_src_global generation:  0.05594754219055176
r_  generation:  0.47901368141174316
local_output_nid generation:  0.027005434036254883
local_in_edges_tensor generation:  0.029437541961669922
mini_batch_src_global generation:  0.055993080139160156
r_  generation:  0.4852113723754883
local_output_nid generation:  0.02691340446472168
local_in_edges_tensor generation:  0.03016829490661621
mini_batch_src_global generation:  0.057813167572021484
r_  generation:  0.4904744625091553
----------------------check_connections_block total spend ----------------------------- 2.827029228210449
generate_one_block  0.6283664703369141
generate_one_block  0.6150779724121094
generate_one_block  0.6455669403076172
generate_one_block  0.6271998882293701
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02852177619934082
gen group dst list time:  0.02196812629699707
time for parepare:  0.01938629150390625
local_output_nid generation:  0.03166651725769043
local_in_edges_tensor generation:  0.043831825256347656
mini_batch_src_global generation:  0.04506325721740723
r_  generation:  0.49932265281677246
local_output_nid generation:  0.037721872329711914
local_in_edges_tensor generation:  0.03598833084106445
mini_batch_src_global generation:  0.056444406509399414
r_  generation:  0.5035984516143799
local_output_nid generation:  0.0380556583404541
local_in_edges_tensor generation:  0.03496384620666504
mini_batch_src_global generation:  0.0569760799407959
r_  generation:  0.5080976486206055
local_output_nid generation:  0.03795480728149414
local_in_edges_tensor generation:  0.03867387771606445
mini_batch_src_global generation:  0.05603146553039551
r_  generation:  0.5239086151123047
----------------------check_connections_block total spend ----------------------------- 3.0272369384765625
generate_one_block  0.6263656616210938
generate_one_block  0.6311385631561279
generate_one_block  0.6303939819335938
generate_one_block  0.6321704387664795
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15129899978637695  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

connection checking time:  5.854266166687012
block generation total time  5.036279916763306
average batch blocks generation time:  1.2590699791908264
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11096906661987305  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1439199447631836  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11079692840576172  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1370410919189453  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11081743240356445  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1397905349731445  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11082029342651367  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1399812698364258  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09376537799835205 |0.017845571041107178 |0.003664553165435791 |9.691715240478516e-05 |0.0034790635108947754 |0.0018756389617919922 |
----------------------------------------------------------pseudo_mini_loss sum 1.8016685247421265
 Run 0| Epoch 7 |
Number of nodes for computation during this epoch:  1720319
Number of first layer input nodes during this epoch:  661783
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15181398391723633  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022855758666992188
random selection method range initialization spend 0.005725860595703125
time for parepare:  0.018413782119750977
local_output_nid generation:  0.011316537857055664
local_in_edges_tensor generation:  0.00898432731628418
mini_batch_src_global generation:  0.0076923370361328125
r_  generation:  0.09071993827819824
local_output_nid generation:  0.012006998062133789
local_in_edges_tensor generation:  0.0061376094818115234
mini_batch_src_global generation:  0.010026216506958008
r_  generation:  0.09889411926269531
local_output_nid generation:  0.011888265609741211
local_in_edges_tensor generation:  0.0061588287353515625
mini_batch_src_global generation:  0.007952213287353516
r_  generation:  0.10113954544067383
local_output_nid generation:  0.011991500854492188
local_in_edges_tensor generation:  0.006119489669799805
mini_batch_src_global generation:  0.009335041046142578
r_  generation:  0.10518598556518555
----------------------check_connections_block total spend ----------------------------- 0.6164443492889404
generate_one_block  0.11207294464111328
generate_one_block  0.12245678901672363
generate_one_block  0.1164700984954834
generate_one_block  0.11757516860961914
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03731846809387207
gen group dst list time:  0.01209402084350586
time for parepare:  0.01958918571472168
local_output_nid generation:  0.021737098693847656
local_in_edges_tensor generation:  0.04240536689758301
mini_batch_src_global generation:  0.04524564743041992
r_  generation:  0.47304463386535645
local_output_nid generation:  0.028011560440063477
local_in_edges_tensor generation:  0.034920454025268555
mini_batch_src_global generation:  0.056626319885253906
r_  generation:  0.4812610149383545
local_output_nid generation:  0.026950359344482422
local_in_edges_tensor generation:  0.03152656555175781
mini_batch_src_global generation:  0.05560302734375
r_  generation:  0.4921252727508545
local_output_nid generation:  0.026920318603515625
local_in_edges_tensor generation:  0.03290200233459473
mini_batch_src_global generation:  0.06012558937072754
r_  generation:  0.48451733589172363
----------------------check_connections_block total spend ----------------------------- 2.83447527885437
generate_one_block  0.618232011795044
generate_one_block  0.6232912540435791
generate_one_block  0.6481690406799316
generate_one_block  0.6194477081298828
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03012394905090332
gen group dst list time:  0.022284984588623047
time for parepare:  0.019340038299560547
local_output_nid generation:  0.03053736686706543
local_in_edges_tensor generation:  0.041436195373535156
mini_batch_src_global generation:  0.04471635818481445
r_  generation:  0.4961545467376709
local_output_nid generation:  0.0383908748626709
local_in_edges_tensor generation:  0.03970670700073242
mini_batch_src_global generation:  0.05629301071166992
r_  generation:  0.503629207611084
local_output_nid generation:  0.03845357894897461
local_in_edges_tensor generation:  0.03693842887878418
mini_batch_src_global generation:  0.057503700256347656
r_  generation:  0.5037317276000977
local_output_nid generation:  0.0383760929107666
local_in_edges_tensor generation:  0.04029107093811035
mini_batch_src_global generation:  0.05509018898010254
r_  generation:  0.5073840618133545
----------------------check_connections_block total spend ----------------------------- 3.0017125606536865
generate_one_block  0.6212475299835205
generate_one_block  0.6272449493408203
generate_one_block  0.6396105289459229
generate_one_block  0.6318559646606445
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15181398391723633  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

connection checking time:  5.836187839508057
block generation total time  5.029098987579346
average batch blocks generation time:  1.2572747468948364
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.1112513542175293  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1368436813354492  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11091852188110352  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1401233673095703  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11099004745483398  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1436948776245117  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11088800430297852  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1435890197753906  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09350401163101196 |0.014397203922271729 |0.0035871267318725586 |9.644031524658203e-05 |0.003858208656311035 |0.0013396739959716797 |
----------------------------------------------------------pseudo_mini_loss sum 1.7041014432907104
 Run 0| Epoch 8 |
Number of nodes for computation during this epoch:  1721171
Number of first layer input nodes during this epoch:  661985
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15136241912841797  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.017432451248168945
random selection method range initialization spend 0.005371570587158203
time for parepare:  0.017850160598754883
local_output_nid generation:  0.008865118026733398
local_in_edges_tensor generation:  0.008385419845581055
mini_batch_src_global generation:  0.0078067779541015625
r_  generation:  0.08957052230834961
local_output_nid generation:  0.011659383773803711
local_in_edges_tensor generation:  0.006174564361572266
mini_batch_src_global generation:  0.010153055191040039
r_  generation:  0.09678840637207031
local_output_nid generation:  0.011795759201049805
local_in_edges_tensor generation:  0.006031036376953125
mini_batch_src_global generation:  0.007815122604370117
r_  generation:  0.10042190551757812
local_output_nid generation:  0.011851310729980469
local_in_edges_tensor generation:  0.0062713623046875
mini_batch_src_global generation:  0.008600473403930664
r_  generation:  0.10221099853515625
----------------------check_connections_block total spend ----------------------------- 0.6030261516571045
generate_one_block  0.11257648468017578
generate_one_block  0.11430788040161133
generate_one_block  0.11379671096801758
generate_one_block  0.11587285995483398
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.032187461853027344
gen group dst list time:  0.012000560760498047
time for parepare:  0.01932811737060547
local_output_nid generation:  0.021003007888793945
local_in_edges_tensor generation:  0.03448081016540527
mini_batch_src_global generation:  0.04425835609436035
r_  generation:  0.46207237243652344
local_output_nid generation:  0.02736949920654297
local_in_edges_tensor generation:  0.029052257537841797
mini_batch_src_global generation:  0.05563068389892578
r_  generation:  0.47442102432250977
local_output_nid generation:  0.026300430297851562
local_in_edges_tensor generation:  0.02787637710571289
mini_batch_src_global generation:  0.054949045181274414
r_  generation:  0.4797217845916748
local_output_nid generation:  0.026437997817993164
local_in_edges_tensor generation:  0.027489423751831055
mini_batch_src_global generation:  0.05635476112365723
r_  generation:  0.4834470748901367
----------------------check_connections_block total spend ----------------------------- 2.7646870613098145
generate_one_block  0.6128709316253662
generate_one_block  0.6104371547698975
generate_one_block  0.6422014236450195
generate_one_block  0.6188483238220215
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02304863929748535
gen group dst list time:  0.02223992347717285
time for parepare:  0.018723011016845703
local_output_nid generation:  0.03048419952392578
local_in_edges_tensor generation:  0.04186558723449707
mini_batch_src_global generation:  0.04470467567443848
r_  generation:  0.49179911613464355
local_output_nid generation:  0.03740072250366211
local_in_edges_tensor generation:  0.03344535827636719
mini_batch_src_global generation:  0.055773258209228516
r_  generation:  0.49552273750305176
local_output_nid generation:  0.037842512130737305
local_in_edges_tensor generation:  0.034224748611450195
mini_batch_src_global generation:  0.056118011474609375
r_  generation:  0.4996378421783447
local_output_nid generation:  0.03816580772399902
local_in_edges_tensor generation:  0.03438282012939453
mini_batch_src_global generation:  0.05516791343688965
r_  generation:  0.5005276203155518
----------------------check_connections_block total spend ----------------------------- 2.959747552871704
generate_one_block  0.6189250946044922
generate_one_block  0.6280357837677002
generate_one_block  0.618657112121582
generate_one_block  0.6337730884552002
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15136241912841797  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

connection checking time:  5.7244346141815186
block generation total time  4.983748912811279
average batch blocks generation time:  1.2459372282028198
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11084461212158203  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1401162147521973  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11084842681884766  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1398062705993652  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11133146286010742  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1404614448547363  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11091232299804688  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.13932466506958  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09380018711090088 |0.020740091800689697 |0.0034929513931274414 |9.000301361083984e-05 |0.0037488341331481934 |0.0027511119842529297 |
----------------------------------------------------------pseudo_mini_loss sum 1.6392216682434082
 Run 0| Epoch 9 |
Number of nodes for computation during this epoch:  1721277
Number of first layer input nodes during this epoch:  661965
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15149736404418945  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020023107528686523
random selection method range initialization spend 0.005423307418823242
time for parepare:  0.019425630569458008
local_output_nid generation:  0.008442401885986328
local_in_edges_tensor generation:  0.00829315185546875
mini_batch_src_global generation:  0.007959127426147461
r_  generation:  0.09235763549804688
local_output_nid generation:  0.011756181716918945
local_in_edges_tensor generation:  0.008344411849975586
mini_batch_src_global generation:  0.010265111923217773
r_  generation:  0.0953209400177002
local_output_nid generation:  0.011871337890625
local_in_edges_tensor generation:  0.006093025207519531
mini_batch_src_global generation:  0.007939338684082031
r_  generation:  0.09862112998962402
local_output_nid generation:  0.011745691299438477
local_in_edges_tensor generation:  0.005956411361694336
mini_batch_src_global generation:  0.009007692337036133
r_  generation:  0.10318422317504883
----------------------check_connections_block total spend ----------------------------- 0.6077573299407959
generate_one_block  0.1127769947052002
generate_one_block  0.11305546760559082
generate_one_block  0.11437463760375977
generate_one_block  0.12175917625427246
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.041732072830200195
gen group dst list time:  0.011981010437011719
time for parepare:  0.01941227912902832
local_output_nid generation:  0.021067380905151367
local_in_edges_tensor generation:  0.0394289493560791
mini_batch_src_global generation:  0.04720759391784668
r_  generation:  0.4792287349700928
local_output_nid generation:  0.027878999710083008
local_in_edges_tensor generation:  0.033753395080566406
mini_batch_src_global generation:  0.05760645866394043
r_  generation:  0.47400593757629395
local_output_nid generation:  0.026454448699951172
local_in_edges_tensor generation:  0.02945232391357422
mini_batch_src_global generation:  0.05778169631958008
r_  generation:  0.48059964179992676
local_output_nid generation:  0.02657151222229004
local_in_edges_tensor generation:  0.02689528465270996
mini_batch_src_global generation:  0.05912590026855469
r_  generation:  0.486142635345459
----------------------check_connections_block total spend ----------------------------- 2.8160176277160645
generate_one_block  0.614396333694458
generate_one_block  0.6195831298828125
generate_one_block  0.6417150497436523
generate_one_block  0.6204147338867188
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02565288543701172
gen group dst list time:  0.022225379943847656
time for parepare:  0.01960921287536621
local_output_nid generation:  0.030214309692382812
local_in_edges_tensor generation:  0.04218721389770508
mini_batch_src_global generation:  0.04496431350708008
r_  generation:  0.48906564712524414
local_output_nid generation:  0.03752946853637695
local_in_edges_tensor generation:  0.03987407684326172
mini_batch_src_global generation:  0.056594133377075195
r_  generation:  0.49764180183410645
local_output_nid generation:  0.03715872764587402
local_in_edges_tensor generation:  0.037633657455444336
mini_batch_src_global generation:  0.056365013122558594
r_  generation:  0.5015463829040527
local_output_nid generation:  0.0374751091003418
local_in_edges_tensor generation:  0.03420090675354004
mini_batch_src_global generation:  0.05869126319885254
r_  generation:  0.49897122383117676
----------------------check_connections_block total spend ----------------------------- 2.9737093448638916
generate_one_block  0.6271071434020996
generate_one_block  0.6225175857543945
generate_one_block  0.6303720474243164
generate_one_block  0.6246623992919922
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15149736404418945  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

connection checking time:  5.789726972579956
block generation total time  5.000768423080444
average batch blocks generation time:  1.250192105770111
block dataloader generation time/epoch 12.673490285873413
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11092376708984375  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.143507957458496  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11082744598388672  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.138676643371582  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.1108245849609375  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1403021812438965  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.1108846664428711  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.144467830657959  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09493958950042725 |0.014016211032867432 |0.0035909414291381836 |9.310245513916016e-05 |0.0037038326263427734 |0.0013403892517089844 |
----------------------------------------------------------pseudo_mini_loss sum 1.598050594329834
Total (block generation + training)time/epoch 13.233118295669556
Training time/epoch 0.5594291687011719
Training time without block to device /epoch 0.5033643245697021
Training time without total dataloading part /epoch 0.030891895294189453
load block tensor time/epoch 0.379758358001709
block to device time/epoch 0.05606484413146973
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 10 |
Number of nodes for computation during this epoch:  1721921
Number of first layer input nodes during this epoch:  661943
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15195751190185547  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019687414169311523
random selection method range initialization spend 0.00531315803527832
time for parepare:  0.017851829528808594
local_output_nid generation:  0.008730173110961914
local_in_edges_tensor generation:  0.008446693420410156
mini_batch_src_global generation:  0.00803995132446289
r_  generation:  0.09009408950805664
local_output_nid generation:  0.011660575866699219
local_in_edges_tensor generation:  0.005968570709228516
mini_batch_src_global generation:  0.009897470474243164
r_  generation:  0.09540200233459473
local_output_nid generation:  0.01182866096496582
local_in_edges_tensor generation:  0.006284475326538086
mini_batch_src_global generation:  0.008111238479614258
r_  generation:  0.10055088996887207
local_output_nid generation:  0.01172637939453125
local_in_edges_tensor generation:  0.006052494049072266
mini_batch_src_global generation:  0.008800506591796875
r_  generation:  0.10482549667358398
----------------------check_connections_block total spend ----------------------------- 0.6060683727264404
generate_one_block  0.11284065246582031
generate_one_block  0.11204981803894043
generate_one_block  0.1148374080657959
generate_one_block  0.11584591865539551
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.033487796783447266
gen group dst list time:  0.01190328598022461
time for parepare:  0.03136754035949707
local_output_nid generation:  0.024434804916381836
local_in_edges_tensor generation:  0.043950557708740234
mini_batch_src_global generation:  0.048455238342285156
r_  generation:  0.4864468574523926
local_output_nid generation:  0.03529024124145508
local_in_edges_tensor generation:  0.035311222076416016
mini_batch_src_global generation:  0.058864593505859375
r_  generation:  0.49056124687194824
local_output_nid generation:  0.03426551818847656
local_in_edges_tensor generation:  0.03611946105957031
mini_batch_src_global generation:  0.0604853630065918
r_  generation:  0.5003161430358887
local_output_nid generation:  0.03409719467163086
local_in_edges_tensor generation:  0.043087005615234375
mini_batch_src_global generation:  0.06790375709533691
r_  generation:  0.5214486122131348
----------------------check_connections_block total spend ----------------------------- 3.002364158630371
generate_one_block  0.6274821758270264
generate_one_block  0.637209415435791
generate_one_block  0.7012357711791992
generate_one_block  0.6416947841644287
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029694080352783203
gen group dst list time:  0.025151968002319336
time for parepare:  0.01932358741760254
local_output_nid generation:  0.03184199333190918
local_in_edges_tensor generation:  0.0526270866394043
mini_batch_src_global generation:  0.047910451889038086
r_  generation:  0.4968528747558594
local_output_nid generation:  0.03829002380371094
local_in_edges_tensor generation:  0.04277181625366211
mini_batch_src_global generation:  0.056704044342041016
r_  generation:  0.5096347332000732
local_output_nid generation:  0.037969112396240234
local_in_edges_tensor generation:  0.036165714263916016
mini_batch_src_global generation:  0.05615115165710449
r_  generation:  0.5105624198913574
local_output_nid generation:  0.041735172271728516
local_in_edges_tensor generation:  0.04236745834350586
mini_batch_src_global generation:  0.05630087852478027
r_  generation:  0.5262103080749512
----------------------check_connections_block total spend ----------------------------- 3.066039562225342
generate_one_block  0.6492900848388672
generate_one_block  0.6538372039794922
generate_one_block  0.6434509754180908
generate_one_block  0.6395058631896973
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15195751190185547  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

connection checking time:  6.068403720855713
block generation total time  5.193706274032593
average batch blocks generation time:  1.2984265685081482
block dataloader generation time/epoch 12.91323697566986
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11139535903930664  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1435985565185547  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11071348190307617  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1350946426391602  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11093473434448242  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.139787197113037  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11104297637939453  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1444740295410156  GigaBytes
Max Memory Allocated: 1.3497271537780762  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09292382001876831 |0.021176695823669434 |0.008986175060272217 |0.00010055303573608398 |0.003776848316192627 |0.002785205841064453 |
----------------------------------------------------------pseudo_mini_loss sum 1.5524572134017944
Total (block generation + training)time/epoch 13.48399555683136
Training time/epoch 0.5816066265106201
Training time without block to device /epoch 0.4968998432159424
Training time without total dataloading part /epoch 0.054239511489868164
load block tensor time/epoch 0.37169528007507324
block to device time/epoch 0.08470678329467773
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 11 |
Number of nodes for computation during this epoch:  1720894
Number of first layer input nodes during this epoch:  662028
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15174055099487305  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02245950698852539
random selection method range initialization spend 0.0048787593841552734
time for parepare:  0.017884492874145508
local_output_nid generation:  0.009150266647338867
local_in_edges_tensor generation:  0.011850357055664062
mini_batch_src_global generation:  0.007929325103759766
r_  generation:  0.09166097640991211
local_output_nid generation:  0.011771202087402344
local_in_edges_tensor generation:  0.00612330436706543
mini_batch_src_global generation:  0.010010719299316406
r_  generation:  0.09679961204528809
local_output_nid generation:  0.011870622634887695
local_in_edges_tensor generation:  0.00603175163269043
mini_batch_src_global generation:  0.007972478866577148
r_  generation:  0.10089564323425293
local_output_nid generation:  0.011927366256713867
local_in_edges_tensor generation:  0.006148338317871094
mini_batch_src_global generation:  0.00875997543334961
r_  generation:  0.1049652099609375
----------------------check_connections_block total spend ----------------------------- 0.6137533187866211
generate_one_block  0.11322712898254395
generate_one_block  0.11897730827331543
generate_one_block  0.11709475517272949
generate_one_block  0.11763548851013184
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03778648376464844
gen group dst list time:  0.013356208801269531
time for parepare:  0.019405364990234375
local_output_nid generation:  0.021500587463378906
local_in_edges_tensor generation:  0.042688608169555664
mini_batch_src_global generation:  0.04716229438781738
r_  generation:  0.46865367889404297
local_output_nid generation:  0.028301477432250977
local_in_edges_tensor generation:  0.036492109298706055
mini_batch_src_global generation:  0.05611896514892578
r_  generation:  0.4794769287109375
local_output_nid generation:  0.02718043327331543
local_in_edges_tensor generation:  0.029245853424072266
mini_batch_src_global generation:  0.05652570724487305
r_  generation:  0.4934854507446289
local_output_nid generation:  0.02807474136352539
local_in_edges_tensor generation:  0.03070664405822754
mini_batch_src_global generation:  0.057212114334106445
r_  generation:  0.48746728897094727
----------------------check_connections_block total spend ----------------------------- 2.8313794136047363
generate_one_block  0.6252191066741943
generate_one_block  0.6217327117919922
generate_one_block  0.6621472835540771
generate_one_block  0.64078688621521
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02712559700012207
gen group dst list time:  0.023607730865478516
time for parepare:  0.0199129581451416
local_output_nid generation:  0.03146052360534668
local_in_edges_tensor generation:  0.04172205924987793
mini_batch_src_global generation:  0.04502224922180176
r_  generation:  0.49808835983276367
local_output_nid generation:  0.038683414459228516
local_in_edges_tensor generation:  0.036992788314819336
mini_batch_src_global generation:  0.060793161392211914
r_  generation:  0.5044925212860107
local_output_nid generation:  0.038365840911865234
local_in_edges_tensor generation:  0.04459190368652344
mini_batch_src_global generation:  0.058897972106933594
r_  generation:  0.5127007961273193
local_output_nid generation:  0.03863096237182617
local_in_edges_tensor generation:  0.04365396499633789
mini_batch_src_global generation:  0.06852412223815918
r_  generation:  0.5103740692138672
----------------------check_connections_block total spend ----------------------------- 3.059312105178833
generate_one_block  0.6323354244232178
generate_one_block  0.6323273181915283
generate_one_block  0.6293764114379883
generate_one_block  0.6365487575531006
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15174055099487305  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

connection checking time:  5.890691518783569
block generation total time  5.080473899841309
average batch blocks generation time:  1.2701184749603271
block dataloader generation time/epoch 12.912367661794027
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11093902587890625  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1403956413269043  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11072158813476562  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1365809440612793  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11144685745239258  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1438112258911133  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11095380783081055  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.14424467086792  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09267961978912354 |0.0198403000831604 |0.0036634206771850586 |0.00010156631469726562 |0.017320871353149414 |0.003108501434326172 |
----------------------------------------------------------pseudo_mini_loss sum 1.5189368724822998
Total (block generation + training)time/epoch 13.485884666442871
Training time/epoch 0.5788311958312988
Training time without block to device /epoch 0.4994699954986572
Training time without total dataloading part /epoch 0.08745193481445312
load block tensor time/epoch 0.37071847915649414
block to device time/epoch 0.0793612003326416
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 12 |
Number of nodes for computation during this epoch:  1721362
Number of first layer input nodes during this epoch:  662007
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15151119232177734  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026265621185302734
random selection method range initialization spend 0.006276369094848633
time for parepare:  0.01769399642944336
local_output_nid generation:  0.008692741394042969
local_in_edges_tensor generation:  0.012530326843261719
mini_batch_src_global generation:  0.00780177116394043
r_  generation:  0.0914604663848877
local_output_nid generation:  0.011837959289550781
local_in_edges_tensor generation:  0.0061686038970947266
mini_batch_src_global generation:  0.010283946990966797
r_  generation:  0.09840631484985352
local_output_nid generation:  0.011837959289550781
local_in_edges_tensor generation:  0.006360054016113281
mini_batch_src_global generation:  0.009125471115112305
r_  generation:  0.10251164436340332
local_output_nid generation:  0.012078285217285156
local_in_edges_tensor generation:  0.0060558319091796875
mini_batch_src_global generation:  0.008794546127319336
r_  generation:  0.10505080223083496
----------------------check_connections_block total spend ----------------------------- 0.6202831268310547
generate_one_block  0.1125040054321289
generate_one_block  0.11682963371276855
generate_one_block  0.11615514755249023
generate_one_block  0.11716532707214355
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.044548988342285156
gen group dst list time:  0.01884293556213379
time for parepare:  0.025510311126708984
local_output_nid generation:  0.03874063491821289
local_in_edges_tensor generation:  0.045671939849853516
mini_batch_src_global generation:  0.048265933990478516
r_  generation:  0.4732205867767334
local_output_nid generation:  0.03520035743713379
local_in_edges_tensor generation:  0.03092360496520996
mini_batch_src_global generation:  0.05578303337097168
r_  generation:  0.4822356700897217
local_output_nid generation:  0.03401303291320801
local_in_edges_tensor generation:  0.029404401779174805
mini_batch_src_global generation:  0.05647730827331543
r_  generation:  0.4957730770111084
local_output_nid generation:  0.03532099723815918
local_in_edges_tensor generation:  0.03435659408569336
mini_batch_src_global generation:  0.05906844139099121
r_  generation:  0.5029811859130859
----------------------check_connections_block total spend ----------------------------- 2.9207582473754883
generate_one_block  0.6595077514648438
generate_one_block  0.6339874267578125
generate_one_block  0.6643233299255371
generate_one_block  0.6304206848144531
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.027516603469848633
gen group dst list time:  0.023245573043823242
time for parepare:  0.01916337013244629
local_output_nid generation:  0.03178906440734863
local_in_edges_tensor generation:  0.047991037368774414
mini_batch_src_global generation:  0.05461478233337402
r_  generation:  0.5053389072418213
local_output_nid generation:  0.038372039794921875
local_in_edges_tensor generation:  0.04706740379333496
mini_batch_src_global generation:  0.056488990783691406
r_  generation:  0.5189437866210938
local_output_nid generation:  0.03985714912414551
local_in_edges_tensor generation:  0.036049604415893555
mini_batch_src_global generation:  0.05643725395202637
r_  generation:  0.5187041759490967
local_output_nid generation:  0.04164910316467285
local_in_edges_tensor generation:  0.04086112976074219
mini_batch_src_global generation:  0.05738520622253418
r_  generation:  0.5160555839538574
----------------------check_connections_block total spend ----------------------------- 3.096820592880249
generate_one_block  0.6458611488342285
generate_one_block  0.6400673389434814
generate_one_block  0.6347925662994385
generate_one_block  0.631110668182373
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15151119232177734  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

connection checking time:  6.017578840255737
block generation total time  5.140070915222168
average batch blocks generation time:  1.285017728805542
block dataloader generation time/epoch 12.959716022014618
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11086893081665039  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1399188041687012  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11091470718383789  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1401619911193848  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11085891723632812  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1404352188110352  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11086082458496094  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.143986701965332  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09316474199295044 |0.019716262817382812 |0.0036306381225585938 |9.757280349731445e-05 |0.003482222557067871 |0.0013287067413330078 |
----------------------------------------------------------pseudo_mini_loss sum 1.4878780841827393
Total (block generation + training)time/epoch 13.533043801784515
Training time/epoch 0.5724890232086182
Training time without block to device /epoch 0.4936239719390869
Training time without total dataloading part /epoch 0.030170440673828125
load block tensor time/epoch 0.37265896797180176
block to device time/epoch 0.07886505126953125
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 13 |
Number of nodes for computation during this epoch:  1721889
Number of first layer input nodes during this epoch:  661931
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15189075469970703  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022409915924072266
random selection method range initialization spend 0.0053195953369140625
time for parepare:  0.017803668975830078
local_output_nid generation:  0.008770227432250977
local_in_edges_tensor generation:  0.009613752365112305
mini_batch_src_global generation:  0.007716655731201172
r_  generation:  0.09181499481201172
local_output_nid generation:  0.01179957389831543
local_in_edges_tensor generation:  0.006515026092529297
mini_batch_src_global generation:  0.010166645050048828
r_  generation:  0.09891057014465332
local_output_nid generation:  0.011804342269897461
local_in_edges_tensor generation:  0.006194114685058594
mini_batch_src_global generation:  0.007889270782470703
r_  generation:  0.10135602951049805
local_output_nid generation:  0.011818647384643555
local_in_edges_tensor generation:  0.006284475326538086
mini_batch_src_global generation:  0.008884429931640625
r_  generation:  0.10356426239013672
----------------------check_connections_block total spend ----------------------------- 0.6156575679779053
generate_one_block  0.12187814712524414
generate_one_block  0.11571693420410156
generate_one_block  0.11738228797912598
generate_one_block  0.11740422248840332
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03659367561340332
gen group dst list time:  0.011957645416259766
time for parepare:  0.019550800323486328
local_output_nid generation:  0.021674156188964844
local_in_edges_tensor generation:  0.03790712356567383
mini_batch_src_global generation:  0.04894733428955078
r_  generation:  0.47013211250305176
local_output_nid generation:  0.028362274169921875
local_in_edges_tensor generation:  0.034716129302978516
mini_batch_src_global generation:  0.056714534759521484
r_  generation:  0.48554372787475586
local_output_nid generation:  0.026668548583984375
local_in_edges_tensor generation:  0.02754831314086914
mini_batch_src_global generation:  0.0560152530670166
r_  generation:  0.4828042984008789
local_output_nid generation:  0.026831865310668945
local_in_edges_tensor generation:  0.027806758880615234
mini_batch_src_global generation:  0.05856919288635254
r_  generation:  0.4925506114959717
----------------------check_connections_block total spend ----------------------------- 2.8239872455596924
generate_one_block  0.621267557144165
generate_one_block  0.6329009532928467
generate_one_block  0.6480159759521484
generate_one_block  0.6305756568908691
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.026648521423339844
gen group dst list time:  0.022556543350219727
time for parepare:  0.02284097671508789
local_output_nid generation:  0.03148031234741211
local_in_edges_tensor generation:  0.044779062271118164
mini_batch_src_global generation:  0.047545433044433594
r_  generation:  0.5109233856201172
local_output_nid generation:  0.03935647010803223
local_in_edges_tensor generation:  0.04538416862487793
mini_batch_src_global generation:  0.05752110481262207
r_  generation:  0.5095956325531006
local_output_nid generation:  0.039783477783203125
local_in_edges_tensor generation:  0.037183284759521484
mini_batch_src_global generation:  0.055914878845214844
r_  generation:  0.5047035217285156
local_output_nid generation:  0.03990960121154785
local_in_edges_tensor generation:  0.037428855895996094
mini_batch_src_global generation:  0.05772972106933594
r_  generation:  0.5083932876586914
----------------------check_connections_block total spend ----------------------------- 3.0494329929351807
generate_one_block  0.6297297477722168
generate_one_block  0.6320595741271973
generate_one_block  0.6331803798675537
generate_one_block  0.6357736587524414
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15189075469970703  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

connection checking time:  5.873420238494873
block generation total time  5.0635035037994385
average batch blocks generation time:  1.2658758759498596
block dataloader generation time/epoch 12.940771436691284
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.1112823486328125  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1386408805847168  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11102008819580078  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1439552307128906  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11083555221557617  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1370930671691895  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.1109776496887207  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1440229415893555  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09588050842285156 |0.018891572952270508 |0.003681004047393799 |0.00010275840759277344 |0.0038593411445617676 |0.0015799999237060547 |
----------------------------------------------------------pseudo_mini_loss sum 1.4553272724151611
Total (block generation + training)time/epoch 13.515159606933594
Training time/epoch 0.578446626663208
Training time without block to device /epoch 0.502880334854126
Training time without total dataloading part /epoch 0.032152414321899414
load block tensor time/epoch 0.38352203369140625
block to device time/epoch 0.07556629180908203
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 14 |
Number of nodes for computation during this epoch:  1721504
Number of first layer input nodes during this epoch:  662153
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.1516246795654297  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021732330322265625
random selection method range initialization spend 0.0048885345458984375
time for parepare:  0.018129587173461914
local_output_nid generation:  0.009256124496459961
local_in_edges_tensor generation:  0.011603593826293945
mini_batch_src_global generation:  0.007924079895019531
r_  generation:  0.09129118919372559
local_output_nid generation:  0.011806249618530273
local_in_edges_tensor generation:  0.0060961246490478516
mini_batch_src_global generation:  0.010075092315673828
r_  generation:  0.09934449195861816
local_output_nid generation:  0.011811256408691406
local_in_edges_tensor generation:  0.0062067508697509766
mini_batch_src_global generation:  0.00814962387084961
r_  generation:  0.10101103782653809
local_output_nid generation:  0.011919736862182617
local_in_edges_tensor generation:  0.006128072738647461
mini_batch_src_global generation:  0.008562803268432617
r_  generation:  0.10352301597595215
----------------------check_connections_block total spend ----------------------------- 0.614818811416626
generate_one_block  0.11305594444274902
generate_one_block  0.11558914184570312
generate_one_block  0.11772465705871582
generate_one_block  0.11560893058776855
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0338742733001709
gen group dst list time:  0.011984586715698242
time for parepare:  0.019753694534301758
local_output_nid generation:  0.021427392959594727
local_in_edges_tensor generation:  0.04271531105041504
mini_batch_src_global generation:  0.04773759841918945
r_  generation:  0.47199058532714844
local_output_nid generation:  0.028411149978637695
local_in_edges_tensor generation:  0.033677101135253906
mini_batch_src_global generation:  0.056763410568237305
r_  generation:  0.4917261600494385
local_output_nid generation:  0.027103424072265625
local_in_edges_tensor generation:  0.030247926712036133
mini_batch_src_global generation:  0.058485984802246094
r_  generation:  0.49074459075927734
local_output_nid generation:  0.027135133743286133
local_in_edges_tensor generation:  0.027780771255493164
mini_batch_src_global generation:  0.05669379234313965
r_  generation:  0.49117112159729004
----------------------check_connections_block total spend ----------------------------- 2.842177152633667
generate_one_block  0.620032548904419
generate_one_block  0.6198704242706299
generate_one_block  0.6665852069854736
generate_one_block  0.6212198734283447
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.025922298431396484
gen group dst list time:  0.02241683006286621
time for parepare:  0.01879715919494629
local_output_nid generation:  0.03118276596069336
local_in_edges_tensor generation:  0.04018425941467285
mini_batch_src_global generation:  0.04490399360656738
r_  generation:  0.4991621971130371
local_output_nid generation:  0.037996768951416016
local_in_edges_tensor generation:  0.03717494010925293
mini_batch_src_global generation:  0.05638623237609863
r_  generation:  0.5073280334472656
local_output_nid generation:  0.03871345520019531
local_in_edges_tensor generation:  0.03685402870178223
mini_batch_src_global generation:  0.056386470794677734
r_  generation:  0.5073587894439697
local_output_nid generation:  0.038262367248535156
local_in_edges_tensor generation:  0.039057016372680664
mini_batch_src_global generation:  0.05630803108215332
r_  generation:  0.5117537975311279
----------------------check_connections_block total spend ----------------------------- 3.0182712078094482
generate_one_block  0.6335000991821289
generate_one_block  0.6313736438751221
generate_one_block  0.6321849822998047
generate_one_block  0.6315550804138184
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.1516246795654297  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

connection checking time:  5.860448360443115
block generation total time  5.056321859359741
average batch blocks generation time:  1.2640804648399353
block dataloader generation time/epoch 12.92115851243337
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11083745956420898  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1378612518310547  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11084985733032227  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1440610885620117  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11153554916381836  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1437339782714844  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11081647872924805  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1395106315612793  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09116357564926147 |0.018445849418640137 |0.0035012364387512207 |9.137392044067383e-05 |0.003503143787384033 |0.001680612564086914 |
----------------------------------------------------------pseudo_mini_loss sum 1.4228436946868896
Total (block generation + training)time/epoch 13.49321194489797
Training time/epoch 0.5601727962493896
Training time without block to device /epoch 0.4863893985748291
Training time without total dataloading part /epoch 0.030063629150390625
load block tensor time/epoch 0.3646543025970459
block to device time/epoch 0.07378339767456055
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 15 |
Number of nodes for computation during this epoch:  1720979
Number of first layer input nodes during this epoch:  661725
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15122222900390625  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0225980281829834
random selection method range initialization spend 0.00482487678527832
time for parepare:  0.018219470977783203
local_output_nid generation:  0.008582115173339844
local_in_edges_tensor generation:  0.00843501091003418
mini_batch_src_global generation:  0.0077974796295166016
r_  generation:  0.09115719795227051
local_output_nid generation:  0.0117950439453125
local_in_edges_tensor generation:  0.006035327911376953
mini_batch_src_global generation:  0.009976863861083984
r_  generation:  0.0984351634979248
local_output_nid generation:  0.011814355850219727
local_in_edges_tensor generation:  0.006349802017211914
mini_batch_src_global generation:  0.00798654556274414
r_  generation:  0.10397458076477051
local_output_nid generation:  0.011839628219604492
local_in_edges_tensor generation:  0.007682085037231445
mini_batch_src_global generation:  0.008800506591796875
r_  generation:  0.105255126953125
----------------------check_connections_block total spend ----------------------------- 0.6172049045562744
generate_one_block  0.11399650573730469
generate_one_block  0.11706709861755371
generate_one_block  0.11666727066040039
generate_one_block  0.11699867248535156
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03810572624206543
gen group dst list time:  0.011966705322265625
time for parepare:  0.01970219612121582
local_output_nid generation:  0.021608352661132812
local_in_edges_tensor generation:  0.04790902137756348
mini_batch_src_global generation:  0.04769635200500488
r_  generation:  0.4684112071990967
local_output_nid generation:  0.029848098754882812
local_in_edges_tensor generation:  0.03425717353820801
mini_batch_src_global generation:  0.056549072265625
r_  generation:  0.4831054210662842
local_output_nid generation:  0.027538061141967773
local_in_edges_tensor generation:  0.029677629470825195
mini_batch_src_global generation:  0.05565190315246582
r_  generation:  0.48796844482421875
local_output_nid generation:  0.027468442916870117
local_in_edges_tensor generation:  0.0300753116607666
mini_batch_src_global generation:  0.05956554412841797
r_  generation:  0.49472951889038086
----------------------check_connections_block total spend ----------------------------- 2.849142074584961
generate_one_block  0.6209886074066162
generate_one_block  0.6190345287322998
generate_one_block  0.6454644203186035
generate_one_block  0.6420068740844727
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.027910470962524414
gen group dst list time:  0.022473812103271484
time for parepare:  0.019135475158691406
local_output_nid generation:  0.030205965042114258
local_in_edges_tensor generation:  0.04371976852416992
mini_batch_src_global generation:  0.045262813568115234
r_  generation:  0.49291539192199707
local_output_nid generation:  0.03792881965637207
local_in_edges_tensor generation:  0.0382227897644043
mini_batch_src_global generation:  0.056119441986083984
r_  generation:  0.5063047409057617
local_output_nid generation:  0.03808140754699707
local_in_edges_tensor generation:  0.038587331771850586
mini_batch_src_global generation:  0.05647706985473633
r_  generation:  0.5022556781768799
local_output_nid generation:  0.038062095642089844
local_in_edges_tensor generation:  0.03462862968444824
mini_batch_src_global generation:  0.056197166442871094
r_  generation:  0.5139861106872559
----------------------check_connections_block total spend ----------------------------- 3.0065882205963135
generate_one_block  0.631415843963623
generate_one_block  0.6400465965270996
generate_one_block  0.635016918182373
generate_one_block  0.6340522766113281
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15122222900390625  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

connection checking time:  5.855730295181274
block generation total time  5.068026065826416
average batch blocks generation time:  1.267006516456604
block dataloader generation time/epoch 12.90712308883667
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11088943481445312  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1437487602233887  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11093282699584961  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1402678489685059  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11082172393798828  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1376566886901855  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11091375350952148  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.144263744354248  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0904882550239563 |0.014201343059539795 |0.0035781264305114746 |9.5367431640625e-05 |0.0033231377601623535 |0.0018568038940429688 |
----------------------------------------------------------pseudo_mini_loss sum 1.3953754901885986
Total (block generation + training)time/epoch 13.474625383104597
Training time/epoch 0.5399491786956787
Training time without block to device /epoch 0.48314380645751953
Training time without total dataloading part /epoch 0.02984333038330078
load block tensor time/epoch 0.3619530200958252
block to device time/epoch 0.05680537223815918
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 16 |
Number of nodes for computation during this epoch:  1721571
Number of first layer input nodes during this epoch:  662081
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.1521902084350586  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020613431930541992
random selection method range initialization spend 0.00489354133605957
time for parepare:  0.017922639846801758
local_output_nid generation:  0.009021520614624023
local_in_edges_tensor generation:  0.00832676887512207
mini_batch_src_global generation:  0.00783991813659668
r_  generation:  0.0897977352142334
local_output_nid generation:  0.01193547248840332
local_in_edges_tensor generation:  0.006566047668457031
mini_batch_src_global generation:  0.010220766067504883
r_  generation:  0.09858846664428711
local_output_nid generation:  0.011940717697143555
local_in_edges_tensor generation:  0.006087779998779297
mini_batch_src_global generation:  0.007980585098266602
r_  generation:  0.10133218765258789
local_output_nid generation:  0.011910200119018555
local_in_edges_tensor generation:  0.006214141845703125
mini_batch_src_global generation:  0.008729934692382812
r_  generation:  0.10450506210327148
----------------------check_connections_block total spend ----------------------------- 0.6109585762023926
generate_one_block  0.1142587661743164
generate_one_block  0.1146843433380127
generate_one_block  0.11670589447021484
generate_one_block  0.11499547958374023
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.033997535705566406
gen group dst list time:  0.011970281600952148
time for parepare:  0.01949620246887207
local_output_nid generation:  0.021550893783569336
local_in_edges_tensor generation:  0.03675246238708496
mini_batch_src_global generation:  0.04485940933227539
r_  generation:  0.4737677574157715
local_output_nid generation:  0.02865910530090332
local_in_edges_tensor generation:  0.03205561637878418
mini_batch_src_global generation:  0.05760550498962402
r_  generation:  0.48959994316101074
local_output_nid generation:  0.027422189712524414
local_in_edges_tensor generation:  0.028586387634277344
mini_batch_src_global generation:  0.056438446044921875
r_  generation:  0.4879179000854492
local_output_nid generation:  0.02651834487915039
local_in_edges_tensor generation:  0.02773118019104004
mini_batch_src_global generation:  0.05751824378967285
r_  generation:  0.48795652389526367
----------------------check_connections_block total spend ----------------------------- 2.825186014175415
generate_one_block  0.6161727905273438
generate_one_block  0.6169846057891846
generate_one_block  0.6511876583099365
generate_one_block  0.6149322986602783
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02501678466796875
gen group dst list time:  0.02268838882446289
time for parepare:  0.01961827278137207
local_output_nid generation:  0.03119349479675293
local_in_edges_tensor generation:  0.040740251541137695
mini_batch_src_global generation:  0.045111656188964844
r_  generation:  0.4965062141418457
local_output_nid generation:  0.038828134536743164
local_in_edges_tensor generation:  0.03438711166381836
mini_batch_src_global generation:  0.056295156478881836
r_  generation:  0.5060360431671143
local_output_nid generation:  0.038329124450683594
local_in_edges_tensor generation:  0.034745216369628906
mini_batch_src_global generation:  0.057990074157714844
r_  generation:  0.5080649852752686
local_output_nid generation:  0.038651227951049805
local_in_edges_tensor generation:  0.03473210334777832
mini_batch_src_global generation:  0.0564265251159668
r_  generation:  0.5095672607421875
----------------------check_connections_block total spend ----------------------------- 3.00451922416687
generate_one_block  0.6291103363037109
generate_one_block  0.6324503421783447
generate_one_block  0.6266145706176758
generate_one_block  0.6313512325286865
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.1521902084350586  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

connection checking time:  5.829705238342285
block generation total time  5.018803834915161
average batch blocks generation time:  1.2547009587287903
block dataloader generation time/epoch 12.886792957782745
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.1115412712097168  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1436386108398438  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11092567443847656  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.140181541442871  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11094379425048828  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1433444023132324  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11088085174560547  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.139554500579834  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09009706974029541 |0.01429283618927002 |0.003437936305999756 |9.387731552124023e-05 |0.0034196972846984863 |0.0013375282287597656 |
----------------------------------------------------------pseudo_mini_loss sum 1.3724294900894165
Total (block generation + training)time/epoch 13.45097878575325
Training time/epoch 0.5407588481903076
Training time without block to device /epoch 0.48358750343322754
Training time without total dataloading part /epoch 0.029143571853637695
load block tensor time/epoch 0.36038827896118164
block to device time/epoch 0.05717134475708008
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 17 |
Number of nodes for computation during this epoch:  1721618
Number of first layer input nodes during this epoch:  662013
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15136098861694336  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018860816955566406
random selection method range initialization spend 0.004897117614746094
time for parepare:  0.017954349517822266
local_output_nid generation:  0.008746623992919922
local_in_edges_tensor generation:  0.008764028549194336
mini_batch_src_global generation:  0.007971525192260742
r_  generation:  0.09251189231872559
local_output_nid generation:  0.011868000030517578
local_in_edges_tensor generation:  0.006203889846801758
mini_batch_src_global generation:  0.009949684143066406
r_  generation:  0.0977475643157959
local_output_nid generation:  0.014813899993896484
local_in_edges_tensor generation:  0.006285190582275391
mini_batch_src_global generation:  0.00822138786315918
r_  generation:  0.10229325294494629
local_output_nid generation:  0.012032508850097656
local_in_edges_tensor generation:  0.006072998046875
mini_batch_src_global generation:  0.008672952651977539
r_  generation:  0.10511207580566406
----------------------check_connections_block total spend ----------------------------- 0.6174330711364746
generate_one_block  0.11362981796264648
generate_one_block  0.11415219306945801
generate_one_block  0.11660194396972656
generate_one_block  0.11679983139038086
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.032105207443237305
gen group dst list time:  0.012036561965942383
time for parepare:  0.020187854766845703
local_output_nid generation:  0.021880626678466797
local_in_edges_tensor generation:  0.0334019660949707
mini_batch_src_global generation:  0.04546833038330078
r_  generation:  0.4719507694244385
local_output_nid generation:  0.02812480926513672
local_in_edges_tensor generation:  0.027767658233642578
mini_batch_src_global generation:  0.059535980224609375
r_  generation:  0.4835782051086426
local_output_nid generation:  0.02769017219543457
local_in_edges_tensor generation:  0.02969050407409668
mini_batch_src_global generation:  0.05642867088317871
r_  generation:  0.48578619956970215
local_output_nid generation:  0.02663731575012207
local_in_edges_tensor generation:  0.02657938003540039
mini_batch_src_global generation:  0.05707859992980957
r_  generation:  0.4914829730987549
----------------------check_connections_block total spend ----------------------------- 2.8116507530212402
generate_one_block  0.6269211769104004
generate_one_block  0.6214847564697266
generate_one_block  0.6429944038391113
generate_one_block  0.6192584037780762
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02579522132873535
gen group dst list time:  0.02266407012939453
time for parepare:  0.019607067108154297
local_output_nid generation:  0.030900001525878906
local_in_edges_tensor generation:  0.04547715187072754
mini_batch_src_global generation:  0.045351266860961914
r_  generation:  0.504051923751831
local_output_nid generation:  0.038786888122558594
local_in_edges_tensor generation:  0.03565073013305664
mini_batch_src_global generation:  0.05670976638793945
r_  generation:  0.5138323307037354
local_output_nid generation:  0.038191795349121094
local_in_edges_tensor generation:  0.03726506233215332
mini_batch_src_global generation:  0.05721020698547363
r_  generation:  0.5195624828338623
local_output_nid generation:  0.038262367248535156
local_in_edges_tensor generation:  0.04117298126220703
mini_batch_src_global generation:  0.056862592697143555
r_  generation:  0.5174233913421631
----------------------check_connections_block total spend ----------------------------- 3.0660805702209473
generate_one_block  0.6356754302978516
generate_one_block  0.642462968826294
generate_one_block  0.6420412063598633
generate_one_block  0.6395015716552734
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15136098861694336  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

connection checking time:  5.8777313232421875
block generation total time  5.070339918136597
average batch blocks generation time:  1.2675849795341492
block dataloader generation time/epoch 12.87909229596456
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11084461212158203  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.144479751586914  GigaBytes
Max Memory Allocated: 1.349900722503662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11088085174560547  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1406784057617188  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11120176315307617  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1399016380310059  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.1108541488647461  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1375274658203125  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0866430401802063 |0.01974642276763916 |0.009566962718963623 |8.988380432128906e-05 |0.0029752254486083984 |0.0013813972473144531 |
----------------------------------------------------------pseudo_mini_loss sum 1.3518083095550537
Total (block generation + training)time/epoch 13.443917645348442
Training time/epoch 0.5697360038757324
Training time without block to device /epoch 0.4907503128051758
Training time without total dataloading part /epoch 0.051909685134887695
load block tensor time/epoch 0.3465721607208252
block to device time/epoch 0.07898569107055664
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 18 |
Number of nodes for computation during this epoch:  1721387
Number of first layer input nodes during this epoch:  661967
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15132379531860352  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020724773406982422
random selection method range initialization spend 0.0050334930419921875
time for parepare:  0.018103599548339844
local_output_nid generation:  0.008932828903198242
local_in_edges_tensor generation:  0.012018918991088867
mini_batch_src_global generation:  0.007765293121337891
r_  generation:  0.09163975715637207
local_output_nid generation:  0.011965274810791016
local_in_edges_tensor generation:  0.006316184997558594
mini_batch_src_global generation:  0.010308027267456055
r_  generation:  0.09887576103210449
local_output_nid generation:  0.011926889419555664
local_in_edges_tensor generation:  0.006321430206298828
mini_batch_src_global generation:  0.007915496826171875
r_  generation:  0.10356640815734863
local_output_nid generation:  0.012022018432617188
local_in_edges_tensor generation:  0.006231069564819336
mini_batch_src_global generation:  0.008795738220214844
r_  generation:  0.10557126998901367
----------------------check_connections_block total spend ----------------------------- 0.6210658550262451
generate_one_block  0.11153411865234375
generate_one_block  0.11581158638000488
generate_one_block  0.11856675148010254
generate_one_block  0.11778521537780762
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.036821603775024414
gen group dst list time:  0.012075662612915039
time for parepare:  0.02007603645324707
local_output_nid generation:  0.02170109748840332
local_in_edges_tensor generation:  0.03969240188598633
mini_batch_src_global generation:  0.04774737358093262
r_  generation:  0.4740595817565918
local_output_nid generation:  0.028596878051757812
local_in_edges_tensor generation:  0.032521724700927734
mini_batch_src_global generation:  0.05695462226867676
r_  generation:  0.4871492385864258
local_output_nid generation:  0.027064800262451172
local_in_edges_tensor generation:  0.028120040893554688
mini_batch_src_global generation:  0.056752920150756836
r_  generation:  0.503814697265625
local_output_nid generation:  0.026805400848388672
local_in_edges_tensor generation:  0.028785228729248047
mini_batch_src_global generation:  0.05735659599304199
r_  generation:  0.4930887222290039
----------------------check_connections_block total spend ----------------------------- 2.8546414375305176
generate_one_block  0.6175434589385986
generate_one_block  0.6229298114776611
generate_one_block  0.648775577545166
generate_one_block  0.6209216117858887
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.025242328643798828
gen group dst list time:  0.022554874420166016
time for parepare:  0.018896818161010742
local_output_nid generation:  0.031179428100585938
local_in_edges_tensor generation:  0.03966999053955078
mini_batch_src_global generation:  0.0460047721862793
r_  generation:  0.4969651699066162
local_output_nid generation:  0.038583993911743164
local_in_edges_tensor generation:  0.03445696830749512
mini_batch_src_global generation:  0.0564417839050293
r_  generation:  0.5125699043273926
local_output_nid generation:  0.03918766975402832
local_in_edges_tensor generation:  0.036895036697387695
mini_batch_src_global generation:  0.057657718658447266
r_  generation:  0.5177979469299316
local_output_nid generation:  0.040462493896484375
local_in_edges_tensor generation:  0.03705167770385742
mini_batch_src_global generation:  0.056642770767211914
r_  generation:  0.5113914012908936
----------------------check_connections_block total spend ----------------------------- 3.0328989028930664
generate_one_block  0.6358911991119385
generate_one_block  0.6362450122833252
generate_one_block  0.6323752403259277
generate_one_block  0.6377873420715332
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15132379531860352  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

connection checking time:  5.887540340423584
block generation total time  5.052469253540039
average batch blocks generation time:  1.2631173133850098
block dataloader generation time/epoch 12.87544138431549
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11078691482543945  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1395320892333984  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11098003387451172  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1435728073120117  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11087560653686523  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.144413948059082  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.1108255386352539  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1399431228637695  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0886918306350708 |0.014315605163574219 |0.0036434531211853027 |9.781122207641602e-05 |0.0029892325401306152 |0.002997875213623047 |
----------------------------------------------------------pseudo_mini_loss sum 1.3384976387023926
Total (block generation + training)time/epoch 13.437235689163208
Training time/epoch 0.5342302322387695
Training time without block to device /epoch 0.47696781158447266
Training time without total dataloading part /epoch 0.029919862747192383
load block tensor time/epoch 0.3547673225402832
block to device time/epoch 0.057262420654296875
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 19 |
Number of nodes for computation during this epoch:  1721718
Number of first layer input nodes during this epoch:  661945
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15174245834350586  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018458127975463867
random selection method range initialization spend 0.004875898361206055
time for parepare:  0.01795053482055664
local_output_nid generation:  0.008811473846435547
local_in_edges_tensor generation:  0.008394002914428711
mini_batch_src_global generation:  0.007916688919067383
r_  generation:  0.09166097640991211
local_output_nid generation:  0.011889457702636719
local_in_edges_tensor generation:  0.00620579719543457
mini_batch_src_global generation:  0.01009988784790039
r_  generation:  0.09891963005065918
local_output_nid generation:  0.011855125427246094
local_in_edges_tensor generation:  0.0061798095703125
mini_batch_src_global generation:  0.007843255996704102
r_  generation:  0.1018526554107666
local_output_nid generation:  0.011980533599853516
local_in_edges_tensor generation:  0.006196737289428711
mini_batch_src_global generation:  0.008630514144897461
r_  generation:  0.10548949241638184
----------------------check_connections_block total spend ----------------------------- 0.6142678260803223
generate_one_block  0.11381077766418457
generate_one_block  0.11616253852844238
generate_one_block  0.11544251441955566
generate_one_block  0.11615204811096191
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.032743215560913086
gen group dst list time:  0.011888504028320312
time for parepare:  0.019837379455566406
local_output_nid generation:  0.021288633346557617
local_in_edges_tensor generation:  0.03512406349182129
mini_batch_src_global generation:  0.04542827606201172
r_  generation:  0.4716956615447998
local_output_nid generation:  0.02807760238647461
local_in_edges_tensor generation:  0.02741265296936035
mini_batch_src_global generation:  0.05682778358459473
r_  generation:  0.4825150966644287
local_output_nid generation:  0.026046276092529297
local_in_edges_tensor generation:  0.03011465072631836
mini_batch_src_global generation:  0.05605196952819824
r_  generation:  0.48181581497192383
local_output_nid generation:  0.02593064308166504
local_in_edges_tensor generation:  0.02779102325439453
mini_batch_src_global generation:  0.056780099868774414
r_  generation:  0.4856574535369873
----------------------check_connections_block total spend ----------------------------- 2.7973380088806152
generate_one_block  0.6194477081298828
generate_one_block  0.6208024024963379
generate_one_block  0.63956618309021
generate_one_block  0.6145858764648438
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.026122570037841797
gen group dst list time:  0.02276015281677246
time for parepare:  0.019181489944458008
local_output_nid generation:  0.029847145080566406
local_in_edges_tensor generation:  0.04176211357116699
mini_batch_src_global generation:  0.04482722282409668
r_  generation:  0.4954535961151123
local_output_nid generation:  0.03804802894592285
local_in_edges_tensor generation:  0.034642696380615234
mini_batch_src_global generation:  0.056536197662353516
r_  generation:  0.5063316822052002
local_output_nid generation:  0.03803133964538574
local_in_edges_tensor generation:  0.03588557243347168
mini_batch_src_global generation:  0.05691218376159668
r_  generation:  0.5075788497924805
local_output_nid generation:  0.037761688232421875
local_in_edges_tensor generation:  0.03451180458068848
mini_batch_src_global generation:  0.05589652061462402
r_  generation:  0.5098280906677246
----------------------check_connections_block total spend ----------------------------- 3.000209331512451
generate_one_block  0.624321460723877
generate_one_block  0.6252052783966064
generate_one_block  0.622382402420044
generate_one_block  0.6231608390808105
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15174245834350586  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

connection checking time:  5.797547340393066
block generation total time  4.989472150802612
average batch blocks generation time:  1.247368037700653
block dataloader generation time/epoch 12.856167229739102
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.1113576889038086  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.140432357788086  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11100196838378906  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1440539360046387  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11080074310302734  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1379084587097168  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11086034774780273  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.143315315246582  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08947020769119263 |0.014500558376312256 |0.003847837448120117 |0.000102996826171875 |0.002986431121826172 |0.002870321273803711 |
----------------------------------------------------------pseudo_mini_loss sum 1.3257558345794678
Total (block generation + training)time/epoch 13.4161226532676
Training time/epoch 0.5414371490478516
Training time without block to device /epoch 0.48343491554260254
Training time without total dataloading part /epoch 0.030619382858276367
load block tensor time/epoch 0.3578808307647705
block to device time/epoch 0.05800223350524902
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 20 |
Number of nodes for computation during this epoch:  1721504
Number of first layer input nodes during this epoch:  662021
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.1513080596923828  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018323421478271484
random selection method range initialization spend 0.004944324493408203
time for parepare:  0.01760101318359375
local_output_nid generation:  0.008907794952392578
local_in_edges_tensor generation:  0.008777856826782227
mini_batch_src_global generation:  0.007855415344238281
r_  generation:  0.09163713455200195
local_output_nid generation:  0.01184225082397461
local_in_edges_tensor generation:  0.00612640380859375
mini_batch_src_global generation:  0.010022163391113281
r_  generation:  0.09713888168334961
local_output_nid generation:  0.011889934539794922
local_in_edges_tensor generation:  0.006258964538574219
mini_batch_src_global generation:  0.008050918579101562
r_  generation:  0.10317468643188477
local_output_nid generation:  0.011883974075317383
local_in_edges_tensor generation:  0.006190061569213867
mini_batch_src_global generation:  0.00866389274597168
r_  generation:  0.1045680046081543
----------------------check_connections_block total spend ----------------------------- 0.6130063533782959
generate_one_block  0.11283397674560547
generate_one_block  0.11571669578552246
generate_one_block  0.11885857582092285
generate_one_block  0.11927604675292969
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03209233283996582
gen group dst list time:  0.014759302139282227
time for parepare:  0.019460201263427734
local_output_nid generation:  0.021219730377197266
local_in_edges_tensor generation:  0.03932619094848633
mini_batch_src_global generation:  0.052355051040649414
r_  generation:  0.4732649326324463
local_output_nid generation:  0.028178930282592773
local_in_edges_tensor generation:  0.03324007987976074
mini_batch_src_global generation:  0.056276559829711914
r_  generation:  0.4919393062591553
local_output_nid generation:  0.03362464904785156
local_in_edges_tensor generation:  0.03857302665710449
mini_batch_src_global generation:  0.07785987854003906
r_  generation:  0.49467921257019043
local_output_nid generation:  0.027300357818603516
local_in_edges_tensor generation:  0.03179335594177246
mini_batch_src_global generation:  0.057065725326538086
r_  generation:  0.4874234199523926
----------------------check_connections_block total spend ----------------------------- 2.898622512817383
generate_one_block  0.6266727447509766
generate_one_block  0.6194417476654053
generate_one_block  0.6556618213653564
generate_one_block  0.6270453929901123
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03161764144897461
gen group dst list time:  0.022882699966430664
time for parepare:  0.019010066986083984
local_output_nid generation:  0.030530214309692383
local_in_edges_tensor generation:  0.04707598686218262
mini_batch_src_global generation:  0.04757976531982422
r_  generation:  0.4939239025115967
local_output_nid generation:  0.038103580474853516
local_in_edges_tensor generation:  0.03899741172790527
mini_batch_src_global generation:  0.05648016929626465
r_  generation:  0.5016994476318359
local_output_nid generation:  0.037705421447753906
local_in_edges_tensor generation:  0.040239572525024414
mini_batch_src_global generation:  0.057015180587768555
r_  generation:  0.5093228816986084
local_output_nid generation:  0.037496328353881836
local_in_edges_tensor generation:  0.034012556076049805
mini_batch_src_global generation:  0.0560603141784668
r_  generation:  0.5253069400787354
----------------------check_connections_block total spend ----------------------------- 3.034377336502075
generate_one_block  0.6534624099731445
generate_one_block  0.649348258972168
generate_one_block  0.6459534168243408
generate_one_block  0.6351358890533447
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.1513080596923828  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

connection checking time:  5.932999849319458
block generation total time  5.112721681594849
average batch blocks generation time:  1.2781804203987122
block dataloader generation time/epoch 12.861933728059133
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11081552505493164  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1442594528198242  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.1108083724975586  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1385960578918457  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11141395568847656  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1439599990844727  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11082983016967773  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.137986660003662  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08993744850158691 |0.020377516746520996 |0.003697693347930908 |9.828805923461914e-05 |0.0033649802207946777 |0.0013074874877929688 |
----------------------------------------------------------pseudo_mini_loss sum 1.310200810432434
Total (block generation + training)time/epoch 13.422057867050171
Training time/epoch 0.5617103576660156
Training time without block to device /epoch 0.48020029067993164
Training time without total dataloading part /epoch 0.02995133399963379
load block tensor time/epoch 0.35974979400634766
block to device time/epoch 0.08151006698608398
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 21 |
Number of nodes for computation during this epoch:  1721035
Number of first layer input nodes during this epoch:  661899
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15124130249023438  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02745199203491211
random selection method range initialization spend 0.00486445426940918
time for parepare:  0.017650365829467773
local_output_nid generation:  0.008781194686889648
local_in_edges_tensor generation:  0.012463569641113281
mini_batch_src_global generation:  0.007908344268798828
r_  generation:  0.09074521064758301
local_output_nid generation:  0.011891841888427734
local_in_edges_tensor generation:  0.006272792816162109
mini_batch_src_global generation:  0.010095357894897461
r_  generation:  0.09794783592224121
local_output_nid generation:  0.01185464859008789
local_in_edges_tensor generation:  0.006115436553955078
mini_batch_src_global generation:  0.007942676544189453
r_  generation:  0.10061407089233398
local_output_nid generation:  0.011990547180175781
local_in_edges_tensor generation:  0.006327629089355469
mini_batch_src_global generation:  0.008776187896728516
r_  generation:  0.10452151298522949
----------------------check_connections_block total spend ----------------------------- 0.6142818927764893
generate_one_block  0.11472916603088379
generate_one_block  0.11561727523803711
generate_one_block  0.11615395545959473
generate_one_block  0.11907243728637695
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03850531578063965
gen group dst list time:  0.011938810348510742
time for parepare:  0.01985645294189453
local_output_nid generation:  0.021296977996826172
local_in_edges_tensor generation:  0.03792405128479004
mini_batch_src_global generation:  0.04571819305419922
r_  generation:  0.4732074737548828
local_output_nid generation:  0.028219938278198242
local_in_edges_tensor generation:  0.033934593200683594
mini_batch_src_global generation:  0.056467294692993164
r_  generation:  0.4797351360321045
local_output_nid generation:  0.026803016662597656
local_in_edges_tensor generation:  0.029601335525512695
mini_batch_src_global generation:  0.05780529975891113
r_  generation:  0.49006128311157227
local_output_nid generation:  0.026782751083374023
local_in_edges_tensor generation:  0.03184151649475098
mini_batch_src_global generation:  0.05698895454406738
r_  generation:  0.4934864044189453
----------------------check_connections_block total spend ----------------------------- 2.8302011489868164
generate_one_block  0.6272537708282471
generate_one_block  0.6248228549957275
generate_one_block  0.6576781272888184
generate_one_block  0.6304781436920166
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02689051628112793
gen group dst list time:  0.023145437240600586
time for parepare:  0.019766569137573242
local_output_nid generation:  0.03184175491333008
local_in_edges_tensor generation:  0.04372072219848633
mini_batch_src_global generation:  0.047034502029418945
r_  generation:  0.4985499382019043
local_output_nid generation:  0.038573265075683594
local_in_edges_tensor generation:  0.04130411148071289
mini_batch_src_global generation:  0.056825876235961914
r_  generation:  0.5068662166595459
local_output_nid generation:  0.03837847709655762
local_in_edges_tensor generation:  0.049963951110839844
mini_batch_src_global generation:  0.06074213981628418
r_  generation:  0.5181121826171875
local_output_nid generation:  0.04165935516357422
local_in_edges_tensor generation:  0.036475419998168945
mini_batch_src_global generation:  0.05629324913024902
r_  generation:  0.5107319355010986
----------------------check_connections_block total spend ----------------------------- 3.075587511062622
generate_one_block  0.6337661743164062
generate_one_block  0.6312136650085449
generate_one_block  0.6327438354492188
generate_one_block  0.6305484771728516
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15124130249023438  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

connection checking time:  5.9057886600494385
block generation total time  5.068505048751831
average batch blocks generation time:  1.2671262621879578
block dataloader generation time/epoch 12.865676879882812
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11089706420898438  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1393918991088867  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.1108083724975586  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1391024589538574  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.1108555793762207  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.139298439025879  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11087322235107422  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1442627906799316  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09548258781433105 |0.01998889446258545 |0.0037509799003601074 |9.948015213012695e-05 |0.0038475394248962402 |0.001352548599243164 |
----------------------------------------------------------pseudo_mini_loss sum 1.2938232421875
Total (block generation + training)time/epoch 13.427725351773775
Training time/epoch 0.5848734378814697
Training time without block to device /epoch 0.5049178600311279
Training time without total dataloading part /epoch 0.03214454650878906
load block tensor time/epoch 0.3819303512573242
block to device time/epoch 0.0799555778503418
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 22 |
Number of nodes for computation during this epoch:  1721256
Number of first layer input nodes during this epoch:  661968
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.1519908905029297  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020951509475708008
random selection method range initialization spend 0.004933834075927734
time for parepare:  0.017632722854614258
local_output_nid generation:  0.00888824462890625
local_in_edges_tensor generation:  0.010646343231201172
mini_batch_src_global generation:  0.00807952880859375
r_  generation:  0.09283995628356934
local_output_nid generation:  0.011878490447998047
local_in_edges_tensor generation:  0.006246328353881836
mini_batch_src_global generation:  0.010556459426879883
r_  generation:  0.09854626655578613
local_output_nid generation:  0.012096405029296875
local_in_edges_tensor generation:  0.006366729736328125
mini_batch_src_global generation:  0.008135795593261719
r_  generation:  0.1026005744934082
local_output_nid generation:  0.012018442153930664
local_in_edges_tensor generation:  0.00619959831237793
mini_batch_src_global generation:  0.00884699821472168
r_  generation:  0.10410404205322266
----------------------check_connections_block total spend ----------------------------- 0.618725061416626
generate_one_block  0.11794543266296387
generate_one_block  0.11398434638977051
generate_one_block  0.11591601371765137
generate_one_block  0.11577653884887695
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03835582733154297
gen group dst list time:  0.011914253234863281
time for parepare:  0.019823551177978516
local_output_nid generation:  0.020998239517211914
local_in_edges_tensor generation:  0.04049563407897949
mini_batch_src_global generation:  0.04725313186645508
r_  generation:  0.47130823135375977
local_output_nid generation:  0.027872800827026367
local_in_edges_tensor generation:  0.03364992141723633
mini_batch_src_global generation:  0.056412696838378906
r_  generation:  0.48013806343078613
local_output_nid generation:  0.026684999465942383
local_in_edges_tensor generation:  0.029792070388793945
mini_batch_src_global generation:  0.058606624603271484
r_  generation:  0.4881932735443115
local_output_nid generation:  0.026636838912963867
local_in_edges_tensor generation:  0.029813051223754883
mini_batch_src_global generation:  0.05691242218017578
r_  generation:  0.4873323440551758
----------------------check_connections_block total spend ----------------------------- 2.8226547241210938
generate_one_block  0.6283676624298096
generate_one_block  0.6237738132476807
generate_one_block  0.6470904350280762
generate_one_block  0.6283352375030518
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.026341676712036133
gen group dst list time:  0.02287125587463379
time for parepare:  0.01930522918701172
local_output_nid generation:  0.031418561935424805
local_in_edges_tensor generation:  0.04172801971435547
mini_batch_src_global generation:  0.04641413688659668
r_  generation:  0.5015468597412109
local_output_nid generation:  0.03859257698059082
local_in_edges_tensor generation:  0.03506183624267578
mini_batch_src_global generation:  0.05684518814086914
r_  generation:  0.5024945735931396
local_output_nid generation:  0.038388967514038086
local_in_edges_tensor generation:  0.0354924201965332
mini_batch_src_global generation:  0.05776357650756836
r_  generation:  0.5143716335296631
local_output_nid generation:  0.03838396072387695
local_in_edges_tensor generation:  0.03570818901062012
mini_batch_src_global generation:  0.05644965171813965
r_  generation:  0.5103237628936768
----------------------check_connections_block total spend ----------------------------- 3.0178744792938232
generate_one_block  0.6367902755737305
generate_one_block  0.6592533588409424
generate_one_block  0.6452224254608154
generate_one_block  0.639453649520874
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.1519908905029297  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

connection checking time:  5.840529203414917
block generation total time  5.1082868576049805
average batch blocks generation time:  1.2770717144012451
block dataloader generation time/epoch 12.866514648709979
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11146926879882812  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.143681526184082  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11082220077514648  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1385245323181152  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11090373992919922  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1397075653076172  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11086797714233398  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1400437355041504  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09604096412658691 |0.01780146360397339 |0.0036292076110839844 |9.441375732421875e-05 |0.003813326358795166 |0.0018553733825683594 |
----------------------------------------------------------pseudo_mini_loss sum 1.2813379764556885
Total (block generation + training)time/epoch 13.429833718708583
Training time/epoch 0.5796289443969727
Training time without block to device /epoch 0.5084230899810791
Training time without total dataloading part /epoch 0.032003164291381836
load block tensor time/epoch 0.38416385650634766
block to device time/epoch 0.07120585441589355
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 23 |
Number of nodes for computation during this epoch:  1721098
Number of first layer input nodes during this epoch:  661901
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15135478973388672  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02076101303100586
random selection method range initialization spend 0.004912376403808594
time for parepare:  0.0181272029876709
local_output_nid generation:  0.008934974670410156
local_in_edges_tensor generation:  0.009445667266845703
mini_batch_src_global generation:  0.00806736946105957
r_  generation:  0.09344816207885742
local_output_nid generation:  0.011838436126708984
local_in_edges_tensor generation:  0.0066335201263427734
mini_batch_src_global generation:  0.010641336441040039
r_  generation:  0.09889674186706543
local_output_nid generation:  0.012013912200927734
local_in_edges_tensor generation:  0.006353616714477539
mini_batch_src_global generation:  0.007705211639404297
r_  generation:  0.10117387771606445
local_output_nid generation:  0.0120849609375
local_in_edges_tensor generation:  0.006218433380126953
mini_batch_src_global generation:  0.009076118469238281
r_  generation:  0.10448431968688965
----------------------check_connections_block total spend ----------------------------- 0.6190335750579834
generate_one_block  0.115966796875
generate_one_block  0.12100505828857422
generate_one_block  0.11684513092041016
generate_one_block  0.12033486366271973
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.040197134017944336
gen group dst list time:  0.011890888214111328
time for parepare:  0.020399093627929688
local_output_nid generation:  0.022181987762451172
local_in_edges_tensor generation:  0.04157829284667969
mini_batch_src_global generation:  0.04858207702636719
r_  generation:  0.48615026473999023
local_output_nid generation:  0.03054356575012207
local_in_edges_tensor generation:  0.03227353096008301
mini_batch_src_global generation:  0.05652618408203125
r_  generation:  0.4794349670410156
local_output_nid generation:  0.027373075485229492
local_in_edges_tensor generation:  0.030397891998291016
mini_batch_src_global generation:  0.058733224868774414
r_  generation:  0.4855334758758545
local_output_nid generation:  0.02739691734313965
local_in_edges_tensor generation:  0.028212308883666992
mini_batch_src_global generation:  0.0574193000793457
r_  generation:  0.49000096321105957
----------------------check_connections_block total spend ----------------------------- 2.84633469581604
generate_one_block  0.6252985000610352
generate_one_block  0.6208696365356445
generate_one_block  0.6522216796875
generate_one_block  0.6243665218353271
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.026256799697875977
gen group dst list time:  0.02264118194580078
time for parepare:  0.018781185150146484
local_output_nid generation:  0.030617952346801758
local_in_edges_tensor generation:  0.04752326011657715
mini_batch_src_global generation:  0.04554414749145508
r_  generation:  0.4973330497741699
local_output_nid generation:  0.03745293617248535
local_in_edges_tensor generation:  0.041025638580322266
mini_batch_src_global generation:  0.05657792091369629
r_  generation:  0.5065796375274658
local_output_nid generation:  0.037357330322265625
local_in_edges_tensor generation:  0.03528618812561035
mini_batch_src_global generation:  0.05908203125
r_  generation:  0.5059804916381836
local_output_nid generation:  0.037863731384277344
local_in_edges_tensor generation:  0.0393679141998291
mini_batch_src_global generation:  0.05663037300109863
r_  generation:  0.5095064640045166
----------------------check_connections_block total spend ----------------------------- 3.019986629486084
generate_one_block  0.6339094638824463
generate_one_block  0.6282620429992676
generate_one_block  0.6393435001373291
generate_one_block  0.6331768035888672
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15135478973388672  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

connection checking time:  5.866321325302124
block generation total time  5.057448148727417
average batch blocks generation time:  1.2643620371818542
block dataloader generation time/epoch 12.864989233016967
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11088895797729492  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.144667148590088  GigaBytes
Max Memory Allocated: 1.3499083518981934  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11074066162109375  GigaBytes
Max Memory Allocated: 1.3500981330871582  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.139017105102539  GigaBytes
Max Memory Allocated: 1.3500981330871582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11115217208862305  GigaBytes
Max Memory Allocated: 1.3500981330871582  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1389861106872559  GigaBytes
Max Memory Allocated: 1.3500981330871582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11090469360351562  GigaBytes
Max Memory Allocated: 1.3500981330871582  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1397204399108887  GigaBytes
Max Memory Allocated: 1.3500981330871582  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09328716993331909 |0.014480769634246826 |0.003625154495239258 |9.40561294555664e-05 |0.003332793712615967 |0.0028960704803466797 |
----------------------------------------------------------pseudo_mini_loss sum 1.2699580192565918
Total (block generation + training)time/epoch 13.427637910842895
Training time/epoch 0.5530815124511719
Training time without block to device /epoch 0.49515843391418457
Training time without total dataloading part /epoch 0.031104087829589844
load block tensor time/epoch 0.37314867973327637
block to device time/epoch 0.057923078536987305
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 24 |
Number of nodes for computation during this epoch:  1721293
Number of first layer input nodes during this epoch:  661850
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15140199661254883  GigaBytes
Max Memory Allocated: 1.3500981330871582  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018184900283813477
random selection method range initialization spend 0.0049822330474853516
time for parepare:  0.017276287078857422
local_output_nid generation:  0.008806228637695312
local_in_edges_tensor generation:  0.008362531661987305
mini_batch_src_global generation:  0.0077669620513916016
r_  generation:  0.09123516082763672
local_output_nid generation:  0.011725902557373047
local_in_edges_tensor generation:  0.0061817169189453125
mini_batch_src_global generation:  0.01035165786743164
r_  generation:  0.09942197799682617
local_output_nid generation:  0.011766672134399414
local_in_edges_tensor generation:  0.006333351135253906
mini_batch_src_global generation:  0.007862567901611328
r_  generation:  0.10238933563232422
local_output_nid generation:  0.011821269989013672
local_in_edges_tensor generation:  0.006198883056640625
mini_batch_src_global generation:  0.008626937866210938
r_  generation:  0.1041567325592041
----------------------check_connections_block total spend ----------------------------- 0.6133759021759033
generate_one_block  0.11237382888793945
generate_one_block  0.11657571792602539
generate_one_block  0.1159205436706543
generate_one_block  0.1172952651977539
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03568148612976074
gen group dst list time:  0.013391256332397461
time for parepare:  0.028911590576171875
local_output_nid generation:  0.02455902099609375
local_in_edges_tensor generation:  0.04081845283508301
mini_batch_src_global generation:  0.04792952537536621
r_  generation:  0.48832273483276367
local_output_nid generation:  0.037247657775878906
local_in_edges_tensor generation:  0.0363616943359375
mini_batch_src_global generation:  0.06251168251037598
r_  generation:  0.5025265216827393
local_output_nid generation:  0.03423929214477539
local_in_edges_tensor generation:  0.032900333404541016
mini_batch_src_global generation:  0.05956625938415527
r_  generation:  0.517265796661377
local_output_nid generation:  0.034217119216918945
local_in_edges_tensor generation:  0.037245750427246094
mini_batch_src_global generation:  0.06335163116455078
r_  generation:  0.534045934677124
----------------------check_connections_block total spend ----------------------------- 3.045339345932007
generate_one_block  0.6428847312927246
generate_one_block  0.6450986862182617
generate_one_block  0.6855144500732422
generate_one_block  0.6438748836517334
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.040997982025146484
gen group dst list time:  0.02373480796813965
time for parepare:  0.02039790153503418
local_output_nid generation:  0.03159046173095703
local_in_edges_tensor generation:  0.059599876403808594
mini_batch_src_global generation:  0.04620480537414551
r_  generation:  0.516087532043457
local_output_nid generation:  0.04218292236328125
local_in_edges_tensor generation:  0.0520625114440918
mini_batch_src_global generation:  0.05957388877868652
r_  generation:  0.5029370784759521
local_output_nid generation:  0.03897976875305176
local_in_edges_tensor generation:  0.03791356086730957
mini_batch_src_global generation:  0.05799269676208496
r_  generation:  0.5032339096069336
local_output_nid generation:  0.03920459747314453
local_in_edges_tensor generation:  0.035447120666503906
mini_batch_src_global generation:  0.0558018684387207
r_  generation:  0.5079069137573242
----------------------check_connections_block total spend ----------------------------- 3.0799505710601807
generate_one_block  0.6313216686248779
generate_one_block  0.639218807220459
generate_one_block  0.6530773639678955
generate_one_block  0.6358282566070557
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15140199661254883  GigaBytes
Max Memory Allocated: 1.3500981330871582  GigaBytes

connection checking time:  6.1252899169921875
block generation total time  5.17681884765625
average batch blocks generation time:  1.2942047119140625
block dataloader generation time/epoch 12.88719092309475
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11091184616088867  GigaBytes
Max Memory Allocated: 1.3500981330871582  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.140061855316162  GigaBytes
Max Memory Allocated: 1.3500981330871582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.1110224723815918  GigaBytes
Max Memory Allocated: 1.3500981330871582  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.145573616027832  GigaBytes
Max Memory Allocated: 1.3500981330871582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11087942123413086  GigaBytes
Max Memory Allocated: 1.3509125709533691  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1387486457824707  GigaBytes
Max Memory Allocated: 1.3509125709533691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11083698272705078  GigaBytes
Max Memory Allocated: 1.3509125709533691  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1393604278564453  GigaBytes
Max Memory Allocated: 1.3509125709533691  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08135145902633667 |0.01919788122177124 |0.0038005709648132324 |9.85860824584961e-05 |0.017336130142211914 |0.0013027191162109375 |
----------------------------------------------------------pseudo_mini_loss sum 1.2557727098464966
Total (block generation + training)time/epoch 13.450753420591354
Training time/epoch 0.5770716667175293
Training time without block to device /epoch 0.5002801418304443
Training time without total dataloading part /epoch 0.08624386787414551
load block tensor time/epoch 0.3254058361053467
block to device time/epoch 0.07679152488708496
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 25 |
Number of nodes for computation during this epoch:  1721807
Number of first layer input nodes during this epoch:  662147
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.1518716812133789  GigaBytes
Max Memory Allocated: 1.3509125709533691  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021593332290649414
random selection method range initialization spend 0.00493931770324707
time for parepare:  0.017539024353027344
local_output_nid generation:  0.009013652801513672
local_in_edges_tensor generation:  0.012289285659790039
mini_batch_src_global generation:  0.007811784744262695
r_  generation:  0.09260034561157227
local_output_nid generation:  0.011878728866577148
local_in_edges_tensor generation:  0.006903886795043945
mini_batch_src_global generation:  0.010874271392822266
r_  generation:  0.09783625602722168
local_output_nid generation:  0.011895895004272461
local_in_edges_tensor generation:  0.0060803890228271484
mini_batch_src_global generation:  0.00785064697265625
r_  generation:  0.10329294204711914
local_output_nid generation:  0.011868000030517578
local_in_edges_tensor generation:  0.006176948547363281
mini_batch_src_global generation:  0.00871729850769043
r_  generation:  0.10777473449707031
----------------------check_connections_block total spend ----------------------------- 0.6247737407684326
generate_one_block  0.11375164985656738
generate_one_block  0.11638331413269043
generate_one_block  0.12089061737060547
generate_one_block  0.11659407615661621
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.043709516525268555
gen group dst list time:  0.011672496795654297
time for parepare:  0.020322322845458984
local_output_nid generation:  0.02234339714050293
local_in_edges_tensor generation:  0.04480171203613281
mini_batch_src_global generation:  0.0483555793762207
r_  generation:  0.48359060287475586
local_output_nid generation:  0.031244754791259766
local_in_edges_tensor generation:  0.03466224670410156
mini_batch_src_global generation:  0.05912518501281738
r_  generation:  0.48215222358703613
local_output_nid generation:  0.02857685089111328
local_in_edges_tensor generation:  0.039171695709228516
mini_batch_src_global generation:  0.058969974517822266
r_  generation:  0.4928297996520996
local_output_nid generation:  0.02777552604675293
local_in_edges_tensor generation:  0.0279233455657959
mini_batch_src_global generation:  0.05707812309265137
r_  generation:  0.49094176292419434
----------------------check_connections_block total spend ----------------------------- 2.8863511085510254
generate_one_block  0.6220860481262207
generate_one_block  0.6226584911346436
generate_one_block  0.6570148468017578
generate_one_block  0.6318020820617676
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.024857521057128906
gen group dst list time:  0.022843122482299805
time for parepare:  0.018670082092285156
local_output_nid generation:  0.031144142150878906
local_in_edges_tensor generation:  0.04903984069824219
mini_batch_src_global generation:  0.04581570625305176
r_  generation:  0.4932732582092285
local_output_nid generation:  0.03812122344970703
local_in_edges_tensor generation:  0.03845858573913574
mini_batch_src_global generation:  0.056993961334228516
r_  generation:  0.505286693572998
local_output_nid generation:  0.03853797912597656
local_in_edges_tensor generation:  0.0360260009765625
mini_batch_src_global generation:  0.0579531192779541
r_  generation:  0.504178524017334
local_output_nid generation:  0.03816962242126465
local_in_edges_tensor generation:  0.03485274314880371
mini_batch_src_global generation:  0.055963754653930664
r_  generation:  0.5088949203491211
----------------------check_connections_block total spend ----------------------------- 3.0083038806915283
generate_one_block  0.6290173530578613
generate_one_block  0.6321315765380859
generate_one_block  0.6334757804870605
generate_one_block  0.6289718151092529
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.1518716812133789  GigaBytes
Max Memory Allocated: 1.3509125709533691  GigaBytes

connection checking time:  5.894654989242554
block generation total time  5.05715799331665
average batch blocks generation time:  1.2642894983291626
block dataloader generation time/epoch 12.887377065770766
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.1113739013671875  GigaBytes
Max Memory Allocated: 1.3509125709533691  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.136505126953125  GigaBytes
Max Memory Allocated: 1.3509125709533691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11082983016967773  GigaBytes
Max Memory Allocated: 1.3509125709533691  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1391258239746094  GigaBytes
Max Memory Allocated: 1.3509125709533691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11105155944824219  GigaBytes
Max Memory Allocated: 1.3509125709533691  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1444854736328125  GigaBytes
Max Memory Allocated: 1.3509125709533691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11093902587890625  GigaBytes
Max Memory Allocated: 1.3509125709533691  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.143601417541504  GigaBytes
Max Memory Allocated: 1.3509125709533691  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0952143669128418 |0.014450311660766602 |0.00366973876953125 |9.566545486450195e-05 |0.0037761926651000977 |0.0028831958770751953 |
----------------------------------------------------------pseudo_mini_loss sum 1.246403455734253
Total (block generation + training)time/epoch 13.450875492656932
Training time/epoch 0.5622851848602295
Training time without block to device /epoch 0.5044839382171631
Training time without total dataloading part /epoch 0.033049583435058594
load block tensor time/epoch 0.3808574676513672
block to device time/epoch 0.057801246643066406
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 26 |
Number of nodes for computation during this epoch:  1721119
Number of first layer input nodes during this epoch:  661986
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15151262283325195  GigaBytes
Max Memory Allocated: 1.3509125709533691  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020525455474853516
random selection method range initialization spend 0.005327463150024414
time for parepare:  0.01736617088317871
local_output_nid generation:  0.008835554122924805
local_in_edges_tensor generation:  0.008513212203979492
mini_batch_src_global generation:  0.007906675338745117
r_  generation:  0.09121131896972656
local_output_nid generation:  0.011780977249145508
local_in_edges_tensor generation:  0.006067037582397461
mini_batch_src_global generation:  0.010143041610717773
r_  generation:  0.09874296188354492
local_output_nid generation:  0.011800765991210938
local_in_edges_tensor generation:  0.006098031997680664
mini_batch_src_global generation:  0.007881641387939453
r_  generation:  0.10134506225585938
local_output_nid generation:  0.01190948486328125
local_in_edges_tensor generation:  0.006140947341918945
mini_batch_src_global generation:  0.008630514144897461
r_  generation:  0.10281777381896973
----------------------check_connections_block total spend ----------------------------- 0.6097102165222168
generate_one_block  0.11299943923950195
generate_one_block  0.11837482452392578
generate_one_block  0.11575841903686523
generate_one_block  0.11516427993774414
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03222537040710449
gen group dst list time:  0.011803150177001953
time for parepare:  0.019706010818481445
local_output_nid generation:  0.021313190460205078
local_in_edges_tensor generation:  0.03406953811645508
mini_batch_src_global generation:  0.04531741142272949
r_  generation:  0.4682605266571045
local_output_nid generation:  0.0275723934173584
local_in_edges_tensor generation:  0.03145575523376465
mini_batch_src_global generation:  0.05867362022399902
r_  generation:  0.48470354080200195
local_output_nid generation:  0.026770353317260742
local_in_edges_tensor generation:  0.02683877944946289
mini_batch_src_global generation:  0.056265830993652344
r_  generation:  0.4871833324432373
local_output_nid generation:  0.026820898056030273
local_in_edges_tensor generation:  0.027681827545166016
mini_batch_src_global generation:  0.05720973014831543
r_  generation:  0.4860825538635254
----------------------check_connections_block total spend ----------------------------- 2.8042263984680176
generate_one_block  0.6219115257263184
generate_one_block  0.6291937828063965
generate_one_block  0.6473658084869385
generate_one_block  0.625150203704834
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02899622917175293
gen group dst list time:  0.022877931594848633
time for parepare:  0.019395828247070312
local_output_nid generation:  0.03159689903259277
local_in_edges_tensor generation:  0.045595407485961914
mini_batch_src_global generation:  0.045937538146972656
r_  generation:  0.5011358261108398
local_output_nid generation:  0.03736615180969238
local_in_edges_tensor generation:  0.041725873947143555
mini_batch_src_global generation:  0.056943655014038086
r_  generation:  0.5067403316497803
local_output_nid generation:  0.037481069564819336
local_in_edges_tensor generation:  0.03456759452819824
mini_batch_src_global generation:  0.05638384819030762
r_  generation:  0.5011422634124756
local_output_nid generation:  0.03728818893432617
local_in_edges_tensor generation:  0.038672447204589844
mini_batch_src_global generation:  0.05581545829772949
r_  generation:  0.5088894367218018
----------------------check_connections_block total spend ----------------------------- 3.0146734714508057
generate_one_block  0.6305372714996338
generate_one_block  0.6547102928161621
generate_one_block  0.6496469974517822
generate_one_block  0.6264779567718506
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15151262283325195  GigaBytes
Max Memory Allocated: 1.3509125709533691  GigaBytes

connection checking time:  5.818899869918823
block generation total time  5.084993839263916
average batch blocks generation time:  1.271248459815979
block dataloader generation time/epoch 12.882479601436192
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.1108560562133789  GigaBytes
Max Memory Allocated: 1.3509125709533691  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1442594528198242  GigaBytes
Max Memory Allocated: 1.3509125709533691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11094093322753906  GigaBytes
Max Memory Allocated: 1.3509125709533691  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1443514823913574  GigaBytes
Max Memory Allocated: 1.3509125709533691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11127853393554688  GigaBytes
Max Memory Allocated: 1.3509125709533691  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.139892578125  GigaBytes
Max Memory Allocated: 1.3509125709533691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11080169677734375  GigaBytes
Max Memory Allocated: 1.3509125709533691  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.138700008392334  GigaBytes
Max Memory Allocated: 1.3509125709533691  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09410309791564941 |0.019849061965942383 |0.0035799741744995117 |9.179115295410156e-05 |0.0038267970085144043 |0.0012028217315673828 |
----------------------------------------------------------pseudo_mini_loss sum 1.2326420545578003
Total (block generation + training)time/epoch 13.446901016765171
Training time/epoch 0.5799362659454346
Training time without block to device /epoch 0.500540018081665
Training time without total dataloading part /epoch 0.031197071075439453
load block tensor time/epoch 0.37641239166259766
block to device time/epoch 0.07939624786376953
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 27 |
Number of nodes for computation during this epoch:  1721433
Number of first layer input nodes during this epoch:  661876
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15115022659301758  GigaBytes
Max Memory Allocated: 1.3509125709533691  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020725488662719727
random selection method range initialization spend 0.00579524040222168
time for parepare:  0.017631053924560547
local_output_nid generation:  0.008974313735961914
local_in_edges_tensor generation:  0.012062549591064453
mini_batch_src_global generation:  0.007757425308227539
r_  generation:  0.09239554405212402
local_output_nid generation:  0.011840581893920898
local_in_edges_tensor generation:  0.006165742874145508
mini_batch_src_global generation:  0.009949445724487305
r_  generation:  0.09772777557373047
local_output_nid generation:  0.011880159378051758
local_in_edges_tensor generation:  0.006145477294921875
mini_batch_src_global generation:  0.007940530776977539
r_  generation:  0.10238409042358398
local_output_nid generation:  0.011967897415161133
local_in_edges_tensor generation:  0.006284475326538086
mini_batch_src_global generation:  0.008764266967773438
r_  generation:  0.10385894775390625
----------------------check_connections_block total spend ----------------------------- 0.6161448955535889
generate_one_block  0.1150357723236084
generate_one_block  0.11500096321105957
generate_one_block  0.11730813980102539
generate_one_block  0.11503195762634277
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.041379690170288086
gen group dst list time:  0.011762380599975586
time for parepare:  0.019570589065551758
local_output_nid generation:  0.02073216438293457
local_in_edges_tensor generation:  0.04087257385253906
mini_batch_src_global generation:  0.04566693305969238
r_  generation:  0.4690821170806885
local_output_nid generation:  0.027843713760375977
local_in_edges_tensor generation:  0.03491687774658203
mini_batch_src_global generation:  0.05624127388000488
r_  generation:  0.494828462600708
local_output_nid generation:  0.02790212631225586
local_in_edges_tensor generation:  0.030695676803588867
mini_batch_src_global generation:  0.05716109275817871
r_  generation:  0.4892754554748535
local_output_nid generation:  0.026458263397216797
local_in_edges_tensor generation:  0.03161478042602539
mini_batch_src_global generation:  0.056641578674316406
r_  generation:  0.48820972442626953
----------------------check_connections_block total spend ----------------------------- 2.840752124786377
generate_one_block  0.6247329711914062
generate_one_block  0.6179261207580566
generate_one_block  0.6487746238708496
generate_one_block  0.626366376876831
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028074264526367188
gen group dst list time:  0.02265024185180664
time for parepare:  0.018927574157714844
local_output_nid generation:  0.030379772186279297
local_in_edges_tensor generation:  0.04065203666687012
mini_batch_src_global generation:  0.04461669921875
r_  generation:  0.49312758445739746
local_output_nid generation:  0.03748607635498047
local_in_edges_tensor generation:  0.03663063049316406
mini_batch_src_global generation:  0.05677628517150879
r_  generation:  0.5036108493804932
local_output_nid generation:  0.03842878341674805
local_in_edges_tensor generation:  0.038628578186035156
mini_batch_src_global generation:  0.05896949768066406
r_  generation:  0.50351881980896
local_output_nid generation:  0.03733015060424805
local_in_edges_tensor generation:  0.04116082191467285
mini_batch_src_global generation:  0.055910587310791016
r_  generation:  0.5109124183654785
----------------------check_connections_block total spend ----------------------------- 3.004415988922119
generate_one_block  0.6305828094482422
generate_one_block  0.6287634372711182
generate_one_block  0.6342394351959229
generate_one_block  0.6405212879180908
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.15115022659301758  GigaBytes
Max Memory Allocated: 1.3509125709533691  GigaBytes

connection checking time:  5.845168113708496
block generation total time  5.051907062530518
average batch blocks generation time:  1.2629767656326294
block dataloader generation time/epoch 12.879162926422921
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11099720001220703  GigaBytes
Max Memory Allocated: 1.3509125709533691  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1402740478515625  GigaBytes
Max Memory Allocated: 1.3509125709533691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11081981658935547  GigaBytes
Max Memory Allocated: 1.3509125709533691  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1386351585388184  GigaBytes
Max Memory Allocated: 1.3509125709533691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11090373992919922  GigaBytes
Max Memory Allocated: 1.3509125709533691  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1445417404174805  GigaBytes
Max Memory Allocated: 1.3509125709533691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11083650588989258  GigaBytes
Max Memory Allocated: 1.3509125709533691  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1400952339172363  GigaBytes
Max Memory Allocated: 1.3509125709533691  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09579801559448242 |0.01450115442276001 |0.0036263465881347656 |9.304285049438477e-05 |0.0038837790489196777 |0.0017817020416259766 |
----------------------------------------------------------pseudo_mini_loss sum 1.2243138551712036
Total (block generation + training)time/epoch 13.443608409480044
Training time/epoch 0.5646519660949707
Training time without block to device /epoch 0.5066473484039307
Training time without total dataloading part /epoch 0.03219437599182129
load block tensor time/epoch 0.3831920623779297
block to device time/epoch 0.05800461769104004
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 28 |
Number of nodes for computation during this epoch:  1721619
Number of first layer input nodes during this epoch:  662189
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.1516132354736328  GigaBytes
Max Memory Allocated: 1.3509125709533691  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01860809326171875
random selection method range initialization spend 0.005747795104980469
time for parepare:  0.0175626277923584
local_output_nid generation:  0.008991241455078125
local_in_edges_tensor generation:  0.008866310119628906
mini_batch_src_global generation:  0.0077817440032958984
r_  generation:  0.0924828052520752
local_output_nid generation:  0.011816978454589844
local_in_edges_tensor generation:  0.006125450134277344
mini_batch_src_global generation:  0.01030588150024414
r_  generation:  0.09935426712036133
local_output_nid generation:  0.011948823928833008
local_in_edges_tensor generation:  0.006356000900268555
mini_batch_src_global generation:  0.0078887939453125
r_  generation:  0.10210967063903809
local_output_nid generation:  0.011947154998779297
local_in_edges_tensor generation:  0.006235361099243164
mini_batch_src_global generation:  0.008839130401611328
r_  generation:  0.1056830883026123
----------------------check_connections_block total spend ----------------------------- 0.616502046585083
generate_one_block  0.11360549926757812
generate_one_block  0.1150665283203125
generate_one_block  0.11466526985168457
generate_one_block  0.11692667007446289
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03137969970703125
gen group dst list time:  0.011837005615234375
time for parepare:  0.019372940063476562
local_output_nid generation:  0.021195173263549805
local_in_edges_tensor generation:  0.03393220901489258
mini_batch_src_global generation:  0.0451054573059082
r_  generation:  0.46778345108032227
local_output_nid generation:  0.027880191802978516
local_in_edges_tensor generation:  0.02737593650817871
mini_batch_src_global generation:  0.056481361389160156
r_  generation:  0.4830305576324463
local_output_nid generation:  0.027019262313842773
local_in_edges_tensor generation:  0.027554035186767578
mini_batch_src_global generation:  0.05600094795227051
r_  generation:  0.4896376132965088
local_output_nid generation:  0.02680492401123047
local_in_edges_tensor generation:  0.027233362197875977
mini_batch_src_global generation:  0.05824899673461914
r_  generation:  0.497464656829834
----------------------check_connections_block total spend ----------------------------- 2.809603214263916
generate_one_block  0.6173858642578125
generate_one_block  0.6191468238830566
generate_one_block  0.6463024616241455
generate_one_block  0.6225807666778564
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.026326894760131836
gen group dst list time:  0.02290201187133789
time for parepare:  0.019418001174926758
local_output_nid generation:  0.030358314514160156
local_in_edges_tensor generation:  0.04045462608337402
mini_batch_src_global generation:  0.04526805877685547
r_  generation:  0.4983973503112793
local_output_nid generation:  0.037998199462890625
local_in_edges_tensor generation:  0.03988051414489746
mini_batch_src_global generation:  0.05666375160217285
r_  generation:  0.5076460838317871
local_output_nid generation:  0.03844594955444336
local_in_edges_tensor generation:  0.03545808792114258
mini_batch_src_global generation:  0.05724215507507324
r_  generation:  0.5079746246337891
local_output_nid generation:  0.03809404373168945
local_in_edges_tensor generation:  0.046674251556396484
mini_batch_src_global generation:  0.05945086479187012
r_  generation:  0.5090231895446777
----------------------check_connections_block total spend ----------------------------- 3.0252468585968018
generate_one_block  0.6234383583068848
generate_one_block  0.6269991397857666
generate_one_block  0.6240572929382324
generate_one_block  0.6293749809265137
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.1516132354736328  GigaBytes
Max Memory Allocated: 1.3509125709533691  GigaBytes

connection checking time:  5.834850072860718
block generation total time  5.0092856884002686
average batch blocks generation time:  1.2523214221000671
block dataloader generation time/epoch 12.870618140697479
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11118364334106445  GigaBytes
Max Memory Allocated: 1.3509125709533691  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1388988494873047  GigaBytes
Max Memory Allocated: 1.3509125709533691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11087989807128906  GigaBytes
Max Memory Allocated: 1.3509125709533691  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1394004821777344  GigaBytes
Max Memory Allocated: 1.3509125709533691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.11088323593139648  GigaBytes
Max Memory Allocated: 1.3509125709533691  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1397099494934082  GigaBytes
Max Memory Allocated: 1.3509125709533691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 0.1109309196472168  GigaBytes
Max Memory Allocated: 1.3509125709533691  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8826904296875 GB
    Memory Allocated: 1.1441702842712402  GigaBytes
Max Memory Allocated: 1.3509125709533691  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08916884660720825 |0.0159338116645813 |0.003445267677307129 |9.125471115112305e-05 |0.003007233142852783 |0.0017118453979492188 |
----------------------------------------------------------pseudo_mini_loss sum 1.2119450569152832
Total (block generation + training)time/epoch 13.433907783031463
Training time/epoch 0.5411224365234375
Training time without block to device /epoch 0.4773871898651123
Training time without total dataloading part /epoch 0.02788686752319336
load block tensor time/epoch 0.356675386428833
block to device time/epoch 0.0637352466583252
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 29 |
Number of nodes for computation during this epoch:  1721139
Number of first layer input nodes during this epoch:  661713
