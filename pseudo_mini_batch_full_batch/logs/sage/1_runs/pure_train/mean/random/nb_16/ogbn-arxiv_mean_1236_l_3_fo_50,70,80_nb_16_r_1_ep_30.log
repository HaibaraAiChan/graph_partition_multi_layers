Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1647763667.1104133
ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027634382247924805
random selection method range initialization spend 0.006427288055419922
time for parepare:  0.0186612606048584
local_output_nid generation:  0.002307891845703125
local_in_edges_tensor generation:  0.0050830841064453125
mini_batch_src_global generation:  0.0020558834075927734
r_  generation:  0.020496129989624023
local_output_nid generation:  0.0026443004608154297
local_in_edges_tensor generation:  0.0017247200012207031
mini_batch_src_global generation:  0.002482175827026367
r_  generation:  0.02052593231201172
local_output_nid generation:  0.002956390380859375
local_in_edges_tensor generation:  0.0016939640045166016
mini_batch_src_global generation:  0.0016412734985351562
r_  generation:  0.021008014678955078
local_output_nid generation:  0.0029294490814208984
local_in_edges_tensor generation:  0.0016193389892578125
mini_batch_src_global generation:  0.00160980224609375
r_  generation:  0.02039337158203125
local_output_nid generation:  0.0029244422912597656
local_in_edges_tensor generation:  0.0015301704406738281
mini_batch_src_global generation:  0.0015616416931152344
r_  generation:  0.01985478401184082
local_output_nid generation:  0.0029022693634033203
local_in_edges_tensor generation:  0.0015320777893066406
mini_batch_src_global generation:  0.0016062259674072266
r_  generation:  0.021206140518188477
local_output_nid generation:  0.002918243408203125
local_in_edges_tensor generation:  0.001523733139038086
mini_batch_src_global generation:  0.001708984375
r_  generation:  0.02097344398498535
local_output_nid generation:  0.0028455257415771484
local_in_edges_tensor generation:  0.0014796257019042969
mini_batch_src_global generation:  0.001804351806640625
r_  generation:  0.020615100860595703
local_output_nid generation:  0.0028715133666992188
local_in_edges_tensor generation:  0.0015101432800292969
mini_batch_src_global generation:  0.0017497539520263672
r_  generation:  0.021593809127807617
local_output_nid generation:  0.0029485225677490234
local_in_edges_tensor generation:  0.0015590190887451172
mini_batch_src_global generation:  0.0017287731170654297
r_  generation:  0.02100539207458496
local_output_nid generation:  0.0028908252716064453
local_in_edges_tensor generation:  0.0014994144439697266
mini_batch_src_global generation:  0.0016837120056152344
r_  generation:  0.021221160888671875
local_output_nid generation:  0.002972841262817383
local_in_edges_tensor generation:  0.001562356948852539
mini_batch_src_global generation:  0.0018320083618164062
r_  generation:  0.021488189697265625
local_output_nid generation:  0.0030219554901123047
local_in_edges_tensor generation:  0.0014994144439697266
mini_batch_src_global generation:  0.0018420219421386719
r_  generation:  0.021546602249145508
local_output_nid generation:  0.002891063690185547
local_in_edges_tensor generation:  0.0015611648559570312
mini_batch_src_global generation:  0.0018198490142822266
r_  generation:  0.021901369094848633
local_output_nid generation:  0.002924203872680664
local_in_edges_tensor generation:  0.0014748573303222656
mini_batch_src_global generation:  0.0018486976623535156
r_  generation:  0.02138042449951172
local_output_nid generation:  0.0029058456420898438
local_in_edges_tensor generation:  0.0015270709991455078
mini_batch_src_global generation:  0.0018162727355957031
r_  generation:  0.021281957626342773
----------------------check_connections_block total spend ----------------------------- 0.5430741310119629
generate_one_block  0.03119039535522461
generate_one_block  0.03156876564025879
generate_one_block  0.03545880317687988
generate_one_block  0.031534433364868164
generate_one_block  0.029924392700195312
generate_one_block  0.03173017501831055
generate_one_block  0.030788421630859375
generate_one_block  0.0305938720703125
generate_one_block  0.03177285194396973
generate_one_block  0.031148433685302734
generate_one_block  0.03074932098388672
generate_one_block  0.03159642219543457
generate_one_block  0.031237125396728516
generate_one_block  0.03135418891906738
generate_one_block  0.03151202201843262
generate_one_block  0.03098297119140625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.041133880615234375
gen group dst list time:  0.020615339279174805
time for parepare:  0.02010345458984375
local_output_nid generation:  0.009487152099609375
local_in_edges_tensor generation:  0.022732019424438477
mini_batch_src_global generation:  0.027876853942871094
r_  generation:  0.25520896911621094
local_output_nid generation:  0.016194820404052734
local_in_edges_tensor generation:  0.02459549903869629
mini_batch_src_global generation:  0.03235197067260742
r_  generation:  0.2706327438354492
local_output_nid generation:  0.01532292366027832
local_in_edges_tensor generation:  0.034940242767333984
mini_batch_src_global generation:  0.034871578216552734
r_  generation:  0.27805137634277344
local_output_nid generation:  0.01459956169128418
local_in_edges_tensor generation:  0.018460750579833984
mini_batch_src_global generation:  0.0602874755859375
r_  generation:  0.2637462615966797
local_output_nid generation:  0.013178348541259766
local_in_edges_tensor generation:  0.015888214111328125
mini_batch_src_global generation:  0.03249669075012207
r_  generation:  0.26671910285949707
local_output_nid generation:  0.013786792755126953
local_in_edges_tensor generation:  0.01930093765258789
mini_batch_src_global generation:  0.033910512924194336
r_  generation:  0.2726576328277588
local_output_nid generation:  0.013215303421020508
local_in_edges_tensor generation:  0.013682126998901367
mini_batch_src_global generation:  0.03378438949584961
r_  generation:  0.26315832138061523
local_output_nid generation:  0.013125419616699219
local_in_edges_tensor generation:  0.017876625061035156
mini_batch_src_global generation:  0.03315138816833496
r_  generation:  0.25806093215942383
local_output_nid generation:  0.013260364532470703
local_in_edges_tensor generation:  0.018198490142822266
mini_batch_src_global generation:  0.033944129943847656
r_  generation:  0.27149200439453125
local_output_nid generation:  0.013399124145507812
local_in_edges_tensor generation:  0.023145437240600586
mini_batch_src_global generation:  0.03428077697753906
r_  generation:  0.2707827091217041
local_output_nid generation:  0.013280630111694336
local_in_edges_tensor generation:  0.013910531997680664
mini_batch_src_global generation:  0.03368711471557617
r_  generation:  0.26509904861450195
local_output_nid generation:  0.013702154159545898
local_in_edges_tensor generation:  0.01465153694152832
mini_batch_src_global generation:  0.036400556564331055
r_  generation:  0.26965856552124023
local_output_nid generation:  0.013321161270141602
local_in_edges_tensor generation:  0.02090764045715332
mini_batch_src_global generation:  0.04221510887145996
r_  generation:  0.2722184658050537
local_output_nid generation:  0.01349020004272461
local_in_edges_tensor generation:  0.01434636116027832
mini_batch_src_global generation:  0.03484511375427246
r_  generation:  0.2738664150238037
local_output_nid generation:  0.013425827026367188
local_in_edges_tensor generation:  0.016544342041015625
mini_batch_src_global generation:  0.03397369384765625
r_  generation:  0.271071195602417
local_output_nid generation:  0.013250350952148438
local_in_edges_tensor generation:  0.0231015682220459
mini_batch_src_global generation:  0.039649009704589844
r_  generation:  0.27347898483276367
----------------------check_connections_block total spend ----------------------------- 6.369990348815918
generate_one_block  0.38628315925598145
generate_one_block  0.36197900772094727
generate_one_block  0.37134313583374023
generate_one_block  0.3515613079071045
generate_one_block  0.36891889572143555
generate_one_block  0.36621642112731934
generate_one_block  0.3512129783630371
generate_one_block  0.3426196575164795
generate_one_block  0.3649153709411621
generate_one_block  0.36008620262145996
generate_one_block  0.34758591651916504
generate_one_block  0.3661065101623535
generate_one_block  0.41069579124450684
generate_one_block  0.35505032539367676
generate_one_block  0.37299180030822754
generate_one_block  0.3536851406097412
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.06196856498718262
gen group dst list time:  0.06736254692077637
time for parepare:  0.021514415740966797
local_output_nid generation:  0.027571439743041992
local_in_edges_tensor generation:  0.07219862937927246
mini_batch_src_global generation:  0.05309438705444336
r_  generation:  0.5246117115020752
local_output_nid generation:  0.03606128692626953
local_in_edges_tensor generation:  0.0556180477142334
mini_batch_src_global generation:  0.06540608406066895
r_  generation:  0.5176515579223633
local_output_nid generation:  0.0333409309387207
local_in_edges_tensor generation:  0.04762578010559082
mini_batch_src_global generation:  0.05825376510620117
r_  generation:  0.5281331539154053
local_output_nid generation:  0.033293962478637695
local_in_edges_tensor generation:  0.04660773277282715
mini_batch_src_global generation:  0.059294939041137695
r_  generation:  0.5307974815368652
local_output_nid generation:  0.033334970474243164
local_in_edges_tensor generation:  0.03938031196594238
mini_batch_src_global generation:  0.06041455268859863
r_  generation:  0.5332608222961426
local_output_nid generation:  0.033194780349731445
local_in_edges_tensor generation:  0.03619575500488281
mini_batch_src_global generation:  0.06474423408508301
r_  generation:  0.5321931838989258
local_output_nid generation:  0.03329300880432129
local_in_edges_tensor generation:  0.04601931571960449
mini_batch_src_global generation:  0.060964345932006836
r_  generation:  0.5429210662841797
local_output_nid generation:  0.033312320709228516
local_in_edges_tensor generation:  0.03659868240356445
mini_batch_src_global generation:  0.062460899353027344
r_  generation:  0.536884069442749
local_output_nid generation:  0.03380870819091797
local_in_edges_tensor generation:  0.04635882377624512
mini_batch_src_global generation:  0.0625009536743164
r_  generation:  0.5421619415283203
local_output_nid generation:  0.03323864936828613
local_in_edges_tensor generation:  0.045621395111083984
mini_batch_src_global generation:  0.06253457069396973
r_  generation:  0.539301872253418
local_output_nid generation:  0.03322172164916992
local_in_edges_tensor generation:  0.045252323150634766
mini_batch_src_global generation:  0.061905860900878906
r_  generation:  0.5386991500854492
local_output_nid generation:  0.03332090377807617
local_in_edges_tensor generation:  0.04549574851989746
mini_batch_src_global generation:  0.06116890907287598
r_  generation:  0.5394077301025391
local_output_nid generation:  0.03319406509399414
local_in_edges_tensor generation:  0.041890859603881836
mini_batch_src_global generation:  0.06267380714416504
r_  generation:  0.545548677444458
local_output_nid generation:  0.03414607048034668
local_in_edges_tensor generation:  0.03620123863220215
mini_batch_src_global generation:  0.08479833602905273
r_  generation:  0.5453283786773682
local_output_nid generation:  0.035939693450927734
local_in_edges_tensor generation:  0.04741859436035156
mini_batch_src_global generation:  0.06328558921813965
r_  generation:  0.5389938354492188
local_output_nid generation:  0.03367114067077637
local_in_edges_tensor generation:  0.0449213981628418
mini_batch_src_global generation:  0.06254148483276367
r_  generation:  0.5427873134613037
----------------------check_connections_block total spend ----------------------------- 12.782583475112915
generate_one_block  0.6846814155578613
generate_one_block  0.6877999305725098
generate_one_block  0.7078888416290283
generate_one_block  0.7015516757965088
generate_one_block  0.6701626777648926
generate_one_block  0.6776258945465088
generate_one_block  0.7486369609832764
generate_one_block  0.6718399524688721
generate_one_block  0.6831748485565186
generate_one_block  0.6852138042449951
generate_one_block  0.7111899852752686
generate_one_block  0.6984789371490479
generate_one_block  0.6864273548126221
generate_one_block  0.6866285800933838
generate_one_block  0.6824634075164795
generate_one_block  0.6939568519592285
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  19.152573823928833
block generation total time  16.90897274017334
average batch blocks generation time:  1.0568107962608337
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.09583616256713867  GigaBytes
Max Memory Allocated: 0.09583616256713867  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7682948112487793  GigaBytes
Max Memory Allocated: 0.8098769187927246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5389404296875 GB
    Memory Allocated: 0.0982666015625  GigaBytes
Max Memory Allocated: 0.8556900024414062  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5389404296875 GB
    Memory Allocated: 0.7752213478088379  GigaBytes
Max Memory Allocated: 0.8556900024414062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.09939289093017578  GigaBytes
Max Memory Allocated: 0.8625750541687012  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.7815465927124023  GigaBytes
Max Memory Allocated: 0.8625750541687012  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.09824800491333008  GigaBytes
Max Memory Allocated: 0.8710079193115234  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.7744245529174805  GigaBytes
Max Memory Allocated: 0.8710079193115234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.09783077239990234  GigaBytes
Max Memory Allocated: 0.8710079193115234  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7622475624084473  GigaBytes
Max Memory Allocated: 0.8710079193115234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09842920303344727  GigaBytes
Max Memory Allocated: 0.8710079193115234  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7790884971618652  GigaBytes
Max Memory Allocated: 0.8710079193115234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09908771514892578  GigaBytes
Max Memory Allocated: 0.8710079193115234  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7727165222167969  GigaBytes
Max Memory Allocated: 0.8710079193115234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09793281555175781  GigaBytes
Max Memory Allocated: 0.8710079193115234  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7643184661865234  GigaBytes
Max Memory Allocated: 0.8710079193115234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09801101684570312  GigaBytes
Max Memory Allocated: 0.8710079193115234  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7673721313476562  GigaBytes
Max Memory Allocated: 0.8710079193115234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0981588363647461  GigaBytes
Max Memory Allocated: 0.8710079193115234  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7710762023925781  GigaBytes
Max Memory Allocated: 0.8710079193115234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0990753173828125  GigaBytes
Max Memory Allocated: 0.8710079193115234  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7685866355895996  GigaBytes
Max Memory Allocated: 0.8710079193115234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09837102890014648  GigaBytes
Max Memory Allocated: 0.8710079193115234  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7798309326171875  GigaBytes
Max Memory Allocated: 0.8710079193115234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09821653366088867  GigaBytes
Max Memory Allocated: 0.8710079193115234  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7738523483276367  GigaBytes
Max Memory Allocated: 0.8710079193115234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09822750091552734  GigaBytes
Max Memory Allocated: 0.8710079193115234  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7725067138671875  GigaBytes
Max Memory Allocated: 0.8710079193115234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09810924530029297  GigaBytes
Max Memory Allocated: 0.8710079193115234  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7697029113769531  GigaBytes
Max Memory Allocated: 0.8710079193115234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09808826446533203  GigaBytes
Max Memory Allocated: 0.8710079193115234  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7690892219543457  GigaBytes
Max Memory Allocated: 0.8710079193115234  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05980505049228668 |0.03969584405422211 |0.048885777592659 |0.00010284781455993652 |0.0113791823387146 |0.0040624141693115234 |
----------------------------------------------------------pseudo_mini_loss sum 6.283711910247803
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5332767
Number of first layer input nodes during this epoch:  2522347
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.12830686569213867  GigaBytes
Max Memory Allocated: 0.8710079193115234  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021215438842773438
random selection method range initialization spend 0.004922389984130859
time for parepare:  0.017824649810791016
local_output_nid generation:  0.0025415420532226562
local_in_edges_tensor generation:  0.007430315017700195
mini_batch_src_global generation:  0.001997232437133789
r_  generation:  0.020349979400634766
local_output_nid generation:  0.0030431747436523438
local_in_edges_tensor generation:  0.0017476081848144531
mini_batch_src_global generation:  0.0023956298828125
r_  generation:  0.02142190933227539
local_output_nid generation:  0.0031032562255859375
local_in_edges_tensor generation:  0.001680135726928711
mini_batch_src_global generation:  0.0015628337860107422
r_  generation:  0.020931720733642578
local_output_nid generation:  0.0031213760375976562
local_in_edges_tensor generation:  0.0016241073608398438
mini_batch_src_global generation:  0.0016112327575683594
r_  generation:  0.021078109741210938
local_output_nid generation:  0.003046751022338867
local_in_edges_tensor generation:  0.0016145706176757812
mini_batch_src_global generation:  0.001619577407836914
r_  generation:  0.021268844604492188
local_output_nid generation:  0.002963542938232422
local_in_edges_tensor generation:  0.0015654563903808594
mini_batch_src_global generation:  0.0016379356384277344
r_  generation:  0.0213472843170166
local_output_nid generation:  0.003180265426635742
local_in_edges_tensor generation:  0.0016214847564697266
mini_batch_src_global generation:  0.0016443729400634766
r_  generation:  0.022211313247680664
local_output_nid generation:  0.0030786991119384766
local_in_edges_tensor generation:  0.001619577407836914
mini_batch_src_global generation:  0.0016367435455322266
r_  generation:  0.021121978759765625
local_output_nid generation:  0.002966642379760742
local_in_edges_tensor generation:  0.001592397689819336
mini_batch_src_global generation:  0.0017163753509521484
r_  generation:  0.02189469337463379
local_output_nid generation:  0.0030269622802734375
local_in_edges_tensor generation:  0.0016257762908935547
mini_batch_src_global generation:  0.0016734600067138672
r_  generation:  0.022398948669433594
local_output_nid generation:  0.003064870834350586
local_in_edges_tensor generation:  0.0016553401947021484
mini_batch_src_global generation:  0.0017375946044921875
r_  generation:  0.02164769172668457
local_output_nid generation:  0.0030164718627929688
local_in_edges_tensor generation:  0.0016279220581054688
mini_batch_src_global generation:  0.0017237663269042969
r_  generation:  0.022105932235717773
local_output_nid generation:  0.0030870437622070312
local_in_edges_tensor generation:  0.001592397689819336
mini_batch_src_global generation:  0.001882314682006836
r_  generation:  0.02256155014038086
local_output_nid generation:  0.0031003952026367188
local_in_edges_tensor generation:  0.0016510486602783203
mini_batch_src_global generation:  0.0017559528350830078
r_  generation:  0.023035049438476562
local_output_nid generation:  0.003106832504272461
local_in_edges_tensor generation:  0.0016007423400878906
mini_batch_src_global generation:  0.001779317855834961
r_  generation:  0.022008895874023438
local_output_nid generation:  0.003007173538208008
local_in_edges_tensor generation:  0.0016224384307861328
mini_batch_src_global generation:  0.001737356185913086
r_  generation:  0.023035526275634766
----------------------check_connections_block total spend ----------------------------- 0.5660371780395508
generate_one_block  0.034122467041015625
generate_one_block  0.03191781044006348
generate_one_block  0.0316159725189209
generate_one_block  0.03139209747314453
generate_one_block  0.03138422966003418
generate_one_block  0.033777713775634766
generate_one_block  0.03195357322692871
generate_one_block  0.030350208282470703
generate_one_block  0.03467273712158203
generate_one_block  0.03155517578125
generate_one_block  0.031224489212036133
generate_one_block  0.03404068946838379
generate_one_block  0.031632184982299805
generate_one_block  0.03208470344543457
generate_one_block  0.03107595443725586
generate_one_block  0.031592607498168945
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04298257827758789
gen group dst list time:  0.019405841827392578
time for parepare:  0.021826505661010742
local_output_nid generation:  0.009243011474609375
local_in_edges_tensor generation:  0.02746438980102539
mini_batch_src_global generation:  0.026943683624267578
r_  generation:  0.2575054168701172
local_output_nid generation:  0.014455080032348633
local_in_edges_tensor generation:  0.033269643783569336
mini_batch_src_global generation:  0.042617082595825195
r_  generation:  0.26502466201782227
local_output_nid generation:  0.014423847198486328
local_in_edges_tensor generation:  0.019369125366210938
mini_batch_src_global generation:  0.03255057334899902
r_  generation:  0.2685558795928955
local_output_nid generation:  0.014194965362548828
local_in_edges_tensor generation:  0.01618027687072754
mini_batch_src_global generation:  0.03265500068664551
r_  generation:  0.2688605785369873
local_output_nid generation:  0.014217853546142578
local_in_edges_tensor generation:  0.016214847564697266
mini_batch_src_global generation:  0.034105777740478516
r_  generation:  0.2726783752441406
local_output_nid generation:  0.013190031051635742
local_in_edges_tensor generation:  0.01626133918762207
mini_batch_src_global generation:  0.03383684158325195
r_  generation:  0.267686128616333
local_output_nid generation:  0.013255596160888672
local_in_edges_tensor generation:  0.018337726593017578
mini_batch_src_global generation:  0.03407406806945801
r_  generation:  0.2734260559082031
local_output_nid generation:  0.012948751449584961
local_in_edges_tensor generation:  0.01335597038269043
mini_batch_src_global generation:  0.03328704833984375
r_  generation:  0.26027750968933105
local_output_nid generation:  0.013344049453735352
local_in_edges_tensor generation:  0.01635885238647461
mini_batch_src_global generation:  0.03474545478820801
r_  generation:  0.27080249786376953
local_output_nid generation:  0.013329267501831055
local_in_edges_tensor generation:  0.02105093002319336
mini_batch_src_global generation:  0.03374743461608887
r_  generation:  0.2703423500061035
local_output_nid generation:  0.013250350952148438
local_in_edges_tensor generation:  0.016659021377563477
mini_batch_src_global generation:  0.03432488441467285
r_  generation:  0.2834806442260742
local_output_nid generation:  0.013299942016601562
local_in_edges_tensor generation:  0.015975475311279297
mini_batch_src_global generation:  0.03426313400268555
r_  generation:  0.2762022018432617
local_output_nid generation:  0.013334512710571289
local_in_edges_tensor generation:  0.020986080169677734
mini_batch_src_global generation:  0.03672146797180176
r_  generation:  0.28411388397216797
local_output_nid generation:  0.014396905899047852
local_in_edges_tensor generation:  0.025526046752929688
mini_batch_src_global generation:  0.03581094741821289
r_  generation:  0.2944009304046631
local_output_nid generation:  0.013212919235229492
local_in_edges_tensor generation:  0.018152236938476562
mini_batch_src_global generation:  0.037700653076171875
r_  generation:  0.27521514892578125
local_output_nid generation:  0.015288829803466797
local_in_edges_tensor generation:  0.017829418182373047
mini_batch_src_global generation:  0.03381633758544922
r_  generation:  0.27063941955566406
----------------------check_connections_block total spend ----------------------------- 6.390700101852417
generate_one_block  0.3632321357727051
generate_one_block  0.36635303497314453
generate_one_block  0.3581376075744629
generate_one_block  0.3496978282928467
generate_one_block  0.35617589950561523
generate_one_block  0.3457491397857666
generate_one_block  0.39064669609069824
generate_one_block  0.35398411750793457
generate_one_block  0.38406944274902344
generate_one_block  0.37091898918151855
generate_one_block  0.36341357231140137
generate_one_block  0.3516237735748291
generate_one_block  0.3570222854614258
generate_one_block  0.37343716621398926
generate_one_block  0.34224843978881836
generate_one_block  0.34238243103027344
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04751157760620117
gen group dst list time:  0.07046318054199219
time for parepare:  0.019073009490966797
local_output_nid generation:  0.02772068977355957
local_in_edges_tensor generation:  0.060939788818359375
mini_batch_src_global generation:  0.04999566078186035
r_  generation:  0.5195314884185791
local_output_nid generation:  0.03288006782531738
local_in_edges_tensor generation:  0.05285334587097168
mini_batch_src_global generation:  0.07248663902282715
r_  generation:  0.527554988861084
local_output_nid generation:  0.03273177146911621
local_in_edges_tensor generation:  0.03821301460266113
mini_batch_src_global generation:  0.05811738967895508
r_  generation:  0.5392422676086426
local_output_nid generation:  0.036888837814331055
local_in_edges_tensor generation:  0.04676055908203125
mini_batch_src_global generation:  0.06288814544677734
r_  generation:  0.5505037307739258
local_output_nid generation:  0.0356442928314209
local_in_edges_tensor generation:  0.10222434997558594
mini_batch_src_global generation:  0.06595468521118164
r_  generation:  0.5360896587371826
local_output_nid generation:  0.03267860412597656
local_in_edges_tensor generation:  0.04121279716491699
mini_batch_src_global generation:  0.06059527397155762
r_  generation:  0.537139892578125
local_output_nid generation:  0.032746315002441406
local_in_edges_tensor generation:  0.03775286674499512
mini_batch_src_global generation:  0.06187319755554199
r_  generation:  0.5473568439483643
local_output_nid generation:  0.032286643981933594
local_in_edges_tensor generation:  0.03312945365905762
mini_batch_src_global generation:  0.060895442962646484
r_  generation:  0.5400114059448242
local_output_nid generation:  0.03255939483642578
local_in_edges_tensor generation:  0.04266238212585449
mini_batch_src_global generation:  0.061167001724243164
r_  generation:  0.5457737445831299
local_output_nid generation:  0.0323333740234375
local_in_edges_tensor generation:  0.038562774658203125
mini_batch_src_global generation:  0.06132698059082031
r_  generation:  0.5421617031097412
local_output_nid generation:  0.03383636474609375
local_in_edges_tensor generation:  0.05116081237792969
mini_batch_src_global generation:  0.061998605728149414
r_  generation:  0.5533199310302734
local_output_nid generation:  0.03366851806640625
local_in_edges_tensor generation:  0.044023752212524414
mini_batch_src_global generation:  0.07223749160766602
r_  generation:  0.5482947826385498
local_output_nid generation:  0.03472471237182617
local_in_edges_tensor generation:  0.04012274742126465
mini_batch_src_global generation:  0.06156277656555176
r_  generation:  0.5394999980926514
local_output_nid generation:  0.034018754959106445
local_in_edges_tensor generation:  0.04660224914550781
mini_batch_src_global generation:  0.06190824508666992
r_  generation:  0.5431089401245117
local_output_nid generation:  0.03368401527404785
local_in_edges_tensor generation:  0.03378915786743164
mini_batch_src_global generation:  0.06178426742553711
r_  generation:  0.544713020324707
local_output_nid generation:  0.03354930877685547
local_in_edges_tensor generation:  0.032624006271362305
mini_batch_src_global generation:  0.061774492263793945
r_  generation:  0.5526838302612305
----------------------check_connections_block total spend ----------------------------- 12.886913061141968
generate_one_block  0.6922578811645508
generate_one_block  0.7018156051635742
generate_one_block  0.6814670562744141
generate_one_block  0.6821746826171875
generate_one_block  0.7005136013031006
generate_one_block  0.707310676574707
generate_one_block  0.6825652122497559
generate_one_block  0.6731693744659424
generate_one_block  0.7314624786376953
generate_one_block  0.6961021423339844
generate_one_block  0.6814103126525879
generate_one_block  0.6897432804107666
generate_one_block  0.7240114212036133
generate_one_block  0.7077071666717529
generate_one_block  0.6817612648010254
generate_one_block  0.6761634349822998
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.12830686569213867  GigaBytes
Max Memory Allocated: 0.8710079193115234  GigaBytes

connection checking time:  19.277613162994385
block generation total time  16.87872815132141
average batch blocks generation time:  1.0549205094575882
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10087251663208008  GigaBytes
Max Memory Allocated: 0.8710079193115234  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7814640998840332  GigaBytes
Max Memory Allocated: 0.8710079193115234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09994125366210938  GigaBytes
Max Memory Allocated: 0.8710079193115234  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7817916870117188  GigaBytes
Max Memory Allocated: 0.8710079193115234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09988260269165039  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7739057540893555  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09978294372558594  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7756509780883789  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10086631774902344  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7776098251342773  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09979391098022461  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7746028900146484  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09977054595947266  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7710118293762207  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09941339492797852  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7640533447265625  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09983158111572266  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7760319709777832  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09962272644042969  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.771540641784668  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09967279434204102  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7694802284240723  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09978342056274414  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7702360153198242  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09978199005126953  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7771873474121094  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09995317459106445  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7802338600158691  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09968948364257812  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7677726745605469  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09971857070922852  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.770409107208252  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06769128143787384 |0.017721042037010193 |0.0034851282835006714 |8.825957775115967e-05 |0.0036455094814300537 |0.0018572807312011719 |
----------------------------------------------------------pseudo_mini_loss sum 3.2415785789489746
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5333506
Number of first layer input nodes during this epoch:  2521737
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.12717628479003906  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027616262435913086
random selection method range initialization spend 0.00503993034362793
time for parepare:  0.01802849769592285
local_output_nid generation:  0.0023169517517089844
local_in_edges_tensor generation:  0.0069887638092041016
mini_batch_src_global generation:  0.0018138885498046875
r_  generation:  0.021355390548706055
local_output_nid generation:  0.0030050277709960938
local_in_edges_tensor generation:  0.0017266273498535156
mini_batch_src_global generation:  0.002510547637939453
r_  generation:  0.022964000701904297
local_output_nid generation:  0.003081798553466797
local_in_edges_tensor generation:  0.0017437934875488281
mini_batch_src_global generation:  0.0016543865203857422
r_  generation:  0.020844221115112305
local_output_nid generation:  0.0031201839447021484
local_in_edges_tensor generation:  0.0016829967498779297
mini_batch_src_global generation:  0.001580953598022461
r_  generation:  0.020608901977539062
local_output_nid generation:  0.0029876232147216797
local_in_edges_tensor generation:  0.001707315444946289
mini_batch_src_global generation:  0.0016918182373046875
r_  generation:  0.021425247192382812
local_output_nid generation:  0.003033161163330078
local_in_edges_tensor generation:  0.00176239013671875
mini_batch_src_global generation:  0.001659393310546875
r_  generation:  0.02129340171813965
local_output_nid generation:  0.0031206607818603516
local_in_edges_tensor generation:  0.001733541488647461
mini_batch_src_global generation:  0.0017147064208984375
r_  generation:  0.021764755249023438
local_output_nid generation:  0.003014087677001953
local_in_edges_tensor generation:  0.0016396045684814453
mini_batch_src_global generation:  0.0017113685607910156
r_  generation:  0.023499250411987305
local_output_nid generation:  0.003010988235473633
local_in_edges_tensor generation:  0.00176239013671875
mini_batch_src_global generation:  0.0017516613006591797
r_  generation:  0.022054672241210938
local_output_nid generation:  0.003094911575317383
local_in_edges_tensor generation:  0.001705169677734375
mini_batch_src_global generation:  0.0017788410186767578
r_  generation:  0.022662639617919922
local_output_nid generation:  0.0030121803283691406
local_in_edges_tensor generation:  0.0017180442810058594
mini_batch_src_global generation:  0.001768350601196289
r_  generation:  0.022104501724243164
local_output_nid generation:  0.003038644790649414
local_in_edges_tensor generation:  0.0016994476318359375
mini_batch_src_global generation:  0.0017123222351074219
r_  generation:  0.02192544937133789
local_output_nid generation:  0.003012418746948242
local_in_edges_tensor generation:  0.0017461776733398438
mini_batch_src_global generation:  0.0017147064208984375
r_  generation:  0.02157306671142578
local_output_nid generation:  0.002987384796142578
local_in_edges_tensor generation:  0.0017004013061523438
mini_batch_src_global generation:  0.0016674995422363281
r_  generation:  0.023212432861328125
local_output_nid generation:  0.0030705928802490234
local_in_edges_tensor generation:  0.0016772747039794922
mini_batch_src_global generation:  0.0017535686492919922
r_  generation:  0.022811412811279297
local_output_nid generation:  0.003087282180786133
local_in_edges_tensor generation:  0.0016970634460449219
mini_batch_src_global generation:  0.0017933845520019531
r_  generation:  0.022649288177490234
----------------------check_connections_block total spend ----------------------------- 0.5692408084869385
generate_one_block  0.036124467849731445
generate_one_block  0.03159832954406738
generate_one_block  0.030886173248291016
generate_one_block  0.03045177459716797
generate_one_block  0.030779123306274414
generate_one_block  0.03325915336608887
generate_one_block  0.03107619285583496
generate_one_block  0.03275132179260254
generate_one_block  0.03132343292236328
generate_one_block  0.03177666664123535
generate_one_block  0.030914783477783203
generate_one_block  0.03136420249938965
generate_one_block  0.030491352081298828
generate_one_block  0.031201601028442383
generate_one_block  0.03240633010864258
generate_one_block  0.03177499771118164
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.037906646728515625
gen group dst list time:  0.02088642120361328
time for parepare:  0.02093505859375
local_output_nid generation:  0.009411334991455078
local_in_edges_tensor generation:  0.04501461982727051
mini_batch_src_global generation:  0.026891708374023438
r_  generation:  0.25151824951171875
local_output_nid generation:  0.014480352401733398
local_in_edges_tensor generation:  0.02144789695739746
mini_batch_src_global generation:  0.03358197212219238
r_  generation:  0.263904333114624
local_output_nid generation:  0.013053178787231445
local_in_edges_tensor generation:  0.01819300651550293
mini_batch_src_global generation:  0.03164052963256836
r_  generation:  0.27045249938964844
local_output_nid generation:  0.013477802276611328
local_in_edges_tensor generation:  0.01661515235900879
mini_batch_src_global generation:  0.03358125686645508
r_  generation:  0.27535176277160645
local_output_nid generation:  0.016039133071899414
local_in_edges_tensor generation:  0.015454292297363281
mini_batch_src_global generation:  0.034117698669433594
r_  generation:  0.2657608985900879
local_output_nid generation:  0.01422572135925293
local_in_edges_tensor generation:  0.014068126678466797
mini_batch_src_global generation:  0.03335881233215332
r_  generation:  0.26941728591918945
local_output_nid generation:  0.014099836349487305
local_in_edges_tensor generation:  0.015316247940063477
mini_batch_src_global generation:  0.03485679626464844
r_  generation:  0.27015161514282227
local_output_nid generation:  0.013783454895019531
local_in_edges_tensor generation:  0.014327049255371094
mini_batch_src_global generation:  0.03420305252075195
r_  generation:  0.2706451416015625
local_output_nid generation:  0.014068841934204102
local_in_edges_tensor generation:  0.01756596565246582
mini_batch_src_global generation:  0.03565192222595215
r_  generation:  0.27147364616394043
local_output_nid generation:  0.013271808624267578
local_in_edges_tensor generation:  0.014078617095947266
mini_batch_src_global generation:  0.03484344482421875
r_  generation:  0.27472758293151855
local_output_nid generation:  0.013134956359863281
local_in_edges_tensor generation:  0.015292167663574219
mini_batch_src_global generation:  0.03516507148742676
r_  generation:  0.28812599182128906
local_output_nid generation:  0.013325929641723633
local_in_edges_tensor generation:  0.014021158218383789
mini_batch_src_global generation:  0.03450465202331543
r_  generation:  0.275545597076416
local_output_nid generation:  0.013055562973022461
local_in_edges_tensor generation:  0.016338586807250977
mini_batch_src_global generation:  0.03421759605407715
r_  generation:  0.2709023952484131
local_output_nid generation:  0.014182090759277344
local_in_edges_tensor generation:  0.017999649047851562
mini_batch_src_global generation:  0.033628225326538086
r_  generation:  0.2714664936065674
local_output_nid generation:  0.013753175735473633
local_in_edges_tensor generation:  0.01658487319946289
mini_batch_src_global generation:  0.036293983459472656
r_  generation:  0.28166699409484863
local_output_nid generation:  0.013368368148803711
local_in_edges_tensor generation:  0.01646900177001953
mini_batch_src_global generation:  0.035123586654663086
r_  generation:  0.27559709548950195
----------------------check_connections_block total spend ----------------------------- 6.33892560005188
generate_one_block  0.3617408275604248
generate_one_block  0.3536345958709717
generate_one_block  0.3519601821899414
generate_one_block  0.3414642810821533
generate_one_block  0.34276509284973145
generate_one_block  0.3475828170776367
generate_one_block  0.3798344135284424
generate_one_block  0.35350704193115234
generate_one_block  0.35342907905578613
generate_one_block  0.36839985847473145
generate_one_block  0.35153627395629883
generate_one_block  0.3612821102142334
generate_one_block  0.3462517261505127
generate_one_block  0.343217134475708
generate_one_block  0.3829972743988037
generate_one_block  0.3587024211883545
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.041364192962646484
gen group dst list time:  0.06905007362365723
time for parepare:  0.019425630569458008
local_output_nid generation:  0.02761220932006836
local_in_edges_tensor generation:  0.0607762336730957
mini_batch_src_global generation:  0.05118298530578613
r_  generation:  0.5202248096466064
local_output_nid generation:  0.03241777420043945
local_in_edges_tensor generation:  0.04800868034362793
mini_batch_src_global generation:  0.06369686126708984
r_  generation:  0.5197889804840088
local_output_nid generation:  0.03399085998535156
local_in_edges_tensor generation:  0.04430246353149414
mini_batch_src_global generation:  0.059812307357788086
r_  generation:  0.5339457988739014
local_output_nid generation:  0.03298234939575195
local_in_edges_tensor generation:  0.03946423530578613
mini_batch_src_global generation:  0.05993151664733887
r_  generation:  0.5311872959136963
local_output_nid generation:  0.03221631050109863
local_in_edges_tensor generation:  0.08220076560974121
mini_batch_src_global generation:  0.062403202056884766
r_  generation:  0.5347461700439453
local_output_nid generation:  0.03283190727233887
local_in_edges_tensor generation:  0.036752939224243164
mini_batch_src_global generation:  0.07011198997497559
r_  generation:  0.5427825450897217
local_output_nid generation:  0.03507542610168457
local_in_edges_tensor generation:  0.03243660926818848
mini_batch_src_global generation:  0.06545519828796387
r_  generation:  0.5385172367095947
local_output_nid generation:  0.03357505798339844
local_in_edges_tensor generation:  0.03446030616760254
mini_batch_src_global generation:  0.06186938285827637
r_  generation:  0.5352697372436523
local_output_nid generation:  0.03346753120422363
local_in_edges_tensor generation:  0.03625011444091797
mini_batch_src_global generation:  0.06189131736755371
r_  generation:  0.5411849021911621
local_output_nid generation:  0.03357052803039551
local_in_edges_tensor generation:  0.03390383720397949
mini_batch_src_global generation:  0.06149554252624512
r_  generation:  0.5408830642700195
local_output_nid generation:  0.0334935188293457
local_in_edges_tensor generation:  0.03193807601928711
mini_batch_src_global generation:  0.061768293380737305
r_  generation:  0.5484805107116699
local_output_nid generation:  0.033425092697143555
local_in_edges_tensor generation:  0.03153562545776367
mini_batch_src_global generation:  0.06179666519165039
r_  generation:  0.5418901443481445
local_output_nid generation:  0.03334951400756836
local_in_edges_tensor generation:  0.03175830841064453
mini_batch_src_global generation:  0.061243295669555664
r_  generation:  0.5374789237976074
local_output_nid generation:  0.033576011657714844
local_in_edges_tensor generation:  0.03368186950683594
mini_batch_src_global generation:  0.06448054313659668
r_  generation:  0.5437099933624268
local_output_nid generation:  0.03365683555603027
local_in_edges_tensor generation:  0.04414105415344238
mini_batch_src_global generation:  0.06505250930786133
r_  generation:  0.5403215885162354
local_output_nid generation:  0.0348052978515625
local_in_edges_tensor generation:  0.039259910583496094
mini_batch_src_global generation:  0.06233978271484375
r_  generation:  0.5440242290496826
----------------------check_connections_block total spend ----------------------------- 12.682141542434692
generate_one_block  0.6841135025024414
generate_one_block  0.6774742603302002
generate_one_block  0.6872868537902832
generate_one_block  0.6709511280059814
generate_one_block  0.6824731826782227
generate_one_block  0.7005553245544434
generate_one_block  0.6959893703460693
generate_one_block  0.6783466339111328
generate_one_block  0.7481310367584229
generate_one_block  0.6948492527008057
generate_one_block  0.6882145404815674
generate_one_block  0.6744735240936279
generate_one_block  0.6755232810974121
generate_one_block  0.6806955337524414
generate_one_block  0.7108399868011475
generate_one_block  0.6832172870635986
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.12717628479003906  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

connection checking time:  19.021067142486572
block generation total time  16.73143982887268
average batch blocks generation time:  1.0457149893045425
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09962844848632812  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.770258903503418  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09986257553100586  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7768378257751465  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09970569610595703  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.770782470703125  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09968090057373047  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7698278427124023  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09962224960327148  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7704172134399414  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.0996699333190918  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7700138092041016  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10078144073486328  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7763047218322754  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09983015060424805  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7714090347290039  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09981155395507812  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7757916450500488  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09987831115722656  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.781224250793457  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09973669052124023  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7705540657043457  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09975147247314453  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7702550888061523  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09950017929077148  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.765648365020752  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.0996999740600586  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7681584358215332  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10096359252929688  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7830314636230469  GigaBytes
Max Memory Allocated: 0.8710308074951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09988021850585938  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7727823257446289  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06146569550037384 |0.017618298530578613 |0.0038826167583465576 |9.731948375701904e-05 |0.002940654754638672 |0.0033795833587646484 |
----------------------------------------------------------pseudo_mini_loss sum 2.5985755920410156
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  5329967
Number of first layer input nodes during this epoch:  2521490
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.1286301612854004  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022782087326049805
random selection method range initialization spend 0.0050280094146728516
time for parepare:  0.01684093475341797
local_output_nid generation:  0.0023283958435058594
local_in_edges_tensor generation:  0.004595518112182617
mini_batch_src_global generation:  0.001798391342163086
r_  generation:  0.020740509033203125
local_output_nid generation:  0.0028471946716308594
local_in_edges_tensor generation:  0.0016603469848632812
mini_batch_src_global generation:  0.002207040786743164
r_  generation:  0.022130727767944336
local_output_nid generation:  0.0029325485229492188
local_in_edges_tensor generation:  0.001680612564086914
mini_batch_src_global generation:  0.0017414093017578125
r_  generation:  0.02191758155822754
local_output_nid generation:  0.0029697418212890625
local_in_edges_tensor generation:  0.0016856193542480469
mini_batch_src_global generation:  0.0017113685607910156
r_  generation:  0.02133655548095703
local_output_nid generation:  0.0029592514038085938
local_in_edges_tensor generation:  0.0016236305236816406
mini_batch_src_global generation:  0.001705169677734375
r_  generation:  0.021088600158691406
local_output_nid generation:  0.0029802322387695312
local_in_edges_tensor generation:  0.0016207695007324219
mini_batch_src_global generation:  0.001703023910522461
r_  generation:  0.021330595016479492
local_output_nid generation:  0.0029702186584472656
local_in_edges_tensor generation:  0.0015592575073242188
mini_batch_src_global generation:  0.0017170906066894531
r_  generation:  0.021795034408569336
local_output_nid generation:  0.0030868053436279297
local_in_edges_tensor generation:  0.0015785694122314453
mini_batch_src_global generation:  0.0017390251159667969
r_  generation:  0.021916866302490234
local_output_nid generation:  0.0030400753021240234
local_in_edges_tensor generation:  0.0015439987182617188
mini_batch_src_global generation:  0.0017735958099365234
r_  generation:  0.022238731384277344
local_output_nid generation:  0.003166675567626953
local_in_edges_tensor generation:  0.0020875930786132812
mini_batch_src_global generation:  0.0017826557159423828
r_  generation:  0.021950244903564453
local_output_nid generation:  0.00299072265625
local_in_edges_tensor generation:  0.0015788078308105469
mini_batch_src_global generation:  0.001783132553100586
r_  generation:  0.02239823341369629
local_output_nid generation:  0.003064870834350586
local_in_edges_tensor generation:  0.0015377998352050781
mini_batch_src_global generation:  0.0017917156219482422
r_  generation:  0.021805763244628906
local_output_nid generation:  0.0031213760375976562
local_in_edges_tensor generation:  0.0015697479248046875
mini_batch_src_global generation:  0.0017354488372802734
r_  generation:  0.021985769271850586
local_output_nid generation:  0.003005504608154297
local_in_edges_tensor generation:  0.0015571117401123047
mini_batch_src_global generation:  0.0017666816711425781
r_  generation:  0.022055625915527344
local_output_nid generation:  0.0029990673065185547
local_in_edges_tensor generation:  0.001604318618774414
mini_batch_src_global generation:  0.0017809867858886719
r_  generation:  0.022057294845581055
local_output_nid generation:  0.00305938720703125
local_in_edges_tensor generation:  0.0016078948974609375
mini_batch_src_global generation:  0.001819610595703125
r_  generation:  0.022680997848510742
----------------------check_connections_block total spend ----------------------------- 0.5609612464904785
generate_one_block  0.037996768951416016
generate_one_block  0.031995534896850586
generate_one_block  0.03203940391540527
generate_one_block  0.030910015106201172
generate_one_block  0.030626535415649414
generate_one_block  0.03386664390563965
generate_one_block  0.03142070770263672
generate_one_block  0.031105995178222656
generate_one_block  0.03140115737915039
generate_one_block  0.031192302703857422
generate_one_block  0.031804561614990234
generate_one_block  0.031049251556396484
generate_one_block  0.030940532684326172
generate_one_block  0.031170368194580078
generate_one_block  0.031166791915893555
generate_one_block  0.03218841552734375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03479599952697754
gen group dst list time:  0.018215656280517578
time for parepare:  0.01937413215637207
local_output_nid generation:  0.009034156799316406
local_in_edges_tensor generation:  0.020860910415649414
mini_batch_src_global generation:  0.027933359146118164
r_  generation:  0.2541835308074951
local_output_nid generation:  0.013235807418823242
local_in_edges_tensor generation:  0.018515348434448242
mini_batch_src_global generation:  0.03233194351196289
r_  generation:  0.26435303688049316
local_output_nid generation:  0.014799833297729492
local_in_edges_tensor generation:  0.01842021942138672
mini_batch_src_global generation:  0.031882286071777344
r_  generation:  0.2798142433166504
local_output_nid generation:  0.013972043991088867
local_in_edges_tensor generation:  0.01890277862548828
mini_batch_src_global generation:  0.03532290458679199
r_  generation:  0.272660493850708
local_output_nid generation:  0.013861656188964844
local_in_edges_tensor generation:  0.020843029022216797
mini_batch_src_global generation:  0.03462934494018555
r_  generation:  0.27434825897216797
local_output_nid generation:  0.017631053924560547
local_in_edges_tensor generation:  0.017838239669799805
mini_batch_src_global generation:  0.03632044792175293
r_  generation:  0.27630043029785156
local_output_nid generation:  0.015218496322631836
local_in_edges_tensor generation:  0.015367984771728516
mini_batch_src_global generation:  0.034337520599365234
r_  generation:  0.2709989547729492
local_output_nid generation:  0.014422893524169922
local_in_edges_tensor generation:  0.017142772674560547
mini_batch_src_global generation:  0.03426551818847656
r_  generation:  0.2820005416870117
local_output_nid generation:  0.014798402786254883
local_in_edges_tensor generation:  0.01622319221496582
mini_batch_src_global generation:  0.0358881950378418
r_  generation:  0.2743809223175049
local_output_nid generation:  0.013832569122314453
local_in_edges_tensor generation:  0.016859054565429688
mini_batch_src_global generation:  0.036273956298828125
r_  generation:  0.272505521774292
local_output_nid generation:  0.014541149139404297
local_in_edges_tensor generation:  0.016815662384033203
mini_batch_src_global generation:  0.03911447525024414
r_  generation:  0.2786393165588379
local_output_nid generation:  0.013421773910522461
local_in_edges_tensor generation:  0.017334938049316406
mini_batch_src_global generation:  0.04557061195373535
r_  generation:  0.26944494247436523
local_output_nid generation:  0.013201713562011719
local_in_edges_tensor generation:  0.016809463500976562
mini_batch_src_global generation:  0.03655576705932617
r_  generation:  0.26987481117248535
local_output_nid generation:  0.013176918029785156
local_in_edges_tensor generation:  0.015291452407836914
mini_batch_src_global generation:  0.03397488594055176
r_  generation:  0.2663452625274658
local_output_nid generation:  0.013212919235229492
local_in_edges_tensor generation:  0.015431642532348633
mini_batch_src_global generation:  0.03740739822387695
r_  generation:  0.271686315536499
local_output_nid generation:  0.013535022735595703
local_in_edges_tensor generation:  0.02113056182861328
mini_batch_src_global generation:  0.03635096549987793
r_  generation:  0.2746086120605469
----------------------check_connections_block total spend ----------------------------- 6.382714033126831
generate_one_block  0.36274147033691406
generate_one_block  0.3488740921020508
generate_one_block  0.3588144779205322
generate_one_block  0.3500196933746338
generate_one_block  0.3473634719848633
generate_one_block  0.3523108959197998
generate_one_block  0.3869438171386719
generate_one_block  0.35268402099609375
generate_one_block  0.3626117706298828
generate_one_block  0.3544039726257324
generate_one_block  0.36473917961120605
generate_one_block  0.34400343894958496
generate_one_block  0.34415435791015625
generate_one_block  0.3423137664794922
generate_one_block  0.3522951602935791
generate_one_block  0.3612854480743408
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05451059341430664
gen group dst list time:  0.06656956672668457
time for parepare:  0.020503759384155273
local_output_nid generation:  0.028270244598388672
local_in_edges_tensor generation:  0.056977272033691406
mini_batch_src_global generation:  0.049993276596069336
r_  generation:  0.5150277614593506
local_output_nid generation:  0.03332161903381348
local_in_edges_tensor generation:  0.04752779006958008
mini_batch_src_global generation:  0.06230020523071289
r_  generation:  0.5366480350494385
local_output_nid generation:  0.03387737274169922
local_in_edges_tensor generation:  0.036688804626464844
mini_batch_src_global generation:  0.07987380027770996
r_  generation:  0.5370304584503174
local_output_nid generation:  0.03396892547607422
local_in_edges_tensor generation:  0.04019021987915039
mini_batch_src_global generation:  0.059354305267333984
r_  generation:  0.5323290824890137
local_output_nid generation:  0.033516883850097656
local_in_edges_tensor generation:  0.0864107608795166
mini_batch_src_global generation:  0.05969500541687012
r_  generation:  0.5384542942047119
local_output_nid generation:  0.032997846603393555
local_in_edges_tensor generation:  0.03245067596435547
mini_batch_src_global generation:  0.061466217041015625
r_  generation:  0.5517230033874512
local_output_nid generation:  0.032849788665771484
local_in_edges_tensor generation:  0.032088279724121094
mini_batch_src_global generation:  0.06386017799377441
r_  generation:  0.5417201519012451
local_output_nid generation:  0.03288459777832031
local_in_edges_tensor generation:  0.03748917579650879
mini_batch_src_global generation:  0.0611262321472168
r_  generation:  0.537421464920044
local_output_nid generation:  0.03252077102661133
local_in_edges_tensor generation:  0.032557010650634766
mini_batch_src_global generation:  0.06129336357116699
r_  generation:  0.5435521602630615
local_output_nid generation:  0.03373241424560547
local_in_edges_tensor generation:  0.032773494720458984
mini_batch_src_global generation:  0.06204080581665039
r_  generation:  0.5384366512298584
local_output_nid generation:  0.03278946876525879
local_in_edges_tensor generation:  0.03469252586364746
mini_batch_src_global generation:  0.06449031829833984
r_  generation:  0.542881965637207
local_output_nid generation:  0.032836198806762695
local_in_edges_tensor generation:  0.037641286849975586
mini_batch_src_global generation:  0.06241655349731445
r_  generation:  0.5429806709289551
local_output_nid generation:  0.032860755920410156
local_in_edges_tensor generation:  0.0318751335144043
mini_batch_src_global generation:  0.062326908111572266
r_  generation:  0.5443606376647949
local_output_nid generation:  0.033011674880981445
local_in_edges_tensor generation:  0.0326533317565918
mini_batch_src_global generation:  0.0650482177734375
r_  generation:  0.5427839756011963
local_output_nid generation:  0.0336453914642334
local_in_edges_tensor generation:  0.04087948799133301
mini_batch_src_global generation:  0.06220412254333496
r_  generation:  0.5412571430206299
local_output_nid generation:  0.03294777870178223
local_in_edges_tensor generation:  0.032800912857055664
mini_batch_src_global generation:  0.06225180625915527
r_  generation:  0.5401997566223145
----------------------check_connections_block total spend ----------------------------- 12.716917753219604
generate_one_block  0.6863691806793213
generate_one_block  0.6769201755523682
generate_one_block  0.6802482604980469
generate_one_block  0.6828932762145996
generate_one_block  0.6888635158538818
generate_one_block  0.687143087387085
generate_one_block  0.6842637062072754
generate_one_block  0.6797261238098145
generate_one_block  0.7224860191345215
generate_one_block  0.6803696155548096
generate_one_block  0.6907236576080322
generate_one_block  0.6766555309295654
generate_one_block  0.6795856952667236
generate_one_block  0.6810126304626465
generate_one_block  0.69051194190979
generate_one_block  0.6819901466369629
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.1286301612854004  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

connection checking time:  19.099631786346436
block generation total time  16.65532159805298
average batch blocks generation time:  1.0409575998783112
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09973573684692383  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7707653045654297  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09977102279663086  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7730236053466797  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09990453720092773  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7815470695495605  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.0996856689453125  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7710385322570801  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10075569152832031  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7706241607666016  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09982442855834961  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7717742919921875  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09977865219116211  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7708325386047363  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09986066818237305  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7744650840759277  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09980964660644531  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7724566459655762  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09974145889282227  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7725324630737305  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09997797012329102  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7808704376220703  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09955978393554688  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7695817947387695  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09958553314208984  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7668695449829102  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09977388381958008  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7735371589660645  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09976482391357422  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7743616104125977  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09981155395507812  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7768006324768066  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06426034867763519 |0.016788750886917114 |0.003655746579170227 |9.676814079284668e-05 |0.003312721848487854 |0.002862215042114258 |
----------------------------------------------------------pseudo_mini_loss sum 2.350083589553833
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  5330360
Number of first layer input nodes during this epoch:  2521524
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.12857294082641602  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026627779006958008
random selection method range initialization spend 0.005108356475830078
time for parepare:  0.01997661590576172
local_output_nid generation:  0.0022745132446289062
local_in_edges_tensor generation:  0.007980108261108398
mini_batch_src_global generation:  0.002426624298095703
r_  generation:  0.021848201751708984
local_output_nid generation:  0.003014087677001953
local_in_edges_tensor generation:  0.0019278526306152344
mini_batch_src_global generation:  0.002544403076171875
r_  generation:  0.023107290267944336
local_output_nid generation:  0.0030508041381835938
local_in_edges_tensor generation:  0.001680612564086914
mini_batch_src_global generation:  0.0019066333770751953
r_  generation:  0.03515625
local_output_nid generation:  0.005147457122802734
local_in_edges_tensor generation:  0.002460479736328125
mini_batch_src_global generation:  0.0020606517791748047
r_  generation:  0.022705078125
local_output_nid generation:  0.0047075748443603516
local_in_edges_tensor generation:  0.002259492874145508
mini_batch_src_global generation:  0.0019507408142089844
r_  generation:  0.021795988082885742
local_output_nid generation:  0.004391670227050781
local_in_edges_tensor generation:  0.0021390914916992188
mini_batch_src_global generation:  0.0018603801727294922
r_  generation:  0.022096633911132812
local_output_nid generation:  0.006457328796386719
local_in_edges_tensor generation:  0.0026407241821289062
mini_batch_src_global generation:  0.006552934646606445
r_  generation:  0.02477860450744629
local_output_nid generation:  0.0038204193115234375
local_in_edges_tensor generation:  0.0018575191497802734
mini_batch_src_global generation:  0.013834953308105469
r_  generation:  0.025783538818359375
local_output_nid generation:  0.006017923355102539
local_in_edges_tensor generation:  0.0025022029876708984
mini_batch_src_global generation:  0.015849828720092773
r_  generation:  0.02383279800415039
local_output_nid generation:  0.003650665283203125
local_in_edges_tensor generation:  0.0017061233520507812
mini_batch_src_global generation:  0.008945465087890625
r_  generation:  0.027187824249267578
local_output_nid generation:  0.0046405792236328125
local_in_edges_tensor generation:  0.0020532608032226562
mini_batch_src_global generation:  0.0018863677978515625
r_  generation:  0.022690296173095703
local_output_nid generation:  0.0044858455657958984
local_in_edges_tensor generation:  0.002081155776977539
mini_batch_src_global generation:  0.001920461654663086
r_  generation:  0.022861957550048828
local_output_nid generation:  0.004368782043457031
local_in_edges_tensor generation:  0.001983642578125
mini_batch_src_global generation:  0.0018544197082519531
r_  generation:  0.02249765396118164
local_output_nid generation:  0.004433155059814453
local_in_edges_tensor generation:  0.002074003219604492
mini_batch_src_global generation:  0.0018892288208007812
r_  generation:  0.02256631851196289
local_output_nid generation:  0.004312992095947266
local_in_edges_tensor generation:  0.002026081085205078
mini_batch_src_global generation:  0.0018718242645263672
r_  generation:  0.0224459171295166
local_output_nid generation:  0.004440784454345703
local_in_edges_tensor generation:  0.002155780792236328
mini_batch_src_global generation:  0.0018486976623535156
r_  generation:  0.022621631622314453
----------------------check_connections_block total spend ----------------------------- 0.6966121196746826
generate_one_block  0.033713340759277344
generate_one_block  0.03203463554382324
generate_one_block  0.032799720764160156
generate_one_block  0.03192782402038574
generate_one_block  0.030817270278930664
generate_one_block  0.04922342300415039
generate_one_block  0.04087376594543457
generate_one_block  0.044487714767456055
generate_one_block  0.03466176986694336
generate_one_block  0.03148293495178223
generate_one_block  0.04574942588806152
generate_one_block  0.04132533073425293
generate_one_block  0.03151082992553711
generate_one_block  0.03108525276184082
generate_one_block  0.031116724014282227
generate_one_block  0.03198432922363281
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03859663009643555
gen group dst list time:  0.01840043067932129
time for parepare:  0.019147396087646484
local_output_nid generation:  0.009432315826416016
local_in_edges_tensor generation:  0.021472454071044922
mini_batch_src_global generation:  0.026912212371826172
r_  generation:  0.252377986907959
local_output_nid generation:  0.015343189239501953
local_in_edges_tensor generation:  0.018999576568603516
mini_batch_src_global generation:  0.0329434871673584
r_  generation:  0.25996947288513184
local_output_nid generation:  0.012960195541381836
local_in_edges_tensor generation:  0.015103340148925781
mini_batch_src_global generation:  0.03368210792541504
r_  generation:  0.2649049758911133
local_output_nid generation:  0.014810800552368164
local_in_edges_tensor generation:  0.01616525650024414
mini_batch_src_global generation:  0.03260660171508789
r_  generation:  0.27220630645751953
local_output_nid generation:  0.013953685760498047
local_in_edges_tensor generation:  0.016877174377441406
mini_batch_src_global generation:  0.03608393669128418
r_  generation:  0.2730557918548584
local_output_nid generation:  0.014790058135986328
local_in_edges_tensor generation:  0.020509958267211914
mini_batch_src_global generation:  0.03391695022583008
r_  generation:  0.272796630859375
local_output_nid generation:  0.014186859130859375
local_in_edges_tensor generation:  0.01929163932800293
mini_batch_src_global generation:  0.036325931549072266
r_  generation:  0.28188514709472656
local_output_nid generation:  0.014047861099243164
local_in_edges_tensor generation:  0.02279043197631836
mini_batch_src_global generation:  0.034508705139160156
r_  generation:  0.28780364990234375
local_output_nid generation:  0.01638054847717285
local_in_edges_tensor generation:  0.014280319213867188
mini_batch_src_global generation:  0.03611946105957031
r_  generation:  0.27464866638183594
local_output_nid generation:  0.014340400695800781
local_in_edges_tensor generation:  0.015305519104003906
mini_batch_src_global generation:  0.03782534599304199
r_  generation:  0.28755807876586914
local_output_nid generation:  0.013883829116821289
local_in_edges_tensor generation:  0.014454841613769531
mini_batch_src_global generation:  0.03476381301879883
r_  generation:  0.2712578773498535
local_output_nid generation:  0.01395416259765625
local_in_edges_tensor generation:  0.014945745468139648
mini_batch_src_global generation:  0.034569501876831055
r_  generation:  0.2738070487976074
local_output_nid generation:  0.013407468795776367
local_in_edges_tensor generation:  0.013717889785766602
mini_batch_src_global generation:  0.03416156768798828
r_  generation:  0.26827025413513184
local_output_nid generation:  0.013361215591430664
local_in_edges_tensor generation:  0.014780759811401367
mini_batch_src_global generation:  0.034716129302978516
r_  generation:  0.2723369598388672
local_output_nid generation:  0.013418912887573242
local_in_edges_tensor generation:  0.015198707580566406
mini_batch_src_global generation:  0.03429698944091797
r_  generation:  0.27400636672973633
local_output_nid generation:  0.013686895370483398
local_in_edges_tensor generation:  0.014912843704223633
mini_batch_src_global generation:  0.034934043884277344
r_  generation:  0.27436256408691406
----------------------check_connections_block total spend ----------------------------- 6.353265285491943
generate_one_block  0.3661468029022217
generate_one_block  0.3534395694732666
generate_one_block  0.35392069816589355
generate_one_block  0.3581657409667969
generate_one_block  0.34856224060058594
generate_one_block  0.3540794849395752
generate_one_block  0.3947947025299072
generate_one_block  0.36360764503479004
generate_one_block  0.35989880561828613
generate_one_block  0.3564584255218506
generate_one_block  0.3585982322692871
generate_one_block  0.35440492630004883
generate_one_block  0.35479235649108887
generate_one_block  0.36745643615722656
generate_one_block  0.34961795806884766
generate_one_block  0.35575270652770996
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04508805274963379
gen group dst list time:  0.07207918167114258
time for parepare:  0.01811385154724121
local_output_nid generation:  0.027861595153808594
local_in_edges_tensor generation:  0.056273460388183594
mini_batch_src_global generation:  0.05278325080871582
r_  generation:  0.5305793285369873
local_output_nid generation:  0.03476452827453613
local_in_edges_tensor generation:  0.04406166076660156
mini_batch_src_global generation:  0.06338310241699219
r_  generation:  0.533653736114502
local_output_nid generation:  0.033594369888305664
local_in_edges_tensor generation:  0.03732013702392578
mini_batch_src_global generation:  0.06531095504760742
r_  generation:  0.541766881942749
local_output_nid generation:  0.033159494400024414
local_in_edges_tensor generation:  0.033713340759277344
mini_batch_src_global generation:  0.06099987030029297
r_  generation:  0.5356552600860596
local_output_nid generation:  0.0363163948059082
local_in_edges_tensor generation:  0.09026145935058594
mini_batch_src_global generation:  0.06316161155700684
r_  generation:  0.5444416999816895
local_output_nid generation:  0.032836198806762695
local_in_edges_tensor generation:  0.03464174270629883
mini_batch_src_global generation:  0.06250953674316406
r_  generation:  0.5360784530639648
local_output_nid generation:  0.0347287654876709
local_in_edges_tensor generation:  0.03746676445007324
mini_batch_src_global generation:  0.06148886680603027
r_  generation:  0.5602495670318604
local_output_nid generation:  0.03667402267456055
local_in_edges_tensor generation:  0.035584449768066406
mini_batch_src_global generation:  0.06705975532531738
r_  generation:  0.5380213260650635
local_output_nid generation:  0.03375124931335449
local_in_edges_tensor generation:  0.03492116928100586
mini_batch_src_global generation:  0.06187081336975098
r_  generation:  0.541736364364624
local_output_nid generation:  0.03395891189575195
local_in_edges_tensor generation:  0.03547263145446777
mini_batch_src_global generation:  0.062455177307128906
r_  generation:  0.5386312007904053
local_output_nid generation:  0.03381776809692383
local_in_edges_tensor generation:  0.03702712059020996
mini_batch_src_global generation:  0.06204962730407715
r_  generation:  0.5424225330352783
local_output_nid generation:  0.033661842346191406
local_in_edges_tensor generation:  0.03289437294006348
mini_batch_src_global generation:  0.06277918815612793
r_  generation:  0.5542953014373779
local_output_nid generation:  0.03390312194824219
local_in_edges_tensor generation:  0.03453826904296875
mini_batch_src_global generation:  0.06182575225830078
r_  generation:  0.5464053153991699
local_output_nid generation:  0.03377223014831543
local_in_edges_tensor generation:  0.039934396743774414
mini_batch_src_global generation:  0.06312942504882812
r_  generation:  0.5406091213226318
local_output_nid generation:  0.03406786918640137
local_in_edges_tensor generation:  0.03502035140991211
mini_batch_src_global generation:  0.06158709526062012
r_  generation:  0.5427258014678955
local_output_nid generation:  0.033772945404052734
local_in_edges_tensor generation:  0.0368647575378418
mini_batch_src_global generation:  0.06398320198059082
r_  generation:  0.5448956489562988
----------------------check_connections_block total spend ----------------------------- 12.771408557891846
generate_one_block  0.6871979236602783
generate_one_block  0.6817491054534912
generate_one_block  0.6883301734924316
generate_one_block  0.6830248832702637
generate_one_block  0.6835412979125977
generate_one_block  0.675926685333252
generate_one_block  0.6891679763793945
generate_one_block  0.6942079067230225
generate_one_block  0.7645611763000488
generate_one_block  0.6937987804412842
generate_one_block  0.6875565052032471
generate_one_block  0.6811871528625488
generate_one_block  0.6878829002380371
generate_one_block  0.6953704357147217
generate_one_block  0.6827974319458008
generate_one_block  0.6857008934020996
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.12857294082641602  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

connection checking time:  19.12467384338379
block generation total time  16.811697959899902
average batch blocks generation time:  1.050731122493744
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09978961944580078  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7727079391479492  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09969139099121094  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7717385292053223  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09975337982177734  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7741298675537109  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.0997915267944336  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.77716064453125  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.1006631851196289  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7744154930114746  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09949588775634766  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7663025856018066  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09988594055175781  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7805767059326172  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09977293014526367  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7720022201538086  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09970808029174805  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.771456241607666  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.0997319221496582  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7715334892272949  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10078907012939453  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7774624824523926  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09960556030273438  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7676200866699219  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09960746765136719  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7682833671569824  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.0998992919921875  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7754521369934082  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.100738525390625  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7765107154846191  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09990739822387695  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7798781394958496  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06144021451473236 |0.017767921090126038 |0.0037008970975875854 |9.627640247344971e-05 |0.003260686993598938 |0.0015149116516113281 |
----------------------------------------------------------pseudo_mini_loss sum 2.1049580574035645
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  5330653
Number of first layer input nodes during this epoch:  2521259
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.12861967086791992  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02880239486694336
random selection method range initialization spend 0.006822347640991211
time for parepare:  0.018584489822387695
local_output_nid generation:  0.0022928714752197266
local_in_edges_tensor generation:  0.008065462112426758
mini_batch_src_global generation:  0.003310680389404297
r_  generation:  0.028196096420288086
local_output_nid generation:  0.003551959991455078
local_in_edges_tensor generation:  0.00191497802734375
mini_batch_src_global generation:  0.003046751022338867
r_  generation:  0.024084806442260742
local_output_nid generation:  0.0031790733337402344
local_in_edges_tensor generation:  0.0018482208251953125
mini_batch_src_global generation:  0.0017795562744140625
r_  generation:  0.033907175064086914
local_output_nid generation:  0.004914045333862305
local_in_edges_tensor generation:  0.0022640228271484375
mini_batch_src_global generation:  0.0020585060119628906
r_  generation:  0.023061275482177734
local_output_nid generation:  0.00451350212097168
local_in_edges_tensor generation:  0.002162933349609375
mini_batch_src_global generation:  0.002004861831665039
r_  generation:  0.02243518829345703
local_output_nid generation:  0.004335880279541016
local_in_edges_tensor generation:  0.002070188522338867
mini_batch_src_global generation:  0.002003908157348633
r_  generation:  0.022249221801757812
local_output_nid generation:  0.004395484924316406
local_in_edges_tensor generation:  0.0020415782928466797
mini_batch_src_global generation:  0.0018787384033203125
r_  generation:  0.022705078125
local_output_nid generation:  0.004467010498046875
local_in_edges_tensor generation:  0.0020759105682373047
mini_batch_src_global generation:  0.0020067691802978516
r_  generation:  0.023013591766357422
local_output_nid generation:  0.004361391067504883
local_in_edges_tensor generation:  0.0021228790283203125
mini_batch_src_global generation:  0.00201416015625
r_  generation:  0.022789716720581055
local_output_nid generation:  0.0044078826904296875
local_in_edges_tensor generation:  0.0019497871398925781
mini_batch_src_global generation:  0.0019304752349853516
r_  generation:  0.022850990295410156
local_output_nid generation:  0.004564046859741211
local_in_edges_tensor generation:  0.002216815948486328
mini_batch_src_global generation:  0.009815216064453125
r_  generation:  0.024987459182739258
local_output_nid generation:  0.004646778106689453
local_in_edges_tensor generation:  0.001973390579223633
mini_batch_src_global generation:  0.0018296241760253906
r_  generation:  0.023798465728759766
local_output_nid generation:  0.004093170166015625
local_in_edges_tensor generation:  0.0018382072448730469
mini_batch_src_global generation:  0.001973390579223633
r_  generation:  0.02320122718811035
local_output_nid generation:  0.0038025379180908203
local_in_edges_tensor generation:  0.0017852783203125
mini_batch_src_global generation:  0.0019414424896240234
r_  generation:  0.022538185119628906
local_output_nid generation:  0.003610849380493164
local_in_edges_tensor generation:  0.0017440319061279297
mini_batch_src_global generation:  0.0019271373748779297
r_  generation:  0.022934913635253906
local_output_nid generation:  0.0034766197204589844
local_in_edges_tensor generation:  0.001760721206665039
mini_batch_src_global generation:  0.0018787384033203125
r_  generation:  0.021988630294799805
----------------------check_connections_block total spend ----------------------------- 0.6524403095245361
generate_one_block  0.03364300727844238
generate_one_block  0.03213167190551758
generate_one_block  0.030742406845092773
generate_one_block  0.03191971778869629
generate_one_block  0.03220200538635254
generate_one_block  0.03407430648803711
generate_one_block  0.03129768371582031
generate_one_block  0.03521394729614258
generate_one_block  0.033309221267700195
generate_one_block  0.03240799903869629
generate_one_block  0.04010272026062012
generate_one_block  0.03978276252746582
generate_one_block  0.03446006774902344
generate_one_block  0.033761024475097656
generate_one_block  0.03260684013366699
generate_one_block  0.03236865997314453
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0369715690612793
gen group dst list time:  0.019293546676635742
time for parepare:  0.020611286163330078
local_output_nid generation:  0.009412765502929688
local_in_edges_tensor generation:  0.025892257690429688
mini_batch_src_global generation:  0.025900602340698242
r_  generation:  0.24840164184570312
local_output_nid generation:  0.013065338134765625
local_in_edges_tensor generation:  0.021904706954956055
mini_batch_src_global generation:  0.031610965728759766
r_  generation:  0.25948119163513184
local_output_nid generation:  0.013068914413452148
local_in_edges_tensor generation:  0.02284097671508789
mini_batch_src_global generation:  0.031423330307006836
r_  generation:  0.26442670822143555
local_output_nid generation:  0.014026403427124023
local_in_edges_tensor generation:  0.020061016082763672
mini_batch_src_global generation:  0.03767514228820801
r_  generation:  0.2874922752380371
local_output_nid generation:  0.016496896743774414
local_in_edges_tensor generation:  0.01988983154296875
mini_batch_src_global generation:  0.034113168716430664
r_  generation:  0.273301362991333
local_output_nid generation:  0.014015436172485352
local_in_edges_tensor generation:  0.014171123504638672
mini_batch_src_global generation:  0.033972978591918945
r_  generation:  0.2704429626464844
local_output_nid generation:  0.014203071594238281
local_in_edges_tensor generation:  0.0161130428314209
mini_batch_src_global generation:  0.03342390060424805
r_  generation:  0.26529550552368164
local_output_nid generation:  0.014748811721801758
local_in_edges_tensor generation:  0.014330387115478516
mini_batch_src_global generation:  0.034759521484375
r_  generation:  0.27730536460876465
local_output_nid generation:  0.014468908309936523
local_in_edges_tensor generation:  0.014142513275146484
mini_batch_src_global generation:  0.03520512580871582
r_  generation:  0.2724730968475342
local_output_nid generation:  0.014354944229125977
local_in_edges_tensor generation:  0.018003225326538086
mini_batch_src_global generation:  0.034792423248291016
r_  generation:  0.27640295028686523
local_output_nid generation:  0.01416468620300293
local_in_edges_tensor generation:  0.014221668243408203
mini_batch_src_global generation:  0.03471207618713379
r_  generation:  0.2870464324951172
local_output_nid generation:  0.014264106750488281
local_in_edges_tensor generation:  0.013827323913574219
mini_batch_src_global generation:  0.03475522994995117
r_  generation:  0.28287672996520996
local_output_nid generation:  0.014817953109741211
local_in_edges_tensor generation:  0.01842331886291504
mini_batch_src_global generation:  0.03695082664489746
r_  generation:  0.2845423221588135
local_output_nid generation:  0.013601064682006836
local_in_edges_tensor generation:  0.019448280334472656
mini_batch_src_global generation:  0.036184072494506836
r_  generation:  0.2755420207977295
local_output_nid generation:  0.013547420501708984
local_in_edges_tensor generation:  0.01681208610534668
mini_batch_src_global generation:  0.03489494323730469
r_  generation:  0.273134708404541
local_output_nid generation:  0.01341700553894043
local_in_edges_tensor generation:  0.018244266510009766
mini_batch_src_global generation:  0.03581523895263672
r_  generation:  0.27376270294189453
----------------------check_connections_block total spend ----------------------------- 6.377554893493652
generate_one_block  0.3547048568725586
generate_one_block  0.34753942489624023
generate_one_block  0.3478395938873291
generate_one_block  0.3660099506378174
generate_one_block  0.3604393005371094
generate_one_block  0.35014796257019043
generate_one_block  0.3756227493286133
generate_one_block  0.3601713180541992
generate_one_block  0.3534684181213379
generate_one_block  0.35829591751098633
generate_one_block  0.35057640075683594
generate_one_block  0.3721787929534912
generate_one_block  0.3654155731201172
generate_one_block  0.3561263084411621
generate_one_block  0.3525550365447998
generate_one_block  0.3433496952056885
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.039231300354003906
gen group dst list time:  0.06689453125
time for parepare:  0.02060985565185547
local_output_nid generation:  0.028292179107666016
local_in_edges_tensor generation:  0.07177972793579102
mini_batch_src_global generation:  0.05039501190185547
r_  generation:  0.5199980735778809
local_output_nid generation:  0.03302288055419922
local_in_edges_tensor generation:  0.04276227951049805
mini_batch_src_global generation:  0.06494379043579102
r_  generation:  0.5241196155548096
local_output_nid generation:  0.03268289566040039
local_in_edges_tensor generation:  0.03655743598937988
mini_batch_src_global generation:  0.0926365852355957
r_  generation:  0.5505011081695557
local_output_nid generation:  0.03340506553649902
local_in_edges_tensor generation:  0.04383063316345215
mini_batch_src_global generation:  0.07782149314880371
r_  generation:  0.5350363254547119
local_output_nid generation:  0.035233259201049805
local_in_edges_tensor generation:  0.0986948013305664
mini_batch_src_global generation:  0.061079978942871094
r_  generation:  0.5390031337738037
local_output_nid generation:  0.033325910568237305
local_in_edges_tensor generation:  0.03301382064819336
mini_batch_src_global generation:  0.062184810638427734
r_  generation:  0.5339055061340332
local_output_nid generation:  0.033376455307006836
local_in_edges_tensor generation:  0.03759646415710449
mini_batch_src_global generation:  0.06184816360473633
r_  generation:  0.5559432506561279
local_output_nid generation:  0.03317403793334961
local_in_edges_tensor generation:  0.039574384689331055
mini_batch_src_global generation:  0.06253576278686523
r_  generation:  0.5413579940795898
local_output_nid generation:  0.03419375419616699
local_in_edges_tensor generation:  0.04366636276245117
mini_batch_src_global generation:  0.0645742416381836
r_  generation:  0.5422017574310303
local_output_nid generation:  0.03327608108520508
local_in_edges_tensor generation:  0.03862595558166504
mini_batch_src_global generation:  0.0627286434173584
r_  generation:  0.5451638698577881
local_output_nid generation:  0.03335452079772949
local_in_edges_tensor generation:  0.043021440505981445
mini_batch_src_global generation:  0.06434893608093262
r_  generation:  0.5618636608123779
local_output_nid generation:  0.03546285629272461
local_in_edges_tensor generation:  0.04197239875793457
mini_batch_src_global generation:  0.07064199447631836
r_  generation:  0.5419673919677734
local_output_nid generation:  0.034976959228515625
local_in_edges_tensor generation:  0.03895401954650879
mini_batch_src_global generation:  0.06258749961853027
r_  generation:  0.5416157245635986
local_output_nid generation:  0.03432726860046387
local_in_edges_tensor generation:  0.03182506561279297
mini_batch_src_global generation:  0.06255006790161133
r_  generation:  0.5375289916992188
local_output_nid generation:  0.034234046936035156
local_in_edges_tensor generation:  0.03570961952209473
mini_batch_src_global generation:  0.06248903274536133
r_  generation:  0.5416812896728516
local_output_nid generation:  0.03441214561462402
local_in_edges_tensor generation:  0.033194541931152344
mini_batch_src_global generation:  0.06262612342834473
r_  generation:  0.5377950668334961
----------------------check_connections_block total spend ----------------------------- 12.869193077087402
generate_one_block  0.6918087005615234
generate_one_block  0.6830227375030518
generate_one_block  0.6927568912506104
generate_one_block  0.7075889110565186
generate_one_block  0.6867289543151855
generate_one_block  0.6883354187011719
generate_one_block  0.690464973449707
generate_one_block  0.6897480487823486
generate_one_block  0.7193763256072998
generate_one_block  0.6978821754455566
generate_one_block  0.6949934959411621
generate_one_block  0.6963932514190674
generate_one_block  0.70255446434021
generate_one_block  0.6845431327819824
generate_one_block  0.6791071891784668
generate_one_block  0.6809673309326172
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.12861967086791992  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

connection checking time:  19.246747970581055
block generation total time  16.800713300704956
average batch blocks generation time:  1.0500445812940598
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09940147399902344  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7637763023376465  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.099517822265625  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7647037506103516  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09959793090820312  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7686233520507812  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09997797012329102  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7806262969970703  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09982824325561523  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7763333320617676  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.0997629165649414  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7719807624816895  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10063552856445312  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7729620933532715  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10000228881835938  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7774333953857422  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.0996541976928711  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7723236083984375  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09987926483154297  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7797141075134277  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09961795806884766  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7688202857971191  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09994173049926758  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7813539505004883  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09995460510253906  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7806434631347656  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09992027282714844  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7722387313842773  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.0996103286743164  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7700061798095703  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09962654113769531  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7681360244750977  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06354661285877228 |0.01760508120059967 |0.0034490376710891724 |8.855760097503662e-05 |0.003300800919532776 |0.0017895698547363281 |
----------------------------------------------------------pseudo_mini_loss sum 1.9459751844406128
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  5329426
Number of first layer input nodes during this epoch:  2520826
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.1270737648010254  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024013519287109375
random selection method range initialization spend 0.005420207977294922
time for parepare:  0.018711566925048828
local_output_nid generation:  0.0023322105407714844
local_in_edges_tensor generation:  0.007294178009033203
mini_batch_src_global generation:  0.0018248558044433594
r_  generation:  0.020562171936035156
local_output_nid generation:  0.0029006004333496094
local_in_edges_tensor generation:  0.0017421245574951172
mini_batch_src_global generation:  0.002123117446899414
r_  generation:  0.022687435150146484
local_output_nid generation:  0.003007173538208008
local_in_edges_tensor generation:  0.0016736984252929688
mini_batch_src_global generation:  0.0017731189727783203
r_  generation:  0.021924495697021484
local_output_nid generation:  0.002984762191772461
local_in_edges_tensor generation:  0.00168609619140625
mini_batch_src_global generation:  0.0018045902252197266
r_  generation:  0.021953582763671875
local_output_nid generation:  0.002985715866088867
local_in_edges_tensor generation:  0.0016832351684570312
mini_batch_src_global generation:  0.001798391342163086
r_  generation:  0.02190542221069336
local_output_nid generation:  0.0030753612518310547
local_in_edges_tensor generation:  0.0016617774963378906
mini_batch_src_global generation:  0.0018076896667480469
r_  generation:  0.022421598434448242
local_output_nid generation:  0.0030066967010498047
local_in_edges_tensor generation:  0.0016481876373291016
mini_batch_src_global generation:  0.0018367767333984375
r_  generation:  0.022866010665893555
local_output_nid generation:  0.003004789352416992
local_in_edges_tensor generation:  0.0016753673553466797
mini_batch_src_global generation:  0.0018439292907714844
r_  generation:  0.02290511131286621
local_output_nid generation:  0.0030062198638916016
local_in_edges_tensor generation:  0.0016722679138183594
mini_batch_src_global generation:  0.0018641948699951172
r_  generation:  0.022340059280395508
local_output_nid generation:  0.0030829906463623047
local_in_edges_tensor generation:  0.0016009807586669922
mini_batch_src_global generation:  0.0018041133880615234
r_  generation:  0.022249937057495117
local_output_nid generation:  0.0030095577239990234
local_in_edges_tensor generation:  0.001646280288696289
mini_batch_src_global generation:  0.0018184185028076172
r_  generation:  0.022666454315185547
local_output_nid generation:  0.002992391586303711
local_in_edges_tensor generation:  0.0016503334045410156
mini_batch_src_global generation:  0.0018095970153808594
r_  generation:  0.02199578285217285
local_output_nid generation:  0.0029952526092529297
local_in_edges_tensor generation:  0.00159454345703125
mini_batch_src_global generation:  0.0017781257629394531
r_  generation:  0.02173924446105957
local_output_nid generation:  0.0029778480529785156
local_in_edges_tensor generation:  0.0015895366668701172
mini_batch_src_global generation:  0.0017514228820800781
r_  generation:  0.021442651748657227
local_output_nid generation:  0.0030319690704345703
local_in_edges_tensor generation:  0.0015866756439208984
mini_batch_src_global generation:  0.0018172264099121094
r_  generation:  0.022399425506591797
local_output_nid generation:  0.0030355453491210938
local_in_edges_tensor generation:  0.0015883445739746094
mini_batch_src_global generation:  0.0018186569213867188
r_  generation:  0.022603511810302734
----------------------check_connections_block total spend ----------------------------- 0.5731217861175537
generate_one_block  0.03022480010986328
generate_one_block  0.031586408615112305
generate_one_block  0.031244277954101562
generate_one_block  0.03163766860961914
generate_one_block  0.031191587448120117
generate_one_block  0.03428912162780762
generate_one_block  0.03221583366394043
generate_one_block  0.031676292419433594
generate_one_block  0.03150296211242676
generate_one_block  0.030881881713867188
generate_one_block  0.031456947326660156
generate_one_block  0.030597925186157227
generate_one_block  0.0303499698638916
generate_one_block  0.03043675422668457
generate_one_block  0.031558990478515625
generate_one_block  0.03252267837524414
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03837108612060547
gen group dst list time:  0.01831960678100586
time for parepare:  0.019166946411132812
local_output_nid generation:  0.00916147232055664
local_in_edges_tensor generation:  0.02532815933227539
mini_batch_src_global generation:  0.025888919830322266
r_  generation:  0.248213529586792
local_output_nid generation:  0.013474225997924805
local_in_edges_tensor generation:  0.01906585693359375
mini_batch_src_global generation:  0.03241395950317383
r_  generation:  0.26128554344177246
local_output_nid generation:  0.01313471794128418
local_in_edges_tensor generation:  0.01646137237548828
mini_batch_src_global generation:  0.032770395278930664
r_  generation:  0.2662522792816162
local_output_nid generation:  0.013710260391235352
local_in_edges_tensor generation:  0.019031047821044922
mini_batch_src_global generation:  0.03429818153381348
r_  generation:  0.2707233428955078
local_output_nid generation:  0.013936758041381836
local_in_edges_tensor generation:  0.016623973846435547
mini_batch_src_global generation:  0.036447763442993164
r_  generation:  0.26979494094848633
local_output_nid generation:  0.013699531555175781
local_in_edges_tensor generation:  0.014152765274047852
mini_batch_src_global generation:  0.034853458404541016
r_  generation:  0.26900267601013184
local_output_nid generation:  0.014137506484985352
local_in_edges_tensor generation:  0.01665472984313965
mini_batch_src_global generation:  0.04012322425842285
r_  generation:  0.2789440155029297
local_output_nid generation:  0.013804435729980469
local_in_edges_tensor generation:  0.01966547966003418
mini_batch_src_global generation:  0.0346682071685791
r_  generation:  0.2725691795349121
local_output_nid generation:  0.014917612075805664
local_in_edges_tensor generation:  0.019306659698486328
mini_batch_src_global generation:  0.03573751449584961
r_  generation:  0.2714412212371826
local_output_nid generation:  0.013815879821777344
local_in_edges_tensor generation:  0.014158964157104492
mini_batch_src_global generation:  0.0363004207611084
r_  generation:  0.27237486839294434
local_output_nid generation:  0.014147758483886719
local_in_edges_tensor generation:  0.015816211700439453
mini_batch_src_global generation:  0.03489851951599121
r_  generation:  0.2736399173736572
local_output_nid generation:  0.013715028762817383
local_in_edges_tensor generation:  0.013972759246826172
mini_batch_src_global generation:  0.03571915626525879
r_  generation:  0.27242469787597656
local_output_nid generation:  0.013466358184814453
local_in_edges_tensor generation:  0.017164230346679688
mini_batch_src_global generation:  0.03657865524291992
r_  generation:  0.2670435905456543
local_output_nid generation:  0.012997865676879883
local_in_edges_tensor generation:  0.01407003402709961
mini_batch_src_global generation:  0.03485918045043945
r_  generation:  0.26975345611572266
local_output_nid generation:  0.013413429260253906
local_in_edges_tensor generation:  0.016528606414794922
mini_batch_src_global generation:  0.037155866622924805
r_  generation:  0.2745499610900879
local_output_nid generation:  0.01336979866027832
local_in_edges_tensor generation:  0.017439842224121094
mini_batch_src_global generation:  0.03511500358581543
r_  generation:  0.2768421173095703
----------------------check_connections_block total spend ----------------------------- 6.304917335510254
generate_one_block  0.34589529037475586
generate_one_block  0.3474442958831787
generate_one_block  0.3592846393585205
generate_one_block  0.35791873931884766
generate_one_block  0.3581960201263428
generate_one_block  0.3490779399871826
generate_one_block  0.3931734561920166
generate_one_block  0.3459806442260742
generate_one_block  0.3474080562591553
generate_one_block  0.3449382781982422
generate_one_block  0.34915590286254883
generate_one_block  0.34389686584472656
generate_one_block  0.34529685974121094
generate_one_block  0.3442044258117676
generate_one_block  0.3511922359466553
generate_one_block  0.3552722930908203
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03540349006652832
gen group dst list time:  0.06445622444152832
time for parepare:  0.017862558364868164
local_output_nid generation:  0.027521610260009766
local_in_edges_tensor generation:  0.056609392166137695
mini_batch_src_global generation:  0.05324387550354004
r_  generation:  0.5210309028625488
local_output_nid generation:  0.03307008743286133
local_in_edges_tensor generation:  0.04135584831237793
mini_batch_src_global generation:  0.06708359718322754
r_  generation:  0.528101921081543
local_output_nid generation:  0.03280353546142578
local_in_edges_tensor generation:  0.0329892635345459
mini_batch_src_global generation:  0.0596923828125
r_  generation:  0.5333545207977295
local_output_nid generation:  0.032915353775024414
local_in_edges_tensor generation:  0.035884857177734375
mini_batch_src_global generation:  0.06034445762634277
r_  generation:  0.5487062931060791
local_output_nid generation:  0.032792091369628906
local_in_edges_tensor generation:  0.07975649833679199
mini_batch_src_global generation:  0.061255693435668945
r_  generation:  0.5373563766479492
local_output_nid generation:  0.03267931938171387
local_in_edges_tensor generation:  0.036455392837524414
mini_batch_src_global generation:  0.06163477897644043
r_  generation:  0.5364665985107422
local_output_nid generation:  0.033048391342163086
local_in_edges_tensor generation:  0.03679656982421875
mini_batch_src_global generation:  0.06206107139587402
r_  generation:  0.5413799285888672
local_output_nid generation:  0.033080339431762695
local_in_edges_tensor generation:  0.0334930419921875
mini_batch_src_global generation:  0.062180280685424805
r_  generation:  0.5410435199737549
local_output_nid generation:  0.03451275825500488
local_in_edges_tensor generation:  0.03643989562988281
mini_batch_src_global generation:  0.06147027015686035
r_  generation:  0.5409801006317139
local_output_nid generation:  0.0329132080078125
local_in_edges_tensor generation:  0.03339028358459473
mini_batch_src_global generation:  0.06432318687438965
r_  generation:  0.5425236225128174
local_output_nid generation:  0.033571720123291016
local_in_edges_tensor generation:  0.04152989387512207
mini_batch_src_global generation:  0.06196403503417969
r_  generation:  0.5439810752868652
local_output_nid generation:  0.033101797103881836
local_in_edges_tensor generation:  0.03275418281555176
mini_batch_src_global generation:  0.06308960914611816
r_  generation:  0.5418651103973389
local_output_nid generation:  0.03564953804016113
local_in_edges_tensor generation:  0.032282114028930664
mini_batch_src_global generation:  0.06186413764953613
r_  generation:  0.5447981357574463
local_output_nid generation:  0.03312110900878906
local_in_edges_tensor generation:  0.04230237007141113
mini_batch_src_global generation:  0.0650935173034668
r_  generation:  0.5449397563934326
local_output_nid generation:  0.03531193733215332
local_in_edges_tensor generation:  0.034877777099609375
mini_batch_src_global generation:  0.06305742263793945
r_  generation:  0.5432310104370117
local_output_nid generation:  0.03339385986328125
local_in_edges_tensor generation:  0.03741097450256348
mini_batch_src_global generation:  0.06486153602600098
r_  generation:  0.5407476425170898
----------------------check_connections_block total spend ----------------------------- 12.715460062026978
generate_one_block  0.6814498901367188
generate_one_block  0.673037052154541
generate_one_block  0.6808896064758301
generate_one_block  0.6948614120483398
generate_one_block  0.6759378910064697
generate_one_block  0.682098388671875
generate_one_block  0.684260368347168
generate_one_block  0.6797199249267578
generate_one_block  0.7472360134124756
generate_one_block  0.6864376068115234
generate_one_block  0.6848070621490479
generate_one_block  0.6773266792297363
generate_one_block  0.6878831386566162
generate_one_block  0.6969900131225586
generate_one_block  0.6844148635864258
generate_one_block  0.6850571632385254
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.1270737648010254  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

connection checking time:  19.02037739753723
block generation total time  16.640743017196655
average batch blocks generation time:  1.040046438574791
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09968948364257812  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.772580623626709  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09965324401855469  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7709231376647949  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09982633590698242  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7728667259216309  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.0999460220336914  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7813324928283691  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09981775283813477  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7710299491882324  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09970855712890625  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7705025672912598  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.0998983383178711  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7780671119689941  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09980916976928711  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7719001770019531  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10076332092285156  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.777280330657959  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09966468811035156  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7691593170166016  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09978151321411133  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7762336730957031  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.0996999740600586  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7682890892028809  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09952354431152344  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7633934020996094  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09966373443603516  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7722024917602539  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10080337524414062  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.776944637298584  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10003662109375  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.781217098236084  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06799627840518951 |0.017154395580291748 |0.0034939348697662354 |8.96751880645752e-05 |0.003716215491294861 |0.0013093948364257812 |
----------------------------------------------------------pseudo_mini_loss sum 1.8648072481155396
 Run 0| Epoch 6 |
Number of nodes for computation during this epoch:  5331511
Number of first layer input nodes during this epoch:  2522331
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.12974834442138672  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02228403091430664
random selection method range initialization spend 0.0054357051849365234
time for parepare:  0.019219398498535156
local_output_nid generation:  0.0022966861724853516
local_in_edges_tensor generation:  0.005426168441772461
mini_batch_src_global generation:  0.0024373531341552734
r_  generation:  0.021383047103881836
local_output_nid generation:  0.00293731689453125
local_in_edges_tensor generation:  0.00196075439453125
mini_batch_src_global generation:  0.0024895668029785156
r_  generation:  0.02262568473815918
local_output_nid generation:  0.0030510425567626953
local_in_edges_tensor generation:  0.0019252300262451172
mini_batch_src_global generation:  0.0018131732940673828
r_  generation:  0.021222591400146484
local_output_nid generation:  0.002977609634399414
local_in_edges_tensor generation:  0.001954793930053711
mini_batch_src_global generation:  0.001836538314819336
r_  generation:  0.0218203067779541
local_output_nid generation:  0.0029828548431396484
local_in_edges_tensor generation:  0.0018777847290039062
mini_batch_src_global generation:  0.0018270015716552734
r_  generation:  0.02213597297668457
local_output_nid generation:  0.0029604434967041016
local_in_edges_tensor generation:  0.0018591880798339844
mini_batch_src_global generation:  0.0018589496612548828
r_  generation:  0.02266716957092285
local_output_nid generation:  0.002985715866088867
local_in_edges_tensor generation:  0.00189971923828125
mini_batch_src_global generation:  0.0019025802612304688
r_  generation:  0.022043466567993164
local_output_nid generation:  0.0030586719512939453
local_in_edges_tensor generation:  0.0018792152404785156
mini_batch_src_global generation:  0.001873016357421875
r_  generation:  0.02159261703491211
local_output_nid generation:  0.0029854774475097656
local_in_edges_tensor generation:  0.0018301010131835938
mini_batch_src_global generation:  0.001836538314819336
r_  generation:  0.02215266227722168
local_output_nid generation:  0.0029783248901367188
local_in_edges_tensor generation:  0.0018384456634521484
mini_batch_src_global generation:  0.0018541812896728516
r_  generation:  0.021619796752929688
local_output_nid generation:  0.0029654502868652344
local_in_edges_tensor generation:  0.0017857551574707031
mini_batch_src_global generation:  0.001878976821899414
r_  generation:  0.022642135620117188
local_output_nid generation:  0.0029976367950439453
local_in_edges_tensor generation:  0.0018610954284667969
mini_batch_src_global generation:  0.0018651485443115234
r_  generation:  0.021926403045654297
local_output_nid generation:  0.002974987030029297
local_in_edges_tensor generation:  0.0018222332000732422
mini_batch_src_global generation:  0.0018448829650878906
r_  generation:  0.022118568420410156
local_output_nid generation:  0.002992391586303711
local_in_edges_tensor generation:  0.001947164535522461
mini_batch_src_global generation:  0.0019173622131347656
r_  generation:  0.022683143615722656
local_output_nid generation:  0.0029773712158203125
local_in_edges_tensor generation:  0.0018482208251953125
mini_batch_src_global generation:  0.001888275146484375
r_  generation:  0.021836280822753906
local_output_nid generation:  0.002975940704345703
local_in_edges_tensor generation:  0.0018396377563476562
mini_batch_src_global generation:  0.0018916130065917969
r_  generation:  0.022426128387451172
----------------------check_connections_block total spend ----------------------------- 0.5734069347381592
generate_one_block  0.030750274658203125
generate_one_block  0.03208756446838379
generate_one_block  0.030342578887939453
generate_one_block  0.03135490417480469
generate_one_block  0.03154444694519043
generate_one_block  0.034522294998168945
generate_one_block  0.03151583671569824
generate_one_block  0.030263662338256836
generate_one_block  0.031299591064453125
generate_one_block  0.030684471130371094
generate_one_block  0.03217196464538574
generate_one_block  0.031162738800048828
generate_one_block  0.030657529830932617
generate_one_block  0.031287431716918945
generate_one_block  0.031038522720336914
generate_one_block  0.03171110153198242
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0531458854675293
gen group dst list time:  0.018468379974365234
time for parepare:  0.01905369758605957
local_output_nid generation:  0.009359359741210938
local_in_edges_tensor generation:  0.025765180587768555
mini_batch_src_global generation:  0.02721095085144043
r_  generation:  0.25563979148864746
local_output_nid generation:  0.013332605361938477
local_in_edges_tensor generation:  0.01678609848022461
mini_batch_src_global generation:  0.037077903747558594
r_  generation:  0.2643289566040039
local_output_nid generation:  0.012933492660522461
local_in_edges_tensor generation:  0.018694400787353516
mini_batch_src_global generation:  0.031077861785888672
r_  generation:  0.2573275566101074
local_output_nid generation:  0.013947486877441406
local_in_edges_tensor generation:  0.015739917755126953
mini_batch_src_global generation:  0.033904075622558594
r_  generation:  0.2694587707519531
local_output_nid generation:  0.01381063461303711
local_in_edges_tensor generation:  0.014195680618286133
mini_batch_src_global generation:  0.033835649490356445
r_  generation:  0.2705807685852051
local_output_nid generation:  0.013865470886230469
local_in_edges_tensor generation:  0.014102697372436523
mini_batch_src_global generation:  0.03410053253173828
r_  generation:  0.2726447582244873
local_output_nid generation:  0.013816356658935547
local_in_edges_tensor generation:  0.015330791473388672
mini_batch_src_global generation:  0.034113168716430664
r_  generation:  0.27060985565185547
local_output_nid generation:  0.013858795166015625
local_in_edges_tensor generation:  0.01660323143005371
mini_batch_src_global generation:  0.035121917724609375
r_  generation:  0.2638978958129883
local_output_nid generation:  0.014180660247802734
local_in_edges_tensor generation:  0.014726638793945312
mini_batch_src_global generation:  0.036510467529296875
r_  generation:  0.2751610279083252
local_output_nid generation:  0.013841867446899414
local_in_edges_tensor generation:  0.013938426971435547
mini_batch_src_global generation:  0.03404068946838379
r_  generation:  0.26717615127563477
local_output_nid generation:  0.013596296310424805
local_in_edges_tensor generation:  0.015674591064453125
mini_batch_src_global generation:  0.035747528076171875
r_  generation:  0.27262163162231445
local_output_nid generation:  0.01373600959777832
local_in_edges_tensor generation:  0.016993284225463867
mini_batch_src_global generation:  0.034265995025634766
r_  generation:  0.272352933883667
local_output_nid generation:  0.013783693313598633
local_in_edges_tensor generation:  0.014226675033569336
mini_batch_src_global generation:  0.03470873832702637
r_  generation:  0.2683234214782715
local_output_nid generation:  0.013763427734375
local_in_edges_tensor generation:  0.016742944717407227
mini_batch_src_global generation:  0.035036325454711914
r_  generation:  0.27544260025024414
local_output_nid generation:  0.013338088989257812
local_in_edges_tensor generation:  0.015503644943237305
mini_batch_src_global generation:  0.03552818298339844
r_  generation:  0.2746720314025879
local_output_nid generation:  0.01313328742980957
local_in_edges_tensor generation:  0.014523983001708984
mini_batch_src_global generation:  0.034415483474731445
r_  generation:  0.2708127498626709
----------------------check_connections_block total spend ----------------------------- 6.263117074966431
generate_one_block  0.36077451705932617
generate_one_block  0.3528597354888916
generate_one_block  0.33930468559265137
generate_one_block  0.3494899272918701
generate_one_block  0.3515613079071045
generate_one_block  0.34779882431030273
generate_one_block  0.3717687129974365
generate_one_block  0.33722352981567383
generate_one_block  0.3500988483428955
generate_one_block  0.3386092185974121
generate_one_block  0.3483920097351074
generate_one_block  0.347855806350708
generate_one_block  0.34764885902404785
generate_one_block  0.3555159568786621
generate_one_block  0.3572981357574463
generate_one_block  0.3465425968170166
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0348515510559082
gen group dst list time:  0.0686187744140625
time for parepare:  0.017621517181396484
local_output_nid generation:  0.028488636016845703
local_in_edges_tensor generation:  0.041667938232421875
mini_batch_src_global generation:  0.05063581466674805
r_  generation:  0.5223400592803955
local_output_nid generation:  0.03330254554748535
local_in_edges_tensor generation:  0.03839612007141113
mini_batch_src_global generation:  0.06513762474060059
r_  generation:  0.5268404483795166
local_output_nid generation:  0.03312230110168457
local_in_edges_tensor generation:  0.03230166435241699
mini_batch_src_global generation:  0.05948281288146973
r_  generation:  0.5360665321350098
local_output_nid generation:  0.03399324417114258
local_in_edges_tensor generation:  0.03586077690124512
mini_batch_src_global generation:  0.059725284576416016
r_  generation:  0.5330185890197754
local_output_nid generation:  0.0329747200012207
local_in_edges_tensor generation:  0.07573914527893066
mini_batch_src_global generation:  0.06061434745788574
r_  generation:  0.5376007556915283
local_output_nid generation:  0.03565406799316406
local_in_edges_tensor generation:  0.03551602363586426
mini_batch_src_global generation:  0.06189918518066406
r_  generation:  0.5336308479309082
local_output_nid generation:  0.032708168029785156
local_in_edges_tensor generation:  0.03275942802429199
mini_batch_src_global generation:  0.06094241142272949
r_  generation:  0.5420598983764648
local_output_nid generation:  0.03328704833984375
local_in_edges_tensor generation:  0.03575015068054199
mini_batch_src_global generation:  0.06191611289978027
r_  generation:  0.5424854755401611
local_output_nid generation:  0.03338265419006348
local_in_edges_tensor generation:  0.03219485282897949
mini_batch_src_global generation:  0.06166505813598633
r_  generation:  0.5447211265563965
local_output_nid generation:  0.033022165298461914
local_in_edges_tensor generation:  0.033046722412109375
mini_batch_src_global generation:  0.061758995056152344
r_  generation:  0.5399909019470215
local_output_nid generation:  0.03299212455749512
local_in_edges_tensor generation:  0.03346443176269531
mini_batch_src_global generation:  0.06411051750183105
r_  generation:  0.5465104579925537
local_output_nid generation:  0.0332186222076416
local_in_edges_tensor generation:  0.03222203254699707
mini_batch_src_global generation:  0.06262683868408203
r_  generation:  0.5436489582061768
local_output_nid generation:  0.033444881439208984
local_in_edges_tensor generation:  0.03492879867553711
mini_batch_src_global generation:  0.06402206420898438
r_  generation:  0.541717529296875
local_output_nid generation:  0.033469200134277344
local_in_edges_tensor generation:  0.03744316101074219
mini_batch_src_global generation:  0.06533122062683105
r_  generation:  0.5420982837677002
local_output_nid generation:  0.03347659111022949
local_in_edges_tensor generation:  0.03702402114868164
mini_batch_src_global generation:  0.06476902961730957
r_  generation:  0.5474028587341309
local_output_nid generation:  0.03350114822387695
local_in_edges_tensor generation:  0.03762936592102051
mini_batch_src_global generation:  0.062224388122558594
r_  generation:  0.5406558513641357
----------------------check_connections_block total spend ----------------------------- 12.674187898635864
generate_one_block  0.6769719123840332
generate_one_block  0.6867685317993164
generate_one_block  0.6877627372741699
generate_one_block  0.6872785091400146
generate_one_block  0.6997854709625244
generate_one_block  0.6809911727905273
generate_one_block  0.6728866100311279
generate_one_block  0.6832177639007568
generate_one_block  0.7212975025177002
generate_one_block  0.6906247138977051
generate_one_block  0.6865847110748291
generate_one_block  0.6842136383056641
generate_one_block  0.6845266819000244
generate_one_block  0.6829338073730469
generate_one_block  0.6818997859954834
generate_one_block  0.6757099628448486
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.12974834442138672  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

connection checking time:  18.937304973602295
block generation total time  16.586196184158325
average batch blocks generation time:  1.0366372615098953
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09989404678344727  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7806992530822754  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09984970092773438  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7805309295654297  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10061073303222656  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7682056427001953  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09987878799438477  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7772784233093262  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09979534149169922  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7753238677978516  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09970617294311523  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7709174156188965  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.0996999740600586  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7682952880859375  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09956598281860352  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7673182487487793  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.0999140739440918  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.779515266418457  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09974002838134766  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7718472480773926  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09974098205566406  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.777097225189209  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09977579116821289  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.770319938659668  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09968137741088867  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7679538726806641  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09984397888183594  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7762870788574219  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.1008901596069336  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7792019844055176  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09975767135620117  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7727751731872559  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06501486897468567 |0.014507964253425598 |0.003442928194999695 |8.982419967651367e-05 |0.003237500786781311 |0.0013048648834228516 |
----------------------------------------------------------pseudo_mini_loss sum 1.7935088872909546
 Run 0| Epoch 7 |
Number of nodes for computation during this epoch:  5331540
Number of first layer input nodes during this epoch:  2521846
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.12838315963745117  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024395465850830078
random selection method range initialization spend 0.0056116580963134766
time for parepare:  0.018610000610351562
local_output_nid generation:  0.0023453235626220703
local_in_edges_tensor generation:  0.007626771926879883
mini_batch_src_global generation:  0.0018851757049560547
r_  generation:  0.020307540893554688
local_output_nid generation:  0.0030012130737304688
local_in_edges_tensor generation:  0.0017673969268798828
mini_batch_src_global generation:  0.002174854278564453
r_  generation:  0.022550582885742188
local_output_nid generation:  0.002974271774291992
local_in_edges_tensor generation:  0.0016884803771972656
mini_batch_src_global generation:  0.0018372535705566406
r_  generation:  0.02165055274963379
local_output_nid generation:  0.003009796142578125
local_in_edges_tensor generation:  0.0016858577728271484
mini_batch_src_global generation:  0.0017609596252441406
r_  generation:  0.021491050720214844
local_output_nid generation:  0.003065347671508789
local_in_edges_tensor generation:  0.0018055438995361328
mini_batch_src_global generation:  0.0018901824951171875
r_  generation:  0.02249932289123535
local_output_nid generation:  0.0030853748321533203
local_in_edges_tensor generation:  0.0016286373138427734
mini_batch_src_global generation:  0.0018625259399414062
r_  generation:  0.022588253021240234
local_output_nid generation:  0.003015279769897461
local_in_edges_tensor generation:  0.0016846656799316406
mini_batch_src_global generation:  0.001819610595703125
r_  generation:  0.02232646942138672
local_output_nid generation:  0.003000974655151367
local_in_edges_tensor generation:  0.0016405582427978516
mini_batch_src_global generation:  0.0018453598022460938
r_  generation:  0.022371292114257812
local_output_nid generation:  0.003036022186279297
local_in_edges_tensor generation:  0.0016260147094726562
mini_batch_src_global generation:  0.0018742084503173828
r_  generation:  0.02228260040283203
local_output_nid generation:  0.0030133724212646484
local_in_edges_tensor generation:  0.0016596317291259766
mini_batch_src_global generation:  0.0018935203552246094
r_  generation:  0.022646665573120117
local_output_nid generation:  0.0030896663665771484
local_in_edges_tensor generation:  0.0016295909881591797
mini_batch_src_global generation:  0.001802682876586914
r_  generation:  0.021973848342895508
local_output_nid generation:  0.0030629634857177734
local_in_edges_tensor generation:  0.0016837120056152344
mini_batch_src_global generation:  0.0018706321716308594
r_  generation:  0.02253103256225586
local_output_nid generation:  0.0030472278594970703
local_in_edges_tensor generation:  0.0019044876098632812
mini_batch_src_global generation:  0.0018820762634277344
r_  generation:  0.02280426025390625
local_output_nid generation:  0.0030841827392578125
local_in_edges_tensor generation:  0.0016124248504638672
mini_batch_src_global generation:  0.001992940902709961
r_  generation:  0.022292137145996094
local_output_nid generation:  0.0030875205993652344
local_in_edges_tensor generation:  0.0016198158264160156
mini_batch_src_global generation:  0.001901388168334961
r_  generation:  0.02230095863342285
local_output_nid generation:  0.0030164718627929688
local_in_edges_tensor generation:  0.001699209213256836
mini_batch_src_global generation:  0.0018889904022216797
r_  generation:  0.021699905395507812
----------------------check_connections_block total spend ----------------------------- 0.5737564563751221
generate_one_block  0.029985666275024414
generate_one_block  0.03126811981201172
generate_one_block  0.030941486358642578
generate_one_block  0.03092670440673828
generate_one_block  0.031571388244628906
generate_one_block  0.034446001052856445
generate_one_block  0.03140521049499512
generate_one_block  0.031172752380371094
generate_one_block  0.031178712844848633
generate_one_block  0.03206229209899902
generate_one_block  0.0308685302734375
generate_one_block  0.031751394271850586
generate_one_block  0.03207230567932129
generate_one_block  0.031249046325683594
generate_one_block  0.03145790100097656
generate_one_block  0.031533002853393555
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04042959213256836
gen group dst list time:  0.018227338790893555
time for parepare:  0.01997518539428711
local_output_nid generation:  0.008987903594970703
local_in_edges_tensor generation:  0.025882244110107422
mini_batch_src_global generation:  0.026159048080444336
r_  generation:  0.24411725997924805
local_output_nid generation:  0.01346898078918457
local_in_edges_tensor generation:  0.019177913665771484
mini_batch_src_global generation:  0.03489804267883301
r_  generation:  0.25816845893859863
local_output_nid generation:  0.01303553581237793
local_in_edges_tensor generation:  0.017550230026245117
mini_batch_src_global generation:  0.0325319766998291
r_  generation:  0.2657654285430908
local_output_nid generation:  0.013690948486328125
local_in_edges_tensor generation:  0.01899552345275879
mini_batch_src_global generation:  0.032424211502075195
r_  generation:  0.26390624046325684
local_output_nid generation:  0.01404428482055664
local_in_edges_tensor generation:  0.019137144088745117
mini_batch_src_global generation:  0.03523683547973633
r_  generation:  0.2736034393310547
local_output_nid generation:  0.01361227035522461
local_in_edges_tensor generation:  0.01531839370727539
mini_batch_src_global generation:  0.03622770309448242
r_  generation:  0.2756693363189697
local_output_nid generation:  0.01379084587097168
local_in_edges_tensor generation:  0.017576217651367188
mini_batch_src_global generation:  0.03623509407043457
r_  generation:  0.27121758460998535
local_output_nid generation:  0.013781309127807617
local_in_edges_tensor generation:  0.01411890983581543
mini_batch_src_global generation:  0.03418993949890137
r_  generation:  0.27036309242248535
local_output_nid generation:  0.013862133026123047
local_in_edges_tensor generation:  0.01536107063293457
mini_batch_src_global generation:  0.035990238189697266
r_  generation:  0.27438902854919434
local_output_nid generation:  0.01394510269165039
local_in_edges_tensor generation:  0.01839900016784668
mini_batch_src_global generation:  0.03522801399230957
r_  generation:  0.2780008316040039
local_output_nid generation:  0.013037681579589844
local_in_edges_tensor generation:  0.014110326766967773
mini_batch_src_global generation:  0.03449702262878418
r_  generation:  0.2667982578277588
local_output_nid generation:  0.013811349868774414
local_in_edges_tensor generation:  0.014438152313232422
mini_batch_src_global generation:  0.034520626068115234
r_  generation:  0.2730751037597656
local_output_nid generation:  0.014411211013793945
local_in_edges_tensor generation:  0.01478433609008789
mini_batch_src_global generation:  0.035604000091552734
r_  generation:  0.2817370891571045
local_output_nid generation:  0.013545036315917969
local_in_edges_tensor generation:  0.01385951042175293
mini_batch_src_global generation:  0.03502368927001953
r_  generation:  0.27230000495910645
local_output_nid generation:  0.013213396072387695
local_in_edges_tensor generation:  0.014149904251098633
mini_batch_src_global generation:  0.03523826599121094
r_  generation:  0.274660587310791
local_output_nid generation:  0.012923717498779297
local_in_edges_tensor generation:  0.01671624183654785
mini_batch_src_global generation:  0.03451228141784668
r_  generation:  0.26447510719299316
----------------------check_connections_block total spend ----------------------------- 6.280615568161011
generate_one_block  0.3398444652557373
generate_one_block  0.34889674186706543
generate_one_block  0.3406689167022705
generate_one_block  0.34334492683410645
generate_one_block  0.3558075428009033
generate_one_block  0.36268019676208496
generate_one_block  0.37334299087524414
generate_one_block  0.3466365337371826
generate_one_block  0.3501551151275635
generate_one_block  0.3605654239654541
generate_one_block  0.34269261360168457
generate_one_block  0.35102105140686035
generate_one_block  0.3502812385559082
generate_one_block  0.3495218753814697
generate_one_block  0.35356593132019043
generate_one_block  0.33846020698547363
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.035324811935424805
gen group dst list time:  0.06980180740356445
time for parepare:  0.02028489112854004
local_output_nid generation:  0.027553319931030273
local_in_edges_tensor generation:  0.04862570762634277
mini_batch_src_global generation:  0.05161404609680176
r_  generation:  0.5229065418243408
local_output_nid generation:  0.03316020965576172
local_in_edges_tensor generation:  0.04127001762390137
mini_batch_src_global generation:  0.06326937675476074
r_  generation:  0.5255422592163086
local_output_nid generation:  0.03296661376953125
local_in_edges_tensor generation:  0.03218507766723633
mini_batch_src_global generation:  0.06526803970336914
r_  generation:  0.5355195999145508
local_output_nid generation:  0.03267073631286621
local_in_edges_tensor generation:  0.0324099063873291
mini_batch_src_global generation:  0.059934139251708984
r_  generation:  0.5333712100982666
local_output_nid generation:  0.03256034851074219
local_in_edges_tensor generation:  0.0796661376953125
mini_batch_src_global generation:  0.06091165542602539
r_  generation:  0.5372118949890137
local_output_nid generation:  0.03263735771179199
local_in_edges_tensor generation:  0.034354209899902344
mini_batch_src_global generation:  0.06198596954345703
r_  generation:  0.5342822074890137
local_output_nid generation:  0.03254127502441406
local_in_edges_tensor generation:  0.034589529037475586
mini_batch_src_global generation:  0.06176018714904785
r_  generation:  0.537895679473877
local_output_nid generation:  0.032976627349853516
local_in_edges_tensor generation:  0.03460359573364258
mini_batch_src_global generation:  0.06237459182739258
r_  generation:  0.5360195636749268
local_output_nid generation:  0.0327143669128418
local_in_edges_tensor generation:  0.03913545608520508
mini_batch_src_global generation:  0.06357264518737793
r_  generation:  0.540804386138916
local_output_nid generation:  0.03287696838378906
local_in_edges_tensor generation:  0.03496193885803223
mini_batch_src_global generation:  0.06532907485961914
r_  generation:  0.5417835712432861
local_output_nid generation:  0.03254199028015137
local_in_edges_tensor generation:  0.0318448543548584
mini_batch_src_global generation:  0.06190991401672363
r_  generation:  0.5464193820953369
local_output_nid generation:  0.032828569412231445
local_in_edges_tensor generation:  0.03305959701538086
mini_batch_src_global generation:  0.06322026252746582
r_  generation:  0.5431065559387207
local_output_nid generation:  0.033071279525756836
local_in_edges_tensor generation:  0.034622907638549805
mini_batch_src_global generation:  0.06461668014526367
r_  generation:  0.5419104099273682
local_output_nid generation:  0.03281712532043457
local_in_edges_tensor generation:  0.03161287307739258
mini_batch_src_global generation:  0.06283783912658691
r_  generation:  0.5461764335632324
local_output_nid generation:  0.03284883499145508
local_in_edges_tensor generation:  0.032363176345825195
mini_batch_src_global generation:  0.06189250946044922
r_  generation:  0.5432524681091309
local_output_nid generation:  0.032814979553222656
local_in_edges_tensor generation:  0.03209042549133301
mini_batch_src_global generation:  0.0620121955871582
r_  generation:  0.5425646305084229
----------------------check_connections_block total spend ----------------------------- 12.640402793884277
generate_one_block  0.6819179058074951
generate_one_block  0.6820077896118164
generate_one_block  0.6785593032836914
generate_one_block  0.6770787239074707
generate_one_block  0.6792593002319336
generate_one_block  0.6943528652191162
generate_one_block  0.683013916015625
generate_one_block  0.6842973232269287
generate_one_block  0.7452499866485596
generate_one_block  0.6860437393188477
generate_one_block  0.6835751533508301
generate_one_block  0.6846582889556885
generate_one_block  0.6811709403991699
generate_one_block  0.676102876663208
generate_one_block  0.6849827766418457
generate_one_block  0.6877877712249756
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.12838315963745117  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

connection checking time:  18.921018362045288
block generation total time  16.5975444316864
average batch blocks generation time:  1.0373465269804
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09961223602294922  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7651557922363281  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09978437423706055  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7736616134643555  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.1007080078125  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.772212028503418  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09947013854980469  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7662563323974609  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09980630874633789  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7765731811523438  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10008430480957031  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7800450325012207  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09973764419555664  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7720599174499512  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09974288940429688  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7743959426879883  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09985160827636719  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.775723934173584  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10004615783691406  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7813692092895508  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09958982467651367  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7674045562744141  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09977483749389648  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.772770881652832  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09982681274414062  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7800569534301758  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.0996103286743164  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7700409889221191  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09984636306762695  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7730803489685059  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.0995173454284668  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.766362190246582  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06665179133415222 |0.014389678835868835 |0.003714248538017273 |9.63062047958374e-05 |0.00368712842464447 |0.0031223297119140625 |
----------------------------------------------------------pseudo_mini_loss sum 1.7013150453567505
 Run 0| Epoch 8 |
Number of nodes for computation during this epoch:  5329643
Number of first layer input nodes during this epoch:  2520824
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.1268024444580078  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02940225601196289
random selection method range initialization spend 0.007748842239379883
time for parepare:  0.020659446716308594
local_output_nid generation:  0.002267122268676758
local_in_edges_tensor generation:  0.008125543594360352
mini_batch_src_global generation:  0.002866029739379883
r_  generation:  0.02204155921936035
local_output_nid generation:  0.003007650375366211
local_in_edges_tensor generation:  0.0017175674438476562
mini_batch_src_global generation:  0.0022482872009277344
r_  generation:  0.022032499313354492
local_output_nid generation:  0.0030558109283447266
local_in_edges_tensor generation:  0.0019383430480957031
mini_batch_src_global generation:  0.001844167709350586
r_  generation:  0.02172374725341797
local_output_nid generation:  0.0030143260955810547
local_in_edges_tensor generation:  0.0016875267028808594
mini_batch_src_global generation:  0.0018057823181152344
r_  generation:  0.022243976593017578
local_output_nid generation:  0.003006458282470703
local_in_edges_tensor generation:  0.0017330646514892578
mini_batch_src_global generation:  0.0017888545989990234
r_  generation:  0.02185964584350586
local_output_nid generation:  0.0030210018157958984
local_in_edges_tensor generation:  0.00164794921875
mini_batch_src_global generation:  0.0017969608306884766
r_  generation:  0.021825075149536133
local_output_nid generation:  0.003003835678100586
local_in_edges_tensor generation:  0.0017170906066894531
mini_batch_src_global generation:  0.001817941665649414
r_  generation:  0.022856950759887695
local_output_nid generation:  0.0030930042266845703
local_in_edges_tensor generation:  0.0016639232635498047
mini_batch_src_global generation:  0.0018360614776611328
r_  generation:  0.023023605346679688
local_output_nid generation:  0.003026247024536133
local_in_edges_tensor generation:  0.0016741752624511719
mini_batch_src_global generation:  0.0018699169158935547
r_  generation:  0.02228832244873047
local_output_nid generation:  0.003116607666015625
local_in_edges_tensor generation:  0.001714468002319336
mini_batch_src_global generation:  0.0018036365509033203
r_  generation:  0.022221803665161133
local_output_nid generation:  0.00312042236328125
local_in_edges_tensor generation:  0.0016069412231445312
mini_batch_src_global generation:  0.0018072128295898438
r_  generation:  0.02239823341369629
local_output_nid generation:  0.0029973983764648438
local_in_edges_tensor generation:  0.0016491413116455078
mini_batch_src_global generation:  0.0017778873443603516
r_  generation:  0.02175140380859375
local_output_nid generation:  0.002994060516357422
local_in_edges_tensor generation:  0.0016138553619384766
mini_batch_src_global generation:  0.0018506050109863281
r_  generation:  0.023147106170654297
local_output_nid generation:  0.003091096878051758
local_in_edges_tensor generation:  0.0016205310821533203
mini_batch_src_global generation:  0.001798391342163086
r_  generation:  0.022126436233520508
local_output_nid generation:  0.0030357837677001953
local_in_edges_tensor generation:  0.001672506332397461
mini_batch_src_global generation:  0.0018150806427001953
r_  generation:  0.022574901580810547
local_output_nid generation:  0.0030171871185302734
local_in_edges_tensor generation:  0.0015666484832763672
mini_batch_src_global generation:  0.0017857551574707031
r_  generation:  0.022361040115356445
----------------------check_connections_block total spend ----------------------------- 0.579409122467041
generate_one_block  0.03232407569885254
generate_one_block  0.03103327751159668
generate_one_block  0.030807018280029297
generate_one_block  0.03195500373840332
generate_one_block  0.03139233589172363
generate_one_block  0.033866167068481445
generate_one_block  0.03223586082458496
generate_one_block  0.03187680244445801
generate_one_block  0.031089067459106445
generate_one_block  0.03117847442626953
generate_one_block  0.03100752830505371
generate_one_block  0.030591964721679688
generate_one_block  0.03234457969665527
generate_one_block  0.030988693237304688
generate_one_block  0.031960248947143555
generate_one_block  0.03152012825012207
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03701305389404297
gen group dst list time:  0.018667221069335938
time for parepare:  0.019292116165161133
local_output_nid generation:  0.009630918502807617
local_in_edges_tensor generation:  0.025542497634887695
mini_batch_src_global generation:  0.027789831161499023
r_  generation:  0.2544519901275635
local_output_nid generation:  0.013388395309448242
local_in_edges_tensor generation:  0.018393516540527344
mini_batch_src_global generation:  0.03338170051574707
r_  generation:  0.25366878509521484
local_output_nid generation:  0.013038396835327148
local_in_edges_tensor generation:  0.013627767562866211
mini_batch_src_global generation:  0.031156301498413086
r_  generation:  0.2600545883178711
local_output_nid generation:  0.014107704162597656
local_in_edges_tensor generation:  0.015873193740844727
mini_batch_src_global generation:  0.03299975395202637
r_  generation:  0.2710607051849365
local_output_nid generation:  0.013762235641479492
local_in_edges_tensor generation:  0.014083147048950195
mini_batch_src_global generation:  0.03345036506652832
r_  generation:  0.26780176162719727
local_output_nid generation:  0.013817548751831055
local_in_edges_tensor generation:  0.01649618148803711
mini_batch_src_global generation:  0.033597469329833984
r_  generation:  0.27112698554992676
local_output_nid generation:  0.014329671859741211
local_in_edges_tensor generation:  0.018076658248901367
mini_batch_src_global generation:  0.03647780418395996
r_  generation:  0.2749969959259033
local_output_nid generation:  0.014222383499145508
local_in_edges_tensor generation:  0.014461994171142578
mini_batch_src_global generation:  0.03650188446044922
r_  generation:  0.2786691188812256
local_output_nid generation:  0.013891458511352539
local_in_edges_tensor generation:  0.014246940612792969
mini_batch_src_global generation:  0.03446817398071289
r_  generation:  0.27367377281188965
local_output_nid generation:  0.013942480087280273
local_in_edges_tensor generation:  0.014285802841186523
mini_batch_src_global generation:  0.03393387794494629
r_  generation:  0.27256083488464355
local_output_nid generation:  0.013744115829467773
local_in_edges_tensor generation:  0.014086246490478516
mini_batch_src_global generation:  0.034461259841918945
r_  generation:  0.274716854095459
local_output_nid generation:  0.013628005981445312
local_in_edges_tensor generation:  0.013924837112426758
mini_batch_src_global generation:  0.03381681442260742
r_  generation:  0.2706446647644043
local_output_nid generation:  0.014223575592041016
local_in_edges_tensor generation:  0.014566898345947266
mini_batch_src_global generation:  0.036870718002319336
r_  generation:  0.2893059253692627
local_output_nid generation:  0.013753652572631836
local_in_edges_tensor generation:  0.020584821701049805
mini_batch_src_global generation:  0.03463578224182129
r_  generation:  0.27243804931640625
local_output_nid generation:  0.013160467147827148
local_in_edges_tensor generation:  0.014253854751586914
mini_batch_src_global generation:  0.03469419479370117
r_  generation:  0.27754783630371094
local_output_nid generation:  0.014049053192138672
local_in_edges_tensor generation:  0.015612125396728516
mini_batch_src_global generation:  0.03737831115722656
r_  generation:  0.27847957611083984
----------------------check_connections_block total spend ----------------------------- 6.306340932846069
generate_one_block  0.36966371536254883
generate_one_block  0.342989444732666
generate_one_block  0.3457150459289551
generate_one_block  0.363506555557251
generate_one_block  0.35921812057495117
generate_one_block  0.35061073303222656
generate_one_block  0.3865318298339844
generate_one_block  0.3680989742279053
generate_one_block  0.3547399044036865
generate_one_block  0.3467679023742676
generate_one_block  0.35281944274902344
generate_one_block  0.3483586311340332
generate_one_block  0.371356725692749
generate_one_block  0.3601725101470947
generate_one_block  0.35648107528686523
generate_one_block  0.35833024978637695
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03706932067871094
gen group dst list time:  0.07072734832763672
time for parepare:  0.018578767776489258
local_output_nid generation:  0.028920412063598633
local_in_edges_tensor generation:  0.057944297790527344
mini_batch_src_global generation:  0.051903724670410156
r_  generation:  0.5336215496063232
local_output_nid generation:  0.03326892852783203
local_in_edges_tensor generation:  0.046991586685180664
mini_batch_src_global generation:  0.06729793548583984
r_  generation:  0.527693510055542
local_output_nid generation:  0.03339242935180664
local_in_edges_tensor generation:  0.03838062286376953
mini_batch_src_global generation:  0.06341981887817383
r_  generation:  0.5416333675384521
local_output_nid generation:  0.034342288970947266
local_in_edges_tensor generation:  0.036324262619018555
mini_batch_src_global generation:  0.062264442443847656
r_  generation:  0.5367946624755859
local_output_nid generation:  0.03354835510253906
local_in_edges_tensor generation:  0.07963871955871582
mini_batch_src_global generation:  0.06305742263793945
r_  generation:  0.540611743927002
local_output_nid generation:  0.033669233322143555
local_in_edges_tensor generation:  0.045378923416137695
mini_batch_src_global generation:  0.061559438705444336
r_  generation:  0.5374646186828613
local_output_nid generation:  0.03341507911682129
local_in_edges_tensor generation:  0.042816877365112305
mini_batch_src_global generation:  0.060903310775756836
r_  generation:  0.5608663558959961
local_output_nid generation:  0.035788536071777344
local_in_edges_tensor generation:  0.038279056549072266
mini_batch_src_global generation:  0.0645296573638916
r_  generation:  0.5384857654571533
local_output_nid generation:  0.03412151336669922
local_in_edges_tensor generation:  0.03634142875671387
mini_batch_src_global generation:  0.061860084533691406
r_  generation:  0.545975923538208
local_output_nid generation:  0.034250497817993164
local_in_edges_tensor generation:  0.03293752670288086
mini_batch_src_global generation:  0.0625772476196289
r_  generation:  0.5412952899932861
local_output_nid generation:  0.03488016128540039
local_in_edges_tensor generation:  0.03566575050354004
mini_batch_src_global generation:  0.062100887298583984
r_  generation:  0.5465481281280518
local_output_nid generation:  0.03393840789794922
local_in_edges_tensor generation:  0.035373687744140625
mini_batch_src_global generation:  0.0628042221069336
r_  generation:  0.5407083034515381
local_output_nid generation:  0.034155845642089844
local_in_edges_tensor generation:  0.03329133987426758
mini_batch_src_global generation:  0.06264448165893555
r_  generation:  0.5467023849487305
local_output_nid generation:  0.0343928337097168
local_in_edges_tensor generation:  0.03596687316894531
mini_batch_src_global generation:  0.06319975852966309
r_  generation:  0.5420117378234863
local_output_nid generation:  0.03424715995788574
local_in_edges_tensor generation:  0.03538846969604492
mini_batch_src_global generation:  0.06438279151916504
r_  generation:  0.5459325313568115
local_output_nid generation:  0.03397226333618164
local_in_edges_tensor generation:  0.0353093147277832
mini_batch_src_global generation:  0.06532788276672363
r_  generation:  0.5413904190063477
----------------------check_connections_block total spend ----------------------------- 12.833923101425171
generate_one_block  0.6922454833984375
generate_one_block  0.6812565326690674
generate_one_block  0.6797833442687988
generate_one_block  0.6923065185546875
generate_one_block  0.6834828853607178
generate_one_block  0.6758296489715576
generate_one_block  0.6855125427246094
generate_one_block  0.6965928077697754
generate_one_block  0.728219747543335
generate_one_block  0.6854848861694336
generate_one_block  0.6941313743591309
generate_one_block  0.6903934478759766
generate_one_block  0.7062442302703857
generate_one_block  0.687840461730957
generate_one_block  0.6966991424560547
generate_one_block  0.7043862342834473
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.1268024444580078  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

connection checking time:  19.14026403427124
block generation total time  16.815770149230957
average batch blocks generation time:  1.0509856343269348
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10097360610961914  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7830581665039062  GigaBytes
Max Memory Allocated: 0.8724079132080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09967899322509766  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7669081687927246  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.0996851921081543  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7686805725097656  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09994220733642578  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7810959815979004  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09960746765136719  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7662296295166016  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09965276718139648  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7673540115356445  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10085391998291016  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7815523147583008  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10000085830688477  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7813014984130859  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10075092315673828  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7761797904968262  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09997129440307617  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7753782272338867  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10075092315673828  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7769842147827148  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09955167770385742  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7655129432678223  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09999322891235352  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7811870574951172  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09962129592895508  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7664890289306641  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09975433349609375  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7738842964172363  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09991598129272461  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7748446464538574  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06348860263824463 |0.018317341804504395 |0.0033533573150634766 |8.93324613571167e-05 |0.0035227686166763306 |0.0016326904296875 |
----------------------------------------------------------pseudo_mini_loss sum 1.6411354541778564
 Run 0| Epoch 9 |
Number of nodes for computation during this epoch:  5333461
Number of first layer input nodes during this epoch:  2522739
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.12861967086791992  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026516437530517578
random selection method range initialization spend 0.00592494010925293
time for parepare:  0.019724607467651367
local_output_nid generation:  0.0023849010467529297
local_in_edges_tensor generation:  0.0067713260650634766
mini_batch_src_global generation:  0.0022842884063720703
r_  generation:  0.021478891372680664
local_output_nid generation:  0.003086566925048828
local_in_edges_tensor generation:  0.0017313957214355469
mini_batch_src_global generation:  0.0023775100708007812
r_  generation:  0.0231015682220459
local_output_nid generation:  0.003054380416870117
local_in_edges_tensor generation:  0.0019617080688476562
mini_batch_src_global generation:  0.0018568038940429688
r_  generation:  0.022202730178833008
local_output_nid generation:  0.003148317337036133
local_in_edges_tensor generation:  0.0017018318176269531
mini_batch_src_global generation:  0.0018045902252197266
r_  generation:  0.02172255516052246
local_output_nid generation:  0.0030303001403808594
local_in_edges_tensor generation:  0.0016663074493408203
mini_batch_src_global generation:  0.00180816650390625
r_  generation:  0.02241683006286621
local_output_nid generation:  0.0030922889709472656
local_in_edges_tensor generation:  0.0016100406646728516
mini_batch_src_global generation:  0.0017364025115966797
r_  generation:  0.021462202072143555
local_output_nid generation:  0.00302886962890625
local_in_edges_tensor generation:  0.0016384124755859375
mini_batch_src_global generation:  0.0017673969268798828
r_  generation:  0.022211074829101562
local_output_nid generation:  0.0030689239501953125
local_in_edges_tensor generation:  0.0016303062438964844
mini_batch_src_global generation:  0.0017886161804199219
r_  generation:  0.022279739379882812
local_output_nid generation:  0.002979755401611328
local_in_edges_tensor generation:  0.0016579627990722656
mini_batch_src_global generation:  0.0017883777618408203
r_  generation:  0.022011518478393555
local_output_nid generation:  0.0029807090759277344
local_in_edges_tensor generation:  0.001651763916015625
mini_batch_src_global generation:  0.001810312271118164
r_  generation:  0.022734403610229492
local_output_nid generation:  0.0029976367950439453
local_in_edges_tensor generation:  0.001641988754272461
mini_batch_src_global generation:  0.0018002986907958984
r_  generation:  0.022522449493408203
local_output_nid generation:  0.003008127212524414
local_in_edges_tensor generation:  0.0016438961029052734
mini_batch_src_global generation:  0.001798391342163086
r_  generation:  0.02254486083984375
local_output_nid generation:  0.002986907958984375
local_in_edges_tensor generation:  0.0015673637390136719
mini_batch_src_global generation:  0.0018010139465332031
r_  generation:  0.022600650787353516
local_output_nid generation:  0.002992868423461914
local_in_edges_tensor generation:  0.0016727447509765625
mini_batch_src_global generation:  0.001771688461303711
r_  generation:  0.0216367244720459
local_output_nid generation:  0.003087282180786133
local_in_edges_tensor generation:  0.0016224384307861328
mini_batch_src_global generation:  0.0017819404602050781
r_  generation:  0.022199153900146484
local_output_nid generation:  0.002976655960083008
local_in_edges_tensor generation:  0.0015869140625
mini_batch_src_global generation:  0.0017974376678466797
r_  generation:  0.022602558135986328
----------------------check_connections_block total spend ----------------------------- 0.5756487846374512
generate_one_block  0.031442880630493164
generate_one_block  0.03180217742919922
generate_one_block  0.031350135803222656
generate_one_block  0.031402587890625
generate_one_block  0.03226828575134277
generate_one_block  0.03294253349304199
generate_one_block  0.03140974044799805
generate_one_block  0.030768156051635742
generate_one_block  0.031174659729003906
generate_one_block  0.03173518180847168
generate_one_block  0.031145811080932617
generate_one_block  0.0312654972076416
generate_one_block  0.03125405311584473
generate_one_block  0.030823707580566406
generate_one_block  0.031389713287353516
generate_one_block  0.032527923583984375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03737449645996094
gen group dst list time:  0.018545866012573242
time for parepare:  0.019219398498535156
local_output_nid generation:  0.009385108947753906
local_in_edges_tensor generation:  0.028073549270629883
mini_batch_src_global generation:  0.027086496353149414
r_  generation:  0.257824182510376
local_output_nid generation:  0.013489723205566406
local_in_edges_tensor generation:  0.015510797500610352
mini_batch_src_global generation:  0.032717227935791016
r_  generation:  0.26632189750671387
local_output_nid generation:  0.013321399688720703
local_in_edges_tensor generation:  0.015526056289672852
mini_batch_src_global generation:  0.033072471618652344
r_  generation:  0.2709324359893799
local_output_nid generation:  0.013541221618652344
local_in_edges_tensor generation:  0.014172077178955078
mini_batch_src_global generation:  0.03256344795227051
r_  generation:  0.26900601387023926
local_output_nid generation:  0.014149188995361328
local_in_edges_tensor generation:  0.015645265579223633
mini_batch_src_global generation:  0.036261558532714844
r_  generation:  0.27742767333984375
local_output_nid generation:  0.013405323028564453
local_in_edges_tensor generation:  0.017995595932006836
mini_batch_src_global generation:  0.03651094436645508
r_  generation:  0.26200246810913086
local_output_nid generation:  0.013731718063354492
local_in_edges_tensor generation:  0.013837099075317383
mini_batch_src_global generation:  0.034075021743774414
r_  generation:  0.27710938453674316
local_output_nid generation:  0.013773918151855469
local_in_edges_tensor generation:  0.014989376068115234
mini_batch_src_global generation:  0.03494882583618164
r_  generation:  0.2714965343475342
local_output_nid generation:  0.013936042785644531
local_in_edges_tensor generation:  0.021199703216552734
mini_batch_src_global generation:  0.035490989685058594
r_  generation:  0.27559351921081543
local_output_nid generation:  0.014105796813964844
local_in_edges_tensor generation:  0.018062829971313477
mini_batch_src_global generation:  0.035358428955078125
r_  generation:  0.28109097480773926
local_output_nid generation:  0.013672828674316406
local_in_edges_tensor generation:  0.01969003677368164
mini_batch_src_global generation:  0.03545665740966797
r_  generation:  0.27286744117736816
local_output_nid generation:  0.014221668243408203
local_in_edges_tensor generation:  0.014379501342773438
mini_batch_src_global generation:  0.03577589988708496
r_  generation:  0.27740025520324707
local_output_nid generation:  0.015016794204711914
local_in_edges_tensor generation:  0.019266843795776367
mini_batch_src_global generation:  0.0368349552154541
r_  generation:  0.27883410453796387
local_output_nid generation:  0.013596057891845703
local_in_edges_tensor generation:  0.015525102615356445
mini_batch_src_global generation:  0.03408098220825195
r_  generation:  0.2803633213043213
local_output_nid generation:  0.0133514404296875
local_in_edges_tensor generation:  0.014556884765625
mini_batch_src_global generation:  0.03541254997253418
r_  generation:  0.280475378036499
local_output_nid generation:  0.01568913459777832
local_in_edges_tensor generation:  0.016855239868164062
mini_batch_src_global generation:  0.0359807014465332
r_  generation:  0.2747530937194824
----------------------check_connections_block total spend ----------------------------- 6.365442514419556
generate_one_block  0.36734747886657715
generate_one_block  0.35301637649536133
generate_one_block  0.3576016426086426
generate_one_block  0.3499619960784912
generate_one_block  0.3619685173034668
generate_one_block  0.34311699867248535
generate_one_block  0.38418149948120117
generate_one_block  0.34404778480529785
generate_one_block  0.3493962287902832
generate_one_block  0.3521878719329834
generate_one_block  0.3460240364074707
generate_one_block  0.3508610725402832
generate_one_block  0.36394524574279785
generate_one_block  0.3533632755279541
generate_one_block  0.35712170600891113
generate_one_block  0.3619801998138428
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.041268348693847656
gen group dst list time:  0.06627511978149414
time for parepare:  0.01832103729248047
local_output_nid generation:  0.0290529727935791
local_in_edges_tensor generation:  0.056421518325805664
mini_batch_src_global generation:  0.052376747131347656
r_  generation:  0.5306947231292725
local_output_nid generation:  0.03360581398010254
local_in_edges_tensor generation:  0.041922569274902344
mini_batch_src_global generation:  0.0655970573425293
r_  generation:  0.5329062938690186
local_output_nid generation:  0.03325986862182617
local_in_edges_tensor generation:  0.03767132759094238
mini_batch_src_global generation:  0.06179332733154297
r_  generation:  0.5482115745544434
local_output_nid generation:  0.03345966339111328
local_in_edges_tensor generation:  0.039734840393066406
mini_batch_src_global generation:  0.05986452102661133
r_  generation:  0.539647102355957
local_output_nid generation:  0.03356218338012695
local_in_edges_tensor generation:  0.08248138427734375
mini_batch_src_global generation:  0.062360525131225586
r_  generation:  0.5456068515777588
local_output_nid generation:  0.0339808464050293
local_in_edges_tensor generation:  0.03488612174987793
mini_batch_src_global generation:  0.06124114990234375
r_  generation:  0.5414059162139893
local_output_nid generation:  0.033281803131103516
local_in_edges_tensor generation:  0.034389495849609375
mini_batch_src_global generation:  0.061002492904663086
r_  generation:  0.5578596591949463
local_output_nid generation:  0.035846710205078125
local_in_edges_tensor generation:  0.03665351867675781
mini_batch_src_global generation:  0.06249189376831055
r_  generation:  0.5379316806793213
local_output_nid generation:  0.034400224685668945
local_in_edges_tensor generation:  0.0352787971496582
mini_batch_src_global generation:  0.0607762336730957
r_  generation:  0.5445647239685059
local_output_nid generation:  0.03420376777648926
local_in_edges_tensor generation:  0.03433823585510254
mini_batch_src_global generation:  0.062346458435058594
r_  generation:  0.5388655662536621
local_output_nid generation:  0.033737897872924805
local_in_edges_tensor generation:  0.037039756774902344
mini_batch_src_global generation:  0.060904502868652344
r_  generation:  0.5458993911743164
local_output_nid generation:  0.033823251724243164
local_in_edges_tensor generation:  0.034589290618896484
mini_batch_src_global generation:  0.06255149841308594
r_  generation:  0.5390775203704834
local_output_nid generation:  0.034174442291259766
local_in_edges_tensor generation:  0.03242850303649902
mini_batch_src_global generation:  0.06100153923034668
r_  generation:  0.547443151473999
local_output_nid generation:  0.03425455093383789
local_in_edges_tensor generation:  0.034269094467163086
mini_batch_src_global generation:  0.06285262107849121
r_  generation:  0.5431687831878662
local_output_nid generation:  0.0342562198638916
local_in_edges_tensor generation:  0.03254985809326172
mini_batch_src_global generation:  0.06121540069580078
r_  generation:  0.5455834865570068
local_output_nid generation:  0.034209489822387695
local_in_edges_tensor generation:  0.034668922424316406
mini_batch_src_global generation:  0.06241297721862793
r_  generation:  0.5431191921234131
----------------------check_connections_block total spend ----------------------------- 12.79908037185669
generate_one_block  0.6929175853729248
generate_one_block  0.6822619438171387
generate_one_block  0.6828792095184326
generate_one_block  0.684354305267334
generate_one_block  0.6844236850738525
generate_one_block  0.6796877384185791
generate_one_block  0.684891939163208
generate_one_block  0.6823379993438721
generate_one_block  0.75193190574646
generate_one_block  0.69795823097229
generate_one_block  0.6895349025726318
generate_one_block  0.6897873878479004
generate_one_block  0.6916217803955078
generate_one_block  0.6857874393463135
generate_one_block  0.6939840316772461
generate_one_block  0.697791576385498
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.12861967086791992  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

connection checking time:  19.164522886276245
block generation total time  16.76827359199524
average batch blocks generation time:  1.0480170994997025
block dataloader generation time/epoch 38.23983645439148
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09990310668945312  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7806658744812012  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09995031356811523  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7795462608337402  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10089588165283203  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7770123481750488  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09969282150268555  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7694168090820312  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09992599487304688  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7784571647644043  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09952402114868164  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7635302543640137  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09963274002075195  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7681565284729004  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09965848922729492  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7684111595153809  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10072803497314453  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7736606597900391  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.0998530387878418  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.779569149017334  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09957027435302734  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7688841819763184  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09981870651245117  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7770075798034668  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09983253479003906  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7761521339416504  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09970617294311523  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7725625038146973  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09965133666992188  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7708806991577148  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09992647171020508  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7783880233764648  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06282594799995422 |0.020762309432029724 |0.0036924779415130615 |9.638071060180664e-05 |0.0033174902200698853 |0.002971649169921875 |
----------------------------------------------------------pseudo_mini_loss sum 1.5936158895492554
Total (block generation + training)time/epoch 39.762447357177734
Training time/epoch 1.5224089622497559
Training time without block to device /epoch 1.1902120113372803
Training time without total dataloading part /epoch 0.11667323112487793
load block tensor time/epoch 1.0052151679992676
block to device time/epoch 0.3321969509124756
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 10 |
Number of nodes for computation during this epoch:  5331439
Number of first layer input nodes during this epoch:  2521613
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.12962818145751953  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023876428604125977
random selection method range initialization spend 0.005105018615722656
time for parepare:  0.01936507225036621
local_output_nid generation:  0.0024089813232421875
local_in_edges_tensor generation:  0.006985187530517578
mini_batch_src_global generation:  0.001764059066772461
r_  generation:  0.021238088607788086
local_output_nid generation:  0.0030291080474853516
local_in_edges_tensor generation:  0.0017254352569580078
mini_batch_src_global generation:  0.00208282470703125
r_  generation:  0.02228069305419922
local_output_nid generation:  0.00298309326171875
local_in_edges_tensor generation:  0.0017118453979492188
mini_batch_src_global generation:  0.001745462417602539
r_  generation:  0.02211618423461914
local_output_nid generation:  0.003129720687866211
local_in_edges_tensor generation:  0.0016536712646484375
mini_batch_src_global generation:  0.0017778873443603516
r_  generation:  0.021751880645751953
local_output_nid generation:  0.0030252933502197266
local_in_edges_tensor generation:  0.001607656478881836
mini_batch_src_global generation:  0.0017218589782714844
r_  generation:  0.020877838134765625
local_output_nid generation:  0.0030121803283691406
local_in_edges_tensor generation:  0.0016646385192871094
mini_batch_src_global generation:  0.0017461776733398438
r_  generation:  0.0222470760345459
local_output_nid generation:  0.0030524730682373047
local_in_edges_tensor generation:  0.0015749931335449219
mini_batch_src_global generation:  0.0017786026000976562
r_  generation:  0.021590471267700195
local_output_nid generation:  0.0030198097229003906
local_in_edges_tensor generation:  0.0016558170318603516
mini_batch_src_global generation:  0.0017991065979003906
r_  generation:  0.022266387939453125
local_output_nid generation:  0.0030019283294677734
local_in_edges_tensor generation:  0.0015757083892822266
mini_batch_src_global generation:  0.0018229484558105469
r_  generation:  0.023180007934570312
local_output_nid generation:  0.0031201839447021484
local_in_edges_tensor generation:  0.0016264915466308594
mini_batch_src_global generation:  0.0018274784088134766
r_  generation:  0.022040843963623047
local_output_nid generation:  0.0030851364135742188
local_in_edges_tensor generation:  0.001644134521484375
mini_batch_src_global generation:  0.001767873764038086
r_  generation:  0.02207326889038086
local_output_nid generation:  0.0030367374420166016
local_in_edges_tensor generation:  0.001628875732421875
mini_batch_src_global generation:  0.0017635822296142578
r_  generation:  0.022557735443115234
local_output_nid generation:  0.003080606460571289
local_in_edges_tensor generation:  0.0015811920166015625
mini_batch_src_global generation:  0.001802682876586914
r_  generation:  0.02257537841796875
local_output_nid generation:  0.003061532974243164
local_in_edges_tensor generation:  0.0016508102416992188
mini_batch_src_global generation:  0.0017611980438232422
r_  generation:  0.022550344467163086
local_output_nid generation:  0.0030345916748046875
local_in_edges_tensor generation:  0.0015554428100585938
mini_batch_src_global generation:  0.0018372535705566406
r_  generation:  0.022925138473510742
local_output_nid generation:  0.0030608177185058594
local_in_edges_tensor generation:  0.0016567707061767578
mini_batch_src_global generation:  0.0018095970153808594
r_  generation:  0.022731304168701172
----------------------check_connections_block total spend ----------------------------- 0.5725581645965576
generate_one_block  0.030952930450439453
generate_one_block  0.031691551208496094
generate_one_block  0.03108048439025879
generate_one_block  0.03229379653930664
generate_one_block  0.030245065689086914
generate_one_block  0.034345388412475586
generate_one_block  0.03069901466369629
generate_one_block  0.03138566017150879
generate_one_block  0.03214740753173828
generate_one_block  0.031136751174926758
generate_one_block  0.03093552589416504
generate_one_block  0.031890153884887695
generate_one_block  0.03205442428588867
generate_one_block  0.03165936470031738
generate_one_block  0.036057233810424805
generate_one_block  0.03225398063659668
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03985953330993652
gen group dst list time:  0.017721176147460938
time for parepare:  0.02093338966369629
local_output_nid generation:  0.009386301040649414
local_in_edges_tensor generation:  0.02344989776611328
mini_batch_src_global generation:  0.02677321434020996
r_  generation:  0.2528409957885742
local_output_nid generation:  0.013387203216552734
local_in_edges_tensor generation:  0.019490957260131836
mini_batch_src_global generation:  0.03179478645324707
r_  generation:  0.26099514961242676
local_output_nid generation:  0.013161897659301758
local_in_edges_tensor generation:  0.015187740325927734
mini_batch_src_global generation:  0.03248095512390137
r_  generation:  0.2644484043121338
local_output_nid generation:  0.01395559310913086
local_in_edges_tensor generation:  0.01620769500732422
mini_batch_src_global generation:  0.03228163719177246
r_  generation:  0.2689535617828369
local_output_nid generation:  0.013679027557373047
local_in_edges_tensor generation:  0.01775050163269043
mini_batch_src_global generation:  0.034125328063964844
r_  generation:  0.263869047164917
local_output_nid generation:  0.013855695724487305
local_in_edges_tensor generation:  0.01433873176574707
mini_batch_src_global generation:  0.0416104793548584
r_  generation:  0.2696404457092285
local_output_nid generation:  0.013512134552001953
local_in_edges_tensor generation:  0.01514887809753418
mini_batch_src_global generation:  0.03460955619812012
r_  generation:  0.2654237747192383
local_output_nid generation:  0.013827323913574219
local_in_edges_tensor generation:  0.014094829559326172
mini_batch_src_global generation:  0.03546857833862305
r_  generation:  0.2735860347747803
local_output_nid generation:  0.013926267623901367
local_in_edges_tensor generation:  0.015363931655883789
mini_batch_src_global generation:  0.03479266166687012
r_  generation:  0.2776679992675781
local_output_nid generation:  0.013693094253540039
local_in_edges_tensor generation:  0.015751361846923828
mini_batch_src_global generation:  0.0341191291809082
r_  generation:  0.2706472873687744
local_output_nid generation:  0.013244867324829102
local_in_edges_tensor generation:  0.015668153762817383
mini_batch_src_global generation:  0.034354209899902344
r_  generation:  0.26868700981140137
local_output_nid generation:  0.013879776000976562
local_in_edges_tensor generation:  0.013901472091674805
mini_batch_src_global generation:  0.03486514091491699
r_  generation:  0.28113269805908203
local_output_nid generation:  0.014005661010742188
local_in_edges_tensor generation:  0.0172421932220459
mini_batch_src_global generation:  0.034956932067871094
r_  generation:  0.281325101852417
local_output_nid generation:  0.013550758361816406
local_in_edges_tensor generation:  0.017624378204345703
mini_batch_src_global generation:  0.03738808631896973
r_  generation:  0.27354907989501953
local_output_nid generation:  0.013364315032958984
local_in_edges_tensor generation:  0.01427459716796875
mini_batch_src_global generation:  0.03500962257385254
r_  generation:  0.28250551223754883
local_output_nid generation:  0.013009309768676758
local_in_edges_tensor generation:  0.01617717742919922
mini_batch_src_global generation:  0.03502821922302246
r_  generation:  0.27335166931152344
----------------------check_connections_block total spend ----------------------------- 6.301051378250122
generate_one_block  0.3582775592803955
generate_one_block  0.35295820236206055
generate_one_block  0.35990381240844727
generate_one_block  0.36170005798339844
generate_one_block  0.3460426330566406
generate_one_block  0.3489210605621338
generate_one_block  0.3738870620727539
generate_one_block  0.35135912895202637
generate_one_block  0.36028575897216797
generate_one_block  0.3457329273223877
generate_one_block  0.34403061866760254
generate_one_block  0.363771915435791
generate_one_block  0.3575713634490967
generate_one_block  0.3613595962524414
generate_one_block  0.3612391948699951
generate_one_block  0.3573625087738037
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03806805610656738
gen group dst list time:  0.06744384765625
time for parepare:  0.018381118774414062
local_output_nid generation:  0.028017759323120117
local_in_edges_tensor generation:  0.05325484275817871
mini_batch_src_global generation:  0.04832625389099121
r_  generation:  0.5222043991088867
local_output_nid generation:  0.03310132026672363
local_in_edges_tensor generation:  0.04265952110290527
mini_batch_src_global generation:  0.06453824043273926
r_  generation:  0.5216126441955566
local_output_nid generation:  0.03537869453430176
local_in_edges_tensor generation:  0.04270434379577637
mini_batch_src_global generation:  0.05906963348388672
r_  generation:  0.5345690250396729
local_output_nid generation:  0.033602237701416016
local_in_edges_tensor generation:  0.03584575653076172
mini_batch_src_global generation:  0.05919909477233887
r_  generation:  0.531395435333252
local_output_nid generation:  0.0330348014831543
local_in_edges_tensor generation:  0.08621454238891602
mini_batch_src_global generation:  0.06002449989318848
r_  generation:  0.5347001552581787
local_output_nid generation:  0.03261709213256836
local_in_edges_tensor generation:  0.03760170936584473
mini_batch_src_global generation:  0.061746835708618164
r_  generation:  0.5341694355010986
local_output_nid generation:  0.03252243995666504
local_in_edges_tensor generation:  0.0377197265625
mini_batch_src_global generation:  0.06667852401733398
r_  generation:  0.5542590618133545
local_output_nid generation:  0.034047842025756836
local_in_edges_tensor generation:  0.034853458404541016
mini_batch_src_global generation:  0.06821870803833008
r_  generation:  0.5357797145843506
local_output_nid generation:  0.03374195098876953
local_in_edges_tensor generation:  0.034493207931518555
mini_batch_src_global generation:  0.061086177825927734
r_  generation:  0.5364527702331543
local_output_nid generation:  0.03340482711791992
local_in_edges_tensor generation:  0.03450822830200195
mini_batch_src_global generation:  0.06447267532348633
r_  generation:  0.534600019454956
local_output_nid generation:  0.033582210540771484
local_in_edges_tensor generation:  0.03267097473144531
mini_batch_src_global generation:  0.06113886833190918
r_  generation:  0.5398774147033691
local_output_nid generation:  0.03347039222717285
local_in_edges_tensor generation:  0.035376548767089844
mini_batch_src_global generation:  0.06501984596252441
r_  generation:  0.5374088287353516
local_output_nid generation:  0.03348875045776367
local_in_edges_tensor generation:  0.03362774848937988
mini_batch_src_global generation:  0.06128096580505371
r_  generation:  0.5401182174682617
local_output_nid generation:  0.0334620475769043
local_in_edges_tensor generation:  0.0334467887878418
mini_batch_src_global generation:  0.06254434585571289
r_  generation:  0.5382840633392334
local_output_nid generation:  0.03357553482055664
local_in_edges_tensor generation:  0.03532242774963379
mini_batch_src_global generation:  0.06457662582397461
r_  generation:  0.5525469779968262
local_output_nid generation:  0.03342485427856445
local_in_edges_tensor generation:  0.03769087791442871
mini_batch_src_global generation:  0.06431460380554199
r_  generation:  0.540776252746582
----------------------check_connections_block total spend ----------------------------- 12.668368816375732
generate_one_block  0.6862280368804932
generate_one_block  0.6808638572692871
generate_one_block  0.6780412197113037
generate_one_block  0.673253059387207
generate_one_block  0.6738908290863037
generate_one_block  0.6835367679595947
generate_one_block  0.6770784854888916
generate_one_block  0.684974193572998
generate_one_block  0.7089035511016846
generate_one_block  0.6775040626525879
generate_one_block  0.6803886890411377
generate_one_block  0.6860389709472656
generate_one_block  0.7016611099243164
generate_one_block  0.6880228519439697
generate_one_block  0.6993849277496338
generate_one_block  0.6910560131072998
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.12962818145751953  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

connection checking time:  18.969420194625854
block generation total time  16.675230026245117
average batch blocks generation time:  1.0422018766403198
block dataloader generation time/epoch 38.07902979850769
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.1007838249206543  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.772705078125  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.0998077392578125  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7757019996643066  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.0996394157409668  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7711944580078125  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09975910186767578  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7765903472900391  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09947538375854492  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7639060020446777  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09976673126220703  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7714414596557617  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09950590133666992  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.763770580291748  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09979772567749023  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7761349678039551  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09972286224365234  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7757110595703125  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09974098205566406  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7688956260681152  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09967565536499023  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7681546211242676  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10000467300415039  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7817635536193848  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10091590881347656  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7818646430969238  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09959793090820312  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7692604064941406  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10097789764404297  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.782841682434082  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09966516494750977  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7712984085083008  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06436021625995636 |0.018329590559005737 |0.003525763750076294 |9.045004844665527e-05 |0.0035704821348190308 |0.001550912857055664 |
----------------------------------------------------------pseudo_mini_loss sum 1.5549324750900269
Total (block generation + training)time/epoch 39.59196496009827
Training time/epoch 1.5029845237731934
Training time without block to device /epoch 1.2097110748291016
Training time without total dataloading part /epoch 0.11653804779052734
load block tensor time/epoch 1.0297634601593018
block to device time/epoch 0.2932734489440918
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 11 |
Number of nodes for computation during this epoch:  5330427
Number of first layer input nodes during this epoch:  2520876
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.12840032577514648  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022541284561157227
random selection method range initialization spend 0.005585193634033203
time for parepare:  0.018882036209106445
local_output_nid generation:  0.0023691654205322266
local_in_edges_tensor generation:  0.009056329727172852
mini_batch_src_global generation:  0.0016827583312988281
r_  generation:  0.02030348777770996
local_output_nid generation:  0.0029375553131103516
local_in_edges_tensor generation:  0.0017616748809814453
mini_batch_src_global generation:  0.0021131038665771484
r_  generation:  0.022536277770996094
local_output_nid generation:  0.002963542938232422
local_in_edges_tensor generation:  0.0017175674438476562
mini_batch_src_global generation:  0.0017440319061279297
r_  generation:  0.022085905075073242
local_output_nid generation:  0.0030760765075683594
local_in_edges_tensor generation:  0.0016825199127197266
mini_batch_src_global generation:  0.004696369171142578
r_  generation:  0.025107860565185547
local_output_nid generation:  0.0038042068481445312
local_in_edges_tensor generation:  0.0017521381378173828
mini_batch_src_global generation:  0.010242462158203125
r_  generation:  0.02378368377685547
local_output_nid generation:  0.003053426742553711
local_in_edges_tensor generation:  0.0016851425170898438
mini_batch_src_global generation:  0.002245187759399414
r_  generation:  0.02433323860168457
local_output_nid generation:  0.0031495094299316406
local_in_edges_tensor generation:  0.0019278526306152344
mini_batch_src_global generation:  0.0022139549255371094
r_  generation:  0.024515628814697266
local_output_nid generation:  0.0030744075775146484
local_in_edges_tensor generation:  0.0016562938690185547
mini_batch_src_global generation:  0.002119302749633789
r_  generation:  0.023857593536376953
local_output_nid generation:  0.0032012462615966797
local_in_edges_tensor generation:  0.0016639232635498047
mini_batch_src_global generation:  0.0022156238555908203
r_  generation:  0.024869441986083984
local_output_nid generation:  0.003077983856201172
local_in_edges_tensor generation:  0.0016379356384277344
mini_batch_src_global generation:  0.002225160598754883
r_  generation:  0.024937868118286133
local_output_nid generation:  0.003080606460571289
local_in_edges_tensor generation:  0.0016646385192871094
mini_batch_src_global generation:  0.009503364562988281
r_  generation:  0.022461414337158203
local_output_nid generation:  0.00315093994140625
local_in_edges_tensor generation:  0.0016906261444091797
mini_batch_src_global generation:  0.0017862319946289062
r_  generation:  0.02239203453063965
local_output_nid generation:  0.0030765533447265625
local_in_edges_tensor generation:  0.0015878677368164062
mini_batch_src_global generation:  0.0018110275268554688
r_  generation:  0.022583484649658203
local_output_nid generation:  0.003084897994995117
local_in_edges_tensor generation:  0.0017015933990478516
mini_batch_src_global generation:  0.0018601417541503906
r_  generation:  0.02281808853149414
local_output_nid generation:  0.003191709518432617
local_in_edges_tensor generation:  0.001644134521484375
mini_batch_src_global generation:  0.001783132553100586
r_  generation:  0.02978372573852539
local_output_nid generation:  0.005644321441650391
local_in_edges_tensor generation:  0.002366304397583008
mini_batch_src_global generation:  0.00720667839050293
r_  generation:  0.028569936752319336
----------------------check_connections_block total spend ----------------------------- 0.6748831272125244
generate_one_block  0.03258514404296875
generate_one_block  0.03233814239501953
generate_one_block  0.0315546989440918
generate_one_block  0.03218960762023926
generate_one_block  0.033261775970458984
generate_one_block  0.03589320182800293
generate_one_block  0.03173470497131348
generate_one_block  0.030719280242919922
generate_one_block  0.03195643424987793
generate_one_block  0.04579806327819824
generate_one_block  0.04122662544250488
generate_one_block  0.045999765396118164
generate_one_block  0.040123701095581055
generate_one_block  0.032321929931640625
generate_one_block  0.043819427490234375
generate_one_block  0.04299497604370117
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03756427764892578
gen group dst list time:  0.018712282180786133
time for parepare:  0.019512653350830078
local_output_nid generation:  0.00909423828125
local_in_edges_tensor generation:  0.025043964385986328
mini_batch_src_global generation:  0.025870084762573242
r_  generation:  0.23858046531677246
local_output_nid generation:  0.013324260711669922
local_in_edges_tensor generation:  0.017989635467529297
mini_batch_src_global generation:  0.033796072006225586
r_  generation:  0.26144838333129883
local_output_nid generation:  0.013343095779418945
local_in_edges_tensor generation:  0.018396854400634766
mini_batch_src_global generation:  0.031347036361694336
r_  generation:  0.26041650772094727
local_output_nid generation:  0.013974189758300781
local_in_edges_tensor generation:  0.018082618713378906
mini_batch_src_global generation:  0.03423666954040527
r_  generation:  0.2734189033508301
local_output_nid generation:  0.013689756393432617
local_in_edges_tensor generation:  0.014094352722167969
mini_batch_src_global generation:  0.033597469329833984
r_  generation:  0.26758456230163574
local_output_nid generation:  0.013445615768432617
local_in_edges_tensor generation:  0.013782501220703125
mini_batch_src_global generation:  0.03724193572998047
r_  generation:  0.26750993728637695
local_output_nid generation:  0.013936758041381836
local_in_edges_tensor generation:  0.015953779220581055
mini_batch_src_global generation:  0.034645795822143555
r_  generation:  0.2723701000213623
local_output_nid generation:  0.013559103012084961
local_in_edges_tensor generation:  0.013816595077514648
mini_batch_src_global generation:  0.03463554382324219
r_  generation:  0.2630631923675537
local_output_nid generation:  0.01379084587097168
local_in_edges_tensor generation:  0.014013051986694336
mini_batch_src_global generation:  0.034929513931274414
r_  generation:  0.27588891983032227
local_output_nid generation:  0.01400613784790039
local_in_edges_tensor generation:  0.015212059020996094
mini_batch_src_global generation:  0.035135746002197266
r_  generation:  0.27675318717956543
local_output_nid generation:  0.01347661018371582
local_in_edges_tensor generation:  0.014278411865234375
mini_batch_src_global generation:  0.03517866134643555
r_  generation:  0.27708005905151367
local_output_nid generation:  0.013709783554077148
local_in_edges_tensor generation:  0.014209747314453125
mini_batch_src_global generation:  0.03607940673828125
r_  generation:  0.2738161087036133
local_output_nid generation:  0.013951539993286133
local_in_edges_tensor generation:  0.014443397521972656
mini_batch_src_global generation:  0.03504467010498047
r_  generation:  0.27932286262512207
local_output_nid generation:  0.015383481979370117
local_in_edges_tensor generation:  0.014383316040039062
mini_batch_src_global generation:  0.036399126052856445
r_  generation:  0.2817070484161377
local_output_nid generation:  0.012886524200439453
local_in_edges_tensor generation:  0.022711992263793945
mini_batch_src_global generation:  0.044333457946777344
r_  generation:  0.27532434463500977
local_output_nid generation:  0.013994932174682617
local_in_edges_tensor generation:  0.01611804962158203
mini_batch_src_global generation:  0.03604006767272949
r_  generation:  0.27799272537231445
----------------------check_connections_block total spend ----------------------------- 6.29732608795166
generate_one_block  0.35578250885009766
generate_one_block  0.37311744689941406
generate_one_block  0.351517915725708
generate_one_block  0.36270856857299805
generate_one_block  0.34494709968566895
generate_one_block  0.3462374210357666
generate_one_block  0.3834693431854248
generate_one_block  0.3411672115325928
generate_one_block  0.36455297470092773
generate_one_block  0.37552905082702637
generate_one_block  0.3584437370300293
generate_one_block  0.35811495780944824
generate_one_block  0.35651350021362305
generate_one_block  0.35878729820251465
generate_one_block  0.3482396602630615
generate_one_block  0.3558366298675537
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04089832305908203
gen group dst list time:  0.06911325454711914
time for parepare:  0.01937389373779297
local_output_nid generation:  0.028037071228027344
local_in_edges_tensor generation:  0.06095409393310547
mini_batch_src_global generation:  0.04853057861328125
r_  generation:  0.5313518047332764
local_output_nid generation:  0.03388619422912598
local_in_edges_tensor generation:  0.04494023323059082
mini_batch_src_global generation:  0.06466460227966309
r_  generation:  0.5225996971130371
local_output_nid generation:  0.03380393981933594
local_in_edges_tensor generation:  0.03788042068481445
mini_batch_src_global generation:  0.05882883071899414
r_  generation:  0.5342087745666504
local_output_nid generation:  0.0339512825012207
local_in_edges_tensor generation:  0.03348278999328613
mini_batch_src_global generation:  0.05971574783325195
r_  generation:  0.5368907451629639
local_output_nid generation:  0.03336334228515625
local_in_edges_tensor generation:  0.08864116668701172
mini_batch_src_global generation:  0.060593605041503906
r_  generation:  0.5468571186065674
local_output_nid generation:  0.0320131778717041
local_in_edges_tensor generation:  0.03348660469055176
mini_batch_src_global generation:  0.06029772758483887
r_  generation:  0.5328869819641113
local_output_nid generation:  0.03340578079223633
local_in_edges_tensor generation:  0.035491943359375
mini_batch_src_global generation:  0.0625
r_  generation:  0.538769006729126
local_output_nid generation:  0.03435635566711426
local_in_edges_tensor generation:  0.03625607490539551
mini_batch_src_global generation:  0.06108260154724121
r_  generation:  0.5387835502624512
local_output_nid generation:  0.03207564353942871
local_in_edges_tensor generation:  0.03940176963806152
mini_batch_src_global generation:  0.06064033508300781
r_  generation:  0.5399942398071289
local_output_nid generation:  0.03250408172607422
local_in_edges_tensor generation:  0.03765749931335449
mini_batch_src_global generation:  0.06425261497497559
r_  generation:  0.5411036014556885
local_output_nid generation:  0.032750844955444336
local_in_edges_tensor generation:  0.03723430633544922
mini_batch_src_global generation:  0.06387543678283691
r_  generation:  0.5404980182647705
local_output_nid generation:  0.03289532661437988
local_in_edges_tensor generation:  0.03760361671447754
mini_batch_src_global generation:  0.06463217735290527
r_  generation:  0.5400347709655762
local_output_nid generation:  0.032776832580566406
local_in_edges_tensor generation:  0.0367283821105957
mini_batch_src_global generation:  0.07389354705810547
r_  generation:  0.5567929744720459
local_output_nid generation:  0.03493833541870117
local_in_edges_tensor generation:  0.033023834228515625
mini_batch_src_global generation:  0.06327056884765625
r_  generation:  0.5426695346832275
local_output_nid generation:  0.033519744873046875
local_in_edges_tensor generation:  0.03252983093261719
mini_batch_src_global generation:  0.061414480209350586
r_  generation:  0.5400559902191162
local_output_nid generation:  0.033698081970214844
local_in_edges_tensor generation:  0.03544878959655762
mini_batch_src_global generation:  0.06498527526855469
r_  generation:  0.5424196720123291
----------------------check_connections_block total spend ----------------------------- 12.738287448883057
generate_one_block  0.6877074241638184
generate_one_block  0.682896614074707
generate_one_block  0.6897947788238525
generate_one_block  0.6836740970611572
generate_one_block  0.6830489635467529
generate_one_block  0.6898458003997803
generate_one_block  0.6821837425231934
generate_one_block  0.681720495223999
generate_one_block  0.7506701946258545
generate_one_block  0.6893599033355713
generate_one_block  0.6877050399780273
generate_one_block  0.6884963512420654
generate_one_block  0.6836719512939453
generate_one_block  0.6879756450653076
generate_one_block  0.6835863590240479
generate_one_block  0.6815564632415771
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.12840032577514648  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

connection checking time:  19.035613536834717
block generation total time  16.768859148025513
average batch blocks generation time:  1.0480536967515945
block dataloader generation time/epoch 38.13260340690613
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09941577911376953  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7630257606506348  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.0998682975769043  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7763376235961914  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.1007547378540039  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7774214744567871  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10017919540405273  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7821550369262695  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09965705871582031  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7695245742797852  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09954547882080078  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7661471366882324  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09965896606445312  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7769608497619629  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09951114654541016  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.764132022857666  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09965753555297852  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7705302238464355  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10002899169921875  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7811975479125977  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10086631774902344  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7769021987915039  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09980392456054688  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7755703926086426  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.100860595703125  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7819089889526367  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10004234313964844  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7813482284545898  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.0996546745300293  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7673854827880859  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09971237182617188  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7760872840881348  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06753137707710266 |0.01520739495754242 |0.0036979466676712036 |9.556114673614502e-05 |0.003522351384162903 |0.0014252662658691406 |
----------------------------------------------------------pseudo_mini_loss sum 1.5198426246643066
Total (block generation + training)time/epoch 39.643940130869545
Training time/epoch 1.5078775882720947
Training time without block to device /epoch 1.264559268951416
Training time without total dataloading part /epoch 0.11847901344299316
load block tensor time/epoch 1.0805020332336426
block to device time/epoch 0.2433183193206787
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 12 |
Number of nodes for computation during this epoch:  5332874
Number of first layer input nodes during this epoch:  2521810
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.1284017562866211  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024175643920898438
random selection method range initialization spend 0.005516767501831055
time for parepare:  0.01926589012145996
local_output_nid generation:  0.0023660659790039062
local_in_edges_tensor generation:  0.005508899688720703
mini_batch_src_global generation:  0.0017247200012207031
r_  generation:  0.0209658145904541
local_output_nid generation:  0.002903461456298828
local_in_edges_tensor generation:  0.0017130374908447266
mini_batch_src_global generation:  0.0021042823791503906
r_  generation:  0.022150039672851562
local_output_nid generation:  0.0030536651611328125
local_in_edges_tensor generation:  0.0016942024230957031
mini_batch_src_global generation:  0.0017025470733642578
r_  generation:  0.021226882934570312
local_output_nid generation:  0.00307464599609375
local_in_edges_tensor generation:  0.001634836196899414
mini_batch_src_global generation:  0.0017862319946289062
r_  generation:  0.021687746047973633
local_output_nid generation:  0.002959728240966797
local_in_edges_tensor generation:  0.0016849040985107422
mini_batch_src_global generation:  0.0018296241760253906
r_  generation:  0.022747278213500977
local_output_nid generation:  0.0029926300048828125
local_in_edges_tensor generation:  0.0016558170318603516
mini_batch_src_global generation:  0.0018181800842285156
r_  generation:  0.021706342697143555
local_output_nid generation:  0.003063678741455078
local_in_edges_tensor generation:  0.0016546249389648438
mini_batch_src_global generation:  0.0018601417541503906
r_  generation:  0.022516250610351562
local_output_nid generation:  0.0030083656311035156
local_in_edges_tensor generation:  0.0015666484832763672
mini_batch_src_global generation:  0.0018301010131835938
r_  generation:  0.022642850875854492
local_output_nid generation:  0.0030641555786132812
local_in_edges_tensor generation:  0.0015559196472167969
mini_batch_src_global generation:  0.0018069744110107422
r_  generation:  0.022866249084472656
local_output_nid generation:  0.003023862838745117
local_in_edges_tensor generation:  0.0016150474548339844
mini_batch_src_global generation:  0.001811981201171875
r_  generation:  0.022188425064086914
local_output_nid generation:  0.002984762191772461
local_in_edges_tensor generation:  0.0016269683837890625
mini_batch_src_global generation:  0.0017817020416259766
r_  generation:  0.02230668067932129
local_output_nid generation:  0.002987384796142578
local_in_edges_tensor generation:  0.0016052722930908203
mini_batch_src_global generation:  0.0017781257629394531
r_  generation:  0.02224564552307129
local_output_nid generation:  0.003012418746948242
local_in_edges_tensor generation:  0.0015940666198730469
mini_batch_src_global generation:  0.0017590522766113281
r_  generation:  0.022252798080444336
local_output_nid generation:  0.0029773712158203125
local_in_edges_tensor generation:  0.001561880111694336
mini_batch_src_global generation:  0.0017862319946289062
r_  generation:  0.022662878036499023
local_output_nid generation:  0.0030508041381835938
local_in_edges_tensor generation:  0.001539468765258789
mini_batch_src_global generation:  0.001802682876586914
r_  generation:  0.022502899169921875
local_output_nid generation:  0.003233194351196289
local_in_edges_tensor generation:  0.0015954971313476562
mini_batch_src_global generation:  0.0018045902252197266
r_  generation:  0.022440195083618164
----------------------check_connections_block total spend ----------------------------- 0.578965425491333
generate_one_block  0.03059244155883789
generate_one_block  0.03190779685974121
generate_one_block  0.030829429626464844
generate_one_block  0.031297922134399414
generate_one_block  0.033406972885131836
generate_one_block  0.03470158576965332
generate_one_block  0.031653642654418945
generate_one_block  0.03205251693725586
generate_one_block  0.031386375427246094
generate_one_block  0.03121352195739746
generate_one_block  0.030957698822021484
generate_one_block  0.03141975402832031
generate_one_block  0.03132176399230957
generate_one_block  0.03205990791320801
generate_one_block  0.031179189682006836
generate_one_block  0.03166341781616211
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.039541006088256836
gen group dst list time:  0.021462678909301758
time for parepare:  0.020900249481201172
local_output_nid generation:  0.009025335311889648
local_in_edges_tensor generation:  0.029596805572509766
mini_batch_src_global generation:  0.026488065719604492
r_  generation:  0.24837660789489746
local_output_nid generation:  0.013234853744506836
local_in_edges_tensor generation:  0.018988847732543945
mini_batch_src_global generation:  0.03199410438537598
r_  generation:  0.25716209411621094
local_output_nid generation:  0.012916803359985352
local_in_edges_tensor generation:  0.01499629020690918
mini_batch_src_global generation:  0.03148531913757324
r_  generation:  0.26305341720581055
local_output_nid generation:  0.013929605484008789
local_in_edges_tensor generation:  0.016263723373413086
mini_batch_src_global generation:  0.03341102600097656
r_  generation:  0.26801562309265137
local_output_nid generation:  0.014046907424926758
local_in_edges_tensor generation:  0.01821112632751465
mini_batch_src_global generation:  0.03551530838012695
r_  generation:  0.2784097194671631
local_output_nid generation:  0.013433456420898438
local_in_edges_tensor generation:  0.014323234558105469
mini_batch_src_global generation:  0.03343534469604492
r_  generation:  0.266521692276001
local_output_nid generation:  0.015829801559448242
local_in_edges_tensor generation:  0.014188051223754883
mini_batch_src_global generation:  0.03439188003540039
r_  generation:  0.27772998809814453
local_output_nid generation:  0.013958215713500977
local_in_edges_tensor generation:  0.01599884033203125
mini_batch_src_global generation:  0.03426694869995117
r_  generation:  0.27456068992614746
local_output_nid generation:  0.01392221450805664
local_in_edges_tensor generation:  0.014254093170166016
mini_batch_src_global generation:  0.03756093978881836
r_  generation:  0.27866387367248535
local_output_nid generation:  0.01394796371459961
local_in_edges_tensor generation:  0.014190435409545898
mini_batch_src_global generation:  0.03613471984863281
r_  generation:  0.2780897617340088
local_output_nid generation:  0.013339757919311523
local_in_edges_tensor generation:  0.013953924179077148
mini_batch_src_global generation:  0.03448319435119629
r_  generation:  0.2756040096282959
local_output_nid generation:  0.013771533966064453
local_in_edges_tensor generation:  0.013933897018432617
mini_batch_src_global generation:  0.03582596778869629
r_  generation:  0.2810537815093994
local_output_nid generation:  0.014211416244506836
local_in_edges_tensor generation:  0.014326333999633789
mini_batch_src_global generation:  0.03557443618774414
r_  generation:  0.2806825637817383
local_output_nid generation:  0.015100240707397461
local_in_edges_tensor generation:  0.015781402587890625
mini_batch_src_global generation:  0.03609824180603027
r_  generation:  0.2809598445892334
local_output_nid generation:  0.013612031936645508
local_in_edges_tensor generation:  0.018009662628173828
mini_batch_src_global generation:  0.03516221046447754
r_  generation:  0.2782173156738281
local_output_nid generation:  0.013486385345458984
local_in_edges_tensor generation:  0.016983985900878906
mini_batch_src_global generation:  0.036398887634277344
r_  generation:  0.282651424407959
----------------------check_connections_block total spend ----------------------------- 6.352945327758789
generate_one_block  0.3616044521331787
generate_one_block  0.3551599979400635
generate_one_block  0.3594396114349365
generate_one_block  0.35660266876220703
generate_one_block  0.36358642578125
generate_one_block  0.34825682640075684
generate_one_block  0.3938016891479492
generate_one_block  0.35431814193725586
generate_one_block  0.3562886714935303
generate_one_block  0.35167479515075684
generate_one_block  0.3500075340270996
generate_one_block  0.3554069995880127
generate_one_block  0.35483694076538086
generate_one_block  0.3663327693939209
generate_one_block  0.34995031356811523
generate_one_block  0.3636496067047119
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05023980140686035
gen group dst list time:  0.07554149627685547
time for parepare:  0.022369384765625
local_output_nid generation:  0.03787398338317871
local_in_edges_tensor generation:  0.06651091575622559
mini_batch_src_global generation:  0.05234408378601074
r_  generation:  0.5360867977142334
local_output_nid generation:  0.03684592247009277
local_in_edges_tensor generation:  0.050063371658325195
mini_batch_src_global generation:  0.06923866271972656
r_  generation:  0.5555226802825928
local_output_nid generation:  0.03599739074707031
local_in_edges_tensor generation:  0.04841899871826172
mini_batch_src_global generation:  0.0697472095489502
r_  generation:  0.5410676002502441
local_output_nid generation:  0.037831783294677734
local_in_edges_tensor generation:  0.03756451606750488
mini_batch_src_global generation:  0.06230473518371582
r_  generation:  0.5386505126953125
local_output_nid generation:  0.03743600845336914
local_in_edges_tensor generation:  0.11355042457580566
mini_batch_src_global generation:  0.06092548370361328
r_  generation:  0.5412197113037109
local_output_nid generation:  0.035208940505981445
local_in_edges_tensor generation:  0.032494306564331055
mini_batch_src_global generation:  0.06159019470214844
r_  generation:  0.5431406497955322
local_output_nid generation:  0.03315877914428711
local_in_edges_tensor generation:  0.03614044189453125
mini_batch_src_global generation:  0.061380624771118164
r_  generation:  0.5475692749023438
local_output_nid generation:  0.034360408782958984
local_in_edges_tensor generation:  0.03663372993469238
mini_batch_src_global generation:  0.06665277481079102
r_  generation:  0.546550989151001
local_output_nid generation:  0.033841609954833984
local_in_edges_tensor generation:  0.04271960258483887
mini_batch_src_global generation:  0.0629265308380127
r_  generation:  0.5467789173126221
local_output_nid generation:  0.03382372856140137
local_in_edges_tensor generation:  0.040206193923950195
mini_batch_src_global generation:  0.06711268424987793
r_  generation:  0.5578067302703857
local_output_nid generation:  0.03584599494934082
local_in_edges_tensor generation:  0.03705859184265137
mini_batch_src_global generation:  0.06468534469604492
r_  generation:  0.5388259887695312
local_output_nid generation:  0.034265995025634766
local_in_edges_tensor generation:  0.0340266227722168
mini_batch_src_global generation:  0.06630301475524902
r_  generation:  0.5436050891876221
local_output_nid generation:  0.034360647201538086
local_in_edges_tensor generation:  0.03887367248535156
mini_batch_src_global generation:  0.06158089637756348
r_  generation:  0.552947998046875
local_output_nid generation:  0.03440046310424805
local_in_edges_tensor generation:  0.031929731369018555
mini_batch_src_global generation:  0.06250762939453125
r_  generation:  0.5484979152679443
local_output_nid generation:  0.03439450263977051
local_in_edges_tensor generation:  0.03228020668029785
mini_batch_src_global generation:  0.06238722801208496
r_  generation:  0.5454113483428955
local_output_nid generation:  0.03538155555725098
local_in_edges_tensor generation:  0.03214716911315918
mini_batch_src_global generation:  0.06290245056152344
r_  generation:  0.5496692657470703
----------------------check_connections_block total spend ----------------------------- 12.983442306518555
generate_one_block  0.7001168727874756
generate_one_block  0.6958982944488525
generate_one_block  0.6977686882019043
generate_one_block  0.6976327896118164
generate_one_block  0.6982460021972656
generate_one_block  0.6878697872161865
generate_one_block  0.6871621608734131
generate_one_block  0.689755916595459
generate_one_block  0.7278475761413574
generate_one_block  0.6845166683197021
generate_one_block  0.684995174407959
generate_one_block  0.6952204704284668
generate_one_block  0.690901517868042
generate_one_block  0.6926538944244385
generate_one_block  0.6875259876251221
generate_one_block  0.7077713012695312
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.1284017562866211  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

connection checking time:  19.336387634277344
block generation total time  16.866800546646118
average batch blocks generation time:  1.0541750341653824
block dataloader generation time/epoch 38.22105884552002
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.0995798110961914  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7661223411560059  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09978866577148438  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7693595886230469  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.099761962890625  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.768834114074707  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09979438781738281  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7765679359436035  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09990596771240234  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7808904647827148  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09963512420654297  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7667932510375977  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.0998835563659668  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.777184009552002  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09965848922729492  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.771641731262207  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10085773468017578  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7804803848266602  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09971952438354492  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7726607322692871  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09961509704589844  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7694492340087891  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09969711303710938  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7714924812316895  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09972429275512695  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7717089653015137  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09993505477905273  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7798104286193848  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.0997314453125  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7711162567138672  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09995174407958984  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7807021141052246  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06843674182891846 |0.014967367053031921 |0.0033446848392486572 |8.918344974517822e-05 |0.003737717866897583 |0.001316070556640625 |
----------------------------------------------------------pseudo_mini_loss sum 1.4835177659988403
Total (block generation + training)time/epoch 39.73315632343292
Training time/epoch 1.5141096115112305
Training time without block to device /epoch 1.2746317386627197
Training time without total dataloading part /epoch 0.11606144905090332
load block tensor time/epoch 1.0949878692626953
block to device time/epoch 0.23947787284851074
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 13 |
Number of nodes for computation during this epoch:  5330410
Number of first layer input nodes during this epoch:  2521361
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.12960290908813477  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.028590679168701172
random selection method range initialization spend 0.00704503059387207
time for parepare:  0.018186092376708984
local_output_nid generation:  0.0022971630096435547
local_in_edges_tensor generation:  0.006647348403930664
mini_batch_src_global generation:  0.0023174285888671875
r_  generation:  0.022822856903076172
local_output_nid generation:  0.0028302669525146484
local_in_edges_tensor generation:  0.001888275146484375
mini_batch_src_global generation:  0.0021572113037109375
r_  generation:  0.02185964584350586
local_output_nid generation:  0.002948760986328125
local_in_edges_tensor generation:  0.0037147998809814453
mini_batch_src_global generation:  0.0018277168273925781
r_  generation:  0.021643400192260742
local_output_nid generation:  0.003061532974243164
local_in_edges_tensor generation:  0.002039670944213867
mini_batch_src_global generation:  0.0018432140350341797
r_  generation:  0.022176742553710938
local_output_nid generation:  0.003063678741455078
local_in_edges_tensor generation:  0.001743316650390625
mini_batch_src_global generation:  0.0017969608306884766
r_  generation:  0.02169322967529297
local_output_nid generation:  0.0029973983764648438
local_in_edges_tensor generation:  0.0016531944274902344
mini_batch_src_global generation:  0.0018696784973144531
r_  generation:  0.024566173553466797
local_output_nid generation:  0.002993345260620117
local_in_edges_tensor generation:  0.0017158985137939453
mini_batch_src_global generation:  0.002198457717895508
r_  generation:  0.024085044860839844
local_output_nid generation:  0.0030035972595214844
local_in_edges_tensor generation:  0.0017685890197753906
mini_batch_src_global generation:  0.0022125244140625
r_  generation:  0.024819374084472656
local_output_nid generation:  0.0030062198638916016
local_in_edges_tensor generation:  0.0015912055969238281
mini_batch_src_global generation:  0.0021979808807373047
r_  generation:  0.0244448184967041
local_output_nid generation:  0.00308990478515625
local_in_edges_tensor generation:  0.0016744136810302734
mini_batch_src_global generation:  0.0021567344665527344
r_  generation:  0.02411365509033203
local_output_nid generation:  0.0029926300048828125
local_in_edges_tensor generation:  0.001645803451538086
mini_batch_src_global generation:  0.0022411346435546875
r_  generation:  0.024828672409057617
local_output_nid generation:  0.0029687881469726562
local_in_edges_tensor generation:  0.0016291141510009766
mini_batch_src_global generation:  0.002167224884033203
r_  generation:  0.024152755737304688
local_output_nid generation:  0.0030732154846191406
local_in_edges_tensor generation:  0.0015950202941894531
mini_batch_src_global generation:  0.0022211074829101562
r_  generation:  0.024918794631958008
local_output_nid generation:  0.0030052661895751953
local_in_edges_tensor generation:  0.0016298294067382812
mini_batch_src_global generation:  0.002218961715698242
r_  generation:  0.0247189998626709
local_output_nid generation:  0.0029993057250976562
local_in_edges_tensor generation:  0.0015985965728759766
mini_batch_src_global generation:  0.002209901809692383
r_  generation:  0.024749755859375
local_output_nid generation:  0.003021240234375
local_in_edges_tensor generation:  0.001651763916015625
mini_batch_src_global generation:  0.002229928970336914
r_  generation:  0.024185895919799805
----------------------check_connections_block total spend ----------------------------- 0.6169681549072266
generate_one_block  0.03067326545715332
generate_one_block  0.03210854530334473
generate_one_block  0.03325796127319336
generate_one_block  0.033669233322143555
generate_one_block  0.03286099433898926
generate_one_block  0.03508806228637695
generate_one_block  0.031063556671142578
generate_one_block  0.032068729400634766
generate_one_block  0.030976057052612305
generate_one_block  0.030716896057128906
generate_one_block  0.032045602798461914
generate_one_block  0.031343698501586914
generate_one_block  0.03204655647277832
generate_one_block  0.031861066818237305
generate_one_block  0.031672000885009766
generate_one_block  0.03190970420837402
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03913259506225586
gen group dst list time:  0.01754474639892578
time for parepare:  0.019037246704101562
local_output_nid generation:  0.009306669235229492
local_in_edges_tensor generation:  0.024465322494506836
mini_batch_src_global generation:  0.026519298553466797
r_  generation:  0.24582600593566895
local_output_nid generation:  0.012824058532714844
local_in_edges_tensor generation:  0.01715230941772461
mini_batch_src_global generation:  0.032210588455200195
r_  generation:  0.24816060066223145
local_output_nid generation:  0.013182401657104492
local_in_edges_tensor generation:  0.01766371726989746
mini_batch_src_global generation:  0.03295540809631348
r_  generation:  0.2694249153137207
local_output_nid generation:  0.014892578125
local_in_edges_tensor generation:  0.021359682083129883
mini_batch_src_global generation:  0.037427425384521484
r_  generation:  0.27404093742370605
local_output_nid generation:  0.01402592658996582
local_in_edges_tensor generation:  0.01909184455871582
mini_batch_src_global generation:  0.03686118125915527
r_  generation:  0.2753474712371826
local_output_nid generation:  0.014189720153808594
local_in_edges_tensor generation:  0.017399072647094727
mini_batch_src_global generation:  0.03448033332824707
r_  generation:  0.27704596519470215
local_output_nid generation:  0.01372075080871582
local_in_edges_tensor generation:  0.015095710754394531
mini_batch_src_global generation:  0.03712797164916992
r_  generation:  0.26981210708618164
local_output_nid generation:  0.013994693756103516
local_in_edges_tensor generation:  0.01895427703857422
mini_batch_src_global generation:  0.03555130958557129
r_  generation:  0.27309727668762207
local_output_nid generation:  0.013569831848144531
local_in_edges_tensor generation:  0.01537632942199707
mini_batch_src_global generation:  0.03773093223571777
r_  generation:  0.26639604568481445
local_output_nid generation:  0.013692378997802734
local_in_edges_tensor generation:  0.014015674591064453
mini_batch_src_global generation:  0.03596997261047363
r_  generation:  0.26709747314453125
local_output_nid generation:  0.013407468795776367
local_in_edges_tensor generation:  0.015488862991333008
mini_batch_src_global generation:  0.03790426254272461
r_  generation:  0.2739381790161133
local_output_nid generation:  0.013803482055664062
local_in_edges_tensor generation:  0.013848066329956055
mini_batch_src_global generation:  0.03433394432067871
r_  generation:  0.2715489864349365
local_output_nid generation:  0.014090776443481445
local_in_edges_tensor generation:  0.01845717430114746
mini_batch_src_global generation:  0.03667473793029785
r_  generation:  0.2925596237182617
local_output_nid generation:  0.016527414321899414
local_in_edges_tensor generation:  0.018086910247802734
mini_batch_src_global generation:  0.04307246208190918
r_  generation:  0.27585840225219727
local_output_nid generation:  0.013711929321289062
local_in_edges_tensor generation:  0.014569997787475586
mini_batch_src_global generation:  0.03479814529418945
r_  generation:  0.27581214904785156
local_output_nid generation:  0.013338088989257812
local_in_edges_tensor generation:  0.014139652252197266
mini_batch_src_global generation:  0.03421425819396973
r_  generation:  0.2706718444824219
----------------------check_connections_block total spend ----------------------------- 6.326197624206543
generate_one_block  0.35039377212524414
generate_one_block  0.3393409252166748
generate_one_block  0.36049389839172363
generate_one_block  0.36029648780822754
generate_one_block  0.3501138687133789
generate_one_block  0.3588862419128418
generate_one_block  0.3801264762878418
generate_one_block  0.34917354583740234
generate_one_block  0.34662532806396484
generate_one_block  0.3445854187011719
generate_one_block  0.35019993782043457
generate_one_block  0.35013246536254883
generate_one_block  0.36232638359069824
generate_one_block  0.357011079788208
generate_one_block  0.3497159481048584
generate_one_block  0.345184326171875
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.041051626205444336
gen group dst list time:  0.06409263610839844
time for parepare:  0.01817798614501953
local_output_nid generation:  0.027540206909179688
local_in_edges_tensor generation:  0.055230140686035156
mini_batch_src_global generation:  0.052098751068115234
r_  generation:  0.5296144485473633
local_output_nid generation:  0.03275442123413086
local_in_edges_tensor generation:  0.04301595687866211
mini_batch_src_global generation:  0.06177043914794922
r_  generation:  0.5189406871795654
local_output_nid generation:  0.0329585075378418
local_in_edges_tensor generation:  0.03662538528442383
mini_batch_src_global generation:  0.05811667442321777
r_  generation:  0.5441956520080566
local_output_nid generation:  0.033063411712646484
local_in_edges_tensor generation:  0.040976762771606445
mini_batch_src_global generation:  0.06193876266479492
r_  generation:  0.5319795608520508
local_output_nid generation:  0.03318667411804199
local_in_edges_tensor generation:  0.07777929306030273
mini_batch_src_global generation:  0.06020164489746094
r_  generation:  0.54201340675354
local_output_nid generation:  0.033167123794555664
local_in_edges_tensor generation:  0.03515315055847168
mini_batch_src_global generation:  0.061399221420288086
r_  generation:  0.5338044166564941
local_output_nid generation:  0.03291940689086914
local_in_edges_tensor generation:  0.035477638244628906
mini_batch_src_global generation:  0.06083226203918457
r_  generation:  0.5455858707427979
local_output_nid generation:  0.033103227615356445
local_in_edges_tensor generation:  0.03533458709716797
mini_batch_src_global generation:  0.06148028373718262
r_  generation:  0.5336482524871826
local_output_nid generation:  0.03280138969421387
local_in_edges_tensor generation:  0.035190582275390625
mini_batch_src_global generation:  0.06039166450500488
r_  generation:  0.5435199737548828
local_output_nid generation:  0.03304553031921387
local_in_edges_tensor generation:  0.03300356864929199
mini_batch_src_global generation:  0.06146597862243652
r_  generation:  0.5349438190460205
local_output_nid generation:  0.03305554389953613
local_in_edges_tensor generation:  0.033284902572631836
mini_batch_src_global generation:  0.06027102470397949
r_  generation:  0.5449995994567871
local_output_nid generation:  0.03297829627990723
local_in_edges_tensor generation:  0.04099535942077637
mini_batch_src_global generation:  0.06398677825927734
r_  generation:  0.5372767448425293
local_output_nid generation:  0.032952070236206055
local_in_edges_tensor generation:  0.0329737663269043
mini_batch_src_global generation:  0.06107449531555176
r_  generation:  0.5438809394836426
local_output_nid generation:  0.0367434024810791
local_in_edges_tensor generation:  0.03325390815734863
mini_batch_src_global generation:  0.06185793876647949
r_  generation:  0.5380816459655762
local_output_nid generation:  0.03309440612792969
local_in_edges_tensor generation:  0.03592371940612793
mini_batch_src_global generation:  0.06022214889526367
r_  generation:  0.5436446666717529
local_output_nid generation:  0.03314852714538574
local_in_edges_tensor generation:  0.03603506088256836
mini_batch_src_global generation:  0.06496715545654297
r_  generation:  0.5356693267822266
----------------------check_connections_block total spend ----------------------------- 12.6366286277771
generate_one_block  0.6729066371917725
generate_one_block  0.6841669082641602
generate_one_block  0.6818079948425293
generate_one_block  0.6903166770935059
generate_one_block  0.6844210624694824
generate_one_block  0.6879401206970215
generate_one_block  0.6830592155456543
generate_one_block  0.6834533214569092
generate_one_block  0.7424883842468262
generate_one_block  0.6764495372772217
generate_one_block  0.6920781135559082
generate_one_block  0.685333251953125
generate_one_block  0.6916341781616211
generate_one_block  0.6847708225250244
generate_one_block  0.6755867004394531
generate_one_block  0.6761147975921631
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.12960290908813477  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

connection checking time:  18.962826251983643
block generation total time  16.647133827209473
average batch blocks generation time:  1.040445864200592
block dataloader generation time/epoch 38.16408243179321
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10071706771850586  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7748532295227051  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09935474395751953  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7586555480957031  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09975957870483398  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7781705856323242  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09986257553100586  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7777156829833984  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10085201263427734  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7735671997070312  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09995126724243164  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7819342613220215  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10070133209228516  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7728838920593262  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09992599487304688  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7774133682250977  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09961175918579102  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7669458389282227  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09967708587646484  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7668938636779785  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09978771209716797  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.772890567779541  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09983491897583008  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7739443778991699  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09990835189819336  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7766075134277344  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.0998845100402832  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7800765037536621  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09969186782836914  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7708783149719238  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09966850280761719  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7723684310913086  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0676741749048233 |0.016283750534057617 |0.003570765256881714 |9.21487808227539e-05 |0.0035749971866607666 |0.0017209053039550781 |
----------------------------------------------------------pseudo_mini_loss sum 1.4574217796325684
Total (block generation + training)time/epoch 39.67933411598206
Training time/epoch 1.527578353881836
Training time without block to device /epoch 1.267038345336914
Training time without total dataloading part /epoch 0.11752748489379883
load block tensor time/epoch 1.0827867984771729
block to device time/epoch 0.2605400085449219
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 14 |
Number of nodes for computation during this epoch:  5330970
Number of first layer input nodes during this epoch:  2521922
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.128265380859375  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023450851440429688
random selection method range initialization spend 0.005298614501953125
time for parepare:  0.018570423126220703
local_output_nid generation:  0.002450227737426758
local_in_edges_tensor generation:  0.0048828125
mini_batch_src_global generation:  0.0021669864654541016
r_  generation:  0.020567893981933594
local_output_nid generation:  0.002836465835571289
local_in_edges_tensor generation:  0.0017657279968261719
mini_batch_src_global generation:  0.002313852310180664
r_  generation:  0.022084712982177734
local_output_nid generation:  0.0030248165130615234
local_in_edges_tensor generation:  0.0017342567443847656
mini_batch_src_global generation:  0.0017499923706054688
r_  generation:  0.022305727005004883
local_output_nid generation:  0.0029659271240234375
local_in_edges_tensor generation:  0.001733541488647461
mini_batch_src_global generation:  0.0018091201782226562
r_  generation:  0.02149367332458496
local_output_nid generation:  0.002963542938232422
local_in_edges_tensor generation:  0.0016872882843017578
mini_batch_src_global generation:  0.0017533302307128906
r_  generation:  0.021215438842773438
local_output_nid generation:  0.002966165542602539
local_in_edges_tensor generation:  0.0017085075378417969
mini_batch_src_global generation:  0.0017914772033691406
r_  generation:  0.023015975952148438
local_output_nid generation:  0.0029900074005126953
local_in_edges_tensor generation:  0.0017056465148925781
mini_batch_src_global generation:  0.0018525123596191406
r_  generation:  0.022829532623291016
local_output_nid generation:  0.0029859542846679688
local_in_edges_tensor generation:  0.0017299652099609375
mini_batch_src_global generation:  0.0017914772033691406
r_  generation:  0.02198934555053711
local_output_nid generation:  0.0030753612518310547
local_in_edges_tensor generation:  0.0017406940460205078
mini_batch_src_global generation:  0.0018014907836914062
r_  generation:  0.022455930709838867
local_output_nid generation:  0.0029985904693603516
local_in_edges_tensor generation:  0.0017354488372802734
mini_batch_src_global generation:  0.0017552375793457031
r_  generation:  0.02185535430908203
local_output_nid generation:  0.0029757022857666016
local_in_edges_tensor generation:  0.0016536712646484375
mini_batch_src_global generation:  0.0018711090087890625
r_  generation:  0.02257990837097168
local_output_nid generation:  0.0029859542846679688
local_in_edges_tensor generation:  0.001708984375
mini_batch_src_global generation:  0.001802682876586914
r_  generation:  0.022980690002441406
local_output_nid generation:  0.0029718875885009766
local_in_edges_tensor generation:  0.0016536712646484375
mini_batch_src_global generation:  0.001764059066772461
r_  generation:  0.02118229866027832
local_output_nid generation:  0.0030612945556640625
local_in_edges_tensor generation:  0.0016777515411376953
mini_batch_src_global generation:  0.0017864704132080078
r_  generation:  0.023062705993652344
local_output_nid generation:  0.0031058788299560547
local_in_edges_tensor generation:  0.0016932487487792969
mini_batch_src_global generation:  0.0018124580383300781
r_  generation:  0.02216029167175293
local_output_nid generation:  0.0030608177185058594
local_in_edges_tensor generation:  0.001682281494140625
mini_batch_src_global generation:  0.0017867088317871094
r_  generation:  0.022503376007080078
----------------------check_connections_block total spend ----------------------------- 0.570519208908081
generate_one_block  0.030736684799194336
generate_one_block  0.03129744529724121
generate_one_block  0.03229212760925293
generate_one_block  0.030506134033203125
generate_one_block  0.03064274787902832
generate_one_block  0.03483414649963379
generate_one_block  0.032309532165527344
generate_one_block  0.030589580535888672
generate_one_block  0.0317385196685791
generate_one_block  0.03064584732055664
generate_one_block  0.03204178810119629
generate_one_block  0.032004594802856445
generate_one_block  0.030066967010498047
generate_one_block  0.03142523765563965
generate_one_block  0.03095388412475586
generate_one_block  0.0317082405090332
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.037492990493774414
gen group dst list time:  0.018874645233154297
time for parepare:  0.019368410110473633
local_output_nid generation:  0.009289741516113281
local_in_edges_tensor generation:  0.018787145614624023
mini_batch_src_global generation:  0.025569438934326172
r_  generation:  0.2507631778717041
local_output_nid generation:  0.013152599334716797
local_in_edges_tensor generation:  0.01884150505065918
mini_batch_src_global generation:  0.032959938049316406
r_  generation:  0.25470900535583496
local_output_nid generation:  0.01566338539123535
local_in_edges_tensor generation:  0.019553422927856445
mini_batch_src_global generation:  0.033521175384521484
r_  generation:  0.2713508605957031
local_output_nid generation:  0.013354063034057617
local_in_edges_tensor generation:  0.013767719268798828
mini_batch_src_global generation:  0.03251290321350098
r_  generation:  0.2614922523498535
local_output_nid generation:  0.013672351837158203
local_in_edges_tensor generation:  0.014176607131958008
mini_batch_src_global generation:  0.0327908992767334
r_  generation:  0.2666800022125244
local_output_nid generation:  0.014092445373535156
local_in_edges_tensor generation:  0.017024517059326172
mini_batch_src_global generation:  0.034247636795043945
r_  generation:  0.2775533199310303
local_output_nid generation:  0.013744115829467773
local_in_edges_tensor generation:  0.01672506332397461
mini_batch_src_global generation:  0.0346522331237793
r_  generation:  0.27796053886413574
local_output_nid generation:  0.013534307479858398
local_in_edges_tensor generation:  0.01388096809387207
mini_batch_src_global generation:  0.03395247459411621
r_  generation:  0.2708919048309326
local_output_nid generation:  0.013912439346313477
local_in_edges_tensor generation:  0.015992164611816406
mini_batch_src_global generation:  0.0354771614074707
r_  generation:  0.2794070243835449
local_output_nid generation:  0.014424800872802734
local_in_edges_tensor generation:  0.01404261589050293
mini_batch_src_global generation:  0.03359103202819824
r_  generation:  0.2689378261566162
local_output_nid generation:  0.013630390167236328
local_in_edges_tensor generation:  0.018697023391723633
mini_batch_src_global generation:  0.03458595275878906
r_  generation:  0.2808492183685303
local_output_nid generation:  0.016030550003051758
local_in_edges_tensor generation:  0.01797199249267578
mini_batch_src_global generation:  0.03510594367980957
r_  generation:  0.2803809642791748
local_output_nid generation:  0.015906095504760742
local_in_edges_tensor generation:  0.017589807510375977
mini_batch_src_global generation:  0.03574347496032715
r_  generation:  0.26881980895996094
local_output_nid generation:  0.014116525650024414
local_in_edges_tensor generation:  0.021796703338623047
mini_batch_src_global generation:  0.03490805625915527
r_  generation:  0.2802441120147705
local_output_nid generation:  0.013476133346557617
local_in_edges_tensor generation:  0.016604900360107422
mini_batch_src_global generation:  0.03713107109069824
r_  generation:  0.27489471435546875
local_output_nid generation:  0.01322627067565918
local_in_edges_tensor generation:  0.017420053482055664
mini_batch_src_global generation:  0.04417061805725098
r_  generation:  0.27815723419189453
----------------------check_connections_block total spend ----------------------------- 6.333422899246216
generate_one_block  0.3600425720214844
generate_one_block  0.3443915843963623
generate_one_block  0.365558385848999
generate_one_block  0.34245872497558594
generate_one_block  0.3498828411102295
generate_one_block  0.366558313369751
generate_one_block  0.40657496452331543
generate_one_block  0.35253238677978516
generate_one_block  0.35391688346862793
generate_one_block  0.34627437591552734
generate_one_block  0.3606994152069092
generate_one_block  0.36096715927124023
generate_one_block  0.3436250686645508
generate_one_block  0.35819220542907715
generate_one_block  0.3543825149536133
generate_one_block  0.3574531078338623
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03920459747314453
gen group dst list time:  0.06920313835144043
time for parepare:  0.020275115966796875
local_output_nid generation:  0.028135061264038086
local_in_edges_tensor generation:  0.05607128143310547
mini_batch_src_global generation:  0.050668954849243164
r_  generation:  0.5208516120910645
local_output_nid generation:  0.03271627426147461
local_in_edges_tensor generation:  0.04234433174133301
mini_batch_src_global generation:  0.0625767707824707
r_  generation:  0.5234420299530029
local_output_nid generation:  0.03475594520568848
local_in_edges_tensor generation:  0.03840517997741699
mini_batch_src_global generation:  0.0596621036529541
r_  generation:  0.5376651287078857
local_output_nid generation:  0.0328373908996582
local_in_edges_tensor generation:  0.043384552001953125
mini_batch_src_global generation:  0.07681655883789062
r_  generation:  0.5325243473052979
local_output_nid generation:  0.03525876998901367
local_in_edges_tensor generation:  0.09027314186096191
mini_batch_src_global generation:  0.06285977363586426
r_  generation:  0.5366113185882568
local_output_nid generation:  0.03307485580444336
local_in_edges_tensor generation:  0.03468918800354004
mini_batch_src_global generation:  0.06380605697631836
r_  generation:  0.5338921546936035
local_output_nid generation:  0.03307604789733887
local_in_edges_tensor generation:  0.03392839431762695
mini_batch_src_global generation:  0.060901641845703125
r_  generation:  0.5422501564025879
local_output_nid generation:  0.03270530700683594
local_in_edges_tensor generation:  0.032830238342285156
mini_batch_src_global generation:  0.06219220161437988
r_  generation:  0.5389044284820557
local_output_nid generation:  0.03293037414550781
local_in_edges_tensor generation:  0.03510761260986328
mini_batch_src_global generation:  0.06186866760253906
r_  generation:  0.5429668426513672
local_output_nid generation:  0.03290081024169922
local_in_edges_tensor generation:  0.03340554237365723
mini_batch_src_global generation:  0.06265521049499512
r_  generation:  0.5402877330780029
local_output_nid generation:  0.03330802917480469
local_in_edges_tensor generation:  0.035817861557006836
mini_batch_src_global generation:  0.06542849540710449
r_  generation:  0.5409319400787354
local_output_nid generation:  0.033098459243774414
local_in_edges_tensor generation:  0.03980612754821777
mini_batch_src_global generation:  0.06655359268188477
r_  generation:  0.5434403419494629
local_output_nid generation:  0.03281450271606445
local_in_edges_tensor generation:  0.03309059143066406
mini_batch_src_global generation:  0.06158924102783203
r_  generation:  0.5424978733062744
local_output_nid generation:  0.0343935489654541
local_in_edges_tensor generation:  0.03405141830444336
mini_batch_src_global generation:  0.06262588500976562
r_  generation:  0.5482528209686279
local_output_nid generation:  0.03323006629943848
local_in_edges_tensor generation:  0.03545260429382324
mini_batch_src_global generation:  0.061599016189575195
r_  generation:  0.540440559387207
local_output_nid generation:  0.03293657302856445
local_in_edges_tensor generation:  0.03537416458129883
mini_batch_src_global generation:  0.06608963012695312
r_  generation:  0.5378727912902832
----------------------check_connections_block total spend ----------------------------- 12.720385551452637
generate_one_block  0.6883237361907959
generate_one_block  0.6854918003082275
generate_one_block  0.6892855167388916
generate_one_block  0.6763722896575928
generate_one_block  0.6830587387084961
generate_one_block  0.6858217716217041
generate_one_block  0.6933541297912598
generate_one_block  0.6895473003387451
generate_one_block  0.7259321212768555
generate_one_block  0.6965444087982178
generate_one_block  0.6977403163909912
generate_one_block  0.6880745887756348
generate_one_block  0.6808440685272217
generate_one_block  0.6873767375946045
generate_one_block  0.6856734752655029
generate_one_block  0.6930286884307861
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.128265380859375  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

connection checking time:  19.053808450698853
block generation total time  16.76998019218445
average batch blocks generation time:  1.048123762011528
block dataloader generation time/epoch 38.15151552359263
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10082387924194336  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7760505676269531  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.0996403694152832  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7685942649841309  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10102462768554688  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.781494140625  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09951353073120117  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7653083801269531  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10068511962890625  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7707500457763672  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09980201721191406  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.775547981262207  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10092926025390625  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7818112373352051  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09973001480102539  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.768061637878418  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09979009628295898  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7759585380554199  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09947395324707031  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7648348808288574  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10094928741455078  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7825946807861328  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.0999140739440918  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7809052467346191  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09948205947875977  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7631731033325195  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09991121292114258  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7809224128723145  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09966039657592773  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7708783149719238  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.0996713638305664  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7725338935852051  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06274019181728363 |0.017058879137039185 |0.003533661365509033 |9.153783321380615e-05 |0.0033550113439559937 |0.0018084049224853516 |
----------------------------------------------------------pseudo_mini_loss sum 1.429046630859375
Total (block generation + training)time/epoch 39.65680185953776
Training time/epoch 1.4551706314086914
Training time without block to device /epoch 1.1822285652160645
Training time without total dataloading part /epoch 0.11349177360534668
load block tensor time/epoch 1.003843069076538
block to device time/epoch 0.27294206619262695
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 15 |
Number of nodes for computation during this epoch:  5330426
Number of first layer input nodes during this epoch:  2521471
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.12829875946044922  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024463415145874023
random selection method range initialization spend 0.005560636520385742
time for parepare:  0.018296003341674805
local_output_nid generation:  0.002347230911254883
local_in_edges_tensor generation:  0.0050356388092041016
mini_batch_src_global generation:  0.0018312931060791016
r_  generation:  0.02091217041015625
local_output_nid generation:  0.0029485225677490234
local_in_edges_tensor generation:  0.0017774105072021484
mini_batch_src_global generation:  0.0021162033081054688
r_  generation:  0.02262401580810547
local_output_nid generation:  0.003017902374267578
local_in_edges_tensor generation:  0.0017421245574951172
mini_batch_src_global generation:  0.0017421245574951172
r_  generation:  0.02211618423461914
local_output_nid generation:  0.0030536651611328125
local_in_edges_tensor generation:  0.0017311573028564453
mini_batch_src_global generation:  0.0017380714416503906
r_  generation:  0.02131175994873047
local_output_nid generation:  0.0030324459075927734
local_in_edges_tensor generation:  0.0017120838165283203
mini_batch_src_global generation:  0.0018110275268554688
r_  generation:  0.02233123779296875
local_output_nid generation:  0.003001689910888672
local_in_edges_tensor generation:  0.0017151832580566406
mini_batch_src_global generation:  0.0018455982208251953
r_  generation:  0.02403879165649414
local_output_nid generation:  0.0030374526977539062
local_in_edges_tensor generation:  0.001737833023071289
mini_batch_src_global generation:  0.0017964839935302734
r_  generation:  0.022154808044433594
local_output_nid generation:  0.0030090808868408203
local_in_edges_tensor generation:  0.001711130142211914
mini_batch_src_global generation:  0.001802206039428711
r_  generation:  0.021911144256591797
local_output_nid generation:  0.0030205249786376953
local_in_edges_tensor generation:  0.0017044544219970703
mini_batch_src_global generation:  0.0017955303192138672
r_  generation:  0.02196788787841797
local_output_nid generation:  0.004505634307861328
local_in_edges_tensor generation:  0.0016813278198242188
mini_batch_src_global generation:  0.001783609390258789
r_  generation:  0.022188186645507812
local_output_nid generation:  0.0029969215393066406
local_in_edges_tensor generation:  0.001703023910522461
mini_batch_src_global generation:  0.0017693042755126953
r_  generation:  0.022431612014770508
local_output_nid generation:  0.003032684326171875
local_in_edges_tensor generation:  0.001661062240600586
mini_batch_src_global generation:  0.0017712116241455078
r_  generation:  0.022122621536254883
local_output_nid generation:  0.0029914379119873047
local_in_edges_tensor generation:  0.003055572509765625
mini_batch_src_global generation:  0.0017986297607421875
r_  generation:  0.022783279418945312
local_output_nid generation:  0.0031270980834960938
local_in_edges_tensor generation:  0.0016515254974365234
mini_batch_src_global generation:  0.0017743110656738281
r_  generation:  0.02220749855041504
local_output_nid generation:  0.0031175613403320312
local_in_edges_tensor generation:  0.001651763916015625
mini_batch_src_global generation:  0.001753091812133789
r_  generation:  0.02209782600402832
local_output_nid generation:  0.003086566925048828
local_in_edges_tensor generation:  0.0016565322875976562
mini_batch_src_global generation:  0.0017910003662109375
r_  generation:  0.022443771362304688
----------------------check_connections_block total spend ----------------------------- 0.5756535530090332
generate_one_block  0.03047037124633789
generate_one_block  0.031368255615234375
generate_one_block  0.03149676322937012
generate_one_block  0.031190156936645508
generate_one_block  0.031786203384399414
generate_one_block  0.035630226135253906
generate_one_block  0.03178739547729492
generate_one_block  0.03136920928955078
generate_one_block  0.031205177307128906
generate_one_block  0.030976295471191406
generate_one_block  0.031252384185791016
generate_one_block  0.033895015716552734
generate_one_block  0.03225207328796387
generate_one_block  0.031307220458984375
generate_one_block  0.031122922897338867
generate_one_block  0.034256935119628906
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04184603691101074
gen group dst list time:  0.018194913864135742
time for parepare:  0.022738218307495117
local_output_nid generation:  0.009766578674316406
local_in_edges_tensor generation:  0.02640247344970703
mini_batch_src_global generation:  0.026400327682495117
r_  generation:  0.25311946868896484
local_output_nid generation:  0.013628959655761719
local_in_edges_tensor generation:  0.021105051040649414
mini_batch_src_global generation:  0.035841941833496094
r_  generation:  0.269726037979126
local_output_nid generation:  0.01422882080078125
local_in_edges_tensor generation:  0.019564390182495117
mini_batch_src_global generation:  0.032869577407836914
r_  generation:  0.2680339813232422
local_output_nid generation:  0.015675783157348633
local_in_edges_tensor generation:  0.018594980239868164
mini_batch_src_global generation:  0.03280019760131836
r_  generation:  0.27742624282836914
local_output_nid generation:  0.016611814498901367
local_in_edges_tensor generation:  0.019428491592407227
mini_batch_src_global generation:  0.034920692443847656
r_  generation:  0.27402162551879883
local_output_nid generation:  0.014307022094726562
local_in_edges_tensor generation:  0.016011714935302734
mini_batch_src_global generation:  0.03359055519104004
r_  generation:  0.2703380584716797
local_output_nid generation:  0.014348268508911133
local_in_edges_tensor generation:  0.014187335968017578
mini_batch_src_global generation:  0.03371095657348633
r_  generation:  0.2692992687225342
local_output_nid generation:  0.01417398452758789
local_in_edges_tensor generation:  0.014097213745117188
mini_batch_src_global generation:  0.03347206115722656
r_  generation:  0.26805996894836426
local_output_nid generation:  0.014446020126342773
local_in_edges_tensor generation:  0.014107704162597656
mini_batch_src_global generation:  0.033910274505615234
r_  generation:  0.2727375030517578
local_output_nid generation:  0.014260292053222656
local_in_edges_tensor generation:  0.013988733291625977
mini_batch_src_global generation:  0.03388261795043945
r_  generation:  0.2762143611907959
local_output_nid generation:  0.013712167739868164
local_in_edges_tensor generation:  0.014330625534057617
mini_batch_src_global generation:  0.034339189529418945
r_  generation:  0.27471923828125
local_output_nid generation:  0.025658369064331055
local_in_edges_tensor generation:  0.013922452926635742
mini_batch_src_global generation:  0.03419780731201172
r_  generation:  0.27638912200927734
local_output_nid generation:  0.014396429061889648
local_in_edges_tensor generation:  0.01856517791748047
mini_batch_src_global generation:  0.036037445068359375
r_  generation:  0.2818925380706787
local_output_nid generation:  0.014301538467407227
local_in_edges_tensor generation:  0.01683950424194336
mini_batch_src_global generation:  0.03562355041503906
r_  generation:  0.27654528617858887
local_output_nid generation:  0.01401519775390625
local_in_edges_tensor generation:  0.014794588088989258
mini_batch_src_global generation:  0.03608894348144531
r_  generation:  0.27597546577453613
local_output_nid generation:  0.014484405517578125
local_in_edges_tensor generation:  0.020930051803588867
mini_batch_src_global generation:  0.03639554977416992
r_  generation:  0.2754652500152588
----------------------check_connections_block total spend ----------------------------- 6.367960453033447
generate_one_block  0.3644406795501709
generate_one_block  0.36118316650390625
generate_one_block  0.3645515441894531
generate_one_block  0.34737539291381836
generate_one_block  0.3578176498413086
generate_one_block  0.35037922859191895
generate_one_block  0.3763918876647949
generate_one_block  0.34394240379333496
generate_one_block  0.3477444648742676
generate_one_block  0.35474371910095215
generate_one_block  0.3588533401489258
generate_one_block  0.3530862331390381
generate_one_block  0.3604135513305664
generate_one_block  0.35355448722839355
generate_one_block  0.34587955474853516
generate_one_block  0.3474898338317871
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.041289567947387695
gen group dst list time:  0.06440019607543945
time for parepare:  0.01781487464904785
local_output_nid generation:  0.027899742126464844
local_in_edges_tensor generation:  0.060942649841308594
mini_batch_src_global generation:  0.05176711082458496
r_  generation:  0.5258660316467285
local_output_nid generation:  0.03350830078125
local_in_edges_tensor generation:  0.04013657569885254
mini_batch_src_global generation:  0.06535816192626953
r_  generation:  0.5290687084197998
local_output_nid generation:  0.03328371047973633
local_in_edges_tensor generation:  0.04024863243103027
mini_batch_src_global generation:  0.06249570846557617
r_  generation:  0.5353760719299316
local_output_nid generation:  0.03346395492553711
local_in_edges_tensor generation:  0.038541316986083984
mini_batch_src_global generation:  0.06024003028869629
r_  generation:  0.5334680080413818
local_output_nid generation:  0.03399801254272461
local_in_edges_tensor generation:  0.08343124389648438
mini_batch_src_global generation:  0.0616917610168457
r_  generation:  0.5438432693481445
local_output_nid generation:  0.03295326232910156
local_in_edges_tensor generation:  0.04292011260986328
mini_batch_src_global generation:  0.06182575225830078
r_  generation:  0.5448260307312012
local_output_nid generation:  0.03276944160461426
local_in_edges_tensor generation:  0.0385591983795166
mini_batch_src_global generation:  0.06404232978820801
r_  generation:  0.5466017723083496
local_output_nid generation:  0.033135414123535156
local_in_edges_tensor generation:  0.03711843490600586
mini_batch_src_global generation:  0.06234431266784668
r_  generation:  0.56471848487854
local_output_nid generation:  0.03628969192504883
local_in_edges_tensor generation:  0.03838348388671875
mini_batch_src_global generation:  0.06573867797851562
r_  generation:  0.5457155704498291
local_output_nid generation:  0.0339508056640625
local_in_edges_tensor generation:  0.034390926361083984
mini_batch_src_global generation:  0.06294989585876465
r_  generation:  0.5390315055847168
local_output_nid generation:  0.0338437557220459
local_in_edges_tensor generation:  0.035887718200683594
mini_batch_src_global generation:  0.06166386604309082
r_  generation:  0.5413382053375244
local_output_nid generation:  0.03370499610900879
local_in_edges_tensor generation:  0.04102301597595215
mini_batch_src_global generation:  0.0653374195098877
r_  generation:  0.53912353515625
local_output_nid generation:  0.0339813232421875
local_in_edges_tensor generation:  0.033901214599609375
mini_batch_src_global generation:  0.06146502494812012
r_  generation:  0.5429942607879639
local_output_nid generation:  0.03409290313720703
local_in_edges_tensor generation:  0.03355836868286133
mini_batch_src_global generation:  0.062180519104003906
r_  generation:  0.5517063140869141
local_output_nid generation:  0.03372597694396973
local_in_edges_tensor generation:  0.037396907806396484
mini_batch_src_global generation:  0.06270647048950195
r_  generation:  0.5473260879516602
local_output_nid generation:  0.03377795219421387
local_in_edges_tensor generation:  0.035640716552734375
mini_batch_src_global generation:  0.06279325485229492
r_  generation:  0.5456829071044922
----------------------check_connections_block total spend ----------------------------- 12.82735538482666
generate_one_block  0.6937034130096436
generate_one_block  0.6855502128601074
generate_one_block  0.687859296798706
generate_one_block  0.6886401176452637
generate_one_block  0.6964585781097412
generate_one_block  0.6786303520202637
generate_one_block  0.6835789680480957
generate_one_block  0.6854202747344971
generate_one_block  0.7620508670806885
generate_one_block  0.6754279136657715
generate_one_block  0.6925015449523926
generate_one_block  0.6882903575897217
generate_one_block  0.6845118999481201
generate_one_block  0.6870348453521729
generate_one_block  0.6913986206054688
generate_one_block  0.6893348693847656
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.12829875946044922  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

connection checking time:  19.195315837860107
block generation total time  16.758239269256592
average batch blocks generation time:  1.047389954328537
block dataloader generation time/epoch 38.16134449413845
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09974384307861328  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7768316268920898  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09989166259765625  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7772836685180664  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09966421127319336  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7727656364440918  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09974288940429688  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.769050121307373  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10091018676757812  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7821602821350098  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09969806671142578  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7723217010498047  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09956502914428711  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7680487632751465  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09981107711791992  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7693367004394531  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09976482391357422  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7761950492858887  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09963607788085938  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7693557739257812  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.100799560546875  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7727890014648438  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.099639892578125  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7697458267211914  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09976434707641602  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7713804244995117  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09977579116821289  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7748427391052246  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09975767135620117  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7743792533874512  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09977054595947266  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.776127815246582  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06683634221553802 |0.018127411603927612 |0.0037422925233840942 |9.493529796600342e-05 |0.0035960227251052856 |0.003028392791748047 |
----------------------------------------------------------pseudo_mini_loss sum 1.4039196968078613
Total (block generation + training)time/epoch 39.68459752627781
Training time/epoch 1.6307826042175293
Training time without block to device /epoch 1.3407440185546875
Training time without total dataloading part /epoch 0.12196040153503418
load block tensor time/epoch 1.0693814754486084
block to device time/epoch 0.2900385856628418
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 16 |
Number of nodes for computation during this epoch:  5330595
Number of first layer input nodes during this epoch:  2521410
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.12844467163085938  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023436307907104492
random selection method range initialization spend 0.005635976791381836
time for parepare:  0.01974940299987793
local_output_nid generation:  0.002239227294921875
local_in_edges_tensor generation:  0.005368471145629883
mini_batch_src_global generation:  0.002124786376953125
r_  generation:  0.020540714263916016
local_output_nid generation:  0.0029141902923583984
local_in_edges_tensor generation:  0.0017750263214111328
mini_batch_src_global generation:  0.0023288726806640625
r_  generation:  0.022314786911010742
local_output_nid generation:  0.002972126007080078
local_in_edges_tensor generation:  0.0042209625244140625
mini_batch_src_global generation:  0.001817464828491211
r_  generation:  0.02238297462463379
local_output_nid generation:  0.003206491470336914
local_in_edges_tensor generation:  0.001722574234008789
mini_batch_src_global generation:  0.0018401145935058594
r_  generation:  0.022022485733032227
local_output_nid generation:  0.003014802932739258
local_in_edges_tensor generation:  0.0017304420471191406
mini_batch_src_global generation:  0.0017597675323486328
r_  generation:  0.021522045135498047
local_output_nid generation:  0.0030546188354492188
local_in_edges_tensor generation:  0.0017635822296142578
mini_batch_src_global generation:  0.0017812252044677734
r_  generation:  0.022613525390625
local_output_nid generation:  0.0030176639556884766
local_in_edges_tensor generation:  0.00174713134765625
mini_batch_src_global generation:  0.0018184185028076172
r_  generation:  0.022463560104370117
local_output_nid generation:  0.003004312515258789
local_in_edges_tensor generation:  0.001692056655883789
mini_batch_src_global generation:  0.001844644546508789
r_  generation:  0.022699832916259766
local_output_nid generation:  0.0030930042266845703
local_in_edges_tensor generation:  0.0016906261444091797
mini_batch_src_global generation:  0.0018241405487060547
r_  generation:  0.022208452224731445
local_output_nid generation:  0.0030012130737304688
local_in_edges_tensor generation:  0.0016679763793945312
mini_batch_src_global generation:  0.0018200874328613281
r_  generation:  0.022375106811523438
local_output_nid generation:  0.002979278564453125
local_in_edges_tensor generation:  0.0017080307006835938
mini_batch_src_global generation:  0.001787424087524414
r_  generation:  0.022736549377441406
local_output_nid generation:  0.0030176639556884766
local_in_edges_tensor generation:  0.0016655921936035156
mini_batch_src_global generation:  0.001867055892944336
r_  generation:  0.022695541381835938
local_output_nid generation:  0.0030450820922851562
local_in_edges_tensor generation:  0.0017085075378417969
mini_batch_src_global generation:  0.0018467903137207031
r_  generation:  0.022375822067260742
local_output_nid generation:  0.0030672550201416016
local_in_edges_tensor generation:  0.0017251968383789062
mini_batch_src_global generation:  0.001772165298461914
r_  generation:  0.021552324295043945
local_output_nid generation:  0.0029947757720947266
local_in_edges_tensor generation:  0.0016357898712158203
mini_batch_src_global generation:  0.0018057823181152344
r_  generation:  0.02261185646057129
local_output_nid generation:  0.0029897689819335938
local_in_edges_tensor generation:  0.0017118453979492188
mini_batch_src_global generation:  0.0018069744110107422
r_  generation:  0.021864652633666992
----------------------check_connections_block total spend ----------------------------- 0.5759506225585938
generate_one_block  0.03020501136779785
generate_one_block  0.0315248966217041
generate_one_block  0.03168082237243652
generate_one_block  0.03135228157043457
generate_one_block  0.031016111373901367
generate_one_block  0.03428220748901367
generate_one_block  0.03170204162597656
generate_one_block  0.03135824203491211
generate_one_block  0.03157973289489746
generate_one_block  0.03159809112548828
generate_one_block  0.0312197208404541
generate_one_block  0.03137540817260742
generate_one_block  0.031004905700683594
generate_one_block  0.03033304214477539
generate_one_block  0.03211355209350586
generate_one_block  0.03123617172241211
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04282021522521973
gen group dst list time:  0.018895864486694336
time for parepare:  0.019327878952026367
local_output_nid generation:  0.009168148040771484
local_in_edges_tensor generation:  0.02661728858947754
mini_batch_src_global generation:  0.025643587112426758
r_  generation:  0.2419300079345703
local_output_nid generation:  0.01317596435546875
local_in_edges_tensor generation:  0.019110918045043945
mini_batch_src_global generation:  0.03172612190246582
r_  generation:  0.25797224044799805
local_output_nid generation:  0.0133209228515625
local_in_edges_tensor generation:  0.01666259765625
mini_batch_src_global generation:  0.032685279846191406
r_  generation:  0.2675204277038574
local_output_nid generation:  0.014010190963745117
local_in_edges_tensor generation:  0.019348621368408203
mini_batch_src_global generation:  0.03232073783874512
r_  generation:  0.2683274745941162
local_output_nid generation:  0.013821601867675781
local_in_edges_tensor generation:  0.01654672622680664
mini_batch_src_global generation:  0.03320622444152832
r_  generation:  0.2708737850189209
local_output_nid generation:  0.013423919677734375
local_in_edges_tensor generation:  0.014014244079589844
mini_batch_src_global generation:  0.03510022163391113
r_  generation:  0.27156782150268555
local_output_nid generation:  0.013929605484008789
local_in_edges_tensor generation:  0.014289140701293945
mini_batch_src_global generation:  0.03432273864746094
r_  generation:  0.27771496772766113
local_output_nid generation:  0.01381373405456543
local_in_edges_tensor generation:  0.01424551010131836
mini_batch_src_global generation:  0.03386330604553223
r_  generation:  0.2766563892364502
local_output_nid generation:  0.014035224914550781
local_in_edges_tensor generation:  0.014598608016967773
mini_batch_src_global generation:  0.035147666931152344
r_  generation:  0.28065013885498047
local_output_nid generation:  0.013904094696044922
local_in_edges_tensor generation:  0.017980098724365234
mini_batch_src_global generation:  0.03439831733703613
r_  generation:  0.2766547203063965
local_output_nid generation:  0.01328420639038086
local_in_edges_tensor generation:  0.01429605484008789
mini_batch_src_global generation:  0.034592390060424805
r_  generation:  0.28255653381347656
local_output_nid generation:  0.014789342880249023
local_in_edges_tensor generation:  0.014521598815917969
mini_batch_src_global generation:  0.03604602813720703
r_  generation:  0.2808563709259033
local_output_nid generation:  0.01404261589050293
local_in_edges_tensor generation:  0.020688772201538086
mini_batch_src_global generation:  0.03497576713562012
r_  generation:  0.28350281715393066
local_output_nid generation:  0.013769149780273438
local_in_edges_tensor generation:  0.01790618896484375
mini_batch_src_global generation:  0.03497481346130371
r_  generation:  0.26678919792175293
local_output_nid generation:  0.014212369918823242
local_in_edges_tensor generation:  0.01609325408935547
mini_batch_src_global generation:  0.03671121597290039
r_  generation:  0.28798580169677734
local_output_nid generation:  0.013159036636352539
local_in_edges_tensor generation:  0.01565384864807129
mini_batch_src_global generation:  0.0352482795715332
r_  generation:  0.2695467472076416
----------------------check_connections_block total spend ----------------------------- 6.333367347717285
generate_one_block  0.34833383560180664
generate_one_block  0.35369300842285156
generate_one_block  0.35502076148986816
generate_one_block  0.35681653022766113
generate_one_block  0.34503769874572754
generate_one_block  0.3463175296783447
generate_one_block  0.38950324058532715
generate_one_block  0.3548393249511719
generate_one_block  0.358809232711792
generate_one_block  0.36194729804992676
generate_one_block  0.36679768562316895
generate_one_block  0.3613128662109375
generate_one_block  0.3623499870300293
generate_one_block  0.34114527702331543
generate_one_block  0.3668665885925293
generate_one_block  0.34589266777038574
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03941965103149414
gen group dst list time:  0.06944155693054199
time for parepare:  0.01871943473815918
local_output_nid generation:  0.027642250061035156
local_in_edges_tensor generation:  0.057073116302490234
mini_batch_src_global generation:  0.05065202713012695
r_  generation:  0.5281362533569336
local_output_nid generation:  0.03266787528991699
local_in_edges_tensor generation:  0.04251837730407715
mini_batch_src_global generation:  0.06272387504577637
r_  generation:  0.5235750675201416
local_output_nid generation:  0.03331422805786133
local_in_edges_tensor generation:  0.03938770294189453
mini_batch_src_global generation:  0.062499284744262695
r_  generation:  0.5421137809753418
local_output_nid generation:  0.03481245040893555
local_in_edges_tensor generation:  0.039038658142089844
mini_batch_src_global generation:  0.062439918518066406
r_  generation:  0.5331430435180664
local_output_nid generation:  0.03277015686035156
local_in_edges_tensor generation:  0.08715152740478516
mini_batch_src_global generation:  0.06037020683288574
r_  generation:  0.5431349277496338
local_output_nid generation:  0.032651662826538086
local_in_edges_tensor generation:  0.04515218734741211
mini_batch_src_global generation:  0.07330513000488281
r_  generation:  0.5406162738800049
local_output_nid generation:  0.03493356704711914
local_in_edges_tensor generation:  0.034966230392456055
mini_batch_src_global generation:  0.0633230209350586
r_  generation:  0.5455467700958252
local_output_nid generation:  0.033226966857910156
local_in_edges_tensor generation:  0.036296844482421875
mini_batch_src_global generation:  0.0647127628326416
r_  generation:  0.5349233150482178
local_output_nid generation:  0.034271955490112305
local_in_edges_tensor generation:  0.037976741790771484
mini_batch_src_global generation:  0.06195068359375
r_  generation:  0.5477509498596191
local_output_nid generation:  0.03340506553649902
local_in_edges_tensor generation:  0.03418564796447754
mini_batch_src_global generation:  0.06456995010375977
r_  generation:  0.5370306968688965
local_output_nid generation:  0.033571481704711914
local_in_edges_tensor generation:  0.0361781120300293
mini_batch_src_global generation:  0.06293153762817383
r_  generation:  0.5481240749359131
local_output_nid generation:  0.0333864688873291
local_in_edges_tensor generation:  0.03617143630981445
mini_batch_src_global generation:  0.07376408576965332
r_  generation:  0.5398454666137695
local_output_nid generation:  0.03367328643798828
local_in_edges_tensor generation:  0.036128997802734375
mini_batch_src_global generation:  0.06403088569641113
r_  generation:  0.5472862720489502
local_output_nid generation:  0.0338134765625
local_in_edges_tensor generation:  0.03432726860046387
mini_batch_src_global generation:  0.06413793563842773
r_  generation:  0.5371687412261963
local_output_nid generation:  0.033940792083740234
local_in_edges_tensor generation:  0.03329062461853027
mini_batch_src_global generation:  0.0613856315612793
r_  generation:  0.5479342937469482
local_output_nid generation:  0.03472137451171875
local_in_edges_tensor generation:  0.04113578796386719
mini_batch_src_global generation:  0.06267833709716797
r_  generation:  0.5431134700775146
----------------------check_connections_block total spend ----------------------------- 12.776042222976685
generate_one_block  0.6876809597015381
generate_one_block  0.6870448589324951
generate_one_block  0.6983578205108643
generate_one_block  0.6855959892272949
generate_one_block  0.6812677383422852
generate_one_block  0.6909453868865967
generate_one_block  0.6754059791564941
generate_one_block  0.67964768409729
generate_one_block  0.7256519794464111
generate_one_block  0.6848280429840088
generate_one_block  0.6892337799072266
generate_one_block  0.7035057544708252
generate_one_block  0.6853423118591309
generate_one_block  0.6804876327514648
generate_one_block  0.6977918148040771
generate_one_block  0.6987514495849609
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.12844467163085938  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

connection checking time:  19.10940957069397
block generation total time  16.766222715377808
average batch blocks generation time:  1.047888919711113
block dataloader generation time/epoch 38.161629647016525
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09946823120117188  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7655811309814453  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09967756271362305  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7705516815185547  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.100860595703125  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7809419631958008  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09986448287963867  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7772641181945801  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10066604614257812  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7706313133239746  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09980010986328125  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.775883674621582  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09981536865234375  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7697062492370605  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.0997767448425293  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7714371681213379  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10092639923095703  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7819757461547852  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09967517852783203  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7691802978515625  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09984397888183594  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7758002281188965  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.099853515625  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7739930152893066  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09972620010375977  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7725925445556641  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09948348999023438  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7629837989807129  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09998750686645508  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7778410911560059  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09964132308959961  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.768486499786377  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06730790436267853 |0.016385957598686218 |0.003489851951599121 |9.062886238098145e-05 |0.0036505162715911865 |0.001386880874633789 |
----------------------------------------------------------pseudo_mini_loss sum 1.3767964839935303
Total (block generation + training)time/epoch 39.684475779533386
Training time/epoch 1.519763708114624
Training time without block to device /epoch 1.2575883865356445
Training time without total dataloading part /epoch 0.11708283424377441
load block tensor time/epoch 1.0769264698028564
block to device time/epoch 0.2621753215789795
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 17 |
Number of nodes for computation during this epoch:  5330652
Number of first layer input nodes during this epoch:  2521523
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.12699604034423828  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02402353286743164
random selection method range initialization spend 0.006256580352783203
time for parepare:  0.019152164459228516
local_output_nid generation:  0.002279996871948242
local_in_edges_tensor generation:  0.005303382873535156
mini_batch_src_global generation:  0.0021505355834960938
r_  generation:  0.02308940887451172
local_output_nid generation:  0.002888917922973633
local_in_edges_tensor generation:  0.001722574234008789
mini_batch_src_global generation:  0.002492189407348633
r_  generation:  0.022366762161254883
local_output_nid generation:  0.0029418468475341797
local_in_edges_tensor generation:  0.0016827583312988281
mini_batch_src_global generation:  0.0016980171203613281
r_  generation:  0.021269798278808594
local_output_nid generation:  0.002969503402709961
local_in_edges_tensor generation:  0.0016579627990722656
mini_batch_src_global generation:  0.0017392635345458984
r_  generation:  0.021609067916870117
local_output_nid generation:  0.003065824508666992
local_in_edges_tensor generation:  0.0017409324645996094
mini_batch_src_global generation:  0.0017807483673095703
r_  generation:  0.021753787994384766
local_output_nid generation:  0.0030031204223632812
local_in_edges_tensor generation:  0.0016701221466064453
mini_batch_src_global generation:  0.0017445087432861328
r_  generation:  0.021886587142944336
local_output_nid generation:  0.0030591487884521484
local_in_edges_tensor generation:  0.0016603469848632812
mini_batch_src_global generation:  0.0017361640930175781
r_  generation:  0.02182292938232422
local_output_nid generation:  0.0030517578125
local_in_edges_tensor generation:  0.001729726791381836
mini_batch_src_global generation:  0.0017650127410888672
r_  generation:  0.021509408950805664
local_output_nid generation:  0.0029730796813964844
local_in_edges_tensor generation:  0.0016536712646484375
mini_batch_src_global generation:  0.0017368793487548828
r_  generation:  0.021105527877807617
local_output_nid generation:  0.002960681915283203
local_in_edges_tensor generation:  0.0016651153564453125
mini_batch_src_global generation:  0.0017194747924804688
r_  generation:  0.02206563949584961
local_output_nid generation:  0.003066539764404297
local_in_edges_tensor generation:  0.0016505718231201172
mini_batch_src_global generation:  0.0017383098602294922
r_  generation:  0.02146124839782715
local_output_nid generation:  0.0029718875885009766
local_in_edges_tensor generation:  0.0016834735870361328
mini_batch_src_global generation:  0.00179290771484375
r_  generation:  0.022499561309814453
local_output_nid generation:  0.002973318099975586
local_in_edges_tensor generation:  0.0016620159149169922
mini_batch_src_global generation:  0.0017299652099609375
r_  generation:  0.022177457809448242
local_output_nid generation:  0.002982616424560547
local_in_edges_tensor generation:  0.0016977787017822266
mini_batch_src_global generation:  0.0017402172088623047
r_  generation:  0.021645545959472656
local_output_nid generation:  0.0030694007873535156
local_in_edges_tensor generation:  0.0016777515411376953
mini_batch_src_global generation:  0.0017437934875488281
r_  generation:  0.0217437744140625
local_output_nid generation:  0.002969980239868164
local_in_edges_tensor generation:  0.0016846656799316406
mini_batch_src_global generation:  0.00174713134765625
r_  generation:  0.022564411163330078
----------------------check_connections_block total spend ----------------------------- 0.5653016567230225
generate_one_block  0.03491520881652832
generate_one_block  0.03181576728820801
generate_one_block  0.030888080596923828
generate_one_block  0.03145885467529297
generate_one_block  0.03104090690612793
generate_one_block  0.03358650207519531
generate_one_block  0.03113865852355957
generate_one_block  0.030912160873413086
generate_one_block  0.030257701873779297
generate_one_block  0.03099679946899414
generate_one_block  0.030671358108520508
generate_one_block  0.0319819450378418
generate_one_block  0.03062915802001953
generate_one_block  0.031002044677734375
generate_one_block  0.03108692169189453
generate_one_block  0.03218221664428711
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04104113578796387
gen group dst list time:  0.01779794692993164
time for parepare:  0.021046876907348633
local_output_nid generation:  0.009169340133666992
local_in_edges_tensor generation:  0.025066375732421875
mini_batch_src_global generation:  0.027078866958618164
r_  generation:  0.2502131462097168
local_output_nid generation:  0.01338648796081543
local_in_edges_tensor generation:  0.01644754409790039
mini_batch_src_global generation:  0.03342866897583008
r_  generation:  0.2635176181793213
local_output_nid generation:  0.012940645217895508
local_in_edges_tensor generation:  0.018268108367919922
mini_batch_src_global generation:  0.03454303741455078
r_  generation:  0.25878381729125977
local_output_nid generation:  0.01519465446472168
local_in_edges_tensor generation:  0.018650531768798828
mini_batch_src_global generation:  0.032973527908325195
r_  generation:  0.2656712532043457
local_output_nid generation:  0.013276815414428711
local_in_edges_tensor generation:  0.015095949172973633
mini_batch_src_global generation:  0.035558462142944336
r_  generation:  0.2705247402191162
local_output_nid generation:  0.01368093490600586
local_in_edges_tensor generation:  0.014337301254272461
mini_batch_src_global generation:  0.035066843032836914
r_  generation:  0.27440667152404785
local_output_nid generation:  0.01612710952758789
local_in_edges_tensor generation:  0.019618749618530273
mini_batch_src_global generation:  0.03457045555114746
r_  generation:  0.27156829833984375
local_output_nid generation:  0.013704061508178711
local_in_edges_tensor generation:  0.01654791831970215
mini_batch_src_global generation:  0.03795266151428223
r_  generation:  0.2737879753112793
local_output_nid generation:  0.013396739959716797
local_in_edges_tensor generation:  0.021379709243774414
mini_batch_src_global generation:  0.034798622131347656
r_  generation:  0.2785186767578125
local_output_nid generation:  0.01618790626525879
local_in_edges_tensor generation:  0.01574993133544922
mini_batch_src_global generation:  0.034032583236694336
r_  generation:  0.2682352066040039
local_output_nid generation:  0.013694524765014648
local_in_edges_tensor generation:  0.016211509704589844
mini_batch_src_global generation:  0.03407573699951172
r_  generation:  0.2670717239379883
local_output_nid generation:  0.014264822006225586
local_in_edges_tensor generation:  0.018850088119506836
mini_batch_src_global generation:  0.03600788116455078
r_  generation:  0.2774486541748047
local_output_nid generation:  0.013907194137573242
local_in_edges_tensor generation:  0.014060497283935547
mini_batch_src_global generation:  0.03510689735412598
r_  generation:  0.2673797607421875
local_output_nid generation:  0.013844966888427734
local_in_edges_tensor generation:  0.01587986946105957
mini_batch_src_global generation:  0.035390615463256836
r_  generation:  0.2664985656738281
local_output_nid generation:  0.013429880142211914
local_in_edges_tensor generation:  0.015119314193725586
mini_batch_src_global generation:  0.034375905990600586
r_  generation:  0.26907944679260254
local_output_nid generation:  0.013401508331298828
local_in_edges_tensor generation:  0.014746665954589844
mini_batch_src_global generation:  0.034705400466918945
r_  generation:  0.2853407859802246
----------------------check_connections_block total spend ----------------------------- 6.292855978012085
generate_one_block  0.3677046298980713
generate_one_block  0.3540489673614502
generate_one_block  0.3443949222564697
generate_one_block  0.34949564933776855
generate_one_block  0.349853515625
generate_one_block  0.34663844108581543
generate_one_block  0.3768432140350342
generate_one_block  0.35097241401672363
generate_one_block  0.3425624370574951
generate_one_block  0.34767675399780273
generate_one_block  0.3482027053833008
generate_one_block  0.36846280097961426
generate_one_block  0.34984683990478516
generate_one_block  0.34685611724853516
generate_one_block  0.3635673522949219
generate_one_block  0.3577690124511719
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.045038700103759766
gen group dst list time:  0.07216405868530273
time for parepare:  0.019078493118286133
local_output_nid generation:  0.028038501739501953
local_in_edges_tensor generation:  0.05914878845214844
mini_batch_src_global generation:  0.04892778396606445
r_  generation:  0.5179691314697266
local_output_nid generation:  0.03247690200805664
local_in_edges_tensor generation:  0.04280710220336914
mini_batch_src_global generation:  0.06177163124084473
r_  generation:  0.5181324481964111
local_output_nid generation:  0.03201460838317871
local_in_edges_tensor generation:  0.03375506401062012
mini_batch_src_global generation:  0.06021308898925781
r_  generation:  0.5290961265563965
local_output_nid generation:  0.03215813636779785
local_in_edges_tensor generation:  0.03392434120178223
mini_batch_src_global generation:  0.059198617935180664
r_  generation:  0.5251946449279785
local_output_nid generation:  0.03222846984863281
local_in_edges_tensor generation:  0.0850837230682373
mini_batch_src_global generation:  0.058965444564819336
r_  generation:  0.5355188846588135
local_output_nid generation:  0.03233695030212402
local_in_edges_tensor generation:  0.036087989807128906
mini_batch_src_global generation:  0.06134152412414551
r_  generation:  0.5293540954589844
local_output_nid generation:  0.03225827217102051
local_in_edges_tensor generation:  0.0338442325592041
mini_batch_src_global generation:  0.060289859771728516
r_  generation:  0.5377688407897949
local_output_nid generation:  0.03224444389343262
local_in_edges_tensor generation:  0.03891181945800781
mini_batch_src_global generation:  0.08844685554504395
r_  generation:  0.5501546859741211
local_output_nid generation:  0.03671717643737793
local_in_edges_tensor generation:  0.041787147521972656
mini_batch_src_global generation:  0.06933355331420898
r_  generation:  0.558621883392334
local_output_nid generation:  0.03371262550354004
local_in_edges_tensor generation:  0.04359316825866699
mini_batch_src_global generation:  0.08643174171447754
r_  generation:  0.558485746383667
local_output_nid generation:  0.03542494773864746
local_in_edges_tensor generation:  0.03941822052001953
mini_batch_src_global generation:  0.06712484359741211
r_  generation:  0.5509233474731445
local_output_nid generation:  0.03530311584472656
local_in_edges_tensor generation:  0.04022336006164551
mini_batch_src_global generation:  0.06776070594787598
r_  generation:  0.5439724922180176
local_output_nid generation:  0.034015655517578125
local_in_edges_tensor generation:  0.03348970413208008
mini_batch_src_global generation:  0.0631263256072998
r_  generation:  0.5411162376403809
local_output_nid generation:  0.034173011779785156
local_in_edges_tensor generation:  0.03509926795959473
mini_batch_src_global generation:  0.06568312644958496
r_  generation:  0.5508408546447754
local_output_nid generation:  0.034333229064941406
local_in_edges_tensor generation:  0.04104423522949219
mini_batch_src_global generation:  0.06589603424072266
r_  generation:  0.5448379516601562
local_output_nid generation:  0.03424715995788574
local_in_edges_tensor generation:  0.03689694404602051
mini_batch_src_global generation:  0.06430840492248535
r_  generation:  0.5414953231811523
----------------------check_connections_block total spend ----------------------------- 12.832178831100464
generate_one_block  0.6956729888916016
generate_one_block  0.7090344429016113
generate_one_block  0.6907451152801514
generate_one_block  0.6790785789489746
generate_one_block  0.6875574588775635
generate_one_block  0.7120015621185303
generate_one_block  0.6934604644775391
generate_one_block  0.6892578601837158
generate_one_block  0.7738840579986572
generate_one_block  0.7005207538604736
generate_one_block  0.6893751621246338
generate_one_block  0.6930131912231445
generate_one_block  0.6791727542877197
generate_one_block  0.6803693771362305
generate_one_block  0.6920785903930664
generate_one_block  0.7112476825714111
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.12699604034423828  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

connection checking time:  19.12503480911255
block generation total time  16.841365814208984
average batch blocks generation time:  1.0525853633880615
block dataloader generation time/epoch 38.174385441674126
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09990119934082031  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7783493995666504  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09988880157470703  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7815346717834473  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09956836700439453  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7636990547180176  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.0997152328491211  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7763748168945312  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09977388381958008  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7763357162475586  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09989166259765625  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.776364803314209  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09968709945678711  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7717552185058594  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09966611862182617  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7708210945129395  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09948492050170898  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.764228343963623  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.0998077392578125  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7762899398803711  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.0995945930480957  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7676577568054199  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10004615783691406  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7831325531005859  GigaBytes
Max Memory Allocated: 0.8724541664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09960174560546875  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.766636848449707  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09959888458251953  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7680759429931641  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09983205795288086  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7755560874938965  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09985828399658203  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7740411758422852  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06340964138507843 |0.01852676272392273 |0.0033751577138900757 |9.170174598693848e-05 |0.0035446733236312866 |0.001531839370727539 |
----------------------------------------------------------pseudo_mini_loss sum 1.357212781906128
Total (block generation + training)time/epoch 39.69358131620619
Training time/epoch 1.4897654056549072
Training time without block to device /epoch 1.1933372020721436
Training time without total dataloading part /epoch 0.11371636390686035
load block tensor time/epoch 1.0145542621612549
block to device time/epoch 0.29642820358276367
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 18 |
Number of nodes for computation during this epoch:  5329764
Number of first layer input nodes during this epoch:  2520607
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.12864208221435547  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02861309051513672
random selection method range initialization spend 0.006615877151489258
time for parepare:  0.02077031135559082
local_output_nid generation:  0.0023877620697021484
local_in_edges_tensor generation:  0.004996299743652344
mini_batch_src_global generation:  0.0020911693572998047
r_  generation:  0.022493600845336914
local_output_nid generation:  0.00283050537109375
local_in_edges_tensor generation:  0.0016744136810302734
mini_batch_src_global generation:  0.0024406909942626953
r_  generation:  0.022191762924194336
local_output_nid generation:  0.0030264854431152344
local_in_edges_tensor generation:  0.0017201900482177734
mini_batch_src_global generation:  0.001726388931274414
r_  generation:  0.02120351791381836
local_output_nid generation:  0.0029664039611816406
local_in_edges_tensor generation:  0.0016467571258544922
mini_batch_src_global generation:  0.0017237663269042969
r_  generation:  0.02124786376953125
local_output_nid generation:  0.0029582977294921875
local_in_edges_tensor generation:  0.0018618106842041016
mini_batch_src_global generation:  0.0018107891082763672
r_  generation:  0.02255702018737793
local_output_nid generation:  0.0031516551971435547
local_in_edges_tensor generation:  0.003139972686767578
mini_batch_src_global generation:  0.0017476081848144531
r_  generation:  0.021757841110229492
local_output_nid generation:  0.0030603408813476562
local_in_edges_tensor generation:  0.0017595291137695312
mini_batch_src_global generation:  0.0017390251159667969
r_  generation:  0.021885156631469727
local_output_nid generation:  0.002992868423461914
local_in_edges_tensor generation:  0.001767873764038086
mini_batch_src_global generation:  0.0017514228820800781
r_  generation:  0.022111892700195312
local_output_nid generation:  0.0030412673950195312
local_in_edges_tensor generation:  0.0017547607421875
mini_batch_src_global generation:  0.0017428398132324219
r_  generation:  0.021930932998657227
local_output_nid generation:  0.0030367374420166016
local_in_edges_tensor generation:  0.0016057491302490234
mini_batch_src_global generation:  0.00174713134765625
r_  generation:  0.02164912223815918
local_output_nid generation:  0.0030095577239990234
local_in_edges_tensor generation:  0.0015950202941894531
mini_batch_src_global generation:  0.0017704963684082031
r_  generation:  0.02414417266845703
local_output_nid generation:  0.003098011016845703
local_in_edges_tensor generation:  0.0016710758209228516
mini_batch_src_global generation:  0.0017993450164794922
r_  generation:  0.02259540557861328
local_output_nid generation:  0.003056049346923828
local_in_edges_tensor generation:  0.0016264915466308594
mini_batch_src_global generation:  0.0017731189727783203
r_  generation:  0.02163243293762207
local_output_nid generation:  0.0029816627502441406
local_in_edges_tensor generation:  0.001573324203491211
mini_batch_src_global generation:  0.0017409324645996094
r_  generation:  0.022115707397460938
local_output_nid generation:  0.0030107498168945312
local_in_edges_tensor generation:  0.0015964508056640625
mini_batch_src_global generation:  0.00174713134765625
r_  generation:  0.02239084243774414
local_output_nid generation:  0.0029938220977783203
local_in_edges_tensor generation:  0.0016393661499023438
mini_batch_src_global generation:  0.0017857551574707031
r_  generation:  0.022331953048706055
----------------------check_connections_block total spend ----------------------------- 0.5733938217163086
generate_one_block  0.03261160850524902
generate_one_block  0.03151345252990723
generate_one_block  0.03017139434814453
generate_one_block  0.03347349166870117
generate_one_block  0.03235316276550293
generate_one_block  0.034088850021362305
generate_one_block  0.03131699562072754
generate_one_block  0.03342390060424805
generate_one_block  0.03124713897705078
generate_one_block  0.03090834617614746
generate_one_block  0.032195329666137695
generate_one_block  0.031549692153930664
generate_one_block  0.030464887619018555
generate_one_block  0.03135275840759277
generate_one_block  0.03181719779968262
generate_one_block  0.03282976150512695
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.038130760192871094
gen group dst list time:  0.017679452896118164
time for parepare:  0.022000551223754883
local_output_nid generation:  0.009433507919311523
local_in_edges_tensor generation:  0.022884130477905273
mini_batch_src_global generation:  0.028873682022094727
r_  generation:  0.2402970790863037
local_output_nid generation:  0.012977123260498047
local_in_edges_tensor generation:  0.018382787704467773
mini_batch_src_global generation:  0.03262972831726074
r_  generation:  0.2546682357788086
local_output_nid generation:  0.012747526168823242
local_in_edges_tensor generation:  0.015568256378173828
mini_batch_src_global generation:  0.031247377395629883
r_  generation:  0.25854039192199707
local_output_nid generation:  0.013584375381469727
local_in_edges_tensor generation:  0.013606071472167969
mini_batch_src_global generation:  0.031455039978027344
r_  generation:  0.2597770690917969
local_output_nid generation:  0.013983726501464844
local_in_edges_tensor generation:  0.018513202667236328
mini_batch_src_global generation:  0.034989356994628906
r_  generation:  0.27228593826293945
local_output_nid generation:  0.013524293899536133
local_in_edges_tensor generation:  0.013409852981567383
mini_batch_src_global generation:  0.03336286544799805
r_  generation:  0.279921293258667
local_output_nid generation:  0.016095399856567383
local_in_edges_tensor generation:  0.01690673828125
mini_batch_src_global generation:  0.033933401107788086
r_  generation:  0.26698756217956543
local_output_nid generation:  0.01408529281616211
local_in_edges_tensor generation:  0.017190217971801758
mini_batch_src_global generation:  0.03401899337768555
r_  generation:  0.26846837997436523
local_output_nid generation:  0.014102458953857422
local_in_edges_tensor generation:  0.013890504837036133
mini_batch_src_global generation:  0.034267425537109375
r_  generation:  0.2664499282836914
local_output_nid generation:  0.01381826400756836
local_in_edges_tensor generation:  0.013598203659057617
mini_batch_src_global generation:  0.033608436584472656
r_  generation:  0.265439510345459
local_output_nid generation:  0.013499259948730469
local_in_edges_tensor generation:  0.016208171844482422
mini_batch_src_global generation:  0.036322832107543945
r_  generation:  0.27529263496398926
local_output_nid generation:  0.014229059219360352
local_in_edges_tensor generation:  0.014284133911132812
mini_batch_src_global generation:  0.03491616249084473
r_  generation:  0.27768945693969727
local_output_nid generation:  0.013976573944091797
local_in_edges_tensor generation:  0.015895843505859375
mini_batch_src_global generation:  0.034101009368896484
r_  generation:  0.2682483196258545
local_output_nid generation:  0.013975143432617188
local_in_edges_tensor generation:  0.014574050903320312
mini_batch_src_global generation:  0.034062862396240234
r_  generation:  0.2710118293762207
local_output_nid generation:  0.014958620071411133
local_in_edges_tensor generation:  0.013945341110229492
mini_batch_src_global generation:  0.03486013412475586
r_  generation:  0.27275514602661133
local_output_nid generation:  0.013602733612060547
local_in_edges_tensor generation:  0.016970396041870117
mini_batch_src_global generation:  0.03627920150756836
r_  generation:  0.27747273445129395
----------------------check_connections_block total spend ----------------------------- 6.2191619873046875
generate_one_block  0.34740138053894043
generate_one_block  0.3482973575592041
generate_one_block  0.3480796813964844
generate_one_block  0.345961332321167
generate_one_block  0.36615920066833496
generate_one_block  0.35006189346313477
generate_one_block  0.38232874870300293
generate_one_block  0.3522379398345947
generate_one_block  0.35004186630249023
generate_one_block  0.3526031970977783
generate_one_block  0.3649113178253174
generate_one_block  0.35177159309387207
generate_one_block  0.34459710121154785
generate_one_block  0.34461307525634766
generate_one_block  0.35486912727355957
generate_one_block  0.36081814765930176
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03944993019104004
gen group dst list time:  0.06938934326171875
time for parepare:  0.018805265426635742
local_output_nid generation:  0.02673959732055664
local_in_edges_tensor generation:  0.05955028533935547
mini_batch_src_global generation:  0.05042099952697754
r_  generation:  0.5327925682067871
local_output_nid generation:  0.03181171417236328
local_in_edges_tensor generation:  0.045113563537597656
mini_batch_src_global generation:  0.06166672706604004
r_  generation:  0.5264542102813721
local_output_nid generation:  0.031812429428100586
local_in_edges_tensor generation:  0.033737897872924805
mini_batch_src_global generation:  0.05882859230041504
r_  generation:  0.5365750789642334
local_output_nid generation:  0.032782554626464844
local_in_edges_tensor generation:  0.039922237396240234
mini_batch_src_global generation:  0.06009387969970703
r_  generation:  0.5252776145935059
local_output_nid generation:  0.03430628776550293
local_in_edges_tensor generation:  0.09203290939331055
mini_batch_src_global generation:  0.061087846755981445
r_  generation:  0.5343642234802246
local_output_nid generation:  0.03163266181945801
local_in_edges_tensor generation:  0.042433977127075195
mini_batch_src_global generation:  0.06096982955932617
r_  generation:  0.5282809734344482
local_output_nid generation:  0.033545494079589844
local_in_edges_tensor generation:  0.03596949577331543
mini_batch_src_global generation:  0.06327199935913086
r_  generation:  0.5351622104644775
local_output_nid generation:  0.032161712646484375
local_in_edges_tensor generation:  0.038091421127319336
mini_batch_src_global generation:  0.06439757347106934
r_  generation:  0.5331180095672607
local_output_nid generation:  0.03201937675476074
local_in_edges_tensor generation:  0.037784576416015625
mini_batch_src_global generation:  0.062456369400024414
r_  generation:  0.5385448932647705
local_output_nid generation:  0.03216409683227539
local_in_edges_tensor generation:  0.03570890426635742
mini_batch_src_global generation:  0.07301735877990723
r_  generation:  0.5485963821411133
local_output_nid generation:  0.03441023826599121
local_in_edges_tensor generation:  0.03377938270568848
mini_batch_src_global generation:  0.06086230278015137
r_  generation:  0.5367860794067383
local_output_nid generation:  0.0335080623626709
local_in_edges_tensor generation:  0.038286685943603516
mini_batch_src_global generation:  0.06140780448913574
r_  generation:  0.5345063209533691
local_output_nid generation:  0.0332188606262207
local_in_edges_tensor generation:  0.03920292854309082
mini_batch_src_global generation:  0.06120896339416504
r_  generation:  0.5366268157958984
local_output_nid generation:  0.03280973434448242
local_in_edges_tensor generation:  0.03412342071533203
mini_batch_src_global generation:  0.061623573303222656
r_  generation:  0.5439765453338623
local_output_nid generation:  0.03285408020019531
local_in_edges_tensor generation:  0.034043073654174805
mini_batch_src_global generation:  0.060527801513671875
r_  generation:  0.5394446849822998
local_output_nid generation:  0.033115386962890625
local_in_edges_tensor generation:  0.03585457801818848
mini_batch_src_global generation:  0.06440114974975586
r_  generation:  0.5376524925231934
----------------------check_connections_block total spend ----------------------------- 12.653613567352295
generate_one_block  0.6804461479187012
generate_one_block  0.6739029884338379
generate_one_block  0.6745262145996094
generate_one_block  0.6779060363769531
generate_one_block  0.6817858219146729
generate_one_block  0.6781930923461914
generate_one_block  0.6842656135559082
generate_one_block  0.6774744987487793
generate_one_block  0.710003137588501
generate_one_block  0.6755378246307373
generate_one_block  0.6780602931976318
generate_one_block  0.6804766654968262
generate_one_block  0.6794300079345703
generate_one_block  0.6842825412750244
generate_one_block  0.678112268447876
generate_one_block  0.6842608451843262
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.12864208221435547  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

connection checking time:  18.872775554656982
block generation total time  16.563416957855225
average batch blocks generation time:  1.0352135598659515
block dataloader generation time/epoch 38.131619000434874
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09959220886230469  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7671756744384766  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.0998072624206543  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7731842994689941  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09972381591796875  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7713632583618164  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09971427917480469  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7703094482421875  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10095596313476562  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7823286056518555  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09969234466552734  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7689404487609863  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09977102279663086  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7700614929199219  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09986734390258789  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7761712074279785  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09968805313110352  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7706770896911621  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09977865219116211  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7688241004943848  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.0999441146850586  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7772846221923828  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09987306594848633  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7815713882446289  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09961414337158203  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.768683910369873  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09973621368408203  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7715539932250977  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09972381591796875  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7693357467651367  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.1000056266784668  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7814621925354004  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06718744337558746 |0.017429053783416748 |0.0034584254026412964 |8.788704872131348e-05 |0.0037706494331359863 |0.0029761791229248047 |
----------------------------------------------------------pseudo_mini_loss sum 1.3404326438903809
Total (block generation + training)time/epoch 39.652941250801085
Training time/epoch 1.5401890277862549
Training time without block to device /epoch 1.261324167251587
Training time without total dataloading part /epoch 0.12004756927490234
load block tensor time/epoch 1.0749990940093994
block to device time/epoch 0.27886486053466797
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 19 |
Number of nodes for computation during this epoch:  5332076
Number of first layer input nodes during this epoch:  2522316
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.1296253204345703  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023368120193481445
random selection method range initialization spend 0.0051610469818115234
time for parepare:  0.01935863494873047
local_output_nid generation:  0.002336740493774414
local_in_edges_tensor generation:  0.007630825042724609
mini_batch_src_global generation:  0.002254962921142578
r_  generation:  0.02125406265258789
local_output_nid generation:  0.0028662681579589844
local_in_edges_tensor generation:  0.0017194747924804688
mini_batch_src_global generation:  0.0023233890533447266
r_  generation:  0.022373676300048828
local_output_nid generation:  0.0029845237731933594
local_in_edges_tensor generation:  0.001661062240600586
mini_batch_src_global generation:  0.0016777515411376953
r_  generation:  0.021500349044799805
local_output_nid generation:  0.0029757022857666016
local_in_edges_tensor generation:  0.0018429756164550781
mini_batch_src_global generation:  0.001764535903930664
r_  generation:  0.022684097290039062
local_output_nid generation:  0.002945423126220703
local_in_edges_tensor generation:  0.001692056655883789
mini_batch_src_global generation:  0.0017702579498291016
r_  generation:  0.021408796310424805
local_output_nid generation:  0.003026723861694336
local_in_edges_tensor generation:  0.0016164779663085938
mini_batch_src_global generation:  0.0017213821411132812
r_  generation:  0.02219986915588379
local_output_nid generation:  0.0029702186584472656
local_in_edges_tensor generation:  0.0016362667083740234
mini_batch_src_global generation:  0.001758575439453125
r_  generation:  0.0221707820892334
local_output_nid generation:  0.0030252933502197266
local_in_edges_tensor generation:  0.0016489028930664062
mini_batch_src_global generation:  0.0017855167388916016
r_  generation:  0.023064851760864258
local_output_nid generation:  0.00295257568359375
local_in_edges_tensor generation:  0.001664876937866211
mini_batch_src_global generation:  0.0017521381378173828
r_  generation:  0.021714448928833008
local_output_nid generation:  0.002971172332763672
local_in_edges_tensor generation:  0.0015995502471923828
mini_batch_src_global generation:  0.0017361640930175781
r_  generation:  0.023017168045043945
local_output_nid generation:  0.0030510425567626953
local_in_edges_tensor generation:  0.001615762710571289
mini_batch_src_global generation:  0.0017311573028564453
r_  generation:  0.021743297576904297
local_output_nid generation:  0.002958059310913086
local_in_edges_tensor generation:  0.001623392105102539
mini_batch_src_global generation:  0.0017499923706054688
r_  generation:  0.02259683609008789
local_output_nid generation:  0.0030536651611328125
local_in_edges_tensor generation:  0.0015637874603271484
mini_batch_src_global generation:  0.0017547607421875
r_  generation:  0.02198934555053711
local_output_nid generation:  0.002968311309814453
local_in_edges_tensor generation:  0.0015950202941894531
mini_batch_src_global generation:  0.0016994476318359375
r_  generation:  0.021972179412841797
local_output_nid generation:  0.002973794937133789
local_in_edges_tensor generation:  0.0015518665313720703
mini_batch_src_global generation:  0.0017735958099365234
r_  generation:  0.0225069522857666
local_output_nid generation:  0.0029630661010742188
local_in_edges_tensor generation:  0.0016803741455078125
mini_batch_src_global generation:  0.0017549991607666016
r_  generation:  0.02158641815185547
----------------------check_connections_block total spend ----------------------------- 0.570319652557373
generate_one_block  0.03150010108947754
generate_one_block  0.030597925186157227
generate_one_block  0.030465364456176758
generate_one_block  0.03195619583129883
generate_one_block  0.031113147735595703
generate_one_block  0.03387856483459473
generate_one_block  0.031047582626342773
generate_one_block  0.032117605209350586
generate_one_block  0.031288862228393555
generate_one_block  0.031090736389160156
generate_one_block  0.030803442001342773
generate_one_block  0.030922412872314453
generate_one_block  0.03082108497619629
generate_one_block  0.030621767044067383
generate_one_block  0.03190469741821289
generate_one_block  0.030930757522583008
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03511357307434082
gen group dst list time:  0.018671751022338867
time for parepare:  0.018942832946777344
local_output_nid generation:  0.009394645690917969
local_in_edges_tensor generation:  0.02703261375427246
mini_batch_src_global generation:  0.027857065200805664
r_  generation:  0.25225114822387695
local_output_nid generation:  0.013103723526000977
local_in_edges_tensor generation:  0.018455982208251953
mini_batch_src_global generation:  0.03276824951171875
r_  generation:  0.2529902458190918
local_output_nid generation:  0.012814521789550781
local_in_edges_tensor generation:  0.017505407333374023
mini_batch_src_global generation:  0.03185439109802246
r_  generation:  0.25991201400756836
local_output_nid generation:  0.013930797576904297
local_in_edges_tensor generation:  0.014394998550415039
mini_batch_src_global generation:  0.03402280807495117
r_  generation:  0.27095651626586914
local_output_nid generation:  0.013550758361816406
local_in_edges_tensor generation:  0.016164064407348633
mini_batch_src_global generation:  0.03586840629577637
r_  generation:  0.2667500972747803
local_output_nid generation:  0.01373147964477539
local_in_edges_tensor generation:  0.014019250869750977
mini_batch_src_global generation:  0.03689980506896973
r_  generation:  0.2655937671661377
local_output_nid generation:  0.013663291931152344
local_in_edges_tensor generation:  0.014177560806274414
mini_batch_src_global generation:  0.03577589988708496
r_  generation:  0.26505017280578613
local_output_nid generation:  0.013966560363769531
local_in_edges_tensor generation:  0.014443397521972656
mini_batch_src_global generation:  0.035848379135131836
r_  generation:  0.2747468948364258
local_output_nid generation:  0.013646841049194336
local_in_edges_tensor generation:  0.014181852340698242
mini_batch_src_global generation:  0.03527021408081055
r_  generation:  0.2651252746582031
local_output_nid generation:  0.013699531555175781
local_in_edges_tensor generation:  0.013778209686279297
mini_batch_src_global generation:  0.03510761260986328
r_  generation:  0.26717686653137207
local_output_nid generation:  0.013039112091064453
local_in_edges_tensor generation:  0.01402425765991211
mini_batch_src_global generation:  0.035056352615356445
r_  generation:  0.2644944190979004
local_output_nid generation:  0.013924598693847656
local_in_edges_tensor generation:  0.01552724838256836
mini_batch_src_global generation:  0.03454017639160156
r_  generation:  0.2726097106933594
local_output_nid generation:  0.013846635818481445
local_in_edges_tensor generation:  0.01372385025024414
mini_batch_src_global generation:  0.03481888771057129
r_  generation:  0.2689223289489746
local_output_nid generation:  0.013662338256835938
local_in_edges_tensor generation:  0.013987064361572266
mini_batch_src_global generation:  0.03413748741149902
r_  generation:  0.2683725357055664
local_output_nid generation:  0.013802528381347656
local_in_edges_tensor generation:  0.014148235321044922
mini_batch_src_global generation:  0.03698563575744629
r_  generation:  0.27268362045288086
local_output_nid generation:  0.012619972229003906
local_in_edges_tensor generation:  0.014945268630981445
mini_batch_src_global generation:  0.034017086029052734
r_  generation:  0.2630350589752197
----------------------check_connections_block total spend ----------------------------- 6.189001083374023
generate_one_block  0.36318469047546387
generate_one_block  0.3371617794036865
generate_one_block  0.34731173515319824
generate_one_block  0.35672450065612793
generate_one_block  0.35018038749694824
generate_one_block  0.34407973289489746
generate_one_block  0.36991000175476074
generate_one_block  0.35655689239501953
generate_one_block  0.3419327735900879
generate_one_block  0.3461329936981201
generate_one_block  0.3415405750274658
generate_one_block  0.353515625
generate_one_block  0.3489255905151367
generate_one_block  0.34567832946777344
generate_one_block  0.35410189628601074
generate_one_block  0.3341073989868164
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03483295440673828
gen group dst list time:  0.06420445442199707
time for parepare:  0.01805281639099121
local_output_nid generation:  0.027532577514648438
local_in_edges_tensor generation:  0.04866671562194824
mini_batch_src_global generation:  0.04851102828979492
r_  generation:  0.5150344371795654
local_output_nid generation:  0.032848358154296875
local_in_edges_tensor generation:  0.03664851188659668
mini_batch_src_global generation:  0.06213688850402832
r_  generation:  0.5161774158477783
local_output_nid generation:  0.032582998275756836
local_in_edges_tensor generation:  0.03382754325866699
mini_batch_src_global generation:  0.05875349044799805
r_  generation:  0.5247676372528076
local_output_nid generation:  0.03270125389099121
local_in_edges_tensor generation:  0.0325007438659668
mini_batch_src_global generation:  0.061180830001831055
r_  generation:  0.5214686393737793
local_output_nid generation:  0.03260493278503418
local_in_edges_tensor generation:  0.08040809631347656
mini_batch_src_global generation:  0.05994105339050293
r_  generation:  0.53141188621521
local_output_nid generation:  0.03290915489196777
local_in_edges_tensor generation:  0.03389477729797363
mini_batch_src_global generation:  0.06350922584533691
r_  generation:  0.5293824672698975
local_output_nid generation:  0.03292346000671387
local_in_edges_tensor generation:  0.03207588195800781
mini_batch_src_global generation:  0.0609738826751709
r_  generation:  0.5348849296569824
local_output_nid generation:  0.03256058692932129
local_in_edges_tensor generation:  0.03682541847229004
mini_batch_src_global generation:  0.061086416244506836
r_  generation:  0.5307953357696533
local_output_nid generation:  0.0327761173248291
local_in_edges_tensor generation:  0.03146100044250488
mini_batch_src_global generation:  0.06106400489807129
r_  generation:  0.5355961322784424
local_output_nid generation:  0.032804250717163086
local_in_edges_tensor generation:  0.0341036319732666
mini_batch_src_global generation:  0.06432414054870605
r_  generation:  0.5288078784942627
local_output_nid generation:  0.03259468078613281
local_in_edges_tensor generation:  0.03174090385437012
mini_batch_src_global generation:  0.060958147048950195
r_  generation:  0.5313642024993896
local_output_nid generation:  0.03279924392700195
local_in_edges_tensor generation:  0.033971309661865234
mini_batch_src_global generation:  0.06420779228210449
r_  generation:  0.5337543487548828
local_output_nid generation:  0.032605886459350586
local_in_edges_tensor generation:  0.03147244453430176
mini_batch_src_global generation:  0.061460256576538086
r_  generation:  0.5330755710601807
local_output_nid generation:  0.03260183334350586
local_in_edges_tensor generation:  0.03242635726928711
mini_batch_src_global generation:  0.06201958656311035
r_  generation:  0.5321865081787109
local_output_nid generation:  0.03289294242858887
local_in_edges_tensor generation:  0.03341984748840332
mini_batch_src_global generation:  0.06309032440185547
r_  generation:  0.5380275249481201
local_output_nid generation:  0.032579660415649414
local_in_edges_tensor generation:  0.031828880310058594
mini_batch_src_global generation:  0.06314420700073242
r_  generation:  0.5392196178436279
----------------------check_connections_block total spend ----------------------------- 12.456484079360962
generate_one_block  0.6700530052185059
generate_one_block  0.6800360679626465
generate_one_block  0.6697051525115967
generate_one_block  0.6783459186553955
generate_one_block  0.6827731132507324
generate_one_block  0.6725873947143555
generate_one_block  0.6806201934814453
generate_one_block  0.6797423362731934
generate_one_block  0.7387740612030029
generate_one_block  0.6711404323577881
generate_one_block  0.6762168407440186
generate_one_block  0.6749246120452881
generate_one_block  0.675396203994751
generate_one_block  0.67926025390625
generate_one_block  0.6857755184173584
generate_one_block  0.6876089572906494
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.1296253204345703  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

connection checking time:  18.645485162734985
block generation total time  16.49400496482849
average batch blocks generation time:  1.0308753103017807
block dataloader generation time/epoch 38.06177171793851
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09992313385009766  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7774567604064941  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09977912902832031  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.773991584777832  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09972763061523438  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7707109451293945  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09987401962280273  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7766404151916504  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09982538223266602  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7755160331726074  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09978437423706055  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7711906433105469  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09977102279663086  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7750186920166016  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09998416900634766  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7778801918029785  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10069942474365234  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7745180130004883  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09959077835083008  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7696094512939453  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.0995779037475586  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7682929039001465  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09986639022827148  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7736544609069824  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09978532791137695  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7724566459655762  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09955310821533203  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7680449485778809  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10089588165283203  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.782468318939209  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09942865371704102  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7636833190917969  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0640125572681427 |0.01417405903339386 |0.0034084171056747437 |8.855760097503662e-05 |0.0035585612058639526 |0.0016498565673828125 |
----------------------------------------------------------pseudo_mini_loss sum 1.3310452699661255
Total (block generation + training)time/epoch 39.57456114075401
Training time/epoch 1.427220344543457
Training time without block to device /epoch 1.2004354000091553
Training time without total dataloading part /epoch 0.11453843116760254
load block tensor time/epoch 1.0242009162902832
block to device time/epoch 0.22678494453430176
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 20 |
Number of nodes for computation during this epoch:  5331149
Number of first layer input nodes during this epoch:  2521663
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.12665653228759766  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02328777313232422
random selection method range initialization spend 0.004918813705444336
time for parepare:  0.01766824722290039
local_output_nid generation:  0.002428293228149414
local_in_edges_tensor generation:  0.003951549530029297
mini_batch_src_global generation:  0.0017709732055664062
r_  generation:  0.021080970764160156
local_output_nid generation:  0.0028688907623291016
local_in_edges_tensor generation:  0.0016951560974121094
mini_batch_src_global generation:  0.002028942108154297
r_  generation:  0.021912336349487305
local_output_nid generation:  0.0029511451721191406
local_in_edges_tensor generation:  0.0016913414001464844
mini_batch_src_global generation:  0.001687765121459961
r_  generation:  0.021205663681030273
local_output_nid generation:  0.0029659271240234375
local_in_edges_tensor generation:  0.0017366409301757812
mini_batch_src_global generation:  0.0017518997192382812
r_  generation:  0.021201372146606445
local_output_nid generation:  0.0029633045196533203
local_in_edges_tensor generation:  0.0018019676208496094
mini_batch_src_global generation:  0.0017256736755371094
r_  generation:  0.02163529396057129
local_output_nid generation:  0.003252267837524414
local_in_edges_tensor generation:  0.0017001628875732422
mini_batch_src_global generation:  0.0017516613006591797
r_  generation:  0.021703243255615234
local_output_nid generation:  0.003170490264892578
local_in_edges_tensor generation:  0.0016701221466064453
mini_batch_src_global generation:  0.0018203258514404297
r_  generation:  0.02231144905090332
local_output_nid generation:  0.003028392791748047
local_in_edges_tensor generation:  0.0016188621520996094
mini_batch_src_global generation:  0.0017507076263427734
r_  generation:  0.021310091018676758
local_output_nid generation:  0.0030164718627929688
local_in_edges_tensor generation:  0.001590728759765625
mini_batch_src_global generation:  0.0017359256744384766
r_  generation:  0.022113561630249023
local_output_nid generation:  0.0029785633087158203
local_in_edges_tensor generation:  0.0015964508056640625
mini_batch_src_global generation:  0.0017960071563720703
r_  generation:  0.021768808364868164
local_output_nid generation:  0.002973794937133789
local_in_edges_tensor generation:  0.0016455650329589844
mini_batch_src_global generation:  0.0018155574798583984
r_  generation:  0.02253890037536621
local_output_nid generation:  0.002961397171020508
local_in_edges_tensor generation:  0.0016720294952392578
mini_batch_src_global generation:  0.0017535686492919922
r_  generation:  0.022319316864013672
local_output_nid generation:  0.003001689910888672
local_in_edges_tensor generation:  0.0016169548034667969
mini_batch_src_global generation:  0.0017571449279785156
r_  generation:  0.021663188934326172
local_output_nid generation:  0.0029845237731933594
local_in_edges_tensor generation:  0.0015635490417480469
mini_batch_src_global generation:  0.0017843246459960938
r_  generation:  0.02236795425415039
local_output_nid generation:  0.0030312538146972656
local_in_edges_tensor generation:  0.0016162395477294922
mini_batch_src_global generation:  0.0017380714416503906
r_  generation:  0.02122783660888672
local_output_nid generation:  0.002974987030029297
local_in_edges_tensor generation:  0.0015685558319091797
mini_batch_src_global generation:  0.0017254352569580078
r_  generation:  0.021476268768310547
----------------------check_connections_block total spend ----------------------------- 0.557502269744873
generate_one_block  0.03078007698059082
generate_one_block  0.030641555786132812
generate_one_block  0.03116583824157715
generate_one_block  0.030924081802368164
generate_one_block  0.03077864646911621
generate_one_block  0.033325910568237305
generate_one_block  0.03150677680969238
generate_one_block  0.030334949493408203
generate_one_block  0.03151297569274902
generate_one_block  0.03127288818359375
generate_one_block  0.03196144104003906
generate_one_block  0.031173229217529297
generate_one_block  0.030675172805786133
generate_one_block  0.031964778900146484
generate_one_block  0.030363082885742188
generate_one_block  0.03171133995056152
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03394031524658203
gen group dst list time:  0.017105579376220703
time for parepare:  0.0190277099609375
local_output_nid generation:  0.009205341339111328
local_in_edges_tensor generation:  0.02411365509033203
mini_batch_src_global generation:  0.029124736785888672
r_  generation:  0.2523386478424072
local_output_nid generation:  0.012919187545776367
local_in_edges_tensor generation:  0.022213220596313477
mini_batch_src_global generation:  0.03303122520446777
r_  generation:  0.2534043788909912
local_output_nid generation:  0.013004064559936523
local_in_edges_tensor generation:  0.01519322395324707
mini_batch_src_global generation:  0.03232860565185547
r_  generation:  0.2600367069244385
local_output_nid generation:  0.013603687286376953
local_in_edges_tensor generation:  0.017895936965942383
mini_batch_src_global generation:  0.0321807861328125
r_  generation:  0.2625281810760498
local_output_nid generation:  0.013728141784667969
local_in_edges_tensor generation:  0.016538619995117188
mini_batch_src_global generation:  0.03305840492248535
r_  generation:  0.2605769634246826
local_output_nid generation:  0.013325929641723633
local_in_edges_tensor generation:  0.01438760757446289
mini_batch_src_global generation:  0.03325176239013672
r_  generation:  0.2626991271972656
local_output_nid generation:  0.01383829116821289
local_in_edges_tensor generation:  0.01548457145690918
mini_batch_src_global generation:  0.03567004203796387
r_  generation:  0.2705965042114258
local_output_nid generation:  0.013517618179321289
local_in_edges_tensor generation:  0.01593947410583496
mini_batch_src_global generation:  0.03384757041931152
r_  generation:  0.25917577743530273
local_output_nid generation:  0.013816118240356445
local_in_edges_tensor generation:  0.014003276824951172
mini_batch_src_global generation:  0.03432035446166992
r_  generation:  0.2691636085510254
local_output_nid generation:  0.013463258743286133
local_in_edges_tensor generation:  0.014041423797607422
mini_batch_src_global generation:  0.03410625457763672
r_  generation:  0.26610398292541504
local_output_nid generation:  0.013199806213378906
local_in_edges_tensor generation:  0.016408920288085938
mini_batch_src_global generation:  0.0360865592956543
r_  generation:  0.27604174613952637
local_output_nid generation:  0.013604164123535156
local_in_edges_tensor generation:  0.014290332794189453
mini_batch_src_global generation:  0.03449535369873047
r_  generation:  0.28402233123779297
local_output_nid generation:  0.01602768898010254
local_in_edges_tensor generation:  0.014356374740600586
mini_batch_src_global generation:  0.0348966121673584
r_  generation:  0.2679474353790283
local_output_nid generation:  0.014255046844482422
local_in_edges_tensor generation:  0.01663970947265625
mini_batch_src_global generation:  0.0349888801574707
r_  generation:  0.2770845890045166
local_output_nid generation:  0.013716697692871094
local_in_edges_tensor generation:  0.014150142669677734
mini_batch_src_global generation:  0.034235477447509766
r_  generation:  0.2662479877471924
local_output_nid generation:  0.01339578628540039
local_in_edges_tensor generation:  0.013909339904785156
mini_batch_src_global generation:  0.03372311592102051
r_  generation:  0.26686763763427734
----------------------check_connections_block total spend ----------------------------- 6.193743944168091
generate_one_block  0.35419154167175293
generate_one_block  0.3409242630004883
generate_one_block  0.35109424591064453
generate_one_block  0.3475792407989502
generate_one_block  0.3398318290710449
generate_one_block  0.3437082767486572
generate_one_block  0.38405919075012207
generate_one_block  0.34394001960754395
generate_one_block  0.34926509857177734
generate_one_block  0.34418582916259766
generate_one_block  0.3615291118621826
generate_one_block  0.35001468658447266
generate_one_block  0.3459506034851074
generate_one_block  0.3614614009857178
generate_one_block  0.34255194664001465
generate_one_block  0.34371137619018555
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0334019660949707
gen group dst list time:  0.06442046165466309
time for parepare:  0.017317771911621094
local_output_nid generation:  0.027698755264282227
local_in_edges_tensor generation:  0.045822858810424805
mini_batch_src_global generation:  0.049546241760253906
r_  generation:  0.5163850784301758
local_output_nid generation:  0.03261399269104004
local_in_edges_tensor generation:  0.035976409912109375
mini_batch_src_global generation:  0.06199526786804199
r_  generation:  0.5138518810272217
local_output_nid generation:  0.032440185546875
local_in_edges_tensor generation:  0.031383514404296875
mini_batch_src_global generation:  0.060497283935546875
r_  generation:  0.5296871662139893
local_output_nid generation:  0.032637834548950195
local_in_edges_tensor generation:  0.03425860404968262
mini_batch_src_global generation:  0.059796810150146484
r_  generation:  0.522695779800415
local_output_nid generation:  0.0323488712310791
local_in_edges_tensor generation:  0.07594442367553711
mini_batch_src_global generation:  0.05962657928466797
r_  generation:  0.5351982116699219
local_output_nid generation:  0.032703399658203125
local_in_edges_tensor generation:  0.037999868392944336
mini_batch_src_global generation:  0.06102442741394043
r_  generation:  0.5288376808166504
local_output_nid generation:  0.03287935256958008
local_in_edges_tensor generation:  0.03119635581970215
mini_batch_src_global generation:  0.06025815010070801
r_  generation:  0.5365605354309082
local_output_nid generation:  0.03234553337097168
local_in_edges_tensor generation:  0.03152728080749512
mini_batch_src_global generation:  0.06080770492553711
r_  generation:  0.5312485694885254
local_output_nid generation:  0.03266406059265137
local_in_edges_tensor generation:  0.03411674499511719
mini_batch_src_global generation:  0.06341385841369629
r_  generation:  0.538217306137085
local_output_nid generation:  0.03249979019165039
local_in_edges_tensor generation:  0.03142070770263672
mini_batch_src_global generation:  0.0615992546081543
r_  generation:  0.5289907455444336
local_output_nid generation:  0.03269314765930176
local_in_edges_tensor generation:  0.03337287902832031
mini_batch_src_global generation:  0.06256341934204102
r_  generation:  0.5390772819519043
local_output_nid generation:  0.03252005577087402
local_in_edges_tensor generation:  0.0352482795715332
mini_batch_src_global generation:  0.0640726089477539
r_  generation:  0.5341041088104248
local_output_nid generation:  0.03238821029663086
local_in_edges_tensor generation:  0.03201460838317871
mini_batch_src_global generation:  0.06039166450500488
r_  generation:  0.5357437133789062
local_output_nid generation:  0.03266501426696777
local_in_edges_tensor generation:  0.03243446350097656
mini_batch_src_global generation:  0.06269693374633789
r_  generation:  0.5340063571929932
local_output_nid generation:  0.032378435134887695
local_in_edges_tensor generation:  0.03148245811462402
mini_batch_src_global generation:  0.060469627380371094
r_  generation:  0.5337893962860107
local_output_nid generation:  0.03287458419799805
local_in_edges_tensor generation:  0.03121781349182129
mini_batch_src_global generation:  0.061493635177612305
r_  generation:  0.53702712059021
----------------------check_connections_block total spend ----------------------------- 12.466534852981567
generate_one_block  0.6720468997955322
generate_one_block  0.6718883514404297
generate_one_block  0.6759755611419678
generate_one_block  0.6721158027648926
generate_one_block  0.671623945236206
generate_one_block  0.6752898693084717
generate_one_block  0.6696796417236328
generate_one_block  0.6703653335571289
generate_one_block  0.710862398147583
generate_one_block  0.6687138080596924
generate_one_block  0.6854887008666992
generate_one_block  0.6772863864898682
generate_one_block  0.6787416934967041
generate_one_block  0.6725125312805176
generate_one_block  0.6719033718109131
generate_one_block  0.6737658977508545
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.12665653228759766  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

connection checking time:  18.660278797149658
block generation total time  16.422258853912354
average batch blocks generation time:  1.026391178369522
block dataloader generation time/epoch 37.995830257733665
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10094404220581055  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7817907333374023  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09953546524047852  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7688593864440918  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09970283508300781  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7713713645935059  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09979534149169922  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7710623741149902  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10067462921142578  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7740941047668457  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09983634948730469  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7744555473327637  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09994792938232422  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7806954383850098  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.0995783805847168  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7659440040588379  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10083198547363281  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.780794620513916  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09962701797485352  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7671980857849121  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10102653503417969  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7822022438049316  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09966564178466797  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.775881290435791  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.0997018814086914  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7698445320129395  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09989500045776367  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7810583114624023  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09961509704589844  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7639708518981934  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09971141815185547  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7698674201965332  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06525175273418427 |0.01287601888179779 |0.003475397825241089 |9.207427501678467e-05 |0.0032192468643188477 |0.0028374195098876953 |
----------------------------------------------------------pseudo_mini_loss sum 1.3178932666778564
Total (block generation + training)time/epoch 39.501272082328796
Training time/epoch 1.4244334697723389
Training time without block to device /epoch 1.2184171676635742
Training time without total dataloading part /epoch 0.11142492294311523
load block tensor time/epoch 1.0440280437469482
block to device time/epoch 0.20601630210876465
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 21 |
Number of nodes for computation during this epoch:  5331995
Number of first layer input nodes during this epoch:  2521797
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.12720060348510742  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02462315559387207
random selection method range initialization spend 0.0051364898681640625
time for parepare:  0.017642736434936523
local_output_nid generation:  0.0023708343505859375
local_in_edges_tensor generation:  0.0040819644927978516
mini_batch_src_global generation:  0.001798868179321289
r_  generation:  0.02094101905822754
local_output_nid generation:  0.002862215042114258
local_in_edges_tensor generation:  0.0017766952514648438
mini_batch_src_global generation:  0.0020923614501953125
r_  generation:  0.022328853607177734
local_output_nid generation:  0.002961397171020508
local_in_edges_tensor generation:  0.0018396377563476562
mini_batch_src_global generation:  0.0017199516296386719
r_  generation:  0.020882129669189453
local_output_nid generation:  0.0031218528747558594
local_in_edges_tensor generation:  0.0017468929290771484
mini_batch_src_global generation:  0.0018184185028076172
r_  generation:  0.022181987762451172
local_output_nid generation:  0.0029823780059814453
local_in_edges_tensor generation:  0.0017364025115966797
mini_batch_src_global generation:  0.0017693042755126953
r_  generation:  0.021307706832885742
local_output_nid generation:  0.0029778480529785156
local_in_edges_tensor generation:  0.0016832351684570312
mini_batch_src_global generation:  0.0017611980438232422
r_  generation:  0.021838665008544922
local_output_nid generation:  0.0030612945556640625
local_in_edges_tensor generation:  0.0016586780548095703
mini_batch_src_global generation:  0.0017650127410888672
r_  generation:  0.022370100021362305
local_output_nid generation:  0.002957582473754883
local_in_edges_tensor generation:  0.0016674995422363281
mini_batch_src_global generation:  0.0017628669738769531
r_  generation:  0.021620750427246094
local_output_nid generation:  0.003039121627807617
local_in_edges_tensor generation:  0.0016570091247558594
mini_batch_src_global generation:  0.0017576217651367188
r_  generation:  0.02189779281616211
local_output_nid generation:  0.0032117366790771484
local_in_edges_tensor generation:  0.0015940666198730469
mini_batch_src_global generation:  0.0016906261444091797
r_  generation:  0.02221989631652832
local_output_nid generation:  0.0029370784759521484
local_in_edges_tensor generation:  0.0016124248504638672
mini_batch_src_global generation:  0.0017507076263427734
r_  generation:  0.021535873413085938
local_output_nid generation:  0.0029561519622802734
local_in_edges_tensor generation:  0.0015850067138671875
mini_batch_src_global generation:  0.0017116069793701172
r_  generation:  0.021713972091674805
local_output_nid generation:  0.0029654502868652344
local_in_edges_tensor generation:  0.0015871524810791016
mini_batch_src_global generation:  0.0016944408416748047
r_  generation:  0.022320270538330078
local_output_nid generation:  0.002990245819091797
local_in_edges_tensor generation:  0.00164794921875
mini_batch_src_global generation:  0.001760244369506836
r_  generation:  0.021708250045776367
local_output_nid generation:  0.0029833316802978516
local_in_edges_tensor generation:  0.001547098159790039
mini_batch_src_global generation:  0.0017399787902832031
r_  generation:  0.021509408950805664
local_output_nid generation:  0.0029821395874023438
local_in_edges_tensor generation:  0.0015561580657958984
mini_batch_src_global generation:  0.0017528533935546875
r_  generation:  0.02250051498413086
----------------------check_connections_block total spend ----------------------------- 0.5592513084411621
generate_one_block  0.030109882354736328
generate_one_block  0.03136444091796875
generate_one_block  0.030382394790649414
generate_one_block  0.0313420295715332
generate_one_block  0.030505657196044922
generate_one_block  0.03382515907287598
generate_one_block  0.031961917877197266
generate_one_block  0.030607938766479492
generate_one_block  0.031288862228393555
generate_one_block  0.031064510345458984
generate_one_block  0.03052353858947754
generate_one_block  0.030952930450439453
generate_one_block  0.031282901763916016
generate_one_block  0.030916929244995117
generate_one_block  0.030792236328125
generate_one_block  0.03246712684631348
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.08767223358154297
gen group dst list time:  0.019756078720092773
time for parepare:  0.019543170928955078
local_output_nid generation:  0.009156465530395508
local_in_edges_tensor generation:  0.021565675735473633
mini_batch_src_global generation:  0.02910137176513672
r_  generation:  0.25504446029663086
local_output_nid generation:  0.013339996337890625
local_in_edges_tensor generation:  0.018956899642944336
mini_batch_src_global generation:  0.03508591651916504
r_  generation:  0.2769310474395752
local_output_nid generation:  0.015403032302856445
local_in_edges_tensor generation:  0.021243810653686523
mini_batch_src_global generation:  0.0374140739440918
r_  generation:  0.2586362361907959
local_output_nid generation:  0.014409542083740234
local_in_edges_tensor generation:  0.014591693878173828
mini_batch_src_global generation:  0.03391885757446289
r_  generation:  0.27030110359191895
local_output_nid generation:  0.01422119140625
local_in_edges_tensor generation:  0.013953924179077148
mini_batch_src_global generation:  0.03475809097290039
r_  generation:  0.26654648780822754
local_output_nid generation:  0.013895511627197266
local_in_edges_tensor generation:  0.014179706573486328
mini_batch_src_global generation:  0.034594058990478516
r_  generation:  0.2677950859069824
local_output_nid generation:  0.014308691024780273
local_in_edges_tensor generation:  0.016440868377685547
mini_batch_src_global generation:  0.034331321716308594
r_  generation:  0.2735259532928467
local_output_nid generation:  0.014057159423828125
local_in_edges_tensor generation:  0.014031410217285156
mini_batch_src_global generation:  0.03393387794494629
r_  generation:  0.27121472358703613
local_output_nid generation:  0.014161109924316406
local_in_edges_tensor generation:  0.013761043548583984
mini_batch_src_global generation:  0.04016685485839844
r_  generation:  0.27534937858581543
local_output_nid generation:  0.014120101928710938
local_in_edges_tensor generation:  0.015949487686157227
mini_batch_src_global generation:  0.03399252891540527
r_  generation:  0.2723720073699951
local_output_nid generation:  0.013476133346557617
local_in_edges_tensor generation:  0.015140533447265625
mini_batch_src_global generation:  0.03468918800354004
r_  generation:  0.2730681896209717
local_output_nid generation:  0.014054536819458008
local_in_edges_tensor generation:  0.014652490615844727
mini_batch_src_global generation:  0.03381538391113281
r_  generation:  0.2743806838989258
local_output_nid generation:  0.014072656631469727
local_in_edges_tensor generation:  0.01388859748840332
mini_batch_src_global generation:  0.03469061851501465
r_  generation:  0.27093029022216797
local_output_nid generation:  0.013862848281860352
local_in_edges_tensor generation:  0.013838768005371094
mini_batch_src_global generation:  0.03406095504760742
r_  generation:  0.2667102813720703
local_output_nid generation:  0.014126300811767578
local_in_edges_tensor generation:  0.013908863067626953
mini_batch_src_global generation:  0.034607887268066406
r_  generation:  0.2732377052307129
local_output_nid generation:  0.013939619064331055
local_in_edges_tensor generation:  0.015249252319335938
mini_batch_src_global generation:  0.03479766845703125
r_  generation:  0.27475833892822266
----------------------check_connections_block total spend ----------------------------- 6.2816572189331055
generate_one_block  0.3547987937927246
generate_one_block  0.3521244525909424
generate_one_block  0.34200119972229004
generate_one_block  0.35796403884887695
generate_one_block  0.3487677574157715
generate_one_block  0.3502969741821289
generate_one_block  0.38119029998779297
generate_one_block  0.3457362651824951
generate_one_block  0.3534221649169922
generate_one_block  0.3487520217895508
generate_one_block  0.35190534591674805
generate_one_block  0.35808491706848145
generate_one_block  0.3503854274749756
generate_one_block  0.34263157844543457
generate_one_block  0.35405921936035156
generate_one_block  0.36245036125183105
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.042942047119140625
gen group dst list time:  0.0710303783416748
time for parepare:  0.019547224044799805
local_output_nid generation:  0.028079509735107422
local_in_edges_tensor generation:  0.05293726921081543
mini_batch_src_global generation:  0.04800057411193848
r_  generation:  0.5194754600524902
local_output_nid generation:  0.03253030776977539
local_in_edges_tensor generation:  0.041788578033447266
mini_batch_src_global generation:  0.06283974647521973
r_  generation:  0.5180239677429199
local_output_nid generation:  0.033588409423828125
local_in_edges_tensor generation:  0.03552365303039551
mini_batch_src_global generation:  0.06005239486694336
r_  generation:  0.532881498336792
local_output_nid generation:  0.032946109771728516
local_in_edges_tensor generation:  0.033864736557006836
mini_batch_src_global generation:  0.06005549430847168
r_  generation:  0.5309910774230957
local_output_nid generation:  0.032848358154296875
local_in_edges_tensor generation:  0.08496952056884766
mini_batch_src_global generation:  0.06737542152404785
r_  generation:  0.5339124202728271
local_output_nid generation:  0.032846689224243164
local_in_edges_tensor generation:  0.04035067558288574
mini_batch_src_global generation:  0.062049150466918945
r_  generation:  0.5352373123168945
local_output_nid generation:  0.03262901306152344
local_in_edges_tensor generation:  0.032605886459350586
mini_batch_src_global generation:  0.06418013572692871
r_  generation:  0.535874605178833
local_output_nid generation:  0.03432798385620117
local_in_edges_tensor generation:  0.03441333770751953
mini_batch_src_global generation:  0.06206870079040527
r_  generation:  0.531775712966919
local_output_nid generation:  0.03258967399597168
local_in_edges_tensor generation:  0.04027271270751953
mini_batch_src_global generation:  0.0762026309967041
r_  generation:  0.5394196510314941
local_output_nid generation:  0.03492569923400879
local_in_edges_tensor generation:  0.033925771713256836
mini_batch_src_global generation:  0.061902523040771484
r_  generation:  0.5382909774780273
local_output_nid generation:  0.033518314361572266
local_in_edges_tensor generation:  0.03457188606262207
mini_batch_src_global generation:  0.06183171272277832
r_  generation:  0.541231632232666
local_output_nid generation:  0.0335543155670166
local_in_edges_tensor generation:  0.035643577575683594
mini_batch_src_global generation:  0.06271052360534668
r_  generation:  0.5347318649291992
local_output_nid generation:  0.03346705436706543
local_in_edges_tensor generation:  0.032471656799316406
mini_batch_src_global generation:  0.06405091285705566
r_  generation:  0.5347549915313721
local_output_nid generation:  0.0335996150970459
local_in_edges_tensor generation:  0.03855562210083008
mini_batch_src_global generation:  0.06438803672790527
r_  generation:  0.5341253280639648
local_output_nid generation:  0.03352928161621094
local_in_edges_tensor generation:  0.034212589263916016
mini_batch_src_global generation:  0.06180453300476074
r_  generation:  0.5412139892578125
local_output_nid generation:  0.03355717658996582
local_in_edges_tensor generation:  0.0354304313659668
mini_batch_src_global generation:  0.0651705265045166
r_  generation:  0.5347683429718018
----------------------check_connections_block total spend ----------------------------- 12.65473484992981
generate_one_block  0.6800520420074463
generate_one_block  0.6780636310577393
generate_one_block  0.6822195053100586
generate_one_block  0.6829872131347656
generate_one_block  0.6785068511962891
generate_one_block  0.6825587749481201
generate_one_block  0.6762406826019287
generate_one_block  0.6850008964538574
generate_one_block  0.7510247230529785
generate_one_block  0.6751656532287598
generate_one_block  0.6829800605773926
generate_one_block  0.6856451034545898
generate_one_block  0.6871988773345947
generate_one_block  0.6799452304840088
generate_one_block  0.6832199096679688
generate_one_block  0.6950170993804932
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.12720060348510742  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

connection checking time:  18.936392068862915
block generation total time  16.64039707183838
average batch blocks generation time:  1.0400248169898987
block dataloader generation time/epoch 37.98680800658006
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09966564178466797  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7696342468261719  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.0999135971069336  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7728004455566406  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09953737258911133  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7665796279907227  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09996318817138672  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7765645980834961  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.0996851921081543  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7674150466918945  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09980630874633789  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7756567001342773  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09975671768188477  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7732133865356445  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.0997014045715332  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7725338935852051  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09979724884033203  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7721319198608398  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09979248046875  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7711086273193359  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10078144073486328  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.776555061340332  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09984970092773438  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7707767486572266  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.0996851921081543  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7734246253967285  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09974479675292969  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7720317840576172  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09973573684692383  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7722201347351074  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09998369216918945  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7810721397399902  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06308510899543762 |0.01790812611579895 |0.0035160034894943237 |9.185075759887695e-05 |0.003290921449661255 |0.003076314926147461 |
----------------------------------------------------------pseudo_mini_loss sum 1.2992244958877563
Total (block generation + training)time/epoch 39.48972036288335
Training time/epoch 1.4722905158996582
Training time without block to device /epoch 1.185760498046875
Training time without total dataloading part /epoch 0.11345672607421875
load block tensor time/epoch 1.009361743927002
block to device time/epoch 0.2865300178527832
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 22 |
Number of nodes for computation during this epoch:  5330241
Number of first layer input nodes during this epoch:  2522228
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.12972640991210938  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023873090744018555
random selection method range initialization spend 0.006646394729614258
time for parepare:  0.017932415008544922
local_output_nid generation:  0.002359628677368164
local_in_edges_tensor generation:  0.008565187454223633
mini_batch_src_global generation:  0.0017690658569335938
r_  generation:  0.03777480125427246
local_output_nid generation:  0.004894256591796875
local_in_edges_tensor generation:  0.0021648406982421875
mini_batch_src_global generation:  0.003100156784057617
r_  generation:  0.022305011749267578
local_output_nid generation:  0.0033326148986816406
local_in_edges_tensor generation:  0.0017118453979492188
mini_batch_src_global generation:  0.0017807483673095703
r_  generation:  0.03670191764831543
local_output_nid generation:  0.004936695098876953
local_in_edges_tensor generation:  0.002400636672973633
mini_batch_src_global generation:  0.0020165443420410156
r_  generation:  0.023041963577270508
local_output_nid generation:  0.0045201778411865234
local_in_edges_tensor generation:  0.002172708511352539
mini_batch_src_global generation:  0.0019538402557373047
r_  generation:  0.02181720733642578
local_output_nid generation:  0.0045621395111083984
local_in_edges_tensor generation:  0.002162933349609375
mini_batch_src_global generation:  0.001867532730102539
r_  generation:  0.022072315216064453
local_output_nid generation:  0.004430532455444336
local_in_edges_tensor generation:  0.0022318363189697266
mini_batch_src_global generation:  0.001847982406616211
r_  generation:  0.02290630340576172
local_output_nid generation:  0.004492282867431641
local_in_edges_tensor generation:  0.002399444580078125
mini_batch_src_global generation:  0.016781330108642578
r_  generation:  0.022815465927124023
local_output_nid generation:  0.004372835159301758
local_in_edges_tensor generation:  0.0020186901092529297
mini_batch_src_global generation:  0.0018029212951660156
r_  generation:  0.02255535125732422
local_output_nid generation:  0.003912210464477539
local_in_edges_tensor generation:  0.0018391609191894531
mini_batch_src_global generation:  0.0018358230590820312
r_  generation:  0.022658109664916992
local_output_nid generation:  0.0036733150482177734
local_in_edges_tensor generation:  0.0017321109771728516
mini_batch_src_global generation:  0.0017857551574707031
r_  generation:  0.02275705337524414
local_output_nid generation:  0.0035247802734375
local_in_edges_tensor generation:  0.0016987323760986328
mini_batch_src_global generation:  0.001783132553100586
r_  generation:  0.022693872451782227
local_output_nid generation:  0.003401517868041992
local_in_edges_tensor generation:  0.0017235279083251953
mini_batch_src_global generation:  0.0017917156219482422
r_  generation:  0.021932601928710938
local_output_nid generation:  0.003348827362060547
local_in_edges_tensor generation:  0.0016660690307617188
mini_batch_src_global generation:  0.0017898082733154297
r_  generation:  0.022733688354492188
local_output_nid generation:  0.0033559799194335938
local_in_edges_tensor generation:  0.0016512870788574219
mini_batch_src_global generation:  0.00182342529296875
r_  generation:  0.02252054214477539
local_output_nid generation:  0.0033218860626220703
local_in_edges_tensor generation:  0.0017066001892089844
mini_batch_src_global generation:  0.0017876625061035156
r_  generation:  0.029445171356201172
----------------------check_connections_block total spend ----------------------------- 0.6619434356689453
generate_one_block  0.033269405364990234
generate_one_block  0.033583641052246094
generate_one_block  0.036980390548706055
generate_one_block  0.04245281219482422
generate_one_block  0.0407102108001709
generate_one_block  0.03457903861999512
generate_one_block  0.03138089179992676
generate_one_block  0.031079769134521484
generate_one_block  0.03170299530029297
generate_one_block  0.03145432472229004
generate_one_block  0.031334638595581055
generate_one_block  0.03112959861755371
generate_one_block  0.030512571334838867
generate_one_block  0.030737638473510742
generate_one_block  0.03190755844116211
generate_one_block  0.032338619232177734
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0377042293548584
gen group dst list time:  0.017401695251464844
time for parepare:  0.01956963539123535
local_output_nid generation:  0.009306907653808594
local_in_edges_tensor generation:  0.02808070182800293
mini_batch_src_global generation:  0.026857376098632812
r_  generation:  0.24621844291687012
local_output_nid generation:  0.013092994689941406
local_in_edges_tensor generation:  0.01877307891845703
mini_batch_src_global generation:  0.03316187858581543
r_  generation:  0.2541074752807617
local_output_nid generation:  0.013372182846069336
local_in_edges_tensor generation:  0.019647598266601562
mini_batch_src_global generation:  0.03412318229675293
r_  generation:  0.2715134620666504
local_output_nid generation:  0.013892889022827148
local_in_edges_tensor generation:  0.016763687133789062
mini_batch_src_global generation:  0.033303260803222656
r_  generation:  0.2668013572692871
local_output_nid generation:  0.013847112655639648
local_in_edges_tensor generation:  0.016396045684814453
mini_batch_src_global generation:  0.034061431884765625
r_  generation:  0.2651991844177246
local_output_nid generation:  0.013638019561767578
local_in_edges_tensor generation:  0.014449834823608398
mini_batch_src_global generation:  0.03408455848693848
r_  generation:  0.2707080841064453
local_output_nid generation:  0.01393580436706543
local_in_edges_tensor generation:  0.014248371124267578
mini_batch_src_global generation:  0.034255027770996094
r_  generation:  0.2677271366119385
local_output_nid generation:  0.013935565948486328
local_in_edges_tensor generation:  0.014069318771362305
mini_batch_src_global generation:  0.033956289291381836
r_  generation:  0.2683384418487549
local_output_nid generation:  0.01401662826538086
local_in_edges_tensor generation:  0.01429605484008789
mini_batch_src_global generation:  0.03900408744812012
r_  generation:  0.2759990692138672
local_output_nid generation:  0.013837814331054688
local_in_edges_tensor generation:  0.017929553985595703
mini_batch_src_global generation:  0.034777164459228516
r_  generation:  0.2774367332458496
local_output_nid generation:  0.013273239135742188
local_in_edges_tensor generation:  0.01451563835144043
mini_batch_src_global generation:  0.03586983680725098
r_  generation:  0.28058290481567383
local_output_nid generation:  0.014766454696655273
local_in_edges_tensor generation:  0.016091108322143555
mini_batch_src_global generation:  0.034716129302978516
r_  generation:  0.2811589241027832
local_output_nid generation:  0.013895034790039062
local_in_edges_tensor generation:  0.022237777709960938
mini_batch_src_global generation:  0.03627777099609375
r_  generation:  0.2735741138458252
local_output_nid generation:  0.01388859748840332
local_in_edges_tensor generation:  0.018906831741333008
mini_batch_src_global generation:  0.03417778015136719
r_  generation:  0.27614545822143555
local_output_nid generation:  0.014041423797607422
local_in_edges_tensor generation:  0.020699262619018555
mini_batch_src_global generation:  0.036898136138916016
r_  generation:  0.29161906242370605
local_output_nid generation:  0.01569080352783203
local_in_edges_tensor generation:  0.018567562103271484
mini_batch_src_global generation:  0.035257577896118164
r_  generation:  0.27599358558654785
----------------------check_connections_block total spend ----------------------------- 6.347538471221924
generate_one_block  0.35849428176879883
generate_one_block  0.3439488410949707
generate_one_block  0.3615729808807373
generate_one_block  0.35614728927612305
generate_one_block  0.3473026752471924
generate_one_block  0.3570733070373535
generate_one_block  0.3938324451446533
generate_one_block  0.35054636001586914
generate_one_block  0.3635444641113281
generate_one_block  0.3611876964569092
generate_one_block  0.35508298873901367
generate_one_block  0.3539409637451172
generate_one_block  0.3515169620513916
generate_one_block  0.3508167266845703
generate_one_block  0.3693678379058838
generate_one_block  0.35971641540527344
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.039597272872924805
gen group dst list time:  0.07353782653808594
time for parepare:  0.019767284393310547
local_output_nid generation:  0.02886509895324707
local_in_edges_tensor generation:  0.05514121055603027
mini_batch_src_global generation:  0.05020785331726074
r_  generation:  0.5205941200256348
local_output_nid generation:  0.03315615653991699
local_in_edges_tensor generation:  0.04233074188232422
mini_batch_src_global generation:  0.06449627876281738
r_  generation:  0.5225648880004883
local_output_nid generation:  0.03344154357910156
local_in_edges_tensor generation:  0.03307604789733887
mini_batch_src_global generation:  0.059173583984375
r_  generation:  0.5401599407196045
local_output_nid generation:  0.03291797637939453
local_in_edges_tensor generation:  0.034345388412475586
mini_batch_src_global generation:  0.06029844284057617
r_  generation:  0.5346214771270752
local_output_nid generation:  0.03435063362121582
local_in_edges_tensor generation:  0.08384013175964355
mini_batch_src_global generation:  0.061023712158203125
r_  generation:  0.5380566120147705
local_output_nid generation:  0.03292131423950195
local_in_edges_tensor generation:  0.03736734390258789
mini_batch_src_global generation:  0.061385154724121094
r_  generation:  0.5366747379302979
local_output_nid generation:  0.03319740295410156
local_in_edges_tensor generation:  0.037204742431640625
mini_batch_src_global generation:  0.060980796813964844
r_  generation:  0.5417258739471436
local_output_nid generation:  0.0333707332611084
local_in_edges_tensor generation:  0.03675723075866699
mini_batch_src_global generation:  0.06206703186035156
r_  generation:  0.5414299964904785
local_output_nid generation:  0.033156394958496094
local_in_edges_tensor generation:  0.03431820869445801
mini_batch_src_global generation:  0.06168985366821289
r_  generation:  0.5511713027954102
local_output_nid generation:  0.03342390060424805
local_in_edges_tensor generation:  0.03781437873840332
mini_batch_src_global generation:  0.06639885902404785
r_  generation:  0.556098461151123
local_output_nid generation:  0.03424358367919922
local_in_edges_tensor generation:  0.0367121696472168
mini_batch_src_global generation:  0.06498503684997559
r_  generation:  0.5542957782745361
local_output_nid generation:  0.03547406196594238
local_in_edges_tensor generation:  0.03247952461242676
mini_batch_src_global generation:  0.0622866153717041
r_  generation:  0.5373895168304443
local_output_nid generation:  0.03404831886291504
local_in_edges_tensor generation:  0.03419971466064453
mini_batch_src_global generation:  0.06549954414367676
r_  generation:  0.5411291122436523
local_output_nid generation:  0.03423571586608887
local_in_edges_tensor generation:  0.032730817794799805
mini_batch_src_global generation:  0.06401586532592773
r_  generation:  0.5525343418121338
local_output_nid generation:  0.03409433364868164
local_in_edges_tensor generation:  0.034110069274902344
mini_batch_src_global generation:  0.06261181831359863
r_  generation:  0.5490365028381348
local_output_nid generation:  0.033875226974487305
local_in_edges_tensor generation:  0.03706836700439453
mini_batch_src_global generation:  0.06259632110595703
r_  generation:  0.5430464744567871
----------------------check_connections_block total spend ----------------------------- 12.75705885887146
generate_one_block  0.6968774795532227
generate_one_block  0.6851880550384521
generate_one_block  0.6900339126586914
generate_one_block  0.6910443305969238
generate_one_block  0.6841001510620117
generate_one_block  0.6867475509643555
generate_one_block  0.6869962215423584
generate_one_block  0.6960623264312744
generate_one_block  0.7393503189086914
generate_one_block  0.6901750564575195
generate_one_block  0.6889846324920654
generate_one_block  0.6899318695068359
generate_one_block  0.6848578453063965
generate_one_block  0.6835341453552246
generate_one_block  0.7027857303619385
generate_one_block  0.6933748722076416
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.12972640991210938  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

connection checking time:  19.104597330093384
block generation total time  16.82413673400879
average batch blocks generation time:  1.0515085458755493
block dataloader generation time/epoch 38.01363641875131
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10074949264526367  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.774080753326416  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09960746765136719  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7659358978271484  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10098743438720703  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7828149795532227  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09987020492553711  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7770185470581055  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10071182250976562  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7709498405456543  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09972047805786133  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7707004547119141  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09966135025024414  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7711858749389648  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.0996699333190918  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7696332931518555  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09985589981079102  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7742762565612793  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09978437423706055  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7711358070373535  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09981107711791992  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7714481353759766  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09989070892333984  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7771458625793457  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09959983825683594  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7669949531555176  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.0996408462524414  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7683014869689941  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10086250305175781  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.78045654296875  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09989738464355469  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7774190902709961  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0677109956741333 |0.017010509967803955 |0.0035254061222076416 |9.296834468841553e-05 |0.003733709454536438 |0.001302480697631836 |
----------------------------------------------------------pseudo_mini_loss sum 1.2883484363555908
Total (block generation + training)time/epoch 39.51918154103415
Training time/epoch 1.5394763946533203
Training time without block to device /epoch 1.267308235168457
Training time without total dataloading part /epoch 0.11893582344055176
load block tensor time/epoch 1.0833759307861328
block to device time/epoch 0.2721681594848633
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 23 |
Number of nodes for computation during this epoch:  5332124
Number of first layer input nodes during this epoch:  2522132
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.12864255905151367  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026169776916503906
random selection method range initialization spend 0.0053501129150390625
time for parepare:  0.018534421920776367
local_output_nid generation:  0.0024003982543945312
local_in_edges_tensor generation:  0.007999420166015625
mini_batch_src_global generation:  0.0019145011901855469
r_  generation:  0.02183842658996582
local_output_nid generation:  0.0028820037841796875
local_in_edges_tensor generation:  0.0017817020416259766
mini_batch_src_global generation:  0.0020570755004882812
r_  generation:  0.023481130599975586
local_output_nid generation:  0.002982616424560547
local_in_edges_tensor generation:  0.002010822296142578
mini_batch_src_global generation:  0.0017740726470947266
r_  generation:  0.022097349166870117
local_output_nid generation:  0.0030181407928466797
local_in_edges_tensor generation:  0.0017180442810058594
mini_batch_src_global generation:  0.0017676353454589844
r_  generation:  0.02222728729248047
local_output_nid generation:  0.0029871463775634766
local_in_edges_tensor generation:  0.0017285346984863281
mini_batch_src_global generation:  0.0017900466918945312
r_  generation:  0.02284860610961914
local_output_nid generation:  0.0030431747436523438
local_in_edges_tensor generation:  0.0017333030700683594
mini_batch_src_global generation:  0.0017924308776855469
r_  generation:  0.022125720977783203
local_output_nid generation:  0.003081083297729492
local_in_edges_tensor generation:  0.0018804073333740234
mini_batch_src_global generation:  0.0017669200897216797
r_  generation:  0.02232813835144043
local_output_nid generation:  0.0029714107513427734
local_in_edges_tensor generation:  0.0017771720886230469
mini_batch_src_global generation:  0.0017998218536376953
r_  generation:  0.021939516067504883
local_output_nid generation:  0.002994060516357422
local_in_edges_tensor generation:  0.0018506050109863281
mini_batch_src_global generation:  0.0017559528350830078
r_  generation:  0.021549224853515625
local_output_nid generation:  0.0030546188354492188
local_in_edges_tensor generation:  0.0017218589782714844
mini_batch_src_global generation:  0.0017688274383544922
r_  generation:  0.022179603576660156
local_output_nid generation:  0.002985715866088867
local_in_edges_tensor generation:  0.0016872882843017578
mini_batch_src_global generation:  0.001825094223022461
r_  generation:  0.022985458374023438
local_output_nid generation:  0.002991199493408203
local_in_edges_tensor generation:  0.001688241958618164
mini_batch_src_global generation:  0.0018422603607177734
r_  generation:  0.022232770919799805
local_output_nid generation:  0.0030066967010498047
local_in_edges_tensor generation:  0.0016984939575195312
mini_batch_src_global generation:  0.0017516613006591797
r_  generation:  0.022304534912109375
local_output_nid generation:  0.0030989646911621094
local_in_edges_tensor generation:  0.0016376972198486328
mini_batch_src_global generation:  0.0017490386962890625
r_  generation:  0.0221710205078125
local_output_nid generation:  0.0030608177185058594
local_in_edges_tensor generation:  0.0016803741455078125
mini_batch_src_global generation:  0.0017306804656982422
r_  generation:  0.02217411994934082
local_output_nid generation:  0.00299072265625
local_in_edges_tensor generation:  0.001642465591430664
mini_batch_src_global generation:  0.0018410682678222656
r_  generation:  0.02289414405822754
----------------------check_connections_block total spend ----------------------------- 0.5756769180297852
generate_one_block  0.03140068054199219
generate_one_block  0.03163957595825195
generate_one_block  0.03167605400085449
generate_one_block  0.03174448013305664
generate_one_block  0.032053470611572266
generate_one_block  0.03373885154724121
generate_one_block  0.03153276443481445
generate_one_block  0.03082275390625
generate_one_block  0.030713796615600586
generate_one_block  0.0307924747467041
generate_one_block  0.03201436996459961
generate_one_block  0.03152346611022949
generate_one_block  0.0313413143157959
generate_one_block  0.031138181686401367
generate_one_block  0.030871152877807617
generate_one_block  0.03233981132507324
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03939390182495117
gen group dst list time:  0.017603397369384766
time for parepare:  0.019539594650268555
local_output_nid generation:  0.009460926055908203
local_in_edges_tensor generation:  0.02787184715270996
mini_batch_src_global generation:  0.027752161026000977
r_  generation:  0.25660252571105957
local_output_nid generation:  0.013193845748901367
local_in_edges_tensor generation:  0.015443801879882812
mini_batch_src_global generation:  0.03360486030578613
r_  generation:  0.2648806571960449
local_output_nid generation:  0.013178348541259766
local_in_edges_tensor generation:  0.01894378662109375
mini_batch_src_global generation:  0.031674861907958984
r_  generation:  0.2646465301513672
local_output_nid generation:  0.013852357864379883
local_in_edges_tensor generation:  0.016232967376708984
mini_batch_src_global generation:  0.03383040428161621
r_  generation:  0.27352452278137207
local_output_nid generation:  0.014134645462036133
local_in_edges_tensor generation:  0.014554262161254883
mini_batch_src_global generation:  0.03485894203186035
r_  generation:  0.2814469337463379
local_output_nid generation:  0.013758659362792969
local_in_edges_tensor generation:  0.01650834083557129
mini_batch_src_global generation:  0.033757686614990234
r_  generation:  0.2724583148956299
local_output_nid generation:  0.013712167739868164
local_in_edges_tensor generation:  0.014158248901367188
mini_batch_src_global generation:  0.03665757179260254
r_  generation:  0.27138185501098633
local_output_nid generation:  0.013751029968261719
local_in_edges_tensor generation:  0.013974428176879883
mini_batch_src_global generation:  0.03410768508911133
r_  generation:  0.2696552276611328
local_output_nid generation:  0.013528108596801758
local_in_edges_tensor generation:  0.013755083084106445
mini_batch_src_global generation:  0.034032344818115234
r_  generation:  0.2669672966003418
local_output_nid generation:  0.013777971267700195
local_in_edges_tensor generation:  0.015069961547851562
mini_batch_src_global generation:  0.03438162803649902
r_  generation:  0.27470970153808594
local_output_nid generation:  0.013640165328979492
local_in_edges_tensor generation:  0.014367103576660156
mini_batch_src_global generation:  0.03567910194396973
r_  generation:  0.27985429763793945
local_output_nid generation:  0.013630390167236328
local_in_edges_tensor generation:  0.014265298843383789
mini_batch_src_global generation:  0.034670352935791016
r_  generation:  0.27457475662231445
local_output_nid generation:  0.013914108276367188
local_in_edges_tensor generation:  0.013913154602050781
mini_batch_src_global generation:  0.03697967529296875
r_  generation:  0.27304768562316895
local_output_nid generation:  0.013695240020751953
local_in_edges_tensor generation:  0.01397848129272461
mini_batch_src_global generation:  0.03469038009643555
r_  generation:  0.2758305072784424
local_output_nid generation:  0.013547420501708984
local_in_edges_tensor generation:  0.01394033432006836
mini_batch_src_global generation:  0.0346989631652832
r_  generation:  0.27097201347351074
local_output_nid generation:  0.013348102569580078
local_in_edges_tensor generation:  0.017861366271972656
mini_batch_src_global generation:  0.036298274993896484
r_  generation:  0.28350186347961426
----------------------check_connections_block total spend ----------------------------- 6.309636354446411
generate_one_block  0.36243772506713867
generate_one_block  0.3492774963378906
generate_one_block  0.3485112190246582
generate_one_block  0.3530151844024658
generate_one_block  0.3643202781677246
generate_one_block  0.3425767421722412
generate_one_block  0.37044191360473633
generate_one_block  0.3437802791595459
generate_one_block  0.34306812286376953
generate_one_block  0.34749412536621094
generate_one_block  0.3613760471343994
generate_one_block  0.3473949432373047
generate_one_block  0.3471958637237549
generate_one_block  0.3503739833831787
generate_one_block  0.34327268600463867
generate_one_block  0.36217689514160156
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04025459289550781
gen group dst list time:  0.06496405601501465
time for parepare:  0.017432689666748047
local_output_nid generation:  0.027821063995361328
local_in_edges_tensor generation:  0.04164910316467285
mini_batch_src_global generation:  0.048232316970825195
r_  generation:  0.5258493423461914
local_output_nid generation:  0.03293466567993164
local_in_edges_tensor generation:  0.03995108604431152
mini_batch_src_global generation:  0.06233572959899902
r_  generation:  0.5280389785766602
local_output_nid generation:  0.03281044960021973
local_in_edges_tensor generation:  0.03576493263244629
mini_batch_src_global generation:  0.05953359603881836
r_  generation:  0.5389976501464844
local_output_nid generation:  0.03313088417053223
local_in_edges_tensor generation:  0.03647804260253906
mini_batch_src_global generation:  0.060475826263427734
r_  generation:  0.5315368175506592
local_output_nid generation:  0.03333616256713867
local_in_edges_tensor generation:  0.07849621772766113
mini_batch_src_global generation:  0.061249732971191406
r_  generation:  0.5427937507629395
local_output_nid generation:  0.033405303955078125
local_in_edges_tensor generation:  0.038005828857421875
mini_batch_src_global generation:  0.061977386474609375
r_  generation:  0.5367872714996338
local_output_nid generation:  0.03311753273010254
local_in_edges_tensor generation:  0.03424668312072754
mini_batch_src_global generation:  0.06121325492858887
r_  generation:  0.541954755783081
local_output_nid generation:  0.0327296257019043
local_in_edges_tensor generation:  0.032937049865722656
mini_batch_src_global generation:  0.06215786933898926
r_  generation:  0.5416991710662842
local_output_nid generation:  0.03258872032165527
local_in_edges_tensor generation:  0.033957719802856445
mini_batch_src_global generation:  0.061197519302368164
r_  generation:  0.5463006496429443
local_output_nid generation:  0.032872676849365234
local_in_edges_tensor generation:  0.03571128845214844
mini_batch_src_global generation:  0.06603550910949707
r_  generation:  0.5412333011627197
local_output_nid generation:  0.033223628997802734
local_in_edges_tensor generation:  0.0330967903137207
mini_batch_src_global generation:  0.061308860778808594
r_  generation:  0.5487232208251953
local_output_nid generation:  0.03285813331604004
local_in_edges_tensor generation:  0.03563070297241211
mini_batch_src_global generation:  0.06302571296691895
r_  generation:  0.5419294834136963
local_output_nid generation:  0.03312373161315918
local_in_edges_tensor generation:  0.03316378593444824
mini_batch_src_global generation:  0.061041831970214844
r_  generation:  0.547027587890625
local_output_nid generation:  0.032898902893066406
local_in_edges_tensor generation:  0.033336639404296875
mini_batch_src_global generation:  0.06219196319580078
r_  generation:  0.5388369560241699
local_output_nid generation:  0.03280806541442871
local_in_edges_tensor generation:  0.03361201286315918
mini_batch_src_global generation:  0.06412124633789062
r_  generation:  0.5457439422607422
local_output_nid generation:  0.03405642509460449
local_in_edges_tensor generation:  0.03708004951477051
mini_batch_src_global generation:  0.062265634536743164
r_  generation:  0.546271800994873
----------------------check_connections_block total spend ----------------------------- 12.67340636253357
generate_one_block  0.6791579723358154
generate_one_block  0.6852037906646729
generate_one_block  0.6830039024353027
generate_one_block  0.6863656044006348
generate_one_block  0.6872053146362305
generate_one_block  0.6819112300872803
generate_one_block  0.6809484958648682
generate_one_block  0.6867938041687012
generate_one_block  0.7471117973327637
generate_one_block  0.6834855079650879
generate_one_block  0.6898024082183838
generate_one_block  0.6835222244262695
generate_one_block  0.6871483325958252
generate_one_block  0.6807279586791992
generate_one_block  0.6846275329589844
generate_one_block  0.6869621276855469
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.12864255905151367  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

connection checking time:  18.98304271697998
block generation total time  16.650691509246826
average batch blocks generation time:  1.0406682193279266
block dataloader generation time/epoch 38.0047295888265
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10094308853149414  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7823653221130371  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.0998539924621582  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7770628929138184  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.0997929573059082  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7768688201904297  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09970998764038086  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7722058296203613  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.100006103515625  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7814211845397949  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09973573684692383  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7692279815673828  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09961414337158203  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7686767578125  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09957647323608398  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7691512107849121  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09954118728637695  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7643132209777832  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09978389739990234  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7740802764892578  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09979772567749023  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7769923210144043  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.0997018814086914  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7706999778747559  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10073375701904297  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7745656967163086  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09968090057373047  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7677850723266602  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09969854354858398  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7669410705566406  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10008811950683594  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7816643714904785  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06323981285095215 |0.019105806946754456 |0.0036217719316482544 |9.350478649139404e-05 |0.0030817240476608276 |0.0023224353790283203 |
----------------------------------------------------------pseudo_mini_loss sum 1.2703691720962524
Total (block generation + training)time/epoch 39.50949668884277
Training time/epoch 1.493436574935913
Training time without block to device /epoch 1.1877436637878418
Training time without total dataloading part /epoch 0.11107444763183594
load block tensor time/epoch 1.0118370056152344
block to device time/epoch 0.3056929111480713
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 24 |
Number of nodes for computation during this epoch:  5331486
Number of first layer input nodes during this epoch:  2521514
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.12976455688476562  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023641109466552734
random selection method range initialization spend 0.0056154727935791016
time for parepare:  0.01967930793762207
local_output_nid generation:  0.002311229705810547
local_in_edges_tensor generation:  0.006340742111206055
mini_batch_src_global generation:  0.0021665096282958984
r_  generation:  0.02072286605834961
local_output_nid generation:  0.0029273033142089844
local_in_edges_tensor generation:  0.0017933845520019531
mini_batch_src_global generation:  0.002307415008544922
r_  generation:  0.022226810455322266
local_output_nid generation:  0.002981901168823242
local_in_edges_tensor generation:  0.001753091812133789
mini_batch_src_global generation:  0.0017542839050292969
r_  generation:  0.021363496780395508
local_output_nid generation:  0.0029828548431396484
local_in_edges_tensor generation:  0.0017466545104980469
mini_batch_src_global generation:  0.0017561912536621094
r_  generation:  0.02181386947631836
local_output_nid generation:  0.0029866695404052734
local_in_edges_tensor generation:  0.0017392635345458984
mini_batch_src_global generation:  0.00176239013671875
r_  generation:  0.021436691284179688
local_output_nid generation:  0.0030164718627929688
local_in_edges_tensor generation:  0.0017199516296386719
mini_batch_src_global generation:  0.0017800331115722656
r_  generation:  0.02268815040588379
local_output_nid generation:  0.0030629634857177734
local_in_edges_tensor generation:  0.001739501953125
mini_batch_src_global generation:  0.0018682479858398438
r_  generation:  0.022728443145751953
local_output_nid generation:  0.0030651092529296875
local_in_edges_tensor generation:  0.001708984375
mini_batch_src_global generation:  0.0018167495727539062
r_  generation:  0.02299809455871582
local_output_nid generation:  0.0029859542846679688
local_in_edges_tensor generation:  0.0017635822296142578
mini_batch_src_global generation:  0.0018224716186523438
r_  generation:  0.022703170776367188
local_output_nid generation:  0.002999544143676758
local_in_edges_tensor generation:  0.001739501953125
mini_batch_src_global generation:  0.0018076896667480469
r_  generation:  0.022537708282470703
local_output_nid generation:  0.0029799938201904297
local_in_edges_tensor generation:  0.001672506332397461
mini_batch_src_global generation:  0.0018038749694824219
r_  generation:  0.022615432739257812
local_output_nid generation:  0.002971649169921875
local_in_edges_tensor generation:  0.0016982555389404297
mini_batch_src_global generation:  0.0018231868743896484
r_  generation:  0.022504329681396484
local_output_nid generation:  0.002986907958984375
local_in_edges_tensor generation:  0.0017371177673339844
mini_batch_src_global generation:  0.0018401145935058594
r_  generation:  0.022635221481323242
local_output_nid generation:  0.0029592514038085938
local_in_edges_tensor generation:  0.0017285346984863281
mini_batch_src_global generation:  0.0017786026000976562
r_  generation:  0.021822452545166016
local_output_nid generation:  0.0029740333557128906
local_in_edges_tensor generation:  0.001726388931274414
mini_batch_src_global generation:  0.0018277168273925781
r_  generation:  0.022362947463989258
local_output_nid generation:  0.0029969215393066406
local_in_edges_tensor generation:  0.001697540283203125
mini_batch_src_global generation:  0.0018229484558105469
r_  generation:  0.022628307342529297
----------------------check_connections_block total spend ----------------------------- 0.5748023986816406
generate_one_block  0.029825448989868164
generate_one_block  0.03151226043701172
generate_one_block  0.03183341026306152
generate_one_block  0.03109288215637207
generate_one_block  0.0308074951171875
generate_one_block  0.03456377983093262
generate_one_block  0.032167911529541016
generate_one_block  0.03176307678222656
generate_one_block  0.03141474723815918
generate_one_block  0.031455039978027344
generate_one_block  0.03186988830566406
generate_one_block  0.031458139419555664
generate_one_block  0.031678199768066406
generate_one_block  0.03063654899597168
generate_one_block  0.031086444854736328
generate_one_block  0.03232216835021973
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03943514823913574
gen group dst list time:  0.018642902374267578
time for parepare:  0.019564390182495117
local_output_nid generation:  0.009143352508544922
local_in_edges_tensor generation:  0.025556087493896484
mini_batch_src_global generation:  0.026262760162353516
r_  generation:  0.24276471138000488
local_output_nid generation:  0.013284921646118164
local_in_edges_tensor generation:  0.019343852996826172
mini_batch_src_global generation:  0.0322117805480957
r_  generation:  0.2613792419433594
local_output_nid generation:  0.013111591339111328
local_in_edges_tensor generation:  0.015557527542114258
mini_batch_src_global generation:  0.031323909759521484
r_  generation:  0.26136183738708496
local_output_nid generation:  0.014071226119995117
local_in_edges_tensor generation:  0.017880678176879883
mini_batch_src_global generation:  0.0339810848236084
r_  generation:  0.26886868476867676
local_output_nid generation:  0.013742208480834961
local_in_edges_tensor generation:  0.014168262481689453
mini_batch_src_global generation:  0.03449058532714844
r_  generation:  0.3277866840362549
local_output_nid generation:  0.013727188110351562
local_in_edges_tensor generation:  0.015655994415283203
mini_batch_src_global generation:  0.036682844161987305
r_  generation:  0.2772846221923828
local_output_nid generation:  0.014145135879516602
local_in_edges_tensor generation:  0.01672530174255371
mini_batch_src_global generation:  0.0347592830657959
r_  generation:  0.27738451957702637
local_output_nid generation:  0.014079093933105469
local_in_edges_tensor generation:  0.014539718627929688
mini_batch_src_global generation:  0.034394264221191406
r_  generation:  0.2782731056213379
local_output_nid generation:  0.013923168182373047
local_in_edges_tensor generation:  0.014151811599731445
mini_batch_src_global generation:  0.03589487075805664
r_  generation:  0.2805211544036865
local_output_nid generation:  0.013911008834838867
local_in_edges_tensor generation:  0.014219999313354492
mini_batch_src_global generation:  0.03443455696105957
r_  generation:  0.2758469581604004
local_output_nid generation:  0.01582193374633789
local_in_edges_tensor generation:  0.01592540740966797
mini_batch_src_global generation:  0.034761667251586914
r_  generation:  0.2855660915374756
local_output_nid generation:  0.014741182327270508
local_in_edges_tensor generation:  0.021004676818847656
mini_batch_src_global generation:  0.035973310470581055
r_  generation:  0.2734968662261963
local_output_nid generation:  0.014360427856445312
local_in_edges_tensor generation:  0.018044710159301758
mini_batch_src_global generation:  0.03766942024230957
r_  generation:  0.28296518325805664
local_output_nid generation:  0.013806343078613281
local_in_edges_tensor generation:  0.020620346069335938
mini_batch_src_global generation:  0.03781628608703613
r_  generation:  0.28438496589660645
local_output_nid generation:  0.01334238052368164
local_in_edges_tensor generation:  0.01563239097595215
mini_batch_src_global generation:  0.03497934341430664
r_  generation:  0.28046560287475586
local_output_nid generation:  0.014451742172241211
local_in_edges_tensor generation:  0.01660776138305664
mini_batch_src_global generation:  0.03462576866149902
r_  generation:  0.27228260040283203
----------------------check_connections_block total spend ----------------------------- 6.419985294342041
generate_one_block  0.3557863235473633
generate_one_block  0.3495919704437256
generate_one_block  0.3526620864868164
generate_one_block  0.3549320697784424
generate_one_block  0.341947078704834
generate_one_block  0.3617274761199951
generate_one_block  0.3904271125793457
generate_one_block  0.37348198890686035
generate_one_block  0.3574988842010498
generate_one_block  0.3516829013824463
generate_one_block  0.35562920570373535
generate_one_block  0.3473544120788574
generate_one_block  0.3554403781890869
generate_one_block  0.35067272186279297
generate_one_block  0.35622167587280273
generate_one_block  0.3532090187072754
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04361462593078613
gen group dst list time:  0.06850957870483398
time for parepare:  0.020327329635620117
local_output_nid generation:  0.028000593185424805
local_in_edges_tensor generation:  0.06140279769897461
mini_batch_src_global generation:  0.05203986167907715
r_  generation:  0.5262737274169922
local_output_nid generation:  0.033193111419677734
local_in_edges_tensor generation:  0.04172205924987793
mini_batch_src_global generation:  0.06498456001281738
r_  generation:  0.5327372550964355
local_output_nid generation:  0.03361821174621582
local_in_edges_tensor generation:  0.03481435775756836
mini_batch_src_global generation:  0.0620570182800293
r_  generation:  0.5592176914215088
local_output_nid generation:  0.03642106056213379
local_in_edges_tensor generation:  0.039232730865478516
mini_batch_src_global generation:  0.0635373592376709
r_  generation:  0.53434157371521
local_output_nid generation:  0.034456491470336914
local_in_edges_tensor generation:  0.09241318702697754
mini_batch_src_global generation:  0.060295820236206055
r_  generation:  0.5372662544250488
local_output_nid generation:  0.03306126594543457
local_in_edges_tensor generation:  0.03429102897644043
mini_batch_src_global generation:  0.06149888038635254
r_  generation:  0.5358531475067139
local_output_nid generation:  0.03349733352661133
local_in_edges_tensor generation:  0.03515815734863281
mini_batch_src_global generation:  0.06099271774291992
r_  generation:  0.5422439575195312
local_output_nid generation:  0.03328967094421387
local_in_edges_tensor generation:  0.03490328788757324
mini_batch_src_global generation:  0.062270164489746094
r_  generation:  0.5417377948760986
local_output_nid generation:  0.03301358222961426
local_in_edges_tensor generation:  0.03209424018859863
mini_batch_src_global generation:  0.061811208724975586
r_  generation:  0.5397868156433105
local_output_nid generation:  0.03506827354431152
local_in_edges_tensor generation:  0.03248739242553711
mini_batch_src_global generation:  0.062244415283203125
r_  generation:  0.5494594573974609
local_output_nid generation:  0.03311324119567871
local_in_edges_tensor generation:  0.03666353225708008
mini_batch_src_global generation:  0.061762094497680664
r_  generation:  0.5447535514831543
local_output_nid generation:  0.03339099884033203
local_in_edges_tensor generation:  0.03203082084655762
mini_batch_src_global generation:  0.06328010559082031
r_  generation:  0.5426573753356934
local_output_nid generation:  0.03461408615112305
local_in_edges_tensor generation:  0.03375864028930664
mini_batch_src_global generation:  0.06128811836242676
r_  generation:  0.5406720638275146
local_output_nid generation:  0.03342270851135254
local_in_edges_tensor generation:  0.03814816474914551
mini_batch_src_global generation:  0.061925649642944336
r_  generation:  0.5371978282928467
local_output_nid generation:  0.03430008888244629
local_in_edges_tensor generation:  0.03442549705505371
mini_batch_src_global generation:  0.06184792518615723
r_  generation:  0.5440278053283691
local_output_nid generation:  0.03363656997680664
local_in_edges_tensor generation:  0.034654855728149414
mini_batch_src_global generation:  0.06216883659362793
r_  generation:  0.5404868125915527
----------------------check_connections_block total spend ----------------------------- 12.732580184936523
generate_one_block  0.689528226852417
generate_one_block  0.6934900283813477
generate_one_block  0.6894729137420654
generate_one_block  0.708364725112915
generate_one_block  0.691415548324585
generate_one_block  0.6795806884765625
generate_one_block  0.6854257583618164
generate_one_block  0.6895797252655029
generate_one_block  0.7230761051177979
generate_one_block  0.7005066871643066
generate_one_block  0.6805014610290527
generate_one_block  0.6877706050872803
generate_one_block  0.69207763671875
generate_one_block  0.6843984127044678
generate_one_block  0.6866014003753662
generate_one_block  0.6847283840179443
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.12976455688476562  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

connection checking time:  19.152565479278564
block generation total time  16.774783611297607
average batch blocks generation time:  1.0484239757061005
block dataloader generation time/epoch 38.017111107707024
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09949016571044922  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7652726173400879  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09973335266113281  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7702445983886719  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10075092315673828  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7728352546691895  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09977579116821289  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7725634574890137  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10064029693603516  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7738766670227051  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09985589981079102  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7768487930297852  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10088634490966797  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 0.7819733619689941  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.09992742538452148  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7799582481384277  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.09984493255615234  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7727823257446289  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.0997457504272461  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.770106315612793  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.09977865219116211  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7726569175720215  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.09964704513549805  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7675819396972656  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.09983968734741211  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7801051139831543  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.09966659545898438  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.768071174621582  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.09974861145019531  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7698807716369629  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.09970951080322266  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7700390815734863  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.061132580041885376 |0.016030430793762207 |0.0038531869649887085 |9.444355964660645e-05 |0.005105644464492798 |0.001817941665649414 |
----------------------------------------------------------pseudo_mini_loss sum 1.2617385387420654
Total (block generation + training)time/epoch 39.51819559931755
Training time/epoch 1.4455785751342773
Training time without block to device /epoch 1.189091682434082
Training time without total dataloading part /epoch 0.14667034149169922
load block tensor time/epoch 0.978121280670166
block to device time/epoch 0.2564868927001953
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 25 |
Number of nodes for computation during this epoch:  5330382
Number of first layer input nodes during this epoch:  2521860
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.12834501266479492  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026415348052978516
random selection method range initialization spend 0.00653076171875
time for parepare:  0.019124269485473633
local_output_nid generation:  0.0022416114807128906
local_in_edges_tensor generation:  0.0054399967193603516
mini_batch_src_global generation:  0.0018856525421142578
r_  generation:  0.021638870239257812
local_output_nid generation:  0.0029304027557373047
local_in_edges_tensor generation:  0.001857757568359375
mini_batch_src_global generation:  0.0020422935485839844
r_  generation:  0.022037029266357422
local_output_nid generation:  0.003046751022338867
local_in_edges_tensor generation:  0.0017642974853515625
mini_batch_src_global generation:  0.0017442703247070312
r_  generation:  0.021627187728881836
local_output_nid generation:  0.0029969215393066406
local_in_edges_tensor generation:  0.0017232894897460938
mini_batch_src_global generation:  0.0017521381378173828
r_  generation:  0.02201056480407715
local_output_nid generation:  0.0031163692474365234
local_in_edges_tensor generation:  0.0017232894897460938
mini_batch_src_global generation:  0.0018129348754882812
r_  generation:  0.022211790084838867
local_output_nid generation:  0.0030684471130371094
local_in_edges_tensor generation:  0.0016758441925048828
mini_batch_src_global generation:  0.0017821788787841797
r_  generation:  0.022611141204833984
local_output_nid generation:  0.003036022186279297
local_in_edges_tensor generation:  0.0017397403717041016
mini_batch_src_global generation:  0.0018246173858642578
r_  generation:  0.02247786521911621
local_output_nid generation:  0.0030214786529541016
local_in_edges_tensor generation:  0.0016756057739257812
mini_batch_src_global generation:  0.0018072128295898438
r_  generation:  0.02213311195373535
local_output_nid generation:  0.0030105113983154297
local_in_edges_tensor generation:  0.0017783641815185547
mini_batch_src_global generation:  0.0018000602722167969
r_  generation:  0.022696256637573242
local_output_nid generation:  0.0030181407928466797
local_in_edges_tensor generation:  0.0017237663269042969
mini_batch_src_global generation:  0.0018107891082763672
r_  generation:  0.022655963897705078
local_output_nid generation:  0.0030546188354492188
local_in_edges_tensor generation:  0.0017499923706054688
mini_batch_src_global generation:  0.0018374919891357422
r_  generation:  0.022650480270385742
local_output_nid generation:  0.0030112266540527344
local_in_edges_tensor generation:  0.0017032623291015625
mini_batch_src_global generation:  0.0017695426940917969
r_  generation:  0.02267313003540039
local_output_nid generation:  0.0029883384704589844
local_in_edges_tensor generation:  0.0016984939575195312
mini_batch_src_global generation:  0.00179290771484375
r_  generation:  0.022116422653198242
local_output_nid generation:  0.0029790401458740234
local_in_edges_tensor generation:  0.0016677379608154297
mini_batch_src_global generation:  0.001889944076538086
r_  generation:  0.022225379943847656
local_output_nid generation:  0.0031142234802246094
local_in_edges_tensor generation:  0.0017268657684326172
mini_batch_src_global generation:  0.0017688274383544922
r_  generation:  0.03624296188354492
local_output_nid generation:  0.005019664764404297
local_in_edges_tensor generation:  0.0027990341186523438
mini_batch_src_global generation:  0.02701425552368164
r_  generation:  0.025119304656982422
----------------------check_connections_block total spend ----------------------------- 0.6208600997924805
generate_one_block  0.03127789497375488
generate_one_block  0.03234744071960449
generate_one_block  0.03334927558898926
generate_one_block  0.03325796127319336
generate_one_block  0.03284001350402832
generate_one_block  0.03667783737182617
generate_one_block  0.033101558685302734
generate_one_block  0.046363115310668945
generate_one_block  0.0373537540435791
generate_one_block  0.03695535659790039
generate_one_block  0.03220391273498535
generate_one_block  0.031219005584716797
generate_one_block  0.03071284294128418
generate_one_block  0.0313723087310791
generate_one_block  0.031080007553100586
generate_one_block  0.03232693672180176
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03673839569091797
gen group dst list time:  0.0178225040435791
time for parepare:  0.020557165145874023
local_output_nid generation:  0.009166717529296875
local_in_edges_tensor generation:  0.031636714935302734
mini_batch_src_global generation:  0.026956558227539062
r_  generation:  0.26053619384765625
local_output_nid generation:  0.020589828491210938
local_in_edges_tensor generation:  0.029887676239013672
mini_batch_src_global generation:  0.0397646427154541
r_  generation:  0.2692561149597168
local_output_nid generation:  0.017467737197875977
local_in_edges_tensor generation:  0.015430212020874023
mini_batch_src_global generation:  0.0343780517578125
r_  generation:  0.27580928802490234
local_output_nid generation:  0.014191865921020508
local_in_edges_tensor generation:  0.019564151763916016
mini_batch_src_global generation:  0.036380767822265625
r_  generation:  0.3265564441680908
local_output_nid generation:  0.016333341598510742
local_in_edges_tensor generation:  0.021441936492919922
mini_batch_src_global generation:  0.03549695014953613
r_  generation:  0.28032493591308594
local_output_nid generation:  0.014176368713378906
local_in_edges_tensor generation:  0.016393423080444336
mini_batch_src_global generation:  0.03791928291320801
r_  generation:  0.28430843353271484
local_output_nid generation:  0.01392364501953125
local_in_edges_tensor generation:  0.015158891677856445
mini_batch_src_global generation:  0.036591291427612305
r_  generation:  0.2847747802734375
local_output_nid generation:  0.01380157470703125
local_in_edges_tensor generation:  0.014477729797363281
mini_batch_src_global generation:  0.03690004348754883
r_  generation:  0.28295135498046875
local_output_nid generation:  0.014009952545166016
local_in_edges_tensor generation:  0.01614832878112793
mini_batch_src_global generation:  0.03750181198120117
r_  generation:  0.29186010360717773
local_output_nid generation:  0.013890504837036133
local_in_edges_tensor generation:  0.016708850860595703
mini_batch_src_global generation:  0.03758096694946289
r_  generation:  0.2919168472290039
local_output_nid generation:  0.013241052627563477
local_in_edges_tensor generation:  0.014767885208129883
mini_batch_src_global generation:  0.03713798522949219
r_  generation:  0.29054951667785645
local_output_nid generation:  0.013821125030517578
local_in_edges_tensor generation:  0.013583898544311523
mini_batch_src_global generation:  0.0372319221496582
r_  generation:  0.28600120544433594
local_output_nid generation:  0.0138092041015625
local_in_edges_tensor generation:  0.013392448425292969
mini_batch_src_global generation:  0.03710055351257324
r_  generation:  0.2850639820098877
local_output_nid generation:  0.013791084289550781
local_in_edges_tensor generation:  0.013793468475341797
mini_batch_src_global generation:  0.03770565986633301
r_  generation:  0.28705525398254395
local_output_nid generation:  0.013447761535644531
local_in_edges_tensor generation:  0.013684511184692383
mini_batch_src_global generation:  0.038053035736083984
r_  generation:  0.28727173805236816
local_output_nid generation:  0.013291597366333008
local_in_edges_tensor generation:  0.015125513076782227
mini_batch_src_global generation:  0.03946399688720703
r_  generation:  0.29239630699157715
----------------------check_connections_block total spend ----------------------------- 6.6790173053741455
generate_one_block  0.3603532314300537
generate_one_block  0.3486776351928711
generate_one_block  0.34484338760375977
generate_one_block  0.3536553382873535
generate_one_block  0.35240817070007324
generate_one_block  0.3602607250213623
generate_one_block  0.3850266933441162
generate_one_block  0.35770249366760254
generate_one_block  0.36040830612182617
generate_one_block  0.35709166526794434
generate_one_block  0.358684778213501
generate_one_block  0.35793423652648926
generate_one_block  0.350632905960083
generate_one_block  0.35457396507263184
generate_one_block  0.3484001159667969
generate_one_block  0.3614189624786377
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04230928421020508
gen group dst list time:  0.07023811340332031
time for parepare:  0.019716501235961914
local_output_nid generation:  0.028229713439941406
local_in_edges_tensor generation:  0.057674407958984375
mini_batch_src_global generation:  0.05023074150085449
r_  generation:  0.5247092247009277
local_output_nid generation:  0.03263044357299805
local_in_edges_tensor generation:  0.04299426078796387
mini_batch_src_global generation:  0.06236124038696289
r_  generation:  0.5371048450469971
local_output_nid generation:  0.032468318939208984
local_in_edges_tensor generation:  0.03226351737976074
mini_batch_src_global generation:  0.06013202667236328
r_  generation:  0.5423026084899902
local_output_nid generation:  0.03331875801086426
local_in_edges_tensor generation:  0.03233695030212402
mini_batch_src_global generation:  0.06223154067993164
r_  generation:  0.537306547164917
local_output_nid generation:  0.034929752349853516
local_in_edges_tensor generation:  0.08454108238220215
mini_batch_src_global generation:  0.060855865478515625
r_  generation:  0.5448048114776611
local_output_nid generation:  0.03487205505371094
local_in_edges_tensor generation:  0.03488945960998535
mini_batch_src_global generation:  0.06260991096496582
r_  generation:  0.537825345993042
local_output_nid generation:  0.03406214714050293
local_in_edges_tensor generation:  0.03803443908691406
mini_batch_src_global generation:  0.06124067306518555
r_  generation:  0.5473225116729736
local_output_nid generation:  0.03288984298706055
local_in_edges_tensor generation:  0.03917074203491211
mini_batch_src_global generation:  0.06195783615112305
r_  generation:  0.541961669921875
local_output_nid generation:  0.033843994140625
local_in_edges_tensor generation:  0.03716683387756348
mini_batch_src_global generation:  0.06493043899536133
r_  generation:  0.54878830909729
local_output_nid generation:  0.03350663185119629
local_in_edges_tensor generation:  0.037537574768066406
mini_batch_src_global generation:  0.06565237045288086
r_  generation:  0.5581507682800293
local_output_nid generation:  0.03631138801574707
local_in_edges_tensor generation:  0.03528118133544922
mini_batch_src_global generation:  0.06529998779296875
r_  generation:  0.5439908504486084
local_output_nid generation:  0.0340733528137207
local_in_edges_tensor generation:  0.037900447845458984
mini_batch_src_global generation:  0.0627751350402832
r_  generation:  0.540546178817749
local_output_nid generation:  0.03444981575012207
local_in_edges_tensor generation:  0.03436851501464844
mini_batch_src_global generation:  0.06103873252868652
r_  generation:  0.5447545051574707
local_output_nid generation:  0.03409457206726074
local_in_edges_tensor generation:  0.034507036209106445
mini_batch_src_global generation:  0.06213092803955078
r_  generation:  0.5397477149963379
local_output_nid generation:  0.03406357765197754
local_in_edges_tensor generation:  0.033965110778808594
mini_batch_src_global generation:  0.061655521392822266
r_  generation:  0.5537478923797607
local_output_nid generation:  0.034058570861816406
local_in_edges_tensor generation:  0.03427314758300781
mini_batch_src_global generation:  0.06228923797607422
r_  generation:  0.5424723625183105
----------------------check_connections_block total spend ----------------------------- 12.765614748001099
generate_one_block  0.685377836227417
generate_one_block  0.6839125156402588
generate_one_block  0.6805880069732666
generate_one_block  0.686398983001709
generate_one_block  0.6836047172546387
generate_one_block  0.6885859966278076
generate_one_block  0.6869003772735596
generate_one_block  0.6892011165618896
generate_one_block  0.7636809349060059
generate_one_block  0.6830055713653564
generate_one_block  0.6819188594818115
generate_one_block  0.6873571872711182
generate_one_block  0.684537410736084
generate_one_block  0.6901304721832275
generate_one_block  0.6991457939147949
generate_one_block  0.7030632495880127
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.12834501266479492  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

connection checking time:  19.444632053375244
block generation total time  16.78948163986206
average batch blocks generation time:  1.0493426024913788
block dataloader generation time/epoch 38.05423256930183
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.09964418411254883  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.769075870513916  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.0995492935180664  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.766822338104248  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.09954833984375  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7698512077331543  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.09979438781738281  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7713761329650879  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.10068607330322266  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7745580673217773  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.09997320175170898  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7797093391418457  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.09973335266113281  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7704048156738281  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.09965705871582031  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7704653739929199  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.10088157653808594  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7808499336242676  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.09974002838134766  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7719573974609375  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.10082149505615234  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7780976295471191  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.09977006912231445  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7732081413269043  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.1007080078125  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7754659652709961  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.09990358352661133  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7716412544250488  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.09973287582397461  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7698254585266113  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.09979534149169922  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.773066520690918  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06416742503643036 |0.01743265986442566 |0.0034817904233932495 |9.223818778991699e-05 |0.0031991302967071533 |0.0027997493743896484 |
----------------------------------------------------------pseudo_mini_loss sum 1.24930739402771
Total (block generation + training)time/epoch 39.554223270977246
Training time/epoch 1.4822149276733398
Training time without block to device /epoch 1.2032923698425293
Training time without total dataloading part /epoch 0.11117029190063477
load block tensor time/epoch 1.0266788005828857
block to device time/epoch 0.27892255783081055
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 26 |
Number of nodes for computation during this epoch:  5329647
Number of first layer input nodes during this epoch:  2521476
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.1286001205444336  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024165868759155273
random selection method range initialization spend 0.005196332931518555
time for parepare:  0.01831984519958496
local_output_nid generation:  0.002335071563720703
local_in_edges_tensor generation:  0.007083415985107422
mini_batch_src_global generation:  0.0017518997192382812
r_  generation:  0.020436763763427734
local_output_nid generation:  0.003001689910888672
local_in_edges_tensor generation:  0.0018007755279541016
mini_batch_src_global generation:  0.002196073532104492
r_  generation:  0.022818326950073242
local_output_nid generation:  0.0030002593994140625
local_in_edges_tensor generation:  0.0017778873443603516
mini_batch_src_global generation:  0.0018661022186279297
r_  generation:  0.02221989631652832
local_output_nid generation:  0.0029926300048828125
local_in_edges_tensor generation:  0.0017096996307373047
mini_batch_src_global generation:  0.001871347427368164
r_  generation:  0.02227306365966797
local_output_nid generation:  0.0029859542846679688
local_in_edges_tensor generation:  0.0017664432525634766
mini_batch_src_global generation:  0.0017936229705810547
r_  generation:  0.02183246612548828
local_output_nid generation:  0.0030083656311035156
local_in_edges_tensor generation:  0.0017881393432617188
mini_batch_src_global generation:  0.00177764892578125
r_  generation:  0.022368192672729492
local_output_nid generation:  0.0030736923217773438
local_in_edges_tensor generation:  0.0017955303192138672
mini_batch_src_global generation:  0.0018095970153808594
r_  generation:  0.022258758544921875
local_output_nid generation:  0.002983570098876953
local_in_edges_tensor generation:  0.0017480850219726562
mini_batch_src_global generation:  0.0018355846405029297
r_  generation:  0.023862123489379883
local_output_nid generation:  0.003657102584838867
local_in_edges_tensor generation:  0.0017480850219726562
mini_batch_src_global generation:  0.0018177032470703125
r_  generation:  0.023093461990356445
local_output_nid generation:  0.0030515193939208984
local_in_edges_tensor generation:  0.0017743110656738281
mini_batch_src_global generation:  0.0018155574798583984
r_  generation:  0.021828413009643555
local_output_nid generation:  0.0031042098999023438
local_in_edges_tensor generation:  0.0017275810241699219
mini_batch_src_global generation:  0.0017924308776855469
r_  generation:  0.022885799407958984
local_output_nid generation:  0.003008604049682617
local_in_edges_tensor generation:  0.0017299652099609375
mini_batch_src_global generation:  0.0017840862274169922
r_  generation:  0.0220181941986084
local_output_nid generation:  0.0030450820922851562
local_in_edges_tensor generation:  0.0017390251159667969
mini_batch_src_global generation:  0.0017707347869873047
r_  generation:  0.023326396942138672
local_output_nid generation:  0.0038194656372070312
local_in_edges_tensor generation:  0.001817941665649414
mini_batch_src_global generation:  0.0019419193267822266
r_  generation:  0.022526979446411133
local_output_nid generation:  0.003062009811401367
local_in_edges_tensor generation:  0.0018074512481689453
mini_batch_src_global generation:  0.0017669200897216797
r_  generation:  0.02205038070678711
local_output_nid generation:  0.0030558109283447266
local_in_edges_tensor generation:  0.0017309188842773438
mini_batch_src_global generation:  0.0017445087432861328
r_  generation:  0.021823883056640625
----------------------check_connections_block total spend ----------------------------- 0.5823392868041992
generate_one_block  0.029538393020629883
generate_one_block  0.031819820404052734
generate_one_block  0.03372335433959961
generate_one_block  0.033888816833496094
generate_one_block  0.032579660415649414
generate_one_block  0.03706693649291992
generate_one_block  0.03271198272705078
generate_one_block  0.0335233211517334
generate_one_block  0.03285408020019531
generate_one_block  0.032701730728149414
generate_one_block  0.033211469650268555
generate_one_block  0.03238964080810547
generate_one_block  0.0324249267578125
generate_one_block  0.03291153907775879
generate_one_block  0.03406977653503418
generate_one_block  0.041162967681884766
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0400538444519043
gen group dst list time:  0.018407344818115234
time for parepare:  0.02079629898071289
local_output_nid generation:  0.009224653244018555
local_in_edges_tensor generation:  0.0276641845703125
mini_batch_src_global generation:  0.02568221092224121
r_  generation:  0.24204063415527344
local_output_nid generation:  0.013761520385742188
local_in_edges_tensor generation:  0.019132614135742188
mini_batch_src_global generation:  0.03367924690246582
r_  generation:  0.2652394771575928
local_output_nid generation:  0.013066768646240234
local_in_edges_tensor generation:  0.015125751495361328
mini_batch_src_global generation:  0.03257441520690918
r_  generation:  0.262831449508667
local_output_nid generation:  0.013524055480957031
local_in_edges_tensor generation:  0.01500248908996582
mini_batch_src_global generation:  0.03365302085876465
r_  generation:  0.2746715545654297
local_output_nid generation:  0.013935327529907227
local_in_edges_tensor generation:  0.014509201049804688
mini_batch_src_global generation:  0.03352046012878418
r_  generation:  0.27045273780822754
local_output_nid generation:  0.014056682586669922
local_in_edges_tensor generation:  0.014383077621459961
mini_batch_src_global generation:  0.03392672538757324
r_  generation:  0.2729039192199707
local_output_nid generation:  0.013702869415283203
local_in_edges_tensor generation:  0.01727461814880371
mini_batch_src_global generation:  0.034261465072631836
r_  generation:  0.2704336643218994
local_output_nid generation:  0.014099597930908203
local_in_edges_tensor generation:  0.015407323837280273
mini_batch_src_global generation:  0.03627634048461914
r_  generation:  0.27835941314697266
local_output_nid generation:  0.013910770416259766
local_in_edges_tensor generation:  0.014177322387695312
mini_batch_src_global generation:  0.03435921669006348
r_  generation:  0.27080655097961426
local_output_nid generation:  0.013353347778320312
local_in_edges_tensor generation:  0.014116764068603516
mini_batch_src_global generation:  0.036307573318481445
r_  generation:  0.2707712650299072
local_output_nid generation:  0.01342153549194336
local_in_edges_tensor generation:  0.014439821243286133
mini_batch_src_global generation:  0.03455495834350586
r_  generation:  0.2756679058074951
local_output_nid generation:  0.013746500015258789
local_in_edges_tensor generation:  0.014103889465332031
mini_batch_src_global generation:  0.03441786766052246
r_  generation:  0.27158451080322266
local_output_nid generation:  0.013810157775878906
local_in_edges_tensor generation:  0.013498544692993164
mini_batch_src_global generation:  0.03383326530456543
r_  generation:  0.2709503173828125
local_output_nid generation:  0.01409459114074707
local_in_edges_tensor generation:  0.015118837356567383
mini_batch_src_global generation:  0.0344386100769043
r_  generation:  0.2746570110321045
local_output_nid generation:  0.013460159301757812
local_in_edges_tensor generation:  0.013846635818481445
mini_batch_src_global generation:  0.03411698341369629
r_  generation:  0.27196598052978516
local_output_nid generation:  0.012892961502075195
local_in_edges_tensor generation:  0.014265060424804688
mini_batch_src_global generation:  0.0343475341796875
r_  generation:  0.2729463577270508
----------------------check_connections_block total spend ----------------------------- 6.260144948959351
generate_one_block  0.35007143020629883
generate_one_block  0.35808491706848145
generate_one_block  0.3556053638458252
generate_one_block  0.3588278293609619
generate_one_block  0.35578203201293945
generate_one_block  0.36013078689575195
generate_one_block  0.38152050971984863
generate_one_block  0.36099982261657715
generate_one_block  0.35079193115234375
generate_one_block  0.346663236618042
generate_one_block  0.3506810665130615
generate_one_block  0.3473820686340332
generate_one_block  0.3480374813079834
generate_one_block  0.35419464111328125
generate_one_block  0.34576869010925293
generate_one_block  0.3534884452819824
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03823733329772949
gen group dst list time:  0.06888008117675781
time for parepare:  0.019680500030517578
local_output_nid generation:  0.028131961822509766
local_in_edges_tensor generation:  0.052663564682006836
mini_batch_src_global generation:  0.05034947395324707
r_  generation:  0.541778564453125
local_output_nid generation:  0.03606557846069336
local_in_edges_tensor generation:  0.04038119316101074
mini_batch_src_global generation:  0.0678706169128418
r_  generation:  0.5234992504119873
local_output_nid generation:  0.03397345542907715
local_in_edges_tensor generation:  0.03329014778137207
mini_batch_src_global generation:  0.05979776382446289
r_  generation:  0.5342679023742676
local_output_nid generation:  0.03389573097229004
local_in_edges_tensor generation:  0.03516411781311035
mini_batch_src_global generation:  0.05967092514038086
r_  generation:  0.5345923900604248
local_output_nid generation:  0.03386712074279785
local_in_edges_tensor generation:  0.08821773529052734
mini_batch_src_global generation:  0.060846567153930664
r_  generation:  0.542447566986084
local_output_nid generation:  0.033045053482055664
local_in_edges_tensor generation:  0.03778409957885742
mini_batch_src_global generation:  0.0615077018737793
r_  generation:  0.5399131774902344
local_output_nid generation:  0.032721757888793945
local_in_edges_tensor generation:  0.03245353698730469
mini_batch_src_global generation:  0.0610194206237793
r_  generation:  0.5420510768890381
local_output_nid generation:  0.03399205207824707
local_in_edges_tensor generation:  0.0350339412689209
mini_batch_src_global generation:  0.061988115310668945
r_  generation:  0.552894115447998
local_output_nid generation:  0.03300929069519043
local_in_edges_tensor generation:  0.035474300384521484
mini_batch_src_global generation:  0.061359405517578125
r_  generation:  0.547541618347168
local_output_nid generation:  0.03297781944274902
local_in_edges_tensor generation:  0.03484606742858887
mini_batch_src_global generation:  0.0623316764831543
r_  generation:  0.5466163158416748
local_output_nid generation:  0.03338170051574707
local_in_edges_tensor generation:  0.0385432243347168
mini_batch_src_global generation:  0.0625455379486084
r_  generation:  0.5434894561767578
local_output_nid generation:  0.0331573486328125
local_in_edges_tensor generation:  0.03455543518066406
mini_batch_src_global generation:  0.062404632568359375
r_  generation:  0.5409247875213623
local_output_nid generation:  0.03319573402404785
local_in_edges_tensor generation:  0.032654762268066406
mini_batch_src_global generation:  0.06419157981872559
r_  generation:  0.544020414352417
local_output_nid generation:  0.03337836265563965
local_in_edges_tensor generation:  0.03886890411376953
mini_batch_src_global generation:  0.06206250190734863
r_  generation:  0.5487449169158936
local_output_nid generation:  0.034539222717285156
local_in_edges_tensor generation:  0.03669595718383789
mini_batch_src_global generation:  0.06172752380371094
r_  generation:  0.5447642803192139
local_output_nid generation:  0.03344368934631348
local_in_edges_tensor generation:  0.03481745719909668
mini_batch_src_global generation:  0.06277680397033691
r_  generation:  0.543419361114502
----------------------check_connections_block total spend ----------------------------- 12.743784427642822
generate_one_block  0.6933159828186035
generate_one_block  0.6881844997406006
generate_one_block  0.6968994140625
generate_one_block  0.6856868267059326
generate_one_block  0.6840634346008301
generate_one_block  0.6881048679351807
generate_one_block  0.6829016208648682
generate_one_block  0.6901488304138184
generate_one_block  0.7344367504119873
generate_one_block  0.6829688549041748
generate_one_block  0.6912000179290771
generate_one_block  0.6925857067108154
generate_one_block  0.6866888999938965
generate_one_block  0.6909356117248535
generate_one_block  0.6835448741912842
generate_one_block  0.6834125518798828
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.1286001205444336  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

connection checking time:  19.003929376602173
block generation total time  16.73310899734497
average batch blocks generation time:  1.0458193123340607
block dataloader generation time/epoch 38.05349751313528
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.09955310821533203  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7656831741333008  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.0999751091003418  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7812633514404297  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.09975814819335938  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7726807594299316  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.0997772216796875  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7712006568908691  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.09975767135620117  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7716474533081055  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.0999140739440918  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7774825096130371  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.0997314453125  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7690839767456055  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.10003376007080078  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7779974937438965  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.09975481033325195  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7732372283935547  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.09965133666992188  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7684726715087891  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.0998544692993164  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7725214958190918  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.09976863861083984  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7699332237243652  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.09968280792236328  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7734804153442383  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.0998845100402832  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7795205116271973  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.0995626449584961  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7681646347045898  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.09977579116821289  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7701964378356934  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06317207217216492 |0.015539035201072693 |0.003584042191505432 |9.410083293914795e-05 |0.003155320882797241 |0.001928567886352539 |
----------------------------------------------------------pseudo_mini_loss sum 1.2380672693252563
Total (block generation + training)time/epoch 39.549923062324524
Training time/epoch 1.4355580806732178
Training time without block to device /epoch 1.1869335174560547
Training time without total dataloading part /epoch 0.11126399040222168
load block tensor time/epoch 1.0107531547546387
block to device time/epoch 0.24862456321716309
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 27 |
Number of nodes for computation during this epoch:  5331060
Number of first layer input nodes during this epoch:  2521929
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.1273355484008789  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025139331817626953
random selection method range initialization spend 0.005126476287841797
time for parepare:  0.017841577529907227
local_output_nid generation:  0.002438783645629883
local_in_edges_tensor generation:  0.0051348209381103516
mini_batch_src_global generation:  0.0015730857849121094
r_  generation:  0.020889997482299805
local_output_nid generation:  0.0028972625732421875
local_in_edges_tensor generation:  0.0017275810241699219
mini_batch_src_global generation:  0.0020852088928222656
r_  generation:  0.02235269546508789
local_output_nid generation:  0.0029833316802978516
local_in_edges_tensor generation:  0.00167083740234375
mini_batch_src_global generation:  0.0017201900482177734
r_  generation:  0.021889448165893555
local_output_nid generation:  0.003069162368774414
local_in_edges_tensor generation:  0.0016629695892333984
mini_batch_src_global generation:  0.0018088817596435547
r_  generation:  0.02236652374267578
local_output_nid generation:  0.0030770301818847656
local_in_edges_tensor generation:  0.0017054080963134766
mini_batch_src_global generation:  0.00176239013671875
r_  generation:  0.02182745933532715
local_output_nid generation:  0.003023862838745117
local_in_edges_tensor generation:  0.0016937255859375
mini_batch_src_global generation:  0.0017209053039550781
r_  generation:  0.0214841365814209
local_output_nid generation:  0.0030591487884521484
local_in_edges_tensor generation:  0.0016901493072509766
mini_batch_src_global generation:  0.0017616748809814453
r_  generation:  0.022075176239013672
local_output_nid generation:  0.003004312515258789
local_in_edges_tensor generation:  0.001638174057006836
mini_batch_src_global generation:  0.0018122196197509766
r_  generation:  0.022678852081298828
local_output_nid generation:  0.003086566925048828
local_in_edges_tensor generation:  0.0016911029815673828
mini_batch_src_global generation:  0.0017619132995605469
r_  generation:  0.022295475006103516
local_output_nid generation:  0.003008604049682617
local_in_edges_tensor generation:  0.0017282962799072266
mini_batch_src_global generation:  0.0017993450164794922
r_  generation:  0.022281169891357422
local_output_nid generation:  0.0030760765075683594
local_in_edges_tensor generation:  0.001617431640625
mini_batch_src_global generation:  0.0017619132995605469
r_  generation:  0.022420406341552734
local_output_nid generation:  0.0030410289764404297
local_in_edges_tensor generation:  0.0016298294067382812
mini_batch_src_global generation:  0.0018241405487060547
r_  generation:  0.023142337799072266
local_output_nid generation:  0.003086566925048828
local_in_edges_tensor generation:  0.0016360282897949219
mini_batch_src_global generation:  0.0018131732940673828
r_  generation:  0.02290487289428711
local_output_nid generation:  0.0030853748321533203
local_in_edges_tensor generation:  0.0016906261444091797
mini_batch_src_global generation:  0.001821279525756836
r_  generation:  0.022391319274902344
local_output_nid generation:  0.003113269805908203
local_in_edges_tensor generation:  0.00171661376953125
mini_batch_src_global generation:  0.001752614974975586
r_  generation:  0.021696805953979492
local_output_nid generation:  0.0030231475830078125
local_in_edges_tensor generation:  0.0016322135925292969
mini_batch_src_global generation:  0.0017507076263427734
r_  generation:  0.02145552635192871
----------------------check_connections_block total spend ----------------------------- 0.5714571475982666
generate_one_block  0.03154301643371582
generate_one_block  0.03190803527832031
generate_one_block  0.03224587440490723
generate_one_block  0.031722068786621094
generate_one_block  0.030756711959838867
generate_one_block  0.033327341079711914
generate_one_block  0.03142237663269043
generate_one_block  0.03520321846008301
generate_one_block  0.03241872787475586
generate_one_block  0.03115987777709961
generate_one_block  0.03114795684814453
generate_one_block  0.03297734260559082
generate_one_block  0.03261137008666992
generate_one_block  0.031191110610961914
generate_one_block  0.03358125686645508
generate_one_block  0.031199216842651367
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03763937950134277
gen group dst list time:  0.020807504653930664
time for parepare:  0.01955103874206543
local_output_nid generation:  0.009280681610107422
local_in_edges_tensor generation:  0.028375864028930664
mini_batch_src_global generation:  0.026456594467163086
r_  generation:  0.2525811195373535
local_output_nid generation:  0.013941526412963867
local_in_edges_tensor generation:  0.018961191177368164
mini_batch_src_global generation:  0.03227424621582031
r_  generation:  0.2683744430541992
local_output_nid generation:  0.013361930847167969
local_in_edges_tensor generation:  0.01946115493774414
mini_batch_src_global generation:  0.03350496292114258
r_  generation:  0.2742457389831543
local_output_nid generation:  0.013476371765136719
local_in_edges_tensor generation:  0.01392984390258789
mini_batch_src_global generation:  0.03278231620788574
r_  generation:  0.2743844985961914
local_output_nid generation:  0.01402139663696289
local_in_edges_tensor generation:  0.016322851181030273
mini_batch_src_global generation:  0.033289194107055664
r_  generation:  0.26946568489074707
local_output_nid generation:  0.013888835906982422
local_in_edges_tensor generation:  0.018184185028076172
mini_batch_src_global generation:  0.03427433967590332
r_  generation:  0.26537513732910156
local_output_nid generation:  0.013738870620727539
local_in_edges_tensor generation:  0.016504526138305664
mini_batch_src_global generation:  0.033499956130981445
r_  generation:  0.27182769775390625
local_output_nid generation:  0.014011383056640625
local_in_edges_tensor generation:  0.014162302017211914
mini_batch_src_global generation:  0.0341029167175293
r_  generation:  0.27611398696899414
local_output_nid generation:  0.0140380859375
local_in_edges_tensor generation:  0.014431953430175781
mini_batch_src_global generation:  0.03406643867492676
r_  generation:  0.28048253059387207
local_output_nid generation:  0.01530313491821289
local_in_edges_tensor generation:  0.013888835906982422
mini_batch_src_global generation:  0.03531002998352051
r_  generation:  0.2762413024902344
local_output_nid generation:  0.01383662223815918
local_in_edges_tensor generation:  0.014131784439086914
mini_batch_src_global generation:  0.035233259201049805
r_  generation:  0.2786710262298584
local_output_nid generation:  0.014076471328735352
local_in_edges_tensor generation:  0.014024972915649414
mini_batch_src_global generation:  0.03635597229003906
r_  generation:  0.27944159507751465
local_output_nid generation:  0.014272451400756836
local_in_edges_tensor generation:  0.015870332717895508
mini_batch_src_global generation:  0.03730440139770508
r_  generation:  0.28238701820373535
local_output_nid generation:  0.013924598693847656
local_in_edges_tensor generation:  0.019709348678588867
mini_batch_src_global generation:  0.039678096771240234
r_  generation:  0.2764766216278076
local_output_nid generation:  0.01434636116027832
local_in_edges_tensor generation:  0.020180463790893555
mini_batch_src_global generation:  0.035762786865234375
r_  generation:  0.2757303714752197
local_output_nid generation:  0.013122797012329102
local_in_edges_tensor generation:  0.01505422592163086
mini_batch_src_global generation:  0.03326129913330078
r_  generation:  0.27150678634643555
----------------------check_connections_block total spend ----------------------------- 6.35120153427124
generate_one_block  0.3650646209716797
generate_one_block  0.360584020614624
generate_one_block  0.37097668647766113
generate_one_block  0.3717210292816162
generate_one_block  0.36362671852111816
generate_one_block  0.35219430923461914
generate_one_block  0.38522768020629883
generate_one_block  0.35343027114868164
generate_one_block  0.35839176177978516
generate_one_block  0.35294461250305176
generate_one_block  0.34755921363830566
generate_one_block  0.3542513847351074
generate_one_block  0.35839271545410156
generate_one_block  0.3594222068786621
generate_one_block  0.3435804843902588
generate_one_block  0.34371018409729004
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04301953315734863
gen group dst list time:  0.06556296348571777
time for parepare:  0.01795196533203125
local_output_nid generation:  0.029300928115844727
local_in_edges_tensor generation:  0.06130528450012207
mini_batch_src_global generation:  0.052403926849365234
r_  generation:  0.5294833183288574
local_output_nid generation:  0.03344011306762695
local_in_edges_tensor generation:  0.04281949996948242
mini_batch_src_global generation:  0.06320357322692871
r_  generation:  0.5291492938995361
local_output_nid generation:  0.034487247467041016
local_in_edges_tensor generation:  0.0421907901763916
mini_batch_src_global generation:  0.05934500694274902
r_  generation:  0.5408029556274414
local_output_nid generation:  0.033240318298339844
local_in_edges_tensor generation:  0.04140472412109375
mini_batch_src_global generation:  0.060790300369262695
r_  generation:  0.5345723628997803
local_output_nid generation:  0.03311610221862793
local_in_edges_tensor generation:  0.0804440975189209
mini_batch_src_global generation:  0.05977892875671387
r_  generation:  0.5416438579559326
local_output_nid generation:  0.033266305923461914
local_in_edges_tensor generation:  0.03859877586364746
mini_batch_src_global generation:  0.06099510192871094
r_  generation:  0.5387160778045654
local_output_nid generation:  0.03323006629943848
local_in_edges_tensor generation:  0.041692256927490234
mini_batch_src_global generation:  0.06020855903625488
r_  generation:  0.5678181648254395
local_output_nid generation:  0.036161184310913086
local_in_edges_tensor generation:  0.036307573318481445
mini_batch_src_global generation:  0.06595873832702637
r_  generation:  0.5403866767883301
local_output_nid generation:  0.03428220748901367
local_in_edges_tensor generation:  0.0387725830078125
mini_batch_src_global generation:  0.06141328811645508
r_  generation:  0.5433051586151123
local_output_nid generation:  0.03371763229370117
local_in_edges_tensor generation:  0.03429532051086426
mini_batch_src_global generation:  0.061647653579711914
r_  generation:  0.5384352207183838
local_output_nid generation:  0.03402256965637207
local_in_edges_tensor generation:  0.03646397590637207
mini_batch_src_global generation:  0.0608370304107666
r_  generation:  0.5459752082824707
local_output_nid generation:  0.03417205810546875
local_in_edges_tensor generation:  0.03593087196350098
mini_batch_src_global generation:  0.061638593673706055
r_  generation:  0.5418751239776611
local_output_nid generation:  0.03428530693054199
local_in_edges_tensor generation:  0.03868699073791504
mini_batch_src_global generation:  0.06146502494812012
r_  generation:  0.5470662117004395
local_output_nid generation:  0.03427839279174805
local_in_edges_tensor generation:  0.036286354064941406
mini_batch_src_global generation:  0.06298112869262695
r_  generation:  0.540468692779541
local_output_nid generation:  0.03411602973937988
local_in_edges_tensor generation:  0.038709402084350586
mini_batch_src_global generation:  0.06153678894042969
r_  generation:  0.5450310707092285
local_output_nid generation:  0.035204172134399414
local_in_edges_tensor generation:  0.04044318199157715
mini_batch_src_global generation:  0.06266474723815918
r_  generation:  0.5439291000366211
----------------------check_connections_block total spend ----------------------------- 12.79213809967041
generate_one_block  0.6948683261871338
generate_one_block  0.6898524761199951
generate_one_block  0.6897027492523193
generate_one_block  0.6835837364196777
generate_one_block  0.6840903759002686
generate_one_block  0.6846692562103271
generate_one_block  0.6832678318023682
generate_one_block  0.6883056163787842
generate_one_block  0.7639665603637695
generate_one_block  0.7004213333129883
generate_one_block  0.68876051902771
generate_one_block  0.6834051609039307
generate_one_block  0.6854777336120605
generate_one_block  0.6931171417236328
generate_one_block  0.6792917251586914
generate_one_block  0.6957080364227295
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.1273355484008789  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

connection checking time:  19.14333963394165
block generation total time  16.829566478729248
average batch blocks generation time:  1.051847904920578
block dataloader generation time/epoch 38.063312241905614
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.09977197647094727  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7727384567260742  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.09985685348510742  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7728867530822754  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.10094642639160156  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7817702293395996  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.09976863861083984  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7728910446166992  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.09968805313110352  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7700252532958984  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.09943151473999023  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.761751651763916  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.09973716735839844  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7696781158447266  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.09995126724243164  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7797842025756836  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.099853515625  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7795743942260742  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.09963846206665039  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7659072875976562  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.09958457946777344  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7718214988708496  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.0997767448425293  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7718815803527832  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.09986543655395508  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7803840637207031  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.09965801239013672  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7699103355407715  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.09949970245361328  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7657337188720703  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.09958600997924805  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.768157958984375  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06576882302761078 |0.017453819513320923 |0.003775492310523987 |9.329617023468018e-05 |0.003632262349128723 |0.0017490386962890625 |
----------------------------------------------------------pseudo_mini_loss sum 1.2242554426193237
Total (block generation + training)time/epoch 39.56088505293194
Training time/epoch 1.5179648399353027
Training time without block to device /epoch 1.238703727722168
Training time without total dataloading part /epoch 0.1217658519744873
load block tensor time/epoch 1.0523011684417725
block to device time/epoch 0.27926111221313477
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 28 |
Number of nodes for computation during this epoch:  5326553
Number of first layer input nodes during this epoch:  2520287
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.12687110900878906  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03885769844055176
random selection method range initialization spend 0.0070307254791259766
time for parepare:  0.019433975219726562
local_output_nid generation:  0.0024373531341552734
local_in_edges_tensor generation:  0.006108522415161133
mini_batch_src_global generation:  0.002100229263305664
r_  generation:  0.02280569076538086
local_output_nid generation:  0.0029146671295166016
local_in_edges_tensor generation:  0.0017342567443847656
mini_batch_src_global generation:  0.0024280548095703125
r_  generation:  0.024195194244384766
local_output_nid generation:  0.0030786991119384766
local_in_edges_tensor generation:  0.0017619132995605469
mini_batch_src_global generation:  0.0020890235900878906
r_  generation:  0.023830175399780273
local_output_nid generation:  0.003050565719604492
local_in_edges_tensor generation:  0.0016629695892333984
mini_batch_src_global generation:  0.0021593570709228516
r_  generation:  0.02381610870361328
local_output_nid generation:  0.003049612045288086
local_in_edges_tensor generation:  0.0017120838165283203
mini_batch_src_global generation:  0.002160310745239258
r_  generation:  0.023949146270751953
local_output_nid generation:  0.0030562877655029297
local_in_edges_tensor generation:  0.0016570091247558594
mini_batch_src_global generation:  0.0021445751190185547
r_  generation:  0.021839141845703125
local_output_nid generation:  0.003044605255126953
local_in_edges_tensor generation:  0.0016505718231201172
mini_batch_src_global generation:  0.001794576644897461
r_  generation:  0.022905349731445312
local_output_nid generation:  0.003111600875854492
local_in_edges_tensor generation:  0.0016100406646728516
mini_batch_src_global generation:  0.0018301010131835938
r_  generation:  0.022815227508544922
local_output_nid generation:  0.003103017807006836
local_in_edges_tensor generation:  0.0016350746154785156
mini_batch_src_global generation:  0.0018410682678222656
r_  generation:  0.022765398025512695
local_output_nid generation:  0.003040313720703125
local_in_edges_tensor generation:  0.001684427261352539
mini_batch_src_global generation:  0.0017936229705810547
r_  generation:  0.022223234176635742
local_output_nid generation:  0.0030531883239746094
local_in_edges_tensor generation:  0.0015947818756103516
mini_batch_src_global generation:  0.0017545223236083984
r_  generation:  0.02152395248413086
local_output_nid generation:  0.0030324459075927734
local_in_edges_tensor generation:  0.0015730857849121094
mini_batch_src_global generation:  0.0017282962799072266
r_  generation:  0.021836519241333008
local_output_nid generation:  0.0030541419982910156
local_in_edges_tensor generation:  0.0015680789947509766
mini_batch_src_global generation:  0.0018329620361328125
r_  generation:  0.023159027099609375
local_output_nid generation:  0.003149271011352539
local_in_edges_tensor generation:  0.0016574859619140625
mini_batch_src_global generation:  0.0017840862274169922
r_  generation:  0.022188663482666016
local_output_nid generation:  0.00315093994140625
local_in_edges_tensor generation:  0.0016262531280517578
mini_batch_src_global generation:  0.0017437934875488281
r_  generation:  0.022138595581054688
local_output_nid generation:  0.003141164779663086
local_in_edges_tensor generation:  0.001531362533569336
mini_batch_src_global generation:  0.0018067359924316406
r_  generation:  0.022552490234375
----------------------check_connections_block total spend ----------------------------- 0.5910000801086426
generate_one_block  0.03013467788696289
generate_one_block  0.030754566192626953
generate_one_block  0.0313878059387207
generate_one_block  0.030970335006713867
generate_one_block  0.03134870529174805
generate_one_block  0.03387141227722168
generate_one_block  0.032418012619018555
generate_one_block  0.03134751319885254
generate_one_block  0.03236222267150879
generate_one_block  0.030770540237426758
generate_one_block  0.030538320541381836
generate_one_block  0.031091928482055664
generate_one_block  0.032356977462768555
generate_one_block  0.0314638614654541
generate_one_block  0.03076910972595215
generate_one_block  0.032012224197387695
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.035678863525390625
gen group dst list time:  0.017900466918945312
time for parepare:  0.019214630126953125
local_output_nid generation:  0.00925755500793457
local_in_edges_tensor generation:  0.024211645126342773
mini_batch_src_global generation:  0.026206254959106445
r_  generation:  0.24369215965270996
local_output_nid generation:  0.013882875442504883
local_in_edges_tensor generation:  0.0186004638671875
mini_batch_src_global generation:  0.03290152549743652
r_  generation:  0.2572634220123291
local_output_nid generation:  0.013237476348876953
local_in_edges_tensor generation:  0.013860702514648438
mini_batch_src_global generation:  0.032921552658081055
r_  generation:  0.26589322090148926
local_output_nid generation:  0.013605117797851562
local_in_edges_tensor generation:  0.01497030258178711
mini_batch_src_global generation:  0.03374433517456055
r_  generation:  0.2707350254058838
local_output_nid generation:  0.014101743698120117
local_in_edges_tensor generation:  0.016124963760375977
mini_batch_src_global generation:  0.03494071960449219
r_  generation:  0.27707481384277344
local_output_nid generation:  0.016756772994995117
local_in_edges_tensor generation:  0.021931171417236328
mini_batch_src_global generation:  0.03525805473327637
r_  generation:  0.275376558303833
local_output_nid generation:  0.01410365104675293
local_in_edges_tensor generation:  0.02086639404296875
mini_batch_src_global generation:  0.039429664611816406
r_  generation:  0.2807765007019043
local_output_nid generation:  0.014143705368041992
local_in_edges_tensor generation:  0.015383481979370117
mini_batch_src_global generation:  0.03623247146606445
r_  generation:  0.2925429344177246
local_output_nid generation:  0.016539335250854492
local_in_edges_tensor generation:  0.0161592960357666
mini_batch_src_global generation:  0.03617668151855469
r_  generation:  0.27614521980285645
local_output_nid generation:  0.013965129852294922
local_in_edges_tensor generation:  0.01845407485961914
mini_batch_src_global generation:  0.0349423885345459
r_  generation:  0.26833176612854004
local_output_nid generation:  0.01364898681640625
local_in_edges_tensor generation:  0.014264106750488281
mini_batch_src_global generation:  0.03365731239318848
r_  generation:  0.2661173343658447
local_output_nid generation:  0.014294147491455078
local_in_edges_tensor generation:  0.014221429824829102
mini_batch_src_global generation:  0.03445792198181152
r_  generation:  0.2731804847717285
local_output_nid generation:  0.014516830444335938
local_in_edges_tensor generation:  0.019287586212158203
mini_batch_src_global generation:  0.037502288818359375
r_  generation:  0.28142857551574707
local_output_nid generation:  0.014188766479492188
local_in_edges_tensor generation:  0.014183759689331055
mini_batch_src_global generation:  0.03506112098693848
r_  generation:  0.27452778816223145
local_output_nid generation:  0.014039278030395508
local_in_edges_tensor generation:  0.014898061752319336
mini_batch_src_global generation:  0.034722328186035156
r_  generation:  0.2810180187225342
local_output_nid generation:  0.016970396041870117
local_in_edges_tensor generation:  0.016681194305419922
mini_batch_src_global generation:  0.03474736213684082
r_  generation:  0.2781989574432373
----------------------check_connections_block total spend ----------------------------- 6.367227792739868
generate_one_block  0.3627796173095703
generate_one_block  0.35230231285095215
generate_one_block  0.3519144058227539
generate_one_block  0.35260891914367676
generate_one_block  0.35850977897644043
generate_one_block  0.3507871627807617
generate_one_block  0.40352845191955566
generate_one_block  0.3517277240753174
generate_one_block  0.3569161891937256
generate_one_block  0.34488773345947266
generate_one_block  0.34207582473754883
generate_one_block  0.3483438491821289
generate_one_block  0.36776304244995117
generate_one_block  0.3474869728088379
generate_one_block  0.34793829917907715
generate_one_block  0.36684441566467285
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.039778709411621094
gen group dst list time:  0.06428384780883789
time for parepare:  0.01952838897705078
local_output_nid generation:  0.027896642684936523
local_in_edges_tensor generation:  0.05822181701660156
mini_batch_src_global generation:  0.05077409744262695
r_  generation:  0.5226826667785645
local_output_nid generation:  0.03249192237854004
local_in_edges_tensor generation:  0.037064313888549805
mini_batch_src_global generation:  0.06227445602416992
r_  generation:  0.5183393955230713
local_output_nid generation:  0.03324437141418457
local_in_edges_tensor generation:  0.03230094909667969
mini_batch_src_global generation:  0.06015968322753906
r_  generation:  0.5310928821563721
local_output_nid generation:  0.03280806541442871
local_in_edges_tensor generation:  0.0386052131652832
mini_batch_src_global generation:  0.05929827690124512
r_  generation:  0.536686897277832
local_output_nid generation:  0.03356575965881348
local_in_edges_tensor generation:  0.08931088447570801
mini_batch_src_global generation:  0.05933117866516113
r_  generation:  0.537062406539917
local_output_nid generation:  0.03263092041015625
local_in_edges_tensor generation:  0.0347135066986084
mini_batch_src_global generation:  0.0621800422668457
r_  generation:  0.5410737991333008
local_output_nid generation:  0.03286242485046387
local_in_edges_tensor generation:  0.03399038314819336
mini_batch_src_global generation:  0.062046051025390625
r_  generation:  0.5388588905334473
local_output_nid generation:  0.03320145606994629
local_in_edges_tensor generation:  0.033696651458740234
mini_batch_src_global generation:  0.06286859512329102
r_  generation:  0.5406093597412109
local_output_nid generation:  0.032878875732421875
local_in_edges_tensor generation:  0.03505873680114746
mini_batch_src_global generation:  0.06050467491149902
r_  generation:  0.5430049896240234
local_output_nid generation:  0.03301525115966797
local_in_edges_tensor generation:  0.0375213623046875
mini_batch_src_global generation:  0.06103849411010742
r_  generation:  0.556133508682251
local_output_nid generation:  0.0348668098449707
local_in_edges_tensor generation:  0.038584232330322266
mini_batch_src_global generation:  0.06517767906188965
r_  generation:  0.5490784645080566
local_output_nid generation:  0.0340423583984375
local_in_edges_tensor generation:  0.033774614334106445
mini_batch_src_global generation:  0.06108570098876953
r_  generation:  0.5396475791931152
local_output_nid generation:  0.03433036804199219
local_in_edges_tensor generation:  0.03424191474914551
mini_batch_src_global generation:  0.061858415603637695
r_  generation:  0.5427289009094238
local_output_nid generation:  0.034172773361206055
local_in_edges_tensor generation:  0.03216409683227539
mini_batch_src_global generation:  0.0625450611114502
r_  generation:  0.5421230792999268
local_output_nid generation:  0.0339055061340332
local_in_edges_tensor generation:  0.03372907638549805
mini_batch_src_global generation:  0.060686588287353516
r_  generation:  0.5437343120574951
local_output_nid generation:  0.034015655517578125
local_in_edges_tensor generation:  0.03487372398376465
mini_batch_src_global generation:  0.06300926208496094
r_  generation:  0.5428385734558105
----------------------check_connections_block total spend ----------------------------- 12.70023512840271
generate_one_block  0.6960678100585938
generate_one_block  0.680861234664917
generate_one_block  0.6795780658721924
generate_one_block  0.6942117214202881
generate_one_block  0.6876893043518066
generate_one_block  0.6845815181732178
generate_one_block  0.6961615085601807
generate_one_block  0.6855988502502441
generate_one_block  0.7236893177032471
generate_one_block  0.6795926094055176
generate_one_block  0.702146053314209
generate_one_block  0.6842138767242432
generate_one_block  0.6920289993286133
generate_one_block  0.6888675689697266
generate_one_block  0.6848251819610596
generate_one_block  0.693650484085083
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.12687110900878906  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

connection checking time:  19.067462921142578
block generation total time  16.760178804397583
average batch blocks generation time:  1.047511175274849
block dataloader generation time/epoch 38.067035865783694
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.09963321685791016  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7693815231323242  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.09951257705688477  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7670063972473145  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.10082054138183594  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7732086181640625  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.09991073608398438  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7763333320617676  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.09971046447753906  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7705307006835938  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.09953880310058594  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.769019603729248  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.0999445915222168  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7811636924743652  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.09967994689941406  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.771702766418457  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.10090923309326172  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7825307846069336  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.09968090057373047  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7665519714355469  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.10065650939941406  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7731671333312988  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.09973716735839844  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7725181579589844  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.10107898712158203  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7826766967773438  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.09981346130371094  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7718019485473633  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.09976768493652344  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7712535858154297  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.09987115859985352  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.7783422470092773  GigaBytes
Max Memory Allocated: 0.8730406761169434  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06287527084350586 |0.018165692687034607 |0.0034419000148773193 |9.088218212127686e-05 |0.003311559557914734 |0.0013091564178466797 |
----------------------------------------------------------pseudo_mini_loss sum 1.2178049087524414
Total (block generation + training)time/epoch 39.563357615470885
Training time/epoch 1.4723620414733887
Training time without block to device /epoch 1.181710958480835
Training time without total dataloading part /epoch 0.11081862449645996
load block tensor time/epoch 1.0060043334960938
block to device time/epoch 0.2906510829925537
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 29 |
Number of nodes for computation during this epoch:  5333301
Number of first layer input nodes during this epoch:  2522103
