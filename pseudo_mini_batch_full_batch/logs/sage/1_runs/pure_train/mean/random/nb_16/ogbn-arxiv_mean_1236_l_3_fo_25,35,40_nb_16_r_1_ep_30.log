Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1647751466.6455536
ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023009777069091797
random selection method range initialization spend 0.006273746490478516
time for parepare:  0.01880025863647461
local_output_nid generation:  0.002185344696044922
local_in_edges_tensor generation:  0.0038764476776123047
mini_batch_src_global generation:  0.0017583370208740234
r_  generation:  0.01858973503112793
local_output_nid generation:  0.0028264522552490234
local_in_edges_tensor generation:  0.0016164779663085938
mini_batch_src_global generation:  0.002204418182373047
r_  generation:  0.01875162124633789
local_output_nid generation:  0.002918720245361328
local_in_edges_tensor generation:  0.001621246337890625
mini_batch_src_global generation:  0.0013921260833740234
r_  generation:  0.018976211547851562
local_output_nid generation:  0.0029418468475341797
local_in_edges_tensor generation:  0.0015354156494140625
mini_batch_src_global generation:  0.0014004707336425781
r_  generation:  0.018570899963378906
local_output_nid generation:  0.0029506683349609375
local_in_edges_tensor generation:  0.0015027523040771484
mini_batch_src_global generation:  0.0013332366943359375
r_  generation:  0.018054723739624023
local_output_nid generation:  0.002870798110961914
local_in_edges_tensor generation:  0.0014750957489013672
mini_batch_src_global generation:  0.0014345645904541016
r_  generation:  0.018897294998168945
local_output_nid generation:  0.0028862953186035156
local_in_edges_tensor generation:  0.0015077590942382812
mini_batch_src_global generation:  0.0014164447784423828
r_  generation:  0.019026517868041992
local_output_nid generation:  0.0029304027557373047
local_in_edges_tensor generation:  0.0015175342559814453
mini_batch_src_global generation:  0.0014333724975585938
r_  generation:  0.0188601016998291
local_output_nid generation:  0.0029075145721435547
local_in_edges_tensor generation:  0.0014727115631103516
mini_batch_src_global generation:  0.0014472007751464844
r_  generation:  0.019365787506103516
local_output_nid generation:  0.0029144287109375
local_in_edges_tensor generation:  0.0015270709991455078
mini_batch_src_global generation:  0.0014853477478027344
r_  generation:  0.019278526306152344
local_output_nid generation:  0.002969980239868164
local_in_edges_tensor generation:  0.0015211105346679688
mini_batch_src_global generation:  0.0014801025390625
r_  generation:  0.019160032272338867
local_output_nid generation:  0.0029222965240478516
local_in_edges_tensor generation:  0.001558542251586914
mini_batch_src_global generation:  0.0014796257019042969
r_  generation:  0.01965951919555664
local_output_nid generation:  0.002964496612548828
local_in_edges_tensor generation:  0.001432657241821289
mini_batch_src_global generation:  0.0014984607696533203
r_  generation:  0.019442319869995117
local_output_nid generation:  0.002897977828979492
local_in_edges_tensor generation:  0.0015308856964111328
mini_batch_src_global generation:  0.001470327377319336
r_  generation:  0.01940464973449707
local_output_nid generation:  0.0028526782989501953
local_in_edges_tensor generation:  0.0014579296112060547
mini_batch_src_global generation:  0.0014955997467041016
r_  generation:  0.019424915313720703
local_output_nid generation:  0.0028939247131347656
local_in_edges_tensor generation:  0.0014603137969970703
mini_batch_src_global generation:  0.0014982223510742188
r_  generation:  0.01923346519470215
----------------------check_connections_block total spend ----------------------------- 0.49950194358825684
generate_one_block  0.027281761169433594
generate_one_block  0.02851581573486328
generate_one_block  0.031557559967041016
generate_one_block  0.028304576873779297
generate_one_block  0.026926755905151367
generate_one_block  0.028203725814819336
generate_one_block  0.02778029441833496
generate_one_block  0.027596473693847656
generate_one_block  0.02830648422241211
generate_one_block  0.02762317657470703
generate_one_block  0.02731466293334961
generate_one_block  0.028070926666259766
generate_one_block  0.028148651123046875
generate_one_block  0.028172731399536133
generate_one_block  0.02796196937561035
generate_one_block  0.027219057083129883
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.037539005279541016
gen group dst list time:  0.018913745880126953
time for parepare:  0.019161701202392578
local_output_nid generation:  0.00833272933959961
local_in_edges_tensor generation:  0.017301559448242188
mini_batch_src_global generation:  0.01887965202331543
r_  generation:  0.19068527221679688
local_output_nid generation:  0.013208627700805664
local_in_edges_tensor generation:  0.019944429397583008
mini_batch_src_global generation:  0.024164438247680664
r_  generation:  0.19921183586120605
local_output_nid generation:  0.013162612915039062
local_in_edges_tensor generation:  0.01654839515686035
mini_batch_src_global generation:  0.02517557144165039
r_  generation:  0.20547842979431152
local_output_nid generation:  0.013083934783935547
local_in_edges_tensor generation:  0.016261816024780273
mini_batch_src_global generation:  0.02431488037109375
r_  generation:  0.2033858299255371
local_output_nid generation:  0.012944698333740234
local_in_edges_tensor generation:  0.012664079666137695
mini_batch_src_global generation:  0.024509429931640625
r_  generation:  0.20358705520629883
local_output_nid generation:  0.013129234313964844
local_in_edges_tensor generation:  0.014436483383178711
mini_batch_src_global generation:  0.02586078643798828
r_  generation:  0.21260929107666016
local_output_nid generation:  0.013143062591552734
local_in_edges_tensor generation:  0.014343500137329102
mini_batch_src_global generation:  0.02580881118774414
r_  generation:  0.2070631980895996
local_output_nid generation:  0.012919902801513672
local_in_edges_tensor generation:  0.012273550033569336
mini_batch_src_global generation:  0.025691509246826172
r_  generation:  0.20557808876037598
local_output_nid generation:  0.013112068176269531
local_in_edges_tensor generation:  0.01806926727294922
mini_batch_src_global generation:  0.025696516036987305
r_  generation:  0.21167206764221191
local_output_nid generation:  0.013051748275756836
local_in_edges_tensor generation:  0.01625680923461914
mini_batch_src_global generation:  0.02589726448059082
r_  generation:  0.209852933883667
local_output_nid generation:  0.013042211532592773
local_in_edges_tensor generation:  0.014217615127563477
mini_batch_src_global generation:  0.025786161422729492
r_  generation:  0.2073836326599121
local_output_nid generation:  0.013347864151000977
local_in_edges_tensor generation:  0.0165250301361084
mini_batch_src_global generation:  0.02768874168395996
r_  generation:  0.21124744415283203
local_output_nid generation:  0.016192197799682617
local_in_edges_tensor generation:  0.014421224594116211
mini_batch_src_global generation:  0.025928735733032227
r_  generation:  0.21102237701416016
local_output_nid generation:  0.013118267059326172
local_in_edges_tensor generation:  0.014349937438964844
mini_batch_src_global generation:  0.026468992233276367
r_  generation:  0.20830202102661133
local_output_nid generation:  0.013123273849487305
local_in_edges_tensor generation:  0.0163419246673584
mini_batch_src_global generation:  0.02633357048034668
r_  generation:  0.21081900596618652
local_output_nid generation:  0.012917518615722656
local_in_edges_tensor generation:  0.012621879577636719
mini_batch_src_global generation:  0.02622056007385254
r_  generation:  0.20749378204345703
----------------------check_connections_block total spend ----------------------------- 4.909360408782959
generate_one_block  0.2706899642944336
generate_one_block  0.2686035633087158
generate_one_block  0.28044843673706055
generate_one_block  0.2647993564605713
generate_one_block  0.27449631690979004
generate_one_block  0.27610325813293457
generate_one_block  0.26488161087036133
generate_one_block  0.2627735137939453
generate_one_block  0.27267003059387207
generate_one_block  0.27227091789245605
generate_one_block  0.2729508876800537
generate_one_block  0.275768518447876
generate_one_block  0.27194738388061523
generate_one_block  0.264965295791626
generate_one_block  0.27768921852111816
generate_one_block  0.2620890140533447
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03420209884643555
gen group dst list time:  0.0586395263671875
time for parepare:  0.01887226104736328
local_output_nid generation:  0.02532482147216797
local_in_edges_tensor generation:  0.04312896728515625
mini_batch_src_global generation:  0.04097151756286621
r_  generation:  0.44228076934814453
local_output_nid generation:  0.031287431716918945
local_in_edges_tensor generation:  0.04534316062927246
mini_batch_src_global generation:  0.0507814884185791
r_  generation:  0.447521448135376
local_output_nid generation:  0.031244516372680664
local_in_edges_tensor generation:  0.03828167915344238
mini_batch_src_global generation:  0.05353236198425293
r_  generation:  0.4587893486022949
local_output_nid generation:  0.031078815460205078
local_in_edges_tensor generation:  0.034802913665771484
mini_batch_src_global generation:  0.051751136779785156
r_  generation:  0.4603884220123291
local_output_nid generation:  0.03086996078491211
local_in_edges_tensor generation:  0.029388904571533203
mini_batch_src_global generation:  0.05180001258850098
r_  generation:  0.46094679832458496
local_output_nid generation:  0.03103351593017578
local_in_edges_tensor generation:  0.034142255783081055
mini_batch_src_global generation:  0.052703857421875
r_  generation:  0.46002888679504395
local_output_nid generation:  0.03112339973449707
local_in_edges_tensor generation:  0.03412461280822754
mini_batch_src_global generation:  0.05241250991821289
r_  generation:  0.4705805778503418
local_output_nid generation:  0.030938148498535156
local_in_edges_tensor generation:  0.029884815216064453
mini_batch_src_global generation:  0.05214977264404297
r_  generation:  0.4740889072418213
local_output_nid generation:  0.031239748001098633
local_in_edges_tensor generation:  0.03494668006896973
mini_batch_src_global generation:  0.0528562068939209
r_  generation:  0.48093390464782715
local_output_nid generation:  0.030855894088745117
local_in_edges_tensor generation:  0.03861856460571289
mini_batch_src_global generation:  0.05302691459655762
r_  generation:  0.4752061367034912
local_output_nid generation:  0.0310671329498291
local_in_edges_tensor generation:  0.04276299476623535
mini_batch_src_global generation:  0.05304217338562012
r_  generation:  0.47852015495300293
local_output_nid generation:  0.03131842613220215
local_in_edges_tensor generation:  0.03360724449157715
mini_batch_src_global generation:  0.052434682846069336
r_  generation:  0.45793867111206055
local_output_nid generation:  0.030683279037475586
local_in_edges_tensor generation:  0.034032583236694336
mini_batch_src_global generation:  0.05227160453796387
r_  generation:  0.46324706077575684
local_output_nid generation:  0.03166985511779785
local_in_edges_tensor generation:  0.0351564884185791
mini_batch_src_global generation:  0.0527496337890625
r_  generation:  0.45424413681030273
local_output_nid generation:  0.03113245964050293
local_in_edges_tensor generation:  0.029078006744384766
mini_batch_src_global generation:  0.05202841758728027
r_  generation:  0.4625570774078369
local_output_nid generation:  0.030729293823242188
local_in_edges_tensor generation:  0.032498836517333984
mini_batch_src_global generation:  0.0518643856048584
r_  generation:  0.4542961120605469
----------------------check_connections_block total spend ----------------------------- 10.889964580535889
generate_one_block  0.594135046005249
generate_one_block  0.6021056175231934
generate_one_block  0.5916042327880859
generate_one_block  0.5757541656494141
generate_one_block  0.5843005180358887
generate_one_block  0.6410624980926514
generate_one_block  0.6225535869598389
generate_one_block  0.5683033466339111
generate_one_block  0.5751118659973145
generate_one_block  0.5871431827545166
generate_one_block  0.608004093170166
generate_one_block  0.6052756309509277
generate_one_block  0.614579439163208
generate_one_block  0.5823519229888916
generate_one_block  0.5968945026397705
generate_one_block  0.5808613300323486
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  15.799324989318848
block generation total time  13.86318826675415
average batch blocks generation time:  0.8664492666721344
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1756591796875 GB
    Memory Allocated: 0.09065866470336914  GigaBytes
Max Memory Allocated: 0.09065866470336914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1678466796875 GB
    Memory Allocated: 0.7159438133239746  GigaBytes
Max Memory Allocated: 0.7533230781555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4530029296875 GB
    Memory Allocated: 0.09181022644042969  GigaBytes
Max Memory Allocated: 0.7947306632995605  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4530029296875 GB
    Memory Allocated: 0.7172741889953613  GigaBytes
Max Memory Allocated: 0.7947306632995605  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5701904296875 GB
    Memory Allocated: 0.09248828887939453  GigaBytes
Max Memory Allocated: 0.7964248657226562  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0487060546875 GB
    Memory Allocated: 0.7237873077392578  GigaBytes
Max Memory Allocated: 0.7964248657226562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.09175777435302734  GigaBytes
Max Memory Allocated: 0.8047876358032227  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.7162990570068359  GigaBytes
Max Memory Allocated: 0.8047876358032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.0921030044555664  GigaBytes
Max Memory Allocated: 0.8047876358032227  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.7100691795349121  GigaBytes
Max Memory Allocated: 0.8047876358032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.09191036224365234  GigaBytes
Max Memory Allocated: 0.8047876358032227  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.7166991233825684  GigaBytes
Max Memory Allocated: 0.8047876358032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.0922098159790039  GigaBytes
Max Memory Allocated: 0.8047876358032227  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.7152614593505859  GigaBytes
Max Memory Allocated: 0.8047876358032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.09160137176513672  GigaBytes
Max Memory Allocated: 0.8047876358032227  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.713404655456543  GigaBytes
Max Memory Allocated: 0.8047876358032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.09227180480957031  GigaBytes
Max Memory Allocated: 0.8047876358032227  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.7118420600891113  GigaBytes
Max Memory Allocated: 0.8047876358032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.09175825119018555  GigaBytes
Max Memory Allocated: 0.8047876358032227  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.7157135009765625  GigaBytes
Max Memory Allocated: 0.8047876358032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.0922231674194336  GigaBytes
Max Memory Allocated: 0.8047876358032227  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.715085506439209  GigaBytes
Max Memory Allocated: 0.8047876358032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.0920414924621582  GigaBytes
Max Memory Allocated: 0.8047876358032227  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.7241477966308594  GigaBytes
Max Memory Allocated: 0.8047876358032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.09233379364013672  GigaBytes
Max Memory Allocated: 0.8050322532653809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.7163481712341309  GigaBytes
Max Memory Allocated: 0.8050322532653809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.09167957305908203  GigaBytes
Max Memory Allocated: 0.8050322532653809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.7163519859313965  GigaBytes
Max Memory Allocated: 0.8050322532653809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.09229564666748047  GigaBytes
Max Memory Allocated: 0.8050322532653809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.7163138389587402  GigaBytes
Max Memory Allocated: 0.8050322532653809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.09150409698486328  GigaBytes
Max Memory Allocated: 0.8050322532653809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.7126855850219727  GigaBytes
Max Memory Allocated: 0.8050322532653809  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.057635530829429626 |0.034648969769477844 |0.05162680149078369 |0.00010229647159576416 |0.010752379894256592 |0.004770755767822266 |
----------------------------------------------------------pseudo_mini_loss sum 6.236293315887451
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5091284
Number of first layer input nodes during this epoch:  2471389
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.11473321914672852  GigaBytes
Max Memory Allocated: 0.8050322532653809  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019458532333374023
random selection method range initialization spend 0.005356550216674805
time for parepare:  0.01791214942932129
local_output_nid generation:  0.0024220943450927734
local_in_edges_tensor generation:  0.007866859436035156
mini_batch_src_global generation:  0.0018777847290039062
r_  generation:  0.01763916015625
local_output_nid generation:  0.002803802490234375
local_in_edges_tensor generation:  0.0016379356384277344
mini_batch_src_global generation:  0.0021860599517822266
r_  generation:  0.01862788200378418
local_output_nid generation:  0.0028619766235351562
local_in_edges_tensor generation:  0.0015423297882080078
mini_batch_src_global generation:  0.001405477523803711
r_  generation:  0.01853489875793457
local_output_nid generation:  0.002885103225708008
local_in_edges_tensor generation:  0.0015442371368408203
mini_batch_src_global generation:  0.0014390945434570312
r_  generation:  0.01858806610107422
local_output_nid generation:  0.002901792526245117
local_in_edges_tensor generation:  0.0015218257904052734
mini_batch_src_global generation:  0.0014195442199707031
r_  generation:  0.019000768661499023
local_output_nid generation:  0.002892017364501953
local_in_edges_tensor generation:  0.0015082359313964844
mini_batch_src_global generation:  0.0014255046844482422
r_  generation:  0.018851041793823242
local_output_nid generation:  0.002946138381958008
local_in_edges_tensor generation:  0.0015740394592285156
mini_batch_src_global generation:  0.0014421939849853516
r_  generation:  0.019179582595825195
local_output_nid generation:  0.003024578094482422
local_in_edges_tensor generation:  0.001468658447265625
mini_batch_src_global generation:  0.0014271736145019531
r_  generation:  0.01918482780456543
local_output_nid generation:  0.0029854774475097656
local_in_edges_tensor generation:  0.0015330314636230469
mini_batch_src_global generation:  0.001447439193725586
r_  generation:  0.01937580108642578
local_output_nid generation:  0.0029833316802978516
local_in_edges_tensor generation:  0.001504659652709961
mini_batch_src_global generation:  0.0014584064483642578
r_  generation:  0.019405841827392578
local_output_nid generation:  0.0030040740966796875
local_in_edges_tensor generation:  0.0014617443084716797
mini_batch_src_global generation:  0.001459360122680664
r_  generation:  0.019055604934692383
local_output_nid generation:  0.002944469451904297
local_in_edges_tensor generation:  0.001439809799194336
mini_batch_src_global generation:  0.0014941692352294922
r_  generation:  0.01934218406677246
local_output_nid generation:  0.0029311180114746094
local_in_edges_tensor generation:  0.0014338493347167969
mini_batch_src_global generation:  0.001499176025390625
r_  generation:  0.01948070526123047
local_output_nid generation:  0.002971172332763672
local_in_edges_tensor generation:  0.0014369487762451172
mini_batch_src_global generation:  0.0015482902526855469
r_  generation:  0.01972794532775879
local_output_nid generation:  0.0029833316802978516
local_in_edges_tensor generation:  0.001416921615600586
mini_batch_src_global generation:  0.0015463829040527344
r_  generation:  0.01920294761657715
local_output_nid generation:  0.002950906753540039
local_in_edges_tensor generation:  0.0014088153839111328
mini_batch_src_global generation:  0.0015454292297363281
r_  generation:  0.019123554229736328
----------------------check_connections_block total spend ----------------------------- 0.5032789707183838
generate_one_block  0.034876108169555664
generate_one_block  0.028418779373168945
generate_one_block  0.027816057205200195
generate_one_block  0.028009891510009766
generate_one_block  0.02779984474182129
generate_one_block  0.029981136322021484
generate_one_block  0.029056549072265625
generate_one_block  0.02715134620666504
generate_one_block  0.02777886390686035
generate_one_block  0.027917861938476562
generate_one_block  0.02742767333984375
generate_one_block  0.02764606475830078
generate_one_block  0.027951478958129883
generate_one_block  0.027957916259765625
generate_one_block  0.02791595458984375
generate_one_block  0.0279080867767334
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.034491539001464844
gen group dst list time:  0.01757335662841797
time for parepare:  0.019008636474609375
local_output_nid generation:  0.00817561149597168
local_in_edges_tensor generation:  0.019371509552001953
mini_batch_src_global generation:  0.018854618072509766
r_  generation:  0.19370722770690918
local_output_nid generation:  0.012228727340698242
local_in_edges_tensor generation:  0.019022703170776367
mini_batch_src_global generation:  0.02458667755126953
r_  generation:  0.20394659042358398
local_output_nid generation:  0.01231074333190918
local_in_edges_tensor generation:  0.017261743545532227
mini_batch_src_global generation:  0.023693084716796875
r_  generation:  0.20628881454467773
local_output_nid generation:  0.014276266098022461
local_in_edges_tensor generation:  0.012630701065063477
mini_batch_src_global generation:  0.0243680477142334
r_  generation:  0.21196413040161133
local_output_nid generation:  0.012313365936279297
local_in_edges_tensor generation:  0.014984607696533203
mini_batch_src_global generation:  0.02541804313659668
r_  generation:  0.2133350372314453
local_output_nid generation:  0.013917684555053711
local_in_edges_tensor generation:  0.013477802276611328
mini_batch_src_global generation:  0.025385379791259766
r_  generation:  0.2113816738128662
local_output_nid generation:  0.012016057968139648
local_in_edges_tensor generation:  0.015595197677612305
mini_batch_src_global generation:  0.025478363037109375
r_  generation:  0.21450304985046387
local_output_nid generation:  0.013324260711669922
local_in_edges_tensor generation:  0.0137481689453125
mini_batch_src_global generation:  0.0260007381439209
r_  generation:  0.20977258682250977
local_output_nid generation:  0.011997461318969727
local_in_edges_tensor generation:  0.017453432083129883
mini_batch_src_global generation:  0.026075124740600586
r_  generation:  0.22245526313781738
local_output_nid generation:  0.015429496765136719
local_in_edges_tensor generation:  0.021639347076416016
mini_batch_src_global generation:  0.029587745666503906
r_  generation:  0.2155306339263916
local_output_nid generation:  0.012294769287109375
local_in_edges_tensor generation:  0.015195131301879883
mini_batch_src_global generation:  0.025737762451171875
r_  generation:  0.21150755882263184
local_output_nid generation:  0.012437105178833008
local_in_edges_tensor generation:  0.016037940979003906
mini_batch_src_global generation:  0.026458263397216797
r_  generation:  0.2141578197479248
local_output_nid generation:  0.012542963027954102
local_in_edges_tensor generation:  0.015915393829345703
mini_batch_src_global generation:  0.026474952697753906
r_  generation:  0.2144474983215332
local_output_nid generation:  0.012418031692504883
local_in_edges_tensor generation:  0.01585531234741211
mini_batch_src_global generation:  0.02711963653564453
r_  generation:  0.21766185760498047
local_output_nid generation:  0.012238025665283203
local_in_edges_tensor generation:  0.01231527328491211
mini_batch_src_global generation:  0.026061058044433594
r_  generation:  0.21088266372680664
local_output_nid generation:  0.012383699417114258
local_in_edges_tensor generation:  0.012275218963623047
mini_batch_src_global generation:  0.025862693786621094
r_  generation:  0.2086327075958252
----------------------check_connections_block total spend ----------------------------- 5.007978916168213
generate_one_block  0.2723667621612549
generate_one_block  0.27437329292297363
generate_one_block  0.2759981155395508
generate_one_block  0.2750542163848877
generate_one_block  0.2772822380065918
generate_one_block  0.2681901454925537
generate_one_block  0.2956564426422119
generate_one_block  0.28557348251342773
generate_one_block  0.2906153202056885
generate_one_block  0.27393555641174316
generate_one_block  0.27096986770629883
generate_one_block  0.27471470832824707
generate_one_block  0.27748608589172363
generate_one_block  0.28058862686157227
generate_one_block  0.26949286460876465
generate_one_block  0.26869940757751465
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05821728706359863
gen group dst list time:  0.06658291816711426
time for parepare:  0.01822376251220703
local_output_nid generation:  0.026277542114257812
local_in_edges_tensor generation:  0.054854631423950195
mini_batch_src_global generation:  0.04559016227722168
r_  generation:  0.4388711452484131
local_output_nid generation:  0.03151440620422363
local_in_edges_tensor generation:  0.04718208312988281
mini_batch_src_global generation:  0.05109882354736328
r_  generation:  0.46744656562805176
local_output_nid generation:  0.031041383743286133
local_in_edges_tensor generation:  0.039707183837890625
mini_batch_src_global generation:  0.05037045478820801
r_  generation:  0.46274852752685547
local_output_nid generation:  0.030737638473510742
local_in_edges_tensor generation:  0.03204941749572754
mini_batch_src_global generation:  0.06161618232727051
r_  generation:  0.4727210998535156
local_output_nid generation:  0.03433728218078613
local_in_edges_tensor generation:  0.1058204174041748
mini_batch_src_global generation:  0.05460643768310547
r_  generation:  0.4642658233642578
local_output_nid generation:  0.03138542175292969
local_in_edges_tensor generation:  0.043251752853393555
mini_batch_src_global generation:  0.05675864219665527
r_  generation:  0.4592006206512451
local_output_nid generation:  0.0308687686920166
local_in_edges_tensor generation:  0.033252716064453125
mini_batch_src_global generation:  0.05194282531738281
r_  generation:  0.462721586227417
local_output_nid generation:  0.030626296997070312
local_in_edges_tensor generation:  0.03124690055847168
mini_batch_src_global generation:  0.05287051200866699
r_  generation:  0.4548478126525879
local_output_nid generation:  0.03072047233581543
local_in_edges_tensor generation:  0.034537553787231445
mini_batch_src_global generation:  0.05341029167175293
r_  generation:  0.47086453437805176
local_output_nid generation:  0.030766725540161133
local_in_edges_tensor generation:  0.03426361083984375
mini_batch_src_global generation:  0.056229352951049805
r_  generation:  0.46335291862487793
local_output_nid generation:  0.03080892562866211
local_in_edges_tensor generation:  0.03215670585632324
mini_batch_src_global generation:  0.05200457572937012
r_  generation:  0.4612250328063965
local_output_nid generation:  0.030957460403442383
local_in_edges_tensor generation:  0.038193464279174805
mini_batch_src_global generation:  0.0525813102722168
r_  generation:  0.45943617820739746
local_output_nid generation:  0.031165599822998047
local_in_edges_tensor generation:  0.042304277420043945
mini_batch_src_global generation:  0.052510738372802734
r_  generation:  0.462644100189209
local_output_nid generation:  0.03213143348693848
local_in_edges_tensor generation:  0.053314208984375
mini_batch_src_global generation:  0.05591082572937012
r_  generation:  0.48277735710144043
local_output_nid generation:  0.03272128105163574
local_in_edges_tensor generation:  0.038256168365478516
mini_batch_src_global generation:  0.05643153190612793
r_  generation:  0.4586517810821533
local_output_nid generation:  0.03202319145202637
local_in_edges_tensor generation:  0.03819155693054199
mini_batch_src_global generation:  0.05347704887390137
r_  generation:  0.4559516906738281
----------------------check_connections_block total spend ----------------------------- 11.064528703689575
generate_one_block  0.5777390003204346
generate_one_block  0.587195873260498
generate_one_block  0.5781011581420898
generate_one_block  0.5731608867645264
generate_one_block  0.5823209285736084
generate_one_block  0.5916383266448975
generate_one_block  0.5828096866607666
generate_one_block  0.5660393238067627
generate_one_block  0.6214780807495117
generate_one_block  0.5840897560119629
generate_one_block  0.5748860836029053
generate_one_block  0.5753331184387207
generate_one_block  0.5967869758605957
generate_one_block  0.592951774597168
generate_one_block  0.5670034885406494
generate_one_block  0.564741849899292
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.11473321914672852  GigaBytes
Max Memory Allocated: 0.8050322532653809  GigaBytes

connection checking time:  16.072507619857788
block generation total time  13.747273445129395
average batch blocks generation time:  0.8592045903205872
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.09392404556274414  GigaBytes
Max Memory Allocated: 0.8050322532653809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.7183384895324707  GigaBytes
Max Memory Allocated: 0.8050322532653809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.09350776672363281  GigaBytes
Max Memory Allocated: 0.8050322532653809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.7246232032775879  GigaBytes
Max Memory Allocated: 0.8050322532653809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.09401321411132812  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.7198314666748047  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.09336423873901367  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.71856689453125  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.09402179718017578  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.7215795516967773  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.09343433380126953  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.7176427841186523  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.0938873291015625  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.7174191474914551  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.09310674667358398  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.7144021987915039  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.0939168930053711  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.7182745933532715  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.09325456619262695  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.7174434661865234  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.09382438659667969  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.7167425155639648  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.09336566925048828  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.717522144317627  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.09398078918457031  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.7198014259338379  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.0935511589050293  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.721341609954834  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.09377193450927734  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.7154064178466797  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.09328651428222656  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.7161884307861328  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.061641544103622437 |0.011657506227493286 |0.003773331642150879 |9.31769609451294e-05 |0.003566443920135498 |0.00312042236328125 |
----------------------------------------------------------pseudo_mini_loss sum 3.2348058223724365
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5096585
Number of first layer input nodes during this epoch:  2472929
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.11487150192260742  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024100780487060547
random selection method range initialization spend 0.005908966064453125
time for parepare:  0.018295764923095703
local_output_nid generation:  0.002296924591064453
local_in_edges_tensor generation:  0.007871866226196289
mini_batch_src_global generation:  0.001604318618774414
r_  generation:  0.0192413330078125
local_output_nid generation:  0.002954721450805664
local_in_edges_tensor generation:  0.0018877983093261719
mini_batch_src_global generation:  0.0025243759155273438
r_  generation:  0.019160747528076172
local_output_nid generation:  0.0030138492584228516
local_in_edges_tensor generation:  0.0016291141510009766
mini_batch_src_global generation:  0.0014247894287109375
r_  generation:  0.018838167190551758
local_output_nid generation:  0.0030031204223632812
local_in_edges_tensor generation:  0.0015554428100585938
mini_batch_src_global generation:  0.0013556480407714844
r_  generation:  0.0183713436126709
local_output_nid generation:  0.0030236244201660156
local_in_edges_tensor generation:  0.001558542251586914
mini_batch_src_global generation:  0.0014653205871582031
r_  generation:  0.019320964813232422
local_output_nid generation:  0.0030901432037353516
local_in_edges_tensor generation:  0.0016646385192871094
mini_batch_src_global generation:  0.0014429092407226562
r_  generation:  0.018961429595947266
local_output_nid generation:  0.003058910369873047
local_in_edges_tensor generation:  0.0015757083892822266
mini_batch_src_global generation:  0.0015339851379394531
r_  generation:  0.0197293758392334
local_output_nid generation:  0.003018617630004883
local_in_edges_tensor generation:  0.0015802383422851562
mini_batch_src_global generation:  0.0015022754669189453
r_  generation:  0.023000478744506836
local_output_nid generation:  0.003062725067138672
local_in_edges_tensor generation:  0.0014865398406982422
mini_batch_src_global generation:  0.0015189647674560547
r_  generation:  0.019875049591064453
local_output_nid generation:  0.0029914379119873047
local_in_edges_tensor generation:  0.001470327377319336
mini_batch_src_global generation:  0.0015201568603515625
r_  generation:  0.020139694213867188
local_output_nid generation:  0.0029544830322265625
local_in_edges_tensor generation:  0.0015416145324707031
mini_batch_src_global generation:  0.001573324203491211
r_  generation:  0.022829294204711914
local_output_nid generation:  0.003057718276977539
local_in_edges_tensor generation:  0.0016109943389892578
mini_batch_src_global generation:  0.001550912857055664
r_  generation:  0.01951766014099121
local_output_nid generation:  0.0029740333557128906
local_in_edges_tensor generation:  0.0015277862548828125
mini_batch_src_global generation:  0.0015096664428710938
r_  generation:  0.019390344619750977
local_output_nid generation:  0.0029747486114501953
local_in_edges_tensor generation:  0.0015692710876464844
mini_batch_src_global generation:  0.0014879703521728516
r_  generation:  0.019206762313842773
local_output_nid generation:  0.002970457077026367
local_in_edges_tensor generation:  0.001504659652709961
mini_batch_src_global generation:  0.0015573501586914062
r_  generation:  0.020714759826660156
local_output_nid generation:  0.0030117034912109375
local_in_edges_tensor generation:  0.0015387535095214844
mini_batch_src_global generation:  0.001577615737915039
r_  generation:  0.020002126693725586
----------------------check_connections_block total spend ----------------------------- 0.5260226726531982
generate_one_block  0.027881860733032227
generate_one_block  0.02907848358154297
generate_one_block  0.02769017219543457
generate_one_block  0.02751755714416504
generate_one_block  0.027518749237060547
generate_one_block  0.03264045715332031
generate_one_block  0.028070449829101562
generate_one_block  0.0279388427734375
generate_one_block  0.028028011322021484
generate_one_block  0.02869272232055664
generate_one_block  0.02807021141052246
generate_one_block  0.027994155883789062
generate_one_block  0.027307510375976562
generate_one_block  0.027350664138793945
generate_one_block  0.0286712646484375
generate_one_block  0.028870820999145508
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03284335136413574
gen group dst list time:  0.018538951873779297
time for parepare:  0.01957106590270996
local_output_nid generation:  0.008358955383300781
local_in_edges_tensor generation:  0.023530006408691406
mini_batch_src_global generation:  0.01979351043701172
r_  generation:  0.19237923622131348
local_output_nid generation:  0.012256860733032227
local_in_edges_tensor generation:  0.014123201370239258
mini_batch_src_global generation:  0.02418041229248047
r_  generation:  0.20288610458374023
local_output_nid generation:  0.011885404586791992
local_in_edges_tensor generation:  0.012767791748046875
mini_batch_src_global generation:  0.023093223571777344
r_  generation:  0.20343494415283203
local_output_nid generation:  0.012368440628051758
local_in_edges_tensor generation:  0.012976884841918945
mini_batch_src_global generation:  0.023936748504638672
r_  generation:  0.20741820335388184
local_output_nid generation:  0.012654542922973633
local_in_edges_tensor generation:  0.012593269348144531
mini_batch_src_global generation:  0.024821758270263672
r_  generation:  0.20795726776123047
local_output_nid generation:  0.012711286544799805
local_in_edges_tensor generation:  0.01171422004699707
mini_batch_src_global generation:  0.02600550651550293
r_  generation:  0.21065807342529297
local_output_nid generation:  0.012667655944824219
local_in_edges_tensor generation:  0.011846065521240234
mini_batch_src_global generation:  0.02581024169921875
r_  generation:  0.21201658248901367
local_output_nid generation:  0.012629270553588867
local_in_edges_tensor generation:  0.013567686080932617
mini_batch_src_global generation:  0.026152372360229492
r_  generation:  0.21558356285095215
local_output_nid generation:  0.015220165252685547
local_in_edges_tensor generation:  0.012706518173217773
mini_batch_src_global generation:  0.030068397521972656
r_  generation:  0.21696949005126953
local_output_nid generation:  0.012230396270751953
local_in_edges_tensor generation:  0.012746810913085938
mini_batch_src_global generation:  0.027074575424194336
r_  generation:  0.21889543533325195
local_output_nid generation:  0.01194310188293457
local_in_edges_tensor generation:  0.011798858642578125
mini_batch_src_global generation:  0.026266813278198242
r_  generation:  0.2150270938873291
local_output_nid generation:  0.011901378631591797
local_in_edges_tensor generation:  0.011482000350952148
mini_batch_src_global generation:  0.026242494583129883
r_  generation:  0.2125380039215088
local_output_nid generation:  0.01193547248840332
local_in_edges_tensor generation:  0.013883590698242188
mini_batch_src_global generation:  0.02620530128479004
r_  generation:  0.213942289352417
local_output_nid generation:  0.011893987655639648
local_in_edges_tensor generation:  0.011436700820922852
mini_batch_src_global generation:  0.025999784469604492
r_  generation:  0.21694040298461914
local_output_nid generation:  0.01239013671875
local_in_edges_tensor generation:  0.013622283935546875
mini_batch_src_global generation:  0.026970624923706055
r_  generation:  0.21853971481323242
local_output_nid generation:  0.011971235275268555
local_in_edges_tensor generation:  0.01342916488647461
mini_batch_src_global generation:  0.027040719985961914
r_  generation:  0.2219550609588623
----------------------check_connections_block total spend ----------------------------- 4.968515157699585
generate_one_block  0.2762444019317627
generate_one_block  0.270519495010376
generate_one_block  0.26836061477661133
generate_one_block  0.2662699222564697
generate_one_block  0.26714348793029785
generate_one_block  0.27171850204467773
generate_one_block  0.29547595977783203
generate_one_block  0.2784392833709717
generate_one_block  0.27495265007019043
generate_one_block  0.27268171310424805
generate_one_block  0.2675204277038574
generate_one_block  0.2659163475036621
generate_one_block  0.2645096778869629
generate_one_block  0.2671244144439697
generate_one_block  0.2768564224243164
generate_one_block  0.2746772766113281
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.038954734802246094
gen group dst list time:  0.06567072868347168
time for parepare:  0.018835067749023438
local_output_nid generation:  0.0263364315032959
local_in_edges_tensor generation:  0.05527830123901367
mini_batch_src_global generation:  0.040923118591308594
r_  generation:  0.4411182403564453
local_output_nid generation:  0.03144383430480957
local_in_edges_tensor generation:  0.03898310661315918
mini_batch_src_global generation:  0.05325055122375488
r_  generation:  0.4592611789703369
local_output_nid generation:  0.03144717216491699
local_in_edges_tensor generation:  0.032662153244018555
mini_batch_src_global generation:  0.05041360855102539
r_  generation:  0.4564177989959717
local_output_nid generation:  0.03187155723571777
local_in_edges_tensor generation:  0.035845041275024414
mini_batch_src_global generation:  0.05353808403015137
r_  generation:  0.4542086124420166
local_output_nid generation:  0.0342714786529541
local_in_edges_tensor generation:  0.07645869255065918
mini_batch_src_global generation:  0.05125927925109863
r_  generation:  0.45691442489624023
local_output_nid generation:  0.03138375282287598
local_in_edges_tensor generation:  0.03650474548339844
mini_batch_src_global generation:  0.06013345718383789
r_  generation:  0.4682149887084961
local_output_nid generation:  0.03143024444580078
local_in_edges_tensor generation:  0.040721893310546875
mini_batch_src_global generation:  0.05300712585449219
r_  generation:  0.4635961055755615
local_output_nid generation:  0.03273320198059082
local_in_edges_tensor generation:  0.03161501884460449
mini_batch_src_global generation:  0.05231189727783203
r_  generation:  0.45712852478027344
local_output_nid generation:  0.03148293495178223
local_in_edges_tensor generation:  0.03435397148132324
mini_batch_src_global generation:  0.058211326599121094
r_  generation:  0.47972726821899414
local_output_nid generation:  0.034253597259521484
local_in_edges_tensor generation:  0.033239126205444336
mini_batch_src_global generation:  0.05475616455078125
r_  generation:  0.46024107933044434
local_output_nid generation:  0.03232741355895996
local_in_edges_tensor generation:  0.03030848503112793
mini_batch_src_global generation:  0.05179119110107422
r_  generation:  0.4593698978424072
local_output_nid generation:  0.0322110652923584
local_in_edges_tensor generation:  0.031171560287475586
mini_batch_src_global generation:  0.05217123031616211
r_  generation:  0.46549105644226074
local_output_nid generation:  0.032518625259399414
local_in_edges_tensor generation:  0.03269338607788086
mini_batch_src_global generation:  0.0521087646484375
r_  generation:  0.4681227207183838
local_output_nid generation:  0.032521963119506836
local_in_edges_tensor generation:  0.032657623291015625
mini_batch_src_global generation:  0.05323982238769531
r_  generation:  0.45528149604797363
local_output_nid generation:  0.032761335372924805
local_in_edges_tensor generation:  0.035161733627319336
mini_batch_src_global generation:  0.05252814292907715
r_  generation:  0.4644126892089844
local_output_nid generation:  0.0327000617980957
local_in_edges_tensor generation:  0.03228354454040527
mini_batch_src_global generation:  0.052797794342041016
r_  generation:  0.45638060569763184
----------------------check_connections_block total spend ----------------------------- 10.925817012786865
generate_one_block  0.5911507606506348
generate_one_block  0.5738246440887451
generate_one_block  0.574470043182373
generate_one_block  0.5725092887878418
generate_one_block  0.58669114112854
generate_one_block  0.5893576145172119
generate_one_block  0.5751628875732422
generate_one_block  0.5845708847045898
generate_one_block  0.6430025100708008
generate_one_block  0.5872867107391357
generate_one_block  0.5685296058654785
generate_one_block  0.5779812335968018
generate_one_block  0.5700428485870361
generate_one_block  0.5708835124969482
generate_one_block  0.5905766487121582
generate_one_block  0.5902159214019775
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.11487150192260742  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

connection checking time:  15.89433217048645
block generation total time  13.70466685295105
average batch blocks generation time:  0.8565416783094406
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.0938410758972168  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.7136502265930176  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09344768524169922  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7181496620178223  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09385967254638672  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7160687446594238  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09330511093139648  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7172412872314453  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09381771087646484  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7166376113891602  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09324312210083008  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7160224914550781  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09388351440429688  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7175893783569336  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09334945678710938  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7168869972229004  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.093963623046875  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.719782829284668  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09343957901000977  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7232418060302734  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09385299682617188  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7170462608337402  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09330606460571289  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7161493301391602  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09378623962402344  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7129607200622559  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09334039688110352  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7157597541809082  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0940256118774414  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7244820594787598  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09338569641113281  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7178711891174316  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.060975104570388794 |0.013105854392051697 |0.0035432130098342896 |9.365379810333252e-05 |0.0032501220703125 |0.0019154548645019531 |
----------------------------------------------------------pseudo_mini_loss sum 2.6144351959228516
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  5089562
Number of first layer input nodes during this epoch:  2471349
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11534833908081055  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02732253074645996
random selection method range initialization spend 0.005972146987915039
time for parepare:  0.017246007919311523
local_output_nid generation:  0.002338409423828125
local_in_edges_tensor generation:  0.008397102355957031
mini_batch_src_global generation:  0.0016241073608398438
r_  generation:  0.018964052200317383
local_output_nid generation:  0.002820253372192383
local_in_edges_tensor generation:  0.0016808509826660156
mini_batch_src_global generation:  0.0019145011901855469
r_  generation:  0.01968693733215332
local_output_nid generation:  0.0029239654541015625
local_in_edges_tensor generation:  0.001611948013305664
mini_batch_src_global generation:  0.0015540122985839844
r_  generation:  0.019696474075317383
local_output_nid generation:  0.003070831298828125
local_in_edges_tensor generation:  0.0015935897827148438
mini_batch_src_global generation:  0.0015671253204345703
r_  generation:  0.018787145614624023
local_output_nid generation:  0.0029900074005126953
local_in_edges_tensor generation:  0.0016028881072998047
mini_batch_src_global generation:  0.0015058517456054688
r_  generation:  0.019269943237304688
local_output_nid generation:  0.0029706954956054688
local_in_edges_tensor generation:  0.0015439987182617188
mini_batch_src_global generation:  0.0015575885772705078
r_  generation:  0.019222497940063477
local_output_nid generation:  0.0030684471130371094
local_in_edges_tensor generation:  0.0015664100646972656
mini_batch_src_global generation:  0.0014719963073730469
r_  generation:  0.019726037979125977
local_output_nid generation:  0.002933025360107422
local_in_edges_tensor generation:  0.001474618911743164
mini_batch_src_global generation:  0.0015866756439208984
r_  generation:  0.019340038299560547
local_output_nid generation:  0.0029702186584472656
local_in_edges_tensor generation:  0.001531839370727539
mini_batch_src_global generation:  0.0016608238220214844
r_  generation:  0.01983785629272461
local_output_nid generation:  0.002925395965576172
local_in_edges_tensor generation:  0.001459360122680664
mini_batch_src_global generation:  0.0015230178833007812
r_  generation:  0.019748926162719727
local_output_nid generation:  0.0030019283294677734
local_in_edges_tensor generation:  0.0015213489532470703
mini_batch_src_global generation:  0.0016124248504638672
r_  generation:  0.020000696182250977
local_output_nid generation:  0.002941608428955078
local_in_edges_tensor generation:  0.001477956771850586
mini_batch_src_global generation:  0.0015151500701904297
r_  generation:  0.01952385902404785
local_output_nid generation:  0.0029456615447998047
local_in_edges_tensor generation:  0.0014743804931640625
mini_batch_src_global generation:  0.0015206336975097656
r_  generation:  0.01972651481628418
local_output_nid generation:  0.0029287338256835938
local_in_edges_tensor generation:  0.0014369487762451172
mini_batch_src_global generation:  0.0015277862548828125
r_  generation:  0.019556283950805664
local_output_nid generation:  0.002971649169921875
local_in_edges_tensor generation:  0.0015444755554199219
mini_batch_src_global generation:  0.001537322998046875
r_  generation:  0.020322084426879883
local_output_nid generation:  0.002946615219116211
local_in_edges_tensor generation:  0.0015180110931396484
mini_batch_src_global generation:  0.0015902519226074219
r_  generation:  0.0200345516204834
----------------------check_connections_block total spend ----------------------------- 0.5158777236938477
generate_one_block  0.035256147384643555
generate_one_block  0.028744935989379883
generate_one_block  0.027954578399658203
generate_one_block  0.02784252166748047
generate_one_block  0.027280330657958984
generate_one_block  0.03013324737548828
generate_one_block  0.027851581573486328
generate_one_block  0.02765941619873047
generate_one_block  0.027760028839111328
generate_one_block  0.028333663940429688
generate_one_block  0.02776050567626953
generate_one_block  0.02768397331237793
generate_one_block  0.02755451202392578
generate_one_block  0.027550697326660156
generate_one_block  0.0281064510345459
generate_one_block  0.028901100158691406
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.07127690315246582
gen group dst list time:  0.016721010208129883
time for parepare:  0.019211530685424805
local_output_nid generation:  0.00847482681274414
local_in_edges_tensor generation:  0.02084207534790039
mini_batch_src_global generation:  0.019331693649291992
r_  generation:  0.19331860542297363
local_output_nid generation:  0.01219487190246582
local_in_edges_tensor generation:  0.013591289520263672
mini_batch_src_global generation:  0.02634406089782715
r_  generation:  0.19963622093200684
local_output_nid generation:  0.012396097183227539
local_in_edges_tensor generation:  0.011922597885131836
mini_batch_src_global generation:  0.02458024024963379
r_  generation:  0.20678091049194336
local_output_nid generation:  0.012706995010375977
local_in_edges_tensor generation:  0.012060165405273438
mini_batch_src_global generation:  0.026215314865112305
r_  generation:  0.20606470108032227
local_output_nid generation:  0.012645959854125977
local_in_edges_tensor generation:  0.012958526611328125
mini_batch_src_global generation:  0.025039196014404297
r_  generation:  0.20822620391845703
local_output_nid generation:  0.012380123138427734
local_in_edges_tensor generation:  0.011986494064331055
mini_batch_src_global generation:  0.027622222900390625
r_  generation:  0.21284770965576172
local_output_nid generation:  0.012743473052978516
local_in_edges_tensor generation:  0.012192487716674805
mini_batch_src_global generation:  0.02847146987915039
r_  generation:  0.21076083183288574
local_output_nid generation:  0.012657642364501953
local_in_edges_tensor generation:  0.012790203094482422
mini_batch_src_global generation:  0.02596569061279297
r_  generation:  0.20956921577453613
local_output_nid generation:  0.012684106826782227
local_in_edges_tensor generation:  0.012988805770874023
mini_batch_src_global generation:  0.02713632583618164
r_  generation:  0.2134871482849121
local_output_nid generation:  0.012758731842041016
local_in_edges_tensor generation:  0.011766433715820312
mini_batch_src_global generation:  0.026423215866088867
r_  generation:  0.2172257900238037
local_output_nid generation:  0.01235342025756836
local_in_edges_tensor generation:  0.012989044189453125
mini_batch_src_global generation:  0.027246475219726562
r_  generation:  0.21390342712402344
local_output_nid generation:  0.012218952178955078
local_in_edges_tensor generation:  0.013194561004638672
mini_batch_src_global generation:  0.026114463806152344
r_  generation:  0.2096250057220459
local_output_nid generation:  0.011985301971435547
local_in_edges_tensor generation:  0.013486862182617188
mini_batch_src_global generation:  0.025955915451049805
r_  generation:  0.2116231918334961
local_output_nid generation:  0.012115716934204102
local_in_edges_tensor generation:  0.011854410171508789
mini_batch_src_global generation:  0.0260164737701416
r_  generation:  0.2089378833770752
local_output_nid generation:  0.011999368667602539
local_in_edges_tensor generation:  0.013063192367553711
mini_batch_src_global generation:  0.02643132209777832
r_  generation:  0.2117295265197754
local_output_nid generation:  0.012043952941894531
local_in_edges_tensor generation:  0.01686263084411621
mini_batch_src_global generation:  0.027805566787719727
r_  generation:  0.21521377563476562
----------------------check_connections_block total spend ----------------------------- 4.926246166229248
generate_one_block  0.2667708396911621
generate_one_block  0.26550817489624023
generate_one_block  0.26944971084594727
generate_one_block  0.26766109466552734
generate_one_block  0.2705826759338379
generate_one_block  0.26554274559020996
generate_one_block  0.2866556644439697
generate_one_block  0.2648196220397949
generate_one_block  0.2701864242553711
generate_one_block  0.2696831226348877
generate_one_block  0.276078462600708
generate_one_block  0.26456665992736816
generate_one_block  0.26145100593566895
generate_one_block  0.2633538246154785
generate_one_block  0.2698380947113037
generate_one_block  0.2742035388946533
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0317232608795166
gen group dst list time:  0.060764312744140625
time for parepare:  0.017876386642456055
local_output_nid generation:  0.02885913848876953
local_in_edges_tensor generation:  0.03671860694885254
mini_batch_src_global generation:  0.039766550064086914
r_  generation:  0.43659090995788574
local_output_nid generation:  0.03150200843811035
local_in_edges_tensor generation:  0.033293962478637695
mini_batch_src_global generation:  0.05166006088256836
r_  generation:  0.4486351013183594
local_output_nid generation:  0.031363725662231445
local_in_edges_tensor generation:  0.030901432037353516
mini_batch_src_global generation:  0.049877166748046875
r_  generation:  0.4535386562347412
local_output_nid generation:  0.031029701232910156
local_in_edges_tensor generation:  0.029633283615112305
mini_batch_src_global generation:  0.05140995979309082
r_  generation:  0.4506206512451172
local_output_nid generation:  0.031359195709228516
local_in_edges_tensor generation:  0.07491374015808105
mini_batch_src_global generation:  0.05154681205749512
r_  generation:  0.4565753936767578
local_output_nid generation:  0.030990123748779297
local_in_edges_tensor generation:  0.035843610763549805
mini_batch_src_global generation:  0.05281877517700195
r_  generation:  0.45455479621887207
local_output_nid generation:  0.030863285064697266
local_in_edges_tensor generation:  0.03285527229309082
mini_batch_src_global generation:  0.056984663009643555
r_  generation:  0.4564182758331299
local_output_nid generation:  0.0310060977935791
local_in_edges_tensor generation:  0.030577421188354492
mini_batch_src_global generation:  0.052866458892822266
r_  generation:  0.46061182022094727
local_output_nid generation:  0.03141522407531738
local_in_edges_tensor generation:  0.032752037048339844
mini_batch_src_global generation:  0.05150032043457031
r_  generation:  0.460538387298584
local_output_nid generation:  0.031152963638305664
local_in_edges_tensor generation:  0.030203819274902344
mini_batch_src_global generation:  0.05273294448852539
r_  generation:  0.46460437774658203
local_output_nid generation:  0.032866477966308594
local_in_edges_tensor generation:  0.03336596488952637
mini_batch_src_global generation:  0.05516695976257324
r_  generation:  0.46289658546447754
local_output_nid generation:  0.031554460525512695
local_in_edges_tensor generation:  0.03424859046936035
mini_batch_src_global generation:  0.053019046783447266
r_  generation:  0.45717406272888184
local_output_nid generation:  0.03140091896057129
local_in_edges_tensor generation:  0.029251575469970703
mini_batch_src_global generation:  0.051697731018066406
r_  generation:  0.45893383026123047
local_output_nid generation:  0.031161785125732422
local_in_edges_tensor generation:  0.02979898452758789
mini_batch_src_global generation:  0.052391767501831055
r_  generation:  0.4558522701263428
local_output_nid generation:  0.03148818016052246
local_in_edges_tensor generation:  0.03174138069152832
mini_batch_src_global generation:  0.0536036491394043
r_  generation:  0.4629027843475342
local_output_nid generation:  0.031307220458984375
local_in_edges_tensor generation:  0.03591346740722656
mini_batch_src_global generation:  0.052956581115722656
r_  generation:  0.45689964294433594
----------------------check_connections_block total spend ----------------------------- 10.777382135391235
generate_one_block  0.5732975006103516
generate_one_block  0.5739457607269287
generate_one_block  0.5727756023406982
generate_one_block  0.5783259868621826
generate_one_block  0.5784580707550049
generate_one_block  0.5739772319793701
generate_one_block  0.5822436809539795
generate_one_block  0.5685863494873047
generate_one_block  0.6037757396697998
generate_one_block  0.5852091312408447
generate_one_block  0.5822811126708984
generate_one_block  0.5725083351135254
generate_one_block  0.5668120384216309
generate_one_block  0.585796594619751
generate_one_block  0.582160234451294
generate_one_block  0.5767219066619873
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11534833908081055  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

connection checking time:  15.703628301620483
block generation total time  13.56322693824768
average batch blocks generation time:  0.84770168364048
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09397745132446289  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7185330390930176  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09329700469970703  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7182273864746094  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09398555755615234  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7206239700317383  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09318828582763672  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7175345420837402  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09385395050048828  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7165012359619141  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09330987930297852  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7171816825866699  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09391307830810547  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7171425819396973  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09335756301879883  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7165713310241699  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09393310546875  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7179174423217773  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09328985214233398  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7186975479125977  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09397029876708984  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7189621925354004  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09320974349975586  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.717674732208252  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09380054473876953  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7154302597045898  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0933384895324707  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7165703773498535  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09392261505126953  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7182173728942871  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09333229064941406  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7191290855407715  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06002841889858246 |0.012153416872024536 |0.004055723547935486 |0.00010246038436889648 |0.0035775750875473022 |0.0018601417541503906 |
----------------------------------------------------------pseudo_mini_loss sum 2.3725123405456543
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  5092381
Number of first layer input nodes during this epoch:  2470297
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.1152644157409668  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019716501235961914
random selection method range initialization spend 0.005635499954223633
time for parepare:  0.018763303756713867
local_output_nid generation:  0.0023398399353027344
local_in_edges_tensor generation:  0.006785154342651367
mini_batch_src_global generation:  0.0015411376953125
r_  generation:  0.018822431564331055
local_output_nid generation:  0.002819061279296875
local_in_edges_tensor generation:  0.0019485950469970703
mini_batch_src_global generation:  0.0018792152404785156
r_  generation:  0.019839763641357422
local_output_nid generation:  0.002936124801635742
local_in_edges_tensor generation:  0.0016117095947265625
mini_batch_src_global generation:  0.0015323162078857422
r_  generation:  0.018887996673583984
local_output_nid generation:  0.002967357635498047
local_in_edges_tensor generation:  0.0016455650329589844
mini_batch_src_global generation:  0.0015141963958740234
r_  generation:  0.01924419403076172
local_output_nid generation:  0.0029866695404052734
local_in_edges_tensor generation:  0.0015900135040283203
mini_batch_src_global generation:  0.0015635490417480469
r_  generation:  0.018929719924926758
local_output_nid generation:  0.0029752254486083984
local_in_edges_tensor generation:  0.0015993118286132812
mini_batch_src_global generation:  0.0014846324920654297
r_  generation:  0.019452571868896484
local_output_nid generation:  0.003131389617919922
local_in_edges_tensor generation:  0.0016570091247558594
mini_batch_src_global generation:  0.0016167163848876953
r_  generation:  0.019844770431518555
local_output_nid generation:  0.0030510425567626953
local_in_edges_tensor generation:  0.0016350746154785156
mini_batch_src_global generation:  0.0016415119171142578
r_  generation:  0.01982426643371582
local_output_nid generation:  0.0030066967010498047
local_in_edges_tensor generation:  0.0015783309936523438
mini_batch_src_global generation:  0.0016162395477294922
r_  generation:  0.0197446346282959
local_output_nid generation:  0.0030820369720458984
local_in_edges_tensor generation:  0.001569986343383789
mini_batch_src_global generation:  0.0016324520111083984
r_  generation:  0.019628047943115234
local_output_nid generation:  0.0030477046966552734
local_in_edges_tensor generation:  0.0015523433685302734
mini_batch_src_global generation:  0.0016133785247802734
r_  generation:  0.01987934112548828
local_output_nid generation:  0.002989053726196289
local_in_edges_tensor generation:  0.0015447139739990234
mini_batch_src_global generation:  0.0016319751739501953
r_  generation:  0.01956796646118164
local_output_nid generation:  0.0030379295349121094
local_in_edges_tensor generation:  0.0015630722045898438
mini_batch_src_global generation:  0.0015690326690673828
r_  generation:  0.019502878189086914
local_output_nid generation:  0.002969503402709961
local_in_edges_tensor generation:  0.0015206336975097656
mini_batch_src_global generation:  0.001577615737915039
r_  generation:  0.019533157348632812
local_output_nid generation:  0.0029952526092529297
local_in_edges_tensor generation:  0.0017876625061035156
mini_batch_src_global generation:  0.0018773078918457031
r_  generation:  0.01963210105895996
local_output_nid generation:  0.0029458999633789062
local_in_edges_tensor generation:  0.0015377998352050781
mini_batch_src_global generation:  0.0016064643859863281
r_  generation:  0.019884586334228516
----------------------check_connections_block total spend ----------------------------- 0.5164039134979248
generate_one_block  0.027802705764770508
generate_one_block  0.028890371322631836
generate_one_block  0.027532339096069336
generate_one_block  0.027907848358154297
generate_one_block  0.027487754821777344
generate_one_block  0.03246498107910156
generate_one_block  0.02886509895324707
generate_one_block  0.028052330017089844
generate_one_block  0.02852487564086914
generate_one_block  0.02821493148803711
generate_one_block  0.0280303955078125
generate_one_block  0.027899503707885742
generate_one_block  0.027837753295898438
generate_one_block  0.027625083923339844
generate_one_block  0.027988910675048828
generate_one_block  0.030532360076904297
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04050636291503906
gen group dst list time:  0.016419649124145508
time for parepare:  0.02218341827392578
local_output_nid generation:  0.010177135467529297
local_in_edges_tensor generation:  0.02082538604736328
mini_batch_src_global generation:  0.019437313079833984
r_  generation:  0.19729971885681152
local_output_nid generation:  0.012962818145751953
local_in_edges_tensor generation:  0.020941495895385742
mini_batch_src_global generation:  0.028007984161376953
r_  generation:  0.20949411392211914
local_output_nid generation:  0.012041568756103516
local_in_edges_tensor generation:  0.015850543975830078
mini_batch_src_global generation:  0.025072336196899414
r_  generation:  0.20770573616027832
local_output_nid generation:  0.0122528076171875
local_in_edges_tensor generation:  0.012426137924194336
mini_batch_src_global generation:  0.03149843215942383
r_  generation:  0.21383929252624512
local_output_nid generation:  0.01428985595703125
local_in_edges_tensor generation:  0.012401103973388672
mini_batch_src_global generation:  0.02501082420349121
r_  generation:  0.20772361755371094
local_output_nid generation:  0.012843847274780273
local_in_edges_tensor generation:  0.012809514999389648
mini_batch_src_global generation:  0.02527308464050293
r_  generation:  0.20993280410766602
local_output_nid generation:  0.013149499893188477
local_in_edges_tensor generation:  0.015370607376098633
mini_batch_src_global generation:  0.030989408493041992
r_  generation:  0.21866917610168457
local_output_nid generation:  0.012976884841918945
local_in_edges_tensor generation:  0.012208700180053711
mini_batch_src_global generation:  0.026367664337158203
r_  generation:  0.2119133472442627
local_output_nid generation:  0.013087272644042969
local_in_edges_tensor generation:  0.012505292892456055
mini_batch_src_global generation:  0.026172637939453125
r_  generation:  0.21277117729187012
local_output_nid generation:  0.013180017471313477
local_in_edges_tensor generation:  0.0136566162109375
mini_batch_src_global generation:  0.026461124420166016
r_  generation:  0.2165696620941162
local_output_nid generation:  0.012806177139282227
local_in_edges_tensor generation:  0.011873483657836914
mini_batch_src_global generation:  0.026235342025756836
r_  generation:  0.21382689476013184
local_output_nid generation:  0.012935400009155273
local_in_edges_tensor generation:  0.012593746185302734
mini_batch_src_global generation:  0.02641916275024414
r_  generation:  0.21275043487548828
local_output_nid generation:  0.01293802261352539
local_in_edges_tensor generation:  0.012351512908935547
mini_batch_src_global generation:  0.026544570922851562
r_  generation:  0.21065902709960938
local_output_nid generation:  0.012939691543579102
local_in_edges_tensor generation:  0.011471033096313477
mini_batch_src_global generation:  0.026310443878173828
r_  generation:  0.21300292015075684
local_output_nid generation:  0.012471675872802734
local_in_edges_tensor generation:  0.013498544692993164
mini_batch_src_global generation:  0.0272829532623291
r_  generation:  0.21471357345581055
local_output_nid generation:  0.012535333633422852
local_in_edges_tensor generation:  0.012094497680664062
mini_batch_src_global generation:  0.027571439743041992
r_  generation:  0.21351003646850586
----------------------check_connections_block total spend ----------------------------- 4.999935150146484
generate_one_block  0.2790818214416504
generate_one_block  0.2706305980682373
generate_one_block  0.26459312438964844
generate_one_block  0.26753664016723633
generate_one_block  0.2661111354827881
generate_one_block  0.2653927803039551
generate_one_block  0.3096294403076172
generate_one_block  0.27208900451660156
generate_one_block  0.2721385955810547
generate_one_block  0.27356791496276855
generate_one_block  0.26999878883361816
generate_one_block  0.2775156497955322
generate_one_block  0.27378392219543457
generate_one_block  0.2700517177581787
generate_one_block  0.2828183174133301
generate_one_block  0.2767319679260254
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0395207405090332
gen group dst list time:  0.06897544860839844
time for parepare:  0.019200563430786133
local_output_nid generation:  0.026798725128173828
local_in_edges_tensor generation:  0.057678937911987305
mini_batch_src_global generation:  0.04301643371582031
r_  generation:  0.4422116279602051
local_output_nid generation:  0.031362295150756836
local_in_edges_tensor generation:  0.03920936584472656
mini_batch_src_global generation:  0.05344748497009277
r_  generation:  0.45352697372436523
local_output_nid generation:  0.03142666816711426
local_in_edges_tensor generation:  0.03049159049987793
mini_batch_src_global generation:  0.049623727798461914
r_  generation:  0.4541330337524414
local_output_nid generation:  0.031742095947265625
local_in_edges_tensor generation:  0.03202676773071289
mini_batch_src_global generation:  0.05404376983642578
r_  generation:  0.4681735038757324
local_output_nid generation:  0.03116440773010254
local_in_edges_tensor generation:  0.07424426078796387
mini_batch_src_global generation:  0.05047202110290527
r_  generation:  0.4623737335205078
local_output_nid generation:  0.03157758712768555
local_in_edges_tensor generation:  0.030119895935058594
mini_batch_src_global generation:  0.05210471153259277
r_  generation:  0.45571184158325195
local_output_nid generation:  0.031519412994384766
local_in_edges_tensor generation:  0.03673148155212402
mini_batch_src_global generation:  0.05471611022949219
r_  generation:  0.4632997512817383
local_output_nid generation:  0.031859397888183594
local_in_edges_tensor generation:  0.037737369537353516
mini_batch_src_global generation:  0.05261397361755371
r_  generation:  0.45392656326293945
local_output_nid generation:  0.03316020965576172
local_in_edges_tensor generation:  0.03525114059448242
mini_batch_src_global generation:  0.06029844284057617
r_  generation:  0.4625716209411621
local_output_nid generation:  0.03154134750366211
local_in_edges_tensor generation:  0.03209209442138672
mini_batch_src_global generation:  0.05209779739379883
r_  generation:  0.45535778999328613
local_output_nid generation:  0.03188037872314453
local_in_edges_tensor generation:  0.03941059112548828
mini_batch_src_global generation:  0.05215120315551758
r_  generation:  0.45799732208251953
local_output_nid generation:  0.03404116630554199
local_in_edges_tensor generation:  0.032271623611450195
mini_batch_src_global generation:  0.05241107940673828
r_  generation:  0.4703216552734375
local_output_nid generation:  0.03250384330749512
local_in_edges_tensor generation:  0.030169248580932617
mini_batch_src_global generation:  0.05302548408508301
r_  generation:  0.45745253562927246
local_output_nid generation:  0.03272533416748047
local_in_edges_tensor generation:  0.03526568412780762
mini_batch_src_global generation:  0.05233359336853027
r_  generation:  0.4545269012451172
local_output_nid generation:  0.03253507614135742
local_in_edges_tensor generation:  0.03464055061340332
mini_batch_src_global generation:  0.052788734436035156
r_  generation:  0.4562361240386963
local_output_nid generation:  0.032509803771972656
local_in_edges_tensor generation:  0.03223705291748047
mini_batch_src_global generation:  0.05299830436706543
r_  generation:  0.4542238712310791
----------------------check_connections_block total spend ----------------------------- 10.874176979064941
generate_one_block  0.5821046829223633
generate_one_block  0.5817434787750244
generate_one_block  0.574397087097168
generate_one_block  0.5746614933013916
generate_one_block  0.5779337882995605
generate_one_block  0.5766644477844238
generate_one_block  0.5886795520782471
generate_one_block  0.5755519866943359
generate_one_block  0.6521072387695312
generate_one_block  0.5818648338317871
generate_one_block  0.577399730682373
generate_one_block  0.579249382019043
generate_one_block  0.5766570568084717
generate_one_block  0.5847959518432617
generate_one_block  0.5778722763061523
generate_one_block  0.5778086185455322
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.1152644157409668  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

connection checking time:  15.874112129211426
block generation total time  13.731163024902344
average batch blocks generation time:  0.8581976890563965
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09394502639770508  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7184391021728516  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09341049194335938  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7191348075866699  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09383487701416016  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7161188125610352  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09346342086791992  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7209720611572266  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09385108947753906  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7173366546630859  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09305477142333984  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7112722396850586  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09408187866210938  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7241997718811035  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09334945678710938  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7174735069274902  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09389686584472656  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7168269157409668  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09333992004394531  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7179107666015625  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0939016342163086  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7184920310974121  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09316492080688477  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7114758491516113  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0937814712524414  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7162551879882812  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0935215950012207  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7167239189147949  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09387493133544922  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7184295654296875  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09353923797607422  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7196340560913086  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05990739166736603 |0.01325981318950653 |0.003586024045944214 |9.420514106750488e-05 |0.0032382458448410034 |0.002737283706665039 |
----------------------------------------------------------pseudo_mini_loss sum 2.103675127029419
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  5093805
Number of first layer input nodes during this epoch:  2472753
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11544275283813477  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0231626033782959
random selection method range initialization spend 0.005619525909423828
time for parepare:  0.018496274948120117
local_output_nid generation:  0.0023403167724609375
local_in_edges_tensor generation:  0.007199764251708984
mini_batch_src_global generation:  0.0016355514526367188
r_  generation:  0.018387556076049805
local_output_nid generation:  0.0028443336486816406
local_in_edges_tensor generation:  0.001664876937866211
mini_batch_src_global generation:  0.0019190311431884766
r_  generation:  0.018810033798217773
local_output_nid generation:  0.0029137134552001953
local_in_edges_tensor generation:  0.0016474723815917969
mini_batch_src_global generation:  0.0014963150024414062
r_  generation:  0.018527984619140625
local_output_nid generation:  0.002910614013671875
local_in_edges_tensor generation:  0.0015850067138671875
mini_batch_src_global generation:  0.0016276836395263672
r_  generation:  0.019377470016479492
local_output_nid generation:  0.0029523372650146484
local_in_edges_tensor generation:  0.0015475749969482422
mini_batch_src_global generation:  0.0016317367553710938
r_  generation:  0.019347429275512695
local_output_nid generation:  0.0029489994049072266
local_in_edges_tensor generation:  0.0015621185302734375
mini_batch_src_global generation:  0.001622915267944336
r_  generation:  0.019315481185913086
local_output_nid generation:  0.0029230117797851562
local_in_edges_tensor generation:  0.0015878677368164062
mini_batch_src_global generation:  0.0016162395477294922
r_  generation:  0.019602298736572266
local_output_nid generation:  0.002962350845336914
local_in_edges_tensor generation:  0.0015554428100585938
mini_batch_src_global generation:  0.0016133785247802734
r_  generation:  0.019704580307006836
local_output_nid generation:  0.0029075145721435547
local_in_edges_tensor generation:  0.0015306472778320312
mini_batch_src_global generation:  0.0016124248504638672
r_  generation:  0.01964116096496582
local_output_nid generation:  0.0029516220092773438
local_in_edges_tensor generation:  0.0015718936920166016
mini_batch_src_global generation:  0.0016124248504638672
r_  generation:  0.020499229431152344
local_output_nid generation:  0.0033757686614990234
local_in_edges_tensor generation:  0.001577615737915039
mini_batch_src_global generation:  0.0016112327575683594
r_  generation:  0.019657611846923828
local_output_nid generation:  0.00296783447265625
local_in_edges_tensor generation:  0.0015406608581542969
mini_batch_src_global generation:  0.0016782283782958984
r_  generation:  0.01993083953857422
local_output_nid generation:  0.0029795169830322266
local_in_edges_tensor generation:  0.0015079975128173828
mini_batch_src_global generation:  0.0016131401062011719
r_  generation:  0.020142555236816406
local_output_nid generation:  0.0030181407928466797
local_in_edges_tensor generation:  0.0015654563903808594
mini_batch_src_global generation:  0.0015642642974853516
r_  generation:  0.01949596405029297
local_output_nid generation:  0.003054380416870117
local_in_edges_tensor generation:  0.001493692398071289
mini_batch_src_global generation:  0.0015454292297363281
r_  generation:  0.019605398178100586
local_output_nid generation:  0.0030069351196289062
local_in_edges_tensor generation:  0.0015130043029785156
mini_batch_src_global generation:  0.0015590190887451172
r_  generation:  0.01929759979248047
----------------------check_connections_block total spend ----------------------------- 0.5143804550170898
generate_one_block  0.026978492736816406
generate_one_block  0.028311967849731445
generate_one_block  0.02722787857055664
generate_one_block  0.028156042098999023
generate_one_block  0.02836322784423828
generate_one_block  0.03238534927368164
generate_one_block  0.028142929077148438
generate_one_block  0.028087615966796875
generate_one_block  0.02826690673828125
generate_one_block  0.027858972549438477
generate_one_block  0.027709245681762695
generate_one_block  0.028123140335083008
generate_one_block  0.02789759635925293
generate_one_block  0.027654647827148438
generate_one_block  0.0279996395111084
generate_one_block  0.028063297271728516
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04223012924194336
gen group dst list time:  0.018139123916625977
time for parepare:  0.01951456069946289
local_output_nid generation:  0.008276700973510742
local_in_edges_tensor generation:  0.02566075325012207
mini_batch_src_global generation:  0.01947474479675293
r_  generation:  0.1904151439666748
local_output_nid generation:  0.011993169784545898
local_in_edges_tensor generation:  0.014942169189453125
mini_batch_src_global generation:  0.02381587028503418
r_  generation:  0.19869136810302734
local_output_nid generation:  0.011773824691772461
local_in_edges_tensor generation:  0.012853384017944336
mini_batch_src_global generation:  0.022500276565551758
r_  generation:  0.20206737518310547
local_output_nid generation:  0.012706518173217773
local_in_edges_tensor generation:  0.01481318473815918
mini_batch_src_global generation:  0.025481700897216797
r_  generation:  0.21297025680541992
local_output_nid generation:  0.012710332870483398
local_in_edges_tensor generation:  0.013807535171508789
mini_batch_src_global generation:  0.025836467742919922
r_  generation:  0.213331937789917
local_output_nid generation:  0.012421131134033203
local_in_edges_tensor generation:  0.012353658676147461
mini_batch_src_global generation:  0.025986433029174805
r_  generation:  0.2099921703338623
local_output_nid generation:  0.012665510177612305
local_in_edges_tensor generation:  0.012213706970214844
mini_batch_src_global generation:  0.02566814422607422
r_  generation:  0.2100832462310791
local_output_nid generation:  0.012939929962158203
local_in_edges_tensor generation:  0.011809110641479492
mini_batch_src_global generation:  0.02637314796447754
r_  generation:  0.21587848663330078
local_output_nid generation:  0.012802839279174805
local_in_edges_tensor generation:  0.012241363525390625
mini_batch_src_global generation:  0.02684760093688965
r_  generation:  0.21669292449951172
local_output_nid generation:  0.01289987564086914
local_in_edges_tensor generation:  0.01216745376586914
mini_batch_src_global generation:  0.026436567306518555
r_  generation:  0.21636557579040527
local_output_nid generation:  0.012393712997436523
local_in_edges_tensor generation:  0.012102842330932617
mini_batch_src_global generation:  0.026162147521972656
r_  generation:  0.21330857276916504
local_output_nid generation:  0.012546539306640625
local_in_edges_tensor generation:  0.012743949890136719
mini_batch_src_global generation:  0.027458906173706055
r_  generation:  0.2181413173675537
local_output_nid generation:  0.012853145599365234
local_in_edges_tensor generation:  0.014238119125366211
mini_batch_src_global generation:  0.027070283889770508
r_  generation:  0.21943140029907227
local_output_nid generation:  0.012325525283813477
local_in_edges_tensor generation:  0.012491703033447266
mini_batch_src_global generation:  0.026623249053955078
r_  generation:  0.21264433860778809
local_output_nid generation:  0.011863946914672852
local_in_edges_tensor generation:  0.011993646621704102
mini_batch_src_global generation:  0.026209354400634766
r_  generation:  0.21593856811523438
local_output_nid generation:  0.011890888214111328
local_in_edges_tensor generation:  0.011980295181274414
mini_batch_src_global generation:  0.026124000549316406
r_  generation:  0.21269488334655762
----------------------check_connections_block total spend ----------------------------- 4.957982301712036
generate_one_block  0.2678968906402588
generate_one_block  0.2606539726257324
generate_one_block  0.25966930389404297
generate_one_block  0.2732977867126465
generate_one_block  0.2695178985595703
generate_one_block  0.26355886459350586
generate_one_block  0.28353309631347656
generate_one_block  0.27547359466552734
generate_one_block  0.2681691646575928
generate_one_block  0.2696361541748047
generate_one_block  0.26320958137512207
generate_one_block  0.2773256301879883
generate_one_block  0.2819035053253174
generate_one_block  0.271038293838501
generate_one_block  0.2685580253601074
generate_one_block  0.267261266708374
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03147149085998535
gen group dst list time:  0.059719085693359375
time for parepare:  0.01971435546875
local_output_nid generation:  0.026303529739379883
local_in_edges_tensor generation:  0.03847098350524902
mini_batch_src_global generation:  0.04107546806335449
r_  generation:  0.44523000717163086
local_output_nid generation:  0.031424760818481445
local_in_edges_tensor generation:  0.04226970672607422
mini_batch_src_global generation:  0.053501129150390625
r_  generation:  0.4477567672729492
local_output_nid generation:  0.03151273727416992
local_in_edges_tensor generation:  0.03407645225524902
mini_batch_src_global generation:  0.05005502700805664
r_  generation:  0.4553346633911133
local_output_nid generation:  0.03142523765563965
local_in_edges_tensor generation:  0.034688711166381836
mini_batch_src_global generation:  0.05176210403442383
r_  generation:  0.4565317630767822
local_output_nid generation:  0.031651973724365234
local_in_edges_tensor generation:  0.07637333869934082
mini_batch_src_global generation:  0.05138754844665527
r_  generation:  0.45978569984436035
local_output_nid generation:  0.031443119049072266
local_in_edges_tensor generation:  0.03010272979736328
mini_batch_src_global generation:  0.052571773529052734
r_  generation:  0.45767951011657715
local_output_nid generation:  0.03152632713317871
local_in_edges_tensor generation:  0.03033447265625
mini_batch_src_global generation:  0.052977561950683594
r_  generation:  0.459841251373291
local_output_nid generation:  0.031311988830566406
local_in_edges_tensor generation:  0.03048992156982422
mini_batch_src_global generation:  0.05232357978820801
r_  generation:  0.45423340797424316
local_output_nid generation:  0.031145811080932617
local_in_edges_tensor generation:  0.030081987380981445
mini_batch_src_global generation:  0.05326366424560547
r_  generation:  0.4606590270996094
local_output_nid generation:  0.03147101402282715
local_in_edges_tensor generation:  0.03387331962585449
mini_batch_src_global generation:  0.05298471450805664
r_  generation:  0.45631957054138184
local_output_nid generation:  0.031160354614257812
local_in_edges_tensor generation:  0.030008316040039062
mini_batch_src_global generation:  0.0544891357421875
r_  generation:  0.45930933952331543
local_output_nid generation:  0.031633853912353516
local_in_edges_tensor generation:  0.03050971031188965
mini_batch_src_global generation:  0.051972389221191406
r_  generation:  0.45410728454589844
local_output_nid generation:  0.03140091896057129
local_in_edges_tensor generation:  0.034749746322631836
mini_batch_src_global generation:  0.05149960517883301
r_  generation:  0.45955801010131836
local_output_nid generation:  0.031135082244873047
local_in_edges_tensor generation:  0.030528545379638672
mini_batch_src_global generation:  0.052764177322387695
r_  generation:  0.4539024829864502
local_output_nid generation:  0.0314178466796875
local_in_edges_tensor generation:  0.03034830093383789
mini_batch_src_global generation:  0.05531930923461914
r_  generation:  0.4607369899749756
local_output_nid generation:  0.03150129318237305
local_in_edges_tensor generation:  0.040158987045288086
mini_batch_src_global generation:  0.05526924133300781
r_  generation:  0.45757412910461426
----------------------check_connections_block total spend ----------------------------- 10.793224811553955
generate_one_block  0.5745425224304199
generate_one_block  0.5715928077697754
generate_one_block  0.5776352882385254
generate_one_block  0.5794613361358643
generate_one_block  0.5827956199645996
generate_one_block  0.5734989643096924
generate_one_block  0.5763740539550781
generate_one_block  0.5817446708679199
generate_one_block  0.6143620014190674
generate_one_block  0.5818579196929932
generate_one_block  0.5800755023956299
generate_one_block  0.5890405178070068
generate_one_block  0.6059157848358154
generate_one_block  0.5805811882019043
generate_one_block  0.5784881114959717
generate_one_block  0.5927410125732422
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11544275283813477  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

connection checking time:  15.751207113265991
block generation total time  13.661410331726074
average batch blocks generation time:  0.8538381457328796
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09376859664916992  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7114195823669434  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09307861328125  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7103328704833984  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09374809265136719  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7156567573547363  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09352922439575195  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7193665504455566  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0939931869506836  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7197136878967285  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09332418441772461  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7169661521911621  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09384918212890625  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7174191474914551  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09345722198486328  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7189173698425293  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09397125244140625  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.719764232635498  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09354734420776367  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7221541404724121  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09380912780761719  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7166628837585449  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09352636337280273  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7236108779907227  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0940542221069336  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7198858261108398  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09334039688110352  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7151346206665039  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09383487701416016  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7181148529052734  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09329080581665039  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7162423133850098  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0631333589553833 |0.013892263174057007 |0.0037009865045547485 |9.453296661376953e-05 |0.0037113428115844727 |0.0027437210083007812 |
----------------------------------------------------------pseudo_mini_loss sum 1.9458105564117432
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  5090123
Number of first layer input nodes during this epoch:  2470995
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11501884460449219  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02291393280029297
random selection method range initialization spend 0.0054340362548828125
time for parepare:  0.01892232894897461
local_output_nid generation:  0.0023670196533203125
local_in_edges_tensor generation:  0.007464170455932617
mini_batch_src_global generation:  0.0016131401062011719
r_  generation:  0.01854228973388672
local_output_nid generation:  0.0028862953186035156
local_in_edges_tensor generation:  0.0017268657684326172
mini_batch_src_global generation:  0.0019910335540771484
r_  generation:  0.019872426986694336
local_output_nid generation:  0.003004312515258789
local_in_edges_tensor generation:  0.0016591548919677734
mini_batch_src_global generation:  0.0016019344329833984
r_  generation:  0.01934957504272461
local_output_nid generation:  0.0030384063720703125
local_in_edges_tensor generation:  0.0016064643859863281
mini_batch_src_global generation:  0.0016286373138427734
r_  generation:  0.01923346519470215
local_output_nid generation:  0.003003835678100586
local_in_edges_tensor generation:  0.00162506103515625
mini_batch_src_global generation:  0.001573801040649414
r_  generation:  0.019518375396728516
local_output_nid generation:  0.0030171871185302734
local_in_edges_tensor generation:  0.0015506744384765625
mini_batch_src_global generation:  0.0015864372253417969
r_  generation:  0.019357681274414062
local_output_nid generation:  0.0030221939086914062
local_in_edges_tensor generation:  0.0015311241149902344
mini_batch_src_global generation:  0.0016415119171142578
r_  generation:  0.02039957046508789
local_output_nid generation:  0.0030553340911865234
local_in_edges_tensor generation:  0.0015501976013183594
mini_batch_src_global generation:  0.0016412734985351562
r_  generation:  0.01994037628173828
local_output_nid generation:  0.0030536651611328125
local_in_edges_tensor generation:  0.0015125274658203125
mini_batch_src_global generation:  0.0016107559204101562
r_  generation:  0.019850969314575195
local_output_nid generation:  0.0030035972595214844
local_in_edges_tensor generation:  0.0014743804931640625
mini_batch_src_global generation:  0.0016484260559082031
r_  generation:  0.019663572311401367
local_output_nid generation:  0.0029964447021484375
local_in_edges_tensor generation:  0.0014734268188476562
mini_batch_src_global generation:  0.001619577407836914
r_  generation:  0.0199587345123291
local_output_nid generation:  0.0029630661010742188
local_in_edges_tensor generation:  0.0015292167663574219
mini_batch_src_global generation:  0.0016045570373535156
r_  generation:  0.01957082748413086
local_output_nid generation:  0.0029909610748291016
local_in_edges_tensor generation:  0.0015015602111816406
mini_batch_src_global generation:  0.0016086101531982422
r_  generation:  0.019403696060180664
local_output_nid generation:  0.0029916763305664062
local_in_edges_tensor generation:  0.0015478134155273438
mini_batch_src_global generation:  0.0015380382537841797
r_  generation:  0.019165992736816406
local_output_nid generation:  0.0030028820037841797
local_in_edges_tensor generation:  0.001524209976196289
mini_batch_src_global generation:  0.0015683174133300781
r_  generation:  0.019994020462036133
local_output_nid generation:  0.002984285354614258
local_in_edges_tensor generation:  0.0014781951904296875
mini_batch_src_global generation:  0.0016241073608398438
r_  generation:  0.019680023193359375
----------------------check_connections_block total spend ----------------------------- 0.5176565647125244
generate_one_block  0.02698993682861328
generate_one_block  0.02840256690979004
generate_one_block  0.027475833892822266
generate_one_block  0.02811264991760254
generate_one_block  0.027547597885131836
generate_one_block  0.03049468994140625
generate_one_block  0.028531789779663086
generate_one_block  0.02821040153503418
generate_one_block  0.027827024459838867
generate_one_block  0.027600526809692383
generate_one_block  0.027852535247802734
generate_one_block  0.0277712345123291
generate_one_block  0.02725386619567871
generate_one_block  0.027091503143310547
generate_one_block  0.027835369110107422
generate_one_block  0.03130626678466797
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03400135040283203
gen group dst list time:  0.01607203483581543
time for parepare:  0.019715547561645508
local_output_nid generation:  0.00833272933959961
local_in_edges_tensor generation:  0.022490978240966797
mini_batch_src_global generation:  0.019699811935424805
r_  generation:  0.1884315013885498
local_output_nid generation:  0.012485504150390625
local_in_edges_tensor generation:  0.015744686126708984
mini_batch_src_global generation:  0.028418779373168945
r_  generation:  0.2003178596496582
local_output_nid generation:  0.012252330780029297
local_in_edges_tensor generation:  0.015720605850219727
mini_batch_src_global generation:  0.024451255798339844
r_  generation:  0.20546722412109375
local_output_nid generation:  0.012726306915283203
local_in_edges_tensor generation:  0.013815164566040039
mini_batch_src_global generation:  0.02529454231262207
r_  generation:  0.2100224494934082
local_output_nid generation:  0.012984991073608398
local_in_edges_tensor generation:  0.012156248092651367
mini_batch_src_global generation:  0.025533676147460938
r_  generation:  0.21092605590820312
local_output_nid generation:  0.012910127639770508
local_in_edges_tensor generation:  0.013141155242919922
mini_batch_src_global generation:  0.02557969093322754
r_  generation:  0.21036863327026367
local_output_nid generation:  0.013033390045166016
local_in_edges_tensor generation:  0.013083696365356445
mini_batch_src_global generation:  0.026592731475830078
r_  generation:  0.2178335189819336
local_output_nid generation:  0.01295161247253418
local_in_edges_tensor generation:  0.012143373489379883
mini_batch_src_global generation:  0.02610158920288086
r_  generation:  0.2139582633972168
local_output_nid generation:  0.012974262237548828
local_in_edges_tensor generation:  0.012027502059936523
mini_batch_src_global generation:  0.026238441467285156
r_  generation:  0.21435141563415527
local_output_nid generation:  0.01289987564086914
local_in_edges_tensor generation:  0.012193441390991211
mini_batch_src_global generation:  0.028759241104125977
r_  generation:  0.21411967277526855
local_output_nid generation:  0.01252603530883789
local_in_edges_tensor generation:  0.012106895446777344
mini_batch_src_global generation:  0.02897334098815918
r_  generation:  0.2156982421875
local_output_nid generation:  0.01262807846069336
local_in_edges_tensor generation:  0.011760473251342773
mini_batch_src_global generation:  0.026101350784301758
r_  generation:  0.21264004707336426
local_output_nid generation:  0.012656211853027344
local_in_edges_tensor generation:  0.011855602264404297
mini_batch_src_global generation:  0.026085853576660156
r_  generation:  0.20917034149169922
local_output_nid generation:  0.012701272964477539
local_in_edges_tensor generation:  0.011721134185791016
mini_batch_src_global generation:  0.02569437026977539
r_  generation:  0.21423959732055664
local_output_nid generation:  0.012536048889160156
local_in_edges_tensor generation:  0.012695789337158203
mini_batch_src_global generation:  0.027484416961669922
r_  generation:  0.21590113639831543
local_output_nid generation:  0.012416362762451172
local_in_edges_tensor generation:  0.011892318725585938
mini_batch_src_global generation:  0.026829957962036133
r_  generation:  0.21679925918579102
----------------------check_connections_block total spend ----------------------------- 4.956470012664795
generate_one_block  0.26939940452575684
generate_one_block  0.26432275772094727
generate_one_block  0.26895833015441895
generate_one_block  0.27042174339294434
generate_one_block  0.2681565284729004
generate_one_block  0.26761841773986816
generate_one_block  0.29534912109375
generate_one_block  0.2690088748931885
generate_one_block  0.267045259475708
generate_one_block  0.26657533645629883
generate_one_block  0.2676999568939209
generate_one_block  0.2651858329772949
generate_one_block  0.2632319927215576
generate_one_block  0.264040470123291
generate_one_block  0.27071523666381836
generate_one_block  0.2749476432800293
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03162121772766113
gen group dst list time:  0.06135272979736328
time for parepare:  0.017743349075317383
local_output_nid generation:  0.027351856231689453
local_in_edges_tensor generation:  0.040860652923583984
mini_batch_src_global generation:  0.041545867919921875
r_  generation:  0.446422815322876
local_output_nid generation:  0.031754493713378906
local_in_edges_tensor generation:  0.032330989837646484
mini_batch_src_global generation:  0.05164837837219238
r_  generation:  0.45404863357543945
local_output_nid generation:  0.031594038009643555
local_in_edges_tensor generation:  0.0296785831451416
mini_batch_src_global generation:  0.05060935020446777
r_  generation:  0.4544041156768799
local_output_nid generation:  0.03166627883911133
local_in_edges_tensor generation:  0.033174753189086914
mini_batch_src_global generation:  0.0523378849029541
r_  generation:  0.45301079750061035
local_output_nid generation:  0.03174257278442383
local_in_edges_tensor generation:  0.07104015350341797
mini_batch_src_global generation:  0.05126547813415527
r_  generation:  0.4542973041534424
local_output_nid generation:  0.03372788429260254
local_in_edges_tensor generation:  0.03093886375427246
mini_batch_src_global generation:  0.05261635780334473
r_  generation:  0.45395922660827637
local_output_nid generation:  0.031599998474121094
local_in_edges_tensor generation:  0.03238797187805176
mini_batch_src_global generation:  0.05186152458190918
r_  generation:  0.4587562084197998
local_output_nid generation:  0.03126239776611328
local_in_edges_tensor generation:  0.03092193603515625
mini_batch_src_global generation:  0.05213117599487305
r_  generation:  0.449368953704834
local_output_nid generation:  0.03149914741516113
local_in_edges_tensor generation:  0.02916693687438965
mini_batch_src_global generation:  0.05166172981262207
r_  generation:  0.45917439460754395
local_output_nid generation:  0.03137683868408203
local_in_edges_tensor generation:  0.02928328514099121
mini_batch_src_global generation:  0.05326223373413086
r_  generation:  0.45121335983276367
local_output_nid generation:  0.03149247169494629
local_in_edges_tensor generation:  0.02968740463256836
mini_batch_src_global generation:  0.05201387405395508
r_  generation:  0.4579765796661377
local_output_nid generation:  0.03141498565673828
local_in_edges_tensor generation:  0.031025409698486328
mini_batch_src_global generation:  0.05356025695800781
r_  generation:  0.45279526710510254
local_output_nid generation:  0.031844377517700195
local_in_edges_tensor generation:  0.030374765396118164
mini_batch_src_global generation:  0.0538177490234375
r_  generation:  0.45716047286987305
local_output_nid generation:  0.03166961669921875
local_in_edges_tensor generation:  0.031158447265625
mini_batch_src_global generation:  0.053150177001953125
r_  generation:  0.45467209815979004
local_output_nid generation:  0.031685590744018555
local_in_edges_tensor generation:  0.03133535385131836
mini_batch_src_global generation:  0.05252885818481445
r_  generation:  0.4604527950286865
local_output_nid generation:  0.031903982162475586
local_in_edges_tensor generation:  0.03520703315734863
mini_batch_src_global generation:  0.06490540504455566
r_  generation:  0.4568171501159668
----------------------check_connections_block total spend ----------------------------- 10.742106199264526
generate_one_block  0.5725364685058594
generate_one_block  0.5714354515075684
generate_one_block  0.5900509357452393
generate_one_block  0.5761001110076904
generate_one_block  0.5715031623840332
generate_one_block  0.5751297473907471
generate_one_block  0.5729858875274658
generate_one_block  0.5740101337432861
generate_one_block  0.6358122825622559
generate_one_block  0.5730655193328857
generate_one_block  0.575737476348877
generate_one_block  0.5745525360107422
generate_one_block  0.5735692977905273
generate_one_block  0.583829402923584
generate_one_block  0.5800137519836426
generate_one_block  0.5869648456573486
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11501884460449219  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

connection checking time:  15.698576211929321
block generation total time  13.599973917007446
average batch blocks generation time:  0.8499983698129654
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09382963180541992  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7161173820495605  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09320068359375  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7162699699401855  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09392166137695312  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7182645797729492  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0935220718383789  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7210550308227539  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09389877319335938  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7174458503723145  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09319734573364258  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7161684036254883  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09403228759765625  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.720703125  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0933685302734375  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7178902626037598  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09391307830810547  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.719144344329834  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09328508377075195  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7165813446044922  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09390068054199219  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7181973457336426  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09329414367675781  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7160234451293945  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09373950958251953  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7109541893005371  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09320735931396484  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7150516510009766  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09392452239990234  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7187366485595703  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09366798400878906  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7239775657653809  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06346350908279419 |0.012235596776008606 |0.003709927201271057 |9.480118751525879e-05 |0.003594815731048584 |0.0015001296997070312 |
----------------------------------------------------------pseudo_mini_loss sum 1.8687984943389893
 Run 0| Epoch 6 |
Number of nodes for computation during this epoch:  5091672
Number of first layer input nodes during this epoch:  2472014
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11567926406860352  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02181077003479004
random selection method range initialization spend 0.0055675506591796875
time for parepare:  0.020926713943481445
local_output_nid generation:  0.0023293495178222656
local_in_edges_tensor generation:  0.007615327835083008
mini_batch_src_global generation:  0.001999378204345703
r_  generation:  0.018873214721679688
local_output_nid generation:  0.0029311180114746094
local_in_edges_tensor generation:  0.0017206668853759766
mini_batch_src_global generation:  0.0020804405212402344
r_  generation:  0.01981329917907715
local_output_nid generation:  0.0029664039611816406
local_in_edges_tensor generation:  0.0017266273498535156
mini_batch_src_global generation:  0.001489400863647461
r_  generation:  0.01855778694152832
local_output_nid generation:  0.002979278564453125
local_in_edges_tensor generation:  0.0016551017761230469
mini_batch_src_global generation:  0.0015168190002441406
r_  generation:  0.01892852783203125
local_output_nid generation:  0.0029561519622802734
local_in_edges_tensor generation:  0.0016024112701416016
mini_batch_src_global generation:  0.0015120506286621094
r_  generation:  0.019345998764038086
local_output_nid generation:  0.0029439926147460938
local_in_edges_tensor generation:  0.0015423297882080078
mini_batch_src_global generation:  0.0015773773193359375
r_  generation:  0.019634485244750977
local_output_nid generation:  0.0029370784759521484
local_in_edges_tensor generation:  0.0015697479248046875
mini_batch_src_global generation:  0.0015480518341064453
r_  generation:  0.01969122886657715
local_output_nid generation:  0.0030117034912109375
local_in_edges_tensor generation:  0.0016238689422607422
mini_batch_src_global generation:  0.0015811920166015625
r_  generation:  0.019210338592529297
local_output_nid generation:  0.003020763397216797
local_in_edges_tensor generation:  0.0015892982482910156
mini_batch_src_global generation:  0.0015304088592529297
r_  generation:  0.019421815872192383
local_output_nid generation:  0.002994537353515625
local_in_edges_tensor generation:  0.0015213489532470703
mini_batch_src_global generation:  0.0015954971313476562
r_  generation:  0.019293546676635742
local_output_nid generation:  0.002948284149169922
local_in_edges_tensor generation:  0.0015060901641845703
mini_batch_src_global generation:  0.0015804767608642578
r_  generation:  0.01978015899658203
local_output_nid generation:  0.0029892921447753906
local_in_edges_tensor generation:  0.0015044212341308594
mini_batch_src_global generation:  0.0015518665313720703
r_  generation:  0.01940011978149414
local_output_nid generation:  0.0029642581939697266
local_in_edges_tensor generation:  0.0014905929565429688
mini_batch_src_global generation:  0.0015439987182617188
r_  generation:  0.019572019577026367
local_output_nid generation:  0.0029754638671875
local_in_edges_tensor generation:  0.0014765262603759766
mini_batch_src_global generation:  0.001623392105102539
r_  generation:  0.019930601119995117
local_output_nid generation:  0.0029687881469726562
local_in_edges_tensor generation:  0.0015444755554199219
mini_batch_src_global generation:  0.0015594959259033203
r_  generation:  0.019420385360717773
local_output_nid generation:  0.002980470657348633
local_in_edges_tensor generation:  0.00148773193359375
mini_batch_src_global generation:  0.0015532970428466797
r_  generation:  0.01960897445678711
----------------------check_connections_block total spend ----------------------------- 0.5195620059967041
generate_one_block  0.035529375076293945
generate_one_block  0.02851557731628418
generate_one_block  0.027291059494018555
generate_one_block  0.027741193771362305
generate_one_block  0.02784442901611328
generate_one_block  0.031125307083129883
generate_one_block  0.02800774574279785
generate_one_block  0.0274813175201416
generate_one_block  0.027858734130859375
generate_one_block  0.027650117874145508
generate_one_block  0.02814483642578125
generate_one_block  0.027566194534301758
generate_one_block  0.027918338775634766
generate_one_block  0.028520822525024414
generate_one_block  0.027668237686157227
generate_one_block  0.028390884399414062
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0354619026184082
gen group dst list time:  0.016969680786132812
time for parepare:  0.01951003074645996
local_output_nid generation:  0.008411884307861328
local_in_edges_tensor generation:  0.023380756378173828
mini_batch_src_global generation:  0.020238876342773438
r_  generation:  0.1943192481994629
local_output_nid generation:  0.012141227722167969
local_in_edges_tensor generation:  0.015241861343383789
mini_batch_src_global generation:  0.02410888671875
r_  generation:  0.20268917083740234
local_output_nid generation:  0.012235164642333984
local_in_edges_tensor generation:  0.014611482620239258
mini_batch_src_global generation:  0.02379918098449707
r_  generation:  0.20183348655700684
local_output_nid generation:  0.012734651565551758
local_in_edges_tensor generation:  0.012813091278076172
mini_batch_src_global generation:  0.024185657501220703
r_  generation:  0.20862221717834473
local_output_nid generation:  0.01241159439086914
local_in_edges_tensor generation:  0.01316523551940918
mini_batch_src_global generation:  0.025409698486328125
r_  generation:  0.20946884155273438
local_output_nid generation:  0.012281656265258789
local_in_edges_tensor generation:  0.013467788696289062
mini_batch_src_global generation:  0.025731325149536133
r_  generation:  0.21173572540283203
local_output_nid generation:  0.012748956680297852
local_in_edges_tensor generation:  0.013165712356567383
mini_batch_src_global generation:  0.026140451431274414
r_  generation:  0.21001386642456055
local_output_nid generation:  0.012603282928466797
local_in_edges_tensor generation:  0.012360334396362305
mini_batch_src_global generation:  0.037577152252197266
r_  generation:  0.20738959312438965
local_output_nid generation:  0.012761592864990234
local_in_edges_tensor generation:  0.012609481811523438
mini_batch_src_global generation:  0.026232004165649414
r_  generation:  0.21188569068908691
local_output_nid generation:  0.012780189514160156
local_in_edges_tensor generation:  0.013226509094238281
mini_batch_src_global generation:  0.026566743850708008
r_  generation:  0.21032190322875977
local_output_nid generation:  0.012722015380859375
local_in_edges_tensor generation:  0.012284040451049805
mini_batch_src_global generation:  0.027767419815063477
r_  generation:  0.21203184127807617
local_output_nid generation:  0.01263284683227539
local_in_edges_tensor generation:  0.013944387435913086
mini_batch_src_global generation:  0.026042938232421875
r_  generation:  0.21155428886413574
local_output_nid generation:  0.01265096664428711
local_in_edges_tensor generation:  0.012862443923950195
mini_batch_src_global generation:  0.026172876358032227
r_  generation:  0.21219563484191895
local_output_nid generation:  0.012994766235351562
local_in_edges_tensor generation:  0.01247262954711914
mini_batch_src_global generation:  0.02761530876159668
r_  generation:  0.2184767723083496
local_output_nid generation:  0.012449264526367188
local_in_edges_tensor generation:  0.012415885925292969
mini_batch_src_global generation:  0.029129505157470703
r_  generation:  0.2147235870361328
local_output_nid generation:  0.01192617416381836
local_in_edges_tensor generation:  0.012436628341674805
mini_batch_src_global generation:  0.028905630111694336
r_  generation:  0.2174978256225586
----------------------check_connections_block total spend ----------------------------- 4.951092481613159
generate_one_block  0.2723376750946045
generate_one_block  0.27025580406188965
generate_one_block  0.2656407356262207
generate_one_block  0.27594971656799316
generate_one_block  0.27474427223205566
generate_one_block  0.2734990119934082
generate_one_block  0.29555320739746094
generate_one_block  0.2624220848083496
generate_one_block  0.26953649520874023
generate_one_block  0.2634127140045166
generate_one_block  0.27049946784973145
generate_one_block  0.2703239917755127
generate_one_block  0.27065563201904297
generate_one_block  0.2732384204864502
generate_one_block  0.27161622047424316
generate_one_block  0.26688551902770996
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03481316566467285
gen group dst list time:  0.06270670890808105
time for parepare:  0.01881241798400879
local_output_nid generation:  0.02684926986694336
local_in_edges_tensor generation:  0.04950547218322754
mini_batch_src_global generation:  0.04029417037963867
r_  generation:  0.4449334144592285
local_output_nid generation:  0.03155684471130371
local_in_edges_tensor generation:  0.04041767120361328
mini_batch_src_global generation:  0.0521693229675293
r_  generation:  0.44635772705078125
local_output_nid generation:  0.03132915496826172
local_in_edges_tensor generation:  0.034796953201293945
mini_batch_src_global generation:  0.05079150199890137
r_  generation:  0.45058655738830566
local_output_nid generation:  0.03186917304992676
local_in_edges_tensor generation:  0.03447389602661133
mini_batch_src_global generation:  0.05230593681335449
r_  generation:  0.45227503776550293
local_output_nid generation:  0.031289100646972656
local_in_edges_tensor generation:  0.07327795028686523
mini_batch_src_global generation:  0.05147266387939453
r_  generation:  0.4590184688568115
local_output_nid generation:  0.03150010108947754
local_in_edges_tensor generation:  0.03109598159790039
mini_batch_src_global generation:  0.054924726486206055
r_  generation:  0.4511399269104004
local_output_nid generation:  0.031048297882080078
local_in_edges_tensor generation:  0.02994561195373535
mini_batch_src_global generation:  0.05140066146850586
r_  generation:  0.45752477645874023
local_output_nid generation:  0.03152966499328613
local_in_edges_tensor generation:  0.031828880310058594
mini_batch_src_global generation:  0.052342891693115234
r_  generation:  0.4706442356109619
local_output_nid generation:  0.03475213050842285
local_in_edges_tensor generation:  0.032582759857177734
mini_batch_src_global generation:  0.053071022033691406
r_  generation:  0.46112704277038574
local_output_nid generation:  0.03200936317443848
local_in_edges_tensor generation:  0.03427624702453613
mini_batch_src_global generation:  0.05301475524902344
r_  generation:  0.45541977882385254
local_output_nid generation:  0.0323786735534668
local_in_edges_tensor generation:  0.030034780502319336
mini_batch_src_global generation:  0.05404782295227051
r_  generation:  0.46161484718322754
local_output_nid generation:  0.03232455253601074
local_in_edges_tensor generation:  0.032193899154663086
mini_batch_src_global generation:  0.05301332473754883
r_  generation:  0.45438170433044434
local_output_nid generation:  0.03200888633728027
local_in_edges_tensor generation:  0.030234813690185547
mini_batch_src_global generation:  0.05168509483337402
r_  generation:  0.4573526382446289
local_output_nid generation:  0.03223061561584473
local_in_edges_tensor generation:  0.037142276763916016
mini_batch_src_global generation:  0.05258011817932129
r_  generation:  0.4527132511138916
local_output_nid generation:  0.032358646392822266
local_in_edges_tensor generation:  0.03200697898864746
mini_batch_src_global generation:  0.051841020584106445
r_  generation:  0.45792436599731445
local_output_nid generation:  0.03195548057556152
local_in_edges_tensor generation:  0.030153274536132812
mini_batch_src_global generation:  0.055362701416015625
r_  generation:  0.4558088779449463
----------------------check_connections_block total spend ----------------------------- 10.797188997268677
generate_one_block  0.5772838592529297
generate_one_block  0.5803477764129639
generate_one_block  0.5739743709564209
generate_one_block  0.5766260623931885
generate_one_block  0.582477331161499
generate_one_block  0.571131706237793
generate_one_block  0.5708818435668945
generate_one_block  0.575040340423584
generate_one_block  0.6190669536590576
generate_one_block  0.5764389038085938
generate_one_block  0.5766215324401855
generate_one_block  0.5787663459777832
generate_one_block  0.583716630935669
generate_one_block  0.5849437713623047
generate_one_block  0.6002452373504639
generate_one_block  0.5765366554260254
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11567926406860352  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

connection checking time:  15.748281478881836
block generation total time  13.650670289993286
average batch blocks generation time:  0.8531668931245804
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0939936637878418  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7197360992431641  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.093414306640625  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7194504737854004  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09375667572021484  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7150239944458008  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09346961975097656  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7187938690185547  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09396171569824219  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7185602188110352  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09317970275878906  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7142229080200195  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09387493133544922  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7124066352844238  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09315109252929688  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7146463394165039  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09390830993652344  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7176222801208496  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09334850311279297  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7159996032714844  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09389305114746094  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7189555168151855  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09331846237182617  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.716583251953125  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09387016296386719  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7170734405517578  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09338951110839844  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.719886302947998  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09392070770263672  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7179594039916992  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09327936172485352  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7171764373779297  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.059891074895858765 |0.012281596660614014 |0.0036008358001708984 |9.579956531524658e-05 |0.003165796399116516 |0.0013766288757324219 |
----------------------------------------------------------pseudo_mini_loss sum 1.7921016216278076
 Run 0| Epoch 7 |
Number of nodes for computation during this epoch:  5090214
Number of first layer input nodes during this epoch:  2471289
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11503124237060547  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020143508911132812
random selection method range initialization spend 0.0053920745849609375
time for parepare:  0.018820762634277344
local_output_nid generation:  0.0023605823516845703
local_in_edges_tensor generation:  0.00680232048034668
mini_batch_src_global generation:  0.0015881061553955078
r_  generation:  0.018204689025878906
local_output_nid generation:  0.002902984619140625
local_in_edges_tensor generation:  0.0017290115356445312
mini_batch_src_global generation:  0.0018434524536132812
r_  generation:  0.01957845687866211
local_output_nid generation:  0.0029120445251464844
local_in_edges_tensor generation:  0.0018360614776611328
mini_batch_src_global generation:  0.0014982223510742188
r_  generation:  0.019007205963134766
local_output_nid generation:  0.0029647350311279297
local_in_edges_tensor generation:  0.0017061233520507812
mini_batch_src_global generation:  0.0015087127685546875
r_  generation:  0.0189206600189209
local_output_nid generation:  0.002916574478149414
local_in_edges_tensor generation:  0.0016376972198486328
mini_batch_src_global generation:  0.0015783309936523438
r_  generation:  0.019678115844726562
local_output_nid generation:  0.0029675960540771484
local_in_edges_tensor generation:  0.0016560554504394531
mini_batch_src_global generation:  0.0016489028930664062
r_  generation:  0.019509553909301758
local_output_nid generation:  0.0029659271240234375
local_in_edges_tensor generation:  0.001641988754272461
mini_batch_src_global generation:  0.001561880111694336
r_  generation:  0.019885778427124023
local_output_nid generation:  0.002964019775390625
local_in_edges_tensor generation:  0.0015659332275390625
mini_batch_src_global generation:  0.0015485286712646484
r_  generation:  0.01956343650817871
local_output_nid generation:  0.0030350685119628906
local_in_edges_tensor generation:  0.0015881061553955078
mini_batch_src_global generation:  0.0015969276428222656
r_  generation:  0.019797086715698242
local_output_nid generation:  0.00302886962890625
local_in_edges_tensor generation:  0.0016589164733886719
mini_batch_src_global generation:  0.001558065414428711
r_  generation:  0.019940614700317383
local_output_nid generation:  0.003000497817993164
local_in_edges_tensor generation:  0.001547098159790039
mini_batch_src_global generation:  0.001585245132446289
r_  generation:  0.019367694854736328
local_output_nid generation:  0.002959728240966797
local_in_edges_tensor generation:  0.0015606880187988281
mini_batch_src_global generation:  0.0015578269958496094
r_  generation:  0.01953601837158203
local_output_nid generation:  0.0029518604278564453
local_in_edges_tensor generation:  0.001565694808959961
mini_batch_src_global generation:  0.0015964508056640625
r_  generation:  0.02081155776977539
local_output_nid generation:  0.0029566287994384766
local_in_edges_tensor generation:  0.0015327930450439453
mini_batch_src_global generation:  0.0015957355499267578
r_  generation:  0.019667863845825195
local_output_nid generation:  0.002975940704345703
local_in_edges_tensor generation:  0.0015664100646972656
mini_batch_src_global generation:  0.001554250717163086
r_  generation:  0.019837617874145508
local_output_nid generation:  0.0029554367065429688
local_in_edges_tensor generation:  0.001535177230834961
mini_batch_src_global generation:  0.0015757083892822266
r_  generation:  0.019355297088623047
----------------------check_connections_block total spend ----------------------------- 0.517101526260376
generate_one_block  0.0267641544342041
generate_one_block  0.027982473373413086
generate_one_block  0.027524709701538086
generate_one_block  0.027492761611938477
generate_one_block  0.028418302536010742
generate_one_block  0.030860185623168945
generate_one_block  0.028352022171020508
generate_one_block  0.027689695358276367
generate_one_block  0.02785015106201172
generate_one_block  0.02794671058654785
generate_one_block  0.027065277099609375
generate_one_block  0.027482032775878906
generate_one_block  0.028434276580810547
generate_one_block  0.027729511260986328
generate_one_block  0.027672290802001953
generate_one_block  0.02882528305053711
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05601644515991211
gen group dst list time:  0.02180767059326172
time for parepare:  0.01981806755065918
local_output_nid generation:  0.008430719375610352
local_in_edges_tensor generation:  0.028947830200195312
mini_batch_src_global generation:  0.019982099533081055
r_  generation:  0.2310793399810791
local_output_nid generation:  0.012231588363647461
local_in_edges_tensor generation:  0.015378236770629883
mini_batch_src_global generation:  0.028241395950317383
r_  generation:  0.20395922660827637
local_output_nid generation:  0.012414216995239258
local_in_edges_tensor generation:  0.013561487197875977
mini_batch_src_global generation:  0.02609992027282715
r_  generation:  0.20859861373901367
local_output_nid generation:  0.012870073318481445
local_in_edges_tensor generation:  0.012640237808227539
mini_batch_src_global generation:  0.026945114135742188
r_  generation:  0.21630072593688965
local_output_nid generation:  0.013103246688842773
local_in_edges_tensor generation:  0.014833211898803711
mini_batch_src_global generation:  0.02893209457397461
r_  generation:  0.2204146385192871
local_output_nid generation:  0.012510299682617188
local_in_edges_tensor generation:  0.013507604598999023
mini_batch_src_global generation:  0.03060770034790039
r_  generation:  0.22182559967041016
local_output_nid generation:  0.012993574142456055
local_in_edges_tensor generation:  0.011941194534301758
mini_batch_src_global generation:  0.029851675033569336
r_  generation:  0.220322847366333
local_output_nid generation:  0.013075590133666992
local_in_edges_tensor generation:  0.012208700180053711
mini_batch_src_global generation:  0.027119159698486328
r_  generation:  0.21648931503295898
local_output_nid generation:  0.012865066528320312
local_in_edges_tensor generation:  0.01200723648071289
mini_batch_src_global generation:  0.027750253677368164
r_  generation:  0.21889138221740723
local_output_nid generation:  0.012906551361083984
local_in_edges_tensor generation:  0.011980533599853516
mini_batch_src_global generation:  0.028689146041870117
r_  generation:  0.22460317611694336
local_output_nid generation:  0.01266169548034668
local_in_edges_tensor generation:  0.014302968978881836
mini_batch_src_global generation:  0.027546167373657227
r_  generation:  0.2162327766418457
local_output_nid generation:  0.01262664794921875
local_in_edges_tensor generation:  0.011675119400024414
mini_batch_src_global generation:  0.02714252471923828
r_  generation:  0.2207930088043213
local_output_nid generation:  0.012835264205932617
local_in_edges_tensor generation:  0.011917829513549805
mini_batch_src_global generation:  0.027901887893676758
r_  generation:  0.23064684867858887
local_output_nid generation:  0.012763023376464844
local_in_edges_tensor generation:  0.012152910232543945
mini_batch_src_global generation:  0.02740478515625
r_  generation:  0.22379183769226074
local_output_nid generation:  0.012621402740478516
local_in_edges_tensor generation:  0.01168680191040039
mini_batch_src_global generation:  0.027736902236938477
r_  generation:  0.2238621711730957
local_output_nid generation:  0.012051105499267578
local_in_edges_tensor generation:  0.013006925582885742
mini_batch_src_global generation:  0.02712535858154297
r_  generation:  0.22317147254943848
----------------------check_connections_block total spend ----------------------------- 5.182348251342773
generate_one_block  0.28192996978759766
generate_one_block  0.26746273040771484
generate_one_block  0.26819705963134766
generate_one_block  0.267780065536499
generate_one_block  0.27306175231933594
generate_one_block  0.27658557891845703
generate_one_block  0.2940707206726074
generate_one_block  0.2666754722595215
generate_one_block  0.2735469341278076
generate_one_block  0.2841663360595703
generate_one_block  0.27306556701660156
generate_one_block  0.2682511806488037
generate_one_block  0.27483034133911133
generate_one_block  0.2683680057525635
generate_one_block  0.26971864700317383
generate_one_block  0.26555323600769043
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.038324594497680664
gen group dst list time:  0.07680463790893555
time for parepare:  0.018416404724121094
local_output_nid generation:  0.02712702751159668
local_in_edges_tensor generation:  0.05512523651123047
mini_batch_src_global generation:  0.05254554748535156
r_  generation:  0.465686559677124
local_output_nid generation:  0.0322263240814209
local_in_edges_tensor generation:  0.04323935508728027
mini_batch_src_global generation:  0.0555424690246582
r_  generation:  0.4596216678619385
local_output_nid generation:  0.033788204193115234
local_in_edges_tensor generation:  0.03799557685852051
mini_batch_src_global generation:  0.06314349174499512
r_  generation:  0.4710671901702881
local_output_nid generation:  0.0342864990234375
local_in_edges_tensor generation:  0.03594374656677246
mini_batch_src_global generation:  0.05255270004272461
r_  generation:  0.4522719383239746
local_output_nid generation:  0.032451629638671875
local_in_edges_tensor generation:  0.08723735809326172
mini_batch_src_global generation:  0.054032325744628906
r_  generation:  0.4682893753051758
local_output_nid generation:  0.0315394401550293
local_in_edges_tensor generation:  0.030449628829956055
mini_batch_src_global generation:  0.05401802062988281
r_  generation:  0.4610145092010498
local_output_nid generation:  0.03127169609069824
local_in_edges_tensor generation:  0.03306722640991211
mini_batch_src_global generation:  0.05337810516357422
r_  generation:  0.46654677391052246
local_output_nid generation:  0.03146934509277344
local_in_edges_tensor generation:  0.03153085708618164
mini_batch_src_global generation:  0.054292917251586914
r_  generation:  0.45815181732177734
local_output_nid generation:  0.031197786331176758
local_in_edges_tensor generation:  0.029219627380371094
mini_batch_src_global generation:  0.05344128608703613
r_  generation:  0.4745497703552246
local_output_nid generation:  0.03162336349487305
local_in_edges_tensor generation:  0.03233599662780762
mini_batch_src_global generation:  0.05581021308898926
r_  generation:  0.4631931781768799
local_output_nid generation:  0.032483577728271484
local_in_edges_tensor generation:  0.034656524658203125
mini_batch_src_global generation:  0.05331540107727051
r_  generation:  0.47373127937316895
local_output_nid generation:  0.03190732002258301
local_in_edges_tensor generation:  0.03328561782836914
mini_batch_src_global generation:  0.05536603927612305
r_  generation:  0.4581575393676758
local_output_nid generation:  0.03174185752868652
local_in_edges_tensor generation:  0.03314471244812012
mini_batch_src_global generation:  0.0552065372467041
r_  generation:  0.4771270751953125
local_output_nid generation:  0.03416585922241211
local_in_edges_tensor generation:  0.03567218780517578
mini_batch_src_global generation:  0.05301070213317871
r_  generation:  0.45173048973083496
local_output_nid generation:  0.03226423263549805
local_in_edges_tensor generation:  0.030533552169799805
mini_batch_src_global generation:  0.051308631896972656
r_  generation:  0.4611783027648926
local_output_nid generation:  0.03213620185852051
local_in_edges_tensor generation:  0.028863191604614258
mini_batch_src_global generation:  0.052686214447021484
r_  generation:  0.4532651901245117
----------------------check_connections_block total spend ----------------------------- 11.079161643981934
generate_one_block  0.5810446739196777
generate_one_block  0.595759391784668
generate_one_block  0.581474781036377
generate_one_block  0.5825889110565186
generate_one_block  0.5797946453094482
generate_one_block  0.587012767791748
generate_one_block  0.5838978290557861
generate_one_block  0.5848443508148193
generate_one_block  0.651921272277832
generate_one_block  0.5971930027008057
generate_one_block  0.5833940505981445
generate_one_block  0.580700159072876
generate_one_block  0.5845019817352295
generate_one_block  0.576268196105957
generate_one_block  0.580143928527832
generate_one_block  0.5798218250274658
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11503124237060547  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

connection checking time:  16.261509895324707
block generation total time  13.783625364303589
average batch blocks generation time:  0.8614765852689743
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09383344650268555  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7154788970947266  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0933222770690918  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7170958518981934  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09383869171142578  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.718167781829834  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09304428100585938  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7125911712646484  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09401702880859375  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7208366394042969  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0936436653137207  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7210373878479004  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0939474105834961  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7188601493835449  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0934295654296875  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7180986404418945  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09394454956054688  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.718513011932373  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0936117172241211  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.722531795501709  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09378910064697266  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7148942947387695  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09334135055541992  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7166018486022949  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09402084350585938  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.720008373260498  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09318256378173828  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7161006927490234  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09387969970703125  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7181081771850586  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09312152862548828  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7147769927978516  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0593571662902832 |0.01310710608959198 |0.0035884976387023926 |9.472668170928955e-05 |0.003036871552467346 |0.0031838417053222656 |
----------------------------------------------------------pseudo_mini_loss sum 1.7067389488220215
 Run 0| Epoch 8 |
Number of nodes for computation during this epoch:  5091768
Number of first layer input nodes during this epoch:  2471878
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11460638046264648  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021729230880737305
random selection method range initialization spend 0.0054852962493896484
time for parepare:  0.01925182342529297
local_output_nid generation:  0.0022842884063720703
local_in_edges_tensor generation:  0.007891654968261719
mini_batch_src_global generation:  0.0016789436340332031
r_  generation:  0.019037485122680664
local_output_nid generation:  0.0028672218322753906
local_in_edges_tensor generation:  0.0016770362854003906
mini_batch_src_global generation:  0.001903533935546875
r_  generation:  0.019670486450195312
local_output_nid generation:  0.002959012985229492
local_in_edges_tensor generation:  0.0016715526580810547
mini_batch_src_global generation:  0.0015766620635986328
r_  generation:  0.019031524658203125
local_output_nid generation:  0.0029706954956054688
local_in_edges_tensor generation:  0.0016210079193115234
mini_batch_src_global generation:  0.0016551017761230469
r_  generation:  0.01944279670715332
local_output_nid generation:  0.002975940704345703
local_in_edges_tensor generation:  0.0015637874603271484
mini_batch_src_global generation:  0.0016255378723144531
r_  generation:  0.019351720809936523
local_output_nid generation:  0.002981901168823242
local_in_edges_tensor generation:  0.0016644001007080078
mini_batch_src_global generation:  0.0016508102416992188
r_  generation:  0.019440650939941406
local_output_nid generation:  0.0029926300048828125
local_in_edges_tensor generation:  0.0015785694122314453
mini_batch_src_global generation:  0.0016314983367919922
r_  generation:  0.019955873489379883
local_output_nid generation:  0.003000974655151367
local_in_edges_tensor generation:  0.0016415119171142578
mini_batch_src_global generation:  0.0016012191772460938
r_  generation:  0.02008223533630371
local_output_nid generation:  0.00298309326171875
local_in_edges_tensor generation:  0.0015785694122314453
mini_batch_src_global generation:  0.0016524791717529297
r_  generation:  0.01931595802307129
local_output_nid generation:  0.0030052661895751953
local_in_edges_tensor generation:  0.0015726089477539062
mini_batch_src_global generation:  0.0016045570373535156
r_  generation:  0.019578933715820312
local_output_nid generation:  0.0029478073120117188
local_in_edges_tensor generation:  0.0015947818756103516
mini_batch_src_global generation:  0.001638174057006836
r_  generation:  0.019774675369262695
local_output_nid generation:  0.0029680728912353516
local_in_edges_tensor generation:  0.0015530586242675781
mini_batch_src_global generation:  0.0016169548034667969
r_  generation:  0.01945328712463379
local_output_nid generation:  0.0029540061950683594
local_in_edges_tensor generation:  0.0015025138854980469
mini_batch_src_global generation:  0.0015590190887451172
r_  generation:  0.020227432250976562
local_output_nid generation:  0.0029838085174560547
local_in_edges_tensor generation:  0.0015625953674316406
mini_batch_src_global generation:  0.001627206802368164
r_  generation:  0.019492626190185547
local_output_nid generation:  0.003019571304321289
local_in_edges_tensor generation:  0.0016314983367919922
mini_batch_src_global generation:  0.0016450881958007812
r_  generation:  0.019566774368286133
local_output_nid generation:  0.002991199493408203
local_in_edges_tensor generation:  0.001508474349975586
mini_batch_src_global generation:  0.0016469955444335938
r_  generation:  0.01928234100341797
----------------------check_connections_block total spend ----------------------------- 0.5181279182434082
generate_one_block  0.03571677207946777
generate_one_block  0.027954816818237305
generate_one_block  0.0276641845703125
generate_one_block  0.028118371963500977
generate_one_block  0.02773571014404297
generate_one_block  0.030909061431884766
generate_one_block  0.02844524383544922
generate_one_block  0.02795720100402832
generate_one_block  0.02782750129699707
generate_one_block  0.02780747413635254
generate_one_block  0.027593374252319336
generate_one_block  0.027374267578125
generate_one_block  0.028717041015625
generate_one_block  0.02762603759765625
generate_one_block  0.027943134307861328
generate_one_block  0.02809000015258789
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03916049003601074
gen group dst list time:  0.016207456588745117
time for parepare:  0.020519256591796875
local_output_nid generation:  0.00863790512084961
local_in_edges_tensor generation:  0.023192644119262695
mini_batch_src_global generation:  0.01960134506225586
r_  generation:  0.19768190383911133
local_output_nid generation:  0.012194156646728516
local_in_edges_tensor generation:  0.014672279357910156
mini_batch_src_global generation:  0.026995182037353516
r_  generation:  0.20206713676452637
local_output_nid generation:  0.012418270111083984
local_in_edges_tensor generation:  0.018155574798583984
mini_batch_src_global generation:  0.028617382049560547
r_  generation:  0.20758318901062012
local_output_nid generation:  0.012868165969848633
local_in_edges_tensor generation:  0.013196468353271484
mini_batch_src_global generation:  0.025365829467773438
r_  generation:  0.21914291381835938
local_output_nid generation:  0.013532161712646484
local_in_edges_tensor generation:  0.014942169189453125
mini_batch_src_global generation:  0.026791810989379883
r_  generation:  0.21490716934204102
local_output_nid generation:  0.012437820434570312
local_in_edges_tensor generation:  0.013955116271972656
mini_batch_src_global generation:  0.025474071502685547
r_  generation:  0.21893858909606934
local_output_nid generation:  0.014283418655395508
local_in_edges_tensor generation:  0.013172149658203125
mini_batch_src_global generation:  0.02604079246520996
r_  generation:  0.21392536163330078
local_output_nid generation:  0.013314008712768555
local_in_edges_tensor generation:  0.01419830322265625
mini_batch_src_global generation:  0.027546405792236328
r_  generation:  0.2153773307800293
local_output_nid generation:  0.013230323791503906
local_in_edges_tensor generation:  0.01200103759765625
mini_batch_src_global generation:  0.026326894760131836
r_  generation:  0.21234869956970215
local_output_nid generation:  0.01302957534790039
local_in_edges_tensor generation:  0.011950016021728516
mini_batch_src_global generation:  0.025772571563720703
r_  generation:  0.24344158172607422
local_output_nid generation:  0.01316380500793457
local_in_edges_tensor generation:  0.011564016342163086
mini_batch_src_global generation:  0.02752852439880371
r_  generation:  0.25008344650268555
local_output_nid generation:  0.015565872192382812
local_in_edges_tensor generation:  0.011675834655761719
mini_batch_src_global generation:  0.030346393585205078
r_  generation:  0.21039700508117676
local_output_nid generation:  0.013356447219848633
local_in_edges_tensor generation:  0.012470483779907227
mini_batch_src_global generation:  0.027539730072021484
r_  generation:  0.22082781791687012
local_output_nid generation:  0.012976646423339844
local_in_edges_tensor generation:  0.01176595687866211
mini_batch_src_global generation:  0.026400089263916016
r_  generation:  0.2263484001159668
local_output_nid generation:  0.012974739074707031
local_in_edges_tensor generation:  0.012480497360229492
mini_batch_src_global generation:  0.02771925926208496
r_  generation:  0.21899032592773438
local_output_nid generation:  0.012416839599609375
local_in_edges_tensor generation:  0.017061710357666016
mini_batch_src_global generation:  0.027010679244995117
r_  generation:  0.2182457447052002
----------------------check_connections_block total spend ----------------------------- 5.134887218475342
generate_one_block  0.2860836982727051
generate_one_block  0.27109861373901367
generate_one_block  0.2738070487976074
generate_one_block  0.27898502349853516
generate_one_block  0.2668795585632324
generate_one_block  0.2671658992767334
generate_one_block  0.2993736267089844
generate_one_block  0.27132606506347656
generate_one_block  0.26351070404052734
generate_one_block  0.2660367488861084
generate_one_block  0.26746582984924316
generate_one_block  0.2622182369232178
generate_one_block  0.2820875644683838
generate_one_block  0.2774829864501953
generate_one_block  0.28468918800354004
generate_one_block  0.2776360511779785
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03437018394470215
gen group dst list time:  0.06426429748535156
time for parepare:  0.018551111221313477
local_output_nid generation:  0.02704477310180664
local_in_edges_tensor generation:  0.049088478088378906
mini_batch_src_global generation:  0.04202103614807129
r_  generation:  0.4522974491119385
local_output_nid generation:  0.03339362144470215
local_in_edges_tensor generation:  0.03725695610046387
mini_batch_src_global generation:  0.05216503143310547
r_  generation:  0.45119714736938477
local_output_nid generation:  0.0322263240814209
local_in_edges_tensor generation:  0.0409083366394043
mini_batch_src_global generation:  0.05291581153869629
r_  generation:  0.46223974227905273
local_output_nid generation:  0.03234410285949707
local_in_edges_tensor generation:  0.03132486343383789
mini_batch_src_global generation:  0.056261301040649414
r_  generation:  0.4673793315887451
local_output_nid generation:  0.03390383720397949
local_in_edges_tensor generation:  0.08385753631591797
mini_batch_src_global generation:  0.0522000789642334
r_  generation:  0.45752382278442383
local_output_nid generation:  0.03126192092895508
local_in_edges_tensor generation:  0.029280424118041992
mini_batch_src_global generation:  0.05267524719238281
r_  generation:  0.453693151473999
local_output_nid generation:  0.03172707557678223
local_in_edges_tensor generation:  0.034519195556640625
mini_batch_src_global generation:  0.06321310997009277
r_  generation:  0.46308302879333496
local_output_nid generation:  0.03154110908508301
local_in_edges_tensor generation:  0.02919292449951172
mini_batch_src_global generation:  0.052870988845825195
r_  generation:  0.45328640937805176
local_output_nid generation:  0.03176379203796387
local_in_edges_tensor generation:  0.031763553619384766
mini_batch_src_global generation:  0.05142927169799805
r_  generation:  0.46091318130493164
local_output_nid generation:  0.03167366981506348
local_in_edges_tensor generation:  0.028834104537963867
mini_batch_src_global generation:  0.054529428482055664
r_  generation:  0.4536771774291992
local_output_nid generation:  0.031821489334106445
local_in_edges_tensor generation:  0.03276467323303223
mini_batch_src_global generation:  0.05293130874633789
r_  generation:  0.46216654777526855
local_output_nid generation:  0.03250551223754883
local_in_edges_tensor generation:  0.03605222702026367
mini_batch_src_global generation:  0.052510976791381836
r_  generation:  0.45288705825805664
local_output_nid generation:  0.032581329345703125
local_in_edges_tensor generation:  0.033046722412109375
mini_batch_src_global generation:  0.0555109977722168
r_  generation:  0.4633321762084961
local_output_nid generation:  0.03189682960510254
local_in_edges_tensor generation:  0.03656005859375
mini_batch_src_global generation:  0.05341219902038574
r_  generation:  0.46984076499938965
local_output_nid generation:  0.03366446495056152
local_in_edges_tensor generation:  0.0314030647277832
mini_batch_src_global generation:  0.05767083168029785
r_  generation:  0.4622781276702881
local_output_nid generation:  0.033637285232543945
local_in_edges_tensor generation:  0.033139944076538086
mini_batch_src_global generation:  0.056127071380615234
r_  generation:  0.45488882064819336
----------------------check_connections_block total spend ----------------------------- 10.920310497283936
generate_one_block  0.5866062641143799
generate_one_block  0.5771582126617432
generate_one_block  0.5779266357421875
generate_one_block  0.5789957046508789
generate_one_block  0.5864541530609131
generate_one_block  0.5769917964935303
generate_one_block  0.579535722732544
generate_one_block  0.583946704864502
generate_one_block  0.6113986968994141
generate_one_block  0.5815062522888184
generate_one_block  0.5771121978759766
generate_one_block  0.5757977962493896
generate_one_block  0.5934844017028809
generate_one_block  0.5769500732421875
generate_one_block  0.5805470943450928
generate_one_block  0.583763837814331
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11460638046264648  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

connection checking time:  16.055197715759277
block generation total time  13.724022388458252
average batch blocks generation time:  0.8577513992786407
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0940394401550293  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7234592437744141  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09325933456420898  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.714958667755127  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0938558578491211  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7165837287902832  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09349632263183594  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7197084426879883  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.093841552734375  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7128229141235352  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09329366683959961  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7167015075683594  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09394168853759766  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7202181816101074  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09354114532470703  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7205061912536621  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09384632110595703  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7169394493103027  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0934453010559082  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7168207168579102  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09390926361083984  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7192854881286621  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09316396713256836  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7144184112548828  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09415817260742188  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7245349884033203  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09317874908447266  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7145466804504395  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0939178466796875  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7184829711914062  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09351396560668945  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7171821594238281  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06237781047821045 |0.011219695210456848 |0.0036583393812179565 |9.423494338989258e-05 |0.003681764006614685 |0.0018048286437988281 |
----------------------------------------------------------pseudo_mini_loss sum 1.6396276950836182
 Run 0| Epoch 9 |
Number of nodes for computation during this epoch:  5094631
Number of first layer input nodes during this epoch:  2472747
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.1154489517211914  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0213930606842041
random selection method range initialization spend 0.006017208099365234
time for parepare:  0.01842212677001953
local_output_nid generation:  0.002317190170288086
local_in_edges_tensor generation:  0.007345438003540039
mini_batch_src_global generation:  0.0015702247619628906
r_  generation:  0.01846170425415039
local_output_nid generation:  0.0028533935546875
local_in_edges_tensor generation:  0.0017037391662597656
mini_batch_src_global generation:  0.001817464828491211
r_  generation:  0.020033836364746094
local_output_nid generation:  0.0029897689819335938
local_in_edges_tensor generation:  0.001605987548828125
mini_batch_src_global generation:  0.0014972686767578125
r_  generation:  0.01876974105834961
local_output_nid generation:  0.002951383590698242
local_in_edges_tensor generation:  0.0015554428100585938
mini_batch_src_global generation:  0.0014865398406982422
r_  generation:  0.018752336502075195
local_output_nid generation:  0.002952098846435547
local_in_edges_tensor generation:  0.001556396484375
mini_batch_src_global generation:  0.0015368461608886719
r_  generation:  0.019306659698486328
local_output_nid generation:  0.0029332637786865234
local_in_edges_tensor generation:  0.001581430435180664
mini_batch_src_global generation:  0.0015156269073486328
r_  generation:  0.018633604049682617
local_output_nid generation:  0.002966642379760742
local_in_edges_tensor generation:  0.001611471176147461
mini_batch_src_global generation:  0.001542806625366211
r_  generation:  0.019199132919311523
local_output_nid generation:  0.002994537353515625
local_in_edges_tensor generation:  0.0015823841094970703
mini_batch_src_global generation:  0.0016307830810546875
r_  generation:  0.019433259963989258
local_output_nid generation:  0.0029706954956054688
local_in_edges_tensor generation:  0.0015864372253417969
mini_batch_src_global generation:  0.0015337467193603516
r_  generation:  0.01915574073791504
local_output_nid generation:  0.0029141902923583984
local_in_edges_tensor generation:  0.0014843940734863281
mini_batch_src_global generation:  0.0015485286712646484
r_  generation:  0.01947474479675293
local_output_nid generation:  0.0030062198638916016
local_in_edges_tensor generation:  0.001552581787109375
mini_batch_src_global generation:  0.001554727554321289
r_  generation:  0.019182682037353516
local_output_nid generation:  0.0029883384704589844
local_in_edges_tensor generation:  0.001539468765258789
mini_batch_src_global generation:  0.0015697479248046875
r_  generation:  0.019444704055786133
local_output_nid generation:  0.0029740333557128906
local_in_edges_tensor generation:  0.0015015602111816406
mini_batch_src_global generation:  0.0014955997467041016
r_  generation:  0.019405841827392578
local_output_nid generation:  0.002931833267211914
local_in_edges_tensor generation:  0.0015711784362792969
mini_batch_src_global generation:  0.0015246868133544922
r_  generation:  0.019233226776123047
local_output_nid generation:  0.0029747486114501953
local_in_edges_tensor generation:  0.0015597343444824219
mini_batch_src_global generation:  0.0015153884887695312
r_  generation:  0.0191497802734375
local_output_nid generation:  0.002941131591796875
local_in_edges_tensor generation:  0.0014522075653076172
mini_batch_src_global generation:  0.0015718936920166016
r_  generation:  0.01959514617919922
----------------------check_connections_block total spend ----------------------------- 0.5080220699310303
generate_one_block  0.027970314025878906
generate_one_block  0.028212547302246094
generate_one_block  0.027460575103759766
generate_one_block  0.027903079986572266
generate_one_block  0.028378009796142578
generate_one_block  0.030326128005981445
generate_one_block  0.028058767318725586
generate_one_block  0.02756023406982422
generate_one_block  0.027441978454589844
generate_one_block  0.028575658798217773
generate_one_block  0.027582406997680664
generate_one_block  0.027701616287231445
generate_one_block  0.028644323348999023
generate_one_block  0.027199983596801758
generate_one_block  0.027667999267578125
generate_one_block  0.0281221866607666
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03643369674682617
gen group dst list time:  0.019661426544189453
time for parepare:  0.01918959617614746
local_output_nid generation:  0.008289098739624023
local_in_edges_tensor generation:  0.025648117065429688
mini_batch_src_global generation:  0.0202329158782959
r_  generation:  0.1920459270477295
local_output_nid generation:  0.012097597122192383
local_in_edges_tensor generation:  0.015561103820800781
mini_batch_src_global generation:  0.02421426773071289
r_  generation:  0.19882512092590332
local_output_nid generation:  0.011838197708129883
local_in_edges_tensor generation:  0.013012886047363281
mini_batch_src_global generation:  0.02447199821472168
r_  generation:  0.20452189445495605
local_output_nid generation:  0.012321710586547852
local_in_edges_tensor generation:  0.012670516967773438
mini_batch_src_global generation:  0.024163246154785156
r_  generation:  0.20725774765014648
local_output_nid generation:  0.012810230255126953
local_in_edges_tensor generation:  0.013271808624267578
mini_batch_src_global generation:  0.026909589767456055
r_  generation:  0.21317291259765625
local_output_nid generation:  0.01232767105102539
local_in_edges_tensor generation:  0.013547182083129883
mini_batch_src_global generation:  0.026154756546020508
r_  generation:  0.20299935340881348
local_output_nid generation:  0.012556314468383789
local_in_edges_tensor generation:  0.01212167739868164
mini_batch_src_global generation:  0.025928735733032227
r_  generation:  0.21019482612609863
local_output_nid generation:  0.012662410736083984
local_in_edges_tensor generation:  0.015295982360839844
mini_batch_src_global generation:  0.025831937789916992
r_  generation:  0.20883440971374512
local_output_nid generation:  0.012475967407226562
local_in_edges_tensor generation:  0.012254953384399414
mini_batch_src_global generation:  0.026104450225830078
r_  generation:  0.21101832389831543
local_output_nid generation:  0.01259922981262207
local_in_edges_tensor generation:  0.012136220932006836
mini_batch_src_global generation:  0.02646803855895996
r_  generation:  0.21215248107910156
local_output_nid generation:  0.012315034866333008
local_in_edges_tensor generation:  0.013715267181396484
mini_batch_src_global generation:  0.027042865753173828
r_  generation:  0.20811796188354492
local_output_nid generation:  0.012607812881469727
local_in_edges_tensor generation:  0.012231588363647461
mini_batch_src_global generation:  0.026281356811523438
r_  generation:  0.21353888511657715
local_output_nid generation:  0.012587785720825195
local_in_edges_tensor generation:  0.012635469436645508
mini_batch_src_global generation:  0.026337862014770508
r_  generation:  0.21144652366638184
local_output_nid generation:  0.012529850006103516
local_in_edges_tensor generation:  0.012046098709106445
mini_batch_src_global generation:  0.026036977767944336
r_  generation:  0.20804953575134277
local_output_nid generation:  0.01229238510131836
local_in_edges_tensor generation:  0.01198887825012207
mini_batch_src_global generation:  0.026634693145751953
r_  generation:  0.2125387191772461
local_output_nid generation:  0.011950969696044922
local_in_edges_tensor generation:  0.012724876403808594
mini_batch_src_global generation:  0.028127431869506836
r_  generation:  0.21177268028259277
----------------------check_connections_block total spend ----------------------------- 4.903994560241699
generate_one_block  0.27619481086730957
generate_one_block  0.26679515838623047
generate_one_block  0.272550106048584
generate_one_block  0.26639437675476074
generate_one_block  0.27615833282470703
generate_one_block  0.25909996032714844
generate_one_block  0.2876155376434326
generate_one_block  0.2638990879058838
generate_one_block  0.26560044288635254
generate_one_block  0.2726407051086426
generate_one_block  0.2630331516265869
generate_one_block  0.26987218856811523
generate_one_block  0.2707386016845703
generate_one_block  0.2622103691101074
generate_one_block  0.2666659355163574
generate_one_block  0.27039051055908203
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.033019065856933594
gen group dst list time:  0.06071281433105469
time for parepare:  0.017284631729125977
local_output_nid generation:  0.026395082473754883
local_in_edges_tensor generation:  0.04411768913269043
mini_batch_src_global generation:  0.04022574424743652
r_  generation:  0.43977880477905273
local_output_nid generation:  0.030575990676879883
local_in_edges_tensor generation:  0.03780627250671387
mini_batch_src_global generation:  0.05114936828613281
r_  generation:  0.4404947757720947
local_output_nid generation:  0.030907630920410156
local_in_edges_tensor generation:  0.03058600425720215
mini_batch_src_global generation:  0.05070161819458008
r_  generation:  0.44954991340637207
local_output_nid generation:  0.030895233154296875
local_in_edges_tensor generation:  0.030777692794799805
mini_batch_src_global generation:  0.05153632164001465
r_  generation:  0.44243741035461426
local_output_nid generation:  0.03073906898498535
local_in_edges_tensor generation:  0.07134437561035156
mini_batch_src_global generation:  0.05063223838806152
r_  generation:  0.4525439739227295
local_output_nid generation:  0.03083062171936035
local_in_edges_tensor generation:  0.029850244522094727
mini_batch_src_global generation:  0.052490949630737305
r_  generation:  0.44559550285339355
local_output_nid generation:  0.030788898468017578
local_in_edges_tensor generation:  0.030237913131713867
mini_batch_src_global generation:  0.05150580406188965
r_  generation:  0.45058417320251465
local_output_nid generation:  0.031045913696289062
local_in_edges_tensor generation:  0.030174970626831055
mini_batch_src_global generation:  0.052435874938964844
r_  generation:  0.44843292236328125
local_output_nid generation:  0.031055212020874023
local_in_edges_tensor generation:  0.029181480407714844
mini_batch_src_global generation:  0.0516660213470459
r_  generation:  0.45345234870910645
local_output_nid generation:  0.031331539154052734
local_in_edges_tensor generation:  0.02868032455444336
mini_batch_src_global generation:  0.05291604995727539
r_  generation:  0.45644450187683105
local_output_nid generation:  0.0309450626373291
local_in_edges_tensor generation:  0.030800342559814453
mini_batch_src_global generation:  0.05162310600280762
r_  generation:  0.4530355930328369
local_output_nid generation:  0.03109574317932129
local_in_edges_tensor generation:  0.0308077335357666
mini_batch_src_global generation:  0.05269885063171387
r_  generation:  0.45042967796325684
local_output_nid generation:  0.030745744705200195
local_in_edges_tensor generation:  0.0298006534576416
mini_batch_src_global generation:  0.053377389907836914
r_  generation:  0.45226025581359863
local_output_nid generation:  0.03077530860900879
local_in_edges_tensor generation:  0.03031444549560547
mini_batch_src_global generation:  0.05273771286010742
r_  generation:  0.44873690605163574
local_output_nid generation:  0.031165122985839844
local_in_edges_tensor generation:  0.030645132064819336
mini_batch_src_global generation:  0.05131816864013672
r_  generation:  0.45819616317749023
local_output_nid generation:  0.031349897384643555
local_in_edges_tensor generation:  0.030901670455932617
mini_batch_src_global generation:  0.05273151397705078
r_  generation:  0.4514186382293701
----------------------check_connections_block total spend ----------------------------- 10.629636287689209
generate_one_block  0.5713798999786377
generate_one_block  0.5734901428222656
generate_one_block  0.5714294910430908
generate_one_block  0.5716891288757324
generate_one_block  0.572272777557373
generate_one_block  0.5642845630645752
generate_one_block  0.5774726867675781
generate_one_block  0.5751030445098877
generate_one_block  0.6336665153503418
generate_one_block  0.5863163471221924
generate_one_block  0.5662727355957031
generate_one_block  0.5759625434875488
generate_one_block  0.5763339996337891
generate_one_block  0.5718321800231934
generate_one_block  0.5823879241943359
generate_one_block  0.5797784328460693
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.1154489517211914  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

connection checking time:  15.533630847930908
block generation total time  13.559531688690186
average batch blocks generation time:  0.8474707305431366
block dataloader generation time/epoch 31.088920831680298
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09397172927856445  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7190275192260742  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09351825714111328  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7185168266296387  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09393978118896484  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7189464569091797  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09325599670410156  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7167372703552246  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09403514862060547  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7232189178466797  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09327316284179688  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7142515182495117  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09392452239990234  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7165412902832031  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0933542251586914  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7167587280273438  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0939035415649414  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7173976898193359  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0934605598449707  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7204537391662598  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09377384185791016  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7155561447143555  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.093475341796875  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7196516990661621  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09392070770263672  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7188692092895508  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09336662292480469  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.717078685760498  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09390068054199219  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7162880897521973  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09349489212036133  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7196636199951172  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06296882033348083 |0.012845471501350403 |0.00365273654460907 |9.307265281677246e-05 |0.0036830157041549683 |0.001596689224243164 |
----------------------------------------------------------pseudo_mini_loss sum 1.5943210124969482
Total (block generation + training)time/epoch 32.48160791397095
Training time/epoch 1.3924858570098877
Training time without block to device /epoch 1.1869583129882812
Training time without total dataloading part /epoch 0.12045788764953613
load block tensor time/epoch 1.0075011253356934
block to device time/epoch 0.20552754402160645
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 10 |
Number of nodes for computation during this epoch:  5093929
Number of first layer input nodes during this epoch:  2472468
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11542892456054688  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01996469497680664
random selection method range initialization spend 0.0058405399322509766
time for parepare:  0.018512964248657227
local_output_nid generation:  0.00231170654296875
local_in_edges_tensor generation:  0.003912925720214844
mini_batch_src_global generation:  0.0015921592712402344
r_  generation:  0.01845407485961914
local_output_nid generation:  0.0028612613677978516
local_in_edges_tensor generation:  0.0016570091247558594
mini_batch_src_global generation:  0.0018310546875
r_  generation:  0.019675254821777344
local_output_nid generation:  0.002949237823486328
local_in_edges_tensor generation:  0.0016021728515625
mini_batch_src_global generation:  0.0014772415161132812
r_  generation:  0.018944501876831055
local_output_nid generation:  0.003013134002685547
local_in_edges_tensor generation:  0.0015604496002197266
mini_batch_src_global generation:  0.001558542251586914
r_  generation:  0.018732309341430664
local_output_nid generation:  0.002900362014770508
local_in_edges_tensor generation:  0.0015628337860107422
mini_batch_src_global generation:  0.001451730728149414
r_  generation:  0.018137216567993164
local_output_nid generation:  0.0029265880584716797
local_in_edges_tensor generation:  0.0014872550964355469
mini_batch_src_global generation:  0.0014805793762207031
r_  generation:  0.01907634735107422
local_output_nid generation:  0.0029091835021972656
local_in_edges_tensor generation:  0.001497030258178711
mini_batch_src_global generation:  0.0015225410461425781
r_  generation:  0.01894354820251465
local_output_nid generation:  0.002892017364501953
local_in_edges_tensor generation:  0.0015308856964111328
mini_batch_src_global generation:  0.0015370845794677734
r_  generation:  0.01904582977294922
local_output_nid generation:  0.0029060840606689453
local_in_edges_tensor generation:  0.0015032291412353516
mini_batch_src_global generation:  0.0015311241149902344
r_  generation:  0.019755840301513672
local_output_nid generation:  0.0029611587524414062
local_in_edges_tensor generation:  0.0016002655029296875
mini_batch_src_global generation:  0.0015430450439453125
r_  generation:  0.018978357315063477
local_output_nid generation:  0.002928018569946289
local_in_edges_tensor generation:  0.001504659652709961
mini_batch_src_global generation:  0.0015192031860351562
r_  generation:  0.019099950790405273
local_output_nid generation:  0.0029065608978271484
local_in_edges_tensor generation:  0.0015347003936767578
mini_batch_src_global generation:  0.001501321792602539
r_  generation:  0.019221067428588867
local_output_nid generation:  0.002921581268310547
local_in_edges_tensor generation:  0.0014383792877197266
mini_batch_src_global generation:  0.001524209976196289
r_  generation:  0.019484996795654297
local_output_nid generation:  0.0029294490814208984
local_in_edges_tensor generation:  0.0015039443969726562
mini_batch_src_global generation:  0.0015168190002441406
r_  generation:  0.019289255142211914
local_output_nid generation:  0.002940654754638672
local_in_edges_tensor generation:  0.0014693737030029297
mini_batch_src_global generation:  0.0015821456909179688
r_  generation:  0.019881486892700195
local_output_nid generation:  0.002927064895629883
local_in_edges_tensor generation:  0.0014858245849609375
mini_batch_src_global generation:  0.0040433406829833984
r_  generation:  0.01933908462524414
----------------------check_connections_block total spend ----------------------------- 0.5038681030273438
generate_one_block  0.02743220329284668
generate_one_block  0.028568267822265625
generate_one_block  0.02762126922607422
generate_one_block  0.027680635452270508
generate_one_block  0.026986122131347656
generate_one_block  0.030772686004638672
generate_one_block  0.02849125862121582
generate_one_block  0.027511119842529297
generate_one_block  0.028196334838867188
generate_one_block  0.02723550796508789
generate_one_block  0.02725386619567871
generate_one_block  0.02918863296508789
generate_one_block  0.02802896499633789
generate_one_block  0.02765035629272461
generate_one_block  0.028308629989624023
generate_one_block  0.0281374454498291
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03809952735900879
gen group dst list time:  0.01893472671508789
time for parepare:  0.019185781478881836
local_output_nid generation:  0.008231878280639648
local_in_edges_tensor generation:  0.026675939559936523
mini_batch_src_global generation:  0.019752979278564453
r_  generation:  0.19205403327941895
local_output_nid generation:  0.01211857795715332
local_in_edges_tensor generation:  0.014993429183959961
mini_batch_src_global generation:  0.02407360076904297
r_  generation:  0.19992995262145996
local_output_nid generation:  0.012094497680664062
local_in_edges_tensor generation:  0.012120723724365234
mini_batch_src_global generation:  0.02362346649169922
r_  generation:  0.2053968906402588
local_output_nid generation:  0.012750387191772461
local_in_edges_tensor generation:  0.012262105941772461
mini_batch_src_global generation:  0.02424931526184082
r_  generation:  0.20625543594360352
local_output_nid generation:  0.012269973754882812
local_in_edges_tensor generation:  0.013152599334716797
mini_batch_src_global generation:  0.025310754776000977
r_  generation:  0.20235443115234375
local_output_nid generation:  0.011874914169311523
local_in_edges_tensor generation:  0.012372732162475586
mini_batch_src_global generation:  0.025846004486083984
r_  generation:  0.20856142044067383
local_output_nid generation:  0.012389659881591797
local_in_edges_tensor generation:  0.011736631393432617
mini_batch_src_global generation:  0.02554917335510254
r_  generation:  0.2062053680419922
local_output_nid generation:  0.01251673698425293
local_in_edges_tensor generation:  0.012133121490478516
mini_batch_src_global generation:  0.026056766510009766
r_  generation:  0.21236157417297363
local_output_nid generation:  0.012780189514160156
local_in_edges_tensor generation:  0.013773441314697266
mini_batch_src_global generation:  0.026126861572265625
r_  generation:  0.21497058868408203
local_output_nid generation:  0.012484312057495117
local_in_edges_tensor generation:  0.01195669174194336
mini_batch_src_global generation:  0.025960206985473633
r_  generation:  0.21408319473266602
local_output_nid generation:  0.012434959411621094
local_in_edges_tensor generation:  0.011783838272094727
mini_batch_src_global generation:  0.026056766510009766
r_  generation:  0.21097803115844727
local_output_nid generation:  0.012254476547241211
local_in_edges_tensor generation:  0.012629270553588867
mini_batch_src_global generation:  0.026712417602539062
r_  generation:  0.21529889106750488
local_output_nid generation:  0.012754440307617188
local_in_edges_tensor generation:  0.012735366821289062
mini_batch_src_global generation:  0.02693915367126465
r_  generation:  0.2180333137512207
local_output_nid generation:  0.012760162353515625
local_in_edges_tensor generation:  0.012315034866333008
mini_batch_src_global generation:  0.026296138763427734
r_  generation:  0.21178770065307617
local_output_nid generation:  0.01276254653930664
local_in_edges_tensor generation:  0.012876033782958984
mini_batch_src_global generation:  0.027148962020874023
r_  generation:  0.2181837558746338
local_output_nid generation:  0.0121917724609375
local_in_edges_tensor generation:  0.012964248657226562
mini_batch_src_global generation:  0.028747081756591797
r_  generation:  0.214768648147583
----------------------check_connections_block total spend ----------------------------- 4.92480993270874
generate_one_block  0.271329402923584
generate_one_block  0.2632181644439697
generate_one_block  0.26425862312316895
generate_one_block  0.2677574157714844
generate_one_block  0.2619926929473877
generate_one_block  0.27184414863586426
generate_one_block  0.2813737392425537
generate_one_block  0.26668334007263184
generate_one_block  0.26790595054626465
generate_one_block  0.2637927532196045
generate_one_block  0.2628445625305176
generate_one_block  0.2744591236114502
generate_one_block  0.2710258960723877
generate_one_block  0.2630951404571533
generate_one_block  0.27317333221435547
generate_one_block  0.2693779468536377
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.032822608947753906
gen group dst list time:  0.06017875671386719
time for parepare:  0.01738142967224121
local_output_nid generation:  0.025507450103759766
local_in_edges_tensor generation:  0.03895926475524902
mini_batch_src_global generation:  0.03909659385681152
r_  generation:  0.4466235637664795
local_output_nid generation:  0.031227827072143555
local_in_edges_tensor generation:  0.03427886962890625
mini_batch_src_global generation:  0.05149078369140625
r_  generation:  0.43921685218811035
local_output_nid generation:  0.03059244155883789
local_in_edges_tensor generation:  0.03216552734375
mini_batch_src_global generation:  0.050650596618652344
r_  generation:  0.45580172538757324
local_output_nid generation:  0.030894756317138672
local_in_edges_tensor generation:  0.03119945526123047
mini_batch_src_global generation:  0.05276656150817871
r_  generation:  0.4453308582305908
local_output_nid generation:  0.030838966369628906
local_in_edges_tensor generation:  0.07065987586975098
mini_batch_src_global generation:  0.051003217697143555
r_  generation:  0.4541139602661133
local_output_nid generation:  0.03075551986694336
local_in_edges_tensor generation:  0.029036998748779297
mini_batch_src_global generation:  0.05523538589477539
r_  generation:  0.44988489151000977
local_output_nid generation:  0.031024932861328125
local_in_edges_tensor generation:  0.032962799072265625
mini_batch_src_global generation:  0.053121328353881836
r_  generation:  0.4632885456085205
local_output_nid generation:  0.03145003318786621
local_in_edges_tensor generation:  0.03146648406982422
mini_batch_src_global generation:  0.05709719657897949
r_  generation:  0.4515511989593506
local_output_nid generation:  0.031064271926879883
local_in_edges_tensor generation:  0.033495426177978516
mini_batch_src_global generation:  0.052213430404663086
r_  generation:  0.4628877639770508
local_output_nid generation:  0.03102564811706543
local_in_edges_tensor generation:  0.0292205810546875
mini_batch_src_global generation:  0.052496910095214844
r_  generation:  0.45210790634155273
local_output_nid generation:  0.031594038009643555
local_in_edges_tensor generation:  0.03063368797302246
mini_batch_src_global generation:  0.051351070404052734
r_  generation:  0.4633934497833252
local_output_nid generation:  0.03113532066345215
local_in_edges_tensor generation:  0.033942222595214844
mini_batch_src_global generation:  0.05318188667297363
r_  generation:  0.45299673080444336
local_output_nid generation:  0.03144359588623047
local_in_edges_tensor generation:  0.03206062316894531
mini_batch_src_global generation:  0.051373958587646484
r_  generation:  0.4635963439941406
local_output_nid generation:  0.030855655670166016
local_in_edges_tensor generation:  0.029775619506835938
mini_batch_src_global generation:  0.05227971076965332
r_  generation:  0.448091983795166
local_output_nid generation:  0.031228303909301758
local_in_edges_tensor generation:  0.028912067413330078
mini_batch_src_global generation:  0.0513615608215332
r_  generation:  0.46421146392822266
local_output_nid generation:  0.031027793884277344
local_in_edges_tensor generation:  0.03042745590209961
mini_batch_src_global generation:  0.05274391174316406
r_  generation:  0.4519944190979004
----------------------check_connections_block total spend ----------------------------- 10.713290691375732
generate_one_block  0.5780606269836426
generate_one_block  0.5753681659698486
generate_one_block  0.5747075080871582
generate_one_block  0.5716149806976318
generate_one_block  0.5690617561340332
generate_one_block  0.5731253623962402
generate_one_block  0.5727128982543945
generate_one_block  0.5765492916107178
generate_one_block  0.6114346981048584
generate_one_block  0.5757372379302979
generate_one_block  0.5782709121704102
generate_one_block  0.5816013813018799
generate_one_block  0.5935025215148926
generate_one_block  0.5703611373901367
generate_one_block  0.5746035575866699
generate_one_block  0.5769398212432861
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11542892456054688  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

connection checking time:  15.638100624084473
block generation total time  13.547784090042114
average batch blocks generation time:  0.8467365056276321
block dataloader generation time/epoch 31.13838756084442
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09392023086547852  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7181816101074219  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09342193603515625  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7188291549682617  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09391403198242188  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7179174423217773  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09326362609863281  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7185630798339844  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09372138977050781  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7108068466186523  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09325456619262695  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7167010307312012  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09372329711914062  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7116103172302246  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09332799911499023  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7169146537780762  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0939779281616211  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7191019058227539  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09333276748657227  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.715733528137207  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09382247924804688  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.715141773223877  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09353160858154297  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7202234268188477  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09404373168945312  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7218017578125  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0931859016418457  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7169432640075684  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09408092498779297  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7256369590759277  GigaBytes
Max Memory Allocated: 0.8056340217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09331083297729492  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.718353271484375  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06270860135555267 |0.012098655104637146 |0.0036593973636627197 |9.299814701080322e-05 |0.003690674901008606 |0.0030913352966308594 |
----------------------------------------------------------pseudo_mini_loss sum 1.5535805225372314
Total (block generation + training)time/epoch 32.52354621887207
Training time/epoch 1.3773348331451416
Training time without block to device /epoch 1.1837563514709473
Training time without total dataloading part /epoch 0.12218046188354492
load block tensor time/epoch 1.0033376216888428
block to device time/epoch 0.19357848167419434
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 11 |
Number of nodes for computation during this epoch:  5091468
Number of first layer input nodes during this epoch:  2471015
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11531639099121094  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02086949348449707
random selection method range initialization spend 0.005876302719116211
time for parepare:  0.018758296966552734
local_output_nid generation:  0.002274036407470703
local_in_edges_tensor generation:  0.007571697235107422
mini_batch_src_global generation:  0.0016105175018310547
r_  generation:  0.017705202102661133
local_output_nid generation:  0.002883434295654297
local_in_edges_tensor generation:  0.0017037391662597656
mini_batch_src_global generation:  0.0019142627716064453
r_  generation:  0.019608020782470703
local_output_nid generation:  0.0029146671295166016
local_in_edges_tensor generation:  0.0016469955444335938
mini_batch_src_global generation:  0.0015192031860351562
r_  generation:  0.019050121307373047
local_output_nid generation:  0.0029480457305908203
local_in_edges_tensor generation:  0.0015978813171386719
mini_batch_src_global generation:  0.0015404224395751953
r_  generation:  0.019335031509399414
local_output_nid generation:  0.0029268264770507812
local_in_edges_tensor generation:  0.0015935897827148438
mini_batch_src_global generation:  0.0015225410461425781
r_  generation:  0.018611907958984375
local_output_nid generation:  0.002991914749145508
local_in_edges_tensor generation:  0.0016040802001953125
mini_batch_src_global generation:  0.0015311241149902344
r_  generation:  0.01906752586364746
local_output_nid generation:  0.0029304027557373047
local_in_edges_tensor generation:  0.0015361309051513672
mini_batch_src_global generation:  0.0015516281127929688
r_  generation:  0.019334077835083008
local_output_nid generation:  0.0029366016387939453
local_in_edges_tensor generation:  0.0015780925750732422
mini_batch_src_global generation:  0.0015442371368408203
r_  generation:  0.018927574157714844
local_output_nid generation:  0.0029523372650146484
local_in_edges_tensor generation:  0.0018439292907714844
mini_batch_src_global generation:  0.0015268325805664062
r_  generation:  0.01930093765258789
local_output_nid generation:  0.0029735565185546875
local_in_edges_tensor generation:  0.0015721321105957031
mini_batch_src_global generation:  0.0015392303466796875
r_  generation:  0.019355058670043945
local_output_nid generation:  0.002947092056274414
local_in_edges_tensor generation:  0.0015835762023925781
mini_batch_src_global generation:  0.0015299320220947266
r_  generation:  0.019330739974975586
local_output_nid generation:  0.002911090850830078
local_in_edges_tensor generation:  0.0015583038330078125
mini_batch_src_global generation:  0.0015413761138916016
r_  generation:  0.019089698791503906
local_output_nid generation:  0.002933979034423828
local_in_edges_tensor generation:  0.001566171646118164
mini_batch_src_global generation:  0.0015416145324707031
r_  generation:  0.0196077823638916
local_output_nid generation:  0.0029282569885253906
local_in_edges_tensor generation:  0.0014998912811279297
mini_batch_src_global generation:  0.0015606880187988281
r_  generation:  0.019794702529907227
local_output_nid generation:  0.0030517578125
local_in_edges_tensor generation:  0.0015568733215332031
mini_batch_src_global generation:  0.0015230178833007812
r_  generation:  0.01905226707458496
local_output_nid generation:  0.0030231475830078125
local_in_edges_tensor generation:  0.0016169548034667969
mini_batch_src_global generation:  0.0015256404876708984
r_  generation:  0.019281625747680664
----------------------check_connections_block total spend ----------------------------- 0.5108151435852051
generate_one_block  0.026731014251708984
generate_one_block  0.028011798858642578
generate_one_block  0.027848482131958008
generate_one_block  0.027939319610595703
generate_one_block  0.02791285514831543
generate_one_block  0.03066563606262207
generate_one_block  0.028400659561157227
generate_one_block  0.027486324310302734
generate_one_block  0.028144121170043945
generate_one_block  0.028370380401611328
generate_one_block  0.028038501739501953
generate_one_block  0.027564287185668945
generate_one_block  0.028072595596313477
generate_one_block  0.028441905975341797
generate_one_block  0.027645349502563477
generate_one_block  0.02820563316345215
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03226304054260254
gen group dst list time:  0.015951871871948242
time for parepare:  0.01910400390625
local_output_nid generation:  0.008182287216186523
local_in_edges_tensor generation:  0.01987624168395996
mini_batch_src_global generation:  0.01951742172241211
r_  generation:  0.18388009071350098
local_output_nid generation:  0.012115240097045898
local_in_edges_tensor generation:  0.015584230422973633
mini_batch_src_global generation:  0.025115013122558594
r_  generation:  0.20014381408691406
local_output_nid generation:  0.011843681335449219
local_in_edges_tensor generation:  0.015644073486328125
mini_batch_src_global generation:  0.023612260818481445
r_  generation:  0.20238780975341797
local_output_nid generation:  0.012515068054199219
local_in_edges_tensor generation:  0.013833045959472656
mini_batch_src_global generation:  0.028710603713989258
r_  generation:  0.2087390422821045
local_output_nid generation:  0.012567758560180664
local_in_edges_tensor generation:  0.013125181198120117
mini_batch_src_global generation:  0.025560379028320312
r_  generation:  0.20802617073059082
local_output_nid generation:  0.01250767707824707
local_in_edges_tensor generation:  0.012466192245483398
mini_batch_src_global generation:  0.0254819393157959
r_  generation:  0.2087078094482422
local_output_nid generation:  0.012685060501098633
local_in_edges_tensor generation:  0.013378143310546875
mini_batch_src_global generation:  0.026035785675048828
r_  generation:  0.21181917190551758
local_output_nid generation:  0.012418270111083984
local_in_edges_tensor generation:  0.012413740158081055
mini_batch_src_global generation:  0.02649712562561035
r_  generation:  0.2046656608581543
local_output_nid generation:  0.01280069351196289
local_in_edges_tensor generation:  0.012186050415039062
mini_batch_src_global generation:  0.026381969451904297
r_  generation:  0.2124638557434082
local_output_nid generation:  0.012674093246459961
local_in_edges_tensor generation:  0.011578559875488281
mini_batch_src_global generation:  0.02662062644958496
r_  generation:  0.21466994285583496
local_output_nid generation:  0.012610197067260742
local_in_edges_tensor generation:  0.012172222137451172
mini_batch_src_global generation:  0.027095794677734375
r_  generation:  0.21416234970092773
local_output_nid generation:  0.01240849494934082
local_in_edges_tensor generation:  0.011982202529907227
mini_batch_src_global generation:  0.028680801391601562
r_  generation:  0.21293306350708008
local_output_nid generation:  0.012781858444213867
local_in_edges_tensor generation:  0.012129545211791992
mini_batch_src_global generation:  0.027415990829467773
r_  generation:  0.21526288986206055
local_output_nid generation:  0.012788772583007812
local_in_edges_tensor generation:  0.012026786804199219
mini_batch_src_global generation:  0.02671527862548828
r_  generation:  0.21569275856018066
local_output_nid generation:  0.012607574462890625
local_in_edges_tensor generation:  0.012612342834472656
mini_batch_src_global generation:  0.02898693084716797
r_  generation:  0.2148754596710205
local_output_nid generation:  0.012100458145141602
local_in_edges_tensor generation:  0.011749267578125
mini_batch_src_global generation:  0.026585817337036133
r_  generation:  0.21265053749084473
----------------------check_connections_block total spend ----------------------------- 4.92237114906311
generate_one_block  0.2641274929046631
generate_one_block  0.26819586753845215
generate_one_block  0.26828885078430176
generate_one_block  0.27312302589416504
generate_one_block  0.2644331455230713
generate_one_block  0.26494288444519043
generate_one_block  0.2915363311767578
generate_one_block  0.25864458084106445
generate_one_block  0.2676126956939697
generate_one_block  0.2749290466308594
generate_one_block  0.2732353210449219
generate_one_block  0.26869797706604004
generate_one_block  0.27230310440063477
generate_one_block  0.26912760734558105
generate_one_block  0.2631702423095703
generate_one_block  0.26644206047058105
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029509782791137695
gen group dst list time:  0.06038713455200195
time for parepare:  0.01759481430053711
local_output_nid generation:  0.025568723678588867
local_in_edges_tensor generation:  0.038727760314941406
mini_batch_src_global generation:  0.04046964645385742
r_  generation:  0.4359142780303955
local_output_nid generation:  0.031270503997802734
local_in_edges_tensor generation:  0.03632044792175293
mini_batch_src_global generation:  0.051459550857543945
r_  generation:  0.4426085948944092
local_output_nid generation:  0.03106403350830078
local_in_edges_tensor generation:  0.030707597732543945
mini_batch_src_global generation:  0.0508580207824707
r_  generation:  0.4501512050628662
local_output_nid generation:  0.03113245964050293
local_in_edges_tensor generation:  0.030950307846069336
mini_batch_src_global generation:  0.05429983139038086
r_  generation:  0.44584202766418457
local_output_nid generation:  0.031001806259155273
local_in_edges_tensor generation:  0.07074618339538574
mini_batch_src_global generation:  0.053803443908691406
r_  generation:  0.45151257514953613
local_output_nid generation:  0.030658483505249023
local_in_edges_tensor generation:  0.02910614013671875
mini_batch_src_global generation:  0.05192089080810547
r_  generation:  0.44441890716552734
local_output_nid generation:  0.03113698959350586
local_in_edges_tensor generation:  0.02928781509399414
mini_batch_src_global generation:  0.051049232482910156
r_  generation:  0.4526240825653076
local_output_nid generation:  0.030562639236450195
local_in_edges_tensor generation:  0.02893352508544922
mini_batch_src_global generation:  0.0518951416015625
r_  generation:  0.4472956657409668
local_output_nid generation:  0.03080153465270996
local_in_edges_tensor generation:  0.03355050086975098
mini_batch_src_global generation:  0.053209781646728516
r_  generation:  0.44983959197998047
local_output_nid generation:  0.030884981155395508
local_in_edges_tensor generation:  0.02886366844177246
mini_batch_src_global generation:  0.0533907413482666
r_  generation:  0.4504690170288086
local_output_nid generation:  0.03093695640563965
local_in_edges_tensor generation:  0.03264045715332031
mini_batch_src_global generation:  0.05231070518493652
r_  generation:  0.4564995765686035
local_output_nid generation:  0.030698060989379883
local_in_edges_tensor generation:  0.03080582618713379
mini_batch_src_global generation:  0.053467512130737305
r_  generation:  0.44696640968322754
local_output_nid generation:  0.031032323837280273
local_in_edges_tensor generation:  0.02859044075012207
mini_batch_src_global generation:  0.051439762115478516
r_  generation:  0.4523744583129883
local_output_nid generation:  0.03112936019897461
local_in_edges_tensor generation:  0.032619476318359375
mini_batch_src_global generation:  0.05239510536193848
r_  generation:  0.45208072662353516
local_output_nid generation:  0.03111124038696289
local_in_edges_tensor generation:  0.02860093116760254
mini_batch_src_global generation:  0.051985740661621094
r_  generation:  0.4517500400543213
local_output_nid generation:  0.03117060661315918
local_in_edges_tensor generation:  0.03124260902404785
mini_batch_src_global generation:  0.05406689643859863
r_  generation:  0.44711804389953613
----------------------check_connections_block total spend ----------------------------- 10.610451221466064
generate_one_block  0.5659236907958984
generate_one_block  0.5710973739624023
generate_one_block  0.5758743286132812
generate_one_block  0.571049690246582
generate_one_block  0.5765485763549805
generate_one_block  0.5643765926361084
generate_one_block  0.5761191844940186
generate_one_block  0.5615441799163818
generate_one_block  0.6264116764068604
generate_one_block  0.5833718776702881
generate_one_block  0.5710337162017822
generate_one_block  0.5654122829437256
generate_one_block  0.5719709396362305
generate_one_block  0.5727264881134033
generate_one_block  0.5663418769836426
generate_one_block  0.5756051540374756
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11531639099121094  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

connection checking time:  15.532822370529175
block generation total time  13.504217863082886
average batch blocks generation time:  0.8440136164426804
block dataloader generation time/epoch 31.10394803682963
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09363126754760742  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7108230590820312  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09342098236083984  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7183451652526855  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09392833709716797  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7199687957763672  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09368896484375  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7248773574829102  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09386253356933594  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7164626121520996  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09312248229980469  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.712066650390625  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09396553039550781  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7200183868408203  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09307003021240234  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7102441787719727  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09391307830810547  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7138900756835938  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09354877471923828  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7208590507507324  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0939626693725586  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7181200981140137  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09340333938598633  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7174568176269531  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09397602081298828  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7214770317077637  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09357261657714844  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7197251319885254  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09386253356933594  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7168765068054199  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09329891204833984  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7182307243347168  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06256416440010071 |0.01153169572353363 |0.003644198179244995 |9.472668170928955e-05 |0.003638729453086853 |0.0020143985748291016 |
----------------------------------------------------------pseudo_mini_loss sum 1.5126690864562988
Total (block generation + training)time/epoch 32.48254815737406
Training time/epoch 1.3652377128601074
Training time without block to device /epoch 1.1807305812835693
Training time without total dataloading part /epoch 0.1200568675994873
load block tensor time/epoch 1.0010266304016113
block to device time/epoch 0.18450713157653809
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 12 |
Number of nodes for computation during this epoch:  5094132
Number of first layer input nodes during this epoch:  2472186
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11519956588745117  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01996898651123047
random selection method range initialization spend 0.0058138370513916016
time for parepare:  0.018525123596191406
local_output_nid generation:  0.00235748291015625
local_in_edges_tensor generation:  0.0038907527923583984
mini_batch_src_global generation:  0.0015521049499511719
r_  generation:  0.018271684646606445
local_output_nid generation:  0.002871274948120117
local_in_edges_tensor generation:  0.0016973018646240234
mini_batch_src_global generation:  0.00183868408203125
r_  generation:  0.019300222396850586
local_output_nid generation:  0.002977609634399414
local_in_edges_tensor generation:  0.0016334056854248047
mini_batch_src_global generation:  0.0014536380767822266
r_  generation:  0.018597841262817383
local_output_nid generation:  0.0029768943786621094
local_in_edges_tensor generation:  0.0015728473663330078
mini_batch_src_global generation:  0.0015077590942382812
r_  generation:  0.018887996673583984
local_output_nid generation:  0.002962350845336914
local_in_edges_tensor generation:  0.0015909671783447266
mini_batch_src_global generation:  0.00151824951171875
r_  generation:  0.019379138946533203
local_output_nid generation:  0.0029599666595458984
local_in_edges_tensor generation:  0.0015671253204345703
mini_batch_src_global generation:  0.001516580581665039
r_  generation:  0.01887369155883789
local_output_nid generation:  0.0029647350311279297
local_in_edges_tensor generation:  0.0015523433685302734
mini_batch_src_global generation:  0.0015192031860351562
r_  generation:  0.019182920455932617
local_output_nid generation:  0.0030105113983154297
local_in_edges_tensor generation:  0.0015594959259033203
mini_batch_src_global generation:  0.0015435218811035156
r_  generation:  0.019530296325683594
local_output_nid generation:  0.0029497146606445312
local_in_edges_tensor generation:  0.0015330314636230469
mini_batch_src_global generation:  0.001547098159790039
r_  generation:  0.019370555877685547
local_output_nid generation:  0.002969503402709961
local_in_edges_tensor generation:  0.0015082359313964844
mini_batch_src_global generation:  0.0015676021575927734
r_  generation:  0.01941084861755371
local_output_nid generation:  0.002986431121826172
local_in_edges_tensor generation:  0.0015301704406738281
mini_batch_src_global generation:  0.0015037059783935547
r_  generation:  0.019008159637451172
local_output_nid generation:  0.0029718875885009766
local_in_edges_tensor generation:  0.0014767646789550781
mini_batch_src_global generation:  0.0015308856964111328
r_  generation:  0.0194854736328125
local_output_nid generation:  0.0029296875
local_in_edges_tensor generation:  0.0015113353729248047
mini_batch_src_global generation:  0.0015060901641845703
r_  generation:  0.019410133361816406
local_output_nid generation:  0.0029189586639404297
local_in_edges_tensor generation:  0.0015366077423095703
mini_batch_src_global generation:  0.0015347003936767578
r_  generation:  0.019620180130004883
local_output_nid generation:  0.002940654754638672
local_in_edges_tensor generation:  0.0014705657958984375
mini_batch_src_global generation:  0.0015077590942382812
r_  generation:  0.019443750381469727
local_output_nid generation:  0.0029282569885253906
local_in_edges_tensor generation:  0.001447916030883789
mini_batch_src_global generation:  0.0015301704406738281
r_  generation:  0.019904613494873047
----------------------check_connections_block total spend ----------------------------- 0.5038328170776367
generate_one_block  0.027174711227416992
generate_one_block  0.02788710594177246
generate_one_block  0.0271303653717041
generate_one_block  0.027375459671020508
generate_one_block  0.028252363204956055
generate_one_block  0.030226945877075195
generate_one_block  0.027971744537353516
generate_one_block  0.027894020080566406
generate_one_block  0.0278167724609375
generate_one_block  0.027545690536499023
generate_one_block  0.027030467987060547
generate_one_block  0.02809619903564453
generate_one_block  0.027887344360351562
generate_one_block  0.027949810028076172
generate_one_block  0.027695894241333008
generate_one_block  0.028117895126342773
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029884815216064453
gen group dst list time:  0.015469789505004883
time for parepare:  0.020040512084960938
local_output_nid generation:  0.008226871490478516
local_in_edges_tensor generation:  0.0193026065826416
mini_batch_src_global generation:  0.02009415626525879
r_  generation:  0.18939828872680664
local_output_nid generation:  0.012152671813964844
local_in_edges_tensor generation:  0.015335798263549805
mini_batch_src_global generation:  0.03033280372619629
r_  generation:  0.19935202598571777
local_output_nid generation:  0.011743545532226562
local_in_edges_tensor generation:  0.01602792739868164
mini_batch_src_global generation:  0.030306100845336914
r_  generation:  0.20697259902954102
local_output_nid generation:  0.013922691345214844
local_in_edges_tensor generation:  0.012756109237670898
mini_batch_src_global generation:  0.02781391143798828
r_  generation:  0.2085564136505127
local_output_nid generation:  0.013195037841796875
local_in_edges_tensor generation:  0.013097524642944336
mini_batch_src_global generation:  0.025795698165893555
r_  generation:  0.21547389030456543
local_output_nid generation:  0.012574434280395508
local_in_edges_tensor generation:  0.014440298080444336
mini_batch_src_global generation:  0.025559425354003906
r_  generation:  0.20734167098999023
local_output_nid generation:  0.012863874435424805
local_in_edges_tensor generation:  0.012108564376831055
mini_batch_src_global generation:  0.026237010955810547
r_  generation:  0.21367406845092773
local_output_nid generation:  0.012852668762207031
local_in_edges_tensor generation:  0.011927127838134766
mini_batch_src_global generation:  0.0261228084564209
r_  generation:  0.21254706382751465
local_output_nid generation:  0.013040542602539062
local_in_edges_tensor generation:  0.011912822723388672
mini_batch_src_global generation:  0.02657151222229004
r_  generation:  0.21279406547546387
local_output_nid generation:  0.012858152389526367
local_in_edges_tensor generation:  0.012540817260742188
mini_batch_src_global generation:  0.026154279708862305
r_  generation:  0.21214079856872559
local_output_nid generation:  0.01252436637878418
local_in_edges_tensor generation:  0.011852502822875977
mini_batch_src_global generation:  0.026418447494506836
r_  generation:  0.21257472038269043
local_output_nid generation:  0.012682676315307617
local_in_edges_tensor generation:  0.011957883834838867
mini_batch_src_global generation:  0.029824018478393555
r_  generation:  0.213606595993042
local_output_nid generation:  0.012892961502075195
local_in_edges_tensor generation:  0.012472152709960938
mini_batch_src_global generation:  0.02656388282775879
r_  generation:  0.2144625186920166
local_output_nid generation:  0.01292562484741211
local_in_edges_tensor generation:  0.013021707534790039
mini_batch_src_global generation:  0.02743816375732422
r_  generation:  0.21635055541992188
local_output_nid generation:  0.012973308563232422
local_in_edges_tensor generation:  0.013136863708496094
mini_batch_src_global generation:  0.0292818546295166
r_  generation:  0.21477031707763672
local_output_nid generation:  0.012717723846435547
local_in_edges_tensor generation:  0.012369632720947266
mini_batch_src_global generation:  0.027024269104003906
r_  generation:  0.21931195259094238
----------------------check_connections_block total spend ----------------------------- 4.972230672836304
generate_one_block  0.2698628902435303
generate_one_block  0.26317620277404785
generate_one_block  0.2626988887786865
generate_one_block  0.2651703357696533
generate_one_block  0.27316713333129883
generate_one_block  0.26226377487182617
generate_one_block  0.2906041145324707
generate_one_block  0.2701091766357422
generate_one_block  0.2676272392272949
generate_one_block  0.26506757736206055
generate_one_block  0.26581859588623047
generate_one_block  0.2709391117095947
generate_one_block  0.26912903785705566
generate_one_block  0.269120454788208
generate_one_block  0.26834702491760254
generate_one_block  0.27187561988830566
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03368520736694336
gen group dst list time:  0.062215328216552734
time for parepare:  0.01774454116821289
local_output_nid generation:  0.02518463134765625
local_in_edges_tensor generation:  0.04862785339355469
mini_batch_src_global generation:  0.04095125198364258
r_  generation:  0.44167423248291016
local_output_nid generation:  0.0309603214263916
local_in_edges_tensor generation:  0.035130977630615234
mini_batch_src_global generation:  0.051619529724121094
r_  generation:  0.44599485397338867
local_output_nid generation:  0.031128644943237305
local_in_edges_tensor generation:  0.034616708755493164
mini_batch_src_global generation:  0.05138993263244629
r_  generation:  0.45940589904785156
local_output_nid generation:  0.03037881851196289
local_in_edges_tensor generation:  0.03479504585266113
mini_batch_src_global generation:  0.05244302749633789
r_  generation:  0.45622730255126953
local_output_nid generation:  0.031046390533447266
local_in_edges_tensor generation:  0.07814335823059082
mini_batch_src_global generation:  0.051377058029174805
r_  generation:  0.45586252212524414
local_output_nid generation:  0.03058338165283203
local_in_edges_tensor generation:  0.03133654594421387
mini_batch_src_global generation:  0.05260038375854492
r_  generation:  0.4534761905670166
local_output_nid generation:  0.030656814575195312
local_in_edges_tensor generation:  0.028939485549926758
mini_batch_src_global generation:  0.05166935920715332
r_  generation:  0.45775628089904785
local_output_nid generation:  0.0340423583984375
local_in_edges_tensor generation:  0.029366254806518555
mini_batch_src_global generation:  0.0524754524230957
r_  generation:  0.4504997730255127
local_output_nid generation:  0.03074193000793457
local_in_edges_tensor generation:  0.029273271560668945
mini_batch_src_global generation:  0.0517580509185791
r_  generation:  0.45810961723327637
local_output_nid generation:  0.030770540237426758
local_in_edges_tensor generation:  0.03454732894897461
mini_batch_src_global generation:  0.05260825157165527
r_  generation:  0.4524271488189697
local_output_nid generation:  0.031147480010986328
local_in_edges_tensor generation:  0.03180193901062012
mini_batch_src_global generation:  0.05188393592834473
r_  generation:  0.4570345878601074
local_output_nid generation:  0.030885934829711914
local_in_edges_tensor generation:  0.029406070709228516
mini_batch_src_global generation:  0.05353569984436035
r_  generation:  0.45002007484436035
local_output_nid generation:  0.03082418441772461
local_in_edges_tensor generation:  0.02965259552001953
mini_batch_src_global generation:  0.051557302474975586
r_  generation:  0.45873236656188965
local_output_nid generation:  0.03077101707458496
local_in_edges_tensor generation:  0.03137803077697754
mini_batch_src_global generation:  0.05345916748046875
r_  generation:  0.4595358371734619
local_output_nid generation:  0.030723094940185547
local_in_edges_tensor generation:  0.0298464298248291
mini_batch_src_global generation:  0.05150270462036133
r_  generation:  0.4565894603729248
local_output_nid generation:  0.030886411666870117
local_in_edges_tensor generation:  0.030550718307495117
mini_batch_src_global generation:  0.054639339447021484
r_  generation:  0.4544799327850342
----------------------check_connections_block total spend ----------------------------- 10.737504005432129
generate_one_block  0.5812270641326904
generate_one_block  0.5694694519042969
generate_one_block  0.5758538246154785
generate_one_block  0.5778295993804932
generate_one_block  0.5770323276519775
generate_one_block  0.5642588138580322
generate_one_block  0.5673069953918457
generate_one_block  0.5701460838317871
generate_one_block  0.6107463836669922
generate_one_block  0.573108434677124
generate_one_block  0.5719480514526367
generate_one_block  0.5809643268585205
generate_one_block  0.5783023834228516
generate_one_block  0.5773882865905762
generate_one_block  0.5688896179199219
generate_one_block  0.595172643661499
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11519956588745117  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

connection checking time:  15.709734678268433
block generation total time  13.544621467590332
average batch blocks generation time:  0.8465388417243958
block dataloader generation time/epoch 31.133353888988495
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09380578994750977  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7160787582397461  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09337425231933594  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7161445617675781  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0938730239868164  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7155933380126953  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09337854385375977  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7178096771240234  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09401512145996094  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7194042205810547  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09312915802001953  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7143440246582031  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09393119812011719  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7181859016418457  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09313249588012695  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.716883659362793  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09391117095947266  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7191386222839355  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09331226348876953  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7173752784729004  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09382057189941406  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7159218788146973  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09323263168334961  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7172894477844238  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09392261505126953  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7183666229248047  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09347009658813477  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7190647125244141  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09388065338134766  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7186236381530762  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0935831069946289  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7226853370666504  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05990511178970337 |0.012721940875053406 |0.003604695200920105 |9.453296661376953e-05 |0.0030582845211029053 |0.0019941329956054688 |
----------------------------------------------------------pseudo_mini_loss sum 1.4843300580978394
Total (block generation + training)time/epoch 32.500708758831024
Training time/epoch 1.333343744277954
Training time without block to device /epoch 1.1297926902770996
Training time without total dataloading part /epoch 0.11011433601379395
load block tensor time/epoch 0.9584817886352539
block to device time/epoch 0.2035510540008545
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 13 |
Number of nodes for computation during this epoch:  5090941
Number of first layer input nodes during this epoch:  2470986
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11566781997680664  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018206357955932617
random selection method range initialization spend 0.006032466888427734
time for parepare:  0.017061948776245117
local_output_nid generation:  0.0023810863494873047
local_in_edges_tensor generation:  0.0037963390350341797
mini_batch_src_global generation:  0.0015287399291992188
r_  generation:  0.01802206039428711
local_output_nid generation:  0.002871274948120117
local_in_edges_tensor generation:  0.0016224384307861328
mini_batch_src_global generation:  0.0017542839050292969
r_  generation:  0.018784523010253906
local_output_nid generation:  0.0029332637786865234
local_in_edges_tensor generation:  0.0016210079193115234
mini_batch_src_global generation:  0.0014586448669433594
r_  generation:  0.01970052719116211
local_output_nid generation:  0.004224300384521484
local_in_edges_tensor generation:  0.0016324520111083984
mini_batch_src_global generation:  0.001550436019897461
r_  generation:  0.0195772647857666
local_output_nid generation:  0.0029859542846679688
local_in_edges_tensor generation:  0.0015764236450195312
mini_batch_src_global generation:  0.0015063285827636719
r_  generation:  0.01870870590209961
local_output_nid generation:  0.0029861927032470703
local_in_edges_tensor generation:  0.0016455650329589844
mini_batch_src_global generation:  0.0015256404876708984
r_  generation:  0.020159482955932617
local_output_nid generation:  0.0029735565185546875
local_in_edges_tensor generation:  0.0015842914581298828
mini_batch_src_global generation:  0.001544952392578125
r_  generation:  0.01900339126586914
local_output_nid generation:  0.0029735565185546875
local_in_edges_tensor generation:  0.0017879009246826172
mini_batch_src_global generation:  0.0015900135040283203
r_  generation:  0.01992058753967285
local_output_nid generation:  0.0029778480529785156
local_in_edges_tensor generation:  0.0015170574188232422
mini_batch_src_global generation:  0.001543283462524414
r_  generation:  0.018848896026611328
local_output_nid generation:  0.002994537353515625
local_in_edges_tensor generation:  0.00153350830078125
mini_batch_src_global generation:  0.0015208721160888672
r_  generation:  0.01908111572265625
local_output_nid generation:  0.003009796142578125
local_in_edges_tensor generation:  0.0015599727630615234
mini_batch_src_global generation:  0.0015609264373779297
r_  generation:  0.01954936981201172
local_output_nid generation:  0.0029833316802978516
local_in_edges_tensor generation:  0.0015423297882080078
mini_batch_src_global generation:  0.0015523433685302734
r_  generation:  0.0193634033203125
local_output_nid generation:  0.0029861927032470703
local_in_edges_tensor generation:  0.001561880111694336
mini_batch_src_global generation:  0.0015175342559814453
r_  generation:  0.019433975219726562
local_output_nid generation:  0.0029675960540771484
local_in_edges_tensor generation:  0.0014863014221191406
mini_batch_src_global generation:  0.0015606880187988281
r_  generation:  0.0198819637298584
local_output_nid generation:  0.0029685497283935547
local_in_edges_tensor generation:  0.0015070438385009766
mini_batch_src_global generation:  0.001519918441772461
r_  generation:  0.01955246925354004
local_output_nid generation:  0.0029604434967041016
local_in_edges_tensor generation:  0.0015196800231933594
mini_batch_src_global generation:  0.0015666484832763672
r_  generation:  0.019495248794555664
----------------------check_connections_block total spend ----------------------------- 0.5122900009155273
generate_one_block  0.027170419692993164
generate_one_block  0.027285099029541016
generate_one_block  0.027435779571533203
generate_one_block  0.02783513069152832
generate_one_block  0.02750873565673828
generate_one_block  0.031286001205444336
generate_one_block  0.027646303176879883
generate_one_block  0.028025388717651367
generate_one_block  0.027685880661010742
generate_one_block  0.027217388153076172
generate_one_block  0.027917146682739258
generate_one_block  0.02740621566772461
generate_one_block  0.027958154678344727
generate_one_block  0.028139829635620117
generate_one_block  0.027976036071777344
generate_one_block  0.028074979782104492
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.033593177795410156
gen group dst list time:  0.01652050018310547
time for parepare:  0.019342660903930664
local_output_nid generation:  0.00830531120300293
local_in_edges_tensor generation:  0.02272939682006836
mini_batch_src_global generation:  0.020020484924316406
r_  generation:  0.1883068084716797
local_output_nid generation:  0.011928558349609375
local_in_edges_tensor generation:  0.015002965927124023
mini_batch_src_global generation:  0.02448892593383789
r_  generation:  0.19263243675231934
local_output_nid generation:  0.012004613876342773
local_in_edges_tensor generation:  0.014400005340576172
mini_batch_src_global generation:  0.024303674697875977
r_  generation:  0.20331263542175293
local_output_nid generation:  0.012680768966674805
local_in_edges_tensor generation:  0.014504432678222656
mini_batch_src_global generation:  0.02438831329345703
r_  generation:  0.20809245109558105
local_output_nid generation:  0.012839794158935547
local_in_edges_tensor generation:  0.012029647827148438
mini_batch_src_global generation:  0.025919437408447266
r_  generation:  0.2080085277557373
local_output_nid generation:  0.01292562484741211
local_in_edges_tensor generation:  0.012038469314575195
mini_batch_src_global generation:  0.027301549911499023
r_  generation:  0.21387267112731934
local_output_nid generation:  0.012528657913208008
local_in_edges_tensor generation:  0.011960506439208984
mini_batch_src_global generation:  0.026541948318481445
r_  generation:  0.20857620239257812
local_output_nid generation:  0.012866735458374023
local_in_edges_tensor generation:  0.012003421783447266
mini_batch_src_global generation:  0.02805614471435547
r_  generation:  0.2131037712097168
local_output_nid generation:  0.012504100799560547
local_in_edges_tensor generation:  0.012722015380859375
mini_batch_src_global generation:  0.026116371154785156
r_  generation:  0.20733356475830078
local_output_nid generation:  0.01267385482788086
local_in_edges_tensor generation:  0.011610746383666992
mini_batch_src_global generation:  0.025905132293701172
r_  generation:  0.20816659927368164
local_output_nid generation:  0.012537479400634766
local_in_edges_tensor generation:  0.011968374252319336
mini_batch_src_global generation:  0.026694297790527344
r_  generation:  0.21273326873779297
local_output_nid generation:  0.012631416320800781
local_in_edges_tensor generation:  0.012024164199829102
mini_batch_src_global generation:  0.026357412338256836
r_  generation:  0.21151494979858398
local_output_nid generation:  0.012884855270385742
local_in_edges_tensor generation:  0.012996912002563477
mini_batch_src_global generation:  0.02801799774169922
r_  generation:  0.21834564208984375
local_output_nid generation:  0.012806177139282227
local_in_edges_tensor generation:  0.012979745864868164
mini_batch_src_global generation:  0.0265657901763916
r_  generation:  0.21531915664672852
local_output_nid generation:  0.01287388801574707
local_in_edges_tensor generation:  0.012087106704711914
mini_batch_src_global generation:  0.02699446678161621
r_  generation:  0.21471190452575684
local_output_nid generation:  0.012336254119873047
local_in_edges_tensor generation:  0.011611700057983398
mini_batch_src_global generation:  0.026102304458618164
r_  generation:  0.2115941047668457
----------------------check_connections_block total spend ----------------------------- 4.91074800491333
generate_one_block  0.2677645683288574
generate_one_block  0.25421953201293945
generate_one_block  0.26634764671325684
generate_one_block  0.2683422565460205
generate_one_block  0.26776695251464844
generate_one_block  0.2722632884979248
generate_one_block  0.28617095947265625
generate_one_block  0.2714653015136719
generate_one_block  0.2624943256378174
generate_one_block  0.2619304656982422
generate_one_block  0.27111244201660156
generate_one_block  0.267963171005249
generate_one_block  0.27381157875061035
generate_one_block  0.2697770595550537
generate_one_block  0.2677032947540283
generate_one_block  0.26496005058288574
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0351862907409668
gen group dst list time:  0.062261104583740234
time for parepare:  0.0175778865814209
local_output_nid generation:  0.024871349334716797
local_in_edges_tensor generation:  0.03780078887939453
mini_batch_src_global generation:  0.041034698486328125
r_  generation:  0.43991756439208984
local_output_nid generation:  0.030965566635131836
local_in_edges_tensor generation:  0.03626585006713867
mini_batch_src_global generation:  0.056830406188964844
r_  generation:  0.44058823585510254
local_output_nid generation:  0.03143930435180664
local_in_edges_tensor generation:  0.03642988204956055
mini_batch_src_global generation:  0.0526278018951416
r_  generation:  0.46797895431518555
local_output_nid generation:  0.03159308433532715
local_in_edges_tensor generation:  0.02924370765686035
mini_batch_src_global generation:  0.05651354789733887
r_  generation:  0.4515414237976074
local_output_nid generation:  0.03147411346435547
local_in_edges_tensor generation:  0.07950782775878906
mini_batch_src_global generation:  0.053220272064208984
r_  generation:  0.4609367847442627
local_output_nid generation:  0.03142881393432617
local_in_edges_tensor generation:  0.02871847152709961
mini_batch_src_global generation:  0.05499434471130371
r_  generation:  0.46329617500305176
local_output_nid generation:  0.031091928482055664
local_in_edges_tensor generation:  0.03076028823852539
mini_batch_src_global generation:  0.05533623695373535
r_  generation:  0.4579484462738037
local_output_nid generation:  0.03126406669616699
local_in_edges_tensor generation:  0.030251026153564453
mini_batch_src_global generation:  0.054784536361694336
r_  generation:  0.4508683681488037
local_output_nid generation:  0.03076338768005371
local_in_edges_tensor generation:  0.02861618995666504
mini_batch_src_global generation:  0.05359482765197754
r_  generation:  0.4551551342010498
local_output_nid generation:  0.030852794647216797
local_in_edges_tensor generation:  0.03082895278930664
mini_batch_src_global generation:  0.0546262264251709
r_  generation:  0.4542984962463379
local_output_nid generation:  0.03215146064758301
local_in_edges_tensor generation:  0.030596017837524414
mini_batch_src_global generation:  0.05375337600708008
r_  generation:  0.46232104301452637
local_output_nid generation:  0.0311124324798584
local_in_edges_tensor generation:  0.032494544982910156
mini_batch_src_global generation:  0.05514121055603027
r_  generation:  0.45835375785827637
local_output_nid generation:  0.031137466430664062
local_in_edges_tensor generation:  0.030952930450439453
mini_batch_src_global generation:  0.05126190185546875
r_  generation:  0.4635021686553955
local_output_nid generation:  0.03138160705566406
local_in_edges_tensor generation:  0.03589510917663574
mini_batch_src_global generation:  0.052873849868774414
r_  generation:  0.45842480659484863
local_output_nid generation:  0.031177043914794922
local_in_edges_tensor generation:  0.030330896377563477
mini_batch_src_global generation:  0.05124616622924805
r_  generation:  0.46002197265625
local_output_nid generation:  0.03122878074645996
local_in_edges_tensor generation:  0.028585433959960938
mini_batch_src_global generation:  0.05288505554199219
r_  generation:  0.4501078128814697
----------------------check_connections_block total spend ----------------------------- 10.771163940429688
generate_one_block  0.5788235664367676
generate_one_block  0.5687673091888428
generate_one_block  0.574425220489502
generate_one_block  0.572573184967041
generate_one_block  0.5740265846252441
generate_one_block  0.5694336891174316
generate_one_block  0.5789072513580322
generate_one_block  0.5761666297912598
generate_one_block  0.6180615425109863
generate_one_block  0.5726120471954346
generate_one_block  0.5763990879058838
generate_one_block  0.5795202255249023
generate_one_block  0.5791072845458984
generate_one_block  0.5813112258911133
generate_one_block  0.5739333629608154
generate_one_block  0.5724401473999023
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11566781997680664  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

connection checking time:  15.681911945343018
block generation total time  13.540601253509521
average batch blocks generation time:  0.8462875783443451
block dataloader generation time/epoch 31.1526216506958
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09382009506225586  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7167901992797852  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09296178817749023  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7079429626464844  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09395790100097656  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7183046340942383  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09329795837402344  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7185897827148438  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09393978118896484  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7178783416748047  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0934748649597168  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7237873077392578  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09386920928955078  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7163333892822266  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09348011016845703  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7191267013549805  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09377479553222656  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7158527374267578  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09323549270629883  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7148547172546387  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09394550323486328  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7187447547912598  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09340906143188477  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7165884971618652  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09402942657470703  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7192854881286621  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09346914291381836  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7198753356933594  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09389019012451172  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7177948951721191  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09325599670410156  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.717557430267334  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0602608323097229 |0.01159997284412384 |0.003586485981941223 |9.395182132720947e-05 |0.0031407177448272705 |0.0016012191772460938 |
----------------------------------------------------------pseudo_mini_loss sum 1.457458257675171
Total (block generation + training)time/epoch 32.51050176620483
Training time/epoch 1.3196945190429688
Training time without block to device /epoch 1.1340949535369873
Training time without total dataloading part /epoch 0.11073970794677734
load block tensor time/epoch 0.9641733169555664
block to device time/epoch 0.18559956550598145
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 14 |
Number of nodes for computation during this epoch:  5090819
Number of first layer input nodes during this epoch:  2471408
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11502218246459961  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021137714385986328
random selection method range initialization spend 0.00579071044921875
time for parepare:  0.018640518188476562
local_output_nid generation:  0.0024216175079345703
local_in_edges_tensor generation:  0.006541013717651367
mini_batch_src_global generation:  0.0015561580657958984
r_  generation:  0.018364429473876953
local_output_nid generation:  0.0029447078704833984
local_in_edges_tensor generation:  0.001680135726928711
mini_batch_src_global generation:  0.0018157958984375
r_  generation:  0.019687652587890625
local_output_nid generation:  0.0029325485229492188
local_in_edges_tensor generation:  0.0017077922821044922
mini_batch_src_global generation:  0.001531362533569336
r_  generation:  0.019298553466796875
local_output_nid generation:  0.0030040740966796875
local_in_edges_tensor generation:  0.0015566349029541016
mini_batch_src_global generation:  0.0015287399291992188
r_  generation:  0.018803119659423828
local_output_nid generation:  0.0029294490814208984
local_in_edges_tensor generation:  0.0015149116516113281
mini_batch_src_global generation:  0.0015501976013183594
r_  generation:  0.01859903335571289
local_output_nid generation:  0.0029344558715820312
local_in_edges_tensor generation:  0.0016262531280517578
mini_batch_src_global generation:  0.0015592575073242188
r_  generation:  0.019898653030395508
local_output_nid generation:  0.0029807090759277344
local_in_edges_tensor generation:  0.0015413761138916016
mini_batch_src_global generation:  0.0016007423400878906
r_  generation:  0.019767284393310547
local_output_nid generation:  0.003155946731567383
local_in_edges_tensor generation:  0.0015268325805664062
mini_batch_src_global generation:  0.0015320777893066406
r_  generation:  0.019075632095336914
local_output_nid generation:  0.0029714107513427734
local_in_edges_tensor generation:  0.0015435218811035156
mini_batch_src_global generation:  0.0015599727630615234
r_  generation:  0.01933765411376953
local_output_nid generation:  0.0029358863830566406
local_in_edges_tensor generation:  0.0014917850494384766
mini_batch_src_global generation:  0.0015473365783691406
r_  generation:  0.01925826072692871
local_output_nid generation:  0.002920389175415039
local_in_edges_tensor generation:  0.0014870166778564453
mini_batch_src_global generation:  0.0015692710876464844
r_  generation:  0.019615888595581055
local_output_nid generation:  0.002931833267211914
local_in_edges_tensor generation:  0.0015513896942138672
mini_batch_src_global generation:  0.0015571117401123047
r_  generation:  0.019999980926513672
local_output_nid generation:  0.0029516220092773438
local_in_edges_tensor generation:  0.0014948844909667969
mini_batch_src_global generation:  0.0015156269073486328
r_  generation:  0.018670082092285156
local_output_nid generation:  0.0029664039611816406
local_in_edges_tensor generation:  0.0014984607696533203
mini_batch_src_global generation:  0.0015609264373779297
r_  generation:  0.019290685653686523
local_output_nid generation:  0.002921581268310547
local_in_edges_tensor generation:  0.0015492439270019531
mini_batch_src_global generation:  0.0015404224395751953
r_  generation:  0.01922774314880371
local_output_nid generation:  0.002920866012573242
local_in_edges_tensor generation:  0.0015387535095214844
mini_batch_src_global generation:  0.0015594959259033203
r_  generation:  0.01931142807006836
----------------------check_connections_block total spend ----------------------------- 0.5078215599060059
generate_one_block  0.027089595794677734
generate_one_block  0.028022050857543945
generate_one_block  0.02819085121154785
generate_one_block  0.027472972869873047
generate_one_block  0.02733778953552246
generate_one_block  0.03112006187438965
generate_one_block  0.02837991714477539
generate_one_block  0.02727961540222168
generate_one_block  0.027829647064208984
generate_one_block  0.02746415138244629
generate_one_block  0.028195619583129883
generate_one_block  0.028272151947021484
generate_one_block  0.026906967163085938
generate_one_block  0.027462244033813477
generate_one_block  0.027463674545288086
generate_one_block  0.028407812118530273
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03250002861022949
gen group dst list time:  0.016152143478393555
time for parepare:  0.019360065460205078
local_output_nid generation:  0.008597135543823242
local_in_edges_tensor generation:  0.021862268447875977
mini_batch_src_global generation:  0.020683765411376953
r_  generation:  0.19086217880249023
local_output_nid generation:  0.012062788009643555
local_in_edges_tensor generation:  0.014340400695800781
mini_batch_src_global generation:  0.025092601776123047
r_  generation:  0.1971588134765625
local_output_nid generation:  0.012109756469726562
local_in_edges_tensor generation:  0.01190948486328125
mini_batch_src_global generation:  0.02512979507446289
r_  generation:  0.20869016647338867
local_output_nid generation:  0.012493133544921875
local_in_edges_tensor generation:  0.011988401412963867
mini_batch_src_global generation:  0.025118589401245117
r_  generation:  0.20176911354064941
local_output_nid generation:  0.01262807846069336
local_in_edges_tensor generation:  0.015076637268066406
mini_batch_src_global generation:  0.030527353286743164
r_  generation:  0.20539116859436035
local_output_nid generation:  0.012397527694702148
local_in_edges_tensor generation:  0.012157678604125977
mini_batch_src_global generation:  0.026338577270507812
r_  generation:  0.2129688262939453
local_output_nid generation:  0.012797117233276367
local_in_edges_tensor generation:  0.014002561569213867
mini_batch_src_global generation:  0.026598215103149414
r_  generation:  0.2139439582824707
local_output_nid generation:  0.012537956237792969
local_in_edges_tensor generation:  0.012001991271972656
mini_batch_src_global generation:  0.026391983032226562
r_  generation:  0.20699810981750488
local_output_nid generation:  0.01282501220703125
local_in_edges_tensor generation:  0.012192487716674805
mini_batch_src_global generation:  0.026361942291259766
r_  generation:  0.21337532997131348
local_output_nid generation:  0.012516498565673828
local_in_edges_tensor generation:  0.011890172958374023
mini_batch_src_global generation:  0.02585601806640625
r_  generation:  0.20755958557128906
local_output_nid generation:  0.012888908386230469
local_in_edges_tensor generation:  0.011911392211914062
mini_batch_src_global generation:  0.027019023895263672
r_  generation:  0.21545100212097168
local_output_nid generation:  0.01247859001159668
local_in_edges_tensor generation:  0.013061046600341797
mini_batch_src_global generation:  0.027931690216064453
r_  generation:  0.21565890312194824
local_output_nid generation:  0.01246786117553711
local_in_edges_tensor generation:  0.013329744338989258
mini_batch_src_global generation:  0.02601933479309082
r_  generation:  0.20475125312805176
local_output_nid generation:  0.012882709503173828
local_in_edges_tensor generation:  0.012211084365844727
mini_batch_src_global generation:  0.026504039764404297
r_  generation:  0.21241331100463867
local_output_nid generation:  0.012385368347167969
local_in_edges_tensor generation:  0.011609077453613281
mini_batch_src_global generation:  0.026962995529174805
r_  generation:  0.21090388298034668
local_output_nid generation:  0.012092828750610352
local_in_edges_tensor generation:  0.011685848236083984
mini_batch_src_global generation:  0.026422977447509766
r_  generation:  0.2113642692565918
----------------------check_connections_block total spend ----------------------------- 4.90504789352417
generate_one_block  0.27527713775634766
generate_one_block  0.2609541416168213
generate_one_block  0.2733299732208252
generate_one_block  0.26090407371520996
generate_one_block  0.2625601291656494
generate_one_block  0.272855281829834
generate_one_block  0.2902257442474365
generate_one_block  0.2617757320404053
generate_one_block  0.26737499237060547
generate_one_block  0.25949978828430176
generate_one_block  0.2688596248626709
generate_one_block  0.2758784294128418
generate_one_block  0.2570912837982178
generate_one_block  0.2685725688934326
generate_one_block  0.2652626037597656
generate_one_block  0.26511311531066895
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02854466438293457
gen group dst list time:  0.06259393692016602
time for parepare:  0.018695354461669922
local_output_nid generation:  0.026535511016845703
local_in_edges_tensor generation:  0.04026436805725098
mini_batch_src_global generation:  0.03952169418334961
r_  generation:  0.4387242794036865
local_output_nid generation:  0.031351566314697266
local_in_edges_tensor generation:  0.03609132766723633
mini_batch_src_global generation:  0.05161261558532715
r_  generation:  0.44533753395080566
local_output_nid generation:  0.03094196319580078
local_in_edges_tensor generation:  0.03227853775024414
mini_batch_src_global generation:  0.05689191818237305
r_  generation:  0.45385265350341797
local_output_nid generation:  0.030797243118286133
local_in_edges_tensor generation:  0.03130459785461426
mini_batch_src_global generation:  0.05360603332519531
r_  generation:  0.45060062408447266
local_output_nid generation:  0.03139901161193848
local_in_edges_tensor generation:  0.07053089141845703
mini_batch_src_global generation:  0.05112600326538086
r_  generation:  0.4531209468841553
local_output_nid generation:  0.03071737289428711
local_in_edges_tensor generation:  0.029543638229370117
mini_batch_src_global generation:  0.05255746841430664
r_  generation:  0.4605085849761963
local_output_nid generation:  0.0313105583190918
local_in_edges_tensor generation:  0.03200364112854004
mini_batch_src_global generation:  0.05221986770629883
r_  generation:  0.46230125427246094
local_output_nid generation:  0.0312345027923584
local_in_edges_tensor generation:  0.02918076515197754
mini_batch_src_global generation:  0.05276179313659668
r_  generation:  0.45108628273010254
local_output_nid generation:  0.031246185302734375
local_in_edges_tensor generation:  0.02848529815673828
mini_batch_src_global generation:  0.05386042594909668
r_  generation:  0.4589879512786865
local_output_nid generation:  0.030970096588134766
local_in_edges_tensor generation:  0.030827045440673828
mini_batch_src_global generation:  0.05240201950073242
r_  generation:  0.45556640625
local_output_nid generation:  0.03086400032043457
local_in_edges_tensor generation:  0.028921127319335938
mini_batch_src_global generation:  0.05152320861816406
r_  generation:  0.46042656898498535
local_output_nid generation:  0.031371355056762695
local_in_edges_tensor generation:  0.034696102142333984
mini_batch_src_global generation:  0.052892446517944336
r_  generation:  0.4555833339691162
local_output_nid generation:  0.030701875686645508
local_in_edges_tensor generation:  0.03078937530517578
mini_batch_src_global generation:  0.05086493492126465
r_  generation:  0.45942020416259766
local_output_nid generation:  0.031027793884277344
local_in_edges_tensor generation:  0.028841495513916016
mini_batch_src_global generation:  0.052034616470336914
r_  generation:  0.453472375869751
local_output_nid generation:  0.03091120719909668
local_in_edges_tensor generation:  0.02939915657043457
mini_batch_src_global generation:  0.0512995719909668
r_  generation:  0.4592008590698242
local_output_nid generation:  0.031105756759643555
local_in_edges_tensor generation:  0.028565645217895508
mini_batch_src_global generation:  0.05283045768737793
r_  generation:  0.450880765914917
----------------------check_connections_block total spend ----------------------------- 10.708401203155518
generate_one_block  0.5665268898010254
generate_one_block  0.5658953189849854
generate_one_block  0.5690302848815918
generate_one_block  0.5661160945892334
generate_one_block  0.5663666725158691
generate_one_block  0.5718724727630615
generate_one_block  0.5735161304473877
generate_one_block  0.5709757804870605
generate_one_block  0.6046054363250732
generate_one_block  0.5622661113739014
generate_one_block  0.5710227489471436
generate_one_block  0.5772538185119629
generate_one_block  0.5612940788269043
generate_one_block  0.5691144466400146
generate_one_block  0.5701305866241455
generate_one_block  0.5678262710571289
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11502218246459961  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

connection checking time:  15.613449096679688
block generation total time  13.419347763061523
average batch blocks generation time:  0.8387092351913452
block dataloader generation time/epoch 31.13020424048106
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09392976760864258  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7183380126953125  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09319829940795898  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7157473564147949  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09409904479980469  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7214946746826172  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09311723709106445  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7145252227783203  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09383106231689453  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7169995307922363  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0933537483215332  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7224087715148926  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09401988983154297  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7203822135925293  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09328413009643555  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7153439521789551  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09395885467529297  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7195982933044434  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09302949905395508  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7108335494995117  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09399890899658203  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7230668067932129  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09355592727661133  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7240586280822754  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0936441421508789  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.709928035736084  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09334039688110352  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7188339233398438  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09384536743164062  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7167773246765137  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0932168960571289  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7170953750610352  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06165994703769684 |0.0107230544090271 |0.003666132688522339 |9.368360042572021e-05 |0.003686249256134033 |0.0013849735260009766 |
----------------------------------------------------------pseudo_mini_loss sum 1.4309022426605225
Total (block generation + training)time/epoch 32.48492662111918
Training time/epoch 1.338660478591919
Training time without block to device /epoch 1.1670916080474854
Training time without total dataloading part /epoch 0.12052202224731445
load block tensor time/epoch 0.9865591526031494
block to device time/epoch 0.1715688705444336
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 15 |
Number of nodes for computation during this epoch:  5090971
Number of first layer input nodes during this epoch:  2470929
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11498498916625977  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019826412200927734
random selection method range initialization spend 0.005802154541015625
time for parepare:  0.018819570541381836
local_output_nid generation:  0.002312183380126953
local_in_edges_tensor generation:  0.003885984420776367
mini_batch_src_global generation:  0.0015707015991210938
r_  generation:  0.018440723419189453
local_output_nid generation:  0.002839803695678711
local_in_edges_tensor generation:  0.0016503334045410156
mini_batch_src_global generation:  0.0018596649169921875
r_  generation:  0.020390987396240234
local_output_nid generation:  0.002918243408203125
local_in_edges_tensor generation:  0.0016295909881591797
mini_batch_src_global generation:  0.0015075206756591797
r_  generation:  0.01898932456970215
local_output_nid generation:  0.002996683120727539
local_in_edges_tensor generation:  0.0015985965728759766
mini_batch_src_global generation:  0.001516580581665039
r_  generation:  0.018759727478027344
local_output_nid generation:  0.0029265880584716797
local_in_edges_tensor generation:  0.0015697479248046875
mini_batch_src_global generation:  0.0015137195587158203
r_  generation:  0.01935720443725586
local_output_nid generation:  0.002933502197265625
local_in_edges_tensor generation:  0.001520395278930664
mini_batch_src_global generation:  0.0015189647674560547
r_  generation:  0.019597291946411133
local_output_nid generation:  0.0029549598693847656
local_in_edges_tensor generation:  0.001550436019897461
mini_batch_src_global generation:  0.0015740394592285156
r_  generation:  0.019266366958618164
local_output_nid generation:  0.0029354095458984375
local_in_edges_tensor generation:  0.0015461444854736328
mini_batch_src_global generation:  0.0015475749969482422
r_  generation:  0.019231081008911133
local_output_nid generation:  0.0029392242431640625
local_in_edges_tensor generation:  0.0015566349029541016
mini_batch_src_global generation:  0.0015115737915039062
r_  generation:  0.019086122512817383
local_output_nid generation:  0.0029447078704833984
local_in_edges_tensor generation:  0.0015437602996826172
mini_batch_src_global generation:  0.0015151500701904297
r_  generation:  0.01937103271484375
local_output_nid generation:  0.002911090850830078
local_in_edges_tensor generation:  0.001432657241821289
mini_batch_src_global generation:  0.0015554428100585938
r_  generation:  0.019313335418701172
local_output_nid generation:  0.0029048919677734375
local_in_edges_tensor generation:  0.001481771469116211
mini_batch_src_global generation:  0.0015342235565185547
r_  generation:  0.019389629364013672
local_output_nid generation:  0.0029325485229492188
local_in_edges_tensor generation:  0.0014650821685791016
mini_batch_src_global generation:  0.001514434814453125
r_  generation:  0.01969766616821289
local_output_nid generation:  0.002917051315307617
local_in_edges_tensor generation:  0.0015118122100830078
mini_batch_src_global generation:  0.0015172958374023438
r_  generation:  0.01935601234436035
local_output_nid generation:  0.0029296875
local_in_edges_tensor generation:  0.0014848709106445312
mini_batch_src_global generation:  0.0015146732330322266
r_  generation:  0.019265174865722656
local_output_nid generation:  0.0029058456420898438
local_in_edges_tensor generation:  0.0014390945434570312
mini_batch_src_global generation:  0.0015106201171875
r_  generation:  0.01978778839111328
----------------------check_connections_block total spend ----------------------------- 0.5053913593292236
generate_one_block  0.027192354202270508
generate_one_block  0.027990102767944336
generate_one_block  0.027532339096069336
generate_one_block  0.027387142181396484
generate_one_block  0.02823805809020996
generate_one_block  0.030627727508544922
generate_one_block  0.027909517288208008
generate_one_block  0.027435302734375
generate_one_block  0.027495622634887695
generate_one_block  0.027320146560668945
generate_one_block  0.027700185775756836
generate_one_block  0.027555465698242188
generate_one_block  0.02791905403137207
generate_one_block  0.027379989624023438
generate_one_block  0.027567386627197266
generate_one_block  0.028319835662841797
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0354456901550293
gen group dst list time:  0.01606583595275879
time for parepare:  0.019403934478759766
local_output_nid generation:  0.008410930633544922
local_in_edges_tensor generation:  0.019663333892822266
mini_batch_src_global generation:  0.020441770553588867
r_  generation:  0.1912696361541748
local_output_nid generation:  0.012165069580078125
local_in_edges_tensor generation:  0.015622377395629883
mini_batch_src_global generation:  0.025685787200927734
r_  generation:  0.20319008827209473
local_output_nid generation:  0.01184535026550293
local_in_edges_tensor generation:  0.012142181396484375
mini_batch_src_global generation:  0.024062633514404297
r_  generation:  0.20725703239440918
local_output_nid generation:  0.01237630844116211
local_in_edges_tensor generation:  0.013376712799072266
mini_batch_src_global generation:  0.024517297744750977
r_  generation:  0.2047562599182129
local_output_nid generation:  0.012618780136108398
local_in_edges_tensor generation:  0.012069225311279297
mini_batch_src_global generation:  0.026085853576660156
r_  generation:  0.21333837509155273
local_output_nid generation:  0.012410163879394531
local_in_edges_tensor generation:  0.012061119079589844
mini_batch_src_global generation:  0.025866270065307617
r_  generation:  0.2098989486694336
local_output_nid generation:  0.012540102005004883
local_in_edges_tensor generation:  0.011855125427246094
mini_batch_src_global generation:  0.02613091468811035
r_  generation:  0.20809197425842285
local_output_nid generation:  0.01266169548034668
local_in_edges_tensor generation:  0.012396574020385742
mini_batch_src_global generation:  0.025971651077270508
r_  generation:  0.20947885513305664
local_output_nid generation:  0.012613534927368164
local_in_edges_tensor generation:  0.011837005615234375
mini_batch_src_global generation:  0.026244163513183594
r_  generation:  0.210554838180542
local_output_nid generation:  0.012485265731811523
local_in_edges_tensor generation:  0.011750221252441406
mini_batch_src_global generation:  0.027436017990112305
r_  generation:  0.2131037712097168
local_output_nid generation:  0.013148784637451172
local_in_edges_tensor generation:  0.011700630187988281
mini_batch_src_global generation:  0.026419639587402344
r_  generation:  0.2127852439880371
local_output_nid generation:  0.012307167053222656
local_in_edges_tensor generation:  0.012718677520751953
mini_batch_src_global generation:  0.026525497436523438
r_  generation:  0.21263623237609863
local_output_nid generation:  0.012679576873779297
local_in_edges_tensor generation:  0.012601613998413086
mini_batch_src_global generation:  0.02739095687866211
r_  generation:  0.21561360359191895
local_output_nid generation:  0.012622833251953125
local_in_edges_tensor generation:  0.011906147003173828
mini_batch_src_global generation:  0.026607751846313477
r_  generation:  0.21586251258850098
local_output_nid generation:  0.012363433837890625
local_in_edges_tensor generation:  0.011760950088500977
mini_batch_src_global generation:  0.026682376861572266
r_  generation:  0.21410799026489258
local_output_nid generation:  0.012018442153930664
local_in_edges_tensor generation:  0.012585878372192383
mini_batch_src_global generation:  0.026516199111938477
r_  generation:  0.21344709396362305
----------------------check_connections_block total spend ----------------------------- 4.926666498184204
generate_one_block  0.2666339874267578
generate_one_block  0.2669868469238281
generate_one_block  0.2671689987182617
generate_one_block  0.26488280296325684
generate_one_block  0.27024173736572266
generate_one_block  0.2665517330169678
generate_one_block  0.2840299606323242
generate_one_block  0.26453137397766113
generate_one_block  0.2652597427368164
generate_one_block  0.2642641067504883
generate_one_block  0.26754307746887207
generate_one_block  0.267775297164917
generate_one_block  0.2708606719970703
generate_one_block  0.2687368392944336
generate_one_block  0.26778340339660645
generate_one_block  0.26821279525756836
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.031507253646850586
gen group dst list time:  0.06574010848999023
time for parepare:  0.01760387420654297
local_output_nid generation:  0.025290489196777344
local_in_edges_tensor generation:  0.04494643211364746
mini_batch_src_global generation:  0.04125618934631348
r_  generation:  0.4445152282714844
local_output_nid generation:  0.031190872192382812
local_in_edges_tensor generation:  0.03799772262573242
mini_batch_src_global generation:  0.061370849609375
r_  generation:  0.4445338249206543
local_output_nid generation:  0.03183317184448242
local_in_edges_tensor generation:  0.029222726821899414
mini_batch_src_global generation:  0.05199432373046875
r_  generation:  0.45453763008117676
local_output_nid generation:  0.031416893005371094
local_in_edges_tensor generation:  0.029097795486450195
mini_batch_src_global generation:  0.05182361602783203
r_  generation:  0.4554581642150879
local_output_nid generation:  0.03131508827209473
local_in_edges_tensor generation:  0.07369565963745117
mini_batch_src_global generation:  0.051793575286865234
r_  generation:  0.4568467140197754
local_output_nid generation:  0.031203508377075195
local_in_edges_tensor generation:  0.029242992401123047
mini_batch_src_global generation:  0.05237746238708496
r_  generation:  0.4494929313659668
local_output_nid generation:  0.031192541122436523
local_in_edges_tensor generation:  0.028667688369750977
mini_batch_src_global generation:  0.05155825614929199
r_  generation:  0.4522111415863037
local_output_nid generation:  0.03141331672668457
local_in_edges_tensor generation:  0.030539512634277344
mini_batch_src_global generation:  0.05160641670227051
r_  generation:  0.4477193355560303
local_output_nid generation:  0.031553030014038086
local_in_edges_tensor generation:  0.03249073028564453
mini_batch_src_global generation:  0.05074906349182129
r_  generation:  0.45498180389404297
local_output_nid generation:  0.03137540817260742
local_in_edges_tensor generation:  0.028319120407104492
mini_batch_src_global generation:  0.05267143249511719
r_  generation:  0.44876718521118164
local_output_nid generation:  0.03150677680969238
local_in_edges_tensor generation:  0.03478384017944336
mini_batch_src_global generation:  0.055304765701293945
r_  generation:  0.45594191551208496
local_output_nid generation:  0.031166791915893555
local_in_edges_tensor generation:  0.030954837799072266
mini_batch_src_global generation:  0.05235743522644043
r_  generation:  0.45175743103027344
local_output_nid generation:  0.03159379959106445
local_in_edges_tensor generation:  0.028347492218017578
mini_batch_src_global generation:  0.051358699798583984
r_  generation:  0.4564321041107178
local_output_nid generation:  0.03164029121398926
local_in_edges_tensor generation:  0.028995037078857422
mini_batch_src_global generation:  0.05262637138366699
r_  generation:  0.4515504837036133
local_output_nid generation:  0.031775712966918945
local_in_edges_tensor generation:  0.032415151596069336
mini_batch_src_global generation:  0.06587672233581543
r_  generation:  0.4558417797088623
local_output_nid generation:  0.031416893005371094
local_in_edges_tensor generation:  0.02930593490600586
mini_batch_src_global generation:  0.05243992805480957
r_  generation:  0.4526364803314209
----------------------check_connections_block total spend ----------------------------- 10.695459604263306
generate_one_block  0.5765907764434814
generate_one_block  0.5784249305725098
generate_one_block  0.5729997158050537
generate_one_block  0.5717377662658691
generate_one_block  0.5791079998016357
generate_one_block  0.5712957382202148
generate_one_block  0.568289041519165
generate_one_block  0.5745987892150879
generate_one_block  0.6296615600585938
generate_one_block  0.5851507186889648
generate_one_block  0.5841491222381592
generate_one_block  0.5742104053497314
generate_one_block  0.5743749141693115
generate_one_block  0.5856442451477051
generate_one_block  0.586453914642334
generate_one_block  0.5697789192199707
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11498498916625977  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

connection checking time:  15.62212610244751
block generation total time  13.57393193244934
average batch blocks generation time:  0.8483707457780838
block dataloader generation time/epoch 31.136688334601267
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09388017654418945  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7187199592590332  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09355831146240234  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7206306457519531  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09391498565673828  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7187032699584961  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09329795837402344  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7153425216674805  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09400177001953125  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7204818725585938  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09331703186035156  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7177844047546387  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09379291534423828  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7129359245300293  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09346818923950195  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7165102958679199  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09384918212890625  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7178425788879395  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0932459831237793  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7159337997436523  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09390544891357422  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7176513671875  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09326934814453125  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7160954475402832  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09398174285888672  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7184581756591797  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09337234497070312  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.716700553894043  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09392070770263672  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7181224822998047  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09337472915649414  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.71759033203125  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06285572052001953 |0.00954805314540863 |0.003619059920310974 |9.34898853302002e-05 |0.0036739110946655273 |0.002871274948120117 |
----------------------------------------------------------pseudo_mini_loss sum 1.399437427520752
Total (block generation + training)time/epoch 32.501152583530974
Training time/epoch 1.4226932525634766
Training time without block to device /epoch 1.2699244022369385
Training time without total dataloading part /epoch 0.12105464935302734
load block tensor time/epoch 1.0056915283203125
block to device time/epoch 0.15276885032653809
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 16 |
Number of nodes for computation during this epoch:  5092010
Number of first layer input nodes during this epoch:  2472447
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11520195007324219  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01854252815246582
random selection method range initialization spend 0.005747318267822266
time for parepare:  0.016858816146850586
local_output_nid generation:  0.002367734909057617
local_in_edges_tensor generation:  0.0038077831268310547
mini_batch_src_global generation:  0.001539468765258789
r_  generation:  0.018146276473999023
local_output_nid generation:  0.0028765201568603516
local_in_edges_tensor generation:  0.0016396045684814453
mini_batch_src_global generation:  0.0018563270568847656
r_  generation:  0.019598007202148438
local_output_nid generation:  0.002966165542602539
local_in_edges_tensor generation:  0.0016071796417236328
mini_batch_src_global generation:  0.0015153884887695312
r_  generation:  0.01923966407775879
local_output_nid generation:  0.0029811859130859375
local_in_edges_tensor generation:  0.0016067028045654297
mini_batch_src_global generation:  0.0015475749969482422
r_  generation:  0.018916845321655273
local_output_nid generation:  0.002980470657348633
local_in_edges_tensor generation:  0.0015881061553955078
mini_batch_src_global generation:  0.0015270709991455078
r_  generation:  0.018945932388305664
local_output_nid generation:  0.003067493438720703
local_in_edges_tensor generation:  0.0016012191772460938
mini_batch_src_global generation:  0.0015676021575927734
r_  generation:  0.019242286682128906
local_output_nid generation:  0.0030274391174316406
local_in_edges_tensor generation:  0.001598358154296875
mini_batch_src_global generation:  0.0015401840209960938
r_  generation:  0.019466876983642578
local_output_nid generation:  0.0030450820922851562
local_in_edges_tensor generation:  0.0014691352844238281
mini_batch_src_global generation:  0.0015523433685302734
r_  generation:  0.019541501998901367
local_output_nid generation:  0.0029630661010742188
local_in_edges_tensor generation:  0.0015170574188232422
mini_batch_src_global generation:  0.001535654067993164
r_  generation:  0.019416332244873047
local_output_nid generation:  0.0029621124267578125
local_in_edges_tensor generation:  0.0014951229095458984
mini_batch_src_global generation:  0.0015065670013427734
r_  generation:  0.019499540328979492
local_output_nid generation:  0.0029892921447753906
local_in_edges_tensor generation:  0.0014450550079345703
mini_batch_src_global generation:  0.0015323162078857422
r_  generation:  0.01956033706665039
local_output_nid generation:  0.0030715465545654297
local_in_edges_tensor generation:  0.001462697982788086
mini_batch_src_global generation:  0.0015196800231933594
r_  generation:  0.01962733268737793
local_output_nid generation:  0.003003358840942383
local_in_edges_tensor generation:  0.0015294551849365234
mini_batch_src_global generation:  0.001556396484375
r_  generation:  0.019112110137939453
local_output_nid generation:  0.0029795169830322266
local_in_edges_tensor generation:  0.0015397071838378906
mini_batch_src_global generation:  0.0014858245849609375
r_  generation:  0.01881718635559082
local_output_nid generation:  0.0029447078704833984
local_in_edges_tensor generation:  0.001463174819946289
mini_batch_src_global generation:  0.001554250717163086
r_  generation:  0.019588470458984375
local_output_nid generation:  0.0029239654541015625
local_in_edges_tensor generation:  0.0014913082122802734
mini_batch_src_global generation:  0.0015268325805664062
r_  generation:  0.019054412841796875
----------------------check_connections_block total spend ----------------------------- 0.5028891563415527
generate_one_block  0.026556968688964844
generate_one_block  0.02820134162902832
generate_one_block  0.02791881561279297
generate_one_block  0.02775406837463379
generate_one_block  0.027585744857788086
generate_one_block  0.030638933181762695
generate_one_block  0.027878522872924805
generate_one_block  0.02793407440185547
generate_one_block  0.028066396713256836
generate_one_block  0.027766942977905273
generate_one_block  0.02762150764465332
generate_one_block  0.02803206443786621
generate_one_block  0.028095722198486328
generate_one_block  0.027371644973754883
generate_one_block  0.02820897102355957
generate_one_block  0.027858257293701172
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03082108497619629
gen group dst list time:  0.016602516174316406
time for parepare:  0.019090890884399414
local_output_nid generation:  0.008251428604125977
local_in_edges_tensor generation:  0.018447160720825195
mini_batch_src_global generation:  0.02005743980407715
r_  generation:  0.1857752799987793
local_output_nid generation:  0.01220846176147461
local_in_edges_tensor generation:  0.013826847076416016
mini_batch_src_global generation:  0.029503583908081055
r_  generation:  0.20100998878479004
local_output_nid generation:  0.012006759643554688
local_in_edges_tensor generation:  0.01288461685180664
mini_batch_src_global generation:  0.024924039840698242
r_  generation:  0.20465683937072754
local_output_nid generation:  0.012638092041015625
local_in_edges_tensor generation:  0.012898921966552734
mini_batch_src_global generation:  0.024184226989746094
r_  generation:  0.207183837890625
local_output_nid generation:  0.012632131576538086
local_in_edges_tensor generation:  0.014464616775512695
mini_batch_src_global generation:  0.026538372039794922
r_  generation:  0.2041950225830078
local_output_nid generation:  0.012463808059692383
local_in_edges_tensor generation:  0.012131214141845703
mini_batch_src_global generation:  0.026098966598510742
r_  generation:  0.20751357078552246
local_output_nid generation:  0.01250600814819336
local_in_edges_tensor generation:  0.011787652969360352
mini_batch_src_global generation:  0.028110265731811523
r_  generation:  0.20963072776794434
local_output_nid generation:  0.012566328048706055
local_in_edges_tensor generation:  0.012060165405273438
mini_batch_src_global generation:  0.026051759719848633
r_  generation:  0.2105724811553955
local_output_nid generation:  0.012792110443115234
local_in_edges_tensor generation:  0.01192784309387207
mini_batch_src_global generation:  0.027170896530151367
r_  generation:  0.21444106101989746
local_output_nid generation:  0.013527631759643555
local_in_edges_tensor generation:  0.01229095458984375
mini_batch_src_global generation:  0.02633047103881836
r_  generation:  0.21210432052612305
local_output_nid generation:  0.012228012084960938
local_in_edges_tensor generation:  0.012784481048583984
mini_batch_src_global generation:  0.026572227478027344
r_  generation:  0.21115612983703613
local_output_nid generation:  0.012610912322998047
local_in_edges_tensor generation:  0.011525630950927734
mini_batch_src_global generation:  0.027689695358276367
r_  generation:  0.21452546119689941
local_output_nid generation:  0.012695550918579102
local_in_edges_tensor generation:  0.012865543365478516
mini_batch_src_global generation:  0.027547121047973633
r_  generation:  0.21204614639282227
local_output_nid generation:  0.012359142303466797
local_in_edges_tensor generation:  0.013838052749633789
mini_batch_src_global generation:  0.02603626251220703
r_  generation:  0.2048344612121582
local_output_nid generation:  0.0129241943359375
local_in_edges_tensor generation:  0.012526750564575195
mini_batch_src_global generation:  0.027474641799926758
r_  generation:  0.21750760078430176
local_output_nid generation:  0.0121917724609375
local_in_edges_tensor generation:  0.012463569641113281
mini_batch_src_global generation:  0.029979228973388672
r_  generation:  0.20988798141479492
----------------------check_connections_block total spend ----------------------------- 4.91651725769043
generate_one_block  0.257587194442749
generate_one_block  0.2654893398284912
generate_one_block  0.2685980796813965
generate_one_block  0.2670578956604004
generate_one_block  0.2610747814178467
generate_one_block  0.26679086685180664
generate_one_block  0.2918128967285156
generate_one_block  0.26828432083129883
generate_one_block  0.27171754837036133
generate_one_block  0.26805686950683594
generate_one_block  0.26572084426879883
generate_one_block  0.2674276828765869
generate_one_block  0.2676103115081787
generate_one_block  0.2569901943206787
generate_one_block  0.27918291091918945
generate_one_block  0.2632148265838623
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03427839279174805
gen group dst list time:  0.06210207939147949
time for parepare:  0.01937556266784668
local_output_nid generation:  0.02562999725341797
local_in_edges_tensor generation:  0.04340004920959473
mini_batch_src_global generation:  0.041606903076171875
r_  generation:  0.437227725982666
local_output_nid generation:  0.031568288803100586
local_in_edges_tensor generation:  0.033339738845825195
mini_batch_src_global generation:  0.052605390548706055
r_  generation:  0.4385535717010498
local_output_nid generation:  0.03123950958251953
local_in_edges_tensor generation:  0.0310213565826416
mini_batch_src_global generation:  0.05190896987915039
r_  generation:  0.4546778202056885
local_output_nid generation:  0.03136253356933594
local_in_edges_tensor generation:  0.03231453895568848
mini_batch_src_global generation:  0.05263805389404297
r_  generation:  0.4466230869293213
local_output_nid generation:  0.03129458427429199
local_in_edges_tensor generation:  0.06939363479614258
mini_batch_src_global generation:  0.050359487533569336
r_  generation:  0.45166969299316406
local_output_nid generation:  0.03136706352233887
local_in_edges_tensor generation:  0.030172348022460938
mini_batch_src_global generation:  0.05378365516662598
r_  generation:  0.4515409469604492
local_output_nid generation:  0.03103780746459961
local_in_edges_tensor generation:  0.033742427825927734
mini_batch_src_global generation:  0.0508272647857666
r_  generation:  0.45613884925842285
local_output_nid generation:  0.031059980392456055
local_in_edges_tensor generation:  0.029478073120117188
mini_batch_src_global generation:  0.05388641357421875
r_  generation:  0.44791173934936523
local_output_nid generation:  0.031189918518066406
local_in_edges_tensor generation:  0.028946638107299805
mini_batch_src_global generation:  0.0513308048248291
r_  generation:  0.45650696754455566
local_output_nid generation:  0.0344386100769043
local_in_edges_tensor generation:  0.03055429458618164
mini_batch_src_global generation:  0.05256199836730957
r_  generation:  0.44576287269592285
local_output_nid generation:  0.03130936622619629
local_in_edges_tensor generation:  0.029422998428344727
mini_batch_src_global generation:  0.05396270751953125
r_  generation:  0.45494556427001953
local_output_nid generation:  0.031023740768432617
local_in_edges_tensor generation:  0.028445005416870117
mini_batch_src_global generation:  0.05259251594543457
r_  generation:  0.4502840042114258
local_output_nid generation:  0.031078338623046875
local_in_edges_tensor generation:  0.030628442764282227
mini_batch_src_global generation:  0.05408906936645508
r_  generation:  0.45931220054626465
local_output_nid generation:  0.030957937240600586
local_in_edges_tensor generation:  0.03151416778564453
mini_batch_src_global generation:  0.052594661712646484
r_  generation:  0.44755077362060547
local_output_nid generation:  0.031186819076538086
local_in_edges_tensor generation:  0.0325160026550293
mini_batch_src_global generation:  0.05160808563232422
r_  generation:  0.4600062370300293
local_output_nid generation:  0.03116321563720703
local_in_edges_tensor generation:  0.031609535217285156
mini_batch_src_global generation:  0.05225872993469238
r_  generation:  0.45354151725769043
----------------------check_connections_block total spend ----------------------------- 10.67313528060913
generate_one_block  0.5673801898956299
generate_one_block  0.57305908203125
generate_one_block  0.5760180950164795
generate_one_block  0.5819277763366699
generate_one_block  0.5671238899230957
generate_one_block  0.5751438140869141
generate_one_block  0.5701594352722168
generate_one_block  0.5713541507720947
generate_one_block  0.6209979057312012
generate_one_block  0.567497730255127
generate_one_block  0.584496259689331
generate_one_block  0.5738463401794434
generate_one_block  0.5691218376159668
generate_one_block  0.5671219825744629
generate_one_block  0.5831553936004639
generate_one_block  0.5686619281768799
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11520195007324219  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

connection checking time:  15.58965253829956
block generation total time  13.503682374954224
average batch blocks generation time:  0.843980148434639
block dataloader generation time/epoch 31.128285259008408
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09364557266235352  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7110300064086914  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09318161010742188  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7172775268554688  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09396839141845703  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.721198558807373  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09335899353027344  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7196154594421387  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0937662124633789  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7160773277282715  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09339618682861328  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7175402641296387  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09389305114746094  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7137618064880371  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09332895278930664  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7178339958190918  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09402847290039062  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7232198715209961  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09323978424072266  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7140922546386719  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09392642974853516  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7179117202758789  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09328985214233398  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.717961311340332  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09391498565673828  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7184205055236816  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09301137924194336  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7095823287963867  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0941152572631836  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7233786582946777  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09326839447021484  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7158875465393066  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06238304078578949 |0.0107756108045578 |0.003648236393928528 |9.334087371826172e-05 |0.0036805272102355957 |0.002902507781982422 |
----------------------------------------------------------pseudo_mini_loss sum 1.374987244606018
Total (block generation + training)time/epoch 32.49092397093773
Training time/epoch 1.3496458530426025
Training time without block to device /epoch 1.1772360801696777
Training time without total dataloading part /epoch 0.12165617942810059
load block tensor time/epoch 0.9981286525726318
block to device time/epoch 0.1724097728729248
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 17 |
Number of nodes for computation during this epoch:  5090404
Number of first layer input nodes during this epoch:  2470922
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11490869522094727  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01984691619873047
random selection method range initialization spend 0.0052793025970458984
time for parepare:  0.021162033081054688
local_output_nid generation:  0.0030236244201660156
local_in_edges_tensor generation:  0.0048370361328125
mini_batch_src_global generation:  0.002066373825073242
r_  generation:  0.01956009864807129
local_output_nid generation:  0.0038497447967529297
local_in_edges_tensor generation:  0.002138853073120117
mini_batch_src_global generation:  0.002246379852294922
r_  generation:  0.021364212036132812
local_output_nid generation:  0.00411224365234375
local_in_edges_tensor generation:  0.0020647048950195312
mini_batch_src_global generation:  0.001636505126953125
r_  generation:  0.01920914649963379
local_output_nid generation:  0.004141569137573242
local_in_edges_tensor generation:  0.002077341079711914
mini_batch_src_global generation:  0.0016679763793945312
r_  generation:  0.019535541534423828
local_output_nid generation:  0.004194498062133789
local_in_edges_tensor generation:  0.002090930938720703
mini_batch_src_global generation:  0.0017240047454833984
r_  generation:  0.020413875579833984
local_output_nid generation:  0.004235744476318359
local_in_edges_tensor generation:  0.0021505355834960938
mini_batch_src_global generation:  0.0017020702362060547
r_  generation:  0.019952058792114258
local_output_nid generation:  0.004368305206298828
local_in_edges_tensor generation:  0.0020923614501953125
mini_batch_src_global generation:  0.0016543865203857422
r_  generation:  0.02016162872314453
local_output_nid generation:  0.004229307174682617
local_in_edges_tensor generation:  0.0020279884338378906
mini_batch_src_global generation:  0.001664876937866211
r_  generation:  0.01957869529724121
local_output_nid generation:  0.004113435745239258
local_in_edges_tensor generation:  0.001973390579223633
mini_batch_src_global generation:  0.0016536712646484375
r_  generation:  0.01926255226135254
local_output_nid generation:  0.004182577133178711
local_in_edges_tensor generation:  0.0019903182983398438
mini_batch_src_global generation:  0.001688241958618164
r_  generation:  0.020025014877319336
local_output_nid generation:  0.004351615905761719
local_in_edges_tensor generation:  0.002048015594482422
mini_batch_src_global generation:  0.0016672611236572266
r_  generation:  0.019759654998779297
local_output_nid generation:  0.004229068756103516
local_in_edges_tensor generation:  0.0021495819091796875
mini_batch_src_global generation:  0.001680135726928711
r_  generation:  0.02042388916015625
local_output_nid generation:  0.004219770431518555
local_in_edges_tensor generation:  0.001975536346435547
mini_batch_src_global generation:  0.0016956329345703125
r_  generation:  0.020112991333007812
local_output_nid generation:  0.004354715347290039
local_in_edges_tensor generation:  0.0020852088928222656
mini_batch_src_global generation:  0.001691579818725586
r_  generation:  0.020128726959228516
local_output_nid generation:  0.00428009033203125
local_in_edges_tensor generation:  0.0019812583923339844
mini_batch_src_global generation:  0.0016756057739257812
r_  generation:  0.020272493362426758
local_output_nid generation:  0.004225015640258789
local_in_edges_tensor generation:  0.0020017623901367188
mini_batch_src_global generation:  0.0017452239990234375
r_  generation:  0.020425796508789062
----------------------check_connections_block total spend ----------------------------- 0.5601654052734375
generate_one_block  0.0384061336517334
generate_one_block  0.029719114303588867
generate_one_block  0.028548717498779297
generate_one_block  0.029129981994628906
generate_one_block  0.03219914436340332
generate_one_block  0.044504642486572266
generate_one_block  0.028454065322875977
generate_one_block  0.027408838272094727
generate_one_block  0.0269317626953125
generate_one_block  0.027576446533203125
generate_one_block  0.027478456497192383
generate_one_block  0.02814507484436035
generate_one_block  0.027360916137695312
generate_one_block  0.02746272087097168
generate_one_block  0.027626514434814453
generate_one_block  0.02848219871520996
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.031595706939697266
gen group dst list time:  0.015561580657958984
time for parepare:  0.01953887939453125
local_output_nid generation:  0.008418560028076172
local_in_edges_tensor generation:  0.020442724227905273
mini_batch_src_global generation:  0.020761489868164062
r_  generation:  0.19431447982788086
local_output_nid generation:  0.012211799621582031
local_in_edges_tensor generation:  0.013062715530395508
mini_batch_src_global generation:  0.024381637573242188
r_  generation:  0.20318198204040527
local_output_nid generation:  0.011723041534423828
local_in_edges_tensor generation:  0.013862371444702148
mini_batch_src_global generation:  0.024420738220214844
r_  generation:  0.20114850997924805
local_output_nid generation:  0.012544393539428711
local_in_edges_tensor generation:  0.015203237533569336
mini_batch_src_global generation:  0.02645254135131836
r_  generation:  0.20931005477905273
local_output_nid generation:  0.012662649154663086
local_in_edges_tensor generation:  0.013692855834960938
mini_batch_src_global generation:  0.026062726974487305
r_  generation:  0.2137775421142578
local_output_nid generation:  0.012329339981079102
local_in_edges_tensor generation:  0.012266159057617188
mini_batch_src_global generation:  0.02568364143371582
r_  generation:  0.2156846523284912
local_output_nid generation:  0.012659072875976562
local_in_edges_tensor generation:  0.01903367042541504
mini_batch_src_global generation:  0.027263164520263672
r_  generation:  0.2142784595489502
local_output_nid generation:  0.012476444244384766
local_in_edges_tensor generation:  0.01372385025024414
mini_batch_src_global generation:  0.026219606399536133
r_  generation:  0.21500277519226074
local_output_nid generation:  0.012427091598510742
local_in_edges_tensor generation:  0.01503896713256836
mini_batch_src_global generation:  0.026745319366455078
r_  generation:  0.21225643157958984
local_output_nid generation:  0.01350545883178711
local_in_edges_tensor generation:  0.013231039047241211
mini_batch_src_global generation:  0.027570009231567383
r_  generation:  0.22339749336242676
local_output_nid generation:  0.014678001403808594
local_in_edges_tensor generation:  0.0140228271484375
mini_batch_src_global generation:  0.02609872817993164
r_  generation:  0.20954537391662598
local_output_nid generation:  0.012997150421142578
local_in_edges_tensor generation:  0.012836933135986328
mini_batch_src_global generation:  0.02766871452331543
r_  generation:  0.2137923240661621
local_output_nid generation:  0.012809514999389648
local_in_edges_tensor generation:  0.012135744094848633
mini_batch_src_global generation:  0.026899099349975586
r_  generation:  0.20978188514709473
local_output_nid generation:  0.012880325317382812
local_in_edges_tensor generation:  0.011829376220703125
mini_batch_src_global generation:  0.027400493621826172
r_  generation:  0.20980191230773926
local_output_nid generation:  0.012962818145751953
local_in_edges_tensor generation:  0.013431310653686523
mini_batch_src_global generation:  0.026986360549926758
r_  generation:  0.2144474983215332
local_output_nid generation:  0.012939214706420898
local_in_edges_tensor generation:  0.013648748397827148
mini_batch_src_global generation:  0.026707172393798828
r_  generation:  0.2126166820526123
----------------------check_connections_block total spend ----------------------------- 4.987207412719727
generate_one_block  0.2700672149658203
generate_one_block  0.2687222957611084
generate_one_block  0.2640211582183838
generate_one_block  0.2662353515625
generate_one_block  0.270122766494751
generate_one_block  0.2687556743621826
generate_one_block  0.29358935356140137
generate_one_block  0.2650890350341797
generate_one_block  0.2583029270172119
generate_one_block  0.2704348564147949
generate_one_block  0.2726445198059082
generate_one_block  0.2759816646575928
generate_one_block  0.26571059226989746
generate_one_block  0.26735830307006836
generate_one_block  0.27135562896728516
generate_one_block  0.27094030380249023
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03741025924682617
gen group dst list time:  0.06193041801452637
time for parepare:  0.017959117889404297
local_output_nid generation:  0.025373458862304688
local_in_edges_tensor generation:  0.05070781707763672
mini_batch_src_global generation:  0.041410207748413086
r_  generation:  0.4444105625152588
local_output_nid generation:  0.042174339294433594
local_in_edges_tensor generation:  0.03658938407897949
mini_batch_src_global generation:  0.050946712493896484
r_  generation:  0.4428582191467285
local_output_nid generation:  0.030400991439819336
local_in_edges_tensor generation:  0.031651973724365234
mini_batch_src_global generation:  0.050095558166503906
r_  generation:  0.4543263912200928
local_output_nid generation:  0.03116631507873535
local_in_edges_tensor generation:  0.039038896560668945
mini_batch_src_global generation:  0.05231475830078125
r_  generation:  0.44669175148010254
local_output_nid generation:  0.030956745147705078
local_in_edges_tensor generation:  0.0814971923828125
mini_batch_src_global generation:  0.051156044006347656
r_  generation:  0.46314024925231934
local_output_nid generation:  0.03147530555725098
local_in_edges_tensor generation:  0.038262367248535156
mini_batch_src_global generation:  0.0520634651184082
r_  generation:  0.46394777297973633
local_output_nid generation:  0.03287959098815918
local_in_edges_tensor generation:  0.03563642501831055
mini_batch_src_global generation:  0.05232572555541992
r_  generation:  0.4541196823120117
local_output_nid generation:  0.03157997131347656
local_in_edges_tensor generation:  0.030420541763305664
mini_batch_src_global generation:  0.055764198303222656
r_  generation:  0.44562482833862305
local_output_nid generation:  0.03135180473327637
local_in_edges_tensor generation:  0.029043197631835938
mini_batch_src_global generation:  0.051290273666381836
r_  generation:  0.45325541496276855
local_output_nid generation:  0.03156542778015137
local_in_edges_tensor generation:  0.03287529945373535
mini_batch_src_global generation:  0.05312609672546387
r_  generation:  0.4503452777862549
local_output_nid generation:  0.03174138069152832
local_in_edges_tensor generation:  0.03132271766662598
mini_batch_src_global generation:  0.05161738395690918
r_  generation:  0.45883965492248535
local_output_nid generation:  0.031905412673950195
local_in_edges_tensor generation:  0.02902364730834961
mini_batch_src_global generation:  0.05466818809509277
r_  generation:  0.4617044925689697
local_output_nid generation:  0.03212928771972656
local_in_edges_tensor generation:  0.029006481170654297
mini_batch_src_global generation:  0.05181622505187988
r_  generation:  0.4557070732116699
local_output_nid generation:  0.031760215759277344
local_in_edges_tensor generation:  0.029017925262451172
mini_batch_src_global generation:  0.05446338653564453
r_  generation:  0.44791626930236816
local_output_nid generation:  0.03189587593078613
local_in_edges_tensor generation:  0.03293132781982422
mini_batch_src_global generation:  0.05198049545288086
r_  generation:  0.459322452545166
local_output_nid generation:  0.0318455696105957
local_in_edges_tensor generation:  0.0388646125793457
mini_batch_src_global generation:  0.0530543327331543
r_  generation:  0.44793152809143066
----------------------check_connections_block total spend ----------------------------- 10.781883239746094
generate_one_block  0.587639570236206
generate_one_block  0.5732972621917725
generate_one_block  0.5768978595733643
generate_one_block  0.5846195220947266
generate_one_block  0.5805444717407227
generate_one_block  0.5748152732849121
generate_one_block  0.578894853591919
generate_one_block  0.568737268447876
generate_one_block  0.6393072605133057
generate_one_block  0.5747559070587158
generate_one_block  0.5706095695495605
generate_one_block  0.591921329498291
generate_one_block  0.5679728984832764
generate_one_block  0.568594217300415
generate_one_block  0.579063892364502
generate_one_block  0.5838863849639893
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11490869522094727  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

connection checking time:  15.76909065246582
block generation total time  13.62088918685913
average batch blocks generation time:  0.8513055741786957
block dataloader generation time/epoch 31.170926279491848
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09400415420532227  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7193083763122559  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09348201751708984  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.723203182220459  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09375953674316406  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7100400924682617  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09333324432373047  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7183070182800293  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09395790100097656  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.719672679901123  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09347248077392578  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7179207801818848  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09392261505126953  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7178382873535156  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09322118759155273  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7162022590637207  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09375858306884766  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7147741317749023  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09343481063842773  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7190718650817871  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09378719329833984  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7121720314025879  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09351968765258789  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7244329452514648  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0938100814819336  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7128543853759766  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09317398071289062  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7165727615356445  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09400177001953125  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7194218635559082  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09336280822753906  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7180352210998535  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06275534629821777 |0.011730238795280457 |0.0036636292934417725 |9.347498416900635e-05 |0.0036657899618148804 |0.0019664764404296875 |
----------------------------------------------------------pseudo_mini_loss sum 1.3572660684585571
Total (block generation + training)time/epoch 32.53461215231154
Training time/epoch 1.3718113899230957
Training time without block to device /epoch 1.1841275691986084
Training time without total dataloading part /epoch 0.12073278427124023
load block tensor time/epoch 1.0040855407714844
block to device time/epoch 0.1876838207244873
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 18 |
Number of nodes for computation during this epoch:  5091341
Number of first layer input nodes during this epoch:  2470854
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11529397964477539  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021790742874145508
random selection method range initialization spend 0.0059125423431396484
time for parepare:  0.018518686294555664
local_output_nid generation:  0.0023391246795654297
local_in_edges_tensor generation:  0.007447481155395508
mini_batch_src_global generation:  0.0015561580657958984
r_  generation:  0.01775956153869629
local_output_nid generation:  0.002807140350341797
local_in_edges_tensor generation:  0.001672983169555664
mini_batch_src_global generation:  0.001828908920288086
r_  generation:  0.019449472427368164
local_output_nid generation:  0.0029566287994384766
local_in_edges_tensor generation:  0.0016117095947265625
mini_batch_src_global generation:  0.0014827251434326172
r_  generation:  0.01830315589904785
local_output_nid generation:  0.0029120445251464844
local_in_edges_tensor generation:  0.0016140937805175781
mini_batch_src_global generation:  0.001489877700805664
r_  generation:  0.018511295318603516
local_output_nid generation:  0.002897024154663086
local_in_edges_tensor generation:  0.0015435218811035156
mini_batch_src_global generation:  0.0015490055084228516
r_  generation:  0.01941537857055664
local_output_nid generation:  0.002936124801635742
local_in_edges_tensor generation:  0.0015058517456054688
mini_batch_src_global generation:  0.0015368461608886719
r_  generation:  0.018959522247314453
local_output_nid generation:  0.002902507781982422
local_in_edges_tensor generation:  0.0015673637390136719
mini_batch_src_global generation:  0.0015039443969726562
r_  generation:  0.01901531219482422
local_output_nid generation:  0.0029201507568359375
local_in_edges_tensor generation:  0.0015573501586914062
mini_batch_src_global generation:  0.0015621185302734375
r_  generation:  0.01934337615966797
local_output_nid generation:  0.0029010772705078125
local_in_edges_tensor generation:  0.0015838146209716797
mini_batch_src_global generation:  0.0015265941619873047
r_  generation:  0.018918275833129883
local_output_nid generation:  0.0029723644256591797
local_in_edges_tensor generation:  0.0015025138854980469
mini_batch_src_global generation:  0.0015115737915039062
r_  generation:  0.018867969512939453
local_output_nid generation:  0.0029103755950927734
local_in_edges_tensor generation:  0.0014770030975341797
mini_batch_src_global generation:  0.0015544891357421875
r_  generation:  0.019684791564941406
local_output_nid generation:  0.002921581268310547
local_in_edges_tensor generation:  0.001458883285522461
mini_batch_src_global generation:  0.001543283462524414
r_  generation:  0.019809246063232422
local_output_nid generation:  0.0029404163360595703
local_in_edges_tensor generation:  0.001641988754272461
mini_batch_src_global generation:  0.0015044212341308594
r_  generation:  0.018882274627685547
local_output_nid generation:  0.0028917789459228516
local_in_edges_tensor generation:  0.0014884471893310547
mini_batch_src_global generation:  0.0014984607696533203
r_  generation:  0.018996477127075195
local_output_nid generation:  0.002911806106567383
local_in_edges_tensor generation:  0.001538991928100586
mini_batch_src_global generation:  0.0016491413116455078
r_  generation:  0.019282102584838867
local_output_nid generation:  0.002888917922973633
local_in_edges_tensor generation:  0.0014417171478271484
mini_batch_src_global generation:  0.0015110969543457031
r_  generation:  0.019289016723632812
----------------------check_connections_block total spend ----------------------------- 0.5037052631378174
generate_one_block  0.02762007713317871
generate_one_block  0.028016328811645508
generate_one_block  0.027156591415405273
generate_one_block  0.02731490135192871
generate_one_block  0.028126001358032227
generate_one_block  0.03046393394470215
generate_one_block  0.027773141860961914
generate_one_block  0.0279080867767334
generate_one_block  0.027644872665405273
generate_one_block  0.02744293212890625
generate_one_block  0.027927637100219727
generate_one_block  0.02776312828063965
generate_one_block  0.027443885803222656
generate_one_block  0.02802729606628418
generate_one_block  0.028287887573242188
generate_one_block  0.02850484848022461
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0326848030090332
gen group dst list time:  0.01595783233642578
time for parepare:  0.019399166107177734
local_output_nid generation:  0.008256196975708008
local_in_edges_tensor generation:  0.022459745407104492
mini_batch_src_global generation:  0.01965951919555664
r_  generation:  0.18849897384643555
local_output_nid generation:  0.011869430541992188
local_in_edges_tensor generation:  0.015352964401245117
mini_batch_src_global generation:  0.02373504638671875
r_  generation:  0.19887709617614746
local_output_nid generation:  0.012015104293823242
local_in_edges_tensor generation:  0.012561798095703125
mini_batch_src_global generation:  0.023185253143310547
r_  generation:  0.2014927864074707
local_output_nid generation:  0.012493371963500977
local_in_edges_tensor generation:  0.012687444686889648
mini_batch_src_global generation:  0.027016878128051758
r_  generation:  0.20636892318725586
local_output_nid generation:  0.013478994369506836
local_in_edges_tensor generation:  0.01401519775390625
mini_batch_src_global generation:  0.03313565254211426
r_  generation:  0.21144604682922363
local_output_nid generation:  0.011996746063232422
local_in_edges_tensor generation:  0.011922597885131836
mini_batch_src_global generation:  0.026595354080200195
r_  generation:  0.207319974899292
local_output_nid generation:  0.012445926666259766
local_in_edges_tensor generation:  0.011639595031738281
mini_batch_src_global generation:  0.02602696418762207
r_  generation:  0.2094573974609375
local_output_nid generation:  0.012501716613769531
local_in_edges_tensor generation:  0.011830329895019531
mini_batch_src_global generation:  0.025906085968017578
r_  generation:  0.2124619483947754
local_output_nid generation:  0.012687921524047852
local_in_edges_tensor generation:  0.012147665023803711
mini_batch_src_global generation:  0.02983379364013672
r_  generation:  0.21080732345581055
local_output_nid generation:  0.012573003768920898
local_in_edges_tensor generation:  0.013572216033935547
mini_batch_src_global generation:  0.025537490844726562
r_  generation:  0.2206416130065918
local_output_nid generation:  0.01539468765258789
local_in_edges_tensor generation:  0.013277530670166016
mini_batch_src_global generation:  0.026703834533691406
r_  generation:  0.2167665958404541
local_output_nid generation:  0.014686107635498047
local_in_edges_tensor generation:  0.012070655822753906
mini_batch_src_global generation:  0.02664971351623535
r_  generation:  0.21314215660095215
local_output_nid generation:  0.012674331665039062
local_in_edges_tensor generation:  0.01183462142944336
mini_batch_src_global generation:  0.02624225616455078
r_  generation:  0.21015024185180664
local_output_nid generation:  0.012845516204833984
local_in_edges_tensor generation:  0.011667966842651367
mini_batch_src_global generation:  0.026482105255126953
r_  generation:  0.21016979217529297
local_output_nid generation:  0.01286458969116211
local_in_edges_tensor generation:  0.012720108032226562
mini_batch_src_global generation:  0.026688814163208008
r_  generation:  0.21471142768859863
local_output_nid generation:  0.012823820114135742
local_in_edges_tensor generation:  0.014277219772338867
mini_batch_src_global generation:  0.02658247947692871
r_  generation:  0.21599555015563965
----------------------check_connections_block total spend ----------------------------- 4.937552213668823
generate_one_block  0.2616879940032959
generate_one_block  0.26306962966918945
generate_one_block  0.26256394386291504
generate_one_block  0.26067304611206055
generate_one_block  0.27165985107421875
generate_one_block  0.263416051864624
generate_one_block  0.2960548400878906
generate_one_block  0.2706334590911865
generate_one_block  0.26198267936706543
generate_one_block  0.2621433734893799
generate_one_block  0.2745018005371094
generate_one_block  0.28438425064086914
generate_one_block  0.2638366222381592
generate_one_block  0.26671314239501953
generate_one_block  0.2731029987335205
generate_one_block  0.27237439155578613
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03119659423828125
gen group dst list time:  0.06033682823181152
time for parepare:  0.017531394958496094
local_output_nid generation:  0.02575087547302246
local_in_edges_tensor generation:  0.044211387634277344
mini_batch_src_global generation:  0.04150819778442383
r_  generation:  0.43988561630249023
local_output_nid generation:  0.031610727310180664
local_in_edges_tensor generation:  0.032498836517333984
mini_batch_src_global generation:  0.051436424255371094
r_  generation:  0.4391922950744629
local_output_nid generation:  0.031160593032836914
local_in_edges_tensor generation:  0.03074359893798828
mini_batch_src_global generation:  0.05249452590942383
r_  generation:  0.44574904441833496
local_output_nid generation:  0.031215906143188477
local_in_edges_tensor generation:  0.03157663345336914
mini_batch_src_global generation:  0.05217909812927246
r_  generation:  0.443817138671875
local_output_nid generation:  0.03120875358581543
local_in_edges_tensor generation:  0.07230305671691895
mini_batch_src_global generation:  0.05173850059509277
r_  generation:  0.4532489776611328
local_output_nid generation:  0.03105449676513672
local_in_edges_tensor generation:  0.03150010108947754
mini_batch_src_global generation:  0.0527040958404541
r_  generation:  0.4502377510070801
local_output_nid generation:  0.031087398529052734
local_in_edges_tensor generation:  0.03144192695617676
mini_batch_src_global generation:  0.0540318489074707
r_  generation:  0.45418596267700195
local_output_nid generation:  0.031117677688598633
local_in_edges_tensor generation:  0.028702735900878906
mini_batch_src_global generation:  0.05295372009277344
r_  generation:  0.4517252445220947
local_output_nid generation:  0.030838727951049805
local_in_edges_tensor generation:  0.030688047409057617
mini_batch_src_global generation:  0.05165362358093262
r_  generation:  0.45141100883483887
local_output_nid generation:  0.030791521072387695
local_in_edges_tensor generation:  0.03068065643310547
mini_batch_src_global generation:  0.05313539505004883
r_  generation:  0.4470505714416504
local_output_nid generation:  0.030884742736816406
local_in_edges_tensor generation:  0.03107285499572754
mini_batch_src_global generation:  0.051764726638793945
r_  generation:  0.4525268077850342
local_output_nid generation:  0.031162023544311523
local_in_edges_tensor generation:  0.03256726264953613
mini_batch_src_global generation:  0.05306386947631836
r_  generation:  0.44605112075805664
local_output_nid generation:  0.030773639678955078
local_in_edges_tensor generation:  0.029189109802246094
mini_batch_src_global generation:  0.05164933204650879
r_  generation:  0.45171308517456055
local_output_nid generation:  0.031342506408691406
local_in_edges_tensor generation:  0.032361507415771484
mini_batch_src_global generation:  0.05344820022583008
r_  generation:  0.4473857879638672
local_output_nid generation:  0.03078174591064453
local_in_edges_tensor generation:  0.029988765716552734
mini_batch_src_global generation:  0.05668807029724121
r_  generation:  0.4535186290740967
local_output_nid generation:  0.031073331832885742
local_in_edges_tensor generation:  0.030093908309936523
mini_batch_src_global generation:  0.052982330322265625
r_  generation:  0.4483296871185303
----------------------check_connections_block total spend ----------------------------- 10.623064756393433
generate_one_block  0.5629885196685791
generate_one_block  0.5709681510925293
generate_one_block  0.5669538974761963
generate_one_block  0.5707917213439941
generate_one_block  0.5729572772979736
generate_one_block  0.5742394924163818
generate_one_block  0.5730891227722168
generate_one_block  0.5813801288604736
generate_one_block  0.5963690280914307
generate_one_block  0.5740628242492676
generate_one_block  0.5761642456054688
generate_one_block  0.5734703540802002
generate_one_block  0.5663278102874756
generate_one_block  0.566180944442749
generate_one_block  0.568514347076416
generate_one_block  0.5753955841064453
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11529397964477539  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

connection checking time:  15.560616970062256
block generation total time  13.478651523590088
average batch blocks generation time:  0.8424157202243805
block dataloader generation time/epoch 31.1584538936615
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09380578994750977  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.715721607208252  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09337234497070312  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7163362503051758  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09379959106445312  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7163043022155762  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09334182739257812  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.717473030090332  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09405899047851562  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7214717864990234  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09328699111938477  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7163448333740234  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09391593933105469  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7174491882324219  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09355926513671875  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7202043533325195  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09384536743164062  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7168469429016113  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09331560134887695  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7152528762817383  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09403800964355469  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7195935249328613  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09335041046142578  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7229137420654297  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09378433227539062  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7159152030944824  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09331226348876953  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.717015266418457  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09395027160644531  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7147102355957031  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09347963333129883  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7197055816650391  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06279471516609192 |0.010170236229896545 |0.003614261746406555 |9.15825366973877e-05 |0.003690958023071289 |0.0030410289764404297 |
----------------------------------------------------------pseudo_mini_loss sum 1.3405481576919556
Total (block generation + training)time/epoch 32.52054235935211
Training time/epoch 1.347475290298462
Training time without block to device /epoch 1.1847515106201172
Training time without total dataloading part /epoch 0.12138986587524414
load block tensor time/epoch 1.0047154426574707
block to device time/epoch 0.16272377967834473
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 19 |
Number of nodes for computation during this epoch:  5091960
Number of first layer input nodes during this epoch:  2472144
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11555767059326172  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019034862518310547
random selection method range initialization spend 0.005892515182495117
time for parepare:  0.01866006851196289
local_output_nid generation:  0.0023365020751953125
local_in_edges_tensor generation:  0.003973722457885742
mini_batch_src_global generation:  0.0015990734100341797
r_  generation:  0.01872730255126953
local_output_nid generation:  0.0027878284454345703
local_in_edges_tensor generation:  0.0016398429870605469
mini_batch_src_global generation:  0.001882791519165039
r_  generation:  0.01926279067993164
local_output_nid generation:  0.0028519630432128906
local_in_edges_tensor generation:  0.0016679763793945312
mini_batch_src_global generation:  0.0015370845794677734
r_  generation:  0.018651247024536133
local_output_nid generation:  0.0028977394104003906
local_in_edges_tensor generation:  0.0016133785247802734
mini_batch_src_global generation:  0.001603841781616211
r_  generation:  0.019119739532470703
local_output_nid generation:  0.0028743743896484375
local_in_edges_tensor generation:  0.0015366077423095703
mini_batch_src_global generation:  0.0015873908996582031
r_  generation:  0.018970251083374023
local_output_nid generation:  0.0028667449951171875
local_in_edges_tensor generation:  0.0015392303466796875
mini_batch_src_global generation:  0.0016129016876220703
r_  generation:  0.019139766693115234
local_output_nid generation:  0.002884387969970703
local_in_edges_tensor generation:  0.0015730857849121094
mini_batch_src_global generation:  0.0015914440155029297
r_  generation:  0.01925516128540039
local_output_nid generation:  0.002875089645385742
local_in_edges_tensor generation:  0.0015304088592529297
mini_batch_src_global generation:  0.0016529560089111328
r_  generation:  0.019591808319091797
local_output_nid generation:  0.002893209457397461
local_in_edges_tensor generation:  0.0015289783477783203
mini_batch_src_global generation:  0.0015673637390136719
r_  generation:  0.019075632095336914
local_output_nid generation:  0.0029153823852539062
local_in_edges_tensor generation:  0.0015408992767333984
mini_batch_src_global generation:  0.001527547836303711
r_  generation:  0.019333362579345703
local_output_nid generation:  0.0028848648071289062
local_in_edges_tensor generation:  0.0015308856964111328
mini_batch_src_global generation:  0.0015828609466552734
r_  generation:  0.019226551055908203
local_output_nid generation:  0.0028963088989257812
local_in_edges_tensor generation:  0.0015172958374023438
mini_batch_src_global generation:  0.0015358924865722656
r_  generation:  0.019330739974975586
local_output_nid generation:  0.002918720245361328
local_in_edges_tensor generation:  0.0014965534210205078
mini_batch_src_global generation:  0.0015468597412109375
r_  generation:  0.019380569458007812
local_output_nid generation:  0.002882719039916992
local_in_edges_tensor generation:  0.0015273094177246094
mini_batch_src_global generation:  0.0014934539794921875
r_  generation:  0.018943071365356445
local_output_nid generation:  0.0028908252716064453
local_in_edges_tensor generation:  0.0014836788177490234
mini_batch_src_global generation:  0.0015404224395751953
r_  generation:  0.019693613052368164
local_output_nid generation:  0.002879619598388672
local_in_edges_tensor generation:  0.0014846324920654297
mini_batch_src_global generation:  0.001516580581665039
r_  generation:  0.01888251304626465
----------------------check_connections_block total spend ----------------------------- 0.5025639533996582
generate_one_block  0.027916669845581055
generate_one_block  0.02802252769470215
generate_one_block  0.02734661102294922
generate_one_block  0.02784276008605957
generate_one_block  0.027691364288330078
generate_one_block  0.03036785125732422
generate_one_block  0.02780294418334961
generate_one_block  0.02805614471435547
generate_one_block  0.027337312698364258
generate_one_block  0.027350902557373047
generate_one_block  0.02727484703063965
generate_one_block  0.02780914306640625
generate_one_block  0.027415990829467773
generate_one_block  0.027395248413085938
generate_one_block  0.02781510353088379
generate_one_block  0.027582168579101562
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03652620315551758
gen group dst list time:  0.01609325408935547
time for parepare:  0.019252777099609375
local_output_nid generation:  0.008302688598632812
local_in_edges_tensor generation:  0.018329858779907227
mini_batch_src_global generation:  0.019730806350708008
r_  generation:  0.19277501106262207
local_output_nid generation:  0.012167692184448242
local_in_edges_tensor generation:  0.015567302703857422
mini_batch_src_global generation:  0.02506089210510254
r_  generation:  0.19800615310668945
local_output_nid generation:  0.011867761611938477
local_in_edges_tensor generation:  0.015206098556518555
mini_batch_src_global generation:  0.02457284927368164
r_  generation:  0.20436334609985352
local_output_nid generation:  0.012645483016967773
local_in_edges_tensor generation:  0.012742042541503906
mini_batch_src_global generation:  0.024756669998168945
r_  generation:  0.20986294746398926
local_output_nid generation:  0.012386322021484375
local_in_edges_tensor generation:  0.012277841567993164
mini_batch_src_global generation:  0.026457548141479492
r_  generation:  0.20853161811828613
local_output_nid generation:  0.012218952178955078
local_in_edges_tensor generation:  0.012280941009521484
mini_batch_src_global generation:  0.025698184967041016
r_  generation:  0.20711374282836914
local_output_nid generation:  0.012338876724243164
local_in_edges_tensor generation:  0.01173543930053711
mini_batch_src_global generation:  0.025836467742919922
r_  generation:  0.20796895027160645
local_output_nid generation:  0.012556314468383789
local_in_edges_tensor generation:  0.011878490447998047
mini_batch_src_global generation:  0.0264739990234375
r_  generation:  0.21253156661987305
local_output_nid generation:  0.01250147819519043
local_in_edges_tensor generation:  0.011952400207519531
mini_batch_src_global generation:  0.02623438835144043
r_  generation:  0.2079007625579834
local_output_nid generation:  0.012408256530761719
local_in_edges_tensor generation:  0.01214456558227539
mini_batch_src_global generation:  0.026116609573364258
r_  generation:  0.20963764190673828
local_output_nid generation:  0.012401103973388672
local_in_edges_tensor generation:  0.014267206192016602
mini_batch_src_global generation:  0.025873184204101562
r_  generation:  0.21086668968200684
local_output_nid generation:  0.01259613037109375
local_in_edges_tensor generation:  0.011749744415283203
mini_batch_src_global generation:  0.027342557907104492
r_  generation:  0.2135298252105713
local_output_nid generation:  0.012456417083740234
local_in_edges_tensor generation:  0.012573480606079102
mini_batch_src_global generation:  0.02653980255126953
r_  generation:  0.21307682991027832
local_output_nid generation:  0.0123291015625
local_in_edges_tensor generation:  0.01182103157043457
mini_batch_src_global generation:  0.026100873947143555
r_  generation:  0.21101880073547363
local_output_nid generation:  0.01267552375793457
local_in_edges_tensor generation:  0.011773824691772461
mini_batch_src_global generation:  0.027137279510498047
r_  generation:  0.21347761154174805
local_output_nid generation:  0.012251138687133789
local_in_edges_tensor generation:  0.012409210205078125
mini_batch_src_global generation:  0.026125669479370117
r_  generation:  0.2093675136566162
----------------------check_connections_block total spend ----------------------------- 4.893387317657471
generate_one_block  0.26909875869750977
generate_one_block  0.2616550922393799
generate_one_block  0.26415586471557617
generate_one_block  0.27286863327026367
generate_one_block  0.26598644256591797
generate_one_block  0.26684045791625977
generate_one_block  0.28589963912963867
generate_one_block  0.2732827663421631
generate_one_block  0.2612297534942627
generate_one_block  0.2623145580291748
generate_one_block  0.25956225395202637
generate_one_block  0.2745048999786377
generate_one_block  0.2646667957305908
generate_one_block  0.26315975189208984
generate_one_block  0.2709343433380127
generate_one_block  0.2562398910522461
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.031842708587646484
gen group dst list time:  0.06104850769042969
time for parepare:  0.018688440322875977
local_output_nid generation:  0.025914669036865234
local_in_edges_tensor generation:  0.03701901435852051
mini_batch_src_global generation:  0.0441129207611084
r_  generation:  0.44548869132995605
local_output_nid generation:  0.03233027458190918
local_in_edges_tensor generation:  0.03705310821533203
mini_batch_src_global generation:  0.0518646240234375
r_  generation:  0.4430654048919678
local_output_nid generation:  0.031110763549804688
local_in_edges_tensor generation:  0.030827045440673828
mini_batch_src_global generation:  0.05132913589477539
r_  generation:  0.45195794105529785
local_output_nid generation:  0.03150749206542969
local_in_edges_tensor generation:  0.030320167541503906
mini_batch_src_global generation:  0.05205535888671875
r_  generation:  0.44619297981262207
local_output_nid generation:  0.03157782554626465
local_in_edges_tensor generation:  0.07354092597961426
mini_batch_src_global generation:  0.05135369300842285
r_  generation:  0.45122456550598145
local_output_nid generation:  0.031064271926879883
local_in_edges_tensor generation:  0.029444217681884766
mini_batch_src_global generation:  0.05260801315307617
r_  generation:  0.4572010040283203
local_output_nid generation:  0.03348851203918457
local_in_edges_tensor generation:  0.03020930290222168
mini_batch_src_global generation:  0.05370354652404785
r_  generation:  0.4499661922454834
local_output_nid generation:  0.03209185600280762
local_in_edges_tensor generation:  0.03058910369873047
mini_batch_src_global generation:  0.05331063270568848
r_  generation:  0.45084118843078613
local_output_nid generation:  0.03219342231750488
local_in_edges_tensor generation:  0.029460906982421875
mini_batch_src_global generation:  0.05186653137207031
r_  generation:  0.4519205093383789
local_output_nid generation:  0.03246283531188965
local_in_edges_tensor generation:  0.02900099754333496
mini_batch_src_global generation:  0.05478954315185547
r_  generation:  0.4506189823150635
local_output_nid generation:  0.03251934051513672
local_in_edges_tensor generation:  0.029047489166259766
mini_batch_src_global generation:  0.051131486892700195
r_  generation:  0.4530320167541504
local_output_nid generation:  0.032143592834472656
local_in_edges_tensor generation:  0.028652667999267578
mini_batch_src_global generation:  0.05424857139587402
r_  generation:  0.45105528831481934
local_output_nid generation:  0.032042503356933594
local_in_edges_tensor generation:  0.029165983200073242
mini_batch_src_global generation:  0.051535844802856445
r_  generation:  0.451465368270874
local_output_nid generation:  0.03207826614379883
local_in_edges_tensor generation:  0.028645038604736328
mini_batch_src_global generation:  0.05454611778259277
r_  generation:  0.44989728927612305
local_output_nid generation:  0.03206825256347656
local_in_edges_tensor generation:  0.028752803802490234
mini_batch_src_global generation:  0.05138826370239258
r_  generation:  0.4547300338745117
local_output_nid generation:  0.03207826614379883
local_in_edges_tensor generation:  0.02892756462097168
mini_batch_src_global generation:  0.053005218505859375
r_  generation:  0.44771552085876465
----------------------check_connections_block total spend ----------------------------- 10.673375606536865
generate_one_block  0.5717873573303223
generate_one_block  0.5736815929412842
generate_one_block  0.5642900466918945
generate_one_block  0.5718369483947754
generate_one_block  0.5745124816894531
generate_one_block  0.5669469833374023
generate_one_block  0.5678396224975586
generate_one_block  0.5780255794525146
generate_one_block  0.619854211807251
generate_one_block  0.5804171562194824
generate_one_block  0.5633449554443359
generate_one_block  0.5757730007171631
generate_one_block  0.5645780563354492
generate_one_block  0.5657453536987305
generate_one_block  0.5737769603729248
generate_one_block  0.5629091262817383
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11555767059326172  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

connection checking time:  15.566762924194336
block generation total time  13.44771933555603
average batch blocks generation time:  0.8404824584722519
block dataloader generation time/epoch 31.144517941908404
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0940403938293457  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7200756072998047  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09355449676513672  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.719205379486084  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09391117095947266  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7179746627807617  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09340333938598633  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7193007469177246  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09391498565673828  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7177443504333496  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09343338012695312  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7180066108703613  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0938577651977539  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7173199653625488  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.093475341796875  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7194004058837891  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09383010864257812  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.716825008392334  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09326982498168945  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7162575721740723  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09378528594970703  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7162017822265625  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09343624114990234  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.718235969543457  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09386920928955078  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7178988456726074  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09319400787353516  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.715245246887207  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09396076202392578  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7213420867919922  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09314107894897461  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7138848304748535  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0625695288181305 |0.009834781289100647 |0.0036004632711410522 |9.238719940185547e-05 |0.0036811381578445435 |0.002157926559448242 |
----------------------------------------------------------pseudo_mini_loss sum 1.333418846130371
Total (block generation + training)time/epoch 32.504406387155704
Training time/epoch 1.3376975059509277
Training time without block to device /epoch 1.1803410053253174
Training time without total dataloading part /epoch 0.12014174461364746
load block tensor time/epoch 1.001112461090088
block to device time/epoch 0.15735650062561035
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 20 |
Number of nodes for computation during this epoch:  5093952
Number of first layer input nodes during this epoch:  2473008
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11578607559204102  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018526554107666016
random selection method range initialization spend 0.005360603332519531
time for parepare:  0.01669621467590332
local_output_nid generation:  0.002346038818359375
local_in_edges_tensor generation:  0.004853487014770508
mini_batch_src_global generation:  0.0016140937805175781
r_  generation:  0.0187225341796875
local_output_nid generation:  0.0028362274169921875
local_in_edges_tensor generation:  0.001682281494140625
mini_batch_src_global generation:  0.0018229484558105469
r_  generation:  0.018973350524902344
local_output_nid generation:  0.002871990203857422
local_in_edges_tensor generation:  0.0015838146209716797
mini_batch_src_global generation:  0.0014946460723876953
r_  generation:  0.018810033798217773
local_output_nid generation:  0.002929210662841797
local_in_edges_tensor generation:  0.001600503921508789
mini_batch_src_global generation:  0.0014882087707519531
r_  generation:  0.0188448429107666
local_output_nid generation:  0.0029153823852539062
local_in_edges_tensor generation:  0.0014841556549072266
mini_batch_src_global generation:  0.0015141963958740234
r_  generation:  0.018948078155517578
local_output_nid generation:  0.002910137176513672
local_in_edges_tensor generation:  0.0015292167663574219
mini_batch_src_global generation:  0.0015366077423095703
r_  generation:  0.018970727920532227
local_output_nid generation:  0.002948284149169922
local_in_edges_tensor generation:  0.001537322998046875
mini_batch_src_global generation:  0.0016217231750488281
r_  generation:  0.01978588104248047
local_output_nid generation:  0.002903461456298828
local_in_edges_tensor generation:  0.0015327930450439453
mini_batch_src_global generation:  0.0015451908111572266
r_  generation:  0.018703699111938477
local_output_nid generation:  0.002935647964477539
local_in_edges_tensor generation:  0.001554250717163086
mini_batch_src_global generation:  0.001524209976196289
r_  generation:  0.0196533203125
local_output_nid generation:  0.0030472278594970703
local_in_edges_tensor generation:  0.0015294551849365234
mini_batch_src_global generation:  0.0015287399291992188
r_  generation:  0.019214391708374023
local_output_nid generation:  0.0029828548431396484
local_in_edges_tensor generation:  0.0015094280242919922
mini_batch_src_global generation:  0.0015478134155273438
r_  generation:  0.019818544387817383
local_output_nid generation:  0.0030493736267089844
local_in_edges_tensor generation:  0.0014772415161132812
mini_batch_src_global generation:  0.0015835762023925781
r_  generation:  0.019404172897338867
local_output_nid generation:  0.002949237823486328
local_in_edges_tensor generation:  0.0015420913696289062
mini_batch_src_global generation:  0.0014917850494384766
r_  generation:  0.01906418800354004
local_output_nid generation:  0.002950906753540039
local_in_edges_tensor generation:  0.0014324188232421875
mini_batch_src_global generation:  0.0015499591827392578
r_  generation:  0.01975226402282715
local_output_nid generation:  0.002974271774291992
local_in_edges_tensor generation:  0.001482248306274414
mini_batch_src_global generation:  0.0015439987182617188
r_  generation:  0.01892375946044922
local_output_nid generation:  0.0029430389404296875
local_in_edges_tensor generation:  0.001524209976196289
mini_batch_src_global generation:  0.0015437602996826172
r_  generation:  0.019184112548828125
----------------------check_connections_block total spend ----------------------------- 0.5016095638275146
generate_one_block  0.027276039123535156
generate_one_block  0.027759790420532227
generate_one_block  0.02739405632019043
generate_one_block  0.027743101119995117
generate_one_block  0.027339935302734375
generate_one_block  0.02996230125427246
generate_one_block  0.028055667877197266
generate_one_block  0.026865720748901367
generate_one_block  0.02806711196899414
generate_one_block  0.027569055557250977
generate_one_block  0.028018951416015625
generate_one_block  0.027645587921142578
generate_one_block  0.027208566665649414
generate_one_block  0.028165817260742188
generate_one_block  0.027528047561645508
generate_one_block  0.0279390811920166
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03260993957519531
gen group dst list time:  0.016056299209594727
time for parepare:  0.019219160079956055
local_output_nid generation:  0.00832986831665039
local_in_edges_tensor generation:  0.018488168716430664
mini_batch_src_global generation:  0.020519495010375977
r_  generation:  0.1945638656616211
local_output_nid generation:  0.012117624282836914
local_in_edges_tensor generation:  0.013547182083129883
mini_batch_src_global generation:  0.023892879486083984
r_  generation:  0.19774103164672852
local_output_nid generation:  0.011976242065429688
local_in_edges_tensor generation:  0.01171731948852539
mini_batch_src_global generation:  0.02316117286682129
r_  generation:  0.20436668395996094
local_output_nid generation:  0.012792587280273438
local_in_edges_tensor generation:  0.012649059295654297
mini_batch_src_global generation:  0.024195194244384766
r_  generation:  0.20628142356872559
local_output_nid generation:  0.012757062911987305
local_in_edges_tensor generation:  0.01240849494934082
mini_batch_src_global generation:  0.02508068084716797
r_  generation:  0.20760655403137207
local_output_nid generation:  0.012551307678222656
local_in_edges_tensor generation:  0.012649774551391602
mini_batch_src_global generation:  0.025281667709350586
r_  generation:  0.20759320259094238
local_output_nid generation:  0.012958049774169922
local_in_edges_tensor generation:  0.012865781784057617
mini_batch_src_global generation:  0.026979446411132812
r_  generation:  0.21410918235778809
local_output_nid generation:  0.012608051300048828
local_in_edges_tensor generation:  0.012322187423706055
mini_batch_src_global generation:  0.025682687759399414
r_  generation:  0.20684576034545898
local_output_nid generation:  0.01295018196105957
local_in_edges_tensor generation:  0.012215614318847656
mini_batch_src_global generation:  0.026305437088012695
r_  generation:  0.21397161483764648
local_output_nid generation:  0.012769222259521484
local_in_edges_tensor generation:  0.011780738830566406
mini_batch_src_global generation:  0.026072025299072266
r_  generation:  0.20961856842041016
local_output_nid generation:  0.012884855270385742
local_in_edges_tensor generation:  0.012692928314208984
mini_batch_src_global generation:  0.02715611457824707
r_  generation:  0.2163989543914795
local_output_nid generation:  0.01263117790222168
local_in_edges_tensor generation:  0.011981010437011719
mini_batch_src_global generation:  0.026589393615722656
r_  generation:  0.2127077579498291
local_output_nid generation:  0.0126953125
local_in_edges_tensor generation:  0.011638164520263672
mini_batch_src_global generation:  0.0262906551361084
r_  generation:  0.21173477172851562
local_output_nid generation:  0.013069868087768555
local_in_edges_tensor generation:  0.012693166732788086
mini_batch_src_global generation:  0.02675175666809082
r_  generation:  0.2158963680267334
local_output_nid generation:  0.012681007385253906
local_in_edges_tensor generation:  0.011354684829711914
mini_batch_src_global generation:  0.026393890380859375
r_  generation:  0.2094721794128418
local_output_nid generation:  0.012491226196289062
local_in_edges_tensor generation:  0.011616706848144531
mini_batch_src_global generation:  0.026088714599609375
r_  generation:  0.21040105819702148
----------------------check_connections_block total spend ----------------------------- 4.900153636932373
generate_one_block  0.2657318115234375
generate_one_block  0.26276516914367676
generate_one_block  0.2646522521972656
generate_one_block  0.2632789611816406
generate_one_block  0.26146721839904785
generate_one_block  0.2611055374145508
generate_one_block  0.2909998893737793
generate_one_block  0.25810742378234863
generate_one_block  0.26664090156555176
generate_one_block  0.2651379108428955
generate_one_block  0.2716095447540283
generate_one_block  0.2696225643157959
generate_one_block  0.26679039001464844
generate_one_block  0.2755556106567383
generate_one_block  0.26271867752075195
generate_one_block  0.261918306350708
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.032419681549072266
gen group dst list time:  0.0617828369140625
time for parepare:  0.017699480056762695
local_output_nid generation:  0.02600574493408203
local_in_edges_tensor generation:  0.046966552734375
mini_batch_src_global generation:  0.04181361198425293
r_  generation:  0.4431636333465576
local_output_nid generation:  0.03128170967102051
local_in_edges_tensor generation:  0.03420138359069824
mini_batch_src_global generation:  0.051465749740600586
r_  generation:  0.43920040130615234
local_output_nid generation:  0.031100988388061523
local_in_edges_tensor generation:  0.03184795379638672
mini_batch_src_global generation:  0.05020761489868164
r_  generation:  0.44980645179748535
local_output_nid generation:  0.03128933906555176
local_in_edges_tensor generation:  0.03229665756225586
mini_batch_src_global generation:  0.05218768119812012
r_  generation:  0.44876599311828613
local_output_nid generation:  0.031302690505981445
local_in_edges_tensor generation:  0.07267260551452637
mini_batch_src_global generation:  0.05205845832824707
r_  generation:  0.45253610610961914
local_output_nid generation:  0.03134918212890625
local_in_edges_tensor generation:  0.02924060821533203
mini_batch_src_global generation:  0.05309748649597168
r_  generation:  0.44848060607910156
local_output_nid generation:  0.03125500679016113
local_in_edges_tensor generation:  0.030711889266967773
mini_batch_src_global generation:  0.05201578140258789
r_  generation:  0.4613196849822998
local_output_nid generation:  0.03135538101196289
local_in_edges_tensor generation:  0.03089308738708496
mini_batch_src_global generation:  0.053383827209472656
r_  generation:  0.44510984420776367
local_output_nid generation:  0.03142523765563965
local_in_edges_tensor generation:  0.03119063377380371
mini_batch_src_global generation:  0.052231788635253906
r_  generation:  0.4541945457458496
local_output_nid generation:  0.03106999397277832
local_in_edges_tensor generation:  0.029414653778076172
mini_batch_src_global generation:  0.05261826515197754
r_  generation:  0.44899487495422363
local_output_nid generation:  0.033109188079833984
local_in_edges_tensor generation:  0.029201745986938477
mini_batch_src_global generation:  0.05388069152832031
r_  generation:  0.45485758781433105
local_output_nid generation:  0.031234264373779297
local_in_edges_tensor generation:  0.031571149826049805
mini_batch_src_global generation:  0.05335211753845215
r_  generation:  0.44419360160827637
local_output_nid generation:  0.030765771865844727
local_in_edges_tensor generation:  0.02900838851928711
mini_batch_src_global generation:  0.053888797760009766
r_  generation:  0.45172595977783203
local_output_nid generation:  0.03125166893005371
local_in_edges_tensor generation:  0.028183698654174805
mini_batch_src_global generation:  0.05475449562072754
r_  generation:  0.4497692584991455
local_output_nid generation:  0.031221389770507812
local_in_edges_tensor generation:  0.02913355827331543
mini_batch_src_global generation:  0.05179619789123535
r_  generation:  0.45134472846984863
local_output_nid generation:  0.031467437744140625
local_in_edges_tensor generation:  0.02928018569946289
mini_batch_src_global generation:  0.05343937873840332
r_  generation:  0.4469022750854492
----------------------check_connections_block total spend ----------------------------- 10.646044731140137
generate_one_block  0.5784902572631836
generate_one_block  0.5678665637969971
generate_one_block  0.5707085132598877
generate_one_block  0.5747637748718262
generate_one_block  0.5751280784606934
generate_one_block  0.56900954246521
generate_one_block  0.5695450305938721
generate_one_block  0.5720572471618652
generate_one_block  0.6026661396026611
generate_one_block  0.5642299652099609
generate_one_block  0.5753226280212402
generate_one_block  0.573580265045166
generate_one_block  0.5664284229278564
generate_one_block  0.5739660263061523
generate_one_block  0.5682518482208252
generate_one_block  0.5810654163360596
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11578607559204102  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

connection checking time:  15.54619836807251
block generation total time  13.451181888580322
average batch blocks generation time:  0.8406988680362701
block dataloader generation time/epoch 31.13018415371577
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0940098762512207  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7197122573852539  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09305477142333984  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7155184745788574  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09390544891357422  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7178759574890137  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09336996078491211  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7177248001098633  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0938711166381836  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7182192802429199  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0933980941772461  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7183952331542969  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09402179718017578  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7204737663269043  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09308624267578125  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7144522666931152  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09397506713867188  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7244930267333984  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09319877624511719  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7125082015991211  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0940704345703125  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7225933074951172  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09312152862548828  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7181787490844727  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09385299682617188  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7165794372558594  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0934138298034668  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7212252616882324  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0938100814819336  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.712317943572998  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09333372116088867  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.716644287109375  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.061894491314888 |0.012112751603126526 |0.003573790192604065 |9.31471586227417e-05 |0.0036371201276779175 |0.002695798873901367 |
----------------------------------------------------------pseudo_mini_loss sum 1.318246841430664
Total (block generation + training)time/epoch 32.49023995796839
Training time/epoch 1.361663579940796
Training time without block to device /epoch 1.1678595542907715
Training time without total dataloading part /epoch 0.11956071853637695
load block tensor time/epoch 0.990311861038208
block to device time/epoch 0.19380402565002441
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 21 |
Number of nodes for computation during this epoch:  5093894
Number of first layer input nodes during this epoch:  2471142
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11504077911376953  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.017526865005493164
random selection method range initialization spend 0.005387544631958008
time for parepare:  0.016826868057250977
local_output_nid generation:  0.0023789405822753906
local_in_edges_tensor generation:  0.003908395767211914
mini_batch_src_global generation:  0.0014812946319580078
r_  generation:  0.017984390258789062
local_output_nid generation:  0.0027997493743896484
local_in_edges_tensor generation:  0.0016384124755859375
mini_batch_src_global generation:  0.0018444061279296875
r_  generation:  0.019245386123657227
local_output_nid generation:  0.0029273033142089844
local_in_edges_tensor generation:  0.0016093254089355469
mini_batch_src_global generation:  0.0014858245849609375
r_  generation:  0.018359899520874023
local_output_nid generation:  0.0029740333557128906
local_in_edges_tensor generation:  0.0015285015106201172
mini_batch_src_global generation:  0.0015108585357666016
r_  generation:  0.018746376037597656
local_output_nid generation:  0.0028831958770751953
local_in_edges_tensor generation:  0.001519918441772461
mini_batch_src_global generation:  0.0015206336975097656
r_  generation:  0.018809795379638672
local_output_nid generation:  0.0028586387634277344
local_in_edges_tensor generation:  0.0015521049499511719
mini_batch_src_global generation:  0.001512289047241211
r_  generation:  0.019277334213256836
local_output_nid generation:  0.0029380321502685547
local_in_edges_tensor generation:  0.0015306472778320312
mini_batch_src_global generation:  0.0015611648559570312
r_  generation:  0.01958918571472168
local_output_nid generation:  0.002897500991821289
local_in_edges_tensor generation:  0.001500844955444336
mini_batch_src_global generation:  0.0015239715576171875
r_  generation:  0.01903700828552246
local_output_nid generation:  0.002901792526245117
local_in_edges_tensor generation:  0.0015170574188232422
mini_batch_src_global generation:  0.0015261173248291016
r_  generation:  0.018988609313964844
local_output_nid generation:  0.002893686294555664
local_in_edges_tensor generation:  0.0014510154724121094
mini_batch_src_global generation:  0.0015218257904052734
r_  generation:  0.01902294158935547
local_output_nid generation:  0.0028831958770751953
local_in_edges_tensor generation:  0.0014672279357910156
mini_batch_src_global generation:  0.0015213489532470703
r_  generation:  0.01890254020690918
local_output_nid generation:  0.002892732620239258
local_in_edges_tensor generation:  0.0015408992767333984
mini_batch_src_global generation:  0.0015172958374023438
r_  generation:  0.018705129623413086
local_output_nid generation:  0.002877473831176758
local_in_edges_tensor generation:  0.0014696121215820312
mini_batch_src_global generation:  0.001508951187133789
r_  generation:  0.019044876098632812
local_output_nid generation:  0.0029015541076660156
local_in_edges_tensor generation:  0.0015292167663574219
mini_batch_src_global generation:  0.0015251636505126953
r_  generation:  0.018923521041870117
local_output_nid generation:  0.0028831958770751953
local_in_edges_tensor generation:  0.0014567375183105469
mini_batch_src_global generation:  0.0014867782592773438
r_  generation:  0.01904606819152832
local_output_nid generation:  0.0028481483459472656
local_in_edges_tensor generation:  0.0014636516571044922
mini_batch_src_global generation:  0.001554250717163086
r_  generation:  0.019621849060058594
----------------------check_connections_block total spend ----------------------------- 0.49601268768310547
generate_one_block  0.02653980255126953
generate_one_block  0.027825593948364258
generate_one_block  0.027032136917114258
generate_one_block  0.027915000915527344
generate_one_block  0.027616262435913086
generate_one_block  0.030695199966430664
generate_one_block  0.02841019630432129
generate_one_block  0.027549266815185547
generate_one_block  0.027461767196655273
generate_one_block  0.027382373809814453
generate_one_block  0.02735447883605957
generate_one_block  0.027509450912475586
generate_one_block  0.027700185775756836
generate_one_block  0.02711319923400879
generate_one_block  0.027476787567138672
generate_one_block  0.029036998748779297
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.033669233322143555
gen group dst list time:  0.015512228012084961
time for parepare:  0.01959824562072754
local_output_nid generation:  0.008253812789916992
local_in_edges_tensor generation:  0.01910114288330078
mini_batch_src_global generation:  0.020193815231323242
r_  generation:  0.18953609466552734
local_output_nid generation:  0.012063026428222656
local_in_edges_tensor generation:  0.015126228332519531
mini_batch_src_global generation:  0.025221586227416992
r_  generation:  0.19668316841125488
local_output_nid generation:  0.011954069137573242
local_in_edges_tensor generation:  0.015124082565307617
mini_batch_src_global generation:  0.023961782455444336
r_  generation:  0.19903135299682617
local_output_nid generation:  0.012454509735107422
local_in_edges_tensor generation:  0.011922359466552734
mini_batch_src_global generation:  0.024352073669433594
r_  generation:  0.2094426155090332
local_output_nid generation:  0.014013051986694336
local_in_edges_tensor generation:  0.013350248336791992
mini_batch_src_global generation:  0.025249004364013672
r_  generation:  0.20714712142944336
local_output_nid generation:  0.012934207916259766
local_in_edges_tensor generation:  0.01184988021850586
mini_batch_src_global generation:  0.025630474090576172
r_  generation:  0.20639729499816895
local_output_nid generation:  0.013022422790527344
local_in_edges_tensor generation:  0.012488365173339844
mini_batch_src_global generation:  0.02598285675048828
r_  generation:  0.20891928672790527
local_output_nid generation:  0.01287388801574707
local_in_edges_tensor generation:  0.011864662170410156
mini_batch_src_global generation:  0.02686452865600586
r_  generation:  0.20568108558654785
local_output_nid generation:  0.012908458709716797
local_in_edges_tensor generation:  0.011797904968261719
mini_batch_src_global generation:  0.026560306549072266
r_  generation:  0.2103745937347412
local_output_nid generation:  0.012922048568725586
local_in_edges_tensor generation:  0.012279510498046875
mini_batch_src_global generation:  0.02602839469909668
r_  generation:  0.2089366912841797
local_output_nid generation:  0.012573480606079102
local_in_edges_tensor generation:  0.012525081634521484
mini_batch_src_global generation:  0.027158737182617188
r_  generation:  0.21074247360229492
local_output_nid generation:  0.012594938278198242
local_in_edges_tensor generation:  0.011462926864624023
mini_batch_src_global generation:  0.03385329246520996
r_  generation:  0.20787835121154785
local_output_nid generation:  0.01299142837524414
local_in_edges_tensor generation:  0.011757135391235352
mini_batch_src_global generation:  0.026366233825683594
r_  generation:  0.21044921875
local_output_nid generation:  0.012883901596069336
local_in_edges_tensor generation:  0.011866331100463867
mini_batch_src_global generation:  0.02643132209777832
r_  generation:  0.20886921882629395
local_output_nid generation:  0.012990236282348633
local_in_edges_tensor generation:  0.01146245002746582
mini_batch_src_global generation:  0.026671886444091797
r_  generation:  0.21209001541137695
local_output_nid generation:  0.012679576873779297
local_in_edges_tensor generation:  0.013647794723510742
mini_batch_src_global generation:  0.026813030242919922
r_  generation:  0.21379351615905762
----------------------check_connections_block total spend ----------------------------- 4.890052795410156
generate_one_block  0.2619047164916992
generate_one_block  0.26465535163879395
generate_one_block  0.2602710723876953
generate_one_block  0.26663827896118164
generate_one_block  0.2700948715209961
generate_one_block  0.2664663791656494
generate_one_block  0.293133020401001
generate_one_block  0.26305246353149414
generate_one_block  0.26711463928222656
generate_one_block  0.266019344329834
generate_one_block  0.2665097713470459
generate_one_block  0.26413869857788086
generate_one_block  0.26918721199035645
generate_one_block  0.2608203887939453
generate_one_block  0.2684502601623535
generate_one_block  0.27048230171203613
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029213428497314453
gen group dst list time:  0.06134486198425293
time for parepare:  0.01774001121520996
local_output_nid generation:  0.02547311782836914
local_in_edges_tensor generation:  0.04638981819152832
mini_batch_src_global generation:  0.04122424125671387
r_  generation:  0.43639612197875977
local_output_nid generation:  0.030962228775024414
local_in_edges_tensor generation:  0.03714942932128906
mini_batch_src_global generation:  0.05133700370788574
r_  generation:  0.44240498542785645
local_output_nid generation:  0.030536651611328125
local_in_edges_tensor generation:  0.030913352966308594
mini_batch_src_global generation:  0.050750732421875
r_  generation:  0.4456672668457031
local_output_nid generation:  0.03125762939453125
local_in_edges_tensor generation:  0.03141164779663086
mini_batch_src_global generation:  0.051785945892333984
r_  generation:  0.4445347785949707
local_output_nid generation:  0.030952930450439453
local_in_edges_tensor generation:  0.07182645797729492
mini_batch_src_global generation:  0.05106496810913086
r_  generation:  0.44944334030151367
local_output_nid generation:  0.03060150146484375
local_in_edges_tensor generation:  0.03125905990600586
mini_batch_src_global generation:  0.05235695838928223
r_  generation:  0.44951581954956055
local_output_nid generation:  0.030542612075805664
local_in_edges_tensor generation:  0.031217575073242188
mini_batch_src_global generation:  0.05115246772766113
r_  generation:  0.45154595375061035
local_output_nid generation:  0.030739545822143555
local_in_edges_tensor generation:  0.030508041381835938
mini_batch_src_global generation:  0.05228996276855469
r_  generation:  0.4457993507385254
local_output_nid generation:  0.031119585037231445
local_in_edges_tensor generation:  0.03137803077697754
mini_batch_src_global generation:  0.05176997184753418
r_  generation:  0.4571239948272705
local_output_nid generation:  0.031160593032836914
local_in_edges_tensor generation:  0.03101825714111328
mini_batch_src_global generation:  0.05321455001831055
r_  generation:  0.44811129570007324
local_output_nid generation:  0.03280925750732422
local_in_edges_tensor generation:  0.03118443489074707
mini_batch_src_global generation:  0.05192136764526367
r_  generation:  0.45624780654907227
local_output_nid generation:  0.03107166290283203
local_in_edges_tensor generation:  0.028676509857177734
mini_batch_src_global generation:  0.052959442138671875
r_  generation:  0.44853734970092773
local_output_nid generation:  0.031201839447021484
local_in_edges_tensor generation:  0.029103755950927734
mini_batch_src_global generation:  0.05176067352294922
r_  generation:  0.45288610458374023
local_output_nid generation:  0.03098297119140625
local_in_edges_tensor generation:  0.029275894165039062
mini_batch_src_global generation:  0.0530397891998291
r_  generation:  0.4484255313873291
local_output_nid generation:  0.03105616569519043
local_in_edges_tensor generation:  0.029103755950927734
mini_batch_src_global generation:  0.053544044494628906
r_  generation:  0.44983553886413574
local_output_nid generation:  0.031035661697387695
local_in_edges_tensor generation:  0.033176422119140625
mini_batch_src_global generation:  0.052651166915893555
r_  generation:  0.4471931457519531
----------------------check_connections_block total spend ----------------------------- 10.613032579421997
generate_one_block  0.5682053565979004
generate_one_block  0.5645921230316162
generate_one_block  0.5748946666717529
generate_one_block  0.5776360034942627
generate_one_block  0.5713214874267578
generate_one_block  0.5666046142578125
generate_one_block  0.5643889904022217
generate_one_block  0.5684027671813965
generate_one_block  0.624523401260376
generate_one_block  0.5666189193725586
generate_one_block  0.5716187953948975
generate_one_block  0.5636258125305176
generate_one_block  0.5664534568786621
generate_one_block  0.563772439956665
generate_one_block  0.5682728290557861
generate_one_block  0.5742952823638916
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11504077911376953  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

connection checking time:  15.503085374832153
block generation total time  13.434165716171265
average batch blocks generation time:  0.839635357260704
block dataloader generation time/epoch 31.111498502584602
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09382867813110352  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7126278877258301  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09339427947998047  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7167668342590332  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09379959106445312  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7156009674072266  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0934286117553711  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.718602180480957  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09388446807861328  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7171430587768555  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09339714050292969  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7184443473815918  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0939340591430664  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7201485633850098  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09336185455322266  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7167372703552246  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09394168853759766  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7170553207397461  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09328031539916992  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7165985107421875  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09393119812011719  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7190885543823242  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09333181381225586  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7159619331359863  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09391975402832031  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7185487747192383  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09328985214233398  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7153573036193848  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09393596649169922  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7188129425048828  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09350109100341797  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.720360279083252  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05848689377307892 |0.00917382538318634 |0.003513157367706299 |9.179115295410156e-05 |0.00310710072517395 |0.0029764175415039062 |
----------------------------------------------------------pseudo_mini_loss sum 1.2987734079360962
Total (block generation + training)time/epoch 32.46324143042931
Training time/epoch 1.2517967224121094
Training time without block to device /epoch 1.105015516281128
Training time without total dataloading part /epoch 0.11036920547485352
load block tensor time/epoch 0.9357903003692627
block to device time/epoch 0.14678120613098145
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 22 |
Number of nodes for computation during this epoch:  5089349
Number of first layer input nodes during this epoch:  2471301
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11558675765991211  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0162351131439209
random selection method range initialization spend 0.0054149627685546875
time for parepare:  0.017089366912841797
local_output_nid generation:  0.002345561981201172
local_in_edges_tensor generation:  0.0038378238677978516
mini_batch_src_global generation:  0.0015704631805419922
r_  generation:  0.018230438232421875
local_output_nid generation:  0.002870798110961914
local_in_edges_tensor generation:  0.001691579818725586
mini_batch_src_global generation:  0.0017199516296386719
r_  generation:  0.018719196319580078
local_output_nid generation:  0.0028839111328125
local_in_edges_tensor generation:  0.001592397689819336
mini_batch_src_global generation:  0.0015060901641845703
r_  generation:  0.01934051513671875
local_output_nid generation:  0.0029916763305664062
local_in_edges_tensor generation:  0.0015790462493896484
mini_batch_src_global generation:  0.0015192031860351562
r_  generation:  0.019829750061035156
local_output_nid generation:  0.003139972686767578
local_in_edges_tensor generation:  0.0016322135925292969
mini_batch_src_global generation:  0.0015728473663330078
r_  generation:  0.019317626953125
local_output_nid generation:  0.003077983856201172
local_in_edges_tensor generation:  0.0015938282012939453
mini_batch_src_global generation:  0.0015540122985839844
r_  generation:  0.018891096115112305
local_output_nid generation:  0.002963542938232422
local_in_edges_tensor generation:  0.0015490055084228516
mini_batch_src_global generation:  0.0015521049499511719
r_  generation:  0.019232988357543945
local_output_nid generation:  0.0029702186584472656
local_in_edges_tensor generation:  0.0015606880187988281
mini_batch_src_global generation:  0.0015425682067871094
r_  generation:  0.01892375946044922
local_output_nid generation:  0.0029134750366210938
local_in_edges_tensor generation:  0.0016176700592041016
mini_batch_src_global generation:  0.00153350830078125
r_  generation:  0.019216060638427734
local_output_nid generation:  0.0029609203338623047
local_in_edges_tensor generation:  0.0016298294067382812
mini_batch_src_global generation:  0.0015308856964111328
r_  generation:  0.019205331802368164
local_output_nid generation:  0.0029501914978027344
local_in_edges_tensor generation:  0.0015110969543457031
mini_batch_src_global generation:  0.001560211181640625
r_  generation:  0.01947927474975586
local_output_nid generation:  0.002901792526245117
local_in_edges_tensor generation:  0.0014808177947998047
mini_batch_src_global generation:  0.001531362533569336
r_  generation:  0.019494295120239258
local_output_nid generation:  0.002905130386352539
local_in_edges_tensor generation:  0.0015070438385009766
mini_batch_src_global generation:  0.0015635490417480469
r_  generation:  0.019324541091918945
local_output_nid generation:  0.002938985824584961
local_in_edges_tensor generation:  0.0015556812286376953
mini_batch_src_global generation:  0.001499176025390625
r_  generation:  0.019248008728027344
local_output_nid generation:  0.0029299259185791016
local_in_edges_tensor generation:  0.0014674663543701172
mini_batch_src_global generation:  0.0015532970428466797
r_  generation:  0.0195920467376709
local_output_nid generation:  0.002908468246459961
local_in_edges_tensor generation:  0.0014939308166503906
mini_batch_src_global generation:  0.0015101432800292969
r_  generation:  0.0193326473236084
----------------------check_connections_block total spend ----------------------------- 0.5032556056976318
generate_one_block  0.02770519256591797
generate_one_block  0.027676820755004883
generate_one_block  0.028051376342773438
generate_one_block  0.02863144874572754
generate_one_block  0.027005672454833984
generate_one_block  0.029871225357055664
generate_one_block  0.02812671661376953
generate_one_block  0.027243614196777344
generate_one_block  0.02787160873413086
generate_one_block  0.02755284309387207
generate_one_block  0.027755260467529297
generate_one_block  0.02751612663269043
generate_one_block  0.027567148208618164
generate_one_block  0.02795267105102539
generate_one_block  0.02845287322998047
generate_one_block  0.028452157974243164
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02813887596130371
gen group dst list time:  0.01599597930908203
time for parepare:  0.020119667053222656
local_output_nid generation:  0.008440494537353516
local_in_edges_tensor generation:  0.020073413848876953
mini_batch_src_global generation:  0.01922440528869629
r_  generation:  0.18940043449401855
local_output_nid generation:  0.01195836067199707
local_in_edges_tensor generation:  0.015286684036254883
mini_batch_src_global generation:  0.024823427200317383
r_  generation:  0.19452762603759766
local_output_nid generation:  0.0120391845703125
local_in_edges_tensor generation:  0.013789176940917969
mini_batch_src_global generation:  0.02683734893798828
r_  generation:  0.2088940143585205
local_output_nid generation:  0.012958526611328125
local_in_edges_tensor generation:  0.013948202133178711
mini_batch_src_global generation:  0.024448871612548828
r_  generation:  0.20714378356933594
local_output_nid generation:  0.01252293586730957
local_in_edges_tensor generation:  0.012863874435424805
mini_batch_src_global generation:  0.029140710830688477
r_  generation:  0.20914053916931152
local_output_nid generation:  0.012357950210571289
local_in_edges_tensor generation:  0.013015508651733398
mini_batch_src_global generation:  0.03106856346130371
r_  generation:  0.21367383003234863
local_output_nid generation:  0.012524127960205078
local_in_edges_tensor generation:  0.014422416687011719
mini_batch_src_global generation:  0.029842853546142578
r_  generation:  0.2086327075958252
local_output_nid generation:  0.012534379959106445
local_in_edges_tensor generation:  0.015787839889526367
mini_batch_src_global generation:  0.02608776092529297
r_  generation:  0.20848846435546875
local_output_nid generation:  0.012605428695678711
local_in_edges_tensor generation:  0.011686563491821289
mini_batch_src_global generation:  0.032666683197021484
r_  generation:  0.21541786193847656
local_output_nid generation:  0.012509584426879883
local_in_edges_tensor generation:  0.012719392776489258
mini_batch_src_global generation:  0.030331850051879883
r_  generation:  0.21230363845825195
local_output_nid generation:  0.012325763702392578
local_in_edges_tensor generation:  0.014026880264282227
mini_batch_src_global generation:  0.027327299118041992
r_  generation:  0.21267127990722656
local_output_nid generation:  0.012359142303466797
local_in_edges_tensor generation:  0.01361703872680664
mini_batch_src_global generation:  0.03618979454040527
r_  generation:  0.21422624588012695
local_output_nid generation:  0.0135650634765625
local_in_edges_tensor generation:  0.012800931930541992
mini_batch_src_global generation:  0.028850555419921875
r_  generation:  0.21095061302185059
local_output_nid generation:  0.013853073120117188
local_in_edges_tensor generation:  0.012286901473999023
mini_batch_src_global generation:  0.02590465545654297
r_  generation:  0.20900416374206543
local_output_nid generation:  0.013104438781738281
local_in_edges_tensor generation:  0.011906623840332031
mini_batch_src_global generation:  0.026237964630126953
r_  generation:  0.213179349899292
local_output_nid generation:  0.012798309326171875
local_in_edges_tensor generation:  0.012938499450683594
mini_batch_src_global generation:  0.026394367218017578
r_  generation:  0.21313714981079102
----------------------check_connections_block total spend ----------------------------- 4.96723198890686
generate_one_block  0.26520419120788574
generate_one_block  0.25929713249206543
generate_one_block  0.2745387554168701
generate_one_block  0.2723679542541504
generate_one_block  0.26401424407958984
generate_one_block  0.26577281951904297
generate_one_block  0.28873729705810547
generate_one_block  0.264070987701416
generate_one_block  0.2725694179534912
generate_one_block  0.265700101852417
generate_one_block  0.26944398880004883
generate_one_block  0.27076196670532227
generate_one_block  0.2607755661010742
generate_one_block  0.26170802116394043
generate_one_block  0.2681770324707031
generate_one_block  0.2704486846923828
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03841853141784668
gen group dst list time:  0.061206817626953125
time for parepare:  0.019823789596557617
local_output_nid generation:  0.025702714920043945
local_in_edges_tensor generation:  0.0422210693359375
mini_batch_src_global generation:  0.039251089096069336
r_  generation:  0.4414806365966797
local_output_nid generation:  0.030469894409179688
local_in_edges_tensor generation:  0.0363163948059082
mini_batch_src_global generation:  0.05311465263366699
r_  generation:  0.4363863468170166
local_output_nid generation:  0.03071308135986328
local_in_edges_tensor generation:  0.030883312225341797
mini_batch_src_global generation:  0.0538785457611084
r_  generation:  0.450153112411499
local_output_nid generation:  0.031104087829589844
local_in_edges_tensor generation:  0.02948164939880371
mini_batch_src_global generation:  0.05234384536743164
r_  generation:  0.4459095001220703
local_output_nid generation:  0.03096914291381836
local_in_edges_tensor generation:  0.06942009925842285
mini_batch_src_global generation:  0.052671194076538086
r_  generation:  0.45084047317504883
local_output_nid generation:  0.030770540237426758
local_in_edges_tensor generation:  0.028424978256225586
mini_batch_src_global generation:  0.05255770683288574
r_  generation:  0.44641637802124023
local_output_nid generation:  0.030946731567382812
local_in_edges_tensor generation:  0.030599355697631836
mini_batch_src_global generation:  0.05187106132507324
r_  generation:  0.454120397567749
local_output_nid generation:  0.030823230743408203
local_in_edges_tensor generation:  0.031459808349609375
mini_batch_src_global generation:  0.05267643928527832
r_  generation:  0.45017576217651367
local_output_nid generation:  0.03092479705810547
local_in_edges_tensor generation:  0.03240561485290527
mini_batch_src_global generation:  0.052336931228637695
r_  generation:  0.4570803642272949
local_output_nid generation:  0.030813932418823242
local_in_edges_tensor generation:  0.030602216720581055
mini_batch_src_global generation:  0.05580615997314453
r_  generation:  0.4523437023162842
local_output_nid generation:  0.030618906021118164
local_in_edges_tensor generation:  0.029802322387695312
mini_batch_src_global generation:  0.05199718475341797
r_  generation:  0.45404887199401855
local_output_nid generation:  0.030919551849365234
local_in_edges_tensor generation:  0.030721426010131836
mini_batch_src_global generation:  0.055194854736328125
r_  generation:  0.45089173316955566
local_output_nid generation:  0.0306699275970459
local_in_edges_tensor generation:  0.028740882873535156
mini_batch_src_global generation:  0.05202364921569824
r_  generation:  0.4521334171295166
local_output_nid generation:  0.030763864517211914
local_in_edges_tensor generation:  0.02951669692993164
mini_batch_src_global generation:  0.05261540412902832
r_  generation:  0.4475257396697998
local_output_nid generation:  0.03075432777404785
local_in_edges_tensor generation:  0.032813310623168945
mini_batch_src_global generation:  0.052404165267944336
r_  generation:  0.454866886138916
local_output_nid generation:  0.030954599380493164
local_in_edges_tensor generation:  0.030694246292114258
mini_batch_src_global generation:  0.05514883995056152
r_  generation:  0.4522714614868164
----------------------check_connections_block total spend ----------------------------- 10.642905235290527
generate_one_block  0.5741124153137207
generate_one_block  0.5593633651733398
generate_one_block  0.5732858180999756
generate_one_block  0.584944486618042
generate_one_block  0.5703914165496826
generate_one_block  0.5678279399871826
generate_one_block  0.5663235187530518
generate_one_block  0.5699491500854492
generate_one_block  0.606602668762207
generate_one_block  0.5728931427001953
generate_one_block  0.5699529647827148
generate_one_block  0.5855131149291992
generate_one_block  0.5651676654815674
generate_one_block  0.5673377513885498
generate_one_block  0.5723488330841064
generate_one_block  0.5800809860229492
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11558675765991211  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

connection checking time:  15.610137224197388
block generation total time  13.47968339920044
average batch blocks generation time:  0.8424802124500275
block dataloader generation time/epoch 31.10877534321376
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09385919570922852  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7179651260375977  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09308338165283203  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7107868194580078  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0941152572631836  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7255392074584961  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09343767166137695  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7197170257568359  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0938568115234375  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7177543640136719  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09328031539916992  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7161335945129395  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09384441375732422  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7176527976989746  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09322500228881836  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7156219482421875  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0939798355102539  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7189369201660156  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.093353271484375  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7163834571838379  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0939483642578125  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7184934616088867  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0934762954711914  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.720024585723877  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09379005432128906  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7152252197265625  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09330511093139648  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7159185409545898  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09392833709716797  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7193384170532227  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09340286254882812  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7180447578430176  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06263630092144012 |0.009484097361564636 |0.00361807644367218 |9.351968765258789e-05 |0.0036633312702178955 |0.001505136489868164 |
----------------------------------------------------------pseudo_mini_loss sum 1.2788218259811401
Total (block generation + training)time/epoch 32.459174156188965
Training time/epoch 1.3327322006225586
Training time without block to device /epoch 1.1809866428375244
Training time without total dataloading part /epoch 0.11950397491455078
load block tensor time/epoch 1.002180814743042
block to device time/epoch 0.15174555778503418
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 23 |
Number of nodes for computation during this epoch:  5093165
Number of first layer input nodes during this epoch:  2472433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11530065536499023  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02021336555480957
random selection method range initialization spend 0.005382537841796875
time for parepare:  0.016863107681274414
local_output_nid generation:  0.0023088455200195312
local_in_edges_tensor generation:  0.003958225250244141
mini_batch_src_global generation:  0.001615285873413086
r_  generation:  0.018660306930541992
local_output_nid generation:  0.002816438674926758
local_in_edges_tensor generation:  0.0017168521881103516
mini_batch_src_global generation:  0.0017764568328857422
r_  generation:  0.019586801528930664
local_output_nid generation:  0.0029985904693603516
local_in_edges_tensor generation:  0.0016300678253173828
mini_batch_src_global generation:  0.0014901161193847656
r_  generation:  0.018962621688842773
local_output_nid generation:  0.0029752254486083984
local_in_edges_tensor generation:  0.0015950202941894531
mini_batch_src_global generation:  0.0015106201171875
r_  generation:  0.018858909606933594
local_output_nid generation:  0.0029180049896240234
local_in_edges_tensor generation:  0.0014810562133789062
mini_batch_src_global generation:  0.0015292167663574219
r_  generation:  0.019393444061279297
local_output_nid generation:  0.0029354095458984375
local_in_edges_tensor generation:  0.001573801040649414
mini_batch_src_global generation:  0.001560211181640625
r_  generation:  0.019113540649414062
local_output_nid generation:  0.0029320716857910156
local_in_edges_tensor generation:  0.0015125274658203125
mini_batch_src_global generation:  0.0015380382537841797
r_  generation:  0.01912975311279297
local_output_nid generation:  0.0029518604278564453
local_in_edges_tensor generation:  0.0014874935150146484
mini_batch_src_global generation:  0.0015151500701904297
r_  generation:  0.019047260284423828
local_output_nid generation:  0.0029315948486328125
local_in_edges_tensor generation:  0.0014858245849609375
mini_batch_src_global generation:  0.0015044212341308594
r_  generation:  0.018746137619018555
local_output_nid generation:  0.002965688705444336
local_in_edges_tensor generation:  0.0014867782592773438
mini_batch_src_global generation:  0.0015344619750976562
r_  generation:  0.019025802612304688
local_output_nid generation:  0.0029129981994628906
local_in_edges_tensor generation:  0.0014929771423339844
mini_batch_src_global generation:  0.0015587806701660156
r_  generation:  0.019695520401000977
local_output_nid generation:  0.0029647350311279297
local_in_edges_tensor generation:  0.0014917850494384766
mini_batch_src_global generation:  0.0015358924865722656
r_  generation:  0.018839120864868164
local_output_nid generation:  0.002892017364501953
local_in_edges_tensor generation:  0.0014843940734863281
mini_batch_src_global generation:  0.0015180110931396484
r_  generation:  0.019142866134643555
local_output_nid generation:  0.0029234886169433594
local_in_edges_tensor generation:  0.001504659652709961
mini_batch_src_global generation:  0.0015256404876708984
r_  generation:  0.01886582374572754
local_output_nid generation:  0.0029001235961914062
local_in_edges_tensor generation:  0.0015583038330078125
mini_batch_src_global generation:  0.0015592575073242188
r_  generation:  0.01885056495666504
local_output_nid generation:  0.0029075145721435547
local_in_edges_tensor generation:  0.0014338493347167969
mini_batch_src_global generation:  0.0015382766723632812
r_  generation:  0.019437074661254883
----------------------check_connections_block total spend ----------------------------- 0.49889492988586426
generate_one_block  0.027252197265625
generate_one_block  0.027981281280517578
generate_one_block  0.027838706970214844
generate_one_block  0.02765679359436035
generate_one_block  0.0279085636138916
generate_one_block  0.030338525772094727
generate_one_block  0.027735471725463867
generate_one_block  0.027243614196777344
generate_one_block  0.02731609344482422
generate_one_block  0.0271756649017334
generate_one_block  0.028061866760253906
generate_one_block  0.027215242385864258
generate_one_block  0.027565479278564453
generate_one_block  0.027348041534423828
generate_one_block  0.02707648277282715
generate_one_block  0.028031110763549805
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02955341339111328
gen group dst list time:  0.015390157699584961
time for parepare:  0.018930435180664062
local_output_nid generation:  0.008342266082763672
local_in_edges_tensor generation:  0.019666433334350586
mini_batch_src_global generation:  0.02029109001159668
r_  generation:  0.19487357139587402
local_output_nid generation:  0.012019634246826172
local_in_edges_tensor generation:  0.015337467193603516
mini_batch_src_global generation:  0.02435898780822754
r_  generation:  0.19861960411071777
local_output_nid generation:  0.011847972869873047
local_in_edges_tensor generation:  0.012746095657348633
mini_batch_src_global generation:  0.023653507232666016
r_  generation:  0.20554089546203613
local_output_nid generation:  0.01217198371887207
local_in_edges_tensor generation:  0.01240849494934082
mini_batch_src_global generation:  0.025786638259887695
r_  generation:  0.20630431175231934
local_output_nid generation:  0.012621402740478516
local_in_edges_tensor generation:  0.013361454010009766
mini_batch_src_global generation:  0.026277780532836914
r_  generation:  0.21128296852111816
local_output_nid generation:  0.012680768966674805
local_in_edges_tensor generation:  0.01157999038696289
mini_batch_src_global generation:  0.026161670684814453
r_  generation:  0.20788192749023438
local_output_nid generation:  0.012650489807128906
local_in_edges_tensor generation:  0.012175321578979492
mini_batch_src_global generation:  0.025877714157104492
r_  generation:  0.20788979530334473
local_output_nid generation:  0.012588977813720703
local_in_edges_tensor generation:  0.011706352233886719
mini_batch_src_global generation:  0.02571702003479004
r_  generation:  0.2075958251953125
local_output_nid generation:  0.012531518936157227
local_in_edges_tensor generation:  0.01348567008972168
mini_batch_src_global generation:  0.025931119918823242
r_  generation:  0.2079756259918213
local_output_nid generation:  0.012627840042114258
local_in_edges_tensor generation:  0.011772871017456055
mini_batch_src_global generation:  0.026276588439941406
r_  generation:  0.20996689796447754
local_output_nid generation:  0.01240849494934082
local_in_edges_tensor generation:  0.012836456298828125
mini_batch_src_global generation:  0.027315139770507812
r_  generation:  0.21716761589050293
local_output_nid generation:  0.012490510940551758
local_in_edges_tensor generation:  0.01384735107421875
mini_batch_src_global generation:  0.027573347091674805
r_  generation:  0.21068310737609863
local_output_nid generation:  0.012656450271606445
local_in_edges_tensor generation:  0.012464523315429688
mini_batch_src_global generation:  0.027273178100585938
r_  generation:  0.2100381851196289
local_output_nid generation:  0.012445449829101562
local_in_edges_tensor generation:  0.011950254440307617
mini_batch_src_global generation:  0.026519060134887695
r_  generation:  0.2084808349609375
local_output_nid generation:  0.012343883514404297
local_in_edges_tensor generation:  0.014211893081665039
mini_batch_src_global generation:  0.026652812957763672
r_  generation:  0.20846199989318848
local_output_nid generation:  0.012609243392944336
local_in_edges_tensor generation:  0.011602640151977539
mini_batch_src_global generation:  0.02711319923400879
r_  generation:  0.21301603317260742
----------------------check_connections_block total spend ----------------------------- 4.900889158248901
generate_one_block  0.26919054985046387
generate_one_block  0.26700377464294434
generate_one_block  0.26610541343688965
generate_one_block  0.2673196792602539
generate_one_block  0.27426648139953613
generate_one_block  0.26401495933532715
generate_one_block  0.2851736545562744
generate_one_block  0.26477599143981934
generate_one_block  0.2610957622528076
generate_one_block  0.2665696144104004
generate_one_block  0.27390575408935547
generate_one_block  0.2634730339050293
generate_one_block  0.2649707794189453
generate_one_block  0.2632434368133545
generate_one_block  0.260467529296875
generate_one_block  0.2723066806793213
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03772544860839844
gen group dst list time:  0.06161642074584961
time for parepare:  0.017642974853515625
local_output_nid generation:  0.02585124969482422
local_in_edges_tensor generation:  0.04392075538635254
mini_batch_src_global generation:  0.03997087478637695
r_  generation:  0.4474787712097168
local_output_nid generation:  0.030948877334594727
local_in_edges_tensor generation:  0.03232979774475098
mini_batch_src_global generation:  0.05185055732727051
r_  generation:  0.44230222702026367
local_output_nid generation:  0.03079676628112793
local_in_edges_tensor generation:  0.030589818954467773
mini_batch_src_global generation:  0.05039668083190918
r_  generation:  0.448030948638916
local_output_nid generation:  0.030724287033081055
local_in_edges_tensor generation:  0.030613422393798828
mini_batch_src_global generation:  0.05200839042663574
r_  generation:  0.44857335090637207
local_output_nid generation:  0.03144526481628418
local_in_edges_tensor generation:  0.07164931297302246
mini_batch_src_global generation:  0.05166816711425781
r_  generation:  0.453021764755249
local_output_nid generation:  0.030760526657104492
local_in_edges_tensor generation:  0.028775691986083984
mini_batch_src_global generation:  0.052896738052368164
r_  generation:  0.4464235305786133
local_output_nid generation:  0.03071737289428711
local_in_edges_tensor generation:  0.028781414031982422
mini_batch_src_global generation:  0.05163884162902832
r_  generation:  0.4562954902648926
local_output_nid generation:  0.031014204025268555
local_in_edges_tensor generation:  0.028555870056152344
mini_batch_src_global generation:  0.05273866653442383
r_  generation:  0.4487133026123047
local_output_nid generation:  0.030707359313964844
local_in_edges_tensor generation:  0.03264141082763672
mini_batch_src_global generation:  0.05106806755065918
r_  generation:  0.4511837959289551
local_output_nid generation:  0.030839204788208008
local_in_edges_tensor generation:  0.029886960983276367
mini_batch_src_global generation:  0.05448579788208008
r_  generation:  0.446835994720459
local_output_nid generation:  0.03338742256164551
local_in_edges_tensor generation:  0.03690028190612793
mini_batch_src_global generation:  0.05163311958312988
r_  generation:  0.45334482192993164
local_output_nid generation:  0.03104996681213379
local_in_edges_tensor generation:  0.029439210891723633
mini_batch_src_global generation:  0.053011417388916016
r_  generation:  0.44864606857299805
local_output_nid generation:  0.03080272674560547
local_in_edges_tensor generation:  0.03052496910095215
mini_batch_src_global generation:  0.05331993103027344
r_  generation:  0.45200252532958984
local_output_nid generation:  0.030430078506469727
local_in_edges_tensor generation:  0.028191328048706055
mini_batch_src_global generation:  0.05245661735534668
r_  generation:  0.4478623867034912
local_output_nid generation:  0.03059530258178711
local_in_edges_tensor generation:  0.028581619262695312
mini_batch_src_global generation:  0.0519561767578125
r_  generation:  0.45593857765197754
local_output_nid generation:  0.030577421188354492
local_in_edges_tensor generation:  0.032044410705566406
mini_batch_src_global generation:  0.05317568778991699
r_  generation:  0.4481534957885742
----------------------check_connections_block total spend ----------------------------- 10.636440753936768
generate_one_block  0.5684840679168701
generate_one_block  0.5736753940582275
generate_one_block  0.570143461227417
generate_one_block  0.5681300163269043
generate_one_block  0.5814156532287598
generate_one_block  0.5694522857666016
generate_one_block  0.568800687789917
generate_one_block  0.5854477882385254
generate_one_block  0.6273207664489746
generate_one_block  0.572396993637085
generate_one_block  0.5734388828277588
generate_one_block  0.5884294509887695
generate_one_block  0.5697507858276367
generate_one_block  0.5691506862640381
generate_one_block  0.5712640285491943
generate_one_block  0.5746870040893555
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11530065536499023  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

connection checking time:  15.537329912185669
block generation total time  13.515871047973633
average batch blocks generation time:  0.844741940498352
block dataloader generation time/epoch 31.104801225662232
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09403848648071289  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7236618995666504  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09337329864501953  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7173862457275391  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0939035415649414  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7191953659057617  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09330558776855469  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7184133529663086  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09409809112548828  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7250595092773438  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09338617324829102  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7168736457824707  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09384632110595703  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7169489860534668  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09319496154785156  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7161908149719238  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09380435943603516  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7147984504699707  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0933847427368164  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.716273307800293  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09409427642822266  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.720299243927002  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09331178665161133  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.716606616973877  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09387588500976562  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7177376747131348  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09314727783203125  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7112092971801758  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09378337860107422  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7151389122009277  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09354829788208008  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7194375991821289  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06261079013347626 |0.011252477765083313 |0.0035872459411621094 |9.076297283172607e-05 |0.0036476552486419678 |0.001279592514038086 |
----------------------------------------------------------pseudo_mini_loss sum 1.2707337141036987
Total (block generation + training)time/epoch 32.45582078297933
Training time/epoch 1.3595786094665527
Training time without block to device /epoch 1.1795389652252197
Training time without total dataloading part /epoch 0.11849021911621094
load block tensor time/epoch 1.0017726421356201
block to device time/epoch 0.180039644241333
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 24 |
Number of nodes for computation during this epoch:  5092364
Number of first layer input nodes during this epoch:  2471697
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11563348770141602  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020547866821289062
random selection method range initialization spend 0.00541377067565918
time for parepare:  0.01727604866027832
local_output_nid generation:  0.002343893051147461
local_in_edges_tensor generation:  0.007259368896484375
mini_batch_src_global generation:  0.0014650821685791016
r_  generation:  0.0178375244140625
local_output_nid generation:  0.0028607845306396484
local_in_edges_tensor generation:  0.001621246337890625
mini_batch_src_global generation:  0.0017986297607421875
r_  generation:  0.019613027572631836
local_output_nid generation:  0.0028934478759765625
local_in_edges_tensor generation:  0.0016124248504638672
mini_batch_src_global generation:  0.0014832019805908203
r_  generation:  0.018523693084716797
local_output_nid generation:  0.0029172897338867188
local_in_edges_tensor generation:  0.0015778541564941406
mini_batch_src_global generation:  0.0014710426330566406
r_  generation:  0.018868446350097656
local_output_nid generation:  0.002908468246459961
local_in_edges_tensor generation:  0.0015299320220947266
mini_batch_src_global generation:  0.0014867782592773438
r_  generation:  0.018511533737182617
local_output_nid generation:  0.002969980239868164
local_in_edges_tensor generation:  0.0015077590942382812
mini_batch_src_global generation:  0.001531839370727539
r_  generation:  0.019227027893066406
local_output_nid generation:  0.0029091835021972656
local_in_edges_tensor generation:  0.0015339851379394531
mini_batch_src_global generation:  0.0015594959259033203
r_  generation:  0.019457101821899414
local_output_nid generation:  0.0029404163360595703
local_in_edges_tensor generation:  0.0015485286712646484
mini_batch_src_global generation:  0.0015621185302734375
r_  generation:  0.01950669288635254
local_output_nid generation:  0.0029573440551757812
local_in_edges_tensor generation:  0.0014736652374267578
mini_batch_src_global generation:  0.0015366077423095703
r_  generation:  0.019317150115966797
local_output_nid generation:  0.0029535293579101562
local_in_edges_tensor generation:  0.0014870166778564453
mini_batch_src_global generation:  0.0015282630920410156
r_  generation:  0.019455432891845703
local_output_nid generation:  0.002954244613647461
local_in_edges_tensor generation:  0.001504659652709961
mini_batch_src_global generation:  0.0015468597412109375
r_  generation:  0.019420385360717773
local_output_nid generation:  0.0029506683349609375
local_in_edges_tensor generation:  0.0015132427215576172
mini_batch_src_global generation:  0.0015490055084228516
r_  generation:  0.01916980743408203
local_output_nid generation:  0.002962350845336914
local_in_edges_tensor generation:  0.0015869140625
mini_batch_src_global generation:  0.0015344619750976562
r_  generation:  0.01951003074645996
local_output_nid generation:  0.00295257568359375
local_in_edges_tensor generation:  0.0014951229095458984
mini_batch_src_global generation:  0.0015299320220947266
r_  generation:  0.01873612403869629
local_output_nid generation:  0.0029075145721435547
local_in_edges_tensor generation:  0.0015382766723632812
mini_batch_src_global generation:  0.0015192031860351562
r_  generation:  0.01924419403076172
local_output_nid generation:  0.002888202667236328
local_in_edges_tensor generation:  0.0014748573303222656
mini_batch_src_global generation:  0.0015823841094970703
r_  generation:  0.019370555877685547
----------------------check_connections_block total spend ----------------------------- 0.5030865669250488
generate_one_block  0.02670884132385254
generate_one_block  0.028241872787475586
generate_one_block  0.027509689331054688
generate_one_block  0.027711153030395508
generate_one_block  0.027220726013183594
generate_one_block  0.03071904182434082
generate_one_block  0.027921676635742188
generate_one_block  0.02791595458984375
generate_one_block  0.027620553970336914
generate_one_block  0.027920246124267578
generate_one_block  0.02785015106201172
generate_one_block  0.02730584144592285
generate_one_block  0.02767038345336914
generate_one_block  0.026894092559814453
generate_one_block  0.027489423751831055
generate_one_block  0.02839183807373047
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029910802841186523
gen group dst list time:  0.015452146530151367
time for parepare:  0.019173145294189453
local_output_nid generation:  0.008038520812988281
local_in_edges_tensor generation:  0.021015644073486328
mini_batch_src_global generation:  0.019947528839111328
r_  generation:  0.18842053413391113
local_output_nid generation:  0.012074708938598633
local_in_edges_tensor generation:  0.015341520309448242
mini_batch_src_global generation:  0.0251312255859375
r_  generation:  0.20002269744873047
local_output_nid generation:  0.011913537979125977
local_in_edges_tensor generation:  0.014401435852050781
mini_batch_src_global generation:  0.023169279098510742
r_  generation:  0.20351743698120117
local_output_nid generation:  0.012640953063964844
local_in_edges_tensor generation:  0.011927604675292969
mini_batch_src_global generation:  0.029843807220458984
r_  generation:  0.20691323280334473
local_output_nid generation:  0.01255941390991211
local_in_edges_tensor generation:  0.011324882507324219
mini_batch_src_global generation:  0.02554798126220703
r_  generation:  0.20841598510742188
local_output_nid generation:  0.01215505599975586
local_in_edges_tensor generation:  0.012378454208374023
mini_batch_src_global generation:  0.02744603157043457
r_  generation:  0.2160625457763672
local_output_nid generation:  0.012633562088012695
local_in_edges_tensor generation:  0.01287698745727539
mini_batch_src_global generation:  0.02679443359375
r_  generation:  0.2139744758605957
local_output_nid generation:  0.01287078857421875
local_in_edges_tensor generation:  0.012810945510864258
mini_batch_src_global generation:  0.02611088752746582
r_  generation:  0.21362733840942383
local_output_nid generation:  0.012659072875976562
local_in_edges_tensor generation:  0.012002229690551758
mini_batch_src_global generation:  0.026456117630004883
r_  generation:  0.21370863914489746
local_output_nid generation:  0.012660741806030273
local_in_edges_tensor generation:  0.012674093246459961
mini_batch_src_global generation:  0.02626347541809082
r_  generation:  0.21201729774475098
local_output_nid generation:  0.012131929397583008
local_in_edges_tensor generation:  0.012198925018310547
mini_batch_src_global generation:  0.026617765426635742
r_  generation:  0.21400833129882812
local_output_nid generation:  0.012244224548339844
local_in_edges_tensor generation:  0.011976957321166992
mini_batch_src_global generation:  0.026454925537109375
r_  generation:  0.2093067169189453
local_output_nid generation:  0.012791872024536133
local_in_edges_tensor generation:  0.01152801513671875
mini_batch_src_global generation:  0.027983903884887695
r_  generation:  0.2164621353149414
local_output_nid generation:  0.012289762496948242
local_in_edges_tensor generation:  0.012028932571411133
mini_batch_src_global generation:  0.026661396026611328
r_  generation:  0.20992588996887207
local_output_nid generation:  0.012421607971191406
local_in_edges_tensor generation:  0.011881351470947266
mini_batch_src_global generation:  0.02986931800842285
r_  generation:  0.21273469924926758
local_output_nid generation:  0.012613058090209961
local_in_edges_tensor generation:  0.012664318084716797
mini_batch_src_global generation:  0.02694392204284668
r_  generation:  0.21277570724487305
----------------------check_connections_block total spend ----------------------------- 4.9318342208862305
generate_one_block  0.26921582221984863
generate_one_block  0.2644660472869873
generate_one_block  0.26444125175476074
generate_one_block  0.26740312576293945
generate_one_block  0.26287245750427246
generate_one_block  0.275252103805542
generate_one_block  0.29218244552612305
generate_one_block  0.2706122398376465
generate_one_block  0.2682924270629883
generate_one_block  0.2671926021575928
generate_one_block  0.2698030471801758
generate_one_block  0.2620213031768799
generate_one_block  0.26830601692199707
generate_one_block  0.25986814498901367
generate_one_block  0.26259851455688477
generate_one_block  0.2678976058959961
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02855706214904785
gen group dst list time:  0.060721635818481445
time for parepare:  0.01805877685546875
local_output_nid generation:  0.02542853355407715
local_in_edges_tensor generation:  0.042943477630615234
mini_batch_src_global generation:  0.04187154769897461
r_  generation:  0.438610315322876
local_output_nid generation:  0.0312957763671875
local_in_edges_tensor generation:  0.03267335891723633
mini_batch_src_global generation:  0.05220341682434082
r_  generation:  0.4416501522064209
local_output_nid generation:  0.030914306640625
local_in_edges_tensor generation:  0.031057119369506836
mini_batch_src_global generation:  0.0532984733581543
r_  generation:  0.4492945671081543
local_output_nid generation:  0.03120589256286621
local_in_edges_tensor generation:  0.032419681549072266
mini_batch_src_global generation:  0.052343130111694336
r_  generation:  0.45064616203308105
local_output_nid generation:  0.03160429000854492
local_in_edges_tensor generation:  0.07216072082519531
mini_batch_src_global generation:  0.05354809761047363
r_  generation:  0.4569876194000244
local_output_nid generation:  0.030988216400146484
local_in_edges_tensor generation:  0.029239177703857422
mini_batch_src_global generation:  0.05295062065124512
r_  generation:  0.45033907890319824
local_output_nid generation:  0.03134322166442871
local_in_edges_tensor generation:  0.03100109100341797
mini_batch_src_global generation:  0.05285239219665527
r_  generation:  0.46110033988952637
local_output_nid generation:  0.03115677833557129
local_in_edges_tensor generation:  0.028950929641723633
mini_batch_src_global generation:  0.05310821533203125
r_  generation:  0.446624755859375
local_output_nid generation:  0.031397342681884766
local_in_edges_tensor generation:  0.028636455535888672
mini_batch_src_global generation:  0.05191636085510254
r_  generation:  0.4517171382904053
local_output_nid generation:  0.031202316284179688
local_in_edges_tensor generation:  0.030558347702026367
mini_batch_src_global generation:  0.05515861511230469
r_  generation:  0.44862937927246094
local_output_nid generation:  0.03113389015197754
local_in_edges_tensor generation:  0.029617786407470703
mini_batch_src_global generation:  0.05202007293701172
r_  generation:  0.4521462917327881
local_output_nid generation:  0.03121042251586914
local_in_edges_tensor generation:  0.03339219093322754
mini_batch_src_global generation:  0.052809715270996094
r_  generation:  0.44788193702697754
local_output_nid generation:  0.031319618225097656
local_in_edges_tensor generation:  0.028444528579711914
mini_batch_src_global generation:  0.05211448669433594
r_  generation:  0.45605969429016113
local_output_nid generation:  0.03250002861022949
local_in_edges_tensor generation:  0.031244993209838867
mini_batch_src_global generation:  0.05312848091125488
r_  generation:  0.45003557205200195
local_output_nid generation:  0.0316309928894043
local_in_edges_tensor generation:  0.02891707420349121
mini_batch_src_global generation:  0.052126407623291016
r_  generation:  0.4537181854248047
local_output_nid generation:  0.031204700469970703
local_in_edges_tensor generation:  0.02930593490600586
mini_batch_src_global generation:  0.0532534122467041
r_  generation:  0.4470515251159668
----------------------check_connections_block total spend ----------------------------- 10.649940013885498
generate_one_block  0.5643777847290039
generate_one_block  0.5684361457824707
generate_one_block  0.5745553970336914
generate_one_block  0.5739328861236572
generate_one_block  0.5723111629486084
generate_one_block  0.5707602500915527
generate_one_block  0.5716595649719238
generate_one_block  0.5709772109985352
generate_one_block  0.5974135398864746
generate_one_block  0.5683958530426025
generate_one_block  0.5636544227600098
generate_one_block  0.5669317245483398
generate_one_block  0.5686519145965576
generate_one_block  0.5639050006866455
generate_one_block  0.5655422210693359
generate_one_block  0.5761756896972656
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11563348770141602  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

connection checking time:  15.581774234771729
block generation total time  13.430105924606323
average batch blocks generation time:  0.8393816202878952
block dataloader generation time/epoch 31.096868216991425
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09374094009399414  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7118020057678223  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09325408935546875  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7170124053955078  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09388160705566406  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7179503440856934  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09326648712158203  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7176599502563477  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09385013580322266  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7177305221557617  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0933675765991211  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7189836502075195  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09397602081298828  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7225956916809082  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09345245361328125  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.719275951385498  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09392356872558594  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7189974784851074  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09334802627563477  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7175636291503906  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09393501281738281  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7184786796569824  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09314489364624023  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7119221687316895  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09395980834960938  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7206473350524902  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09320354461669922  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.714876651763916  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09382915496826172  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.716132640838623  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09322929382324219  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7168407440185547  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06056337058544159 |0.011273875832557678 |0.003826439380645752 |9.576976299285889e-05 |0.005142912268638611 |0.0014278888702392578 |
----------------------------------------------------------pseudo_mini_loss sum 1.2575123310089111
Total (block generation + training)time/epoch 32.44816932082176
Training time/epoch 1.3553338050842285
Training time without block to device /epoch 1.1749517917633057
Training time without total dataloading part /epoch 0.1464698314666748
load block tensor time/epoch 0.9690139293670654
block to device time/epoch 0.18038201332092285
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 25 |
Number of nodes for computation during this epoch:  5090053
Number of first layer input nodes during this epoch:  2470572
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11507463455200195  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019097566604614258
random selection method range initialization spend 0.00580906867980957
time for parepare:  0.018358230590820312
local_output_nid generation:  0.002355337142944336
local_in_edges_tensor generation:  0.003928661346435547
mini_batch_src_global generation:  0.0015730857849121094
r_  generation:  0.01859879493713379
local_output_nid generation:  0.0028657913208007812
local_in_edges_tensor generation:  0.0017256736755371094
mini_batch_src_global generation:  0.0018131732940673828
r_  generation:  0.019802093505859375
local_output_nid generation:  0.0029478073120117188
local_in_edges_tensor generation:  0.001669168472290039
mini_batch_src_global generation:  0.0015397071838378906
r_  generation:  0.0192873477935791
local_output_nid generation:  0.0029516220092773438
local_in_edges_tensor generation:  0.001714468002319336
mini_batch_src_global generation:  0.001537322998046875
r_  generation:  0.01932072639465332
local_output_nid generation:  0.0029273033142089844
local_in_edges_tensor generation:  0.001575469970703125
mini_batch_src_global generation:  0.0015833377838134766
r_  generation:  0.0191650390625
local_output_nid generation:  0.0029277801513671875
local_in_edges_tensor generation:  0.0015902519226074219
mini_batch_src_global generation:  0.0016117095947265625
r_  generation:  0.019846677780151367
local_output_nid generation:  0.003047943115234375
local_in_edges_tensor generation:  0.0015985965728759766
mini_batch_src_global generation:  0.0016095638275146484
r_  generation:  0.01965045928955078
local_output_nid generation:  0.00299072265625
local_in_edges_tensor generation:  0.001583099365234375
mini_batch_src_global generation:  0.0015914440155029297
r_  generation:  0.019562244415283203
local_output_nid generation:  0.0030074119567871094
local_in_edges_tensor generation:  0.0015828609466552734
mini_batch_src_global generation:  0.0015883445739746094
r_  generation:  0.01984858512878418
local_output_nid generation:  0.0030295848846435547
local_in_edges_tensor generation:  0.0015485286712646484
mini_batch_src_global generation:  0.0015976428985595703
r_  generation:  0.01975107192993164
local_output_nid generation:  0.003032207489013672
local_in_edges_tensor generation:  0.0015482902526855469
mini_batch_src_global generation:  0.0015950202941894531
r_  generation:  0.019866228103637695
local_output_nid generation:  0.0029380321502685547
local_in_edges_tensor generation:  0.001542806625366211
mini_batch_src_global generation:  0.0015861988067626953
r_  generation:  0.01958322525024414
local_output_nid generation:  0.002962350845336914
local_in_edges_tensor generation:  0.001550912857055664
mini_batch_src_global generation:  0.0015895366668701172
r_  generation:  0.0194394588470459
local_output_nid generation:  0.0029501914978027344
local_in_edges_tensor generation:  0.00159454345703125
mini_batch_src_global generation:  0.0015566349029541016
r_  generation:  0.01957082748413086
local_output_nid generation:  0.0029582977294921875
local_in_edges_tensor generation:  0.0015747547149658203
mini_batch_src_global generation:  0.0015873908996582031
r_  generation:  0.019541501998901367
local_output_nid generation:  0.002965211868286133
local_in_edges_tensor generation:  0.0015354156494140625
mini_batch_src_global generation:  0.001583099365234375
r_  generation:  0.019986391067504883
----------------------check_connections_block total spend ----------------------------- 0.5155997276306152
generate_one_block  0.02737903594970703
generate_one_block  0.027797698974609375
generate_one_block  0.02802252769470215
generate_one_block  0.028247833251953125
generate_one_block  0.027895212173461914
generate_one_block  0.031286001205444336
generate_one_block  0.028163433074951172
generate_one_block  0.0282289981842041
generate_one_block  0.02810811996459961
generate_one_block  0.028028011322021484
generate_one_block  0.028096914291381836
generate_one_block  0.027547121047973633
generate_one_block  0.027773380279541016
generate_one_block  0.027795791625976562
generate_one_block  0.027618885040283203
generate_one_block  0.02957773208618164
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.035723209381103516
gen group dst list time:  0.01861715316772461
time for parepare:  0.01959991455078125
local_output_nid generation:  0.008414745330810547
local_in_edges_tensor generation:  0.025742053985595703
mini_batch_src_global generation:  0.020293712615966797
r_  generation:  0.19434499740600586
local_output_nid generation:  0.013164281845092773
local_in_edges_tensor generation:  0.014147281646728516
mini_batch_src_global generation:  0.025136709213256836
r_  generation:  0.19907045364379883
local_output_nid generation:  0.012099504470825195
local_in_edges_tensor generation:  0.013314247131347656
mini_batch_src_global generation:  0.023542404174804688
r_  generation:  0.2036597728729248
local_output_nid generation:  0.012548685073852539
local_in_edges_tensor generation:  0.015626907348632812
mini_batch_src_global generation:  0.02462601661682129
r_  generation:  0.20960140228271484
local_output_nid generation:  0.012827396392822266
local_in_edges_tensor generation:  0.013850688934326172
mini_batch_src_global generation:  0.025823116302490234
r_  generation:  0.20694565773010254
local_output_nid generation:  0.012818574905395508
local_in_edges_tensor generation:  0.012377738952636719
mini_batch_src_global generation:  0.026286602020263672
r_  generation:  0.21512842178344727
local_output_nid generation:  0.01280832290649414
local_in_edges_tensor generation:  0.012803792953491211
mini_batch_src_global generation:  0.026289701461791992
r_  generation:  0.21269774436950684
local_output_nid generation:  0.012997865676879883
local_in_edges_tensor generation:  0.012215375900268555
mini_batch_src_global generation:  0.02736687660217285
r_  generation:  0.2143416404724121
local_output_nid generation:  0.013004541397094727
local_in_edges_tensor generation:  0.013804435729980469
mini_batch_src_global generation:  0.026648283004760742
r_  generation:  0.2152857780456543
local_output_nid generation:  0.012943744659423828
local_in_edges_tensor generation:  0.012883663177490234
mini_batch_src_global generation:  0.026526212692260742
r_  generation:  0.21579527854919434
local_output_nid generation:  0.012715816497802734
local_in_edges_tensor generation:  0.012091636657714844
mini_batch_src_global generation:  0.02681255340576172
r_  generation:  0.2144625186920166
local_output_nid generation:  0.012579917907714844
local_in_edges_tensor generation:  0.012648820877075195
mini_batch_src_global generation:  0.026408910751342773
r_  generation:  0.21554780006408691
local_output_nid generation:  0.012747049331665039
local_in_edges_tensor generation:  0.011990547180175781
mini_batch_src_global generation:  0.026685237884521484
r_  generation:  0.2127246856689453
local_output_nid generation:  0.012819290161132812
local_in_edges_tensor generation:  0.01223301887512207
mini_batch_src_global generation:  0.02672863006591797
r_  generation:  0.21725010871887207
local_output_nid generation:  0.012816190719604492
local_in_edges_tensor generation:  0.011764287948608398
mini_batch_src_global generation:  0.026599645614624023
r_  generation:  0.21581315994262695
local_output_nid generation:  0.01293492317199707
local_in_edges_tensor generation:  0.012893199920654297
mini_batch_src_global generation:  0.028461456298828125
r_  generation:  0.22198271751403809
----------------------check_connections_block total spend ----------------------------- 4.986071348190308
generate_one_block  0.27991271018981934
generate_one_block  0.27065610885620117
generate_one_block  0.2704479694366455
generate_one_block  0.2761962413787842
generate_one_block  0.26866722106933594
generate_one_block  0.2755270004272461
generate_one_block  0.29861974716186523
generate_one_block  0.2761039733886719
generate_one_block  0.2740325927734375
generate_one_block  0.2794058322906494
generate_one_block  0.2745649814605713
generate_one_block  0.2728383541107178
generate_one_block  0.26645946502685547
generate_one_block  0.27084827423095703
generate_one_block  0.2871577739715576
generate_one_block  0.2791628837585449
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0351865291595459
gen group dst list time:  0.07037138938903809
time for parepare:  0.018592357635498047
local_output_nid generation:  0.027423858642578125
local_in_edges_tensor generation:  0.05769753456115723
mini_batch_src_global generation:  0.041782379150390625
r_  generation:  0.4478588104248047
local_output_nid generation:  0.031819820404052734
local_in_edges_tensor generation:  0.03979921340942383
mini_batch_src_global generation:  0.05143237113952637
r_  generation:  0.45104408264160156
local_output_nid generation:  0.03180265426635742
local_in_edges_tensor generation:  0.034449100494384766
mini_batch_src_global generation:  0.05071449279785156
r_  generation:  0.4566042423248291
local_output_nid generation:  0.03258347511291504
local_in_edges_tensor generation:  0.033911705017089844
mini_batch_src_global generation:  0.05374860763549805
r_  generation:  0.45043396949768066
local_output_nid generation:  0.03186964988708496
local_in_edges_tensor generation:  0.07799410820007324
mini_batch_src_global generation:  0.05324864387512207
r_  generation:  0.46140193939208984
local_output_nid generation:  0.0314328670501709
local_in_edges_tensor generation:  0.032608985900878906
mini_batch_src_global generation:  0.05387687683105469
r_  generation:  0.45679426193237305
local_output_nid generation:  0.03149294853210449
local_in_edges_tensor generation:  0.03191351890563965
mini_batch_src_global generation:  0.05169796943664551
r_  generation:  0.46396756172180176
local_output_nid generation:  0.03131604194641113
local_in_edges_tensor generation:  0.037508487701416016
mini_batch_src_global generation:  0.05435514450073242
r_  generation:  0.4739816188812256
local_output_nid generation:  0.03297114372253418
local_in_edges_tensor generation:  0.03697037696838379
mini_batch_src_global generation:  0.05530977249145508
r_  generation:  0.46276092529296875
local_output_nid generation:  0.03273463249206543
local_in_edges_tensor generation:  0.03275942802429199
mini_batch_src_global generation:  0.05567812919616699
r_  generation:  0.45574498176574707
local_output_nid generation:  0.03247666358947754
local_in_edges_tensor generation:  0.03201651573181152
mini_batch_src_global generation:  0.052330732345581055
r_  generation:  0.4610445499420166
local_output_nid generation:  0.03266572952270508
local_in_edges_tensor generation:  0.030074357986450195
mini_batch_src_global generation:  0.05901336669921875
r_  generation:  0.45821237564086914
local_output_nid generation:  0.03236794471740723
local_in_edges_tensor generation:  0.030164241790771484
mini_batch_src_global generation:  0.052663564682006836
r_  generation:  0.46183109283447266
local_output_nid generation:  0.03269362449645996
local_in_edges_tensor generation:  0.030159473419189453
mini_batch_src_global generation:  0.05332517623901367
r_  generation:  0.45809006690979004
local_output_nid generation:  0.03247332572937012
local_in_edges_tensor generation:  0.0319666862487793
mini_batch_src_global generation:  0.05235767364501953
r_  generation:  0.4638552665710449
local_output_nid generation:  0.03297829627990723
local_in_edges_tensor generation:  0.032266855239868164
mini_batch_src_global generation:  0.053788185119628906
r_  generation:  0.45590949058532715
----------------------check_connections_block total spend ----------------------------- 10.899070262908936
generate_one_block  0.58785080909729
generate_one_block  0.5732145309448242
generate_one_block  0.5789074897766113
generate_one_block  0.5786490440368652
generate_one_block  0.5826175212860107
generate_one_block  0.5778729915618896
generate_one_block  0.5727994441986084
generate_one_block  0.5805509090423584
generate_one_block  0.6492927074432373
generate_one_block  0.5843005180358887
generate_one_block  0.581561803817749
generate_one_block  0.5788414478302002
generate_one_block  0.5859534740447998
generate_one_block  0.5862810611724854
generate_one_block  0.5993850231170654
generate_one_block  0.5955548286437988
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11507463455200195  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

connection checking time:  15.885141611099243
block generation total time  13.814234733581543
average batch blocks generation time:  0.8633896708488464
block dataloader generation time/epoch 31.135878661099603
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09384298324584961  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7124028205871582  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09313201904296875  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7142128944396973  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09385204315185547  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7187137603759766  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09339570999145508  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7179450988769531  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09382152557373047  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7172589302062988  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09349250793457031  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7195010185241699  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09386825561523438  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7172865867614746  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09329748153686523  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.717658519744873  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09393882751464844  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.719029426574707  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09324932098388672  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7173113822937012  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09388446807861328  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7185659408569336  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09325218200683594  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7165045738220215  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09378623962402344  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7166352272033691  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09347200393676758  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7166142463684082  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09383773803710938  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.716242790222168  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09336614608764648  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7188777923583984  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06239977478981018 |0.01355104148387909 |0.003702312707901001 |9.584426879882812e-05 |0.003706499934196472 |0.0015621185302734375 |
----------------------------------------------------------pseudo_mini_loss sum 1.248008131980896
Total (block generation + training)time/epoch 32.48983996054705
Training time/epoch 1.3962695598602295
Training time without block to device /epoch 1.179452896118164
Training time without total dataloading part /epoch 0.12163662910461426
load block tensor time/epoch 0.9983963966369629
block to device time/epoch 0.21681666374206543
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 26 |
Number of nodes for computation during this epoch:  5089864
Number of first layer input nodes during this epoch:  2471058
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11546516418457031  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022944211959838867
random selection method range initialization spend 0.005815744400024414
time for parepare:  0.018951416015625
local_output_nid generation:  0.0023331642150878906
local_in_edges_tensor generation:  0.007508039474487305
mini_batch_src_global generation:  0.0015912055969238281
r_  generation:  0.01784491539001465
local_output_nid generation:  0.0028586387634277344
local_in_edges_tensor generation:  0.0016849040985107422
mini_batch_src_global generation:  0.0018994808197021484
r_  generation:  0.020094633102416992
local_output_nid generation:  0.002905130386352539
local_in_edges_tensor generation:  0.0016345977783203125
mini_batch_src_global generation:  0.0015513896942138672
r_  generation:  0.019302845001220703
local_output_nid generation:  0.0030317306518554688
local_in_edges_tensor generation:  0.0016121864318847656
mini_batch_src_global generation:  0.0016224384307861328
r_  generation:  0.019269704818725586
local_output_nid generation:  0.003025054931640625
local_in_edges_tensor generation:  0.0016002655029296875
mini_batch_src_global generation:  0.0015377998352050781
r_  generation:  0.0194699764251709
local_output_nid generation:  0.003004789352416992
local_in_edges_tensor generation:  0.0017774105072021484
mini_batch_src_global generation:  0.001607656478881836
r_  generation:  0.01948380470275879
local_output_nid generation:  0.0029544830322265625
local_in_edges_tensor generation:  0.0015664100646972656
mini_batch_src_global generation:  0.0015759468078613281
r_  generation:  0.019353628158569336
local_output_nid generation:  0.002973794937133789
local_in_edges_tensor generation:  0.001508951187133789
mini_batch_src_global generation:  0.0015878677368164062
r_  generation:  0.019744873046875
local_output_nid generation:  0.0029625892639160156
local_in_edges_tensor generation:  0.0015587806701660156
mini_batch_src_global generation:  0.001706838607788086
r_  generation:  0.019451618194580078
local_output_nid generation:  0.0029332637786865234
local_in_edges_tensor generation:  0.0016512870788574219
mini_batch_src_global generation:  0.0015721321105957031
r_  generation:  0.0191037654876709
local_output_nid generation:  0.0029392242431640625
local_in_edges_tensor generation:  0.001584768295288086
mini_batch_src_global generation:  0.001615762710571289
r_  generation:  0.019706010818481445
local_output_nid generation:  0.0029299259185791016
local_in_edges_tensor generation:  0.0015435218811035156
mini_batch_src_global generation:  0.001590728759765625
r_  generation:  0.019283533096313477
local_output_nid generation:  0.0029053688049316406
local_in_edges_tensor generation:  0.0015406608581542969
mini_batch_src_global generation:  0.0015635490417480469
r_  generation:  0.019347429275512695
local_output_nid generation:  0.002909421920776367
local_in_edges_tensor generation:  0.001552581787109375
mini_batch_src_global generation:  0.0015571117401123047
r_  generation:  0.019605159759521484
local_output_nid generation:  0.002971172332763672
local_in_edges_tensor generation:  0.0015473365783691406
mini_batch_src_global generation:  0.001539468765258789
r_  generation:  0.019307613372802734
local_output_nid generation:  0.0029172897338867188
local_in_edges_tensor generation:  0.00151824951171875
mini_batch_src_global generation:  0.0015521049499511719
r_  generation:  0.019080162048339844
----------------------check_connections_block total spend ----------------------------- 0.5129997730255127
generate_one_block  0.02727055549621582
generate_one_block  0.028690814971923828
generate_one_block  0.028010845184326172
generate_one_block  0.027974605560302734
generate_one_block  0.02765822410583496
generate_one_block  0.031004667282104492
generate_one_block  0.02793121337890625
generate_one_block  0.028045177459716797
generate_one_block  0.028094053268432617
generate_one_block  0.02744436264038086
generate_one_block  0.027805805206298828
generate_one_block  0.02773904800415039
generate_one_block  0.02746272087097168
generate_one_block  0.027855634689331055
generate_one_block  0.027915000915527344
generate_one_block  0.028053760528564453
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03524136543273926
gen group dst list time:  0.015852689743041992
time for parepare:  0.01918959617614746
local_output_nid generation:  0.008327722549438477
local_in_edges_tensor generation:  0.02226543426513672
mini_batch_src_global generation:  0.020557880401611328
r_  generation:  0.1881089210510254
local_output_nid generation:  0.012455940246582031
local_in_edges_tensor generation:  0.016162633895874023
mini_batch_src_global generation:  0.02599930763244629
r_  generation:  0.2021040916442871
local_output_nid generation:  0.011977672576904297
local_in_edges_tensor generation:  0.014078140258789062
mini_batch_src_global generation:  0.0234682559967041
r_  generation:  0.2040424346923828
local_output_nid generation:  0.012356996536254883
local_in_edges_tensor generation:  0.013059854507446289
mini_batch_src_global generation:  0.024926185607910156
r_  generation:  0.20855927467346191
local_output_nid generation:  0.012693166732788086
local_in_edges_tensor generation:  0.012224912643432617
mini_batch_src_global generation:  0.025626182556152344
r_  generation:  0.20911192893981934
local_output_nid generation:  0.012856721878051758
local_in_edges_tensor generation:  0.012944698333740234
mini_batch_src_global generation:  0.027167320251464844
r_  generation:  0.21449637413024902
local_output_nid generation:  0.012660503387451172
local_in_edges_tensor generation:  0.011847257614135742
mini_batch_src_global generation:  0.026737213134765625
r_  generation:  0.2112290859222412
local_output_nid generation:  0.013054132461547852
local_in_edges_tensor generation:  0.012519598007202148
mini_batch_src_global generation:  0.026697874069213867
r_  generation:  0.21890783309936523
local_output_nid generation:  0.012857913970947266
local_in_edges_tensor generation:  0.012806415557861328
mini_batch_src_global generation:  0.026938915252685547
r_  generation:  0.21293234825134277
local_output_nid generation:  0.012682199478149414
local_in_edges_tensor generation:  0.012201309204101562
mini_batch_src_global generation:  0.026883602142333984
r_  generation:  0.21043848991394043
local_output_nid generation:  0.012425899505615234
local_in_edges_tensor generation:  0.012370109558105469
mini_batch_src_global generation:  0.027950048446655273
r_  generation:  0.2152538299560547
local_output_nid generation:  0.012236833572387695
local_in_edges_tensor generation:  0.012219905853271484
mini_batch_src_global generation:  0.026600360870361328
r_  generation:  0.2104344367980957
local_output_nid generation:  0.01280069351196289
local_in_edges_tensor generation:  0.011896133422851562
mini_batch_src_global generation:  0.0269012451171875
r_  generation:  0.21385478973388672
local_output_nid generation:  0.012797117233276367
local_in_edges_tensor generation:  0.013031244277954102
mini_batch_src_global generation:  0.026572704315185547
r_  generation:  0.21399521827697754
local_output_nid generation:  0.012842178344726562
local_in_edges_tensor generation:  0.012009859085083008
mini_batch_src_global generation:  0.02748394012451172
r_  generation:  0.2125697135925293
local_output_nid generation:  0.012982368469238281
local_in_edges_tensor generation:  0.011977195739746094
mini_batch_src_global generation:  0.026311874389648438
r_  generation:  0.21102452278137207
----------------------check_connections_block total spend ----------------------------- 4.9438560009002686
generate_one_block  0.27235984802246094
generate_one_block  0.27245402336120605
generate_one_block  0.26831912994384766
generate_one_block  0.271697998046875
generate_one_block  0.2692854404449463
generate_one_block  0.271465539932251
generate_one_block  0.288677453994751
generate_one_block  0.2737293243408203
generate_one_block  0.269040584564209
generate_one_block  0.2659468650817871
generate_one_block  0.26964712142944336
generate_one_block  0.2639329433441162
generate_one_block  0.2642340660095215
generate_one_block  0.269320011138916
generate_one_block  0.26598119735717773
generate_one_block  0.2640044689178467
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03150534629821777
gen group dst list time:  0.0614011287689209
time for parepare:  0.018929243087768555
local_output_nid generation:  0.026047229766845703
local_in_edges_tensor generation:  0.04492807388305664
mini_batch_src_global generation:  0.040567636489868164
r_  generation:  0.4453728199005127
local_output_nid generation:  0.03165149688720703
local_in_edges_tensor generation:  0.031156539916992188
mini_batch_src_global generation:  0.05209088325500488
r_  generation:  0.44759058952331543
local_output_nid generation:  0.030657291412353516
local_in_edges_tensor generation:  0.033846378326416016
mini_batch_src_global generation:  0.05145859718322754
r_  generation:  0.45809388160705566
local_output_nid generation:  0.0334627628326416
local_in_edges_tensor generation:  0.02881622314453125
mini_batch_src_global generation:  0.05278325080871582
r_  generation:  0.45059895515441895
local_output_nid generation:  0.031163454055786133
local_in_edges_tensor generation:  0.07336854934692383
mini_batch_src_global generation:  0.052290916442871094
r_  generation:  0.4557051658630371
local_output_nid generation:  0.031218528747558594
local_in_edges_tensor generation:  0.03150510787963867
mini_batch_src_global generation:  0.053182125091552734
r_  generation:  0.4591562747955322
local_output_nid generation:  0.0312650203704834
local_in_edges_tensor generation:  0.02888941764831543
mini_batch_src_global generation:  0.05173635482788086
r_  generation:  0.45915985107421875
local_output_nid generation:  0.03133034706115723
local_in_edges_tensor generation:  0.02929544448852539
mini_batch_src_global generation:  0.05322456359863281
r_  generation:  0.4578893184661865
local_output_nid generation:  0.03113722801208496
local_in_edges_tensor generation:  0.03270387649536133
mini_batch_src_global generation:  0.05250287055969238
r_  generation:  0.46016669273376465
local_output_nid generation:  0.0311281681060791
local_in_edges_tensor generation:  0.029852867126464844
mini_batch_src_global generation:  0.05325627326965332
r_  generation:  0.4524803161621094
local_output_nid generation:  0.031330108642578125
local_in_edges_tensor generation:  0.02898693084716797
mini_batch_src_global generation:  0.05263662338256836
r_  generation:  0.4593977928161621
local_output_nid generation:  0.031026363372802734
local_in_edges_tensor generation:  0.029776334762573242
mini_batch_src_global generation:  0.05355501174926758
r_  generation:  0.45330166816711426
local_output_nid generation:  0.030976295471191406
local_in_edges_tensor generation:  0.032688140869140625
mini_batch_src_global generation:  0.053941965103149414
r_  generation:  0.4604983329772949
local_output_nid generation:  0.0309598445892334
local_in_edges_tensor generation:  0.030617952346801758
mini_batch_src_global generation:  0.05482053756713867
r_  generation:  0.4539601802825928
local_output_nid generation:  0.031095266342163086
local_in_edges_tensor generation:  0.028789758682250977
mini_batch_src_global generation:  0.051949501037597656
r_  generation:  0.46154332160949707
local_output_nid generation:  0.031122446060180664
local_in_edges_tensor generation:  0.030031442642211914
mini_batch_src_global generation:  0.052590370178222656
r_  generation:  0.4505453109741211
----------------------check_connections_block total spend ----------------------------- 10.749451160430908
generate_one_block  0.5676989555358887
generate_one_block  0.586035966873169
generate_one_block  0.5775959491729736
generate_one_block  0.5719997882843018
generate_one_block  0.576634407043457
generate_one_block  0.5797224044799805
generate_one_block  0.5747964382171631
generate_one_block  0.5784420967102051
generate_one_block  0.6105749607086182
generate_one_block  0.5842530727386475
generate_one_block  0.5729424953460693
generate_one_block  0.5748515129089355
generate_one_block  0.5877032279968262
generate_one_block  0.5800125598907471
generate_one_block  0.5799987316131592
generate_one_block  0.5789206027984619
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11546516418457031  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

connection checking time:  15.693307161331177
block generation total time  13.60227918624878
average batch blocks generation time:  0.8501424491405487
block dataloader generation time/epoch 31.146919515397812
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09379816055297852  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7158923149108887  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09359407424926758  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7243494987487793  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09392261505126953  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.718742847442627  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09316635131835938  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7138762474060059  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09389686584472656  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7175827026367188  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09344196319580078  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7198576927185059  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09383869171142578  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.71685791015625  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0934443473815918  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7195520401000977  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09391212463378906  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7190423011779785  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09321975708007812  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7162013053894043  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09393501281738281  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.718297004699707  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09325218200683594  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7157144546508789  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0938425064086914  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7176132202148438  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0933527946472168  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7182450294494629  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.093841552734375  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7171926498413086  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0933065414428711  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7161970138549805  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06071782112121582 |0.012067317962646484 |0.0035776644945144653 |9.493529796600342e-05 |0.002968147397041321 |0.0029664039611816406 |
----------------------------------------------------------pseudo_mini_loss sum 1.240402102470398
Total (block generation + training)time/epoch 32.49967658519745
Training time/epoch 1.332033634185791
Training time without block to device /epoch 1.1389565467834473
Training time without total dataloading part /epoch 0.10921835899353027
load block tensor time/epoch 0.9714851379394531
block to device time/epoch 0.19307708740234375
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 27 |
Number of nodes for computation during this epoch:  5092185
Number of first layer input nodes during this epoch:  2471215
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11496591567993164  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023460865020751953
random selection method range initialization spend 0.005801677703857422
time for parepare:  0.017501354217529297
local_output_nid generation:  0.002390623092651367
local_in_edges_tensor generation:  0.0038471221923828125
mini_batch_src_global generation:  0.0016703605651855469
r_  generation:  0.019025802612304688
local_output_nid generation:  0.0029191970825195312
local_in_edges_tensor generation:  0.0017735958099365234
mini_batch_src_global generation:  0.0018031597137451172
r_  generation:  0.01963329315185547
local_output_nid generation:  0.002930164337158203
local_in_edges_tensor generation:  0.0016727447509765625
mini_batch_src_global generation:  0.0015354156494140625
r_  generation:  0.019212007522583008
local_output_nid generation:  0.0029785633087158203
local_in_edges_tensor generation:  0.0016605854034423828
mini_batch_src_global generation:  0.0015850067138671875
r_  generation:  0.019350767135620117
local_output_nid generation:  0.002973794937133789
local_in_edges_tensor generation:  0.0015997886657714844
mini_batch_src_global generation:  0.0015850067138671875
r_  generation:  0.018879175186157227
local_output_nid generation:  0.00296783447265625
local_in_edges_tensor generation:  0.0015802383422851562
mini_batch_src_global generation:  0.0015265941619873047
r_  generation:  0.01901555061340332
local_output_nid generation:  0.002932310104370117
local_in_edges_tensor generation:  0.0015683174133300781
mini_batch_src_global generation:  0.0015654563903808594
r_  generation:  0.01946425437927246
local_output_nid generation:  0.0029256343841552734
local_in_edges_tensor generation:  0.0015969276428222656
mini_batch_src_global generation:  0.001590728759765625
r_  generation:  0.019804000854492188
local_output_nid generation:  0.00293731689453125
local_in_edges_tensor generation:  0.0015687942504882812
mini_batch_src_global generation:  0.0015726089477539062
r_  generation:  0.01980304718017578
local_output_nid generation:  0.0029397010803222656
local_in_edges_tensor generation:  0.0015573501586914062
mini_batch_src_global generation:  0.0015704631805419922
r_  generation:  0.01947188377380371
local_output_nid generation:  0.0029754638671875
local_in_edges_tensor generation:  0.0015931129455566406
mini_batch_src_global generation:  0.0016319751739501953
r_  generation:  0.019737720489501953
local_output_nid generation:  0.002932310104370117
local_in_edges_tensor generation:  0.0016179084777832031
mini_batch_src_global generation:  0.0015788078308105469
r_  generation:  0.02037525177001953
local_output_nid generation:  0.0029594898223876953
local_in_edges_tensor generation:  0.0016021728515625
mini_batch_src_global generation:  0.0016117095947265625
r_  generation:  0.020003318786621094
local_output_nid generation:  0.0030748844146728516
local_in_edges_tensor generation:  0.0016019344329833984
mini_batch_src_global generation:  0.001603841781616211
r_  generation:  0.019640684127807617
local_output_nid generation:  0.0030059814453125
local_in_edges_tensor generation:  0.0015840530395507812
mini_batch_src_global generation:  0.001554727554321289
r_  generation:  0.01922464370727539
local_output_nid generation:  0.0029540061950683594
local_in_edges_tensor generation:  0.001577138900756836
mini_batch_src_global generation:  0.0015683174133300781
r_  generation:  0.019277095794677734
----------------------check_connections_block total spend ----------------------------- 0.5111615657806396
generate_one_block  0.027510643005371094
generate_one_block  0.02852773666381836
generate_one_block  0.027910709381103516
generate_one_block  0.02838134765625
generate_one_block  0.027642250061035156
generate_one_block  0.029860734939575195
generate_one_block  0.02819681167602539
generate_one_block  0.02805018424987793
generate_one_block  0.027971506118774414
generate_one_block  0.02760624885559082
generate_one_block  0.028015851974487305
generate_one_block  0.02867579460144043
generate_one_block  0.028090953826904297
generate_one_block  0.0278322696685791
generate_one_block  0.027366161346435547
generate_one_block  0.02782750129699707
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03208613395690918
gen group dst list time:  0.015602827072143555
time for parepare:  0.019492387771606445
local_output_nid generation:  0.008699178695678711
local_in_edges_tensor generation:  0.019555330276489258
mini_batch_src_global generation:  0.020782947540283203
r_  generation:  0.19237136840820312
local_output_nid generation:  0.012538909912109375
local_in_edges_tensor generation:  0.015212774276733398
mini_batch_src_global generation:  0.02474689483642578
r_  generation:  0.20340394973754883
local_output_nid generation:  0.012113094329833984
local_in_edges_tensor generation:  0.014478683471679688
mini_batch_src_global generation:  0.025327205657958984
r_  generation:  0.2077162265777588
local_output_nid generation:  0.012268781661987305
local_in_edges_tensor generation:  0.013828516006469727
mini_batch_src_global generation:  0.024615764617919922
r_  generation:  0.21060752868652344
local_output_nid generation:  0.012709379196166992
local_in_edges_tensor generation:  0.01549386978149414
mini_batch_src_global generation:  0.03275895118713379
r_  generation:  0.21600341796875
local_output_nid generation:  0.014013528823852539
local_in_edges_tensor generation:  0.01317739486694336
mini_batch_src_global generation:  0.02847433090209961
r_  generation:  0.20880722999572754
local_output_nid generation:  0.013097047805786133
local_in_edges_tensor generation:  0.012509822845458984
mini_batch_src_global generation:  0.02644968032836914
r_  generation:  0.21229100227355957
local_output_nid generation:  0.013271808624267578
local_in_edges_tensor generation:  0.012952327728271484
mini_batch_src_global generation:  0.026520252227783203
r_  generation:  0.21316313743591309
local_output_nid generation:  0.013311624526977539
local_in_edges_tensor generation:  0.01219487190246582
mini_batch_src_global generation:  0.02704644203186035
r_  generation:  0.21693658828735352
local_output_nid generation:  0.012876033782958984
local_in_edges_tensor generation:  0.012016057968139648
mini_batch_src_global generation:  0.02658390998840332
r_  generation:  0.2137296199798584
local_output_nid generation:  0.013046979904174805
local_in_edges_tensor generation:  0.012279987335205078
mini_batch_src_global generation:  0.026694059371948242
r_  generation:  0.2148737907409668
local_output_nid generation:  0.013156414031982422
local_in_edges_tensor generation:  0.011824607849121094
mini_batch_src_global generation:  0.026776552200317383
r_  generation:  0.21422171592712402
local_output_nid generation:  0.013326644897460938
local_in_edges_tensor generation:  0.012764692306518555
mini_batch_src_global generation:  0.02724146842956543
r_  generation:  0.2176346778869629
local_output_nid generation:  0.013128042221069336
local_in_edges_tensor generation:  0.012652397155761719
mini_batch_src_global generation:  0.02666020393371582
r_  generation:  0.21343636512756348
local_output_nid generation:  0.012985467910766602
local_in_edges_tensor generation:  0.01309514045715332
mini_batch_src_global generation:  0.02674722671508789
r_  generation:  0.21245980262756348
local_output_nid generation:  0.013086318969726562
local_in_edges_tensor generation:  0.012134552001953125
mini_batch_src_global generation:  0.02710747718811035
r_  generation:  0.21014094352722168
----------------------check_connections_block total spend ----------------------------- 4.982720613479614
generate_one_block  0.2699317932128906
generate_one_block  0.2693440914154053
generate_one_block  0.27538585662841797
generate_one_block  0.2730724811553955
generate_one_block  0.26879096031188965
generate_one_block  0.26105570793151855
generate_one_block  0.28989315032958984
generate_one_block  0.2716224193572998
generate_one_block  0.2749929428100586
generate_one_block  0.2667093276977539
generate_one_block  0.2679891586303711
generate_one_block  0.2721261978149414
generate_one_block  0.27527761459350586
generate_one_block  0.26734328269958496
generate_one_block  0.26739501953125
generate_one_block  0.262068510055542
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.036304473876953125
gen group dst list time:  0.06172823905944824
time for parepare:  0.018969297409057617
local_output_nid generation:  0.02648782730102539
local_in_edges_tensor generation:  0.04819607734680176
mini_batch_src_global generation:  0.039862871170043945
r_  generation:  0.4467644691467285
local_output_nid generation:  0.03209805488586426
local_in_edges_tensor generation:  0.03531360626220703
mini_batch_src_global generation:  0.051947593688964844
r_  generation:  0.44965529441833496
local_output_nid generation:  0.031496286392211914
local_in_edges_tensor generation:  0.031476497650146484
mini_batch_src_global generation:  0.053131818771362305
r_  generation:  0.4603395462036133
local_output_nid generation:  0.031629323959350586
local_in_edges_tensor generation:  0.029427528381347656
mini_batch_src_global generation:  0.053978681564331055
r_  generation:  0.4571216106414795
local_output_nid generation:  0.03156924247741699
local_in_edges_tensor generation:  0.07151460647583008
mini_batch_src_global generation:  0.051628828048706055
r_  generation:  0.4595489501953125
local_output_nid generation:  0.031282663345336914
local_in_edges_tensor generation:  0.030775785446166992
mini_batch_src_global generation:  0.05439329147338867
r_  generation:  0.44911766052246094
local_output_nid generation:  0.03135275840759277
local_in_edges_tensor generation:  0.029063940048217773
mini_batch_src_global generation:  0.05131721496582031
r_  generation:  0.45876622200012207
local_output_nid generation:  0.031511545181274414
local_in_edges_tensor generation:  0.03307938575744629
mini_batch_src_global generation:  0.05322909355163574
r_  generation:  0.4510993957519531
local_output_nid generation:  0.03157663345336914
local_in_edges_tensor generation:  0.031038284301757812
mini_batch_src_global generation:  0.05430340766906738
r_  generation:  0.45806360244750977
local_output_nid generation:  0.031333208084106445
local_in_edges_tensor generation:  0.028733491897583008
mini_batch_src_global generation:  0.05277371406555176
r_  generation:  0.4508168697357178
local_output_nid generation:  0.03150367736816406
local_in_edges_tensor generation:  0.029212474822998047
mini_batch_src_global generation:  0.05197477340698242
r_  generation:  0.45822668075561523
local_output_nid generation:  0.03126215934753418
local_in_edges_tensor generation:  0.030741453170776367
mini_batch_src_global generation:  0.053501129150390625
r_  generation:  0.4503939151763916
local_output_nid generation:  0.03146839141845703
local_in_edges_tensor generation:  0.029180288314819336
mini_batch_src_global generation:  0.051583051681518555
r_  generation:  0.4604909420013428
local_output_nid generation:  0.03129220008850098
local_in_edges_tensor generation:  0.030933856964111328
mini_batch_src_global generation:  0.05487227439880371
r_  generation:  0.4572489261627197
local_output_nid generation:  0.031720876693725586
local_in_edges_tensor generation:  0.029108047485351562
mini_batch_src_global generation:  0.05233144760131836
r_  generation:  0.455946683883667
local_output_nid generation:  0.0313870906829834
local_in_edges_tensor generation:  0.02920818328857422
mini_batch_src_global generation:  0.0525205135345459
r_  generation:  0.4503638744354248
----------------------check_connections_block total spend ----------------------------- 10.743480205535889
generate_one_block  0.570934534072876
generate_one_block  0.578608512878418
generate_one_block  0.582223653793335
generate_one_block  0.5768730640411377
generate_one_block  0.5748941898345947
generate_one_block  0.570427656173706
generate_one_block  0.5694887638092041
generate_one_block  0.5763871669769287
generate_one_block  0.637362003326416
generate_one_block  0.5692057609558105
generate_one_block  0.5697736740112305
generate_one_block  0.5754549503326416
generate_one_block  0.5739736557006836
generate_one_block  0.5706405639648438
generate_one_block  0.5681333541870117
generate_one_block  0.5731637477874756
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.11496591567993164  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

connection checking time:  15.726200819015503
block generation total time  13.570543766021729
average batch blocks generation time:  0.848158985376358
block dataloader generation time/epoch 31.155968189239502
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09392690658569336  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7182044982910156  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09340953826904297  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7177333831787109  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0939931869506836  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7193751335144043  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09336090087890625  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7181596755981445  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09383487701416016  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7163147926330566  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09298515319824219  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7103266716003418  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09383010864257812  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7170066833496094  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09345340728759766  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7191381454467773  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09400558471679688  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7210402488708496  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09311342239379883  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7106947898864746  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09384918212890625  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7176766395568848  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09337091445922852  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7183794975280762  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.093994140625  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7229557037353516  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0932774543762207  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7167930603027344  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09381771087646484  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7158241271972656  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09327173233032227  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7153506278991699  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05939190089702606 |0.009490489959716797 |0.003613010048866272 |9.480118751525879e-05 |0.0028496980667114258 |0.0016622543334960938 |
----------------------------------------------------------pseudo_mini_loss sum 1.2262061834335327
Total (block generation + training)time/epoch 32.50433861581903
Training time/epoch 1.2691748142242432
Training time without block to device /epoch 1.1173269748687744
Training time without total dataloading part /epoch 0.1065824031829834
load block tensor time/epoch 0.950270414352417
block to device time/epoch 0.15184783935546875
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 28 |
Number of nodes for computation during this epoch:  5088842
Number of first layer input nodes during this epoch:  2470684
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.1148223876953125  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.017206668853759766
random selection method range initialization spend 0.005872011184692383
time for parepare:  0.01903843879699707
local_output_nid generation:  0.0023813247680664062
local_in_edges_tensor generation:  0.004051923751831055
mini_batch_src_global generation:  0.0013973712921142578
r_  generation:  0.0182342529296875
local_output_nid generation:  0.0028464794158935547
local_in_edges_tensor generation:  0.0016558170318603516
mini_batch_src_global generation:  0.0018029212951660156
r_  generation:  0.0197601318359375
local_output_nid generation:  0.0029408931732177734
local_in_edges_tensor generation:  0.0017604827880859375
mini_batch_src_global generation:  0.0015099048614501953
r_  generation:  0.01919412612915039
local_output_nid generation:  0.0029325485229492188
local_in_edges_tensor generation:  0.0016019344329833984
mini_batch_src_global generation:  0.0015110969543457031
r_  generation:  0.018831729888916016
local_output_nid generation:  0.0028989315032958984
local_in_edges_tensor generation:  0.0015723705291748047
mini_batch_src_global generation:  0.0014963150024414062
r_  generation:  0.01903676986694336
local_output_nid generation:  0.0029120445251464844
local_in_edges_tensor generation:  0.0016131401062011719
mini_batch_src_global generation:  0.0015358924865722656
r_  generation:  0.019012928009033203
local_output_nid generation:  0.0029175281524658203
local_in_edges_tensor generation:  0.0015158653259277344
mini_batch_src_global generation:  0.0016019344329833984
r_  generation:  0.020390033721923828
local_output_nid generation:  0.0029315948486328125
local_in_edges_tensor generation:  0.0015873908996582031
mini_batch_src_global generation:  0.0016028881072998047
r_  generation:  0.019608020782470703
local_output_nid generation:  0.0029010772705078125
local_in_edges_tensor generation:  0.001524209976196289
mini_batch_src_global generation:  0.0015473365783691406
r_  generation:  0.020008563995361328
local_output_nid generation:  0.0029120445251464844
local_in_edges_tensor generation:  0.0014967918395996094
mini_batch_src_global generation:  0.0015821456909179688
r_  generation:  0.019469022750854492
local_output_nid generation:  0.0029747486114501953
local_in_edges_tensor generation:  0.0028808116912841797
mini_batch_src_global generation:  0.001911163330078125
r_  generation:  0.019292354583740234
local_output_nid generation:  0.0029528141021728516
local_in_edges_tensor generation:  0.001573801040649414
mini_batch_src_global generation:  0.0015687942504882812
r_  generation:  0.01931619644165039
local_output_nid generation:  0.0028984546661376953
local_in_edges_tensor generation:  0.0014679431915283203
mini_batch_src_global generation:  0.001659393310546875
r_  generation:  0.019809484481811523
local_output_nid generation:  0.002913951873779297
local_in_edges_tensor generation:  0.001512289047241211
mini_batch_src_global generation:  0.001622915267944336
r_  generation:  0.01977682113647461
local_output_nid generation:  0.0029633045196533203
local_in_edges_tensor generation:  0.0014946460723876953
mini_batch_src_global generation:  0.0015332698822021484
r_  generation:  0.019433975219726562
local_output_nid generation:  0.002965211868286133
local_in_edges_tensor generation:  0.001619100570678711
mini_batch_src_global generation:  0.0016033649444580078
r_  generation:  0.02009272575378418
----------------------check_connections_block total spend ----------------------------- 0.5150446891784668
generate_one_block  0.027914762496948242
generate_one_block  0.028256893157958984
generate_one_block  0.028031587600708008
generate_one_block  0.027569055557250977
generate_one_block  0.027722597122192383
generate_one_block  0.030504465103149414
generate_one_block  0.02916121482849121
generate_one_block  0.028035640716552734
generate_one_block  0.028834104537963867
generate_one_block  0.027798891067504883
generate_one_block  0.027537822723388672
generate_one_block  0.027628660202026367
generate_one_block  0.02837347984313965
generate_one_block  0.027968645095825195
generate_one_block  0.027796030044555664
generate_one_block  0.029036760330200195
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0358729362487793
gen group dst list time:  0.015845060348510742
time for parepare:  0.019827604293823242
local_output_nid generation:  0.008599281311035156
local_in_edges_tensor generation:  0.01910257339477539
mini_batch_src_global generation:  0.0196993350982666
r_  generation:  0.1911177635192871
local_output_nid generation:  0.012305259704589844
local_in_edges_tensor generation:  0.014870643615722656
mini_batch_src_global generation:  0.024445772171020508
r_  generation:  0.20176982879638672
local_output_nid generation:  0.01204061508178711
local_in_edges_tensor generation:  0.012886524200439453
mini_batch_src_global generation:  0.023920536041259766
r_  generation:  0.20598936080932617
local_output_nid generation:  0.012370109558105469
local_in_edges_tensor generation:  0.012885093688964844
mini_batch_src_global generation:  0.024127960205078125
r_  generation:  0.2060377597808838
local_output_nid generation:  0.012774944305419922
local_in_edges_tensor generation:  0.012044191360473633
mini_batch_src_global generation:  0.025908470153808594
r_  generation:  0.21281862258911133
local_output_nid generation:  0.012629985809326172
local_in_edges_tensor generation:  0.012070655822753906
mini_batch_src_global generation:  0.025641918182373047
r_  generation:  0.2100982666015625
local_output_nid generation:  0.013028621673583984
local_in_edges_tensor generation:  0.013078451156616211
mini_batch_src_global generation:  0.02914571762084961
r_  generation:  0.21680474281311035
local_output_nid generation:  0.012711286544799805
local_in_edges_tensor generation:  0.012806177139282227
mini_batch_src_global generation:  0.030117034912109375
r_  generation:  0.212479829788208
local_output_nid generation:  0.013954639434814453
local_in_edges_tensor generation:  0.013262271881103516
mini_batch_src_global generation:  0.029787540435791016
r_  generation:  0.21623826026916504
local_output_nid generation:  0.012588262557983398
local_in_edges_tensor generation:  0.012290477752685547
mini_batch_src_global generation:  0.026460886001586914
r_  generation:  0.21097922325134277
local_output_nid generation:  0.012308597564697266
local_in_edges_tensor generation:  0.012232065200805664
mini_batch_src_global generation:  0.026157140731811523
r_  generation:  0.21097874641418457
local_output_nid generation:  0.012540578842163086
local_in_edges_tensor generation:  0.011934757232666016
mini_batch_src_global generation:  0.026339292526245117
r_  generation:  0.21340298652648926
local_output_nid generation:  0.013032674789428711
local_in_edges_tensor generation:  0.014546394348144531
mini_batch_src_global generation:  0.0286715030670166
r_  generation:  0.22453641891479492
local_output_nid generation:  0.012895822525024414
local_in_edges_tensor generation:  0.012328147888183594
mini_batch_src_global generation:  0.027138710021972656
r_  generation:  0.21321582794189453
local_output_nid generation:  0.012719392776489258
local_in_edges_tensor generation:  0.01242828369140625
mini_batch_src_global generation:  0.02658867835998535
r_  generation:  0.2162482738494873
local_output_nid generation:  0.012839794158935547
local_in_edges_tensor generation:  0.014937162399291992
mini_batch_src_global generation:  0.026996612548828125
r_  generation:  0.2187643051147461
----------------------check_connections_block total spend ----------------------------- 4.981282711029053
generate_one_block  0.2680830955505371
generate_one_block  0.26377153396606445
generate_one_block  0.2707083225250244
generate_one_block  0.26908302307128906
generate_one_block  0.2690584659576416
generate_one_block  0.2685365676879883
generate_one_block  0.30038976669311523
generate_one_block  0.26845669746398926
generate_one_block  0.2780721187591553
generate_one_block  0.26866698265075684
generate_one_block  0.26445436477661133
generate_one_block  0.2672762870788574
generate_one_block  0.2821173667907715
generate_one_block  0.2689387798309326
generate_one_block  0.2684786319732666
generate_one_block  0.27555251121520996
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03182578086853027
gen group dst list time:  0.06673741340637207
time for parepare:  0.01872706413269043
local_output_nid generation:  0.02714681625366211
local_in_edges_tensor generation:  0.05926847457885742
mini_batch_src_global generation:  0.041900634765625
r_  generation:  0.4462699890136719
local_output_nid generation:  0.031968116760253906
local_in_edges_tensor generation:  0.039752960205078125
mini_batch_src_global generation:  0.05170297622680664
r_  generation:  0.4451334476470947
local_output_nid generation:  0.031136512756347656
local_in_edges_tensor generation:  0.03462958335876465
mini_batch_src_global generation:  0.0513455867767334
r_  generation:  0.45612502098083496
local_output_nid generation:  0.03156876564025879
local_in_edges_tensor generation:  0.035019636154174805
mini_batch_src_global generation:  0.052210092544555664
r_  generation:  0.4501991271972656
local_output_nid generation:  0.03146982192993164
local_in_edges_tensor generation:  0.07819604873657227
mini_batch_src_global generation:  0.0568234920501709
r_  generation:  0.457399845123291
local_output_nid generation:  0.031365394592285156
local_in_edges_tensor generation:  0.03483104705810547
mini_batch_src_global generation:  0.05257463455200195
r_  generation:  0.4508519172668457
local_output_nid generation:  0.031954050064086914
local_in_edges_tensor generation:  0.033098697662353516
mini_batch_src_global generation:  0.05220532417297363
r_  generation:  0.4610738754272461
local_output_nid generation:  0.031215667724609375
local_in_edges_tensor generation:  0.0358424186706543
mini_batch_src_global generation:  0.05746650695800781
r_  generation:  0.458451509475708
local_output_nid generation:  0.031758785247802734
local_in_edges_tensor generation:  0.03242182731628418
mini_batch_src_global generation:  0.05425906181335449
r_  generation:  0.464479923248291
local_output_nid generation:  0.031168699264526367
local_in_edges_tensor generation:  0.0343930721282959
mini_batch_src_global generation:  0.054027557373046875
r_  generation:  0.452517032623291
local_output_nid generation:  0.031484127044677734
local_in_edges_tensor generation:  0.032186031341552734
mini_batch_src_global generation:  0.05261802673339844
r_  generation:  0.46131157875061035
local_output_nid generation:  0.031330108642578125
local_in_edges_tensor generation:  0.032482147216796875
mini_batch_src_global generation:  0.053838253021240234
r_  generation:  0.45725488662719727
local_output_nid generation:  0.03139925003051758
local_in_edges_tensor generation:  0.031969547271728516
mini_batch_src_global generation:  0.054686784744262695
r_  generation:  0.4659311771392822
local_output_nid generation:  0.03136873245239258
local_in_edges_tensor generation:  0.03399181365966797
mini_batch_src_global generation:  0.055690765380859375
r_  generation:  0.45699310302734375
local_output_nid generation:  0.03180265426635742
local_in_edges_tensor generation:  0.032125234603881836
mini_batch_src_global generation:  0.05361223220825195
r_  generation:  0.45978856086730957
local_output_nid generation:  0.03150367736816406
local_in_edges_tensor generation:  0.03557991981506348
mini_batch_src_global generation:  0.052139997482299805
r_  generation:  0.4597506523132324
----------------------check_connections_block total spend ----------------------------- 10.854342222213745
generate_one_block  0.5851607322692871
generate_one_block  0.5671865940093994
generate_one_block  0.5699400901794434
generate_one_block  0.582406759262085
generate_one_block  0.5792407989501953
generate_one_block  0.5713374614715576
generate_one_block  0.575136661529541
generate_one_block  0.5819857120513916
generate_one_block  0.6136949062347412
generate_one_block  0.5704729557037354
generate_one_block  0.5823180675506592
generate_one_block  0.5699117183685303
generate_one_block  0.5835843086242676
generate_one_block  0.5756838321685791
generate_one_block  0.58001708984375
generate_one_block  0.5846195220947266
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.1148223876953125  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

connection checking time:  15.835624933242798
block generation total time  13.6243417263031
average batch blocks generation time:  0.8515213578939438
block dataloader generation time/epoch 31.171038818359374
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09383153915405273  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7167906761169434  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09303617477416992  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7117137908935547  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09390830993652344  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7182574272155762  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09348154067993164  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7172331809997559  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09390926361083984  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7172813415527344  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09305334091186523  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7146501541137695  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09406280517578125  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7233734130859375  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0932459831237793  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7164716720581055  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09403800964355469  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7249956130981445  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09330606460571289  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7146673202514648  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.093841552734375  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.717339038848877  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09316396713256836  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7163424491882324  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09412956237792969  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7253007888793945  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0933980941772461  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7173104286193848  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09386348724365234  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7177972793579102  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09345483779907227  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7196998596191406  GigaBytes
Max Memory Allocated: 0.8067202568054199  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06309694051742554 |0.009488582611083984 |0.003674551844596863 |9.50843095779419e-05 |0.0036594122648239136 |0.0014395713806152344 |
----------------------------------------------------------pseudo_mini_loss sum 1.2153143882751465
Total (block generation + training)time/epoch 32.519105219841
Training time/epoch 1.3420522212982178
Training time without block to device /epoch 1.190234899520874
Training time without total dataloading part /epoch 0.12030434608459473
load block tensor time/epoch 1.0095510482788086
block to device time/epoch 0.15181732177734375
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 29 |
Number of nodes for computation during this epoch:  5092773
Number of first layer input nodes during this epoch:  2472119
