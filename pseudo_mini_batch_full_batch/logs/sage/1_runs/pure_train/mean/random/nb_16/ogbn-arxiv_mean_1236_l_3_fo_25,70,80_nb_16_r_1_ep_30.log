Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1647759350.7478757
ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025480270385742188
random selection method range initialization spend 0.006265401840209961
time for parepare:  0.019123077392578125
local_output_nid generation:  0.0021736621856689453
local_in_edges_tensor generation:  0.003916263580322266
mini_batch_src_global generation:  0.002002716064453125
r_  generation:  0.024031639099121094
local_output_nid generation:  0.0029332637786865234
local_in_edges_tensor generation:  0.001661539077758789
mini_batch_src_global generation:  0.0028662681579589844
r_  generation:  0.02302098274230957
local_output_nid generation:  0.0029480457305908203
local_in_edges_tensor generation:  0.0016047954559326172
mini_batch_src_global generation:  0.0019185543060302734
r_  generation:  0.023282766342163086
local_output_nid generation:  0.002966642379760742
local_in_edges_tensor generation:  0.0015671253204345703
mini_batch_src_global generation:  0.0019352436065673828
r_  generation:  0.02114248275756836
local_output_nid generation:  0.0029592514038085938
local_in_edges_tensor generation:  0.0015707015991210938
mini_batch_src_global generation:  0.0015277862548828125
r_  generation:  0.020164966583251953
local_output_nid generation:  0.002941608428955078
local_in_edges_tensor generation:  0.0015501976013183594
mini_batch_src_global generation:  0.0016586780548095703
r_  generation:  0.022089242935180664
local_output_nid generation:  0.003004312515258789
local_in_edges_tensor generation:  0.00154876708984375
mini_batch_src_global generation:  0.0016994476318359375
r_  generation:  0.02149820327758789
local_output_nid generation:  0.002942323684692383
local_in_edges_tensor generation:  0.0015845298767089844
mini_batch_src_global generation:  0.0016674995422363281
r_  generation:  0.02127385139465332
local_output_nid generation:  0.002942323684692383
local_in_edges_tensor generation:  0.001516580581665039
mini_batch_src_global generation:  0.001638174057006836
r_  generation:  0.022563934326171875
local_output_nid generation:  0.0029315948486328125
local_in_edges_tensor generation:  0.0015501976013183594
mini_batch_src_global generation:  0.0017385482788085938
r_  generation:  0.02180314064025879
local_output_nid generation:  0.0029532909393310547
local_in_edges_tensor generation:  0.0015439987182617188
mini_batch_src_global generation:  0.0017242431640625
r_  generation:  0.021795988082885742
local_output_nid generation:  0.0029871463775634766
local_in_edges_tensor generation:  0.0015149116516113281
mini_batch_src_global generation:  0.0017001628875732422
r_  generation:  0.022391080856323242
local_output_nid generation:  0.003046274185180664
local_in_edges_tensor generation:  0.0015206336975097656
mini_batch_src_global generation:  0.0017862319946289062
r_  generation:  0.021944761276245117
local_output_nid generation:  0.0029914379119873047
local_in_edges_tensor generation:  0.0015578269958496094
mini_batch_src_global generation:  0.0017414093017578125
r_  generation:  0.02215409278869629
local_output_nid generation:  0.0029861927032470703
local_in_edges_tensor generation:  0.0015232563018798828
mini_batch_src_global generation:  0.0017344951629638672
r_  generation:  0.022063732147216797
local_output_nid generation:  0.0029582977294921875
local_in_edges_tensor generation:  0.0015981197357177734
mini_batch_src_global generation:  0.0017364025115966797
r_  generation:  0.021686315536499023
----------------------check_connections_block total spend ----------------------------- 0.5666580200195312
generate_one_block  0.030884742736816406
generate_one_block  0.032390594482421875
generate_one_block  0.03593897819519043
generate_one_block  0.03182172775268555
generate_one_block  0.0302734375
generate_one_block  0.032510995864868164
generate_one_block  0.03100109100341797
generate_one_block  0.03051924705505371
generate_one_block  0.03167843818664551
generate_one_block  0.03101515769958496
generate_one_block  0.031035900115966797
generate_one_block  0.03198575973510742
generate_one_block  0.031488656997680664
generate_one_block  0.031449079513549805
generate_one_block  0.031406402587890625
generate_one_block  0.031011104583740234
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.039353132247924805
gen group dst list time:  0.020761966705322266
time for parepare:  0.01922750473022461
local_output_nid generation:  0.00938105583190918
local_in_edges_tensor generation:  0.021877765655517578
mini_batch_src_global generation:  0.027812957763671875
r_  generation:  0.2519834041595459
local_output_nid generation:  0.014167308807373047
local_in_edges_tensor generation:  0.023878812789916992
mini_batch_src_global generation:  0.03293561935424805
r_  generation:  0.2581634521484375
local_output_nid generation:  0.013964176177978516
local_in_edges_tensor generation:  0.022022485733032227
mini_batch_src_global generation:  0.041985511779785156
r_  generation:  0.2730600833892822
local_output_nid generation:  0.013667583465576172
local_in_edges_tensor generation:  0.016555309295654297
mini_batch_src_global generation:  0.03239798545837402
r_  generation:  0.267672061920166
local_output_nid generation:  0.013614654541015625
local_in_edges_tensor generation:  0.01638007164001465
mini_batch_src_global generation:  0.03262662887573242
r_  generation:  0.26267409324645996
local_output_nid generation:  0.014008522033691406
local_in_edges_tensor generation:  0.016486167907714844
mini_batch_src_global generation:  0.034217119216918945
r_  generation:  0.2792787551879883
local_output_nid generation:  0.013684511184692383
local_in_edges_tensor generation:  0.016611576080322266
mini_batch_src_global generation:  0.03376483917236328
r_  generation:  0.268718957901001
local_output_nid generation:  0.013628959655761719
local_in_edges_tensor generation:  0.018414974212646484
mini_batch_src_global generation:  0.03321218490600586
r_  generation:  0.26409292221069336
local_output_nid generation:  0.013797283172607422
local_in_edges_tensor generation:  0.016619205474853516
mini_batch_src_global generation:  0.036632537841796875
r_  generation:  0.277172327041626
local_output_nid generation:  0.013959884643554688
local_in_edges_tensor generation:  0.01877307891845703
mini_batch_src_global generation:  0.034544944763183594
r_  generation:  0.2744326591491699
local_output_nid generation:  0.013640403747558594
local_in_edges_tensor generation:  0.013890981674194336
mini_batch_src_global generation:  0.03442096710205078
r_  generation:  0.26996517181396484
local_output_nid generation:  0.01398777961730957
local_in_edges_tensor generation:  0.018579959869384766
mini_batch_src_global generation:  0.034693002700805664
r_  generation:  0.27625393867492676
local_output_nid generation:  0.013903379440307617
local_in_edges_tensor generation:  0.021344423294067383
mini_batch_src_global generation:  0.0343327522277832
r_  generation:  0.27259016036987305
local_output_nid generation:  0.013773918151855469
local_in_edges_tensor generation:  0.016386985778808594
mini_batch_src_global generation:  0.034388065338134766
r_  generation:  0.2769021987915039
local_output_nid generation:  0.013750791549682617
local_in_edges_tensor generation:  0.021240949630737305
mini_batch_src_global generation:  0.03454875946044922
r_  generation:  0.27290797233581543
local_output_nid generation:  0.013603687286376953
local_in_edges_tensor generation:  0.014210224151611328
mini_batch_src_global generation:  0.03468894958496094
r_  generation:  0.2713453769683838
----------------------check_connections_block total spend ----------------------------- 6.309690237045288
generate_one_block  0.36293578147888184
generate_one_block  0.35405826568603516
generate_one_block  0.3698744773864746
generate_one_block  0.35210418701171875
generate_one_block  0.35764193534851074
generate_one_block  0.36635303497314453
generate_one_block  0.3510160446166992
generate_one_block  0.34040093421936035
generate_one_block  0.3666393756866455
generate_one_block  0.3586134910583496
generate_one_block  0.34417104721069336
generate_one_block  0.362501859664917
generate_one_block  0.3586416244506836
generate_one_block  0.3575441837310791
generate_one_block  0.36959266662597656
generate_one_block  0.3480701446533203
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.07356977462768555
gen group dst list time:  0.07248568534851074
time for parepare:  0.019828081130981445
local_output_nid generation:  0.027436256408691406
local_in_edges_tensor generation:  0.05575084686279297
mini_batch_src_global generation:  0.04694700241088867
r_  generation:  0.4515409469604492
local_output_nid generation:  0.03281068801879883
local_in_edges_tensor generation:  0.04832053184509277
mini_batch_src_global generation:  0.053275346755981445
r_  generation:  0.4683396816253662
local_output_nid generation:  0.034124135971069336
local_in_edges_tensor generation:  0.04074454307556152
mini_batch_src_global generation:  0.057752370834350586
r_  generation:  0.488574743270874
local_output_nid generation:  0.03646993637084961
local_in_edges_tensor generation:  0.04438495635986328
mini_batch_src_global generation:  0.054688453674316406
r_  generation:  0.47313356399536133
local_output_nid generation:  0.03318142890930176
local_in_edges_tensor generation:  0.033865928649902344
mini_batch_src_global generation:  0.05216526985168457
r_  generation:  0.4746212959289551
local_output_nid generation:  0.03318333625793457
local_in_edges_tensor generation:  0.04050898551940918
mini_batch_src_global generation:  0.053174495697021484
r_  generation:  0.47765207290649414
local_output_nid generation:  0.03344368934631348
local_in_edges_tensor generation:  0.04003262519836426
mini_batch_src_global generation:  0.05367708206176758
r_  generation:  0.47499632835388184
local_output_nid generation:  0.033505916595458984
local_in_edges_tensor generation:  0.03259086608886719
mini_batch_src_global generation:  0.08181476593017578
r_  generation:  0.480543851852417
local_output_nid generation:  0.03323698043823242
local_in_edges_tensor generation:  0.032183170318603516
mini_batch_src_global generation:  0.05329108238220215
r_  generation:  0.47973012924194336
local_output_nid generation:  0.03489041328430176
local_in_edges_tensor generation:  0.0440983772277832
mini_batch_src_global generation:  0.0542759895324707
r_  generation:  0.47997212409973145
local_output_nid generation:  0.03597736358642578
local_in_edges_tensor generation:  0.04339790344238281
mini_batch_src_global generation:  0.05913281440734863
r_  generation:  0.47779130935668945
local_output_nid generation:  0.03366708755493164
local_in_edges_tensor generation:  0.038297414779663086
mini_batch_src_global generation:  0.05762672424316406
r_  generation:  0.5025684833526611
local_output_nid generation:  0.03352761268615723
local_in_edges_tensor generation:  0.044442176818847656
mini_batch_src_global generation:  0.05904579162597656
r_  generation:  0.4783492088317871
local_output_nid generation:  0.03362083435058594
local_in_edges_tensor generation:  0.03630566596984863
mini_batch_src_global generation:  0.05537533760070801
r_  generation:  0.48362112045288086
local_output_nid generation:  0.03570413589477539
local_in_edges_tensor generation:  0.03235507011413574
mini_batch_src_global generation:  0.05487394332885742
r_  generation:  0.4778103828430176
local_output_nid generation:  0.03336763381958008
local_in_edges_tensor generation:  0.040151357650756836
mini_batch_src_global generation:  0.05388379096984863
r_  generation:  0.4836256504058838
----------------------check_connections_block total spend ----------------------------- 11.467769145965576
generate_one_block  0.5996754169464111
generate_one_block  0.6107196807861328
generate_one_block  0.6231060028076172
generate_one_block  0.5948431491851807
generate_one_block  0.5960633754730225
generate_one_block  0.6060876846313477
generate_one_block  0.6536526679992676
generate_one_block  0.5955185890197754
generate_one_block  0.5970780849456787
generate_one_block  0.6030879020690918
generate_one_block  0.6014950275421143
generate_one_block  0.6060645580291748
generate_one_block  0.6041274070739746
generate_one_block  0.5946919918060303
generate_one_block  0.6108572483062744
generate_one_block  0.6011486053466797
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  17.777459383010864
block generation total time  15.418376445770264
average batch blocks generation time:  0.9636485278606415
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.09326791763305664  GigaBytes
Max Memory Allocated: 0.09326791763305664  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2244873046875 GB
    Memory Allocated: 0.7638301849365234  GigaBytes
Max Memory Allocated: 0.8054494857788086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5330810546875 GB
    Memory Allocated: 0.09595203399658203  GigaBytes
Max Memory Allocated: 0.8512997627258301  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5330810546875 GB
    Memory Allocated: 0.7702574729919434  GigaBytes
Max Memory Allocated: 0.8512997627258301  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.09621810913085938  GigaBytes
Max Memory Allocated: 0.8577070236206055  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.7751021385192871  GigaBytes
Max Memory Allocated: 0.8577070236206055  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.09594917297363281  GigaBytes
Max Memory Allocated: 0.8645539283752441  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.7691526412963867  GigaBytes
Max Memory Allocated: 0.8645539283752441  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.09554338455200195  GigaBytes
Max Memory Allocated: 0.8645539283752441  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7585959434509277  GigaBytes
Max Memory Allocated: 0.8645539283752441  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09613466262817383  GigaBytes
Max Memory Allocated: 0.8645539283752441  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.773015022277832  GigaBytes
Max Memory Allocated: 0.8645539283752441  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09588050842285156  GigaBytes
Max Memory Allocated: 0.8645539283752441  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7674522399902344  GigaBytes
Max Memory Allocated: 0.8645539283752441  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09563016891479492  GigaBytes
Max Memory Allocated: 0.8645539283752441  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7606229782104492  GigaBytes
Max Memory Allocated: 0.8645539283752441  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09569263458251953  GigaBytes
Max Memory Allocated: 0.8645539283752441  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7619314193725586  GigaBytes
Max Memory Allocated: 0.8645539283752441  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09588861465454102  GigaBytes
Max Memory Allocated: 0.8645539283752441  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7658634185791016  GigaBytes
Max Memory Allocated: 0.8645539283752441  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.0958094596862793  GigaBytes
Max Memory Allocated: 0.8645539283752441  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7635350227355957  GigaBytes
Max Memory Allocated: 0.8645539283752441  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09609508514404297  GigaBytes
Max Memory Allocated: 0.8645539283752441  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7738561630249023  GigaBytes
Max Memory Allocated: 0.8645539283752441  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09591960906982422  GigaBytes
Max Memory Allocated: 0.8645539283752441  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7658205032348633  GigaBytes
Max Memory Allocated: 0.8645539283752441  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09593963623046875  GigaBytes
Max Memory Allocated: 0.8645539283752441  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7694759368896484  GigaBytes
Max Memory Allocated: 0.8645539283752441  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.0958104133605957  GigaBytes
Max Memory Allocated: 0.8645539283752441  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7649416923522949  GigaBytes
Max Memory Allocated: 0.8645539283752441  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09576606750488281  GigaBytes
Max Memory Allocated: 0.8645539283752441  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7635245323181152  GigaBytes
Max Memory Allocated: 0.8645539283752441  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0596935898065567 |0.03861120343208313 |0.04944464564323425 |0.00010085105895996094 |0.011010289192199707 |0.00405120849609375 |
----------------------------------------------------------pseudo_mini_loss sum 6.275854110717773
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5321331
Number of first layer input nodes during this epoch:  2510844
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.1230616569519043  GigaBytes
Max Memory Allocated: 0.8645539283752441  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01983475685119629
random selection method range initialization spend 0.0052814483642578125
time for parepare:  0.018270015716552734
local_output_nid generation:  0.002387523651123047
local_in_edges_tensor generation:  0.00750279426574707
mini_batch_src_global generation:  0.0021283626556396484
r_  generation:  0.020331144332885742
local_output_nid generation:  0.0029630661010742188
local_in_edges_tensor generation:  0.001806497573852539
mini_batch_src_global generation:  0.002367734909057617
r_  generation:  0.021105051040649414
local_output_nid generation:  0.0029325485229492188
local_in_edges_tensor generation:  0.0016944408416748047
mini_batch_src_global generation:  0.0016024112701416016
r_  generation:  0.02067112922668457
local_output_nid generation:  0.0029511451721191406
local_in_edges_tensor generation:  0.0016112327575683594
mini_batch_src_global generation:  0.0015778541564941406
r_  generation:  0.021326541900634766
local_output_nid generation:  0.003015756607055664
local_in_edges_tensor generation:  0.0015919208526611328
mini_batch_src_global generation:  0.0015764236450195312
r_  generation:  0.02144646644592285
local_output_nid generation:  0.002994537353515625
local_in_edges_tensor generation:  0.0015583038330078125
mini_batch_src_global generation:  0.001621246337890625
r_  generation:  0.021108388900756836
local_output_nid generation:  0.002965211868286133
local_in_edges_tensor generation:  0.0015430450439453125
mini_batch_src_global generation:  0.0016939640045166016
r_  generation:  0.021901369094848633
local_output_nid generation:  0.0029914379119873047
local_in_edges_tensor generation:  0.0015914440155029297
mini_batch_src_global generation:  0.0016601085662841797
r_  generation:  0.021499156951904297
local_output_nid generation:  0.0030083656311035156
local_in_edges_tensor generation:  0.0015363693237304688
mini_batch_src_global generation:  0.0016622543334960938
r_  generation:  0.02199268341064453
local_output_nid generation:  0.003006458282470703
local_in_edges_tensor generation:  0.0015308856964111328
mini_batch_src_global generation:  0.0017271041870117188
r_  generation:  0.021865129470825195
local_output_nid generation:  0.0029616355895996094
local_in_edges_tensor generation:  0.001544952392578125
mini_batch_src_global generation:  0.001714468002319336
r_  generation:  0.021827220916748047
local_output_nid generation:  0.0030753612518310547
local_in_edges_tensor generation:  0.0016126632690429688
mini_batch_src_global generation:  0.0017535686492919922
r_  generation:  0.02203202247619629
local_output_nid generation:  0.002978801727294922
local_in_edges_tensor generation:  0.0015611648559570312
mini_batch_src_global generation:  0.001775979995727539
r_  generation:  0.022094011306762695
local_output_nid generation:  0.002986907958984375
local_in_edges_tensor generation:  0.0015366077423095703
mini_batch_src_global generation:  0.0017461776733398438
r_  generation:  0.02286243438720703
local_output_nid generation:  0.002975940704345703
local_in_edges_tensor generation:  0.0015652179718017578
mini_batch_src_global generation:  0.0017628669738769531
r_  generation:  0.022005558013916016
local_output_nid generation:  0.0030066967010498047
local_in_edges_tensor generation:  0.0015444755554199219
mini_batch_src_global generation:  0.0018019676208496094
r_  generation:  0.02205038070678711
----------------------check_connections_block total spend ----------------------------- 0.5645551681518555
generate_one_block  0.034676313400268555
generate_one_block  0.03231453895568848
generate_one_block  0.03195452690124512
generate_one_block  0.03394746780395508
generate_one_block  0.031430959701538086
generate_one_block  0.03360772132873535
generate_one_block  0.03158164024353027
generate_one_block  0.030412912368774414
generate_one_block  0.03150677680969238
generate_one_block  0.03113102912902832
generate_one_block  0.030963659286499023
generate_one_block  0.03139472007751465
generate_one_block  0.03157401084899902
generate_one_block  0.03253340721130371
generate_one_block  0.030887603759765625
generate_one_block  0.0316011905670166
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03892874717712402
gen group dst list time:  0.022281169891357422
time for parepare:  0.019387245178222656
local_output_nid generation:  0.009422063827514648
local_in_edges_tensor generation:  0.02771139144897461
mini_batch_src_global generation:  0.027400493621826172
r_  generation:  0.26452136039733887
local_output_nid generation:  0.013612747192382812
local_in_edges_tensor generation:  0.026433467864990234
mini_batch_src_global generation:  0.034507036209106445
r_  generation:  0.27762842178344727
local_output_nid generation:  0.014292716979980469
local_in_edges_tensor generation:  0.030483007431030273
mini_batch_src_global generation:  0.04356241226196289
r_  generation:  0.2807178497314453
local_output_nid generation:  0.015534400939941406
local_in_edges_tensor generation:  0.023627281188964844
mini_batch_src_global generation:  0.033596038818359375
r_  generation:  0.28698229789733887
local_output_nid generation:  0.014451742172241211
local_in_edges_tensor generation:  0.016247034072875977
mini_batch_src_global generation:  0.03369283676147461
r_  generation:  0.2830383777618408
local_output_nid generation:  0.013236761093139648
local_in_edges_tensor generation:  0.02040886878967285
mini_batch_src_global generation:  0.03364825248718262
r_  generation:  0.2736027240753174
local_output_nid generation:  0.013540506362915039
local_in_edges_tensor generation:  0.018590927124023438
mini_batch_src_global generation:  0.03406405448913574
r_  generation:  0.27783942222595215
local_output_nid generation:  0.01769399642944336
local_in_edges_tensor generation:  0.03612518310546875
mini_batch_src_global generation:  0.035249948501586914
r_  generation:  0.26339244842529297
local_output_nid generation:  0.013451337814331055
local_in_edges_tensor generation:  0.0200197696685791
mini_batch_src_global generation:  0.047281503677368164
r_  generation:  0.279005765914917
local_output_nid generation:  0.014474868774414062
local_in_edges_tensor generation:  0.021781444549560547
mini_batch_src_global generation:  0.03496408462524414
r_  generation:  0.2709360122680664
local_output_nid generation:  0.013264179229736328
local_in_edges_tensor generation:  0.0173187255859375
mini_batch_src_global generation:  0.03534507751464844
r_  generation:  0.284381628036499
local_output_nid generation:  0.013483047485351562
local_in_edges_tensor generation:  0.017531394958496094
mini_batch_src_global generation:  0.034696102142333984
r_  generation:  0.27716708183288574
local_output_nid generation:  0.013528823852539062
local_in_edges_tensor generation:  0.022203683853149414
mini_batch_src_global generation:  0.03440690040588379
r_  generation:  0.2821648120880127
local_output_nid generation:  0.013723134994506836
local_in_edges_tensor generation:  0.018184185028076172
mini_batch_src_global generation:  0.035848379135131836
r_  generation:  0.2853214740753174
local_output_nid generation:  0.013526439666748047
local_in_edges_tensor generation:  0.014754533767700195
mini_batch_src_global generation:  0.03479170799255371
r_  generation:  0.27556371688842773
local_output_nid generation:  0.013531923294067383
local_in_edges_tensor generation:  0.014909744262695312
mini_batch_src_global generation:  0.03405499458312988
r_  generation:  0.27196478843688965
----------------------check_connections_block total spend ----------------------------- 6.52719259262085
generate_one_block  0.36950111389160156
generate_one_block  0.3793172836303711
generate_one_block  0.3658931255340576
generate_one_block  0.35768747329711914
generate_one_block  0.35900020599365234
generate_one_block  0.35265326499938965
generate_one_block  0.38578200340270996
generate_one_block  0.34244537353515625
generate_one_block  0.3611471652984619
generate_one_block  0.3576211929321289
generate_one_block  0.3555736541748047
generate_one_block  0.364119291305542
generate_one_block  0.3588273525238037
generate_one_block  0.37744712829589844
generate_one_block  0.34418773651123047
generate_one_block  0.34548449516296387
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04520559310913086
gen group dst list time:  0.06310319900512695
time for parepare:  0.018000125885009766
local_output_nid generation:  0.027325868606567383
local_in_edges_tensor generation:  0.0618288516998291
mini_batch_src_global generation:  0.04602551460266113
r_  generation:  0.45564866065979004
local_output_nid generation:  0.0328824520111084
local_in_edges_tensor generation:  0.052216529846191406
mini_batch_src_global generation:  0.05321526527404785
r_  generation:  0.4590611457824707
local_output_nid generation:  0.032654523849487305
local_in_edges_tensor generation:  0.04082775115966797
mini_batch_src_global generation:  0.05133771896362305
r_  generation:  0.4656364917755127
local_output_nid generation:  0.03275632858276367
local_in_edges_tensor generation:  0.039160966873168945
mini_batch_src_global generation:  0.05194544792175293
r_  generation:  0.4684274196624756
local_output_nid generation:  0.032849788665771484
local_in_edges_tensor generation:  0.08703470230102539
mini_batch_src_global generation:  0.0523526668548584
r_  generation:  0.4772059917449951
local_output_nid generation:  0.03269243240356445
local_in_edges_tensor generation:  0.03894352912902832
mini_batch_src_global generation:  0.0533597469329834
r_  generation:  0.47884106636047363
local_output_nid generation:  0.033301591873168945
local_in_edges_tensor generation:  0.04066944122314453
mini_batch_src_global generation:  0.053763389587402344
r_  generation:  0.4785447120666504
local_output_nid generation:  0.03360605239868164
local_in_edges_tensor generation:  0.03889799118041992
mini_batch_src_global generation:  0.05338883399963379
r_  generation:  0.4822378158569336
local_output_nid generation:  0.032994985580444336
local_in_edges_tensor generation:  0.045236825942993164
mini_batch_src_global generation:  0.0585935115814209
r_  generation:  0.49207282066345215
local_output_nid generation:  0.035823822021484375
local_in_edges_tensor generation:  0.04589104652404785
mini_batch_src_global generation:  0.06124305725097656
r_  generation:  0.4755849838256836
local_output_nid generation:  0.034937381744384766
local_in_edges_tensor generation:  0.0415494441986084
mini_batch_src_global generation:  0.05298566818237305
r_  generation:  0.4819295406341553
local_output_nid generation:  0.03360271453857422
local_in_edges_tensor generation:  0.03519248962402344
mini_batch_src_global generation:  0.05397152900695801
r_  generation:  0.47780513763427734
local_output_nid generation:  0.033968448638916016
local_in_edges_tensor generation:  0.043941497802734375
mini_batch_src_global generation:  0.05301189422607422
r_  generation:  0.4769928455352783
local_output_nid generation:  0.03398752212524414
local_in_edges_tensor generation:  0.04342317581176758
mini_batch_src_global generation:  0.056611061096191406
r_  generation:  0.4815673828125
local_output_nid generation:  0.03403615951538086
local_in_edges_tensor generation:  0.03619098663330078
mini_batch_src_global generation:  0.05329728126525879
r_  generation:  0.4830749034881592
local_output_nid generation:  0.033933162689208984
local_in_edges_tensor generation:  0.03592705726623535
mini_batch_src_global generation:  0.05443263053894043
r_  generation:  0.4798281192779541
----------------------check_connections_block total spend ----------------------------- 11.428041696548462
generate_one_block  0.6316540241241455
generate_one_block  0.6093614101409912
generate_one_block  0.5977637767791748
generate_one_block  0.5998811721801758
generate_one_block  0.6040403842926025
generate_one_block  0.6006910800933838
generate_one_block  0.5864548683166504
generate_one_block  0.5909225940704346
generate_one_block  0.6280968189239502
generate_one_block  0.6029329299926758
generate_one_block  0.5980226993560791
generate_one_block  0.5940816402435303
generate_one_block  0.6034786701202393
generate_one_block  0.6068341732025146
generate_one_block  0.5865235328674316
generate_one_block  0.5936994552612305
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.1230616569519043  GigaBytes
Max Memory Allocated: 0.8645539283752441  GigaBytes

connection checking time:  17.95523428916931
block generation total time  15.411127090454102
average batch blocks generation time:  0.9631954431533813
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09761857986450195  GigaBytes
Max Memory Allocated: 0.8645539283752441  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7724080085754395  GigaBytes
Max Memory Allocated: 0.8645539283752441  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09762430191040039  GigaBytes
Max Memory Allocated: 0.8645539283752441  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7758021354675293  GigaBytes
Max Memory Allocated: 0.8645539283752441  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09758424758911133  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7689061164855957  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09750795364379883  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7709732055664062  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09772920608520508  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7716708183288574  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09752321243286133  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7693381309509277  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09746313095092773  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7662968635559082  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09711837768554688  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7602748870849609  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09754180908203125  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7709574699401855  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09733104705810547  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7662897109985352  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09736204147338867  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.765315055847168  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09749698638916016  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7656564712524414  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09755420684814453  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7723016738891602  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0976872444152832  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7754020690917969  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0973973274230957  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7641415596008301  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0974574089050293  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7664175033569336  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06483574211597443 |0.013296246528625488 |0.0035569965839385986 |9.344518184661865e-05 |0.0034535229206085205 |0.0032117366790771484 |
----------------------------------------------------------pseudo_mini_loss sum 3.24951434135437
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5323168
Number of first layer input nodes during this epoch:  2510640
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.1230473518371582  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.053160667419433594
random selection method range initialization spend 0.00568389892578125
time for parepare:  0.018981218338012695
local_output_nid generation:  0.0023691654205322266
local_in_edges_tensor generation:  0.005326986312866211
mini_batch_src_global generation:  0.0017955303192138672
r_  generation:  0.02209019660949707
local_output_nid generation:  0.0028638839721679688
local_in_edges_tensor generation:  0.0017595291137695312
mini_batch_src_global generation:  0.002446889877319336
r_  generation:  0.021927833557128906
local_output_nid generation:  0.0030727386474609375
local_in_edges_tensor generation:  0.0017254352569580078
mini_batch_src_global generation:  0.0016722679138183594
r_  generation:  0.02179431915283203
local_output_nid generation:  0.002993345260620117
local_in_edges_tensor generation:  0.0016393661499023438
mini_batch_src_global generation:  0.0016062259674072266
r_  generation:  0.020829439163208008
local_output_nid generation:  0.0030257701873779297
local_in_edges_tensor generation:  0.0016827583312988281
mini_batch_src_global generation:  0.0016906261444091797
r_  generation:  0.022238969802856445
local_output_nid generation:  0.0031020641326904297
local_in_edges_tensor generation:  0.0017223358154296875
mini_batch_src_global generation:  0.001687765121459961
r_  generation:  0.02145075798034668
local_output_nid generation:  0.003052234649658203
local_in_edges_tensor generation:  0.0016605854034423828
mini_batch_src_global generation:  0.0017821788787841797
r_  generation:  0.022578001022338867
local_output_nid generation:  0.0030374526977539062
local_in_edges_tensor generation:  0.001622915267944336
mini_batch_src_global generation:  0.0017328262329101562
r_  generation:  0.02244400978088379
local_output_nid generation:  0.003182649612426758
local_in_edges_tensor generation:  0.0015769004821777344
mini_batch_src_global generation:  0.0017647743225097656
r_  generation:  0.022661924362182617
local_output_nid generation:  0.0030965805053710938
local_in_edges_tensor generation:  0.0016303062438964844
mini_batch_src_global generation:  0.0017910003662109375
r_  generation:  0.02277517318725586
local_output_nid generation:  0.003052949905395508
local_in_edges_tensor generation:  0.001653432846069336
mini_batch_src_global generation:  0.0018222332000732422
r_  generation:  0.02422952651977539
local_output_nid generation:  0.004464387893676758
local_in_edges_tensor generation:  0.0016651153564453125
mini_batch_src_global generation:  0.0018010139465332031
r_  generation:  0.022364377975463867
local_output_nid generation:  0.00312042236328125
local_in_edges_tensor generation:  0.0015976428985595703
mini_batch_src_global generation:  0.0017099380493164062
r_  generation:  0.022079944610595703
local_output_nid generation:  0.0031328201293945312
local_in_edges_tensor generation:  0.0016181468963623047
mini_batch_src_global generation:  0.001722097396850586
r_  generation:  0.022505760192871094
local_output_nid generation:  0.003087759017944336
local_in_edges_tensor generation:  0.0018417835235595703
mini_batch_src_global generation:  0.0018444061279296875
r_  generation:  0.023655176162719727
local_output_nid generation:  0.003053426742553711
local_in_edges_tensor generation:  0.0016219615936279297
mini_batch_src_global generation:  0.0018048286437988281
r_  generation:  0.022600650787353516
----------------------check_connections_block total spend ----------------------------- 0.5769104957580566
generate_one_block  0.031774044036865234
generate_one_block  0.03191065788269043
generate_one_block  0.030909061431884766
generate_one_block  0.03125476837158203
generate_one_block  0.03475666046142578
generate_one_block  0.03403210639953613
generate_one_block  0.031587839126586914
generate_one_block  0.03516101837158203
generate_one_block  0.0317537784576416
generate_one_block  0.03236675262451172
generate_one_block  0.03125739097595215
generate_one_block  0.03113102912902832
generate_one_block  0.03040933609008789
generate_one_block  0.03070354461669922
generate_one_block  0.03208780288696289
generate_one_block  0.032265663146972656
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04204964637756348
gen group dst list time:  0.018643856048583984
time for parepare:  0.019538164138793945
local_output_nid generation:  0.009299755096435547
local_in_edges_tensor generation:  0.029890060424804688
mini_batch_src_global generation:  0.026638269424438477
r_  generation:  0.253861665725708
local_output_nid generation:  0.013355016708374023
local_in_edges_tensor generation:  0.017115354537963867
mini_batch_src_global generation:  0.03239750862121582
r_  generation:  0.26683545112609863
local_output_nid generation:  0.013198137283325195
local_in_edges_tensor generation:  0.01568770408630371
mini_batch_src_global generation:  0.031528472900390625
r_  generation:  0.2665870189666748
local_output_nid generation:  0.013988733291625977
local_in_edges_tensor generation:  0.01667022705078125
mini_batch_src_global generation:  0.032013654708862305
r_  generation:  0.2670609951019287
local_output_nid generation:  0.013938665390014648
local_in_edges_tensor generation:  0.0143585205078125
mini_batch_src_global generation:  0.03324747085571289
r_  generation:  0.2682511806488037
local_output_nid generation:  0.013693094253540039
local_in_edges_tensor generation:  0.016260623931884766
mini_batch_src_global generation:  0.0336003303527832
r_  generation:  0.27335047721862793
local_output_nid generation:  0.013944149017333984
local_in_edges_tensor generation:  0.015542268753051758
mini_batch_src_global generation:  0.033884525299072266
r_  generation:  0.27391672134399414
local_output_nid generation:  0.013704776763916016
local_in_edges_tensor generation:  0.015487909317016602
mini_batch_src_global generation:  0.03455066680908203
r_  generation:  0.27910518646240234
local_output_nid generation:  0.013887643814086914
local_in_edges_tensor generation:  0.01570916175842285
mini_batch_src_global generation:  0.03469038009643555
r_  generation:  0.2781331539154053
local_output_nid generation:  0.013286828994750977
local_in_edges_tensor generation:  0.015877962112426758
mini_batch_src_global generation:  0.03496384620666504
r_  generation:  0.2832527160644531
local_output_nid generation:  0.015612602233886719
local_in_edges_tensor generation:  0.018714189529418945
mini_batch_src_global generation:  0.03574728965759277
r_  generation:  0.2747201919555664
local_output_nid generation:  0.013198614120483398
local_in_edges_tensor generation:  0.017172574996948242
mini_batch_src_global generation:  0.034874677658081055
r_  generation:  0.2772095203399658
local_output_nid generation:  0.013182878494262695
local_in_edges_tensor generation:  0.015719890594482422
mini_batch_src_global generation:  0.03606247901916504
r_  generation:  0.2691996097564697
local_output_nid generation:  0.01320338249206543
local_in_edges_tensor generation:  0.014294624328613281
mini_batch_src_global generation:  0.03695178031921387
r_  generation:  0.27357935905456543
local_output_nid generation:  0.013593435287475586
local_in_edges_tensor generation:  0.015720367431640625
mini_batch_src_global generation:  0.03528714179992676
r_  generation:  0.28601813316345215
local_output_nid generation:  0.014341354370117188
local_in_edges_tensor generation:  0.020905494689941406
mini_batch_src_global generation:  0.036870479583740234
r_  generation:  0.29435086250305176
----------------------check_connections_block total spend ----------------------------- 6.356093168258667
generate_one_block  0.3625142574310303
generate_one_block  0.3545041084289551
generate_one_block  0.3558220863342285
generate_one_block  0.34694457054138184
generate_one_block  0.35103821754455566
generate_one_block  0.3511838912963867
generate_one_block  0.38445401191711426
generate_one_block  0.36273646354675293
generate_one_block  0.3814809322357178
generate_one_block  0.36389708518981934
generate_one_block  0.34910058975219727
generate_one_block  0.3561859130859375
generate_one_block  0.34879326820373535
generate_one_block  0.35155701637268066
generate_one_block  0.3652346134185791
generate_one_block  0.35593461990356445
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03565621376037598
gen group dst list time:  0.0671541690826416
time for parepare:  0.01783299446105957
local_output_nid generation:  0.028917551040649414
local_in_edges_tensor generation:  0.05670738220214844
mini_batch_src_global generation:  0.04507160186767578
r_  generation:  0.45453929901123047
local_output_nid generation:  0.03290200233459473
local_in_edges_tensor generation:  0.0431363582611084
mini_batch_src_global generation:  0.05404853820800781
r_  generation:  0.46289563179016113
local_output_nid generation:  0.03309154510498047
local_in_edges_tensor generation:  0.03669452667236328
mini_batch_src_global generation:  0.05280804634094238
r_  generation:  0.4706904888153076
local_output_nid generation:  0.032709360122680664
local_in_edges_tensor generation:  0.03307986259460449
mini_batch_src_global generation:  0.05185389518737793
r_  generation:  0.4747653007507324
local_output_nid generation:  0.03367877006530762
local_in_edges_tensor generation:  0.08521819114685059
mini_batch_src_global generation:  0.05278611183166504
r_  generation:  0.4757983684539795
local_output_nid generation:  0.03280520439147949
local_in_edges_tensor generation:  0.03786277770996094
mini_batch_src_global generation:  0.05564999580383301
r_  generation:  0.48479175567626953
local_output_nid generation:  0.0342409610748291
local_in_edges_tensor generation:  0.03374218940734863
mini_batch_src_global generation:  0.0570216178894043
r_  generation:  0.4946315288543701
local_output_nid generation:  0.03539538383483887
local_in_edges_tensor generation:  0.0367734432220459
mini_batch_src_global generation:  0.0548253059387207
r_  generation:  0.4818298816680908
local_output_nid generation:  0.03406858444213867
local_in_edges_tensor generation:  0.037537336349487305
mini_batch_src_global generation:  0.05394577980041504
r_  generation:  0.48473596572875977
local_output_nid generation:  0.03399515151977539
local_in_edges_tensor generation:  0.03603553771972656
mini_batch_src_global generation:  0.05451536178588867
r_  generation:  0.48275017738342285
local_output_nid generation:  0.03402280807495117
local_in_edges_tensor generation:  0.03415799140930176
mini_batch_src_global generation:  0.0543060302734375
r_  generation:  0.48600292205810547
local_output_nid generation:  0.034218788146972656
local_in_edges_tensor generation:  0.034551143646240234
mini_batch_src_global generation:  0.054380178451538086
r_  generation:  0.4818096160888672
local_output_nid generation:  0.03388166427612305
local_in_edges_tensor generation:  0.033655643463134766
mini_batch_src_global generation:  0.0526883602142334
r_  generation:  0.4889965057373047
local_output_nid generation:  0.03386235237121582
local_in_edges_tensor generation:  0.03480410575866699
mini_batch_src_global generation:  0.053518056869506836
r_  generation:  0.4808025360107422
local_output_nid generation:  0.034163475036621094
local_in_edges_tensor generation:  0.040004730224609375
mini_batch_src_global generation:  0.05363130569458008
r_  generation:  0.4799940586090088
local_output_nid generation:  0.0336306095123291
local_in_edges_tensor generation:  0.03734636306762695
mini_batch_src_global generation:  0.05501151084899902
r_  generation:  0.49104785919189453
----------------------check_connections_block total spend ----------------------------- 11.444434642791748
generate_one_block  0.6095378398895264
generate_one_block  0.6102268695831299
generate_one_block  0.6007537841796875
generate_one_block  0.5988881587982178
generate_one_block  0.5978982448577881
generate_one_block  0.5977632999420166
generate_one_block  0.601348876953125
generate_one_block  0.6031274795532227
generate_one_block  0.7018952369689941
generate_one_block  0.6040027141571045
generate_one_block  0.598186731338501
generate_one_block  0.6170222759246826
generate_one_block  0.5988879203796387
generate_one_block  0.6028625965118408
generate_one_block  0.6247577667236328
generate_one_block  0.6175525188446045
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.1230473518371582  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

connection checking time:  17.800527811050415
block generation total time  15.52609395980835
average batch blocks generation time:  0.9703808724880219
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09733057022094727  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7653779983520508  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09754705429077148  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.768458366394043  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09743595123291016  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.765925407409668  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09736824035644531  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7654109001159668  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0973200798034668  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7660202980041504  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0973520278930664  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7649035453796387  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09762334823608398  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7701492309570312  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09753799438476562  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7665472030639648  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09754753112792969  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7710318565368652  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09761238098144531  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7754487991333008  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09741353988647461  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7649221420288086  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09744453430175781  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7647504806518555  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09718799591064453  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7615742683410645  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0974435806274414  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7644271850585938  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09783935546875  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.776545524597168  GigaBytes
Max Memory Allocated: 0.8650126457214355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0975656509399414  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7678899765014648  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0631549209356308 |0.01733464002609253 |0.0035342127084732056 |9.326636791229248e-05 |0.003200158476829529 |0.0013821125030517578 |
----------------------------------------------------------pseudo_mini_loss sum 2.6048388481140137
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  5318198
Number of first layer input nodes during this epoch:  2509840
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.1235356330871582  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027391433715820312
random selection method range initialization spend 0.00579833984375
time for parepare:  0.018378019332885742
local_output_nid generation:  0.002288341522216797
local_in_edges_tensor generation:  0.0072901248931884766
mini_batch_src_global generation:  0.001760721206665039
r_  generation:  0.02128291130065918
local_output_nid generation:  0.002834320068359375
local_in_edges_tensor generation:  0.0016994476318359375
mini_batch_src_global generation:  0.002202272415161133
r_  generation:  0.0217893123626709
local_output_nid generation:  0.0029468536376953125
local_in_edges_tensor generation:  0.001800537109375
mini_batch_src_global generation:  0.0016870498657226562
r_  generation:  0.022318124771118164
local_output_nid generation:  0.0031137466430664062
local_in_edges_tensor generation:  0.0018239021301269531
mini_batch_src_global generation:  0.0017609596252441406
r_  generation:  0.021799087524414062
local_output_nid generation:  0.003213167190551758
local_in_edges_tensor generation:  0.0017917156219482422
mini_batch_src_global generation:  0.0017805099487304688
r_  generation:  0.021816730499267578
local_output_nid generation:  0.003223419189453125
local_in_edges_tensor generation:  0.0018012523651123047
mini_batch_src_global generation:  0.0017843246459960938
r_  generation:  0.0219879150390625
local_output_nid generation:  0.0030808448791503906
local_in_edges_tensor generation:  0.0015981197357177734
mini_batch_src_global generation:  0.0017042160034179688
r_  generation:  0.022170305252075195
local_output_nid generation:  0.0030677318572998047
local_in_edges_tensor generation:  0.0015993118286132812
mini_batch_src_global generation:  0.0016837120056152344
r_  generation:  0.022292137145996094
local_output_nid generation:  0.003030538558959961
local_in_edges_tensor generation:  0.0016016960144042969
mini_batch_src_global generation:  0.0018033981323242188
r_  generation:  0.022252559661865234
local_output_nid generation:  0.0030155181884765625
local_in_edges_tensor generation:  0.0016329288482666016
mini_batch_src_global generation:  0.0017423629760742188
r_  generation:  0.02244091033935547
local_output_nid generation:  0.002980470657348633
local_in_edges_tensor generation:  0.001528024673461914
mini_batch_src_global generation:  0.0018341541290283203
r_  generation:  0.022396087646484375
local_output_nid generation:  0.002960681915283203
local_in_edges_tensor generation:  0.0015833377838134766
mini_batch_src_global generation:  0.00176239013671875
r_  generation:  0.022197723388671875
local_output_nid generation:  0.0030832290649414062
local_in_edges_tensor generation:  0.001592397689819336
mini_batch_src_global generation:  0.0017125606536865234
r_  generation:  0.02218008041381836
local_output_nid generation:  0.0030014514923095703
local_in_edges_tensor generation:  0.0015468597412109375
mini_batch_src_global generation:  0.001741647720336914
r_  generation:  0.021929264068603516
local_output_nid generation:  0.003032207489013672
local_in_edges_tensor generation:  0.0015327930450439453
mini_batch_src_global generation:  0.0018281936645507812
r_  generation:  0.023767709732055664
local_output_nid generation:  0.003017902374267578
local_in_edges_tensor generation:  0.0015621185302734375
mini_batch_src_global generation:  0.001848459243774414
r_  generation:  0.02272963523864746
----------------------check_connections_block total spend ----------------------------- 0.5771968364715576
generate_one_block  0.034738779067993164
generate_one_block  0.032358407974243164
generate_one_block  0.03177380561828613
generate_one_block  0.030881881713867188
generate_one_block  0.031050682067871094
generate_one_block  0.03425002098083496
generate_one_block  0.03147244453430176
generate_one_block  0.031036853790283203
generate_one_block  0.0315706729888916
generate_one_block  0.0316619873046875
generate_one_block  0.03196239471435547
generate_one_block  0.030635356903076172
generate_one_block  0.030587434768676758
generate_one_block  0.03334450721740723
generate_one_block  0.032042741775512695
generate_one_block  0.03287506103515625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04720664024353027
gen group dst list time:  0.01969170570373535
time for parepare:  0.019501209259033203
local_output_nid generation:  0.009392499923706055
local_in_edges_tensor generation:  0.025500774383544922
mini_batch_src_global generation:  0.028008460998535156
r_  generation:  0.2584652900695801
local_output_nid generation:  0.013606786727905273
local_in_edges_tensor generation:  0.01867532730102539
mini_batch_src_global generation:  0.03253173828125
r_  generation:  0.27192211151123047
local_output_nid generation:  0.01654338836669922
local_in_edges_tensor generation:  0.021871089935302734
mini_batch_src_global generation:  0.03535056114196777
r_  generation:  0.2740921974182129
local_output_nid generation:  0.014072895050048828
local_in_edges_tensor generation:  0.016712188720703125
mini_batch_src_global generation:  0.03826403617858887
r_  generation:  0.2790045738220215
local_output_nid generation:  0.016330480575561523
local_in_edges_tensor generation:  0.015392780303955078
mini_batch_src_global generation:  0.03290605545043945
r_  generation:  0.27043843269348145
local_output_nid generation:  0.01422429084777832
local_in_edges_tensor generation:  0.015117168426513672
mini_batch_src_global generation:  0.03365921974182129
r_  generation:  0.2929656505584717
local_output_nid generation:  0.014415502548217773
local_in_edges_tensor generation:  0.015349149703979492
mini_batch_src_global generation:  0.033991336822509766
r_  generation:  0.2727046012878418
local_output_nid generation:  0.01428079605102539
local_in_edges_tensor generation:  0.01854109764099121
mini_batch_src_global generation:  0.03377485275268555
r_  generation:  0.2748990058898926
local_output_nid generation:  0.014344930648803711
local_in_edges_tensor generation:  0.015612363815307617
mini_batch_src_global generation:  0.034559011459350586
r_  generation:  0.2828683853149414
local_output_nid generation:  0.01439809799194336
local_in_edges_tensor generation:  0.016644001007080078
mini_batch_src_global generation:  0.036739349365234375
r_  generation:  0.27786993980407715
local_output_nid generation:  0.014657258987426758
local_in_edges_tensor generation:  0.01565694808959961
mini_batch_src_global generation:  0.03562498092651367
r_  generation:  0.28377389907836914
local_output_nid generation:  0.013600826263427734
local_in_edges_tensor generation:  0.02064967155456543
mini_batch_src_global generation:  0.03408217430114746
r_  generation:  0.2744593620300293
local_output_nid generation:  0.013338565826416016
local_in_edges_tensor generation:  0.017461061477661133
mini_batch_src_global generation:  0.03377366065979004
r_  generation:  0.2849397659301758
local_output_nid generation:  0.015431404113769531
local_in_edges_tensor generation:  0.015448808670043945
mini_batch_src_global generation:  0.03428053855895996
r_  generation:  0.27143120765686035
local_output_nid generation:  0.013370037078857422
local_in_edges_tensor generation:  0.015489339828491211
mini_batch_src_global generation:  0.033698320388793945
r_  generation:  0.27039527893066406
local_output_nid generation:  0.013868331909179688
local_in_edges_tensor generation:  0.016342639923095703
mini_batch_src_global generation:  0.03781437873840332
r_  generation:  0.28136682510375977
----------------------check_connections_block total spend ----------------------------- 6.439584016799927
generate_one_block  0.36179351806640625
generate_one_block  0.368802547454834
generate_one_block  0.36369919776916504
generate_one_block  0.35262608528137207
generate_one_block  0.35283374786376953
generate_one_block  0.35711097717285156
generate_one_block  0.3841133117675781
generate_one_block  0.3564729690551758
generate_one_block  0.3578207492828369
generate_one_block  0.35581469535827637
generate_one_block  0.3679482936859131
generate_one_block  0.3479781150817871
generate_one_block  0.350480318069458
generate_one_block  0.3448057174682617
generate_one_block  0.35286545753479004
generate_one_block  0.3616325855255127
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.039270639419555664
gen group dst list time:  0.0671381950378418
time for parepare:  0.02100396156311035
local_output_nid generation:  0.02811431884765625
local_in_edges_tensor generation:  0.0465846061706543
mini_batch_src_global generation:  0.04433107376098633
r_  generation:  0.467165470123291
local_output_nid generation:  0.03688764572143555
local_in_edges_tensor generation:  0.040152788162231445
mini_batch_src_global generation:  0.05333852767944336
r_  generation:  0.4623856544494629
local_output_nid generation:  0.034041643142700195
local_in_edges_tensor generation:  0.0331113338470459
mini_batch_src_global generation:  0.053078413009643555
r_  generation:  0.4882993698120117
local_output_nid generation:  0.03439974784851074
local_in_edges_tensor generation:  0.031282663345336914
mini_batch_src_global generation:  0.05213570594787598
r_  generation:  0.47057175636291504
local_output_nid generation:  0.03386735916137695
local_in_edges_tensor generation:  0.08258652687072754
mini_batch_src_global generation:  0.05341458320617676
r_  generation:  0.4834277629852295
local_output_nid generation:  0.03317451477050781
local_in_edges_tensor generation:  0.03570556640625
mini_batch_src_global generation:  0.052870988845825195
r_  generation:  0.48130011558532715
local_output_nid generation:  0.03299212455749512
local_in_edges_tensor generation:  0.032784223556518555
mini_batch_src_global generation:  0.05303382873535156
r_  generation:  0.4753141403198242
local_output_nid generation:  0.03343033790588379
local_in_edges_tensor generation:  0.03034210205078125
mini_batch_src_global generation:  0.053772926330566406
r_  generation:  0.47998738288879395
local_output_nid generation:  0.03335833549499512
local_in_edges_tensor generation:  0.03291797637939453
mini_batch_src_global generation:  0.054230451583862305
r_  generation:  0.480318546295166
local_output_nid generation:  0.033144235610961914
local_in_edges_tensor generation:  0.0334930419921875
mini_batch_src_global generation:  0.05552506446838379
r_  generation:  0.48366522789001465
local_output_nid generation:  0.03337740898132324
local_in_edges_tensor generation:  0.03319811820983887
mini_batch_src_global generation:  0.057645320892333984
r_  generation:  0.48427796363830566
local_output_nid generation:  0.03426814079284668
local_in_edges_tensor generation:  0.03095698356628418
mini_batch_src_global generation:  0.05401611328125
r_  generation:  0.4851109981536865
local_output_nid generation:  0.03313136100769043
local_in_edges_tensor generation:  0.03330874443054199
mini_batch_src_global generation:  0.05337929725646973
r_  generation:  0.48502135276794434
local_output_nid generation:  0.033348798751831055
local_in_edges_tensor generation:  0.03251910209655762
mini_batch_src_global generation:  0.05557560920715332
r_  generation:  0.48711538314819336
local_output_nid generation:  0.03376936912536621
local_in_edges_tensor generation:  0.039186716079711914
mini_batch_src_global generation:  0.05287909507751465
r_  generation:  0.4797213077545166
local_output_nid generation:  0.03356432914733887
local_in_edges_tensor generation:  0.03615522384643555
mini_batch_src_global generation:  0.05417895317077637
r_  generation:  0.4843103885650635
----------------------check_connections_block total spend ----------------------------- 11.385886907577515
generate_one_block  0.6225519180297852
generate_one_block  0.6105682849884033
generate_one_block  0.6004071235656738
generate_one_block  0.5946083068847656
generate_one_block  0.5899369716644287
generate_one_block  0.597365140914917
generate_one_block  0.5975241661071777
generate_one_block  0.5967350006103516
generate_one_block  0.6329607963562012
generate_one_block  0.6137158870697021
generate_one_block  0.599750280380249
generate_one_block  0.591632604598999
generate_one_block  0.5958607196807861
generate_one_block  0.5959687232971191
generate_one_block  0.6077404022216797
generate_one_block  0.6063284873962402
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.1235356330871582  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

connection checking time:  17.82547092437744
block generation total time  15.390453100204468
average batch blocks generation time:  0.9619033187627792
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0974435806274414  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.765648365020752  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09742498397827148  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7679142951965332  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09761524200439453  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7755999565124512  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09738492965698242  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7660841941833496  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09747600555419922  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7647261619567871  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09756135940551758  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7679295539855957  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09748554229736328  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7654280662536621  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09754610061645508  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7691497802734375  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09749221801757812  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7675395011901855  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09742116928100586  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7677922248840332  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09767627716064453  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7749276161193848  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09728384017944336  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7658686637878418  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09723520278930664  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7629384994506836  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09743690490722656  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7691826820373535  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09744644165039062  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7694315910339355  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09750890731811523  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7720603942871094  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0633312463760376 |0.013812333345413208 |0.0035070329904556274 |9.162724018096924e-05 |0.00330391526222229 |0.002949953079223633 |
----------------------------------------------------------pseudo_mini_loss sum 2.3547587394714355
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  5319934
Number of first layer input nodes during this epoch:  2509709
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12351322174072266  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022215843200683594
random selection method range initialization spend 0.00545191764831543
time for parepare:  0.01949024200439453
local_output_nid generation:  0.002345561981201172
local_in_edges_tensor generation:  0.007204532623291016
mini_batch_src_global generation:  0.0018379688262939453
r_  generation:  0.02158665657043457
local_output_nid generation:  0.0029227733612060547
local_in_edges_tensor generation:  0.0018241405487060547
mini_batch_src_global generation:  0.0020742416381835938
r_  generation:  0.022453784942626953
local_output_nid generation:  0.00299835205078125
local_in_edges_tensor generation:  0.0017786026000976562
mini_batch_src_global generation:  0.0017201900482177734
r_  generation:  0.021588563919067383
local_output_nid generation:  0.00305938720703125
local_in_edges_tensor generation:  0.0017781257629394531
mini_batch_src_global generation:  0.0017299652099609375
r_  generation:  0.021685361862182617
local_output_nid generation:  0.003078460693359375
local_in_edges_tensor generation:  0.0018029212951660156
mini_batch_src_global generation:  0.0017583370208740234
r_  generation:  0.02137303352355957
local_output_nid generation:  0.0030503273010253906
local_in_edges_tensor generation:  0.0017800331115722656
mini_batch_src_global generation:  0.001705169677734375
r_  generation:  0.02164769172668457
local_output_nid generation:  0.0030488967895507812
local_in_edges_tensor generation:  0.0017693042755126953
mini_batch_src_global generation:  0.0017757415771484375
r_  generation:  0.02254319190979004
local_output_nid generation:  0.0031423568725585938
local_in_edges_tensor generation:  0.0017209053039550781
mini_batch_src_global generation:  0.001791238784790039
r_  generation:  0.022495269775390625
local_output_nid generation:  0.0031435489654541016
local_in_edges_tensor generation:  0.001756906509399414
mini_batch_src_global generation:  0.0018131732940673828
r_  generation:  0.0232083797454834
local_output_nid generation:  0.0032303333282470703
local_in_edges_tensor generation:  0.0019333362579345703
mini_batch_src_global generation:  0.0018401145935058594
r_  generation:  0.022338151931762695
local_output_nid generation:  0.003177642822265625
local_in_edges_tensor generation:  0.0017752647399902344
mini_batch_src_global generation:  0.0018134117126464844
r_  generation:  0.0227663516998291
local_output_nid generation:  0.0031533241271972656
local_in_edges_tensor generation:  0.0017364025115966797
mini_batch_src_global generation:  0.0018122196197509766
r_  generation:  0.022128820419311523
local_output_nid generation:  0.0031032562255859375
local_in_edges_tensor generation:  0.0017631053924560547
mini_batch_src_global generation:  0.0017383098602294922
r_  generation:  0.0221099853515625
local_output_nid generation:  0.0030879974365234375
local_in_edges_tensor generation:  0.0017483234405517578
mini_batch_src_global generation:  0.0017542839050292969
r_  generation:  0.022223472595214844
local_output_nid generation:  0.0030813217163085938
local_in_edges_tensor generation:  0.0016765594482421875
mini_batch_src_global generation:  0.0017495155334472656
r_  generation:  0.022186279296875
local_output_nid generation:  0.0030858516693115234
local_in_edges_tensor generation:  0.0017218589782714844
mini_batch_src_global generation:  0.0018041133880615234
r_  generation:  0.022922754287719727
----------------------check_connections_block total spend ----------------------------- 0.5778036117553711
generate_one_block  0.03191566467285156
generate_one_block  0.031607866287231445
generate_one_block  0.031002283096313477
generate_one_block  0.03177952766418457
generate_one_block  0.030935049057006836
generate_one_block  0.0333867073059082
generate_one_block  0.03204822540283203
generate_one_block  0.03180384635925293
generate_one_block  0.031812191009521484
generate_one_block  0.03149724006652832
generate_one_block  0.03138470649719238
generate_one_block  0.03148698806762695
generate_one_block  0.03109598159790039
generate_one_block  0.031299591064453125
generate_one_block  0.031008243560791016
generate_one_block  0.03203725814819336
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03779888153076172
gen group dst list time:  0.018666505813598633
time for parepare:  0.02028656005859375
local_output_nid generation:  0.009511709213256836
local_in_edges_tensor generation:  0.033867597579956055
mini_batch_src_global generation:  0.026513338088989258
r_  generation:  0.25396299362182617
local_output_nid generation:  0.014318704605102539
local_in_edges_tensor generation:  0.01897454261779785
mini_batch_src_global generation:  0.03666067123413086
r_  generation:  0.2651174068450928
local_output_nid generation:  0.01607489585876465
local_in_edges_tensor generation:  0.018988847732543945
mini_batch_src_global generation:  0.03113579750061035
r_  generation:  0.2651972770690918
local_output_nid generation:  0.014101743698120117
local_in_edges_tensor generation:  0.016344785690307617
mini_batch_src_global generation:  0.03388667106628418
r_  generation:  0.27118849754333496
local_output_nid generation:  0.014309406280517578
local_in_edges_tensor generation:  0.0179290771484375
mini_batch_src_global generation:  0.03307223320007324
r_  generation:  0.26705193519592285
local_output_nid generation:  0.014311075210571289
local_in_edges_tensor generation:  0.013951778411865234
mini_batch_src_global generation:  0.03358888626098633
r_  generation:  0.27128028869628906
local_output_nid generation:  0.014603614807128906
local_in_edges_tensor generation:  0.015681982040405273
mini_batch_src_global generation:  0.03647184371948242
r_  generation:  0.27829694747924805
local_output_nid generation:  0.01516413688659668
local_in_edges_tensor generation:  0.014376640319824219
mini_batch_src_global generation:  0.03425741195678711
r_  generation:  0.2741866111755371
local_output_nid generation:  0.013990402221679688
local_in_edges_tensor generation:  0.014557361602783203
mini_batch_src_global generation:  0.034810781478881836
r_  generation:  0.27698707580566406
local_output_nid generation:  0.01408243179321289
local_in_edges_tensor generation:  0.01723647117614746
mini_batch_src_global generation:  0.03476738929748535
r_  generation:  0.2804737091064453
local_output_nid generation:  0.014229297637939453
local_in_edges_tensor generation:  0.014216423034667969
mini_batch_src_global generation:  0.03441309928894043
r_  generation:  0.2747831344604492
local_output_nid generation:  0.01318812370300293
local_in_edges_tensor generation:  0.017627239227294922
mini_batch_src_global generation:  0.034368038177490234
r_  generation:  0.27732419967651367
local_output_nid generation:  0.013097286224365234
local_in_edges_tensor generation:  0.013852834701538086
mini_batch_src_global generation:  0.034294843673706055
r_  generation:  0.2713170051574707
local_output_nid generation:  0.013170719146728516
local_in_edges_tensor generation:  0.01387333869934082
mini_batch_src_global generation:  0.03436636924743652
r_  generation:  0.27532482147216797
local_output_nid generation:  0.013300895690917969
local_in_edges_tensor generation:  0.015388727188110352
mini_batch_src_global generation:  0.03436684608459473
r_  generation:  0.27327632904052734
local_output_nid generation:  0.013215303421020508
local_in_edges_tensor generation:  0.015069723129272461
mini_batch_src_global generation:  0.035996437072753906
r_  generation:  0.27784276008605957
----------------------check_connections_block total spend ----------------------------- 6.334625482559204
generate_one_block  0.3569214344024658
generate_one_block  0.35076403617858887
generate_one_block  0.35057640075683594
generate_one_block  0.35107898712158203
generate_one_block  0.34220004081726074
generate_one_block  0.34565019607543945
generate_one_block  0.39055871963500977
generate_one_block  0.34897327423095703
generate_one_block  0.3563058376312256
generate_one_block  0.35625147819519043
generate_one_block  0.3468971252441406
generate_one_block  0.3546457290649414
generate_one_block  0.3470337390899658
generate_one_block  0.350269079208374
generate_one_block  0.34902429580688477
generate_one_block  0.3602464199066162
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.032956838607788086
gen group dst list time:  0.06983065605163574
time for parepare:  0.018164873123168945
local_output_nid generation:  0.0275113582611084
local_in_edges_tensor generation:  0.047597408294677734
mini_batch_src_global generation:  0.043797969818115234
r_  generation:  0.4582390785217285
local_output_nid generation:  0.03328132629394531
local_in_edges_tensor generation:  0.040232181549072266
mini_batch_src_global generation:  0.05565667152404785
r_  generation:  0.4643220901489258
local_output_nid generation:  0.033263444900512695
local_in_edges_tensor generation:  0.03322911262512207
mini_batch_src_global generation:  0.05343341827392578
r_  generation:  0.46926259994506836
local_output_nid generation:  0.03314805030822754
local_in_edges_tensor generation:  0.03032827377319336
mini_batch_src_global generation:  0.0523838996887207
r_  generation:  0.47277188301086426
local_output_nid generation:  0.03309011459350586
local_in_edges_tensor generation:  0.0743260383605957
mini_batch_src_global generation:  0.052822113037109375
r_  generation:  0.4769899845123291
local_output_nid generation:  0.03305816650390625
local_in_edges_tensor generation:  0.03190112113952637
mini_batch_src_global generation:  0.05311155319213867
r_  generation:  0.4769458770751953
local_output_nid generation:  0.033197879791259766
local_in_edges_tensor generation:  0.033608436584472656
mini_batch_src_global generation:  0.056235313415527344
r_  generation:  0.48016905784606934
local_output_nid generation:  0.03323078155517578
local_in_edges_tensor generation:  0.03531360626220703
mini_batch_src_global generation:  0.05472135543823242
r_  generation:  0.47977757453918457
local_output_nid generation:  0.03311800956726074
local_in_edges_tensor generation:  0.030202627182006836
mini_batch_src_global generation:  0.05366206169128418
r_  generation:  0.47925615310668945
local_output_nid generation:  0.03355598449707031
local_in_edges_tensor generation:  0.03179597854614258
mini_batch_src_global generation:  0.054338932037353516
r_  generation:  0.48115110397338867
local_output_nid generation:  0.033310651779174805
local_in_edges_tensor generation:  0.03546953201293945
mini_batch_src_global generation:  0.05582928657531738
r_  generation:  0.48084259033203125
local_output_nid generation:  0.03319549560546875
local_in_edges_tensor generation:  0.030030012130737305
mini_batch_src_global generation:  0.05415773391723633
r_  generation:  0.4810638427734375
local_output_nid generation:  0.033202171325683594
local_in_edges_tensor generation:  0.030986309051513672
mini_batch_src_global generation:  0.05435681343078613
r_  generation:  0.47890567779541016
local_output_nid generation:  0.03312277793884277
local_in_edges_tensor generation:  0.0370485782623291
mini_batch_src_global generation:  0.053732872009277344
r_  generation:  0.4832956790924072
local_output_nid generation:  0.03324532508850098
local_in_edges_tensor generation:  0.030734539031982422
mini_batch_src_global generation:  0.05320572853088379
r_  generation:  0.4801621437072754
local_output_nid generation:  0.03336763381958008
local_in_edges_tensor generation:  0.03204989433288574
mini_batch_src_global generation:  0.05636239051818848
r_  generation:  0.48470067977905273
----------------------check_connections_block total spend ----------------------------- 11.29898190498352
generate_one_block  0.5994992256164551
generate_one_block  0.6004714965820312
generate_one_block  0.5981307029724121
generate_one_block  0.6097383499145508
generate_one_block  0.605560302734375
generate_one_block  0.5946078300476074
generate_one_block  0.5939419269561768
generate_one_block  0.5939147472381592
generate_one_block  0.6524097919464111
generate_one_block  0.6012728214263916
generate_one_block  0.5979635715484619
generate_one_block  0.5942730903625488
generate_one_block  0.6024570465087891
generate_one_block  0.6128640174865723
generate_one_block  0.6145889759063721
generate_one_block  0.6156806945800781
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12351322174072266  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

connection checking time:  17.633607387542725
block generation total time  15.344771385192871
average batch blocks generation time:  0.9590482115745544
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09743213653564453  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7671380043029785  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09738492965698242  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7696547508239746  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09745645523071289  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7692251205444336  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09750032424926758  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.772214412689209  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09748458862304688  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7692852020263672  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09716939926147461  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7625036239624023  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09756278991699219  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7747349739074707  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09742116928100586  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7663984298706055  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09736204147338867  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7663183212280273  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09741687774658203  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7663369178771973  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09762716293334961  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7712869644165039  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09730291366577148  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7628269195556641  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09728479385375977  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.764101505279541  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09757137298583984  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7702975273132324  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09748029708862305  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7673439979553223  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09764671325683594  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7749238014221191  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06325523555278778 |0.012347951531410217 |0.0035699158906936646 |9.247660636901855e-05 |0.003304809331893921 |0.0019121170043945312 |
----------------------------------------------------------pseudo_mini_loss sum 2.103856325149536
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  5318932
Number of first layer input nodes during this epoch:  2509093
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12356424331665039  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026389122009277344
random selection method range initialization spend 0.0053441524505615234
time for parepare:  0.017427444458007812
local_output_nid generation:  0.002310514450073242
local_in_edges_tensor generation:  0.00414276123046875
mini_batch_src_global generation:  0.0017466545104980469
r_  generation:  0.021213531494140625
local_output_nid generation:  0.0029163360595703125
local_in_edges_tensor generation:  0.001940011978149414
mini_batch_src_global generation:  0.002085447311401367
r_  generation:  0.021922588348388672
local_output_nid generation:  0.003002643585205078
local_in_edges_tensor generation:  0.0017468929290771484
mini_batch_src_global generation:  0.0017824172973632812
r_  generation:  0.0216827392578125
local_output_nid generation:  0.003021240234375
local_in_edges_tensor generation:  0.0021026134490966797
mini_batch_src_global generation:  0.0018765926361083984
r_  generation:  0.02249002456665039
local_output_nid generation:  0.003081798553466797
local_in_edges_tensor generation:  0.0017535686492919922
mini_batch_src_global generation:  0.001852273941040039
r_  generation:  0.022423982620239258
local_output_nid generation:  0.0030336380004882812
local_in_edges_tensor generation:  0.001789093017578125
mini_batch_src_global generation:  0.0018322467803955078
r_  generation:  0.022043943405151367
local_output_nid generation:  0.0030832290649414062
local_in_edges_tensor generation:  0.0018932819366455078
mini_batch_src_global generation:  0.0018091201782226562
r_  generation:  0.02232956886291504
local_output_nid generation:  0.003015756607055664
local_in_edges_tensor generation:  0.0017673969268798828
mini_batch_src_global generation:  0.0018892288208007812
r_  generation:  0.02286243438720703
local_output_nid generation:  0.0030612945556640625
local_in_edges_tensor generation:  0.0016984939575195312
mini_batch_src_global generation:  0.0018508434295654297
r_  generation:  0.022952556610107422
local_output_nid generation:  0.0031495094299316406
local_in_edges_tensor generation:  0.0017588138580322266
mini_batch_src_global generation:  0.001741647720336914
r_  generation:  0.022441625595092773
local_output_nid generation:  0.003094196319580078
local_in_edges_tensor generation:  0.0017495155334472656
mini_batch_src_global generation:  0.0018126964569091797
r_  generation:  0.022793054580688477
local_output_nid generation:  0.0030536651611328125
local_in_edges_tensor generation:  0.0016896724700927734
mini_batch_src_global generation:  0.0028841495513916016
r_  generation:  0.022714614868164062
local_output_nid generation:  0.003084897994995117
local_in_edges_tensor generation:  0.001764535903930664
mini_batch_src_global generation:  0.001789093017578125
r_  generation:  0.023105859756469727
local_output_nid generation:  0.0030565261840820312
local_in_edges_tensor generation:  0.0016889572143554688
mini_batch_src_global generation:  0.0017719268798828125
r_  generation:  0.022362947463989258
local_output_nid generation:  0.0030367374420166016
local_in_edges_tensor generation:  0.0016789436340332031
mini_batch_src_global generation:  0.0017817020416259766
r_  generation:  0.02237105369567871
local_output_nid generation:  0.0029993057250976562
local_in_edges_tensor generation:  0.0017788410186767578
mini_batch_src_global generation:  0.0017712116241455078
r_  generation:  0.021811723709106445
----------------------check_connections_block total spend ----------------------------- 0.5819458961486816
generate_one_block  0.030593156814575195
generate_one_block  0.031176328659057617
generate_one_block  0.03061079978942871
generate_one_block  0.03243398666381836
generate_one_block  0.03214120864868164
generate_one_block  0.034243106842041016
generate_one_block  0.03109884262084961
generate_one_block  0.03321123123168945
generate_one_block  0.031832218170166016
generate_one_block  0.03136444091796875
generate_one_block  0.031038761138916016
generate_one_block  0.03264188766479492
generate_one_block  0.03246450424194336
generate_one_block  0.031378984451293945
generate_one_block  0.03249859809875488
generate_one_block  0.03145003318786621
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0444798469543457
gen group dst list time:  0.020728349685668945
time for parepare:  0.020353317260742188
local_output_nid generation:  0.009393453598022461
local_in_edges_tensor generation:  0.031016826629638672
mini_batch_src_global generation:  0.02542257308959961
r_  generation:  0.2451164722442627
local_output_nid generation:  0.012936115264892578
local_in_edges_tensor generation:  0.01894998550415039
mini_batch_src_global generation:  0.03420829772949219
r_  generation:  0.25652384757995605
local_output_nid generation:  0.012959957122802734
local_in_edges_tensor generation:  0.015447616577148438
mini_batch_src_global generation:  0.030538558959960938
r_  generation:  0.2590627670288086
local_output_nid generation:  0.013851404190063477
local_in_edges_tensor generation:  0.018294334411621094
mini_batch_src_global generation:  0.03395700454711914
r_  generation:  0.27591896057128906
local_output_nid generation:  0.014055013656616211
local_in_edges_tensor generation:  0.01824784278869629
mini_batch_src_global generation:  0.033997535705566406
r_  generation:  0.2746458053588867
local_output_nid generation:  0.01383662223815918
local_in_edges_tensor generation:  0.015383005142211914
mini_batch_src_global generation:  0.03515958786010742
r_  generation:  0.27330636978149414
local_output_nid generation:  0.013704299926757812
local_in_edges_tensor generation:  0.014403104782104492
mini_batch_src_global generation:  0.033522844314575195
r_  generation:  0.26672792434692383
local_output_nid generation:  0.014077186584472656
local_in_edges_tensor generation:  0.014804601669311523
mini_batch_src_global generation:  0.034841299057006836
r_  generation:  0.28464484214782715
local_output_nid generation:  0.013959169387817383
local_in_edges_tensor generation:  0.014191150665283203
mini_batch_src_global generation:  0.034619808197021484
r_  generation:  0.2750382423400879
local_output_nid generation:  0.014116287231445312
local_in_edges_tensor generation:  0.015384197235107422
mini_batch_src_global generation:  0.0359044075012207
r_  generation:  0.27881956100463867
local_output_nid generation:  0.013695478439331055
local_in_edges_tensor generation:  0.014311790466308594
mini_batch_src_global generation:  0.03395342826843262
r_  generation:  0.27021169662475586
local_output_nid generation:  0.013245105743408203
local_in_edges_tensor generation:  0.01424098014831543
mini_batch_src_global generation:  0.034941911697387695
r_  generation:  0.28060436248779297
local_output_nid generation:  0.013154029846191406
local_in_edges_tensor generation:  0.018163681030273438
mini_batch_src_global generation:  0.03506731986999512
r_  generation:  0.28322720527648926
local_output_nid generation:  0.012913227081298828
local_in_edges_tensor generation:  0.014566898345947266
mini_batch_src_global generation:  0.035082101821899414
r_  generation:  0.2801501750946045
local_output_nid generation:  0.013210535049438477
local_in_edges_tensor generation:  0.014526128768920898
mini_batch_src_global generation:  0.034337520599365234
r_  generation:  0.2736184597015381
local_output_nid generation:  0.012897253036499023
local_in_edges_tensor generation:  0.014519214630126953
mini_batch_src_global generation:  0.033907175064086914
r_  generation:  0.27461862564086914
----------------------check_connections_block total spend ----------------------------- 6.309196710586548
generate_one_block  0.3498389720916748
generate_one_block  0.341402530670166
generate_one_block  0.3468179702758789
generate_one_block  0.36257338523864746
generate_one_block  0.35880255699157715
generate_one_block  0.3506505489349365
generate_one_block  0.3656284809112549
generate_one_block  0.36560606956481934
generate_one_block  0.35164737701416016
generate_one_block  0.35408496856689453
generate_one_block  0.3439805507659912
generate_one_block  0.3563883304595947
generate_one_block  0.3673861026763916
generate_one_block  0.3544294834136963
generate_one_block  0.344860315322876
generate_one_block  0.3445277214050293
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03655672073364258
gen group dst list time:  0.06328988075256348
time for parepare:  0.017957448959350586
local_output_nid generation:  0.027365684509277344
local_in_edges_tensor generation:  0.0363466739654541
mini_batch_src_global generation:  0.042737722396850586
r_  generation:  0.4523658752441406
local_output_nid generation:  0.032492637634277344
local_in_edges_tensor generation:  0.036895036697387695
mini_batch_src_global generation:  0.0530238151550293
r_  generation:  0.46151089668273926
local_output_nid generation:  0.0327150821685791
local_in_edges_tensor generation:  0.035683631896972656
mini_batch_src_global generation:  0.05164980888366699
r_  generation:  0.4665098190307617
local_output_nid generation:  0.03259468078613281
local_in_edges_tensor generation:  0.03976154327392578
mini_batch_src_global generation:  0.051207780838012695
r_  generation:  0.4697692394256592
local_output_nid generation:  0.0330049991607666
local_in_edges_tensor generation:  0.07726025581359863
mini_batch_src_global generation:  0.05240297317504883
r_  generation:  0.4759547710418701
local_output_nid generation:  0.032526493072509766
local_in_edges_tensor generation:  0.030699968338012695
mini_batch_src_global generation:  0.05270195007324219
r_  generation:  0.48035669326782227
local_output_nid generation:  0.03286147117614746
local_in_edges_tensor generation:  0.030354976654052734
mini_batch_src_global generation:  0.053046226501464844
r_  generation:  0.4806029796600342
local_output_nid generation:  0.03260517120361328
local_in_edges_tensor generation:  0.030538320541381836
mini_batch_src_global generation:  0.05379438400268555
r_  generation:  0.48747682571411133
local_output_nid generation:  0.03283429145812988
local_in_edges_tensor generation:  0.02996969223022461
mini_batch_src_global generation:  0.055112361907958984
r_  generation:  0.47779107093811035
local_output_nid generation:  0.03267836570739746
local_in_edges_tensor generation:  0.03168916702270508
mini_batch_src_global generation:  0.056028127670288086
r_  generation:  0.4882619380950928
local_output_nid generation:  0.03282642364501953
local_in_edges_tensor generation:  0.03142523765563965
mini_batch_src_global generation:  0.05341839790344238
r_  generation:  0.4820992946624756
local_output_nid generation:  0.032842397689819336
local_in_edges_tensor generation:  0.032059669494628906
mini_batch_src_global generation:  0.05599093437194824
r_  generation:  0.48642492294311523
local_output_nid generation:  0.03291153907775879
local_in_edges_tensor generation:  0.03399205207824707
mini_batch_src_global generation:  0.0542142391204834
r_  generation:  0.48139357566833496
local_output_nid generation:  0.032619476318359375
local_in_edges_tensor generation:  0.030782461166381836
mini_batch_src_global generation:  0.05408453941345215
r_  generation:  0.4884519577026367
local_output_nid generation:  0.032560110092163086
local_in_edges_tensor generation:  0.0310671329498291
mini_batch_src_global generation:  0.05338454246520996
r_  generation:  0.47952890396118164
local_output_nid generation:  0.0327911376953125
local_in_edges_tensor generation:  0.03063178062438965
mini_batch_src_global generation:  0.0546112060546875
r_  generation:  0.48503565788269043
----------------------check_connections_block total spend ----------------------------- 11.282605409622192
generate_one_block  0.5918805599212646
generate_one_block  0.5906734466552734
generate_one_block  0.5962839126586914
generate_one_block  0.6007752418518066
generate_one_block  0.6012692451477051
generate_one_block  0.5905227661132812
generate_one_block  0.607428789138794
generate_one_block  0.5938918590545654
generate_one_block  0.6303744316101074
generate_one_block  0.6041367053985596
generate_one_block  0.5953977108001709
generate_one_block  0.5989444255828857
generate_one_block  0.5984396934509277
generate_one_block  0.5985884666442871
generate_one_block  0.5900974273681641
generate_one_block  0.5934677124023438
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12356424331665039  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

connection checking time:  17.59180212020874
block generation total time  15.240797758102417
average batch blocks generation time:  0.9525498598814011
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09709835052490234  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7598395347595215  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09720039367675781  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7611823081970215  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09728097915649414  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7647266387939453  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09766674041748047  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7717442512512207  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09755706787109375  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7743244171142578  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09745502471923828  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7666225433349609  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09735107421875  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7677063941955566  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0976715087890625  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.771054744720459  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09734678268432617  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7672529220581055  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09757184982299805  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7745456695556641  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09731101989746094  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.764678955078125  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09765434265136719  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7756614685058594  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09766578674316406  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7750797271728516  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09759187698364258  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7666721343994141  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09724283218383789  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7660093307495117  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09733819961547852  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7639427185058594  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.061766430735588074 |0.013582572340965271 |0.003778994083404541 |9.927153587341309e-05 |0.003434315323829651 |0.0015287399291992188 |
----------------------------------------------------------pseudo_mini_loss sum 1.9489896297454834
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  5316956
Number of first layer input nodes during this epoch:  2508793
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12292051315307617  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02543783187866211
random selection method range initialization spend 0.005494356155395508
time for parepare:  0.0197293758392334
local_output_nid generation:  0.002299785614013672
local_in_edges_tensor generation:  0.00888514518737793
mini_batch_src_global generation:  0.0021524429321289062
r_  generation:  0.020842790603637695
local_output_nid generation:  0.003043651580810547
local_in_edges_tensor generation:  0.0017752647399902344
mini_batch_src_global generation:  0.002337932586669922
r_  generation:  0.022481441497802734
local_output_nid generation:  0.0031065940856933594
local_in_edges_tensor generation:  0.0017197132110595703
mini_batch_src_global generation:  0.0017235279083251953
r_  generation:  0.021923303604125977
local_output_nid generation:  0.0030677318572998047
local_in_edges_tensor generation:  0.0016336441040039062
mini_batch_src_global generation:  0.0018193721771240234
r_  generation:  0.02223038673400879
local_output_nid generation:  0.0030498504638671875
local_in_edges_tensor generation:  0.001708984375
mini_batch_src_global generation:  0.0017592906951904297
r_  generation:  0.021725177764892578
local_output_nid generation:  0.0030519962310791016
local_in_edges_tensor generation:  0.001644134521484375
mini_batch_src_global generation:  0.0017561912536621094
r_  generation:  0.022093772888183594
local_output_nid generation:  0.003000020980834961
local_in_edges_tensor generation:  0.0016238689422607422
mini_batch_src_global generation:  0.001790761947631836
r_  generation:  0.023168563842773438
local_output_nid generation:  0.0030241012573242188
local_in_edges_tensor generation:  0.0016236305236816406
mini_batch_src_global generation:  0.001786947250366211
r_  generation:  0.02261495590209961
local_output_nid generation:  0.003030538558959961
local_in_edges_tensor generation:  0.001634836196899414
mini_batch_src_global generation:  0.0017468929290771484
r_  generation:  0.02257847785949707
local_output_nid generation:  0.003017425537109375
local_in_edges_tensor generation:  0.0017228126525878906
mini_batch_src_global generation:  0.0017576217651367188
r_  generation:  0.022098779678344727
local_output_nid generation:  0.003053903579711914
local_in_edges_tensor generation:  0.0016090869903564453
mini_batch_src_global generation:  0.0017633438110351562
r_  generation:  0.022526979446411133
local_output_nid generation:  0.002992391586303711
local_in_edges_tensor generation:  0.0016293525695800781
mini_batch_src_global generation:  0.0017735958099365234
r_  generation:  0.022211790084838867
local_output_nid generation:  0.0029768943786621094
local_in_edges_tensor generation:  0.0017080307006835938
mini_batch_src_global generation:  0.0017039775848388672
r_  generation:  0.02140951156616211
local_output_nid generation:  0.0030345916748046875
local_in_edges_tensor generation:  0.001596212387084961
mini_batch_src_global generation:  0.0016779899597167969
r_  generation:  0.02186441421508789
local_output_nid generation:  0.0029952526092529297
local_in_edges_tensor generation:  0.0015642642974853516
mini_batch_src_global generation:  0.001756906509399414
r_  generation:  0.022673845291137695
local_output_nid generation:  0.002964019775390625
local_in_edges_tensor generation:  0.0015957355499267578
mini_batch_src_global generation:  0.0017423629760742188
r_  generation:  0.022405624389648438
----------------------check_connections_block total spend ----------------------------- 0.5739443302154541
generate_one_block  0.030824899673461914
generate_one_block  0.03163266181945801
generate_one_block  0.03137803077697754
generate_one_block  0.0320131778717041
generate_one_block  0.030977487564086914
generate_one_block  0.033753395080566406
generate_one_block  0.0324559211730957
generate_one_block  0.0317378044128418
generate_one_block  0.031230449676513672
generate_one_block  0.031124353408813477
generate_one_block  0.031813859939575195
generate_one_block  0.03126716613769531
generate_one_block  0.03040790557861328
generate_one_block  0.030626773834228516
generate_one_block  0.03139305114746094
generate_one_block  0.031982421875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04123210906982422
gen group dst list time:  0.01850438117980957
time for parepare:  0.019880294799804688
local_output_nid generation:  0.009075164794921875
local_in_edges_tensor generation:  0.02830028533935547
mini_batch_src_global generation:  0.025684833526611328
r_  generation:  0.24515557289123535
local_output_nid generation:  0.013344764709472656
local_in_edges_tensor generation:  0.02035355567932129
mini_batch_src_global generation:  0.033174753189086914
r_  generation:  0.2605009078979492
local_output_nid generation:  0.01300811767578125
local_in_edges_tensor generation:  0.020330429077148438
mini_batch_src_global generation:  0.03449058532714844
r_  generation:  0.2669219970703125
local_output_nid generation:  0.013768672943115234
local_in_edges_tensor generation:  0.020696163177490234
mini_batch_src_global generation:  0.03402996063232422
r_  generation:  0.27603745460510254
local_output_nid generation:  0.013855934143066406
local_in_edges_tensor generation:  0.015822887420654297
mini_batch_src_global generation:  0.03355073928833008
r_  generation:  0.2728710174560547
local_output_nid generation:  0.013689994812011719
local_in_edges_tensor generation:  0.015713930130004883
mini_batch_src_global generation:  0.03381538391113281
r_  generation:  0.27437400817871094
local_output_nid generation:  0.014055967330932617
local_in_edges_tensor generation:  0.015818357467651367
mini_batch_src_global generation:  0.034642934799194336
r_  generation:  0.2787747383117676
local_output_nid generation:  0.01372385025024414
local_in_edges_tensor generation:  0.016626596450805664
mini_batch_src_global generation:  0.034499406814575195
r_  generation:  0.27683353424072266
local_output_nid generation:  0.0139007568359375
local_in_edges_tensor generation:  0.016043424606323242
mini_batch_src_global generation:  0.03399085998535156
r_  generation:  0.2770078182220459
local_output_nid generation:  0.013853311538696289
local_in_edges_tensor generation:  0.016493558883666992
mini_batch_src_global generation:  0.03553509712219238
r_  generation:  0.2759287357330322
local_output_nid generation:  0.014940500259399414
local_in_edges_tensor generation:  0.017014503479003906
mini_batch_src_global generation:  0.03484821319580078
r_  generation:  0.2775301933288574
local_output_nid generation:  0.015042543411254883
local_in_edges_tensor generation:  0.018259763717651367
mini_batch_src_global generation:  0.03470206260681152
r_  generation:  0.27526164054870605
local_output_nid generation:  0.012768745422363281
local_in_edges_tensor generation:  0.021573781967163086
mini_batch_src_global generation:  0.03399038314819336
r_  generation:  0.27200818061828613
local_output_nid generation:  0.012956380844116211
local_in_edges_tensor generation:  0.015523433685302734
mini_batch_src_global generation:  0.03603863716125488
r_  generation:  0.2762026786804199
local_output_nid generation:  0.013170480728149414
local_in_edges_tensor generation:  0.02222418785095215
mini_batch_src_global generation:  0.0373845100402832
r_  generation:  0.2768073081970215
local_output_nid generation:  0.013396739959716797
local_in_edges_tensor generation:  0.01911330223083496
mini_batch_src_global generation:  0.03721022605895996
r_  generation:  0.28098464012145996
----------------------check_connections_block total spend ----------------------------- 6.370125770568848
generate_one_block  0.3581674098968506
generate_one_block  0.34543752670288086
generate_one_block  0.35590076446533203
generate_one_block  0.3598644733428955
generate_one_block  0.3558783531188965
generate_one_block  0.352283239364624
generate_one_block  0.40447378158569336
generate_one_block  0.3542964458465576
generate_one_block  0.35281848907470703
generate_one_block  0.34661173820495605
generate_one_block  0.3558063507080078
generate_one_block  0.3502655029296875
generate_one_block  0.3459658622741699
generate_one_block  0.34806203842163086
generate_one_block  0.3564338684082031
generate_one_block  0.3575441837310791
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0381467342376709
gen group dst list time:  0.06814742088317871
time for parepare:  0.01955866813659668
local_output_nid generation:  0.027553081512451172
local_in_edges_tensor generation:  0.0571286678314209
mini_batch_src_global generation:  0.04396176338195801
r_  generation:  0.4618692398071289
local_output_nid generation:  0.032662391662597656
local_in_edges_tensor generation:  0.04320836067199707
mini_batch_src_global generation:  0.054285287857055664
r_  generation:  0.4623897075653076
local_output_nid generation:  0.033991336822509766
local_in_edges_tensor generation:  0.03291034698486328
mini_batch_src_global generation:  0.05099296569824219
r_  generation:  0.4780268669128418
local_output_nid generation:  0.03338909149169922
local_in_edges_tensor generation:  0.03864884376525879
mini_batch_src_global generation:  0.05236077308654785
r_  generation:  0.4884772300720215
local_output_nid generation:  0.03629183769226074
local_in_edges_tensor generation:  0.09153366088867188
mini_batch_src_global generation:  0.05723142623901367
r_  generation:  0.47569966316223145
local_output_nid generation:  0.03253817558288574
local_in_edges_tensor generation:  0.030983924865722656
mini_batch_src_global generation:  0.053314208984375
r_  generation:  0.47861695289611816
local_output_nid generation:  0.03267025947570801
local_in_edges_tensor generation:  0.03325319290161133
mini_batch_src_global generation:  0.052991628646850586
r_  generation:  0.4768054485321045
local_output_nid generation:  0.03267621994018555
local_in_edges_tensor generation:  0.034587860107421875
mini_batch_src_global generation:  0.08365011215209961
r_  generation:  0.480266809463501
local_output_nid generation:  0.032442331314086914
local_in_edges_tensor generation:  0.03039407730102539
mini_batch_src_global generation:  0.05300593376159668
r_  generation:  0.4807000160217285
local_output_nid generation:  0.033751487731933594
local_in_edges_tensor generation:  0.03594255447387695
mini_batch_src_global generation:  0.05459856986999512
r_  generation:  0.48087406158447266
local_output_nid generation:  0.03307008743286133
local_in_edges_tensor generation:  0.03259420394897461
mini_batch_src_global generation:  0.053307533264160156
r_  generation:  0.47705674171447754
local_output_nid generation:  0.03252673149108887
local_in_edges_tensor generation:  0.031647443771362305
mini_batch_src_global generation:  0.055650949478149414
r_  generation:  0.4778780937194824
local_output_nid generation:  0.03260684013366699
local_in_edges_tensor generation:  0.032335519790649414
mini_batch_src_global generation:  0.0533750057220459
r_  generation:  0.475583553314209
local_output_nid generation:  0.032543182373046875
local_in_edges_tensor generation:  0.03349947929382324
mini_batch_src_global generation:  0.0543212890625
r_  generation:  0.4787445068359375
local_output_nid generation:  0.033086538314819336
local_in_edges_tensor generation:  0.03575396537780762
mini_batch_src_global generation:  0.05534696578979492
r_  generation:  0.47954607009887695
local_output_nid generation:  0.03323483467102051
local_in_edges_tensor generation:  0.03733420372009277
mini_batch_src_global generation:  0.05397748947143555
r_  generation:  0.48172664642333984
----------------------check_connections_block total spend ----------------------------- 11.391468048095703
generate_one_block  0.606757640838623
generate_one_block  0.587092399597168
generate_one_block  0.5885968208312988
generate_one_block  0.5990440845489502
generate_one_block  0.6033952236175537
generate_one_block  0.5922753810882568
generate_one_block  0.5985324382781982
generate_one_block  0.6126244068145752
generate_one_block  0.6817481517791748
generate_one_block  0.5910928249359131
generate_one_block  0.5989968776702881
generate_one_block  0.5904481410980225
generate_one_block  0.6017725467681885
generate_one_block  0.6072025299072266
generate_one_block  0.6045892238616943
generate_one_block  0.6035106182098389
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12292051315307617  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

connection checking time:  17.76159381866455
block generation total time  15.367489337921143
average batch blocks generation time:  0.9604680836200714
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09737586975097656  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7651286125183105  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09732913970947266  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7652392387390137  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0974893569946289  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7678842544555664  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09764289855957031  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.775475025177002  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09747743606567383  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7658958435058594  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09733343124389648  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7658529281616211  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09755134582519531  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7716317176818848  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09748649597167969  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7661609649658203  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09748315811157227  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7712893486022949  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09732294082641602  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7649831771850586  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0974569320678711  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7710456848144531  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09739923477172852  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7640218734741211  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09715461730957031  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7594313621520996  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0972909927368164  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7647480964660645  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09766244888305664  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7711834907531738  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09774208068847656  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7751517295837402  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0658748596906662 |0.015463650226593018 |0.0039163678884506226 |9.828805923461914e-05 |0.0035743415355682373 |0.002971172332763672 |
----------------------------------------------------------pseudo_mini_loss sum 1.8633453845977783
 Run 0| Epoch 6 |
Number of nodes for computation during this epoch:  5317962
Number of first layer input nodes during this epoch:  2509575
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12375879287719727  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02506542205810547
random selection method range initialization spend 0.005541801452636719
time for parepare:  0.02008056640625
local_output_nid generation:  0.0023458003997802734
local_in_edges_tensor generation:  0.0048465728759765625
mini_batch_src_global generation:  0.001817941665649414
r_  generation:  0.021416902542114258
local_output_nid generation:  0.002851724624633789
local_in_edges_tensor generation:  0.001705169677734375
mini_batch_src_global generation:  0.00211334228515625
r_  generation:  0.022795915603637695
local_output_nid generation:  0.0030145645141601562
local_in_edges_tensor generation:  0.0018115043640136719
mini_batch_src_global generation:  0.0017409324645996094
r_  generation:  0.021165847778320312
local_output_nid generation:  0.003048419952392578
local_in_edges_tensor generation:  0.0016663074493408203
mini_batch_src_global generation:  0.0018038749694824219
r_  generation:  0.021671056747436523
local_output_nid generation:  0.003007650375366211
local_in_edges_tensor generation:  0.0016417503356933594
mini_batch_src_global generation:  0.0017919540405273438
r_  generation:  0.021982192993164062
local_output_nid generation:  0.002988576889038086
local_in_edges_tensor generation:  0.0016124248504638672
mini_batch_src_global generation:  0.0018157958984375
r_  generation:  0.022461891174316406
local_output_nid generation:  0.0030601024627685547
local_in_edges_tensor generation:  0.0016465187072753906
mini_batch_src_global generation:  0.0018053054809570312
r_  generation:  0.022111177444458008
local_output_nid generation:  0.003034830093383789
local_in_edges_tensor generation:  0.0016674995422363281
mini_batch_src_global generation:  0.0017893314361572266
r_  generation:  0.02176523208618164
local_output_nid generation:  0.0030591487884521484
local_in_edges_tensor generation:  0.0016200542449951172
mini_batch_src_global generation:  0.0017795562744140625
r_  generation:  0.022197246551513672
local_output_nid generation:  0.0030035972595214844
local_in_edges_tensor generation:  0.0015985965728759766
mini_batch_src_global generation:  0.0018074512481689453
r_  generation:  0.021820545196533203
local_output_nid generation:  0.00298309326171875
local_in_edges_tensor generation:  0.0016529560089111328
mini_batch_src_global generation:  0.0018115043640136719
r_  generation:  0.023115873336791992
local_output_nid generation:  0.0032231807708740234
local_in_edges_tensor generation:  0.0016829967498779297
mini_batch_src_global generation:  0.001825094223022461
r_  generation:  0.021921873092651367
local_output_nid generation:  0.0030698776245117188
local_in_edges_tensor generation:  0.00157928466796875
mini_batch_src_global generation:  0.0017712116241455078
r_  generation:  0.022135019302368164
local_output_nid generation:  0.0030832290649414062
local_in_edges_tensor generation:  0.0015304088592529297
mini_batch_src_global generation:  0.0018270015716552734
r_  generation:  0.022724628448486328
local_output_nid generation:  0.0030388832092285156
local_in_edges_tensor generation:  0.0016567707061767578
mini_batch_src_global generation:  0.0018131732940673828
r_  generation:  0.022010087966918945
local_output_nid generation:  0.003003835678100586
local_in_edges_tensor generation:  0.0015802383422851562
mini_batch_src_global generation:  0.0017571449279785156
r_  generation:  0.02245163917541504
----------------------check_connections_block total spend ----------------------------- 0.5707225799560547
generate_one_block  0.03154468536376953
generate_one_block  0.03229951858520508
generate_one_block  0.030648469924926758
generate_one_block  0.031835079193115234
generate_one_block  0.031975746154785156
generate_one_block  0.03530597686767578
generate_one_block  0.031529903411865234
generate_one_block  0.030889511108398438
generate_one_block  0.0316464900970459
generate_one_block  0.03104090690612793
generate_one_block  0.03144478797912598
generate_one_block  0.031067371368408203
generate_one_block  0.031360626220703125
generate_one_block  0.03253674507141113
generate_one_block  0.03132319450378418
generate_one_block  0.031796932220458984
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.040772438049316406
gen group dst list time:  0.01828312873840332
time for parepare:  0.019644498825073242
local_output_nid generation:  0.009376287460327148
local_in_edges_tensor generation:  0.03174853324890137
mini_batch_src_global generation:  0.02579355239868164
r_  generation:  0.25480222702026367
local_output_nid generation:  0.01575183868408203
local_in_edges_tensor generation:  0.02274036407470703
mini_batch_src_global generation:  0.033941030502319336
r_  generation:  0.26993346214294434
local_output_nid generation:  0.012901544570922852
local_in_edges_tensor generation:  0.018823862075805664
mini_batch_src_global generation:  0.041965484619140625
r_  generation:  0.2646307945251465
local_output_nid generation:  0.01520991325378418
local_in_edges_tensor generation:  0.01518559455871582
mini_batch_src_global generation:  0.033730506896972656
r_  generation:  0.272841215133667
local_output_nid generation:  0.014183521270751953
local_in_edges_tensor generation:  0.016385316848754883
mini_batch_src_global generation:  0.03399157524108887
r_  generation:  0.27718377113342285
local_output_nid generation:  0.014421701431274414
local_in_edges_tensor generation:  0.015874624252319336
mini_batch_src_global generation:  0.034470558166503906
r_  generation:  0.27577733993530273
local_output_nid generation:  0.014179229736328125
local_in_edges_tensor generation:  0.016971111297607422
mini_batch_src_global generation:  0.034420013427734375
r_  generation:  0.2730278968811035
local_output_nid generation:  0.01403045654296875
local_in_edges_tensor generation:  0.01895761489868164
mini_batch_src_global generation:  0.033889055252075195
r_  generation:  0.26711201667785645
local_output_nid generation:  0.01428365707397461
local_in_edges_tensor generation:  0.014523744583129883
mini_batch_src_global generation:  0.03486490249633789
r_  generation:  0.2767961025238037
local_output_nid generation:  0.014239788055419922
local_in_edges_tensor generation:  0.014165401458740234
mini_batch_src_global generation:  0.03421664237976074
r_  generation:  0.27001953125
local_output_nid generation:  0.013942956924438477
local_in_edges_tensor generation:  0.01507258415222168
mini_batch_src_global generation:  0.03420615196228027
r_  generation:  0.2750120162963867
local_output_nid generation:  0.014098882675170898
local_in_edges_tensor generation:  0.017691612243652344
mini_batch_src_global generation:  0.034427642822265625
r_  generation:  0.2779111862182617
local_output_nid generation:  0.013651609420776367
local_in_edges_tensor generation:  0.014573335647583008
mini_batch_src_global generation:  0.03623461723327637
r_  generation:  0.27432823181152344
local_output_nid generation:  0.01367497444152832
local_in_edges_tensor generation:  0.015949726104736328
mini_batch_src_global generation:  0.03845834732055664
r_  generation:  0.28328514099121094
local_output_nid generation:  0.013619661331176758
local_in_edges_tensor generation:  0.015632152557373047
mini_batch_src_global generation:  0.0376896858215332
r_  generation:  0.2799499034881592
local_output_nid generation:  0.013526439666748047
local_in_edges_tensor generation:  0.014890193939208984
mini_batch_src_global generation:  0.034218788146972656
r_  generation:  0.27860188484191895
----------------------check_connections_block total spend ----------------------------- 6.374409198760986
generate_one_block  0.374969482421875
generate_one_block  0.3626997470855713
generate_one_block  0.34444570541381836
generate_one_block  0.35890769958496094
generate_one_block  0.3550570011138916
generate_one_block  0.3571913242340088
generate_one_block  0.38275885581970215
generate_one_block  0.3466649055480957
generate_one_block  0.36138343811035156
generate_one_block  0.34503698348999023
generate_one_block  0.3583545684814453
generate_one_block  0.35984301567077637
generate_one_block  0.37009692192077637
generate_one_block  0.3634350299835205
generate_one_block  0.36721372604370117
generate_one_block  0.3511645793914795
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.037786006927490234
gen group dst list time:  0.07001328468322754
time for parepare:  0.02013254165649414
local_output_nid generation:  0.02849602699279785
local_in_edges_tensor generation:  0.054158687591552734
mini_batch_src_global generation:  0.04343390464782715
r_  generation:  0.4575662612915039
local_output_nid generation:  0.03380417823791504
local_in_edges_tensor generation:  0.04106926918029785
mini_batch_src_global generation:  0.05312800407409668
r_  generation:  0.46715497970581055
local_output_nid generation:  0.033586978912353516
local_in_edges_tensor generation:  0.03318428993225098
mini_batch_src_global generation:  0.05148434638977051
r_  generation:  0.4765660762786865
local_output_nid generation:  0.03314948081970215
local_in_edges_tensor generation:  0.03388857841491699
mini_batch_src_global generation:  0.056240081787109375
r_  generation:  0.48882579803466797
local_output_nid generation:  0.033390045166015625
local_in_edges_tensor generation:  0.08372020721435547
mini_batch_src_global generation:  0.05212831497192383
r_  generation:  0.4795565605163574
local_output_nid generation:  0.033187150955200195
local_in_edges_tensor generation:  0.03382730484008789
mini_batch_src_global generation:  0.05370807647705078
r_  generation:  0.4835374355316162
local_output_nid generation:  0.0334627628326416
local_in_edges_tensor generation:  0.03540849685668945
mini_batch_src_global generation:  0.05330228805541992
r_  generation:  0.48611021041870117
local_output_nid generation:  0.03416037559509277
local_in_edges_tensor generation:  0.03473043441772461
mini_batch_src_global generation:  0.05430793762207031
r_  generation:  0.4833252429962158
local_output_nid generation:  0.033255577087402344
local_in_edges_tensor generation:  0.031610727310180664
mini_batch_src_global generation:  0.05395150184631348
r_  generation:  0.4836297035217285
local_output_nid generation:  0.03356432914733887
local_in_edges_tensor generation:  0.035925865173339844
mini_batch_src_global generation:  0.05431509017944336
r_  generation:  0.4829447269439697
local_output_nid generation:  0.0334477424621582
local_in_edges_tensor generation:  0.03533434867858887
mini_batch_src_global generation:  0.054784297943115234
r_  generation:  0.477813720703125
local_output_nid generation:  0.033452749252319336
local_in_edges_tensor generation:  0.032613277435302734
mini_batch_src_global generation:  0.05369877815246582
r_  generation:  0.4811999797821045
local_output_nid generation:  0.03334784507751465
local_in_edges_tensor generation:  0.03279304504394531
mini_batch_src_global generation:  0.05367708206176758
r_  generation:  0.48301267623901367
local_output_nid generation:  0.03375101089477539
local_in_edges_tensor generation:  0.03434038162231445
mini_batch_src_global generation:  0.05370140075683594
r_  generation:  0.483809232711792
local_output_nid generation:  0.033550262451171875
local_in_edges_tensor generation:  0.04296612739562988
mini_batch_src_global generation:  0.056871891021728516
r_  generation:  0.5056929588317871
local_output_nid generation:  0.036576032638549805
local_in_edges_tensor generation:  0.03412151336669922
mini_batch_src_global generation:  0.056418418884277344
r_  generation:  0.4868602752685547
----------------------check_connections_block total spend ----------------------------- 11.455026865005493
generate_one_block  0.6068363189697266
generate_one_block  0.6050827503204346
generate_one_block  0.6124019622802734
generate_one_block  0.5993103981018066
generate_one_block  0.6094958782196045
generate_one_block  0.596343994140625
generate_one_block  0.5982933044433594
generate_one_block  0.611950159072876
generate_one_block  0.6369180679321289
generate_one_block  0.6018095016479492
generate_one_block  0.6052210330963135
generate_one_block  0.6000735759735107
generate_one_block  0.602548360824585
generate_one_block  0.602769136428833
generate_one_block  0.6117463111877441
generate_one_block  0.6039772033691406
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12375879287719727  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

connection checking time:  17.82943606376648
block generation total time  15.464000940322876
average batch blocks generation time:  0.9665000587701797
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09762144088745117  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7749214172363281  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09756135940551758  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7744045257568359  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09734249114990234  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7633810043334961  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09756946563720703  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7723031044006348  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09749889373779297  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.770047664642334  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09737348556518555  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7655096054077148  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09734058380126953  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7627496719360352  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0972895622253418  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7665467262268066  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09758615493774414  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7719063758850098  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09742593765258789  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.767549991607666  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09744548797607422  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7719688415527344  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09742546081542969  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.765169620513916  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09732913970947266  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7639956474304199  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09750223159790039  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7708110809326172  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09770011901855469  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7722129821777344  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09740066528320312  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7671499252319336  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.062135085463523865 |0.01583409309387207 |0.0037096142768859863 |9.499490261077881e-05 |0.0033186376094818115 |0.0033025741577148438 |
----------------------------------------------------------pseudo_mini_loss sum 1.7914185523986816
 Run 0| Epoch 7 |
Number of nodes for computation during this epoch:  5318613
Number of first layer input nodes during this epoch:  2509662
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12310266494750977  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025030851364135742
random selection method range initialization spend 0.006055355072021484
time for parepare:  0.020267009735107422
local_output_nid generation:  0.002295255661010742
local_in_edges_tensor generation:  0.007834911346435547
mini_batch_src_global generation:  0.002122640609741211
r_  generation:  0.020333290100097656
local_output_nid generation:  0.0029642581939697266
local_in_edges_tensor generation:  0.0017428398132324219
mini_batch_src_global generation:  0.0024039745330810547
r_  generation:  0.022644519805908203
local_output_nid generation:  0.0030481815338134766
local_in_edges_tensor generation:  0.0016908645629882812
mini_batch_src_global generation:  0.0017323493957519531
r_  generation:  0.02165055274963379
local_output_nid generation:  0.0030679702758789062
local_in_edges_tensor generation:  0.001672506332397461
mini_batch_src_global generation:  0.0017466545104980469
r_  generation:  0.02261829376220703
local_output_nid generation:  0.0030939579010009766
local_in_edges_tensor generation:  0.0020589828491210938
mini_batch_src_global generation:  0.007717132568359375
r_  generation:  0.022486448287963867
local_output_nid generation:  0.003069639205932617
local_in_edges_tensor generation:  0.0016701221466064453
mini_batch_src_global generation:  0.0017931461334228516
r_  generation:  0.022556066513061523
local_output_nid generation:  0.003103017807006836
local_in_edges_tensor generation:  0.0016512870788574219
mini_batch_src_global generation:  0.001855611801147461
r_  generation:  0.022769689559936523
local_output_nid generation:  0.003054380416870117
local_in_edges_tensor generation:  0.0016438961029052734
mini_batch_src_global generation:  0.0017747879028320312
r_  generation:  0.022258520126342773
local_output_nid generation:  0.0030775070190429688
local_in_edges_tensor generation:  0.0016009807586669922
mini_batch_src_global generation:  0.0017879009246826172
r_  generation:  0.022541284561157227
local_output_nid generation:  0.003031015396118164
local_in_edges_tensor generation:  0.0016012191772460938
mini_batch_src_global generation:  0.001821756362915039
r_  generation:  0.02283477783203125
local_output_nid generation:  0.0030694007873535156
local_in_edges_tensor generation:  0.0016579627990722656
mini_batch_src_global generation:  0.0018076896667480469
r_  generation:  0.021808385848999023
local_output_nid generation:  0.003088235855102539
local_in_edges_tensor generation:  0.0016524791717529297
mini_batch_src_global generation:  0.0017521381378173828
r_  generation:  0.022744178771972656
local_output_nid generation:  0.0030655860900878906
local_in_edges_tensor generation:  0.0016565322875976562
mini_batch_src_global generation:  0.001855611801147461
r_  generation:  0.022658824920654297
local_output_nid generation:  0.0031020641326904297
local_in_edges_tensor generation:  0.0015993118286132812
mini_batch_src_global generation:  0.0018284320831298828
r_  generation:  0.022495031356811523
local_output_nid generation:  0.003091573715209961
local_in_edges_tensor generation:  0.0016469955444335938
mini_batch_src_global generation:  0.0018315315246582031
r_  generation:  0.022600173950195312
local_output_nid generation:  0.0030565261840820312
local_in_edges_tensor generation:  0.0016603469848632812
mini_batch_src_global generation:  0.001817464828491211
r_  generation:  0.022043704986572266
----------------------check_connections_block total spend ----------------------------- 0.5848565101623535
generate_one_block  0.03046131134033203
generate_one_block  0.0320432186126709
generate_one_block  0.030884265899658203
generate_one_block  0.030838966369628906
generate_one_block  0.0316615104675293
generate_one_block  0.03482675552368164
generate_one_block  0.03191876411437988
generate_one_block  0.03137636184692383
generate_one_block  0.031401634216308594
generate_one_block  0.03209090232849121
generate_one_block  0.030949831008911133
generate_one_block  0.031514644622802734
generate_one_block  0.03215193748474121
generate_one_block  0.03131866455078125
generate_one_block  0.03187727928161621
generate_one_block  0.0316927433013916
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04063868522644043
gen group dst list time:  0.018464088439941406
time for parepare:  0.019841909408569336
local_output_nid generation:  0.009116888046264648
local_in_edges_tensor generation:  0.025978803634643555
mini_batch_src_global generation:  0.02595829963684082
r_  generation:  0.24336576461791992
local_output_nid generation:  0.013817071914672852
local_in_edges_tensor generation:  0.019366741180419922
mini_batch_src_global generation:  0.03343844413757324
r_  generation:  0.2627098560333252
local_output_nid generation:  0.013018131256103516
local_in_edges_tensor generation:  0.015373468399047852
mini_batch_src_global generation:  0.0322568416595459
r_  generation:  0.2597532272338867
local_output_nid generation:  0.013352394104003906
local_in_edges_tensor generation:  0.019383907318115234
mini_batch_src_global generation:  0.03297567367553711
r_  generation:  0.26644182205200195
local_output_nid generation:  0.013993501663208008
local_in_edges_tensor generation:  0.019248485565185547
mini_batch_src_global generation:  0.03512907028198242
r_  generation:  0.2732856273651123
local_output_nid generation:  0.014059305191040039
local_in_edges_tensor generation:  0.018368005752563477
mini_batch_src_global generation:  0.03589510917663574
r_  generation:  0.28355932235717773
local_output_nid generation:  0.013970375061035156
local_in_edges_tensor generation:  0.016436100006103516
mini_batch_src_global generation:  0.036334991455078125
r_  generation:  0.27637720108032227
local_output_nid generation:  0.014046669006347656
local_in_edges_tensor generation:  0.014175653457641602
mini_batch_src_global generation:  0.035169124603271484
r_  generation:  0.2744741439819336
local_output_nid generation:  0.01394343376159668
local_in_edges_tensor generation:  0.014301061630249023
mini_batch_src_global generation:  0.03466200828552246
r_  generation:  0.2763645648956299
local_output_nid generation:  0.014162302017211914
local_in_edges_tensor generation:  0.014605522155761719
mini_batch_src_global generation:  0.03515887260437012
r_  generation:  0.285660982131958
local_output_nid generation:  0.013336181640625
local_in_edges_tensor generation:  0.014232635498046875
mini_batch_src_global generation:  0.03438735008239746
r_  generation:  0.27354001998901367
local_output_nid generation:  0.014127254486083984
local_in_edges_tensor generation:  0.014240264892578125
mini_batch_src_global generation:  0.0345919132232666
r_  generation:  0.27878594398498535
local_output_nid generation:  0.014203548431396484
local_in_edges_tensor generation:  0.014818429946899414
mini_batch_src_global generation:  0.035547733306884766
r_  generation:  0.27902984619140625
local_output_nid generation:  0.013338088989257812
local_in_edges_tensor generation:  0.017015933990478516
mini_batch_src_global generation:  0.034558773040771484
r_  generation:  0.27506399154663086
local_output_nid generation:  0.013292312622070312
local_in_edges_tensor generation:  0.014004230499267578
mini_batch_src_global generation:  0.03505825996398926
r_  generation:  0.279712438583374
local_output_nid generation:  0.013106822967529297
local_in_edges_tensor generation:  0.015268802642822266
mini_batch_src_global generation:  0.034121036529541016
r_  generation:  0.2774379253387451
----------------------check_connections_block total spend ----------------------------- 6.332238435745239
generate_one_block  0.35872960090637207
generate_one_block  0.35616230964660645
generate_one_block  0.35636234283447266
generate_one_block  0.354830265045166
generate_one_block  0.3685321807861328
generate_one_block  0.3788464069366455
generate_one_block  0.3899955749511719
generate_one_block  0.34999537467956543
generate_one_block  0.3590879440307617
generate_one_block  0.37712597846984863
generate_one_block  0.364194393157959
generate_one_block  0.35417962074279785
generate_one_block  0.36341333389282227
generate_one_block  0.3531525135040283
generate_one_block  0.35868024826049805
generate_one_block  0.34516167640686035
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03534245491027832
gen group dst list time:  0.06807303428649902
time for parepare:  0.02005290985107422
local_output_nid generation:  0.028435468673706055
local_in_edges_tensor generation:  0.046293020248413086
mini_batch_src_global generation:  0.04282641410827637
r_  generation:  0.46249818801879883
local_output_nid generation:  0.03262042999267578
local_in_edges_tensor generation:  0.0442042350769043
mini_batch_src_global generation:  0.0535588264465332
r_  generation:  0.46186089515686035
local_output_nid generation:  0.03272390365600586
local_in_edges_tensor generation:  0.036993980407714844
mini_batch_src_global generation:  0.05699491500854492
r_  generation:  0.4746530055999756
local_output_nid generation:  0.03252530097961426
local_in_edges_tensor generation:  0.04172110557556152
mini_batch_src_global generation:  0.052803993225097656
r_  generation:  0.47424745559692383
local_output_nid generation:  0.03257632255554199
local_in_edges_tensor generation:  0.07769536972045898
mini_batch_src_global generation:  0.05450248718261719
r_  generation:  0.4807732105255127
local_output_nid generation:  0.03491950035095215
local_in_edges_tensor generation:  0.03615140914916992
mini_batch_src_global generation:  0.05383706092834473
r_  generation:  0.5009269714355469
local_output_nid generation:  0.0367128849029541
local_in_edges_tensor generation:  0.0360414981842041
mini_batch_src_global generation:  0.05885791778564453
r_  generation:  0.4746708869934082
local_output_nid generation:  0.03403639793395996
local_in_edges_tensor generation:  0.03176712989807129
mini_batch_src_global generation:  0.05477619171142578
r_  generation:  0.4810488224029541
local_output_nid generation:  0.034043073654174805
local_in_edges_tensor generation:  0.03504538536071777
mini_batch_src_global generation:  0.053043365478515625
r_  generation:  0.47814440727233887
local_output_nid generation:  0.03398275375366211
local_in_edges_tensor generation:  0.03397989273071289
mini_batch_src_global generation:  0.057244062423706055
r_  generation:  0.491375207901001
local_output_nid generation:  0.03387117385864258
local_in_edges_tensor generation:  0.030758380889892578
mini_batch_src_global generation:  0.0536198616027832
r_  generation:  0.4818260669708252
local_output_nid generation:  0.03403162956237793
local_in_edges_tensor generation:  0.030803680419921875
mini_batch_src_global generation:  0.05500912666320801
r_  generation:  0.4841787815093994
local_output_nid generation:  0.03378462791442871
local_in_edges_tensor generation:  0.03340721130371094
mini_batch_src_global generation:  0.05363011360168457
r_  generation:  0.4780385494232178
local_output_nid generation:  0.03437352180480957
local_in_edges_tensor generation:  0.03325796127319336
mini_batch_src_global generation:  0.055292367935180664
r_  generation:  0.4797239303588867
local_output_nid generation:  0.03425312042236328
local_in_edges_tensor generation:  0.03325772285461426
mini_batch_src_global generation:  0.05355191230773926
r_  generation:  0.47855448722839355
local_output_nid generation:  0.034171104431152344
local_in_edges_tensor generation:  0.031225919723510742
mini_batch_src_global generation:  0.05444788932800293
r_  generation:  0.4779326915740967
----------------------check_connections_block total spend ----------------------------- 11.399617433547974
generate_one_block  0.6029515266418457
generate_one_block  0.6070888042449951
generate_one_block  0.6020128726959229
generate_one_block  0.5946099758148193
generate_one_block  0.5990192890167236
generate_one_block  0.6071267127990723
generate_one_block  0.600658655166626
generate_one_block  0.5990924835205078
generate_one_block  0.6759474277496338
generate_one_block  0.6099362373352051
generate_one_block  0.612339973449707
generate_one_block  0.6013121604919434
generate_one_block  0.6092629432678223
generate_one_block  0.6008570194244385
generate_one_block  0.5983846187591553
generate_one_block  0.6049435138702393
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12310266494750977  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

connection checking time:  17.731855869293213
block generation total time  15.513993978500366
average batch blocks generation time:  0.9696246236562729
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0972747802734375  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7611303329467773  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0974116325378418  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7678747177124023  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09743833541870117  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7698407173156738  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09717226028442383  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7624855041503906  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09751701354980469  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7745013236999512  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09776926040649414  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7749500274658203  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09742975234985352  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7672586441040039  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09744834899902344  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7704219818115234  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09754228591918945  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7706332206726074  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09772634506225586  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.775702953338623  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09726619720458984  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7634711265563965  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0974893569946289  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7677836418151855  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09754419326782227  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.774993896484375  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09730863571166992  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.765052318572998  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09750652313232422  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7678704261779785  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09722471237182617  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.762749195098877  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06507092714309692 |0.015440553426742554 |0.0036319345235824585 |9.647011756896973e-05 |0.0033761262893676758 |0.002938508987426758 |
----------------------------------------------------------pseudo_mini_loss sum 1.7035400867462158
 Run 0| Epoch 8 |
Number of nodes for computation during this epoch:  5317936
Number of first layer input nodes during this epoch:  2508799
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12274312973022461  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027019500732421875
random selection method range initialization spend 0.006959438323974609
time for parepare:  0.01922917366027832
local_output_nid generation:  0.0023801326751708984
local_in_edges_tensor generation:  0.00586247444152832
mini_batch_src_global generation:  0.0018863677978515625
r_  generation:  0.021749258041381836
local_output_nid generation:  0.002870321273803711
local_in_edges_tensor generation:  0.0017693042755126953
mini_batch_src_global generation:  0.002106189727783203
r_  generation:  0.024906635284423828
local_output_nid generation:  0.0030515193939208984
local_in_edges_tensor generation:  0.002147674560546875
mini_batch_src_global generation:  0.0018150806427001953
r_  generation:  0.02162647247314453
local_output_nid generation:  0.0030019283294677734
local_in_edges_tensor generation:  0.0017685890197753906
mini_batch_src_global generation:  0.0017917156219482422
r_  generation:  0.022284269332885742
local_output_nid generation:  0.0030472278594970703
local_in_edges_tensor generation:  0.0017414093017578125
mini_batch_src_global generation:  0.0017750263214111328
r_  generation:  0.022090435028076172
local_output_nid generation:  0.003675222396850586
local_in_edges_tensor generation:  0.003437042236328125
mini_batch_src_global generation:  0.001796722412109375
r_  generation:  0.02195906639099121
local_output_nid generation:  0.003018617630004883
local_in_edges_tensor generation:  0.0018117427825927734
mini_batch_src_global generation:  0.0018091201782226562
r_  generation:  0.02263045310974121
local_output_nid generation:  0.0029866695404052734
local_in_edges_tensor generation:  0.001829385757446289
mini_batch_src_global generation:  0.0018200874328613281
r_  generation:  0.02460765838623047
local_output_nid generation:  0.0030126571655273438
local_in_edges_tensor generation:  0.0017571449279785156
mini_batch_src_global generation:  0.0025129318237304688
r_  generation:  0.02183675765991211
local_output_nid generation:  0.003025054931640625
local_in_edges_tensor generation:  0.001882791519165039
mini_batch_src_global generation:  0.0017588138580322266
r_  generation:  0.022050142288208008
local_output_nid generation:  0.003170013427734375
local_in_edges_tensor generation:  0.0017540454864501953
mini_batch_src_global generation:  0.0017864704132080078
r_  generation:  0.02448439598083496
local_output_nid generation:  0.0030341148376464844
local_in_edges_tensor generation:  0.003362417221069336
mini_batch_src_global generation:  0.0021338462829589844
r_  generation:  0.022005319595336914
local_output_nid generation:  0.0030486583709716797
local_in_edges_tensor generation:  0.001953601837158203
mini_batch_src_global generation:  0.0019412040710449219
r_  generation:  0.022889375686645508
local_output_nid generation:  0.0030612945556640625
local_in_edges_tensor generation:  0.0017390251159667969
mini_batch_src_global generation:  0.0018241405487060547
r_  generation:  0.023275136947631836
local_output_nid generation:  0.003042459487915039
local_in_edges_tensor generation:  0.001661062240600586
mini_batch_src_global generation:  0.0017895698547363281
r_  generation:  0.022351503372192383
local_output_nid generation:  0.003056049346923828
local_in_edges_tensor generation:  0.0016794204711914062
mini_batch_src_global generation:  0.0018107891082763672
r_  generation:  0.02192854881286621
----------------------check_connections_block total spend ----------------------------- 0.5875916481018066
generate_one_block  0.03796505928039551
generate_one_block  0.03129434585571289
generate_one_block  0.03126049041748047
generate_one_block  0.032199859619140625
generate_one_block  0.03357434272766113
generate_one_block  0.0341644287109375
generate_one_block  0.03277707099914551
generate_one_block  0.034010887145996094
generate_one_block  0.031089305877685547
generate_one_block  0.031641483306884766
generate_one_block  0.03124523162841797
generate_one_block  0.03079986572265625
generate_one_block  0.032831668853759766
generate_one_block  0.0339663028717041
generate_one_block  0.03188371658325195
generate_one_block  0.03170180320739746
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0386962890625
gen group dst list time:  0.018372535705566406
time for parepare:  0.02177262306213379
local_output_nid generation:  0.009982824325561523
local_in_edges_tensor generation:  0.02499079704284668
mini_batch_src_global generation:  0.029848814010620117
r_  generation:  0.2651808261871338
local_output_nid generation:  0.015950441360473633
local_in_edges_tensor generation:  0.018802404403686523
mini_batch_src_global generation:  0.03296661376953125
r_  generation:  0.2577931880950928
local_output_nid generation:  0.013690710067749023
local_in_edges_tensor generation:  0.018469572067260742
mini_batch_src_global generation:  0.03239941596984863
r_  generation:  0.26189637184143066
local_output_nid generation:  0.014551877975463867
local_in_edges_tensor generation:  0.014783382415771484
mini_batch_src_global generation:  0.03363609313964844
r_  generation:  0.27626514434814453
local_output_nid generation:  0.014294624328613281
local_in_edges_tensor generation:  0.014152288436889648
mini_batch_src_global generation:  0.03377962112426758
r_  generation:  0.26854848861694336
local_output_nid generation:  0.013944864273071289
local_in_edges_tensor generation:  0.014182567596435547
mini_batch_src_global generation:  0.03342938423156738
r_  generation:  0.27352166175842285
local_output_nid generation:  0.014724254608154297
local_in_edges_tensor generation:  0.015163660049438477
mini_batch_src_global generation:  0.0345761775970459
r_  generation:  0.27510952949523926
local_output_nid generation:  0.014746427536010742
local_in_edges_tensor generation:  0.015697240829467773
mini_batch_src_global generation:  0.03600668907165527
r_  generation:  0.2796475887298584
local_output_nid generation:  0.014339447021484375
local_in_edges_tensor generation:  0.014348030090332031
mini_batch_src_global generation:  0.03416275978088379
r_  generation:  0.2725989818572998
local_output_nid generation:  0.014495849609375
local_in_edges_tensor generation:  0.01519918441772461
mini_batch_src_global generation:  0.03400444984436035
r_  generation:  0.27544569969177246
local_output_nid generation:  0.014445304870605469
local_in_edges_tensor generation:  0.015377998352050781
mini_batch_src_global generation:  0.03427886962890625
r_  generation:  0.27225756645202637
local_output_nid generation:  0.014195680618286133
local_in_edges_tensor generation:  0.013854026794433594
mini_batch_src_global generation:  0.03381156921386719
r_  generation:  0.2712666988372803
local_output_nid generation:  0.014671564102172852
local_in_edges_tensor generation:  0.017437219619750977
mini_batch_src_global generation:  0.036975860595703125
r_  generation:  0.284564733505249
local_output_nid generation:  0.014116048812866211
local_in_edges_tensor generation:  0.015194892883300781
mini_batch_src_global generation:  0.03467082977294922
r_  generation:  0.2788114547729492
local_output_nid generation:  0.013773441314697266
local_in_edges_tensor generation:  0.014061689376831055
mini_batch_src_global generation:  0.03616046905517578
r_  generation:  0.27987241744995117
local_output_nid generation:  0.013443708419799805
local_in_edges_tensor generation:  0.015122413635253906
mini_batch_src_global generation:  0.03565359115600586
r_  generation:  0.28768253326416016
----------------------check_connections_block total spend ----------------------------- 6.358554363250732
generate_one_block  0.37126898765563965
generate_one_block  0.3498802185058594
generate_one_block  0.34958744049072266
generate_one_block  0.36214447021484375
generate_one_block  0.34903383255004883
generate_one_block  0.34680891036987305
generate_one_block  0.3827183246612549
generate_one_block  0.3617262840270996
generate_one_block  0.3504765033721924
generate_one_block  0.3516669273376465
generate_one_block  0.3539862632751465
generate_one_block  0.343731164932251
generate_one_block  0.37580418586730957
generate_one_block  0.34831833839416504
generate_one_block  0.3580586910247803
generate_one_block  0.3565399646759033
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03446149826049805
gen group dst list time:  0.07047700881958008
time for parepare:  0.01961040496826172
local_output_nid generation:  0.02868938446044922
local_in_edges_tensor generation:  0.048979997634887695
mini_batch_src_global generation:  0.043294429779052734
r_  generation:  0.46077775955200195
local_output_nid generation:  0.03350687026977539
local_in_edges_tensor generation:  0.04044651985168457
mini_batch_src_global generation:  0.05555868148803711
r_  generation:  0.4617593288421631
local_output_nid generation:  0.033653974533081055
local_in_edges_tensor generation:  0.032721757888793945
mini_batch_src_global generation:  0.05089902877807617
r_  generation:  0.4711766242980957
local_output_nid generation:  0.03302955627441406
local_in_edges_tensor generation:  0.03443336486816406
mini_batch_src_global generation:  0.05195331573486328
r_  generation:  0.47357797622680664
local_output_nid generation:  0.03308463096618652
local_in_edges_tensor generation:  0.07505249977111816
mini_batch_src_global generation:  0.05167722702026367
r_  generation:  0.4755570888519287
local_output_nid generation:  0.03314542770385742
local_in_edges_tensor generation:  0.031177520751953125
mini_batch_src_global generation:  0.05552411079406738
r_  generation:  0.4820983409881592
local_output_nid generation:  0.033660173416137695
local_in_edges_tensor generation:  0.04170966148376465
mini_batch_src_global generation:  0.05500149726867676
r_  generation:  0.480785608291626
local_output_nid generation:  0.03269457817077637
local_in_edges_tensor generation:  0.03590226173400879
mini_batch_src_global generation:  0.05426597595214844
r_  generation:  0.4845445156097412
local_output_nid generation:  0.03330874443054199
local_in_edges_tensor generation:  0.031145572662353516
mini_batch_src_global generation:  0.05357551574707031
r_  generation:  0.48667454719543457
local_output_nid generation:  0.03464221954345703
local_in_edges_tensor generation:  0.038111209869384766
mini_batch_src_global generation:  0.05434870719909668
r_  generation:  0.48560547828674316
local_output_nid generation:  0.03342080116271973
local_in_edges_tensor generation:  0.03672385215759277
mini_batch_src_global generation:  0.054036617279052734
r_  generation:  0.4824199676513672
local_output_nid generation:  0.03347325325012207
local_in_edges_tensor generation:  0.03101634979248047
mini_batch_src_global generation:  0.05520892143249512
r_  generation:  0.5033688545227051
local_output_nid generation:  0.036379098892211914
local_in_edges_tensor generation:  0.03253340721130371
mini_batch_src_global generation:  0.06027650833129883
r_  generation:  0.48341894149780273
local_output_nid generation:  0.03415393829345703
local_in_edges_tensor generation:  0.03428077697753906
mini_batch_src_global generation:  0.05423307418823242
r_  generation:  0.4823760986328125
local_output_nid generation:  0.03412294387817383
local_in_edges_tensor generation:  0.033391475677490234
mini_batch_src_global generation:  0.05562877655029297
r_  generation:  0.48104047775268555
local_output_nid generation:  0.03427481651306152
local_in_edges_tensor generation:  0.03355813026428223
mini_batch_src_global generation:  0.05470132827758789
r_  generation:  0.48354220390319824
----------------------check_connections_block total spend ----------------------------- 11.424428939819336
generate_one_block  0.6108417510986328
generate_one_block  0.6008391380310059
generate_one_block  0.5996768474578857
generate_one_block  0.6026825904846191
generate_one_block  0.5990438461303711
generate_one_block  0.6020870208740234
generate_one_block  0.61590576171875
generate_one_block  0.6052758693695068
generate_one_block  0.6380429267883301
generate_one_block  0.6057369709014893
generate_one_block  0.6034145355224609
generate_one_block  0.6033005714416504
generate_one_block  0.6127927303314209
generate_one_block  0.6063382625579834
generate_one_block  0.601806640625
generate_one_block  0.6019794940948486
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12274312973022461  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

connection checking time:  17.78298330307007
block generation total time  15.421515464782715
average batch blocks generation time:  0.9638447165489197
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09774065017700195  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7763533592224121  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09732246398925781  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7627711296081543  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0973973274230957  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7644495964050293  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09763383865356445  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7752504348754883  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0972752571105957  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7626795768737793  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09735631942749023  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.763709545135498  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09763002395629883  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7755393981933594  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0977025032043457  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7751431465148926  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09751033782958984  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7702546119689941  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09763622283935547  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7699971199035645  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09755659103393555  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.770848274230957  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09724903106689453  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7615971565246582  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09768056869506836  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7763791084289551  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09732341766357422  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.763239860534668  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09746360778808594  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7717938423156738  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09759807586669922  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7698454856872559  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06728026270866394 |0.017272844910621643 |0.003914818167686462 |9.857118129730225e-05 |0.0036166757345199585 |0.0031549930572509766 |
----------------------------------------------------------pseudo_mini_loss sum 1.6381120681762695
 Run 0| Epoch 9 |
Number of nodes for computation during this epoch:  5321938
Number of first layer input nodes during this epoch:  2510736
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12351369857788086  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02412271499633789
random selection method range initialization spend 0.0057909488677978516
time for parepare:  0.021343231201171875
local_output_nid generation:  0.0023581981658935547
local_in_edges_tensor generation:  0.006445407867431641
mini_batch_src_global generation:  0.0022606849670410156
r_  generation:  0.02202749252319336
local_output_nid generation:  0.0029294490814208984
local_in_edges_tensor generation:  0.0019183158874511719
mini_batch_src_global generation:  0.0023314952850341797
r_  generation:  0.02297043800354004
local_output_nid generation:  0.002986431121826172
local_in_edges_tensor generation:  0.0017046928405761719
mini_batch_src_global generation:  0.0017445087432861328
r_  generation:  0.02247905731201172
local_output_nid generation:  0.003035306930541992
local_in_edges_tensor generation:  0.0017123222351074219
mini_batch_src_global generation:  0.0017697811126708984
r_  generation:  0.02191925048828125
local_output_nid generation:  0.0030138492584228516
local_in_edges_tensor generation:  0.0016422271728515625
mini_batch_src_global generation:  0.0017871856689453125
r_  generation:  0.02267909049987793
local_output_nid generation:  0.0030040740966796875
local_in_edges_tensor generation:  0.0016143321990966797
mini_batch_src_global generation:  0.0017380714416503906
r_  generation:  0.021811962127685547
local_output_nid generation:  0.0029778480529785156
local_in_edges_tensor generation:  0.0016298294067382812
mini_batch_src_global generation:  0.00177001953125
r_  generation:  0.022401094436645508
local_output_nid generation:  0.0030667781829833984
local_in_edges_tensor generation:  0.0015625953674316406
mini_batch_src_global generation:  0.0017719268798828125
r_  generation:  0.022258996963500977
local_output_nid generation:  0.002969503402709961
local_in_edges_tensor generation:  0.0016133785247802734
mini_batch_src_global generation:  0.0017440319061279297
r_  generation:  0.022651195526123047
local_output_nid generation:  0.0030977725982666016
local_in_edges_tensor generation:  0.0016739368438720703
mini_batch_src_global generation:  0.0018093585968017578
r_  generation:  0.02253580093383789
local_output_nid generation:  0.003023386001586914
local_in_edges_tensor generation:  0.0016164779663085938
mini_batch_src_global generation:  0.0017666816711425781
r_  generation:  0.022720813751220703
local_output_nid generation:  0.002999544143676758
local_in_edges_tensor generation:  0.0016574859619140625
mini_batch_src_global generation:  0.0017707347869873047
r_  generation:  0.022483348846435547
local_output_nid generation:  0.0030622482299804688
local_in_edges_tensor generation:  0.001543283462524414
mini_batch_src_global generation:  0.0017554759979248047
r_  generation:  0.023116588592529297
local_output_nid generation:  0.0030062198638916016
local_in_edges_tensor generation:  0.0016355514526367188
mini_batch_src_global generation:  0.0017735958099365234
r_  generation:  0.022211074829101562
local_output_nid generation:  0.003053426742553711
local_in_edges_tensor generation:  0.001638174057006836
mini_batch_src_global generation:  0.001798391342163086
r_  generation:  0.022724151611328125
local_output_nid generation:  0.0029935836791992188
local_in_edges_tensor generation:  0.0015521049499511719
mini_batch_src_global generation:  0.001809835433959961
r_  generation:  0.02275991439819336
----------------------check_connections_block total spend ----------------------------- 0.5796527862548828
generate_one_block  0.031266212463378906
generate_one_block  0.032113075256347656
generate_one_block  0.03159284591674805
generate_one_block  0.03133559226989746
generate_one_block  0.032241106033325195
generate_one_block  0.03348517417907715
generate_one_block  0.031697750091552734
generate_one_block  0.030951738357543945
generate_one_block  0.031238079071044922
generate_one_block  0.03220391273498535
generate_one_block  0.03106832504272461
generate_one_block  0.03143954277038574
generate_one_block  0.03163003921508789
generate_one_block  0.031036853790283203
generate_one_block  0.03174090385437012
generate_one_block  0.032843589782714844
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03398013114929199
gen group dst list time:  0.018679380416870117
time for parepare:  0.019420146942138672
local_output_nid generation:  0.00942373275756836
local_in_edges_tensor generation:  0.026722192764282227
mini_batch_src_global generation:  0.027047157287597656
r_  generation:  0.25960659980773926
local_output_nid generation:  0.013404607772827148
local_in_edges_tensor generation:  0.020951271057128906
mini_batch_src_global generation:  0.033661603927612305
r_  generation:  0.2682819366455078
local_output_nid generation:  0.013470649719238281
local_in_edges_tensor generation:  0.015044450759887695
mini_batch_src_global generation:  0.03300189971923828
r_  generation:  0.27166032791137695
local_output_nid generation:  0.015460014343261719
local_in_edges_tensor generation:  0.014677047729492188
mini_batch_src_global generation:  0.03270602226257324
r_  generation:  0.2774677276611328
local_output_nid generation:  0.014374971389770508
local_in_edges_tensor generation:  0.017163515090942383
mini_batch_src_global generation:  0.03638482093811035
r_  generation:  0.2829599380493164
local_output_nid generation:  0.013698816299438477
local_in_edges_tensor generation:  0.020604372024536133
mini_batch_src_global generation:  0.03399181365966797
r_  generation:  0.27222752571105957
local_output_nid generation:  0.013982534408569336
local_in_edges_tensor generation:  0.020097732543945312
mini_batch_src_global generation:  0.035537004470825195
r_  generation:  0.27994346618652344
local_output_nid generation:  0.015071630477905273
local_in_edges_tensor generation:  0.016225576400756836
mini_batch_src_global generation:  0.03503537178039551
r_  generation:  0.2875351905822754
local_output_nid generation:  0.016446352005004883
local_in_edges_tensor generation:  0.01890254020690918
mini_batch_src_global generation:  0.03445768356323242
r_  generation:  0.27103185653686523
local_output_nid generation:  0.014502525329589844
local_in_edges_tensor generation:  0.01799297332763672
mini_batch_src_global generation:  0.035726070404052734
r_  generation:  0.27982044219970703
local_output_nid generation:  0.013789892196655273
local_in_edges_tensor generation:  0.014509916305541992
mini_batch_src_global generation:  0.035585880279541016
r_  generation:  0.27105164527893066
local_output_nid generation:  0.014466285705566406
local_in_edges_tensor generation:  0.014364242553710938
mini_batch_src_global generation:  0.035802602767944336
r_  generation:  0.2784254550933838
local_output_nid generation:  0.01467752456665039
local_in_edges_tensor generation:  0.0196688175201416
mini_batch_src_global generation:  0.036452293395996094
r_  generation:  0.2776656150817871
local_output_nid generation:  0.013849020004272461
local_in_edges_tensor generation:  0.01659679412841797
mini_batch_src_global generation:  0.03444242477416992
r_  generation:  0.2831251621246338
local_output_nid generation:  0.013733386993408203
local_in_edges_tensor generation:  0.014824628829956055
mini_batch_src_global generation:  0.03510165214538574
r_  generation:  0.2832508087158203
local_output_nid generation:  0.01363372802734375
local_in_edges_tensor generation:  0.019248008728027344
mini_batch_src_global generation:  0.03495907783508301
r_  generation:  0.28378820419311523
----------------------check_connections_block total spend ----------------------------- 6.446957349777222
generate_one_block  0.3755629062652588
generate_one_block  0.3565032482147217
generate_one_block  0.35892295837402344
generate_one_block  0.3584258556365967
generate_one_block  0.3654334545135498
generate_one_block  0.35379886627197266
generate_one_block  0.3885321617126465
generate_one_block  0.34696054458618164
generate_one_block  0.34679341316223145
generate_one_block  0.36713695526123047
generate_one_block  0.3550279140472412
generate_one_block  0.36135387420654297
generate_one_block  0.3583807945251465
generate_one_block  0.3506886959075928
generate_one_block  0.3610813617706299
generate_one_block  0.364670991897583
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.037508487701416016
gen group dst list time:  0.06755781173706055
time for parepare:  0.019309520721435547
local_output_nid generation:  0.028745412826538086
local_in_edges_tensor generation:  0.058362722396850586
mini_batch_src_global generation:  0.04411458969116211
r_  generation:  0.46358776092529297
local_output_nid generation:  0.033583879470825195
local_in_edges_tensor generation:  0.041971683502197266
mini_batch_src_global generation:  0.05559945106506348
r_  generation:  0.46532249450683594
local_output_nid generation:  0.033490896224975586
local_in_edges_tensor generation:  0.030942201614379883
mini_batch_src_global generation:  0.0517725944519043
r_  generation:  0.47648048400878906
local_output_nid generation:  0.03314042091369629
local_in_edges_tensor generation:  0.0342254638671875
mini_batch_src_global generation:  0.05405235290527344
r_  generation:  0.4721348285675049
local_output_nid generation:  0.033448219299316406
local_in_edges_tensor generation:  0.08204817771911621
mini_batch_src_global generation:  0.052449703216552734
r_  generation:  0.4791240692138672
local_output_nid generation:  0.033048152923583984
local_in_edges_tensor generation:  0.034537315368652344
mini_batch_src_global generation:  0.05461549758911133
r_  generation:  0.4862980842590332
local_output_nid generation:  0.032898664474487305
local_in_edges_tensor generation:  0.036031246185302734
mini_batch_src_global generation:  0.054711103439331055
r_  generation:  0.4955317974090576
local_output_nid generation:  0.036133766174316406
local_in_edges_tensor generation:  0.038732051849365234
mini_batch_src_global generation:  0.05635666847229004
r_  generation:  0.4807562828063965
local_output_nid generation:  0.0342099666595459
local_in_edges_tensor generation:  0.03253340721130371
mini_batch_src_global generation:  0.055318593978881836
r_  generation:  0.4809870719909668
local_output_nid generation:  0.034201860427856445
local_in_edges_tensor generation:  0.03280138969421387
mini_batch_src_global generation:  0.05428004264831543
r_  generation:  0.4822711944580078
local_output_nid generation:  0.03387761116027832
local_in_edges_tensor generation:  0.031467437744140625
mini_batch_src_global generation:  0.05310487747192383
r_  generation:  0.47756528854370117
local_output_nid generation:  0.03413677215576172
local_in_edges_tensor generation:  0.03093886375427246
mini_batch_src_global generation:  0.055701255798339844
r_  generation:  0.4905736446380615
local_output_nid generation:  0.03434276580810547
local_in_edges_tensor generation:  0.03252601623535156
mini_batch_src_global generation:  0.05348348617553711
r_  generation:  0.4829256534576416
local_output_nid generation:  0.03402447700500488
local_in_edges_tensor generation:  0.03261828422546387
mini_batch_src_global generation:  0.05460858345031738
r_  generation:  0.4843308925628662
local_output_nid generation:  0.034039974212646484
local_in_edges_tensor generation:  0.035507917404174805
mini_batch_src_global generation:  0.05370807647705078
r_  generation:  0.4830899238586426
local_output_nid generation:  0.03523731231689453
local_in_edges_tensor generation:  0.032880306243896484
mini_batch_src_global generation:  0.055197954177856445
r_  generation:  0.48883962631225586
----------------------check_connections_block total spend ----------------------------- 11.429598331451416
generate_one_block  0.6050190925598145
generate_one_block  0.6036434173583984
generate_one_block  0.6079232692718506
generate_one_block  0.596027135848999
generate_one_block  0.5975034236907959
generate_one_block  0.5907077789306641
generate_one_block  0.5988516807556152
generate_one_block  0.6006839275360107
generate_one_block  0.6669268608093262
generate_one_block  0.6031398773193359
generate_one_block  0.5988492965698242
generate_one_block  0.6061763763427734
generate_one_block  0.6044857501983643
generate_one_block  0.6080608367919922
generate_one_block  0.60721755027771
generate_one_block  0.6121885776519775
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12351369857788086  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

connection checking time:  17.876555681228638
block generation total time  15.476678848266602
average batch blocks generation time:  0.9672924280166626
block dataloader generation time/epoch 35.57536506652832
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09759855270385742  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.774566650390625  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09760904312133789  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7719182968139648  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09761285781860352  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7713732719421387  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09738636016845703  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7646045684814453  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09761857986450195  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7727346420288086  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09722423553466797  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7602176666259766  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0972757339477539  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7627582550048828  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09729528427124023  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7642908096313477  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09746074676513672  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7682251930236816  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0975809097290039  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7745089530944824  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09728860855102539  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7650508880615234  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09757518768310547  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7722563743591309  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09757518768310547  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7712702751159668  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09738779067993164  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7686715126037598  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09736394882202148  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7662463188171387  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09762239456176758  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7721242904663086  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06139837205410004 |0.015236184000968933 |0.0037720799446105957 |0.00010007619857788086 |0.003238007426261902 |0.0017342567443847656 |
----------------------------------------------------------pseudo_mini_loss sum 1.597403645515442
Total (block generation + training)time/epoch 36.9835422039032
Training time/epoch 1.4077670574188232
Training time without block to device /epoch 1.1639881134033203
Training time without total dataloading part /epoch 0.11549687385559082
load block tensor time/epoch 0.9823739528656006
block to device time/epoch 0.24377894401550293
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 10 |
Number of nodes for computation during this epoch:  5319626
Number of first layer input nodes during this epoch:  2509612
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.1236104965209961  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022968053817749023
random selection method range initialization spend 0.005414485931396484
time for parepare:  0.018334150314331055
local_output_nid generation:  0.002413034439086914
local_in_edges_tensor generation:  0.004449605941772461
mini_batch_src_global generation:  0.0017800331115722656
r_  generation:  0.02144932746887207
local_output_nid generation:  0.002989053726196289
local_in_edges_tensor generation:  0.0017156600952148438
mini_batch_src_global generation:  0.0020456314086914062
r_  generation:  0.030719518661499023
local_output_nid generation:  0.00492405891418457
local_in_edges_tensor generation:  0.0024385452270507812
mini_batch_src_global generation:  0.0043108463287353516
r_  generation:  0.024125337600708008
local_output_nid generation:  0.003001689910888672
local_in_edges_tensor generation:  0.0017266273498535156
mini_batch_src_global generation:  0.0018341541290283203
r_  generation:  0.022199392318725586
local_output_nid generation:  0.0031490325927734375
local_in_edges_tensor generation:  0.001644134521484375
mini_batch_src_global generation:  0.0024912357330322266
r_  generation:  0.029367923736572266
local_output_nid generation:  0.004603147506713867
local_in_edges_tensor generation:  0.002338409423828125
mini_batch_src_global generation:  0.002251148223876953
r_  generation:  0.024790525436401367
local_output_nid generation:  0.004412412643432617
local_in_edges_tensor generation:  0.002194643020629883
mini_batch_src_global generation:  0.0022809505462646484
r_  generation:  0.02396845817565918
local_output_nid generation:  0.004384756088256836
local_in_edges_tensor generation:  0.002109527587890625
mini_batch_src_global generation:  0.0023345947265625
r_  generation:  0.024759769439697266
local_output_nid generation:  0.004392385482788086
local_in_edges_tensor generation:  0.0021371841430664062
mini_batch_src_global generation:  0.00663304328918457
r_  generation:  0.02526068687438965
local_output_nid generation:  0.004413604736328125
local_in_edges_tensor generation:  0.0023665428161621094
mini_batch_src_global generation:  0.0023081302642822266
r_  generation:  0.024552583694458008
local_output_nid generation:  0.0044209957122802734
local_in_edges_tensor generation:  0.002171039581298828
mini_batch_src_global generation:  0.002242565155029297
r_  generation:  0.029639244079589844
local_output_nid generation:  0.004462242126464844
local_in_edges_tensor generation:  0.002161741256713867
mini_batch_src_global generation:  0.001889944076538086
r_  generation:  0.0228116512298584
local_output_nid generation:  0.004470348358154297
local_in_edges_tensor generation:  0.002089262008666992
mini_batch_src_global generation:  0.0018384456634521484
r_  generation:  0.022875547409057617
local_output_nid generation:  0.00439000129699707
local_in_edges_tensor generation:  0.0021033287048339844
mini_batch_src_global generation:  0.003927469253540039
r_  generation:  0.022677898406982422
local_output_nid generation:  0.00451207160949707
local_in_edges_tensor generation:  0.002093791961669922
mini_batch_src_global generation:  0.0019130706787109375
r_  generation:  0.022885799407958984
local_output_nid generation:  0.004971742630004883
local_in_edges_tensor generation:  0.0022182464599609375
mini_batch_src_global generation:  0.009666919708251953
r_  generation:  0.023601055145263672
----------------------check_connections_block total spend ----------------------------- 0.6835169792175293
generate_one_block  0.03930473327636719
generate_one_block  0.0319676399230957
generate_one_block  0.03273653984069824
generate_one_block  0.03159451484680176
generate_one_block  0.030272483825683594
generate_one_block  0.036067962646484375
generate_one_block  0.03095102310180664
generate_one_block  0.03393101692199707
generate_one_block  0.03644609451293945
generate_one_block  0.032019853591918945
generate_one_block  0.0316927433013916
generate_one_block  0.03302741050720215
generate_one_block  0.034986019134521484
generate_one_block  0.03517866134643555
generate_one_block  0.03584766387939453
generate_one_block  0.032712697982788086
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04007124900817871
gen group dst list time:  0.01904439926147461
time for parepare:  0.022797822952270508
local_output_nid generation:  0.009725093841552734
local_in_edges_tensor generation:  0.02701544761657715
mini_batch_src_global generation:  0.02674412727355957
r_  generation:  0.2562720775604248
local_output_nid generation:  0.013175249099731445
local_in_edges_tensor generation:  0.019104480743408203
mini_batch_src_global generation:  0.033397674560546875
r_  generation:  0.2666904926300049
local_output_nid generation:  0.013196945190429688
local_in_edges_tensor generation:  0.019715309143066406
mini_batch_src_global generation:  0.03276991844177246
r_  generation:  0.27101826667785645
local_output_nid generation:  0.013975858688354492
local_in_edges_tensor generation:  0.022128582000732422
mini_batch_src_global generation:  0.03376317024230957
r_  generation:  0.2876119613647461
local_output_nid generation:  0.016014575958251953
local_in_edges_tensor generation:  0.01865553855895996
mini_batch_src_global generation:  0.034238338470458984
r_  generation:  0.26829051971435547
local_output_nid generation:  0.013946771621704102
local_in_edges_tensor generation:  0.014542818069458008
mini_batch_src_global generation:  0.03390216827392578
r_  generation:  0.29128217697143555
local_output_nid generation:  0.014115095138549805
local_in_edges_tensor generation:  0.014926910400390625
mini_batch_src_global generation:  0.03406262397766113
r_  generation:  0.2737398147583008
local_output_nid generation:  0.014407634735107422
local_in_edges_tensor generation:  0.015336990356445312
mini_batch_src_global generation:  0.03424549102783203
r_  generation:  0.27800846099853516
local_output_nid generation:  0.015444040298461914
local_in_edges_tensor generation:  0.01914358139038086
mini_batch_src_global generation:  0.03640389442443848
r_  generation:  0.2805638313293457
local_output_nid generation:  0.014195919036865234
local_in_edges_tensor generation:  0.01797008514404297
mini_batch_src_global generation:  0.03506922721862793
r_  generation:  0.2734954357147217
local_output_nid generation:  0.015350818634033203
local_in_edges_tensor generation:  0.01688241958618164
mini_batch_src_global generation:  0.03405618667602539
r_  generation:  0.27612733840942383
local_output_nid generation:  0.014404058456420898
local_in_edges_tensor generation:  0.020352602005004883
mini_batch_src_global generation:  0.03622746467590332
r_  generation:  0.281109094619751
local_output_nid generation:  0.014435291290283203
local_in_edges_tensor generation:  0.016468048095703125
mini_batch_src_global generation:  0.03605222702026367
r_  generation:  0.2819216251373291
local_output_nid generation:  0.013596296310424805
local_in_edges_tensor generation:  0.01532602310180664
mini_batch_src_global generation:  0.03610873222351074
r_  generation:  0.28361940383911133
local_output_nid generation:  0.015889406204223633
local_in_edges_tensor generation:  0.020029067993164062
mini_batch_src_global generation:  0.038252830505371094
r_  generation:  0.2811300754547119
local_output_nid generation:  0.01354217529296875
local_in_edges_tensor generation:  0.016558170318603516
mini_batch_src_global generation:  0.035030364990234375
r_  generation:  0.27576327323913574
----------------------check_connections_block total spend ----------------------------- 6.451506614685059
generate_one_block  0.3654611110687256
generate_one_block  0.3498198986053467
generate_one_block  0.3640017509460449
generate_one_block  0.36196446418762207
generate_one_block  0.3482396602630615
generate_one_block  0.35497379302978516
generate_one_block  0.3769805431365967
generate_one_block  0.35835719108581543
generate_one_block  0.3632967472076416
generate_one_block  0.35141944885253906
generate_one_block  0.3483703136444092
generate_one_block  0.36641597747802734
generate_one_block  0.3639955520629883
generate_one_block  0.34926342964172363
generate_one_block  0.3639359474182129
generate_one_block  0.35619544982910156
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03451132774353027
gen group dst list time:  0.06691741943359375
time for parepare:  0.019528865814208984
local_output_nid generation:  0.02881026268005371
local_in_edges_tensor generation:  0.05593729019165039
mini_batch_src_global generation:  0.04150724411010742
r_  generation:  0.4629247188568115
local_output_nid generation:  0.03351473808288574
local_in_edges_tensor generation:  0.03871726989746094
mini_batch_src_global generation:  0.05387735366821289
r_  generation:  0.47135257720947266
local_output_nid generation:  0.03621196746826172
local_in_edges_tensor generation:  0.033745527267456055
mini_batch_src_global generation:  0.054750680923461914
r_  generation:  0.47261571884155273
local_output_nid generation:  0.0343165397644043
local_in_edges_tensor generation:  0.03311419486999512
mini_batch_src_global generation:  0.05209541320800781
r_  generation:  0.4662435054779053
local_output_nid generation:  0.03398585319519043
local_in_edges_tensor generation:  0.08568644523620605
mini_batch_src_global generation:  0.0518643856048584
r_  generation:  0.4786231517791748
local_output_nid generation:  0.03311276435852051
local_in_edges_tensor generation:  0.032621145248413086
mini_batch_src_global generation:  0.08181428909301758
r_  generation:  0.47302675247192383
local_output_nid generation:  0.032981157302856445
local_in_edges_tensor generation:  0.03367328643798828
mini_batch_src_global generation:  0.052822113037109375
r_  generation:  0.4828360080718994
local_output_nid generation:  0.03314948081970215
local_in_edges_tensor generation:  0.03387141227722168
mini_batch_src_global generation:  0.056023359298706055
r_  generation:  0.47736597061157227
local_output_nid generation:  0.03425431251525879
local_in_edges_tensor generation:  0.03360724449157715
mini_batch_src_global generation:  0.05339312553405762
r_  generation:  0.48783397674560547
local_output_nid generation:  0.03337907791137695
local_in_edges_tensor generation:  0.03297924995422363
mini_batch_src_global generation:  0.054506540298461914
r_  generation:  0.475999116897583
local_output_nid generation:  0.03389120101928711
local_in_edges_tensor generation:  0.0375971794128418
mini_batch_src_global generation:  0.053212642669677734
r_  generation:  0.483487606048584
local_output_nid generation:  0.033377885818481445
local_in_edges_tensor generation:  0.039919137954711914
mini_batch_src_global generation:  0.054575204849243164
r_  generation:  0.4795360565185547
local_output_nid generation:  0.033808231353759766
local_in_edges_tensor generation:  0.03093743324279785
mini_batch_src_global generation:  0.05369305610656738
r_  generation:  0.4873626232147217
local_output_nid generation:  0.0333712100982666
local_in_edges_tensor generation:  0.03250908851623535
mini_batch_src_global generation:  0.054262638092041016
r_  generation:  0.4731101989746094
local_output_nid generation:  0.033663272857666016
local_in_edges_tensor generation:  0.03288912773132324
mini_batch_src_global generation:  0.05416154861450195
r_  generation:  0.4938979148864746
local_output_nid generation:  0.03354215621948242
local_in_edges_tensor generation:  0.032943010330200195
mini_batch_src_global generation:  0.055449724197387695
r_  generation:  0.4808685779571533
----------------------check_connections_block total spend ----------------------------- 11.39909815788269
generate_one_block  0.6156246662139893
generate_one_block  0.598869800567627
generate_one_block  0.5964529514312744
generate_one_block  0.6049482822418213
generate_one_block  0.6046109199523926
generate_one_block  0.5972981452941895
generate_one_block  0.5983970165252686
generate_one_block  0.6051287651062012
generate_one_block  0.6363310813903809
generate_one_block  0.6004433631896973
generate_one_block  0.5951166152954102
generate_one_block  0.6051681041717529
generate_one_block  0.6243448257446289
generate_one_block  0.5910377502441406
generate_one_block  0.6034824848175049
generate_one_block  0.5987637042999268
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.1236104965209961  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

connection checking time:  17.85060477256775
block generation total time  15.418709754943848
average batch blocks generation time:  0.9636693596839905
block dataloader generation time/epoch 35.59887444972992
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09752082824707031  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7665176391601562  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09754133224487305  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.770927906036377  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09732341766357422  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7659239768981934  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09746551513671875  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7715649604797363  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09720134735107422  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7604131698608398  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09746408462524414  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7665786743164062  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09719610214233398  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7606029510498047  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09753847122192383  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7710199356079102  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09743261337280273  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7707343101501465  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09746837615966797  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7677326202392578  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09741067886352539  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7675080299377441  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09772825241088867  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7761106491088867  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09777021408081055  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7751202583312988  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09729480743408203  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7646822929382324  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09775781631469727  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7761950492858887  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09740924835205078  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.766273021697998  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06556205451488495 |0.014656782150268555 |0.003946751356124878 |0.00010067224502563477 |0.0036292821168899536 |0.0016055107116699219 |
----------------------------------------------------------pseudo_mini_loss sum 1.559963345527649
Total (block generation + training)time/epoch 37.039576172828674
Training time/epoch 1.4729456901550293
Training time without block to device /epoch 1.2384371757507324
Training time without total dataloading part /epoch 0.12443280220031738
load block tensor time/epoch 1.0489928722381592
block to device time/epoch 0.23450851440429688
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 11 |
Number of nodes for computation during this epoch:  5319722
Number of first layer input nodes during this epoch:  2509516
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12335348129272461  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025528669357299805
random selection method range initialization spend 0.005392551422119141
time for parepare:  0.020671606063842773
local_output_nid generation:  0.0023162364959716797
local_in_edges_tensor generation:  0.007587432861328125
mini_batch_src_global generation:  0.0017137527465820312
r_  generation:  0.02015376091003418
local_output_nid generation:  0.002866506576538086
local_in_edges_tensor generation:  0.0017254352569580078
mini_batch_src_global generation:  0.0021038055419921875
r_  generation:  0.022852659225463867
local_output_nid generation:  0.002993345260620117
local_in_edges_tensor generation:  0.0016515254974365234
mini_batch_src_global generation:  0.0017359256744384766
r_  generation:  0.022147655487060547
local_output_nid generation:  0.002958059310913086
local_in_edges_tensor generation:  0.001651763916015625
mini_batch_src_global generation:  0.0018243789672851562
r_  generation:  0.02260756492614746
local_output_nid generation:  0.002998828887939453
local_in_edges_tensor generation:  0.0016529560089111328
mini_batch_src_global generation:  0.0017957687377929688
r_  generation:  0.021620512008666992
local_output_nid generation:  0.0030527114868164062
local_in_edges_tensor generation:  0.001667022705078125
mini_batch_src_global generation:  0.0017931461334228516
r_  generation:  0.022325992584228516
local_output_nid generation:  0.0030422210693359375
local_in_edges_tensor generation:  0.001650094985961914
mini_batch_src_global generation:  0.0018200874328613281
r_  generation:  0.022531747817993164
local_output_nid generation:  0.0030672550201416016
local_in_edges_tensor generation:  0.0016579627990722656
mini_batch_src_global generation:  0.0018007755279541016
r_  generation:  0.021840333938598633
local_output_nid generation:  0.0029997825622558594
local_in_edges_tensor generation:  0.0016214847564697266
mini_batch_src_global generation:  0.0018146038055419922
r_  generation:  0.022754192352294922
local_output_nid generation:  0.0030088424682617188
local_in_edges_tensor generation:  0.0016422271728515625
mini_batch_src_global generation:  0.0018336772918701172
r_  generation:  0.02258443832397461
local_output_nid generation:  0.003033876419067383
local_in_edges_tensor generation:  0.0016541481018066406
mini_batch_src_global generation:  0.001863241195678711
r_  generation:  0.022970199584960938
local_output_nid generation:  0.0030317306518554688
local_in_edges_tensor generation:  0.0016372203826904297
mini_batch_src_global generation:  0.0018565654754638672
r_  generation:  0.02236652374267578
local_output_nid generation:  0.0030896663665771484
local_in_edges_tensor generation:  0.001628875732421875
mini_batch_src_global generation:  0.0018389225006103516
r_  generation:  0.022698402404785156
local_output_nid generation:  0.0030214786529541016
local_in_edges_tensor generation:  0.0015494823455810547
mini_batch_src_global generation:  0.0018596649169921875
r_  generation:  0.02286696434020996
local_output_nid generation:  0.0030546188354492188
local_in_edges_tensor generation:  0.0015981197357177734
mini_batch_src_global generation:  0.0018334388732910156
r_  generation:  0.022153139114379883
local_output_nid generation:  0.003008604049682617
local_in_edges_tensor generation:  0.0017025470733642578
mini_batch_src_global generation:  0.0017952919006347656
r_  generation:  0.022321701049804688
----------------------check_connections_block total spend ----------------------------- 0.5781970024108887
generate_one_block  0.030428409576416016
generate_one_block  0.03175210952758789
generate_one_block  0.03139376640319824
generate_one_block  0.03240466117858887
generate_one_block  0.031215429306030273
generate_one_block  0.0340421199798584
generate_one_block  0.031519174575805664
generate_one_block  0.030644655227661133
generate_one_block  0.03203415870666504
generate_one_block  0.03168845176696777
generate_one_block  0.03146934509277344
generate_one_block  0.031414031982421875
generate_one_block  0.03184652328491211
generate_one_block  0.03218340873718262
generate_one_block  0.030709505081176758
generate_one_block  0.03163790702819824
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03752589225769043
gen group dst list time:  0.01801013946533203
time for parepare:  0.01954340934753418
local_output_nid generation:  0.009101629257202148
local_in_edges_tensor generation:  0.023864269256591797
mini_batch_src_global generation:  0.025760650634765625
r_  generation:  0.24346518516540527
local_output_nid generation:  0.013716459274291992
local_in_edges_tensor generation:  0.019990921020507812
mini_batch_src_global generation:  0.0336756706237793
r_  generation:  0.26421427726745605
local_output_nid generation:  0.013264179229736328
local_in_edges_tensor generation:  0.018973588943481445
mini_batch_src_global generation:  0.03256726264953613
r_  generation:  0.26373744010925293
local_output_nid generation:  0.01411747932434082
local_in_edges_tensor generation:  0.016629457473754883
mini_batch_src_global generation:  0.03805804252624512
r_  generation:  0.2767002582550049
local_output_nid generation:  0.013907909393310547
local_in_edges_tensor generation:  0.01445627212524414
mini_batch_src_global generation:  0.041441917419433594
r_  generation:  0.28032755851745605
local_output_nid generation:  0.015150308609008789
local_in_edges_tensor generation:  0.01806950569152832
mini_batch_src_global generation:  0.033582210540771484
r_  generation:  0.2704505920410156
local_output_nid generation:  0.014441490173339844
local_in_edges_tensor generation:  0.014653205871582031
mini_batch_src_global generation:  0.034407615661621094
r_  generation:  0.2780191898345947
local_output_nid generation:  0.014106512069702148
local_in_edges_tensor generation:  0.014886856079101562
mini_batch_src_global generation:  0.033727407455444336
r_  generation:  0.26419878005981445
local_output_nid generation:  0.014423370361328125
local_in_edges_tensor generation:  0.014451265335083008
mini_batch_src_global generation:  0.0346829891204834
r_  generation:  0.2797398567199707
local_output_nid generation:  0.014460563659667969
local_in_edges_tensor generation:  0.016726970672607422
mini_batch_src_global generation:  0.03604245185852051
r_  generation:  0.27924656867980957
local_output_nid generation:  0.013960123062133789
local_in_edges_tensor generation:  0.014461040496826172
mini_batch_src_global generation:  0.03482961654663086
r_  generation:  0.2798137664794922
local_output_nid generation:  0.014295578002929688
local_in_edges_tensor generation:  0.01384115219116211
mini_batch_src_global generation:  0.03424978256225586
r_  generation:  0.27506065368652344
local_output_nid generation:  0.01454925537109375
local_in_edges_tensor generation:  0.01445627212524414
mini_batch_src_global generation:  0.03523063659667969
r_  generation:  0.2828526496887207
local_output_nid generation:  0.014451026916503906
local_in_edges_tensor generation:  0.014175176620483398
mini_batch_src_global generation:  0.03670477867126465
r_  generation:  0.2817401885986328
local_output_nid generation:  0.013606071472167969
local_in_edges_tensor generation:  0.01426839828491211
mini_batch_src_global generation:  0.03472185134887695
r_  generation:  0.2768697738647461
local_output_nid generation:  0.013651132583618164
local_in_edges_tensor generation:  0.014704465866088867
mini_batch_src_global generation:  0.03468680381774902
r_  generation:  0.27883124351501465
----------------------check_connections_block total spend ----------------------------- 6.355420351028442
generate_one_block  0.3496735095977783
generate_one_block  0.36272573471069336
generate_one_block  0.35413455963134766
generate_one_block  0.3629317283630371
generate_one_block  0.35318470001220703
generate_one_block  0.35222506523132324
generate_one_block  0.3868281841278076
generate_one_block  0.34451746940612793
generate_one_block  0.3596498966217041
generate_one_block  0.36542391777038574
generate_one_block  0.3583073616027832
generate_one_block  0.35562682151794434
generate_one_block  0.3641369342803955
generate_one_block  0.36454224586486816
generate_one_block  0.3550877571105957
generate_one_block  0.3567330837249756
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03446173667907715
gen group dst list time:  0.07137513160705566
time for parepare:  0.01927471160888672
local_output_nid generation:  0.02859187126159668
local_in_edges_tensor generation:  0.049184560775756836
mini_batch_src_global generation:  0.041336774826049805
r_  generation:  0.45728564262390137
local_output_nid generation:  0.033104896545410156
local_in_edges_tensor generation:  0.038416385650634766
mini_batch_src_global generation:  0.05381894111633301
r_  generation:  0.46202993392944336
local_output_nid generation:  0.03324413299560547
local_in_edges_tensor generation:  0.0345759391784668
mini_batch_src_global generation:  0.053528785705566406
r_  generation:  0.4721062183380127
local_output_nid generation:  0.03532981872558594
local_in_edges_tensor generation:  0.03503823280334473
mini_batch_src_global generation:  0.05236697196960449
r_  generation:  0.47003674507141113
local_output_nid generation:  0.03300809860229492
local_in_edges_tensor generation:  0.0735921859741211
mini_batch_src_global generation:  0.06323385238647461
r_  generation:  0.4833226203918457
local_output_nid generation:  0.03295159339904785
local_in_edges_tensor generation:  0.030529022216796875
mini_batch_src_global generation:  0.056012868881225586
r_  generation:  0.4759082794189453
local_output_nid generation:  0.03449392318725586
local_in_edges_tensor generation:  0.04047131538391113
mini_batch_src_global generation:  0.0558927059173584
r_  generation:  0.4861636161804199
local_output_nid generation:  0.0355830192565918
local_in_edges_tensor generation:  0.03118729591369629
mini_batch_src_global generation:  0.05658721923828125
r_  generation:  0.481121301651001
local_output_nid generation:  0.03308439254760742
local_in_edges_tensor generation:  0.03269481658935547
mini_batch_src_global generation:  0.06088590621948242
r_  generation:  0.48682689666748047
local_output_nid generation:  0.03333091735839844
local_in_edges_tensor generation:  0.03203320503234863
mini_batch_src_global generation:  0.05810880661010742
r_  generation:  0.4822850227355957
local_output_nid generation:  0.03354001045227051
local_in_edges_tensor generation:  0.032688140869140625
mini_batch_src_global generation:  0.055982112884521484
r_  generation:  0.48685455322265625
local_output_nid generation:  0.03544807434082031
local_in_edges_tensor generation:  0.03958940505981445
mini_batch_src_global generation:  0.05475163459777832
r_  generation:  0.4783344268798828
local_output_nid generation:  0.033797502517700195
local_in_edges_tensor generation:  0.03708291053771973
mini_batch_src_global generation:  0.05545186996459961
r_  generation:  0.48189425468444824
local_output_nid generation:  0.033605337142944336
local_in_edges_tensor generation:  0.03354692459106445
mini_batch_src_global generation:  0.055110931396484375
r_  generation:  0.47293615341186523
local_output_nid generation:  0.03327584266662598
local_in_edges_tensor generation:  0.03067755699157715
mini_batch_src_global generation:  0.05352354049682617
r_  generation:  0.48116064071655273
local_output_nid generation:  0.03343605995178223
local_in_edges_tensor generation:  0.03230643272399902
mini_batch_src_global generation:  0.06837034225463867
r_  generation:  0.47733092308044434
----------------------check_connections_block total spend ----------------------------- 11.389126300811768
generate_one_block  0.6066186428070068
generate_one_block  0.5987520217895508
generate_one_block  0.6021215915679932
generate_one_block  0.6039788722991943
generate_one_block  0.5937492847442627
generate_one_block  0.596240758895874
generate_one_block  0.6066579818725586
generate_one_block  0.6122758388519287
generate_one_block  0.6745727062225342
generate_one_block  0.6142270565032959
generate_one_block  0.6072969436645508
generate_one_block  0.603416919708252
generate_one_block  0.6051545143127441
generate_one_block  0.6000149250030518
generate_one_block  0.6016659736633301
generate_one_block  0.6082565784454346
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12335348129272461  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

connection checking time:  17.74454665184021
block generation total time  15.480729579925537
average batch blocks generation time:  0.9675455987453461
block dataloader generation time/epoch 35.54576460520426
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09707260131835938  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7596616744995117  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09756135940551758  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7713761329650879  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09764337539672852  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.771298885345459  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0978536605834961  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7763819694519043  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09738731384277344  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7649006843566895  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09728288650512695  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.762911319732666  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09744453430175781  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7720470428466797  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09723711013793945  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7606382369995117  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09735298156738281  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7661819458007812  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09776115417480469  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7755722999572754  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09760665893554688  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7706198692321777  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09756660461425781  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7706546783447266  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09764528274536133  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.774956226348877  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09771060943603516  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7753372192382812  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09734582901000977  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7637248039245605  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09743452072143555  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7710638046264648  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06629455089569092 |0.016755327582359314 |0.003958746790885925 |9.736418724060059e-05 |0.00342482328414917 |0.0014739036560058594 |
----------------------------------------------------------pseudo_mini_loss sum 1.5215328931808472
Total (block generation + training)time/epoch 37.01133863131205
Training time/epoch 1.515120267868042
Training time without block to device /epoch 1.247035026550293
Training time without total dataloading part /epoch 0.12116885185241699
load block tensor time/epoch 1.0607128143310547
block to device time/epoch 0.268085241317749
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 12 |
Number of nodes for computation during this epoch:  5322786
Number of first layer input nodes during this epoch:  2510538
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12330436706542969  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021918773651123047
random selection method range initialization spend 0.005013465881347656
time for parepare:  0.020300865173339844
local_output_nid generation:  0.0023996829986572266
local_in_edges_tensor generation:  0.006630897521972656
mini_batch_src_global generation:  0.002182483673095703
r_  generation:  0.021930456161499023
local_output_nid generation:  0.003103494644165039
local_in_edges_tensor generation:  0.001737833023071289
mini_batch_src_global generation:  0.0023374557495117188
r_  generation:  0.02217388153076172
local_output_nid generation:  0.003069639205932617
local_in_edges_tensor generation:  0.0016627311706542969
mini_batch_src_global generation:  0.0017371177673339844
r_  generation:  0.021891355514526367
local_output_nid generation:  0.003098011016845703
local_in_edges_tensor generation:  0.001657247543334961
mini_batch_src_global generation:  0.0017936229705810547
r_  generation:  0.021790504455566406
local_output_nid generation:  0.003123044967651367
local_in_edges_tensor generation:  0.001657247543334961
mini_batch_src_global generation:  0.0018110275268554688
r_  generation:  0.023172855377197266
local_output_nid generation:  0.0030646324157714844
local_in_edges_tensor generation:  0.0016586780548095703
mini_batch_src_global generation:  0.0018341541290283203
r_  generation:  0.02180027961730957
local_output_nid generation:  0.0031130313873291016
local_in_edges_tensor generation:  0.0016295909881591797
mini_batch_src_global generation:  0.001825571060180664
r_  generation:  0.02291274070739746
local_output_nid generation:  0.0030388832092285156
local_in_edges_tensor generation:  0.0016546249389648438
mini_batch_src_global generation:  0.0018229484558105469
r_  generation:  0.022556304931640625
local_output_nid generation:  0.0030341148376464844
local_in_edges_tensor generation:  0.0016350746154785156
mini_batch_src_global generation:  0.001795053482055664
r_  generation:  0.023364782333374023
local_output_nid generation:  0.003049135208129883
local_in_edges_tensor generation:  0.003225564956665039
mini_batch_src_global generation:  0.0017545223236083984
r_  generation:  0.022553205490112305
local_output_nid generation:  0.003080606460571289
local_in_edges_tensor generation:  0.0016584396362304688
mini_batch_src_global generation:  0.0017871856689453125
r_  generation:  0.03149724006652832
local_output_nid generation:  0.005773305892944336
local_in_edges_tensor generation:  0.0031080245971679688
mini_batch_src_global generation:  0.005897045135498047
r_  generation:  0.027727842330932617
local_output_nid generation:  0.004715919494628906
local_in_edges_tensor generation:  0.002144336700439453
mini_batch_src_global generation:  0.002263307571411133
r_  generation:  0.024838685989379883
local_output_nid generation:  0.004674673080444336
local_in_edges_tensor generation:  0.002039670944213867
mini_batch_src_global generation:  0.0021767616271972656
r_  generation:  0.026288747787475586
local_output_nid generation:  0.0046520233154296875
local_in_edges_tensor generation:  0.0020279884338378906
mini_batch_src_global generation:  0.0022814273834228516
r_  generation:  0.02526116371154785
local_output_nid generation:  0.004622459411621094
local_in_edges_tensor generation:  0.001981973648071289
mini_batch_src_global generation:  0.0022351741790771484
r_  generation:  0.023827552795410156
----------------------check_connections_block total spend ----------------------------- 0.640470027923584
generate_one_block  0.04358172416687012
generate_one_block  0.0351254940032959
generate_one_block  0.04772233963012695
generate_one_block  0.052857398986816406
generate_one_block  0.03557777404785156
generate_one_block  0.03631591796875
generate_one_block  0.033936500549316406
generate_one_block  0.033393144607543945
generate_one_block  0.031801462173461914
generate_one_block  0.03163599967956543
generate_one_block  0.031462669372558594
generate_one_block  0.03273344039916992
generate_one_block  0.031071901321411133
generate_one_block  0.031862735748291016
generate_one_block  0.033292293548583984
generate_one_block  0.03225088119506836
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03793835639953613
gen group dst list time:  0.018581867218017578
time for parepare:  0.021137714385986328
local_output_nid generation:  0.009284734725952148
local_in_edges_tensor generation:  0.025962114334106445
mini_batch_src_global generation:  0.02648138999938965
r_  generation:  0.2520275115966797
local_output_nid generation:  0.013164997100830078
local_in_edges_tensor generation:  0.019092321395874023
mini_batch_src_global generation:  0.03950071334838867
r_  generation:  0.2633359432220459
local_output_nid generation:  0.013919353485107422
local_in_edges_tensor generation:  0.02101445198059082
mini_batch_src_global generation:  0.03643345832824707
r_  generation:  0.2663552761077881
local_output_nid generation:  0.014032125473022461
local_in_edges_tensor generation:  0.016357421875
mini_batch_src_global generation:  0.033559322357177734
r_  generation:  0.26780200004577637
local_output_nid generation:  0.014085531234741211
local_in_edges_tensor generation:  0.01950383186340332
mini_batch_src_global generation:  0.03469538688659668
r_  generation:  0.27961134910583496
local_output_nid generation:  0.013812541961669922
local_in_edges_tensor generation:  0.016248464584350586
mini_batch_src_global generation:  0.03365063667297363
r_  generation:  0.2679250240325928
local_output_nid generation:  0.013920068740844727
local_in_edges_tensor generation:  0.014290332794189453
mini_batch_src_global generation:  0.03647422790527344
r_  generation:  0.27817273139953613
local_output_nid generation:  0.013940095901489258
local_in_edges_tensor generation:  0.01416158676147461
mini_batch_src_global generation:  0.03441047668457031
r_  generation:  0.2789440155029297
local_output_nid generation:  0.0156557559967041
local_in_edges_tensor generation:  0.015461206436157227
mini_batch_src_global generation:  0.03676962852478027
r_  generation:  0.28407907485961914
local_output_nid generation:  0.014016151428222656
local_in_edges_tensor generation:  0.014226198196411133
mini_batch_src_global generation:  0.03834342956542969
r_  generation:  0.2894570827484131
local_output_nid generation:  0.015795469284057617
local_in_edges_tensor generation:  0.020616769790649414
mini_batch_src_global generation:  0.03509116172790527
r_  generation:  0.2780497074127197
local_output_nid generation:  0.014294147491455078
local_in_edges_tensor generation:  0.014125823974609375
mini_batch_src_global generation:  0.036596059799194336
r_  generation:  0.2758615016937256
local_output_nid generation:  0.014223098754882812
local_in_edges_tensor generation:  0.014139652252197266
mini_batch_src_global generation:  0.047377824783325195
r_  generation:  0.2823820114135742
local_output_nid generation:  0.014369726181030273
local_in_edges_tensor generation:  0.015379905700683594
mini_batch_src_global generation:  0.03636646270751953
r_  generation:  0.27920031547546387
local_output_nid generation:  0.01513218879699707
local_in_edges_tensor generation:  0.018422842025756836
mini_batch_src_global generation:  0.03758096694946289
r_  generation:  0.275907039642334
local_output_nid generation:  0.013761281967163086
local_in_edges_tensor generation:  0.01653885841369629
mini_batch_src_global generation:  0.0364229679107666
r_  generation:  0.27869606018066406
----------------------check_connections_block total spend ----------------------------- 6.443909168243408
generate_one_block  0.36023664474487305
generate_one_block  0.34950733184814453
generate_one_block  0.3528721332550049
generate_one_block  0.3573589324951172
generate_one_block  0.36611032485961914
generate_one_block  0.348743200302124
generate_one_block  0.390211820602417
generate_one_block  0.35689640045166016
generate_one_block  0.35556674003601074
generate_one_block  0.35030293464660645
generate_one_block  0.3526186943054199
generate_one_block  0.3559873104095459
generate_one_block  0.3563880920410156
generate_one_block  0.36227917671203613
generate_one_block  0.3639650344848633
generate_one_block  0.36193323135375977
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03899359703063965
gen group dst list time:  0.06498289108276367
time for parepare:  0.01987314224243164
local_output_nid generation:  0.027700424194335938
local_in_edges_tensor generation:  0.051513671875
mini_batch_src_global generation:  0.044187068939208984
r_  generation:  0.4620676040649414
local_output_nid generation:  0.032895565032958984
local_in_edges_tensor generation:  0.03877377510070801
mini_batch_src_global generation:  0.0539093017578125
r_  generation:  0.46581387519836426
local_output_nid generation:  0.034483909606933594
local_in_edges_tensor generation:  0.03476357460021973
mini_batch_src_global generation:  0.052339792251586914
r_  generation:  0.4727323055267334
local_output_nid generation:  0.03288388252258301
local_in_edges_tensor generation:  0.032752037048339844
mini_batch_src_global generation:  0.0526275634765625
r_  generation:  0.4733145236968994
local_output_nid generation:  0.03309297561645508
local_in_edges_tensor generation:  0.07813644409179688
mini_batch_src_global generation:  0.0529325008392334
r_  generation:  0.4832901954650879
local_output_nid generation:  0.03296804428100586
local_in_edges_tensor generation:  0.032418251037597656
mini_batch_src_global generation:  0.05372118949890137
r_  generation:  0.4751105308532715
local_output_nid generation:  0.034853219985961914
local_in_edges_tensor generation:  0.03453183174133301
mini_batch_src_global generation:  0.05441164970397949
r_  generation:  0.48578310012817383
local_output_nid generation:  0.034470558166503906
local_in_edges_tensor generation:  0.036366939544677734
mini_batch_src_global generation:  0.05643582344055176
r_  generation:  0.49104952812194824
local_output_nid generation:  0.03675031661987305
local_in_edges_tensor generation:  0.03464961051940918
mini_batch_src_global generation:  0.0569005012512207
r_  generation:  0.48683905601501465
local_output_nid generation:  0.03384876251220703
local_in_edges_tensor generation:  0.03418302536010742
mini_batch_src_global generation:  0.054738759994506836
r_  generation:  0.47359442710876465
local_output_nid generation:  0.033621788024902344
local_in_edges_tensor generation:  0.032399654388427734
mini_batch_src_global generation:  0.05395913124084473
r_  generation:  0.48636364936828613
local_output_nid generation:  0.0335543155670166
local_in_edges_tensor generation:  0.03052353858947754
mini_batch_src_global generation:  0.05422401428222656
r_  generation:  0.48274850845336914
local_output_nid generation:  0.033931732177734375
local_in_edges_tensor generation:  0.034456729888916016
mini_batch_src_global generation:  0.053922176361083984
r_  generation:  0.5009810924530029
local_output_nid generation:  0.03386735916137695
local_in_edges_tensor generation:  0.03456306457519531
mini_batch_src_global generation:  0.05667233467102051
r_  generation:  0.48085737228393555
local_output_nid generation:  0.034166812896728516
local_in_edges_tensor generation:  0.030293941497802734
mini_batch_src_global generation:  0.05315256118774414
r_  generation:  0.48781538009643555
local_output_nid generation:  0.033881425857543945
local_in_edges_tensor generation:  0.03196430206298828
mini_batch_src_global generation:  0.05520129203796387
r_  generation:  0.4803440570831299
----------------------check_connections_block total spend ----------------------------- 11.42359972000122
generate_one_block  0.6062936782836914
generate_one_block  0.6007881164550781
generate_one_block  0.6012711524963379
generate_one_block  0.6026384830474854
generate_one_block  0.6067359447479248
generate_one_block  0.5940113067626953
generate_one_block  0.6013107299804688
generate_one_block  0.5974421501159668
generate_one_block  0.6349058151245117
generate_one_block  0.6044197082519531
generate_one_block  0.5981552600860596
generate_one_block  0.598670244216919
generate_one_block  0.606734037399292
generate_one_block  0.6091728210449219
generate_one_block  0.6026573181152344
generate_one_block  0.609410285949707
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12330436706542969  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

connection checking time:  17.86750888824463
block generation total time  15.415595054626465
average batch blocks generation time:  0.963474690914154
block dataloader generation time/epoch 35.570891201496124
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09729576110839844  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7626509666442871  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09746599197387695  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7652735710144043  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09752035140991211  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7644195556640625  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09753036499023438  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7719173431396484  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09757804870605469  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.775087833404541  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09728527069091797  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7625541687011719  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09760046005249023  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7721772193908691  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09738397598266602  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.766934871673584  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09767532348632812  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.774749755859375  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09744453430175781  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.770355224609375  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09730720520019531  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7640166282653809  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09739065170288086  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7659235000610352  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0974421501159668  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7671146392822266  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0976400375366211  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7746367454528809  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09743118286132812  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7657046318054199  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09765911102294922  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.774695873260498  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06631673872470856 |0.016459450125694275 |0.0036885440349578857 |9.486079216003418e-05 |0.003656625747680664 |0.0014576911926269531 |
----------------------------------------------------------pseudo_mini_loss sum 1.4904855489730835
Total (block generation + training)time/epoch 37.048367977142334
Training time/epoch 1.5129308700561523
Training time without block to device /epoch 1.249579668045044
Training time without total dataloading part /epoch 0.1204981803894043
load block tensor time/epoch 1.061067819595337
block to device time/epoch 0.2633512020111084
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 13 |
Number of nodes for computation during this epoch:  5320058
Number of first layer input nodes during this epoch:  2510123
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12368154525756836  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02294015884399414
random selection method range initialization spend 0.006357908248901367
time for parepare:  0.0210573673248291
local_output_nid generation:  0.002317667007446289
local_in_edges_tensor generation:  0.007922649383544922
mini_batch_src_global generation:  0.0025177001953125
r_  generation:  0.03823733329772949
local_output_nid generation:  0.004033803939819336
local_in_edges_tensor generation:  0.0021800994873046875
mini_batch_src_global generation:  0.006751060485839844
r_  generation:  0.022121906280517578
local_output_nid generation:  0.0031669139862060547
local_in_edges_tensor generation:  0.0017037391662597656
mini_batch_src_global generation:  0.0017638206481933594
r_  generation:  0.03377580642700195
local_output_nid generation:  0.00493621826171875
local_in_edges_tensor generation:  0.0023674964904785156
mini_batch_src_global generation:  0.0021028518676757812
r_  generation:  0.023332595825195312
local_output_nid generation:  0.004617452621459961
local_in_edges_tensor generation:  0.002218484878540039
mini_batch_src_global generation:  0.001939535140991211
r_  generation:  0.02234649658203125
local_output_nid generation:  0.004517078399658203
local_in_edges_tensor generation:  0.002909421920776367
mini_batch_src_global generation:  0.006178617477416992
r_  generation:  0.0260465145111084
local_output_nid generation:  0.0040988922119140625
local_in_edges_tensor generation:  0.0017528533935546875
mini_batch_src_global generation:  0.002207040786743164
r_  generation:  0.024434566497802734
local_output_nid generation:  0.003723621368408203
local_in_edges_tensor generation:  0.0017933845520019531
mini_batch_src_global generation:  0.0022275447845458984
r_  generation:  0.024969816207885742
local_output_nid generation:  0.003559589385986328
local_in_edges_tensor generation:  0.0016982555389404297
mini_batch_src_global generation:  0.002208232879638672
r_  generation:  0.0240476131439209
local_output_nid generation:  0.0034055709838867188
local_in_edges_tensor generation:  0.0017137527465820312
mini_batch_src_global generation:  0.002175569534301758
r_  generation:  0.02405834197998047
local_output_nid generation:  0.003340482711791992
local_in_edges_tensor generation:  0.0017244815826416016
mini_batch_src_global generation:  0.0022225379943847656
r_  generation:  0.02495408058166504
local_output_nid generation:  0.003281831741333008
local_in_edges_tensor generation:  0.0016472339630126953
mini_batch_src_global generation:  0.0022172927856445312
r_  generation:  0.02238941192626953
local_output_nid generation:  0.003260374069213867
local_in_edges_tensor generation:  0.001623392105102539
mini_batch_src_global generation:  0.0018050670623779297
r_  generation:  0.022543668746948242
local_output_nid generation:  0.0031571388244628906
local_in_edges_tensor generation:  0.0016949176788330078
mini_batch_src_global generation:  0.001802682876586914
r_  generation:  0.023562192916870117
local_output_nid generation:  0.0031480789184570312
local_in_edges_tensor generation:  0.0016222000122070312
mini_batch_src_global generation:  0.0018155574798583984
r_  generation:  0.022785663604736328
local_output_nid generation:  0.003100872039794922
local_in_edges_tensor generation:  0.0016660690307617188
mini_batch_src_global generation:  0.001796722412109375
r_  generation:  0.022739410400390625
----------------------check_connections_block total spend ----------------------------- 0.6667628288269043
generate_one_block  0.030788898468017578
generate_one_block  0.030076980590820312
generate_one_block  0.031323909759521484
generate_one_block  0.03166651725769043
generate_one_block  0.031362056732177734
generate_one_block  0.035323143005371094
generate_one_block  0.031020641326904297
generate_one_block  0.03199362754821777
generate_one_block  0.03129768371582031
generate_one_block  0.030954837799072266
generate_one_block  0.031796932220458984
generate_one_block  0.030855655670166016
generate_one_block  0.03191494941711426
generate_one_block  0.032213687896728516
generate_one_block  0.03190946578979492
generate_one_block  0.031618595123291016
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03709149360656738
gen group dst list time:  0.018793344497680664
time for parepare:  0.01971602439880371
local_output_nid generation:  0.009370565414428711
local_in_edges_tensor generation:  0.026944398880004883
mini_batch_src_global generation:  0.026301145553588867
r_  generation:  0.24881887435913086
local_output_nid generation:  0.012829303741455078
local_in_edges_tensor generation:  0.016875028610229492
mini_batch_src_global generation:  0.03229713439941406
r_  generation:  0.2517383098602295
local_output_nid generation:  0.013051271438598633
local_in_edges_tensor generation:  0.01949453353881836
mini_batch_src_global generation:  0.03276944160461426
r_  generation:  0.2733447551727295
local_output_nid generation:  0.015447378158569336
local_in_edges_tensor generation:  0.01981663703918457
mini_batch_src_global generation:  0.0340723991394043
r_  generation:  0.27578163146972656
local_output_nid generation:  0.013844490051269531
local_in_edges_tensor generation:  0.01577591896057129
mini_batch_src_global generation:  0.03575730323791504
r_  generation:  0.28388333320617676
local_output_nid generation:  0.014112234115600586
local_in_edges_tensor generation:  0.01591348648071289
mini_batch_src_global generation:  0.03473067283630371
r_  generation:  0.28624439239501953
local_output_nid generation:  0.014648675918579102
local_in_edges_tensor generation:  0.01957392692565918
mini_batch_src_global generation:  0.03581881523132324
r_  generation:  0.27607131004333496
local_output_nid generation:  0.016226530075073242
local_in_edges_tensor generation:  0.01839160919189453
mini_batch_src_global generation:  0.03539586067199707
r_  generation:  0.2781672477722168
local_output_nid generation:  0.01382589340209961
local_in_edges_tensor generation:  0.024753570556640625
mini_batch_src_global generation:  0.03384137153625488
r_  generation:  0.28487658500671387
local_output_nid generation:  0.016178607940673828
local_in_edges_tensor generation:  0.013946533203125
mini_batch_src_global generation:  0.034162282943725586
r_  generation:  0.26982975006103516
local_output_nid generation:  0.013720273971557617
local_in_edges_tensor generation:  0.01629018783569336
mini_batch_src_global generation:  0.034409523010253906
r_  generation:  0.27759408950805664
local_output_nid generation:  0.014204263687133789
local_in_edges_tensor generation:  0.014057159423828125
mini_batch_src_global generation:  0.03485989570617676
r_  generation:  0.2728705406188965
local_output_nid generation:  0.01426386833190918
local_in_edges_tensor generation:  0.015633583068847656
mini_batch_src_global generation:  0.036292314529418945
r_  generation:  0.2853991985321045
local_output_nid generation:  0.014336109161376953
local_in_edges_tensor generation:  0.01659107208251953
mini_batch_src_global generation:  0.03522777557373047
r_  generation:  0.2772669792175293
local_output_nid generation:  0.014248847961425781
local_in_edges_tensor generation:  0.015442609786987305
mini_batch_src_global generation:  0.034642934799194336
r_  generation:  0.27919769287109375
local_output_nid generation:  0.013589620590209961
local_in_edges_tensor generation:  0.01426553726196289
mini_batch_src_global generation:  0.03423929214477539
r_  generation:  0.2740602493286133
----------------------check_connections_block total spend ----------------------------- 6.398133993148804
generate_one_block  0.3551030158996582
generate_one_block  0.3352062702178955
generate_one_block  0.3571608066558838
generate_one_block  0.362886905670166
generate_one_block  0.3549633026123047
generate_one_block  0.3566403388977051
generate_one_block  0.37414979934692383
generate_one_block  0.3697383403778076
generate_one_block  0.3513333797454834
generate_one_block  0.3500864505767822
generate_one_block  0.3612067699432373
generate_one_block  0.3548755645751953
generate_one_block  0.3675346374511719
generate_one_block  0.35832715034484863
generate_one_block  0.35704517364501953
generate_one_block  0.3529942035675049
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03393244743347168
gen group dst list time:  0.06968379020690918
time for parepare:  0.019649982452392578
local_output_nid generation:  0.03384995460510254
local_in_edges_tensor generation:  0.052718400955200195
mini_batch_src_global generation:  0.04516291618347168
r_  generation:  0.46293187141418457
local_output_nid generation:  0.03395962715148926
local_in_edges_tensor generation:  0.0396115779876709
mini_batch_src_global generation:  0.05347442626953125
r_  generation:  0.4566380977630615
local_output_nid generation:  0.03400301933288574
local_in_edges_tensor generation:  0.03310871124267578
mini_batch_src_global generation:  0.053482770919799805
r_  generation:  0.4722762107849121
local_output_nid generation:  0.03429436683654785
local_in_edges_tensor generation:  0.034768104553222656
mini_batch_src_global generation:  0.05278635025024414
r_  generation:  0.4683845043182373
local_output_nid generation:  0.03400921821594238
local_in_edges_tensor generation:  0.08452177047729492
mini_batch_src_global generation:  0.05938863754272461
r_  generation:  0.49350666999816895
local_output_nid generation:  0.033205270767211914
local_in_edges_tensor generation:  0.031531572341918945
mini_batch_src_global generation:  0.05430269241333008
r_  generation:  0.47606754302978516
local_output_nid generation:  0.034969329833984375
local_in_edges_tensor generation:  0.0320894718170166
mini_batch_src_global generation:  0.05432319641113281
r_  generation:  0.4898347854614258
local_output_nid generation:  0.03385305404663086
local_in_edges_tensor generation:  0.03388071060180664
mini_batch_src_global generation:  0.055635929107666016
r_  generation:  0.47437357902526855
local_output_nid generation:  0.03299212455749512
local_in_edges_tensor generation:  0.030977249145507812
mini_batch_src_global generation:  0.05373239517211914
r_  generation:  0.4836442470550537
local_output_nid generation:  0.032727718353271484
local_in_edges_tensor generation:  0.03346729278564453
mini_batch_src_global generation:  0.05417060852050781
r_  generation:  0.48592591285705566
local_output_nid generation:  0.03453946113586426
local_in_edges_tensor generation:  0.036690711975097656
mini_batch_src_global generation:  0.05365109443664551
r_  generation:  0.4868431091308594
local_output_nid generation:  0.03297734260559082
local_in_edges_tensor generation:  0.03524446487426758
mini_batch_src_global generation:  0.055113792419433594
r_  generation:  0.4765908718109131
local_output_nid generation:  0.032885074615478516
local_in_edges_tensor generation:  0.03677034378051758
mini_batch_src_global generation:  0.05369853973388672
r_  generation:  0.4849214553833008
local_output_nid generation:  0.033399105072021484
local_in_edges_tensor generation:  0.03674674034118652
mini_batch_src_global generation:  0.054461002349853516
r_  generation:  0.4818120002746582
local_output_nid generation:  0.033590078353881836
local_in_edges_tensor generation:  0.03846573829650879
mini_batch_src_global generation:  0.05369281768798828
r_  generation:  0.4856224060058594
local_output_nid generation:  0.03329300880432129
local_in_edges_tensor generation:  0.03765106201171875
mini_batch_src_global generation:  0.05586504936218262
r_  generation:  0.4770231246948242
----------------------check_connections_block total spend ----------------------------- 11.410866498947144
generate_one_block  0.6154618263244629
generate_one_block  0.5931923389434814
generate_one_block  0.6035869121551514
generate_one_block  0.6108882427215576
generate_one_block  0.6023495197296143
generate_one_block  0.6066269874572754
generate_one_block  0.6096909046173096
generate_one_block  0.61380934715271
generate_one_block  0.6724140644073486
generate_one_block  0.5979199409484863
generate_one_block  0.6031999588012695
generate_one_block  0.6097710132598877
generate_one_block  0.605501651763916
generate_one_block  0.6099865436553955
generate_one_block  0.5947065353393555
generate_one_block  0.6039190292358398
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12368154525756836  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

connection checking time:  17.809000492095947
block generation total time  15.47227692604065
average batch blocks generation time:  0.9670173078775406
block dataloader generation time/epoch 35.57515730857849
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09740972518920898  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7696413993835449  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09698200225830078  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7545642852783203  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09742593765258789  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.772127628326416  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09753131866455078  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7749457359313965  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09766530990600586  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7707996368408203  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09761285781860352  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.776087760925293  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09752845764160156  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7677145004272461  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09757566452026367  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7722811698913574  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09727621078491211  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7629895210266113  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09730005264282227  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7624387741088867  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09746742248535156  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7679576873779297  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09752368927001953  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7690129280090332  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09754610061645508  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7704482078552246  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09756660461425781  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7747788429260254  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09734106063842773  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7653169631958008  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09732198715209961  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7668156623840332  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06649789214134216 |0.016887977719306946 |0.0036836862564086914 |9.655952453613281e-05 |0.0036635398864746094 |0.0029075145721435547 |
----------------------------------------------------------pseudo_mini_loss sum 1.4610196352005005
Total (block generation + training)time/epoch 37.06087951660156
Training time/epoch 1.5184268951416016
Training time without block to device /epoch 1.2482192516326904
Training time without total dataloading part /epoch 0.12200808525085449
load block tensor time/epoch 1.0639662742614746
block to device time/epoch 0.27020764350891113
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 14 |
Number of nodes for computation during this epoch:  5318070
Number of first layer input nodes during this epoch:  2509119
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12302303314208984  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02443695068359375
random selection method range initialization spend 0.005782365798950195
time for parepare:  0.020045042037963867
local_output_nid generation:  0.002335786819458008
local_in_edges_tensor generation:  0.007070064544677734
mini_batch_src_global generation:  0.0021877288818359375
r_  generation:  0.020853519439697266
local_output_nid generation:  0.002877473831176758
local_in_edges_tensor generation:  0.0017223358154296875
mini_batch_src_global generation:  0.002363443374633789
r_  generation:  0.022039175033569336
local_output_nid generation:  0.0029668807983398438
local_in_edges_tensor generation:  0.0018410682678222656
mini_batch_src_global generation:  0.0017466545104980469
r_  generation:  0.022544384002685547
local_output_nid generation:  0.0030002593994140625
local_in_edges_tensor generation:  0.0017282962799072266
mini_batch_src_global generation:  0.0017931461334228516
r_  generation:  0.02138972282409668
local_output_nid generation:  0.0030040740966796875
local_in_edges_tensor generation:  0.0017044544219970703
mini_batch_src_global generation:  0.001744985580444336
r_  generation:  0.022872209548950195
local_output_nid generation:  0.003038167953491211
local_in_edges_tensor generation:  0.0017752647399902344
mini_batch_src_global generation:  0.0018153190612792969
r_  generation:  0.02272176742553711
local_output_nid generation:  0.0029964447021484375
local_in_edges_tensor generation:  0.0017461776733398438
mini_batch_src_global generation:  0.0018129348754882812
r_  generation:  0.0227205753326416
local_output_nid generation:  0.0030202865600585938
local_in_edges_tensor generation:  0.0016837120056152344
mini_batch_src_global generation:  0.0018069744110107422
r_  generation:  0.022078990936279297
local_output_nid generation:  0.0045626163482666016
local_in_edges_tensor generation:  0.0016934871673583984
mini_batch_src_global generation:  0.001804351806640625
r_  generation:  0.022182941436767578
local_output_nid generation:  0.0030355453491210938
local_in_edges_tensor generation:  0.0016341209411621094
mini_batch_src_global generation:  0.001795053482055664
r_  generation:  0.022028684616088867
local_output_nid generation:  0.0030241012573242188
local_in_edges_tensor generation:  0.0016551017761230469
mini_batch_src_global generation:  0.0018382072448730469
r_  generation:  0.02255558967590332
local_output_nid generation:  0.003004312515258789
local_in_edges_tensor generation:  0.001636505126953125
mini_batch_src_global generation:  0.003229856491088867
r_  generation:  0.022695064544677734
local_output_nid generation:  0.003088712692260742
local_in_edges_tensor generation:  0.0017061233520507812
mini_batch_src_global generation:  0.001758575439453125
r_  generation:  0.021151304244995117
local_output_nid generation:  0.0030281543731689453
local_in_edges_tensor generation:  0.0016579627990722656
mini_batch_src_global generation:  0.0017788410186767578
r_  generation:  0.022216081619262695
local_output_nid generation:  0.0029914379119873047
local_in_edges_tensor generation:  0.0016622543334960938
mini_batch_src_global generation:  0.001819610595703125
r_  generation:  0.022571325302124023
local_output_nid generation:  0.003046274185180664
local_in_edges_tensor generation:  0.0016982555389404297
mini_batch_src_global generation:  0.0017871856689453125
r_  generation:  0.022012948989868164
----------------------check_connections_block total spend ----------------------------- 0.5775017738342285
generate_one_block  0.03457021713256836
generate_one_block  0.03268861770629883
generate_one_block  0.03205394744873047
generate_one_block  0.030561447143554688
generate_one_block  0.031391143798828125
generate_one_block  0.03550004959106445
generate_one_block  0.0323176383972168
generate_one_block  0.031665802001953125
generate_one_block  0.031987905502319336
generate_one_block  0.031095027923583984
generate_one_block  0.03168368339538574
generate_one_block  0.032483816146850586
generate_one_block  0.0311281681060791
generate_one_block  0.031564950942993164
generate_one_block  0.03223848342895508
generate_one_block  0.03203845024108887
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03937387466430664
gen group dst list time:  0.01975226402282715
time for parepare:  0.020211219787597656
local_output_nid generation:  0.009395599365234375
local_in_edges_tensor generation:  0.029271364212036133
mini_batch_src_global generation:  0.02723097801208496
r_  generation:  0.2596766948699951
local_output_nid generation:  0.014330863952636719
local_in_edges_tensor generation:  0.01920008659362793
mini_batch_src_global generation:  0.0331730842590332
r_  generation:  0.25998902320861816
local_output_nid generation:  0.013184547424316406
local_in_edges_tensor generation:  0.027678728103637695
mini_batch_src_global generation:  0.033936262130737305
r_  generation:  0.27403903007507324
local_output_nid generation:  0.013430595397949219
local_in_edges_tensor generation:  0.015727996826171875
mini_batch_src_global generation:  0.03307795524597168
r_  generation:  0.2603752613067627
local_output_nid generation:  0.013831138610839844
local_in_edges_tensor generation:  0.017944812774658203
mini_batch_src_global generation:  0.03327465057373047
r_  generation:  0.26915669441223145
local_output_nid generation:  0.014135122299194336
local_in_edges_tensor generation:  0.014818429946899414
mini_batch_src_global generation:  0.03429865837097168
r_  generation:  0.27625608444213867
local_output_nid generation:  0.014002323150634766
local_in_edges_tensor generation:  0.018071413040161133
mini_batch_src_global generation:  0.0351710319519043
r_  generation:  0.27863311767578125
local_output_nid generation:  0.013883590698242188
local_in_edges_tensor generation:  0.014314413070678711
mini_batch_src_global generation:  0.034087181091308594
r_  generation:  0.2839653491973877
local_output_nid generation:  0.01645207405090332
local_in_edges_tensor generation:  0.0140228271484375
mini_batch_src_global generation:  0.03573155403137207
r_  generation:  0.2776663303375244
local_output_nid generation:  0.013944864273071289
local_in_edges_tensor generation:  0.018869876861572266
mini_batch_src_global generation:  0.03692936897277832
r_  generation:  0.2664954662322998
local_output_nid generation:  0.013836860656738281
local_in_edges_tensor generation:  0.015803098678588867
mini_batch_src_global generation:  0.03555154800415039
r_  generation:  0.29343628883361816
local_output_nid generation:  0.01442861557006836
local_in_edges_tensor generation:  0.018119096755981445
mini_batch_src_global generation:  0.034995317459106445
r_  generation:  0.2812974452972412
local_output_nid generation:  0.013976573944091797
local_in_edges_tensor generation:  0.016483545303344727
mini_batch_src_global generation:  0.036002159118652344
r_  generation:  0.26842308044433594
local_output_nid generation:  0.0143890380859375
local_in_edges_tensor generation:  0.014920711517333984
mini_batch_src_global generation:  0.03821754455566406
r_  generation:  0.2814481258392334
local_output_nid generation:  0.014197826385498047
local_in_edges_tensor generation:  0.017125606536865234
mini_batch_src_global generation:  0.035089731216430664
r_  generation:  0.2785472869873047
local_output_nid generation:  0.01381826400756836
local_in_edges_tensor generation:  0.01697540283203125
mini_batch_src_global generation:  0.03429412841796875
r_  generation:  0.2772555351257324
----------------------check_connections_block total spend ----------------------------- 6.404868841171265
generate_one_block  0.36617279052734375
generate_one_block  0.35218191146850586
generate_one_block  0.3716917037963867
generate_one_block  0.3480379581451416
generate_one_block  0.3464009761810303
generate_one_block  0.36575818061828613
generate_one_block  0.400693416595459
generate_one_block  0.35059189796447754
generate_one_block  0.36266255378723145
generate_one_block  0.3474147319793701
generate_one_block  0.3693811893463135
generate_one_block  0.3661684989929199
generate_one_block  0.3453178405761719
generate_one_block  0.3589918613433838
generate_one_block  0.35788893699645996
generate_one_block  0.35497212409973145
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0315554141998291
gen group dst list time:  0.06888413429260254
time for parepare:  0.019405841827392578
local_output_nid generation:  0.02789163589477539
local_in_edges_tensor generation:  0.05211353302001953
mini_batch_src_global generation:  0.04109454154968262
r_  generation:  0.46427178382873535
local_output_nid generation:  0.0327303409576416
local_in_edges_tensor generation:  0.03940272331237793
mini_batch_src_global generation:  0.05337834358215332
r_  generation:  0.4612712860107422
local_output_nid generation:  0.033271074295043945
local_in_edges_tensor generation:  0.03327298164367676
mini_batch_src_global generation:  0.053903818130493164
r_  generation:  0.47633957862854004
local_output_nid generation:  0.03281235694885254
local_in_edges_tensor generation:  0.04270744323730469
mini_batch_src_global generation:  0.051735639572143555
r_  generation:  0.48036789894104004
local_output_nid generation:  0.033016204833984375
local_in_edges_tensor generation:  0.08201813697814941
mini_batch_src_global generation:  0.05258989334106445
r_  generation:  0.49365687370300293
local_output_nid generation:  0.03561592102050781
local_in_edges_tensor generation:  0.03290677070617676
mini_batch_src_global generation:  0.05325031280517578
r_  generation:  0.4745290279388428
local_output_nid generation:  0.03365182876586914
local_in_edges_tensor generation:  0.03557276725769043
mini_batch_src_global generation:  0.05444812774658203
r_  generation:  0.48294615745544434
local_output_nid generation:  0.03379988670349121
local_in_edges_tensor generation:  0.03115558624267578
mini_batch_src_global generation:  0.053659915924072266
r_  generation:  0.47404050827026367
local_output_nid generation:  0.03369641304016113
local_in_edges_tensor generation:  0.0341181755065918
mini_batch_src_global generation:  0.05497145652770996
r_  generation:  0.49713826179504395
local_output_nid generation:  0.03353381156921387
local_in_edges_tensor generation:  0.03209328651428223
mini_batch_src_global generation:  0.05424857139587402
r_  generation:  0.47321128845214844
local_output_nid generation:  0.03384661674499512
local_in_edges_tensor generation:  0.03145432472229004
mini_batch_src_global generation:  0.05459094047546387
r_  generation:  0.495558500289917
local_output_nid generation:  0.03422212600708008
local_in_edges_tensor generation:  0.03546500205993652
mini_batch_src_global generation:  0.053693532943725586
r_  generation:  0.47902965545654297
local_output_nid generation:  0.03395724296569824
local_in_edges_tensor generation:  0.03237724304199219
mini_batch_src_global generation:  0.052634477615356445
r_  generation:  0.4848942756652832
local_output_nid generation:  0.0346066951751709
local_in_edges_tensor generation:  0.03485250473022461
mini_batch_src_global generation:  0.05380582809448242
r_  generation:  0.4746980667114258
local_output_nid generation:  0.03377175331115723
local_in_edges_tensor generation:  0.03598761558532715
mini_batch_src_global generation:  0.052558183670043945
r_  generation:  0.4873166084289551
local_output_nid generation:  0.03375887870788574
local_in_edges_tensor generation:  0.03528475761413574
mini_batch_src_global generation:  0.05436515808105469
r_  generation:  0.478102445602417
----------------------check_connections_block total spend ----------------------------- 11.396273374557495
generate_one_block  0.6083073616027832
generate_one_block  0.6071217060089111
generate_one_block  0.6000661849975586
generate_one_block  0.5921139717102051
generate_one_block  0.5980687141418457
generate_one_block  0.6026196479797363
generate_one_block  0.6069619655609131
generate_one_block  0.6010177135467529
generate_one_block  0.6338531970977783
generate_one_block  0.6130189895629883
generate_one_block  0.6089365482330322
generate_one_block  0.6038863658905029
generate_one_block  0.5963222980499268
generate_one_block  0.5950198173522949
generate_one_block  0.5934820175170898
generate_one_block  0.6032543182373047
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12302303314208984  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

connection checking time:  17.80114221572876
block generation total time  15.428377389907837
average batch blocks generation time:  0.9642735868692398
block dataloader generation time/epoch 35.553975343704224
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09759330749511719  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7699098587036133  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09730720520019531  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7643489837646484  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09785175323486328  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7757186889648438  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0972280502319336  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7619991302490234  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09739303588867188  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7659807205200195  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09747028350830078  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7705655097961426  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0976567268371582  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7749161720275879  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09738588333129883  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7645392417907715  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09747982025146484  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7710452079772949  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09714365005493164  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7615737915039062  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09774971008300781  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7759666442871094  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0975947380065918  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7750368118286133  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09708595275878906  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7594304084777832  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09760618209838867  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7749571800231934  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09734964370727539  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7652029991149902  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09737157821655273  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7675752639770508  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06144432723522186 |0.015315249562263489 |0.003816857933998108 |9.873509407043457e-05 |0.0033332854509353638 |0.0014469623565673828 |
----------------------------------------------------------pseudo_mini_loss sum 1.4343582391738892
Total (block generation + training)time/epoch 37.027289271354675
Training time/epoch 1.4109950065612793
Training time without block to device /epoch 1.1659510135650635
Training time without total dataloading part /epoch 0.11742901802062988
load block tensor time/epoch 0.9831092357635498
block to device time/epoch 0.24504399299621582
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 15 |
Number of nodes for computation during this epoch:  5318942
Number of first layer input nodes during this epoch:  2509144
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12314510345458984  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.043349266052246094
random selection method range initialization spend 0.0052378177642822266
time for parepare:  0.020160913467407227
local_output_nid generation:  0.0023670196533203125
local_in_edges_tensor generation:  0.0053958892822265625
mini_batch_src_global generation:  0.001760244369506836
r_  generation:  0.021479129791259766
local_output_nid generation:  0.002920866012573242
local_in_edges_tensor generation:  0.001661062240600586
mini_batch_src_global generation:  0.0020890235900878906
r_  generation:  0.022317171096801758
local_output_nid generation:  0.002995729446411133
local_in_edges_tensor generation:  0.0017547607421875
mini_batch_src_global generation:  0.0017452239990234375
r_  generation:  0.02172255516052246
local_output_nid generation:  0.0030193328857421875
local_in_edges_tensor generation:  0.0016627311706542969
mini_batch_src_global generation:  0.001718282699584961
r_  generation:  0.021183490753173828
local_output_nid generation:  0.0029630661010742188
local_in_edges_tensor generation:  0.0015652179718017578
mini_batch_src_global generation:  0.0017290115356445312
r_  generation:  0.022257566452026367
local_output_nid generation:  0.0029916763305664062
local_in_edges_tensor generation:  0.0016765594482421875
mini_batch_src_global generation:  0.0017561912536621094
r_  generation:  0.02192974090576172
local_output_nid generation:  0.0029985904693603516
local_in_edges_tensor generation:  0.0016021728515625
mini_batch_src_global generation:  0.00174713134765625
r_  generation:  0.02226734161376953
local_output_nid generation:  0.0029747486114501953
local_in_edges_tensor generation:  0.0016469955444335938
mini_batch_src_global generation:  0.0017523765563964844
r_  generation:  0.021491527557373047
local_output_nid generation:  0.003538370132446289
local_in_edges_tensor generation:  0.0016903877258300781
mini_batch_src_global generation:  0.0017251968383789062
r_  generation:  0.02159738540649414
local_output_nid generation:  0.003027677536010742
local_in_edges_tensor generation:  0.0015625953674316406
mini_batch_src_global generation:  0.0016791820526123047
r_  generation:  0.021892547607421875
local_output_nid generation:  0.0029625892639160156
local_in_edges_tensor generation:  0.0015912055969238281
mini_batch_src_global generation:  0.0017709732055664062
r_  generation:  0.0219724178314209
local_output_nid generation:  0.002930879592895508
local_in_edges_tensor generation:  0.0016222000122070312
mini_batch_src_global generation:  0.0017287731170654297
r_  generation:  0.02162027359008789
local_output_nid generation:  0.003040313720703125
local_in_edges_tensor generation:  0.001650094985961914
mini_batch_src_global generation:  0.0017485618591308594
r_  generation:  0.022302865982055664
local_output_nid generation:  0.0030965805053710938
local_in_edges_tensor generation:  0.0015625953674316406
mini_batch_src_global generation:  0.001760721206665039
r_  generation:  0.0219271183013916
local_output_nid generation:  0.0029883384704589844
local_in_edges_tensor generation:  0.0015544891357421875
mini_batch_src_global generation:  0.0017523765563964844
r_  generation:  0.0217435359954834
local_output_nid generation:  0.002963542938232422
local_in_edges_tensor generation:  0.0015494823455810547
mini_batch_src_global generation:  0.0017328262329101562
r_  generation:  0.022104978561401367
----------------------check_connections_block total spend ----------------------------- 0.5660889148712158
generate_one_block  0.035860300064086914
generate_one_block  0.032052040100097656
generate_one_block  0.0318150520324707
generate_one_block  0.031099557876586914
generate_one_block  0.031748294830322266
generate_one_block  0.03486323356628418
generate_one_block  0.03167533874511719
generate_one_block  0.03081679344177246
generate_one_block  0.03132224082946777
generate_one_block  0.032204389572143555
generate_one_block  0.03176069259643555
generate_one_block  0.03102564811706543
generate_one_block  0.035721540451049805
generate_one_block  0.03139519691467285
generate_one_block  0.03124237060546875
generate_one_block  0.03185629844665527
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.037522315979003906
gen group dst list time:  0.02130603790283203
time for parepare:  0.019464492797851562
local_output_nid generation:  0.009433984756469727
local_in_edges_tensor generation:  0.030047893524169922
mini_batch_src_global generation:  0.026904821395874023
r_  generation:  0.2500953674316406
local_output_nid generation:  0.013340950012207031
local_in_edges_tensor generation:  0.018979787826538086
mini_batch_src_global generation:  0.03382468223571777
r_  generation:  0.2590816020965576
local_output_nid generation:  0.013206720352172852
local_in_edges_tensor generation:  0.014134645462036133
mini_batch_src_global generation:  0.032045841217041016
r_  generation:  0.26654648780822754
local_output_nid generation:  0.013687372207641602
local_in_edges_tensor generation:  0.014851093292236328
mini_batch_src_global generation:  0.03179049491882324
r_  generation:  0.2599189281463623
local_output_nid generation:  0.013660669326782227
local_in_edges_tensor generation:  0.01528024673461914
mini_batch_src_global generation:  0.03391575813293457
r_  generation:  0.2745697498321533
local_output_nid generation:  0.013753414154052734
local_in_edges_tensor generation:  0.014123916625976562
mini_batch_src_global generation:  0.033669233322143555
r_  generation:  0.27213430404663086
local_output_nid generation:  0.01367044448852539
local_in_edges_tensor generation:  0.015149831771850586
mini_batch_src_global generation:  0.03401446342468262
r_  generation:  0.27608227729797363
local_output_nid generation:  0.013537406921386719
local_in_edges_tensor generation:  0.014882087707519531
mini_batch_src_global generation:  0.033663272857666016
r_  generation:  0.27348852157592773
local_output_nid generation:  0.01398468017578125
local_in_edges_tensor generation:  0.015260457992553711
mini_batch_src_global generation:  0.034705162048339844
r_  generation:  0.27877306938171387
local_output_nid generation:  0.013651132583618164
local_in_edges_tensor generation:  0.01612567901611328
mini_batch_src_global generation:  0.03386116027832031
r_  generation:  0.271709680557251
local_output_nid generation:  0.012955188751220703
local_in_edges_tensor generation:  0.01629495620727539
mini_batch_src_global generation:  0.03441667556762695
r_  generation:  0.2762453556060791
local_output_nid generation:  0.013582706451416016
local_in_edges_tensor generation:  0.01450204849243164
mini_batch_src_global generation:  0.03596663475036621
r_  generation:  0.27211999893188477
local_output_nid generation:  0.013769388198852539
local_in_edges_tensor generation:  0.015352249145507812
mini_batch_src_global generation:  0.03755021095275879
r_  generation:  0.28049635887145996
local_output_nid generation:  0.013911247253417969
local_in_edges_tensor generation:  0.01622629165649414
mini_batch_src_global generation:  0.03501081466674805
r_  generation:  0.2765684127807617
local_output_nid generation:  0.013655662536621094
local_in_edges_tensor generation:  0.014920949935913086
mini_batch_src_global generation:  0.03493046760559082
r_  generation:  0.2748422622680664
local_output_nid generation:  0.013704776763916016
local_in_edges_tensor generation:  0.015483856201171875
mini_batch_src_global generation:  0.03475666046142578
r_  generation:  0.2746868133544922
----------------------check_connections_block total spend ----------------------------- 6.294524431228638
generate_one_block  0.3598148822784424
generate_one_block  0.3559896945953369
generate_one_block  0.35685229301452637
generate_one_block  0.3453400135040283
generate_one_block  0.3604872226715088
generate_one_block  0.3573331832885742
generate_one_block  0.3812110424041748
generate_one_block  0.3637690544128418
generate_one_block  0.35795164108276367
generate_one_block  0.3542301654815674
generate_one_block  0.3553965091705322
generate_one_block  0.35555458068847656
generate_one_block  0.3621699810028076
generate_one_block  0.3578348159790039
generate_one_block  0.3537559509277344
generate_one_block  0.3550848960876465
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.034497737884521484
gen group dst list time:  0.06804203987121582
time for parepare:  0.019094228744506836
local_output_nid generation:  0.028929710388183594
local_in_edges_tensor generation:  0.0499727725982666
mini_batch_src_global generation:  0.04116463661193848
r_  generation:  0.459228515625
local_output_nid generation:  0.03254365921020508
local_in_edges_tensor generation:  0.03812694549560547
mini_batch_src_global generation:  0.05380082130432129
r_  generation:  0.4611802101135254
local_output_nid generation:  0.03259611129760742
local_in_edges_tensor generation:  0.042961835861206055
mini_batch_src_global generation:  0.05124258995056152
r_  generation:  0.4701809883117676
local_output_nid generation:  0.03524041175842285
local_in_edges_tensor generation:  0.03703188896179199
mini_batch_src_global generation:  0.05336928367614746
r_  generation:  0.47594785690307617
local_output_nid generation:  0.03597879409790039
local_in_edges_tensor generation:  0.08583760261535645
mini_batch_src_global generation:  0.05880403518676758
r_  generation:  0.4768187999725342
local_output_nid generation:  0.03261995315551758
local_in_edges_tensor generation:  0.032891035079956055
mini_batch_src_global generation:  0.054056644439697266
r_  generation:  0.46544694900512695
local_output_nid generation:  0.032266855239868164
local_in_edges_tensor generation:  0.029877901077270508
mini_batch_src_global generation:  0.05284929275512695
r_  generation:  0.47581052780151367
local_output_nid generation:  0.03241682052612305
local_in_edges_tensor generation:  0.029604434967041016
mini_batch_src_global generation:  0.05449199676513672
r_  generation:  0.4767580032348633
local_output_nid generation:  0.03244185447692871
local_in_edges_tensor generation:  0.03595542907714844
mini_batch_src_global generation:  0.053739309310913086
r_  generation:  0.4804248809814453
local_output_nid generation:  0.03228306770324707
local_in_edges_tensor generation:  0.030802488327026367
mini_batch_src_global generation:  0.05432844161987305
r_  generation:  0.47557926177978516
local_output_nid generation:  0.0328211784362793
local_in_edges_tensor generation:  0.03097987174987793
mini_batch_src_global generation:  0.05383610725402832
r_  generation:  0.48528361320495605
local_output_nid generation:  0.03450179100036621
local_in_edges_tensor generation:  0.03441190719604492
mini_batch_src_global generation:  0.05471539497375488
r_  generation:  0.47065138816833496
local_output_nid generation:  0.03293347358703613
local_in_edges_tensor generation:  0.031855106353759766
mini_batch_src_global generation:  0.05295562744140625
r_  generation:  0.4787914752960205
local_output_nid generation:  0.03271365165710449
local_in_edges_tensor generation:  0.03343701362609863
mini_batch_src_global generation:  0.054015159606933594
r_  generation:  0.4735536575317383
local_output_nid generation:  0.034038543701171875
local_in_edges_tensor generation:  0.0352482795715332
mini_batch_src_global generation:  0.053194522857666016
r_  generation:  0.487529993057251
local_output_nid generation:  0.03330874443054199
local_in_edges_tensor generation:  0.02969670295715332
mini_batch_src_global generation:  0.054959774017333984
r_  generation:  0.4764995574951172
----------------------check_connections_block total spend ----------------------------- 11.289693355560303
generate_one_block  0.6028957366943359
generate_one_block  0.5933117866516113
generate_one_block  0.5891427993774414
generate_one_block  0.6010036468505859
generate_one_block  0.6085362434387207
generate_one_block  0.5930647850036621
generate_one_block  0.5944716930389404
generate_one_block  0.5940537452697754
generate_one_block  0.6583480834960938
generate_one_block  0.5910825729370117
generate_one_block  0.5982356071472168
generate_one_block  0.6081376075744629
generate_one_block  0.5996196269989014
generate_one_block  0.597989559173584
generate_one_block  0.6005270481109619
generate_one_block  0.5903592109680176
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12314510345458984  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

connection checking time:  17.58421778678894
block generation total time  15.353555679321289
average batch blocks generation time:  0.9595972299575806
block dataloader generation time/epoch 35.50577139854431
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09746456146240234  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7712769508361816  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09764814376831055  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7723193168640137  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09738397598266602  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7676787376403809  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09744977951049805  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7647886276245117  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09782075881958008  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7753558158874512  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09743309020996094  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7672529220581055  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09729433059692383  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7641196250915527  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09759759902954102  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7687454223632812  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09749174118041992  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7711596488952637  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0974130630493164  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7645854949951172  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09753942489624023  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7665138244628906  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09734535217285156  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7646608352661133  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09750938415527344  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7662429809570312  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09753990173339844  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7699184417724609  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09749794006347656  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7694258689880371  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09749221801757812  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7711138725280762  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06811128556728363 |0.014516949653625488 |0.0035605132579803467 |9.356439113616943e-05 |0.003726750612258911 |0.001331329345703125 |
----------------------------------------------------------pseudo_mini_loss sum 1.4035813808441162
Total (block generation + training)time/epoch 36.99574637413025
Training time/epoch 1.5896797180175781
Training time without block to device /epoch 1.3574085235595703
Training time without total dataloading part /epoch 0.11942458152770996
load block tensor time/epoch 1.089780569076538
block to device time/epoch 0.2322711944580078
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 16 |
Number of nodes for computation during this epoch:  5320600
Number of first layer input nodes during this epoch:  2510967
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12333917617797852  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026725292205810547
random selection method range initialization spend 0.004809379577636719
time for parepare:  0.019428491592407227
local_output_nid generation:  0.002251863479614258
local_in_edges_tensor generation:  0.007722377777099609
mini_batch_src_global generation:  0.0017113685607910156
r_  generation:  0.020882844924926758
local_output_nid generation:  0.0029518604278564453
local_in_edges_tensor generation:  0.0017616748809814453
mini_batch_src_global generation:  0.0020122528076171875
r_  generation:  0.021672964096069336
local_output_nid generation:  0.002953767776489258
local_in_edges_tensor generation:  0.0017724037170410156
mini_batch_src_global generation:  0.001689910888671875
r_  generation:  0.022363901138305664
local_output_nid generation:  0.0029861927032470703
local_in_edges_tensor generation:  0.0016870498657226562
mini_batch_src_global generation:  0.0017709732055664062
r_  generation:  0.021687984466552734
local_output_nid generation:  0.002922534942626953
local_in_edges_tensor generation:  0.0016565322875976562
mini_batch_src_global generation:  0.001710653305053711
r_  generation:  0.02142930030822754
local_output_nid generation:  0.002959012985229492
local_in_edges_tensor generation:  0.001667022705078125
mini_batch_src_global generation:  0.0017025470733642578
r_  generation:  0.022090911865234375
local_output_nid generation:  0.002962827682495117
local_in_edges_tensor generation:  0.0015969276428222656
mini_batch_src_global generation:  0.0017364025115966797
r_  generation:  0.02239084243774414
local_output_nid generation:  0.002978086471557617
local_in_edges_tensor generation:  0.0017006397247314453
mini_batch_src_global generation:  0.0017445087432861328
r_  generation:  0.022300004959106445
local_output_nid generation:  0.0029828548431396484
local_in_edges_tensor generation:  0.0016245841979980469
mini_batch_src_global generation:  0.0017173290252685547
r_  generation:  0.02265000343322754
local_output_nid generation:  0.0029630661010742188
local_in_edges_tensor generation:  0.001634359359741211
mini_batch_src_global generation:  0.0017364025115966797
r_  generation:  0.022113800048828125
local_output_nid generation:  0.003022909164428711
local_in_edges_tensor generation:  0.001657247543334961
mini_batch_src_global generation:  0.0017914772033691406
r_  generation:  0.022114992141723633
local_output_nid generation:  0.002953052520751953
local_in_edges_tensor generation:  0.0016388893127441406
mini_batch_src_global generation:  0.0017590522766113281
r_  generation:  0.022449254989624023
local_output_nid generation:  0.002904653549194336
local_in_edges_tensor generation:  0.0016264915466308594
mini_batch_src_global generation:  0.0017764568328857422
r_  generation:  0.021758079528808594
local_output_nid generation:  0.0029528141021728516
local_in_edges_tensor generation:  0.0016732215881347656
mini_batch_src_global generation:  0.0017011165618896484
r_  generation:  0.021211624145507812
local_output_nid generation:  0.002955913543701172
local_in_edges_tensor generation:  0.001611471176147461
mini_batch_src_global generation:  0.0017600059509277344
r_  generation:  0.022550344467163086
local_output_nid generation:  0.0029571056365966797
local_in_edges_tensor generation:  0.0016434192657470703
mini_batch_src_global generation:  0.0017080307006835938
r_  generation:  0.0213167667388916
----------------------check_connections_block total spend ----------------------------- 0.5657610893249512
generate_one_block  0.03332853317260742
generate_one_block  0.03166532516479492
generate_one_block  0.0319066047668457
generate_one_block  0.031241416931152344
generate_one_block  0.03074193000793457
generate_one_block  0.03421640396118164
generate_one_block  0.03160381317138672
generate_one_block  0.03135228157043457
generate_one_block  0.03136277198791504
generate_one_block  0.031256675720214844
generate_one_block  0.03125739097595215
generate_one_block  0.032052040100097656
generate_one_block  0.03119826316833496
generate_one_block  0.02982783317565918
generate_one_block  0.0317385196685791
generate_one_block  0.03074932098388672
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04061746597290039
gen group dst list time:  0.017779827117919922
time for parepare:  0.019298553466796875
local_output_nid generation:  0.008967399597167969
local_in_edges_tensor generation:  0.025413990020751953
mini_batch_src_global generation:  0.02663731575012207
r_  generation:  0.23849034309387207
local_output_nid generation:  0.013344049453735352
local_in_edges_tensor generation:  0.018755197525024414
mini_batch_src_global generation:  0.03256487846374512
r_  generation:  0.2534146308898926
local_output_nid generation:  0.013616561889648438
local_in_edges_tensor generation:  0.019070148468017578
mini_batch_src_global generation:  0.033100128173828125
r_  generation:  0.26223301887512207
local_output_nid generation:  0.013762950897216797
local_in_edges_tensor generation:  0.019188404083251953
mini_batch_src_global generation:  0.03456544876098633
r_  generation:  0.2685105800628662
local_output_nid generation:  0.012921571731567383
local_in_edges_tensor generation:  0.01825571060180664
mini_batch_src_global generation:  0.03463149070739746
r_  generation:  0.2626218795776367
local_output_nid generation:  0.01339268684387207
local_in_edges_tensor generation:  0.015001773834228516
mini_batch_src_global generation:  0.03465557098388672
r_  generation:  0.26929140090942383
local_output_nid generation:  0.013771295547485352
local_in_edges_tensor generation:  0.014245986938476562
mini_batch_src_global generation:  0.03491497039794922
r_  generation:  0.2760913372039795
local_output_nid generation:  0.013784408569335938
local_in_edges_tensor generation:  0.014068841934204102
mini_batch_src_global generation:  0.03392672538757324
r_  generation:  0.26867008209228516
local_output_nid generation:  0.013960123062133789
local_in_edges_tensor generation:  0.01436614990234375
mini_batch_src_global generation:  0.03526139259338379
r_  generation:  0.27455973625183105
local_output_nid generation:  0.013773441314697266
local_in_edges_tensor generation:  0.017826318740844727
mini_batch_src_global generation:  0.034821510314941406
r_  generation:  0.27636075019836426
local_output_nid generation:  0.01389765739440918
local_in_edges_tensor generation:  0.015553474426269531
mini_batch_src_global generation:  0.03482222557067871
r_  generation:  0.2722139358520508
local_output_nid generation:  0.01370382308959961
local_in_edges_tensor generation:  0.01606607437133789
mini_batch_src_global generation:  0.03572893142700195
r_  generation:  0.27388429641723633
local_output_nid generation:  0.01387333869934082
local_in_edges_tensor generation:  0.015379905700683594
mini_batch_src_global generation:  0.034931182861328125
r_  generation:  0.2781186103820801
local_output_nid generation:  0.013297080993652344
local_in_edges_tensor generation:  0.013681173324584961
mini_batch_src_global generation:  0.03354668617248535
r_  generation:  0.26294898986816406
local_output_nid generation:  0.013955354690551758
local_in_edges_tensor generation:  0.01596856117248535
mini_batch_src_global generation:  0.03583788871765137
r_  generation:  0.28275299072265625
local_output_nid generation:  0.01295328140258789
local_in_edges_tensor generation:  0.013733863830566406
mini_batch_src_global generation:  0.03394460678100586
r_  generation:  0.2699558734893799
----------------------check_connections_block total spend ----------------------------- 6.245416879653931
generate_one_block  0.3388829231262207
generate_one_block  0.3536970615386963
generate_one_block  0.3554537296295166
generate_one_block  0.3550753593444824
generate_one_block  0.34244680404663086
generate_one_block  0.34906792640686035
generate_one_block  0.3800334930419922
generate_one_block  0.34591245651245117
generate_one_block  0.3556821346282959
generate_one_block  0.3528916835784912
generate_one_block  0.3532595634460449
generate_one_block  0.35433197021484375
generate_one_block  0.3564608097076416
generate_one_block  0.34051060676574707
generate_one_block  0.3677191734313965
generate_one_block  0.3418450355529785
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03664135932922363
gen group dst list time:  0.06676530838012695
time for parepare:  0.0178372859954834
local_output_nid generation:  0.028133153915405273
local_in_edges_tensor generation:  0.038401126861572266
mini_batch_src_global generation:  0.04311323165893555
r_  generation:  0.46051692962646484
local_output_nid generation:  0.03272080421447754
local_in_edges_tensor generation:  0.03564620018005371
mini_batch_src_global generation:  0.05556130409240723
r_  generation:  0.4608020782470703
local_output_nid generation:  0.033461809158325195
local_in_edges_tensor generation:  0.0318758487701416
mini_batch_src_global generation:  0.05659174919128418
r_  generation:  0.4685502052307129
local_output_nid generation:  0.03269243240356445
local_in_edges_tensor generation:  0.0304257869720459
mini_batch_src_global generation:  0.05219554901123047
r_  generation:  0.47017455101013184
local_output_nid generation:  0.03237104415893555
local_in_edges_tensor generation:  0.07570028305053711
mini_batch_src_global generation:  0.05312848091125488
r_  generation:  0.4745779037475586
local_output_nid generation:  0.032787322998046875
local_in_edges_tensor generation:  0.030571937561035156
mini_batch_src_global generation:  0.05314373970031738
r_  generation:  0.471785306930542
local_output_nid generation:  0.03419923782348633
local_in_edges_tensor generation:  0.03231239318847656
mini_batch_src_global generation:  0.05374407768249512
r_  generation:  0.48879432678222656
local_output_nid generation:  0.03304767608642578
local_in_edges_tensor generation:  0.031588077545166016
mini_batch_src_global generation:  0.053732872009277344
r_  generation:  0.47521162033081055
local_output_nid generation:  0.033103227615356445
local_in_edges_tensor generation:  0.03328371047973633
mini_batch_src_global generation:  0.05391120910644531
r_  generation:  0.4801054000854492
local_output_nid generation:  0.03265953063964844
local_in_edges_tensor generation:  0.03011298179626465
mini_batch_src_global generation:  0.05420541763305664
r_  generation:  0.4695262908935547
local_output_nid generation:  0.03256654739379883
local_in_edges_tensor generation:  0.03227877616882324
mini_batch_src_global generation:  0.05588030815124512
r_  generation:  0.4826939105987549
local_output_nid generation:  0.03285527229309082
local_in_edges_tensor generation:  0.036376237869262695
mini_batch_src_global generation:  0.05413103103637695
r_  generation:  0.47348785400390625
local_output_nid generation:  0.03245139122009277
local_in_edges_tensor generation:  0.03405404090881348
mini_batch_src_global generation:  0.05370450019836426
r_  generation:  0.4789886474609375
local_output_nid generation:  0.03264474868774414
local_in_edges_tensor generation:  0.03329181671142578
mini_batch_src_global generation:  0.05612373352050781
r_  generation:  0.4693787097930908
local_output_nid generation:  0.032768964767456055
local_in_edges_tensor generation:  0.03186225891113281
mini_batch_src_global generation:  0.053369760513305664
r_  generation:  0.4798767566680908
local_output_nid generation:  0.032991886138916016
local_in_edges_tensor generation:  0.031571149826049805
mini_batch_src_global generation:  0.05570030212402344
r_  generation:  0.47294139862060547
----------------------check_connections_block total spend ----------------------------- 11.224230527877808
generate_one_block  0.5881786346435547
generate_one_block  0.6015915870666504
generate_one_block  0.6012871265411377
generate_one_block  0.5958995819091797
generate_one_block  0.5890083312988281
generate_one_block  0.5965523719787598
generate_one_block  0.5878891944885254
generate_one_block  0.5879504680633545
generate_one_block  0.6332516670227051
generate_one_block  0.5990357398986816
generate_one_block  0.5944135189056396
generate_one_block  0.5984187126159668
generate_one_block  0.5860645771026611
generate_one_block  0.5826070308685303
generate_one_block  0.6005563735961914
generate_one_block  0.5894253253936768
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12333917617797852  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

connection checking time:  17.46964740753174
block generation total time  15.175400972366333
average batch blocks generation time:  0.9484625607728958
block dataloader generation time/epoch 35.421241998672485
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09710168838500977  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7612557411193848  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09734964370727539  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7666172981262207  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09762287139892578  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7751197814941406  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09753227233886719  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.772244930267334  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0973958969116211  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.765254020690918  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09754419326782227  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7707886695861816  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09751510620117188  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.764960765838623  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0974574089050293  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7665042877197266  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09777498245239258  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7751898765563965  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09738540649414062  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7639813423156738  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09755563735961914  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7704925537109375  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09747791290283203  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7682723999023438  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09745025634765625  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7676281929016113  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09713888168334961  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7591042518615723  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09770774841308594  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7759737968444824  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09732675552368164  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7644619941711426  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06456585228443146 |0.013282105326652527 |0.0034848451614379883 |9.025633335113525e-05 |0.0032060444355010986 |0.001451253890991211 |
----------------------------------------------------------pseudo_mini_loss sum 1.3776391744613647
Total (block generation + training)time/epoch 36.90245807170868
Training time/epoch 1.419645071029663
Training time without block to device /epoch 1.2071313858032227
Training time without total dataloading part /epoch 0.10994958877563477
load block tensor time/epoch 1.0330536365509033
block to device time/epoch 0.21251368522644043
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 17 |
Number of nodes for computation during this epoch:  5318934
Number of first layer input nodes during this epoch:  2509693
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12285470962524414  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020699501037597656
random selection method range initialization spend 0.004909038543701172
time for parepare:  0.017224550247192383
local_output_nid generation:  0.002329587936401367
local_in_edges_tensor generation:  0.0074045658111572266
mini_batch_src_global generation:  0.0018053054809570312
r_  generation:  0.021308183670043945
local_output_nid generation:  0.002860546112060547
local_in_edges_tensor generation:  0.0016963481903076172
mini_batch_src_global generation:  0.0021262168884277344
r_  generation:  0.02252674102783203
local_output_nid generation:  0.0029778480529785156
local_in_edges_tensor generation:  0.0016820430755615234
mini_batch_src_global generation:  0.0017085075378417969
r_  generation:  0.021342754364013672
local_output_nid generation:  0.0029845237731933594
local_in_edges_tensor generation:  0.0016331672668457031
mini_batch_src_global generation:  0.0017778873443603516
r_  generation:  0.021706581115722656
local_output_nid generation:  0.002960205078125
local_in_edges_tensor generation:  0.0015978813171386719
mini_batch_src_global generation:  0.0017306804656982422
r_  generation:  0.022113800048828125
local_output_nid generation:  0.0030236244201660156
local_in_edges_tensor generation:  0.0016360282897949219
mini_batch_src_global generation:  0.001756429672241211
r_  generation:  0.022004127502441406
local_output_nid generation:  0.002991914749145508
local_in_edges_tensor generation:  0.0015709400177001953
mini_batch_src_global generation:  0.0017690658569335938
r_  generation:  0.02204132080078125
local_output_nid generation:  0.002961397171020508
local_in_edges_tensor generation:  0.0016641616821289062
mini_batch_src_global generation:  0.0017244815826416016
r_  generation:  0.021410465240478516
local_output_nid generation:  0.0029299259185791016
local_in_edges_tensor generation:  0.0015861988067626953
mini_batch_src_global generation:  0.0017418861389160156
r_  generation:  0.021239519119262695
local_output_nid generation:  0.002988576889038086
local_in_edges_tensor generation:  0.0015859603881835938
mini_batch_src_global generation:  0.0017390251159667969
r_  generation:  0.021939516067504883
local_output_nid generation:  0.0029773712158203125
local_in_edges_tensor generation:  0.0015544891357421875
mini_batch_src_global generation:  0.0017421245574951172
r_  generation:  0.021667957305908203
local_output_nid generation:  0.002972126007080078
local_in_edges_tensor generation:  0.0015532970428466797
mini_batch_src_global generation:  0.0018219947814941406
r_  generation:  0.022710323333740234
local_output_nid generation:  0.0030257701873779297
local_in_edges_tensor generation:  0.0015451908111572266
mini_batch_src_global generation:  0.0017938613891601562
r_  generation:  0.022318601608276367
local_output_nid generation:  0.0029900074005126953
local_in_edges_tensor generation:  0.0016450881958007812
mini_batch_src_global generation:  0.0017948150634765625
r_  generation:  0.022042512893676758
local_output_nid generation:  0.003049135208129883
local_in_edges_tensor generation:  0.001565694808959961
mini_batch_src_global generation:  0.0017366409301757812
r_  generation:  0.021956443786621094
local_output_nid generation:  0.0029942989349365234
local_in_edges_tensor generation:  0.001562356948852539
mini_batch_src_global generation:  0.0017747879028320312
r_  generation:  0.02281475067138672
----------------------check_connections_block total spend ----------------------------- 0.5635097026824951
generate_one_block  0.03506898880004883
generate_one_block  0.0323946475982666
generate_one_block  0.030792951583862305
generate_one_block  0.0312647819519043
generate_one_block  0.031183958053588867
generate_one_block  0.03398251533508301
generate_one_block  0.03152966499328613
generate_one_block  0.030618906021118164
generate_one_block  0.029873371124267578
generate_one_block  0.0308077335357666
generate_one_block  0.030453205108642578
generate_one_block  0.03232431411743164
generate_one_block  0.0310361385345459
generate_one_block  0.03112936019897461
generate_one_block  0.03119635581970215
generate_one_block  0.03235888481140137
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03731679916381836
gen group dst list time:  0.0177459716796875
time for parepare:  0.01923847198486328
local_output_nid generation:  0.00917363166809082
local_in_edges_tensor generation:  0.026554107666015625
mini_batch_src_global generation:  0.0278778076171875
r_  generation:  0.25827836990356445
local_output_nid generation:  0.013138771057128906
local_in_edges_tensor generation:  0.019127607345581055
mini_batch_src_global generation:  0.032808542251586914
r_  generation:  0.2597470283508301
local_output_nid generation:  0.012805700302124023
local_in_edges_tensor generation:  0.017257213592529297
mini_batch_src_global generation:  0.032799720764160156
r_  generation:  0.2630040645599365
local_output_nid generation:  0.013566732406616211
local_in_edges_tensor generation:  0.01654791831970215
mini_batch_src_global generation:  0.0323328971862793
r_  generation:  0.26375412940979004
local_output_nid generation:  0.013426542282104492
local_in_edges_tensor generation:  0.014101743698120117
mini_batch_src_global generation:  0.033863067626953125
r_  generation:  0.27312803268432617
local_output_nid generation:  0.013654232025146484
local_in_edges_tensor generation:  0.014074325561523438
mini_batch_src_global generation:  0.03342008590698242
r_  generation:  0.2679014205932617
local_output_nid generation:  0.013529777526855469
local_in_edges_tensor generation:  0.014523983001708984
mini_batch_src_global generation:  0.034365177154541016
r_  generation:  0.27272772789001465
local_output_nid generation:  0.013597488403320312
local_in_edges_tensor generation:  0.015279054641723633
mini_batch_src_global generation:  0.03364849090576172
r_  generation:  0.26650333404541016
local_output_nid generation:  0.013422727584838867
local_in_edges_tensor generation:  0.015269756317138672
mini_batch_src_global generation:  0.03404664993286133
r_  generation:  0.26597166061401367
local_output_nid generation:  0.013782262802124023
local_in_edges_tensor generation:  0.014274120330810547
mini_batch_src_global generation:  0.033789634704589844
r_  generation:  0.26872777938842773
local_output_nid generation:  0.013075113296508789
local_in_edges_tensor generation:  0.013952016830444336
mini_batch_src_global generation:  0.034798622131347656
r_  generation:  0.27298855781555176
local_output_nid generation:  0.013945579528808594
local_in_edges_tensor generation:  0.015399694442749023
mini_batch_src_global generation:  0.03619837760925293
r_  generation:  0.27658653259277344
local_output_nid generation:  0.013550519943237305
local_in_edges_tensor generation:  0.014449357986450195
mini_batch_src_global generation:  0.034996747970581055
r_  generation:  0.271259069442749
local_output_nid generation:  0.013723373413085938
local_in_edges_tensor generation:  0.014260530471801758
mini_batch_src_global generation:  0.034175872802734375
r_  generation:  0.2680318355560303
local_output_nid generation:  0.01368260383605957
local_in_edges_tensor generation:  0.015075922012329102
mini_batch_src_global generation:  0.035486459732055664
r_  generation:  0.2777903079986572
local_output_nid generation:  0.013015985488891602
local_in_edges_tensor generation:  0.015674591064453125
mini_batch_src_global generation:  0.0361173152923584
r_  generation:  0.27509140968322754
----------------------check_connections_block total spend ----------------------------- 6.238022804260254
generate_one_block  0.35678601264953613
generate_one_block  0.35544896125793457
generate_one_block  0.34503817558288574
generate_one_block  0.35016655921936035
generate_one_block  0.3506505489349365
generate_one_block  0.34865856170654297
generate_one_block  0.37482357025146484
generate_one_block  0.3477904796600342
generate_one_block  0.337566614151001
generate_one_block  0.34882569313049316
generate_one_block  0.34584856033325195
generate_one_block  0.36969733238220215
generate_one_block  0.3443942070007324
generate_one_block  0.3463411331176758
generate_one_block  0.35332250595092773
generate_one_block  0.3572673797607422
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.031337738037109375
gen group dst list time:  0.0652618408203125
time for parepare:  0.017972230911254883
local_output_nid generation:  0.0269930362701416
local_in_edges_tensor generation:  0.03982901573181152
mini_batch_src_global generation:  0.04026389122009277
r_  generation:  0.4604501724243164
local_output_nid generation:  0.03229045867919922
local_in_edges_tensor generation:  0.03966331481933594
mini_batch_src_global generation:  0.053670644760131836
r_  generation:  0.45533084869384766
local_output_nid generation:  0.03258204460144043
local_in_edges_tensor generation:  0.03108811378479004
mini_batch_src_global generation:  0.05070185661315918
r_  generation:  0.4700901508331299
local_output_nid generation:  0.032320261001586914
local_in_edges_tensor generation:  0.03213763236999512
mini_batch_src_global generation:  0.05149412155151367
r_  generation:  0.46059465408325195
local_output_nid generation:  0.032476186752319336
local_in_edges_tensor generation:  0.07374429702758789
mini_batch_src_global generation:  0.053843021392822266
r_  generation:  0.48067474365234375
local_output_nid generation:  0.03275752067565918
local_in_edges_tensor generation:  0.031775474548339844
mini_batch_src_global generation:  0.05370330810546875
r_  generation:  0.46916913986206055
local_output_nid generation:  0.03412580490112305
local_in_edges_tensor generation:  0.03046274185180664
mini_batch_src_global generation:  0.05320882797241211
r_  generation:  0.48336243629455566
local_output_nid generation:  0.032610416412353516
local_in_edges_tensor generation:  0.03142905235290527
mini_batch_src_global generation:  0.05386972427368164
r_  generation:  0.4704897403717041
local_output_nid generation:  0.03244924545288086
local_in_edges_tensor generation:  0.03165435791015625
mini_batch_src_global generation:  0.05291891098022461
r_  generation:  0.4855196475982666
local_output_nid generation:  0.03273797035217285
local_in_edges_tensor generation:  0.03693795204162598
mini_batch_src_global generation:  0.055823326110839844
r_  generation:  0.4712710380554199
local_output_nid generation:  0.032147884368896484
local_in_edges_tensor generation:  0.03015589714050293
mini_batch_src_global generation:  0.05266141891479492
r_  generation:  0.4829597473144531
local_output_nid generation:  0.03269529342651367
local_in_edges_tensor generation:  0.029889822006225586
mini_batch_src_global generation:  0.055678367614746094
r_  generation:  0.4729959964752197
local_output_nid generation:  0.03238034248352051
local_in_edges_tensor generation:  0.03028726577758789
mini_batch_src_global generation:  0.05253434181213379
r_  generation:  0.48636555671691895
local_output_nid generation:  0.03233766555786133
local_in_edges_tensor generation:  0.03022909164428711
mini_batch_src_global generation:  0.05341672897338867
r_  generation:  0.4684333801269531
local_output_nid generation:  0.03252911567687988
local_in_edges_tensor generation:  0.030094385147094727
mini_batch_src_global generation:  0.05298638343811035
r_  generation:  0.4854574203491211
local_output_nid generation:  0.03247690200805664
local_in_edges_tensor generation:  0.03167152404785156
mini_batch_src_global generation:  0.05487489700317383
r_  generation:  0.4692394733428955
----------------------check_connections_block total spend ----------------------------- 11.190614461898804
generate_one_block  0.5900938510894775
generate_one_block  0.5925617218017578
generate_one_block  0.5854637622833252
generate_one_block  0.5984382629394531
generate_one_block  0.5899550914764404
generate_one_block  0.5956366062164307
generate_one_block  0.5917935371398926
generate_one_block  0.5945730209350586
generate_one_block  0.6557919979095459
generate_one_block  0.5946393013000488
generate_one_block  0.5883834362030029
generate_one_block  0.5904731750488281
generate_one_block  0.5911962985992432
generate_one_block  0.5858721733093262
generate_one_block  0.5947380065917969
generate_one_block  0.596397876739502
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12285470962524414  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

connection checking time:  17.428637266159058
block generation total time  15.168634414672852
average batch blocks generation time:  0.9480396509170532
block dataloader generation time/epoch 35.34818802939521
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09756088256835938  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7691464424133301  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09758949279785156  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7755036354064941  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09723901748657227  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7608141899108887  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09742975234985352  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7710819244384766  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09744930267333984  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7685084342956543  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09758234024047852  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7710142135620117  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09736013412475586  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7664203643798828  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09735345840454102  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7653927803039551  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09716224670410156  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.760554313659668  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09749650955200195  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.771491527557373  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09726095199584961  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7632503509521484  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09770393371582031  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.778203010559082  GigaBytes
Max Memory Allocated: 0.8659343719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09723663330078125  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7622456550598145  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09728336334228516  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7636747360229492  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0975341796875  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7707118988037109  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09753656387329102  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7685952186584473  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06215505301952362 |0.012469470500946045 |0.0034319162368774414 |8.955597877502441e-05 |0.0034850239753723145 |0.0013382434844970703 |
----------------------------------------------------------pseudo_mini_loss sum 1.3589876890182495
Total (block generation + training)time/epoch 36.81727327240838
Training time/epoch 1.3718221187591553
Training time without block to device /epoch 1.1723105907440186
Training time without total dataloading part /epoch 0.11344218254089355
load block tensor time/epoch 0.9944808483123779
block to device time/epoch 0.19951152801513672
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 18 |
Number of nodes for computation during this epoch:  5316500
Number of first layer input nodes during this epoch:  2508237
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.1235513687133789  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021917104721069336
random selection method range initialization spend 0.005002498626708984
time for parepare:  0.017641544342041016
local_output_nid generation:  0.0022666454315185547
local_in_edges_tensor generation:  0.00414729118347168
mini_batch_src_global generation:  0.0017151832580566406
r_  generation:  0.0206601619720459
local_output_nid generation:  0.0028879642486572266
local_in_edges_tensor generation:  0.0017077922821044922
mini_batch_src_global generation:  0.0020422935485839844
r_  generation:  0.02194356918334961
local_output_nid generation:  0.0029249191284179688
local_in_edges_tensor generation:  0.0016884803771972656
mini_batch_src_global generation:  0.0017094612121582031
r_  generation:  0.02151322364807129
local_output_nid generation:  0.0030357837677001953
local_in_edges_tensor generation:  0.0017056465148925781
mini_batch_src_global generation:  0.0016741752624511719
r_  generation:  0.021442413330078125
local_output_nid generation:  0.002954244613647461
local_in_edges_tensor generation:  0.0016736984252929688
mini_batch_src_global generation:  0.0017642974853515625
r_  generation:  0.022592782974243164
local_output_nid generation:  0.0029723644256591797
local_in_edges_tensor generation:  0.0016047954559326172
mini_batch_src_global generation:  0.0017497539520263672
r_  generation:  0.022254467010498047
local_output_nid generation:  0.002933502197265625
local_in_edges_tensor generation:  0.001552581787109375
mini_batch_src_global generation:  0.0017199516296386719
r_  generation:  0.02226114273071289
local_output_nid generation:  0.003016233444213867
local_in_edges_tensor generation:  0.001611948013305664
mini_batch_src_global generation:  0.0017497539520263672
r_  generation:  0.022391557693481445
local_output_nid generation:  0.0029497146606445312
local_in_edges_tensor generation:  0.001603841781616211
mini_batch_src_global generation:  0.0017478466033935547
r_  generation:  0.022400379180908203
local_output_nid generation:  0.002955913543701172
local_in_edges_tensor generation:  0.001615285873413086
mini_batch_src_global generation:  0.0017240047454833984
r_  generation:  0.021867036819458008
local_output_nid generation:  0.0030126571655273438
local_in_edges_tensor generation:  0.0015790462493896484
mini_batch_src_global generation:  0.0018062591552734375
r_  generation:  0.023169755935668945
local_output_nid generation:  0.002978086471557617
local_in_edges_tensor generation:  0.0015916824340820312
mini_batch_src_global generation:  0.0017910003662109375
r_  generation:  0.022780418395996094
local_output_nid generation:  0.0029528141021728516
local_in_edges_tensor generation:  0.0016493797302246094
mini_batch_src_global generation:  0.0017004013061523438
r_  generation:  0.02189946174621582
local_output_nid generation:  0.002984285354614258
local_in_edges_tensor generation:  0.0015742778778076172
mini_batch_src_global generation:  0.0017497539520263672
r_  generation:  0.022412776947021484
local_output_nid generation:  0.002984285354614258
local_in_edges_tensor generation:  0.0016505718231201172
mini_batch_src_global generation:  0.0017578601837158203
r_  generation:  0.022575855255126953
local_output_nid generation:  0.0030727386474609375
local_in_edges_tensor generation:  0.0015714168548583984
mini_batch_src_global generation:  0.001775979995727539
r_  generation:  0.022673368453979492
----------------------check_connections_block total spend ----------------------------- 0.5639863014221191
generate_one_block  0.03001236915588379
generate_one_block  0.03150463104248047
generate_one_block  0.030723094940185547
generate_one_block  0.030758380889892578
generate_one_block  0.03208327293395996
generate_one_block  0.0335843563079834
generate_one_block  0.031340599060058594
generate_one_block  0.031113862991333008
generate_one_block  0.030921459197998047
generate_one_block  0.0307157039642334
generate_one_block  0.03213310241699219
generate_one_block  0.03173041343688965
generate_one_block  0.03117680549621582
generate_one_block  0.031162023544311523
generate_one_block  0.031450510025024414
generate_one_block  0.032070159912109375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03558921813964844
gen group dst list time:  0.01742386817932129
time for parepare:  0.019023656845092773
local_output_nid generation:  0.008929729461669922
local_in_edges_tensor generation:  0.021297693252563477
mini_batch_src_global generation:  0.026460647583007812
r_  generation:  0.24698162078857422
local_output_nid generation:  0.013962507247924805
local_in_edges_tensor generation:  0.018504858016967773
mini_batch_src_global generation:  0.0331265926361084
r_  generation:  0.2525665760040283
local_output_nid generation:  0.013213634490966797
local_in_edges_tensor generation:  0.015929222106933594
mini_batch_src_global generation:  0.03137397766113281
r_  generation:  0.2624063491821289
local_output_nid generation:  0.01363682746887207
local_in_edges_tensor generation:  0.014060735702514648
mini_batch_src_global generation:  0.03157520294189453
r_  generation:  0.2582399845123291
local_output_nid generation:  0.013630151748657227
local_in_edges_tensor generation:  0.017593860626220703
mini_batch_src_global generation:  0.03564953804016113
r_  generation:  0.27538585662841797
local_output_nid generation:  0.01337742805480957
local_in_edges_tensor generation:  0.013735055923461914
mini_batch_src_global generation:  0.033599853515625
r_  generation:  0.26436758041381836
local_output_nid generation:  0.013684988021850586
local_in_edges_tensor generation:  0.022634029388427734
mini_batch_src_global generation:  0.03554701805114746
r_  generation:  0.27207422256469727
local_output_nid generation:  0.013738632202148438
local_in_edges_tensor generation:  0.016035795211791992
mini_batch_src_global generation:  0.03415989875793457
r_  generation:  0.270841121673584
local_output_nid generation:  0.013593912124633789
local_in_edges_tensor generation:  0.014233827590942383
mini_batch_src_global generation:  0.034371137619018555
r_  generation:  0.2741713523864746
local_output_nid generation:  0.013506174087524414
local_in_edges_tensor generation:  0.013595342636108398
mini_batch_src_global generation:  0.03385591506958008
r_  generation:  0.26749753952026367
local_output_nid generation:  0.01364755630493164
local_in_edges_tensor generation:  0.015967845916748047
mini_batch_src_global generation:  0.0365443229675293
r_  generation:  0.2809431552886963
local_output_nid generation:  0.013800621032714844
local_in_edges_tensor generation:  0.014208555221557617
mini_batch_src_global generation:  0.037287235260009766
r_  generation:  0.27381229400634766
local_output_nid generation:  0.013634204864501953
local_in_edges_tensor generation:  0.014869451522827148
mini_batch_src_global generation:  0.03424978256225586
r_  generation:  0.2712256908416748
local_output_nid generation:  0.013796806335449219
local_in_edges_tensor generation:  0.015028953552246094
mini_batch_src_global generation:  0.03406882286071777
r_  generation:  0.26746106147766113
local_output_nid generation:  0.013678312301635742
local_in_edges_tensor generation:  0.014207601547241211
mini_batch_src_global generation:  0.034827470779418945
r_  generation:  0.27420496940612793
local_output_nid generation:  0.013665914535522461
local_in_edges_tensor generation:  0.015091180801391602
mini_batch_src_global generation:  0.036730289459228516
r_  generation:  0.27570438385009766
----------------------check_connections_block total spend ----------------------------- 6.233933448791504
generate_one_block  0.3421797752380371
generate_one_block  0.3394031524658203
generate_one_block  0.34521961212158203
generate_one_block  0.3370075225830078
generate_one_block  0.35349178314208984
generate_one_block  0.35335636138916016
generate_one_block  0.37911438941955566
generate_one_block  0.3521742820739746
generate_one_block  0.3465275764465332
generate_one_block  0.34868836402893066
generate_one_block  0.36019110679626465
generate_one_block  0.35437893867492676
generate_one_block  0.34549403190612793
generate_one_block  0.3490638732910156
generate_one_block  0.3535747528076172
generate_one_block  0.3616218566894531
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029721736907958984
gen group dst list time:  0.06509804725646973
time for parepare:  0.01783156394958496
local_output_nid generation:  0.027884244918823242
local_in_edges_tensor generation:  0.043605804443359375
mini_batch_src_global generation:  0.0425417423248291
r_  generation:  0.45847344398498535
local_output_nid generation:  0.032743215560913086
local_in_edges_tensor generation:  0.03815484046936035
mini_batch_src_global generation:  0.05564379692077637
r_  generation:  0.4559614658355713
local_output_nid generation:  0.032790184020996094
local_in_edges_tensor generation:  0.030002117156982422
mini_batch_src_global generation:  0.05085921287536621
r_  generation:  0.4675631523132324
local_output_nid generation:  0.03274083137512207
local_in_edges_tensor generation:  0.03473067283630371
mini_batch_src_global generation:  0.05231022834777832
r_  generation:  0.46517324447631836
local_output_nid generation:  0.032724618911743164
local_in_edges_tensor generation:  0.07411408424377441
mini_batch_src_global generation:  0.05213308334350586
r_  generation:  0.47722387313842773
local_output_nid generation:  0.032591819763183594
local_in_edges_tensor generation:  0.029997587203979492
mini_batch_src_global generation:  0.05632305145263672
r_  generation:  0.4661684036254883
local_output_nid generation:  0.032613515853881836
local_in_edges_tensor generation:  0.03143644332885742
mini_batch_src_global generation:  0.05469465255737305
r_  generation:  0.47822070121765137
local_output_nid generation:  0.03258538246154785
local_in_edges_tensor generation:  0.030352115631103516
mini_batch_src_global generation:  0.057221174240112305
r_  generation:  0.4687972068786621
local_output_nid generation:  0.032711029052734375
local_in_edges_tensor generation:  0.031577110290527344
mini_batch_src_global generation:  0.053548336029052734
r_  generation:  0.47722554206848145
local_output_nid generation:  0.034010887145996094
local_in_edges_tensor generation:  0.029912948608398438
mini_batch_src_global generation:  0.05461454391479492
r_  generation:  0.46793675422668457
local_output_nid generation:  0.03287053108215332
local_in_edges_tensor generation:  0.031225919723510742
mini_batch_src_global generation:  0.05306649208068848
r_  generation:  0.47918081283569336
local_output_nid generation:  0.0327763557434082
local_in_edges_tensor generation:  0.034067630767822266
mini_batch_src_global generation:  0.05614280700683594
r_  generation:  0.4722013473510742
local_output_nid generation:  0.03285813331604004
local_in_edges_tensor generation:  0.03012681007385254
mini_batch_src_global generation:  0.053896427154541016
r_  generation:  0.4799356460571289
local_output_nid generation:  0.03269004821777344
local_in_edges_tensor generation:  0.03072667121887207
mini_batch_src_global generation:  0.05470466613769531
r_  generation:  0.47040510177612305
local_output_nid generation:  0.03303861618041992
local_in_edges_tensor generation:  0.0302889347076416
mini_batch_src_global generation:  0.05372500419616699
r_  generation:  0.4827272891998291
local_output_nid generation:  0.03311634063720703
local_in_edges_tensor generation:  0.034567832946777344
mini_batch_src_global generation:  0.05473041534423828
r_  generation:  0.47032761573791504
----------------------check_connections_block total spend ----------------------------- 11.182003021240234
generate_one_block  0.5932967662811279
generate_one_block  0.5899984836578369
generate_one_block  0.5894262790679932
generate_one_block  0.585789680480957
generate_one_block  0.5912318229675293
generate_one_block  0.595388650894165
generate_one_block  0.5858232975006104
generate_one_block  0.5912549495697021
generate_one_block  0.631800651550293
generate_one_block  0.5918779373168945
generate_one_block  0.589900016784668
generate_one_block  0.5971405506134033
generate_one_block  0.590768575668335
generate_one_block  0.5906209945678711
generate_one_block  0.5957460403442383
generate_one_block  0.5992872714996338
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.1235513687133789  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

connection checking time:  17.41593647003174
block generation total time  15.130839347839355
average batch blocks generation time:  0.9456774592399597
block dataloader generation time/epoch 35.28113026618958
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09726381301879883  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7635693550109863  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09741973876953125  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7656521797180176  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0973811149597168  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7653675079345703  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0973820686340332  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7658681869506836  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09766864776611328  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.775294303894043  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09734010696411133  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7646121978759766  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09747505187988281  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7655553817749023  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09758663177490234  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.771204948425293  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09730768203735352  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7650480270385742  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09739828109741211  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7644009590148926  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09756755828857422  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.771204948425293  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09748983383178711  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7754092216491699  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09727239608764648  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7642288208007812  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09741401672363281  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7664213180541992  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09740447998046875  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7644729614257812  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09768199920654297  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7756986618041992  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06749045848846436 |0.011346861720085144 |0.0035247504711151123 |9.138882160186768e-05 |0.0037074387073516846 |0.0031061172485351562 |
----------------------------------------------------------pseudo_mini_loss sum 1.3422268629074097
Total (block generation + training)time/epoch 36.74860239028931
Training time/epoch 1.452683448791504
Training time without block to device /epoch 1.2711336612701416
Training time without total dataloading part /epoch 0.12028336524963379
load block tensor time/epoch 1.0798473358154297
block to device time/epoch 0.1815497875213623
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 19 |
Number of nodes for computation during this epoch:  5318317
Number of first layer input nodes during this epoch:  2509311
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.1238856315612793  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023263216018676758
random selection method range initialization spend 0.004802227020263672
time for parepare:  0.017052888870239258
local_output_nid generation:  0.002304553985595703
local_in_edges_tensor generation:  0.004220724105834961
mini_batch_src_global generation:  0.0017595291137695312
r_  generation:  0.0216062068939209
local_output_nid generation:  0.0028896331787109375
local_in_edges_tensor generation:  0.0030999183654785156
mini_batch_src_global generation:  0.0021066665649414062
r_  generation:  0.022199392318725586
local_output_nid generation:  0.002968311309814453
local_in_edges_tensor generation:  0.0017919540405273438
mini_batch_src_global generation:  0.0017402172088623047
r_  generation:  0.021314620971679688
local_output_nid generation:  0.002971649169921875
local_in_edges_tensor generation:  0.0017323493957519531
mini_batch_src_global generation:  0.0017685890197753906
r_  generation:  0.02216315269470215
local_output_nid generation:  0.0029811859130859375
local_in_edges_tensor generation:  0.0016400814056396484
mini_batch_src_global generation:  0.0017650127410888672
r_  generation:  0.021619558334350586
local_output_nid generation:  0.0029959678649902344
local_in_edges_tensor generation:  0.0016858577728271484
mini_batch_src_global generation:  0.0017278194427490234
r_  generation:  0.022239208221435547
local_output_nid generation:  0.002956390380859375
local_in_edges_tensor generation:  0.0016803741455078125
mini_batch_src_global generation:  0.001771688461303711
r_  generation:  0.021965503692626953
local_output_nid generation:  0.0029752254486083984
local_in_edges_tensor generation:  0.0016083717346191406
mini_batch_src_global generation:  0.001786947250366211
r_  generation:  0.022706985473632812
local_output_nid generation:  0.002992868423461914
local_in_edges_tensor generation:  0.0016298294067382812
mini_batch_src_global generation:  0.0017819404602050781
r_  generation:  0.022005081176757812
local_output_nid generation:  0.002968311309814453
local_in_edges_tensor generation:  0.0015823841094970703
mini_batch_src_global generation:  0.0017290115356445312
r_  generation:  0.022014617919921875
local_output_nid generation:  0.0030264854431152344
local_in_edges_tensor generation:  0.0016355514526367188
mini_batch_src_global generation:  0.0018095970153808594
r_  generation:  0.021715879440307617
local_output_nid generation:  0.0029954910278320312
local_in_edges_tensor generation:  0.001600503921508789
mini_batch_src_global generation:  0.0017399787902832031
r_  generation:  0.02221989631652832
local_output_nid generation:  0.002992391586303711
local_in_edges_tensor generation:  0.0015413761138916016
mini_batch_src_global generation:  0.0017337799072265625
r_  generation:  0.021898269653320312
local_output_nid generation:  0.0029685497283935547
local_in_edges_tensor generation:  0.0015854835510253906
mini_batch_src_global generation:  0.0016872882843017578
r_  generation:  0.02171158790588379
local_output_nid generation:  0.00301361083984375
local_in_edges_tensor generation:  0.001531839370727539
mini_batch_src_global generation:  0.0017807483673095703
r_  generation:  0.022597551345825195
local_output_nid generation:  0.00293731689453125
local_in_edges_tensor generation:  0.003187894821166992
mini_batch_src_global generation:  0.0017423629760742188
r_  generation:  0.021710872650146484
----------------------check_connections_block total spend ----------------------------- 0.5654065608978271
generate_one_block  0.031780242919921875
generate_one_block  0.03118753433227539
generate_one_block  0.030489683151245117
generate_one_block  0.032118797302246094
generate_one_block  0.030856847763061523
generate_one_block  0.03448224067687988
generate_one_block  0.031252384185791016
generate_one_block  0.03192639350891113
generate_one_block  0.030890941619873047
generate_one_block  0.03102874755859375
generate_one_block  0.031102418899536133
generate_one_block  0.03138136863708496
generate_one_block  0.03113269805908203
generate_one_block  0.03095841407775879
generate_one_block  0.03164339065551758
generate_one_block  0.03064703941345215
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.038231849670410156
gen group dst list time:  0.017804622650146484
time for parepare:  0.01990675926208496
local_output_nid generation:  0.009510993957519531
local_in_edges_tensor generation:  0.02494668960571289
mini_batch_src_global generation:  0.02812051773071289
r_  generation:  0.2582707405090332
local_output_nid generation:  0.013187646865844727
local_in_edges_tensor generation:  0.018799781799316406
mini_batch_src_global generation:  0.04131031036376953
r_  generation:  0.25644564628601074
local_output_nid generation:  0.014884233474731445
local_in_edges_tensor generation:  0.01671886444091797
mini_batch_src_global generation:  0.0382838249206543
r_  generation:  0.2635633945465088
local_output_nid generation:  0.014421701431274414
local_in_edges_tensor generation:  0.01801586151123047
mini_batch_src_global generation:  0.03478431701660156
r_  generation:  0.2710072994232178
local_output_nid generation:  0.013843297958374023
local_in_edges_tensor generation:  0.014329671859741211
mini_batch_src_global generation:  0.03476548194885254
r_  generation:  0.2722132205963135
local_output_nid generation:  0.014026880264282227
local_in_edges_tensor generation:  0.014094829559326172
mini_batch_src_global generation:  0.03353595733642578
r_  generation:  0.26804447174072266
local_output_nid generation:  0.014240026473999023
local_in_edges_tensor generation:  0.01405954360961914
mini_batch_src_global generation:  0.03420519828796387
r_  generation:  0.2709646224975586
local_output_nid generation:  0.01459050178527832
local_in_edges_tensor generation:  0.016018152236938477
mini_batch_src_global generation:  0.03639960289001465
r_  generation:  0.27838850021362305
local_output_nid generation:  0.014268636703491211
local_in_edges_tensor generation:  0.013885259628295898
mini_batch_src_global generation:  0.037412405014038086
r_  generation:  0.2704348564147949
local_output_nid generation:  0.014163494110107422
local_in_edges_tensor generation:  0.013991832733154297
mini_batch_src_global generation:  0.03401541709899902
r_  generation:  0.2679011821746826
local_output_nid generation:  0.014016151428222656
local_in_edges_tensor generation:  0.013737201690673828
mini_batch_src_global generation:  0.03491806983947754
r_  generation:  0.2696390151977539
local_output_nid generation:  0.014271259307861328
local_in_edges_tensor generation:  0.014865398406982422
mini_batch_src_global generation:  0.03617715835571289
r_  generation:  0.27442312240600586
local_output_nid generation:  0.014131307601928711
local_in_edges_tensor generation:  0.016500473022460938
mini_batch_src_global generation:  0.03528547286987305
r_  generation:  0.2759232521057129
local_output_nid generation:  0.014220237731933594
local_in_edges_tensor generation:  0.013874292373657227
mini_batch_src_global generation:  0.03444814682006836
r_  generation:  0.271043062210083
local_output_nid generation:  0.014443397521972656
local_in_edges_tensor generation:  0.015068531036376953
mini_batch_src_global generation:  0.03730297088623047
r_  generation:  0.28153300285339355
local_output_nid generation:  0.013694047927856445
local_in_edges_tensor generation:  0.014949321746826172
mini_batch_src_global generation:  0.034455299377441406
r_  generation:  0.2643418312072754
----------------------check_connections_block total spend ----------------------------- 6.2912187576293945
generate_one_block  0.36339592933654785
generate_one_block  0.3416938781738281
generate_one_block  0.3494408130645752
generate_one_block  0.3604092597961426
generate_one_block  0.3551158905029297
generate_one_block  0.34775781631469727
generate_one_block  0.37882304191589355
generate_one_block  0.3582158088684082
generate_one_block  0.3459298610687256
generate_one_block  0.34571266174316406
generate_one_block  0.34154343605041504
generate_one_block  0.35171079635620117
generate_one_block  0.3502473831176758
generate_one_block  0.34346771240234375
generate_one_block  0.35233354568481445
generate_one_block  0.33422327041625977
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03242182731628418
gen group dst list time:  0.06521224975585938
time for parepare:  0.01771235466003418
local_output_nid generation:  0.028006792068481445
local_in_edges_tensor generation:  0.04614901542663574
mini_batch_src_global generation:  0.04291105270385742
r_  generation:  0.4564495086669922
local_output_nid generation:  0.03301215171813965
local_in_edges_tensor generation:  0.03932523727416992
mini_batch_src_global generation:  0.054174184799194336
r_  generation:  0.455031156539917
local_output_nid generation:  0.03267836570739746
local_in_edges_tensor generation:  0.030436992645263672
mini_batch_src_global generation:  0.05175161361694336
r_  generation:  0.46478891372680664
local_output_nid generation:  0.032653093338012695
local_in_edges_tensor generation:  0.032273292541503906
mini_batch_src_global generation:  0.05647087097167969
r_  generation:  0.4654369354248047
local_output_nid generation:  0.0326533317565918
local_in_edges_tensor generation:  0.07360339164733887
mini_batch_src_global generation:  0.05247783660888672
r_  generation:  0.47511982917785645
local_output_nid generation:  0.032689809799194336
local_in_edges_tensor generation:  0.031897544860839844
mini_batch_src_global generation:  0.05511665344238281
r_  generation:  0.4684774875640869
local_output_nid generation:  0.03270840644836426
local_in_edges_tensor generation:  0.030445098876953125
mini_batch_src_global generation:  0.05324912071228027
r_  generation:  0.47832202911376953
local_output_nid generation:  0.03270530700683594
local_in_edges_tensor generation:  0.0342714786529541
mini_batch_src_global generation:  0.05370593070983887
r_  generation:  0.4704477787017822
local_output_nid generation:  0.03267836570739746
local_in_edges_tensor generation:  0.030494213104248047
mini_batch_src_global generation:  0.05514693260192871
r_  generation:  0.47745776176452637
local_output_nid generation:  0.03255295753479004
local_in_edges_tensor generation:  0.030312299728393555
mini_batch_src_global generation:  0.05463981628417969
r_  generation:  0.47092223167419434
local_output_nid generation:  0.032677412033081055
local_in_edges_tensor generation:  0.030312538146972656
mini_batch_src_global generation:  0.05323648452758789
r_  generation:  0.4756886959075928
local_output_nid generation:  0.03256988525390625
local_in_edges_tensor generation:  0.034945011138916016
mini_batch_src_global generation:  0.054285287857055664
r_  generation:  0.4682600498199463
local_output_nid generation:  0.03248715400695801
local_in_edges_tensor generation:  0.03233170509338379
mini_batch_src_global generation:  0.052800893783569336
r_  generation:  0.4783823490142822
local_output_nid generation:  0.03274846076965332
local_in_edges_tensor generation:  0.03210020065307617
mini_batch_src_global generation:  0.05449175834655762
r_  generation:  0.47166967391967773
local_output_nid generation:  0.032854318618774414
local_in_edges_tensor generation:  0.03240156173706055
mini_batch_src_global generation:  0.053226470947265625
r_  generation:  0.4813258647918701
local_output_nid generation:  0.03258919715881348
local_in_edges_tensor generation:  0.0305325984954834
mini_batch_src_global generation:  0.05413174629211426
r_  generation:  0.47716498374938965
----------------------check_connections_block total spend ----------------------------- 11.17286491394043
generate_one_block  0.5890746116638184
generate_one_block  0.5959293842315674
generate_one_block  0.5904617309570312
generate_one_block  0.5979456901550293
generate_one_block  0.5937423706054688
generate_one_block  0.5908503532409668
generate_one_block  0.5935871601104736
generate_one_block  0.5927891731262207
generate_one_block  0.6542699337005615
generate_one_block  0.5922894477844238
generate_one_block  0.5904755592346191
generate_one_block  0.5960297584533691
generate_one_block  0.5912375450134277
generate_one_block  0.5979270935058594
generate_one_block  0.6015462875366211
generate_one_block  0.5849065780639648
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.1238856315612793  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

connection checking time:  17.464083671569824
block generation total time  15.173083782196045
average batch blocks generation time:  0.9483177363872528
block dataloader generation time/epoch 35.23842430114746
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09758281707763672  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7713770866394043  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09748172760009766  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.769737720489502  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09739828109741211  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7650876045227051  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09760618209838867  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7712216377258301  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09752368927001953  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7673349380493164  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09744882583618164  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7669239044189453  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09742212295532227  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7666497230529785  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09763669967651367  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7724065780639648  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09750986099243164  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7695050239562988  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09723138809204102  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7649679183959961  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09720373153686523  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7637581825256348  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0975503921508789  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7681789398193359  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09750795364379883  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7674975395202637  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0972452163696289  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7639684677124023  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09769201278686523  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7758016586303711  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09713935852050781  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7600603103637695  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06326773762702942 |0.012258008122444153 |0.0035154223442077637 |9.12100076675415e-05 |0.003529757261276245 |0.0016524791717529297 |
----------------------------------------------------------pseudo_mini_loss sum 1.3309332132339478
Total (block generation + training)time/epoch 36.69868020577864
Training time/epoch 1.3879063129425049
Training time without block to device /epoch 1.1917781829833984
Training time without total dataloading part /epoch 0.11583471298217773
load block tensor time/epoch 1.0122838020324707
block to device time/epoch 0.19612812995910645
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 20 |
Number of nodes for computation during this epoch:  5318852
Number of first layer input nodes during this epoch:  2509479
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.1225900650024414  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026194334030151367
random selection method range initialization spend 0.005590915679931641
time for parepare:  0.017149925231933594
local_output_nid generation:  0.002374410629272461
local_in_edges_tensor generation:  0.004000663757324219
mini_batch_src_global generation:  0.0018129348754882812
r_  generation:  0.021512985229492188
local_output_nid generation:  0.002923250198364258
local_in_edges_tensor generation:  0.0018393993377685547
mini_batch_src_global generation:  0.0020606517791748047
r_  generation:  0.02153944969177246
local_output_nid generation:  0.0029404163360595703
local_in_edges_tensor generation:  0.001852273941040039
mini_batch_src_global generation:  0.001691579818725586
r_  generation:  0.02145671844482422
local_output_nid generation:  0.0029778480529785156
local_in_edges_tensor generation:  0.001641988754272461
mini_batch_src_global generation:  0.0018112659454345703
r_  generation:  0.021401405334472656
local_output_nid generation:  0.0029506683349609375
local_in_edges_tensor generation:  0.0016489028930664062
mini_batch_src_global generation:  0.00177001953125
r_  generation:  0.021250009536743164
local_output_nid generation:  0.0029680728912353516
local_in_edges_tensor generation:  0.0016546249389648438
mini_batch_src_global generation:  0.0017113685607910156
r_  generation:  0.021950244903564453
local_output_nid generation:  0.0029671192169189453
local_in_edges_tensor generation:  0.0016529560089111328
mini_batch_src_global generation:  0.0017812252044677734
r_  generation:  0.022362709045410156
local_output_nid generation:  0.0029723644256591797
local_in_edges_tensor generation:  0.0016434192657470703
mini_batch_src_global generation:  0.0017752647399902344
r_  generation:  0.02141547203063965
local_output_nid generation:  0.002994060516357422
local_in_edges_tensor generation:  0.0016210079193115234
mini_batch_src_global generation:  0.001775979995727539
r_  generation:  0.02249431610107422
local_output_nid generation:  0.0029790401458740234
local_in_edges_tensor generation:  0.0016045570373535156
mini_batch_src_global generation:  0.001771688461303711
r_  generation:  0.021959781646728516
local_output_nid generation:  0.0029621124267578125
local_in_edges_tensor generation:  0.001619577407836914
mini_batch_src_global generation:  0.0018575191497802734
r_  generation:  0.022594213485717773
local_output_nid generation:  0.003000020980834961
local_in_edges_tensor generation:  0.0015933513641357422
mini_batch_src_global generation:  0.0018475055694580078
r_  generation:  0.02239203453063965
local_output_nid generation:  0.0029370784759521484
local_in_edges_tensor generation:  0.0015988349914550781
mini_batch_src_global generation:  0.0017991065979003906
r_  generation:  0.021728992462158203
local_output_nid generation:  0.0029828548431396484
local_in_edges_tensor generation:  0.0016226768493652344
mini_batch_src_global generation:  0.0017993450164794922
r_  generation:  0.02258896827697754
local_output_nid generation:  0.0029311180114746094
local_in_edges_tensor generation:  0.0016183853149414062
mini_batch_src_global generation:  0.0017578601837158203
r_  generation:  0.0213620662689209
local_output_nid generation:  0.0029304027557373047
local_in_edges_tensor generation:  0.0016469955444335938
mini_batch_src_global generation:  0.0017445087432861328
r_  generation:  0.02162003517150879
----------------------check_connections_block total spend ----------------------------- 0.5596070289611816
generate_one_block  0.031382083892822266
generate_one_block  0.03127408027648926
generate_one_block  0.03127098083496094
generate_one_block  0.03130483627319336
generate_one_block  0.03070664405822754
generate_one_block  0.03350567817687988
generate_one_block  0.03190112113952637
generate_one_block  0.030565500259399414
generate_one_block  0.03160667419433594
generate_one_block  0.031247854232788086
generate_one_block  0.031934499740600586
generate_one_block  0.03137779235839844
generate_one_block  0.031052827835083008
generate_one_block  0.0323793888092041
generate_one_block  0.030373334884643555
generate_one_block  0.03120708465576172
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03414487838745117
gen group dst list time:  0.0177004337310791
time for parepare:  0.019290685653686523
local_output_nid generation:  0.009376287460327148
local_in_edges_tensor generation:  0.023897886276245117
mini_batch_src_global generation:  0.02800774574279785
r_  generation:  0.25462961196899414
local_output_nid generation:  0.013294696807861328
local_in_edges_tensor generation:  0.018814802169799805
mini_batch_src_global generation:  0.037987470626831055
r_  generation:  0.2555372714996338
local_output_nid generation:  0.013674020767211914
local_in_edges_tensor generation:  0.018650531768798828
mini_batch_src_global generation:  0.03247380256652832
r_  generation:  0.26612138748168945
local_output_nid generation:  0.013874530792236328
local_in_edges_tensor generation:  0.013921737670898438
mini_batch_src_global generation:  0.03215599060058594
r_  generation:  0.268660306930542
local_output_nid generation:  0.013218879699707031
local_in_edges_tensor generation:  0.016645431518554688
mini_batch_src_global generation:  0.03381919860839844
r_  generation:  0.26552629470825195
local_output_nid generation:  0.013611316680908203
local_in_edges_tensor generation:  0.014028072357177734
mini_batch_src_global generation:  0.03339815139770508
r_  generation:  0.2674860954284668
local_output_nid generation:  0.013897418975830078
local_in_edges_tensor generation:  0.015368223190307617
mini_batch_src_global generation:  0.034829139709472656
r_  generation:  0.2760143280029297
local_output_nid generation:  0.013571977615356445
local_in_edges_tensor generation:  0.017231225967407227
mini_batch_src_global generation:  0.033864736557006836
r_  generation:  0.26409268379211426
local_output_nid generation:  0.014066219329833984
local_in_edges_tensor generation:  0.01408243179321289
mini_batch_src_global generation:  0.03498077392578125
r_  generation:  0.27479124069213867
local_output_nid generation:  0.013715744018554688
local_in_edges_tensor generation:  0.014230489730834961
mini_batch_src_global generation:  0.03398919105529785
r_  generation:  0.270519495010376
local_output_nid generation:  0.014099836349487305
local_in_edges_tensor generation:  0.02257847785949707
mini_batch_src_global generation:  0.037027835845947266
r_  generation:  0.28365230560302734
local_output_nid generation:  0.01371002197265625
local_in_edges_tensor generation:  0.014183998107910156
mini_batch_src_global generation:  0.034935712814331055
r_  generation:  0.2745652198791504
local_output_nid generation:  0.013916492462158203
local_in_edges_tensor generation:  0.015004873275756836
mini_batch_src_global generation:  0.03492140769958496
r_  generation:  0.27375078201293945
local_output_nid generation:  0.013979673385620117
local_in_edges_tensor generation:  0.0168154239654541
mini_batch_src_global generation:  0.03544163703918457
r_  generation:  0.27892303466796875
local_output_nid generation:  0.013659000396728516
local_in_edges_tensor generation:  0.01386713981628418
mini_batch_src_global generation:  0.035130977630615234
r_  generation:  0.2730875015258789
local_output_nid generation:  0.013948678970336914
local_in_edges_tensor generation:  0.015312910079956055
mini_batch_src_global generation:  0.03392815589904785
r_  generation:  0.26787400245666504
----------------------check_connections_block total spend ----------------------------- 6.278940916061401
generate_one_block  0.35636377334594727
generate_one_block  0.34823083877563477
generate_one_block  0.3522961139678955
generate_one_block  0.3531076908111572
generate_one_block  0.3431968688964844
generate_one_block  0.3506629467010498
generate_one_block  0.3834547996520996
generate_one_block  0.3393113613128662
generate_one_block  0.35185980796813965
generate_one_block  0.36000967025756836
generate_one_block  0.3612997531890869
generate_one_block  0.35278773307800293
generate_one_block  0.35228514671325684
generate_one_block  0.36248230934143066
generate_one_block  0.3448209762573242
generate_one_block  0.35004210472106934
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03594636917114258
gen group dst list time:  0.07008624076843262
time for parepare:  0.018058300018310547
local_output_nid generation:  0.028397560119628906
local_in_edges_tensor generation:  0.04712963104248047
mini_batch_src_global generation:  0.04164862632751465
r_  generation:  0.4633769989013672
local_output_nid generation:  0.03348064422607422
local_in_edges_tensor generation:  0.03845953941345215
mini_batch_src_global generation:  0.0541074275970459
r_  generation:  0.4593183994293213
local_output_nid generation:  0.03309011459350586
local_in_edges_tensor generation:  0.03250312805175781
mini_batch_src_global generation:  0.05366683006286621
r_  generation:  0.4692118167877197
local_output_nid generation:  0.03315877914428711
local_in_edges_tensor generation:  0.03247642517089844
mini_batch_src_global generation:  0.054978370666503906
r_  generation:  0.4672064781188965
local_output_nid generation:  0.03302192687988281
local_in_edges_tensor generation:  0.07388424873352051
mini_batch_src_global generation:  0.05184292793273926
r_  generation:  0.4776265621185303
local_output_nid generation:  0.03302764892578125
local_in_edges_tensor generation:  0.03425765037536621
mini_batch_src_global generation:  0.05353116989135742
r_  generation:  0.46733832359313965
local_output_nid generation:  0.032874107360839844
local_in_edges_tensor generation:  0.0366668701171875
mini_batch_src_global generation:  0.052605628967285156
r_  generation:  0.4814333915710449
local_output_nid generation:  0.03287220001220703
local_in_edges_tensor generation:  0.030539751052856445
mini_batch_src_global generation:  0.056273460388183594
r_  generation:  0.4671022891998291
local_output_nid generation:  0.033034563064575195
local_in_edges_tensor generation:  0.03159689903259277
mini_batch_src_global generation:  0.05284476280212402
r_  generation:  0.48528504371643066
local_output_nid generation:  0.032825469970703125
local_in_edges_tensor generation:  0.03116750717163086
mini_batch_src_global generation:  0.054318904876708984
r_  generation:  0.4721255302429199
local_output_nid generation:  0.033069610595703125
local_in_edges_tensor generation:  0.03090691566467285
mini_batch_src_global generation:  0.05480694770812988
r_  generation:  0.4841456413269043
local_output_nid generation:  0.03310108184814453
local_in_edges_tensor generation:  0.034232139587402344
mini_batch_src_global generation:  0.054758310317993164
r_  generation:  0.47159337997436523
local_output_nid generation:  0.032569169998168945
local_in_edges_tensor generation:  0.03301596641540527
mini_batch_src_global generation:  0.05330634117126465
r_  generation:  0.4813880920410156
local_output_nid generation:  0.03316068649291992
local_in_edges_tensor generation:  0.0307157039642334
mini_batch_src_global generation:  0.05447745323181152
r_  generation:  0.4698984622955322
local_output_nid generation:  0.0327913761138916
local_in_edges_tensor generation:  0.031094789505004883
mini_batch_src_global generation:  0.05274343490600586
r_  generation:  0.48029494285583496
local_output_nid generation:  0.032735347747802734
local_in_edges_tensor generation:  0.030481338500976562
mini_batch_src_global generation:  0.053945064544677734
r_  generation:  0.46842050552368164
----------------------check_connections_block total spend ----------------------------- 11.225817441940308
generate_one_block  0.5957815647125244
generate_one_block  0.5911364555358887
generate_one_block  0.5907289981842041
generate_one_block  0.5907557010650635
generate_one_block  0.5913560390472412
generate_one_block  0.5923576354980469
generate_one_block  0.595238208770752
generate_one_block  0.5909707546234131
generate_one_block  0.6309506893157959
generate_one_block  0.5882453918457031
generate_one_block  0.5986530780792236
generate_one_block  0.5924761295318604
generate_one_block  0.5899553298950195
generate_one_block  0.595329999923706
generate_one_block  0.5878748893737793
generate_one_block  0.595970630645752
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.1225900650024414  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

connection checking time:  17.50475835800171
block generation total time  15.179993391036987
average batch blocks generation time:  0.9487495869398117
block dataloader generation time/epoch 35.20764305194219
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09768486022949219  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7748908996582031  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09717845916748047  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7646822929382324  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09737825393676758  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7661185264587402  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0974264144897461  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7656345367431641  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09741735458374023  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7688207626342773  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09753131866455078  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7701811790466309  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09761571884155273  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7745695114135742  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09720373153686523  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7621903419494629  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09765434265136719  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7748708724975586  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09730195999145508  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7635564804077148  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09780311584472656  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7762451171875  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09728670120239258  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7705626487731934  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09736347198486328  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7648096084594727  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09753704071044922  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.775174617767334  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09726381301879883  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7604002952575684  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0973806381225586  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7653136253356934  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06403905153274536 |0.010332778096199036 |0.0035155117511749268 |9.265542030334473e-05 |0.0031988322734832764 |0.0018267631530761719 |
----------------------------------------------------------pseudo_mini_loss sum 1.3167699575424194
Total (block generation + training)time/epoch 36.66003920634588
Training time/epoch 1.365734338760376
Training time without block to device /epoch 1.2004098892211914
Training time without total dataloading part /epoch 0.11073875427246094
load block tensor time/epoch 1.0246248245239258
block to device time/epoch 0.16532444953918457
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 21 |
Number of nodes for computation during this epoch:  5319074
Number of first layer input nodes during this epoch:  2508958
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.1229705810546875  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018142223358154297
random selection method range initialization spend 0.00543212890625
time for parepare:  0.018759489059448242
local_output_nid generation:  0.002407550811767578
local_in_edges_tensor generation:  0.004167318344116211
mini_batch_src_global generation:  0.0017592906951904297
r_  generation:  0.020839691162109375
local_output_nid generation:  0.002880573272705078
local_in_edges_tensor generation:  0.0017690658569335938
mini_batch_src_global generation:  0.0020966529846191406
r_  generation:  0.023071765899658203
local_output_nid generation:  0.002955198287963867
local_in_edges_tensor generation:  0.0017616748809814453
mini_batch_src_global generation:  0.0017032623291015625
r_  generation:  0.020877838134765625
local_output_nid generation:  0.003045320510864258
local_in_edges_tensor generation:  0.0016045570373535156
mini_batch_src_global generation:  0.001783132553100586
r_  generation:  0.022340059280395508
local_output_nid generation:  0.002981424331665039
local_in_edges_tensor generation:  0.0016655921936035156
mini_batch_src_global generation:  0.0017468929290771484
r_  generation:  0.021610736846923828
local_output_nid generation:  0.0029821395874023438
local_in_edges_tensor generation:  0.0016672611236572266
mini_batch_src_global generation:  0.0017614364624023438
r_  generation:  0.022076845169067383
local_output_nid generation:  0.0030355453491210938
local_in_edges_tensor generation:  0.0016033649444580078
mini_batch_src_global generation:  0.0017840862274169922
r_  generation:  0.022501707077026367
local_output_nid generation:  0.0030145645141601562
local_in_edges_tensor generation:  0.0016641616821289062
mini_batch_src_global generation:  0.0017848014831542969
r_  generation:  0.022207021713256836
local_output_nid generation:  0.0030059814453125
local_in_edges_tensor generation:  0.0017249584197998047
mini_batch_src_global generation:  0.0017819404602050781
r_  generation:  0.022009611129760742
local_output_nid generation:  0.0030252933502197266
local_in_edges_tensor generation:  0.00157928466796875
mini_batch_src_global generation:  0.0017561912536621094
r_  generation:  0.022397994995117188
local_output_nid generation:  0.0029861927032470703
local_in_edges_tensor generation:  0.0016238689422607422
mini_batch_src_global generation:  0.0017735958099365234
r_  generation:  0.02175450325012207
local_output_nid generation:  0.002991914749145508
local_in_edges_tensor generation:  0.001596212387084961
mini_batch_src_global generation:  0.0017082691192626953
r_  generation:  0.021994352340698242
local_output_nid generation:  0.002986431121826172
local_in_edges_tensor generation:  0.0015683174133300781
mini_batch_src_global generation:  0.0017254352569580078
r_  generation:  0.022549152374267578
local_output_nid generation:  0.003007173538208008
local_in_edges_tensor generation:  0.0015964508056640625
mini_batch_src_global generation:  0.0017502307891845703
r_  generation:  0.02180027961730957
local_output_nid generation:  0.0030324459075927734
local_in_edges_tensor generation:  0.0016353130340576172
mini_batch_src_global generation:  0.0017480850219726562
r_  generation:  0.021888256072998047
local_output_nid generation:  0.0030107498168945312
local_in_edges_tensor generation:  0.0015511512756347656
mini_batch_src_global generation:  0.0017778873443603516
r_  generation:  0.023025035858154297
----------------------check_connections_block total spend ----------------------------- 0.5647947788238525
generate_one_block  0.030603885650634766
generate_one_block  0.03179359436035156
generate_one_block  0.030833005905151367
generate_one_block  0.03174638748168945
generate_one_block  0.03085470199584961
generate_one_block  0.03427290916442871
generate_one_block  0.03167557716369629
generate_one_block  0.030749082565307617
generate_one_block  0.03159165382385254
generate_one_block  0.031417131423950195
generate_one_block  0.031021595001220703
generate_one_block  0.030853986740112305
generate_one_block  0.031174898147583008
generate_one_block  0.03045821189880371
generate_one_block  0.031192779541015625
generate_one_block  0.03266572952270508
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.10793256759643555
gen group dst list time:  0.017564058303833008
time for parepare:  0.019053220748901367
local_output_nid generation:  0.009091854095458984
local_in_edges_tensor generation:  0.023595571517944336
mini_batch_src_global generation:  0.027359724044799805
r_  generation:  0.24823689460754395
local_output_nid generation:  0.013354778289794922
local_in_edges_tensor generation:  0.018741607666015625
mini_batch_src_global generation:  0.03413128852844238
r_  generation:  0.31594109535217285
local_output_nid generation:  0.01323556900024414
local_in_edges_tensor generation:  0.017549991607666016
mini_batch_src_global generation:  0.03905081748962402
r_  generation:  0.26961326599121094
local_output_nid generation:  0.014075756072998047
local_in_edges_tensor generation:  0.01771855354309082
mini_batch_src_global generation:  0.03774428367614746
r_  generation:  0.27468180656433105
local_output_nid generation:  0.013237953186035156
local_in_edges_tensor generation:  0.01814746856689453
mini_batch_src_global generation:  0.03428530693054199
r_  generation:  0.2764420509338379
local_output_nid generation:  0.015965700149536133
local_in_edges_tensor generation:  0.02074456214904785
mini_batch_src_global generation:  0.03522324562072754
r_  generation:  0.28864026069641113
local_output_nid generation:  0.017598390579223633
local_in_edges_tensor generation:  0.01683950424194336
mini_batch_src_global generation:  0.03483319282531738
r_  generation:  0.27875399589538574
local_output_nid generation:  0.01422739028930664
local_in_edges_tensor generation:  0.015079498291015625
mini_batch_src_global generation:  0.034140825271606445
r_  generation:  0.27206850051879883
local_output_nid generation:  0.014303445816040039
local_in_edges_tensor generation:  0.014383077621459961
mini_batch_src_global generation:  0.03520464897155762
r_  generation:  0.2815713882446289
local_output_nid generation:  0.014197111129760742
local_in_edges_tensor generation:  0.016062498092651367
mini_batch_src_global generation:  0.03455233573913574
r_  generation:  0.27492380142211914
local_output_nid generation:  0.014053583145141602
local_in_edges_tensor generation:  0.015478372573852539
mini_batch_src_global generation:  0.034857988357543945
r_  generation:  0.28127002716064453
local_output_nid generation:  0.014374256134033203
local_in_edges_tensor generation:  0.013713359832763672
mini_batch_src_global generation:  0.03463459014892578
r_  generation:  0.27424001693725586
local_output_nid generation:  0.014328479766845703
local_in_edges_tensor generation:  0.014931917190551758
mini_batch_src_global generation:  0.03698325157165527
r_  generation:  0.28056883811950684
local_output_nid generation:  0.014115571975708008
local_in_edges_tensor generation:  0.015435218811035156
mini_batch_src_global generation:  0.03479814529418945
r_  generation:  0.2750527858734131
local_output_nid generation:  0.014416217803955078
local_in_edges_tensor generation:  0.015919923782348633
mini_batch_src_global generation:  0.036743879318237305
r_  generation:  0.28236842155456543
local_output_nid generation:  0.014538288116455078
local_in_edges_tensor generation:  0.01911330223083496
mini_batch_src_global generation:  0.035752058029174805
r_  generation:  0.28133296966552734
----------------------check_connections_block total spend ----------------------------- 6.4658026695251465
generate_one_block  0.3643937110900879
generate_one_block  0.36427736282348633
generate_one_block  0.3498563766479492
generate_one_block  0.3631742000579834
generate_one_block  0.3507051467895508
generate_one_block  0.35123205184936523
generate_one_block  0.3865940570831299
generate_one_block  0.3448622226715088
generate_one_block  0.3618457317352295
generate_one_block  0.35569047927856445
generate_one_block  0.354201078414917
generate_one_block  0.36599135398864746
generate_one_block  0.35883474349975586
generate_one_block  0.3504152297973633
generate_one_block  0.3583085536956787
generate_one_block  0.3677864074707031
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.036380767822265625
gen group dst list time:  0.06920909881591797
time for parepare:  0.020094871520996094
local_output_nid generation:  0.0286862850189209
local_in_edges_tensor generation:  0.04742002487182617
mini_batch_src_global generation:  0.04250144958496094
r_  generation:  0.4649333953857422
local_output_nid generation:  0.03301811218261719
local_in_edges_tensor generation:  0.042690277099609375
mini_batch_src_global generation:  0.056604862213134766
r_  generation:  0.4665658473968506
local_output_nid generation:  0.03317713737487793
local_in_edges_tensor generation:  0.03606724739074707
mini_batch_src_global generation:  0.05210757255554199
r_  generation:  0.4773714542388916
local_output_nid generation:  0.032680511474609375
local_in_edges_tensor generation:  0.03035283088684082
mini_batch_src_global generation:  0.055269718170166016
r_  generation:  0.47014498710632324
local_output_nid generation:  0.032762765884399414
local_in_edges_tensor generation:  0.08168458938598633
mini_batch_src_global generation:  0.05466890335083008
r_  generation:  0.4852774143218994
local_output_nid generation:  0.033223628997802734
local_in_edges_tensor generation:  0.03701472282409668
mini_batch_src_global generation:  0.05626511573791504
r_  generation:  0.49361252784729004
local_output_nid generation:  0.036374568939208984
local_in_edges_tensor generation:  0.035352230072021484
mini_batch_src_global generation:  0.05793142318725586
r_  generation:  0.4878711700439453
local_output_nid generation:  0.034677982330322266
local_in_edges_tensor generation:  0.030991554260253906
mini_batch_src_global generation:  0.054979562759399414
r_  generation:  0.47486186027526855
local_output_nid generation:  0.034482717514038086
local_in_edges_tensor generation:  0.03406405448913574
mini_batch_src_global generation:  0.05376577377319336
r_  generation:  0.48687052726745605
local_output_nid generation:  0.03407168388366699
local_in_edges_tensor generation:  0.029859542846679688
mini_batch_src_global generation:  0.05475211143493652
r_  generation:  0.4781002998352051
local_output_nid generation:  0.034303903579711914
local_in_edges_tensor generation:  0.030516386032104492
mini_batch_src_global generation:  0.05344867706298828
r_  generation:  0.48814868927001953
local_output_nid generation:  0.03434038162231445
local_in_edges_tensor generation:  0.0304110050201416
mini_batch_src_global generation:  0.054868459701538086
r_  generation:  0.47722315788269043
local_output_nid generation:  0.034482717514038086
local_in_edges_tensor generation:  0.0342710018157959
mini_batch_src_global generation:  0.05417442321777344
r_  generation:  0.48862671852111816
local_output_nid generation:  0.03414511680603027
local_in_edges_tensor generation:  0.030342578887939453
mini_batch_src_global generation:  0.05472612380981445
r_  generation:  0.47675418853759766
local_output_nid generation:  0.034157514572143555
local_in_edges_tensor generation:  0.03203296661376953
mini_batch_src_global generation:  0.0533139705657959
r_  generation:  0.4867994785308838
local_output_nid generation:  0.03407859802246094
local_in_edges_tensor generation:  0.032018184661865234
mini_batch_src_global generation:  0.05510425567626953
r_  generation:  0.47724199295043945
----------------------check_connections_block total spend ----------------------------- 11.404757261276245
generate_one_block  0.6153223514556885
generate_one_block  0.6041011810302734
generate_one_block  0.6056077480316162
generate_one_block  0.6018762588500977
generate_one_block  0.5991992950439453
generate_one_block  0.6006300449371338
generate_one_block  0.6019532680511475
generate_one_block  0.6037302017211914
generate_one_block  0.6696715354919434
generate_one_block  0.6044869422912598
generate_one_block  0.6040675640106201
generate_one_block  0.5961947441101074
generate_one_block  0.611278772354126
generate_one_block  0.6074573993682861
generate_one_block  0.6019580364227295
generate_one_block  0.608698844909668
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.1229705810546875  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

connection checking time:  17.87055993080139
block generation total time  15.484402894973755
average batch blocks generation time:  0.9677751809358597
block dataloader generation time/epoch 35.236862861193146
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09734964370727539  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7646327018737793  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09757232666015625  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7678661346435547  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09718132019042969  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.763209342956543  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09764480590820312  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7747640609741211  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0973653793334961  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7635064125061035  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09745264053344727  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.767237663269043  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09740352630615234  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7678728103637695  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09739160537719727  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7685542106628418  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09745454788208008  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7670903205871582  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0974111557006836  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7656397819519043  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09750747680664062  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7704024314880371  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09752750396728516  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7655515670776367  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09740304946899414  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7717161178588867  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09741401672363281  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7679314613342285  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09739542007446289  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7671627998352051  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09763813018798828  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7750639915466309  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0669993907213211 |0.015866994857788086 |0.003641083836555481 |9.450316429138184e-05 |0.0036689192056655884 |0.0017631053924560547 |
----------------------------------------------------------pseudo_mini_loss sum 1.3000012636184692
Total (block generation + training)time/epoch 36.69366873227633
Training time/epoch 1.5095150470733643
Training time without block to device /epoch 1.2556431293487549
Training time without total dataloading part /epoch 0.12023520469665527
load block tensor time/epoch 1.0719902515411377
block to device time/epoch 0.2538719177246094
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 22 |
Number of nodes for computation during this epoch:  5317969
Number of first layer input nodes during this epoch:  2509347
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12372541427612305  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024715185165405273
random selection method range initialization spend 0.005469083786010742
time for parepare:  0.018885374069213867
local_output_nid generation:  0.00234222412109375
local_in_edges_tensor generation:  0.007174015045166016
mini_batch_src_global generation:  0.002258777618408203
r_  generation:  0.021115779876708984
local_output_nid generation:  0.002982616424560547
local_in_edges_tensor generation:  0.0017099380493164062
mini_batch_src_global generation:  0.0023050308227539062
r_  generation:  0.02219223976135254
local_output_nid generation:  0.0029954910278320312
local_in_edges_tensor generation:  0.0016674995422363281
mini_batch_src_global generation:  0.0017383098602294922
r_  generation:  0.022045135498046875
local_output_nid generation:  0.0029790401458740234
local_in_edges_tensor generation:  0.0016863346099853516
mini_batch_src_global generation:  0.0017926692962646484
r_  generation:  0.0232241153717041
local_output_nid generation:  0.0029976367950439453
local_in_edges_tensor generation:  0.001735687255859375
mini_batch_src_global generation:  0.001750946044921875
r_  generation:  0.021261215209960938
local_output_nid generation:  0.0030159950256347656
local_in_edges_tensor generation:  0.0016291141510009766
mini_batch_src_global generation:  0.0017843246459960938
r_  generation:  0.022216796875
local_output_nid generation:  0.0030181407928466797
local_in_edges_tensor generation:  0.0016217231750488281
mini_batch_src_global generation:  0.0017931461334228516
r_  generation:  0.022562265396118164
local_output_nid generation:  0.003052234649658203
local_in_edges_tensor generation:  0.0016188621520996094
mini_batch_src_global generation:  0.001810312271118164
r_  generation:  0.0224001407623291
local_output_nid generation:  0.0030052661895751953
local_in_edges_tensor generation:  0.0016415119171142578
mini_batch_src_global generation:  0.0018155574798583984
r_  generation:  0.022533178329467773
local_output_nid generation:  0.003009796142578125
local_in_edges_tensor generation:  0.0015819072723388672
mini_batch_src_global generation:  0.0017807483673095703
r_  generation:  0.022910118103027344
local_output_nid generation:  0.0030357837677001953
local_in_edges_tensor generation:  0.0016202926635742188
mini_batch_src_global generation:  0.0017976760864257812
r_  generation:  0.022424936294555664
local_output_nid generation:  0.0030145645141601562
local_in_edges_tensor generation:  0.0015740394592285156
mini_batch_src_global generation:  0.001775503158569336
r_  generation:  0.022963285446166992
local_output_nid generation:  0.003021240234375
local_in_edges_tensor generation:  0.0016429424285888672
mini_batch_src_global generation:  0.0018157958984375
r_  generation:  0.021871089935302734
local_output_nid generation:  0.003001689910888672
local_in_edges_tensor generation:  0.0016198158264160156
mini_batch_src_global generation:  0.0017521381378173828
r_  generation:  0.022736072540283203
local_output_nid generation:  0.0030066967010498047
local_in_edges_tensor generation:  0.0015361309051513672
mini_batch_src_global generation:  0.0018243789672851562
r_  generation:  0.022527456283569336
local_output_nid generation:  0.003017902374267578
local_in_edges_tensor generation:  0.0016710758209228516
mini_batch_src_global generation:  0.0017962455749511719
r_  generation:  0.02297377586364746
----------------------check_connections_block total spend ----------------------------- 0.5762298107147217
generate_one_block  0.03420138359069824
generate_one_block  0.030742645263671875
generate_one_block  0.03222203254699707
generate_one_block  0.032042503356933594
generate_one_block  0.030962705612182617
generate_one_block  0.033669233322143555
generate_one_block  0.031778812408447266
generate_one_block  0.03103494644165039
generate_one_block  0.03168511390686035
generate_one_block  0.031222820281982422
generate_one_block  0.031091928482055664
generate_one_block  0.031434059143066406
generate_one_block  0.030906200408935547
generate_one_block  0.03117203712463379
generate_one_block  0.03181099891662598
generate_one_block  0.03198981285095215
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03652453422546387
gen group dst list time:  0.01902151107788086
time for parepare:  0.019989728927612305
local_output_nid generation:  0.009319305419921875
local_in_edges_tensor generation:  0.03255653381347656
mini_batch_src_global generation:  0.027118921279907227
r_  generation:  0.2538893222808838
local_output_nid generation:  0.01319742202758789
local_in_edges_tensor generation:  0.01854085922241211
mini_batch_src_global generation:  0.03202223777770996
r_  generation:  0.255934476852417
local_output_nid generation:  0.013947010040283203
local_in_edges_tensor generation:  0.01942586898803711
mini_batch_src_global generation:  0.03378605842590332
r_  generation:  0.27625155448913574
local_output_nid generation:  0.01389932632446289
local_in_edges_tensor generation:  0.018970251083374023
mini_batch_src_global generation:  0.033011674880981445
r_  generation:  0.2705979347229004
local_output_nid generation:  0.013263702392578125
local_in_edges_tensor generation:  0.014086484909057617
mini_batch_src_global generation:  0.033661603927612305
r_  generation:  0.26996445655822754
local_output_nid generation:  0.013592720031738281
local_in_edges_tensor generation:  0.01788473129272461
mini_batch_src_global generation:  0.03383636474609375
r_  generation:  0.2731919288635254
local_output_nid generation:  0.014005661010742188
local_in_edges_tensor generation:  0.014132261276245117
mini_batch_src_global generation:  0.03411269187927246
r_  generation:  0.2805953025817871
local_output_nid generation:  0.014023780822753906
local_in_edges_tensor generation:  0.015292644500732422
mini_batch_src_global generation:  0.036519765853881836
r_  generation:  0.2768266201019287
local_output_nid generation:  0.015160083770751953
local_in_edges_tensor generation:  0.020279645919799805
mini_batch_src_global generation:  0.04041004180908203
r_  generation:  0.28340792655944824
local_output_nid generation:  0.013951301574707031
local_in_edges_tensor generation:  0.01736283302307129
mini_batch_src_global generation:  0.03650975227355957
r_  generation:  0.273806095123291
local_output_nid generation:  0.013570308685302734
local_in_edges_tensor generation:  0.015447616577148438
mini_batch_src_global generation:  0.03470039367675781
r_  generation:  0.2776627540588379
local_output_nid generation:  0.014114618301391602
local_in_edges_tensor generation:  0.014289617538452148
mini_batch_src_global generation:  0.034621477127075195
r_  generation:  0.27460575103759766
local_output_nid generation:  0.013817071914672852
local_in_edges_tensor generation:  0.016737937927246094
mini_batch_src_global generation:  0.03520846366882324
r_  generation:  0.2743070125579834
local_output_nid generation:  0.013871908187866211
local_in_edges_tensor generation:  0.014000177383422852
mini_batch_src_global generation:  0.036446571350097656
r_  generation:  0.2722890377044678
local_output_nid generation:  0.01416325569152832
local_in_edges_tensor generation:  0.016578197479248047
mini_batch_src_global generation:  0.03779029846191406
r_  generation:  0.2813558578491211
local_output_nid generation:  0.014003753662109375
local_in_edges_tensor generation:  0.016278743743896484
mini_batch_src_global generation:  0.0351870059967041
r_  generation:  0.2777442932128906
----------------------check_connections_block total spend ----------------------------- 6.373972177505493
generate_one_block  0.36001157760620117
generate_one_block  0.3558037281036377
generate_one_block  0.3715555667877197
generate_one_block  0.3583691120147705
generate_one_block  0.35465002059936523
generate_one_block  0.36151623725891113
generate_one_block  0.3996870517730713
generate_one_block  0.3601644039154053
generate_one_block  0.3597071170806885
generate_one_block  0.3571953773498535
generate_one_block  0.35708093643188477
generate_one_block  0.3582322597503662
generate_one_block  0.35196757316589355
generate_one_block  0.3506290912628174
generate_one_block  0.3574333190917969
generate_one_block  0.35930871963500977
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03289484977722168
gen group dst list time:  0.06795573234558105
time for parepare:  0.020345687866210938
local_output_nid generation:  0.0285794734954834
local_in_edges_tensor generation:  0.05485057830810547
mini_batch_src_global generation:  0.04325127601623535
r_  generation:  0.46349191665649414
local_output_nid generation:  0.03332972526550293
local_in_edges_tensor generation:  0.035988807678222656
mini_batch_src_global generation:  0.05366706848144531
r_  generation:  0.4605062007904053
local_output_nid generation:  0.03502225875854492
local_in_edges_tensor generation:  0.03971982002258301
mini_batch_src_global generation:  0.05220317840576172
r_  generation:  0.47594738006591797
local_output_nid generation:  0.033342838287353516
local_in_edges_tensor generation:  0.032520294189453125
mini_batch_src_global generation:  0.05371904373168945
r_  generation:  0.48667192459106445
local_output_nid generation:  0.03690218925476074
local_in_edges_tensor generation:  0.08995175361633301
mini_batch_src_global generation:  0.0557858943939209
r_  generation:  0.4815332889556885
local_output_nid generation:  0.033057212829589844
local_in_edges_tensor generation:  0.03279614448547363
mini_batch_src_global generation:  0.05571413040161133
r_  generation:  0.47227001190185547
local_output_nid generation:  0.03303265571594238
local_in_edges_tensor generation:  0.03251194953918457
mini_batch_src_global generation:  0.05299949645996094
r_  generation:  0.48397397994995117
local_output_nid generation:  0.033010244369506836
local_in_edges_tensor generation:  0.0325007438659668
mini_batch_src_global generation:  0.05851912498474121
r_  generation:  0.47760748863220215
local_output_nid generation:  0.03326988220214844
local_in_edges_tensor generation:  0.032866716384887695
mini_batch_src_global generation:  0.05502796173095703
r_  generation:  0.48729753494262695
local_output_nid generation:  0.03411269187927246
local_in_edges_tensor generation:  0.03371286392211914
mini_batch_src_global generation:  0.05595111846923828
r_  generation:  0.47743725776672363
local_output_nid generation:  0.0335240364074707
local_in_edges_tensor generation:  0.03280758857727051
mini_batch_src_global generation:  0.05580496788024902
r_  generation:  0.48284339904785156
local_output_nid generation:  0.033651113510131836
local_in_edges_tensor generation:  0.03892254829406738
mini_batch_src_global generation:  0.05489540100097656
r_  generation:  0.47581982612609863
local_output_nid generation:  0.03286433219909668
local_in_edges_tensor generation:  0.0317990779876709
mini_batch_src_global generation:  0.05469512939453125
r_  generation:  0.48319578170776367
local_output_nid generation:  0.03309202194213867
local_in_edges_tensor generation:  0.03543496131896973
mini_batch_src_global generation:  0.054438114166259766
r_  generation:  0.4829752445220947
local_output_nid generation:  0.03379034996032715
local_in_edges_tensor generation:  0.030286073684692383
mini_batch_src_global generation:  0.053186655044555664
r_  generation:  0.48619699478149414
local_output_nid generation:  0.03337359428405762
local_in_edges_tensor generation:  0.032134056091308594
mini_batch_src_global generation:  0.05636167526245117
r_  generation:  0.47780919075012207
----------------------check_connections_block total spend ----------------------------- 11.400058269500732
generate_one_block  0.6060550212860107
generate_one_block  0.6076943874359131
generate_one_block  0.6128349304199219
generate_one_block  0.6059768199920654
generate_one_block  0.6028385162353516
generate_one_block  0.5997138023376465
generate_one_block  0.612189769744873
generate_one_block  0.6080024242401123
generate_one_block  0.6392261981964111
generate_one_block  0.6005129814147949
generate_one_block  0.5995185375213623
generate_one_block  0.5976526737213135
generate_one_block  0.5994694232940674
generate_one_block  0.6034574508666992
generate_one_block  0.6064414978027344
generate_one_block  0.604142427444458
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12372541427612305  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

connection checking time:  17.774030447006226
block generation total time  15.479038953781128
average batch blocks generation time:  0.9674399346113205
block dataloader generation time/epoch 35.25480091571808
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09749746322631836  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7678709030151367  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09721136093139648  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7613105773925781  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09775924682617188  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7761592864990234  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09751653671264648  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7688121795654297  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09743595123291016  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7658605575561523  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09735250473022461  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7650942802429199  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09735631942749023  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.767087459564209  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0973358154296875  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7647218704223633  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0975184440612793  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.768826961517334  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09747982025146484  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7664551734924316  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0974874496459961  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7660245895385742  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09758234024047852  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.771787166595459  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09729719161987305  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7628588676452637  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09734392166137695  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7640895843505859  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09758329391479492  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7743816375732422  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09757328033447266  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7719964981079102  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06505356729030609 |0.01583978533744812 |0.004146173596382141 |0.00010620057582855225 |0.003571942448616028 |0.002028226852416992 |
----------------------------------------------------------pseudo_mini_loss sum 1.2868748903274536
Total (block generation + training)time/epoch 36.71382350581033
Training time/epoch 1.4875855445861816
Training time without block to device /epoch 1.2341489791870117
Training time without total dataloading part /epoch 0.12721729278564453
load block tensor time/epoch 1.0408570766448975
block to device time/epoch 0.2534365653991699
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 23 |
Number of nodes for computation during this epoch:  5318857
Number of first layer input nodes during this epoch:  2509655
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12348222732543945  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023284196853637695
random selection method range initialization spend 0.005573749542236328
time for parepare:  0.019765377044677734
local_output_nid generation:  0.0023305416107177734
local_in_edges_tensor generation:  0.0067844390869140625
mini_batch_src_global generation:  0.0018038749694824219
r_  generation:  0.021173477172851562
local_output_nid generation:  0.0029544830322265625
local_in_edges_tensor generation:  0.0017616748809814453
mini_batch_src_global generation:  0.0021157264709472656
r_  generation:  0.02223825454711914
local_output_nid generation:  0.003038644790649414
local_in_edges_tensor generation:  0.0017409324645996094
mini_batch_src_global generation:  0.0017671585083007812
r_  generation:  0.021866559982299805
local_output_nid generation:  0.002994060516357422
local_in_edges_tensor generation:  0.0015897750854492188
mini_batch_src_global generation:  0.0017421245574951172
r_  generation:  0.022203683853149414
local_output_nid generation:  0.0029778480529785156
local_in_edges_tensor generation:  0.0017037391662597656
mini_batch_src_global generation:  0.001802206039428711
r_  generation:  0.022555828094482422
local_output_nid generation:  0.0029883384704589844
local_in_edges_tensor generation:  0.0015764236450195312
mini_batch_src_global generation:  0.0018367767333984375
r_  generation:  0.022177934646606445
local_output_nid generation:  0.0029914379119873047
local_in_edges_tensor generation:  0.0016231536865234375
mini_batch_src_global generation:  0.0017974376678466797
r_  generation:  0.022280454635620117
local_output_nid generation:  0.003075122833251953
local_in_edges_tensor generation:  0.0016083717346191406
mini_batch_src_global generation:  0.0017824172973632812
r_  generation:  0.021855831146240234
local_output_nid generation:  0.0029807090759277344
local_in_edges_tensor generation:  0.0015902519226074219
mini_batch_src_global generation:  0.0017595291137695312
r_  generation:  0.021474838256835938
local_output_nid generation:  0.0030035972595214844
local_in_edges_tensor generation:  0.0015637874603271484
mini_batch_src_global generation:  0.0017702579498291016
r_  generation:  0.022091150283813477
local_output_nid generation:  0.003020048141479492
local_in_edges_tensor generation:  0.0015614032745361328
mini_batch_src_global generation:  0.0018324851989746094
r_  generation:  0.022814512252807617
local_output_nid generation:  0.0029931068420410156
local_in_edges_tensor generation:  0.001608133316040039
mini_batch_src_global generation:  0.0018253326416015625
r_  generation:  0.02197885513305664
local_output_nid generation:  0.003020763397216797
local_in_edges_tensor generation:  0.0016214847564697266
mini_batch_src_global generation:  0.0017576217651367188
r_  generation:  0.02198648452758789
local_output_nid generation:  0.0030732154846191406
local_in_edges_tensor generation:  0.0015501976013183594
mini_batch_src_global generation:  0.0017383098602294922
r_  generation:  0.022062063217163086
local_output_nid generation:  0.0030105113983154297
local_in_edges_tensor generation:  0.0015823841094970703
mini_batch_src_global generation:  0.0017669200897216797
r_  generation:  0.021836519241333008
local_output_nid generation:  0.0029914379119873047
local_in_edges_tensor generation:  0.0015478134155273438
mini_batch_src_global generation:  0.0017962455749511719
r_  generation:  0.02284693717956543
----------------------check_connections_block total spend ----------------------------- 0.5695087909698486
generate_one_block  0.031091928482055664
generate_one_block  0.031667232513427734
generate_one_block  0.03153228759765625
generate_one_block  0.0316617488861084
generate_one_block  0.03236079216003418
generate_one_block  0.03363823890686035
generate_one_block  0.031008243560791016
generate_one_block  0.031057119369506836
generate_one_block  0.030564308166503906
generate_one_block  0.03085780143737793
generate_one_block  0.03205394744873047
generate_one_block  0.030800819396972656
generate_one_block  0.03124213218688965
generate_one_block  0.031099796295166016
generate_one_block  0.031108856201171875
generate_one_block  0.03261709213256836
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03503155708312988
gen group dst list time:  0.01775383949279785
time for parepare:  0.02012014389038086
local_output_nid generation:  0.009564638137817383
local_in_edges_tensor generation:  0.027681589126586914
mini_batch_src_global generation:  0.026471614837646484
r_  generation:  0.2653019428253174
local_output_nid generation:  0.013508319854736328
local_in_edges_tensor generation:  0.018027067184448242
mini_batch_src_global generation:  0.03490304946899414
r_  generation:  0.2653772830963135
local_output_nid generation:  0.014234781265258789
local_in_edges_tensor generation:  0.019412994384765625
mini_batch_src_global generation:  0.03161120414733887
r_  generation:  0.2732832431793213
local_output_nid generation:  0.014170408248901367
local_in_edges_tensor generation:  0.016989469528198242
mini_batch_src_global generation:  0.03229546546936035
r_  generation:  0.2759127616882324
local_output_nid generation:  0.014593362808227539
local_in_edges_tensor generation:  0.02164173126220703
mini_batch_src_global generation:  0.03981614112854004
r_  generation:  0.288271427154541
local_output_nid generation:  0.01396322250366211
local_in_edges_tensor generation:  0.017891883850097656
mini_batch_src_global generation:  0.04485583305358887
r_  generation:  0.2755448818206787
local_output_nid generation:  0.015259027481079102
local_in_edges_tensor generation:  0.014693260192871094
mini_batch_src_global generation:  0.03334665298461914
r_  generation:  0.27516698837280273
local_output_nid generation:  0.014250755310058594
local_in_edges_tensor generation:  0.01547551155090332
mini_batch_src_global generation:  0.0336146354675293
r_  generation:  0.269026517868042
local_output_nid generation:  0.014007568359375
local_in_edges_tensor generation:  0.016376972198486328
mini_batch_src_global generation:  0.033525705337524414
r_  generation:  0.2865180969238281
local_output_nid generation:  0.014325618743896484
local_in_edges_tensor generation:  0.014333724975585938
mini_batch_src_global generation:  0.033907413482666016
r_  generation:  0.2717554569244385
local_output_nid generation:  0.013900279998779297
local_in_edges_tensor generation:  0.01713085174560547
mini_batch_src_global generation:  0.0364682674407959
r_  generation:  0.28888893127441406
local_output_nid generation:  0.01412343978881836
local_in_edges_tensor generation:  0.016140460968017578
mini_batch_src_global generation:  0.0343480110168457
r_  generation:  0.2737123966217041
local_output_nid generation:  0.01432347297668457
local_in_edges_tensor generation:  0.01523900032043457
mini_batch_src_global generation:  0.033870697021484375
r_  generation:  0.2771031856536865
local_output_nid generation:  0.014298200607299805
local_in_edges_tensor generation:  0.016535520553588867
mini_batch_src_global generation:  0.0353245735168457
r_  generation:  0.27741384506225586
local_output_nid generation:  0.015051603317260742
local_in_edges_tensor generation:  0.021012544631958008
mini_batch_src_global generation:  0.03385806083679199
r_  generation:  0.2772796154022217
local_output_nid generation:  0.014630317687988281
local_in_edges_tensor generation:  0.019454002380371094
mini_batch_src_global generation:  0.03525948524475098
r_  generation:  0.287351131439209
----------------------check_connections_block total spend ----------------------------- 6.45372200012207
generate_one_block  0.37962889671325684
generate_one_block  0.35622620582580566
generate_one_block  0.3532679080963135
generate_one_block  0.3562655448913574
generate_one_block  0.37182116508483887
generate_one_block  0.3541746139526367
generate_one_block  0.3810160160064697
generate_one_block  0.35025453567504883
generate_one_block  0.35042476654052734
generate_one_block  0.36589670181274414
generate_one_block  0.3714158535003662
generate_one_block  0.3502318859100342
generate_one_block  0.3507106304168701
generate_one_block  0.3565788269042969
generate_one_block  0.35283994674682617
generate_one_block  0.3665733337402344
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0372467041015625
gen group dst list time:  0.0686795711517334
time for parepare:  0.019209623336791992
local_output_nid generation:  0.03118896484375
local_in_edges_tensor generation:  0.058296918869018555
mini_batch_src_global generation:  0.04277992248535156
r_  generation:  0.46172499656677246
local_output_nid generation:  0.03397798538208008
local_in_edges_tensor generation:  0.039179325103759766
mini_batch_src_global generation:  0.05645465850830078
r_  generation:  0.46305036544799805
local_output_nid generation:  0.03460192680358887
local_in_edges_tensor generation:  0.036049842834472656
mini_batch_src_global generation:  0.0538785457611084
r_  generation:  0.47693371772766113
local_output_nid generation:  0.033860206604003906
local_in_edges_tensor generation:  0.03310108184814453
mini_batch_src_global generation:  0.05521368980407715
r_  generation:  0.4676015377044678
local_output_nid generation:  0.033405303955078125
local_in_edges_tensor generation:  0.08540511131286621
mini_batch_src_global generation:  0.05419802665710449
r_  generation:  0.4816629886627197
local_output_nid generation:  0.03358340263366699
local_in_edges_tensor generation:  0.0320582389831543
mini_batch_src_global generation:  0.05439305305480957
r_  generation:  0.48633861541748047
local_output_nid generation:  0.03546786308288574
local_in_edges_tensor generation:  0.03248190879821777
mini_batch_src_global generation:  0.05378079414367676
r_  generation:  0.48128485679626465
local_output_nid generation:  0.03443264961242676
local_in_edges_tensor generation:  0.03343844413757324
mini_batch_src_global generation:  0.05484294891357422
r_  generation:  0.4841890335083008
local_output_nid generation:  0.033904314041137695
local_in_edges_tensor generation:  0.03219938278198242
mini_batch_src_global generation:  0.05361628532409668
r_  generation:  0.478712797164917
local_output_nid generation:  0.03428292274475098
local_in_edges_tensor generation:  0.03371310234069824
mini_batch_src_global generation:  0.05759382247924805
r_  generation:  0.48232126235961914
local_output_nid generation:  0.03436732292175293
local_in_edges_tensor generation:  0.0356748104095459
mini_batch_src_global generation:  0.05450177192687988
r_  generation:  0.48049187660217285
local_output_nid generation:  0.0342717170715332
local_in_edges_tensor generation:  0.031584978103637695
mini_batch_src_global generation:  0.06271076202392578
r_  generation:  0.48180580139160156
local_output_nid generation:  0.0342860221862793
local_in_edges_tensor generation:  0.03359413146972656
mini_batch_src_global generation:  0.053995609283447266
r_  generation:  0.47905802726745605
local_output_nid generation:  0.034143924713134766
local_in_edges_tensor generation:  0.0315244197845459
mini_batch_src_global generation:  0.05521273612976074
r_  generation:  0.47763943672180176
local_output_nid generation:  0.033849239349365234
local_in_edges_tensor generation:  0.033510684967041016
mini_batch_src_global generation:  0.05429434776306152
r_  generation:  0.4767751693725586
local_output_nid generation:  0.034612417221069336
local_in_edges_tensor generation:  0.03458762168884277
mini_batch_src_global generation:  0.0569915771484375
r_  generation:  0.48387622833251953
----------------------check_connections_block total spend ----------------------------- 11.42013168334961
generate_one_block  0.6089701652526855
generate_one_block  0.5998179912567139
generate_one_block  0.598407506942749
generate_one_block  0.6016108989715576
generate_one_block  0.6056616306304932
generate_one_block  0.6061995029449463
generate_one_block  0.595674991607666
generate_one_block  0.6013326644897461
generate_one_block  0.6689071655273438
generate_one_block  0.6051831245422363
generate_one_block  0.6084411144256592
generate_one_block  0.6019208431243896
generate_one_block  0.608741283416748
generate_one_block  0.5974605083465576
generate_one_block  0.6081206798553467
generate_one_block  0.6145236492156982
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12348222732543945  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

connection checking time:  17.87385368347168
block generation total time  15.498300552368164
average batch blocks generation time:  0.9686437845230103
block dataloader generation time/epoch 35.276973740259805
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09771871566772461  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.775547981262207  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09760093688964844  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7720928192138672  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09749841690063477  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7719264030456543  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09741353988647461  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7671279907226562  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0977640151977539  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7766132354736328  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09746122360229492  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7648782730102539  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09733295440673828  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7643313407897949  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09728193283081055  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7648591995239258  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09725522994995117  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7604150772094727  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09749174118041992  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.768913745880127  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0975198745727539  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.771059513092041  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09738636016845703  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7660174369812012  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.097503662109375  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7692403793334961  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09739446640014648  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7625412940979004  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09743356704711914  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7634487152099609  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09783744812011719  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.776069164276123  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06907656788825989 |0.016336455941200256 |0.0036486685276031494 |9.822845458984375e-05 |0.0035770684480667114 |0.001569986343383789 |
----------------------------------------------------------pseudo_mini_loss sum 1.2751513719558716
Total (block generation + training)time/epoch 36.74221898714701
Training time/epoch 1.5518903732299805
Training time without block to device /epoch 1.2905070781707764
Training time without total dataloading part /epoch 0.11875343322753906
load block tensor time/epoch 1.1052250862121582
block to device time/epoch 0.2613832950592041
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 24 |
Number of nodes for computation during this epoch:  5320443
Number of first layer input nodes during this epoch:  2510488
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12411737442016602  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02771902084350586
random selection method range initialization spend 0.0051386356353759766
time for parepare:  0.01955103874206543
local_output_nid generation:  0.0023767948150634766
local_in_edges_tensor generation:  0.006747245788574219
mini_batch_src_global generation:  0.0019221305847167969
r_  generation:  0.021570920944213867
local_output_nid generation:  0.002954721450805664
local_in_edges_tensor generation:  0.0020818710327148438
mini_batch_src_global generation:  0.0020835399627685547
r_  generation:  0.024718761444091797
local_output_nid generation:  0.003020763397216797
local_in_edges_tensor generation:  0.0034461021423339844
mini_batch_src_global generation:  0.0020749568939208984
r_  generation:  0.0221860408782959
local_output_nid generation:  0.0030069351196289062
local_in_edges_tensor generation:  0.001806497573852539
mini_batch_src_global generation:  0.0017707347869873047
r_  generation:  0.0219571590423584
local_output_nid generation:  0.0030472278594970703
local_in_edges_tensor generation:  0.0018749237060546875
mini_batch_src_global generation:  0.0018737316131591797
r_  generation:  0.022544384002685547
local_output_nid generation:  0.0030930042266845703
local_in_edges_tensor generation:  0.0016970634460449219
mini_batch_src_global generation:  0.0018627643585205078
r_  generation:  0.02290654182434082
local_output_nid generation:  0.0031027793884277344
local_in_edges_tensor generation:  0.0016262531280517578
mini_batch_src_global generation:  0.0018169879913330078
r_  generation:  0.023034334182739258
local_output_nid generation:  0.003041505813598633
local_in_edges_tensor generation:  0.0016262531280517578
mini_batch_src_global generation:  0.0018024444580078125
r_  generation:  0.02517390251159668
local_output_nid generation:  0.003042936325073242
local_in_edges_tensor generation:  0.0016942024230957031
mini_batch_src_global generation:  0.0018312931060791016
r_  generation:  0.023331403732299805
local_output_nid generation:  0.0030374526977539062
local_in_edges_tensor generation:  0.0016560554504394531
mini_batch_src_global generation:  0.0018148422241210938
r_  generation:  0.02240610122680664
local_output_nid generation:  0.003040790557861328
local_in_edges_tensor generation:  0.0016939640045166016
mini_batch_src_global generation:  0.0018317699432373047
r_  generation:  0.023144245147705078
local_output_nid generation:  0.0030317306518554688
local_in_edges_tensor generation:  0.003363370895385742
mini_batch_src_global generation:  0.0018002986907958984
r_  generation:  0.02224874496459961
local_output_nid generation:  0.003008127212524414
local_in_edges_tensor generation:  0.001735687255859375
mini_batch_src_global generation:  0.001781463623046875
r_  generation:  0.02307295799255371
local_output_nid generation:  0.003027200698852539
local_in_edges_tensor generation:  0.0017571449279785156
mini_batch_src_global generation:  0.001750946044921875
r_  generation:  0.021839141845703125
local_output_nid generation:  0.003719806671142578
local_in_edges_tensor generation:  0.0016722679138183594
mini_batch_src_global generation:  0.0017998218536376953
r_  generation:  0.022762060165405273
local_output_nid generation:  0.0031321048736572266
local_in_edges_tensor generation:  0.001720428466796875
mini_batch_src_global generation:  0.0018494129180908203
r_  generation:  0.022336244583129883
----------------------check_connections_block total spend ----------------------------- 0.5952103137969971
generate_one_block  0.03679680824279785
generate_one_block  0.03184771537780762
generate_one_block  0.04787898063659668
generate_one_block  0.035068511962890625
generate_one_block  0.03120875358581543
generate_one_block  0.03516650199890137
generate_one_block  0.03272390365600586
generate_one_block  0.03213977813720703
generate_one_block  0.03152751922607422
generate_one_block  0.045189857482910156
generate_one_block  0.032891273498535156
generate_one_block  0.03439617156982422
generate_one_block  0.04057002067565918
generate_one_block  0.045943498611450195
generate_one_block  0.03755998611450195
generate_one_block  0.033170461654663086
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04091763496398926
gen group dst list time:  0.018671274185180664
time for parepare:  0.020676374435424805
local_output_nid generation:  0.00941777229309082
local_in_edges_tensor generation:  0.026378631591796875
mini_batch_src_global generation:  0.026718854904174805
r_  generation:  0.26230621337890625
local_output_nid generation:  0.016039371490478516
local_in_edges_tensor generation:  0.019048690795898438
mini_batch_src_global generation:  0.03352022171020508
r_  generation:  0.26357364654541016
local_output_nid generation:  0.014153718948364258
local_in_edges_tensor generation:  0.015981435775756836
mini_batch_src_global generation:  0.031531333923339844
r_  generation:  0.26573777198791504
local_output_nid generation:  0.014100313186645508
local_in_edges_tensor generation:  0.015996694564819336
mini_batch_src_global generation:  0.034680843353271484
r_  generation:  0.2743992805480957
local_output_nid generation:  0.013300657272338867
local_in_edges_tensor generation:  0.014174222946166992
mini_batch_src_global generation:  0.035959720611572266
r_  generation:  0.2777564525604248
local_output_nid generation:  0.014461278915405273
local_in_edges_tensor generation:  0.019330501556396484
mini_batch_src_global generation:  0.035805463790893555
r_  generation:  0.2846975326538086
local_output_nid generation:  0.014402151107788086
local_in_edges_tensor generation:  0.0179595947265625
mini_batch_src_global generation:  0.035680294036865234
r_  generation:  0.2832672595977783
local_output_nid generation:  0.014700651168823242
local_in_edges_tensor generation:  0.021689891815185547
mini_batch_src_global generation:  0.034890174865722656
r_  generation:  0.2836184501647949
local_output_nid generation:  0.015407323837280273
local_in_edges_tensor generation:  0.020035982131958008
mini_batch_src_global generation:  0.03643512725830078
r_  generation:  0.2773716449737549
local_output_nid generation:  0.014307498931884766
local_in_edges_tensor generation:  0.014998197555541992
mini_batch_src_global generation:  0.03443598747253418
r_  generation:  0.27724385261535645
local_output_nid generation:  0.014365434646606445
local_in_edges_tensor generation:  0.015554189682006836
mini_batch_src_global generation:  0.036783695220947266
r_  generation:  0.2806358337402344
local_output_nid generation:  0.014210939407348633
local_in_edges_tensor generation:  0.015020608901977539
mini_batch_src_global generation:  0.035773515701293945
r_  generation:  0.28922390937805176
local_output_nid generation:  0.016793012619018555
local_in_edges_tensor generation:  0.013946056365966797
mini_batch_src_global generation:  0.03597521781921387
r_  generation:  0.2797367572784424
local_output_nid generation:  0.014183282852172852
local_in_edges_tensor generation:  0.014323949813842773
mini_batch_src_global generation:  0.03500080108642578
r_  generation:  0.27574753761291504
local_output_nid generation:  0.014374256134033203
local_in_edges_tensor generation:  0.01398468017578125
mini_batch_src_global generation:  0.034799814224243164
r_  generation:  0.2711954116821289
local_output_nid generation:  0.014361143112182617
local_in_edges_tensor generation:  0.015078306198120117
mini_batch_src_global generation:  0.03436851501464844
r_  generation:  0.2776222229003906
----------------------check_connections_block total spend ----------------------------- 6.4476096630096436
generate_one_block  0.3574256896972656
generate_one_block  0.3519737720489502
generate_one_block  0.35408568382263184
generate_one_block  0.3716566562652588
generate_one_block  0.35028910636901855
generate_one_block  0.3683743476867676
generate_one_block  0.3946197032928467
generate_one_block  0.3622465133666992
generate_one_block  0.3565349578857422
generate_one_block  0.35458874702453613
generate_one_block  0.3661623001098633
generate_one_block  0.3520369529724121
generate_one_block  0.36171817779541016
generate_one_block  0.35395216941833496
generate_one_block  0.3521900177001953
generate_one_block  0.35582661628723145
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.037087202072143555
gen group dst list time:  0.06897234916687012
time for parepare:  0.02027440071105957
local_output_nid generation:  0.02977919578552246
local_in_edges_tensor generation:  0.05260181427001953
mini_batch_src_global generation:  0.043431758880615234
r_  generation:  0.46181607246398926
local_output_nid generation:  0.03387165069580078
local_in_edges_tensor generation:  0.04176664352416992
mini_batch_src_global generation:  0.054203033447265625
r_  generation:  0.464946985244751
local_output_nid generation:  0.03308725357055664
local_in_edges_tensor generation:  0.03914189338684082
mini_batch_src_global generation:  0.0626676082611084
r_  generation:  0.4738447666168213
local_output_nid generation:  0.03513002395629883
local_in_edges_tensor generation:  0.03290748596191406
mini_batch_src_global generation:  0.054197072982788086
r_  generation:  0.46851325035095215
local_output_nid generation:  0.03475594520568848
local_in_edges_tensor generation:  0.08454084396362305
mini_batch_src_global generation:  0.05266070365905762
r_  generation:  0.4753875732421875
local_output_nid generation:  0.0333249568939209
local_in_edges_tensor generation:  0.03520703315734863
mini_batch_src_global generation:  0.05378007888793945
r_  generation:  0.4764230251312256
local_output_nid generation:  0.044516563415527344
local_in_edges_tensor generation:  0.032460689544677734
mini_batch_src_global generation:  0.054139137268066406
r_  generation:  0.47843313217163086
local_output_nid generation:  0.03375887870788574
local_in_edges_tensor generation:  0.03280758857727051
mini_batch_src_global generation:  0.05418992042541504
r_  generation:  0.47768473625183105
local_output_nid generation:  0.033570289611816406
local_in_edges_tensor generation:  0.031039714813232422
mini_batch_src_global generation:  0.05336427688598633
r_  generation:  0.478928804397583
local_output_nid generation:  0.03347659111022949
local_in_edges_tensor generation:  0.03054189682006836
mini_batch_src_global generation:  0.054642677307128906
r_  generation:  0.4896094799041748
local_output_nid generation:  0.03330707550048828
local_in_edges_tensor generation:  0.031203508377075195
mini_batch_src_global generation:  0.05697989463806152
r_  generation:  0.4805638790130615
local_output_nid generation:  0.0334470272064209
local_in_edges_tensor generation:  0.03179740905761719
mini_batch_src_global generation:  0.054100751876831055
r_  generation:  0.4831814765930176
local_output_nid generation:  0.03363227844238281
local_in_edges_tensor generation:  0.03684830665588379
mini_batch_src_global generation:  0.053711891174316406
r_  generation:  0.48217320442199707
local_output_nid generation:  0.03441357612609863
local_in_edges_tensor generation:  0.035280466079711914
mini_batch_src_global generation:  0.05505728721618652
r_  generation:  0.48363661766052246
local_output_nid generation:  0.03385043144226074
local_in_edges_tensor generation:  0.03569340705871582
mini_batch_src_global generation:  0.05647778511047363
r_  generation:  0.48023509979248047
local_output_nid generation:  0.03417015075683594
local_in_edges_tensor generation:  0.03327322006225586
mini_batch_src_global generation:  0.05499005317687988
r_  generation:  0.48172831535339355
----------------------check_connections_block total spend ----------------------------- 11.3919038772583
generate_one_block  0.6086623668670654
generate_one_block  0.6072032451629639
generate_one_block  0.6062541007995605
generate_one_block  0.6084685325622559
generate_one_block  0.6061098575592041
generate_one_block  0.6089622974395752
generate_one_block  0.6009244918823242
generate_one_block  0.6014909744262695
generate_one_block  0.6440896987915039
generate_one_block  0.6077542304992676
generate_one_block  0.5964722633361816
generate_one_block  0.6004447937011719
generate_one_block  0.6093735694885254
generate_one_block  0.5983624458312988
generate_one_block  0.6084895133972168
generate_one_block  0.6005458831787109
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12411737442016602  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

connection checking time:  17.839513540267944
block generation total time  15.47728967666626
average batch blocks generation time:  0.9673306047916412
block dataloader generation time/epoch 35.300908386707306
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09714603424072266  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7620759010314941  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09738349914550781  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7648911476135254  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09746122360229492  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7666072845458984  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09740304946899414  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7673578262329102  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09745597839355469  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7691259384155273  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09755611419677734  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7715072631835938  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0978078842163086  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.7753257751464844  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.0976095199584961  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7749428749084473  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09745597839355469  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7680201530456543  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09740400314331055  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7647337913513184  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09746503829956055  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7677459716796875  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09731149673461914  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7634620666503906  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.0975351333618164  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7751784324645996  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09736061096191406  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7641239166259766  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09741687774658203  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.768585205078125  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09740686416625977  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.764615535736084  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06592489778995514 |0.01453651487827301 |0.003812819719314575 |9.357929229736328e-05 |0.005376577377319336 |0.0013852119445800781 |
----------------------------------------------------------pseudo_mini_loss sum 1.2626590728759766
Total (block generation + training)time/epoch 36.76840250194073
Training time/epoch 1.500992774963379
Training time without block to device /epoch 1.2684085369110107
Training time without total dataloading part /epoch 0.14991283416748047
load block tensor time/epoch 1.0547983646392822
block to device time/epoch 0.23258423805236816
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 25 |
Number of nodes for computation during this epoch:  5318654
Number of first layer input nodes during this epoch:  2509295
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.12314128875732422  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02594757080078125
random selection method range initialization spend 0.0054264068603515625
time for parepare:  0.019901037216186523
local_output_nid generation:  0.002347230911254883
local_in_edges_tensor generation:  0.007598161697387695
mini_batch_src_global generation:  0.0018181800842285156
r_  generation:  0.02138495445251465
local_output_nid generation:  0.003011465072631836
local_in_edges_tensor generation:  0.001744985580444336
mini_batch_src_global generation:  0.002089262008666992
r_  generation:  0.022147417068481445
local_output_nid generation:  0.0029692649841308594
local_in_edges_tensor generation:  0.0017006397247314453
mini_batch_src_global generation:  0.0017223358154296875
r_  generation:  0.021600008010864258
local_output_nid generation:  0.0029823780059814453
local_in_edges_tensor generation:  0.0017039775848388672
mini_batch_src_global generation:  0.0017981529235839844
r_  generation:  0.021945476531982422
local_output_nid generation:  0.003044605255126953
local_in_edges_tensor generation:  0.0016911029815673828
mini_batch_src_global generation:  0.0017864704132080078
r_  generation:  0.021715164184570312
local_output_nid generation:  0.0029854774475097656
local_in_edges_tensor generation:  0.0016417503356933594
mini_batch_src_global generation:  0.0018415451049804688
r_  generation:  0.02244114875793457
local_output_nid generation:  0.0030260086059570312
local_in_edges_tensor generation:  0.0016474723815917969
mini_batch_src_global generation:  0.0017955303192138672
r_  generation:  0.02244734764099121
local_output_nid generation:  0.0031108856201171875
local_in_edges_tensor generation:  0.0017175674438476562
mini_batch_src_global generation:  0.0018227100372314453
r_  generation:  0.0222012996673584
local_output_nid generation:  0.003022909164428711
local_in_edges_tensor generation:  0.001580953598022461
mini_batch_src_global generation:  0.0018455982208251953
r_  generation:  0.022539377212524414
local_output_nid generation:  0.0030057430267333984
local_in_edges_tensor generation:  0.00164031982421875
mini_batch_src_global generation:  0.0018062591552734375
r_  generation:  0.02275252342224121
local_output_nid generation:  0.003002166748046875
local_in_edges_tensor generation:  0.001561880111694336
mini_batch_src_global generation:  0.0018231868743896484
r_  generation:  0.02262091636657715
local_output_nid generation:  0.0030107498168945312
local_in_edges_tensor generation:  0.0016324520111083984
mini_batch_src_global generation:  0.001813650131225586
r_  generation:  0.02239990234375
local_output_nid generation:  0.0029647350311279297
local_in_edges_tensor generation:  0.0016055107116699219
mini_batch_src_global generation:  0.0017673969268798828
r_  generation:  0.022336959838867188
local_output_nid generation:  0.002974271774291992
local_in_edges_tensor generation:  0.0015866756439208984
mini_batch_src_global generation:  0.0017371177673339844
r_  generation:  0.022296905517578125
local_output_nid generation:  0.0029942989349365234
local_in_edges_tensor generation:  0.0016064643859863281
mini_batch_src_global generation:  0.0018019676208496094
r_  generation:  0.022281646728515625
local_output_nid generation:  0.002957582473754883
local_in_edges_tensor generation:  0.001590728759765625
mini_batch_src_global generation:  0.0018074512481689453
r_  generation:  0.02273869514465332
----------------------check_connections_block total spend ----------------------------- 0.5753202438354492
generate_one_block  0.031098604202270508
generate_one_block  0.031098365783691406
generate_one_block  0.0312345027923584
generate_one_block  0.03164935111999512
generate_one_block  0.031026840209960938
generate_one_block  0.03441929817199707
generate_one_block  0.031174659729003906
generate_one_block  0.03190183639526367
generate_one_block  0.03160667419433594
generate_one_block  0.0310513973236084
generate_one_block  0.031385183334350586
generate_one_block  0.03126406669616699
generate_one_block  0.031243562698364258
generate_one_block  0.03130149841308594
generate_one_block  0.030979633331298828
generate_one_block  0.03211331367492676
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03741574287414551
gen group dst list time:  0.01774144172668457
time for parepare:  0.021503448486328125
local_output_nid generation:  0.009493112564086914
local_in_edges_tensor generation:  0.026936054229736328
mini_batch_src_global generation:  0.02746105194091797
r_  generation:  0.2498950958251953
local_output_nid generation:  0.013132810592651367
local_in_edges_tensor generation:  0.019078731536865234
mini_batch_src_global generation:  0.033631324768066406
r_  generation:  0.25745558738708496
local_output_nid generation:  0.013330698013305664
local_in_edges_tensor generation:  0.015845298767089844
mini_batch_src_global generation:  0.031334877014160156
r_  generation:  0.2608017921447754
local_output_nid generation:  0.013955116271972656
local_in_edges_tensor generation:  0.018051624298095703
mini_batch_src_global generation:  0.03349781036376953
r_  generation:  0.2740612030029297
local_output_nid generation:  0.013614654541015625
local_in_edges_tensor generation:  0.019029855728149414
mini_batch_src_global generation:  0.03630375862121582
r_  generation:  0.27105212211608887
local_output_nid generation:  0.014030218124389648
local_in_edges_tensor generation:  0.023388147354125977
mini_batch_src_global generation:  0.035486698150634766
r_  generation:  0.28166985511779785
local_output_nid generation:  0.016903162002563477
local_in_edges_tensor generation:  0.016351699829101562
mini_batch_src_global generation:  0.034429311752319336
r_  generation:  0.2867305278778076
local_output_nid generation:  0.01638317108154297
local_in_edges_tensor generation:  0.017050981521606445
mini_batch_src_global generation:  0.034656524658203125
r_  generation:  0.2738490104675293
local_output_nid generation:  0.014372587203979492
local_in_edges_tensor generation:  0.016570329666137695
mini_batch_src_global generation:  0.035309791564941406
r_  generation:  0.2749509811401367
local_output_nid generation:  0.01430368423461914
local_in_edges_tensor generation:  0.014379262924194336
mini_batch_src_global generation:  0.034934282302856445
r_  generation:  0.2781054973602295
local_output_nid generation:  0.014129877090454102
local_in_edges_tensor generation:  0.015105724334716797
mini_batch_src_global generation:  0.035363197326660156
r_  generation:  0.27514052391052246
local_output_nid generation:  0.014355897903442383
local_in_edges_tensor generation:  0.015453815460205078
mini_batch_src_global generation:  0.03480815887451172
r_  generation:  0.2776930332183838
local_output_nid generation:  0.014270305633544922
local_in_edges_tensor generation:  0.014357328414916992
mini_batch_src_global generation:  0.03470921516418457
r_  generation:  0.27211475372314453
local_output_nid generation:  0.01413273811340332
local_in_edges_tensor generation:  0.015103578567504883
mini_batch_src_global generation:  0.03607583045959473
r_  generation:  0.28179359436035156
local_output_nid generation:  0.014233112335205078
local_in_edges_tensor generation:  0.014450311660766602
mini_batch_src_global generation:  0.03469228744506836
r_  generation:  0.2749671936035156
local_output_nid generation:  0.01446223258972168
local_in_edges_tensor generation:  0.01861095428466797
mini_batch_src_global generation:  0.037238359451293945
r_  generation:  0.2864353656768799
----------------------check_connections_block total spend ----------------------------- 6.3850579261779785
generate_one_block  0.370924711227417
generate_one_block  0.3519001007080078
generate_one_block  0.35274744033813477
generate_one_block  0.3578178882598877
generate_one_block  0.3547849655151367
generate_one_block  0.36777520179748535
generate_one_block  0.3879663944244385
generate_one_block  0.35322022438049316
generate_one_block  0.3560609817504883
generate_one_block  0.3557887077331543
generate_one_block  0.35605835914611816
generate_one_block  0.3561677932739258
generate_one_block  0.3497319221496582
generate_one_block  0.36104631423950195
generate_one_block  0.3507506847381592
generate_one_block  0.3619849681854248
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03696155548095703
gen group dst list time:  0.06605029106140137
time for parepare:  0.02016472816467285
local_output_nid generation:  0.028751850128173828
local_in_edges_tensor generation:  0.05238533020019531
mini_batch_src_global generation:  0.0435633659362793
r_  generation:  0.46032047271728516
local_output_nid generation:  0.03356504440307617
local_in_edges_tensor generation:  0.0390169620513916
mini_batch_src_global generation:  0.055906057357788086
r_  generation:  0.461397647857666
local_output_nid generation:  0.03319287300109863
local_in_edges_tensor generation:  0.03285408020019531
mini_batch_src_global generation:  0.06158614158630371
r_  generation:  0.4757850170135498
local_output_nid generation:  0.03292655944824219
local_in_edges_tensor generation:  0.03252100944519043
mini_batch_src_global generation:  0.052550554275512695
r_  generation:  0.47498035430908203
local_output_nid generation:  0.03327178955078125
local_in_edges_tensor generation:  0.08119845390319824
mini_batch_src_global generation:  0.05231451988220215
r_  generation:  0.47794628143310547
local_output_nid generation:  0.03378796577453613
local_in_edges_tensor generation:  0.035086870193481445
mini_batch_src_global generation:  0.05566883087158203
r_  generation:  0.4847729206085205
local_output_nid generation:  0.0335385799407959
local_in_edges_tensor generation:  0.032859086990356445
mini_batch_src_global generation:  0.05521798133850098
r_  generation:  0.47803807258605957
local_output_nid generation:  0.03293490409851074
local_in_edges_tensor generation:  0.03615593910217285
mini_batch_src_global generation:  0.054749250411987305
r_  generation:  0.48499202728271484
local_output_nid generation:  0.0335848331451416
local_in_edges_tensor generation:  0.037961483001708984
mini_batch_src_global generation:  0.05335736274719238
r_  generation:  0.4801764488220215
local_output_nid generation:  0.034337520599365234
local_in_edges_tensor generation:  0.031325578689575195
mini_batch_src_global generation:  0.05613398551940918
r_  generation:  0.4839308261871338
local_output_nid generation:  0.033590078353881836
local_in_edges_tensor generation:  0.0349428653717041
mini_batch_src_global generation:  0.058512210845947266
r_  generation:  0.49979329109191895
local_output_nid generation:  0.03662705421447754
local_in_edges_tensor generation:  0.03517007827758789
mini_batch_src_global generation:  0.05752253532409668
r_  generation:  0.4811232089996338
local_output_nid generation:  0.03448224067687988
local_in_edges_tensor generation:  0.03363156318664551
mini_batch_src_global generation:  0.054006099700927734
r_  generation:  0.47792983055114746
local_output_nid generation:  0.03429579734802246
local_in_edges_tensor generation:  0.030852079391479492
mini_batch_src_global generation:  0.05452442169189453
r_  generation:  0.48392152786254883
local_output_nid generation:  0.03440117835998535
local_in_edges_tensor generation:  0.030258655548095703
mini_batch_src_global generation:  0.05232810974121094
r_  generation:  0.48143935203552246
local_output_nid generation:  0.03451704978942871
local_in_edges_tensor generation:  0.030701637268066406
mini_batch_src_global generation:  0.05456829071044922
r_  generation:  0.4919145107269287
----------------------check_connections_block total spend ----------------------------- 11.42041802406311
generate_one_block  0.6043953895568848
generate_one_block  0.600938081741333
generate_one_block  0.6011617183685303
generate_one_block  0.6010291576385498
generate_one_block  0.6052865982055664
generate_one_block  0.5993683338165283
generate_one_block  0.5965924263000488
generate_one_block  0.5992662906646729
generate_one_block  0.6741518974304199
generate_one_block  0.6008601188659668
generate_one_block  0.6110596656799316
generate_one_block  0.6075382232666016
generate_one_block  0.6013545989990234
generate_one_block  0.5986804962158203
generate_one_block  0.602163553237915
generate_one_block  0.6090707778930664
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.12314128875732422  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

connection checking time:  17.80547595024109
block generation total time  15.457643985748291
average batch blocks generation time:  0.9661027491092682
block dataloader generation time/epoch 35.310701468411615
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.0972905158996582  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7636070251464844  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09721660614013672  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7628135681152344  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09721612930297852  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7655887603759766  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09749221801757812  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7662701606750488  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09741353988647461  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7693595886230469  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09767866134643555  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7744803428649902  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09740686416625977  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7650012969970703  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09735918045043945  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7650222778320312  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.097625732421875  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7747621536254883  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09743452072143555  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.766878604888916  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09760713577270508  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7720112800598145  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09741020202636719  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7676177024841309  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09748983383178711  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7703642845153809  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09755611419677734  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7663006782531738  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.0973505973815918  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7639493942260742  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09747982025146484  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7680625915527344  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0641995370388031 |0.015799671411514282 |0.003520578145980835 |9.432435035705566e-05 |0.003239646553993225 |0.0014529228210449219 |
----------------------------------------------------------pseudo_mini_loss sum 1.2513991594314575
Total (block generation + training)time/epoch 36.777698783313525
Training time/epoch 1.4587500095367432
Training time without block to device /epoch 1.2059552669525146
Training time without total dataloading part /epoch 0.11112570762634277
load block tensor time/epoch 1.0271925926208496
block to device time/epoch 0.2527947425842285
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 26 |
Number of nodes for computation during this epoch:  5316666
Number of first layer input nodes during this epoch:  2509101
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.12357664108276367  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025383710861206055
random selection method range initialization spend 0.00603485107421875
time for parepare:  0.02101755142211914
local_output_nid generation:  0.0023496150970458984
local_in_edges_tensor generation:  0.008105754852294922
mini_batch_src_global generation:  0.0021774768829345703
r_  generation:  0.020158052444458008
local_output_nid generation:  0.002837657928466797
local_in_edges_tensor generation:  0.0017518997192382812
mini_batch_src_global generation:  0.002499818801879883
r_  generation:  0.022986173629760742
local_output_nid generation:  0.0029561519622802734
local_in_edges_tensor generation:  0.0016407966613769531
mini_batch_src_global generation:  0.0018134117126464844
r_  generation:  0.022032499313354492
local_output_nid generation:  0.002962350845336914
local_in_edges_tensor generation:  0.0017309188842773438
mini_batch_src_global generation:  0.001890420913696289
r_  generation:  0.0225069522857666
local_output_nid generation:  0.002980947494506836
local_in_edges_tensor generation:  0.0016391277313232422
mini_batch_src_global generation:  0.0018470287322998047
r_  generation:  0.021623611450195312
local_output_nid generation:  0.0029926300048828125
local_in_edges_tensor generation:  0.0016865730285644531
mini_batch_src_global generation:  0.0018353462219238281
r_  generation:  0.02232956886291504
local_output_nid generation:  0.003047943115234375
local_in_edges_tensor generation:  0.0017008781433105469
mini_batch_src_global generation:  0.0018305778503417969
r_  generation:  0.02288031578063965
local_output_nid generation:  0.002980947494506836
local_in_edges_tensor generation:  0.0015861988067626953
mini_batch_src_global generation:  0.0018570423126220703
r_  generation:  0.022884607315063477
local_output_nid generation:  0.002954244613647461
local_in_edges_tensor generation:  0.0016317367553710938
mini_batch_src_global generation:  0.0019037723541259766
r_  generation:  0.02251267433166504
local_output_nid generation:  0.002969026565551758
local_in_edges_tensor generation:  0.001645803451538086
mini_batch_src_global generation:  0.0018320083618164062
r_  generation:  0.02197098731994629
local_output_nid generation:  0.0029718875885009766
local_in_edges_tensor generation:  0.0015461444854736328
mini_batch_src_global generation:  0.001873016357421875
r_  generation:  0.022328853607177734
local_output_nid generation:  0.003022432327270508
local_in_edges_tensor generation:  0.001598358154296875
mini_batch_src_global generation:  0.0018155574798583984
r_  generation:  0.022199630737304688
local_output_nid generation:  0.0029773712158203125
local_in_edges_tensor generation:  0.0016083717346191406
mini_batch_src_global generation:  0.001795053482055664
r_  generation:  0.022003173828125
local_output_nid generation:  0.003002166748046875
local_in_edges_tensor generation:  0.001598358154296875
mini_batch_src_global generation:  0.0018613338470458984
r_  generation:  0.022532224655151367
local_output_nid generation:  0.0030450820922851562
local_in_edges_tensor generation:  0.0015976428985595703
mini_batch_src_global generation:  0.0018811225891113281
r_  generation:  0.022052764892578125
local_output_nid generation:  0.0029473304748535156
local_in_edges_tensor generation:  0.0015587806701660156
mini_batch_src_global generation:  0.0017583370208740234
r_  generation:  0.021755218505859375
----------------------check_connections_block total spend ----------------------------- 0.5757942199707031
generate_one_block  0.037223100662231445
generate_one_block  0.032117605209350586
generate_one_block  0.03155016899108887
generate_one_block  0.03179192543029785
generate_one_block  0.031116485595703125
generate_one_block  0.03457379341125488
generate_one_block  0.031133651733398438
generate_one_block  0.03234601020812988
generate_one_block  0.03161978721618652
generate_one_block  0.030598163604736328
generate_one_block  0.03155040740966797
generate_one_block  0.031125545501708984
generate_one_block  0.030974388122558594
generate_one_block  0.031836748123168945
generate_one_block  0.030890941619873047
generate_one_block  0.031164884567260742
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.08767271041870117
gen group dst list time:  0.01906752586364746
time for parepare:  0.019619226455688477
local_output_nid generation:  0.009160518646240234
local_in_edges_tensor generation:  0.03485274314880371
mini_batch_src_global generation:  0.029131650924682617
r_  generation:  0.25267958641052246
local_output_nid generation:  0.02118539810180664
local_in_edges_tensor generation:  0.02608633041381836
mini_batch_src_global generation:  0.03470444679260254
r_  generation:  0.29413938522338867
local_output_nid generation:  0.018650531768798828
local_in_edges_tensor generation:  0.02192234992980957
mini_batch_src_global generation:  0.03961467742919922
r_  generation:  0.2841498851776123
local_output_nid generation:  0.014600515365600586
local_in_edges_tensor generation:  0.016490459442138672
mini_batch_src_global generation:  0.036925554275512695
r_  generation:  0.2899208068847656
local_output_nid generation:  0.013564825057983398
local_in_edges_tensor generation:  0.014465093612670898
mini_batch_src_global generation:  0.03780245780944824
r_  generation:  0.2929556369781494
local_output_nid generation:  0.01404881477355957
local_in_edges_tensor generation:  0.015792369842529297
mini_batch_src_global generation:  0.0405735969543457
r_  generation:  0.3054168224334717
local_output_nid generation:  0.014112472534179688
local_in_edges_tensor generation:  0.019307613372802734
mini_batch_src_global generation:  0.042511940002441406
r_  generation:  0.29644155502319336
local_output_nid generation:  0.0142974853515625
local_in_edges_tensor generation:  0.021140575408935547
mini_batch_src_global generation:  0.04283642768859863
r_  generation:  0.30866575241088867
local_output_nid generation:  0.017534494400024414
local_in_edges_tensor generation:  0.01843404769897461
mini_batch_src_global generation:  0.04118013381958008
r_  generation:  0.31521105766296387
local_output_nid generation:  0.016443967819213867
local_in_edges_tensor generation:  0.019520998001098633
mini_batch_src_global generation:  0.039403438568115234
r_  generation:  0.2950296401977539
local_output_nid generation:  0.014319419860839844
local_in_edges_tensor generation:  0.013925790786743164
mini_batch_src_global generation:  0.04067826271057129
r_  generation:  0.31359076499938965
local_output_nid generation:  0.014259576797485352
local_in_edges_tensor generation:  0.01357722282409668
mini_batch_src_global generation:  0.03889822959899902
r_  generation:  0.296602725982666
local_output_nid generation:  0.014255046844482422
local_in_edges_tensor generation:  0.014324188232421875
mini_batch_src_global generation:  0.04002547264099121
r_  generation:  0.2961618900299072
local_output_nid generation:  0.014537572860717773
local_in_edges_tensor generation:  0.0166318416595459
mini_batch_src_global generation:  0.04019284248352051
r_  generation:  0.3017759323120117
local_output_nid generation:  0.014147281646728516
local_in_edges_tensor generation:  0.02039790153503418
mini_batch_src_global generation:  0.03950238227844238
r_  generation:  0.29198718070983887
local_output_nid generation:  0.014351844787597656
local_in_edges_tensor generation:  0.017779827117919922
mini_batch_src_global generation:  0.04231691360473633
r_  generation:  0.30004119873046875
----------------------check_connections_block total spend ----------------------------- 6.9494500160217285
generate_one_block  0.36026477813720703
generate_one_block  0.3615443706512451
generate_one_block  0.35993218421936035
generate_one_block  0.36014533042907715
generate_one_block  0.3530550003051758
generate_one_block  0.36274218559265137
generate_one_block  0.38667750358581543
generate_one_block  0.37965917587280273
generate_one_block  0.35968708992004395
generate_one_block  0.3490025997161865
generate_one_block  0.36225295066833496
generate_one_block  0.35279297828674316
generate_one_block  0.35093259811401367
generate_one_block  0.35781192779541016
generate_one_block  0.3458268642425537
generate_one_block  0.35290026664733887
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03488421440124512
gen group dst list time:  0.07025957107543945
time for parepare:  0.019762039184570312
local_output_nid generation:  0.029704570770263672
local_in_edges_tensor generation:  0.052748918533325195
mini_batch_src_global generation:  0.05415773391723633
r_  generation:  0.4770936965942383
local_output_nid generation:  0.036016225814819336
local_in_edges_tensor generation:  0.041318416595458984
mini_batch_src_global generation:  0.05881476402282715
r_  generation:  0.49184179306030273
local_output_nid generation:  0.038649797439575195
local_in_edges_tensor generation:  0.037238359451293945
mini_batch_src_global generation:  0.058980464935302734
r_  generation:  0.4807264804840088
local_output_nid generation:  0.0343785285949707
local_in_edges_tensor generation:  0.03003096580505371
mini_batch_src_global generation:  0.05412149429321289
r_  generation:  0.47760629653930664
local_output_nid generation:  0.03658914566040039
local_in_edges_tensor generation:  0.08792686462402344
mini_batch_src_global generation:  0.05522418022155762
r_  generation:  0.4930851459503174
local_output_nid generation:  0.0330655574798584
local_in_edges_tensor generation:  0.03238654136657715
mini_batch_src_global generation:  0.05699753761291504
r_  generation:  0.49382829666137695
local_output_nid generation:  0.03371405601501465
local_in_edges_tensor generation:  0.03448486328125
mini_batch_src_global generation:  0.05748319625854492
r_  generation:  0.4933791160583496
local_output_nid generation:  0.03491926193237305
local_in_edges_tensor generation:  0.03675079345703125
mini_batch_src_global generation:  0.05967998504638672
r_  generation:  0.517613410949707
local_output_nid generation:  0.03667187690734863
local_in_edges_tensor generation:  0.040431976318359375
mini_batch_src_global generation:  0.0640861988067627
r_  generation:  0.47894954681396484
local_output_nid generation:  0.03418469429016113
local_in_edges_tensor generation:  0.03215217590332031
mini_batch_src_global generation:  0.05433797836303711
r_  generation:  0.4812469482421875
local_output_nid generation:  0.034464120864868164
local_in_edges_tensor generation:  0.031880855560302734
mini_batch_src_global generation:  0.055716514587402344
r_  generation:  0.48136305809020996
local_output_nid generation:  0.03425455093383789
local_in_edges_tensor generation:  0.030423879623413086
mini_batch_src_global generation:  0.054654598236083984
r_  generation:  0.4902992248535156
local_output_nid generation:  0.03409528732299805
local_in_edges_tensor generation:  0.0302734375
mini_batch_src_global generation:  0.05333065986633301
r_  generation:  0.4822056293487549
local_output_nid generation:  0.036231279373168945
local_in_edges_tensor generation:  0.03478074073791504
mini_batch_src_global generation:  0.05416250228881836
r_  generation:  0.48749327659606934
local_output_nid generation:  0.03444051742553711
local_in_edges_tensor generation:  0.0323789119720459
mini_batch_src_global generation:  0.055016517639160156
r_  generation:  0.47960376739501953
local_output_nid generation:  0.03420901298522949
local_in_edges_tensor generation:  0.03223824501037598
mini_batch_src_global generation:  0.05518698692321777
r_  generation:  0.48902034759521484
----------------------check_connections_block total spend ----------------------------- 11.668486595153809
generate_one_block  0.6098196506500244
generate_one_block  0.6072866916656494
generate_one_block  0.6038389205932617
generate_one_block  0.6065464019775391
generate_one_block  0.6099061965942383
generate_one_block  0.6086342334747314
generate_one_block  0.595088005065918
generate_one_block  0.6044845581054688
generate_one_block  0.6389074325561523
generate_one_block  0.5970356464385986
generate_one_block  0.6019656658172607
generate_one_block  0.6060094833374023
generate_one_block  0.613811731338501
generate_one_block  0.6055986881256104
generate_one_block  0.6077909469604492
generate_one_block  0.6011898517608643
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.12357664108276367  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

connection checking time:  18.617936611175537
block generation total time  15.47314190864563
average batch blocks generation time:  0.9670713692903519
block dataloader generation time/epoch 35.36927602026198
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09721946716308594  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7615742683410645  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.0977025032043457  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7754521369934082  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09746789932250977  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7676820755004883  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09739160537719727  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7656874656677246  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09742116928100586  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7661857604980469  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09758615493774414  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7723250389099121  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09741973876953125  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.764772891998291  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09768533706665039  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7761363983154297  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09744501113891602  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7714252471923828  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09731292724609375  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7644624710083008  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09756040573120117  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7677402496337891  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09736824035644531  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7648482322692871  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09733009338378906  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7655057907104492  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09754037857055664  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7743220329284668  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09720373153686523  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7642273902893066  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09744882583618164  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.766324520111084  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0655147135257721 |0.014569595456123352 |0.003848552703857422 |9.582936763763428e-05 |0.0035979896783828735 |0.0017178058624267578 |
----------------------------------------------------------pseudo_mini_loss sum 1.237198829650879
Total (block generation + training)time/epoch 36.83636734220717
Training time/epoch 1.4684514999389648
Training time without block to device /epoch 1.2353379726409912
Training time without total dataloading part /epoch 0.12239575386047363
load block tensor time/epoch 1.0482354164123535
block to device time/epoch 0.23311352729797363
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 27 |
Number of nodes for computation during this epoch:  5317990
Number of first layer input nodes during this epoch:  2509118
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.12310600280761719  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026603221893310547
random selection method range initialization spend 0.005553007125854492
time for parepare:  0.019066333770751953
local_output_nid generation:  0.00241851806640625
local_in_edges_tensor generation:  0.0073964595794677734
mini_batch_src_global generation:  0.0018019676208496094
r_  generation:  0.02142047882080078
local_output_nid generation:  0.003049135208129883
local_in_edges_tensor generation:  0.0018575191497802734
mini_batch_src_global generation:  0.0021440982818603516
r_  generation:  0.024902820587158203
local_output_nid generation:  0.0030367374420166016
local_in_edges_tensor generation:  0.0016832351684570312
mini_batch_src_global generation:  0.0017673969268798828
r_  generation:  0.022196054458618164
local_output_nid generation:  0.003014802932739258
local_in_edges_tensor generation:  0.0018224716186523438
mini_batch_src_global generation:  0.0017626285552978516
r_  generation:  0.022244691848754883
local_output_nid generation:  0.0037419795989990234
local_in_edges_tensor generation:  0.0016415119171142578
mini_batch_src_global generation:  0.0018110275268554688
r_  generation:  0.023754119873046875
local_output_nid generation:  0.003082275390625
local_in_edges_tensor generation:  0.0016236305236816406
mini_batch_src_global generation:  0.001748800277709961
r_  generation:  0.02208733558654785
local_output_nid generation:  0.0029981136322021484
local_in_edges_tensor generation:  0.0016062259674072266
mini_batch_src_global generation:  0.0017552375793457031
r_  generation:  0.022200584411621094
local_output_nid generation:  0.003007650375366211
local_in_edges_tensor generation:  0.0016925334930419922
mini_batch_src_global generation:  0.0017724037170410156
r_  generation:  0.025487422943115234
local_output_nid generation:  0.0030088424682617188
local_in_edges_tensor generation:  0.0017130374908447266
mini_batch_src_global generation:  0.0017690658569335938
r_  generation:  0.02295374870300293
local_output_nid generation:  0.0030145645141601562
local_in_edges_tensor generation:  0.001683950424194336
mini_batch_src_global generation:  0.0018067359924316406
r_  generation:  0.022255659103393555
local_output_nid generation:  0.0030143260955810547
local_in_edges_tensor generation:  0.0016198158264160156
mini_batch_src_global generation:  0.0018067359924316406
r_  generation:  0.026225805282592773
local_output_nid generation:  0.004255056381225586
local_in_edges_tensor generation:  0.001623392105102539
mini_batch_src_global generation:  0.0018649101257324219
r_  generation:  0.02321314811706543
local_output_nid generation:  0.003026723861694336
local_in_edges_tensor generation:  0.0015671253204345703
mini_batch_src_global generation:  0.0018260478973388672
r_  generation:  0.023236751556396484
local_output_nid generation:  0.0030412673950195312
local_in_edges_tensor generation:  0.0016689300537109375
mini_batch_src_global generation:  0.0018298625946044922
r_  generation:  0.0258481502532959
local_output_nid generation:  0.003053426742553711
local_in_edges_tensor generation:  0.00186920166015625
mini_batch_src_global generation:  0.0017747879028320312
r_  generation:  0.02200007438659668
local_output_nid generation:  0.0030341148376464844
local_in_edges_tensor generation:  0.0016515254974365234
mini_batch_src_global generation:  0.001748800277709961
r_  generation:  0.021888256072998047
----------------------check_connections_block total spend ----------------------------- 0.5936229228973389
generate_one_block  0.031186342239379883
generate_one_block  0.03169703483581543
generate_one_block  0.03197765350341797
generate_one_block  0.03211498260498047
generate_one_block  0.031052350997924805
generate_one_block  0.033565521240234375
generate_one_block  0.03147530555725098
generate_one_block  0.03249669075012207
generate_one_block  0.031820058822631836
generate_one_block  0.03103804588317871
generate_one_block  0.031659603118896484
generate_one_block  0.03243422508239746
generate_one_block  0.031987667083740234
generate_one_block  0.030896663665771484
generate_one_block  0.030420780181884766
generate_one_block  0.03134298324584961
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.038265228271484375
gen group dst list time:  0.018823623657226562
time for parepare:  0.020220041275024414
local_output_nid generation:  0.00936436653137207
local_in_edges_tensor generation:  0.02802133560180664
mini_batch_src_global generation:  0.027523040771484375
r_  generation:  0.25092315673828125
local_output_nid generation:  0.013631582260131836
local_in_edges_tensor generation:  0.019262313842773438
mini_batch_src_global generation:  0.03411984443664551
r_  generation:  0.26653194427490234
local_output_nid generation:  0.013170719146728516
local_in_edges_tensor generation:  0.015599727630615234
mini_batch_src_global generation:  0.03262662887573242
r_  generation:  0.2671213150024414
local_output_nid generation:  0.013543128967285156
local_in_edges_tensor generation:  0.014489173889160156
mini_batch_src_global generation:  0.033242225646972656
r_  generation:  0.27243685722351074
local_output_nid generation:  0.013792991638183594
local_in_edges_tensor generation:  0.017776966094970703
mini_batch_src_global generation:  0.03436446189880371
r_  generation:  0.26880812644958496
local_output_nid generation:  0.013587713241577148
local_in_edges_tensor generation:  0.017091751098632812
mini_batch_src_global generation:  0.03448343276977539
r_  generation:  0.2682983875274658
local_output_nid generation:  0.013929128646850586
local_in_edges_tensor generation:  0.02034473419189453
mini_batch_src_global generation:  0.034262657165527344
r_  generation:  0.26996803283691406
local_output_nid generation:  0.014034032821655273
local_in_edges_tensor generation:  0.014452695846557617
mini_batch_src_global generation:  0.03603672981262207
r_  generation:  0.2777104377746582
local_output_nid generation:  0.01419377326965332
local_in_edges_tensor generation:  0.015453815460205078
mini_batch_src_global generation:  0.03550434112548828
r_  generation:  0.2769889831542969
local_output_nid generation:  0.013801336288452148
local_in_edges_tensor generation:  0.014114141464233398
mini_batch_src_global generation:  0.03455853462219238
r_  generation:  0.27716612815856934
local_output_nid generation:  0.013644218444824219
local_in_edges_tensor generation:  0.014359712600708008
mini_batch_src_global generation:  0.03470349311828613
r_  generation:  0.27280664443969727
local_output_nid generation:  0.013934135437011719
local_in_edges_tensor generation:  0.013589859008789062
mini_batch_src_global generation:  0.03516125679016113
r_  generation:  0.2822887897491455
local_output_nid generation:  0.014316320419311523
local_in_edges_tensor generation:  0.017897605895996094
mini_batch_src_global generation:  0.03650045394897461
r_  generation:  0.2788116931915283
local_output_nid generation:  0.014078140258789062
local_in_edges_tensor generation:  0.0169374942779541
mini_batch_src_global generation:  0.03492164611816406
r_  generation:  0.27390432357788086
local_output_nid generation:  0.013748407363891602
local_in_edges_tensor generation:  0.015124082565307617
mini_batch_src_global generation:  0.034952640533447266
r_  generation:  0.2695283889770508
local_output_nid generation:  0.013954401016235352
local_in_edges_tensor generation:  0.017029523849487305
mini_batch_src_global generation:  0.034218788146972656
r_  generation:  0.2738769054412842
----------------------check_connections_block total spend ----------------------------- 6.327786922454834
generate_one_block  0.37120914459228516
generate_one_block  0.3600926399230957
generate_one_block  0.3697960376739502
generate_one_block  0.36138248443603516
generate_one_block  0.360257625579834
generate_one_block  0.34551262855529785
generate_one_block  0.38178372383117676
generate_one_block  0.36211061477661133
generate_one_block  0.35812878608703613
generate_one_block  0.35219526290893555
generate_one_block  0.35117101669311523
generate_one_block  0.35572266578674316
generate_one_block  0.35962605476379395
generate_one_block  0.35669398307800293
generate_one_block  0.35770511627197266
generate_one_block  0.34443163871765137
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.037450313568115234
gen group dst list time:  0.06589603424072266
time for parepare:  0.019463062286376953
local_output_nid generation:  0.02879190444946289
local_in_edges_tensor generation:  0.05354142189025879
mini_batch_src_global generation:  0.041619300842285156
r_  generation:  0.4639570713043213
local_output_nid generation:  0.03333854675292969
local_in_edges_tensor generation:  0.037508249282836914
mini_batch_src_global generation:  0.05643463134765625
r_  generation:  0.46242594718933105
local_output_nid generation:  0.033334970474243164
local_in_edges_tensor generation:  0.0359044075012207
mini_batch_src_global generation:  0.05198240280151367
r_  generation:  0.47351741790771484
local_output_nid generation:  0.03475046157836914
local_in_edges_tensor generation:  0.03347516059875488
mini_batch_src_global generation:  0.05296063423156738
r_  generation:  0.4666934013366699
local_output_nid generation:  0.03282928466796875
local_in_edges_tensor generation:  0.07945585250854492
mini_batch_src_global generation:  0.05638742446899414
r_  generation:  0.4772317409515381
local_output_nid generation:  0.03290414810180664
local_in_edges_tensor generation:  0.034984588623046875
mini_batch_src_global generation:  0.05622148513793945
r_  generation:  0.4796767234802246
local_output_nid generation:  0.03402137756347656
local_in_edges_tensor generation:  0.03864598274230957
mini_batch_src_global generation:  0.05465078353881836
r_  generation:  0.4785909652709961
local_output_nid generation:  0.0367889404296875
local_in_edges_tensor generation:  0.037158966064453125
mini_batch_src_global generation:  0.06126093864440918
r_  generation:  0.48719191551208496
local_output_nid generation:  0.0356748104095459
local_in_edges_tensor generation:  0.03375840187072754
mini_batch_src_global generation:  0.05658602714538574
r_  generation:  0.4788637161254883
local_output_nid generation:  0.03372669219970703
local_in_edges_tensor generation:  0.03165459632873535
mini_batch_src_global generation:  0.054486751556396484
r_  generation:  0.4808921813964844
local_output_nid generation:  0.03404045104980469
local_in_edges_tensor generation:  0.03349494934082031
mini_batch_src_global generation:  0.055429697036743164
r_  generation:  0.4771878719329834
local_output_nid generation:  0.03406643867492676
local_in_edges_tensor generation:  0.03231453895568848
mini_batch_src_global generation:  0.056864261627197266
r_  generation:  0.48172998428344727
local_output_nid generation:  0.03404808044433594
local_in_edges_tensor generation:  0.03191041946411133
mini_batch_src_global generation:  0.054309844970703125
r_  generation:  0.47811174392700195
local_output_nid generation:  0.033803462982177734
local_in_edges_tensor generation:  0.03486800193786621
mini_batch_src_global generation:  0.06013631820678711
r_  generation:  0.4817965030670166
local_output_nid generation:  0.03364872932434082
local_in_edges_tensor generation:  0.03322029113769531
mini_batch_src_global generation:  0.055635690689086914
r_  generation:  0.47614002227783203
local_output_nid generation:  0.03362298011779785
local_in_edges_tensor generation:  0.031063556671142578
mini_batch_src_global generation:  0.054500579833984375
r_  generation:  0.4830284118652344
----------------------check_connections_block total spend ----------------------------- 11.385512590408325
generate_one_block  0.6032118797302246
generate_one_block  0.6010444164276123
generate_one_block  0.6073431968688965
generate_one_block  0.5931906700134277
generate_one_block  0.5987226963043213
generate_one_block  0.5900917053222656
generate_one_block  0.6017272472381592
generate_one_block  0.6020691394805908
generate_one_block  0.6703433990478516
generate_one_block  0.5960102081298828
generate_one_block  0.5951330661773682
generate_one_block  0.5962231159210205
generate_one_block  0.5953555107116699
generate_one_block  0.6043422222137451
generate_one_block  0.5973331928253174
generate_one_block  0.6068997383117676
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.12310600280761719  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

connection checking time:  17.71329951286316
block generation total time  15.406860828399658
average batch blocks generation time:  0.9629288017749786
block dataloader generation time/epoch 35.36815859142103
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09747791290283203  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7677216529846191  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09758567810058594  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7680788040161133  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09773015975952148  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7749581336975098  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09745359420776367  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7674703598022461  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.0974264144897461  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7655820846557617  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09711694717407227  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7585906982421875  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09744691848754883  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7657594680786133  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09766674041748047  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7747936248779297  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09757661819458008  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7744879722595215  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09732580184936523  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7604608535766602  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09728240966796875  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7670893669128418  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09747505187988281  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.767127513885498  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09760189056396484  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7754049301147461  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09736490249633789  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7657871246337891  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09718799591064453  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7619352340698242  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09731912612915039  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.764488697052002  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06771540641784668 |0.016682162880897522 |0.0035995841026306152 |9.310245513916016e-05 |0.003703564405441284 |0.002901792526245117 |
----------------------------------------------------------pseudo_mini_loss sum 1.222705602645874
Total (block generation + training)time/epoch 36.8387863134083
Training time/epoch 1.5340478420257568
Training time without block to device /epoch 1.2671332359313965
Training time without total dataloading part /epoch 0.12124180793762207
load block tensor time/epoch 1.0834465026855469
block to device time/epoch 0.26691460609436035
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 28 |
Number of nodes for computation during this epoch:  5316367
Number of first layer input nodes during this epoch:  2509033
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.12282419204711914  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024246931076049805
random selection method range initialization spend 0.005054473876953125
time for parepare:  0.019054174423217773
local_output_nid generation:  0.0023572444915771484
local_in_edges_tensor generation:  0.0048215389251708984
mini_batch_src_global generation:  0.0021483898162841797
r_  generation:  0.02102971076965332
local_output_nid generation:  0.002971649169921875
local_in_edges_tensor generation:  0.001840353012084961
mini_batch_src_global generation:  0.0023565292358398438
r_  generation:  0.02293229103088379
local_output_nid generation:  0.003031015396118164
local_in_edges_tensor generation:  0.0018951892852783203
mini_batch_src_global generation:  0.0018320083618164062
r_  generation:  0.02176833152770996
local_output_nid generation:  0.003055095672607422
local_in_edges_tensor generation:  0.0017008781433105469
mini_batch_src_global generation:  0.0018296241760253906
r_  generation:  0.021898984909057617
local_output_nid generation:  0.0031049251556396484
local_in_edges_tensor generation:  0.0017273426055908203
mini_batch_src_global generation:  0.0017919540405273438
r_  generation:  0.021739959716796875
local_output_nid generation:  0.0030188560485839844
local_in_edges_tensor generation:  0.0016717910766601562
mini_batch_src_global generation:  0.001744985580444336
r_  generation:  0.021843671798706055
local_output_nid generation:  0.003039121627807617
local_in_edges_tensor generation:  0.001641988754272461
mini_batch_src_global generation:  0.0018284320831298828
r_  generation:  0.023067712783813477
local_output_nid generation:  0.0030584335327148438
local_in_edges_tensor generation:  0.0016753673553466797
mini_batch_src_global generation:  0.0018219947814941406
r_  generation:  0.02249741554260254
local_output_nid generation:  0.003048419952392578
local_in_edges_tensor generation:  0.00165557861328125
mini_batch_src_global generation:  0.0018546581268310547
r_  generation:  0.022925853729248047
local_output_nid generation:  0.0031464099884033203
local_in_edges_tensor generation:  0.0016384124755859375
mini_batch_src_global generation:  0.0017964839935302734
r_  generation:  0.021989822387695312
local_output_nid generation:  0.003045797348022461
local_in_edges_tensor generation:  0.0016660690307617188
mini_batch_src_global generation:  0.0017673969268798828
r_  generation:  0.021921873092651367
local_output_nid generation:  0.0030252933502197266
local_in_edges_tensor generation:  0.001607656478881836
mini_batch_src_global generation:  0.0017597675323486328
r_  generation:  0.02214503288269043
local_output_nid generation:  0.003028392791748047
local_in_edges_tensor generation:  0.0015935897827148438
mini_batch_src_global generation:  0.0018117427825927734
r_  generation:  0.022845745086669922
local_output_nid generation:  0.003057718276977539
local_in_edges_tensor generation:  0.001646280288696289
mini_batch_src_global generation:  0.0018210411071777344
r_  generation:  0.022614479064941406
local_output_nid generation:  0.0030710697174072266
local_in_edges_tensor generation:  0.00159454345703125
mini_batch_src_global generation:  0.001768350601196289
r_  generation:  0.021892786026000977
local_output_nid generation:  0.0030434131622314453
local_in_edges_tensor generation:  0.001575469970703125
mini_batch_src_global generation:  0.0017910003662109375
r_  generation:  0.02261495590209961
----------------------check_connections_block total spend ----------------------------- 0.5765435695648193
generate_one_block  0.03877568244934082
generate_one_block  0.03139162063598633
generate_one_block  0.031310081481933594
generate_one_block  0.030913591384887695
generate_one_block  0.03172636032104492
generate_one_block  0.0338442325592041
generate_one_block  0.03383302688598633
generate_one_block  0.03162503242492676
generate_one_block  0.03264188766479492
generate_one_block  0.03072500228881836
generate_one_block  0.030673742294311523
generate_one_block  0.03072333335876465
generate_one_block  0.03350043296813965
generate_one_block  0.03140115737915039
generate_one_block  0.03092503547668457
generate_one_block  0.0322115421295166
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03656816482543945
gen group dst list time:  0.01870560646057129
time for parepare:  0.020109891891479492
local_output_nid generation:  0.009436845779418945
local_in_edges_tensor generation:  0.024132490158081055
mini_batch_src_global generation:  0.026911258697509766
r_  generation:  0.24647164344787598
local_output_nid generation:  0.013292551040649414
local_in_edges_tensor generation:  0.018796920776367188
mini_batch_src_global generation:  0.03357434272766113
r_  generation:  0.2598581314086914
local_output_nid generation:  0.013184785842895508
local_in_edges_tensor generation:  0.019134998321533203
mini_batch_src_global generation:  0.03344583511352539
r_  generation:  0.2637901306152344
local_output_nid generation:  0.013808965682983398
local_in_edges_tensor generation:  0.014143705368041992
mini_batch_src_global generation:  0.032479047775268555
r_  generation:  0.270092248916626
local_output_nid generation:  0.013997316360473633
local_in_edges_tensor generation:  0.016145706176757812
mini_batch_src_global generation:  0.035169124603271484
r_  generation:  0.27590084075927734
local_output_nid generation:  0.01396322250366211
local_in_edges_tensor generation:  0.017768144607543945
mini_batch_src_global generation:  0.03409075736999512
r_  generation:  0.27710914611816406
local_output_nid generation:  0.01434469223022461
local_in_edges_tensor generation:  0.01603245735168457
mini_batch_src_global generation:  0.036856889724731445
r_  generation:  0.2794952392578125
local_output_nid generation:  0.01598072052001953
local_in_edges_tensor generation:  0.018529176712036133
mini_batch_src_global generation:  0.03487133979797363
r_  generation:  0.27790164947509766
local_output_nid generation:  0.014340400695800781
local_in_edges_tensor generation:  0.020947933197021484
mini_batch_src_global generation:  0.03701972961425781
r_  generation:  0.28188371658325195
local_output_nid generation:  0.014936685562133789
local_in_edges_tensor generation:  0.02052617073059082
mini_batch_src_global generation:  0.03551530838012695
r_  generation:  0.27450108528137207
local_output_nid generation:  0.01353001594543457
local_in_edges_tensor generation:  0.015601873397827148
mini_batch_src_global generation:  0.038889408111572266
r_  generation:  0.28072404861450195
local_output_nid generation:  0.01647782325744629
local_in_edges_tensor generation:  0.015473127365112305
mini_batch_src_global generation:  0.03640627861022949
r_  generation:  0.27693915367126465
local_output_nid generation:  0.014753580093383789
local_in_edges_tensor generation:  0.01986408233642578
mini_batch_src_global generation:  0.03803086280822754
r_  generation:  0.28303956985473633
local_output_nid generation:  0.014329671859741211
local_in_edges_tensor generation:  0.013985633850097656
mini_batch_src_global generation:  0.0351259708404541
r_  generation:  0.2753176689147949
local_output_nid generation:  0.01448202133178711
local_in_edges_tensor generation:  0.01436758041381836
mini_batch_src_global generation:  0.03544282913208008
r_  generation:  0.2728915214538574
local_output_nid generation:  0.014648675918579102
local_in_edges_tensor generation:  0.014217376708984375
mini_batch_src_global generation:  0.035059452056884766
r_  generation:  0.2817721366882324
----------------------check_connections_block total spend ----------------------------- 6.388522386550903
generate_one_block  0.35228538513183594
generate_one_block  0.3460724353790283
generate_one_block  0.35898280143737793
generate_one_block  0.36051440238952637
generate_one_block  0.37166666984558105
generate_one_block  0.35593533515930176
generate_one_block  0.392681360244751
generate_one_block  0.3591442108154297
generate_one_block  0.3607490062713623
generate_one_block  0.3486952781677246
generate_one_block  0.3494713306427002
generate_one_block  0.3577239513397217
generate_one_block  0.3735692501068115
generate_one_block  0.3495631217956543
generate_one_block  0.35363030433654785
generate_one_block  0.36609435081481934
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03609061241149902
gen group dst list time:  0.06845378875732422
time for parepare:  0.019916534423828125
local_output_nid generation:  0.029711484909057617
local_in_edges_tensor generation:  0.05374789237976074
mini_batch_src_global generation:  0.042830467224121094
r_  generation:  0.46396756172180176
local_output_nid generation:  0.03414154052734375
local_in_edges_tensor generation:  0.04261279106140137
mini_batch_src_global generation:  0.05401611328125
r_  generation:  0.4726395606994629
local_output_nid generation:  0.03319740295410156
local_in_edges_tensor generation:  0.03339099884033203
mini_batch_src_global generation:  0.05633091926574707
r_  generation:  0.48877620697021484
local_output_nid generation:  0.03634166717529297
local_in_edges_tensor generation:  0.03656005859375
mini_batch_src_global generation:  0.05463600158691406
r_  generation:  0.46869850158691406
local_output_nid generation:  0.0340731143951416
local_in_edges_tensor generation:  0.08459997177124023
mini_batch_src_global generation:  0.051938533782958984
r_  generation:  0.47528767585754395
local_output_nid generation:  0.03341054916381836
local_in_edges_tensor generation:  0.03215837478637695
mini_batch_src_global generation:  0.053568124771118164
r_  generation:  0.4751558303833008
local_output_nid generation:  0.033216238021850586
local_in_edges_tensor generation:  0.03526473045349121
mini_batch_src_global generation:  0.0531468391418457
r_  generation:  0.48050355911254883
local_output_nid generation:  0.033111572265625
local_in_edges_tensor generation:  0.03493976593017578
mini_batch_src_global generation:  0.05445981025695801
r_  generation:  0.47951579093933105
local_output_nid generation:  0.03319954872131348
local_in_edges_tensor generation:  0.0334932804107666
mini_batch_src_global generation:  0.06294369697570801
r_  generation:  0.49057674407958984
local_output_nid generation:  0.0333104133605957
local_in_edges_tensor generation:  0.030961036682128906
mini_batch_src_global generation:  0.05516171455383301
r_  generation:  0.48050713539123535
local_output_nid generation:  0.03331780433654785
local_in_edges_tensor generation:  0.030814409255981445
mini_batch_src_global generation:  0.05314517021179199
r_  generation:  0.48101186752319336
local_output_nid generation:  0.0332188606262207
local_in_edges_tensor generation:  0.031132221221923828
mini_batch_src_global generation:  0.05422830581665039
r_  generation:  0.4803657531738281
local_output_nid generation:  0.03338336944580078
local_in_edges_tensor generation:  0.03418922424316406
mini_batch_src_global generation:  0.05559062957763672
r_  generation:  0.4855797290802002
local_output_nid generation:  0.03327322006225586
local_in_edges_tensor generation:  0.03110504150390625
mini_batch_src_global generation:  0.05597710609436035
r_  generation:  0.4780266284942627
local_output_nid generation:  0.03325462341308594
local_in_edges_tensor generation:  0.030824899673461914
mini_batch_src_global generation:  0.0525057315826416
r_  generation:  0.48296117782592773
local_output_nid generation:  0.033502817153930664
local_in_edges_tensor generation:  0.03950381278991699
mini_batch_src_global generation:  0.05436348915100098
r_  generation:  0.4814610481262207
----------------------check_connections_block total spend ----------------------------- 11.411592721939087
generate_one_block  0.6038997173309326
generate_one_block  0.600275993347168
generate_one_block  0.5980978012084961
generate_one_block  0.6066679954528809
generate_one_block  0.6016056537628174
generate_one_block  0.5992276668548584
generate_one_block  0.6136548519134521
generate_one_block  0.6127181053161621
generate_one_block  0.643876314163208
generate_one_block  0.608905553817749
generate_one_block  0.6000511646270752
generate_one_block  0.5969192981719971
generate_one_block  0.6202685832977295
generate_one_block  0.594581127166748
generate_one_block  0.5959980487823486
generate_one_block  0.6092109680175781
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.12282419204711914  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

connection checking time:  17.80011510848999
block generation total time  15.462738037109375
average batch blocks generation time:  0.9664211273193359
block dataloader generation time/epoch 35.375317978858945
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.0972738265991211  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7649025917053223  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09716224670410156  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7629365921020508  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09758377075195312  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7678189277648926  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09760141372680664  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7710103988647461  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09741735458374023  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7655506134033203  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09723472595214844  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7640819549560547  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09765052795410156  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7752804756164551  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09741783142089844  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.767054557800293  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09777450561523438  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7758197784423828  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09741401672363281  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7629284858703613  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09749650955200195  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7679014205932617  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.0974435806274414  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7671093940734863  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09784460067749023  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7768359184265137  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.0974736213684082  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.766329288482666  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09743976593017578  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7660236358642578  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.09758520126342773  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 0.7724094390869141  GigaBytes
Max Memory Allocated: 0.868126392364502  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06741708517074585 |0.015695109963417053 |0.003923773765563965 |9.660422801971436e-05 |0.0036246031522750854 |0.0029544830322265625 |
----------------------------------------------------------pseudo_mini_loss sum 1.2188036441802979
Total (block generation + training)time/epoch 36.848413622379304
Training time/epoch 1.5197117328643799
Training time without block to device /epoch 1.268589973449707
Training time without total dataloading part /epoch 0.1252741813659668
load block tensor time/epoch 1.0786733627319336
block to device time/epoch 0.25112175941467285
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 29 |
Number of nodes for computation during this epoch:  5321740
Number of first layer input nodes during this epoch:  2510403
