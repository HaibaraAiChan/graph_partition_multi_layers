Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1647783406.2614014
ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0213623046875 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02472853660583496
random selection method range initialization spend 0.0063822269439697266
time for parepare:  0.01815176010131836
local_output_nid generation:  0.0021708011627197266
local_in_edges_tensor generation:  0.004696846008300781
mini_batch_src_global generation:  0.0017933845520019531
r_  generation:  0.018414974212646484
local_output_nid generation:  0.0025348663330078125
local_in_edges_tensor generation:  0.0016400814056396484
mini_batch_src_global generation:  0.0021250247955322266
r_  generation:  0.017115354537963867
local_output_nid generation:  0.002736806869506836
local_in_edges_tensor generation:  0.0015866756439208984
mini_batch_src_global generation:  0.0013642311096191406
r_  generation:  0.017435550689697266
local_output_nid generation:  0.0027871131896972656
local_in_edges_tensor generation:  0.0015537738800048828
mini_batch_src_global generation:  0.0013821125030517578
r_  generation:  0.017999649047851562
local_output_nid generation:  0.0027980804443359375
local_in_edges_tensor generation:  0.0014681816101074219
mini_batch_src_global generation:  0.0014011859893798828
r_  generation:  0.01787114143371582
local_output_nid generation:  0.002819538116455078
local_in_edges_tensor generation:  0.0014886856079101562
mini_batch_src_global generation:  0.0014655590057373047
r_  generation:  0.018605709075927734
local_output_nid generation:  0.002873659133911133
local_in_edges_tensor generation:  0.0015175342559814453
mini_batch_src_global generation:  0.0014486312866210938
r_  generation:  0.01842665672302246
local_output_nid generation:  0.002823352813720703
local_in_edges_tensor generation:  0.0015108585357666016
mini_batch_src_global generation:  0.001336812973022461
r_  generation:  0.018033266067504883
local_output_nid generation:  0.002849578857421875
local_in_edges_tensor generation:  0.0014815330505371094
mini_batch_src_global generation:  0.001422882080078125
r_  generation:  0.0183713436126709
local_output_nid generation:  0.0027866363525390625
local_in_edges_tensor generation:  0.0015411376953125
mini_batch_src_global generation:  0.001425027847290039
r_  generation:  0.018407821655273438
local_output_nid generation:  0.002821207046508789
local_in_edges_tensor generation:  0.0014836788177490234
mini_batch_src_global generation:  0.0014719963073730469
r_  generation:  0.018333911895751953
local_output_nid generation:  0.0028641223907470703
local_in_edges_tensor generation:  0.0015039443969726562
mini_batch_src_global generation:  0.0015878677368164062
r_  generation:  0.01914834976196289
local_output_nid generation:  0.0028047561645507812
local_in_edges_tensor generation:  0.0014579296112060547
mini_batch_src_global generation:  0.0015881061553955078
r_  generation:  0.018997907638549805
local_output_nid generation:  0.0028340816497802734
local_in_edges_tensor generation:  0.0014858245849609375
mini_batch_src_global generation:  0.0015532970428466797
r_  generation:  0.019034385681152344
local_output_nid generation:  0.0027952194213867188
local_in_edges_tensor generation:  0.0015034675598144531
mini_batch_src_global generation:  0.0016088485717773438
r_  generation:  0.019008636474609375
local_output_nid generation:  0.00279998779296875
local_in_edges_tensor generation:  0.0014879703521728516
mini_batch_src_global generation:  0.0015821456909179688
r_  generation:  0.018456459045410156
----------------------check_connections_block total spend ----------------------------- 0.4850754737854004
generate_one_block  0.027463197708129883
generate_one_block  0.02666497230529785
generate_one_block  0.030360698699951172
generate_one_block  0.02813243865966797
generate_one_block  0.02763986587524414
generate_one_block  0.02753472328186035
generate_one_block  0.027166128158569336
generate_one_block  0.02702188491821289
generate_one_block  0.027462482452392578
generate_one_block  0.026943445205688477
generate_one_block  0.027036666870117188
generate_one_block  0.028249502182006836
generate_one_block  0.027605533599853516
generate_one_block  0.02713799476623535
generate_one_block  0.02761244773864746
generate_one_block  0.026917457580566406
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.038858652114868164
gen group dst list time:  0.0187375545501709
time for parepare:  0.01908135414123535
local_output_nid generation:  0.008306741714477539
local_in_edges_tensor generation:  0.017906665802001953
mini_batch_src_global generation:  0.01946854591369629
r_  generation:  0.19434428215026855
local_output_nid generation:  0.01159524917602539
local_in_edges_tensor generation:  0.01901984214782715
mini_batch_src_global generation:  0.02366018295288086
r_  generation:  0.19214892387390137
local_output_nid generation:  0.011796712875366211
local_in_edges_tensor generation:  0.01410818099975586
mini_batch_src_global generation:  0.022899866104125977
r_  generation:  0.20061397552490234
local_output_nid generation:  0.012060880661010742
local_in_edges_tensor generation:  0.016076087951660156
mini_batch_src_global generation:  0.024449825286865234
r_  generation:  0.2055671215057373
local_output_nid generation:  0.011955976486206055
local_in_edges_tensor generation:  0.017977237701416016
mini_batch_src_global generation:  0.025510311126708984
r_  generation:  0.2072305679321289
local_output_nid generation:  0.011982440948486328
local_in_edges_tensor generation:  0.015821218490600586
mini_batch_src_global generation:  0.025891780853271484
r_  generation:  0.21400761604309082
local_output_nid generation:  0.011749029159545898
local_in_edges_tensor generation:  0.012694358825683594
mini_batch_src_global generation:  0.026157379150390625
r_  generation:  0.2062215805053711
local_output_nid generation:  0.011768817901611328
local_in_edges_tensor generation:  0.01213693618774414
mini_batch_src_global generation:  0.025238990783691406
r_  generation:  0.20291662216186523
local_output_nid generation:  0.012046575546264648
local_in_edges_tensor generation:  0.016148090362548828
mini_batch_src_global generation:  0.027822256088256836
r_  generation:  0.20771312713623047
local_output_nid generation:  0.011796951293945312
local_in_edges_tensor generation:  0.014647245407104492
mini_batch_src_global generation:  0.026472806930541992
r_  generation:  0.20891666412353516
local_output_nid generation:  0.012010335922241211
local_in_edges_tensor generation:  0.014410972595214844
mini_batch_src_global generation:  0.026569843292236328
r_  generation:  0.21008801460266113
local_output_nid generation:  0.012398004531860352
local_in_edges_tensor generation:  0.01758885383605957
mini_batch_src_global generation:  0.02647113800048828
r_  generation:  0.20934534072875977
local_output_nid generation:  0.01187276840209961
local_in_edges_tensor generation:  0.012598276138305664
mini_batch_src_global generation:  0.02701854705810547
r_  generation:  0.2113494873046875
local_output_nid generation:  0.011901378631591797
local_in_edges_tensor generation:  0.01298069953918457
mini_batch_src_global generation:  0.02645111083984375
r_  generation:  0.20762181282043457
local_output_nid generation:  0.011922836303710938
local_in_edges_tensor generation:  0.012569427490234375
mini_batch_src_global generation:  0.02701544761657715
r_  generation:  0.21327972412109375
local_output_nid generation:  0.011764049530029297
local_in_edges_tensor generation:  0.012413501739501953
mini_batch_src_global generation:  0.02616739273071289
r_  generation:  0.2075510025024414
----------------------check_connections_block total spend ----------------------------- 4.886617422103882
generate_one_block  0.2792959213256836
generate_one_block  0.2586398124694824
generate_one_block  0.26719164848327637
generate_one_block  0.2756834030151367
generate_one_block  0.28508830070495605
generate_one_block  0.27398014068603516
generate_one_block  0.2655494213104248
generate_one_block  0.25995922088623047
generate_one_block  0.26819515228271484
generate_one_block  0.2687842845916748
generate_one_block  0.2668008804321289
generate_one_block  0.2716257572174072
generate_one_block  0.27535128593444824
generate_one_block  0.2611517906188965
generate_one_block  0.2759664058685303
generate_one_block  0.26232481002807617
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03684854507446289
gen group dst list time:  0.05902671813964844
time for parepare:  0.018872499465942383
local_output_nid generation:  0.025324583053588867
local_in_edges_tensor generation:  0.044411420822143555
mini_batch_src_global generation:  0.04178428649902344
r_  generation:  0.4406168460845947
local_output_nid generation:  0.03073859214782715
local_in_edges_tensor generation:  0.045438289642333984
mini_batch_src_global generation:  0.05071258544921875
r_  generation:  0.4432637691497803
local_output_nid generation:  0.030527114868164062
local_in_edges_tensor generation:  0.0380091667175293
mini_batch_src_global generation:  0.04989933967590332
r_  generation:  0.44672727584838867
local_output_nid generation:  0.030525684356689453
local_in_edges_tensor generation:  0.03963613510131836
mini_batch_src_global generation:  0.052222251892089844
r_  generation:  0.44855475425720215
local_output_nid generation:  0.030309200286865234
local_in_edges_tensor generation:  0.034807682037353516
mini_batch_src_global generation:  0.051871538162231445
r_  generation:  0.450376033782959
local_output_nid generation:  0.030530214309692383
local_in_edges_tensor generation:  0.030040264129638672
mini_batch_src_global generation:  0.052402496337890625
r_  generation:  0.449601411819458
local_output_nid generation:  0.03039717674255371
local_in_edges_tensor generation:  0.030803442001342773
mini_batch_src_global generation:  0.05204367637634277
r_  generation:  0.4550778865814209
local_output_nid generation:  0.030287504196166992
local_in_edges_tensor generation:  0.030761241912841797
mini_batch_src_global generation:  0.053055763244628906
r_  generation:  0.4479527473449707
local_output_nid generation:  0.03030538558959961
local_in_edges_tensor generation:  0.03828549385070801
mini_batch_src_global generation:  0.05141472816467285
r_  generation:  0.45211219787597656
local_output_nid generation:  0.030703067779541016
local_in_edges_tensor generation:  0.03086709976196289
mini_batch_src_global generation:  0.053427934646606445
r_  generation:  0.4512770175933838
local_output_nid generation:  0.0304720401763916
local_in_edges_tensor generation:  0.03805899620056152
mini_batch_src_global generation:  0.05146503448486328
r_  generation:  0.4552891254425049
local_output_nid generation:  0.030441761016845703
local_in_edges_tensor generation:  0.037878990173339844
mini_batch_src_global generation:  0.05220460891723633
r_  generation:  0.4510486125946045
local_output_nid generation:  0.030501842498779297
local_in_edges_tensor generation:  0.03138995170593262
mini_batch_src_global generation:  0.05242133140563965
r_  generation:  0.4574556350708008
local_output_nid generation:  0.03032517433166504
local_in_edges_tensor generation:  0.030671358108520508
mini_batch_src_global generation:  0.05304551124572754
r_  generation:  0.44985365867614746
local_output_nid generation:  0.030614614486694336
local_in_edges_tensor generation:  0.041710615158081055
mini_batch_src_global generation:  0.052068233489990234
r_  generation:  0.46148109436035156
local_output_nid generation:  0.030532360076904297
local_in_edges_tensor generation:  0.03140687942504883
mini_batch_src_global generation:  0.05338287353515625
r_  generation:  0.45414257049560547
----------------------check_connections_block total spend ----------------------------- 10.661986827850342
generate_one_block  0.5792901515960693
generate_one_block  0.5632867813110352
generate_one_block  0.5710511207580566
generate_one_block  0.5834484100341797
generate_one_block  0.5743832588195801
generate_one_block  0.5930674076080322
generate_one_block  0.6308927536010742
generate_one_block  0.5828278064727783
generate_one_block  0.573702335357666
generate_one_block  0.5960531234741211
generate_one_block  0.5831432342529297
generate_one_block  0.5931074619293213
generate_one_block  0.603689432144165
generate_one_block  0.583594560623169
generate_one_block  0.6201307773590088
generate_one_block  0.588019847869873
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0213623046875 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

connection checking time:  15.548604249954224
block generation total time  13.735276699066162
average batch blocks generation time:  0.8584547936916351
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.09526968002319336  GigaBytes
Max Memory Allocated: 0.09526968002319336  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1971435546875 GB
    Memory Allocated: 21.49922275543213  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.6463623046875 GB
    Memory Allocated: 0.10033464431762695  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2987060546875 GB
    Memory Allocated: 20.6932635307312  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3006591796875 GB
    Memory Allocated: 0.10106468200683594  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6287841796875 GB
    Memory Allocated: 21.016287803649902  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6307373046875 GB
    Memory Allocated: 0.1006765365600586  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3709716796875 GB
    Memory Allocated: 21.31695556640625  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3709716796875 GB
    Memory Allocated: 0.10114097595214844  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3709716796875 GB
    Memory Allocated: 21.223777294158936  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3709716796875 GB
    Memory Allocated: 0.10063886642456055  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5819091796875 GB
    Memory Allocated: 21.321990966796875  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5819091796875 GB
    Memory Allocated: 0.10105705261230469  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5819091796875 GB
    Memory Allocated: 21.028554439544678  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5819091796875 GB
    Memory Allocated: 0.1003885269165039  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5819091796875 GB
    Memory Allocated: 20.853699684143066  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5819091796875 GB
    Memory Allocated: 0.10109710693359375  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5819091796875 GB
    Memory Allocated: 21.127114295959473  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5819091796875 GB
    Memory Allocated: 0.10071277618408203  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5819091796875 GB
    Memory Allocated: 21.0556321144104  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5819091796875 GB
    Memory Allocated: 0.1010580062866211  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5819091796875 GB
    Memory Allocated: 20.99581813812256  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5819091796875 GB
    Memory Allocated: 0.10067510604858398  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5936279296875 GB
    Memory Allocated: 21.249126434326172  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 0.10114479064941406  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 21.20335626602173  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 0.10048532485961914  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 20.998475074768066  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 0.10117816925048828  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 21.26520872116089  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 0.10034799575805664  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 20.909574508666992  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.035971030592918396 |0.03681392967700958 |0.3532491475343704 |0.00010608136653900146 |0.5828238725662231 |0.007999897003173828 |
----------------------------------------------------------pseudo_mini_loss sum 5.380466461181641
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5091545
Number of first layer input nodes during this epoch:  2471746
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 0.13350296020507812  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02147507667541504
random selection method range initialization spend 0.0054471492767333984
time for parepare:  0.01811385154724121
local_output_nid generation:  0.0027582645416259766
local_in_edges_tensor generation:  0.006964445114135742
mini_batch_src_global generation:  0.0018198490142822266
r_  generation:  0.017612934112548828
local_output_nid generation:  0.0031740665435791016
local_in_edges_tensor generation:  0.0017328262329101562
mini_batch_src_global generation:  0.0021767616271972656
r_  generation:  0.021356821060180664
local_output_nid generation:  0.0031235218048095703
local_in_edges_tensor generation:  0.0016410350799560547
mini_batch_src_global generation:  0.0014042854309082031
r_  generation:  0.018645524978637695
local_output_nid generation:  0.0031118392944335938
local_in_edges_tensor generation:  0.0015645027160644531
mini_batch_src_global generation:  0.0014171600341796875
r_  generation:  0.018470048904418945
local_output_nid generation:  0.003080129623413086
local_in_edges_tensor generation:  0.0016224384307861328
mini_batch_src_global generation:  0.0013949871063232422
r_  generation:  0.018695592880249023
local_output_nid generation:  0.003062009811401367
local_in_edges_tensor generation:  0.0015959739685058594
mini_batch_src_global generation:  0.001458883285522461
r_  generation:  0.019314289093017578
local_output_nid generation:  0.0030977725982666016
local_in_edges_tensor generation:  0.0015387535095214844
mini_batch_src_global generation:  0.0014429092407226562
r_  generation:  0.018910884857177734
local_output_nid generation:  0.003007173538208008
local_in_edges_tensor generation:  0.001516103744506836
mini_batch_src_global generation:  0.0014371871948242188
r_  generation:  0.018897056579589844
local_output_nid generation:  0.003025531768798828
local_in_edges_tensor generation:  0.0015153884887695312
mini_batch_src_global generation:  0.0014662742614746094
r_  generation:  0.01953434944152832
local_output_nid generation:  0.0030252933502197266
local_in_edges_tensor generation:  0.0015134811401367188
mini_batch_src_global generation:  0.001505136489868164
r_  generation:  0.019895076751708984
local_output_nid generation:  0.0030519962310791016
local_in_edges_tensor generation:  0.0014891624450683594
mini_batch_src_global generation:  0.0016102790832519531
r_  generation:  0.020242691040039062
local_output_nid generation:  0.0031223297119140625
local_in_edges_tensor generation:  0.0015807151794433594
mini_batch_src_global generation:  0.001547098159790039
r_  generation:  0.019796133041381836
local_output_nid generation:  0.003140687942504883
local_in_edges_tensor generation:  0.0015745162963867188
mini_batch_src_global generation:  0.0015583038330078125
r_  generation:  0.01925349235534668
local_output_nid generation:  0.0030715465545654297
local_in_edges_tensor generation:  0.0015339851379394531
mini_batch_src_global generation:  0.0015692710876464844
r_  generation:  0.019687414169311523
local_output_nid generation:  0.003095865249633789
local_in_edges_tensor generation:  0.001590728759765625
mini_batch_src_global generation:  0.0015273094177246094
r_  generation:  0.01955699920654297
local_output_nid generation:  0.0030295848846435547
local_in_edges_tensor generation:  0.0015392303466796875
mini_batch_src_global generation:  0.0015430450439453125
r_  generation:  0.019798994064331055
----------------------check_connections_block total spend ----------------------------- 0.5144593715667725
generate_one_block  0.04486203193664551
generate_one_block  0.03173685073852539
generate_one_block  0.03118419647216797
generate_one_block  0.03010082244873047
generate_one_block  0.03344416618347168
generate_one_block  0.03510117530822754
generate_one_block  0.030197858810424805
generate_one_block  0.03302431106567383
generate_one_block  0.03056931495666504
generate_one_block  0.03177595138549805
generate_one_block  0.03199958801269531
generate_one_block  0.03345537185668945
generate_one_block  0.030301332473754883
generate_one_block  0.0307919979095459
generate_one_block  0.033985137939453125
generate_one_block  0.03136324882507324
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.037477970123291016
gen group dst list time:  0.017451763153076172
time for parepare:  0.021984338760375977
local_output_nid generation:  0.008591651916503906
local_in_edges_tensor generation:  0.020885467529296875
mini_batch_src_global generation:  0.019988536834716797
r_  generation:  0.18942618370056152
local_output_nid generation:  0.013019084930419922
local_in_edges_tensor generation:  0.02158498764038086
mini_batch_src_global generation:  0.024315595626831055
r_  generation:  0.21119332313537598
local_output_nid generation:  0.014634370803833008
local_in_edges_tensor generation:  0.026103973388671875
mini_batch_src_global generation:  0.03417062759399414
r_  generation:  0.20688843727111816
local_output_nid generation:  0.01490640640258789
local_in_edges_tensor generation:  0.015127182006835938
mini_batch_src_global generation:  0.025658130645751953
r_  generation:  0.20525360107421875
local_output_nid generation:  0.014109134674072266
local_in_edges_tensor generation:  0.0158541202545166
mini_batch_src_global generation:  0.026647567749023438
r_  generation:  0.2144317626953125
local_output_nid generation:  0.01651453971862793
local_in_edges_tensor generation:  0.014243602752685547
mini_batch_src_global generation:  0.02737736701965332
r_  generation:  0.21493005752563477
local_output_nid generation:  0.012929439544677734
local_in_edges_tensor generation:  0.011869430541992188
mini_batch_src_global generation:  0.025136232376098633
r_  generation:  0.20417213439941406
local_output_nid generation:  0.013386726379394531
local_in_edges_tensor generation:  0.02185678482055664
mini_batch_src_global generation:  0.025870084762573242
r_  generation:  0.20952510833740234
local_output_nid generation:  0.013426065444946289
local_in_edges_tensor generation:  0.014234542846679688
mini_batch_src_global generation:  0.026261568069458008
r_  generation:  0.21154236793518066
local_output_nid generation:  0.013601541519165039
local_in_edges_tensor generation:  0.016141414642333984
mini_batch_src_global generation:  0.028059959411621094
r_  generation:  0.21515274047851562
local_output_nid generation:  0.013677597045898438
local_in_edges_tensor generation:  0.014297246932983398
mini_batch_src_global generation:  0.026897668838500977
r_  generation:  0.22520112991333008
local_output_nid generation:  0.013514995574951172
local_in_edges_tensor generation:  0.024353742599487305
mini_batch_src_global generation:  0.03195810317993164
r_  generation:  0.21137070655822754
local_output_nid generation:  0.012436389923095703
local_in_edges_tensor generation:  0.01502680778503418
mini_batch_src_global generation:  0.026332616806030273
r_  generation:  0.2108931541442871
local_output_nid generation:  0.01256561279296875
local_in_edges_tensor generation:  0.01386117935180664
mini_batch_src_global generation:  0.03530168533325195
r_  generation:  0.21445059776306152
local_output_nid generation:  0.015732526779174805
local_in_edges_tensor generation:  0.01612544059753418
mini_batch_src_global generation:  0.027277231216430664
r_  generation:  0.21254348754882812
local_output_nid generation:  0.012648820877075195
local_in_edges_tensor generation:  0.013996124267578125
mini_batch_src_global generation:  0.026685237884521484
r_  generation:  0.21225547790527344
----------------------check_connections_block total spend ----------------------------- 5.078813552856445
generate_one_block  0.28266453742980957
generate_one_block  0.27796387672424316
generate_one_block  0.28003907203674316
generate_one_block  0.2734205722808838
generate_one_block  0.27729034423828125
generate_one_block  0.28028059005737305
generate_one_block  0.29000186920166016
generate_one_block  0.278369665145874
generate_one_block  0.2776510715484619
generate_one_block  0.28302669525146484
generate_one_block  0.2813105583190918
generate_one_block  0.27796363830566406
generate_one_block  0.2773120403289795
generate_one_block  0.2861037254333496
generate_one_block  0.28566455841064453
generate_one_block  0.28130507469177246
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05536913871765137
gen group dst list time:  0.06851363182067871
time for parepare:  0.01997518539428711
local_output_nid generation:  0.02717304229736328
local_in_edges_tensor generation:  0.05985879898071289
mini_batch_src_global generation:  0.04170846939086914
r_  generation:  0.4302091598510742
local_output_nid generation:  0.031922101974487305
local_in_edges_tensor generation:  0.04784440994262695
mini_batch_src_global generation:  0.050176382064819336
r_  generation:  0.44124650955200195
local_output_nid generation:  0.03135943412780762
local_in_edges_tensor generation:  0.04362177848815918
mini_batch_src_global generation:  0.05292820930480957
r_  generation:  0.4464738368988037
local_output_nid generation:  0.03144693374633789
local_in_edges_tensor generation:  0.03213858604431152
mini_batch_src_global generation:  0.05126166343688965
r_  generation:  0.4408879280090332
local_output_nid generation:  0.031197547912597656
local_in_edges_tensor generation:  0.07670068740844727
mini_batch_src_global generation:  0.050925254821777344
r_  generation:  0.4525563716888428
local_output_nid generation:  0.03148961067199707
local_in_edges_tensor generation:  0.039782047271728516
mini_batch_src_global generation:  0.05263376235961914
r_  generation:  0.4536116123199463
local_output_nid generation:  0.031030893325805664
local_in_edges_tensor generation:  0.032038211822509766
mini_batch_src_global generation:  0.0520322322845459
r_  generation:  0.44959497451782227
local_output_nid generation:  0.034942626953125
local_in_edges_tensor generation:  0.03128623962402344
mini_batch_src_global generation:  0.05248618125915527
r_  generation:  0.44843411445617676
local_output_nid generation:  0.03159642219543457
local_in_edges_tensor generation:  0.044350624084472656
mini_batch_src_global generation:  0.05204653739929199
r_  generation:  0.45720434188842773
local_output_nid generation:  0.031205415725708008
local_in_edges_tensor generation:  0.035779476165771484
mini_batch_src_global generation:  0.05256772041320801
r_  generation:  0.4570579528808594
local_output_nid generation:  0.031343936920166016
local_in_edges_tensor generation:  0.03596234321594238
mini_batch_src_global generation:  0.0515286922454834
r_  generation:  0.45967936515808105
local_output_nid generation:  0.031586647033691406
local_in_edges_tensor generation:  0.041158199310302734
mini_batch_src_global generation:  0.05349230766296387
r_  generation:  0.4550023078918457
local_output_nid generation:  0.031529903411865234
local_in_edges_tensor generation:  0.0357818603515625
mini_batch_src_global generation:  0.051848411560058594
r_  generation:  0.4555947780609131
local_output_nid generation:  0.03133106231689453
local_in_edges_tensor generation:  0.035164594650268555
mini_batch_src_global generation:  0.05246090888977051
r_  generation:  0.45159411430358887
local_output_nid generation:  0.03157639503479004
local_in_edges_tensor generation:  0.03924679756164551
mini_batch_src_global generation:  0.05150270462036133
r_  generation:  0.45995616912841797
local_output_nid generation:  0.03145456314086914
local_in_edges_tensor generation:  0.03626823425292969
mini_batch_src_global generation:  0.053334712982177734
r_  generation:  0.4667482376098633
----------------------check_connections_block total spend ----------------------------- 10.797222375869751
generate_one_block  0.6057648658752441
generate_one_block  0.5980913639068604
generate_one_block  0.5908749103546143
generate_one_block  0.5891971588134766
generate_one_block  0.5976278781890869
generate_one_block  0.595679521560669
generate_one_block  0.5816037654876709
generate_one_block  0.5923361778259277
generate_one_block  0.6349341869354248
generate_one_block  0.6100006103515625
generate_one_block  0.5884034633636475
generate_one_block  0.5955471992492676
generate_one_block  0.5916612148284912
generate_one_block  0.5807144641876221
generate_one_block  0.604546070098877
generate_one_block  0.6042628288269043
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 0.13350296020507812  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

connection checking time:  15.876035928726196
block generation total time  14.051613569259644
average batch blocks generation time:  0.8782258480787277
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 0.11143922805786133  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 20.922245025634766  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 0.11083793640136719  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 21.151537895202637  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 0.11163139343261719  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 21.308470249176025  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 0.11081552505493164  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 20.92601776123047  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 0.11157894134521484  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 21.187766075134277  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 0.1111903190612793  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 21.30662202835083  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 0.11117172241210938  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 20.46822166442871  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 0.1109304428100586  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 20.977925777435303  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 0.11156082153320312  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 21.104512214660645  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 0.11109638214111328  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 21.368267059326172  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 0.11166000366210938  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 21.34770631790161  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 0.11107587814331055  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 21.161762237548828  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 0.11154365539550781  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 21.082786560058594  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 0.11090993881225586  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 21.135759353637695  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 0.11162757873535156  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 21.23344326019287  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 0.11117410659790039  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 21.18948268890381  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03411288559436798 |0.013613283634185791 |0.3039761185646057 |9.676814079284668e-05 |0.5640943050384521 |0.006446123123168945 |
----------------------------------------------------------pseudo_mini_loss sum 3.8703787326812744
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5091458
Number of first layer input nodes during this epoch:  2471086
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 0.13487815856933594  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02362847328186035
random selection method range initialization spend 0.006465435028076172
time for parepare:  0.020512819290161133
local_output_nid generation:  0.0025641918182373047
local_in_edges_tensor generation:  0.009781837463378906
mini_batch_src_global generation:  0.0037250518798828125
r_  generation:  0.02017807960510254
local_output_nid generation:  0.004453420639038086
local_in_edges_tensor generation:  0.002559185028076172
mini_batch_src_global generation:  0.0028259754180908203
r_  generation:  0.018134355545043945
local_output_nid generation:  0.004240751266479492
local_in_edges_tensor generation:  0.00209808349609375
mini_batch_src_global generation:  0.0013275146484375
r_  generation:  0.01828932762145996
local_output_nid generation:  0.0043528079986572266
local_in_edges_tensor generation:  0.001931905746459961
mini_batch_src_global generation:  0.0013949871063232422
r_  generation:  0.017902135848999023
local_output_nid generation:  0.004313945770263672
local_in_edges_tensor generation:  0.002425670623779297
mini_batch_src_global generation:  0.0015604496002197266
r_  generation:  0.01872086524963379
local_output_nid generation:  0.004204273223876953
local_in_edges_tensor generation:  0.0018813610076904297
mini_batch_src_global generation:  0.0014576911926269531
r_  generation:  0.01805400848388672
local_output_nid generation:  0.0042994022369384766
local_in_edges_tensor generation:  0.0025627613067626953
mini_batch_src_global generation:  0.0015687942504882812
r_  generation:  0.01913595199584961
local_output_nid generation:  0.004308462142944336
local_in_edges_tensor generation:  0.0020728111267089844
mini_batch_src_global generation:  0.001459360122680664
r_  generation:  0.01937127113342285
local_output_nid generation:  0.004313468933105469
local_in_edges_tensor generation:  0.002204418182373047
mini_batch_src_global generation:  0.0016319751739501953
r_  generation:  0.019794702529907227
local_output_nid generation:  0.004232168197631836
local_in_edges_tensor generation:  0.0019583702087402344
mini_batch_src_global generation:  0.0015413761138916016
r_  generation:  0.019413232803344727
local_output_nid generation:  0.004458189010620117
local_in_edges_tensor generation:  0.001997709274291992
mini_batch_src_global generation:  0.0016286373138427734
r_  generation:  0.019916534423828125
local_output_nid generation:  0.004415035247802734
local_in_edges_tensor generation:  0.0020782947540283203
mini_batch_src_global generation:  0.0015332698822021484
r_  generation:  0.01909637451171875
local_output_nid generation:  0.004384756088256836
local_in_edges_tensor generation:  0.0019910335540771484
mini_batch_src_global generation:  0.0015773773193359375
r_  generation:  0.01919841766357422
local_output_nid generation:  0.004210233688354492
local_in_edges_tensor generation:  0.002324342727661133
mini_batch_src_global generation:  0.001634836196899414
r_  generation:  0.019484519958496094
local_output_nid generation:  0.004418373107910156
local_in_edges_tensor generation:  0.0019571781158447266
mini_batch_src_global generation:  0.0016865730285644531
r_  generation:  0.019370317459106445
local_output_nid generation:  0.004363298416137695
local_in_edges_tensor generation:  0.001974821090698242
mini_batch_src_global generation:  0.001585245132446289
r_  generation:  0.019409656524658203
----------------------check_connections_block total spend ----------------------------- 0.5578203201293945
generate_one_block  0.039049625396728516
generate_one_block  0.0310060977935791
generate_one_block  0.03151965141296387
generate_one_block  0.03139662742614746
generate_one_block  0.03174018859863281
generate_one_block  0.03544425964355469
generate_one_block  0.03369283676147461
generate_one_block  0.03169584274291992
generate_one_block  0.032727718353271484
generate_one_block  0.03231668472290039
generate_one_block  0.0325319766998291
generate_one_block  0.03157186508178711
generate_one_block  0.031384944915771484
generate_one_block  0.03376889228820801
generate_one_block  0.03243565559387207
generate_one_block  0.033035993576049805
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.09581565856933594
gen group dst list time:  0.019802093505859375
time for parepare:  0.02286815643310547
local_output_nid generation:  0.012167930603027344
local_in_edges_tensor generation:  0.04038238525390625
mini_batch_src_global generation:  0.024187088012695312
r_  generation:  0.19855070114135742
local_output_nid generation:  0.01596689224243164
local_in_edges_tensor generation:  0.024035215377807617
mini_batch_src_global generation:  0.041065216064453125
r_  generation:  0.2111952304840088
local_output_nid generation:  0.018305540084838867
local_in_edges_tensor generation:  0.01802372932434082
mini_batch_src_global generation:  0.026157140731811523
r_  generation:  0.21982645988464355
local_output_nid generation:  0.01624011993408203
local_in_edges_tensor generation:  0.015533447265625
mini_batch_src_global generation:  0.026940345764160156
r_  generation:  0.23459577560424805
local_output_nid generation:  0.01731085777282715
local_in_edges_tensor generation:  0.01383519172668457
mini_batch_src_global generation:  0.03194880485534668
r_  generation:  0.23575973510742188
local_output_nid generation:  0.016611099243164062
local_in_edges_tensor generation:  0.014953136444091797
mini_batch_src_global generation:  0.0315859317779541
r_  generation:  0.2221386432647705
local_output_nid generation:  0.019095897674560547
local_in_edges_tensor generation:  0.018704652786254883
mini_batch_src_global generation:  0.03116893768310547
r_  generation:  0.2504003047943115
local_output_nid generation:  0.018888473510742188
local_in_edges_tensor generation:  0.01824951171875
mini_batch_src_global generation:  0.03183937072753906
r_  generation:  0.2279503345489502
local_output_nid generation:  0.01721811294555664
local_in_edges_tensor generation:  0.012903928756713867
mini_batch_src_global generation:  0.03159356117248535
r_  generation:  0.23028349876403809
local_output_nid generation:  0.016521453857421875
local_in_edges_tensor generation:  0.013345479965209961
mini_batch_src_global generation:  0.02986931800842285
r_  generation:  0.2236192226409912
local_output_nid generation:  0.016125202178955078
local_in_edges_tensor generation:  0.013230562210083008
mini_batch_src_global generation:  0.030628681182861328
r_  generation:  0.2285768985748291
local_output_nid generation:  0.015733003616333008
local_in_edges_tensor generation:  0.013571023941040039
mini_batch_src_global generation:  0.029889345169067383
r_  generation:  0.2614424228668213
local_output_nid generation:  0.01565694808959961
local_in_edges_tensor generation:  0.013226985931396484
mini_batch_src_global generation:  0.030623912811279297
r_  generation:  0.22950458526611328
local_output_nid generation:  0.015935897827148438
local_in_edges_tensor generation:  0.013755321502685547
mini_batch_src_global generation:  0.029384851455688477
r_  generation:  0.22623753547668457
local_output_nid generation:  0.01595926284790039
local_in_edges_tensor generation:  0.015447616577148438
mini_batch_src_global generation:  0.035871028900146484
r_  generation:  0.23473405838012695
local_output_nid generation:  0.01593804359436035
local_in_edges_tensor generation:  0.013239622116088867
mini_batch_src_global generation:  0.029769182205200195
r_  generation:  0.2563023567199707
----------------------check_connections_block total spend ----------------------------- 5.571791410446167
generate_one_block  0.29488205909729004
generate_one_block  0.27314329147338867
generate_one_block  0.28702282905578613
generate_one_block  0.283794641494751
generate_one_block  0.29348182678222656
generate_one_block  0.276796817779541
generate_one_block  0.3148322105407715
generate_one_block  0.290111780166626
generate_one_block  0.3018982410430908
generate_one_block  0.29068946838378906
generate_one_block  0.2990703582763672
generate_one_block  0.2802846431732178
generate_one_block  0.275604248046875
generate_one_block  0.2890756130218506
generate_one_block  0.28411364555358887
generate_one_block  0.280087947845459
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04214763641357422
gen group dst list time:  0.07305431365966797
time for parepare:  0.019702911376953125
local_output_nid generation:  0.028122663497924805
local_in_edges_tensor generation:  0.06371331214904785
mini_batch_src_global generation:  0.043480634689331055
r_  generation:  0.4431416988372803
local_output_nid generation:  0.03231382369995117
local_in_edges_tensor generation:  0.04076790809631348
mini_batch_src_global generation:  0.05184674263000488
r_  generation:  0.44530534744262695
local_output_nid generation:  0.032218217849731445
local_in_edges_tensor generation:  0.03408074378967285
mini_batch_src_global generation:  0.05114173889160156
r_  generation:  0.455491304397583
local_output_nid generation:  0.032129764556884766
local_in_edges_tensor generation:  0.035134077072143555
mini_batch_src_global generation:  0.0523223876953125
r_  generation:  0.4495863914489746
local_output_nid generation:  0.03430962562561035
local_in_edges_tensor generation:  0.07084393501281738
mini_batch_src_global generation:  0.05322408676147461
r_  generation:  0.46315717697143555
local_output_nid generation:  0.0320589542388916
local_in_edges_tensor generation:  0.029414653778076172
mini_batch_src_global generation:  0.052823781967163086
r_  generation:  0.45584940910339355
local_output_nid generation:  0.032117605209350586
local_in_edges_tensor generation:  0.0402069091796875
mini_batch_src_global generation:  0.0586390495300293
r_  generation:  0.4641227722167969
local_output_nid generation:  0.034949302673339844
local_in_edges_tensor generation:  0.036502838134765625
mini_batch_src_global generation:  0.05569267272949219
r_  generation:  0.47145795822143555
local_output_nid generation:  0.034979820251464844
local_in_edges_tensor generation:  0.0317838191986084
mini_batch_src_global generation:  0.0536043643951416
r_  generation:  0.46824193000793457
local_output_nid generation:  0.03345894813537598
local_in_edges_tensor generation:  0.029529333114624023
mini_batch_src_global generation:  0.05386710166931152
r_  generation:  0.4533660411834717
local_output_nid generation:  0.03315019607543945
local_in_edges_tensor generation:  0.0298464298248291
mini_batch_src_global generation:  0.057486772537231445
r_  generation:  0.45835280418395996
local_output_nid generation:  0.03312206268310547
local_in_edges_tensor generation:  0.040117740631103516
mini_batch_src_global generation:  0.05334734916687012
r_  generation:  0.45545506477355957
local_output_nid generation:  0.03291010856628418
local_in_edges_tensor generation:  0.03552579879760742
mini_batch_src_global generation:  0.05217576026916504
r_  generation:  0.45765113830566406
local_output_nid generation:  0.03317427635192871
local_in_edges_tensor generation:  0.0300595760345459
mini_batch_src_global generation:  0.05320382118225098
r_  generation:  0.4610269069671631
local_output_nid generation:  0.03337407112121582
local_in_edges_tensor generation:  0.029697656631469727
mini_batch_src_global generation:  0.05180239677429199
r_  generation:  0.46309947967529297
local_output_nid generation:  0.03315925598144531
local_in_edges_tensor generation:  0.035939931869506836
mini_batch_src_global generation:  0.05332064628601074
r_  generation:  0.45769476890563965
----------------------check_connections_block total spend ----------------------------- 10.929404258728027
generate_one_block  0.607511043548584
generate_one_block  0.6042094230651855
generate_one_block  0.6112401485443115
generate_one_block  0.5886585712432861
generate_one_block  0.5994246006011963
generate_one_block  0.5968339443206787
generate_one_block  0.5968410968780518
generate_one_block  0.5907914638519287
generate_one_block  0.6642131805419922
generate_one_block  0.5870440006256104
generate_one_block  0.6053447723388672
generate_one_block  0.5963478088378906
generate_one_block  0.592705249786377
generate_one_block  0.6010780334472656
generate_one_block  0.6234869956970215
generate_one_block  0.5920491218566895
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 0.13487815856933594  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

connection checking time:  16.501195669174194
block generation total time  14.272669076919556
average batch blocks generation time:  0.8920418173074722
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 0.11154508590698242  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 21.11352300643921  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 0.1107931137084961  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 20.877988815307617  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 0.11165428161621094  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 21.295424938201904  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 0.11082315444946289  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 20.91737461090088  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5955810546875 GB
    Memory Allocated: 0.11164283752441406  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5994873046875 GB
    Memory Allocated: 21.264307498931885  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6014404296875 GB
    Memory Allocated: 0.1107182502746582  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6014404296875 GB
    Memory Allocated: 20.820995330810547  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6014404296875 GB
    Memory Allocated: 0.11171817779541016  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6014404296875 GB
    Memory Allocated: 21.41953468322754  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6014404296875 GB
    Memory Allocated: 0.11101388931274414  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6014404296875 GB
    Memory Allocated: 21.200828075408936  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6014404296875 GB
    Memory Allocated: 0.11158180236816406  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6014404296875 GB
    Memory Allocated: 21.20817995071411  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6014404296875 GB
    Memory Allocated: 0.11093854904174805  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6014404296875 GB
    Memory Allocated: 20.98097848892212  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6014404296875 GB
    Memory Allocated: 0.11166667938232422  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6014404296875 GB
    Memory Allocated: 21.351543426513672  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6014404296875 GB
    Memory Allocated: 0.1110992431640625  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6014404296875 GB
    Memory Allocated: 21.047460079193115  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6014404296875 GB
    Memory Allocated: 0.11142921447753906  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6014404296875 GB
    Memory Allocated: 20.908053398132324  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6014404296875 GB
    Memory Allocated: 0.11098241806030273  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6014404296875 GB
    Memory Allocated: 21.010605335235596  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6014404296875 GB
    Memory Allocated: 0.1116323471069336  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6014404296875 GB
    Memory Allocated: 21.257502555847168  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6014404296875 GB
    Memory Allocated: 0.11092805862426758  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6014404296875 GB
    Memory Allocated: 21.02516746520996  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.032917797565460205 |0.01382187008857727 |0.3027016222476959 |9.705126285552979e-05 |0.5467067211866379 |0.0025162696838378906 |
----------------------------------------------------------pseudo_mini_loss sum 3.3605198860168457
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  5091067
Number of first layer input nodes during this epoch:  2471783
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.6014404296875 GB
    Memory Allocated: 0.13447904586791992  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021706104278564453
random selection method range initialization spend 0.006490468978881836
time for parepare:  0.02131056785583496
local_output_nid generation:  0.002687692642211914
local_in_edges_tensor generation:  0.006579160690307617
mini_batch_src_global generation:  0.0023136138916015625
r_  generation:  0.02080559730529785
local_output_nid generation:  0.0032863616943359375
local_in_edges_tensor generation:  0.0018970966339111328
mini_batch_src_global generation:  0.0024673938751220703
r_  generation:  0.022629976272583008
local_output_nid generation:  0.003235340118408203
local_in_edges_tensor generation:  0.0015516281127929688
mini_batch_src_global generation:  0.001827239990234375
r_  generation:  0.021376371383666992
local_output_nid generation:  0.003200054168701172
local_in_edges_tensor generation:  0.0015909671783447266
mini_batch_src_global generation:  0.0017809867858886719
r_  generation:  0.021375179290771484
local_output_nid generation:  0.0031349658966064453
local_in_edges_tensor generation:  0.0018324851989746094
mini_batch_src_global generation:  0.00516510009765625
r_  generation:  0.02195143699645996
local_output_nid generation:  0.003266572952270508
local_in_edges_tensor generation:  0.0017778873443603516
mini_batch_src_global generation:  0.0018010139465332031
r_  generation:  0.021742582321166992
local_output_nid generation:  0.003149747848510742
local_in_edges_tensor generation:  0.0017774105072021484
mini_batch_src_global generation:  0.0018758773803710938
r_  generation:  0.03403449058532715
local_output_nid generation:  0.005266427993774414
local_in_edges_tensor generation:  0.0024137496948242188
mini_batch_src_global generation:  0.0017209053039550781
r_  generation:  0.019669771194458008
local_output_nid generation:  0.0046422481536865234
local_in_edges_tensor generation:  0.002023458480834961
mini_batch_src_global generation:  0.0015747547149658203
r_  generation:  0.01872992515563965
local_output_nid generation:  0.004651546478271484
local_in_edges_tensor generation:  0.0019409656524658203
mini_batch_src_global generation:  0.001554727554321289
r_  generation:  0.018813610076904297
local_output_nid generation:  0.004334926605224609
local_in_edges_tensor generation:  0.0019037723541259766
mini_batch_src_global generation:  0.0015881061553955078
r_  generation:  0.019321918487548828
local_output_nid generation:  0.004547119140625
local_in_edges_tensor generation:  0.0019898414611816406
mini_batch_src_global generation:  0.0016636848449707031
r_  generation:  0.0192720890045166
local_output_nid generation:  0.00434422492980957
local_in_edges_tensor generation:  0.0018954277038574219
mini_batch_src_global generation:  0.001561880111694336
r_  generation:  0.018652677536010742
local_output_nid generation:  0.004254817962646484
local_in_edges_tensor generation:  0.001954793930053711
mini_batch_src_global generation:  0.0016169548034667969
r_  generation:  0.018757104873657227
local_output_nid generation:  0.004183053970336914
local_in_edges_tensor generation:  0.0019414424896240234
mini_batch_src_global generation:  0.0016362667083740234
r_  generation:  0.01900768280029297
local_output_nid generation:  0.0044476985931396484
local_in_edges_tensor generation:  0.0018775463104248047
mini_batch_src_global generation:  0.001617431640625
r_  generation:  0.019405603408813477
----------------------check_connections_block total spend ----------------------------- 0.5787136554718018
generate_one_block  0.0385286808013916
generate_one_block  0.0343480110168457
generate_one_block  0.03644919395446777
generate_one_block  0.04644966125488281
generate_one_block  0.03184843063354492
generate_one_block  0.036605119705200195
generate_one_block  0.03567981719970703
generate_one_block  0.04816555976867676
generate_one_block  0.0368046760559082
generate_one_block  0.04824519157409668
generate_one_block  0.039229393005371094
generate_one_block  0.049936771392822266
generate_one_block  0.037958383560180664
generate_one_block  0.05139803886413574
generate_one_block  0.03892207145690918
generate_one_block  0.0518343448638916
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04760456085205078
gen group dst list time:  0.01907205581665039
time for parepare:  0.019284486770629883
local_output_nid generation:  0.010304689407348633
local_in_edges_tensor generation:  0.02198004722595215
mini_batch_src_global generation:  0.023246049880981445
r_  generation:  0.19574642181396484
local_output_nid generation:  0.012586832046508789
local_in_edges_tensor generation:  0.014704227447509766
mini_batch_src_global generation:  0.02563762664794922
r_  generation:  0.20920085906982422
local_output_nid generation:  0.012289285659790039
local_in_edges_tensor generation:  0.01314401626586914
mini_batch_src_global generation:  0.023390769958496094
r_  generation:  0.2107686996459961
local_output_nid generation:  0.013001680374145508
local_in_edges_tensor generation:  0.012651681900024414
mini_batch_src_global generation:  0.025221824645996094
r_  generation:  0.21416640281677246
local_output_nid generation:  0.013291120529174805
local_in_edges_tensor generation:  0.017853975296020508
mini_batch_src_global generation:  0.028210163116455078
r_  generation:  0.22617149353027344
local_output_nid generation:  0.013927459716796875
local_in_edges_tensor generation:  0.018267154693603516
mini_batch_src_global generation:  0.026894330978393555
r_  generation:  0.2113814353942871
local_output_nid generation:  0.013011455535888672
local_in_edges_tensor generation:  0.011970281600952148
mini_batch_src_global generation:  0.027139663696289062
r_  generation:  0.24930953979492188
local_output_nid generation:  0.013247013092041016
local_in_edges_tensor generation:  0.012956380844116211
mini_batch_src_global generation:  0.02628612518310547
r_  generation:  0.24347567558288574
local_output_nid generation:  0.013210535049438477
local_in_edges_tensor generation:  0.012752056121826172
mini_batch_src_global generation:  0.026447296142578125
r_  generation:  0.2820582389831543
local_output_nid generation:  0.015896320343017578
local_in_edges_tensor generation:  0.011947154998779297
mini_batch_src_global generation:  0.02658700942993164
r_  generation:  0.21232080459594727
local_output_nid generation:  0.013697385787963867
local_in_edges_tensor generation:  0.012194156646728516
mini_batch_src_global generation:  0.02791881561279297
r_  generation:  0.2185657024383545
local_output_nid generation:  0.012827634811401367
local_in_edges_tensor generation:  0.012695550918579102
mini_batch_src_global generation:  0.026331424713134766
r_  generation:  0.21345758438110352
local_output_nid generation:  0.012841463088989258
local_in_edges_tensor generation:  0.01277017593383789
mini_batch_src_global generation:  0.02654433250427246
r_  generation:  0.21493864059448242
local_output_nid generation:  0.012743234634399414
local_in_edges_tensor generation:  0.013464689254760742
mini_batch_src_global generation:  0.0262911319732666
r_  generation:  0.21570301055908203
local_output_nid generation:  0.012696981430053711
local_in_edges_tensor generation:  0.011869430541992188
mini_batch_src_global generation:  0.026067495346069336
r_  generation:  0.21497464179992676
local_output_nid generation:  0.012723684310913086
local_in_edges_tensor generation:  0.012406110763549805
mini_batch_src_global generation:  0.026617050170898438
r_  generation:  0.21421432495117188
----------------------check_connections_block total spend ----------------------------- 5.184529066085815
generate_one_block  0.2802746295928955
generate_one_block  0.2832493782043457
generate_one_block  0.29767656326293945
generate_one_block  0.2812795639038086
generate_one_block  0.2855536937713623
generate_one_block  0.27753233909606934
generate_one_block  0.3023190498352051
generate_one_block  0.2887904644012451
generate_one_block  0.2849464416503906
generate_one_block  0.2790834903717041
generate_one_block  0.2889077663421631
generate_one_block  0.27844977378845215
generate_one_block  0.2750372886657715
generate_one_block  0.2769930362701416
generate_one_block  0.2765040397644043
generate_one_block  0.27983617782592773
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03635811805725098
gen group dst list time:  0.06674742698669434
time for parepare:  0.019120454788208008
local_output_nid generation:  0.028090238571166992
local_in_edges_tensor generation:  0.04976487159729004
mini_batch_src_global generation:  0.04075050354003906
r_  generation:  0.4379546642303467
local_output_nid generation:  0.03197431564331055
local_in_edges_tensor generation:  0.03476095199584961
mini_batch_src_global generation:  0.05196857452392578
r_  generation:  0.4457542896270752
local_output_nid generation:  0.03194713592529297
local_in_edges_tensor generation:  0.03789639472961426
mini_batch_src_global generation:  0.051203012466430664
r_  generation:  0.4524555206298828
local_output_nid generation:  0.031642913818359375
local_in_edges_tensor generation:  0.029797077178955078
mini_batch_src_global generation:  0.05291867256164551
r_  generation:  0.45230770111083984
local_output_nid generation:  0.03181719779968262
local_in_edges_tensor generation:  0.07108688354492188
mini_batch_src_global generation:  0.051586151123046875
r_  generation:  0.46039915084838867
local_output_nid generation:  0.0316164493560791
local_in_edges_tensor generation:  0.030743837356567383
mini_batch_src_global generation:  0.06754660606384277
r_  generation:  0.46405935287475586
local_output_nid generation:  0.03178238868713379
local_in_edges_tensor generation:  0.03358626365661621
mini_batch_src_global generation:  0.054569244384765625
r_  generation:  0.46053004264831543
local_output_nid generation:  0.03210949897766113
local_in_edges_tensor generation:  0.029961824417114258
mini_batch_src_global generation:  0.05354952812194824
r_  generation:  0.45909690856933594
local_output_nid generation:  0.03170061111450195
local_in_edges_tensor generation:  0.029217004776000977
mini_batch_src_global generation:  0.05414843559265137
r_  generation:  0.4642298221588135
local_output_nid generation:  0.031770944595336914
local_in_edges_tensor generation:  0.03132748603820801
mini_batch_src_global generation:  0.05282282829284668
r_  generation:  0.45776987075805664
local_output_nid generation:  0.03184771537780762
local_in_edges_tensor generation:  0.03304696083068848
mini_batch_src_global generation:  0.05370211601257324
r_  generation:  0.46381044387817383
local_output_nid generation:  0.03461027145385742
local_in_edges_tensor generation:  0.0374147891998291
mini_batch_src_global generation:  0.053166866302490234
r_  generation:  0.46117424964904785
local_output_nid generation:  0.032126665115356445
local_in_edges_tensor generation:  0.03599810600280762
mini_batch_src_global generation:  0.05278348922729492
r_  generation:  0.4644646644592285
local_output_nid generation:  0.03198838233947754
local_in_edges_tensor generation:  0.0356297492980957
mini_batch_src_global generation:  0.05345892906188965
r_  generation:  0.4741785526275635
local_output_nid generation:  0.035140275955200195
local_in_edges_tensor generation:  0.03324127197265625
mini_batch_src_global generation:  0.0591433048248291
r_  generation:  0.46442389488220215
local_output_nid generation:  0.032887935638427734
local_in_edges_tensor generation:  0.029944181442260742
mini_batch_src_global generation:  0.05316472053527832
r_  generation:  0.4587533473968506
----------------------check_connections_block total spend ----------------------------- 10.893548250198364
generate_one_block  0.6025876998901367
generate_one_block  0.5892338752746582
generate_one_block  0.595038890838623
generate_one_block  0.5923445224761963
generate_one_block  0.589632511138916
generate_one_block  0.5983607769012451
generate_one_block  0.592829704284668
generate_one_block  0.5978538990020752
generate_one_block  0.6227843761444092
generate_one_block  0.5874862670898438
generate_one_block  0.6002364158630371
generate_one_block  0.585590124130249
generate_one_block  0.5818204879760742
generate_one_block  0.5887312889099121
generate_one_block  0.5963490009307861
generate_one_block  0.5936448574066162
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.6014404296875 GB
    Memory Allocated: 0.13447904586791992  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

connection checking time:  16.07807731628418
block generation total time  14.050958395004272
average batch blocks generation time:  0.878184899687767
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6014404296875 GB
    Memory Allocated: 0.11149168014526367  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6014404296875 GB
    Memory Allocated: 21.040146350860596  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6014404296875 GB
    Memory Allocated: 0.11101818084716797  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6014404296875 GB
    Memory Allocated: 21.217041969299316  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6033935546875 GB
    Memory Allocated: 0.1116018295288086  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6033935546875 GB
    Memory Allocated: 21.190321445465088  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6033935546875 GB
    Memory Allocated: 0.11101484298706055  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6033935546875 GB
    Memory Allocated: 21.19242000579834  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6033935546875 GB
    Memory Allocated: 0.11160659790039062  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6033935546875 GB
    Memory Allocated: 21.23943567276001  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6033935546875 GB
    Memory Allocated: 0.11088800430297852  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6033935546875 GB
    Memory Allocated: 21.02815341949463  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6033935546875 GB
    Memory Allocated: 0.11154842376708984  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6033935546875 GB
    Memory Allocated: 21.124938011169434  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6033935546875 GB
    Memory Allocated: 0.11099767684936523  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6033935546875 GB
    Memory Allocated: 21.146687030792236  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6033935546875 GB
    Memory Allocated: 0.11155509948730469  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6033935546875 GB
    Memory Allocated: 21.082367420196533  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6033935546875 GB
    Memory Allocated: 0.1109781265258789  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6033935546875 GB
    Memory Allocated: 21.022457122802734  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6033935546875 GB
    Memory Allocated: 0.1116628646850586  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6033935546875 GB
    Memory Allocated: 21.293286323547363  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6033935546875 GB
    Memory Allocated: 0.11092996597290039  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6033935546875 GB
    Memory Allocated: 21.054211139678955  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6033935546875 GB
    Memory Allocated: 0.11149978637695312  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6033935546875 GB
    Memory Allocated: 21.03893232345581  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6033935546875 GB
    Memory Allocated: 0.1109309196472168  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6033935546875 GB
    Memory Allocated: 21.086277961730957  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6033935546875 GB
    Memory Allocated: 0.11151981353759766  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6033935546875 GB
    Memory Allocated: 21.04617691040039  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6033935546875 GB
    Memory Allocated: 0.11096429824829102  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6033935546875 GB
    Memory Allocated: 21.041738510131836  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.035543933510780334 |0.01327165961265564 |0.3023505061864853 |9.337067604064941e-05 |0.5551990270614624 |0.005532979965209961 |
----------------------------------------------------------pseudo_mini_loss sum 2.6956260204315186
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  5091634
Number of first layer input nodes during this epoch:  2471004
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.6033935546875 GB
    Memory Allocated: 0.133575439453125  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02131938934326172
random selection method range initialization spend 0.0061686038970947266
time for parepare:  0.021996736526489258
local_output_nid generation:  0.002781391143798828
local_in_edges_tensor generation:  0.004868268966674805
mini_batch_src_global generation:  0.003733396530151367
r_  generation:  0.02463221549987793
local_output_nid generation:  0.0046122074127197266
local_in_edges_tensor generation:  0.0024666786193847656
mini_batch_src_global generation:  0.0024847984313964844
r_  generation:  0.019900083541870117
local_output_nid generation:  0.004461526870727539
local_in_edges_tensor generation:  0.002267599105834961
mini_batch_src_global generation:  0.0015769004821777344
r_  generation:  0.01830434799194336
local_output_nid generation:  0.004245281219482422
local_in_edges_tensor generation:  0.0019350051879882812
mini_batch_src_global generation:  0.0015747547149658203
r_  generation:  0.0186312198638916
local_output_nid generation:  0.004355430603027344
local_in_edges_tensor generation:  0.0020499229431152344
mini_batch_src_global generation:  0.0016033649444580078
r_  generation:  0.018381834030151367
local_output_nid generation:  0.0042705535888671875
local_in_edges_tensor generation:  0.0019390583038330078
mini_batch_src_global generation:  0.0016825199127197266
r_  generation:  0.01913738250732422
local_output_nid generation:  0.004198789596557617
local_in_edges_tensor generation:  0.002034902572631836
mini_batch_src_global generation:  0.0015537738800048828
r_  generation:  0.01876091957092285
local_output_nid generation:  0.004209756851196289
local_in_edges_tensor generation:  0.001878976821899414
mini_batch_src_global generation:  0.0015711784362792969
r_  generation:  0.018747568130493164
local_output_nid generation:  0.004132747650146484
local_in_edges_tensor generation:  0.002955198287963867
mini_batch_src_global generation:  0.010240554809570312
r_  generation:  0.02476358413696289
local_output_nid generation:  0.004994869232177734
local_in_edges_tensor generation:  0.001962423324584961
mini_batch_src_global generation:  0.0018913745880126953
r_  generation:  0.028196334838867188
local_output_nid generation:  0.004325151443481445
local_in_edges_tensor generation:  0.0021986961364746094
mini_batch_src_global generation:  0.0015380382537841797
r_  generation:  0.018630504608154297
local_output_nid generation:  0.004183769226074219
local_in_edges_tensor generation:  0.0018303394317626953
mini_batch_src_global generation:  0.0015339851379394531
r_  generation:  0.018202781677246094
local_output_nid generation:  0.00416874885559082
local_in_edges_tensor generation:  0.0018041133880615234
mini_batch_src_global generation:  0.001554727554321289
r_  generation:  0.018266916275024414
local_output_nid generation:  0.004146099090576172
local_in_edges_tensor generation:  0.001827239990234375
mini_batch_src_global generation:  0.0016326904296875
r_  generation:  0.01908397674560547
local_output_nid generation:  0.004233598709106445
local_in_edges_tensor generation:  0.0019125938415527344
mini_batch_src_global generation:  0.0016515254974365234
r_  generation:  0.018698692321777344
local_output_nid generation:  0.004140138626098633
local_in_edges_tensor generation:  0.0023088455200195312
mini_batch_src_global generation:  0.011305093765258789
r_  generation:  0.022637128829956055
----------------------check_connections_block total spend ----------------------------- 0.6014184951782227
generate_one_block  0.03582501411437988
generate_one_block  0.03162407875061035
generate_one_block  0.030637025833129883
generate_one_block  0.030736684799194336
generate_one_block  0.03065323829650879
generate_one_block  0.051154136657714844
generate_one_block  0.03753161430358887
generate_one_block  0.03143048286437988
generate_one_block  0.03270220756530762
generate_one_block  0.03239035606384277
generate_one_block  0.030808448791503906
generate_one_block  0.029715538024902344
generate_one_block  0.03038311004638672
generate_one_block  0.03032517433166504
generate_one_block  0.02981853485107422
generate_one_block  0.030823707580566406
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03300213813781738
gen group dst list time:  0.016939640045166016
time for parepare:  0.02017045021057129
local_output_nid generation:  0.009269952774047852
local_in_edges_tensor generation:  0.0201871395111084
mini_batch_src_global generation:  0.022083759307861328
r_  generation:  0.20397353172302246
local_output_nid generation:  0.012668132781982422
local_in_edges_tensor generation:  0.018397092819213867
mini_batch_src_global generation:  0.024783611297607422
r_  generation:  0.21004509925842285
local_output_nid generation:  0.012750625610351562
local_in_edges_tensor generation:  0.017624855041503906
mini_batch_src_global generation:  0.023807525634765625
r_  generation:  0.21166276931762695
local_output_nid generation:  0.013906717300415039
local_in_edges_tensor generation:  0.015017509460449219
mini_batch_src_global generation:  0.025728225708007812
r_  generation:  0.2160325050354004
local_output_nid generation:  0.014601469039916992
local_in_edges_tensor generation:  0.012108325958251953
mini_batch_src_global generation:  0.025557994842529297
r_  generation:  0.21094918251037598
local_output_nid generation:  0.013953924179077148
local_in_edges_tensor generation:  0.014148235321044922
mini_batch_src_global generation:  0.027205944061279297
r_  generation:  0.21404695510864258
local_output_nid generation:  0.013546943664550781
local_in_edges_tensor generation:  0.017788410186767578
mini_batch_src_global generation:  0.026096105575561523
r_  generation:  0.210221529006958
local_output_nid generation:  0.014385461807250977
local_in_edges_tensor generation:  0.011639595031738281
mini_batch_src_global generation:  0.026368141174316406
r_  generation:  0.21387386322021484
local_output_nid generation:  0.013749122619628906
local_in_edges_tensor generation:  0.011802911758422852
mini_batch_src_global generation:  0.03917717933654785
r_  generation:  0.21571636199951172
local_output_nid generation:  0.013657093048095703
local_in_edges_tensor generation:  0.011674165725708008
mini_batch_src_global generation:  0.026370525360107422
r_  generation:  0.2521181106567383
local_output_nid generation:  0.02333521842956543
local_in_edges_tensor generation:  0.017337322235107422
mini_batch_src_global generation:  0.030658483505249023
r_  generation:  0.21424508094787598
local_output_nid generation:  0.013985633850097656
local_in_edges_tensor generation:  0.014977216720581055
mini_batch_src_global generation:  0.02651524543762207
r_  generation:  0.20690703392028809
local_output_nid generation:  0.01367950439453125
local_in_edges_tensor generation:  0.022944211959838867
mini_batch_src_global generation:  0.02615046501159668
r_  generation:  0.21569108963012695
local_output_nid generation:  0.012969970703125
local_in_edges_tensor generation:  0.013670206069946289
mini_batch_src_global generation:  0.026505231857299805
r_  generation:  0.21179938316345215
local_output_nid generation:  0.012678861618041992
local_in_edges_tensor generation:  0.011468887329101562
mini_batch_src_global generation:  0.025936603546142578
r_  generation:  0.254284143447876
local_output_nid generation:  0.012703657150268555
local_in_edges_tensor generation:  0.011924266815185547
mini_batch_src_global generation:  0.02786707878112793
r_  generation:  0.21620821952819824
----------------------check_connections_block total spend ----------------------------- 5.149625062942505
generate_one_block  0.29787731170654297
generate_one_block  0.2849409580230713
generate_one_block  0.27790284156799316
generate_one_block  0.27830052375793457
generate_one_block  0.27513742446899414
generate_one_block  0.28131771087646484
generate_one_block  0.29586029052734375
generate_one_block  0.2782731056213379
generate_one_block  0.2797234058380127
generate_one_block  0.27666616439819336
generate_one_block  0.27480459213256836
generate_one_block  0.27036023139953613
generate_one_block  0.2817811965942383
generate_one_block  0.2821495532989502
generate_one_block  0.2803804874420166
generate_one_block  0.2806580066680908
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03660011291503906
gen group dst list time:  0.06582236289978027
time for parepare:  0.02001667022705078
local_output_nid generation:  0.02879166603088379
local_in_edges_tensor generation:  0.0509486198425293
mini_batch_src_global generation:  0.056238651275634766
r_  generation:  0.4911201000213623
local_output_nid generation:  0.03442645072937012
local_in_edges_tensor generation:  0.035657644271850586
mini_batch_src_global generation:  0.052210330963134766
r_  generation:  0.44792962074279785
local_output_nid generation:  0.03273582458496094
local_in_edges_tensor generation:  0.033093929290771484
mini_batch_src_global generation:  0.05139446258544922
r_  generation:  0.4538695812225342
local_output_nid generation:  0.03294563293457031
local_in_edges_tensor generation:  0.029308557510375977
mini_batch_src_global generation:  0.05237388610839844
r_  generation:  0.4504127502441406
local_output_nid generation:  0.03264117240905762
local_in_edges_tensor generation:  0.08102297782897949
mini_batch_src_global generation:  0.05365109443664551
r_  generation:  0.4709763526916504
local_output_nid generation:  0.03211045265197754
local_in_edges_tensor generation:  0.029420852661132812
mini_batch_src_global generation:  0.05301952362060547
r_  generation:  0.4637761116027832
local_output_nid generation:  0.03217339515686035
local_in_edges_tensor generation:  0.03770279884338379
mini_batch_src_global generation:  0.05442309379577637
r_  generation:  0.46434688568115234
local_output_nid generation:  0.03435182571411133
local_in_edges_tensor generation:  0.03349661827087402
mini_batch_src_global generation:  0.05321168899536133
r_  generation:  0.4624345302581787
local_output_nid generation:  0.03430914878845215
local_in_edges_tensor generation:  0.03481149673461914
mini_batch_src_global generation:  0.05251193046569824
r_  generation:  0.48156213760375977
local_output_nid generation:  0.03526043891906738
local_in_edges_tensor generation:  0.0335233211517334
mini_batch_src_global generation:  0.05411338806152344
r_  generation:  0.4536917209625244
local_output_nid generation:  0.03291511535644531
local_in_edges_tensor generation:  0.03332042694091797
mini_batch_src_global generation:  0.052217960357666016
r_  generation:  0.4587070941925049
local_output_nid generation:  0.03262066841125488
local_in_edges_tensor generation:  0.02883291244506836
mini_batch_src_global generation:  0.053171634674072266
r_  generation:  0.44965553283691406
local_output_nid generation:  0.03293871879577637
local_in_edges_tensor generation:  0.02998828887939453
mini_batch_src_global generation:  0.05182170867919922
r_  generation:  0.4612863063812256
local_output_nid generation:  0.03339719772338867
local_in_edges_tensor generation:  0.03315138816833496
mini_batch_src_global generation:  0.05371809005737305
r_  generation:  0.4549281597137451
local_output_nid generation:  0.03289651870727539
local_in_edges_tensor generation:  0.02886343002319336
mini_batch_src_global generation:  0.05169415473937988
r_  generation:  0.4683341979980469
local_output_nid generation:  0.03271222114562988
local_in_edges_tensor generation:  0.034960269927978516
mini_batch_src_global generation:  0.05512118339538574
r_  generation:  0.4641423225402832
----------------------check_connections_block total spend ----------------------------- 11.005905389785767
generate_one_block  0.6107633113861084
generate_one_block  0.5961475372314453
generate_one_block  0.5948295593261719
generate_one_block  0.5994734764099121
generate_one_block  0.5954186916351318
generate_one_block  0.5968191623687744
generate_one_block  0.6027584075927734
generate_one_block  0.5950465202331543
generate_one_block  0.6618428230285645
generate_one_block  0.6018538475036621
generate_one_block  0.591843843460083
generate_one_block  0.590735673904419
generate_one_block  0.5978043079376221
generate_one_block  0.5959789752960205
generate_one_block  0.5938100814819336
generate_one_block  0.6111915111541748
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.6033935546875 GB
    Memory Allocated: 0.133575439453125  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

connection checking time:  16.15553045272827
block generation total time  14.13245153427124
average batch blocks generation time:  0.8832782208919525
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6033935546875 GB
    Memory Allocated: 0.1117701530456543  GigaBytes
Max Memory Allocated: 21.56040620803833  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6033935546875 GB
    Memory Allocated: 21.547671794891357  GigaBytes
Max Memory Allocated: 21.60985565185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6033935546875 GB
    Memory Allocated: 0.11113643646240234  GigaBytes
Max Memory Allocated: 21.60985565185547  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6033935546875 GB
    Memory Allocated: 21.33153486251831  GigaBytes
Max Memory Allocated: 21.60985565185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6033935546875 GB
    Memory Allocated: 0.11155986785888672  GigaBytes
Max Memory Allocated: 21.60985565185547  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6033935546875 GB
    Memory Allocated: 21.158592700958252  GigaBytes
Max Memory Allocated: 21.60985565185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6033935546875 GB
    Memory Allocated: 0.11104488372802734  GigaBytes
Max Memory Allocated: 21.60985565185547  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6033935546875 GB
    Memory Allocated: 21.30391836166382  GigaBytes
Max Memory Allocated: 21.60985565185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6033935546875 GB
    Memory Allocated: 0.11153030395507812  GigaBytes
Max Memory Allocated: 21.60985565185547  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6033935546875 GB
    Memory Allocated: 21.094467639923096  GigaBytes
Max Memory Allocated: 21.60985565185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6033935546875 GB
    Memory Allocated: 0.11105060577392578  GigaBytes
Max Memory Allocated: 21.60985565185547  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6072998046875 GB
    Memory Allocated: 21.316615104675293  GigaBytes
Max Memory Allocated: 21.60985565185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6092529296875 GB
    Memory Allocated: 0.11154747009277344  GigaBytes
Max Memory Allocated: 21.60985565185547  GigaBytes

Traceback (most recent call last):
  File "pseudo_mini_batch_range_arxiv_sage.py", line 433, in <module>
    main()
  File "pseudo_mini_batch_range_arxiv_sage.py", line 429, in main
    best_test = run(args, device, data)
  File "pseudo_mini_batch_range_arxiv_sage.py", line 251, in run
    batch_pred = model(blocks, batch_inputs)#------------*
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/graph_partition_multi_layers/pseudo_mini_batch_full_batch/SAGE/graphsage_model_arxiv.py", line 57, in forward
    x = self.layers[-1](blocks[-1], x)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 258, in forward
    graph.update_all(msg_fn, self._lstm_reducer)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/heterograph.py", line 4849, in update_all
    ndata = core.message_passing(g, message_func, reduce_func, apply_node_func)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 337, in message_passing
    ndata = invoke_udf_reduce(g, rfunc, msgdata, orig_nid=orig_nid)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 143, in invoke_udf_reduce
    bkt_rsts.append(func(nbatch))
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 173, in _lstm_reducer
    _, (rst, _) = self.lstm(m, h)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/rnn.py", line 582, in forward
    self.dropout, self.training, self.bidirectional, self.batch_first)
RuntimeError: CUDA out of memory. Tried to allocate 2.00 MiB (GPU 0; 23.62 GiB total capacity; 21.02 GiB already allocated; 2.44 MiB free; 22.41 GiB reserved in total by PyTorch)
