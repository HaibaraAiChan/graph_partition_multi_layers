Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1647788920.3683176
ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0213623046875 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027439355850219727
random selection method range initialization spend 0.005892753601074219
time for parepare:  0.0191953182220459
local_output_nid generation:  0.0021665096282958984
local_in_edges_tensor generation:  0.005127668380737305
mini_batch_src_global generation:  0.002046346664428711
r_  generation:  0.020628690719604492
local_output_nid generation:  0.0025403499603271484
local_in_edges_tensor generation:  0.001703023910522461
mini_batch_src_global generation:  0.002373933792114258
r_  generation:  0.018953800201416016
local_output_nid generation:  0.0027930736541748047
local_in_edges_tensor generation:  0.00170135498046875
mini_batch_src_global generation:  0.0015177726745605469
r_  generation:  0.019470930099487305
local_output_nid generation:  0.0028634071350097656
local_in_edges_tensor generation:  0.0016429424285888672
mini_batch_src_global generation:  0.001550436019897461
r_  generation:  0.020156383514404297
local_output_nid generation:  0.0028748512268066406
local_in_edges_tensor generation:  0.0016374588012695312
mini_batch_src_global generation:  0.0016722679138183594
r_  generation:  0.02017831802368164
local_output_nid generation:  0.0028908252716064453
local_in_edges_tensor generation:  0.0015101432800292969
mini_batch_src_global generation:  0.0017232894897460938
r_  generation:  0.020738840103149414
local_output_nid generation:  0.002907276153564453
local_in_edges_tensor generation:  0.0015594959259033203
mini_batch_src_global generation:  0.0017063617706298828
r_  generation:  0.02032327651977539
local_output_nid generation:  0.0028684139251708984
local_in_edges_tensor generation:  0.0015194416046142578
mini_batch_src_global generation:  0.0016200542449951172
r_  generation:  0.020151853561401367
local_output_nid generation:  0.0028238296508789062
local_in_edges_tensor generation:  0.0015609264373779297
mini_batch_src_global generation:  0.00165557861328125
r_  generation:  0.021346569061279297
local_output_nid generation:  0.0029222965240478516
local_in_edges_tensor generation:  0.0015289783477783203
mini_batch_src_global generation:  0.0016937255859375
r_  generation:  0.02095341682434082
local_output_nid generation:  0.0028848648071289062
local_in_edges_tensor generation:  0.0015172958374023438
mini_batch_src_global generation:  0.0017180442810058594
r_  generation:  0.020907163619995117
local_output_nid generation:  0.0028769969940185547
local_in_edges_tensor generation:  0.0014979839324951172
mini_batch_src_global generation:  0.0018248558044433594
r_  generation:  0.02169203758239746
local_output_nid generation:  0.0028803348541259766
local_in_edges_tensor generation:  0.001489877700805664
mini_batch_src_global generation:  0.001865386962890625
r_  generation:  0.021535158157348633
local_output_nid generation:  0.0028839111328125
local_in_edges_tensor generation:  0.0014657974243164062
mini_batch_src_global generation:  0.0017137527465820312
r_  generation:  0.021100521087646484
local_output_nid generation:  0.002866506576538086
local_in_edges_tensor generation:  0.0015020370483398438
mini_batch_src_global generation:  0.0018429756164550781
r_  generation:  0.021697521209716797
local_output_nid generation:  0.002887725830078125
local_in_edges_tensor generation:  0.0015535354614257812
mini_batch_src_global generation:  0.0017609596252441406
r_  generation:  0.02042078971862793
----------------------check_connections_block total spend ----------------------------- 0.5365715026855469
generate_one_block  0.03197932243347168
generate_one_block  0.030037403106689453
generate_one_block  0.034006357192993164
generate_one_block  0.031705379486083984
generate_one_block  0.030750036239624023
generate_one_block  0.03114628791809082
generate_one_block  0.030472517013549805
generate_one_block  0.030013084411621094
generate_one_block  0.03110480308532715
generate_one_block  0.030672311782836914
generate_one_block  0.03052520751953125
generate_one_block  0.031621456146240234
generate_one_block  0.031356096267700195
generate_one_block  0.030810832977294922
generate_one_block  0.03151726722717285
generate_one_block  0.0303342342376709
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04244661331176758
gen group dst list time:  0.02061748504638672
time for parepare:  0.020052433013916016
local_output_nid generation:  0.009583473205566406
local_in_edges_tensor generation:  0.023912668228149414
mini_batch_src_global generation:  0.028861284255981445
r_  generation:  0.2597076892852783
local_output_nid generation:  0.015339374542236328
local_in_edges_tensor generation:  0.024629592895507812
mini_batch_src_global generation:  0.03181648254394531
r_  generation:  0.2507808208465576
local_output_nid generation:  0.015622138977050781
local_in_edges_tensor generation:  0.021210193634033203
mini_batch_src_global generation:  0.03129172325134277
r_  generation:  0.26498889923095703
local_output_nid generation:  0.015776872634887695
local_in_edges_tensor generation:  0.019466400146484375
mini_batch_src_global generation:  0.03499746322631836
r_  generation:  0.2677898406982422
local_output_nid generation:  0.015572071075439453
local_in_edges_tensor generation:  0.016193389892578125
mini_batch_src_global generation:  0.033746957778930664
r_  generation:  0.27387356758117676
local_output_nid generation:  0.01587224006652832
local_in_edges_tensor generation:  0.02105855941772461
mini_batch_src_global generation:  0.034949541091918945
r_  generation:  0.27376675605773926
local_output_nid generation:  0.015556812286376953
local_in_edges_tensor generation:  0.018349647521972656
mini_batch_src_global generation:  0.0345761775970459
r_  generation:  0.2725181579589844
local_output_nid generation:  0.015491485595703125
local_in_edges_tensor generation:  0.017823219299316406
mini_batch_src_global generation:  0.03362441062927246
r_  generation:  0.2601432800292969
local_output_nid generation:  0.015790700912475586
local_in_edges_tensor generation:  0.018659591674804688
mini_batch_src_global generation:  0.0366511344909668
r_  generation:  0.2693312168121338
local_output_nid generation:  0.015666484832763672
local_in_edges_tensor generation:  0.018279314041137695
mini_batch_src_global generation:  0.03489494323730469
r_  generation:  0.26926660537719727
local_output_nid generation:  0.018677711486816406
local_in_edges_tensor generation:  0.017902851104736328
mini_batch_src_global generation:  0.03476858139038086
r_  generation:  0.2738783359527588
local_output_nid generation:  0.01599431037902832
local_in_edges_tensor generation:  0.021165847778320312
mini_batch_src_global generation:  0.03509664535522461
r_  generation:  0.277144193649292
local_output_nid generation:  0.015715837478637695
local_in_edges_tensor generation:  0.018551111221313477
mini_batch_src_global generation:  0.035158634185791016
r_  generation:  0.2763681411743164
local_output_nid generation:  0.015528678894042969
local_in_edges_tensor generation:  0.020926952362060547
mini_batch_src_global generation:  0.034603118896484375
r_  generation:  0.2695322036743164
local_output_nid generation:  0.015887975692749023
local_in_edges_tensor generation:  0.01607203483581543
mini_batch_src_global generation:  0.034970760345458984
r_  generation:  0.2737095355987549
local_output_nid generation:  0.015374898910522461
local_in_edges_tensor generation:  0.020040035247802734
mini_batch_src_global generation:  0.03472566604614258
r_  generation:  0.2667224407196045
----------------------check_connections_block total spend ----------------------------- 6.3626203536987305
generate_one_block  0.36726808547973633
generate_one_block  0.35495734214782715
generate_one_block  0.35590529441833496
generate_one_block  0.37136411666870117
generate_one_block  0.3808705806732178
generate_one_block  0.3653416633605957
generate_one_block  0.35445404052734375
generate_one_block  0.34781646728515625
generate_one_block  0.3593881130218506
generate_one_block  0.3664817810058594
generate_one_block  0.35703444480895996
generate_one_block  0.3660616874694824
generate_one_block  0.3946998119354248
generate_one_block  0.35440969467163086
generate_one_block  0.38432788848876953
generate_one_block  0.36484766006469727
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05939650535583496
gen group dst list time:  0.07652759552001953
time for parepare:  0.020335674285888672
local_output_nid generation:  0.02828502655029297
local_in_edges_tensor generation:  0.056684017181396484
mini_batch_src_global generation:  0.046633243560791016
r_  generation:  0.4556560516357422
local_output_nid generation:  0.033998727798461914
local_in_edges_tensor generation:  0.0509645938873291
mini_batch_src_global generation:  0.05411100387573242
r_  generation:  0.4546957015991211
local_output_nid generation:  0.03336286544799805
local_in_edges_tensor generation:  0.038836002349853516
mini_batch_src_global generation:  0.052065372467041016
r_  generation:  0.4628868103027344
local_output_nid generation:  0.03372025489807129
local_in_edges_tensor generation:  0.04676246643066406
mini_batch_src_global generation:  0.052697181701660156
r_  generation:  0.4650886058807373
local_output_nid generation:  0.033483028411865234
local_in_edges_tensor generation:  0.03808331489562988
mini_batch_src_global generation:  0.05283808708190918
r_  generation:  0.4682631492614746
local_output_nid generation:  0.03385186195373535
local_in_edges_tensor generation:  0.03793144226074219
mini_batch_src_global generation:  0.053742170333862305
r_  generation:  0.481534481048584
local_output_nid generation:  0.03368067741394043
local_in_edges_tensor generation:  0.03416705131530762
mini_batch_src_global generation:  0.05365943908691406
r_  generation:  0.4751110076904297
local_output_nid generation:  0.033060550689697266
local_in_edges_tensor generation:  0.034189701080322266
mini_batch_src_global generation:  0.05379772186279297
r_  generation:  0.47974467277526855
local_output_nid generation:  0.03397083282470703
local_in_edges_tensor generation:  0.0558929443359375
mini_batch_src_global generation:  0.05817127227783203
r_  generation:  0.4858832359313965
local_output_nid generation:  0.03500032424926758
local_in_edges_tensor generation:  0.049727678298950195
mini_batch_src_global generation:  0.054792165756225586
r_  generation:  0.47629833221435547
local_output_nid generation:  0.03380990028381348
local_in_edges_tensor generation:  0.043491363525390625
mini_batch_src_global generation:  0.05378270149230957
r_  generation:  0.47507786750793457
local_output_nid generation:  0.04559159278869629
local_in_edges_tensor generation:  0.038450002670288086
mini_batch_src_global generation:  0.0575253963470459
r_  generation:  0.4718601703643799
local_output_nid generation:  0.033859968185424805
local_in_edges_tensor generation:  0.0339503288269043
mini_batch_src_global generation:  0.05824732780456543
r_  generation:  0.47374892234802246
local_output_nid generation:  0.033715248107910156
local_in_edges_tensor generation:  0.03395509719848633
mini_batch_src_global generation:  0.05496549606323242
r_  generation:  0.4727137088775635
local_output_nid generation:  0.03383326530456543
local_in_edges_tensor generation:  0.052973270416259766
mini_batch_src_global generation:  0.05857372283935547
r_  generation:  0.4771692752838135
local_output_nid generation:  0.0346066951751709
local_in_edges_tensor generation:  0.031664371490478516
mini_batch_src_global generation:  0.05466008186340332
r_  generation:  0.47662782669067383
----------------------check_connections_block total spend ----------------------------- 11.399221181869507
generate_one_block  0.6559126377105713
generate_one_block  0.5964808464050293
generate_one_block  0.6000456809997559
generate_one_block  0.6059434413909912
generate_one_block  0.5977959632873535
generate_one_block  0.60121750831604
generate_one_block  0.6435074806213379
generate_one_block  0.5961165428161621
generate_one_block  0.5990207195281982
generate_one_block  0.6194350719451904
generate_one_block  0.5934977531433105
generate_one_block  0.599273681640625
generate_one_block  0.586193323135376
generate_one_block  0.5938868522644043
generate_one_block  0.5990662574768066
generate_one_block  0.5985376834869385
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0213623046875 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

connection checking time:  17.761841535568237
block generation total time  15.531160116195679
average batch blocks generation time:  0.9706975072622299
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1815185546875 GB
    Memory Allocated: 0.09806585311889648  GigaBytes
Max Memory Allocated: 0.09806585311889648  GigaBytes

Traceback (most recent call last):
  File "pseudo_mini_batch_range_arxiv_sage.py", line 433, in <module>
    main()
  File "pseudo_mini_batch_range_arxiv_sage.py", line 429, in main
    best_test = run(args, device, data)
  File "pseudo_mini_batch_range_arxiv_sage.py", line 251, in run
    batch_pred = model(blocks, batch_inputs)#------------*
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/graph_partition_multi_layers/pseudo_mini_batch_full_batch/SAGE/graphsage_model_arxiv.py", line 53, in forward
    x = layer(block, x)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 258, in forward
    graph.update_all(msg_fn, self._lstm_reducer)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/heterograph.py", line 4849, in update_all
    ndata = core.message_passing(g, message_func, reduce_func, apply_node_func)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 337, in message_passing
    ndata = invoke_udf_reduce(g, rfunc, msgdata, orig_nid=orig_nid)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 143, in invoke_udf_reduce
    bkt_rsts.append(func(nbatch))
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 173, in _lstm_reducer
    _, (rst, _) = self.lstm(m, h)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/rnn.py", line 582, in forward
    self.dropout, self.training, self.bidirectional, self.batch_first)
RuntimeError: CUDA out of memory. Tried to allocate 2.00 MiB (GPU 0; 23.62 GiB total capacity; 22.37 GiB already allocated; 2.44 MiB free; 22.42 GiB reserved in total by PyTorch)
