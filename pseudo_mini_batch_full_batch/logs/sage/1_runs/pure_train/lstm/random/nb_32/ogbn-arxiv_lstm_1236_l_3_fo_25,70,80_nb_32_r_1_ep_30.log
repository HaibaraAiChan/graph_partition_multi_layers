Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1647788965.6251128
ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0213623046875 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027036666870117188
random selection method range initialization spend 0.006536960601806641
time for parepare:  0.018489837646484375
local_output_nid generation:  0.0011420249938964844
local_in_edges_tensor generation:  0.004294395446777344
mini_batch_src_global generation:  0.001613616943359375
r_  generation:  0.010173320770263672
local_output_nid generation:  0.001252889633178711
local_in_edges_tensor generation:  0.0010027885437011719
mini_batch_src_global generation:  0.001714468002319336
r_  generation:  0.010153055191040039
local_output_nid generation:  0.001367807388305664
local_in_edges_tensor generation:  0.0008959770202636719
mini_batch_src_global generation:  0.0010840892791748047
r_  generation:  0.008896350860595703
local_output_nid generation:  0.0013880729675292969
local_in_edges_tensor generation:  0.0008769035339355469
mini_batch_src_global generation:  0.0009739398956298828
r_  generation:  0.009054183959960938
local_output_nid generation:  0.0013794898986816406
local_in_edges_tensor generation:  0.0008571147918701172
mini_batch_src_global generation:  0.0009675025939941406
r_  generation:  0.009235858917236328
local_output_nid generation:  0.0014007091522216797
local_in_edges_tensor generation:  0.0008287429809570312
mini_batch_src_global generation:  0.0010037422180175781
r_  generation:  0.00977325439453125
local_output_nid generation:  0.0014259815216064453
local_in_edges_tensor generation:  0.0008184909820556641
mini_batch_src_global generation:  0.0010442733764648438
r_  generation:  0.009677410125732422
local_output_nid generation:  0.001421213150024414
local_in_edges_tensor generation:  0.0008289813995361328
mini_batch_src_global generation:  0.0010254383087158203
r_  generation:  0.010029315948486328
local_output_nid generation:  0.0014448165893554688
local_in_edges_tensor generation:  0.0008308887481689453
mini_batch_src_global generation:  0.0010142326354980469
r_  generation:  0.009619951248168945
local_output_nid generation:  0.0014393329620361328
local_in_edges_tensor generation:  0.0007889270782470703
mini_batch_src_global generation:  0.0010020732879638672
r_  generation:  0.009659290313720703
local_output_nid generation:  0.0014526844024658203
local_in_edges_tensor generation:  0.0008051395416259766
mini_batch_src_global generation:  0.0010485649108886719
r_  generation:  0.01035308837890625
local_output_nid generation:  0.0014657974243164062
local_in_edges_tensor generation:  0.0008108615875244141
mini_batch_src_global generation:  0.001031637191772461
r_  generation:  0.009948492050170898
local_output_nid generation:  0.0014564990997314453
local_in_edges_tensor generation:  0.0007665157318115234
mini_batch_src_global generation:  0.0010061264038085938
r_  generation:  0.009615898132324219
local_output_nid generation:  0.0014429092407226562
local_in_edges_tensor generation:  0.0007805824279785156
mini_batch_src_global generation:  0.0010569095611572266
r_  generation:  0.00985407829284668
local_output_nid generation:  0.001424551010131836
local_in_edges_tensor generation:  0.0007827281951904297
mini_batch_src_global generation:  0.0010290145874023438
r_  generation:  0.009931087493896484
local_output_nid generation:  0.0014252662658691406
local_in_edges_tensor generation:  0.0007879734039306641
mini_batch_src_global generation:  0.0010120868682861328
r_  generation:  0.009782552719116211
local_output_nid generation:  0.0014407634735107422
local_in_edges_tensor generation:  0.0007905960083007812
mini_batch_src_global generation:  0.0010943412780761719
r_  generation:  0.010202646255493164
local_output_nid generation:  0.001474142074584961
local_in_edges_tensor generation:  0.0007915496826171875
mini_batch_src_global generation:  0.001051187515258789
r_  generation:  0.009874105453491211
local_output_nid generation:  0.0014414787292480469
local_in_edges_tensor generation:  0.0007758140563964844
mini_batch_src_global generation:  0.0010540485382080078
r_  generation:  0.009894609451293945
local_output_nid generation:  0.0014405250549316406
local_in_edges_tensor generation:  0.0007529258728027344
mini_batch_src_global generation:  0.0010285377502441406
r_  generation:  0.009898662567138672
local_output_nid generation:  0.001455545425415039
local_in_edges_tensor generation:  0.0007801055908203125
mini_batch_src_global generation:  0.0011031627655029297
r_  generation:  0.009837627410888672
local_output_nid generation:  0.0014524459838867188
local_in_edges_tensor generation:  0.0007562637329101562
mini_batch_src_global generation:  0.0010576248168945312
r_  generation:  0.010037660598754883
local_output_nid generation:  0.0014553070068359375
local_in_edges_tensor generation:  0.00080108642578125
mini_batch_src_global generation:  0.0011157989501953125
r_  generation:  0.01043558120727539
local_output_nid generation:  0.0014619827270507812
local_in_edges_tensor generation:  0.0008132457733154297
mini_batch_src_global generation:  0.0011014938354492188
r_  generation:  0.010381460189819336
local_output_nid generation:  0.0014595985412597656
local_in_edges_tensor generation:  0.0007770061492919922
mini_batch_src_global generation:  0.0010726451873779297
r_  generation:  0.01024007797241211
local_output_nid generation:  0.0014574527740478516
local_in_edges_tensor generation:  0.0007636547088623047
mini_batch_src_global generation:  0.0010945796966552734
r_  generation:  0.00998544692993164
local_output_nid generation:  0.0014672279357910156
local_in_edges_tensor generation:  0.000751495361328125
mini_batch_src_global generation:  0.0010101795196533203
r_  generation:  0.009671449661254883
local_output_nid generation:  0.0014758110046386719
local_in_edges_tensor generation:  0.0007953643798828125
mini_batch_src_global generation:  0.0010800361633300781
r_  generation:  0.010241270065307617
local_output_nid generation:  0.00144195556640625
local_in_edges_tensor generation:  0.0007712841033935547
mini_batch_src_global generation:  0.001085519790649414
r_  generation:  0.010480165481567383
local_output_nid generation:  0.0014760494232177734
local_in_edges_tensor generation:  0.0056209564208984375
mini_batch_src_global generation:  0.0012826919555664062
r_  generation:  0.010087728500366211
local_output_nid generation:  0.0013480186462402344
local_in_edges_tensor generation:  0.0007731914520263672
mini_batch_src_global generation:  0.0010845661163330078
r_  generation:  0.009495019912719727
local_output_nid generation:  0.0013818740844726562
local_in_edges_tensor generation:  0.0007576942443847656
mini_batch_src_global generation:  0.0011103153228759766
r_  generation:  0.009987831115722656
----------------------check_connections_block total spend ----------------------------- 0.5404667854309082
generate_one_block  0.016020774841308594
generate_one_block  0.015749216079711914
generate_one_block  0.014384746551513672
generate_one_block  0.014414310455322266
generate_one_block  0.0147705078125
generate_one_block  0.015252113342285156
generate_one_block  0.014984607696533203
generate_one_block  0.015157461166381836
generate_one_block  0.014936208724975586
generate_one_block  0.015159845352172852
generate_one_block  0.015365839004516602
generate_one_block  0.014847040176391602
generate_one_block  0.0145263671875
generate_one_block  0.014912605285644531
generate_one_block  0.014902591705322266
generate_one_block  0.01424717903137207
generate_one_block  0.01533961296081543
generate_one_block  0.014671564102172852
generate_one_block  0.014881372451782227
generate_one_block  0.014504432678222656
generate_one_block  0.014881372451782227
generate_one_block  0.014783143997192383
generate_one_block  0.015368461608886719
generate_one_block  0.015228748321533203
generate_one_block  0.015300512313842773
generate_one_block  0.015008926391601562
generate_one_block  0.014258861541748047
generate_one_block  0.015249013900756836
generate_one_block  0.01568770408630371
generate_one_block  0.014829874038696289
generate_one_block  0.014487028121948242
generate_one_block  0.014676332473754883
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04395341873168945
gen group dst list time:  0.023423433303833008
time for parepare:  0.019662857055664062
local_output_nid generation:  0.0054776668548583984
local_in_edges_tensor generation:  0.015227317810058594
mini_batch_src_global generation:  0.016331195831298828
r_  generation:  0.16354751586914062
local_output_nid generation:  0.01059103012084961
local_in_edges_tensor generation:  0.016751766204833984
mini_batch_src_global generation:  0.021267175674438477
r_  generation:  0.1751401424407959
local_output_nid generation:  0.009869098663330078
local_in_edges_tensor generation:  0.010426044464111328
mini_batch_src_global generation:  0.018503665924072266
r_  generation:  0.1609654426574707
local_output_nid generation:  0.009933710098266602
local_in_edges_tensor generation:  0.011034727096557617
mini_batch_src_global generation:  0.019394397735595703
r_  generation:  0.16537761688232422
local_output_nid generation:  0.010072946548461914
local_in_edges_tensor generation:  0.013927936553955078
mini_batch_src_global generation:  0.020503520965576172
r_  generation:  0.17391324043273926
local_output_nid generation:  0.010339498519897461
local_in_edges_tensor generation:  0.01027369499206543
mini_batch_src_global generation:  0.02321457862854004
r_  generation:  0.17621469497680664
local_output_nid generation:  0.010218143463134766
local_in_edges_tensor generation:  0.01415705680847168
mini_batch_src_global generation:  0.021535873413085938
r_  generation:  0.17325568199157715
local_output_nid generation:  0.01046299934387207
local_in_edges_tensor generation:  0.01278829574584961
mini_batch_src_global generation:  0.02237987518310547
r_  generation:  0.17972826957702637
local_output_nid generation:  0.01033329963684082
local_in_edges_tensor generation:  0.009526491165161133
mini_batch_src_global generation:  0.022351741790771484
r_  generation:  0.1773850917816162
local_output_nid generation:  0.010210037231445312
local_in_edges_tensor generation:  0.009557723999023438
mini_batch_src_global generation:  0.022081375122070312
r_  generation:  0.17681574821472168
local_output_nid generation:  0.010353803634643555
local_in_edges_tensor generation:  0.01438593864440918
mini_batch_src_global generation:  0.023151159286499023
r_  generation:  0.18213605880737305
local_output_nid generation:  0.010225534439086914
local_in_edges_tensor generation:  0.012348413467407227
mini_batch_src_global generation:  0.022622346878051758
r_  generation:  0.17897534370422363
local_output_nid generation:  0.009971141815185547
local_in_edges_tensor generation:  0.009330511093139648
mini_batch_src_global generation:  0.02265191078186035
r_  generation:  0.1795825958251953
local_output_nid generation:  0.010221719741821289
local_in_edges_tensor generation:  0.009502887725830078
mini_batch_src_global generation:  0.022700786590576172
r_  generation:  0.17874407768249512
local_output_nid generation:  0.010169506072998047
local_in_edges_tensor generation:  0.012697696685791016
mini_batch_src_global generation:  0.024039506912231445
r_  generation:  0.17699098587036133
local_output_nid generation:  0.009906530380249023
local_in_edges_tensor generation:  0.00937962532043457
mini_batch_src_global generation:  0.021604299545288086
r_  generation:  0.1691274642944336
local_output_nid generation:  0.010528802871704102
local_in_edges_tensor generation:  0.010911703109741211
mini_batch_src_global generation:  0.022630929946899414
r_  generation:  0.17900300025939941
local_output_nid generation:  0.010231494903564453
local_in_edges_tensor generation:  0.0139312744140625
mini_batch_src_global generation:  0.023186922073364258
r_  generation:  0.1777336597442627
local_output_nid generation:  0.010338068008422852
local_in_edges_tensor generation:  0.012700557708740234
mini_batch_src_global generation:  0.022562265396118164
r_  generation:  0.1798703670501709
local_output_nid generation:  0.010221242904663086
local_in_edges_tensor generation:  0.009566545486450195
mini_batch_src_global generation:  0.0226285457611084
r_  generation:  0.17543458938598633
local_output_nid generation:  0.010305404663085938
local_in_edges_tensor generation:  0.011031389236450195
mini_batch_src_global generation:  0.022516965866088867
r_  generation:  0.18329358100891113
local_output_nid generation:  0.010191679000854492
local_in_edges_tensor generation:  0.013923168182373047
mini_batch_src_global generation:  0.022747516632080078
r_  generation:  0.1776275634765625
local_output_nid generation:  0.010505199432373047
local_in_edges_tensor generation:  0.010046243667602539
mini_batch_src_global generation:  0.022716760635375977
r_  generation:  0.18044424057006836
local_output_nid generation:  0.010462284088134766
local_in_edges_tensor generation:  0.010482549667358398
mini_batch_src_global generation:  0.023064851760864258
r_  generation:  0.18346428871154785
local_output_nid generation:  0.010438680648803711
local_in_edges_tensor generation:  0.012790441513061523
mini_batch_src_global generation:  0.023097753524780273
r_  generation:  0.18367910385131836
local_output_nid generation:  0.010273933410644531
local_in_edges_tensor generation:  0.010003805160522461
mini_batch_src_global generation:  0.023199081420898438
r_  generation:  0.18280339241027832
local_output_nid generation:  0.010009527206420898
local_in_edges_tensor generation:  0.012656450271606445
mini_batch_src_global generation:  0.023990392684936523
r_  generation:  0.17304563522338867
local_output_nid generation:  0.010553359985351562
local_in_edges_tensor generation:  0.009792089462280273
mini_batch_src_global generation:  0.022233009338378906
r_  generation:  0.18447422981262207
local_output_nid generation:  0.010607481002807617
local_in_edges_tensor generation:  0.012898921966552734
mini_batch_src_global generation:  0.022818565368652344
r_  generation:  0.1881699562072754
local_output_nid generation:  0.010411739349365234
local_in_edges_tensor generation:  0.023865699768066406
mini_batch_src_global generation:  0.02272343635559082
r_  generation:  0.18053340911865234
local_output_nid generation:  0.008087158203125
local_in_edges_tensor generation:  0.008661508560180664
mini_batch_src_global generation:  0.021953344345092773
r_  generation:  0.1741621494293213
local_output_nid generation:  0.008095741271972656
local_in_edges_tensor generation:  0.013408184051513672
mini_batch_src_global generation:  0.023952722549438477
r_  generation:  0.19067788124084473
----------------------check_connections_block total spend ----------------------------- 8.40036916732788
generate_one_block  0.24319672584533691
generate_one_block  0.24764108657836914
generate_one_block  0.2634444236755371
generate_one_block  0.2201392650604248
generate_one_block  0.22509360313415527
generate_one_block  0.24454975128173828
generate_one_block  0.22939491271972656
generate_one_block  0.2453916072845459
generate_one_block  0.23283982276916504
generate_one_block  0.22433185577392578
generate_one_block  0.23852825164794922
generate_one_block  0.24405550956726074
generate_one_block  0.2269141674041748
generate_one_block  0.23628497123718262
generate_one_block  0.2527763843536377
generate_one_block  0.24174976348876953
generate_one_block  0.24078965187072754
generate_one_block  0.24036049842834473
generate_one_block  0.2333357334136963
generate_one_block  0.22628068923950195
generate_one_block  0.2567329406738281
generate_one_block  0.2299346923828125
generate_one_block  0.2550990581512451
generate_one_block  0.24798345565795898
generate_one_block  0.23702001571655273
generate_one_block  0.22559165954589844
generate_one_block  0.21774983406066895
generate_one_block  0.23354887962341309
generate_one_block  0.23441505432128906
generate_one_block  0.22042131423950195
generate_one_block  0.23110198974609375
generate_one_block  0.23149752616882324
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05898118019104004
gen group dst list time:  0.1139686107635498
time for parepare:  0.018610239028930664
local_output_nid generation:  0.023219823837280273
local_in_edges_tensor generation:  0.045395851135253906
mini_batch_src_global generation:  0.04178190231323242
r_  generation:  0.43055009841918945
local_output_nid generation:  0.030103683471679688
local_in_edges_tensor generation:  0.045650482177734375
mini_batch_src_global generation:  0.05096840858459473
r_  generation:  0.4185161590576172
local_output_nid generation:  0.0291595458984375
local_in_edges_tensor generation:  0.03430986404418945
mini_batch_src_global generation:  0.053671836853027344
r_  generation:  0.4224741458892822
local_output_nid generation:  0.02791595458984375
local_in_edges_tensor generation:  0.0403289794921875
mini_batch_src_global generation:  0.048845767974853516
r_  generation:  0.4247314929962158
local_output_nid generation:  0.027690887451171875
local_in_edges_tensor generation:  0.041474342346191406
mini_batch_src_global generation:  0.04809856414794922
r_  generation:  0.4287104606628418
local_output_nid generation:  0.02877211570739746
local_in_edges_tensor generation:  0.03902411460876465
mini_batch_src_global generation:  0.049089670181274414
r_  generation:  0.44467806816101074
local_output_nid generation:  0.028273344039916992
local_in_edges_tensor generation:  0.042439937591552734
mini_batch_src_global generation:  0.053864240646362305
r_  generation:  0.4424302577972412
local_output_nid generation:  0.02909541130065918
local_in_edges_tensor generation:  0.038156747817993164
mini_batch_src_global generation:  0.05664777755737305
r_  generation:  0.439957857131958
local_output_nid generation:  0.029657363891601562
local_in_edges_tensor generation:  0.033858299255371094
mini_batch_src_global generation:  0.04896211624145508
r_  generation:  0.44631171226501465
local_output_nid generation:  0.028841257095336914
local_in_edges_tensor generation:  0.029727458953857422
mini_batch_src_global generation:  0.05016469955444336
r_  generation:  0.43709325790405273
local_output_nid generation:  0.028733015060424805
local_in_edges_tensor generation:  0.030886173248291016
mini_batch_src_global generation:  0.05686330795288086
r_  generation:  0.45783114433288574
local_output_nid generation:  0.03379225730895996
local_in_edges_tensor generation:  0.05897402763366699
mini_batch_src_global generation:  0.06540608406066895
r_  generation:  0.4403691291809082
local_output_nid generation:  0.029759883880615234
local_in_edges_tensor generation:  0.03352165222167969
mini_batch_src_global generation:  0.04912686347961426
r_  generation:  0.43160295486450195
local_output_nid generation:  0.029346227645874023
local_in_edges_tensor generation:  0.03465461730957031
mini_batch_src_global generation:  0.050286293029785156
r_  generation:  0.44114017486572266
local_output_nid generation:  0.029010772705078125
local_in_edges_tensor generation:  0.0374760627746582
mini_batch_src_global generation:  0.05008292198181152
r_  generation:  0.44144368171691895
local_output_nid generation:  0.02952122688293457
local_in_edges_tensor generation:  0.04301023483276367
mini_batch_src_global generation:  0.06124544143676758
r_  generation:  0.4351975917816162
local_output_nid generation:  0.032122135162353516
local_in_edges_tensor generation:  0.03929543495178223
mini_batch_src_global generation:  0.05048942565917969
r_  generation:  0.4436054229736328
local_output_nid generation:  0.02942490577697754
local_in_edges_tensor generation:  0.038277626037597656
mini_batch_src_global generation:  0.050662994384765625
r_  generation:  0.4448432922363281
local_output_nid generation:  0.02937602996826172
local_in_edges_tensor generation:  0.03604555130004883
mini_batch_src_global generation:  0.05032849311828613
r_  generation:  0.44271397590637207
local_output_nid generation:  0.029315710067749023
local_in_edges_tensor generation:  0.03583168983459473
mini_batch_src_global generation:  0.0497896671295166
r_  generation:  0.4564049243927002
local_output_nid generation:  0.029812097549438477
local_in_edges_tensor generation:  0.027522802352905273
mini_batch_src_global generation:  0.04975128173828125
r_  generation:  0.4426388740539551
local_output_nid generation:  0.02907586097717285
local_in_edges_tensor generation:  0.03236079216003418
mini_batch_src_global generation:  0.050220489501953125
r_  generation:  0.44106388092041016
local_output_nid generation:  0.030162811279296875
local_in_edges_tensor generation:  0.03539562225341797
mini_batch_src_global generation:  0.05392813682556152
r_  generation:  0.4525606632232666
local_output_nid generation:  0.02948617935180664
local_in_edges_tensor generation:  0.04271364212036133
mini_batch_src_global generation:  0.06584620475769043
r_  generation:  0.4506235122680664
local_output_nid generation:  0.030509471893310547
local_in_edges_tensor generation:  0.03647637367248535
mini_batch_src_global generation:  0.05532073974609375
r_  generation:  0.44885706901550293
local_output_nid generation:  0.029235124588012695
local_in_edges_tensor generation:  0.02830648422241211
mini_batch_src_global generation:  0.05596470832824707
r_  generation:  0.448622465133667
local_output_nid generation:  0.029334306716918945
local_in_edges_tensor generation:  0.027228593826293945
mini_batch_src_global generation:  0.0526278018951416
r_  generation:  0.44486117362976074
local_output_nid generation:  0.029236793518066406
local_in_edges_tensor generation:  0.026910781860351562
mini_batch_src_global generation:  0.05573916435241699
r_  generation:  0.4416472911834717
local_output_nid generation:  0.029269933700561523
local_in_edges_tensor generation:  0.03834867477416992
mini_batch_src_global generation:  0.052332401275634766
r_  generation:  0.447129487991333
local_output_nid generation:  0.028945446014404297
local_in_edges_tensor generation:  0.027105331420898438
mini_batch_src_global generation:  0.05327272415161133
r_  generation:  0.45038509368896484
local_output_nid generation:  0.028816938400268555
local_in_edges_tensor generation:  0.028574228286743164
mini_batch_src_global generation:  0.052205801010131836
r_  generation:  0.4419898986816406
local_output_nid generation:  0.02924513816833496
local_in_edges_tensor generation:  0.034642934799194336
mini_batch_src_global generation:  0.050603389739990234
r_  generation:  0.4417440891265869
----------------------check_connections_block total spend ----------------------------- 21.056391716003418
generate_one_block  0.6673412322998047
generate_one_block  0.5671224594116211
generate_one_block  0.5467672348022461
generate_one_block  0.5516161918640137
generate_one_block  0.5547065734863281
generate_one_block  0.5664210319519043
generate_one_block  0.5506627559661865
generate_one_block  0.5661954879760742
generate_one_block  0.5562798976898193
generate_one_block  0.5427098274230957
generate_one_block  0.5510787963867188
generate_one_block  0.5537919998168945
generate_one_block  0.540809154510498
generate_one_block  0.544564962387085
generate_one_block  0.5643761157989502
generate_one_block  0.538358211517334
generate_one_block  0.5530898571014404
generate_one_block  0.5636000633239746
generate_one_block  0.5579161643981934
generate_one_block  0.5646591186523438
generate_one_block  0.5585596561431885
generate_one_block  0.5545752048492432
generate_one_block  0.5669260025024414
generate_one_block  0.5642461776733398
generate_one_block  0.5518918037414551
generate_one_block  0.5539638996124268
generate_one_block  0.5402882099151611
generate_one_block  0.553957462310791
generate_one_block  0.5707495212554932
generate_one_block  0.5437281131744385
generate_one_block  0.5411841869354248
generate_one_block  0.5522456169128418
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0213623046875 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

connection checking time:  29.4567608833313
block generation total time  25.432578086853027
average batch blocks generation time:  0.7947680652141571
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.09075546264648438  GigaBytes
Max Memory Allocated: 0.09075546264648438  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1912841796875 GB
    Memory Allocated: 19.323553562164307  GigaBytes
Max Memory Allocated: 19.423701763153076  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2752685546875 GB
    Memory Allocated: 0.09662008285522461  GigaBytes
Max Memory Allocated: 19.423701763153076  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0760498046875 GB
    Memory Allocated: 19.525851726531982  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5135498046875 GB
    Memory Allocated: 0.09587287902832031  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.6248779296875 GB
    Memory Allocated: 18.421658039093018  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.6268310546875 GB
    Memory Allocated: 0.0962076187133789  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7381591796875 GB
    Memory Allocated: 18.63845729827881  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.2401123046875 GB
    Memory Allocated: 0.09586334228515625  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.2576904296875 GB
    Memory Allocated: 18.575021743774414  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.2596435546875 GB
    Memory Allocated: 0.09615373611450195  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.2947998046875 GB
    Memory Allocated: 19.051666736602783  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.2967529296875 GB
    Memory Allocated: 0.09593391418457031  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.2967529296875 GB
    Memory Allocated: 18.76828622817993  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.2967529296875 GB
    Memory Allocated: 0.09653043746948242  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.2987060546875 GB
    Memory Allocated: 19.162556171417236  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3006591796875 GB
    Memory Allocated: 0.09623289108276367  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3651123046875 GB
    Memory Allocated: 19.041466236114502  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.0960073471069336  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3944091796875 GB
    Memory Allocated: 18.751153469085693  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3983154296875 GB
    Memory Allocated: 0.09627103805541992  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3983154296875 GB
    Memory Allocated: 19.189777374267578  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3983154296875 GB
    Memory Allocated: 0.0960378646850586  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3983154296875 GB
    Memory Allocated: 18.967390537261963  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3983154296875 GB
    Memory Allocated: 0.09554481506347656  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3983154296875 GB
    Memory Allocated: 18.658665657043457  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3983154296875 GB
    Memory Allocated: 0.09639167785644531  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3983154296875 GB
    Memory Allocated: 18.94852876663208  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3983154296875 GB
    Memory Allocated: 0.0961771011352539  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3983154296875 GB
    Memory Allocated: 19.003609657287598  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3983154296875 GB
    Memory Allocated: 0.09582090377807617  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3983154296875 GB
    Memory Allocated: 18.12376880645752  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3983154296875 GB
    Memory Allocated: 0.09612751007080078  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3983154296875 GB
    Memory Allocated: 19.03511095046997  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3983154296875 GB
    Memory Allocated: 0.09610223770141602  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4022216796875 GB
    Memory Allocated: 18.932090282440186  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4041748046875 GB
    Memory Allocated: 0.09634160995483398  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4041748046875 GB
    Memory Allocated: 18.973652362823486  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4041748046875 GB
    Memory Allocated: 0.09623908996582031  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4041748046875 GB
    Memory Allocated: 18.764811515808105  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4041748046875 GB
    Memory Allocated: 0.09605550765991211  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4041748046875 GB
    Memory Allocated: 18.90805673599243  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4041748046875 GB
    Memory Allocated: 0.09621429443359375  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4041748046875 GB
    Memory Allocated: 18.862884521484375  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4041748046875 GB
    Memory Allocated: 0.09639549255371094  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4041748046875 GB
    Memory Allocated: 19.069921016693115  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4041748046875 GB
    Memory Allocated: 0.09644794464111328  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4041748046875 GB
    Memory Allocated: 19.17634391784668  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4041748046875 GB
    Memory Allocated: 0.0963602066040039  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4041748046875 GB
    Memory Allocated: 19.183822631835938  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4041748046875 GB
    Memory Allocated: 0.0961451530456543  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4041748046875 GB
    Memory Allocated: 19.063918113708496  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4041748046875 GB
    Memory Allocated: 0.09586954116821289  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4041748046875 GB
    Memory Allocated: 18.34486961364746  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4041748046875 GB
    Memory Allocated: 0.09618330001831055  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4041748046875 GB
    Memory Allocated: 19.085588932037354  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4041748046875 GB
    Memory Allocated: 0.09645605087280273  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4041748046875 GB
    Memory Allocated: 19.16106128692627  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4041748046875 GB
    Memory Allocated: 0.09628438949584961  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4041748046875 GB
    Memory Allocated: 18.732633113861084  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4041748046875 GB
    Memory Allocated: 0.09580659866333008  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4041748046875 GB
    Memory Allocated: 18.515886306762695  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4041748046875 GB
    Memory Allocated: 0.0960855484008789  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4041748046875 GB
    Memory Allocated: 18.987253189086914  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03616362810134888 |0.033562563359737396 |0.6081128045916557 |0.00011020898818969727 |1.3742701038718224 |0.014327764511108398 |
----------------------------------------------------------pseudo_mini_loss sum 5.386335372924805
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9116905
Number of first layer input nodes during this epoch:  4762596
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4041748046875 GB
    Memory Allocated: 0.12644243240356445  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02479839324951172
random selection method range initialization spend 0.0060274600982666016
time for parepare:  0.019560813903808594
local_output_nid generation:  0.001409769058227539
local_in_edges_tensor generation:  0.005014896392822266
mini_batch_src_global generation:  0.0017554759979248047
r_  generation:  0.010672807693481445
local_output_nid generation:  0.0016262531280517578
local_in_edges_tensor generation:  0.0011093616485595703
mini_batch_src_global generation:  0.0016820430755615234
r_  generation:  0.010193586349487305
local_output_nid generation:  0.0017421245574951172
local_in_edges_tensor generation:  0.0010950565338134766
mini_batch_src_global generation:  0.0012521743774414062
r_  generation:  0.010261297225952148
local_output_nid generation:  0.001768350601196289
local_in_edges_tensor generation:  0.0010094642639160156
mini_batch_src_global generation:  0.0012373924255371094
r_  generation:  0.010033369064331055
local_output_nid generation:  0.0017037391662597656
local_in_edges_tensor generation:  0.000982522964477539
mini_batch_src_global generation:  0.0011751651763916016
r_  generation:  0.010123014450073242
local_output_nid generation:  0.0016949176788330078
local_in_edges_tensor generation:  0.0009636878967285156
mini_batch_src_global generation:  0.0012044906616210938
r_  generation:  0.010145425796508789
local_output_nid generation:  0.001734018325805664
local_in_edges_tensor generation:  0.0010304450988769531
mini_batch_src_global generation:  0.001218557357788086
r_  generation:  0.010076045989990234
local_output_nid generation:  0.0017192363739013672
local_in_edges_tensor generation:  0.0009703636169433594
mini_batch_src_global generation:  0.0013277530670166016
r_  generation:  0.010131597518920898
local_output_nid generation:  0.0017244815826416016
local_in_edges_tensor generation:  0.0009696483612060547
mini_batch_src_global generation:  0.0012428760528564453
r_  generation:  0.010006904602050781
local_output_nid generation:  0.0017666816711425781
local_in_edges_tensor generation:  0.0009810924530029297
mini_batch_src_global generation:  0.0011827945709228516
r_  generation:  0.010506153106689453
local_output_nid generation:  0.0017247200012207031
local_in_edges_tensor generation:  0.0009944438934326172
mini_batch_src_global generation:  0.0012638568878173828
r_  generation:  0.010703086853027344
local_output_nid generation:  0.0017418861389160156
local_in_edges_tensor generation:  0.0009551048278808594
mini_batch_src_global generation:  0.0011682510375976562
r_  generation:  0.01041412353515625
local_output_nid generation:  0.001729726791381836
local_in_edges_tensor generation:  0.0009279251098632812
mini_batch_src_global generation:  0.0011169910430908203
r_  generation:  0.00978398323059082
local_output_nid generation:  0.0017037391662597656
local_in_edges_tensor generation:  0.0009684562683105469
mini_batch_src_global generation:  0.0011532306671142578
r_  generation:  0.00991511344909668
local_output_nid generation:  0.001712799072265625
local_in_edges_tensor generation:  0.0009913444519042969
mini_batch_src_global generation:  0.0012426376342773438
r_  generation:  0.010816812515258789
local_output_nid generation:  0.0017445087432861328
local_in_edges_tensor generation:  0.00093841552734375
mini_batch_src_global generation:  0.001135110855102539
r_  generation:  0.010034799575805664
local_output_nid generation:  0.001720428466796875
local_in_edges_tensor generation:  0.0009679794311523438
mini_batch_src_global generation:  0.0011348724365234375
r_  generation:  0.01012563705444336
local_output_nid generation:  0.001728057861328125
local_in_edges_tensor generation:  0.0009353160858154297
mini_batch_src_global generation:  0.001207113265991211
r_  generation:  0.010517120361328125
local_output_nid generation:  0.001737356185913086
local_in_edges_tensor generation:  0.0009729862213134766
mini_batch_src_global generation:  0.0012307167053222656
r_  generation:  0.01074528694152832
local_output_nid generation:  0.0017671585083007812
local_in_edges_tensor generation:  0.0009677410125732422
mini_batch_src_global generation:  0.0011737346649169922
r_  generation:  0.010539531707763672
local_output_nid generation:  0.0017268657684326172
local_in_edges_tensor generation:  0.0009598731994628906
mini_batch_src_global generation:  0.0012621879577636719
r_  generation:  0.010500669479370117
local_output_nid generation:  0.0017440319061279297
local_in_edges_tensor generation:  0.0009834766387939453
mini_batch_src_global generation:  0.0012395381927490234
r_  generation:  0.0108795166015625
local_output_nid generation:  0.001733541488647461
local_in_edges_tensor generation:  0.0009610652923583984
mini_batch_src_global generation:  0.0012121200561523438
r_  generation:  0.011006593704223633
local_output_nid generation:  0.0017976760864257812
local_in_edges_tensor generation:  0.0009899139404296875
mini_batch_src_global generation:  0.0013422966003417969
r_  generation:  0.01042628288269043
local_output_nid generation:  0.001748800277709961
local_in_edges_tensor generation:  0.0009627342224121094
mini_batch_src_global generation:  0.0013782978057861328
r_  generation:  0.010576963424682617
local_output_nid generation:  0.001745462417602539
local_in_edges_tensor generation:  0.0009603500366210938
mini_batch_src_global generation:  0.0012369155883789062
r_  generation:  0.01052093505859375
local_output_nid generation:  0.001766204833984375
local_in_edges_tensor generation:  0.0009512901306152344
mini_batch_src_global generation:  0.0013742446899414062
r_  generation:  0.01067495346069336
local_output_nid generation:  0.0017657279968261719
local_in_edges_tensor generation:  0.0009601116180419922
mini_batch_src_global generation:  0.0013115406036376953
r_  generation:  0.010456085205078125
local_output_nid generation:  0.001720428466796875
local_in_edges_tensor generation:  0.0009362697601318359
mini_batch_src_global generation:  0.0011904239654541016
r_  generation:  0.010400772094726562
local_output_nid generation:  0.0017328262329101562
local_in_edges_tensor generation:  0.0009586811065673828
mini_batch_src_global generation:  0.0011997222900390625
r_  generation:  0.010486602783203125
local_output_nid generation:  0.0017533302307128906
local_in_edges_tensor generation:  0.0009438991546630859
mini_batch_src_global generation:  0.0012233257293701172
r_  generation:  0.010532855987548828
local_output_nid generation:  0.0017156600952148438
local_in_edges_tensor generation:  0.0009250640869140625
mini_batch_src_global generation:  0.001233816146850586
r_  generation:  0.010528326034545898
----------------------check_connections_block total spend ----------------------------- 0.5806074142456055
generate_one_block  0.025199413299560547
generate_one_block  0.021713733673095703
generate_one_block  0.020216941833496094
generate_one_block  0.019103527069091797
generate_one_block  0.019438505172729492
generate_one_block  0.018633365631103516
generate_one_block  0.018449783325195312
generate_one_block  0.018300771713256836
generate_one_block  0.0184171199798584
generate_one_block  0.01890254020690918
generate_one_block  0.019251346588134766
generate_one_block  0.019056081771850586
generate_one_block  0.017385005950927734
generate_one_block  0.017662763595581055
generate_one_block  0.019548416137695312
generate_one_block  0.02069234848022461
generate_one_block  0.018208026885986328
generate_one_block  0.01872110366821289
generate_one_block  0.019300222396850586
generate_one_block  0.018690109252929688
generate_one_block  0.018728971481323242
generate_one_block  0.019397258758544922
generate_one_block  0.019144773483276367
generate_one_block  0.01845526695251465
generate_one_block  0.018470048904418945
generate_one_block  0.01869058609008789
generate_one_block  0.01897883415222168
generate_one_block  0.01839733123779297
generate_one_block  0.018646240234375
generate_one_block  0.018821239471435547
generate_one_block  0.018847227096557617
generate_one_block  0.018390178680419922
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.042253732681274414
gen group dst list time:  0.02191472053527832
time for parepare:  0.01961994171142578
local_output_nid generation:  0.006681203842163086
local_in_edges_tensor generation:  0.014891862869262695
mini_batch_src_global generation:  0.01619744300842285
r_  generation:  0.16382312774658203
local_output_nid generation:  0.00948786735534668
local_in_edges_tensor generation:  0.011434555053710938
mini_batch_src_global generation:  0.020343542098999023
r_  generation:  0.16982054710388184
local_output_nid generation:  0.010376930236816406
local_in_edges_tensor generation:  0.035279273986816406
mini_batch_src_global generation:  0.020122766494750977
r_  generation:  0.18023347854614258
local_output_nid generation:  0.010138273239135742
local_in_edges_tensor generation:  0.00927591323852539
mini_batch_src_global generation:  0.02013707160949707
r_  generation:  0.17360401153564453
local_output_nid generation:  0.010028600692749023
local_in_edges_tensor generation:  0.009871959686279297
mini_batch_src_global generation:  0.02323770523071289
r_  generation:  0.18669605255126953
local_output_nid generation:  0.009559869766235352
local_in_edges_tensor generation:  0.009345054626464844
mini_batch_src_global generation:  0.0220186710357666
r_  generation:  0.17928528785705566
local_output_nid generation:  0.009575843811035156
local_in_edges_tensor generation:  0.010465383529663086
mini_batch_src_global generation:  0.02208399772644043
r_  generation:  0.17946577072143555
local_output_nid generation:  0.009645462036132812
local_in_edges_tensor generation:  0.010420083999633789
mini_batch_src_global generation:  0.021803855895996094
r_  generation:  0.18007802963256836
local_output_nid generation:  0.010089397430419922
local_in_edges_tensor generation:  0.010626077651977539
mini_batch_src_global generation:  0.021864891052246094
r_  generation:  0.17877769470214844
local_output_nid generation:  0.010338544845581055
local_in_edges_tensor generation:  0.010867834091186523
mini_batch_src_global generation:  0.02400684356689453
r_  generation:  0.1855154037475586
local_output_nid generation:  0.010466814041137695
local_in_edges_tensor generation:  0.013852119445800781
mini_batch_src_global generation:  0.024568557739257812
r_  generation:  0.19141030311584473
local_output_nid generation:  0.010200262069702148
local_in_edges_tensor generation:  0.009206056594848633
mini_batch_src_global generation:  0.023006200790405273
r_  generation:  0.18329095840454102
local_output_nid generation:  0.009705781936645508
local_in_edges_tensor generation:  0.009028911590576172
mini_batch_src_global generation:  0.021458148956298828
r_  generation:  0.16911745071411133
local_output_nid generation:  0.009784698486328125
local_in_edges_tensor generation:  0.008844137191772461
mini_batch_src_global generation:  0.021192312240600586
r_  generation:  0.17351961135864258
local_output_nid generation:  0.012014150619506836
local_in_edges_tensor generation:  0.010955333709716797
mini_batch_src_global generation:  0.023231029510498047
r_  generation:  0.19231438636779785
local_output_nid generation:  0.009936809539794922
local_in_edges_tensor generation:  0.008924722671508789
mini_batch_src_global generation:  0.02215266227722168
r_  generation:  0.17583322525024414
local_output_nid generation:  0.009981870651245117
local_in_edges_tensor generation:  0.010310649871826172
mini_batch_src_global generation:  0.022109031677246094
r_  generation:  0.18277907371520996
local_output_nid generation:  0.012692928314208984
local_in_edges_tensor generation:  0.013936281204223633
mini_batch_src_global generation:  0.022992372512817383
r_  generation:  0.1859602928161621
local_output_nid generation:  0.010077714920043945
local_in_edges_tensor generation:  0.012549400329589844
mini_batch_src_global generation:  0.023816823959350586
r_  generation:  0.1943831443786621
local_output_nid generation:  0.009814262390136719
local_in_edges_tensor generation:  0.012271642684936523
mini_batch_src_global generation:  0.023035526275634766
r_  generation:  0.18675708770751953
local_output_nid generation:  0.009814262390136719
local_in_edges_tensor generation:  0.010882139205932617
mini_batch_src_global generation:  0.023059368133544922
r_  generation:  0.18899250030517578
local_output_nid generation:  0.010109186172485352
local_in_edges_tensor generation:  0.010774374008178711
mini_batch_src_global generation:  0.024900436401367188
r_  generation:  0.19094538688659668
local_output_nid generation:  0.01006460189819336
local_in_edges_tensor generation:  0.01068735122680664
mini_batch_src_global generation:  0.023639917373657227
r_  generation:  0.19205284118652344
local_output_nid generation:  0.009798049926757812
local_in_edges_tensor generation:  0.009229421615600586
mini_batch_src_global generation:  0.022857189178466797
r_  generation:  0.1810464859008789
local_output_nid generation:  0.009674787521362305
local_in_edges_tensor generation:  0.009313821792602539
mini_batch_src_global generation:  0.02316761016845703
r_  generation:  0.18876290321350098
local_output_nid generation:  0.00985264778137207
local_in_edges_tensor generation:  0.01222848892211914
mini_batch_src_global generation:  0.023194074630737305
r_  generation:  0.18893957138061523
local_output_nid generation:  0.009918928146362305
local_in_edges_tensor generation:  0.010742902755737305
mini_batch_src_global generation:  0.0229949951171875
r_  generation:  0.18819785118103027
local_output_nid generation:  0.009479284286499023
local_in_edges_tensor generation:  0.010578155517578125
mini_batch_src_global generation:  0.02309250831604004
r_  generation:  0.1844782829284668
local_output_nid generation:  0.009823799133300781
local_in_edges_tensor generation:  0.010899782180786133
mini_batch_src_global generation:  0.02480006217956543
r_  generation:  0.19032812118530273
local_output_nid generation:  0.009779930114746094
local_in_edges_tensor generation:  0.012295007705688477
mini_batch_src_global generation:  0.023483753204345703
r_  generation:  0.18768882751464844
local_output_nid generation:  0.009696722030639648
local_in_edges_tensor generation:  0.010910272598266602
mini_batch_src_global generation:  0.024878263473510742
r_  generation:  0.19002008438110352
local_output_nid generation:  0.009660005569458008
local_in_edges_tensor generation:  0.009407758712768555
mini_batch_src_global generation:  0.022536277770996094
r_  generation:  0.18358063697814941
----------------------check_connections_block total spend ----------------------------- 8.581688165664673
generate_one_block  0.2389051914215088
generate_one_block  0.23700809478759766
generate_one_block  0.24885272979736328
generate_one_block  0.2419729232788086
generate_one_block  0.2814793586730957
generate_one_block  0.24299168586730957
generate_one_block  0.24357914924621582
generate_one_block  0.23868203163146973
generate_one_block  0.24012017250061035
generate_one_block  0.2533745765686035
generate_one_block  0.25461840629577637
generate_one_block  0.2443246841430664
generate_one_block  0.22400379180908203
generate_one_block  0.2281475067138672
generate_one_block  0.2619283199310303
generate_one_block  0.23148488998413086
generate_one_block  0.24152636528015137
generate_one_block  0.25223708152770996
generate_one_block  0.2620694637298584
generate_one_block  0.25684452056884766
generate_one_block  0.2508680820465088
generate_one_block  0.258495569229126
generate_one_block  0.263080358505249
generate_one_block  0.24346399307250977
generate_one_block  0.24605488777160645
generate_one_block  0.2589151859283447
generate_one_block  0.2640502452850342
generate_one_block  0.24586105346679688
generate_one_block  0.25377535820007324
generate_one_block  0.25321030616760254
generate_one_block  0.258960485458374
generate_one_block  0.24577760696411133
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.043649911880493164
gen group dst list time:  0.11240482330322266
time for parepare:  0.017902374267578125
local_output_nid generation:  0.027955293655395508
local_in_edges_tensor generation:  0.04888653755187988
mini_batch_src_global generation:  0.04175257682800293
r_  generation:  0.4258308410644531
local_output_nid generation:  0.03276968002319336
local_in_edges_tensor generation:  0.04696464538574219
mini_batch_src_global generation:  0.05031251907348633
r_  generation:  0.42371201515197754
local_output_nid generation:  0.03161978721618652
local_in_edges_tensor generation:  0.0433046817779541
mini_batch_src_global generation:  0.05804181098937988
r_  generation:  0.43978166580200195
local_output_nid generation:  0.032065391540527344
local_in_edges_tensor generation:  0.032033443450927734
mini_batch_src_global generation:  0.04868602752685547
r_  generation:  0.43297314643859863
local_output_nid generation:  0.03120565414428711
local_in_edges_tensor generation:  0.032068729400634766
mini_batch_src_global generation:  0.049102067947387695
r_  generation:  0.44061756134033203
local_output_nid generation:  0.03085780143737793
local_in_edges_tensor generation:  0.03190255165100098
mini_batch_src_global generation:  0.049820661544799805
r_  generation:  0.4380455017089844
local_output_nid generation:  0.03102397918701172
local_in_edges_tensor generation:  0.032074928283691406
mini_batch_src_global generation:  0.04960775375366211
r_  generation:  0.44102978706359863
local_output_nid generation:  0.03051900863647461
local_in_edges_tensor generation:  0.032018423080444336
mini_batch_src_global generation:  0.04990196228027344
r_  generation:  0.43198633193969727
local_output_nid generation:  0.030740022659301758
local_in_edges_tensor generation:  0.03520035743713379
mini_batch_src_global generation:  0.04958748817443848
r_  generation:  0.4366011619567871
local_output_nid generation:  0.030495643615722656
local_in_edges_tensor generation:  0.028280019760131836
mini_batch_src_global generation:  0.04992198944091797
r_  generation:  0.4361252784729004
local_output_nid generation:  0.0310976505279541
local_in_edges_tensor generation:  0.030551910400390625
mini_batch_src_global generation:  0.05017590522766113
r_  generation:  0.44609498977661133
local_output_nid generation:  0.03098583221435547
local_in_edges_tensor generation:  0.03202223777770996
mini_batch_src_global generation:  0.05080533027648926
r_  generation:  0.453411340713501
local_output_nid generation:  0.030599355697631836
local_in_edges_tensor generation:  0.028767824172973633
mini_batch_src_global generation:  0.0496826171875
r_  generation:  0.43201255798339844
local_output_nid generation:  0.030568838119506836
local_in_edges_tensor generation:  0.03167152404785156
mini_batch_src_global generation:  0.05235004425048828
r_  generation:  0.43135714530944824
local_output_nid generation:  0.031089305877685547
local_in_edges_tensor generation:  0.03984999656677246
mini_batch_src_global generation:  0.050409555435180664
r_  generation:  0.4412558078765869
local_output_nid generation:  0.030739784240722656
local_in_edges_tensor generation:  0.028421640396118164
mini_batch_src_global generation:  0.051579952239990234
r_  generation:  0.43623971939086914
local_output_nid generation:  0.030459880828857422
local_in_edges_tensor generation:  0.03265261650085449
mini_batch_src_global generation:  0.050505876541137695
r_  generation:  0.4369392395019531
local_output_nid generation:  0.030826807022094727
local_in_edges_tensor generation:  0.03688693046569824
mini_batch_src_global generation:  0.05061841011047363
r_  generation:  0.44193315505981445
local_output_nid generation:  0.03105926513671875
local_in_edges_tensor generation:  0.036400794982910156
mini_batch_src_global generation:  0.05182027816772461
r_  generation:  0.44031834602355957
local_output_nid generation:  0.030944347381591797
local_in_edges_tensor generation:  0.028731107711791992
mini_batch_src_global generation:  0.051119327545166016
r_  generation:  0.43616819381713867
local_output_nid generation:  0.0306246280670166
local_in_edges_tensor generation:  0.0283505916595459
mini_batch_src_global generation:  0.05302119255065918
r_  generation:  0.44847750663757324
local_output_nid generation:  0.0307314395904541
local_in_edges_tensor generation:  0.03616070747375488
mini_batch_src_global generation:  0.05055403709411621
r_  generation:  0.43737268447875977
local_output_nid generation:  0.03064894676208496
local_in_edges_tensor generation:  0.03294873237609863
mini_batch_src_global generation:  0.053673744201660156
r_  generation:  0.44783878326416016
local_output_nid generation:  0.030519962310791016
local_in_edges_tensor generation:  0.03076791763305664
mini_batch_src_global generation:  0.05218386650085449
r_  generation:  0.4474525451660156
local_output_nid generation:  0.0302884578704834
local_in_edges_tensor generation:  0.02766704559326172
mini_batch_src_global generation:  0.0505368709564209
r_  generation:  0.43549418449401855
local_output_nid generation:  0.030238866806030273
local_in_edges_tensor generation:  0.031014442443847656
mini_batch_src_global generation:  0.05373096466064453
r_  generation:  0.4429795742034912
local_output_nid generation:  0.030087709426879883
local_in_edges_tensor generation:  0.028818607330322266
mini_batch_src_global generation:  0.05094337463378906
r_  generation:  0.4386711120605469
local_output_nid generation:  0.030060768127441406
local_in_edges_tensor generation:  0.03163266181945801
mini_batch_src_global generation:  0.050898075103759766
r_  generation:  0.4330754280090332
local_output_nid generation:  0.030292034149169922
local_in_edges_tensor generation:  0.041123151779174805
mini_batch_src_global generation:  0.05020737648010254
r_  generation:  0.43954896926879883
local_output_nid generation:  0.030651569366455078
local_in_edges_tensor generation:  0.0328981876373291
mini_batch_src_global generation:  0.05179309844970703
r_  generation:  0.43805456161499023
local_output_nid generation:  0.030787229537963867
local_in_edges_tensor generation:  0.031991004943847656
mini_batch_src_global generation:  0.05321693420410156
r_  generation:  0.4425938129425049
local_output_nid generation:  0.03045511245727539
local_in_edges_tensor generation:  0.028479337692260742
mini_batch_src_global generation:  0.05058550834655762
r_  generation:  0.43870973587036133
----------------------check_connections_block total spend ----------------------------- 20.810700178146362
generate_one_block  0.5983223915100098
generate_one_block  0.5887784957885742
generate_one_block  0.592606782913208
generate_one_block  0.614077091217041
generate_one_block  0.7122354507446289
generate_one_block  0.581756591796875
generate_one_block  0.5804173946380615
generate_one_block  0.5859568119049072
generate_one_block  0.5846543312072754
generate_one_block  0.5915267467498779
generate_one_block  0.6006913185119629
generate_one_block  0.5889623165130615
generate_one_block  0.5704231262207031
generate_one_block  0.5671534538269043
generate_one_block  0.5896551609039307
generate_one_block  0.6293129920959473
generate_one_block  0.6164021492004395
generate_one_block  0.6012930870056152
generate_one_block  0.6025528907775879
generate_one_block  0.5851759910583496
generate_one_block  0.6137971878051758
generate_one_block  0.5939919948577881
generate_one_block  0.5979795455932617
generate_one_block  0.5805377960205078
generate_one_block  0.5972464084625244
generate_one_block  0.6042158603668213
generate_one_block  0.590470552444458
generate_one_block  0.5865447521209717
generate_one_block  0.6043839454650879
generate_one_block  0.5981318950653076
generate_one_block  0.6049764156341553
generate_one_block  0.5887665748596191
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4041748046875 GB
    Memory Allocated: 0.12644243240356445  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

connection checking time:  29.392388343811035
block generation total time  27.10966157913208
average batch blocks generation time:  0.8471769243478775
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4041748046875 GB
    Memory Allocated: 0.10651731491088867  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4041748046875 GB
    Memory Allocated: 18.817087650299072  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4041748046875 GB
    Memory Allocated: 0.10636138916015625  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4041748046875 GB
    Memory Allocated: 18.53400468826294  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4041748046875 GB
    Memory Allocated: 0.10661125183105469  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4803466796875 GB
    Memory Allocated: 19.24558115005493  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4822998046875 GB
    Memory Allocated: 0.10652971267700195  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4822998046875 GB
    Memory Allocated: 18.796647548675537  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4822998046875 GB
    Memory Allocated: 0.10705900192260742  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4822998046875 GB
    Memory Allocated: 19.309791564941406  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4822998046875 GB
    Memory Allocated: 0.10661649703979492  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4901123046875 GB
    Memory Allocated: 18.931678771972656  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4920654296875 GB
    Memory Allocated: 0.10652542114257812  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4920654296875 GB
    Memory Allocated: 18.794228076934814  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4920654296875 GB
    Memory Allocated: 0.10627508163452148  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4920654296875 GB
    Memory Allocated: 18.58169412612915  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4920654296875 GB
    Memory Allocated: 0.1065530776977539  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4920654296875 GB
    Memory Allocated: 18.702730655670166  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4920654296875 GB
    Memory Allocated: 0.10672807693481445  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4920654296875 GB
    Memory Allocated: 19.06669330596924  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4920654296875 GB
    Memory Allocated: 0.10711479187011719  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 19.353577613830566  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.10680055618286133  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 18.98197889328003  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.10602045059204102  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 17.926880359649658  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.10611581802368164  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 18.199142932891846  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.10702800750732422  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 19.388163089752197  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.10622262954711914  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 18.185458183288574  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.10649442672729492  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 18.76529884338379  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.10685300827026367  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 18.995259761810303  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.10706043243408203  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 19.475438117980957  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.1067047119140625  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 18.864156246185303  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.10654211044311523  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 19.02916193008423  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.10655498504638672  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 19.202404975891113  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.10717105865478516  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 19.33406352996826  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.10657739639282227  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 18.757667541503906  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.10630035400390625  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 18.84252405166626  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.10669279098510742  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 18.943256855010986  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.10669183731079102  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 19.029048919677734  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.10631561279296875  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 18.872313022613525  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.10683155059814453  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 19.073776721954346  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.10675954818725586  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 19.111548900604248  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.10703229904174805  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 19.260967254638672  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.10648870468139648  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 18.551262855529785  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.027765929698944092 |0.021790921688079834 |0.5724493786692619 |9.834766387939453e-05 |1.291749581694603 |0.006142139434814453 |
----------------------------------------------------------pseudo_mini_loss sum 3.9399304389953613
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9115346
Number of first layer input nodes during this epoch:  4763753
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.12644529342651367  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024844646453857422
random selection method range initialization spend 0.005555391311645508
time for parepare:  0.020395278930664062
local_output_nid generation:  0.0014672279357910156
local_in_edges_tensor generation:  0.008803367614746094
mini_batch_src_global generation:  0.0016264915466308594
r_  generation:  0.010808229446411133
local_output_nid generation:  0.0018117427825927734
local_in_edges_tensor generation:  0.001096963882446289
mini_batch_src_global generation:  0.0017840862274169922
r_  generation:  0.010457992553710938
local_output_nid generation:  0.001733541488647461
local_in_edges_tensor generation:  0.0009913444519042969
mini_batch_src_global generation:  0.0011186599731445312
r_  generation:  0.009641647338867188
local_output_nid generation:  0.0016498565673828125
local_in_edges_tensor generation:  0.0009579658508300781
mini_batch_src_global generation:  0.001149892807006836
r_  generation:  0.009662151336669922
local_output_nid generation:  0.0016453266143798828
local_in_edges_tensor generation:  0.0009293556213378906
mini_batch_src_global generation:  0.0025212764739990234
r_  generation:  0.0096282958984375
local_output_nid generation:  0.001600503921508789
local_in_edges_tensor generation:  0.0009448528289794922
mini_batch_src_global generation:  0.0012278556823730469
r_  generation:  0.010314226150512695
local_output_nid generation:  0.0016093254089355469
local_in_edges_tensor generation:  0.0009219646453857422
mini_batch_src_global generation:  0.001169443130493164
r_  generation:  0.01007223129272461
local_output_nid generation:  0.0015995502471923828
local_in_edges_tensor generation:  0.0008952617645263672
mini_batch_src_global generation:  0.0011417865753173828
r_  generation:  0.009964227676391602
local_output_nid generation:  0.0016205310821533203
local_in_edges_tensor generation:  0.0009586811065673828
mini_batch_src_global generation:  0.0011970996856689453
r_  generation:  0.010293722152709961
local_output_nid generation:  0.0015859603881835938
local_in_edges_tensor generation:  0.0009257793426513672
mini_batch_src_global generation:  0.0012161731719970703
r_  generation:  0.010540246963500977
local_output_nid generation:  0.0015933513641357422
local_in_edges_tensor generation:  0.0008909702301025391
mini_batch_src_global generation:  0.0011227130889892578
r_  generation:  0.010073184967041016
local_output_nid generation:  0.0015883445739746094
local_in_edges_tensor generation:  0.0009090900421142578
mini_batch_src_global generation:  0.0011761188507080078
r_  generation:  0.00988626480102539
local_output_nid generation:  0.0016028881072998047
local_in_edges_tensor generation:  0.0009036064147949219
mini_batch_src_global generation:  0.0012094974517822266
r_  generation:  0.010413885116577148
local_output_nid generation:  0.0016224384307861328
local_in_edges_tensor generation:  0.0009324550628662109
mini_batch_src_global generation:  0.0011959075927734375
r_  generation:  0.010515451431274414
local_output_nid generation:  0.0016469955444335938
local_in_edges_tensor generation:  0.0009150505065917969
mini_batch_src_global generation:  0.0012493133544921875
r_  generation:  0.010213851928710938
local_output_nid generation:  0.0016024112701416016
local_in_edges_tensor generation:  0.0009074211120605469
mini_batch_src_global generation:  0.0012302398681640625
r_  generation:  0.010236978530883789
local_output_nid generation:  0.0016105175018310547
local_in_edges_tensor generation:  0.0009326934814453125
mini_batch_src_global generation:  0.00127410888671875
r_  generation:  0.010454654693603516
local_output_nid generation:  0.0016014575958251953
local_in_edges_tensor generation:  0.0009331703186035156
mini_batch_src_global generation:  0.001218557357788086
r_  generation:  0.010601043701171875
local_output_nid generation:  0.0015902519226074219
local_in_edges_tensor generation:  0.0008993148803710938
mini_batch_src_global generation:  0.001165628433227539
r_  generation:  0.010234355926513672
local_output_nid generation:  0.001592874526977539
local_in_edges_tensor generation:  0.0008962154388427734
mini_batch_src_global generation:  0.0011637210845947266
r_  generation:  0.010166645050048828
local_output_nid generation:  0.0016095638275146484
local_in_edges_tensor generation:  0.0009500980377197266
mini_batch_src_global generation:  0.0012853145599365234
r_  generation:  0.010528326034545898
local_output_nid generation:  0.001575469970703125
local_in_edges_tensor generation:  0.0009171962738037109
mini_batch_src_global generation:  0.0012383460998535156
r_  generation:  0.010491132736206055
local_output_nid generation:  0.0015838146209716797
local_in_edges_tensor generation:  0.0008838176727294922
mini_batch_src_global generation:  0.0011625289916992188
r_  generation:  0.010109424591064453
local_output_nid generation:  0.0015900135040283203
local_in_edges_tensor generation:  0.0009379386901855469
mini_batch_src_global generation:  0.0011646747589111328
r_  generation:  0.010290145874023438
local_output_nid generation:  0.0016069412231445312
local_in_edges_tensor generation:  0.0008819103240966797
mini_batch_src_global generation:  0.001218557357788086
r_  generation:  0.010300397872924805
local_output_nid generation:  0.0015950202941894531
local_in_edges_tensor generation:  0.0008854866027832031
mini_batch_src_global generation:  0.0011529922485351562
r_  generation:  0.010061025619506836
local_output_nid generation:  0.0015823841094970703
local_in_edges_tensor generation:  0.0009188652038574219
mini_batch_src_global generation:  0.001201629638671875
r_  generation:  0.010230779647827148
local_output_nid generation:  0.0015819072723388672
local_in_edges_tensor generation:  0.0008654594421386719
mini_batch_src_global generation:  0.0011646747589111328
r_  generation:  0.010203838348388672
local_output_nid generation:  0.0015883445739746094
local_in_edges_tensor generation:  0.0009353160858154297
mini_batch_src_global generation:  0.0011920928955078125
r_  generation:  0.010631084442138672
local_output_nid generation:  0.0015938282012939453
local_in_edges_tensor generation:  0.0009217262268066406
mini_batch_src_global generation:  0.0011639595031738281
r_  generation:  0.010027885437011719
local_output_nid generation:  0.0015985965728759766
local_in_edges_tensor generation:  0.0008985996246337891
mini_batch_src_global generation:  0.0011625289916992188
r_  generation:  0.010394811630249023
local_output_nid generation:  0.0015854835510253906
local_in_edges_tensor generation:  0.0009162425994873047
mini_batch_src_global generation:  0.0011658668518066406
r_  generation:  0.010481595993041992
----------------------check_connections_block total spend ----------------------------- 0.5739762783050537
generate_one_block  0.024916887283325195
generate_one_block  0.021522998809814453
generate_one_block  0.018408536911010742
generate_one_block  0.018148183822631836
generate_one_block  0.01805257797241211
generate_one_block  0.018896818161010742
generate_one_block  0.018312931060791016
generate_one_block  0.017932653427124023
generate_one_block  0.01857900619506836
generate_one_block  0.018709421157836914
generate_one_block  0.017926931381225586
generate_one_block  0.01797032356262207
generate_one_block  0.018677473068237305
generate_one_block  0.018749237060546875
generate_one_block  0.018123865127563477
generate_one_block  0.01825404167175293
generate_one_block  0.018228530883789062
generate_one_block  0.018607616424560547
generate_one_block  0.01790165901184082
generate_one_block  0.017899751663208008
generate_one_block  0.018554210662841797
generate_one_block  0.018404483795166016
generate_one_block  0.0179440975189209
generate_one_block  0.0180509090423584
generate_one_block  0.018157482147216797
generate_one_block  0.01769089698791504
generate_one_block  0.018267393112182617
generate_one_block  0.018123149871826172
generate_one_block  0.018686294555664062
generate_one_block  0.017640352249145508
generate_one_block  0.0183103084564209
generate_one_block  0.018514156341552734
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04480290412902832
gen group dst list time:  0.02284550666809082
time for parepare:  0.020524978637695312
local_output_nid generation:  0.006445884704589844
local_in_edges_tensor generation:  0.020956993103027344
mini_batch_src_global generation:  0.016544342041015625
r_  generation:  0.1650855541229248
local_output_nid generation:  0.009025812149047852
local_in_edges_tensor generation:  0.012814998626708984
mini_batch_src_global generation:  0.021047353744506836
r_  generation:  0.17138314247131348
local_output_nid generation:  0.008687734603881836
local_in_edges_tensor generation:  0.03292369842529297
mini_batch_src_global generation:  0.019423484802246094
r_  generation:  0.16449427604675293
local_output_nid generation:  0.009062767028808594
local_in_edges_tensor generation:  0.010241270065307617
mini_batch_src_global generation:  0.019932031631469727
r_  generation:  0.17226672172546387
local_output_nid generation:  0.009253978729248047
local_in_edges_tensor generation:  0.009832620620727539
mini_batch_src_global generation:  0.020865917205810547
r_  generation:  0.1783151626586914
local_output_nid generation:  0.009716510772705078
local_in_edges_tensor generation:  0.010695934295654297
mini_batch_src_global generation:  0.022368192672729492
r_  generation:  0.18806076049804688
local_output_nid generation:  0.009426593780517578
local_in_edges_tensor generation:  0.009559392929077148
mini_batch_src_global generation:  0.022073984146118164
r_  generation:  0.17802166938781738
local_output_nid generation:  0.009000778198242188
local_in_edges_tensor generation:  0.010871410369873047
mini_batch_src_global generation:  0.021746158599853516
r_  generation:  0.176194429397583
local_output_nid generation:  0.009462118148803711
local_in_edges_tensor generation:  0.009545087814331055
mini_batch_src_global generation:  0.022867441177368164
r_  generation:  0.18473148345947266
local_output_nid generation:  0.009413003921508789
local_in_edges_tensor generation:  0.009584426879882812
mini_batch_src_global generation:  0.02263355255126953
r_  generation:  0.18994879722595215
local_output_nid generation:  0.009351968765258789
local_in_edges_tensor generation:  0.009308815002441406
mini_batch_src_global generation:  0.0222780704498291
r_  generation:  0.18026328086853027
local_output_nid generation:  0.00924992561340332
local_in_edges_tensor generation:  0.00940561294555664
mini_batch_src_global generation:  0.021749258041381836
r_  generation:  0.17599058151245117
local_output_nid generation:  0.009674787521362305
local_in_edges_tensor generation:  0.00949406623840332
mini_batch_src_global generation:  0.023001670837402344
r_  generation:  0.18691349029541016
local_output_nid generation:  0.009678125381469727
local_in_edges_tensor generation:  0.011717081069946289
mini_batch_src_global generation:  0.02442002296447754
r_  generation:  0.18976974487304688
local_output_nid generation:  0.010979652404785156
local_in_edges_tensor generation:  0.00953054428100586
mini_batch_src_global generation:  0.023021697998046875
r_  generation:  0.18452167510986328
local_output_nid generation:  0.009552240371704102
local_in_edges_tensor generation:  0.009376049041748047
mini_batch_src_global generation:  0.022936582565307617
r_  generation:  0.18671226501464844
local_output_nid generation:  0.009549856185913086
local_in_edges_tensor generation:  0.00938558578491211
mini_batch_src_global generation:  0.02254939079284668
r_  generation:  0.1811378002166748
local_output_nid generation:  0.009703874588012695
local_in_edges_tensor generation:  0.009602785110473633
mini_batch_src_global generation:  0.02277350425720215
r_  generation:  0.18683290481567383
local_output_nid generation:  0.009304285049438477
local_in_edges_tensor generation:  0.009347915649414062
mini_batch_src_global generation:  0.02183818817138672
r_  generation:  0.1782371997833252
local_output_nid generation:  0.009389877319335938
local_in_edges_tensor generation:  0.009437322616577148
mini_batch_src_global generation:  0.02208685874938965
r_  generation:  0.18076062202453613
local_output_nid generation:  0.009694099426269531
local_in_edges_tensor generation:  0.010723590850830078
mini_batch_src_global generation:  0.030010461807250977
r_  generation:  0.1876683235168457
local_output_nid generation:  0.009638309478759766
local_in_edges_tensor generation:  0.010063648223876953
mini_batch_src_global generation:  0.0230257511138916
r_  generation:  0.18850088119506836
local_output_nid generation:  0.0094451904296875
local_in_edges_tensor generation:  0.009261846542358398
mini_batch_src_global generation:  0.022531509399414062
r_  generation:  0.18310976028442383
local_output_nid generation:  0.009402990341186523
local_in_edges_tensor generation:  0.009112358093261719
mini_batch_src_global generation:  0.022962331771850586
r_  generation:  0.18433618545532227
local_output_nid generation:  0.009516716003417969
local_in_edges_tensor generation:  0.010819673538208008
mini_batch_src_global generation:  0.023255109786987305
r_  generation:  0.18487548828125
local_output_nid generation:  0.009236812591552734
local_in_edges_tensor generation:  0.009248971939086914
mini_batch_src_global generation:  0.022205591201782227
r_  generation:  0.17855167388916016
local_output_nid generation:  0.009451866149902344
local_in_edges_tensor generation:  0.009122133255004883
mini_batch_src_global generation:  0.02485799789428711
r_  generation:  0.18452167510986328
local_output_nid generation:  0.009209871292114258
local_in_edges_tensor generation:  0.009903669357299805
mini_batch_src_global generation:  0.022414684295654297
r_  generation:  0.18376398086547852
local_output_nid generation:  0.009161949157714844
local_in_edges_tensor generation:  0.010069131851196289
mini_batch_src_global generation:  0.023006439208984375
r_  generation:  0.19023656845092773
local_output_nid generation:  0.008891820907592773
local_in_edges_tensor generation:  0.009055137634277344
mini_batch_src_global generation:  0.022737503051757812
r_  generation:  0.17858338356018066
local_output_nid generation:  0.009223222732543945
local_in_edges_tensor generation:  0.010192394256591797
mini_batch_src_global generation:  0.023562908172607422
r_  generation:  0.18899846076965332
local_output_nid generation:  0.009117841720581055
local_in_edges_tensor generation:  0.011396169662475586
mini_batch_src_global generation:  0.02382802963256836
r_  generation:  0.18590354919433594
----------------------check_connections_block total spend ----------------------------- 8.488574743270874
generate_one_block  0.2441868782043457
generate_one_block  0.23749923706054688
generate_one_block  0.22792840003967285
generate_one_block  0.23514318466186523
generate_one_block  0.26407694816589355
generate_one_block  0.24879670143127441
generate_one_block  0.23982501029968262
generate_one_block  0.23205280303955078
generate_one_block  0.24849796295166016
generate_one_block  0.24449586868286133
generate_one_block  0.23703718185424805
generate_one_block  0.23198986053466797
generate_one_block  0.24648666381835938
generate_one_block  0.2539243698120117
generate_one_block  0.2452688217163086
generate_one_block  0.24523234367370605
generate_one_block  0.2360849380493164
generate_one_block  0.2451953887939453
generate_one_block  0.2335832118988037
generate_one_block  0.2418668270111084
generate_one_block  0.24674582481384277
generate_one_block  0.24707651138305664
generate_one_block  0.23857927322387695
generate_one_block  0.2429494857788086
generate_one_block  0.24074792861938477
generate_one_block  0.2325880527496338
generate_one_block  0.24496722221374512
generate_one_block  0.24270296096801758
generate_one_block  0.25341200828552246
generate_one_block  0.23626184463500977
generate_one_block  0.2455611228942871
generate_one_block  0.2478618621826172
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04302239418029785
gen group dst list time:  0.10617184638977051
time for parepare:  0.018282175064086914
local_output_nid generation:  0.02525925636291504
local_in_edges_tensor generation:  0.03909420967102051
mini_batch_src_global generation:  0.03736543655395508
r_  generation:  0.42131805419921875
local_output_nid generation:  0.03133511543273926
local_in_edges_tensor generation:  0.03397059440612793
mini_batch_src_global generation:  0.04950976371765137
r_  generation:  0.4268686771392822
local_output_nid generation:  0.0299072265625
local_in_edges_tensor generation:  0.02821063995361328
mini_batch_src_global generation:  0.04793286323547363
r_  generation:  0.42998170852661133
local_output_nid generation:  0.02934741973876953
local_in_edges_tensor generation:  0.02831411361694336
mini_batch_src_global generation:  0.049259185791015625
r_  generation:  0.4315323829650879
local_output_nid generation:  0.029468059539794922
local_in_edges_tensor generation:  0.030006885528564453
mini_batch_src_global generation:  0.04920816421508789
r_  generation:  0.4328005313873291
local_output_nid generation:  0.029545068740844727
local_in_edges_tensor generation:  0.02877521514892578
mini_batch_src_global generation:  0.052712202072143555
r_  generation:  0.43974852561950684
local_output_nid generation:  0.029923200607299805
local_in_edges_tensor generation:  0.030189990997314453
mini_batch_src_global generation:  0.05032706260681152
r_  generation:  0.4354572296142578
local_output_nid generation:  0.029322385787963867
local_in_edges_tensor generation:  0.028640270233154297
mini_batch_src_global generation:  0.05111241340637207
r_  generation:  0.44115257263183594
local_output_nid generation:  0.02980351448059082
local_in_edges_tensor generation:  0.0267486572265625
mini_batch_src_global generation:  0.05070233345031738
r_  generation:  0.4385385513305664
local_output_nid generation:  0.029414892196655273
local_in_edges_tensor generation:  0.02671337127685547
mini_batch_src_global generation:  0.05113029479980469
r_  generation:  0.4393007755279541
local_output_nid generation:  0.029521465301513672
local_in_edges_tensor generation:  0.03075551986694336
mini_batch_src_global generation:  0.05072903633117676
r_  generation:  0.43885207176208496
local_output_nid generation:  0.029404878616333008
local_in_edges_tensor generation:  0.027478933334350586
mini_batch_src_global generation:  0.05090594291687012
r_  generation:  0.4353930950164795
local_output_nid generation:  0.029543161392211914
local_in_edges_tensor generation:  0.03287076950073242
mini_batch_src_global generation:  0.05221056938171387
r_  generation:  0.44138145446777344
local_output_nid generation:  0.02945399284362793
local_in_edges_tensor generation:  0.030725479125976562
mini_batch_src_global generation:  0.05135989189147949
r_  generation:  0.4439072608947754
local_output_nid generation:  0.029457807540893555
local_in_edges_tensor generation:  0.03165841102600098
mini_batch_src_global generation:  0.050275325775146484
r_  generation:  0.4418609142303467
local_output_nid generation:  0.0317683219909668
local_in_edges_tensor generation:  0.029248952865600586
mini_batch_src_global generation:  0.05102252960205078
r_  generation:  0.44634151458740234
local_output_nid generation:  0.029468297958374023
local_in_edges_tensor generation:  0.027228116989135742
mini_batch_src_global generation:  0.050882577896118164
r_  generation:  0.4423248767852783
local_output_nid generation:  0.02960515022277832
local_in_edges_tensor generation:  0.02837228775024414
mini_batch_src_global generation:  0.05307650566101074
r_  generation:  0.44989585876464844
local_output_nid generation:  0.029886960983276367
local_in_edges_tensor generation:  0.027304649353027344
mini_batch_src_global generation:  0.05032706260681152
r_  generation:  0.4352078437805176
local_output_nid generation:  0.029593229293823242
local_in_edges_tensor generation:  0.027145862579345703
mini_batch_src_global generation:  0.050451040267944336
r_  generation:  0.43941426277160645
local_output_nid generation:  0.02942967414855957
local_in_edges_tensor generation:  0.031054019927978516
mini_batch_src_global generation:  0.050650596618652344
r_  generation:  0.4360201358795166
local_output_nid generation:  0.029722929000854492
local_in_edges_tensor generation:  0.028771400451660156
mini_batch_src_global generation:  0.051503658294677734
r_  generation:  0.4400930404663086
local_output_nid generation:  0.02949690818786621
local_in_edges_tensor generation:  0.03468513488769531
mini_batch_src_global generation:  0.050283193588256836
r_  generation:  0.44911718368530273
local_output_nid generation:  0.029391050338745117
local_in_edges_tensor generation:  0.027092933654785156
mini_batch_src_global generation:  0.05135631561279297
r_  generation:  0.4453890323638916
local_output_nid generation:  0.02961111068725586
local_in_edges_tensor generation:  0.02757859230041504
mini_batch_src_global generation:  0.05083608627319336
r_  generation:  0.43747949600219727
local_output_nid generation:  0.02966618537902832
local_in_edges_tensor generation:  0.029443025588989258
mini_batch_src_global generation:  0.05064225196838379
r_  generation:  0.4439258575439453
local_output_nid generation:  0.029606342315673828
local_in_edges_tensor generation:  0.02899932861328125
mini_batch_src_global generation:  0.052091360092163086
r_  generation:  0.44326114654541016
local_output_nid generation:  0.02977609634399414
local_in_edges_tensor generation:  0.030029296875
mini_batch_src_global generation:  0.05097651481628418
r_  generation:  0.4408397674560547
local_output_nid generation:  0.029982328414916992
local_in_edges_tensor generation:  0.030823230743408203
mini_batch_src_global generation:  0.05031704902648926
r_  generation:  0.4375474452972412
local_output_nid generation:  0.029543638229370117
local_in_edges_tensor generation:  0.027167797088623047
mini_batch_src_global generation:  0.05118513107299805
r_  generation:  0.44104933738708496
local_output_nid generation:  0.0293426513671875
local_in_edges_tensor generation:  0.02657008171081543
mini_batch_src_global generation:  0.05227327346801758
r_  generation:  0.4404420852661133
local_output_nid generation:  0.029827594757080078
local_in_edges_tensor generation:  0.030576467514038086
mini_batch_src_global generation:  0.05126237869262695
r_  generation:  0.4396202564239502
----------------------check_connections_block total spend ----------------------------- 20.656596899032593
generate_one_block  0.5933771133422852
generate_one_block  0.5727150440216064
generate_one_block  0.5671944618225098
generate_one_block  0.5798351764678955
generate_one_block  0.6831326484680176
generate_one_block  0.5867571830749512
generate_one_block  0.5777127742767334
generate_one_block  0.570969820022583
generate_one_block  0.5727334022521973
generate_one_block  0.5796477794647217
generate_one_block  0.5782475471496582
generate_one_block  0.571364164352417
generate_one_block  0.571993350982666
generate_one_block  0.5803215503692627
generate_one_block  0.5778377056121826
generate_one_block  0.5804347991943359
generate_one_block  0.5800042152404785
generate_one_block  0.5865585803985596
generate_one_block  0.5737318992614746
generate_one_block  0.569941520690918
generate_one_block  0.5843086242675781
generate_one_block  0.581963300704956
generate_one_block  0.5827107429504395
generate_one_block  0.5872673988342285
generate_one_block  0.5926828384399414
generate_one_block  0.5748975276947021
generate_one_block  0.5917925834655762
generate_one_block  0.5944168567657471
generate_one_block  0.5948245525360107
generate_one_block  0.5763406753540039
generate_one_block  0.5803191661834717
generate_one_block  0.5969674587249756
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.12644529342651367  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

connection checking time:  29.145171642303467
block generation total time  26.451629161834717
average batch blocks generation time:  0.8266134113073349
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.1065363883972168  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 19.055041313171387  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.10637283325195312  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 18.828805923461914  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.10637617111206055  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 18.34350299835205  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.10625886917114258  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 18.8023099899292  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.10650491714477539  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 18.830459594726562  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.10683059692382812  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 19.356453895568848  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.1067647933959961  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 18.882588386535645  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.1062002182006836  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 18.601778984069824  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.10686063766479492  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 19.208582401275635  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.1066751480102539  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 19.045799255371094  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.10660123825073242  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 18.798458099365234  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.1062612533569336  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 18.452003002166748  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.1067814826965332  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 19.159465789794922  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.10690927505493164  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 19.338823795318604  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.10643672943115234  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 19.045138359069824  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.10688447952270508  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 19.114075183868408  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.1067037582397461  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 18.79240083694458  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.10697650909423828  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 19.083574771881104  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.10643148422241211  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 18.540778160095215  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.1064605712890625  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 18.711670398712158  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.10686397552490234  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 19.120877265930176  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.10678625106811523  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 19.09187602996826  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.10675764083862305  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 18.82337188720703  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.10642814636230469  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 18.940104961395264  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.1065988540649414  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 18.831029891967773  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.10632038116455078  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 18.54975175857544  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.10666656494140625  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 18.95378541946411  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.10694694519042969  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 18.94639539718628  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.10682487487792969  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 19.330655097961426  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.10661029815673828  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 18.67316961288452  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.10651445388793945  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 19.09106159210205  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.1068267822265625  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 18.992243766784668  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.029796212911605835 |0.021304801106452942 |0.5612846538424492 |9.55536961555481e-05 |1.0768180564045906 |0.0058460235595703125 |
----------------------------------------------------------pseudo_mini_loss sum 3.482888698577881
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  9115071
Number of first layer input nodes during this epoch:  4763476
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.1267528533935547  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026178836822509766
random selection method range initialization spend 0.005645751953125
time for parepare:  0.021024703979492188
local_output_nid generation:  0.0013911724090576172
local_in_edges_tensor generation:  0.007039546966552734
mini_batch_src_global generation:  0.0018117427825927734
r_  generation:  0.01052403450012207
local_output_nid generation:  0.0016410350799560547
local_in_edges_tensor generation:  0.0011343955993652344
mini_batch_src_global generation:  0.0015475749969482422
r_  generation:  0.010409832000732422
local_output_nid generation:  0.0016660690307617188
local_in_edges_tensor generation:  0.0009834766387939453
mini_batch_src_global generation:  0.0012145042419433594
r_  generation:  0.00988626480102539
local_output_nid generation:  0.0016300678253173828
local_in_edges_tensor generation:  0.000982046127319336
mini_batch_src_global generation:  0.0011305809020996094
r_  generation:  0.010149717330932617
local_output_nid generation:  0.0016357898712158203
local_in_edges_tensor generation:  0.0009670257568359375
mini_batch_src_global generation:  0.0011417865753173828
r_  generation:  0.009976863861083984
local_output_nid generation:  0.0016295909881591797
local_in_edges_tensor generation:  0.0009517669677734375
mini_batch_src_global generation:  0.0011904239654541016
r_  generation:  0.010149002075195312
local_output_nid generation:  0.001605987548828125
local_in_edges_tensor generation:  0.0009317398071289062
mini_batch_src_global generation:  0.0011219978332519531
r_  generation:  0.010003328323364258
local_output_nid generation:  0.0016095638275146484
local_in_edges_tensor generation:  0.0009336471557617188
mini_batch_src_global generation:  0.0011584758758544922
r_  generation:  0.010255813598632812
local_output_nid generation:  0.001592397689819336
local_in_edges_tensor generation:  0.0009233951568603516
mini_batch_src_global generation:  0.0011157989501953125
r_  generation:  0.010361194610595703
local_output_nid generation:  0.0016071796417236328
local_in_edges_tensor generation:  0.0008838176727294922
mini_batch_src_global generation:  0.0011124610900878906
r_  generation:  0.010544538497924805
local_output_nid generation:  0.0015821456909179688
local_in_edges_tensor generation:  0.0009429454803466797
mini_batch_src_global generation:  0.0011649131774902344
r_  generation:  0.010181427001953125
local_output_nid generation:  0.0016067028045654297
local_in_edges_tensor generation:  0.0009121894836425781
mini_batch_src_global generation:  0.0011565685272216797
r_  generation:  0.010239124298095703
local_output_nid generation:  0.0016338825225830078
local_in_edges_tensor generation:  0.0009219646453857422
mini_batch_src_global generation:  0.0012383460998535156
r_  generation:  0.01065206527709961
local_output_nid generation:  0.0015785694122314453
local_in_edges_tensor generation:  0.0009205341339111328
mini_batch_src_global generation:  0.0012123584747314453
r_  generation:  0.010017156600952148
local_output_nid generation:  0.0016052722930908203
local_in_edges_tensor generation:  0.0009176731109619141
mini_batch_src_global generation:  0.001176595687866211
r_  generation:  0.01051020622253418
local_output_nid generation:  0.0015892982482910156
local_in_edges_tensor generation:  0.0009131431579589844
mini_batch_src_global generation:  0.0011680126190185547
r_  generation:  0.010814905166625977
local_output_nid generation:  0.0016396045684814453
local_in_edges_tensor generation:  0.000919342041015625
mini_batch_src_global generation:  0.0011622905731201172
r_  generation:  0.010256767272949219
local_output_nid generation:  0.0015985965728759766
local_in_edges_tensor generation:  0.0009012222290039062
mini_batch_src_global generation:  0.0011410713195800781
r_  generation:  0.010199546813964844
local_output_nid generation:  0.0015876293182373047
local_in_edges_tensor generation:  0.0008931159973144531
mini_batch_src_global generation:  0.0011479854583740234
r_  generation:  0.010362863540649414
local_output_nid generation:  0.0016045570373535156
local_in_edges_tensor generation:  0.0009207725524902344
mini_batch_src_global generation:  0.0010788440704345703
r_  generation:  0.00995779037475586
local_output_nid generation:  0.001584768295288086
local_in_edges_tensor generation:  0.0009219646453857422
mini_batch_src_global generation:  0.0012326240539550781
r_  generation:  0.010736942291259766
local_output_nid generation:  0.0015821456909179688
local_in_edges_tensor generation:  0.0009160041809082031
mini_batch_src_global generation:  0.001146078109741211
r_  generation:  0.010565757751464844
local_output_nid generation:  0.001619577407836914
local_in_edges_tensor generation:  0.0008881092071533203
mini_batch_src_global generation:  0.0012142658233642578
r_  generation:  0.010474443435668945
local_output_nid generation:  0.0015931129455566406
local_in_edges_tensor generation:  0.0008957386016845703
mini_batch_src_global generation:  0.001127481460571289
r_  generation:  0.010134696960449219
local_output_nid generation:  0.001600027084350586
local_in_edges_tensor generation:  0.0008828639984130859
mini_batch_src_global generation:  0.0011653900146484375
r_  generation:  0.0105438232421875
local_output_nid generation:  0.0016274452209472656
local_in_edges_tensor generation:  0.00087738037109375
mini_batch_src_global generation:  0.0011413097381591797
r_  generation:  0.010130167007446289
local_output_nid generation:  0.0015916824340820312
local_in_edges_tensor generation:  0.0008983612060546875
mini_batch_src_global generation:  0.0011417865753173828
r_  generation:  0.010370969772338867
local_output_nid generation:  0.0015845298767089844
local_in_edges_tensor generation:  0.0008981227874755859
mini_batch_src_global generation:  0.0011560916900634766
r_  generation:  0.010377883911132812
local_output_nid generation:  0.0016224384307861328
local_in_edges_tensor generation:  0.0008935928344726562
mini_batch_src_global generation:  0.001127004623413086
r_  generation:  0.010312557220458984
local_output_nid generation:  0.0016031265258789062
local_in_edges_tensor generation:  0.0008845329284667969
mini_batch_src_global generation:  0.0011184215545654297
r_  generation:  0.010094642639160156
local_output_nid generation:  0.0015749931335449219
local_in_edges_tensor generation:  0.0009033679962158203
mini_batch_src_global generation:  0.0011794567108154297
r_  generation:  0.010473966598510742
local_output_nid generation:  0.0015904903411865234
local_in_edges_tensor generation:  0.0008904933929443359
mini_batch_src_global generation:  0.0011034011840820312
r_  generation:  0.010290145874023438
----------------------check_connections_block total spend ----------------------------- 0.5711414813995361
generate_one_block  0.025235652923583984
generate_one_block  0.021271467208862305
generate_one_block  0.0191195011138916
generate_one_block  0.018886804580688477
generate_one_block  0.018332481384277344
generate_one_block  0.018660783767700195
generate_one_block  0.018288850784301758
generate_one_block  0.01847219467163086
generate_one_block  0.018462419509887695
generate_one_block  0.01845240592956543
generate_one_block  0.017658710479736328
generate_one_block  0.01834893226623535
generate_one_block  0.018806934356689453
generate_one_block  0.017522096633911133
generate_one_block  0.018747568130493164
generate_one_block  0.01855015754699707
generate_one_block  0.018038034439086914
generate_one_block  0.017937421798706055
generate_one_block  0.018402099609375
generate_one_block  0.0174562931060791
generate_one_block  0.01885223388671875
generate_one_block  0.018563270568847656
generate_one_block  0.018342971801757812
generate_one_block  0.018015623092651367
generate_one_block  0.018647432327270508
generate_one_block  0.01779913902282715
generate_one_block  0.0181427001953125
generate_one_block  0.0179746150970459
generate_one_block  0.018001794815063477
generate_one_block  0.01773977279663086
generate_one_block  0.018423795700073242
generate_one_block  0.01797199249267578
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04172253608703613
gen group dst list time:  0.023333072662353516
time for parepare:  0.01951146125793457
local_output_nid generation:  0.0062639713287353516
local_in_edges_tensor generation:  0.01995849609375
mini_batch_src_global generation:  0.01627659797668457
r_  generation:  0.16049695014953613
local_output_nid generation:  0.008733272552490234
local_in_edges_tensor generation:  0.012412071228027344
mini_batch_src_global generation:  0.027109384536743164
r_  generation:  0.16511082649230957
local_output_nid generation:  0.010418891906738281
local_in_edges_tensor generation:  0.03660082817077637
mini_batch_src_global generation:  0.027678489685058594
r_  generation:  0.17177772521972656
local_output_nid generation:  0.009540319442749023
local_in_edges_tensor generation:  0.010068893432617188
mini_batch_src_global generation:  0.02027273178100586
r_  generation:  0.17636418342590332
local_output_nid generation:  0.009404182434082031
local_in_edges_tensor generation:  0.00915980339050293
mini_batch_src_global generation:  0.021427631378173828
r_  generation:  0.1768803596496582
local_output_nid generation:  0.009389638900756836
local_in_edges_tensor generation:  0.010541677474975586
mini_batch_src_global generation:  0.02195000648498535
r_  generation:  0.1808023452758789
local_output_nid generation:  0.008895635604858398
local_in_edges_tensor generation:  0.009003877639770508
mini_batch_src_global generation:  0.02188420295715332
r_  generation:  0.17693424224853516
local_output_nid generation:  0.009128808975219727
local_in_edges_tensor generation:  0.009896039962768555
mini_batch_src_global generation:  0.02409505844116211
r_  generation:  0.18335556983947754
local_output_nid generation:  0.009244680404663086
local_in_edges_tensor generation:  0.009335517883300781
mini_batch_src_global generation:  0.022568464279174805
r_  generation:  0.17974138259887695
local_output_nid generation:  0.00964498519897461
local_in_edges_tensor generation:  0.009590864181518555
mini_batch_src_global generation:  0.026451826095581055
r_  generation:  0.1847515106201172
local_output_nid generation:  0.009124279022216797
local_in_edges_tensor generation:  0.009025812149047852
mini_batch_src_global generation:  0.02167677879333496
r_  generation:  0.17448735237121582
local_output_nid generation:  0.009283304214477539
local_in_edges_tensor generation:  0.009000062942504883
mini_batch_src_global generation:  0.02232527732849121
r_  generation:  0.18424391746520996
local_output_nid generation:  0.00972437858581543
local_in_edges_tensor generation:  0.00923466682434082
mini_batch_src_global generation:  0.023452281951904297
r_  generation:  0.18897271156311035
local_output_nid generation:  0.009012699127197266
local_in_edges_tensor generation:  0.009570598602294922
mini_batch_src_global generation:  0.022011280059814453
r_  generation:  0.17453765869140625
local_output_nid generation:  0.009532690048217773
local_in_edges_tensor generation:  0.008887052536010742
mini_batch_src_global generation:  0.022803306579589844
r_  generation:  0.1826610565185547
local_output_nid generation:  0.009457111358642578
local_in_edges_tensor generation:  0.009123563766479492
mini_batch_src_global generation:  0.02263021469116211
r_  generation:  0.18393826484680176
local_output_nid generation:  0.009339094161987305
local_in_edges_tensor generation:  0.009642362594604492
mini_batch_src_global generation:  0.023714542388916016
r_  generation:  0.18025994300842285
local_output_nid generation:  0.009357690811157227
local_in_edges_tensor generation:  0.008727073669433594
mini_batch_src_global generation:  0.02264571189880371
r_  generation:  0.18355703353881836
local_output_nid generation:  0.009500265121459961
local_in_edges_tensor generation:  0.009680032730102539
mini_batch_src_global generation:  0.023810386657714844
r_  generation:  0.1832585334777832
local_output_nid generation:  0.009132623672485352
local_in_edges_tensor generation:  0.008638620376586914
mini_batch_src_global generation:  0.02211904525756836
r_  generation:  0.1759347915649414
local_output_nid generation:  0.009674787521362305
local_in_edges_tensor generation:  0.009129047393798828
mini_batch_src_global generation:  0.02415180206298828
r_  generation:  0.18973350524902344
local_output_nid generation:  0.00928640365600586
local_in_edges_tensor generation:  0.009096384048461914
mini_batch_src_global generation:  0.02330803871154785
r_  generation:  0.18692851066589355
local_output_nid generation:  0.009238481521606445
local_in_edges_tensor generation:  0.00962972640991211
mini_batch_src_global generation:  0.023192167282104492
r_  generation:  0.18102622032165527
local_output_nid generation:  0.009401559829711914
local_in_edges_tensor generation:  0.008912086486816406
mini_batch_src_global generation:  0.022495746612548828
r_  generation:  0.17664885520935059
local_output_nid generation:  0.00959324836730957
local_in_edges_tensor generation:  0.008859634399414062
mini_batch_src_global generation:  0.023981094360351562
r_  generation:  0.18508243560791016
local_output_nid generation:  0.009253263473510742
local_in_edges_tensor generation:  0.008826494216918945
mini_batch_src_global generation:  0.022672414779663086
r_  generation:  0.18085479736328125
local_output_nid generation:  0.00937652587890625
local_in_edges_tensor generation:  0.008869171142578125
mini_batch_src_global generation:  0.02340078353881836
r_  generation:  0.18160629272460938
local_output_nid generation:  0.009408950805664062
local_in_edges_tensor generation:  0.009382486343383789
mini_batch_src_global generation:  0.022867679595947266
r_  generation:  0.1834700107574463
local_output_nid generation:  0.009244918823242188
local_in_edges_tensor generation:  0.008871078491210938
mini_batch_src_global generation:  0.022814512252807617
r_  generation:  0.18114829063415527
local_output_nid generation:  0.009176492691040039
local_in_edges_tensor generation:  0.00868678092956543
mini_batch_src_global generation:  0.022623777389526367
r_  generation:  0.18134689331054688
local_output_nid generation:  0.00962066650390625
local_in_edges_tensor generation:  0.00878763198852539
mini_batch_src_global generation:  0.022661447525024414
r_  generation:  0.18310952186584473
local_output_nid generation:  0.009284257888793945
local_in_edges_tensor generation:  0.009014606475830078
mini_batch_src_global generation:  0.023831844329833984
r_  generation:  0.18311071395874023
----------------------check_connections_block total spend ----------------------------- 8.428653478622437
generate_one_block  0.24413371086120605
generate_one_block  0.23251080513000488
generate_one_block  0.24258971214294434
generate_one_block  0.24178719520568848
generate_one_block  0.2726306915283203
generate_one_block  0.24303889274597168
generate_one_block  0.24190068244934082
generate_one_block  0.24808907508850098
generate_one_block  0.24342775344848633
generate_one_block  0.24772024154663086
generate_one_block  0.23273801803588867
generate_one_block  0.24379563331604004
generate_one_block  0.2583332061767578
generate_one_block  0.2301790714263916
generate_one_block  0.2445385456085205
generate_one_block  0.24486470222473145
generate_one_block  0.25101304054260254
generate_one_block  0.2425704002380371
generate_one_block  0.2530333995819092
generate_one_block  0.24256134033203125
generate_one_block  0.2536594867706299
generate_one_block  0.24892520904541016
generate_one_block  0.2450120449066162
generate_one_block  0.23572039604187012
generate_one_block  0.25109195709228516
generate_one_block  0.23748159408569336
generate_one_block  0.24474406242370605
generate_one_block  0.24143409729003906
generate_one_block  0.2403717041015625
generate_one_block  0.23960137367248535
generate_one_block  0.2467060089111328
generate_one_block  0.2362058162689209
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03601527214050293
gen group dst list time:  0.10990381240844727
time for parepare:  0.0201873779296875
local_output_nid generation:  0.026713132858276367
local_in_edges_tensor generation:  0.046010494232177734
mini_batch_src_global generation:  0.044696807861328125
r_  generation:  0.42045116424560547
local_output_nid generation:  0.031463623046875
local_in_edges_tensor generation:  0.038912057876586914
mini_batch_src_global generation:  0.0535280704498291
r_  generation:  0.4185030460357666
local_output_nid generation:  0.03305983543395996
local_in_edges_tensor generation:  0.03165292739868164
mini_batch_src_global generation:  0.04819369316101074
r_  generation:  0.4336256980895996
local_output_nid generation:  0.029822826385498047
local_in_edges_tensor generation:  0.03150486946105957
mini_batch_src_global generation:  0.05321335792541504
r_  generation:  0.4322338104248047
local_output_nid generation:  0.029334545135498047
local_in_edges_tensor generation:  0.02776360511779785
mini_batch_src_global generation:  0.049230337142944336
r_  generation:  0.4379894733428955
local_output_nid generation:  0.030301809310913086
local_in_edges_tensor generation:  0.02767157554626465
mini_batch_src_global generation:  0.06381964683532715
r_  generation:  0.43648338317871094
local_output_nid generation:  0.029631376266479492
local_in_edges_tensor generation:  0.02811741828918457
mini_batch_src_global generation:  0.04934811592102051
r_  generation:  0.4421999454498291
local_output_nid generation:  0.02982163429260254
local_in_edges_tensor generation:  0.027519941329956055
mini_batch_src_global generation:  0.05485224723815918
r_  generation:  0.4365074634552002
local_output_nid generation:  0.02981090545654297
local_in_edges_tensor generation:  0.02773427963256836
mini_batch_src_global generation:  0.04924893379211426
r_  generation:  0.4407989978790283
local_output_nid generation:  0.029868125915527344
local_in_edges_tensor generation:  0.031267642974853516
mini_batch_src_global generation:  0.05073404312133789
r_  generation:  0.4445927143096924
local_output_nid generation:  0.03297591209411621
local_in_edges_tensor generation:  0.028895854949951172
mini_batch_src_global generation:  0.05517721176147461
r_  generation:  0.4385566711425781
local_output_nid generation:  0.02922821044921875
local_in_edges_tensor generation:  0.028959989547729492
mini_batch_src_global generation:  0.05216860771179199
r_  generation:  0.436722993850708
local_output_nid generation:  0.029562950134277344
local_in_edges_tensor generation:  0.028125762939453125
mini_batch_src_global generation:  0.04911637306213379
r_  generation:  0.4549708366394043
local_output_nid generation:  0.0319821834564209
local_in_edges_tensor generation:  0.027271509170532227
mini_batch_src_global generation:  0.05165863037109375
r_  generation:  0.43137359619140625
local_output_nid generation:  0.03050518035888672
local_in_edges_tensor generation:  0.030251264572143555
mini_batch_src_global generation:  0.051107168197631836
r_  generation:  0.44440555572509766
local_output_nid generation:  0.030605554580688477
local_in_edges_tensor generation:  0.03263592720031738
mini_batch_src_global generation:  0.050406694412231445
r_  generation:  0.4378533363342285
local_output_nid generation:  0.03037238121032715
local_in_edges_tensor generation:  0.029106855392456055
mini_batch_src_global generation:  0.049874067306518555
r_  generation:  0.43837904930114746
local_output_nid generation:  0.03002452850341797
local_in_edges_tensor generation:  0.02708601951599121
mini_batch_src_global generation:  0.05047273635864258
r_  generation:  0.436779260635376
local_output_nid generation:  0.030534744262695312
local_in_edges_tensor generation:  0.0279998779296875
mini_batch_src_global generation:  0.049421072006225586
r_  generation:  0.4387805461883545
local_output_nid generation:  0.02997756004333496
local_in_edges_tensor generation:  0.02927422523498535
mini_batch_src_global generation:  0.05120086669921875
r_  generation:  0.43372178077697754
local_output_nid generation:  0.030173540115356445
local_in_edges_tensor generation:  0.03159904479980469
mini_batch_src_global generation:  0.052184104919433594
r_  generation:  0.4577159881591797
local_output_nid generation:  0.030564308166503906
local_in_edges_tensor generation:  0.029097795486450195
mini_batch_src_global generation:  0.05141329765319824
r_  generation:  0.4364643096923828
local_output_nid generation:  0.030483007431030273
local_in_edges_tensor generation:  0.03125739097595215
mini_batch_src_global generation:  0.0500180721282959
r_  generation:  0.4370260238647461
local_output_nid generation:  0.030461788177490234
local_in_edges_tensor generation:  0.027437925338745117
mini_batch_src_global generation:  0.05509376525878906
r_  generation:  0.43412208557128906
local_output_nid generation:  0.030170917510986328
local_in_edges_tensor generation:  0.02738189697265625
mini_batch_src_global generation:  0.04987144470214844
r_  generation:  0.43747806549072266
local_output_nid generation:  0.03017139434814453
local_in_edges_tensor generation:  0.027858495712280273
mini_batch_src_global generation:  0.0515294075012207
r_  generation:  0.43944501876831055
local_output_nid generation:  0.030063867568969727
local_in_edges_tensor generation:  0.029110431671142578
mini_batch_src_global generation:  0.05228018760681152
r_  generation:  0.4371647834777832
local_output_nid generation:  0.030167341232299805
local_in_edges_tensor generation:  0.02776932716369629
mini_batch_src_global generation:  0.051259517669677734
r_  generation:  0.43468618392944336
local_output_nid generation:  0.030400514602661133
local_in_edges_tensor generation:  0.029528141021728516
mini_batch_src_global generation:  0.05022287368774414
r_  generation:  0.43935132026672363
local_output_nid generation:  0.03094339370727539
local_in_edges_tensor generation:  0.03169131278991699
mini_batch_src_global generation:  0.051741600036621094
r_  generation:  0.4333052635192871
local_output_nid generation:  0.030174970626831055
local_in_edges_tensor generation:  0.032022953033447266
mini_batch_src_global generation:  0.05079770088195801
r_  generation:  0.4432041645050049
local_output_nid generation:  0.03000950813293457
local_in_edges_tensor generation:  0.027601003646850586
mini_batch_src_global generation:  0.05061459541320801
r_  generation:  0.4348163604736328
----------------------check_connections_block total spend ----------------------------- 20.692405462265015
generate_one_block  0.5799367427825928
generate_one_block  0.5815503597259521
generate_one_block  0.5746772289276123
generate_one_block  0.5880684852600098
generate_one_block  0.6745843887329102
generate_one_block  0.589214563369751
generate_one_block  0.5813369750976562
generate_one_block  0.5847668647766113
generate_one_block  0.5758075714111328
generate_one_block  0.5811522006988525
generate_one_block  0.573408842086792
generate_one_block  0.5746309757232666
generate_one_block  0.588714599609375
generate_one_block  0.5715951919555664
generate_one_block  0.5748755931854248
generate_one_block  0.5862550735473633
generate_one_block  0.5863664150238037
generate_one_block  0.5719313621520996
generate_one_block  0.5802562236785889
generate_one_block  0.5762825012207031
generate_one_block  0.5845811367034912
generate_one_block  0.5896313190460205
generate_one_block  0.579359769821167
generate_one_block  0.5773310661315918
generate_one_block  0.599529504776001
generate_one_block  0.5822420120239258
generate_one_block  0.5843982696533203
generate_one_block  0.577958345413208
generate_one_block  0.5743229389190674
generate_one_block  0.5838429927825928
generate_one_block  0.5824251174926758
generate_one_block  0.586200475692749
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.1267528533935547  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

connection checking time:  29.12105894088745
block generation total time  26.51964497566223
average batch blocks generation time:  0.8287389054894447
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.10655689239501953  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 18.838443279266357  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.10645103454589844  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 18.521012783050537  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.10666847229003906  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 18.986628532409668  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.10669755935668945  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 19.03513765335083  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1424560546875 GB
    Memory Allocated: 0.10644054412841797  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1444091796875 GB
    Memory Allocated: 19.00827121734619  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 0.10716533660888672  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 19.09150981903076  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 0.10669183731079102  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 18.99598455429077  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 0.10686779022216797  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 19.232713222503662  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 0.10670804977416992  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 18.985005855560303  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 0.1067962646484375  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 19.215768337249756  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 0.10649871826171875  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 18.572911739349365  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 0.10641813278198242  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 19.01872968673706  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 0.10692167282104492  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 19.500964641571045  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 0.10618734359741211  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 18.275485038757324  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 0.10688924789428711  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 19.146942615509033  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 0.10672998428344727  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 19.03721809387207  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 0.10681486129760742  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 18.9752459526062  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 0.10627555847167969  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 18.92021083831787  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 0.10688018798828125  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 19.06863260269165  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 0.10611534118652344  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 18.48553705215454  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 0.10695457458496094  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 19.361036777496338  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 0.10685157775878906  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 19.163922786712646  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 0.10650253295898438  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 18.833237171173096  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 0.10651826858520508  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 18.519888877868652  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 0.10660171508789062  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 19.116426944732666  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 0.10656118392944336  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 18.72080135345459  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 0.10654926300048828  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 18.96129274368286  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 0.10659217834472656  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 18.866028308868408  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 0.1065983772277832  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 18.850639820098877  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 0.10666370391845703  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 18.836122035980225  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 0.10662269592285156  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 19.028423309326172  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 0.10653877258300781  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 18.660563468933105  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03476563096046448 |0.02187221497297287 |0.5567134022712708 |9.47713851928711e-05 |1.0726547092199326 |0.013136863708496094 |
----------------------------------------------------------pseudo_mini_loss sum 2.786607027053833
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  9118184
Number of first layer input nodes during this epoch:  4763497
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 0.1263589859008789  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025524377822875977
random selection method range initialization spend 0.005101442337036133
time for parepare:  0.01919722557067871
local_output_nid generation:  0.0014109611511230469
local_in_edges_tensor generation:  0.004398345947265625
mini_batch_src_global generation:  0.0019314289093017578
r_  generation:  0.011291742324829102
local_output_nid generation:  0.001982450485229492
local_in_edges_tensor generation:  0.0012662410736083984
mini_batch_src_global generation:  0.0014333724975585938
r_  generation:  0.012731552124023438
local_output_nid generation:  0.0016970634460449219
local_in_edges_tensor generation:  0.0012214183807373047
mini_batch_src_global generation:  0.0014514923095703125
r_  generation:  0.010026693344116211
local_output_nid generation:  0.0016064643859863281
local_in_edges_tensor generation:  0.0010297298431396484
mini_batch_src_global generation:  0.0011789798736572266
r_  generation:  0.009935855865478516
local_output_nid generation:  0.001577138900756836
local_in_edges_tensor generation:  0.0009846687316894531
mini_batch_src_global generation:  0.0012655258178710938
r_  generation:  0.010041952133178711
local_output_nid generation:  0.0015995502471923828
local_in_edges_tensor generation:  0.0009989738464355469
mini_batch_src_global generation:  0.001188516616821289
r_  generation:  0.01031947135925293
local_output_nid generation:  0.0015873908996582031
local_in_edges_tensor generation:  0.0010445117950439453
mini_batch_src_global generation:  0.001207590103149414
r_  generation:  0.010632753372192383
local_output_nid generation:  0.0015864372253417969
local_in_edges_tensor generation:  0.0009434223175048828
mini_batch_src_global generation:  0.0011959075927734375
r_  generation:  0.010206937789916992
local_output_nid generation:  0.0015606880187988281
local_in_edges_tensor generation:  0.0009412765502929688
mini_batch_src_global generation:  0.0011572837829589844
r_  generation:  0.010494232177734375
local_output_nid generation:  0.0015749931335449219
local_in_edges_tensor generation:  0.0008909702301025391
mini_batch_src_global generation:  0.0011992454528808594
r_  generation:  0.010269403457641602
local_output_nid generation:  0.0015854835510253906
local_in_edges_tensor generation:  0.0010471343994140625
mini_batch_src_global generation:  0.0012106895446777344
r_  generation:  0.0107574462890625
local_output_nid generation:  0.001581430435180664
local_in_edges_tensor generation:  0.0009179115295410156
mini_batch_src_global generation:  0.0012404918670654297
r_  generation:  0.010592222213745117
local_output_nid generation:  0.0016012191772460938
local_in_edges_tensor generation:  0.0009293556213378906
mini_batch_src_global generation:  0.0011761188507080078
r_  generation:  0.010250091552734375
local_output_nid generation:  0.001630544662475586
local_in_edges_tensor generation:  0.0009129047393798828
mini_batch_src_global generation:  0.0012173652648925781
r_  generation:  0.0104522705078125
local_output_nid generation:  0.0015940666198730469
local_in_edges_tensor generation:  0.0009732246398925781
mini_batch_src_global generation:  0.0011954307556152344
r_  generation:  0.010599851608276367
local_output_nid generation:  0.0015742778778076172
local_in_edges_tensor generation:  0.0009140968322753906
mini_batch_src_global generation:  0.0011551380157470703
r_  generation:  0.010504961013793945
local_output_nid generation:  0.0016162395477294922
local_in_edges_tensor generation:  0.0009276866912841797
mini_batch_src_global generation:  0.0011608600616455078
r_  generation:  0.010448217391967773
local_output_nid generation:  0.0015854835510253906
local_in_edges_tensor generation:  0.0010256767272949219
mini_batch_src_global generation:  0.0012714862823486328
r_  generation:  0.01088094711303711
local_output_nid generation:  0.0015828609466552734
local_in_edges_tensor generation:  0.0009160041809082031
mini_batch_src_global generation:  0.0011985301971435547
r_  generation:  0.010313272476196289
local_output_nid generation:  0.0015964508056640625
local_in_edges_tensor generation:  0.0009188652038574219
mini_batch_src_global generation:  0.0011339187622070312
r_  generation:  0.01039433479309082
local_output_nid generation:  0.0015759468078613281
local_in_edges_tensor generation:  0.0009431838989257812
mini_batch_src_global generation:  0.001201629638671875
r_  generation:  0.010299921035766602
local_output_nid generation:  0.0015811920166015625
local_in_edges_tensor generation:  0.0009076595306396484
mini_batch_src_global generation:  0.0011806488037109375
r_  generation:  0.010373830795288086
local_output_nid generation:  0.001575469970703125
local_in_edges_tensor generation:  0.0009119510650634766
mini_batch_src_global generation:  0.001153707504272461
r_  generation:  0.01005244255065918
local_output_nid generation:  0.0015866756439208984
local_in_edges_tensor generation:  0.00095367431640625
mini_batch_src_global generation:  0.0012559890747070312
r_  generation:  0.01018834114074707
local_output_nid generation:  0.0015995502471923828
local_in_edges_tensor generation:  0.000990152359008789
mini_batch_src_global generation:  0.0012400150299072266
r_  generation:  0.010473489761352539
local_output_nid generation:  0.0015873908996582031
local_in_edges_tensor generation:  0.0010013580322265625
mini_batch_src_global generation:  0.001142263412475586
r_  generation:  0.010228395462036133
local_output_nid generation:  0.0016155242919921875
local_in_edges_tensor generation:  0.0009777545928955078
mini_batch_src_global generation:  0.0012402534484863281
r_  generation:  0.010427474975585938
local_output_nid generation:  0.0015802383422851562
local_in_edges_tensor generation:  0.0009391307830810547
mini_batch_src_global generation:  0.0012133121490478516
r_  generation:  0.01025843620300293
local_output_nid generation:  0.0015952587127685547
local_in_edges_tensor generation:  0.0009343624114990234
mini_batch_src_global generation:  0.001142740249633789
r_  generation:  0.010440349578857422
local_output_nid generation:  0.0016133785247802734
local_in_edges_tensor generation:  0.0009245872497558594
mini_batch_src_global generation:  0.0011754035949707031
r_  generation:  0.010089874267578125
local_output_nid generation:  0.001567840576171875
local_in_edges_tensor generation:  0.0009238719940185547
mini_batch_src_global generation:  0.0011777877807617188
r_  generation:  0.010591745376586914
local_output_nid generation:  0.0015895366668701172
local_in_edges_tensor generation:  0.0009031295776367188
mini_batch_src_global generation:  0.001096963882446289
r_  generation:  0.010083436965942383
----------------------check_connections_block total spend ----------------------------- 0.5765807628631592
generate_one_block  0.03332996368408203
generate_one_block  0.023421764373779297
generate_one_block  0.020914554595947266
generate_one_block  0.01898932456970215
generate_one_block  0.020971059799194336
generate_one_block  0.018931150436401367
generate_one_block  0.01883840560913086
generate_one_block  0.018446683883666992
generate_one_block  0.018634319305419922
generate_one_block  0.018445968627929688
generate_one_block  0.021762609481811523
generate_one_block  0.0188291072845459
generate_one_block  0.01818561553955078
generate_one_block  0.018659114837646484
generate_one_block  0.018727779388427734
generate_one_block  0.02058124542236328
generate_one_block  0.01842331886291504
generate_one_block  0.01933741569519043
generate_one_block  0.018224477767944336
generate_one_block  0.0183255672454834
generate_one_block  0.01815176010131836
generate_one_block  0.020377635955810547
generate_one_block  0.017844200134277344
generate_one_block  0.018040895462036133
generate_one_block  0.018840312957763672
generate_one_block  0.018166065216064453
generate_one_block  0.02071404457092285
generate_one_block  0.01827239990234375
generate_one_block  0.01840686798095703
generate_one_block  0.017776966094970703
generate_one_block  0.01876521110534668
generate_one_block  0.017637014389038086
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04103851318359375
gen group dst list time:  0.022811412811279297
time for parepare:  0.023598909378051758
local_output_nid generation:  0.006738901138305664
local_in_edges_tensor generation:  0.018497705459594727
mini_batch_src_global generation:  0.019396543502807617
r_  generation:  0.17577362060546875
local_output_nid generation:  0.011923789978027344
local_in_edges_tensor generation:  0.013239383697509766
mini_batch_src_global generation:  0.02351069450378418
r_  generation:  0.18817996978759766
local_output_nid generation:  0.009673833847045898
local_in_edges_tensor generation:  0.038176774978637695
mini_batch_src_global generation:  0.02017498016357422
r_  generation:  0.1748523712158203
local_output_nid generation:  0.009513139724731445
local_in_edges_tensor generation:  0.011770009994506836
mini_batch_src_global generation:  0.02064967155456543
r_  generation:  0.17619109153747559
local_output_nid generation:  0.009453773498535156
local_in_edges_tensor generation:  0.012371301651000977
mini_batch_src_global generation:  0.022319793701171875
r_  generation:  0.17625737190246582
local_output_nid generation:  0.00917196273803711
local_in_edges_tensor generation:  0.00993490219116211
mini_batch_src_global generation:  0.021457195281982422
r_  generation:  0.1769392490386963
local_output_nid generation:  0.009026288986206055
local_in_edges_tensor generation:  0.009525537490844727
mini_batch_src_global generation:  0.02257847785949707
r_  generation:  0.1845231056213379
local_output_nid generation:  0.009010553359985352
local_in_edges_tensor generation:  0.009549856185913086
mini_batch_src_global generation:  0.022748708724975586
r_  generation:  0.1810436248779297
local_output_nid generation:  0.008925199508666992
local_in_edges_tensor generation:  0.009250640869140625
mini_batch_src_global generation:  0.022215604782104492
r_  generation:  0.18105840682983398
local_output_nid generation:  0.009132862091064453
local_in_edges_tensor generation:  0.009419441223144531
mini_batch_src_global generation:  0.022340774536132812
r_  generation:  0.1818983554840088
local_output_nid generation:  0.009686470031738281
local_in_edges_tensor generation:  0.00901937484741211
mini_batch_src_global generation:  0.023591279983520508
r_  generation:  0.1878962516784668
local_output_nid generation:  0.009493112564086914
local_in_edges_tensor generation:  0.009236574172973633
mini_batch_src_global generation:  0.023043155670166016
r_  generation:  0.18471455574035645
local_output_nid generation:  0.009411811828613281
local_in_edges_tensor generation:  0.011635303497314453
mini_batch_src_global generation:  0.022731542587280273
r_  generation:  0.1827409267425537
local_output_nid generation:  0.009463310241699219
local_in_edges_tensor generation:  0.009200811386108398
mini_batch_src_global generation:  0.023061513900756836
r_  generation:  0.18497633934020996
local_output_nid generation:  0.009590864181518555
local_in_edges_tensor generation:  0.009874582290649414
mini_batch_src_global generation:  0.022876262664794922
r_  generation:  0.18657755851745605
local_output_nid generation:  0.009467363357543945
local_in_edges_tensor generation:  0.009975433349609375
mini_batch_src_global generation:  0.022979021072387695
r_  generation:  0.18534088134765625
local_output_nid generation:  0.009306907653808594
local_in_edges_tensor generation:  0.012159347534179688
mini_batch_src_global generation:  0.022397279739379883
r_  generation:  0.18014073371887207
local_output_nid generation:  0.009755134582519531
local_in_edges_tensor generation:  0.009337902069091797
mini_batch_src_global generation:  0.02335977554321289
r_  generation:  0.19146084785461426
local_output_nid generation:  0.009434223175048828
local_in_edges_tensor generation:  0.009186029434204102
mini_batch_src_global generation:  0.022826194763183594
r_  generation:  0.18109750747680664
local_output_nid generation:  0.009430885314941406
local_in_edges_tensor generation:  0.008971452713012695
mini_batch_src_global generation:  0.022674083709716797
r_  generation:  0.18210387229919434
local_output_nid generation:  0.009197235107421875
local_in_edges_tensor generation:  0.009537220001220703
mini_batch_src_global generation:  0.022467374801635742
r_  generation:  0.1838669776916504
local_output_nid generation:  0.009356975555419922
local_in_edges_tensor generation:  0.009665489196777344
mini_batch_src_global generation:  0.022370576858520508
r_  generation:  0.18524646759033203
local_output_nid generation:  0.009203433990478516
local_in_edges_tensor generation:  0.013165950775146484
mini_batch_src_global generation:  0.02269124984741211
r_  generation:  0.17657756805419922
local_output_nid generation:  0.009270668029785156
local_in_edges_tensor generation:  0.00880742073059082
mini_batch_src_global generation:  0.021793365478515625
r_  generation:  0.18074655532836914
local_output_nid generation:  0.00971674919128418
local_in_edges_tensor generation:  0.009829044342041016
mini_batch_src_global generation:  0.022835969924926758
r_  generation:  0.18622136116027832
local_output_nid generation:  0.009395837783813477
local_in_edges_tensor generation:  0.00989222526550293
mini_batch_src_global generation:  0.02226734161376953
r_  generation:  0.1789090633392334
local_output_nid generation:  0.009689807891845703
local_in_edges_tensor generation:  0.009107351303100586
mini_batch_src_global generation:  0.022751808166503906
r_  generation:  0.18510961532592773
local_output_nid generation:  0.009535789489746094
local_in_edges_tensor generation:  0.008894205093383789
mini_batch_src_global generation:  0.02305316925048828
r_  generation:  0.18390893936157227
local_output_nid generation:  0.009640216827392578
local_in_edges_tensor generation:  0.009291410446166992
mini_batch_src_global generation:  0.023044109344482422
r_  generation:  0.19000506401062012
local_output_nid generation:  0.009235382080078125
local_in_edges_tensor generation:  0.009716272354125977
mini_batch_src_global generation:  0.022645235061645508
r_  generation:  0.18160676956176758
local_output_nid generation:  0.009672403335571289
local_in_edges_tensor generation:  0.009287595748901367
mini_batch_src_global generation:  0.023601055145263672
r_  generation:  0.1859126091003418
local_output_nid generation:  0.009126663208007812
local_in_edges_tensor generation:  0.009038448333740234
mini_batch_src_global generation:  0.023993968963623047
r_  generation:  0.1797950267791748
----------------------check_connections_block total spend ----------------------------- 8.549336194992065
generate_one_block  0.2588648796081543
generate_one_block  0.2672088146209717
generate_one_block  0.25522732734680176
generate_one_block  0.25098562240600586
generate_one_block  0.2741987705230713
generate_one_block  0.24555277824401855
generate_one_block  0.2526402473449707
generate_one_block  0.24814224243164062
generate_one_block  0.24242949485778809
generate_one_block  0.2484753131866455
generate_one_block  0.2505953311920166
generate_one_block  0.25102782249450684
generate_one_block  0.23992109298706055
generate_one_block  0.2465200424194336
generate_one_block  0.24837517738342285
generate_one_block  0.25034427642822266
generate_one_block  0.2388467788696289
generate_one_block  0.25655484199523926
generate_one_block  0.23955941200256348
generate_one_block  0.24599289894104004
generate_one_block  0.2471151351928711
generate_one_block  0.2432575225830078
generate_one_block  0.2378685474395752
generate_one_block  0.23302936553955078
generate_one_block  0.24956202507019043
generate_one_block  0.23553848266601562
generate_one_block  0.24335789680480957
generate_one_block  0.2445507049560547
generate_one_block  0.24649477005004883
generate_one_block  0.2406177520751953
generate_one_block  0.26424670219421387
generate_one_block  0.23600244522094727
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03849315643310547
gen group dst list time:  0.11201119422912598
time for parepare:  0.018578529357910156
local_output_nid generation:  0.026797056198120117
local_in_edges_tensor generation:  0.04659605026245117
mini_batch_src_global generation:  0.04050493240356445
r_  generation:  0.43549585342407227
local_output_nid generation:  0.034603118896484375
local_in_edges_tensor generation:  0.037697553634643555
mini_batch_src_global generation:  0.05029463768005371
r_  generation:  0.4362351894378662
local_output_nid generation:  0.031568288803100586
local_in_edges_tensor generation:  0.028532981872558594
mini_batch_src_global generation:  0.04885530471801758
r_  generation:  0.4414687156677246
local_output_nid generation:  0.03107452392578125
local_in_edges_tensor generation:  0.030034303665161133
mini_batch_src_global generation:  0.049379825592041016
r_  generation:  0.4334995746612549
local_output_nid generation:  0.02996683120727539
local_in_edges_tensor generation:  0.03127717971801758
mini_batch_src_global generation:  0.053171634674072266
r_  generation:  0.44014692306518555
local_output_nid generation:  0.029985666275024414
local_in_edges_tensor generation:  0.028323650360107422
mini_batch_src_global generation:  0.05054020881652832
r_  generation:  0.4399421215057373
local_output_nid generation:  0.030146121978759766
local_in_edges_tensor generation:  0.033231496810913086
mini_batch_src_global generation:  0.05137968063354492
r_  generation:  0.4463992118835449
local_output_nid generation:  0.029824256896972656
local_in_edges_tensor generation:  0.029286623001098633
mini_batch_src_global generation:  0.05255722999572754
r_  generation:  0.4395291805267334
local_output_nid generation:  0.029928922653198242
local_in_edges_tensor generation:  0.035003662109375
mini_batch_src_global generation:  0.050173044204711914
r_  generation:  0.4430394172668457
local_output_nid generation:  0.029708385467529297
local_in_edges_tensor generation:  0.027195215225219727
mini_batch_src_global generation:  0.050623178482055664
r_  generation:  0.43842101097106934
local_output_nid generation:  0.029856204986572266
local_in_edges_tensor generation:  0.028825044631958008
mini_batch_src_global generation:  0.05024290084838867
r_  generation:  0.44878649711608887
local_output_nid generation:  0.030123472213745117
local_in_edges_tensor generation:  0.03538703918457031
mini_batch_src_global generation:  0.05093550682067871
r_  generation:  0.44974422454833984
local_output_nid generation:  0.03079962730407715
local_in_edges_tensor generation:  0.030376195907592773
mini_batch_src_global generation:  0.04994368553161621
r_  generation:  0.4532337188720703
local_output_nid generation:  0.0316920280456543
local_in_edges_tensor generation:  0.029172420501708984
mini_batch_src_global generation:  0.05228137969970703
r_  generation:  0.44260239601135254
local_output_nid generation:  0.0304415225982666
local_in_edges_tensor generation:  0.027816057205200195
mini_batch_src_global generation:  0.0502476692199707
r_  generation:  0.44327783584594727
local_output_nid generation:  0.030603408813476562
local_in_edges_tensor generation:  0.0284121036529541
mini_batch_src_global generation:  0.05276966094970703
r_  generation:  0.44696998596191406
local_output_nid generation:  0.030654430389404297
local_in_edges_tensor generation:  0.02785801887512207
mini_batch_src_global generation:  0.049626827239990234
r_  generation:  0.44374680519104004
local_output_nid generation:  0.03042316436767578
local_in_edges_tensor generation:  0.0305325984954834
mini_batch_src_global generation:  0.05144524574279785
r_  generation:  0.4440317153930664
local_output_nid generation:  0.030610084533691406
local_in_edges_tensor generation:  0.027521848678588867
mini_batch_src_global generation:  0.04963541030883789
r_  generation:  0.44275569915771484
local_output_nid generation:  0.030653715133666992
local_in_edges_tensor generation:  0.028553485870361328
mini_batch_src_global generation:  0.050376176834106445
r_  generation:  0.4381706714630127
local_output_nid generation:  0.03048253059387207
local_in_edges_tensor generation:  0.029985427856445312
mini_batch_src_global generation:  0.05624723434448242
r_  generation:  0.44135499000549316
local_output_nid generation:  0.030360937118530273
local_in_edges_tensor generation:  0.030661344528198242
mini_batch_src_global generation:  0.0508580207824707
r_  generation:  0.4376392364501953
local_output_nid generation:  0.030337810516357422
local_in_edges_tensor generation:  0.026856422424316406
mini_batch_src_global generation:  0.04896259307861328
r_  generation:  0.4405403137207031
local_output_nid generation:  0.030369043350219727
local_in_edges_tensor generation:  0.02823615074157715
mini_batch_src_global generation:  0.05060124397277832
r_  generation:  0.4371623992919922
local_output_nid generation:  0.03054213523864746
local_in_edges_tensor generation:  0.029141902923583984
mini_batch_src_global generation:  0.051772356033325195
r_  generation:  0.4405937194824219
local_output_nid generation:  0.030431509017944336
local_in_edges_tensor generation:  0.029163122177124023
mini_batch_src_global generation:  0.05091214179992676
r_  generation:  0.4366774559020996
local_output_nid generation:  0.030598163604736328
local_in_edges_tensor generation:  0.030525922775268555
mini_batch_src_global generation:  0.04970431327819824
r_  generation:  0.43950462341308594
local_output_nid generation:  0.03064441680908203
local_in_edges_tensor generation:  0.03746938705444336
mini_batch_src_global generation:  0.050878047943115234
r_  generation:  0.44090938568115234
local_output_nid generation:  0.03095078468322754
local_in_edges_tensor generation:  0.02962327003479004
mini_batch_src_global generation:  0.05023026466369629
r_  generation:  0.44179558753967285
local_output_nid generation:  0.030904531478881836
local_in_edges_tensor generation:  0.029236316680908203
mini_batch_src_global generation:  0.05128908157348633
r_  generation:  0.4395778179168701
local_output_nid generation:  0.030519485473632812
local_in_edges_tensor generation:  0.026554584503173828
mini_batch_src_global generation:  0.05220174789428711
r_  generation:  0.4460883140563965
local_output_nid generation:  0.03033614158630371
local_in_edges_tensor generation:  0.029364824295043945
mini_batch_src_global generation:  0.05081009864807129
r_  generation:  0.43831419944763184
----------------------check_connections_block total spend ----------------------------- 20.851244688034058
generate_one_block  0.6075894832611084
generate_one_block  0.5880587100982666
generate_one_block  0.5826282501220703
generate_one_block  0.5812523365020752
generate_one_block  0.6813266277313232
generate_one_block  0.5880045890808105
generate_one_block  0.5922608375549316
generate_one_block  0.5917365550994873
generate_one_block  0.5817761421203613
generate_one_block  0.5796916484832764
generate_one_block  0.5937132835388184
generate_one_block  0.5867407321929932
generate_one_block  0.5843784809112549
generate_one_block  0.5985968112945557
generate_one_block  0.5845828056335449
generate_one_block  0.5831561088562012
generate_one_block  0.5856499671936035
generate_one_block  0.592818021774292
generate_one_block  0.5844166278839111
generate_one_block  0.5881936550140381
generate_one_block  0.5900287628173828
generate_one_block  0.5861399173736572
generate_one_block  0.5838735103607178
generate_one_block  0.5844502449035645
generate_one_block  0.6052761077880859
generate_one_block  0.5796189308166504
generate_one_block  0.589968204498291
generate_one_block  0.5959091186523438
generate_one_block  0.5922191143035889
generate_one_block  0.5798671245574951
generate_one_block  0.5842368602752686
generate_one_block  0.5981779098510742
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 0.1263589859008789  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

connection checking time:  29.400580883026123
block generation total time  26.859441995620728
average batch blocks generation time:  0.8393575623631477
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 0.10660505294799805  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 19.163105010986328  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 0.10710573196411133  GigaBytes
Max Memory Allocated: 19.625940322875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1463623046875 GB
    Memory Allocated: 19.67340898513794  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10643815994262695  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.05448293685913  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10670232772827148  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.03319215774536  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10658121109008789  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.926112174987793  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10663318634033203  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.88106918334961  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10674667358398438  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.219838619232178  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10660743713378906  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.089457511901855  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10639286041259766  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.701664924621582  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10651779174804688  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.886858463287354  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10667276382446289  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.23418951034546  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10676908493041992  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.149299144744873  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10669136047363281  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.859682083129883  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10673856735229492  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.09669780731201  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10664701461791992  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.058642864227295  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10686445236206055  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.08140802383423  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10663032531738281  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.775158405303955  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10691213607788086  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.37840509414673  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10662126541137695  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.763511657714844  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10664558410644531  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.80906105041504  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10665750503540039  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.820431232452393  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10661840438842773  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.814520835876465  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10624027252197266  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.40644931793213  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10627317428588867  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.514014720916748  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10666370391845703  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.05101776123047  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1064310073852539  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.519017219543457  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10672664642333984  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.866714000701904  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1067037582397461  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.865280151367188  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10679149627685547  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.037460327148438  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10631561279296875  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.59644603729248  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10672950744628906  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.02587604522705  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10621023178100586  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.557331562042236  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03051593154668808 |0.02037379890680313 |0.5619818344712257 |9.585171937942505e-05 |1.076519787311554 |0.00940394401550293 |
----------------------------------------------------------pseudo_mini_loss sum 2.4035966396331787
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  9118016
Number of first layer input nodes during this epoch:  4762257
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.12609243392944336  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02551436424255371
random selection method range initialization spend 0.0052490234375
time for parepare:  0.020854949951171875
local_output_nid generation:  0.00138092041015625
local_in_edges_tensor generation:  0.006585359573364258
mini_batch_src_global generation:  0.0018053054809570312
r_  generation:  0.010576009750366211
local_output_nid generation:  0.0015728473663330078
local_in_edges_tensor generation:  0.0010673999786376953
mini_batch_src_global generation:  0.0016603469848632812
r_  generation:  0.010086536407470703
local_output_nid generation:  0.0016412734985351562
local_in_edges_tensor generation:  0.0010402202606201172
mini_batch_src_global generation:  0.0012309551239013672
r_  generation:  0.009975671768188477
local_output_nid generation:  0.0016105175018310547
local_in_edges_tensor generation:  0.0009734630584716797
mini_batch_src_global generation:  0.0011816024780273438
r_  generation:  0.010195493698120117
local_output_nid generation:  0.0016009807586669922
local_in_edges_tensor generation:  0.0009989738464355469
mini_batch_src_global generation:  0.0011262893676757812
r_  generation:  0.00986337661743164
local_output_nid generation:  0.001600503921508789
local_in_edges_tensor generation:  0.0009365081787109375
mini_batch_src_global generation:  0.001016378402709961
r_  generation:  0.01179194450378418
local_output_nid generation:  0.0016896724700927734
local_in_edges_tensor generation:  0.0009763240814208984
mini_batch_src_global generation:  0.0012879371643066406
r_  generation:  0.01063990592956543
local_output_nid generation:  0.0015950202941894531
local_in_edges_tensor generation:  0.0009567737579345703
mini_batch_src_global generation:  0.0011832714080810547
r_  generation:  0.010073423385620117
local_output_nid generation:  0.0016248226165771484
local_in_edges_tensor generation:  0.0009212493896484375
mini_batch_src_global generation:  0.001163482666015625
r_  generation:  0.010135412216186523
local_output_nid generation:  0.001577615737915039
local_in_edges_tensor generation:  0.0009119510650634766
mini_batch_src_global generation:  0.0012254714965820312
r_  generation:  0.009970903396606445
local_output_nid generation:  0.0015730857849121094
local_in_edges_tensor generation:  0.0009286403656005859
mini_batch_src_global generation:  0.0011768341064453125
r_  generation:  0.010573387145996094
local_output_nid generation:  0.0016224384307861328
local_in_edges_tensor generation:  0.000904083251953125
mini_batch_src_global generation:  0.0011887550354003906
r_  generation:  0.010568618774414062
local_output_nid generation:  0.0015888214111328125
local_in_edges_tensor generation:  0.0009186267852783203
mini_batch_src_global generation:  0.0012183189392089844
r_  generation:  0.01024007797241211
local_output_nid generation:  0.0015842914581298828
local_in_edges_tensor generation:  0.0009229183197021484
mini_batch_src_global generation:  0.0011441707611083984
r_  generation:  0.010288715362548828
local_output_nid generation:  0.0016107559204101562
local_in_edges_tensor generation:  0.0009174346923828125
mini_batch_src_global generation:  0.0011603832244873047
r_  generation:  0.0101318359375
local_output_nid generation:  0.0015900135040283203
local_in_edges_tensor generation:  0.000911712646484375
mini_batch_src_global generation:  0.0012068748474121094
r_  generation:  0.010468244552612305
local_output_nid generation:  0.0015892982482910156
local_in_edges_tensor generation:  0.0009109973907470703
mini_batch_src_global generation:  0.0012233257293701172
r_  generation:  0.01068115234375
local_output_nid generation:  0.001598358154296875
local_in_edges_tensor generation:  0.0009298324584960938
mini_batch_src_global generation:  0.001222372055053711
r_  generation:  0.010769128799438477
local_output_nid generation:  0.001617431640625
local_in_edges_tensor generation:  0.0009441375732421875
mini_batch_src_global generation:  0.0011723041534423828
r_  generation:  0.010326862335205078
local_output_nid generation:  0.0015931129455566406
local_in_edges_tensor generation:  0.0009162425994873047
mini_batch_src_global generation:  0.0011386871337890625
r_  generation:  0.010327816009521484
local_output_nid generation:  0.0015819072723388672
local_in_edges_tensor generation:  0.0009324550628662109
mini_batch_src_global generation:  0.0011913776397705078
r_  generation:  0.010442495346069336
local_output_nid generation:  0.0016255378723144531
local_in_edges_tensor generation:  0.0009558200836181641
mini_batch_src_global generation:  0.0011355876922607422
r_  generation:  0.010202646255493164
local_output_nid generation:  0.001589059829711914
local_in_edges_tensor generation:  0.0009109973907470703
mini_batch_src_global generation:  0.001140594482421875
r_  generation:  0.010104894638061523
local_output_nid generation:  0.0015876293182373047
local_in_edges_tensor generation:  0.0009002685546875
mini_batch_src_global generation:  0.0011241436004638672
r_  generation:  0.010236978530883789
local_output_nid generation:  0.0016009807586669922
local_in_edges_tensor generation:  0.0009653568267822266
mini_batch_src_global generation:  0.0011608600616455078
r_  generation:  0.010293006896972656
local_output_nid generation:  0.0016002655029296875
local_in_edges_tensor generation:  0.0009200572967529297
mini_batch_src_global generation:  0.0012695789337158203
r_  generation:  0.011014223098754883
local_output_nid generation:  0.001589059829711914
local_in_edges_tensor generation:  0.0008957386016845703
mini_batch_src_global generation:  0.0011289119720458984
r_  generation:  0.010255813598632812
local_output_nid generation:  0.0016448497772216797
local_in_edges_tensor generation:  0.0009145736694335938
mini_batch_src_global generation:  0.0011343955993652344
r_  generation:  0.010283708572387695
local_output_nid generation:  0.001592874526977539
local_in_edges_tensor generation:  0.0009136199951171875
mini_batch_src_global generation:  0.0011608600616455078
r_  generation:  0.010513067245483398
local_output_nid generation:  0.0015919208526611328
local_in_edges_tensor generation:  0.0008974075317382812
mini_batch_src_global generation:  0.001127481460571289
r_  generation:  0.010202169418334961
local_output_nid generation:  0.0016634464263916016
local_in_edges_tensor generation:  0.0009207725524902344
mini_batch_src_global generation:  0.0011239051818847656
r_  generation:  0.010044336318969727
local_output_nid generation:  0.0015914440155029297
local_in_edges_tensor generation:  0.0008995532989501953
mini_batch_src_global generation:  0.0011396408081054688
r_  generation:  0.010224342346191406
----------------------check_connections_block total spend ----------------------------- 0.5745425224304199
generate_one_block  0.0245058536529541
generate_one_block  0.021271944046020508
generate_one_block  0.019242525100708008
generate_one_block  0.019115209579467773
generate_one_block  0.01821136474609375
generate_one_block  0.01942276954650879
generate_one_block  0.01988840103149414
generate_one_block  0.01846456527709961
generate_one_block  0.018349647521972656
generate_one_block  0.017696857452392578
generate_one_block  0.018752574920654297
generate_one_block  0.01892685890197754
generate_one_block  0.018178462982177734
generate_one_block  0.018139362335205078
generate_one_block  0.01784229278564453
generate_one_block  0.018378257751464844
generate_one_block  0.018669605255126953
generate_one_block  0.018906354904174805
generate_one_block  0.01807093620300293
generate_one_block  0.018483877182006836
generate_one_block  0.018427610397338867
generate_one_block  0.018029451370239258
generate_one_block  0.017858028411865234
generate_one_block  0.018012046813964844
generate_one_block  0.018292665481567383
generate_one_block  0.019270658493041992
generate_one_block  0.017890453338623047
generate_one_block  0.01803112030029297
generate_one_block  0.018535375595092773
generate_one_block  0.017591476440429688
generate_one_block  0.01767134666442871
generate_one_block  0.01814889907836914
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03969073295593262
gen group dst list time:  0.023101806640625
time for parepare:  0.021883726119995117
local_output_nid generation:  0.00680088996887207
local_in_edges_tensor generation:  0.018102645874023438
mini_batch_src_global generation:  0.01695561408996582
r_  generation:  0.15773940086364746
local_output_nid generation:  0.009324789047241211
local_in_edges_tensor generation:  0.010979890823364258
mini_batch_src_global generation:  0.02042984962463379
r_  generation:  0.16492724418640137
local_output_nid generation:  0.009534358978271484
local_in_edges_tensor generation:  0.034071922302246094
mini_batch_src_global generation:  0.019733667373657227
r_  generation:  0.17337894439697266
local_output_nid generation:  0.009783744812011719
local_in_edges_tensor generation:  0.010526418685913086
mini_batch_src_global generation:  0.022063255310058594
r_  generation:  0.1782071590423584
local_output_nid generation:  0.009474039077758789
local_in_edges_tensor generation:  0.009116888046264648
mini_batch_src_global generation:  0.021096229553222656
r_  generation:  0.1728377342224121
local_output_nid generation:  0.009508371353149414
local_in_edges_tensor generation:  0.010412931442260742
mini_batch_src_global generation:  0.023658037185668945
r_  generation:  0.18709421157836914
local_output_nid generation:  0.009014606475830078
local_in_edges_tensor generation:  0.009372472763061523
mini_batch_src_global generation:  0.022548675537109375
r_  generation:  0.18038153648376465
local_output_nid generation:  0.009016036987304688
local_in_edges_tensor generation:  0.009781599044799805
mini_batch_src_global generation:  0.024866104125976562
r_  generation:  0.1806478500366211
local_output_nid generation:  0.009206056594848633
local_in_edges_tensor generation:  0.009294986724853516
mini_batch_src_global generation:  0.02245187759399414
r_  generation:  0.18432283401489258
local_output_nid generation:  0.009190797805786133
local_in_edges_tensor generation:  0.008835315704345703
mini_batch_src_global generation:  0.021706581115722656
r_  generation:  0.17222952842712402
local_output_nid generation:  0.009636402130126953
local_in_edges_tensor generation:  0.00927591323852539
mini_batch_src_global generation:  0.022709131240844727
r_  generation:  0.18693804740905762
local_output_nid generation:  0.009585380554199219
local_in_edges_tensor generation:  0.009955406188964844
mini_batch_src_global generation:  0.023271799087524414
r_  generation:  0.18603038787841797
local_output_nid generation:  0.00949716567993164
local_in_edges_tensor generation:  0.009135961532592773
mini_batch_src_global generation:  0.02279210090637207
r_  generation:  0.18255138397216797
local_output_nid generation:  0.009451866149902344
local_in_edges_tensor generation:  0.009489297866821289
mini_batch_src_global generation:  0.024403095245361328
r_  generation:  0.18215274810791016
local_output_nid generation:  0.009395122528076172
local_in_edges_tensor generation:  0.009562253952026367
mini_batch_src_global generation:  0.023374557495117188
r_  generation:  0.18149924278259277
local_output_nid generation:  0.009532690048217773
local_in_edges_tensor generation:  0.009792327880859375
mini_batch_src_global generation:  0.022936582565307617
r_  generation:  0.18466949462890625
local_output_nid generation:  0.009660959243774414
local_in_edges_tensor generation:  0.00984811782836914
mini_batch_src_global generation:  0.023812532424926758
r_  generation:  0.19013476371765137
local_output_nid generation:  0.009820699691772461
local_in_edges_tensor generation:  0.009169578552246094
mini_batch_src_global generation:  0.026262998580932617
r_  generation:  0.18854546546936035
local_output_nid generation:  0.009456872940063477
local_in_edges_tensor generation:  0.00889897346496582
mini_batch_src_global generation:  0.023161888122558594
r_  generation:  0.1805553436279297
local_output_nid generation:  0.00960993766784668
local_in_edges_tensor generation:  0.00901031494140625
mini_batch_src_global generation:  0.02282428741455078
r_  generation:  0.18454980850219727
local_output_nid generation:  0.009693384170532227
local_in_edges_tensor generation:  0.00996255874633789
mini_batch_src_global generation:  0.027804851531982422
r_  generation:  0.18719482421875
local_output_nid generation:  0.009357213973999023
local_in_edges_tensor generation:  0.009219884872436523
mini_batch_src_global generation:  0.02254962921142578
r_  generation:  0.1817021369934082
local_output_nid generation:  0.00915074348449707
local_in_edges_tensor generation:  0.008915901184082031
mini_batch_src_global generation:  0.0218350887298584
r_  generation:  0.17909955978393555
local_output_nid generation:  0.009418725967407227
local_in_edges_tensor generation:  0.00896906852722168
mini_batch_src_global generation:  0.022316932678222656
r_  generation:  0.1828927993774414
local_output_nid generation:  0.009450912475585938
local_in_edges_tensor generation:  0.009091615676879883
mini_batch_src_global generation:  0.023104190826416016
r_  generation:  0.18482160568237305
local_output_nid generation:  0.00997018814086914
local_in_edges_tensor generation:  0.010932445526123047
mini_batch_src_global generation:  0.023944616317749023
r_  generation:  0.19126248359680176
local_output_nid generation:  0.009333610534667969
local_in_edges_tensor generation:  0.009956598281860352
mini_batch_src_global generation:  0.02335333824157715
r_  generation:  0.1798999309539795
local_output_nid generation:  0.009496688842773438
local_in_edges_tensor generation:  0.009255647659301758
mini_batch_src_global generation:  0.022516965866088867
r_  generation:  0.17921113967895508
local_output_nid generation:  0.00960087776184082
local_in_edges_tensor generation:  0.008994102478027344
mini_batch_src_global generation:  0.02301502227783203
r_  generation:  0.18299198150634766
local_output_nid generation:  0.009236574172973633
local_in_edges_tensor generation:  0.009124040603637695
mini_batch_src_global generation:  0.02251124382019043
r_  generation:  0.17688298225402832
local_output_nid generation:  0.009356021881103516
local_in_edges_tensor generation:  0.008654594421386719
mini_batch_src_global generation:  0.021994352340698242
r_  generation:  0.1782679557800293
local_output_nid generation:  0.00949716567993164
local_in_edges_tensor generation:  0.009649991989135742
mini_batch_src_global generation:  0.022430419921875
r_  generation:  0.18242430686950684
----------------------check_connections_block total spend ----------------------------- 8.454267263412476
generate_one_block  0.2362964153289795
generate_one_block  0.2348165512084961
generate_one_block  0.2449193000793457
generate_one_block  0.2491004467010498
generate_one_block  0.26129698753356934
generate_one_block  0.2576334476470947
generate_one_block  0.24318337440490723
generate_one_block  0.2437605857849121
generate_one_block  0.24408292770385742
generate_one_block  0.23095417022705078
generate_one_block  0.251741886138916
generate_one_block  0.2514607906341553
generate_one_block  0.2399137020111084
generate_one_block  0.23719263076782227
generate_one_block  0.2404012680053711
generate_one_block  0.24657344818115234
generate_one_block  0.2521350383758545
generate_one_block  0.2555513381958008
generate_one_block  0.24012994766235352
generate_one_block  0.24997925758361816
generate_one_block  0.2509894371032715
generate_one_block  0.24268531799316406
generate_one_block  0.23827052116394043
generate_one_block  0.24397635459899902
generate_one_block  0.2473740577697754
generate_one_block  0.25890231132507324
generate_one_block  0.23616504669189453
generate_one_block  0.23809146881103516
generate_one_block  0.24609661102294922
generate_one_block  0.23594093322753906
generate_one_block  0.2364826202392578
generate_one_block  0.24783086776733398
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03182840347290039
gen group dst list time:  0.1047823429107666
time for parepare:  0.020036697387695312
local_output_nid generation:  0.02527594566345215
local_in_edges_tensor generation:  0.03538155555725098
mini_batch_src_global generation:  0.03746795654296875
r_  generation:  0.42105770111083984
local_output_nid generation:  0.03177022933959961
local_in_edges_tensor generation:  0.0351104736328125
mini_batch_src_global generation:  0.051277875900268555
r_  generation:  0.4226417541503906
local_output_nid generation:  0.0320582389831543
local_in_edges_tensor generation:  0.02915644645690918
mini_batch_src_global generation:  0.05069541931152344
r_  generation:  0.4366765022277832
local_output_nid generation:  0.03214001655578613
local_in_edges_tensor generation:  0.028056621551513672
mini_batch_src_global generation:  0.051941871643066406
r_  generation:  0.4308164119720459
local_output_nid generation:  0.030182600021362305
local_in_edges_tensor generation:  0.02769303321838379
mini_batch_src_global generation:  0.04914450645446777
r_  generation:  0.43747544288635254
local_output_nid generation:  0.030481338500976562
local_in_edges_tensor generation:  0.027288436889648438
mini_batch_src_global generation:  0.050774574279785156
r_  generation:  0.4357328414916992
local_output_nid generation:  0.03018355369567871
local_in_edges_tensor generation:  0.030213594436645508
mini_batch_src_global generation:  0.04971718788146973
r_  generation:  0.4350917339324951
local_output_nid generation:  0.029450178146362305
local_in_edges_tensor generation:  0.02691054344177246
mini_batch_src_global generation:  0.05005526542663574
r_  generation:  0.4318990707397461
local_output_nid generation:  0.02965402603149414
local_in_edges_tensor generation:  0.028713226318359375
mini_batch_src_global generation:  0.04960966110229492
r_  generation:  0.4386427402496338
local_output_nid generation:  0.029474496841430664
local_in_edges_tensor generation:  0.026884794235229492
mini_batch_src_global generation:  0.05001068115234375
r_  generation:  0.43047261238098145
local_output_nid generation:  0.030161142349243164
local_in_edges_tensor generation:  0.02873682975769043
mini_batch_src_global generation:  0.04958915710449219
r_  generation:  0.4409151077270508
local_output_nid generation:  0.030236005783081055
local_in_edges_tensor generation:  0.028284072875976562
mini_batch_src_global generation:  0.05272984504699707
r_  generation:  0.43800950050354004
local_output_nid generation:  0.029911518096923828
local_in_edges_tensor generation:  0.03192949295043945
mini_batch_src_global generation:  0.04917263984680176
r_  generation:  0.43711042404174805
local_output_nid generation:  0.03001236915588379
local_in_edges_tensor generation:  0.02726888656616211
mini_batch_src_global generation:  0.050164222717285156
r_  generation:  0.4391825199127197
local_output_nid generation:  0.029904842376708984
local_in_edges_tensor generation:  0.027223825454711914
mini_batch_src_global generation:  0.049468040466308594
r_  generation:  0.43981099128723145
local_output_nid generation:  0.0299074649810791
local_in_edges_tensor generation:  0.02910637855529785
mini_batch_src_global generation:  0.05017280578613281
r_  generation:  0.4433155059814453
local_output_nid generation:  0.03138232231140137
local_in_edges_tensor generation:  0.029011964797973633
mini_batch_src_global generation:  0.05223274230957031
r_  generation:  0.44213390350341797
local_output_nid generation:  0.029838085174560547
local_in_edges_tensor generation:  0.03145742416381836
mini_batch_src_global generation:  0.05041694641113281
r_  generation:  0.4362304210662842
local_output_nid generation:  0.030080080032348633
local_in_edges_tensor generation:  0.03188729286193848
mini_batch_src_global generation:  0.04960513114929199
r_  generation:  0.4437289237976074
local_output_nid generation:  0.030080080032348633
local_in_edges_tensor generation:  0.02671360969543457
mini_batch_src_global generation:  0.05052375793457031
r_  generation:  0.4330904483795166
local_output_nid generation:  0.03022146224975586
local_in_edges_tensor generation:  0.027811527252197266
mini_batch_src_global generation:  0.05123496055603027
r_  generation:  0.44017672538757324
local_output_nid generation:  0.03148937225341797
local_in_edges_tensor generation:  0.02691364288330078
mini_batch_src_global generation:  0.05049777030944824
r_  generation:  0.4351615905761719
local_output_nid generation:  0.02975177764892578
local_in_edges_tensor generation:  0.026998043060302734
mini_batch_src_global generation:  0.049831390380859375
r_  generation:  0.43683862686157227
local_output_nid generation:  0.029634714126586914
local_in_edges_tensor generation:  0.027452468872070312
mini_batch_src_global generation:  0.05025815963745117
r_  generation:  0.44125986099243164
local_output_nid generation:  0.03036952018737793
local_in_edges_tensor generation:  0.02695465087890625
mini_batch_src_global generation:  0.049225807189941406
r_  generation:  0.4424903392791748
local_output_nid generation:  0.030323266983032227
local_in_edges_tensor generation:  0.031014442443847656
mini_batch_src_global generation:  0.0506284236907959
r_  generation:  0.4436042308807373
local_output_nid generation:  0.02975010871887207
local_in_edges_tensor generation:  0.027564525604248047
mini_batch_src_global generation:  0.049811363220214844
r_  generation:  0.44495248794555664
local_output_nid generation:  0.030407190322875977
local_in_edges_tensor generation:  0.029317855834960938
mini_batch_src_global generation:  0.05046844482421875
r_  generation:  0.44138455390930176
local_output_nid generation:  0.03055858612060547
local_in_edges_tensor generation:  0.033273935317993164
mini_batch_src_global generation:  0.049848318099975586
r_  generation:  0.44124722480773926
local_output_nid generation:  0.03129315376281738
local_in_edges_tensor generation:  0.029397010803222656
mini_batch_src_global generation:  0.05046725273132324
r_  generation:  0.4406445026397705
local_output_nid generation:  0.029842138290405273
local_in_edges_tensor generation:  0.027790307998657227
mini_batch_src_global generation:  0.04925966262817383
r_  generation:  0.4391171932220459
local_output_nid generation:  0.030092477798461914
local_in_edges_tensor generation:  0.02695488929748535
mini_batch_src_global generation:  0.050253868103027344
r_  generation:  0.44577956199645996
----------------------check_connections_block total spend ----------------------------- 20.610305786132812
generate_one_block  0.5812869071960449
generate_one_block  0.5799713134765625
generate_one_block  0.5885000228881836
generate_one_block  0.5852904319763184
generate_one_block  0.6695425510406494
generate_one_block  0.5873124599456787
generate_one_block  0.5904512405395508
generate_one_block  0.5752806663513184
generate_one_block  0.5904507637023926
generate_one_block  0.5764753818511963
generate_one_block  0.5849208831787109
generate_one_block  0.5903520584106445
generate_one_block  0.5910019874572754
generate_one_block  0.5827829837799072
generate_one_block  0.5832006931304932
generate_one_block  0.5826349258422852
generate_one_block  0.5925369262695312
generate_one_block  0.5849640369415283
generate_one_block  0.57814621925354
generate_one_block  0.5865764617919922
generate_one_block  0.5906264781951904
generate_one_block  0.5785527229309082
generate_one_block  0.5907275676727295
generate_one_block  0.5791082382202148
generate_one_block  0.5964534282684326
generate_one_block  0.5901310443878174
generate_one_block  0.5818204879760742
generate_one_block  0.5821902751922607
generate_one_block  0.5941758155822754
generate_one_block  0.5807797908782959
generate_one_block  0.5830154418945312
generate_one_block  0.5869760513305664
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.12609243392944336  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

connection checking time:  29.064573049545288
block generation total time  26.65016531944275
average batch blocks generation time:  0.8328176662325859
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10639333724975586  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.467307567596436  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1064767837524414  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.64762544631958  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10689783096313477  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.053282260894775  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1066889762878418  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.196892261505127  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1077737808227539  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.666958808898926  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1072230339050293  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.610076427459717  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10669183731079102  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.032681465148926  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10663175582885742  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.95892095565796  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10659265518188477  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.977330684661865  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1062626838684082  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.373987197875977  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10673761367797852  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.183778762817383  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10700273513793945  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.305145740509033  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10633563995361328  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.778072357177734  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10682487487792969  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.73022985458374  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10642671585083008  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.73210096359253  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10670328140258789  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.014572143554688  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10700654983520508  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.35914945602417  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10674095153808594  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.275951385498047  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10650348663330078  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.75743007659912  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10689783096313477  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.021411895751953  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1070103645324707  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.21689224243164  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10647392272949219  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.82663106918335  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10649585723876953  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.638407707214355  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1065526008605957  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.74695920944214  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10651493072509766  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.924073219299316  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1070408821105957  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.4633207321167  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10582876205444336  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.475147247314453  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10672283172607422  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.74673557281494  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10661888122558594  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.96444034576416  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10645341873168945  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.556976795196533  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10637521743774414  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.539313793182373  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10644149780273438  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.873332500457764  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.028612568974494934 |0.018211819231510162 |0.5587504506111145 |9.50247049331665e-05 |1.0726123079657555 |0.007218122482299805 |
----------------------------------------------------------pseudo_mini_loss sum 2.1893298625946045
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  9118108
Number of first layer input nodes during this epoch:  4764032
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.12641429901123047  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02500462532043457
random selection method range initialization spend 0.005376338958740234
time for parepare:  0.01731586456298828
local_output_nid generation:  0.0013697147369384766
local_in_edges_tensor generation:  0.007767438888549805
mini_batch_src_global generation:  0.00151824951171875
r_  generation:  0.010515213012695312
local_output_nid generation:  0.0016090869903564453
local_in_edges_tensor generation:  0.001092672348022461
mini_batch_src_global generation:  0.0014319419860839844
r_  generation:  0.009684085845947266
local_output_nid generation:  0.0016064643859863281
local_in_edges_tensor generation:  0.0009653568267822266
mini_batch_src_global generation:  0.0011112689971923828
r_  generation:  0.00966644287109375
local_output_nid generation:  0.0015711784362792969
local_in_edges_tensor generation:  0.0009641647338867188
mini_batch_src_global generation:  0.001111745834350586
r_  generation:  0.009804487228393555
local_output_nid generation:  0.0015778541564941406
local_in_edges_tensor generation:  0.0009565353393554688
mini_batch_src_global generation:  0.0011184215545654297
r_  generation:  0.009968042373657227
local_output_nid generation:  0.0015714168548583984
local_in_edges_tensor generation:  0.0009517669677734375
mini_batch_src_global generation:  0.0011560916900634766
r_  generation:  0.01038813591003418
local_output_nid generation:  0.001577138900756836
local_in_edges_tensor generation:  0.0009398460388183594
mini_batch_src_global generation:  0.0011227130889892578
r_  generation:  0.010008096694946289
local_output_nid generation:  0.0015606880187988281
local_in_edges_tensor generation:  0.0009214878082275391
mini_batch_src_global generation:  0.001077413558959961
r_  generation:  0.009658098220825195
local_output_nid generation:  0.0015687942504882812
local_in_edges_tensor generation:  0.0009088516235351562
mini_batch_src_global generation:  0.001081228256225586
r_  generation:  0.00993490219116211
local_output_nid generation:  0.0015578269958496094
local_in_edges_tensor generation:  0.0009222030639648438
mini_batch_src_global generation:  0.0011632442474365234
r_  generation:  0.009968996047973633
local_output_nid generation:  0.0015723705291748047
local_in_edges_tensor generation:  0.0009357929229736328
mini_batch_src_global generation:  0.0011374950408935547
r_  generation:  0.010447263717651367
local_output_nid generation:  0.0015730857849121094
local_in_edges_tensor generation:  0.0009114742279052734
mini_batch_src_global generation:  0.001171112060546875
r_  generation:  0.009958744049072266
local_output_nid generation:  0.0015854835510253906
local_in_edges_tensor generation:  0.0009191036224365234
mini_batch_src_global generation:  0.0011053085327148438
r_  generation:  0.010159969329833984
local_output_nid generation:  0.00157928466796875
local_in_edges_tensor generation:  0.0008971691131591797
mini_batch_src_global generation:  0.001157522201538086
r_  generation:  0.009940624237060547
local_output_nid generation:  0.0015974044799804688
local_in_edges_tensor generation:  0.0009057521820068359
mini_batch_src_global generation:  0.0012295246124267578
r_  generation:  0.010185480117797852
local_output_nid generation:  0.001592874526977539
local_in_edges_tensor generation:  0.00090789794921875
mini_batch_src_global generation:  0.0012009143829345703
r_  generation:  0.01026153564453125
local_output_nid generation:  0.0015931129455566406
local_in_edges_tensor generation:  0.0009174346923828125
mini_batch_src_global generation:  0.0010831356048583984
r_  generation:  0.009749650955200195
local_output_nid generation:  0.001605987548828125
local_in_edges_tensor generation:  0.0009512901306152344
mini_batch_src_global generation:  0.0011134147644042969
r_  generation:  0.009732723236083984
local_output_nid generation:  0.0015895366668701172
local_in_edges_tensor generation:  0.0009093284606933594
mini_batch_src_global generation:  0.0011217594146728516
r_  generation:  0.010181665420532227
local_output_nid generation:  0.0015916824340820312
local_in_edges_tensor generation:  0.0008962154388427734
mini_batch_src_global generation:  0.0011265277862548828
r_  generation:  0.010284900665283203
local_output_nid generation:  0.0015821456909179688
local_in_edges_tensor generation:  0.0008924007415771484
mini_batch_src_global generation:  0.0011115074157714844
r_  generation:  0.009906291961669922
local_output_nid generation:  0.0015864372253417969
local_in_edges_tensor generation:  0.0009069442749023438
mini_batch_src_global generation:  0.0011594295501708984
r_  generation:  0.01042032241821289
local_output_nid generation:  0.0015919208526611328
local_in_edges_tensor generation:  0.0009374618530273438
mini_batch_src_global generation:  0.0011334419250488281
r_  generation:  0.010221719741821289
local_output_nid generation:  0.0015978813171386719
local_in_edges_tensor generation:  0.0009291172027587891
mini_batch_src_global generation:  0.0011339187622070312
r_  generation:  0.010104179382324219
local_output_nid generation:  0.0015864372253417969
local_in_edges_tensor generation:  0.0008764266967773438
mini_batch_src_global generation:  0.0011429786682128906
r_  generation:  0.010416984558105469
local_output_nid generation:  0.001567840576171875
local_in_edges_tensor generation:  0.0008680820465087891
mini_batch_src_global generation:  0.0011229515075683594
r_  generation:  0.0101470947265625
local_output_nid generation:  0.0015645027160644531
local_in_edges_tensor generation:  0.0008902549743652344
mini_batch_src_global generation:  0.001173257827758789
r_  generation:  0.00999903678894043
local_output_nid generation:  0.0015654563903808594
local_in_edges_tensor generation:  0.0008797645568847656
mini_batch_src_global generation:  0.0011277198791503906
r_  generation:  0.009622335433959961
local_output_nid generation:  0.0015714168548583984
local_in_edges_tensor generation:  0.0008842945098876953
mini_batch_src_global generation:  0.0011067390441894531
r_  generation:  0.009781837463378906
local_output_nid generation:  0.0015671253204345703
local_in_edges_tensor generation:  0.0009300708770751953
mini_batch_src_global generation:  0.0012011528015136719
r_  generation:  0.010373830795288086
local_output_nid generation:  0.0015714168548583984
local_in_edges_tensor generation:  0.0009100437164306641
mini_batch_src_global generation:  0.0011525154113769531
r_  generation:  0.01059412956237793
local_output_nid generation:  0.0015873908996582031
local_in_edges_tensor generation:  0.0009126663208007812
mini_batch_src_global generation:  0.0011641979217529297
r_  generation:  0.009627580642700195
----------------------check_connections_block total spend ----------------------------- 0.557295560836792
generate_one_block  0.023933887481689453
generate_one_block  0.020537137985229492
generate_one_block  0.0185391902923584
generate_one_block  0.018326759338378906
generate_one_block  0.01854848861694336
generate_one_block  0.01885223388671875
generate_one_block  0.01833033561706543
generate_one_block  0.017988204956054688
generate_one_block  0.017971515655517578
generate_one_block  0.017839670181274414
generate_one_block  0.018640995025634766
generate_one_block  0.018012523651123047
generate_one_block  0.018208026885986328
generate_one_block  0.017416954040527344
generate_one_block  0.017821311950683594
generate_one_block  0.018312454223632812
generate_one_block  0.017304658889770508
generate_one_block  0.01743483543395996
generate_one_block  0.018158435821533203
generate_one_block  0.018139362335205078
generate_one_block  0.017511606216430664
generate_one_block  0.018592357635498047
generate_one_block  0.017990827560424805
generate_one_block  0.018161773681640625
generate_one_block  0.018529653549194336
generate_one_block  0.021670818328857422
generate_one_block  0.01884174346923828
generate_one_block  0.01723504066467285
generate_one_block  0.0175323486328125
generate_one_block  0.01851034164428711
generate_one_block  0.018707990646362305
generate_one_block  0.017228364944458008
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03981423377990723
gen group dst list time:  0.020793914794921875
time for parepare:  0.019578218460083008
local_output_nid generation:  0.00635981559753418
local_in_edges_tensor generation:  0.020777463912963867
mini_batch_src_global generation:  0.017026901245117188
r_  generation:  0.1552448272705078
local_output_nid generation:  0.00897359848022461
local_in_edges_tensor generation:  0.011562585830688477
mini_batch_src_global generation:  0.020119190216064453
r_  generation:  0.15987682342529297
local_output_nid generation:  0.00922536849975586
local_in_edges_tensor generation:  0.034056901931762695
mini_batch_src_global generation:  0.020060062408447266
r_  generation:  0.16845989227294922
local_output_nid generation:  0.009456396102905273
local_in_edges_tensor generation:  0.01217508316040039
mini_batch_src_global generation:  0.021595001220703125
r_  generation:  0.1756730079650879
local_output_nid generation:  0.009244680404663086
local_in_edges_tensor generation:  0.010579586029052734
mini_batch_src_global generation:  0.022450685501098633
r_  generation:  0.177321195602417
local_output_nid generation:  0.009279966354370117
local_in_edges_tensor generation:  0.012634038925170898
mini_batch_src_global generation:  0.023483753204345703
r_  generation:  0.18295836448669434
local_output_nid generation:  0.00888681411743164
local_in_edges_tensor generation:  0.00929713249206543
mini_batch_src_global generation:  0.02270054817199707
r_  generation:  0.17570853233337402
local_output_nid generation:  0.008720636367797852
local_in_edges_tensor generation:  0.009099245071411133
mini_batch_src_global generation:  0.021748065948486328
r_  generation:  0.17165184020996094
local_output_nid generation:  0.008960485458374023
local_in_edges_tensor generation:  0.009326457977294922
mini_batch_src_global generation:  0.02307724952697754
r_  generation:  0.18044328689575195
local_output_nid generation:  0.009200811386108398
local_in_edges_tensor generation:  0.009451627731323242
mini_batch_src_global generation:  0.022987842559814453
r_  generation:  0.17801451683044434
local_output_nid generation:  0.009507417678833008
local_in_edges_tensor generation:  0.009269237518310547
mini_batch_src_global generation:  0.023367643356323242
r_  generation:  0.18174004554748535
local_output_nid generation:  0.009244203567504883
local_in_edges_tensor generation:  0.00953817367553711
mini_batch_src_global generation:  0.022559404373168945
r_  generation:  0.17407870292663574
local_output_nid generation:  0.009462594985961914
local_in_edges_tensor generation:  0.00953221321105957
mini_batch_src_global generation:  0.022684574127197266
r_  generation:  0.18001151084899902
local_output_nid generation:  0.009191274642944336
local_in_edges_tensor generation:  0.0091552734375
mini_batch_src_global generation:  0.022365808486938477
r_  generation:  0.17298150062561035
local_output_nid generation:  0.009363651275634766
local_in_edges_tensor generation:  0.009046316146850586
mini_batch_src_global generation:  0.022881031036376953
r_  generation:  0.17872238159179688
local_output_nid generation:  0.009478569030761719
local_in_edges_tensor generation:  0.009318828582763672
mini_batch_src_global generation:  0.02439117431640625
r_  generation:  0.1873788833618164
local_output_nid generation:  0.009190797805786133
local_in_edges_tensor generation:  0.008805513381958008
mini_batch_src_global generation:  0.022571563720703125
r_  generation:  0.1736006736755371
local_output_nid generation:  0.009188413619995117
local_in_edges_tensor generation:  0.00890350341796875
mini_batch_src_global generation:  0.02255558967590332
r_  generation:  0.17557954788208008
local_output_nid generation:  0.009649038314819336
local_in_edges_tensor generation:  0.009023666381835938
mini_batch_src_global generation:  0.023195505142211914
r_  generation:  0.18752288818359375
local_output_nid generation:  0.009410858154296875
local_in_edges_tensor generation:  0.009706735610961914
mini_batch_src_global generation:  0.02361297607421875
r_  generation:  0.1838839054107666
local_output_nid generation:  0.009218215942382812
local_in_edges_tensor generation:  0.008888483047485352
mini_batch_src_global generation:  0.022449970245361328
r_  generation:  0.17294597625732422
local_output_nid generation:  0.009691715240478516
local_in_edges_tensor generation:  0.009418010711669922
mini_batch_src_global generation:  0.023611783981323242
r_  generation:  0.18905258178710938
local_output_nid generation:  0.009449005126953125
local_in_edges_tensor generation:  0.009281158447265625
mini_batch_src_global generation:  0.023277759552001953
r_  generation:  0.17934250831604004
local_output_nid generation:  0.00941777229309082
local_in_edges_tensor generation:  0.008932828903198242
mini_batch_src_global generation:  0.02265620231628418
r_  generation:  0.18154168128967285
local_output_nid generation:  0.009554624557495117
local_in_edges_tensor generation:  0.010428190231323242
mini_batch_src_global generation:  0.023441314697265625
r_  generation:  0.18805718421936035
local_output_nid generation:  0.009244203567504883
local_in_edges_tensor generation:  0.011812686920166016
mini_batch_src_global generation:  0.02258896827697754
r_  generation:  0.1828782558441162
local_output_nid generation:  0.009343385696411133
local_in_edges_tensor generation:  0.00896310806274414
mini_batch_src_global generation:  0.022300004959106445
r_  generation:  0.1775681972503662
local_output_nid generation:  0.009215831756591797
local_in_edges_tensor generation:  0.009055376052856445
mini_batch_src_global generation:  0.022170066833496094
r_  generation:  0.17363715171813965
local_output_nid generation:  0.009247541427612305
local_in_edges_tensor generation:  0.008913993835449219
mini_batch_src_global generation:  0.02196216583251953
r_  generation:  0.17744755744934082
local_output_nid generation:  0.00959324836730957
local_in_edges_tensor generation:  0.010228872299194336
mini_batch_src_global generation:  0.02406764030456543
r_  generation:  0.1835007667541504
local_output_nid generation:  0.009692668914794922
local_in_edges_tensor generation:  0.01041102409362793
mini_batch_src_global generation:  0.02424168586730957
r_  generation:  0.18625354766845703
local_output_nid generation:  0.009177446365356445
local_in_edges_tensor generation:  0.009292125701904297
mini_batch_src_global generation:  0.022409915924072266
r_  generation:  0.17685222625732422
----------------------check_connections_block total spend ----------------------------- 8.348917245864868
generate_one_block  0.23377084732055664
generate_one_block  0.23052549362182617
generate_one_block  0.2362198829650879
generate_one_block  0.24402070045471191
generate_one_block  0.2692532539367676
generate_one_block  0.2471776008605957
generate_one_block  0.24392461776733398
generate_one_block  0.23321127891540527
generate_one_block  0.24760150909423828
generate_one_block  0.24219489097595215
generate_one_block  0.24707984924316406
generate_one_block  0.23682761192321777
generate_one_block  0.24338459968566895
generate_one_block  0.2315843105316162
generate_one_block  0.24259614944458008
generate_one_block  0.25147175788879395
generate_one_block  0.23352622985839844
generate_one_block  0.23561930656433105
generate_one_block  0.2464303970336914
generate_one_block  0.25652456283569336
generate_one_block  0.23262333869934082
generate_one_block  0.25209927558898926
generate_one_block  0.24128079414367676
generate_one_block  0.23976874351501465
generate_one_block  0.2519547939300537
generate_one_block  0.24124383926391602
generate_one_block  0.24511027336120605
generate_one_block  0.23070430755615234
generate_one_block  0.2343459129333496
generate_one_block  0.24759125709533691
generate_one_block  0.24926471710205078
generate_one_block  0.2307267189025879
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04590964317321777
gen group dst list time:  0.1080324649810791
time for parepare:  0.01908731460571289
local_output_nid generation:  0.024960756301879883
local_in_edges_tensor generation:  0.04578375816345215
mini_batch_src_global generation:  0.03977251052856445
r_  generation:  0.4162299633026123
local_output_nid generation:  0.030553817749023438
local_in_edges_tensor generation:  0.03794455528259277
mini_batch_src_global generation:  0.04954099655151367
r_  generation:  0.4153127670288086
local_output_nid generation:  0.030806541442871094
local_in_edges_tensor generation:  0.028194189071655273
mini_batch_src_global generation:  0.04848837852478027
r_  generation:  0.428041934967041
local_output_nid generation:  0.03097057342529297
local_in_edges_tensor generation:  0.028789281845092773
mini_batch_src_global generation:  0.050395965576171875
r_  generation:  0.4245491027832031
local_output_nid generation:  0.03038644790649414
local_in_edges_tensor generation:  0.027312517166137695
mini_batch_src_global generation:  0.04996681213378906
r_  generation:  0.4325389862060547
local_output_nid generation:  0.02891683578491211
local_in_edges_tensor generation:  0.027988433837890625
mini_batch_src_global generation:  0.05116915702819824
r_  generation:  0.4277937412261963
local_output_nid generation:  0.028724193572998047
local_in_edges_tensor generation:  0.02704763412475586
mini_batch_src_global generation:  0.04909777641296387
r_  generation:  0.432636022567749
local_output_nid generation:  0.02902364730834961
local_in_edges_tensor generation:  0.0271303653717041
mini_batch_src_global generation:  0.050879478454589844
r_  generation:  0.42977190017700195
local_output_nid generation:  0.029050111770629883
local_in_edges_tensor generation:  0.02971196174621582
mini_batch_src_global generation:  0.0529329776763916
r_  generation:  0.43501782417297363
local_output_nid generation:  0.028784990310668945
local_in_edges_tensor generation:  0.027238845825195312
mini_batch_src_global generation:  0.051033973693847656
r_  generation:  0.43161725997924805
local_output_nid generation:  0.029187440872192383
local_in_edges_tensor generation:  0.028708219528198242
mini_batch_src_global generation:  0.05022168159484863
r_  generation:  0.4404146671295166
local_output_nid generation:  0.02890181541442871
local_in_edges_tensor generation:  0.0272519588470459
mini_batch_src_global generation:  0.05108904838562012
r_  generation:  0.4284796714782715
local_output_nid generation:  0.02890610694885254
local_in_edges_tensor generation:  0.028583765029907227
mini_batch_src_global generation:  0.05152416229248047
r_  generation:  0.43277502059936523
local_output_nid generation:  0.028609514236450195
local_in_edges_tensor generation:  0.026237964630126953
mini_batch_src_global generation:  0.05004405975341797
r_  generation:  0.4289674758911133
local_output_nid generation:  0.02893376350402832
local_in_edges_tensor generation:  0.0282742977142334
mini_batch_src_global generation:  0.04985833168029785
r_  generation:  0.4338357448577881
local_output_nid generation:  0.029018640518188477
local_in_edges_tensor generation:  0.028846025466918945
mini_batch_src_global generation:  0.05069589614868164
r_  generation:  0.4318201541900635
local_output_nid generation:  0.028569459915161133
local_in_edges_tensor generation:  0.030849933624267578
mini_batch_src_global generation:  0.04980206489562988
r_  generation:  0.43446826934814453
local_output_nid generation:  0.028913021087646484
local_in_edges_tensor generation:  0.027863502502441406
mini_batch_src_global generation:  0.05245566368103027
r_  generation:  0.4294254779815674
local_output_nid generation:  0.02904224395751953
local_in_edges_tensor generation:  0.028403282165527344
mini_batch_src_global generation:  0.04994463920593262
r_  generation:  0.4375777244567871
local_output_nid generation:  0.029058456420898438
local_in_edges_tensor generation:  0.02795553207397461
mini_batch_src_global generation:  0.05112648010253906
r_  generation:  0.43416500091552734
local_output_nid generation:  0.028682231903076172
local_in_edges_tensor generation:  0.02712392807006836
mini_batch_src_global generation:  0.04923510551452637
r_  generation:  0.4323599338531494
local_output_nid generation:  0.029244661331176758
local_in_edges_tensor generation:  0.03066420555114746
mini_batch_src_global generation:  0.051529884338378906
r_  generation:  0.4448354244232178
local_output_nid generation:  0.02895069122314453
local_in_edges_tensor generation:  0.029370784759521484
mini_batch_src_global generation:  0.04959821701049805
r_  generation:  0.43587398529052734
local_output_nid generation:  0.029147863388061523
local_in_edges_tensor generation:  0.02913522720336914
mini_batch_src_global generation:  0.05105781555175781
r_  generation:  0.4397397041320801
local_output_nid generation:  0.02911972999572754
local_in_edges_tensor generation:  0.029061555862426758
mini_batch_src_global generation:  0.04967689514160156
r_  generation:  0.4396860599517822
local_output_nid generation:  0.02890944480895996
local_in_edges_tensor generation:  0.027055740356445312
mini_batch_src_global generation:  0.051239013671875
r_  generation:  0.4385650157928467
local_output_nid generation:  0.02923417091369629
local_in_edges_tensor generation:  0.026212453842163086
mini_batch_src_global generation:  0.05013561248779297
r_  generation:  0.43919873237609863
local_output_nid generation:  0.028924942016601562
local_in_edges_tensor generation:  0.02736973762512207
mini_batch_src_global generation:  0.05121755599975586
r_  generation:  0.4284782409667969
local_output_nid generation:  0.02873396873474121
local_in_edges_tensor generation:  0.026355266571044922
mini_batch_src_global generation:  0.049333810806274414
r_  generation:  0.43367671966552734
local_output_nid generation:  0.029255151748657227
local_in_edges_tensor generation:  0.03374838829040527
mini_batch_src_global generation:  0.05416417121887207
r_  generation:  0.4339296817779541
local_output_nid generation:  0.02931833267211914
local_in_edges_tensor generation:  0.027161121368408203
mini_batch_src_global generation:  0.05016207695007324
r_  generation:  0.43799710273742676
local_output_nid generation:  0.028700590133666992
local_in_edges_tensor generation:  0.026323556900024414
mini_batch_src_global generation:  0.05093097686767578
r_  generation:  0.43346214294433594
----------------------check_connections_block total spend ----------------------------- 20.39783477783203
generate_one_block  0.5766971111297607
generate_one_block  0.563190221786499
generate_one_block  0.5771379470825195
generate_one_block  0.5818805694580078
generate_one_block  0.6509659290313721
generate_one_block  0.5840902328491211
generate_one_block  0.5674920082092285
generate_one_block  0.5719602108001709
generate_one_block  0.582984447479248
generate_one_block  0.5699136257171631
generate_one_block  0.5775370597839355
generate_one_block  0.5743348598480225
generate_one_block  0.5721166133880615
generate_one_block  0.5711755752563477
generate_one_block  0.576042652130127
generate_one_block  0.5792198181152344
generate_one_block  0.5746877193450928
generate_one_block  0.5748231410980225
generate_one_block  0.5840268135070801
generate_one_block  0.5735094547271729
generate_one_block  0.5733938217163086
generate_one_block  0.5820775032043457
generate_one_block  0.5721032619476318
generate_one_block  0.5800895690917969
generate_one_block  0.59596848487854
generate_one_block  0.5699539184570312
generate_one_block  0.5745904445648193
generate_one_block  0.565908670425415
generate_one_block  0.5688881874084473
generate_one_block  0.5832729339599609
generate_one_block  0.5893392562866211
generate_one_block  0.5726754665374756
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.12641429901123047  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

connection checking time:  28.7467520236969
block generation total time  26.261706352233887
average batch blocks generation time:  0.820678323507309
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10608577728271484  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.481531143188477  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10587739944458008  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.411672592163086  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10671138763427734  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.883073806762695  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10672760009765625  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.079903602600098  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10647344589233398  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.074949264526367  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10699844360351562  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.272717475891113  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10634994506835938  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.882699489593506  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10645532608032227  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.631618976593018  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10663175582885742  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.182071685791016  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10640239715576172  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.878125190734863  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10686063766479492  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.283803462982178  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10655021667480469  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.743950366973877  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10652494430541992  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.813345432281494  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10623025894165039  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.4386248588562  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10679197311401367  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.928693771362305  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10668802261352539  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.231645584106445  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10637092590332031  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.5814151763916  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10639333724975586  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.74802827835083  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10684442520141602  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.20835304260254  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1066584587097168  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.186979293823242  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1062922477722168  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.550644397735596  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10699272155761719  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.433560848236084  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1067194938659668  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.943886280059814  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10660457611083984  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.952858924865723  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10707521438598633  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.347763061523438  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10630369186401367  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.85665798187256  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10654640197753906  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.830020427703857  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10614871978759766  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.437469005584717  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10639572143554688  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.54392719268799  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10682439804077148  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.160512924194336  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10686540603637695  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.286155700683594  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10590505599975586  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.378888607025146  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.029879145324230194 |0.020742863416671753 |0.5592554807662964 |9.436905384063721e-05 |1.0675009563565254 |0.009157419204711914 |
----------------------------------------------------------pseudo_mini_loss sum 2.0728061199188232
 Run 0| Epoch 6 |
Number of nodes for computation during this epoch:  9106094
Number of first layer input nodes during this epoch:  4758402
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1256861686706543  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024932146072387695
random selection method range initialization spend 0.006656169891357422
time for parepare:  0.019878864288330078
local_output_nid generation:  0.0014333724975585938
local_in_edges_tensor generation:  0.00406956672668457
mini_batch_src_global generation:  0.0024538040161132812
r_  generation:  0.011724233627319336
local_output_nid generation:  0.0017025470733642578
local_in_edges_tensor generation:  0.0011458396911621094
mini_batch_src_global generation:  0.0016417503356933594
r_  generation:  0.010042905807495117
local_output_nid generation:  0.001661539077758789
local_in_edges_tensor generation:  0.0011010169982910156
mini_batch_src_global generation:  0.0013244152069091797
r_  generation:  0.010260581970214844
local_output_nid generation:  0.001631021499633789
local_in_edges_tensor generation:  0.0010781288146972656
mini_batch_src_global generation:  0.0012700557708740234
r_  generation:  0.010264158248901367
local_output_nid generation:  0.0016179084777832031
local_in_edges_tensor generation:  0.0010750293731689453
mini_batch_src_global generation:  0.0012357234954833984
r_  generation:  0.010184288024902344
local_output_nid generation:  0.0016052722930908203
local_in_edges_tensor generation:  0.0010724067687988281
mini_batch_src_global generation:  0.0011823177337646484
r_  generation:  0.009965181350708008
local_output_nid generation:  0.001617431640625
local_in_edges_tensor generation:  0.0010745525360107422
mini_batch_src_global generation:  0.001199960708618164
r_  generation:  0.010151863098144531
local_output_nid generation:  0.0016031265258789062
local_in_edges_tensor generation:  0.0010635852813720703
mini_batch_src_global generation:  0.0011935234069824219
r_  generation:  0.009918451309204102
local_output_nid generation:  0.0016055107116699219
local_in_edges_tensor generation:  0.0010716915130615234
mini_batch_src_global generation:  0.0012140274047851562
r_  generation:  0.010221481323242188
local_output_nid generation:  0.0016529560089111328
local_in_edges_tensor generation:  0.0010471343994140625
mini_batch_src_global generation:  0.0011947154998779297
r_  generation:  0.01001739501953125
local_output_nid generation:  0.0015804767608642578
local_in_edges_tensor generation:  0.0010499954223632812
mini_batch_src_global generation:  0.0011875629425048828
r_  generation:  0.010257959365844727
local_output_nid generation:  0.0015931129455566406
local_in_edges_tensor generation:  0.0010478496551513672
mini_batch_src_global generation:  0.0011970996856689453
r_  generation:  0.010249614715576172
local_output_nid generation:  0.001584768295288086
local_in_edges_tensor generation:  0.0010712146759033203
mini_batch_src_global generation:  0.0011453628540039062
r_  generation:  0.010200977325439453
local_output_nid generation:  0.0015971660614013672
local_in_edges_tensor generation:  0.0010449886322021484
mini_batch_src_global generation:  0.0011448860168457031
r_  generation:  0.010252237319946289
local_output_nid generation:  0.0015757083892822266
local_in_edges_tensor generation:  0.001039266586303711
mini_batch_src_global generation:  0.0011341571807861328
r_  generation:  0.010043859481811523
local_output_nid generation:  0.0015795230865478516
local_in_edges_tensor generation:  0.0010225772857666016
mini_batch_src_global generation:  0.0011477470397949219
r_  generation:  0.010172843933105469
local_output_nid generation:  0.0015954971313476562
local_in_edges_tensor generation:  0.001039266586303711
mini_batch_src_global generation:  0.001219034194946289
r_  generation:  0.010245800018310547
local_output_nid generation:  0.001581430435180664
local_in_edges_tensor generation:  0.0010447502136230469
mini_batch_src_global generation:  0.0011518001556396484
r_  generation:  0.0102386474609375
local_output_nid generation:  0.0015888214111328125
local_in_edges_tensor generation:  0.00104522705078125
mini_batch_src_global generation:  0.0011360645294189453
r_  generation:  0.010085344314575195
local_output_nid generation:  0.0015974044799804688
local_in_edges_tensor generation:  0.0010406970977783203
mini_batch_src_global generation:  0.0012080669403076172
r_  generation:  0.010287046432495117
local_output_nid generation:  0.0015702247619628906
local_in_edges_tensor generation:  0.0010323524475097656
mini_batch_src_global generation:  0.00116729736328125
r_  generation:  0.010291576385498047
local_output_nid generation:  0.0015823841094970703
local_in_edges_tensor generation:  0.0010335445404052734
mini_batch_src_global generation:  0.0012140274047851562
r_  generation:  0.010223388671875
local_output_nid generation:  0.0015871524810791016
local_in_edges_tensor generation:  0.0010395050048828125
mini_batch_src_global generation:  0.0011153221130371094
r_  generation:  0.01014852523803711
local_output_nid generation:  0.0015625953674316406
local_in_edges_tensor generation:  0.0010488033294677734
mini_batch_src_global generation:  0.0011248588562011719
r_  generation:  0.010321378707885742
local_output_nid generation:  0.001558065414428711
local_in_edges_tensor generation:  0.0010883808135986328
mini_batch_src_global generation:  0.0011756420135498047
r_  generation:  0.010439157485961914
local_output_nid generation:  0.0015671253204345703
local_in_edges_tensor generation:  0.0010192394256591797
mini_batch_src_global generation:  0.001142263412475586
r_  generation:  0.010109663009643555
local_output_nid generation:  0.001565694808959961
local_in_edges_tensor generation:  0.0010139942169189453
mini_batch_src_global generation:  0.0011379718780517578
r_  generation:  0.010480165481567383
local_output_nid generation:  0.0015742778778076172
local_in_edges_tensor generation:  0.0010442733764648438
mini_batch_src_global generation:  0.0012209415435791016
r_  generation:  0.010582923889160156
local_output_nid generation:  0.00159454345703125
local_in_edges_tensor generation:  0.0010502338409423828
mini_batch_src_global generation:  0.0011343955993652344
r_  generation:  0.010184764862060547
local_output_nid generation:  0.0015766620635986328
local_in_edges_tensor generation:  0.0010161399841308594
mini_batch_src_global generation:  0.0011398792266845703
r_  generation:  0.010483026504516602
local_output_nid generation:  0.001590728759765625
local_in_edges_tensor generation:  0.0010788440704345703
mini_batch_src_global generation:  0.0011548995971679688
r_  generation:  0.0104522705078125
local_output_nid generation:  0.0015826225280761719
local_in_edges_tensor generation:  0.0010197162628173828
mini_batch_src_global generation:  0.0011432170867919922
r_  generation:  0.010370016098022461
----------------------check_connections_block total spend ----------------------------- 0.571875810623169
generate_one_block  0.024622201919555664
generate_one_block  0.020989418029785156
generate_one_block  0.019623756408691406
generate_one_block  0.01898789405822754
generate_one_block  0.018524885177612305
generate_one_block  0.018044471740722656
generate_one_block  0.017995357513427734
generate_one_block  0.01784062385559082
generate_one_block  0.018189191818237305
generate_one_block  0.01772618293762207
generate_one_block  0.01803112030029297
generate_one_block  0.01830911636352539
generate_one_block  0.017918825149536133
generate_one_block  0.01789999008178711
generate_one_block  0.017537832260131836
generate_one_block  0.017830610275268555
generate_one_block  0.018050193786621094
generate_one_block  0.01801753044128418
generate_one_block  0.017770051956176758
generate_one_block  0.018032312393188477
generate_one_block  0.0181121826171875
generate_one_block  0.018053531646728516
generate_one_block  0.017920494079589844
generate_one_block  0.017975568771362305
generate_one_block  0.01824212074279785
generate_one_block  0.017891645431518555
generate_one_block  0.0182344913482666
generate_one_block  0.02041935920715332
generate_one_block  0.017882347106933594
generate_one_block  0.01828932762145996
generate_one_block  0.018158674240112305
generate_one_block  0.018030405044555664
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04508781433105469
gen group dst list time:  0.028263568878173828
time for parepare:  0.021770477294921875
local_output_nid generation:  0.0067136287689208984
local_in_edges_tensor generation:  0.022953510284423828
mini_batch_src_global generation:  0.022498607635498047
r_  generation:  0.16443300247192383
local_output_nid generation:  0.009311437606811523
local_in_edges_tensor generation:  0.011929512023925781
mini_batch_src_global generation:  0.034256935119628906
r_  generation:  0.18644332885742188
local_output_nid generation:  0.011043310165405273
local_in_edges_tensor generation:  0.03723764419555664
mini_batch_src_global generation:  0.024861812591552734
r_  generation:  0.18441414833068848
local_output_nid generation:  0.009952545166015625
local_in_edges_tensor generation:  0.010875463485717773
mini_batch_src_global generation:  0.024801015853881836
r_  generation:  0.1820077896118164
local_output_nid generation:  0.009587526321411133
local_in_edges_tensor generation:  0.009040117263793945
mini_batch_src_global generation:  0.0249178409576416
r_  generation:  0.1861715316772461
local_output_nid generation:  0.009093761444091797
local_in_edges_tensor generation:  0.010772943496704102
mini_batch_src_global generation:  0.02295660972595215
r_  generation:  0.1822495460510254
local_output_nid generation:  0.009009361267089844
local_in_edges_tensor generation:  0.011233329772949219
mini_batch_src_global generation:  0.022969722747802734
r_  generation:  0.1824948787689209
local_output_nid generation:  0.00897669792175293
local_in_edges_tensor generation:  0.009089469909667969
mini_batch_src_global generation:  0.023662328720092773
r_  generation:  0.18624472618103027
local_output_nid generation:  0.00908517837524414
local_in_edges_tensor generation:  0.008971691131591797
mini_batch_src_global generation:  0.023141860961914062
r_  generation:  0.18749332427978516
local_output_nid generation:  0.009169340133666992
local_in_edges_tensor generation:  0.009229660034179688
mini_batch_src_global generation:  0.022963285446166992
r_  generation:  0.18216586112976074
local_output_nid generation:  0.009369373321533203
local_in_edges_tensor generation:  0.008906126022338867
mini_batch_src_global generation:  0.023435592651367188
r_  generation:  0.18478703498840332
local_output_nid generation:  0.009526491165161133
local_in_edges_tensor generation:  0.008926630020141602
mini_batch_src_global generation:  0.023630380630493164
r_  generation:  0.1913435459136963
local_output_nid generation:  0.009598970413208008
local_in_edges_tensor generation:  0.008997201919555664
mini_batch_src_global generation:  0.023106098175048828
r_  generation:  0.1853799819946289
local_output_nid generation:  0.01017618179321289
local_in_edges_tensor generation:  0.012592554092407227
mini_batch_src_global generation:  0.023430347442626953
r_  generation:  0.18649649620056152
local_output_nid generation:  0.009268760681152344
local_in_edges_tensor generation:  0.01110219955444336
mini_batch_src_global generation:  0.02275228500366211
r_  generation:  0.18587017059326172
local_output_nid generation:  0.009334087371826172
local_in_edges_tensor generation:  0.009770631790161133
mini_batch_src_global generation:  0.024265289306640625
r_  generation:  0.1948554515838623
local_output_nid generation:  0.00961613655090332
local_in_edges_tensor generation:  0.010470867156982422
mini_batch_src_global generation:  0.02375960350036621
r_  generation:  0.1894667148590088
local_output_nid generation:  0.009669065475463867
local_in_edges_tensor generation:  0.009305477142333984
mini_batch_src_global generation:  0.023956298828125
r_  generation:  0.18774890899658203
local_output_nid generation:  0.009507894515991211
local_in_edges_tensor generation:  0.009605884552001953
mini_batch_src_global generation:  0.023471593856811523
r_  generation:  0.18395328521728516
local_output_nid generation:  0.00946950912475586
local_in_edges_tensor generation:  0.009766101837158203
mini_batch_src_global generation:  0.023700714111328125
r_  generation:  0.18616843223571777
local_output_nid generation:  0.00956273078918457
local_in_edges_tensor generation:  0.010413169860839844
mini_batch_src_global generation:  0.023504972457885742
r_  generation:  0.18728303909301758
local_output_nid generation:  0.009488344192504883
local_in_edges_tensor generation:  0.010637283325195312
mini_batch_src_global generation:  0.024782896041870117
r_  generation:  0.18883991241455078
local_output_nid generation:  0.009538412094116211
local_in_edges_tensor generation:  0.009851932525634766
mini_batch_src_global generation:  0.023683547973632812
r_  generation:  0.18752098083496094
local_output_nid generation:  0.009655475616455078
local_in_edges_tensor generation:  0.009876012802124023
mini_batch_src_global generation:  0.024355173110961914
r_  generation:  0.1868124008178711
local_output_nid generation:  0.009525537490844727
local_in_edges_tensor generation:  0.00907754898071289
mini_batch_src_global generation:  0.023751497268676758
r_  generation:  0.18948006629943848
local_output_nid generation:  0.00948953628540039
local_in_edges_tensor generation:  0.00911092758178711
mini_batch_src_global generation:  0.02416372299194336
r_  generation:  0.18739557266235352
local_output_nid generation:  0.009587287902832031
local_in_edges_tensor generation:  0.009248733520507812
mini_batch_src_global generation:  0.024330854415893555
r_  generation:  0.1887507438659668
local_output_nid generation:  0.009621381759643555
local_in_edges_tensor generation:  0.009947061538696289
mini_batch_src_global generation:  0.024337053298950195
r_  generation:  0.19295692443847656
local_output_nid generation:  0.009464740753173828
local_in_edges_tensor generation:  0.009159326553344727
mini_batch_src_global generation:  0.023876667022705078
r_  generation:  0.18903374671936035
local_output_nid generation:  0.009652853012084961
local_in_edges_tensor generation:  0.013406515121459961
mini_batch_src_global generation:  0.026424169540405273
r_  generation:  0.1967771053314209
local_output_nid generation:  0.009663820266723633
local_in_edges_tensor generation:  0.010151386260986328
mini_batch_src_global generation:  0.023835182189941406
r_  generation:  0.19024085998535156
local_output_nid generation:  0.01318359375
local_in_edges_tensor generation:  0.010834932327270508
mini_batch_src_global generation:  0.028720378875732422
r_  generation:  0.18834948539733887
----------------------check_connections_block total spend ----------------------------- 8.787248611450195
generate_one_block  0.2589883804321289
generate_one_block  0.2329702377319336
generate_one_block  0.2504744529724121
generate_one_block  0.24621176719665527
generate_one_block  0.27976226806640625
generate_one_block  0.2412400245666504
generate_one_block  0.24033403396606445
generate_one_block  0.24317669868469238
generate_one_block  0.24886155128479004
generate_one_block  0.24984264373779297
generate_one_block  0.24273395538330078
generate_one_block  0.24814319610595703
generate_one_block  0.2394418716430664
generate_one_block  0.24311590194702148
generate_one_block  0.23763108253479004
generate_one_block  0.24420475959777832
generate_one_block  0.24767827987670898
generate_one_block  0.24672627449035645
generate_one_block  0.24646496772766113
generate_one_block  0.2515833377838135
generate_one_block  0.2452538013458252
generate_one_block  0.24975371360778809
generate_one_block  0.24689078330993652
generate_one_block  0.24359130859375
generate_one_block  0.2477860450744629
generate_one_block  0.2464132308959961
generate_one_block  0.25061750411987305
generate_one_block  0.2535736560821533
generate_one_block  0.24486327171325684
generate_one_block  0.2501254081726074
generate_one_block  0.24321794509887695
generate_one_block  0.24186134338378906
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.038951873779296875
gen group dst list time:  0.11481666564941406
time for parepare:  0.021365642547607422
local_output_nid generation:  0.027515411376953125
local_in_edges_tensor generation:  0.04698944091796875
mini_batch_src_global generation:  0.039505720138549805
r_  generation:  0.4312131404876709
local_output_nid generation:  0.03183174133300781
local_in_edges_tensor generation:  0.034436702728271484
mini_batch_src_global generation:  0.05117368698120117
r_  generation:  0.43231749534606934
local_output_nid generation:  0.03186798095703125
local_in_edges_tensor generation:  0.026969194412231445
mini_batch_src_global generation:  0.05054283142089844
r_  generation:  0.4532284736633301
local_output_nid generation:  0.031996726989746094
local_in_edges_tensor generation:  0.02838420867919922
mini_batch_src_global generation:  0.054290771484375
r_  generation:  0.44501209259033203
local_output_nid generation:  0.032002925872802734
local_in_edges_tensor generation:  0.02756953239440918
mini_batch_src_global generation:  0.05028367042541504
r_  generation:  0.45020484924316406
local_output_nid generation:  0.03029942512512207
local_in_edges_tensor generation:  0.029166698455810547
mini_batch_src_global generation:  0.05085182189941406
r_  generation:  0.4445474147796631
local_output_nid generation:  0.029674053192138672
local_in_edges_tensor generation:  0.026814699172973633
mini_batch_src_global generation:  0.04977297782897949
r_  generation:  0.4415764808654785
local_output_nid generation:  0.0302579402923584
local_in_edges_tensor generation:  0.03248167037963867
mini_batch_src_global generation:  0.050765275955200195
r_  generation:  0.44183945655822754
local_output_nid generation:  0.030149459838867188
local_in_edges_tensor generation:  0.03263425827026367
mini_batch_src_global generation:  0.05011391639709473
r_  generation:  0.44266533851623535
local_output_nid generation:  0.029987096786499023
local_in_edges_tensor generation:  0.026851654052734375
mini_batch_src_global generation:  0.05086779594421387
r_  generation:  0.43975019454956055
local_output_nid generation:  0.03016972541809082
local_in_edges_tensor generation:  0.027484893798828125
mini_batch_src_global generation:  0.049741268157958984
r_  generation:  0.4384753704071045
local_output_nid generation:  0.029983997344970703
local_in_edges_tensor generation:  0.027377843856811523
mini_batch_src_global generation:  0.05055546760559082
r_  generation:  0.44637179374694824
local_output_nid generation:  0.029979705810546875
local_in_edges_tensor generation:  0.02911972999572754
mini_batch_src_global generation:  0.05003857612609863
r_  generation:  0.44447994232177734
local_output_nid generation:  0.029940128326416016
local_in_edges_tensor generation:  0.028605222702026367
mini_batch_src_global generation:  0.05198264122009277
r_  generation:  0.4441394805908203
local_output_nid generation:  0.03046870231628418
local_in_edges_tensor generation:  0.030657529830932617
mini_batch_src_global generation:  0.051874637603759766
r_  generation:  0.445037841796875
local_output_nid generation:  0.02965569496154785
local_in_edges_tensor generation:  0.03310275077819824
mini_batch_src_global generation:  0.05110907554626465
r_  generation:  0.447829008102417
local_output_nid generation:  0.029822349548339844
local_in_edges_tensor generation:  0.030774593353271484
mini_batch_src_global generation:  0.05013298988342285
r_  generation:  0.44761180877685547
local_output_nid generation:  0.0298919677734375
local_in_edges_tensor generation:  0.030930757522583008
mini_batch_src_global generation:  0.05065321922302246
r_  generation:  0.4514131546020508
local_output_nid generation:  0.029623985290527344
local_in_edges_tensor generation:  0.02691197395324707
mini_batch_src_global generation:  0.058197021484375
r_  generation:  0.4436354637145996
local_output_nid generation:  0.031334638595581055
local_in_edges_tensor generation:  0.02962636947631836
mini_batch_src_global generation:  0.05029702186584473
r_  generation:  0.44171786308288574
local_output_nid generation:  0.03036642074584961
local_in_edges_tensor generation:  0.030243873596191406
mini_batch_src_global generation:  0.04936718940734863
r_  generation:  0.44213366508483887
local_output_nid generation:  0.03046417236328125
local_in_edges_tensor generation:  0.02741074562072754
mini_batch_src_global generation:  0.05237627029418945
r_  generation:  0.4427797794342041
local_output_nid generation:  0.030302762985229492
local_in_edges_tensor generation:  0.027649879455566406
mini_batch_src_global generation:  0.0500330924987793
r_  generation:  0.4412524700164795
local_output_nid generation:  0.0304563045501709
local_in_edges_tensor generation:  0.02901935577392578
mini_batch_src_global generation:  0.050771474838256836
r_  generation:  0.44371485710144043
local_output_nid generation:  0.030284404754638672
local_in_edges_tensor generation:  0.028768301010131836
mini_batch_src_global generation:  0.04955267906188965
r_  generation:  0.4543182849884033
local_output_nid generation:  0.03037881851196289
local_in_edges_tensor generation:  0.03080129623413086
mini_batch_src_global generation:  0.0513458251953125
r_  generation:  0.44039392471313477
local_output_nid generation:  0.03037548065185547
local_in_edges_tensor generation:  0.02875828742980957
mini_batch_src_global generation:  0.053870439529418945
r_  generation:  0.44947242736816406
local_output_nid generation:  0.030264854431152344
local_in_edges_tensor generation:  0.026721715927124023
mini_batch_src_global generation:  0.05064678192138672
r_  generation:  0.4450814723968506
local_output_nid generation:  0.030604839324951172
local_in_edges_tensor generation:  0.028708219528198242
mini_batch_src_global generation:  0.05203056335449219
r_  generation:  0.44993066787719727
local_output_nid generation:  0.0308990478515625
local_in_edges_tensor generation:  0.02862715721130371
mini_batch_src_global generation:  0.05066967010498047
r_  generation:  0.4432413578033447
local_output_nid generation:  0.030650854110717773
local_in_edges_tensor generation:  0.027210474014282227
mini_batch_src_global generation:  0.04969620704650879
r_  generation:  0.45062780380249023
local_output_nid generation:  0.030871152877807617
local_in_edges_tensor generation:  0.0308072566986084
mini_batch_src_global generation:  0.051096200942993164
r_  generation:  0.44696593284606934
----------------------check_connections_block total spend ----------------------------- 20.887810230255127
generate_one_block  0.5969467163085938
generate_one_block  0.5764632225036621
generate_one_block  0.5814588069915771
generate_one_block  0.5786306858062744
generate_one_block  0.6923749446868896
generate_one_block  0.5751848220825195
generate_one_block  0.5806529521942139
generate_one_block  0.5809192657470703
generate_one_block  0.5883076190948486
generate_one_block  0.5763461589813232
generate_one_block  0.580094575881958
generate_one_block  0.5856316089630127
generate_one_block  0.5851428508758545
generate_one_block  0.5810377597808838
generate_one_block  0.5759475231170654
generate_one_block  0.5814249515533447
generate_one_block  0.5858466625213623
generate_one_block  0.5855600833892822
generate_one_block  0.5754976272583008
generate_one_block  0.5831396579742432
generate_one_block  0.5800266265869141
generate_one_block  0.5895969867706299
generate_one_block  0.5808467864990234
generate_one_block  0.5837306976318359
generate_one_block  0.5985643863677979
generate_one_block  0.5830898284912109
generate_one_block  0.579946756362915
generate_one_block  0.5820035934448242
generate_one_block  0.5823352336883545
generate_one_block  0.5812928676605225
generate_one_block  0.5849695205688477
generate_one_block  0.5803539752960205
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1256861686706543  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

connection checking time:  29.675058841705322
block generation total time  26.656899452209473
average batch blocks generation time:  0.833028107881546
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10659360885620117  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.073965549468994  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10637569427490234  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.43505334854126  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10678672790527344  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.332494258880615  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10685968399047852  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.173380851745605  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10690927505493164  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.17218017578125  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10651540756225586  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.93925952911377  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1063995361328125  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.861797332763672  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10695743560791016  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.995677947998047  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10678863525390625  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.98292875289917  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10650396347045898  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.632550716400146  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10632801055908203  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.743656158447266  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10655689239501953  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.981099128723145  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10662078857421875  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.656631469726562  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10635185241699219  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.78910255432129  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1063237190246582  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.49856662750244  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10669279098510742  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.871870517730713  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10665273666381836  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.003498554229736  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10682487487792969  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.027770519256592  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10632753372192383  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.688332557678223  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10643863677978516  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.83063507080078  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10653972625732422  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.823901653289795  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10677146911621094  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.096721649169922  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10659503936767578  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.967626094818115  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10669898986816406  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.890216827392578  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10644054412841797  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.017321586608887  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.106689453125  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.97882890701294  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10666036605834961  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.02037525177002  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10645103454589844  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.083343982696533  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1066288948059082  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.957854747772217  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10657453536987305  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.093528747558594  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10669803619384766  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.9393949508667  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10680818557739258  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.75084114074707  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03405555337667465 |0.01986616849899292 |0.5525774955749512 |9.321421384811401e-05 |1.0686391294002533 |0.005865573883056641 |
----------------------------------------------------------pseudo_mini_loss sum 1.9619942903518677
 Run 0| Epoch 7 |
Number of nodes for computation during this epoch:  9115420
Number of first layer input nodes during this epoch:  4761926
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1273632049560547  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025266170501708984
random selection method range initialization spend 0.005473613739013672
time for parepare:  0.020264148712158203
local_output_nid generation:  0.0014109611511230469
local_in_edges_tensor generation:  0.005917787551879883
mini_batch_src_global generation:  0.0015680789947509766
r_  generation:  0.0105133056640625
local_output_nid generation:  0.0016813278198242188
local_in_edges_tensor generation:  0.0010378360748291016
mini_batch_src_global generation:  0.0015544891357421875
r_  generation:  0.010437250137329102
local_output_nid generation:  0.0016341209411621094
local_in_edges_tensor generation:  0.001054525375366211
mini_batch_src_global generation:  0.0011692047119140625
r_  generation:  0.010087728500366211
local_output_nid generation:  0.0015981197357177734
local_in_edges_tensor generation:  0.0009188652038574219
mini_batch_src_global generation:  0.0011241436004638672
r_  generation:  0.009584665298461914
local_output_nid generation:  0.0015857219696044922
local_in_edges_tensor generation:  0.0009756088256835938
mini_batch_src_global generation:  0.001142740249633789
r_  generation:  0.009784221649169922
local_output_nid generation:  0.001581430435180664
local_in_edges_tensor generation:  0.001102447509765625
mini_batch_src_global generation:  0.0011248588562011719
r_  generation:  0.010121345520019531
local_output_nid generation:  0.0015690326690673828
local_in_edges_tensor generation:  0.0009427070617675781
mini_batch_src_global generation:  0.0011725425720214844
r_  generation:  0.010046243667602539
local_output_nid generation:  0.0015680789947509766
local_in_edges_tensor generation:  0.0009949207305908203
mini_batch_src_global generation:  0.0011508464813232422
r_  generation:  0.010103940963745117
local_output_nid generation:  0.0015635490417480469
local_in_edges_tensor generation:  0.0010128021240234375
mini_batch_src_global generation:  0.0011401176452636719
r_  generation:  0.010483503341674805
local_output_nid generation:  0.0015759468078613281
local_in_edges_tensor generation:  0.0009708404541015625
mini_batch_src_global generation:  0.001111745834350586
r_  generation:  0.010018587112426758
local_output_nid generation:  0.0015642642974853516
local_in_edges_tensor generation:  0.0010166168212890625
mini_batch_src_global generation:  0.0011725425720214844
r_  generation:  0.010493755340576172
local_output_nid generation:  0.0015709400177001953
local_in_edges_tensor generation:  0.0010738372802734375
mini_batch_src_global generation:  0.0011546611785888672
r_  generation:  0.010290861129760742
local_output_nid generation:  0.0015833377838134766
local_in_edges_tensor generation:  0.0009834766387939453
mini_batch_src_global generation:  0.0010900497436523438
r_  generation:  0.009890079498291016
local_output_nid generation:  0.001577615737915039
local_in_edges_tensor generation:  0.0009601116180419922
mini_batch_src_global generation:  0.0011372566223144531
r_  generation:  0.010201454162597656
local_output_nid generation:  0.0015811920166015625
local_in_edges_tensor generation:  0.0009057521820068359
mini_batch_src_global generation:  0.0011641979217529297
r_  generation:  0.010224342346191406
local_output_nid generation:  0.0015740394592285156
local_in_edges_tensor generation:  0.0008969306945800781
mini_batch_src_global generation:  0.0011692047119140625
r_  generation:  0.010024309158325195
local_output_nid generation:  0.0015723705291748047
local_in_edges_tensor generation:  0.0008838176727294922
mini_batch_src_global generation:  0.0011055469512939453
r_  generation:  0.010205745697021484
local_output_nid generation:  0.0015637874603271484
local_in_edges_tensor generation:  0.0009474754333496094
mini_batch_src_global generation:  0.0011758804321289062
r_  generation:  0.010339975357055664
local_output_nid generation:  0.0015523433685302734
local_in_edges_tensor generation:  0.0009558200836181641
mini_batch_src_global generation:  0.0011365413665771484
r_  generation:  0.010440826416015625
local_output_nid generation:  0.0015461444854736328
local_in_edges_tensor generation:  0.0009016990661621094
mini_batch_src_global generation:  0.001117706298828125
r_  generation:  0.010160684585571289
local_output_nid generation:  0.0015649795532226562
local_in_edges_tensor generation:  0.0009195804595947266
mini_batch_src_global generation:  0.001112222671508789
r_  generation:  0.010015726089477539
local_output_nid generation:  0.0015559196472167969
local_in_edges_tensor generation:  0.0009467601776123047
mini_batch_src_global generation:  0.0010967254638671875
r_  generation:  0.010185480117797852
local_output_nid generation:  0.0015676021575927734
local_in_edges_tensor generation:  0.0009288787841796875
mini_batch_src_global generation:  0.0011396408081054688
r_  generation:  0.01007986068725586
local_output_nid generation:  0.0015742778778076172
local_in_edges_tensor generation:  0.000896453857421875
mini_batch_src_global generation:  0.0011577606201171875
r_  generation:  0.010072946548461914
local_output_nid generation:  0.0015718936920166016
local_in_edges_tensor generation:  0.0009572505950927734
mini_batch_src_global generation:  0.0011432170867919922
r_  generation:  0.010643959045410156
local_output_nid generation:  0.001550912857055664
local_in_edges_tensor generation:  0.000888824462890625
mini_batch_src_global generation:  0.001117706298828125
r_  generation:  0.010257482528686523
local_output_nid generation:  0.0015606880187988281
local_in_edges_tensor generation:  0.0008821487426757812
mini_batch_src_global generation:  0.0011148452758789062
r_  generation:  0.010128974914550781
local_output_nid generation:  0.0015571117401123047
local_in_edges_tensor generation:  0.0009276866912841797
mini_batch_src_global generation:  0.0012154579162597656
r_  generation:  0.010008811950683594
local_output_nid generation:  0.0015671253204345703
local_in_edges_tensor generation:  0.0008971691131591797
mini_batch_src_global generation:  0.0011148452758789062
r_  generation:  0.010436773300170898
local_output_nid generation:  0.001584768295288086
local_in_edges_tensor generation:  0.0008790493011474609
mini_batch_src_global generation:  0.0011136531829833984
r_  generation:  0.010086774826049805
local_output_nid generation:  0.0015652179718017578
local_in_edges_tensor generation:  0.0008814334869384766
mini_batch_src_global generation:  0.0010828971862792969
r_  generation:  0.010291814804077148
local_output_nid generation:  0.0015671253204345703
local_in_edges_tensor generation:  0.0008678436279296875
mini_batch_src_global generation:  0.001085042953491211
r_  generation:  0.009982585906982422
----------------------check_connections_block total spend ----------------------------- 0.5628068447113037
generate_one_block  0.020246505737304688
generate_one_block  0.020865201950073242
generate_one_block  0.01906275749206543
generate_one_block  0.01780414581298828
generate_one_block  0.01791095733642578
generate_one_block  0.018203258514404297
generate_one_block  0.017749786376953125
generate_one_block  0.01809406280517578
generate_one_block  0.018655776977539062
generate_one_block  0.017807960510253906
generate_one_block  0.01833176612854004
generate_one_block  0.018193960189819336
generate_one_block  0.017400026321411133
generate_one_block  0.018198013305664062
generate_one_block  0.018017292022705078
generate_one_block  0.017791748046875
generate_one_block  0.01795673370361328
generate_one_block  0.01835465431213379
generate_one_block  0.01839733123779297
generate_one_block  0.0180511474609375
generate_one_block  0.017641305923461914
generate_one_block  0.018019676208496094
generate_one_block  0.017706871032714844
generate_one_block  0.017913818359375
generate_one_block  0.01874065399169922
generate_one_block  0.018038511276245117
generate_one_block  0.01792621612548828
generate_one_block  0.01758432388305664
generate_one_block  0.018307209014892578
generate_one_block  0.01776742935180664
generate_one_block  0.017857074737548828
generate_one_block  0.017825841903686523
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03952455520629883
gen group dst list time:  0.021053552627563477
time for parepare:  0.020342111587524414
local_output_nid generation:  0.006704092025756836
local_in_edges_tensor generation:  0.019383668899536133
mini_batch_src_global generation:  0.0168764591217041
r_  generation:  0.15532207489013672
local_output_nid generation:  0.009106159210205078
local_in_edges_tensor generation:  0.011980772018432617
mini_batch_src_global generation:  0.021283388137817383
r_  generation:  0.16737604141235352
local_output_nid generation:  0.009455442428588867
local_in_edges_tensor generation:  0.034766435623168945
mini_batch_src_global generation:  0.02082681655883789
r_  generation:  0.17438316345214844
local_output_nid generation:  0.009186267852783203
local_in_edges_tensor generation:  0.010219573974609375
mini_batch_src_global generation:  0.020523548126220703
r_  generation:  0.16595458984375
local_output_nid generation:  0.009290933609008789
local_in_edges_tensor generation:  0.00972437858581543
mini_batch_src_global generation:  0.02117609977722168
r_  generation:  0.17452096939086914
local_output_nid generation:  0.008963346481323242
local_in_edges_tensor generation:  0.010003089904785156
mini_batch_src_global generation:  0.021997690200805664
r_  generation:  0.17631196975708008
local_output_nid generation:  0.00882101058959961
local_in_edges_tensor generation:  0.009729385375976562
mini_batch_src_global generation:  0.025002479553222656
r_  generation:  0.1756596565246582
local_output_nid generation:  0.008937835693359375
local_in_edges_tensor generation:  0.010999679565429688
mini_batch_src_global generation:  0.02333211898803711
r_  generation:  0.18093657493591309
local_output_nid generation:  0.009330272674560547
local_in_edges_tensor generation:  0.011682987213134766
mini_batch_src_global generation:  0.024010658264160156
r_  generation:  0.18625354766845703
local_output_nid generation:  0.009076118469238281
local_in_edges_tensor generation:  0.00890207290649414
mini_batch_src_global generation:  0.02240300178527832
r_  generation:  0.1777057647705078
local_output_nid generation:  0.009439706802368164
local_in_edges_tensor generation:  0.009252071380615234
mini_batch_src_global generation:  0.023191213607788086
r_  generation:  0.1845078468322754
local_output_nid generation:  0.009317398071289062
local_in_edges_tensor generation:  0.009195566177368164
mini_batch_src_global generation:  0.022387027740478516
r_  generation:  0.17787790298461914
local_output_nid generation:  0.009223699569702148
local_in_edges_tensor generation:  0.008853912353515625
mini_batch_src_global generation:  0.022098064422607422
r_  generation:  0.1758255958557129
local_output_nid generation:  0.009389638900756836
local_in_edges_tensor generation:  0.009437084197998047
mini_batch_src_global generation:  0.02277374267578125
r_  generation:  0.18216490745544434
local_output_nid generation:  0.009371757507324219
local_in_edges_tensor generation:  0.009226083755493164
mini_batch_src_global generation:  0.022785425186157227
r_  generation:  0.19094014167785645
local_output_nid generation:  0.009439468383789062
local_in_edges_tensor generation:  0.009359121322631836
mini_batch_src_global generation:  0.023038387298583984
r_  generation:  0.18360447883605957
local_output_nid generation:  0.009393930435180664
local_in_edges_tensor generation:  0.009721994400024414
mini_batch_src_global generation:  0.023382186889648438
r_  generation:  0.18452954292297363
local_output_nid generation:  0.009500503540039062
local_in_edges_tensor generation:  0.009460687637329102
mini_batch_src_global generation:  0.023238182067871094
r_  generation:  0.18605566024780273
local_output_nid generation:  0.009672880172729492
local_in_edges_tensor generation:  0.010179281234741211
mini_batch_src_global generation:  0.024672508239746094
r_  generation:  0.19029760360717773
local_output_nid generation:  0.009400129318237305
local_in_edges_tensor generation:  0.00930929183959961
mini_batch_src_global generation:  0.023246049880981445
r_  generation:  0.18164730072021484
local_output_nid generation:  0.009201765060424805
local_in_edges_tensor generation:  0.00924372673034668
mini_batch_src_global generation:  0.022260665893554688
r_  generation:  0.1794288158416748
local_output_nid generation:  0.009446144104003906
local_in_edges_tensor generation:  0.009084224700927734
mini_batch_src_global generation:  0.022632837295532227
r_  generation:  0.18221807479858398
local_output_nid generation:  0.009390830993652344
local_in_edges_tensor generation:  0.009277105331420898
mini_batch_src_global generation:  0.022341489791870117
r_  generation:  0.1805284023284912
local_output_nid generation:  0.009338140487670898
local_in_edges_tensor generation:  0.009307861328125
mini_batch_src_global generation:  0.02321338653564453
r_  generation:  0.18418073654174805
local_output_nid generation:  0.00987386703491211
local_in_edges_tensor generation:  0.011557340621948242
mini_batch_src_global generation:  0.023777246475219727
r_  generation:  0.19370675086975098
local_output_nid generation:  0.009437084197998047
local_in_edges_tensor generation:  0.009773492813110352
mini_batch_src_global generation:  0.023454904556274414
r_  generation:  0.18506979942321777
local_output_nid generation:  0.009367227554321289
local_in_edges_tensor generation:  0.009773492813110352
mini_batch_src_global generation:  0.022705078125
r_  generation:  0.18475914001464844
local_output_nid generation:  0.009363651275634766
local_in_edges_tensor generation:  0.00886845588684082
mini_batch_src_global generation:  0.022485733032226562
r_  generation:  0.1773676872253418
local_output_nid generation:  0.009554147720336914
local_in_edges_tensor generation:  0.009338617324829102
mini_batch_src_global generation:  0.024309873580932617
r_  generation:  0.1872880458831787
local_output_nid generation:  0.009397268295288086
local_in_edges_tensor generation:  0.009615898132324219
mini_batch_src_global generation:  0.022748231887817383
r_  generation:  0.18222403526306152
local_output_nid generation:  0.009386301040649414
local_in_edges_tensor generation:  0.009084939956665039
mini_batch_src_global generation:  0.023037433624267578
r_  generation:  0.18857288360595703
local_output_nid generation:  0.009264230728149414
local_in_edges_tensor generation:  0.01343226432800293
mini_batch_src_global generation:  0.02276897430419922
r_  generation:  0.18311643600463867
----------------------check_connections_block total spend ----------------------------- 8.460275411605835
generate_one_block  0.23420262336730957
generate_one_block  0.23828697204589844
generate_one_block  0.24290204048156738
generate_one_block  0.23168730735778809
generate_one_block  0.27063632011413574
generate_one_block  0.24514055252075195
generate_one_block  0.236891508102417
generate_one_block  0.24734163284301758
generate_one_block  0.2518181800842285
generate_one_block  0.24332451820373535
generate_one_block  0.24874114990234375
generate_one_block  0.24301815032958984
generate_one_block  0.23540592193603516
generate_one_block  0.2460944652557373
generate_one_block  0.24007797241210938
generate_one_block  0.2468116283416748
generate_one_block  0.24612808227539062
generate_one_block  0.25278711318969727
generate_one_block  0.252410888671875
generate_one_block  0.3364064693450928
generate_one_block  0.23592162132263184
generate_one_block  0.24476909637451172
generate_one_block  0.23394465446472168
generate_one_block  0.2531261444091797
generate_one_block  0.25585126876831055
generate_one_block  0.24449968338012695
generate_one_block  0.24257302284240723
generate_one_block  0.23472833633422852
generate_one_block  0.25635313987731934
generate_one_block  0.24119019508361816
generate_one_block  0.25061464309692383
generate_one_block  0.24206948280334473
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03499960899353027
gen group dst list time:  0.1109006404876709
time for parepare:  0.020355939865112305
local_output_nid generation:  0.026067256927490234
local_in_edges_tensor generation:  0.04658198356628418
mini_batch_src_global generation:  0.03925347328186035
r_  generation:  0.42096734046936035
local_output_nid generation:  0.03165173530578613
local_in_edges_tensor generation:  0.034566640853881836
mini_batch_src_global generation:  0.049602508544921875
r_  generation:  0.42989683151245117
local_output_nid generation:  0.03209090232849121
local_in_edges_tensor generation:  0.03140711784362793
mini_batch_src_global generation:  0.04884696006774902
r_  generation:  0.43497586250305176
local_output_nid generation:  0.03164196014404297
local_in_edges_tensor generation:  0.026853322982788086
mini_batch_src_global generation:  0.04954099655151367
r_  generation:  0.42412829399108887
local_output_nid generation:  0.03157305717468262
local_in_edges_tensor generation:  0.030511856079101562
mini_batch_src_global generation:  0.049707651138305664
r_  generation:  0.4386780261993408
local_output_nid generation:  0.029726266860961914
local_in_edges_tensor generation:  0.02648758888244629
mini_batch_src_global generation:  0.05053424835205078
r_  generation:  0.4318375587463379
local_output_nid generation:  0.029670238494873047
local_in_edges_tensor generation:  0.027915239334106445
mini_batch_src_global generation:  0.04932379722595215
r_  generation:  0.4351828098297119
local_output_nid generation:  0.029746532440185547
local_in_edges_tensor generation:  0.027012348175048828
mini_batch_src_global generation:  0.050733089447021484
r_  generation:  0.43268632888793945
local_output_nid generation:  0.030852794647216797
local_in_edges_tensor generation:  0.028363466262817383
mini_batch_src_global generation:  0.052054643630981445
r_  generation:  0.44081544876098633
local_output_nid generation:  0.029959440231323242
local_in_edges_tensor generation:  0.027108192443847656
mini_batch_src_global generation:  0.050458669662475586
r_  generation:  0.43419694900512695
local_output_nid generation:  0.030086040496826172
local_in_edges_tensor generation:  0.028596878051757812
mini_batch_src_global generation:  0.04971504211425781
r_  generation:  0.4369692802429199
local_output_nid generation:  0.029857397079467773
local_in_edges_tensor generation:  0.027618408203125
mini_batch_src_global generation:  0.050684213638305664
r_  generation:  0.43571019172668457
local_output_nid generation:  0.030033588409423828
local_in_edges_tensor generation:  0.028575897216796875
mini_batch_src_global generation:  0.04927825927734375
r_  generation:  0.4361991882324219
local_output_nid generation:  0.029883623123168945
local_in_edges_tensor generation:  0.028481245040893555
mini_batch_src_global generation:  0.053092241287231445
r_  generation:  0.4348745346069336
local_output_nid generation:  0.030028104782104492
local_in_edges_tensor generation:  0.02874302864074707
mini_batch_src_global generation:  0.05106091499328613
r_  generation:  0.43944382667541504
local_output_nid generation:  0.029847145080566406
local_in_edges_tensor generation:  0.0285031795501709
mini_batch_src_global generation:  0.051252126693725586
r_  generation:  0.4338514804840088
local_output_nid generation:  0.02989673614501953
local_in_edges_tensor generation:  0.026850223541259766
mini_batch_src_global generation:  0.04970121383666992
r_  generation:  0.43630552291870117
local_output_nid generation:  0.03005242347717285
local_in_edges_tensor generation:  0.02871870994567871
mini_batch_src_global generation:  0.054065704345703125
r_  generation:  0.43471622467041016
local_output_nid generation:  0.03007197380065918
local_in_edges_tensor generation:  0.027469635009765625
mini_batch_src_global generation:  0.04966330528259277
r_  generation:  0.43726611137390137
local_output_nid generation:  0.029801130294799805
local_in_edges_tensor generation:  0.026479482650756836
mini_batch_src_global generation:  0.050797462463378906
r_  generation:  0.43353700637817383
local_output_nid generation:  0.02966451644897461
local_in_edges_tensor generation:  0.026952266693115234
mini_batch_src_global generation:  0.04933738708496094
r_  generation:  0.43457579612731934
local_output_nid generation:  0.029933452606201172
local_in_edges_tensor generation:  0.02883744239807129
mini_batch_src_global generation:  0.05185580253601074
r_  generation:  0.43396711349487305
local_output_nid generation:  0.02996826171875
local_in_edges_tensor generation:  0.027213573455810547
mini_batch_src_global generation:  0.04924607276916504
r_  generation:  0.4365410804748535
local_output_nid generation:  0.030147790908813477
local_in_edges_tensor generation:  0.030657529830932617
mini_batch_src_global generation:  0.05107688903808594
r_  generation:  0.4363253116607666
local_output_nid generation:  0.030072450637817383
local_in_edges_tensor generation:  0.028460264205932617
mini_batch_src_global generation:  0.049764156341552734
r_  generation:  0.4418656826019287
local_output_nid generation:  0.02984142303466797
local_in_edges_tensor generation:  0.026911497116088867
mini_batch_src_global generation:  0.051053762435913086
r_  generation:  0.43471527099609375
local_output_nid generation:  0.029949665069580078
local_in_edges_tensor generation:  0.028229951858520508
mini_batch_src_global generation:  0.04901528358459473
r_  generation:  0.43869781494140625
local_output_nid generation:  0.029783010482788086
local_in_edges_tensor generation:  0.02895331382751465
mini_batch_src_global generation:  0.05030703544616699
r_  generation:  0.4319300651550293
local_output_nid generation:  0.029755115509033203
local_in_edges_tensor generation:  0.026495933532714844
mini_batch_src_global generation:  0.049071311950683594
r_  generation:  0.4387032985687256
local_output_nid generation:  0.02983546257019043
local_in_edges_tensor generation:  0.030521631240844727
mini_batch_src_global generation:  0.05176830291748047
r_  generation:  0.437009334564209
local_output_nid generation:  0.03001689910888672
local_in_edges_tensor generation:  0.028780460357666016
mini_batch_src_global generation:  0.05110454559326172
r_  generation:  0.44106078147888184
local_output_nid generation:  0.029978036880493164
local_in_edges_tensor generation:  0.026904821395874023
mini_batch_src_global generation:  0.050179243087768555
r_  generation:  0.43610644340515137
----------------------check_connections_block total spend ----------------------------- 20.5073823928833
generate_one_block  0.661107063293457
generate_one_block  0.5744936466217041
generate_one_block  0.5792398452758789
generate_one_block  0.5695321559906006
generate_one_block  0.5763669013977051
generate_one_block  0.573430061340332
generate_one_block  0.5703904628753662
generate_one_block  0.5765256881713867
generate_one_block  0.582993745803833
generate_one_block  0.5731368064880371
generate_one_block  0.5918087959289551
generate_one_block  0.5787081718444824
generate_one_block  0.5745935440063477
generate_one_block  0.5787777900695801
generate_one_block  0.5840308666229248
generate_one_block  0.5782914161682129
generate_one_block  0.5740666389465332
generate_one_block  0.5894968509674072
generate_one_block  0.5841872692108154
generate_one_block  0.5716876983642578
generate_one_block  0.5791723728179932
generate_one_block  0.5903830528259277
generate_one_block  0.5744047164916992
generate_one_block  0.5924127101898193
generate_one_block  0.5854756832122803
generate_one_block  0.5727200508117676
generate_one_block  0.5798766613006592
generate_one_block  0.5739583969116211
generate_one_block  0.5758616924285889
generate_one_block  0.5896198749542236
generate_one_block  0.5821630954742432
generate_one_block  0.5991206169128418
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1273632049560547  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

connection checking time:  28.967657804489136
block generation total time  26.563789129257202
average batch blocks generation time:  0.8301184102892876
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1064000129699707  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.421401023864746  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10646915435791016  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.850187301635742  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10683584213256836  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.09400463104248  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10618352890014648  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.39804172515869  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10668373107910156  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.863994598388672  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1064600944519043  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.98607063293457  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10624933242797852  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.575078010559082  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10666131973266602  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.131444931030273  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10708284378051758  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.343292713165283  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10637998580932617  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.847797870635986  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10689020156860352  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.19734287261963  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10662078857421875  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.823941707611084  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10660266876220703  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.54833745956421  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1066427230834961  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.037528038024902  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10647821426391602  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.79168701171875  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10682201385498047  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.05532932281494  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1064910888671875  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.016677379608154  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10648918151855469  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.202480792999268  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1069788932800293  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.277079105377197  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1066751480102539  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.889038562774658  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10625648498535156  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.60901117324829  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10655736923217773  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.927693843841553  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10654067993164062  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.521095752716064  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10662174224853516  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.08919334411621  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1069183349609375  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.38167667388916  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10661888122558594  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.01194190979004  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1065378189086914  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.916600704193115  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10625505447387695  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.47551202774048  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10663223266601562  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.123945236206055  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1065373420715332  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.879152297973633  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10683679580688477  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.040208339691162  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10649538040161133  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.86678457260132  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.030179642140865326 |0.019472293555736542 |0.5533503368496895 |9.468942880630493e-05 |1.0654614716768265 |0.005864381790161133 |
----------------------------------------------------------pseudo_mini_loss sum 1.8618501424789429
 Run 0| Epoch 8 |
Number of nodes for computation during this epoch:  9113391
Number of first layer input nodes during this epoch:  4760949
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.12623023986816406  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02585458755493164
random selection method range initialization spend 0.00574803352355957
time for parepare:  0.019464969635009766
local_output_nid generation:  0.0013921260833740234
local_in_edges_tensor generation:  0.009084463119506836
mini_batch_src_global generation:  0.0017194747924804688
r_  generation:  0.010300159454345703
local_output_nid generation:  0.001554727554321289
local_in_edges_tensor generation:  0.0011322498321533203
mini_batch_src_global generation:  0.0016491413116455078
r_  generation:  0.010144233703613281
local_output_nid generation:  0.0015728473663330078
local_in_edges_tensor generation:  0.0010061264038085938
mini_batch_src_global generation:  0.0011603832244873047
r_  generation:  0.010017871856689453
local_output_nid generation:  0.0015869140625
local_in_edges_tensor generation:  0.0010073184967041016
mini_batch_src_global generation:  0.0011751651763916016
r_  generation:  0.010156631469726562
local_output_nid generation:  0.0015647411346435547
local_in_edges_tensor generation:  0.0009715557098388672
mini_batch_src_global generation:  0.0011174678802490234
r_  generation:  0.009807586669921875
local_output_nid generation:  0.0015599727630615234
local_in_edges_tensor generation:  0.0009539127349853516
mini_batch_src_global generation:  0.0011432170867919922
r_  generation:  0.010310173034667969
local_output_nid generation:  0.0015637874603271484
local_in_edges_tensor generation:  0.0009448528289794922
mini_batch_src_global generation:  0.001111745834350586
r_  generation:  0.009831666946411133
local_output_nid generation:  0.0015671253204345703
local_in_edges_tensor generation:  0.0009236335754394531
mini_batch_src_global generation:  0.0011472702026367188
r_  generation:  0.009676694869995117
local_output_nid generation:  0.001560211181640625
local_in_edges_tensor generation:  0.0009441375732421875
mini_batch_src_global generation:  0.0011093616485595703
r_  generation:  0.010303974151611328
local_output_nid generation:  0.001577615737915039
local_in_edges_tensor generation:  0.0009462833404541016
mini_batch_src_global generation:  0.0011487007141113281
r_  generation:  0.010233402252197266
local_output_nid generation:  0.0015819072723388672
local_in_edges_tensor generation:  0.0009331703186035156
mini_batch_src_global generation:  0.0011110305786132812
r_  generation:  0.009963512420654297
local_output_nid generation:  0.0015587806701660156
local_in_edges_tensor generation:  0.0009338855743408203
mini_batch_src_global generation:  0.001104116439819336
r_  generation:  0.010076284408569336
local_output_nid generation:  0.0015752315521240234
local_in_edges_tensor generation:  0.0009171962738037109
mini_batch_src_global generation:  0.0011391639709472656
r_  generation:  0.010191917419433594
local_output_nid generation:  0.0015821456909179688
local_in_edges_tensor generation:  0.0009191036224365234
mini_batch_src_global generation:  0.0011336803436279297
r_  generation:  0.010334253311157227
local_output_nid generation:  0.0015697479248046875
local_in_edges_tensor generation:  0.0009164810180664062
mini_batch_src_global generation:  0.0012097358703613281
r_  generation:  0.010467290878295898
local_output_nid generation:  0.001584768295288086
local_in_edges_tensor generation:  0.0008902549743652344
mini_batch_src_global generation:  0.001142263412475586
r_  generation:  0.010254383087158203
local_output_nid generation:  0.0015740394592285156
local_in_edges_tensor generation:  0.0009064674377441406
mini_batch_src_global generation:  0.0011508464813232422
r_  generation:  0.010279655456542969
local_output_nid generation:  0.001584768295288086
local_in_edges_tensor generation:  0.0009152889251708984
mini_batch_src_global generation:  0.0011706352233886719
r_  generation:  0.010639429092407227
local_output_nid generation:  0.0015795230865478516
local_in_edges_tensor generation:  0.0009219646453857422
mini_batch_src_global generation:  0.001169443130493164
r_  generation:  0.01031637191772461
local_output_nid generation:  0.001589059829711914
local_in_edges_tensor generation:  0.0009186267852783203
mini_batch_src_global generation:  0.0011680126190185547
r_  generation:  0.010249853134155273
local_output_nid generation:  0.0016028881072998047
local_in_edges_tensor generation:  0.0009338855743408203
mini_batch_src_global generation:  0.0012247562408447266
r_  generation:  0.010541439056396484
local_output_nid generation:  0.0015971660614013672
local_in_edges_tensor generation:  0.0009379386901855469
mini_batch_src_global generation:  0.0011959075927734375
r_  generation:  0.010793685913085938
local_output_nid generation:  0.0015835762023925781
local_in_edges_tensor generation:  0.0009217262268066406
mini_batch_src_global generation:  0.0012183189392089844
r_  generation:  0.010709524154663086
local_output_nid generation:  0.0016009807586669922
local_in_edges_tensor generation:  0.000896453857421875
mini_batch_src_global generation:  0.0012006759643554688
r_  generation:  0.010282278060913086
local_output_nid generation:  0.0015981197357177734
local_in_edges_tensor generation:  0.0009284019470214844
mini_batch_src_global generation:  0.00115966796875
r_  generation:  0.010498046875
local_output_nid generation:  0.0016055107116699219
local_in_edges_tensor generation:  0.0008990764617919922
mini_batch_src_global generation:  0.0011644363403320312
r_  generation:  0.009904146194458008
local_output_nid generation:  0.001577138900756836
local_in_edges_tensor generation:  0.0009086132049560547
mini_batch_src_global generation:  0.001130819320678711
r_  generation:  0.010344743728637695
local_output_nid generation:  0.0015888214111328125
local_in_edges_tensor generation:  0.0009131431579589844
mini_batch_src_global generation:  0.0011396408081054688
r_  generation:  0.01011037826538086
local_output_nid generation:  0.001583099365234375
local_in_edges_tensor generation:  0.0008981227874755859
mini_batch_src_global generation:  0.001140594482421875
r_  generation:  0.010168790817260742
local_output_nid generation:  0.0015802383422851562
local_in_edges_tensor generation:  0.0009019374847412109
mini_batch_src_global generation:  0.0011234283447265625
r_  generation:  0.010014533996582031
local_output_nid generation:  0.001585245132446289
local_in_edges_tensor generation:  0.0009047985076904297
mini_batch_src_global generation:  0.0011889934539794922
r_  generation:  0.010252952575683594
local_output_nid generation:  0.001588582992553711
local_in_edges_tensor generation:  0.0009164810180664062
mini_batch_src_global generation:  0.0011661052703857422
r_  generation:  0.010553121566772461
----------------------check_connections_block total spend ----------------------------- 0.5696008205413818
generate_one_block  0.023801088333129883
generate_one_block  0.02123236656188965
generate_one_block  0.01885676383972168
generate_one_block  0.018656015396118164
generate_one_block  0.017989158630371094
generate_one_block  0.018506765365600586
generate_one_block  0.0175783634185791
generate_one_block  0.017420291900634766
generate_one_block  0.018406391143798828
generate_one_block  0.01817917823791504
generate_one_block  0.0176849365234375
generate_one_block  0.018176555633544922
generate_one_block  0.017980575561523438
generate_one_block  0.018306255340576172
generate_one_block  0.018265962600708008
generate_one_block  0.01794123649597168
generate_one_block  0.018031835556030273
generate_one_block  0.018714427947998047
generate_one_block  0.01815176010131836
generate_one_block  0.01812005043029785
generate_one_block  0.018620729446411133
generate_one_block  0.018834829330444336
generate_one_block  0.021948814392089844
generate_one_block  0.01877737045288086
generate_one_block  0.018619060516357422
generate_one_block  0.017540693283081055
generate_one_block  0.01825881004333496
generate_one_block  0.01774907112121582
generate_one_block  0.017940521240234375
generate_one_block  0.017574310302734375
generate_one_block  0.018226146697998047
generate_one_block  0.01860499382019043
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.039139747619628906
gen group dst list time:  0.023367643356323242
time for parepare:  0.02200007438659668
local_output_nid generation:  0.006363868713378906
local_in_edges_tensor generation:  0.02177739143371582
mini_batch_src_global generation:  0.017515182495117188
r_  generation:  0.15646100044250488
local_output_nid generation:  0.00936436653137207
local_in_edges_tensor generation:  0.01166677474975586
mini_batch_src_global generation:  0.02318739891052246
r_  generation:  0.16747426986694336
local_output_nid generation:  0.009358644485473633
local_in_edges_tensor generation:  0.032506465911865234
mini_batch_src_global generation:  0.020359516143798828
r_  generation:  0.1693737506866455
local_output_nid generation:  0.009448051452636719
local_in_edges_tensor generation:  0.010399580001831055
mini_batch_src_global generation:  0.02180314064025879
r_  generation:  0.17377758026123047
local_output_nid generation:  0.00928640365600586
local_in_edges_tensor generation:  0.009734630584716797
mini_batch_src_global generation:  0.0217587947845459
r_  generation:  0.17518234252929688
local_output_nid generation:  0.009039163589477539
local_in_edges_tensor generation:  0.010567903518676758
mini_batch_src_global generation:  0.02332782745361328
r_  generation:  0.17920947074890137
local_output_nid generation:  0.008775472640991211
local_in_edges_tensor generation:  0.010418891906738281
mini_batch_src_global generation:  0.022611379623413086
r_  generation:  0.1723792552947998
local_output_nid generation:  0.008713245391845703
local_in_edges_tensor generation:  0.00989532470703125
mini_batch_src_global generation:  0.021613359451293945
r_  generation:  0.17001724243164062
local_output_nid generation:  0.009127378463745117
local_in_edges_tensor generation:  0.009424924850463867
mini_batch_src_global generation:  0.023385286331176758
r_  generation:  0.18185758590698242
local_output_nid generation:  0.009395599365234375
local_in_edges_tensor generation:  0.009181022644042969
mini_batch_src_global generation:  0.023241281509399414
r_  generation:  0.18033576011657715
local_output_nid generation:  0.009195327758789062
local_in_edges_tensor generation:  0.009051799774169922
mini_batch_src_global generation:  0.022672653198242188
r_  generation:  0.17474699020385742
local_output_nid generation:  0.009273767471313477
local_in_edges_tensor generation:  0.009141921997070312
mini_batch_src_global generation:  0.022785186767578125
r_  generation:  0.17588162422180176
local_output_nid generation:  0.00953364372253418
local_in_edges_tensor generation:  0.00895071029663086
mini_batch_src_global generation:  0.022444963455200195
r_  generation:  0.17807245254516602
local_output_nid generation:  0.009563922882080078
local_in_edges_tensor generation:  0.010116338729858398
mini_batch_src_global generation:  0.024350643157958984
r_  generation:  0.18118739128112793
local_output_nid generation:  0.009615898132324219
local_in_edges_tensor generation:  0.010032176971435547
mini_batch_src_global generation:  0.024543285369873047
r_  generation:  0.1881392002105713
local_output_nid generation:  0.009454011917114258
local_in_edges_tensor generation:  0.009210824966430664
mini_batch_src_global generation:  0.023024797439575195
r_  generation:  0.17977499961853027
local_output_nid generation:  0.009453773498535156
local_in_edges_tensor generation:  0.009106159210205078
mini_batch_src_global generation:  0.022533893585205078
r_  generation:  0.17916178703308105
local_output_nid generation:  0.009737730026245117
local_in_edges_tensor generation:  0.010417699813842773
mini_batch_src_global generation:  0.023432493209838867
r_  generation:  0.18348264694213867
local_output_nid generation:  0.009641170501708984
local_in_edges_tensor generation:  0.00956583023071289
mini_batch_src_global generation:  0.023120641708374023
r_  generation:  0.1815776824951172
local_output_nid generation:  0.00950169563293457
local_in_edges_tensor generation:  0.009923696517944336
mini_batch_src_global generation:  0.024399995803833008
r_  generation:  0.18284296989440918
local_output_nid generation:  0.009678125381469727
local_in_edges_tensor generation:  0.009634017944335938
mini_batch_src_global generation:  0.023499250411987305
r_  generation:  0.18486237525939941
local_output_nid generation:  0.009833097457885742
local_in_edges_tensor generation:  0.010371685028076172
mini_batch_src_global generation:  0.024421215057373047
r_  generation:  0.19174885749816895
local_output_nid generation:  0.009836196899414062
local_in_edges_tensor generation:  0.009318113327026367
mini_batch_src_global generation:  0.024318933486938477
r_  generation:  0.19559407234191895
local_output_nid generation:  0.009433984756469727
local_in_edges_tensor generation:  0.009137630462646484
mini_batch_src_global generation:  0.02403402328491211
r_  generation:  0.1840829849243164
local_output_nid generation:  0.0095367431640625
local_in_edges_tensor generation:  0.009311199188232422
mini_batch_src_global generation:  0.02292156219482422
r_  generation:  0.1857452392578125
local_output_nid generation:  0.009077787399291992
local_in_edges_tensor generation:  0.009142875671386719
mini_batch_src_global generation:  0.022572040557861328
r_  generation:  0.17357707023620605
local_output_nid generation:  0.009405136108398438
local_in_edges_tensor generation:  0.009194135665893555
mini_batch_src_global generation:  0.023254871368408203
r_  generation:  0.18892359733581543
local_output_nid generation:  0.009430408477783203
local_in_edges_tensor generation:  0.009443283081054688
mini_batch_src_global generation:  0.023232460021972656
r_  generation:  0.18364906311035156
local_output_nid generation:  0.009418010711669922
local_in_edges_tensor generation:  0.009069204330444336
mini_batch_src_global generation:  0.023016929626464844
r_  generation:  0.18344998359680176
local_output_nid generation:  0.009251832962036133
local_in_edges_tensor generation:  0.01148533821105957
mini_batch_src_global generation:  0.023120641708374023
r_  generation:  0.18084955215454102
local_output_nid generation:  0.009611368179321289
local_in_edges_tensor generation:  0.009192705154418945
mini_batch_src_global generation:  0.023891448974609375
r_  generation:  0.18789267539978027
local_output_nid generation:  0.009874582290649414
local_in_edges_tensor generation:  0.009696006774902344
mini_batch_src_global generation:  0.024015188217163086
r_  generation:  0.18790483474731445
----------------------check_connections_block total spend ----------------------------- 8.450433731079102
generate_one_block  0.23423409461975098
generate_one_block  0.23709797859191895
generate_one_block  0.23816776275634766
generate_one_block  0.24530434608459473
generate_one_block  0.25647711753845215
generate_one_block  0.24465060234069824
generate_one_block  0.2352428436279297
generate_one_block  0.2308213710784912
generate_one_block  0.24696636199951172
generate_one_block  0.2476651668548584
generate_one_block  0.23710012435913086
generate_one_block  0.23856520652770996
generate_one_block  0.23972058296203613
generate_one_block  0.24486637115478516
generate_one_block  0.24974417686462402
generate_one_block  0.2393019199371338
generate_one_block  0.23871350288391113
generate_one_block  0.2526729106903076
generate_one_block  0.24446702003479004
generate_one_block  0.2502601146697998
generate_one_block  0.2472677230834961
generate_one_block  0.25725650787353516
generate_one_block  0.25802135467529297
generate_one_block  0.24512290954589844
generate_one_block  0.24817323684692383
generate_one_block  0.23526573181152344
generate_one_block  0.24727082252502441
generate_one_block  0.24286103248596191
generate_one_block  0.24326443672180176
generate_one_block  0.23698139190673828
generate_one_block  0.2496647834777832
generate_one_block  0.2535371780395508
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04461812973022461
gen group dst list time:  0.10599946975708008
time for parepare:  0.018749475479125977
local_output_nid generation:  0.025069713592529297
local_in_edges_tensor generation:  0.035318613052368164
mini_batch_src_global generation:  0.03701901435852051
r_  generation:  0.4224128723144531
local_output_nid generation:  0.031350135803222656
local_in_edges_tensor generation:  0.035653114318847656
mini_batch_src_global generation:  0.0511784553527832
r_  generation:  0.42346858978271484
local_output_nid generation:  0.0313267707824707
local_in_edges_tensor generation:  0.032022714614868164
mini_batch_src_global generation:  0.048120737075805664
r_  generation:  0.4353947639465332
local_output_nid generation:  0.03145742416381836
local_in_edges_tensor generation:  0.03211808204650879
mini_batch_src_global generation:  0.05099320411682129
r_  generation:  0.42864251136779785
local_output_nid generation:  0.03179025650024414
local_in_edges_tensor generation:  0.027654170989990234
mini_batch_src_global generation:  0.04959225654602051
r_  generation:  0.4381110668182373
local_output_nid generation:  0.030378103256225586
local_in_edges_tensor generation:  0.028942346572875977
mini_batch_src_global generation:  0.0521090030670166
r_  generation:  0.4305405616760254
local_output_nid generation:  0.02931809425354004
local_in_edges_tensor generation:  0.027463436126708984
mini_batch_src_global generation:  0.04903268814086914
r_  generation:  0.43389248847961426
local_output_nid generation:  0.029767990112304688
local_in_edges_tensor generation:  0.027601242065429688
mini_batch_src_global generation:  0.04982328414916992
r_  generation:  0.42922234535217285
local_output_nid generation:  0.029695510864257812
local_in_edges_tensor generation:  0.02778792381286621
mini_batch_src_global generation:  0.05114269256591797
r_  generation:  0.4354684352874756
local_output_nid generation:  0.02996206283569336
local_in_edges_tensor generation:  0.02776193618774414
mini_batch_src_global generation:  0.05123162269592285
r_  generation:  0.43563151359558105
local_output_nid generation:  0.029412031173706055
local_in_edges_tensor generation:  0.029012441635131836
mini_batch_src_global generation:  0.05132794380187988
r_  generation:  0.4370744228363037
local_output_nid generation:  0.02968311309814453
local_in_edges_tensor generation:  0.027680635452270508
mini_batch_src_global generation:  0.050348520278930664
r_  generation:  0.4303462505340576
local_output_nid generation:  0.029987573623657227
local_in_edges_tensor generation:  0.027369260787963867
mini_batch_src_global generation:  0.050913095474243164
r_  generation:  0.43706846237182617
local_output_nid generation:  0.03336024284362793
local_in_edges_tensor generation:  0.03125596046447754
mini_batch_src_global generation:  0.05086183547973633
r_  generation:  0.4384584426879883
local_output_nid generation:  0.030117511749267578
local_in_edges_tensor generation:  0.02813410758972168
mini_batch_src_global generation:  0.049756526947021484
r_  generation:  0.44148826599121094
local_output_nid generation:  0.02993178367614746
local_in_edges_tensor generation:  0.0315394401550293
mini_batch_src_global generation:  0.05042099952697754
r_  generation:  0.4430253505706787
local_output_nid generation:  0.02962327003479004
local_in_edges_tensor generation:  0.0271146297454834
mini_batch_src_global generation:  0.049800872802734375
r_  generation:  0.4395484924316406
local_output_nid generation:  0.029978275299072266
local_in_edges_tensor generation:  0.027587890625
mini_batch_src_global generation:  0.050713539123535156
r_  generation:  0.4354665279388428
local_output_nid generation:  0.030010223388671875
local_in_edges_tensor generation:  0.031516075134277344
mini_batch_src_global generation:  0.04907870292663574
r_  generation:  0.44396257400512695
local_output_nid generation:  0.029634952545166016
local_in_edges_tensor generation:  0.029480934143066406
mini_batch_src_global generation:  0.050667524337768555
r_  generation:  0.4357771873474121
local_output_nid generation:  0.02974700927734375
local_in_edges_tensor generation:  0.029302120208740234
mini_batch_src_global generation:  0.0494229793548584
r_  generation:  0.4407956600189209
local_output_nid generation:  0.03294563293457031
local_in_edges_tensor generation:  0.0319368839263916
mini_batch_src_global generation:  0.05070185661315918
r_  generation:  0.437591552734375
local_output_nid generation:  0.030198097229003906
local_in_edges_tensor generation:  0.03086376190185547
mini_batch_src_global generation:  0.049480438232421875
r_  generation:  0.4409763813018799
local_output_nid generation:  0.029807329177856445
local_in_edges_tensor generation:  0.027588605880737305
mini_batch_src_global generation:  0.050130605697631836
r_  generation:  0.43947887420654297
local_output_nid generation:  0.029531240463256836
local_in_edges_tensor generation:  0.028455495834350586
mini_batch_src_global generation:  0.04964327812194824
r_  generation:  0.43557286262512207
local_output_nid generation:  0.029908418655395508
local_in_edges_tensor generation:  0.0314786434173584
mini_batch_src_global generation:  0.051163673400878906
r_  generation:  0.4322938919067383
local_output_nid generation:  0.029417753219604492
local_in_edges_tensor generation:  0.027454853057861328
mini_batch_src_global generation:  0.04969930648803711
r_  generation:  0.4403727054595947
local_output_nid generation:  0.02960658073425293
local_in_edges_tensor generation:  0.03305315971374512
mini_batch_src_global generation:  0.050806522369384766
r_  generation:  0.4342925548553467
local_output_nid generation:  0.030028581619262695
local_in_edges_tensor generation:  0.027864456176757812
mini_batch_src_global generation:  0.049845218658447266
r_  generation:  0.43673157691955566
local_output_nid generation:  0.03144049644470215
local_in_edges_tensor generation:  0.028017044067382812
mini_batch_src_global generation:  0.05027890205383301
r_  generation:  0.4322664737701416
local_output_nid generation:  0.030114412307739258
local_in_edges_tensor generation:  0.027040958404541016
mini_batch_src_global generation:  0.05035686492919922
r_  generation:  0.44254374504089355
local_output_nid generation:  0.029985666275024414
local_in_edges_tensor generation:  0.030625104904174805
mini_batch_src_global generation:  0.050966739654541016
r_  generation:  0.4368588924407959
----------------------check_connections_block total spend ----------------------------- 20.553773880004883
generate_one_block  0.5809831619262695
generate_one_block  0.571575403213501
generate_one_block  0.5825438499450684
generate_one_block  0.5751981735229492
generate_one_block  0.6706347465515137
generate_one_block  0.58390212059021
generate_one_block  0.5737614631652832
generate_one_block  0.5732276439666748
generate_one_block  0.594315767288208
generate_one_block  0.5856943130493164
generate_one_block  0.5708949565887451
generate_one_block  0.5759727954864502
generate_one_block  0.5801019668579102
generate_one_block  0.5784168243408203
generate_one_block  0.5909078121185303
generate_one_block  0.5832362174987793
generate_one_block  0.5743594169616699
generate_one_block  0.5877635478973389
generate_one_block  0.5843775272369385
generate_one_block  0.5808818340301514
generate_one_block  0.5847539901733398
generate_one_block  0.5870957374572754
generate_one_block  0.5903189182281494
generate_one_block  0.5764570236206055
generate_one_block  0.5945148468017578
generate_one_block  0.5748367309570312
generate_one_block  0.5751862525939941
generate_one_block  0.5845746994018555
generate_one_block  0.5778763294219971
generate_one_block  0.5699660778045654
generate_one_block  0.5955064296722412
generate_one_block  0.5882186889648438
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.12623023986816406  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

connection checking time:  29.004207611083984
block generation total time  26.514781951904297
average batch blocks generation time:  0.8285869359970093
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10631847381591797  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.620484352111816  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1064920425415039  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.68014430999756  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10642337799072266  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.778048992156982  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10657882690429688  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.959455013275146  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10679054260253906  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.952448844909668  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10626077651977539  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.06529140472412  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10625457763671875  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.566267490386963  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10634088516235352  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.428333282470703  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10679054260253906  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.122278213500977  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10674810409545898  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.039921760559082  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1064753532409668  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.53722047805786  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10644197463989258  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.607439041137695  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1065521240234375  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.75147581100464  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10654544830322266  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.92553424835205  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10689640045166016  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.232346057891846  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10672521591186523  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.861873149871826  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10627412796020508  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.68945026397705  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10678958892822266  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.2322735786438  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10689306259155273  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.0195631980896  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10659599304199219  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.071640014648438  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1068272590637207  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.148601055145264  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10676956176757812  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.48118782043457  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1071319580078125  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.550959587097168  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10647106170654297  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.048147678375244  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10669422149658203  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.030977249145508  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10641336441040039  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.457339763641357  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1066899299621582  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.04272747039795  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10656452178955078  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.85072660446167  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10654449462890625  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.922245025634766  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.106048583984375  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.622859001159668  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10692024230957031  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.140231609344482  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10670661926269531  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.16798734664917  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03408290445804596 |0.02137470245361328 |0.5625811815261841 |9.784847497940063e-05 |1.072113499045372 |0.005362033843994141 |
----------------------------------------------------------pseudo_mini_loss sum 1.7759990692138672
 Run 0| Epoch 9 |
Number of nodes for computation during this epoch:  9113660
Number of first layer input nodes during this epoch:  4760888
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.12682580947875977  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02502751350402832
random selection method range initialization spend 0.005266666412353516
time for parepare:  0.021301984786987305
local_output_nid generation:  0.0013799667358398438
local_in_edges_tensor generation:  0.006379604339599609
mini_batch_src_global generation:  0.0017421245574951172
r_  generation:  0.010562419891357422
local_output_nid generation:  0.0016918182373046875
local_in_edges_tensor generation:  0.00106048583984375
mini_batch_src_global generation:  0.001634836196899414
r_  generation:  0.01036977767944336
local_output_nid generation:  0.0016694068908691406
local_in_edges_tensor generation:  0.0009579658508300781
mini_batch_src_global generation:  0.0011861324310302734
r_  generation:  0.010054588317871094
local_output_nid generation:  0.0016241073608398438
local_in_edges_tensor generation:  0.0009133815765380859
mini_batch_src_global generation:  0.0010981559753417969
r_  generation:  0.009443998336791992
local_output_nid generation:  0.0015940666198730469
local_in_edges_tensor generation:  0.0009441375732421875
mini_batch_src_global generation:  0.0011165142059326172
r_  generation:  0.01007223129272461
local_output_nid generation:  0.0015816688537597656
local_in_edges_tensor generation:  0.0009014606475830078
mini_batch_src_global generation:  0.0011594295501708984
r_  generation:  0.010168313980102539
local_output_nid generation:  0.0015935897827148438
local_in_edges_tensor generation:  0.0009188652038574219
mini_batch_src_global generation:  0.0011637210845947266
r_  generation:  0.010289192199707031
local_output_nid generation:  0.0016069412231445312
local_in_edges_tensor generation:  0.0009119510650634766
mini_batch_src_global generation:  0.0011713504791259766
r_  generation:  0.010455608367919922
local_output_nid generation:  0.0015990734100341797
local_in_edges_tensor generation:  0.0008928775787353516
mini_batch_src_global generation:  0.0011174678802490234
r_  generation:  0.010291576385498047
local_output_nid generation:  0.0015668869018554688
local_in_edges_tensor generation:  0.0009014606475830078
mini_batch_src_global generation:  0.0011937618255615234
r_  generation:  0.010087013244628906
local_output_nid generation:  0.001581430435180664
local_in_edges_tensor generation:  0.0009059906005859375
mini_batch_src_global generation:  0.0011622905731201172
r_  generation:  0.010459184646606445
local_output_nid generation:  0.0015811920166015625
local_in_edges_tensor generation:  0.0009138584136962891
mini_batch_src_global generation:  0.0011334419250488281
r_  generation:  0.010291337966918945
local_output_nid generation:  0.0015666484832763672
local_in_edges_tensor generation:  0.0009005069732666016
mini_batch_src_global generation:  0.001171112060546875
r_  generation:  0.010032892227172852
local_output_nid generation:  0.0016117095947265625
local_in_edges_tensor generation:  0.0009026527404785156
mini_batch_src_global generation:  0.0011508464813232422
r_  generation:  0.010214805603027344
local_output_nid generation:  0.0015954971313476562
local_in_edges_tensor generation:  0.0009217262268066406
mini_batch_src_global generation:  0.001220703125
r_  generation:  0.010948419570922852
local_output_nid generation:  0.0015952587127685547
local_in_edges_tensor generation:  0.0009090900421142578
mini_batch_src_global generation:  0.0012519359588623047
r_  generation:  0.010690689086914062
local_output_nid generation:  0.0016298294067382812
local_in_edges_tensor generation:  0.0009126663208007812
mini_batch_src_global generation:  0.0011425018310546875
r_  generation:  0.012045145034790039
local_output_nid generation:  0.0015950202941894531
local_in_edges_tensor generation:  0.0009000301361083984
mini_batch_src_global generation:  0.0012211799621582031
r_  generation:  0.010268211364746094
local_output_nid generation:  0.0015947818756103516
local_in_edges_tensor generation:  0.0008966922760009766
mini_batch_src_global generation:  0.0011281967163085938
r_  generation:  0.010260343551635742
local_output_nid generation:  0.001588582992553711
local_in_edges_tensor generation:  0.0008950233459472656
mini_batch_src_global generation:  0.0011560916900634766
r_  generation:  0.010555267333984375
local_output_nid generation:  0.0015845298767089844
local_in_edges_tensor generation:  0.0008695125579833984
mini_batch_src_global generation:  0.0011773109436035156
r_  generation:  0.010338544845581055
local_output_nid generation:  0.0015959739685058594
local_in_edges_tensor generation:  0.0009088516235351562
mini_batch_src_global generation:  0.0011761188507080078
r_  generation:  0.010590791702270508
local_output_nid generation:  0.0015778541564941406
local_in_edges_tensor generation:  0.0008852481842041016
mini_batch_src_global generation:  0.0011355876922607422
r_  generation:  0.010179996490478516
local_output_nid generation:  0.0015840530395507812
local_in_edges_tensor generation:  0.0009012222290039062
mini_batch_src_global generation:  0.001165151596069336
r_  generation:  0.010469198226928711
local_output_nid generation:  0.0015914440155029297
local_in_edges_tensor generation:  0.0008931159973144531
mini_batch_src_global generation:  0.0011444091796875
r_  generation:  0.010434150695800781
local_output_nid generation:  0.0015854835510253906
local_in_edges_tensor generation:  0.0008993148803710938
mini_batch_src_global generation:  0.0012295246124267578
r_  generation:  0.010487794876098633
local_output_nid generation:  0.0015778541564941406
local_in_edges_tensor generation:  0.0008883476257324219
mini_batch_src_global generation:  0.0011816024780273438
r_  generation:  0.010371685028076172
local_output_nid generation:  0.0015757083892822266
local_in_edges_tensor generation:  0.0008993148803710938
mini_batch_src_global generation:  0.0011708736419677734
r_  generation:  0.009996414184570312
local_output_nid generation:  0.0015916824340820312
local_in_edges_tensor generation:  0.0008840560913085938
mini_batch_src_global generation:  0.0011882781982421875
r_  generation:  0.010411500930786133
local_output_nid generation:  0.0016105175018310547
local_in_edges_tensor generation:  0.0009138584136962891
mini_batch_src_global generation:  0.0012044906616210938
r_  generation:  0.010628700256347656
local_output_nid generation:  0.0015804767608642578
local_in_edges_tensor generation:  0.0009198188781738281
mini_batch_src_global generation:  0.0012345314025878906
r_  generation:  0.011057376861572266
local_output_nid generation:  0.001589059829711914
local_in_edges_tensor generation:  0.0009243488311767578
mini_batch_src_global generation:  0.0012705326080322266
r_  generation:  0.010813236236572266
----------------------check_connections_block total spend ----------------------------- 0.5747840404510498
generate_one_block  0.023906469345092773
generate_one_block  0.02138543128967285
generate_one_block  0.019046783447265625
generate_one_block  0.01761937141418457
generate_one_block  0.01870417594909668
generate_one_block  0.018306255340576172
generate_one_block  0.019736528396606445
generate_one_block  0.018615007400512695
generate_one_block  0.01824355125427246
generate_one_block  0.01789236068725586
generate_one_block  0.01849222183227539
generate_one_block  0.018179893493652344
generate_one_block  0.017661571502685547
generate_one_block  0.018004417419433594
generate_one_block  0.019123315811157227
generate_one_block  0.018471240997314453
generate_one_block  0.017877578735351562
generate_one_block  0.018063783645629883
generate_one_block  0.01800990104675293
generate_one_block  0.018497228622436523
generate_one_block  0.017989158630371094
generate_one_block  0.01834845542907715
generate_one_block  0.0207674503326416
generate_one_block  0.018909454345703125
generate_one_block  0.018141508102416992
generate_one_block  0.01829671859741211
generate_one_block  0.0180511474609375
generate_one_block  0.017607688903808594
generate_one_block  0.01942610740661621
generate_one_block  0.018650531768798828
generate_one_block  0.01900935173034668
generate_one_block  0.018761634826660156
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0390477180480957
gen group dst list time:  0.0233309268951416
time for parepare:  0.02224111557006836
local_output_nid generation:  0.0063626766204833984
local_in_edges_tensor generation:  0.019269227981567383
mini_batch_src_global generation:  0.017273902893066406
r_  generation:  0.16064810752868652
local_output_nid generation:  0.010729551315307617
local_in_edges_tensor generation:  0.012368202209472656
mini_batch_src_global generation:  0.021967649459838867
r_  generation:  0.1716301441192627
local_output_nid generation:  0.009545326232910156
local_in_edges_tensor generation:  0.035114288330078125
mini_batch_src_global generation:  0.02002096176147461
r_  generation:  0.17618751525878906
local_output_nid generation:  0.009114980697631836
local_in_edges_tensor generation:  0.011414766311645508
mini_batch_src_global generation:  0.020154476165771484
r_  generation:  0.16576743125915527
local_output_nid generation:  0.009592294692993164
local_in_edges_tensor generation:  0.010931253433227539
mini_batch_src_global generation:  0.0227205753326416
r_  generation:  0.1823291778564453
local_output_nid generation:  0.008939027786254883
local_in_edges_tensor generation:  0.010757684707641602
mini_batch_src_global generation:  0.021914958953857422
r_  generation:  0.18224072456359863
local_output_nid generation:  0.009092092514038086
local_in_edges_tensor generation:  0.009252548217773438
mini_batch_src_global generation:  0.0232088565826416
r_  generation:  0.17942571640014648
local_output_nid generation:  0.009137392044067383
local_in_edges_tensor generation:  0.009108304977416992
mini_batch_src_global generation:  0.022315263748168945
r_  generation:  0.18471336364746094
local_output_nid generation:  0.009003162384033203
local_in_edges_tensor generation:  0.00917363166809082
mini_batch_src_global generation:  0.022537708282470703
r_  generation:  0.18388891220092773
local_output_nid generation:  0.008974075317382812
local_in_edges_tensor generation:  0.00914764404296875
mini_batch_src_global generation:  0.022008180618286133
r_  generation:  0.1777043342590332
local_output_nid generation:  0.009598731994628906
local_in_edges_tensor generation:  0.009253978729248047
mini_batch_src_global generation:  0.02318120002746582
r_  generation:  0.1879267692565918
local_output_nid generation:  0.009332418441772461
local_in_edges_tensor generation:  0.012897014617919922
mini_batch_src_global generation:  0.022685766220092773
r_  generation:  0.18230438232421875
local_output_nid generation:  0.010200262069702148
local_in_edges_tensor generation:  0.011476278305053711
mini_batch_src_global generation:  0.022334814071655273
r_  generation:  0.17889904975891113
local_output_nid generation:  0.009537935256958008
local_in_edges_tensor generation:  0.009157896041870117
mini_batch_src_global generation:  0.02320265769958496
r_  generation:  0.18935871124267578
local_output_nid generation:  0.009993314743041992
local_in_edges_tensor generation:  0.012732505798339844
mini_batch_src_global generation:  0.02468419075012207
r_  generation:  0.18941140174865723
local_output_nid generation:  0.00977182388305664
local_in_edges_tensor generation:  0.014131784439086914
mini_batch_src_global generation:  0.023575544357299805
r_  generation:  0.1890871524810791
local_output_nid generation:  0.009393930435180664
local_in_edges_tensor generation:  0.009403228759765625
mini_batch_src_global generation:  0.02314138412475586
r_  generation:  0.1827239990234375
local_output_nid generation:  0.009543895721435547
local_in_edges_tensor generation:  0.009926795959472656
mini_batch_src_global generation:  0.02313089370727539
r_  generation:  0.18384051322937012
local_output_nid generation:  0.00958395004272461
local_in_edges_tensor generation:  0.009143352508544922
mini_batch_src_global generation:  0.022754192352294922
r_  generation:  0.18323063850402832
local_output_nid generation:  0.009602785110473633
local_in_edges_tensor generation:  0.009320735931396484
mini_batch_src_global generation:  0.02361583709716797
r_  generation:  0.1872556209564209
local_output_nid generation:  0.009425640106201172
local_in_edges_tensor generation:  0.008960247039794922
mini_batch_src_global generation:  0.022602081298828125
r_  generation:  0.1837139129638672
local_output_nid generation:  0.00946664810180664
local_in_edges_tensor generation:  0.013498783111572266
mini_batch_src_global generation:  0.024298429489135742
r_  generation:  0.18880128860473633
local_output_nid generation:  0.009301900863647461
local_in_edges_tensor generation:  0.00971674919128418
mini_batch_src_global generation:  0.02286815643310547
r_  generation:  0.18396830558776855
local_output_nid generation:  0.009585142135620117
local_in_edges_tensor generation:  0.010143280029296875
mini_batch_src_global generation:  0.024010896682739258
r_  generation:  0.18488335609436035
local_output_nid generation:  0.009519100189208984
local_in_edges_tensor generation:  0.012969255447387695
mini_batch_src_global generation:  0.02321314811706543
r_  generation:  0.18182587623596191
local_output_nid generation:  0.009477376937866211
local_in_edges_tensor generation:  0.009860038757324219
mini_batch_src_global generation:  0.02402472496032715
r_  generation:  0.1853790283203125
local_output_nid generation:  0.00952458381652832
local_in_edges_tensor generation:  0.009282588958740234
mini_batch_src_global generation:  0.022563934326171875
r_  generation:  0.1799018383026123
local_output_nid generation:  0.009351491928100586
local_in_edges_tensor generation:  0.009116411209106445
mini_batch_src_global generation:  0.023926973342895508
r_  generation:  0.17871689796447754
local_output_nid generation:  0.009224176406860352
local_in_edges_tensor generation:  0.010698556900024414
mini_batch_src_global generation:  0.02378106117248535
r_  generation:  0.18488192558288574
local_output_nid generation:  0.009823083877563477
local_in_edges_tensor generation:  0.009880542755126953
mini_batch_src_global generation:  0.023778200149536133
r_  generation:  0.1864488124847412
local_output_nid generation:  0.009949684143066406
local_in_edges_tensor generation:  0.009880304336547852
mini_batch_src_global generation:  0.02567434310913086
r_  generation:  0.19289708137512207
local_output_nid generation:  0.00988459587097168
local_in_edges_tensor generation:  0.009567737579345703
mini_batch_src_global generation:  0.02391839027404785
r_  generation:  0.1941828727722168
----------------------check_connections_block total spend ----------------------------- 8.562528610229492
generate_one_block  0.2473001480102539
generate_one_block  0.244415283203125
generate_one_block  0.24654006958007812
generate_one_block  0.22981548309326172
generate_one_block  0.2679483890533447
generate_one_block  0.24483203887939453
generate_one_block  0.2457256317138672
generate_one_block  0.24897360801696777
generate_one_block  0.24613213539123535
generate_one_block  0.23563694953918457
generate_one_block  0.24892401695251465
generate_one_block  0.2387220859527588
generate_one_block  0.2399601936340332
generate_one_block  0.2482147216796875
generate_one_block  0.25179028511047363
generate_one_block  0.2515733242034912
generate_one_block  0.23985004425048828
generate_one_block  0.24596047401428223
generate_one_block  0.24643754959106445
generate_one_block  0.25223231315612793
generate_one_block  0.2442338466644287
generate_one_block  0.2551259994506836
generate_one_block  0.23659181594848633
generate_one_block  0.2579319477081299
generate_one_block  0.24183249473571777
generate_one_block  0.24524521827697754
generate_one_block  0.24413633346557617
generate_one_block  0.23662543296813965
generate_one_block  0.24507951736450195
generate_one_block  0.25090527534484863
generate_one_block  0.2630305290222168
generate_one_block  0.25648069381713867
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03709673881530762
gen group dst list time:  0.11153316497802734
time for parepare:  0.01872396469116211
local_output_nid generation:  0.026071548461914062
local_in_edges_tensor generation:  0.04817485809326172
mini_batch_src_global generation:  0.03899216651916504
r_  generation:  0.42710328102111816
local_output_nid generation:  0.031232595443725586
local_in_edges_tensor generation:  0.03454470634460449
mini_batch_src_global generation:  0.05016684532165527
r_  generation:  0.43071961402893066
local_output_nid generation:  0.03211402893066406
local_in_edges_tensor generation:  0.033396244049072266
mini_batch_src_global generation:  0.04893302917480469
r_  generation:  0.4411637783050537
local_output_nid generation:  0.031220674514770508
local_in_edges_tensor generation:  0.0304412841796875
mini_batch_src_global generation:  0.0496516227722168
r_  generation:  0.43279337882995605
local_output_nid generation:  0.03186655044555664
local_in_edges_tensor generation:  0.02966761589050293
mini_batch_src_global generation:  0.0499730110168457
r_  generation:  0.4412696361541748
local_output_nid generation:  0.030533790588378906
local_in_edges_tensor generation:  0.032915592193603516
mini_batch_src_global generation:  0.05111861228942871
r_  generation:  0.441514253616333
local_output_nid generation:  0.030530214309692383
local_in_edges_tensor generation:  0.03318524360656738
mini_batch_src_global generation:  0.05052542686462402
r_  generation:  0.4430060386657715
local_output_nid generation:  0.02994370460510254
local_in_edges_tensor generation:  0.031180858612060547
mini_batch_src_global generation:  0.051275014877319336
r_  generation:  0.44434571266174316
local_output_nid generation:  0.029417037963867188
local_in_edges_tensor generation:  0.029659748077392578
mini_batch_src_global generation:  0.05003833770751953
r_  generation:  0.4443354606628418
local_output_nid generation:  0.030760526657104492
local_in_edges_tensor generation:  0.028079748153686523
mini_batch_src_global generation:  0.051177024841308594
r_  generation:  0.4378499984741211
local_output_nid generation:  0.02981090545654297
local_in_edges_tensor generation:  0.031272172927856445
mini_batch_src_global generation:  0.052023887634277344
r_  generation:  0.44411158561706543
local_output_nid generation:  0.029359817504882812
local_in_edges_tensor generation:  0.0296628475189209
mini_batch_src_global generation:  0.051458120346069336
r_  generation:  0.4397611618041992
local_output_nid generation:  0.029362201690673828
local_in_edges_tensor generation:  0.027108192443847656
mini_batch_src_global generation:  0.050325870513916016
r_  generation:  0.44147539138793945
local_output_nid generation:  0.029526710510253906
local_in_edges_tensor generation:  0.028303146362304688
mini_batch_src_global generation:  0.05114006996154785
r_  generation:  0.4410223960876465
local_output_nid generation:  0.03009343147277832
local_in_edges_tensor generation:  0.03036642074584961
mini_batch_src_global generation:  0.05034494400024414
r_  generation:  0.4438660144805908
local_output_nid generation:  0.029829740524291992
local_in_edges_tensor generation:  0.027195215225219727
mini_batch_src_global generation:  0.05147361755371094
r_  generation:  0.44689345359802246
local_output_nid generation:  0.029736757278442383
local_in_edges_tensor generation:  0.029087305068969727
mini_batch_src_global generation:  0.051718950271606445
r_  generation:  0.442335844039917
local_output_nid generation:  0.02980184555053711
local_in_edges_tensor generation:  0.027790307998657227
mini_batch_src_global generation:  0.05081439018249512
r_  generation:  0.44509363174438477
local_output_nid generation:  0.02970576286315918
local_in_edges_tensor generation:  0.029350996017456055
mini_batch_src_global generation:  0.04923868179321289
r_  generation:  0.44356274604797363
local_output_nid generation:  0.03006744384765625
local_in_edges_tensor generation:  0.03186297416687012
mini_batch_src_global generation:  0.052213191986083984
r_  generation:  0.4492616653442383
local_output_nid generation:  0.02935171127319336
local_in_edges_tensor generation:  0.029629945755004883
mini_batch_src_global generation:  0.051111698150634766
r_  generation:  0.44342470169067383
local_output_nid generation:  0.029552936553955078
local_in_edges_tensor generation:  0.029262065887451172
mini_batch_src_global generation:  0.05136537551879883
r_  generation:  0.45224738121032715
local_output_nid generation:  0.029537677764892578
local_in_edges_tensor generation:  0.031006813049316406
mini_batch_src_global generation:  0.04920148849487305
r_  generation:  0.45512866973876953
local_output_nid generation:  0.03278708457946777
local_in_edges_tensor generation:  0.02924060821533203
mini_batch_src_global generation:  0.05339622497558594
r_  generation:  0.44621992111206055
local_output_nid generation:  0.030237436294555664
local_in_edges_tensor generation:  0.02806544303894043
mini_batch_src_global generation:  0.04932975769042969
r_  generation:  0.4480936527252197
local_output_nid generation:  0.030335664749145508
local_in_edges_tensor generation:  0.027063846588134766
mini_batch_src_global generation:  0.05309557914733887
r_  generation:  0.4402177333831787
local_output_nid generation:  0.03049945831298828
local_in_edges_tensor generation:  0.032190561294555664
mini_batch_src_global generation:  0.050536394119262695
r_  generation:  0.4444727897644043
local_output_nid generation:  0.0304868221282959
local_in_edges_tensor generation:  0.027768850326538086
mini_batch_src_global generation:  0.05148744583129883
r_  generation:  0.4423975944519043
local_output_nid generation:  0.03076648712158203
local_in_edges_tensor generation:  0.0293729305267334
mini_batch_src_global generation:  0.05248236656188965
r_  generation:  0.4475076198577881
local_output_nid generation:  0.030612707138061523
local_in_edges_tensor generation:  0.029648303985595703
mini_batch_src_global generation:  0.055466651916503906
r_  generation:  0.4440591335296631
local_output_nid generation:  0.030878782272338867
local_in_edges_tensor generation:  0.02917766571044922
mini_batch_src_global generation:  0.05278134346008301
r_  generation:  0.4552123546600342
local_output_nid generation:  0.030544281005859375
local_in_edges_tensor generation:  0.030129671096801758
mini_batch_src_global generation:  0.05330491065979004
r_  generation:  0.44722867012023926
----------------------check_connections_block total spend ----------------------------- 20.891592979431152
generate_one_block  0.5924017429351807
generate_one_block  0.5762670040130615
generate_one_block  0.5761640071868896
generate_one_block  0.5741763114929199
generate_one_block  0.6970818042755127
generate_one_block  0.5834500789642334
generate_one_block  0.5823390483856201
generate_one_block  0.5892593860626221
generate_one_block  0.5778520107269287
generate_one_block  0.5755250453948975
generate_one_block  0.5821456909179688
generate_one_block  0.5750598907470703
generate_one_block  0.5807459354400635
generate_one_block  0.5934767723083496
generate_one_block  0.6056225299835205
generate_one_block  0.585869312286377
generate_one_block  0.579298734664917
generate_one_block  0.5899770259857178
generate_one_block  0.583350658416748
generate_one_block  0.5830340385437012
generate_one_block  0.5782792568206787
generate_one_block  0.5821619033813477
generate_one_block  0.575096607208252
generate_one_block  0.5900838375091553
generate_one_block  0.5887057781219482
generate_one_block  0.5788083076477051
generate_one_block  0.5802736282348633
generate_one_block  0.5796434879302979
generate_one_block  0.5943641662597656
generate_one_block  0.5864307880401611
generate_one_block  0.5876986980438232
generate_one_block  0.5974149703979492
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.12682580947875977  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

connection checking time:  29.454121589660645
block generation total time  26.700262308120728
average batch blocks generation time:  0.8343831971287727
block dataloader generation time/epoch 59.49150252342224
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10652971267700195  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.69224977493286  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10649633407592773  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.885504245758057  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10689973831176758  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.017091274261475  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10621213912963867  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.18745994567871  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10682249069213867  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.15147066116333  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10651731491088867  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.88167428970337  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10658931732177734  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.969359874725342  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10678720474243164  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.042425632476807  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10655975341796875  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.920883655548096  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10640144348144531  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.624967098236084  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10683345794677734  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.1375412940979  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10645389556884766  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.533814430236816  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10651540756225586  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.682030200958252  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10659313201904297  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.051203727722168  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1069631576538086  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.287729263305664  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10654830932617188  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.21309471130371  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10654544830322266  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.774057388305664  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10657596588134766  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.837639808654785  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10658979415893555  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.889982223510742  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10690450668334961  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.094897270202637  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10648488998413086  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.8356351852417  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10641813278198242  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.06057596206665  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10628175735473633  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.5446720123291  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10641908645629883  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.986040592193604  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1062169075012207  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.73289203643799  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10668516159057617  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.918392181396484  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10680913925170898  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.819857120513916  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10661602020263672  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.593013286590576  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10685205459594727  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.01907444000244  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10654783248901367  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.1018648147583  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10701465606689453  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.57585906982422  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10676813125610352  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.421430587768555  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.029889807105064392 |0.019840151071548462 |0.5563451275229454 |9.512901306152344e-05 |1.0701701119542122 |0.009571313858032227 |
----------------------------------------------------------pseudo_mini_loss sum 1.7207201719284058
Total (block generation + training)time/epoch 113.1947865486145
Training time/epoch 53.70299029350281
Training time without block to device /epoch 53.06810545921326
Training time without total dataloading part /epoch 52.061103105545044
load block tensor time/epoch 0.9564738273620605
block to device time/epoch 0.6348848342895508
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 10 |
Number of nodes for computation during this epoch:  9114664
Number of first layer input nodes during this epoch:  4762023
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.12703180313110352  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023975372314453125
random selection method range initialization spend 0.0058879852294921875
time for parepare:  0.020632505416870117
local_output_nid generation:  0.0014510154724121094
local_in_edges_tensor generation:  0.007572650909423828
mini_batch_src_global generation:  0.0018310546875
r_  generation:  0.01097416877746582
local_output_nid generation:  0.0015900135040283203
local_in_edges_tensor generation:  0.0011472702026367188
mini_batch_src_global generation:  0.0017316341400146484
r_  generation:  0.010657072067260742
local_output_nid generation:  0.001613616943359375
local_in_edges_tensor generation:  0.001007080078125
mini_batch_src_global generation:  0.0011370182037353516
r_  generation:  0.009377479553222656
local_output_nid generation:  0.0015957355499267578
local_in_edges_tensor generation:  0.0010085105895996094
mini_batch_src_global generation:  0.001188039779663086
r_  generation:  0.01000070571899414
local_output_nid generation:  0.0015971660614013672
local_in_edges_tensor generation:  0.0009553432464599609
mini_batch_src_global generation:  0.0011425018310546875
r_  generation:  0.009680747985839844
local_output_nid generation:  0.001613616943359375
local_in_edges_tensor generation:  0.0009610652923583984
mini_batch_src_global generation:  0.0010998249053955078
r_  generation:  0.009682416915893555
local_output_nid generation:  0.0015904903411865234
local_in_edges_tensor generation:  0.000946044921875
mini_batch_src_global generation:  0.001123666763305664
r_  generation:  0.010300636291503906
local_output_nid generation:  0.0016117095947265625
local_in_edges_tensor generation:  0.0009627342224121094
mini_batch_src_global generation:  0.001154184341430664
r_  generation:  0.010307073593139648
local_output_nid generation:  0.0016269683837890625
local_in_edges_tensor generation:  0.0009338855743408203
mini_batch_src_global generation:  0.001203298568725586
r_  generation:  0.010283946990966797
local_output_nid generation:  0.0015938282012939453
local_in_edges_tensor generation:  0.0009539127349853516
mini_batch_src_global generation:  0.0011560916900634766
r_  generation:  0.010222196578979492
local_output_nid generation:  0.0016093254089355469
local_in_edges_tensor generation:  0.000934600830078125
mini_batch_src_global generation:  0.001138448715209961
r_  generation:  0.010388851165771484
local_output_nid generation:  0.0015912055969238281
local_in_edges_tensor generation:  0.0009136199951171875
mini_batch_src_global generation:  0.0011522769927978516
r_  generation:  0.009931087493896484
local_output_nid generation:  0.0015931129455566406
local_in_edges_tensor generation:  0.0009233951568603516
mini_batch_src_global generation:  0.0011081695556640625
r_  generation:  0.010272741317749023
local_output_nid generation:  0.0015914440155029297
local_in_edges_tensor generation:  0.0009303092956542969
mini_batch_src_global generation:  0.0011677742004394531
r_  generation:  0.010242223739624023
local_output_nid generation:  0.0015933513641357422
local_in_edges_tensor generation:  0.0009319782257080078
mini_batch_src_global generation:  0.0011837482452392578
r_  generation:  0.01015162467956543
local_output_nid generation:  0.0016047954559326172
local_in_edges_tensor generation:  0.0009288787841796875
mini_batch_src_global generation:  0.0011835098266601562
r_  generation:  0.010780096054077148
local_output_nid generation:  0.0016024112701416016
local_in_edges_tensor generation:  0.0009169578552246094
mini_batch_src_global generation:  0.0011491775512695312
r_  generation:  0.01035451889038086
local_output_nid generation:  0.0015921592712402344
local_in_edges_tensor generation:  0.0009477138519287109
mini_batch_src_global generation:  0.0012094974517822266
r_  generation:  0.010854482650756836
local_output_nid generation:  0.0016078948974609375
local_in_edges_tensor generation:  0.0009143352508544922
mini_batch_src_global generation:  0.0011334419250488281
r_  generation:  0.010269880294799805
local_output_nid generation:  0.001638174057006836
local_in_edges_tensor generation:  0.0009162425994873047
mini_batch_src_global generation:  0.0011372566223144531
r_  generation:  0.01036214828491211
local_output_nid generation:  0.0015807151794433594
local_in_edges_tensor generation:  0.0009233951568603516
mini_batch_src_global generation:  0.0012156963348388672
r_  generation:  0.010469913482666016
local_output_nid generation:  0.0016033649444580078
local_in_edges_tensor generation:  0.0009007453918457031
mini_batch_src_global generation:  0.0011165142059326172
r_  generation:  0.010049819946289062
local_output_nid generation:  0.0016117095947265625
local_in_edges_tensor generation:  0.0009298324584960938
mini_batch_src_global generation:  0.0012388229370117188
r_  generation:  0.01061248779296875
local_output_nid generation:  0.0016281604766845703
local_in_edges_tensor generation:  0.0009279251098632812
mini_batch_src_global generation:  0.0011394023895263672
r_  generation:  0.010353803634643555
local_output_nid generation:  0.001596689224243164
local_in_edges_tensor generation:  0.0008974075317382812
mini_batch_src_global generation:  0.00119781494140625
r_  generation:  0.010050535202026367
local_output_nid generation:  0.001592874526977539
local_in_edges_tensor generation:  0.0009245872497558594
mini_batch_src_global generation:  0.0011875629425048828
r_  generation:  0.01042795181274414
local_output_nid generation:  0.0016009807586669922
local_in_edges_tensor generation:  0.0009124279022216797
mini_batch_src_global generation:  0.0011241436004638672
r_  generation:  0.009879827499389648
local_output_nid generation:  0.0016093254089355469
local_in_edges_tensor generation:  0.0009267330169677734
mini_batch_src_global generation:  0.001135110855102539
r_  generation:  0.01036524772644043
local_output_nid generation:  0.0015952587127685547
local_in_edges_tensor generation:  0.000911712646484375
mini_batch_src_global generation:  0.0011830329895019531
r_  generation:  0.010553836822509766
local_output_nid generation:  0.001583099365234375
local_in_edges_tensor generation:  0.0009076595306396484
mini_batch_src_global generation:  0.001130819320678711
r_  generation:  0.010223865509033203
local_output_nid generation:  0.0016045570373535156
local_in_edges_tensor generation:  0.0008914470672607422
mini_batch_src_global generation:  0.001123189926147461
r_  generation:  0.009990930557250977
local_output_nid generation:  0.0015876293182373047
local_in_edges_tensor generation:  0.0009083747863769531
mini_batch_src_global generation:  0.0011136531829833984
r_  generation:  0.010334253311157227
----------------------check_connections_block total spend ----------------------------- 0.5719151496887207
generate_one_block  0.024959087371826172
generate_one_block  0.02216315269470215
generate_one_block  0.01846003532409668
generate_one_block  0.019184350967407227
generate_one_block  0.018091201782226562
generate_one_block  0.017751693725585938
generate_one_block  0.018692731857299805
generate_one_block  0.01853489875793457
generate_one_block  0.0187530517578125
generate_one_block  0.018584251403808594
generate_one_block  0.018789052963256836
generate_one_block  0.01809096336364746
generate_one_block  0.01848006248474121
generate_one_block  0.018272876739501953
generate_one_block  0.018047571182250977
generate_one_block  0.019216537475585938
generate_one_block  0.018292665481567383
generate_one_block  0.019248008728027344
generate_one_block  0.018321752548217773
generate_one_block  0.018315553665161133
generate_one_block  0.01852273941040039
generate_one_block  0.017717361450195312
generate_one_block  0.02199387550354004
generate_one_block  0.018851518630981445
generate_one_block  0.018113136291503906
generate_one_block  0.018473386764526367
generate_one_block  0.019374608993530273
generate_one_block  0.018438339233398438
generate_one_block  0.018812894821166992
generate_one_block  0.01804327964782715
generate_one_block  0.017852067947387695
generate_one_block  0.018214941024780273
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0425877571105957
gen group dst list time:  0.022950172424316406
time for parepare:  0.02225947380065918
local_output_nid generation:  0.006641864776611328
local_in_edges_tensor generation:  0.02060842514038086
mini_batch_src_global generation:  0.01824808120727539
r_  generation:  0.16663551330566406
local_output_nid generation:  0.009264230728149414
local_in_edges_tensor generation:  0.011195182800292969
mini_batch_src_global generation:  0.022672414779663086
r_  generation:  0.17731451988220215
local_output_nid generation:  0.009090662002563477
local_in_edges_tensor generation:  0.03474736213684082
mini_batch_src_global generation:  0.01974940299987793
r_  generation:  0.16213440895080566
local_output_nid generation:  0.009622335433959961
local_in_edges_tensor generation:  0.011584758758544922
mini_batch_src_global generation:  0.021332263946533203
r_  generation:  0.17548513412475586
local_output_nid generation:  0.00931096076965332
local_in_edges_tensor generation:  0.011805295944213867
mini_batch_src_global generation:  0.022108078002929688
r_  generation:  0.17308521270751953
local_output_nid generation:  0.009088277816772461
local_in_edges_tensor generation:  0.01105499267578125
mini_batch_src_global generation:  0.02136063575744629
r_  generation:  0.17290854454040527
local_output_nid generation:  0.009083747863769531
local_in_edges_tensor generation:  0.010069131851196289
mini_batch_src_global generation:  0.022965431213378906
r_  generation:  0.18271827697753906
local_output_nid generation:  0.009096622467041016
local_in_edges_tensor generation:  0.009423017501831055
mini_batch_src_global generation:  0.022986650466918945
r_  generation:  0.17929744720458984
local_output_nid generation:  0.009129524230957031
local_in_edges_tensor generation:  0.00954580307006836
mini_batch_src_global generation:  0.02332329750061035
r_  generation:  0.18291926383972168
local_output_nid generation:  0.009417057037353516
local_in_edges_tensor generation:  0.01030421257019043
mini_batch_src_global generation:  0.022822141647338867
r_  generation:  0.17919349670410156
local_output_nid generation:  0.009374856948852539
local_in_edges_tensor generation:  0.009165525436401367
mini_batch_src_global generation:  0.024428367614746094
r_  generation:  0.18688631057739258
local_output_nid generation:  0.00918126106262207
local_in_edges_tensor generation:  0.0087738037109375
mini_batch_src_global generation:  0.021761655807495117
r_  generation:  0.1688094139099121
local_output_nid generation:  0.009639978408813477
local_in_edges_tensor generation:  0.009379386901855469
mini_batch_src_global generation:  0.02309584617614746
r_  generation:  0.18555879592895508
local_output_nid generation:  0.009499788284301758
local_in_edges_tensor generation:  0.009432315826416016
mini_batch_src_global generation:  0.022832155227661133
r_  generation:  0.17919278144836426
local_output_nid generation:  0.009420156478881836
local_in_edges_tensor generation:  0.009654998779296875
mini_batch_src_global generation:  0.02289724349975586
r_  generation:  0.1808462142944336
local_output_nid generation:  0.009872674942016602
local_in_edges_tensor generation:  0.0108184814453125
mini_batch_src_global generation:  0.024692058563232422
r_  generation:  0.18965744972229004
local_output_nid generation:  0.009501934051513672
local_in_edges_tensor generation:  0.009176969528198242
mini_batch_src_global generation:  0.023849964141845703
r_  generation:  0.18718504905700684
local_output_nid generation:  0.009954214096069336
local_in_edges_tensor generation:  0.009648323059082031
mini_batch_src_global generation:  0.024990558624267578
r_  generation:  0.18833208084106445
local_output_nid generation:  0.00962686538696289
local_in_edges_tensor generation:  0.009469747543334961
mini_batch_src_global generation:  0.02392888069152832
r_  generation:  0.18853116035461426
local_output_nid generation:  0.009844303131103516
local_in_edges_tensor generation:  0.01129460334777832
mini_batch_src_global generation:  0.022970199584960938
r_  generation:  0.1816720962524414
local_output_nid generation:  0.009604215621948242
local_in_edges_tensor generation:  0.010071754455566406
mini_batch_src_global generation:  0.023423194885253906
r_  generation:  0.18964910507202148
local_output_nid generation:  0.009319305419921875
local_in_edges_tensor generation:  0.00964212417602539
mini_batch_src_global generation:  0.023364543914794922
r_  generation:  0.17459917068481445
local_output_nid generation:  0.009810209274291992
local_in_edges_tensor generation:  0.009586095809936523
mini_batch_src_global generation:  0.023714542388916016
r_  generation:  0.19058561325073242
local_output_nid generation:  0.009444952011108398
local_in_edges_tensor generation:  0.009054183959960938
mini_batch_src_global generation:  0.022972583770751953
r_  generation:  0.17838215827941895
local_output_nid generation:  0.009394168853759766
local_in_edges_tensor generation:  0.009041309356689453
mini_batch_src_global generation:  0.022522926330566406
r_  generation:  0.17837262153625488
local_output_nid generation:  0.009582042694091797
local_in_edges_tensor generation:  0.009246826171875
mini_batch_src_global generation:  0.024163007736206055
r_  generation:  0.18528127670288086
local_output_nid generation:  0.009484052658081055
local_in_edges_tensor generation:  0.010303497314453125
mini_batch_src_global generation:  0.023039579391479492
r_  generation:  0.1816108226776123
local_output_nid generation:  0.00940084457397461
local_in_edges_tensor generation:  0.009909629821777344
mini_batch_src_global generation:  0.023656129837036133
r_  generation:  0.1830761432647705
local_output_nid generation:  0.009742975234985352
local_in_edges_tensor generation:  0.009667396545410156
mini_batch_src_global generation:  0.023350954055786133
r_  generation:  0.18717241287231445
local_output_nid generation:  0.009477376937866211
local_in_edges_tensor generation:  0.00966787338256836
mini_batch_src_global generation:  0.0226290225982666
r_  generation:  0.18150830268859863
local_output_nid generation:  0.009306907653808594
local_in_edges_tensor generation:  0.008997201919555664
mini_batch_src_global generation:  0.022627592086791992
r_  generation:  0.1802208423614502
local_output_nid generation:  0.00954890251159668
local_in_edges_tensor generation:  0.009760856628417969
mini_batch_src_global generation:  0.02303004264831543
r_  generation:  0.18455910682678223
----------------------check_connections_block total spend ----------------------------- 8.485749959945679
generate_one_block  0.2508375644683838
generate_one_block  0.2512962818145752
generate_one_block  0.22395968437194824
generate_one_block  0.24540948867797852
generate_one_block  0.2513608932495117
generate_one_block  0.2340085506439209
generate_one_block  0.25159788131713867
generate_one_block  0.24789690971374512
generate_one_block  0.24676847457885742
generate_one_block  0.24619317054748535
generate_one_block  0.2519962787628174
generate_one_block  0.22740602493286133
generate_one_block  0.2451317310333252
generate_one_block  0.24572420120239258
generate_one_block  0.24113798141479492
generate_one_block  0.25997114181518555
generate_one_block  0.2498950958251953
generate_one_block  0.25760769844055176
generate_one_block  0.2503058910369873
generate_one_block  0.2488105297088623
generate_one_block  0.25209999084472656
generate_one_block  0.23702001571655273
generate_one_block  0.25368285179138184
generate_one_block  0.23921656608581543
generate_one_block  0.2364192008972168
generate_one_block  0.24854016304016113
generate_one_block  0.24208736419677734
generate_one_block  0.2476487159729004
generate_one_block  0.2515707015991211
generate_one_block  0.24039721488952637
generate_one_block  0.24016022682189941
generate_one_block  0.24268245697021484
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.11249780654907227
gen group dst list time:  0.10762429237365723
time for parepare:  0.019919395446777344
local_output_nid generation:  0.025902509689331055
local_in_edges_tensor generation:  0.043725013732910156
mini_batch_src_global generation:  0.054583072662353516
r_  generation:  0.4498264789581299
local_output_nid generation:  0.03159737586975098
local_in_edges_tensor generation:  0.03765082359313965
mini_batch_src_global generation:  0.05406522750854492
r_  generation:  0.4476449489593506
local_output_nid generation:  0.03399300575256348
local_in_edges_tensor generation:  0.03073883056640625
mini_batch_src_global generation:  0.05252408981323242
r_  generation:  0.4509258270263672
local_output_nid generation:  0.034406423568725586
local_in_edges_tensor generation:  0.028547286987304688
mini_batch_src_global generation:  0.05364704132080078
r_  generation:  0.43440771102905273
local_output_nid generation:  0.032279253005981445
local_in_edges_tensor generation:  0.02684807777404785
mini_batch_src_global generation:  0.051635026931762695
r_  generation:  0.4394807815551758
local_output_nid generation:  0.03192901611328125
local_in_edges_tensor generation:  0.028016090393066406
mini_batch_src_global generation:  0.0523984432220459
r_  generation:  0.4386017322540283
local_output_nid generation:  0.030475378036499023
local_in_edges_tensor generation:  0.028960227966308594
mini_batch_src_global generation:  0.05184459686279297
r_  generation:  0.44365739822387695
local_output_nid generation:  0.03028082847595215
local_in_edges_tensor generation:  0.03007340431213379
mini_batch_src_global generation:  0.05303525924682617
r_  generation:  0.4398157596588135
local_output_nid generation:  0.03043818473815918
local_in_edges_tensor generation:  0.02701258659362793
mini_batch_src_global generation:  0.05392575263977051
r_  generation:  0.4457879066467285
local_output_nid generation:  0.030744552612304688
local_in_edges_tensor generation:  0.026933908462524414
mini_batch_src_global generation:  0.051276206970214844
r_  generation:  0.4382960796356201
local_output_nid generation:  0.030907869338989258
local_in_edges_tensor generation:  0.026500225067138672
mini_batch_src_global generation:  0.05002737045288086
r_  generation:  0.44258546829223633
local_output_nid generation:  0.030233383178710938
local_in_edges_tensor generation:  0.028190135955810547
mini_batch_src_global generation:  0.0509951114654541
r_  generation:  0.4328465461730957
local_output_nid generation:  0.030765771865844727
local_in_edges_tensor generation:  0.03306436538696289
mini_batch_src_global generation:  0.05082058906555176
r_  generation:  0.4449925422668457
local_output_nid generation:  0.030468225479125977
local_in_edges_tensor generation:  0.032262325286865234
mini_batch_src_global generation:  0.05463123321533203
r_  generation:  0.43957948684692383
local_output_nid generation:  0.030302762985229492
local_in_edges_tensor generation:  0.028931379318237305
mini_batch_src_global generation:  0.049768686294555664
r_  generation:  0.44197797775268555
local_output_nid generation:  0.030614852905273438
local_in_edges_tensor generation:  0.03001117706298828
mini_batch_src_global generation:  0.05270504951477051
r_  generation:  0.446824312210083
local_output_nid generation:  0.032630205154418945
local_in_edges_tensor generation:  0.030185699462890625
mini_batch_src_global generation:  0.05080556869506836
r_  generation:  0.4461381435394287
local_output_nid generation:  0.03184008598327637
local_in_edges_tensor generation:  0.029288768768310547
mini_batch_src_global generation:  0.05125021934509277
r_  generation:  0.4606952667236328
local_output_nid generation:  0.03277873992919922
local_in_edges_tensor generation:  0.033388614654541016
mini_batch_src_global generation:  0.053746938705444336
r_  generation:  0.4391326904296875
local_output_nid generation:  0.030506372451782227
local_in_edges_tensor generation:  0.030236244201660156
mini_batch_src_global generation:  0.05053544044494629
r_  generation:  0.44022297859191895
local_output_nid generation:  0.030529499053955078
local_in_edges_tensor generation:  0.028755903244018555
mini_batch_src_global generation:  0.05015158653259277
r_  generation:  0.4451146125793457
local_output_nid generation:  0.030025720596313477
local_in_edges_tensor generation:  0.031016111373901367
mini_batch_src_global generation:  0.05066871643066406
r_  generation:  0.44576025009155273
local_output_nid generation:  0.03102731704711914
local_in_edges_tensor generation:  0.02740621566772461
mini_batch_src_global generation:  0.050144195556640625
r_  generation:  0.4435427188873291
local_output_nid generation:  0.030565261840820312
local_in_edges_tensor generation:  0.030184268951416016
mini_batch_src_global generation:  0.05127859115600586
r_  generation:  0.44671010971069336
local_output_nid generation:  0.030292272567749023
local_in_edges_tensor generation:  0.0316166877746582
mini_batch_src_global generation:  0.05041956901550293
r_  generation:  0.4376335144042969
local_output_nid generation:  0.030343294143676758
local_in_edges_tensor generation:  0.02691054344177246
mini_batch_src_global generation:  0.05124974250793457
r_  generation:  0.4470803737640381
local_output_nid generation:  0.03055095672607422
local_in_edges_tensor generation:  0.032990455627441406
mini_batch_src_global generation:  0.04982805252075195
r_  generation:  0.4423031806945801
local_output_nid generation:  0.030924081802368164
local_in_edges_tensor generation:  0.027374982833862305
mini_batch_src_global generation:  0.05109262466430664
r_  generation:  0.44524312019348145
local_output_nid generation:  0.030575275421142578
local_in_edges_tensor generation:  0.027106285095214844
mini_batch_src_global generation:  0.04981112480163574
r_  generation:  0.4419379234313965
local_output_nid generation:  0.030170440673828125
local_in_edges_tensor generation:  0.028670787811279297
mini_batch_src_global generation:  0.050711631774902344
r_  generation:  0.4369056224822998
local_output_nid generation:  0.030550241470336914
local_in_edges_tensor generation:  0.026975393295288086
mini_batch_src_global generation:  0.051158905029296875
r_  generation:  0.448352575302124
local_output_nid generation:  0.03044915199279785
local_in_edges_tensor generation:  0.026729106903076172
mini_batch_src_global generation:  0.04987645149230957
r_  generation:  0.43958377838134766
----------------------check_connections_block total spend ----------------------------- 20.976381301879883
generate_one_block  0.6061956882476807
generate_one_block  0.5926392078399658
generate_one_block  0.5882318019866943
generate_one_block  0.5812587738037109
generate_one_block  0.6996705532073975
generate_one_block  0.5803141593933105
generate_one_block  0.5781154632568359
generate_one_block  0.5862390995025635
generate_one_block  0.5889275074005127
generate_one_block  0.5885522365570068
generate_one_block  0.5934948921203613
generate_one_block  0.575676679611206
generate_one_block  0.5863287448883057
generate_one_block  0.5828776359558105
generate_one_block  0.5829019546508789
generate_one_block  0.5898852348327637
generate_one_block  0.586327314376831
generate_one_block  0.5857508182525635
generate_one_block  0.5923311710357666
generate_one_block  0.5849721431732178
generate_one_block  0.5862581729888916
generate_one_block  0.5734996795654297
generate_one_block  0.5916252136230469
generate_one_block  0.5822250843048096
generate_one_block  0.5898325443267822
generate_one_block  0.5897865295410156
generate_one_block  0.5843431949615479
generate_one_block  0.5894625186920166
generate_one_block  0.5832908153533936
generate_one_block  0.5806396007537842
generate_one_block  0.5850186347961426
generate_one_block  0.5862758159637451
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.12703180313110352  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

connection checking time:  29.46213126182556
block generation total time  26.7317898273468
average batch blocks generation time:  0.8353684321045876
block dataloader generation time/epoch 59.537798047065735
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10672950744628906  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.10495948791504  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1069636344909668  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.40659189224243  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10578632354736328  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 17.953815937042236  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10698127746582031  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.07383918762207  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10650253295898438  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.57887887954712  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10656976699829102  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.479353427886963  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10638189315795898  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.08046579360962  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1065378189086914  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.95949363708496  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10682392120361328  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.06013822555542  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10678291320800781  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.01788091659546  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1068105697631836  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.24305534362793  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10616493225097656  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.114961624145508  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10689783096313477  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.98026466369629  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10655546188354492  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.828829765319824  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10649442672729492  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.666290760040283  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10704708099365234  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.487427711486816  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10679435729980469  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.04300308227539  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10702085494995117  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.477142333984375  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.106719970703125  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.104336738586426  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10677242279052734  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.89101505279541  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10701274871826172  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.14838933944702  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1062474250793457  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.47140407562256  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10689115524291992  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.29716396331787  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10656404495239258  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.74907159805298  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10615825653076172  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.509636402130127  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10676145553588867  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.072336673736572  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10647392272949219  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.801740646362305  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10675668716430664  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.949241161346436  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10637474060058594  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.028265476226807  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10612010955810547  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.707030296325684  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10659980773925781  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.701226234436035  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10629606246948242  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.690866470336914  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.032704927027225494 |0.0212361142039299 |0.5550470799207687 |9.55238938331604e-05 |1.066161572933197 |0.005899190902709961 |
----------------------------------------------------------pseudo_mini_loss sum 1.6728382110595703
Total (block generation + training)time/epoch 113.22424268722534
Training time/epoch 53.669328927993774
Training time without block to device /epoch 52.98977327346802
Training time without total dataloading part /epoch 51.887632846832275
load block tensor time/epoch 1.0465576648712158
block to device time/epoch 0.6795556545257568
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 11 |
Number of nodes for computation during this epoch:  9114280
Number of first layer input nodes during this epoch:  4762888
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1261734962463379  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0246737003326416
random selection method range initialization spend 0.006777048110961914
time for parepare:  0.020557165145874023
local_output_nid generation:  0.0014269351959228516
local_in_edges_tensor generation:  0.006314516067504883
mini_batch_src_global generation:  0.0018498897552490234
r_  generation:  0.011034727096557617
local_output_nid generation:  0.0016665458679199219
local_in_edges_tensor generation:  0.0011279582977294922
mini_batch_src_global generation:  0.0017292499542236328
r_  generation:  0.010769844055175781
local_output_nid generation:  0.0016601085662841797
local_in_edges_tensor generation:  0.0010025501251220703
mini_batch_src_global generation:  0.0012586116790771484
r_  generation:  0.010180473327636719
local_output_nid generation:  0.0016529560089111328
local_in_edges_tensor generation:  0.0009198188781738281
mini_batch_src_global generation:  0.001146554946899414
r_  generation:  0.009782791137695312
local_output_nid generation:  0.0016102790832519531
local_in_edges_tensor generation:  0.0009672641754150391
mini_batch_src_global generation:  0.00122833251953125
r_  generation:  0.01032710075378418
local_output_nid generation:  0.0016131401062011719
local_in_edges_tensor generation:  0.000919342041015625
mini_batch_src_global generation:  0.0011644363403320312
r_  generation:  0.010081052780151367
local_output_nid generation:  0.0016016960144042969
local_in_edges_tensor generation:  0.0009546279907226562
mini_batch_src_global generation:  0.0011174678802490234
r_  generation:  0.010023355484008789
local_output_nid generation:  0.0015938282012939453
local_in_edges_tensor generation:  0.0008916854858398438
mini_batch_src_global generation:  0.0011103153228759766
r_  generation:  0.00993657112121582
local_output_nid generation:  0.0015649795532226562
local_in_edges_tensor generation:  0.0009605884552001953
mini_batch_src_global generation:  0.0011343955993652344
r_  generation:  0.010309457778930664
local_output_nid generation:  0.0015833377838134766
local_in_edges_tensor generation:  0.0009703636169433594
mini_batch_src_global generation:  0.0011837482452392578
r_  generation:  0.010403633117675781
local_output_nid generation:  0.0015919208526611328
local_in_edges_tensor generation:  0.0008993148803710938
mini_batch_src_global generation:  0.00115203857421875
r_  generation:  0.010289430618286133
local_output_nid generation:  0.0015826225280761719
local_in_edges_tensor generation:  0.0008988380432128906
mini_batch_src_global generation:  0.0011126995086669922
r_  generation:  0.00997161865234375
local_output_nid generation:  0.0015883445739746094
local_in_edges_tensor generation:  0.0009396076202392578
mini_batch_src_global generation:  0.001127004623413086
r_  generation:  0.009853363037109375
local_output_nid generation:  0.0015857219696044922
local_in_edges_tensor generation:  0.0009121894836425781
mini_batch_src_global generation:  0.0011534690856933594
r_  generation:  0.010404825210571289
local_output_nid generation:  0.00157928466796875
local_in_edges_tensor generation:  0.0008990764617919922
mini_batch_src_global generation:  0.001132965087890625
r_  generation:  0.010296821594238281
local_output_nid generation:  0.001565694808959961
local_in_edges_tensor generation:  0.0009739398956298828
mini_batch_src_global generation:  0.0012087821960449219
r_  generation:  0.010777473449707031
local_output_nid generation:  0.0015881061553955078
local_in_edges_tensor generation:  0.0009832382202148438
mini_batch_src_global generation:  0.0012607574462890625
r_  generation:  0.010777473449707031
local_output_nid generation:  0.0015864372253417969
local_in_edges_tensor generation:  0.0009045600891113281
mini_batch_src_global generation:  0.001203775405883789
r_  generation:  0.01021718978881836
local_output_nid generation:  0.0016183853149414062
local_in_edges_tensor generation:  0.0009300708770751953
mini_batch_src_global generation:  0.0011839866638183594
r_  generation:  0.010555505752563477
local_output_nid generation:  0.0016012191772460938
local_in_edges_tensor generation:  0.0009002685546875
mini_batch_src_global generation:  0.001148223876953125
r_  generation:  0.010377168655395508
local_output_nid generation:  0.0016088485717773438
local_in_edges_tensor generation:  0.00090789794921875
mini_batch_src_global generation:  0.0011620521545410156
r_  generation:  0.010287046432495117
local_output_nid generation:  0.0015873908996582031
local_in_edges_tensor generation:  0.0008862018585205078
mini_batch_src_global generation:  0.0011258125305175781
r_  generation:  0.010239362716674805
local_output_nid generation:  0.0015664100646972656
local_in_edges_tensor generation:  0.0009391307830810547
mini_batch_src_global generation:  0.0012238025665283203
r_  generation:  0.010577917098999023
local_output_nid generation:  0.0015747547149658203
local_in_edges_tensor generation:  0.0008909702301025391
mini_batch_src_global generation:  0.0011491775512695312
r_  generation:  0.010401487350463867
local_output_nid generation:  0.0015697479248046875
local_in_edges_tensor generation:  0.0008978843688964844
mini_batch_src_global generation:  0.0011410713195800781
r_  generation:  0.010197162628173828
local_output_nid generation:  0.0015790462493896484
local_in_edges_tensor generation:  0.0009016990661621094
mini_batch_src_global generation:  0.0011622905731201172
r_  generation:  0.01042628288269043
local_output_nid generation:  0.0015687942504882812
local_in_edges_tensor generation:  0.0009248256683349609
mini_batch_src_global generation:  0.0012073516845703125
r_  generation:  0.011068344116210938
local_output_nid generation:  0.0015783309936523438
local_in_edges_tensor generation:  0.0009617805480957031
mini_batch_src_global generation:  0.0011739730834960938
r_  generation:  0.010564565658569336
local_output_nid generation:  0.0016050338745117188
local_in_edges_tensor generation:  0.0009067058563232422
mini_batch_src_global generation:  0.00115966796875
r_  generation:  0.010445594787597656
local_output_nid generation:  0.0016148090362548828
local_in_edges_tensor generation:  0.0009007453918457031
mini_batch_src_global generation:  0.0011317729949951172
r_  generation:  0.010129928588867188
local_output_nid generation:  0.0016002655029296875
local_in_edges_tensor generation:  0.0008738040924072266
mini_batch_src_global generation:  0.0011491775512695312
r_  generation:  0.010352134704589844
local_output_nid generation:  0.0015897750854492188
local_in_edges_tensor generation:  0.0009369850158691406
mini_batch_src_global generation:  0.001222848892211914
r_  generation:  0.010308027267456055
----------------------check_connections_block total spend ----------------------------- 0.572808027267456
generate_one_block  0.024582862854003906
generate_one_block  0.02161383628845215
generate_one_block  0.01934981346130371
generate_one_block  0.018082618713378906
generate_one_block  0.01903557777404785
generate_one_block  0.018157005310058594
generate_one_block  0.01792764663696289
generate_one_block  0.017742156982421875
generate_one_block  0.018413782119750977
generate_one_block  0.018314838409423828
generate_one_block  0.018045425415039062
generate_one_block  0.017798423767089844
generate_one_block  0.017512798309326172
generate_one_block  0.018386363983154297
generate_one_block  0.018070220947265625
generate_one_block  0.019039392471313477
generate_one_block  0.018924951553344727
generate_one_block  0.01794123649597168
generate_one_block  0.01846599578857422
generate_one_block  0.018248319625854492
generate_one_block  0.018095731735229492
generate_one_block  0.017843008041381836
generate_one_block  0.02175140380859375
generate_one_block  0.018892526626586914
generate_one_block  0.01805734634399414
generate_one_block  0.018372535705566406
generate_one_block  0.01936483383178711
generate_one_block  0.01847982406616211
generate_one_block  0.018558025360107422
generate_one_block  0.017620086669921875
generate_one_block  0.018201589584350586
generate_one_block  0.017937660217285156
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03912234306335449
gen group dst list time:  0.02340555191040039
time for parepare:  0.025312423706054688
local_output_nid generation:  0.007543802261352539
local_in_edges_tensor generation:  0.019025564193725586
mini_batch_src_global generation:  0.017489910125732422
r_  generation:  0.16938352584838867
local_output_nid generation:  0.009525537490844727
local_in_edges_tensor generation:  0.012328624725341797
mini_batch_src_global generation:  0.02269721031188965
r_  generation:  0.1739509105682373
local_output_nid generation:  0.009561300277709961
local_in_edges_tensor generation:  0.03373265266418457
mini_batch_src_global generation:  0.020824432373046875
r_  generation:  0.17822265625
local_output_nid generation:  0.009287357330322266
local_in_edges_tensor generation:  0.012048482894897461
mini_batch_src_global generation:  0.021149635314941406
r_  generation:  0.20818233489990234
local_output_nid generation:  0.013361692428588867
local_in_edges_tensor generation:  0.009905815124511719
mini_batch_src_global generation:  0.025908470153808594
r_  generation:  0.18886375427246094
local_output_nid generation:  0.008905887603759766
local_in_edges_tensor generation:  0.011327981948852539
mini_batch_src_global generation:  0.02302074432373047
r_  generation:  0.1799793243408203
local_output_nid generation:  0.00893712043762207
local_in_edges_tensor generation:  0.0106353759765625
mini_batch_src_global generation:  0.03325986862182617
r_  generation:  0.1915721893310547
local_output_nid generation:  0.011039018630981445
local_in_edges_tensor generation:  0.010078191757202148
mini_batch_src_global generation:  0.023585796356201172
r_  generation:  0.18100738525390625
local_output_nid generation:  0.009207963943481445
local_in_edges_tensor generation:  0.017578840255737305
mini_batch_src_global generation:  0.023572683334350586
r_  generation:  0.18262457847595215
local_output_nid generation:  0.015440702438354492
local_in_edges_tensor generation:  0.010684728622436523
mini_batch_src_global generation:  0.02791881561279297
r_  generation:  0.1805408000946045
local_output_nid generation:  0.009589195251464844
local_in_edges_tensor generation:  0.009190082550048828
mini_batch_src_global generation:  0.022606849670410156
r_  generation:  0.1790332794189453
local_output_nid generation:  0.00932931900024414
local_in_edges_tensor generation:  0.009589433670043945
mini_batch_src_global generation:  0.022372961044311523
r_  generation:  0.17464375495910645
local_output_nid generation:  0.009346723556518555
local_in_edges_tensor generation:  0.008801698684692383
mini_batch_src_global generation:  0.02235865592956543
r_  generation:  0.1770937442779541
local_output_nid generation:  0.009638309478759766
local_in_edges_tensor generation:  0.010571718215942383
mini_batch_src_global generation:  0.02406167984008789
r_  generation:  0.18199801445007324
local_output_nid generation:  0.009603261947631836
local_in_edges_tensor generation:  0.009092330932617188
mini_batch_src_global generation:  0.022547245025634766
r_  generation:  0.1804046630859375
local_output_nid generation:  0.010064363479614258
local_in_edges_tensor generation:  0.009407997131347656
mini_batch_src_global generation:  0.024599313735961914
r_  generation:  0.18818879127502441
local_output_nid generation:  0.00976109504699707
local_in_edges_tensor generation:  0.010510444641113281
mini_batch_src_global generation:  0.023514747619628906
r_  generation:  0.18874621391296387
local_output_nid generation:  0.00950002670288086
local_in_edges_tensor generation:  0.009109258651733398
mini_batch_src_global generation:  0.02278876304626465
r_  generation:  0.18132710456848145
local_output_nid generation:  0.00976109504699707
local_in_edges_tensor generation:  0.009281396865844727
mini_batch_src_global generation:  0.023197650909423828
r_  generation:  0.18481707572937012
local_output_nid generation:  0.009654521942138672
local_in_edges_tensor generation:  0.008951902389526367
mini_batch_src_global generation:  0.023000240325927734
r_  generation:  0.18328499794006348
local_output_nid generation:  0.009694576263427734
local_in_edges_tensor generation:  0.00918436050415039
mini_batch_src_global generation:  0.02297210693359375
r_  generation:  0.1857469081878662
local_output_nid generation:  0.009523630142211914
local_in_edges_tensor generation:  0.00893092155456543
mini_batch_src_global generation:  0.022952795028686523
r_  generation:  0.17946767807006836
local_output_nid generation:  0.009665727615356445
local_in_edges_tensor generation:  0.009091377258300781
mini_batch_src_global generation:  0.025032520294189453
r_  generation:  0.18702006340026855
local_output_nid generation:  0.009656190872192383
local_in_edges_tensor generation:  0.009301424026489258
mini_batch_src_global generation:  0.023214340209960938
r_  generation:  0.18065905570983887
local_output_nid generation:  0.00951695442199707
local_in_edges_tensor generation:  0.009003162384033203
mini_batch_src_global generation:  0.02241802215576172
r_  generation:  0.17839837074279785
local_output_nid generation:  0.009748697280883789
local_in_edges_tensor generation:  0.009422779083251953
mini_batch_src_global generation:  0.023047685623168945
r_  generation:  0.18249988555908203
local_output_nid generation:  0.01012873649597168
local_in_edges_tensor generation:  0.01189732551574707
mini_batch_src_global generation:  0.025197744369506836
r_  generation:  0.19276094436645508
local_output_nid generation:  0.009780168533325195
local_in_edges_tensor generation:  0.00955057144165039
mini_batch_src_global generation:  0.023384571075439453
r_  generation:  0.18385100364685059
local_output_nid generation:  0.009700775146484375
local_in_edges_tensor generation:  0.00933837890625
mini_batch_src_global generation:  0.02444624900817871
r_  generation:  0.1868124008178711
local_output_nid generation:  0.009183645248413086
local_in_edges_tensor generation:  0.010299921035766602
mini_batch_src_global generation:  0.0224916934967041
r_  generation:  0.1774604320526123
local_output_nid generation:  0.009652376174926758
local_in_edges_tensor generation:  0.009414196014404297
mini_batch_src_global generation:  0.022795915603637695
r_  generation:  0.187652587890625
local_output_nid generation:  0.009537935256958008
local_in_edges_tensor generation:  0.008909940719604492
mini_batch_src_global generation:  0.022486209869384766
r_  generation:  0.18204212188720703
----------------------check_connections_block total spend ----------------------------- 8.61590027809143
generate_one_block  0.2618100643157959
generate_one_block  0.25543212890625
generate_one_block  0.25092196464538574
generate_one_block  0.2409050464630127
generate_one_block  0.26999664306640625
generate_one_block  0.24298334121704102
generate_one_block  0.23697662353515625
generate_one_block  0.238694429397583
generate_one_block  0.24287700653076172
generate_one_block  0.2445073127746582
generate_one_block  0.23769688606262207
generate_one_block  0.23669886589050293
generate_one_block  0.24107885360717773
generate_one_block  0.2515134811401367
generate_one_block  0.24563097953796387
generate_one_block  0.2607738971710205
generate_one_block  0.2558267116546631
generate_one_block  0.24189162254333496
generate_one_block  0.25171446800231934
generate_one_block  0.2506098747253418
generate_one_block  0.2489776611328125
generate_one_block  0.24649691581726074
generate_one_block  0.2529134750366211
generate_one_block  0.2507619857788086
generate_one_block  0.23767971992492676
generate_one_block  0.24587798118591309
generate_one_block  0.2611854076385498
generate_one_block  0.24813437461853027
generate_one_block  0.2502133846282959
generate_one_block  0.23720908164978027
generate_one_block  0.24514436721801758
generate_one_block  0.24248814582824707
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03653907775878906
gen group dst list time:  0.11648917198181152
time for parepare:  0.018681049346923828
local_output_nid generation:  0.027346372604370117
local_in_edges_tensor generation:  0.0499262809753418
mini_batch_src_global generation:  0.03934931755065918
r_  generation:  0.43829965591430664
local_output_nid generation:  0.03175997734069824
local_in_edges_tensor generation:  0.03291749954223633
mini_batch_src_global generation:  0.04944443702697754
r_  generation:  0.42573070526123047
local_output_nid generation:  0.031989336013793945
local_in_edges_tensor generation:  0.02898573875427246
mini_batch_src_global generation:  0.050672292709350586
r_  generation:  0.43745899200439453
local_output_nid generation:  0.03171992301940918
local_in_edges_tensor generation:  0.032097578048706055
mini_batch_src_global generation:  0.05245208740234375
r_  generation:  0.4330129623413086
local_output_nid generation:  0.03222227096557617
local_in_edges_tensor generation:  0.03398489952087402
mini_batch_src_global generation:  0.051593780517578125
r_  generation:  0.4432077407836914
local_output_nid generation:  0.03220391273498535
local_in_edges_tensor generation:  0.03061819076538086
mini_batch_src_global generation:  0.050776004791259766
r_  generation:  0.43301820755004883
local_output_nid generation:  0.030040979385375977
local_in_edges_tensor generation:  0.02722024917602539
mini_batch_src_global generation:  0.04961657524108887
r_  generation:  0.4371657371520996
local_output_nid generation:  0.030597448348999023
local_in_edges_tensor generation:  0.029675960540771484
mini_batch_src_global generation:  0.052312612533569336
r_  generation:  0.4336707592010498
local_output_nid generation:  0.03125500679016113
local_in_edges_tensor generation:  0.029514789581298828
mini_batch_src_global generation:  0.05347323417663574
r_  generation:  0.44094038009643555
local_output_nid generation:  0.029892444610595703
local_in_edges_tensor generation:  0.0320742130279541
mini_batch_src_global generation:  0.05170750617980957
r_  generation:  0.43485450744628906
local_output_nid generation:  0.030013561248779297
local_in_edges_tensor generation:  0.032622337341308594
mini_batch_src_global generation:  0.051749229431152344
r_  generation:  0.43878865242004395
local_output_nid generation:  0.030101299285888672
local_in_edges_tensor generation:  0.027695894241333008
mini_batch_src_global generation:  0.050523996353149414
r_  generation:  0.43611598014831543
local_output_nid generation:  0.029935121536254883
local_in_edges_tensor generation:  0.02882838249206543
mini_batch_src_global generation:  0.0497589111328125
r_  generation:  0.4341857433319092
local_output_nid generation:  0.030132532119750977
local_in_edges_tensor generation:  0.031279563903808594
mini_batch_src_global generation:  0.05077958106994629
r_  generation:  0.45788097381591797
local_output_nid generation:  0.03299593925476074
local_in_edges_tensor generation:  0.030606746673583984
mini_batch_src_global generation:  0.05159354209899902
r_  generation:  0.4386632442474365
local_output_nid generation:  0.031239748001098633
local_in_edges_tensor generation:  0.02983880043029785
mini_batch_src_global generation:  0.05243277549743652
r_  generation:  0.4397585391998291
local_output_nid generation:  0.031203031539916992
local_in_edges_tensor generation:  0.029237747192382812
mini_batch_src_global generation:  0.05050992965698242
r_  generation:  0.43781471252441406
local_output_nid generation:  0.031269073486328125
local_in_edges_tensor generation:  0.02886486053466797
mini_batch_src_global generation:  0.05041384696960449
r_  generation:  0.4346957206726074
local_output_nid generation:  0.0307464599609375
local_in_edges_tensor generation:  0.029023408889770508
mini_batch_src_global generation:  0.04981708526611328
r_  generation:  0.43726396560668945
local_output_nid generation:  0.030806303024291992
local_in_edges_tensor generation:  0.02761387825012207
mini_batch_src_global generation:  0.05114436149597168
r_  generation:  0.44657111167907715
local_output_nid generation:  0.030731201171875
local_in_edges_tensor generation:  0.029119253158569336
mini_batch_src_global generation:  0.049268484115600586
r_  generation:  0.44368910789489746
local_output_nid generation:  0.030635356903076172
local_in_edges_tensor generation:  0.027370452880859375
mini_batch_src_global generation:  0.05037069320678711
r_  generation:  0.4380192756652832
local_output_nid generation:  0.030924320220947266
local_in_edges_tensor generation:  0.028803348541259766
mini_batch_src_global generation:  0.0496220588684082
r_  generation:  0.4401555061340332
local_output_nid generation:  0.030954837799072266
local_in_edges_tensor generation:  0.03060603141784668
mini_batch_src_global generation:  0.05004096031188965
r_  generation:  0.44774699211120605
local_output_nid generation:  0.030892133712768555
local_in_edges_tensor generation:  0.029498577117919922
mini_batch_src_global generation:  0.04991793632507324
r_  generation:  0.44384241104125977
local_output_nid generation:  0.03105759620666504
local_in_edges_tensor generation:  0.029788732528686523
mini_batch_src_global generation:  0.05230545997619629
r_  generation:  0.4398188591003418
local_output_nid generation:  0.031206130981445312
local_in_edges_tensor generation:  0.03131842613220215
mini_batch_src_global generation:  0.0496218204498291
r_  generation:  0.44391465187072754
local_output_nid generation:  0.031146526336669922
local_in_edges_tensor generation:  0.031649112701416016
mini_batch_src_global generation:  0.05268597602844238
r_  generation:  0.43646955490112305
local_output_nid generation:  0.031278133392333984
local_in_edges_tensor generation:  0.0276033878326416
mini_batch_src_global generation:  0.05115151405334473
r_  generation:  0.44161486625671387
local_output_nid generation:  0.030588865280151367
local_in_edges_tensor generation:  0.03158831596374512
mini_batch_src_global generation:  0.05048537254333496
r_  generation:  0.43642687797546387
local_output_nid generation:  0.03069758415222168
local_in_edges_tensor generation:  0.028130054473876953
mini_batch_src_global generation:  0.049623727798461914
r_  generation:  0.44702935218811035
local_output_nid generation:  0.030623435974121094
local_in_edges_tensor generation:  0.02694559097290039
mini_batch_src_global generation:  0.05093717575073242
r_  generation:  0.4424290657043457
----------------------check_connections_block total spend ----------------------------- 20.759804725646973
generate_one_block  0.602250337600708
generate_one_block  0.5910913944244385
generate_one_block  0.5857620239257812
generate_one_block  0.5819828510284424
generate_one_block  0.6914641857147217
generate_one_block  0.5800807476043701
generate_one_block  0.5766026973724365
generate_one_block  0.5829372406005859
generate_one_block  0.5823264122009277
generate_one_block  0.5767135620117188
generate_one_block  0.584054708480835
generate_one_block  0.5808541774749756
generate_one_block  0.5753028392791748
generate_one_block  0.5926723480224609
generate_one_block  0.591214656829834
generate_one_block  0.5951251983642578
generate_one_block  0.5815777778625488
generate_one_block  0.5776996612548828
generate_one_block  0.575833797454834
generate_one_block  0.586683988571167
generate_one_block  0.5918705463409424
generate_one_block  0.5821704864501953
generate_one_block  0.588789701461792
generate_one_block  0.5885522365570068
generate_one_block  0.5990211963653564
generate_one_block  0.5832579135894775
generate_one_block  0.5924215316772461
generate_one_block  0.5940907001495361
generate_one_block  0.5948789119720459
generate_one_block  0.5824787616729736
generate_one_block  0.5808088779449463
generate_one_block  0.577298641204834
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1261734962463379  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

connection checking time:  29.375705003738403
block generation total time  26.77349281311035
average batch blocks generation time:  0.8366716504096985
block dataloader generation time/epoch 59.52395908037821
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10806512832641602  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.175089836120605  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.106689453125  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.16979217529297  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10686492919921875  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.118412017822266  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10638570785522461  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.57327127456665  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10692262649536133  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.40186882019043  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1065826416015625  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.81438970565796  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1063222885131836  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.521004676818848  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10638046264648438  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.66845941543579  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10666465759277344  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.887486457824707  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10639047622680664  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.80148983001709  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1064000129699707  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.6804838180542  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10643911361694336  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.551494598388672  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10582256317138672  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.52527093887329  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10668134689331055  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.046224117279053  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10637807846069336  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.702208995819092  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10734415054321289  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.454235553741455  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10645246505737305  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.12264633178711  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10641956329345703  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.707504749298096  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10653305053710938  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.889580726623535  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10663270950317383  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.836214542388916  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10654973983764648  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.957290172576904  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10647773742675781  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.765442371368408  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10667181015014648  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.111358165740967  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10677099227905273  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.947880744934082  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10657930374145508  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.641236305236816  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10670709609985352  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.017199993133545  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10715579986572266  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.562653064727783  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10669422149658203  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.05126667022705  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10690116882324219  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.15822744369507  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10604238510131836  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.47560214996338  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10647201538085938  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.91504716873169  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10633420944213867  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.693893432617188  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.030659794807434082 |0.021073535084724426 |0.5537173375487328 |9.782612323760986e-05 |1.0646828711032867 |0.010105133056640625 |
----------------------------------------------------------pseudo_mini_loss sum 1.611255407333374
Total (block generation + training)time/epoch 113.15230544408162
Training time/epoch 53.51188373565674
Training time without block to device /epoch 52.83753061294556
Training time without total dataloading part /epoch 51.80204224586487
load block tensor time/epoch 0.9811134338378906
block to device time/epoch 0.6743531227111816
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 12 |
Number of nodes for computation during this epoch:  9112779
Number of first layer input nodes during this epoch:  4761002
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.12618350982666016  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023975372314453125
random selection method range initialization spend 0.005639553070068359
time for parepare:  0.020778656005859375
local_output_nid generation:  0.0014352798461914062
local_in_edges_tensor generation:  0.00823068618774414
mini_batch_src_global generation:  0.0018298625946044922
r_  generation:  0.010965347290039062
local_output_nid generation:  0.0015571117401123047
local_in_edges_tensor generation:  0.0011544227600097656
mini_batch_src_global generation:  0.0016283988952636719
r_  generation:  0.010170459747314453
local_output_nid generation:  0.0015845298767089844
local_in_edges_tensor generation:  0.001012563705444336
mini_batch_src_global generation:  0.0011417865753173828
r_  generation:  0.009699821472167969
local_output_nid generation:  0.0016021728515625
local_in_edges_tensor generation:  0.0009849071502685547
mini_batch_src_global generation:  0.0011484622955322266
r_  generation:  0.010105133056640625
local_output_nid generation:  0.0015866756439208984
local_in_edges_tensor generation:  0.0009672641754150391
mini_batch_src_global generation:  0.0011456012725830078
r_  generation:  0.010103940963745117
local_output_nid generation:  0.0015876293182373047
local_in_edges_tensor generation:  0.0009512901306152344
mini_batch_src_global generation:  0.0011379718780517578
r_  generation:  0.01012873649597168
local_output_nid generation:  0.0015819072723388672
local_in_edges_tensor generation:  0.0009520053863525391
mini_batch_src_global generation:  0.001131296157836914
r_  generation:  0.0101470947265625
local_output_nid generation:  0.0015826225280761719
local_in_edges_tensor generation:  0.0009517669677734375
mini_batch_src_global generation:  0.0011386871337890625
r_  generation:  0.010188102722167969
local_output_nid generation:  0.0015773773193359375
local_in_edges_tensor generation:  0.0009253025054931641
mini_batch_src_global generation:  0.001169443130493164
r_  generation:  0.01013803482055664
local_output_nid generation:  0.001585245132446289
local_in_edges_tensor generation:  0.0009436607360839844
mini_batch_src_global generation:  0.0011153221130371094
r_  generation:  0.010096073150634766
local_output_nid generation:  0.0015904903411865234
local_in_edges_tensor generation:  0.0009257793426513672
mini_batch_src_global generation:  0.001155853271484375
r_  generation:  0.010316610336303711
local_output_nid generation:  0.0016016960144042969
local_in_edges_tensor generation:  0.0009434223175048828
mini_batch_src_global generation:  0.0011594295501708984
r_  generation:  0.010495901107788086
local_output_nid generation:  0.0015835762023925781
local_in_edges_tensor generation:  0.0009386539459228516
mini_batch_src_global generation:  0.0011646747589111328
r_  generation:  0.010378122329711914
local_output_nid generation:  0.0015916824340820312
local_in_edges_tensor generation:  0.0009286403656005859
mini_batch_src_global generation:  0.0012192726135253906
r_  generation:  0.010552644729614258
local_output_nid generation:  0.0015881061553955078
local_in_edges_tensor generation:  0.0008985996246337891
mini_batch_src_global generation:  0.0011060237884521484
r_  generation:  0.010027885437011719
local_output_nid generation:  0.0015916824340820312
local_in_edges_tensor generation:  0.0009021759033203125
mini_batch_src_global generation:  0.0010979175567626953
r_  generation:  0.009781837463378906
local_output_nid generation:  0.001577615737915039
local_in_edges_tensor generation:  0.0009274482727050781
mini_batch_src_global generation:  0.0011451244354248047
r_  generation:  0.010269403457641602
local_output_nid generation:  0.001588582992553711
local_in_edges_tensor generation:  0.0009315013885498047
mini_batch_src_global generation:  0.0011599063873291016
r_  generation:  0.010264396667480469
local_output_nid generation:  0.0015766620635986328
local_in_edges_tensor generation:  0.0009436607360839844
mini_batch_src_global generation:  0.0011715888977050781
r_  generation:  0.010593652725219727
local_output_nid generation:  0.001581430435180664
local_in_edges_tensor generation:  0.0008897781372070312
mini_batch_src_global generation:  0.0011358261108398438
r_  generation:  0.010295867919921875
local_output_nid generation:  0.0015900135040283203
local_in_edges_tensor generation:  0.0009145736694335938
mini_batch_src_global generation:  0.0011544227600097656
r_  generation:  0.010614633560180664
local_output_nid generation:  0.0016164779663085938
local_in_edges_tensor generation:  0.0009603500366210938
mini_batch_src_global generation:  0.0012722015380859375
r_  generation:  0.010852336883544922
local_output_nid generation:  0.0016014575958251953
local_in_edges_tensor generation:  0.0009081363677978516
mini_batch_src_global generation:  0.0011343955993652344
r_  generation:  0.010090351104736328
local_output_nid generation:  0.0015888214111328125
local_in_edges_tensor generation:  0.0009109973907470703
mini_batch_src_global generation:  0.0010991096496582031
r_  generation:  0.009978055953979492
local_output_nid generation:  0.0015940666198730469
local_in_edges_tensor generation:  0.0009272098541259766
mini_batch_src_global generation:  0.0012292861938476562
r_  generation:  0.010636329650878906
local_output_nid generation:  0.0016167163848876953
local_in_edges_tensor generation:  0.0009353160858154297
mini_batch_src_global generation:  0.0011374950408935547
r_  generation:  0.009992599487304688
local_output_nid generation:  0.0015833377838134766
local_in_edges_tensor generation:  0.0009100437164306641
mini_batch_src_global generation:  0.0011410713195800781
r_  generation:  0.010355710983276367
local_output_nid generation:  0.0015819072723388672
local_in_edges_tensor generation:  0.0009527206420898438
mini_batch_src_global generation:  0.0011899471282958984
r_  generation:  0.010339021682739258
local_output_nid generation:  0.0015881061553955078
local_in_edges_tensor generation:  0.0009133815765380859
mini_batch_src_global generation:  0.0011849403381347656
r_  generation:  0.010707616806030273
local_output_nid generation:  0.0016047954559326172
local_in_edges_tensor generation:  0.000919342041015625
mini_batch_src_global generation:  0.0011680126190185547
r_  generation:  0.010397672653198242
local_output_nid generation:  0.0016050338745117188
local_in_edges_tensor generation:  0.0009391307830810547
mini_batch_src_global generation:  0.0012602806091308594
r_  generation:  0.01094961166381836
local_output_nid generation:  0.0016396045684814453
local_in_edges_tensor generation:  0.0009264945983886719
mini_batch_src_global generation:  0.0011699199676513672
r_  generation:  0.010639429092407227
----------------------check_connections_block total spend ----------------------------- 0.5744228363037109
generate_one_block  0.024538755416870117
generate_one_block  0.021229028701782227
generate_one_block  0.018638134002685547
generate_one_block  0.018778324127197266
generate_one_block  0.018444061279296875
generate_one_block  0.018236398696899414
generate_one_block  0.018098115921020508
generate_one_block  0.01824665069580078
generate_one_block  0.017864227294921875
generate_one_block  0.01802968978881836
generate_one_block  0.018181324005126953
generate_one_block  0.01882004737854004
generate_one_block  0.018523454666137695
generate_one_block  0.018515586853027344
generate_one_block  0.01758742332458496
generate_one_block  0.0173184871673584
generate_one_block  0.018239974975585938
generate_one_block  0.01813507080078125
generate_one_block  0.018765687942504883
generate_one_block  0.01811671257019043
generate_one_block  0.018311500549316406
generate_one_block  0.019004344940185547
generate_one_block  0.020796775817871094
generate_one_block  0.018265962600708008
generate_one_block  0.0189208984375
generate_one_block  0.017745018005371094
generate_one_block  0.0182497501373291
generate_one_block  0.018393754959106445
generate_one_block  0.018796682357788086
generate_one_block  0.018192768096923828
generate_one_block  0.01905679702758789
generate_one_block  0.018497705459594727
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03891134262084961
gen group dst list time:  0.023314952850341797
time for parepare:  0.021883487701416016
local_output_nid generation:  0.0064830780029296875
local_in_edges_tensor generation:  0.021007061004638672
mini_batch_src_global generation:  0.01767587661743164
r_  generation:  0.16582489013671875
local_output_nid generation:  0.009118795394897461
local_in_edges_tensor generation:  0.012432336807250977
mini_batch_src_global generation:  0.022237300872802734
r_  generation:  0.1692643165588379
local_output_nid generation:  0.00921320915222168
local_in_edges_tensor generation:  0.034941673278808594
mini_batch_src_global generation:  0.020891189575195312
r_  generation:  0.16869592666625977
local_output_nid generation:  0.009545087814331055
local_in_edges_tensor generation:  0.009852409362792969
mini_batch_src_global generation:  0.023957252502441406
r_  generation:  0.1754930019378662
local_output_nid generation:  0.009489059448242188
local_in_edges_tensor generation:  0.00917506217956543
mini_batch_src_global generation:  0.021974802017211914
r_  generation:  0.17756080627441406
local_output_nid generation:  0.009214639663696289
local_in_edges_tensor generation:  0.01121211051940918
mini_batch_src_global generation:  0.027513980865478516
r_  generation:  0.17927837371826172
local_output_nid generation:  0.008936405181884766
local_in_edges_tensor generation:  0.009288311004638672
mini_batch_src_global generation:  0.0232083797454834
r_  generation:  0.1768953800201416
local_output_nid generation:  0.008963346481323242
local_in_edges_tensor generation:  0.013549566268920898
mini_batch_src_global generation:  0.022495746612548828
r_  generation:  0.18297863006591797
local_output_nid generation:  0.008871793746948242
local_in_edges_tensor generation:  0.010089397430419922
mini_batch_src_global generation:  0.02289581298828125
r_  generation:  0.1780397891998291
local_output_nid generation:  0.009188413619995117
local_in_edges_tensor generation:  0.009587764739990234
mini_batch_src_global generation:  0.022629261016845703
r_  generation:  0.17967867851257324
local_output_nid generation:  0.009377717971801758
local_in_edges_tensor generation:  0.00891876220703125
mini_batch_src_global generation:  0.022519826889038086
r_  generation:  0.1798243522644043
local_output_nid generation:  0.009607076644897461
local_in_edges_tensor generation:  0.009157896041870117
mini_batch_src_global generation:  0.02423572540283203
r_  generation:  0.18335199356079102
local_output_nid generation:  0.009595394134521484
local_in_edges_tensor generation:  0.010495185852050781
mini_batch_src_global generation:  0.023354053497314453
r_  generation:  0.1822509765625
local_output_nid generation:  0.009570598602294922
local_in_edges_tensor generation:  0.009816884994506836
mini_batch_src_global generation:  0.026767969131469727
r_  generation:  0.18172454833984375
local_output_nid generation:  0.009274005889892578
local_in_edges_tensor generation:  0.01170206069946289
mini_batch_src_global generation:  0.022624492645263672
r_  generation:  0.17526936531066895
local_output_nid generation:  0.008988142013549805
local_in_edges_tensor generation:  0.009894609451293945
mini_batch_src_global generation:  0.02185511589050293
r_  generation:  0.17283105850219727
local_output_nid generation:  0.009459257125854492
local_in_edges_tensor generation:  0.009096622467041016
mini_batch_src_global generation:  0.02296757698059082
r_  generation:  0.18306493759155273
local_output_nid generation:  0.009522438049316406
local_in_edges_tensor generation:  0.009053468704223633
mini_batch_src_global generation:  0.022910594940185547
r_  generation:  0.17735910415649414
local_output_nid generation:  0.009773731231689453
local_in_edges_tensor generation:  0.013110637664794922
mini_batch_src_global generation:  0.024830102920532227
r_  generation:  0.18685078620910645
local_output_nid generation:  0.009452581405639648
local_in_edges_tensor generation:  0.010579586029052734
mini_batch_src_global generation:  0.023710012435913086
r_  generation:  0.18277502059936523
local_output_nid generation:  0.01044321060180664
local_in_edges_tensor generation:  0.009996414184570312
mini_batch_src_global generation:  0.023334264755249023
r_  generation:  0.1830730438232422
local_output_nid generation:  0.009822368621826172
local_in_edges_tensor generation:  0.00989532470703125
mini_batch_src_global generation:  0.023961782455444336
r_  generation:  0.1888875961303711
local_output_nid generation:  0.009362459182739258
local_in_edges_tensor generation:  0.009599924087524414
mini_batch_src_global generation:  0.02285480499267578
r_  generation:  0.1758873462677002
local_output_nid generation:  0.009254693984985352
local_in_edges_tensor generation:  0.00896310806274414
mini_batch_src_global generation:  0.022193193435668945
r_  generation:  0.17440390586853027
local_output_nid generation:  0.009872198104858398
local_in_edges_tensor generation:  0.009731531143188477
mini_batch_src_global generation:  0.023568153381347656
r_  generation:  0.18495440483093262
local_output_nid generation:  0.009344339370727539
local_in_edges_tensor generation:  0.008860588073730469
mini_batch_src_global generation:  0.022648334503173828
r_  generation:  0.17552518844604492
local_output_nid generation:  0.009444952011108398
local_in_edges_tensor generation:  0.009075403213500977
mini_batch_src_global generation:  0.022942781448364258
r_  generation:  0.1803879737854004
local_output_nid generation:  0.009560108184814453
local_in_edges_tensor generation:  0.009891510009765625
mini_batch_src_global generation:  0.023092985153198242
r_  generation:  0.1857001781463623
local_output_nid generation:  0.009758710861206055
local_in_edges_tensor generation:  0.010015726089477539
mini_batch_src_global generation:  0.02427840232849121
r_  generation:  0.1887502670288086
local_output_nid generation:  0.009402751922607422
local_in_edges_tensor generation:  0.009582757949829102
mini_batch_src_global generation:  0.02306056022644043
r_  generation:  0.18011236190795898
local_output_nid generation:  0.009830236434936523
local_in_edges_tensor generation:  0.010161638259887695
mini_batch_src_global generation:  0.024088382720947266
r_  generation:  0.19210243225097656
local_output_nid generation:  0.00963449478149414
local_in_edges_tensor generation:  0.009717226028442383
mini_batch_src_global generation:  0.0237882137298584
r_  generation:  0.18343091011047363
----------------------check_connections_block total spend ----------------------------- 8.469183921813965
generate_one_block  0.24848675727844238
generate_one_block  0.2481691837310791
generate_one_block  0.23955535888671875
generate_one_block  0.24402761459350586
generate_one_block  0.26195645332336426
generate_one_block  0.24756860733032227
generate_one_block  0.24166417121887207
generate_one_block  0.24556589126586914
generate_one_block  0.24412250518798828
generate_one_block  0.246290922164917
generate_one_block  0.24201512336730957
generate_one_block  0.24791288375854492
generate_one_block  0.24638724327087402
generate_one_block  0.2477264404296875
generate_one_block  0.23591256141662598
generate_one_block  0.23754405975341797
generate_one_block  0.24715471267700195
generate_one_block  0.24310016632080078
generate_one_block  0.25293493270874023
generate_one_block  0.25556087493896484
generate_one_block  0.2492659091949463
generate_one_block  0.25492143630981445
generate_one_block  0.23926734924316406
generate_one_block  0.23662686347961426
generate_one_block  0.25043702125549316
generate_one_block  0.23758745193481445
generate_one_block  0.24377131462097168
generate_one_block  0.24927020072937012
generate_one_block  0.2563750743865967
generate_one_block  0.2480766773223877
generate_one_block  0.26225948333740234
generate_one_block  0.2473456859588623
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.038661956787109375
gen group dst list time:  0.10678410530090332
time for parepare:  0.018418073654174805
local_output_nid generation:  0.026293277740478516
local_in_edges_tensor generation:  0.04098939895629883
mini_batch_src_global generation:  0.038926124572753906
r_  generation:  0.432647705078125
local_output_nid generation:  0.03156232833862305
local_in_edges_tensor generation:  0.03498959541320801
mini_batch_src_global generation:  0.049474239349365234
r_  generation:  0.42565035820007324
local_output_nid generation:  0.03148484230041504
local_in_edges_tensor generation:  0.028813838958740234
mini_batch_src_global generation:  0.048044681549072266
r_  generation:  0.4304790496826172
local_output_nid generation:  0.03166007995605469
local_in_edges_tensor generation:  0.02840876579284668
mini_batch_src_global generation:  0.04922890663146973
r_  generation:  0.43561339378356934
local_output_nid generation:  0.03442811965942383
local_in_edges_tensor generation:  0.03326058387756348
mini_batch_src_global generation:  0.049097537994384766
r_  generation:  0.4379112720489502
local_output_nid generation:  0.03156852722167969
local_in_edges_tensor generation:  0.02760934829711914
mini_batch_src_global generation:  0.050014495849609375
r_  generation:  0.4371178150177002
local_output_nid generation:  0.030022144317626953
local_in_edges_tensor generation:  0.0290374755859375
mini_batch_src_global generation:  0.051244497299194336
r_  generation:  0.4378623962402344
local_output_nid generation:  0.029710769653320312
local_in_edges_tensor generation:  0.027109622955322266
mini_batch_src_global generation:  0.05041384696960449
r_  generation:  0.4346959590911865
local_output_nid generation:  0.029560327529907227
local_in_edges_tensor generation:  0.028949975967407227
mini_batch_src_global generation:  0.04920625686645508
r_  generation:  0.43515539169311523
local_output_nid generation:  0.029630661010742188
local_in_edges_tensor generation:  0.02847456932067871
mini_batch_src_global generation:  0.05290579795837402
r_  generation:  0.44319748878479004
local_output_nid generation:  0.02943110466003418
local_in_edges_tensor generation:  0.02737879753112793
mini_batch_src_global generation:  0.049132585525512695
r_  generation:  0.43837952613830566
local_output_nid generation:  0.02950429916381836
local_in_edges_tensor generation:  0.02906060218811035
mini_batch_src_global generation:  0.05094099044799805
r_  generation:  0.4383072853088379
local_output_nid generation:  0.029625654220581055
local_in_edges_tensor generation:  0.029248952865600586
mini_batch_src_global generation:  0.05378270149230957
r_  generation:  0.44182777404785156
local_output_nid generation:  0.029747724533081055
local_in_edges_tensor generation:  0.02783656120300293
mini_batch_src_global generation:  0.050342559814453125
r_  generation:  0.4371609687805176
local_output_nid generation:  0.02967095375061035
local_in_edges_tensor generation:  0.0264589786529541
mini_batch_src_global generation:  0.04934859275817871
r_  generation:  0.436506986618042
local_output_nid generation:  0.029314041137695312
local_in_edges_tensor generation:  0.026915311813354492
mini_batch_src_global generation:  0.050243377685546875
r_  generation:  0.43525242805480957
local_output_nid generation:  0.029710054397583008
local_in_edges_tensor generation:  0.028761625289916992
mini_batch_src_global generation:  0.051470041275024414
r_  generation:  0.44400930404663086
local_output_nid generation:  0.029653072357177734
local_in_edges_tensor generation:  0.02664327621459961
mini_batch_src_global generation:  0.050293684005737305
r_  generation:  0.4571220874786377
local_output_nid generation:  0.03205752372741699
local_in_edges_tensor generation:  0.030792236328125
mini_batch_src_global generation:  0.051178693771362305
r_  generation:  0.4403402805328369
local_output_nid generation:  0.030275583267211914
local_in_edges_tensor generation:  0.02701091766357422
mini_batch_src_global generation:  0.05056881904602051
r_  generation:  0.43646931648254395
local_output_nid generation:  0.030467987060546875
local_in_edges_tensor generation:  0.028156757354736328
mini_batch_src_global generation:  0.05216217041015625
r_  generation:  0.4399423599243164
local_output_nid generation:  0.031229257583618164
local_in_edges_tensor generation:  0.02703404426574707
mini_batch_src_global generation:  0.05089592933654785
r_  generation:  0.4422125816345215
local_output_nid generation:  0.030230045318603516
local_in_edges_tensor generation:  0.028093576431274414
mini_batch_src_global generation:  0.05156254768371582
r_  generation:  0.4377906322479248
local_output_nid generation:  0.030354738235473633
local_in_edges_tensor generation:  0.027426719665527344
mini_batch_src_global generation:  0.05018162727355957
r_  generation:  0.4344761371612549
local_output_nid generation:  0.030392885208129883
local_in_edges_tensor generation:  0.028931379318237305
mini_batch_src_global generation:  0.05001187324523926
r_  generation:  0.4394228458404541
local_output_nid generation:  0.030380964279174805
local_in_edges_tensor generation:  0.028738021850585938
mini_batch_src_global generation:  0.04995608329772949
r_  generation:  0.43398499488830566
local_output_nid generation:  0.030393600463867188
local_in_edges_tensor generation:  0.02874612808227539
mini_batch_src_global generation:  0.054688453674316406
r_  generation:  0.4367852210998535
local_output_nid generation:  0.03069758415222168
local_in_edges_tensor generation:  0.02874922752380371
mini_batch_src_global generation:  0.05305933952331543
r_  generation:  0.44150471687316895
local_output_nid generation:  0.030924320220947266
local_in_edges_tensor generation:  0.029118061065673828
mini_batch_src_global generation:  0.05266618728637695
r_  generation:  0.4394185543060303
local_output_nid generation:  0.030453205108642578
local_in_edges_tensor generation:  0.026170969009399414
mini_batch_src_global generation:  0.05132699012756348
r_  generation:  0.4345710277557373
local_output_nid generation:  0.030598878860473633
local_in_edges_tensor generation:  0.028612852096557617
mini_batch_src_global generation:  0.052352190017700195
r_  generation:  0.443195104598999
local_output_nid generation:  0.030301809310913086
local_in_edges_tensor generation:  0.027459383010864258
mini_batch_src_global generation:  0.05139470100402832
r_  generation:  0.43578290939331055
----------------------check_connections_block total spend ----------------------------- 20.632976055145264
generate_one_block  0.5843746662139893
generate_one_block  0.5862665176391602
generate_one_block  0.5710887908935547
generate_one_block  0.5820193290710449
generate_one_block  0.6767079830169678
generate_one_block  0.5733582973480225
generate_one_block  0.5799624919891357
generate_one_block  0.572974681854248
generate_one_block  0.5725405216217041
generate_one_block  0.5834474563598633
generate_one_block  0.5785648822784424
generate_one_block  0.577491283416748
generate_one_block  0.5845816135406494
generate_one_block  0.5795657634735107
generate_one_block  0.5697166919708252
generate_one_block  0.5715060234069824
generate_one_block  0.5755965709686279
generate_one_block  0.5850820541381836
generate_one_block  0.5964057445526123
generate_one_block  0.5782878398895264
generate_one_block  0.5872025489807129
generate_one_block  0.5859050750732422
generate_one_block  0.573904275894165
generate_one_block  0.5829958915710449
generate_one_block  0.6036748886108398
generate_one_block  0.5801496505737305
generate_one_block  0.5855379104614258
generate_one_block  0.5880024433135986
generate_one_block  0.5863690376281738
generate_one_block  0.5834982395172119
generate_one_block  0.587195873260498
generate_one_block  0.5737907886505127
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.12618350982666016  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

connection checking time:  29.10215997695923
block generation total time  26.59662675857544
average batch blocks generation time:  0.8311445862054825
block dataloader generation time/epoch 59.39337241649628
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10665178298950195  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.993642330169678  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10657978057861328  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.923705577850342  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10618782043457031  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.52257251739502  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10675525665283203  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.985101222991943  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10670852661132812  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.000906467437744  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10666942596435547  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.999877452850342  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10679197311401367  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.845335483551025  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10648059844970703  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.94149112701416  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10642433166503906  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.73602294921875  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1064291000366211  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.784595012664795  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10616874694824219  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.803012371063232  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10664081573486328  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.05209732055664  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10668420791625977  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.024765014648438  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10667896270751953  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.062675952911377  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10643577575683594  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.362829208374023  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10614156723022461  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.425914764404297  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10648202896118164  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.913487434387207  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10668039321899414  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.77985143661499  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10712242126464844  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.327296257019043  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10667228698730469  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.072920322418213  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10672712326049805  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.0984148979187  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10703849792480469  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.42656373977661  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10628795623779297  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.529316425323486  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1063528060913086  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.543342113494873  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10674190521240234  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.1296968460083  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10624265670776367  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.5495548248291  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10648059844970703  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.766599655151367  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10672187805175781  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.089763164520264  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10697460174560547  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.35327386856079  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1064906120300293  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.855125427246094  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10672235488891602  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.53947162628174  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1063232421875  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.950660228729248  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.029559314250946045 |0.020522423088550568 |0.557367779314518 |9.52109694480896e-05 |1.0720733404159546 |0.00658869743347168 |
----------------------------------------------------------pseudo_mini_loss sum 1.574393630027771
Total (block generation + training)time/epoch 113.06737130880356
Training time/epoch 53.81068658828735
Training time without block to device /epoch 53.153969049453735
Training time without total dataloading part /epoch 52.15175127983093
load block tensor time/epoch 0.9458980560302734
block to device time/epoch 0.6567175388336182
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 13 |
Number of nodes for computation during this epoch:  9111459
Number of first layer input nodes during this epoch:  4760005
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.12625741958618164  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02341175079345703
random selection method range initialization spend 0.005312442779541016
time for parepare:  0.020665407180786133
local_output_nid generation:  0.0013785362243652344
local_in_edges_tensor generation:  0.005990028381347656
mini_batch_src_global generation:  0.0018527507781982422
r_  generation:  0.01079869270324707
local_output_nid generation:  0.0016491413116455078
local_in_edges_tensor generation:  0.0010695457458496094
mini_batch_src_global generation:  0.0016655921936035156
r_  generation:  0.010283708572387695
local_output_nid generation:  0.001611948013305664
local_in_edges_tensor generation:  0.000978708267211914
mini_batch_src_global generation:  0.0012392997741699219
r_  generation:  0.010486602783203125
local_output_nid generation:  0.0016057491302490234
local_in_edges_tensor generation:  0.000957489013671875
mini_batch_src_global generation:  0.0011348724365234375
r_  generation:  0.009754180908203125
local_output_nid generation:  0.0015950202941894531
local_in_edges_tensor generation:  0.0009601116180419922
mini_batch_src_global generation:  0.0011355876922607422
r_  generation:  0.010243892669677734
local_output_nid generation:  0.0015854835510253906
local_in_edges_tensor generation:  0.0009217262268066406
mini_batch_src_global generation:  0.0011904239654541016
r_  generation:  0.010578393936157227
local_output_nid generation:  0.0016160011291503906
local_in_edges_tensor generation:  0.0009157657623291016
mini_batch_src_global generation:  0.0011456012725830078
r_  generation:  0.010196208953857422
local_output_nid generation:  0.0015916824340820312
local_in_edges_tensor generation:  0.0009129047393798828
mini_batch_src_global generation:  0.0011167526245117188
r_  generation:  0.010101079940795898
local_output_nid generation:  0.0015802383422851562
local_in_edges_tensor generation:  0.0009353160858154297
mini_batch_src_global generation:  0.0011456012725830078
r_  generation:  0.01046299934387207
local_output_nid generation:  0.0015912055969238281
local_in_edges_tensor generation:  0.0009036064147949219
mini_batch_src_global generation:  0.001134634017944336
r_  generation:  0.010286569595336914
local_output_nid generation:  0.0015933513641357422
local_in_edges_tensor generation:  0.0009045600891113281
mini_batch_src_global generation:  0.0011138916015625
r_  generation:  0.010149240493774414
local_output_nid generation:  0.0015864372253417969
local_in_edges_tensor generation:  0.0009217262268066406
mini_batch_src_global generation:  0.001199960708618164
r_  generation:  0.010473012924194336
local_output_nid generation:  0.0015790462493896484
local_in_edges_tensor generation:  0.0009257793426513672
mini_batch_src_global generation:  0.0011479854583740234
r_  generation:  0.010306596755981445
local_output_nid generation:  0.0015759468078613281
local_in_edges_tensor generation:  0.0009419918060302734
mini_batch_src_global generation:  0.0011625289916992188
r_  generation:  0.01238107681274414
local_output_nid generation:  0.0015840530395507812
local_in_edges_tensor generation:  0.0009210109710693359
mini_batch_src_global generation:  0.0011467933654785156
r_  generation:  0.01036214828491211
local_output_nid generation:  0.0015802383422851562
local_in_edges_tensor generation:  0.000919342041015625
mini_batch_src_global generation:  0.0011570453643798828
r_  generation:  0.010413885116577148
local_output_nid generation:  0.0016231536865234375
local_in_edges_tensor generation:  0.0009164810180664062
mini_batch_src_global generation:  0.0010638236999511719
r_  generation:  0.009855031967163086
local_output_nid generation:  0.0015759468078613281
local_in_edges_tensor generation:  0.0009052753448486328
mini_batch_src_global generation:  0.0011749267578125
r_  generation:  0.010098934173583984
local_output_nid generation:  0.001569986343383789
local_in_edges_tensor generation:  0.0009181499481201172
mini_batch_src_global generation:  0.0011293888092041016
r_  generation:  0.010342121124267578
local_output_nid generation:  0.0015616416931152344
local_in_edges_tensor generation:  0.0009016990661621094
mini_batch_src_global generation:  0.0011479854583740234
r_  generation:  0.010483503341674805
local_output_nid generation:  0.0015730857849121094
local_in_edges_tensor generation:  0.0008833408355712891
mini_batch_src_global generation:  0.0011336803436279297
r_  generation:  0.010355949401855469
local_output_nid generation:  0.0015578269958496094
local_in_edges_tensor generation:  0.0008826255798339844
mini_batch_src_global generation:  0.001178741455078125
r_  generation:  0.010452985763549805
local_output_nid generation:  0.0015711784362792969
local_in_edges_tensor generation:  0.0008754730224609375
mini_batch_src_global generation:  0.001214742660522461
r_  generation:  0.01052093505859375
local_output_nid generation:  0.0015521049499511719
local_in_edges_tensor generation:  0.0008916854858398438
mini_batch_src_global generation:  0.0011703968048095703
r_  generation:  0.010106325149536133
local_output_nid generation:  0.001604318618774414
local_in_edges_tensor generation:  0.0009250640869140625
mini_batch_src_global generation:  0.001253366470336914
r_  generation:  0.010820627212524414
local_output_nid generation:  0.0016121864318847656
local_in_edges_tensor generation:  0.0009191036224365234
mini_batch_src_global generation:  0.0012040138244628906
r_  generation:  0.01082301139831543
local_output_nid generation:  0.001604318618774414
local_in_edges_tensor generation:  0.0008826255798339844
mini_batch_src_global generation:  0.0011582374572753906
r_  generation:  0.010336637496948242
local_output_nid generation:  0.0015757083892822266
local_in_edges_tensor generation:  0.0009067058563232422
mini_batch_src_global generation:  0.0011293888092041016
r_  generation:  0.01016855239868164
local_output_nid generation:  0.0015704631805419922
local_in_edges_tensor generation:  0.0009143352508544922
mini_batch_src_global generation:  0.0011169910430908203
r_  generation:  0.010169506072998047
local_output_nid generation:  0.0015773773193359375
local_in_edges_tensor generation:  0.0009691715240478516
mini_batch_src_global generation:  0.0011668205261230469
r_  generation:  0.010606765747070312
local_output_nid generation:  0.0015759468078613281
local_in_edges_tensor generation:  0.0009069442749023438
mini_batch_src_global generation:  0.0012292861938476562
r_  generation:  0.010561227798461914
local_output_nid generation:  0.0015783309936523438
local_in_edges_tensor generation:  0.000911712646484375
mini_batch_src_global generation:  0.001138925552368164
r_  generation:  0.010426521301269531
----------------------check_connections_block total spend ----------------------------- 0.574023962020874
generate_one_block  0.024136066436767578
generate_one_block  0.02127528190612793
generate_one_block  0.01977992057800293
generate_one_block  0.018157958984375
generate_one_block  0.018818378448486328
generate_one_block  0.018900156021118164
generate_one_block  0.018168210983276367
generate_one_block  0.017996549606323242
generate_one_block  0.018674612045288086
generate_one_block  0.018325328826904297
generate_one_block  0.01784992218017578
generate_one_block  0.018548250198364258
generate_one_block  0.018233776092529297
generate_one_block  0.018982648849487305
generate_one_block  0.017983198165893555
generate_one_block  0.01801443099975586
generate_one_block  0.01706695556640625
generate_one_block  0.017786502838134766
generate_one_block  0.018180131912231445
generate_one_block  0.018273591995239258
generate_one_block  0.018062353134155273
generate_one_block  0.018195390701293945
generate_one_block  0.021428585052490234
generate_one_block  0.018332481384277344
generate_one_block  0.019036054611206055
generate_one_block  0.018990516662597656
generate_one_block  0.018040895462036133
generate_one_block  0.01782703399658203
generate_one_block  0.017772912979125977
generate_one_block  0.018408775329589844
generate_one_block  0.018634557723999023
generate_one_block  0.018123865127563477
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03820967674255371
gen group dst list time:  0.02351212501525879
time for parepare:  0.022081851959228516
local_output_nid generation:  0.0064275264739990234
local_in_edges_tensor generation:  0.018366575241088867
mini_batch_src_global generation:  0.017678022384643555
r_  generation:  0.16089248657226562
local_output_nid generation:  0.009219884872436523
local_in_edges_tensor generation:  0.012169361114501953
mini_batch_src_global generation:  0.02087712287902832
r_  generation:  0.16858434677124023
local_output_nid generation:  0.009817361831665039
local_in_edges_tensor generation:  0.03607487678527832
mini_batch_src_global generation:  0.022233247756958008
r_  generation:  0.18100476264953613
local_output_nid generation:  0.00932931900024414
local_in_edges_tensor generation:  0.008986711502075195
mini_batch_src_global generation:  0.020806550979614258
r_  generation:  0.17206382751464844
local_output_nid generation:  0.009538888931274414
local_in_edges_tensor generation:  0.011491060256958008
mini_batch_src_global generation:  0.022241830825805664
r_  generation:  0.1804819107055664
local_output_nid generation:  0.009268522262573242
local_in_edges_tensor generation:  0.009376287460327148
mini_batch_src_global generation:  0.02395319938659668
r_  generation:  0.18571782112121582
local_output_nid generation:  0.008952140808105469
local_in_edges_tensor generation:  0.009097099304199219
mini_batch_src_global generation:  0.022609710693359375
r_  generation:  0.17534947395324707
local_output_nid generation:  0.008950233459472656
local_in_edges_tensor generation:  0.011068344116210938
mini_batch_src_global generation:  0.021811485290527344
r_  generation:  0.1771073341369629
local_output_nid generation:  0.009354829788208008
local_in_edges_tensor generation:  0.010232686996459961
mini_batch_src_global generation:  0.023289918899536133
r_  generation:  0.1838538646697998
local_output_nid generation:  0.009357929229736328
local_in_edges_tensor generation:  0.009207963943481445
mini_batch_src_global generation:  0.02264404296875
r_  generation:  0.18310904502868652
local_output_nid generation:  0.009262561798095703
local_in_edges_tensor generation:  0.010211944580078125
mini_batch_src_global generation:  0.022171497344970703
r_  generation:  0.17421269416809082
local_output_nid generation:  0.009578704833984375
local_in_edges_tensor generation:  0.00934457778930664
mini_batch_src_global generation:  0.023827791213989258
r_  generation:  0.18525934219360352
local_output_nid generation:  0.009592056274414062
local_in_edges_tensor generation:  0.010573863983154297
mini_batch_src_global generation:  0.02418351173400879
r_  generation:  0.18166232109069824
local_output_nid generation:  0.009900808334350586
local_in_edges_tensor generation:  0.010258197784423828
mini_batch_src_global generation:  0.024013996124267578
r_  generation:  0.1883068084716797
local_output_nid generation:  0.009540796279907227
local_in_edges_tensor generation:  0.009317398071289062
mini_batch_src_global generation:  0.023719072341918945
r_  generation:  0.18178415298461914
local_output_nid generation:  0.009488582611083984
local_in_edges_tensor generation:  0.009679555892944336
mini_batch_src_global generation:  0.022414684295654297
r_  generation:  0.1808156967163086
local_output_nid generation:  0.009084701538085938
local_in_edges_tensor generation:  0.008729219436645508
mini_batch_src_global generation:  0.022107601165771484
r_  generation:  0.17255878448486328
local_output_nid generation:  0.009402275085449219
local_in_edges_tensor generation:  0.009673595428466797
mini_batch_src_global generation:  0.023528099060058594
r_  generation:  0.17937326431274414
local_output_nid generation:  0.009459495544433594
local_in_edges_tensor generation:  0.009197711944580078
mini_batch_src_global generation:  0.023317813873291016
r_  generation:  0.1825883388519287
local_output_nid generation:  0.009514570236206055
local_in_edges_tensor generation:  0.009406089782714844
mini_batch_src_global generation:  0.023662090301513672
r_  generation:  0.18725848197937012
local_output_nid generation:  0.00954580307006836
local_in_edges_tensor generation:  0.009474992752075195
mini_batch_src_global generation:  0.02355027198791504
r_  generation:  0.18367981910705566
local_output_nid generation:  0.009598255157470703
local_in_edges_tensor generation:  0.009344339370727539
mini_batch_src_global generation:  0.02310657501220703
r_  generation:  0.1858670711517334
local_output_nid generation:  0.00960087776184082
local_in_edges_tensor generation:  0.009247779846191406
mini_batch_src_global generation:  0.022849559783935547
r_  generation:  0.1843719482421875
local_output_nid generation:  0.009214162826538086
local_in_edges_tensor generation:  0.00889277458190918
mini_batch_src_global generation:  0.022698402404785156
r_  generation:  0.18071365356445312
local_output_nid generation:  0.009835004806518555
local_in_edges_tensor generation:  0.010745525360107422
mini_batch_src_global generation:  0.024669408798217773
r_  generation:  0.18892931938171387
local_output_nid generation:  0.010057687759399414
local_in_edges_tensor generation:  0.014039754867553711
mini_batch_src_global generation:  0.025412559509277344
r_  generation:  0.1944265365600586
local_output_nid generation:  0.010421991348266602
local_in_edges_tensor generation:  0.00992131233215332
mini_batch_src_global generation:  0.022736549377441406
r_  generation:  0.18041515350341797
local_output_nid generation:  0.009416580200195312
local_in_edges_tensor generation:  0.009031295776367188
mini_batch_src_global generation:  0.022320032119750977
r_  generation:  0.17920327186584473
local_output_nid generation:  0.009426116943359375
local_in_edges_tensor generation:  0.009159088134765625
mini_batch_src_global generation:  0.02305746078491211
r_  generation:  0.1822960376739502
local_output_nid generation:  0.009579181671142578
local_in_edges_tensor generation:  0.00925135612487793
mini_batch_src_global generation:  0.023200273513793945
r_  generation:  0.18394708633422852
local_output_nid generation:  0.009633302688598633
local_in_edges_tensor generation:  0.008966922760009766
mini_batch_src_global generation:  0.023487567901611328
r_  generation:  0.18697237968444824
local_output_nid generation:  0.009401321411132812
local_in_edges_tensor generation:  0.009233236312866211
mini_batch_src_global generation:  0.02295398712158203
r_  generation:  0.18438148498535156
----------------------check_connections_block total spend ----------------------------- 8.50468897819519
generate_one_block  0.23990201950073242
generate_one_block  0.2445826530456543
generate_one_block  0.25635862350463867
generate_one_block  0.23882079124450684
generate_one_block  0.2658846378326416
generate_one_block  0.25412583351135254
generate_one_block  0.24085712432861328
generate_one_block  0.2401423454284668
generate_one_block  0.2493610382080078
generate_one_block  0.2443842887878418
generate_one_block  0.23838233947753906
generate_one_block  0.2514607906341553
generate_one_block  0.24767470359802246
generate_one_block  0.2582557201385498
generate_one_block  0.24573707580566406
generate_one_block  0.24646854400634766
generate_one_block  0.23262429237365723
generate_one_block  0.24020099639892578
generate_one_block  0.24700546264648438
generate_one_block  0.2606329917907715
generate_one_block  0.24831914901733398
generate_one_block  0.24653840065002441
generate_one_block  0.246809720993042
generate_one_block  0.2465956211090088
generate_one_block  0.25346803665161133
generate_one_block  0.26157569885253906
generate_one_block  0.23947358131408691
generate_one_block  0.23571181297302246
generate_one_block  0.24624395370483398
generate_one_block  0.24727797508239746
generate_one_block  0.25654149055480957
generate_one_block  0.24570512771606445
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.037584781646728516
gen group dst list time:  0.10891199111938477
time for parepare:  0.019349336624145508
local_output_nid generation:  0.026705026626586914
local_in_edges_tensor generation:  0.045217037200927734
mini_batch_src_global generation:  0.039020538330078125
r_  generation:  0.4226405620574951
local_output_nid generation:  0.031554460525512695
local_in_edges_tensor generation:  0.03266644477844238
mini_batch_src_global generation:  0.049356698989868164
r_  generation:  0.42863011360168457
local_output_nid generation:  0.03256821632385254
local_in_edges_tensor generation:  0.030442237854003906
mini_batch_src_global generation:  0.04838991165161133
r_  generation:  0.44304490089416504
local_output_nid generation:  0.03170967102050781
local_in_edges_tensor generation:  0.03265023231506348
mini_batch_src_global generation:  0.04917192459106445
r_  generation:  0.4322972297668457
local_output_nid generation:  0.03180217742919922
local_in_edges_tensor generation:  0.02955460548400879
mini_batch_src_global generation:  0.05064082145690918
r_  generation:  0.4443807601928711
local_output_nid generation:  0.03180670738220215
local_in_edges_tensor generation:  0.029628276824951172
mini_batch_src_global generation:  0.0505373477935791
r_  generation:  0.4375190734863281
local_output_nid generation:  0.03041696548461914
local_in_edges_tensor generation:  0.028922319412231445
mini_batch_src_global generation:  0.04907035827636719
r_  generation:  0.43774962425231934
local_output_nid generation:  0.02961564064025879
local_in_edges_tensor generation:  0.029204368591308594
mini_batch_src_global generation:  0.050150394439697266
r_  generation:  0.4370381832122803
local_output_nid generation:  0.029495716094970703
local_in_edges_tensor generation:  0.031135082244873047
mini_batch_src_global generation:  0.04946327209472656
r_  generation:  0.44121503829956055
local_output_nid generation:  0.029773712158203125
local_in_edges_tensor generation:  0.02905106544494629
mini_batch_src_global generation:  0.05141806602478027
r_  generation:  0.44260668754577637
local_output_nid generation:  0.030225038528442383
local_in_edges_tensor generation:  0.029483556747436523
mini_batch_src_global generation:  0.05064034461975098
r_  generation:  0.4410879611968994
local_output_nid generation:  0.02974677085876465
local_in_edges_tensor generation:  0.02722787857055664
mini_batch_src_global generation:  0.05030632019042969
r_  generation:  0.4372546672821045
local_output_nid generation:  0.029501914978027344
local_in_edges_tensor generation:  0.02762007713317871
mini_batch_src_global generation:  0.04928231239318848
r_  generation:  0.4580879211425781
local_output_nid generation:  0.03182363510131836
local_in_edges_tensor generation:  0.029343843460083008
mini_batch_src_global generation:  0.05355548858642578
r_  generation:  0.4423842430114746
local_output_nid generation:  0.030207395553588867
local_in_edges_tensor generation:  0.028672218322753906
mini_batch_src_global generation:  0.04960513114929199
r_  generation:  0.44375157356262207
local_output_nid generation:  0.029920101165771484
local_in_edges_tensor generation:  0.029212236404418945
mini_batch_src_global generation:  0.05304765701293945
r_  generation:  0.44025516510009766
local_output_nid generation:  0.03001856803894043
local_in_edges_tensor generation:  0.026660919189453125
mini_batch_src_global generation:  0.04850912094116211
r_  generation:  0.43474388122558594
local_output_nid generation:  0.030047893524169922
local_in_edges_tensor generation:  0.030985355377197266
mini_batch_src_global generation:  0.049971818923950195
r_  generation:  0.4376051425933838
local_output_nid generation:  0.03025054931640625
local_in_edges_tensor generation:  0.03289079666137695
mini_batch_src_global generation:  0.05129122734069824
r_  generation:  0.4405536651611328
local_output_nid generation:  0.030028581619262695
local_in_edges_tensor generation:  0.026947021484375
mini_batch_src_global generation:  0.05053901672363281
r_  generation:  0.43665194511413574
local_output_nid generation:  0.03003215789794922
local_in_edges_tensor generation:  0.02902054786682129
mini_batch_src_global generation:  0.05097484588623047
r_  generation:  0.43900370597839355
local_output_nid generation:  0.030014514923095703
local_in_edges_tensor generation:  0.027512311935424805
mini_batch_src_global generation:  0.05137038230895996
r_  generation:  0.4394092559814453
local_output_nid generation:  0.03013920783996582
local_in_edges_tensor generation:  0.029050827026367188
mini_batch_src_global generation:  0.04943442344665527
r_  generation:  0.4437446594238281
local_output_nid generation:  0.031625986099243164
local_in_edges_tensor generation:  0.027164936065673828
mini_batch_src_global generation:  0.05021047592163086
r_  generation:  0.4404435157775879
local_output_nid generation:  0.03027510643005371
local_in_edges_tensor generation:  0.028137922286987305
mini_batch_src_global generation:  0.04933285713195801
r_  generation:  0.44425082206726074
local_output_nid generation:  0.03052353858947754
local_in_edges_tensor generation:  0.031163930892944336
mini_batch_src_global generation:  0.05269002914428711
r_  generation:  0.4470977783203125
local_output_nid generation:  0.03027486801147461
local_in_edges_tensor generation:  0.028530597686767578
mini_batch_src_global generation:  0.04995584487915039
r_  generation:  0.4404428005218506
local_output_nid generation:  0.030084848403930664
local_in_edges_tensor generation:  0.02687549591064453
mini_batch_src_global generation:  0.050493478775024414
r_  generation:  0.435452938079834
local_output_nid generation:  0.02982020378112793
local_in_edges_tensor generation:  0.02666020393371582
mini_batch_src_global generation:  0.049439430236816406
r_  generation:  0.43942904472351074
local_output_nid generation:  0.0301971435546875
local_in_edges_tensor generation:  0.026776790618896484
mini_batch_src_global generation:  0.05051994323730469
r_  generation:  0.434734582901001
local_output_nid generation:  0.030614614486694336
local_in_edges_tensor generation:  0.030614376068115234
mini_batch_src_global generation:  0.049384117126464844
r_  generation:  0.445223331451416
local_output_nid generation:  0.030272245407104492
local_in_edges_tensor generation:  0.026864290237426758
mini_batch_src_global generation:  0.05098438262939453
r_  generation:  0.43915438652038574
----------------------check_connections_block total spend ----------------------------- 20.68469786643982
generate_one_block  0.5807590484619141
generate_one_block  0.5830507278442383
generate_one_block  0.5928854942321777
generate_one_block  0.5780959129333496
generate_one_block  0.6768503189086914
generate_one_block  0.5899622440338135
generate_one_block  0.5750718116760254
generate_one_block  0.580810546875
generate_one_block  0.5811464786529541
generate_one_block  0.5804681777954102
generate_one_block  0.5758628845214844
generate_one_block  0.5815825462341309
generate_one_block  0.5819079875946045
generate_one_block  0.588843584060669
generate_one_block  0.5781993865966797
generate_one_block  0.5766422748565674
generate_one_block  0.5719010829925537
generate_one_block  0.5786428451538086
generate_one_block  0.5851597785949707
generate_one_block  0.5815985202789307
generate_one_block  0.5813021659851074
generate_one_block  0.5769259929656982
generate_one_block  0.5831332206726074
generate_one_block  0.5823333263397217
generate_one_block  0.5992023944854736
generate_one_block  0.5871963500976562
generate_one_block  0.5824384689331055
generate_one_block  0.5790181159973145
generate_one_block  0.5815043449401855
generate_one_block  0.5781009197235107
generate_one_block  0.5968482494354248
generate_one_block  0.5825293064117432
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.12625741958618164  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

connection checking time:  29.18938684463501
block generation total time  26.64709734916687
average batch blocks generation time:  0.8327217921614647
block dataloader generation time/epoch 59.33519206047058
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10635137557983398  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.53285837173462  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10658454895019531  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.714417934417725  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10706233978271484  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.398707389831543  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10659599304199219  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.680315017700195  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10659456253051758  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.162739276885986  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10691642761230469  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.386287212371826  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10657787322998047  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.746931076049805  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10646915435791016  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.661712169647217  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10670137405395508  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.089743614196777  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10678577423095703  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.87178373336792  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10641622543334961  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.526813507080078  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10663986206054688  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.089174270629883  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10645008087158203  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.925006866455078  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10715103149414062  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.343459129333496  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10656929016113281  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.8232479095459  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1062464714050293  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.596460819244385  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10613822937011719  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.245516777038574  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1067957878112793  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.78485870361328  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10669374465942383  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.019413948059082  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10684967041015625  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.191368579864502  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10658884048461914  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.015449047088623  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10645103454589844  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.893677711486816  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10665702819824219  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.778448581695557  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10629892349243164  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.744035243988037  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10661888122558594  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.254759311676025  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10716962814331055  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.489824295043945  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10645198822021484  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.750678539276123  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10654926300048828  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.592620372772217  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10650205612182617  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.903367519378662  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10662174224853516  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.901160717010498  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10676908493041992  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.1750807762146  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10646820068359375  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.878382682800293  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.029407761991024017 |0.020602606236934662 |0.5552869886159897 |9.532272815704346e-05 |1.0683506578207016 |0.0063550472259521484 |
----------------------------------------------------------pseudo_mini_loss sum 1.5340811014175415
Total (block generation + training)time/epoch 112.99765095710754
Training time/epoch 53.616031885147095
Training time without block to device /epoch 52.956748485565186
Training time without total dataloading part /epoch 51.9658100605011
load block tensor time/epoch 0.9410483837127686
block to device time/epoch 0.6592833995819092
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 14 |
Number of nodes for computation during this epoch:  9115292
Number of first layer input nodes during this epoch:  4762739
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.12654542922973633  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025452136993408203
random selection method range initialization spend 0.006697654724121094
time for parepare:  0.021546363830566406
local_output_nid generation:  0.0014271736145019531
local_in_edges_tensor generation:  0.007088184356689453
mini_batch_src_global generation:  0.003000497817993164
r_  generation:  0.016082286834716797
local_output_nid generation:  0.00251007080078125
local_in_edges_tensor generation:  0.0013437271118164062
mini_batch_src_global generation:  0.002146005630493164
r_  generation:  0.011251688003540039
local_output_nid generation:  0.002432584762573242
local_in_edges_tensor generation:  0.0012748241424560547
mini_batch_src_global generation:  0.001455545425415039
r_  generation:  0.010460853576660156
local_output_nid generation:  0.0023729801177978516
local_in_edges_tensor generation:  0.0012555122375488281
mini_batch_src_global generation:  0.0014362335205078125
r_  generation:  0.010785102844238281
local_output_nid generation:  0.0023336410522460938
local_in_edges_tensor generation:  0.0012481212615966797
mini_batch_src_global generation:  0.0014863014221191406
r_  generation:  0.010016202926635742
local_output_nid generation:  0.0023407936096191406
local_in_edges_tensor generation:  0.0012352466583251953
mini_batch_src_global generation:  0.0014350414276123047
r_  generation:  0.010467052459716797
local_output_nid generation:  0.0023593902587890625
local_in_edges_tensor generation:  0.0012140274047851562
mini_batch_src_global generation:  0.0014271736145019531
r_  generation:  0.010267972946166992
local_output_nid generation:  0.0023376941680908203
local_in_edges_tensor generation:  0.001207113265991211
mini_batch_src_global generation:  0.0013852119445800781
r_  generation:  0.010250329971313477
local_output_nid generation:  0.0023255348205566406
local_in_edges_tensor generation:  0.0011987686157226562
mini_batch_src_global generation:  0.0013706684112548828
r_  generation:  0.01036381721496582
local_output_nid generation:  0.002343416213989258
local_in_edges_tensor generation:  0.0012400150299072266
mini_batch_src_global generation:  0.0013988018035888672
r_  generation:  0.010831117630004883
local_output_nid generation:  0.002321004867553711
local_in_edges_tensor generation:  0.0012106895446777344
mini_batch_src_global generation:  0.0014064311981201172
r_  generation:  0.01069021224975586
local_output_nid generation:  0.002335786819458008
local_in_edges_tensor generation:  0.001237630844116211
mini_batch_src_global generation:  0.0015707015991210938
r_  generation:  0.011078596115112305
local_output_nid generation:  0.0023720264434814453
local_in_edges_tensor generation:  0.0012335777282714844
mini_batch_src_global generation:  0.0013897418975830078
r_  generation:  0.010380744934082031
local_output_nid generation:  0.0023365020751953125
local_in_edges_tensor generation:  0.0012445449829101562
mini_batch_src_global generation:  0.0013654232025146484
r_  generation:  0.010652780532836914
local_output_nid generation:  0.0023500919342041016
local_in_edges_tensor generation:  0.001224517822265625
mini_batch_src_global generation:  0.0014085769653320312
r_  generation:  0.010608434677124023
local_output_nid generation:  0.002362966537475586
local_in_edges_tensor generation:  0.0012385845184326172
mini_batch_src_global generation:  0.0013699531555175781
r_  generation:  0.010499954223632812
local_output_nid generation:  0.0023314952850341797
local_in_edges_tensor generation:  0.001245260238647461
mini_batch_src_global generation:  0.0014216899871826172
r_  generation:  0.010761022567749023
local_output_nid generation:  0.002348661422729492
local_in_edges_tensor generation:  0.0012364387512207031
mini_batch_src_global generation:  0.0014040470123291016
r_  generation:  0.010459423065185547
local_output_nid generation:  0.0023698806762695312
local_in_edges_tensor generation:  0.0012600421905517578
mini_batch_src_global generation:  0.0014786720275878906
r_  generation:  0.010942459106445312
local_output_nid generation:  0.002376079559326172
local_in_edges_tensor generation:  0.0011947154998779297
mini_batch_src_global generation:  0.0015082359313964844
r_  generation:  0.010445833206176758
local_output_nid generation:  0.002378702163696289
local_in_edges_tensor generation:  0.001234292984008789
mini_batch_src_global generation:  0.0015838146209716797
r_  generation:  0.01129460334777832
local_output_nid generation:  0.0023870468139648438
local_in_edges_tensor generation:  0.0012395381927490234
mini_batch_src_global generation:  0.001425027847290039
r_  generation:  0.010939598083496094
local_output_nid generation:  0.00238037109375
local_in_edges_tensor generation:  0.001222848892211914
mini_batch_src_global generation:  0.0013954639434814453
r_  generation:  0.010600805282592773
local_output_nid generation:  0.002380847930908203
local_in_edges_tensor generation:  0.0012421607971191406
mini_batch_src_global generation:  0.0014102458953857422
r_  generation:  0.010776042938232422
local_output_nid generation:  0.002388477325439453
local_in_edges_tensor generation:  0.001194000244140625
mini_batch_src_global generation:  0.0013709068298339844
r_  generation:  0.010427474975585938
local_output_nid generation:  0.0023674964904785156
local_in_edges_tensor generation:  0.0012052059173583984
mini_batch_src_global generation:  0.0013737678527832031
r_  generation:  0.010630369186401367
local_output_nid generation:  0.0023686885833740234
local_in_edges_tensor generation:  0.0011959075927734375
mini_batch_src_global generation:  0.0013399124145507812
r_  generation:  0.010423898696899414
local_output_nid generation:  0.002348184585571289
local_in_edges_tensor generation:  0.0012469291687011719
mini_batch_src_global generation:  0.0015299320220947266
r_  generation:  0.010951995849609375
local_output_nid generation:  0.0023860931396484375
local_in_edges_tensor generation:  0.0012707710266113281
mini_batch_src_global generation:  0.0014824867248535156
r_  generation:  0.010950803756713867
local_output_nid generation:  0.002418041229248047
local_in_edges_tensor generation:  0.0012669563293457031
mini_batch_src_global generation:  0.0014867782592773438
r_  generation:  0.010523557662963867
local_output_nid generation:  0.002447366714477539
local_in_edges_tensor generation:  0.00122833251953125
mini_batch_src_global generation:  0.0014150142669677734
r_  generation:  0.010525941848754883
local_output_nid generation:  0.002374887466430664
local_in_edges_tensor generation:  0.001247406005859375
mini_batch_src_global generation:  0.001546621322631836
r_  generation:  0.010829925537109375
----------------------check_connections_block total spend ----------------------------- 0.6479299068450928
generate_one_block  0.028189897537231445
generate_one_block  0.024318218231201172
generate_one_block  0.021681785583496094
generate_one_block  0.020880460739135742
generate_one_block  0.019522428512573242
generate_one_block  0.019384145736694336
generate_one_block  0.019188880920410156
generate_one_block  0.018907546997070312
generate_one_block  0.019297122955322266
generate_one_block  0.019896507263183594
generate_one_block  0.019559144973754883
generate_one_block  0.02059316635131836
generate_one_block  0.019009113311767578
generate_one_block  0.019718170166015625
generate_one_block  0.019436359405517578
generate_one_block  0.0190737247467041
generate_one_block  0.019524812698364258
generate_one_block  0.01939105987548828
generate_one_block  0.01981806755065918
generate_one_block  0.019374370574951172
generate_one_block  0.020531892776489258
generate_one_block  0.01972675323486328
generate_one_block  0.023956775665283203
generate_one_block  0.020991086959838867
generate_one_block  0.019256114959716797
generate_one_block  0.01935720443725586
generate_one_block  0.01899552345275879
generate_one_block  0.019715070724487305
generate_one_block  0.019254446029663086
generate_one_block  0.018611669540405273
generate_one_block  0.019031286239624023
generate_one_block  0.019712209701538086
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.048308610916137695
gen group dst list time:  0.02618408203125
time for parepare:  0.02214360237121582
local_output_nid generation:  0.0067288875579833984
local_in_edges_tensor generation:  0.01951885223388672
mini_batch_src_global generation:  0.017357826232910156
r_  generation:  0.16216015815734863
local_output_nid generation:  0.008949995040893555
local_in_edges_tensor generation:  0.012114286422729492
mini_batch_src_global generation:  0.022054433822631836
r_  generation:  0.17596936225891113
local_output_nid generation:  0.009654045104980469
local_in_edges_tensor generation:  0.037595510482788086
mini_batch_src_global generation:  0.021685123443603516
r_  generation:  0.1859147548675537
local_output_nid generation:  0.009745359420776367
local_in_edges_tensor generation:  0.01245427131652832
mini_batch_src_global generation:  0.02312636375427246
r_  generation:  0.18651366233825684
local_output_nid generation:  0.010819673538208008
local_in_edges_tensor generation:  0.009677648544311523
mini_batch_src_global generation:  0.02170252799987793
r_  generation:  0.18050479888916016
local_output_nid generation:  0.010036230087280273
local_in_edges_tensor generation:  0.009709358215332031
mini_batch_src_global generation:  0.022452354431152344
r_  generation:  0.18062376976013184
local_output_nid generation:  0.008916378021240234
local_in_edges_tensor generation:  0.008988142013549805
mini_batch_src_global generation:  0.029915571212768555
r_  generation:  0.18164944648742676
local_output_nid generation:  0.00994563102722168
local_in_edges_tensor generation:  0.010603666305541992
mini_batch_src_global generation:  0.021999120712280273
r_  generation:  0.17569279670715332
local_output_nid generation:  0.009162664413452148
local_in_edges_tensor generation:  0.009221792221069336
mini_batch_src_global generation:  0.022617816925048828
r_  generation:  0.18201112747192383
local_output_nid generation:  0.009633541107177734
local_in_edges_tensor generation:  0.009363889694213867
mini_batch_src_global generation:  0.03712296485900879
r_  generation:  0.20685195922851562
local_output_nid generation:  0.014674901962280273
local_in_edges_tensor generation:  0.01266622543334961
mini_batch_src_global generation:  0.02676558494567871
r_  generation:  0.20416975021362305
local_output_nid generation:  0.01586627960205078
local_in_edges_tensor generation:  0.013120412826538086
mini_batch_src_global generation:  0.02942204475402832
r_  generation:  0.21393632888793945
local_output_nid generation:  0.013993978500366211
local_in_edges_tensor generation:  0.010454893112182617
mini_batch_src_global generation:  0.026404380798339844
r_  generation:  0.18434715270996094
local_output_nid generation:  0.01142263412475586
local_in_edges_tensor generation:  0.00998544692993164
mini_batch_src_global generation:  0.03075551986694336
r_  generation:  0.22366094589233398
local_output_nid generation:  0.010329723358154297
local_in_edges_tensor generation:  0.009275197982788086
mini_batch_src_global generation:  0.02756357192993164
r_  generation:  0.1860041618347168
local_output_nid generation:  0.009883403778076172
local_in_edges_tensor generation:  0.009008169174194336
mini_batch_src_global generation:  0.022573471069335938
r_  generation:  0.17940020561218262
local_output_nid generation:  0.009895801544189453
local_in_edges_tensor generation:  0.009268045425415039
mini_batch_src_global generation:  0.025476932525634766
r_  generation:  0.18694782257080078
local_output_nid generation:  0.009783267974853516
local_in_edges_tensor generation:  0.010465621948242188
mini_batch_src_global generation:  0.02320075035095215
r_  generation:  0.18871688842773438
local_output_nid generation:  0.009941339492797852
local_in_edges_tensor generation:  0.00968027114868164
mini_batch_src_global generation:  0.025675535202026367
r_  generation:  0.19297122955322266
local_output_nid generation:  0.009647130966186523
local_in_edges_tensor generation:  0.01459956169128418
mini_batch_src_global generation:  0.023698091506958008
r_  generation:  0.1878821849822998
local_output_nid generation:  0.010246038436889648
local_in_edges_tensor generation:  0.015879154205322266
mini_batch_src_global generation:  0.024842500686645508
r_  generation:  0.19116473197937012
local_output_nid generation:  0.009714603424072266
local_in_edges_tensor generation:  0.009947061538696289
mini_batch_src_global generation:  0.02374720573425293
r_  generation:  0.1897881031036377
local_output_nid generation:  0.0095977783203125
local_in_edges_tensor generation:  0.009002923965454102
mini_batch_src_global generation:  0.02283024787902832
r_  generation:  0.1795032024383545
local_output_nid generation:  0.00962686538696289
local_in_edges_tensor generation:  0.00989079475402832
mini_batch_src_global generation:  0.023890972137451172
r_  generation:  0.18432402610778809
local_output_nid generation:  0.009603500366210938
local_in_edges_tensor generation:  0.00883936882019043
mini_batch_src_global generation:  0.022468090057373047
r_  generation:  0.18108344078063965
local_output_nid generation:  0.009594202041625977
local_in_edges_tensor generation:  0.009787797927856445
mini_batch_src_global generation:  0.024186134338378906
r_  generation:  0.18357610702514648
local_output_nid generation:  0.009475231170654297
local_in_edges_tensor generation:  0.00964808464050293
mini_batch_src_global generation:  0.02244281768798828
r_  generation:  0.18017196655273438
local_output_nid generation:  0.009661436080932617
local_in_edges_tensor generation:  0.00990605354309082
mini_batch_src_global generation:  0.024558305740356445
r_  generation:  0.1924152374267578
local_output_nid generation:  0.009588956832885742
local_in_edges_tensor generation:  0.00887918472290039
mini_batch_src_global generation:  0.022671222686767578
r_  generation:  0.18465805053710938
local_output_nid generation:  0.009251117706298828
local_in_edges_tensor generation:  0.011446952819824219
mini_batch_src_global generation:  0.022138357162475586
r_  generation:  0.17520999908447266
local_output_nid generation:  0.009567737579345703
local_in_edges_tensor generation:  0.00875711441040039
mini_batch_src_global generation:  0.022797107696533203
r_  generation:  0.18317651748657227
local_output_nid generation:  0.010614156723022461
local_in_edges_tensor generation:  0.010747432708740234
mini_batch_src_global generation:  0.02556896209716797
r_  generation:  0.19869136810302734
----------------------check_connections_block total spend ----------------------------- 8.85156536102295
generate_one_block  0.259152889251709
generate_one_block  0.2442464828491211
generate_one_block  0.2533555030822754
generate_one_block  0.2575974464416504
generate_one_block  0.25731778144836426
generate_one_block  0.24273324012756348
generate_one_block  0.24526047706604004
generate_one_block  0.23775744438171387
generate_one_block  0.2515089511871338
generate_one_block  0.26283884048461914
generate_one_block  0.24990534782409668
generate_one_block  0.26015233993530273
generate_one_block  0.24853777885437012
generate_one_block  0.25113558769226074
generate_one_block  0.24485254287719727
generate_one_block  0.2394576072692871
generate_one_block  0.25048184394836426
generate_one_block  0.25038957595825195
generate_one_block  0.2538630962371826
generate_one_block  0.2557547092437744
generate_one_block  0.25862932205200195
generate_one_block  0.2523515224456787
generate_one_block  0.23939752578735352
generate_one_block  0.2442944049835205
generate_one_block  0.24607038497924805
generate_one_block  0.25067663192749023
generate_one_block  0.24737858772277832
generate_one_block  0.25458407402038574
generate_one_block  0.24215412139892578
generate_one_block  0.22987818717956543
generate_one_block  0.23706412315368652
generate_one_block  0.25464630126953125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.042513370513916016
gen group dst list time:  0.11661577224731445
time for parepare:  0.019572734832763672
local_output_nid generation:  0.026683568954467773
local_in_edges_tensor generation:  0.041121482849121094
mini_batch_src_global generation:  0.03849005699157715
r_  generation:  0.4352376461029053
local_output_nid generation:  0.034406185150146484
local_in_edges_tensor generation:  0.035314083099365234
mini_batch_src_global generation:  0.05221080780029297
r_  generation:  0.425335168838501
local_output_nid generation:  0.031845808029174805
local_in_edges_tensor generation:  0.031006813049316406
mini_batch_src_global generation:  0.04841446876525879
r_  generation:  0.4342005252838135
local_output_nid generation:  0.03210949897766113
local_in_edges_tensor generation:  0.029846668243408203
mini_batch_src_global generation:  0.05000162124633789
r_  generation:  0.4358246326446533
local_output_nid generation:  0.03202533721923828
local_in_edges_tensor generation:  0.029453277587890625
mini_batch_src_global generation:  0.05014824867248535
r_  generation:  0.43291568756103516
local_output_nid generation:  0.0323491096496582
local_in_edges_tensor generation:  0.028823137283325195
mini_batch_src_global generation:  0.05048966407775879
r_  generation:  0.43406105041503906
local_output_nid generation:  0.030096054077148438
local_in_edges_tensor generation:  0.03136324882507324
mini_batch_src_global generation:  0.04992485046386719
r_  generation:  0.4346139430999756
local_output_nid generation:  0.029839754104614258
local_in_edges_tensor generation:  0.027912378311157227
mini_batch_src_global generation:  0.052399396896362305
r_  generation:  0.43266725540161133
local_output_nid generation:  0.03038644790649414
local_in_edges_tensor generation:  0.0323481559753418
mini_batch_src_global generation:  0.049591779708862305
r_  generation:  0.4371767044067383
local_output_nid generation:  0.03255176544189453
local_in_edges_tensor generation:  0.03267216682434082
mini_batch_src_global generation:  0.05521821975708008
r_  generation:  0.4409172534942627
local_output_nid generation:  0.029987573623657227
local_in_edges_tensor generation:  0.028887271881103516
mini_batch_src_global generation:  0.05024981498718262
r_  generation:  0.4404933452606201
local_output_nid generation:  0.030282974243164062
local_in_edges_tensor generation:  0.030591249465942383
mini_batch_src_global generation:  0.05217385292053223
r_  generation:  0.43889641761779785
local_output_nid generation:  0.030655384063720703
local_in_edges_tensor generation:  0.029564380645751953
mini_batch_src_global generation:  0.053151607513427734
r_  generation:  0.44609808921813965
local_output_nid generation:  0.031029939651489258
local_in_edges_tensor generation:  0.028870582580566406
mini_batch_src_global generation:  0.05302834510803223
r_  generation:  0.4434492588043213
local_output_nid generation:  0.032058000564575195
local_in_edges_tensor generation:  0.0322573184967041
mini_batch_src_global generation:  0.05023026466369629
r_  generation:  0.44162845611572266
local_output_nid generation:  0.030431509017944336
local_in_edges_tensor generation:  0.026607513427734375
mini_batch_src_global generation:  0.05132794380187988
r_  generation:  0.4370410442352295
local_output_nid generation:  0.030586719512939453
local_in_edges_tensor generation:  0.026875734329223633
mini_batch_src_global generation:  0.050327301025390625
r_  generation:  0.44084715843200684
local_output_nid generation:  0.03132057189941406
local_in_edges_tensor generation:  0.031122207641601562
mini_batch_src_global generation:  0.051271677017211914
r_  generation:  0.45343852043151855
local_output_nid generation:  0.031131744384765625
local_in_edges_tensor generation:  0.03227734565734863
mini_batch_src_global generation:  0.050841331481933594
r_  generation:  0.453948974609375
local_output_nid generation:  0.0339200496673584
local_in_edges_tensor generation:  0.027700424194335938
mini_batch_src_global generation:  0.051720380783081055
r_  generation:  0.43760061264038086
local_output_nid generation:  0.030920743942260742
local_in_edges_tensor generation:  0.03042435646057129
mini_batch_src_global generation:  0.05028104782104492
r_  generation:  0.4429628849029541
local_output_nid generation:  0.030447006225585938
local_in_edges_tensor generation:  0.02711796760559082
mini_batch_src_global generation:  0.05097532272338867
r_  generation:  0.43491601943969727
local_output_nid generation:  0.0300295352935791
local_in_edges_tensor generation:  0.028952360153198242
mini_batch_src_global generation:  0.04977679252624512
r_  generation:  0.43694281578063965
local_output_nid generation:  0.030291318893432617
local_in_edges_tensor generation:  0.02892279624938965
mini_batch_src_global generation:  0.05116534233093262
r_  generation:  0.44299840927124023
local_output_nid generation:  0.030081748962402344
local_in_edges_tensor generation:  0.028377532958984375
mini_batch_src_global generation:  0.05179190635681152
r_  generation:  0.43902158737182617
local_output_nid generation:  0.03025197982788086
local_in_edges_tensor generation:  0.02689528465270996
mini_batch_src_global generation:  0.05047178268432617
r_  generation:  0.43875885009765625
local_output_nid generation:  0.029852867126464844
local_in_edges_tensor generation:  0.03151965141296387
mini_batch_src_global generation:  0.049881935119628906
r_  generation:  0.4371623992919922
local_output_nid generation:  0.0306398868560791
local_in_edges_tensor generation:  0.027121305465698242
mini_batch_src_global generation:  0.05203843116760254
r_  generation:  0.445573091506958
local_output_nid generation:  0.030237913131713867
local_in_edges_tensor generation:  0.03039383888244629
mini_batch_src_global generation:  0.05071449279785156
r_  generation:  0.44248533248901367
local_output_nid generation:  0.03040337562561035
local_in_edges_tensor generation:  0.029621362686157227
mini_batch_src_global generation:  0.05118584632873535
r_  generation:  0.433535099029541
local_output_nid generation:  0.03017735481262207
local_in_edges_tensor generation:  0.027043819427490234
mini_batch_src_global generation:  0.04933762550354004
r_  generation:  0.4388620853424072
local_output_nid generation:  0.030347347259521484
local_in_edges_tensor generation:  0.030649662017822266
mini_batch_src_global generation:  0.05091285705566406
r_  generation:  0.441774845123291
----------------------check_connections_block total spend ----------------------------- 20.77830457687378
generate_one_block  0.5943090915679932
generate_one_block  0.5880036354064941
generate_one_block  0.5858490467071533
generate_one_block  0.5816295146942139
generate_one_block  0.6829891204833984
generate_one_block  0.5805706977844238
generate_one_block  0.5832192897796631
generate_one_block  0.5750784873962402
generate_one_block  0.5874602794647217
generate_one_block  0.5849275588989258
generate_one_block  0.5792419910430908
generate_one_block  0.5885825157165527
generate_one_block  0.5874330997467041
generate_one_block  0.5939960479736328
generate_one_block  0.5811336040496826
generate_one_block  0.5820562839508057
generate_one_block  0.5943379402160645
generate_one_block  0.5915265083312988
generate_one_block  0.5861167907714844
generate_one_block  0.5836172103881836
generate_one_block  0.592210054397583
generate_one_block  0.5765359401702881
generate_one_block  0.5748331546783447
generate_one_block  0.5838730335235596
generate_one_block  0.5981621742248535
generate_one_block  0.5800833702087402
generate_one_block  0.5772044658660889
generate_one_block  0.5838372707366943
generate_one_block  0.5787179470062256
generate_one_block  0.5818188190460205
generate_one_block  0.5831692218780518
generate_one_block  0.5953342914581299
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.12654542922973633  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

connection checking time:  29.62986993789673
block generation total time  26.791283130645752
average batch blocks generation time:  0.8372275978326797
block dataloader generation time/epoch 59.4310185511907
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10609674453735352  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.590370655059814  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10640954971313477  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.916701316833496  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10660982131958008  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.174644947052002  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10686731338500977  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.417771816253662  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10634231567382812  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.72941541671753  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10667037963867188  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.80647563934326  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10639142990112305  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.822518348693848  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10606575012207031  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.46687602996826  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10677003860473633  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.95111846923828  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10678672790527344  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.113805770874023  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10623550415039062  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.88908290863037  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10674381256103516  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.43465232849121  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10660791397094727  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.785236358642578  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10681819915771484  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.100733757019043  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10640382766723633  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.724181175231934  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10652875900268555  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 18.454320907592773  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10675287246704102  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.046069622039795  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10700035095214844  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 19.088670253753662  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1068572998046875  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7225341796875 GB
    Memory Allocated: 19.192139148712158  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10661125183105469  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 19.05598211288452  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10717105865478516  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 19.506263256072998  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10673999786376953  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 19.151299953460693  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10610723495483398  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.616202354431152  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10686111450195312  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.954943656921387  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10644721984863281  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.73905038833618  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10653209686279297  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.911426544189453  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10594797134399414  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.56040334701538  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.1068110466003418  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 19.06587314605713  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10624074935913086  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.675549030303955  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10617399215698242  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.09225845336914  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10644292831420898  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.395143508911133  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10661840438842773  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 19.059589862823486  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03482227027416229 |0.020717382431030273 |0.5555950477719307 |9.403377771377563e-05 |1.067661501467228 |0.005326271057128906 |
----------------------------------------------------------pseudo_mini_loss sum 1.5096056461334229
Total (block generation + training)time/epoch 113.11331641674042
Training time/epoch 53.781261920928955
Training time without block to device /epoch 53.118305683135986
Training time without total dataloading part /epoch 51.952544927597046
load block tensor time/epoch 1.1143126487731934
block to device time/epoch 0.6629562377929688
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 15 |
Number of nodes for computation during this epoch:  9107903
Number of first layer input nodes during this epoch:  4759258
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.1267075538635254  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02983546257019043
random selection method range initialization spend 0.0064046382904052734
time for parepare:  0.024249553680419922
local_output_nid generation:  0.0017888545989990234
local_in_edges_tensor generation:  0.005599260330200195
mini_batch_src_global generation:  0.002421855926513672
r_  generation:  0.011292457580566406
local_output_nid generation:  0.0018627643585205078
local_in_edges_tensor generation:  0.0012586116790771484
mini_batch_src_global generation:  0.0020067691802978516
r_  generation:  0.010900497436523438
local_output_nid generation:  0.002038240432739258
local_in_edges_tensor generation:  0.0012538433074951172
mini_batch_src_global generation:  0.0014753341674804688
r_  generation:  0.010179519653320312
local_output_nid generation:  0.002127408981323242
local_in_edges_tensor generation:  0.0012176036834716797
mini_batch_src_global generation:  0.0014176368713378906
r_  generation:  0.010308027267456055
local_output_nid generation:  0.002117633819580078
local_in_edges_tensor generation:  0.0012042522430419922
mini_batch_src_global generation:  0.001444101333618164
r_  generation:  0.010501623153686523
local_output_nid generation:  0.002171039581298828
local_in_edges_tensor generation:  0.0012362003326416016
mini_batch_src_global generation:  0.0014410018920898438
r_  generation:  0.010912895202636719
local_output_nid generation:  0.002209901809692383
local_in_edges_tensor generation:  0.001219034194946289
mini_batch_src_global generation:  0.0015480518341064453
r_  generation:  0.010871410369873047
local_output_nid generation:  0.0022428035736083984
local_in_edges_tensor generation:  0.0012247562408447266
mini_batch_src_global generation:  0.0013327598571777344
r_  generation:  0.010243415832519531
local_output_nid generation:  0.0022306442260742188
local_in_edges_tensor generation:  0.0012102127075195312
mini_batch_src_global generation:  0.0013649463653564453
r_  generation:  0.010355949401855469
local_output_nid generation:  0.0022537708282470703
local_in_edges_tensor generation:  0.0012252330780029297
mini_batch_src_global generation:  0.0015192031860351562
r_  generation:  0.010821342468261719
local_output_nid generation:  0.0022563934326171875
local_in_edges_tensor generation:  0.0012035369873046875
mini_batch_src_global generation:  0.0014040470123291016
r_  generation:  0.01078176498413086
local_output_nid generation:  0.0022559165954589844
local_in_edges_tensor generation:  0.0012068748474121094
mini_batch_src_global generation:  0.0013511180877685547
r_  generation:  0.010291099548339844
local_output_nid generation:  0.0022459030151367188
local_in_edges_tensor generation:  0.0011687278747558594
mini_batch_src_global generation:  0.0014624595642089844
r_  generation:  0.010469198226928711
local_output_nid generation:  0.0022759437561035156
local_in_edges_tensor generation:  0.0012061595916748047
mini_batch_src_global generation:  0.0014219284057617188
r_  generation:  0.010915040969848633
local_output_nid generation:  0.0022902488708496094
local_in_edges_tensor generation:  0.0011870861053466797
mini_batch_src_global generation:  0.0013353824615478516
r_  generation:  0.010432958602905273
local_output_nid generation:  0.0022656917572021484
local_in_edges_tensor generation:  0.0012085437774658203
mini_batch_src_global generation:  0.0013804435729980469
r_  generation:  0.010656356811523438
local_output_nid generation:  0.002259492874145508
local_in_edges_tensor generation:  0.0012183189392089844
mini_batch_src_global generation:  0.0013964176177978516
r_  generation:  0.010794639587402344
local_output_nid generation:  0.002264261245727539
local_in_edges_tensor generation:  0.0011968612670898438
mini_batch_src_global generation:  0.0014178752899169922
r_  generation:  0.010938405990600586
local_output_nid generation:  0.002293825149536133
local_in_edges_tensor generation:  0.0012214183807373047
mini_batch_src_global generation:  0.0015616416931152344
r_  generation:  0.011003255844116211
local_output_nid generation:  0.002307891845703125
local_in_edges_tensor generation:  0.0012061595916748047
mini_batch_src_global generation:  0.0014667510986328125
r_  generation:  0.010529518127441406
local_output_nid generation:  0.002275705337524414
local_in_edges_tensor generation:  0.0011975765228271484
mini_batch_src_global generation:  0.0015006065368652344
r_  generation:  0.010630130767822266
local_output_nid generation:  0.002332925796508789
local_in_edges_tensor generation:  0.0012197494506835938
mini_batch_src_global generation:  0.0013759136199951172
r_  generation:  0.010543107986450195
local_output_nid generation:  0.002325773239135742
local_in_edges_tensor generation:  0.0012395381927490234
mini_batch_src_global generation:  0.0013926029205322266
r_  generation:  0.011056900024414062
local_output_nid generation:  0.002330303192138672
local_in_edges_tensor generation:  0.0012042522430419922
mini_batch_src_global generation:  0.0013985633850097656
r_  generation:  0.010803699493408203
local_output_nid generation:  0.002338409423828125
local_in_edges_tensor generation:  0.0011973381042480469
mini_batch_src_global generation:  0.0014116764068603516
r_  generation:  0.010671615600585938
local_output_nid generation:  0.002317667007446289
local_in_edges_tensor generation:  0.0019795894622802734
mini_batch_src_global generation:  0.004026651382446289
r_  generation:  0.01681685447692871
local_output_nid generation:  0.002863645553588867
local_in_edges_tensor generation:  0.0013074874877929688
mini_batch_src_global generation:  0.0015344619750976562
r_  generation:  0.010729551315307617
local_output_nid generation:  0.0024373531341552734
local_in_edges_tensor generation:  0.0011684894561767578
mini_batch_src_global generation:  0.0012145042419433594
r_  generation:  0.010293245315551758
local_output_nid generation:  0.0022728443145751953
local_in_edges_tensor generation:  0.0010406970977783203
mini_batch_src_global generation:  0.0014290809631347656
r_  generation:  0.010579824447631836
local_output_nid generation:  0.002196073532104492
local_in_edges_tensor generation:  0.0010478496551513672
mini_batch_src_global generation:  0.0011324882507324219
r_  generation:  0.010131120681762695
local_output_nid generation:  0.0020771026611328125
local_in_edges_tensor generation:  0.0010631084442138672
mini_batch_src_global generation:  0.0012140274047851562
r_  generation:  0.01064157485961914
local_output_nid generation:  0.002034425735473633
local_in_edges_tensor generation:  0.0010826587677001953
mini_batch_src_global generation:  0.001176595687866211
r_  generation:  0.010648965835571289
----------------------check_connections_block total spend ----------------------------- 0.6453282833099365
generate_one_block  0.021648406982421875
generate_one_block  0.02196955680847168
generate_one_block  0.01920628547668457
generate_one_block  0.018698453903198242
generate_one_block  0.018886566162109375
generate_one_block  0.019341707229614258
generate_one_block  0.01887965202331543
generate_one_block  0.01801300048828125
generate_one_block  0.018143415451049805
generate_one_block  0.0189363956451416
generate_one_block  0.018619775772094727
generate_one_block  0.018272876739501953
generate_one_block  0.018107891082763672
generate_one_block  0.018828153610229492
generate_one_block  0.017952442169189453
generate_one_block  0.018200397491455078
generate_one_block  0.018413782119750977
generate_one_block  0.01876068115234375
generate_one_block  0.01864314079284668
generate_one_block  0.01798105239868164
generate_one_block  0.01818561553955078
generate_one_block  0.018086910247802734
generate_one_block  0.0225222110748291
generate_one_block  0.019091367721557617
generate_one_block  0.018358230590820312
generate_one_block  0.01755070686340332
generate_one_block  0.018184423446655273
generate_one_block  0.017876625061035156
generate_one_block  0.01817798614501953
generate_one_block  0.017795085906982422
generate_one_block  0.01850581169128418
generate_one_block  0.018449068069458008
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.039676666259765625
gen group dst list time:  0.026021480560302734
time for parepare:  0.02218008041381836
local_output_nid generation:  0.0065898895263671875
local_in_edges_tensor generation:  0.017351150512695312
mini_batch_src_global generation:  0.020632028579711914
r_  generation:  0.17756938934326172
local_output_nid generation:  0.009380102157592773
local_in_edges_tensor generation:  0.012022733688354492
mini_batch_src_global generation:  0.02411627769470215
r_  generation:  0.17274022102355957
local_output_nid generation:  0.00953817367553711
local_in_edges_tensor generation:  0.035859107971191406
mini_batch_src_global generation:  0.03466367721557617
r_  generation:  0.18047571182250977
local_output_nid generation:  0.00963592529296875
local_in_edges_tensor generation:  0.012235641479492188
mini_batch_src_global generation:  0.023941993713378906
r_  generation:  0.17873311042785645
local_output_nid generation:  0.009611368179321289
local_in_edges_tensor generation:  0.010141134262084961
mini_batch_src_global generation:  0.024431467056274414
r_  generation:  0.18211889266967773
local_output_nid generation:  0.009368181228637695
local_in_edges_tensor generation:  0.011791229248046875
mini_batch_src_global generation:  0.026213645935058594
r_  generation:  0.18842053413391113
local_output_nid generation:  0.009195566177368164
local_in_edges_tensor generation:  0.010549306869506836
mini_batch_src_global generation:  0.025952816009521484
r_  generation:  0.18587112426757812
local_output_nid generation:  0.008926868438720703
local_in_edges_tensor generation:  0.009080886840820312
mini_batch_src_global generation:  0.03599047660827637
r_  generation:  0.1941831111907959
local_output_nid generation:  0.012053728103637695
local_in_edges_tensor generation:  0.012296199798583984
mini_batch_src_global generation:  0.030267000198364258
r_  generation:  0.1803760528564453
local_output_nid generation:  0.009922027587890625
local_in_edges_tensor generation:  0.00901341438293457
mini_batch_src_global generation:  0.022967815399169922
r_  generation:  0.18744564056396484
local_output_nid generation:  0.009717226028442383
local_in_edges_tensor generation:  0.009215354919433594
mini_batch_src_global generation:  0.02303457260131836
r_  generation:  0.19247674942016602
local_output_nid generation:  0.009534358978271484
local_in_edges_tensor generation:  0.009515047073364258
mini_batch_src_global generation:  0.02689647674560547
r_  generation:  0.1759629249572754
local_output_nid generation:  0.009495973587036133
local_in_edges_tensor generation:  0.014368057250976562
mini_batch_src_global generation:  0.022326946258544922
r_  generation:  0.18036174774169922
local_output_nid generation:  0.009676933288574219
local_in_edges_tensor generation:  0.009916543960571289
mini_batch_src_global generation:  0.023381471633911133
r_  generation:  0.19090723991394043
local_output_nid generation:  0.009266853332519531
local_in_edges_tensor generation:  0.008823156356811523
mini_batch_src_global generation:  0.022808313369750977
r_  generation:  0.1814875602722168
local_output_nid generation:  0.009405136108398438
local_in_edges_tensor generation:  0.013096809387207031
mini_batch_src_global generation:  0.023894309997558594
r_  generation:  0.19083023071289062
local_output_nid generation:  0.009573936462402344
local_in_edges_tensor generation:  0.009375572204589844
mini_batch_src_global generation:  0.024034976959228516
r_  generation:  0.19653987884521484
local_output_nid generation:  0.009742498397827148
local_in_edges_tensor generation:  0.01564645767211914
mini_batch_src_global generation:  0.024631738662719727
r_  generation:  0.20518970489501953
local_output_nid generation:  0.009786844253540039
local_in_edges_tensor generation:  0.011896133422851562
mini_batch_src_global generation:  0.023801565170288086
r_  generation:  0.19154596328735352
local_output_nid generation:  0.010470867156982422
local_in_edges_tensor generation:  0.01079869270324707
mini_batch_src_global generation:  0.02359771728515625
r_  generation:  0.18459153175354004
local_output_nid generation:  0.013859033584594727
local_in_edges_tensor generation:  0.009224414825439453
mini_batch_src_global generation:  0.028575420379638672
r_  generation:  0.18631863594055176
local_output_nid generation:  0.009714365005493164
local_in_edges_tensor generation:  0.010261058807373047
mini_batch_src_global generation:  0.022605180740356445
r_  generation:  0.18334722518920898
local_output_nid generation:  0.010105371475219727
local_in_edges_tensor generation:  0.009154081344604492
mini_batch_src_global generation:  0.023859024047851562
r_  generation:  0.18937206268310547
local_output_nid generation:  0.009770393371582031
local_in_edges_tensor generation:  0.009306192398071289
mini_batch_src_global generation:  0.022890806198120117
r_  generation:  0.18295788764953613
local_output_nid generation:  0.009877920150756836
local_in_edges_tensor generation:  0.00944066047668457
mini_batch_src_global generation:  0.023345232009887695
r_  generation:  0.18399405479431152
local_output_nid generation:  0.009490728378295898
local_in_edges_tensor generation:  0.008920907974243164
mini_batch_src_global generation:  0.022048234939575195
r_  generation:  0.17570900917053223
local_output_nid generation:  0.009682893753051758
local_in_edges_tensor generation:  0.009074926376342773
mini_batch_src_global generation:  0.022249460220336914
r_  generation:  0.17885661125183105
local_output_nid generation:  0.009548187255859375
local_in_edges_tensor generation:  0.008956193923950195
mini_batch_src_global generation:  0.022550582885742188
r_  generation:  0.17868614196777344
local_output_nid generation:  0.009624242782592773
local_in_edges_tensor generation:  0.009805440902709961
mini_batch_src_global generation:  0.02380847930908203
r_  generation:  0.1805419921875
local_output_nid generation:  0.009402036666870117
local_in_edges_tensor generation:  0.009132862091064453
mini_batch_src_global generation:  0.022462844848632812
r_  generation:  0.1786806583404541
local_output_nid generation:  0.00981450080871582
local_in_edges_tensor generation:  0.00948190689086914
mini_batch_src_global generation:  0.024651527404785156
r_  generation:  0.18812894821166992
local_output_nid generation:  0.009849071502685547
local_in_edges_tensor generation:  0.009839773178100586
mini_batch_src_global generation:  0.022936344146728516
r_  generation:  0.18551158905029297
----------------------check_connections_block total spend ----------------------------- 8.718393564224243
generate_one_block  0.2662835121154785
generate_one_block  0.2380216121673584
generate_one_block  0.2451164722442627
generate_one_block  0.24855518341064453
generate_one_block  0.26456451416015625
generate_one_block  0.25670647621154785
generate_one_block  0.24983811378479004
generate_one_block  0.23903632164001465
generate_one_block  0.243927001953125
generate_one_block  0.26866984367370605
generate_one_block  0.25853681564331055
generate_one_block  0.2389528751373291
generate_one_block  0.24553203582763672
generate_one_block  0.2582705020904541
generate_one_block  0.24159598350524902
generate_one_block  0.2528719902038574
generate_one_block  0.25369858741760254
generate_one_block  0.25559210777282715
generate_one_block  0.2588076591491699
generate_one_block  0.25484800338745117
generate_one_block  0.24606823921203613
generate_one_block  0.24567842483520508
generate_one_block  0.25771641731262207
generate_one_block  0.2466599941253662
generate_one_block  0.25110626220703125
generate_one_block  0.2360091209411621
generate_one_block  0.24535775184631348
generate_one_block  0.24347734451293945
generate_one_block  0.2446601390838623
generate_one_block  0.24078679084777832
generate_one_block  0.2552776336669922
generate_one_block  0.2467641830444336
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04095339775085449
gen group dst list time:  0.13719511032104492
time for parepare:  0.01927781105041504
local_output_nid generation:  0.027344226837158203
local_in_edges_tensor generation:  0.04862093925476074
mini_batch_src_global generation:  0.03932785987854004
r_  generation:  0.4262111186981201
local_output_nid generation:  0.03468632698059082
local_in_edges_tensor generation:  0.03454113006591797
mini_batch_src_global generation:  0.05012106895446777
r_  generation:  0.4333376884460449
local_output_nid generation:  0.03483104705810547
local_in_edges_tensor generation:  0.0363619327545166
mini_batch_src_global generation:  0.05090641975402832
r_  generation:  0.44338130950927734
local_output_nid generation:  0.03463554382324219
local_in_edges_tensor generation:  0.03176259994506836
mini_batch_src_global generation:  0.05161404609680176
r_  generation:  0.44322967529296875
local_output_nid generation:  0.03280305862426758
local_in_edges_tensor generation:  0.02921772003173828
mini_batch_src_global generation:  0.05315446853637695
r_  generation:  0.4357731342315674
local_output_nid generation:  0.033086538314819336
local_in_edges_tensor generation:  0.031781673431396484
mini_batch_src_global generation:  0.053078651428222656
r_  generation:  0.43637752532958984
local_output_nid generation:  0.0317535400390625
local_in_edges_tensor generation:  0.02906060218811035
mini_batch_src_global generation:  0.04957985877990723
r_  generation:  0.4413144588470459
local_output_nid generation:  0.03064560890197754
local_in_edges_tensor generation:  0.03398633003234863
mini_batch_src_global generation:  0.05949807167053223
r_  generation:  0.4367084503173828
local_output_nid generation:  0.03230881690979004
local_in_edges_tensor generation:  0.027957439422607422
mini_batch_src_global generation:  0.050347328186035156
r_  generation:  0.4372425079345703
local_output_nid generation:  0.030708789825439453
local_in_edges_tensor generation:  0.02869439125061035
mini_batch_src_global generation:  0.05344748497009277
r_  generation:  0.4410552978515625
local_output_nid generation:  0.030761003494262695
local_in_edges_tensor generation:  0.031083106994628906
mini_batch_src_global generation:  0.05029797554016113
r_  generation:  0.44069552421569824
local_output_nid generation:  0.03029489517211914
local_in_edges_tensor generation:  0.027902603149414062
mini_batch_src_global generation:  0.062013864517211914
r_  generation:  0.4424910545349121
local_output_nid generation:  0.030413389205932617
local_in_edges_tensor generation:  0.032442331314086914
mini_batch_src_global generation:  0.05187582969665527
r_  generation:  0.44059109687805176
local_output_nid generation:  0.030758142471313477
local_in_edges_tensor generation:  0.030641555786132812
mini_batch_src_global generation:  0.053180694580078125
r_  generation:  0.43868041038513184
local_output_nid generation:  0.030079126358032227
local_in_edges_tensor generation:  0.02770686149597168
mini_batch_src_global generation:  0.04985237121582031
r_  generation:  0.43533825874328613
local_output_nid generation:  0.030580520629882812
local_in_edges_tensor generation:  0.029671907424926758
mini_batch_src_global generation:  0.051167964935302734
r_  generation:  0.44805192947387695
local_output_nid generation:  0.03162980079650879
local_in_edges_tensor generation:  0.03088212013244629
mini_batch_src_global generation:  0.05281519889831543
r_  generation:  0.4534931182861328
local_output_nid generation:  0.030426979064941406
local_in_edges_tensor generation:  0.03110051155090332
mini_batch_src_global generation:  0.05154252052307129
r_  generation:  0.44387388229370117
local_output_nid generation:  0.032328128814697266
local_in_edges_tensor generation:  0.03129863739013672
mini_batch_src_global generation:  0.0495295524597168
r_  generation:  0.4485762119293213
local_output_nid generation:  0.030255556106567383
local_in_edges_tensor generation:  0.033570051193237305
mini_batch_src_global generation:  0.04971957206726074
r_  generation:  0.44852209091186523
local_output_nid generation:  0.0307464599609375
local_in_edges_tensor generation:  0.028786897659301758
mini_batch_src_global generation:  0.050127506256103516
r_  generation:  0.4472973346710205
local_output_nid generation:  0.03134322166442871
local_in_edges_tensor generation:  0.027400732040405273
mini_batch_src_global generation:  0.0506587028503418
r_  generation:  0.43861842155456543
local_output_nid generation:  0.030633211135864258
local_in_edges_tensor generation:  0.029465436935424805
mini_batch_src_global generation:  0.05161905288696289
r_  generation:  0.4412236213684082
local_output_nid generation:  0.030575037002563477
local_in_edges_tensor generation:  0.03015613555908203
mini_batch_src_global generation:  0.050116777420043945
r_  generation:  0.4392516613006592
local_output_nid generation:  0.03061223030090332
local_in_edges_tensor generation:  0.028800487518310547
mini_batch_src_global generation:  0.05295300483703613
r_  generation:  0.44159793853759766
local_output_nid generation:  0.030089616775512695
local_in_edges_tensor generation:  0.029306650161743164
mini_batch_src_global generation:  0.05049848556518555
r_  generation:  0.43633556365966797
local_output_nid generation:  0.030205488204956055
local_in_edges_tensor generation:  0.02696967124938965
mini_batch_src_global generation:  0.04884600639343262
r_  generation:  0.45102500915527344
local_output_nid generation:  0.03049778938293457
local_in_edges_tensor generation:  0.028020858764648438
mini_batch_src_global generation:  0.0522003173828125
r_  generation:  0.4388277530670166
local_output_nid generation:  0.032355308532714844
local_in_edges_tensor generation:  0.02788090705871582
mini_batch_src_global generation:  0.049349308013916016
r_  generation:  0.4407048225402832
local_output_nid generation:  0.030452728271484375
local_in_edges_tensor generation:  0.029615402221679688
mini_batch_src_global generation:  0.050569772720336914
r_  generation:  0.43729376792907715
local_output_nid generation:  0.030606985092163086
local_in_edges_tensor generation:  0.02975773811340332
mini_batch_src_global generation:  0.0500333309173584
r_  generation:  0.4466288089752197
local_output_nid generation:  0.030622243881225586
local_in_edges_tensor generation:  0.03280043601989746
mini_batch_src_global generation:  0.05291175842285156
r_  generation:  0.44275450706481934
----------------------check_connections_block total spend ----------------------------- 20.898848056793213
generate_one_block  0.606529712677002
generate_one_block  0.5887115001678467
generate_one_block  0.5859360694885254
generate_one_block  0.5942862033843994
generate_one_block  0.69498610496521
generate_one_block  0.5856602191925049
generate_one_block  0.5873925685882568
generate_one_block  0.5915634632110596
generate_one_block  0.5828714370727539
generate_one_block  0.5846664905548096
generate_one_block  0.5858273506164551
generate_one_block  0.5809717178344727
generate_one_block  0.580406904220581
generate_one_block  0.5949382781982422
generate_one_block  0.5750253200531006
generate_one_block  0.5757675170898438
generate_one_block  0.5912771224975586
generate_one_block  0.5845613479614258
generate_one_block  0.5900061130523682
generate_one_block  0.5859403610229492
generate_one_block  0.5737473964691162
generate_one_block  0.5816671848297119
generate_one_block  0.590198278427124
generate_one_block  0.5886580944061279
generate_one_block  0.5996770858764648
generate_one_block  0.5767521858215332
generate_one_block  0.5767443180084229
generate_one_block  0.5876505374908447
generate_one_block  0.5898725986480713
generate_one_block  0.5865519046783447
generate_one_block  0.5943236351013184
generate_one_block  0.5908453464508057
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.1267075538635254  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

connection checking time:  29.617241621017456
block generation total time  26.883002281188965
average batch blocks generation time:  0.8400938212871552
block dataloader generation time/epoch 59.502831186567036
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10660839080810547  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 19.168745040893555  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.1065974235534668  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.674039840698242  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10669422149658203  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.991910934448242  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.1068735122680664  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 19.080524444580078  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10669708251953125  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 19.013237476348877  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10697603225708008  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 19.463232040405273  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10691547393798828  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 19.218684196472168  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10623407363891602  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.58753490447998  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10637855529785156  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.69828176498413  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10672664642333984  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 19.09030294418335  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10686254501342773  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 19.090770721435547  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.1062021255493164  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.40345048904419  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10682964324951172  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.776521682739258  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10674333572387695  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 19.170361518859863  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10620927810668945  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.446296215057373  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10643815994262695  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.981428146362305  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10681962966918945  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 19.0970721244812  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10694169998168945  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 19.165746212005615  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10680294036865234  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 19.13363265991211  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10614871978759766  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.66953945159912  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10631132125854492  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.720107555389404  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10654067993164062  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.749910354614258  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10680961608886719  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 19.17805290222168  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10648584365844727  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.864129543304443  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10646486282348633  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 19.05690908432007  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10622310638427734  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.402113437652588  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10626554489135742  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.580135822296143  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10659360885620117  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.70948839187622  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10659646987915039  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.771004676818848  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10633277893066406  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.61799383163452  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10663986206054688  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 19.18601942062378  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.1068415641784668  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 19.04692792892456  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.030532926321029663 |0.02127668261528015 |0.555018462240696 |9.50545072555542e-05 |1.0665736719965935 |0.010031461715698242 |
----------------------------------------------------------pseudo_mini_loss sum 1.4739452600479126
Total (block generation + training)time/epoch 113.17541878564018
Training time/epoch 53.61408233642578
Training time without block to device /epoch 52.933228492736816
Training time without total dataloading part /epoch 51.90402150154114
load block tensor time/epoch 0.9770536422729492
block to device time/epoch 0.6808538436889648
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 16 |
Number of nodes for computation during this epoch:  9112811
Number of first layer input nodes during this epoch:  4761137
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.1268939971923828  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02476668357849121
random selection method range initialization spend 0.007277727127075195
time for parepare:  0.021352767944335938
local_output_nid generation:  0.001413106918334961
local_in_edges_tensor generation:  0.007109642028808594
mini_batch_src_global generation:  0.0019278526306152344
r_  generation:  0.011185884475708008
local_output_nid generation:  0.0016891956329345703
local_in_edges_tensor generation:  0.0010476112365722656
mini_batch_src_global generation:  0.0016400814056396484
r_  generation:  0.010370731353759766
local_output_nid generation:  0.0016360282897949219
local_in_edges_tensor generation:  0.0009772777557373047
mini_batch_src_global generation:  0.0011737346649169922
r_  generation:  0.009750604629516602
local_output_nid generation:  0.0016224384307861328
local_in_edges_tensor generation:  0.0009753704071044922
mini_batch_src_global generation:  0.0011911392211914062
r_  generation:  0.010033130645751953
local_output_nid generation:  0.001589059829711914
local_in_edges_tensor generation:  0.0009338855743408203
mini_batch_src_global generation:  0.0011286735534667969
r_  generation:  0.009850263595581055
local_output_nid generation:  0.0016360282897949219
local_in_edges_tensor generation:  0.00093841552734375
mini_batch_src_global generation:  0.0012013912200927734
r_  generation:  0.009983062744140625
local_output_nid generation:  0.001592874526977539
local_in_edges_tensor generation:  0.0009307861328125
mini_batch_src_global generation:  0.0011484622955322266
r_  generation:  0.010195016860961914
local_output_nid generation:  0.0015797615051269531
local_in_edges_tensor generation:  0.0009071826934814453
mini_batch_src_global generation:  0.0011284351348876953
r_  generation:  0.010094642639160156
local_output_nid generation:  0.001617431640625
local_in_edges_tensor generation:  0.0009353160858154297
mini_batch_src_global generation:  0.001214742660522461
r_  generation:  0.01054072380065918
local_output_nid generation:  0.0015919208526611328
local_in_edges_tensor generation:  0.0009417533874511719
mini_batch_src_global generation:  0.001180410385131836
r_  generation:  0.010430574417114258
local_output_nid generation:  0.0016016960144042969
local_in_edges_tensor generation:  0.0009250640869140625
mini_batch_src_global generation:  0.0012145042419433594
r_  generation:  0.010747909545898438
local_output_nid generation:  0.0016279220581054688
local_in_edges_tensor generation:  0.0009238719940185547
mini_batch_src_global generation:  0.001195669174194336
r_  generation:  0.010708332061767578
local_output_nid generation:  0.0016002655029296875
local_in_edges_tensor generation:  0.0009398460388183594
mini_batch_src_global generation:  0.001230001449584961
r_  generation:  0.010301351547241211
local_output_nid generation:  0.0015864372253417969
local_in_edges_tensor generation:  0.0009317398071289062
mini_batch_src_global generation:  0.0011820793151855469
r_  generation:  0.010539054870605469
local_output_nid generation:  0.0016217231750488281
local_in_edges_tensor generation:  0.0009083747863769531
mini_batch_src_global generation:  0.001155853271484375
r_  generation:  0.010445117950439453
local_output_nid generation:  0.0016102790832519531
local_in_edges_tensor generation:  0.0009160041809082031
mini_batch_src_global generation:  0.0011687278747558594
r_  generation:  0.010454416275024414
local_output_nid generation:  0.0015971660614013672
local_in_edges_tensor generation:  0.0009162425994873047
mini_batch_src_global generation:  0.001234292984008789
r_  generation:  0.010338544845581055
local_output_nid generation:  0.001596689224243164
local_in_edges_tensor generation:  0.0009036064147949219
mini_batch_src_global generation:  0.0011663436889648438
r_  generation:  0.009931087493896484
local_output_nid generation:  0.001603841781616211
local_in_edges_tensor generation:  0.0009417533874511719
mini_batch_src_global generation:  0.0011620521545410156
r_  generation:  0.010196208953857422
local_output_nid generation:  0.0015931129455566406
local_in_edges_tensor generation:  0.0009157657623291016
mini_batch_src_global generation:  0.0012650489807128906
r_  generation:  0.01084280014038086
local_output_nid generation:  0.001580953598022461
local_in_edges_tensor generation:  0.0009357929229736328
mini_batch_src_global generation:  0.001218557357788086
r_  generation:  0.010868072509765625
local_output_nid generation:  0.00164794921875
local_in_edges_tensor generation:  0.0009019374847412109
mini_batch_src_global generation:  0.0011525154113769531
r_  generation:  0.010103702545166016
local_output_nid generation:  0.0015964508056640625
local_in_edges_tensor generation:  0.0009067058563232422
mini_batch_src_global generation:  0.0011365413665771484
r_  generation:  0.010045289993286133
local_output_nid generation:  0.0015995502471923828
local_in_edges_tensor generation:  0.0008902549743652344
mini_batch_src_global generation:  0.001173257827758789
r_  generation:  0.01028299331665039
local_output_nid generation:  0.0016276836395263672
local_in_edges_tensor generation:  0.0009059906005859375
mini_batch_src_global generation:  0.0012171268463134766
r_  generation:  0.010216236114501953
local_output_nid generation:  0.0015909671783447266
local_in_edges_tensor generation:  0.0009233951568603516
mini_batch_src_global generation:  0.0011875629425048828
r_  generation:  0.010510444641113281
local_output_nid generation:  0.0015785694122314453
local_in_edges_tensor generation:  0.0009057521820068359
mini_batch_src_global generation:  0.0011942386627197266
r_  generation:  0.010493755340576172
local_output_nid generation:  0.0016326904296875
local_in_edges_tensor generation:  0.000919342041015625
mini_batch_src_global generation:  0.001233816146850586
r_  generation:  0.011006832122802734
local_output_nid generation:  0.0015826225280761719
local_in_edges_tensor generation:  0.0008916854858398438
mini_batch_src_global generation:  0.0012149810791015625
r_  generation:  0.010566473007202148
local_output_nid generation:  0.0015921592712402344
local_in_edges_tensor generation:  0.0008928775787353516
mini_batch_src_global generation:  0.0011169910430908203
r_  generation:  0.010099172592163086
local_output_nid generation:  0.0016126632690429688
local_in_edges_tensor generation:  0.0008890628814697266
mini_batch_src_global generation:  0.0011403560638427734
r_  generation:  0.01025080680847168
local_output_nid generation:  0.0015878677368164062
local_in_edges_tensor generation:  0.0008902549743652344
mini_batch_src_global generation:  0.0011637210845947266
r_  generation:  0.01018381118774414
----------------------check_connections_block total spend ----------------------------- 0.575955867767334
generate_one_block  0.025125741958618164
generate_one_block  0.021288633346557617
generate_one_block  0.01880812644958496
generate_one_block  0.018661022186279297
generate_one_block  0.017957687377929688
generate_one_block  0.018159151077270508
generate_one_block  0.018146038055419922
generate_one_block  0.01804661750793457
generate_one_block  0.01890873908996582
generate_one_block  0.018491268157958984
generate_one_block  0.01903986930847168
generate_one_block  0.018988370895385742
generate_one_block  0.01809978485107422
generate_one_block  0.018384218215942383
generate_one_block  0.01822042465209961
generate_one_block  0.018303632736206055
generate_one_block  0.018260478973388672
generate_one_block  0.017458200454711914
generate_one_block  0.017945051193237305
generate_one_block  0.018968582153320312
generate_one_block  0.018872976303100586
generate_one_block  0.0177004337310791
generate_one_block  0.0210115909576416
generate_one_block  0.018749237060546875
generate_one_block  0.01797628402709961
generate_one_block  0.01853013038635254
generate_one_block  0.018473386764526367
generate_one_block  0.019214630126953125
generate_one_block  0.01846766471862793
generate_one_block  0.017732620239257812
generate_one_block  0.017798423767089844
generate_one_block  0.017885208129882812
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03788566589355469
gen group dst list time:  0.02333974838256836
time for parepare:  0.02357649803161621
local_output_nid generation:  0.006775856018066406
local_in_edges_tensor generation:  0.0192568302154541
mini_batch_src_global generation:  0.01874065399169922
r_  generation:  0.17163467407226562
local_output_nid generation:  0.009260416030883789
local_in_edges_tensor generation:  0.01228022575378418
mini_batch_src_global generation:  0.021910429000854492
r_  generation:  0.168701171875
local_output_nid generation:  0.009449243545532227
local_in_edges_tensor generation:  0.03520798683166504
mini_batch_src_global generation:  0.020075082778930664
r_  generation:  0.17046093940734863
local_output_nid generation:  0.009560585021972656
local_in_edges_tensor generation:  0.012244224548339844
mini_batch_src_global generation:  0.025826692581176758
r_  generation:  0.17816734313964844
local_output_nid generation:  0.009206056594848633
local_in_edges_tensor generation:  0.011687278747558594
mini_batch_src_global generation:  0.02177572250366211
r_  generation:  0.172163724899292
local_output_nid generation:  0.00907588005065918
local_in_edges_tensor generation:  0.009506940841674805
mini_batch_src_global generation:  0.02209162712097168
r_  generation:  0.17904090881347656
local_output_nid generation:  0.009068727493286133
local_in_edges_tensor generation:  0.00912022590637207
mini_batch_src_global generation:  0.022365093231201172
r_  generation:  0.17757582664489746
local_output_nid generation:  0.008981943130493164
local_in_edges_tensor generation:  0.008951663970947266
mini_batch_src_global generation:  0.02248835563659668
r_  generation:  0.17675280570983887
local_output_nid generation:  0.009474515914916992
local_in_edges_tensor generation:  0.009108781814575195
mini_batch_src_global generation:  0.023726940155029297
r_  generation:  0.18431711196899414
local_output_nid generation:  0.0097808837890625
local_in_edges_tensor generation:  0.009247541427612305
mini_batch_src_global generation:  0.02320241928100586
r_  generation:  0.1809864044189453
local_output_nid generation:  0.009931087493896484
local_in_edges_tensor generation:  0.011727094650268555
mini_batch_src_global generation:  0.02524590492248535
r_  generation:  0.18962597846984863
local_output_nid generation:  0.009852409362792969
local_in_edges_tensor generation:  0.010808229446411133
mini_batch_src_global generation:  0.023470401763916016
r_  generation:  0.18514132499694824
local_output_nid generation:  0.009578704833984375
local_in_edges_tensor generation:  0.009441375732421875
mini_batch_src_global generation:  0.0227510929107666
r_  generation:  0.17793846130371094
local_output_nid generation:  0.009634256362915039
local_in_edges_tensor generation:  0.00947260856628418
mini_batch_src_global generation:  0.02322220802307129
r_  generation:  0.18329906463623047
local_output_nid generation:  0.009613752365112305
local_in_edges_tensor generation:  0.009303092956542969
mini_batch_src_global generation:  0.023005247116088867
r_  generation:  0.18468809127807617
local_output_nid generation:  0.00958871841430664
local_in_edges_tensor generation:  0.010768413543701172
mini_batch_src_global generation:  0.023463964462280273
r_  generation:  0.18519854545593262
local_output_nid generation:  0.009597301483154297
local_in_edges_tensor generation:  0.011526823043823242
mini_batch_src_global generation:  0.023429155349731445
r_  generation:  0.183668851852417
local_output_nid generation:  0.009283065795898438
local_in_edges_tensor generation:  0.01115560531616211
mini_batch_src_global generation:  0.021777629852294922
r_  generation:  0.17212510108947754
local_output_nid generation:  0.009509801864624023
local_in_edges_tensor generation:  0.009120941162109375
mini_batch_src_global generation:  0.022834062576293945
r_  generation:  0.18030190467834473
local_output_nid generation:  0.0099945068359375
local_in_edges_tensor generation:  0.010791301727294922
mini_batch_src_global generation:  0.02453017234802246
r_  generation:  0.18787384033203125
local_output_nid generation:  0.009774446487426758
local_in_edges_tensor generation:  0.010755538940429688
mini_batch_src_global generation:  0.024190664291381836
r_  generation:  0.1896662712097168
local_output_nid generation:  0.009390592575073242
local_in_edges_tensor generation:  0.00896906852722168
mini_batch_src_global generation:  0.022487163543701172
r_  generation:  0.17447900772094727
local_output_nid generation:  0.009485006332397461
local_in_edges_tensor generation:  0.009258270263671875
mini_batch_src_global generation:  0.024792909622192383
r_  generation:  0.17730212211608887
local_output_nid generation:  0.009418487548828125
local_in_edges_tensor generation:  0.009012699127197266
mini_batch_src_global generation:  0.02278590202331543
r_  generation:  0.1806929111480713
local_output_nid generation:  0.009539127349853516
local_in_edges_tensor generation:  0.009076356887817383
mini_batch_src_global generation:  0.022254467010498047
r_  generation:  0.17829084396362305
local_output_nid generation:  0.009634971618652344
local_in_edges_tensor generation:  0.009879827499389648
mini_batch_src_global generation:  0.023044347763061523
r_  generation:  0.18216395378112793
local_output_nid generation:  0.009510517120361328
local_in_edges_tensor generation:  0.009821891784667969
mini_batch_src_global generation:  0.022945165634155273
r_  generation:  0.18319201469421387
local_output_nid generation:  0.00989079475402832
local_in_edges_tensor generation:  0.010240793228149414
mini_batch_src_global generation:  0.023665428161621094
r_  generation:  0.18995451927185059
local_output_nid generation:  0.00975799560546875
local_in_edges_tensor generation:  0.010049581527709961
mini_batch_src_global generation:  0.02552008628845215
r_  generation:  0.18566274642944336
local_output_nid generation:  0.009413480758666992
local_in_edges_tensor generation:  0.011832475662231445
mini_batch_src_global generation:  0.022498130798339844
r_  generation:  0.17819881439208984
local_output_nid generation:  0.009467363357543945
local_in_edges_tensor generation:  0.00894021987915039
mini_batch_src_global generation:  0.0222475528717041
r_  generation:  0.1799159049987793
local_output_nid generation:  0.009554147720336914
local_in_edges_tensor generation:  0.009454727172851562
mini_batch_src_global generation:  0.02354574203491211
r_  generation:  0.18243813514709473
----------------------check_connections_block total spend ----------------------------- 8.492492198944092
generate_one_block  0.25609540939331055
generate_one_block  0.24014735221862793
generate_one_block  0.24396061897277832
generate_one_block  0.2480483055114746
generate_one_block  0.25240302085876465
generate_one_block  0.24536347389221191
generate_one_block  0.24374794960021973
generate_one_block  0.2424309253692627
generate_one_block  0.2547943592071533
generate_one_block  0.24555587768554688
generate_one_block  0.258190393447876
generate_one_block  0.25137782096862793
generate_one_block  0.24088525772094727
generate_one_block  0.24681949615478516
generate_one_block  0.24889111518859863
generate_one_block  0.2511003017425537
generate_one_block  0.24591588973999023
generate_one_block  0.23064422607421875
generate_one_block  0.24293971061706543
generate_one_block  0.26105332374572754
generate_one_block  0.2573509216308594
generate_one_block  0.23514318466186523
generate_one_block  0.2393341064453125
generate_one_block  0.24490094184875488
generate_one_block  0.2419114112854004
generate_one_block  0.24785923957824707
generate_one_block  0.24851727485656738
generate_one_block  0.2596404552459717
generate_one_block  0.24899554252624512
generate_one_block  0.23700737953186035
generate_one_block  0.24035239219665527
generate_one_block  0.24455666542053223
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.034148454666137695
gen group dst list time:  0.10776519775390625
time for parepare:  0.018968820571899414
local_output_nid generation:  0.02587151527404785
local_in_edges_tensor generation:  0.04159188270568848
mini_batch_src_global generation:  0.04066729545593262
r_  generation:  0.4328758716583252
local_output_nid generation:  0.03206944465637207
local_in_edges_tensor generation:  0.03333473205566406
mini_batch_src_global generation:  0.0498044490814209
r_  generation:  0.42378878593444824
local_output_nid generation:  0.03214669227600098
local_in_edges_tensor generation:  0.03150177001953125
mini_batch_src_global generation:  0.04869890213012695
r_  generation:  0.4485282897949219
local_output_nid generation:  0.03200674057006836
local_in_edges_tensor generation:  0.02912163734436035
mini_batch_src_global generation:  0.054100751876831055
r_  generation:  0.43478846549987793
local_output_nid generation:  0.03152322769165039
local_in_edges_tensor generation:  0.029158830642700195
mini_batch_src_global generation:  0.05054211616516113
r_  generation:  0.434293270111084
local_output_nid generation:  0.03174710273742676
local_in_edges_tensor generation:  0.03026604652404785
mini_batch_src_global generation:  0.050768136978149414
r_  generation:  0.4398372173309326
local_output_nid generation:  0.030425310134887695
local_in_edges_tensor generation:  0.031595468521118164
mini_batch_src_global generation:  0.05009341239929199
r_  generation:  0.437305212020874
local_output_nid generation:  0.029677867889404297
local_in_edges_tensor generation:  0.029226303100585938
mini_batch_src_global generation:  0.05183553695678711
r_  generation:  0.4323768615722656
local_output_nid generation:  0.02989983558654785
local_in_edges_tensor generation:  0.027905941009521484
mini_batch_src_global generation:  0.05081439018249512
r_  generation:  0.4380912780761719
local_output_nid generation:  0.030109167098999023
local_in_edges_tensor generation:  0.03152203559875488
mini_batch_src_global generation:  0.05128788948059082
r_  generation:  0.4356832504272461
local_output_nid generation:  0.030770540237426758
local_in_edges_tensor generation:  0.03355836868286133
mini_batch_src_global generation:  0.05059385299682617
r_  generation:  0.4450678825378418
local_output_nid generation:  0.030723094940185547
local_in_edges_tensor generation:  0.02967238426208496
mini_batch_src_global generation:  0.05157160758972168
r_  generation:  0.4386451244354248
local_output_nid generation:  0.030193805694580078
local_in_edges_tensor generation:  0.03554987907409668
mini_batch_src_global generation:  0.04993748664855957
r_  generation:  0.43760228157043457
local_output_nid generation:  0.030251741409301758
local_in_edges_tensor generation:  0.029503583908081055
mini_batch_src_global generation:  0.05075430870056152
r_  generation:  0.4359605312347412
local_output_nid generation:  0.030020713806152344
local_in_edges_tensor generation:  0.029236793518066406
mini_batch_src_global generation:  0.05196189880371094
r_  generation:  0.4410123825073242
local_output_nid generation:  0.02991485595703125
local_in_edges_tensor generation:  0.028545856475830078
mini_batch_src_global generation:  0.05112743377685547
r_  generation:  0.4391446113586426
local_output_nid generation:  0.029812097549438477
local_in_edges_tensor generation:  0.027266979217529297
mini_batch_src_global generation:  0.050179481506347656
r_  generation:  0.4391610622406006
local_output_nid generation:  0.029691219329833984
local_in_edges_tensor generation:  0.029401302337646484
mini_batch_src_global generation:  0.05060315132141113
r_  generation:  0.43151187896728516
local_output_nid generation:  0.029894113540649414
local_in_edges_tensor generation:  0.030231475830078125
mini_batch_src_global generation:  0.05234193801879883
r_  generation:  0.4387521743774414
local_output_nid generation:  0.030535221099853516
local_in_edges_tensor generation:  0.032219886779785156
mini_batch_src_global generation:  0.05312228202819824
r_  generation:  0.4365825653076172
local_output_nid generation:  0.029878854751586914
local_in_edges_tensor generation:  0.027447938919067383
mini_batch_src_global generation:  0.050287485122680664
r_  generation:  0.4393582344055176
local_output_nid generation:  0.0297393798828125
local_in_edges_tensor generation:  0.029996871948242188
mini_batch_src_global generation:  0.05095243453979492
r_  generation:  0.4317128658294678
local_output_nid generation:  0.029918193817138672
local_in_edges_tensor generation:  0.027928829193115234
mini_batch_src_global generation:  0.05187869071960449
r_  generation:  0.43671751022338867
local_output_nid generation:  0.03301119804382324
local_in_edges_tensor generation:  0.029649972915649414
mini_batch_src_global generation:  0.05463886260986328
r_  generation:  0.4384322166442871
local_output_nid generation:  0.03021693229675293
local_in_edges_tensor generation:  0.02825617790222168
mini_batch_src_global generation:  0.05048561096191406
r_  generation:  0.4412996768951416
local_output_nid generation:  0.03003668785095215
local_in_edges_tensor generation:  0.027954578399658203
mini_batch_src_global generation:  0.05159449577331543
r_  generation:  0.45606565475463867
local_output_nid generation:  0.03217911720275879
local_in_edges_tensor generation:  0.028268098831176758
mini_batch_src_global generation:  0.05152726173400879
r_  generation:  0.44184231758117676
local_output_nid generation:  0.030873775482177734
local_in_edges_tensor generation:  0.029823780059814453
mini_batch_src_global generation:  0.05169105529785156
r_  generation:  0.4449021816253662
local_output_nid generation:  0.031661033630371094
local_in_edges_tensor generation:  0.03121328353881836
mini_batch_src_global generation:  0.051439523696899414
r_  generation:  0.4431498050689697
local_output_nid generation:  0.030660629272460938
local_in_edges_tensor generation:  0.028248310089111328
mini_batch_src_global generation:  0.05154228210449219
r_  generation:  0.4416015148162842
local_output_nid generation:  0.03075432777404785
local_in_edges_tensor generation:  0.02785205841064453
mini_batch_src_global generation:  0.05001664161682129
r_  generation:  0.44716382026672363
local_output_nid generation:  0.0306241512298584
local_in_edges_tensor generation:  0.029597759246826172
mini_batch_src_global generation:  0.051055192947387695
r_  generation:  0.43547964096069336
----------------------check_connections_block total spend ----------------------------- 20.733129739761353
generate_one_block  0.5844838619232178
generate_one_block  0.5870437622070312
generate_one_block  0.5813045501708984
generate_one_block  0.5773823261260986
generate_one_block  0.6781740188598633
generate_one_block  0.5837092399597168
generate_one_block  0.5869660377502441
generate_one_block  0.584181547164917
generate_one_block  0.5768938064575195
generate_one_block  0.5841360092163086
generate_one_block  0.586597204208374
generate_one_block  0.5813302993774414
generate_one_block  0.5771057605743408
generate_one_block  0.5768520832061768
generate_one_block  0.5813436508178711
generate_one_block  0.5774846076965332
generate_one_block  0.577303409576416
generate_one_block  0.5731298923492432
generate_one_block  0.5804438591003418
generate_one_block  0.5843870639801025
generate_one_block  0.5823826789855957
generate_one_block  0.575153112411499
generate_one_block  0.5791487693786621
generate_one_block  0.5805160999298096
generate_one_block  0.5950582027435303
generate_one_block  0.5793797969818115
generate_one_block  0.5799734592437744
generate_one_block  0.5850620269775391
generate_one_block  0.5875649452209473
generate_one_block  0.582200288772583
generate_one_block  0.5815041065216064
generate_one_block  0.5752379894256592
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.1268939971923828  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

connection checking time:  29.225621938705444
block generation total time  26.599368810653687
average batch blocks generation time:  0.8312302753329277
block dataloader generation time/epoch 59.45345711708069
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10692787170410156  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 19.370730876922607  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.1064004898071289  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.784815311431885  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10678434371948242  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.757829189300537  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10659456253051758  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.946845054626465  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10625219345092773  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.49902629852295  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10656404495239258  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.923165798187256  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10664939880371094  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.794148445129395  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10649824142456055  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.714913368225098  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10655832290649414  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 19.120583057403564  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.106781005859375  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.95390796661377  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.1082468032836914  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 19.503992080688477  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10684680938720703  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 19.204429626464844  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10656309127807617  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.710625648498535  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10658645629882812  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 19.01017427444458  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10671806335449219  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 19.058098316192627  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10641908645629883  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 19.058946132659912  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10664987564086914  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.940484523773193  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10629701614379883  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.22714328765869  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10675811767578125  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.85225009918213  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.1071462631225586  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 19.372061729431152  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10688209533691406  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 19.368232250213623  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10646486282348633  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.434763431549072  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10644817352294922  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.65415334701538  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10663461685180664  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.825758934020996  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10654067993164062  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.652138710021973  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10636138916015625  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.93747568130493  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10652017593383789  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.881246089935303  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10707283020019531  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 19.440124988555908  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10678815841674805  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 19.14020347595215  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10638570785522461  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.58231258392334  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10631227493286133  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.693010807037354  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10632705688476562  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.723158359527588  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03142604976892471 |0.019547298550605774 |0.5555305629968643 |9.571760892868042e-05 |1.0679127052426338 |0.005780458450317383 |
----------------------------------------------------------pseudo_mini_loss sum 1.4478929042816162
Total (block generation + training)time/epoch 113.1232397556305
Training time/epoch 53.6498920917511
Training time without block to device /epoch 53.024378538131714
Training time without total dataloading part /epoch 51.959028005599976
load block tensor time/epoch 1.0056335926055908
block to device time/epoch 0.6255135536193848
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 17 |
Number of nodes for computation during this epoch:  9116552
Number of first layer input nodes during this epoch:  4763668
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.12633275985717773  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02955770492553711
random selection method range initialization spend 0.0057713985443115234
time for parepare:  0.022958040237426758
local_output_nid generation:  0.002025127410888672
local_in_edges_tensor generation:  0.007973194122314453
mini_batch_src_global generation:  0.0024566650390625
r_  generation:  0.010927438735961914
local_output_nid generation:  0.0018618106842041016
local_in_edges_tensor generation:  0.0012946128845214844
mini_batch_src_global generation:  0.0021321773529052734
r_  generation:  0.010820627212524414
local_output_nid generation:  0.002037525177001953
local_in_edges_tensor generation:  0.0012428760528564453
mini_batch_src_global generation:  0.001538991928100586
r_  generation:  0.010352134704589844
local_output_nid generation:  0.002103090286254883
local_in_edges_tensor generation:  0.0012333393096923828
mini_batch_src_global generation:  0.0014586448669433594
r_  generation:  0.010382413864135742
local_output_nid generation:  0.002130746841430664
local_in_edges_tensor generation:  0.0012040138244628906
mini_batch_src_global generation:  0.001379251480102539
r_  generation:  0.010252714157104492
local_output_nid generation:  0.0021657943725585938
local_in_edges_tensor generation:  0.0011913776397705078
mini_batch_src_global generation:  0.0015060901641845703
r_  generation:  0.021780729293823242
local_output_nid generation:  0.002490520477294922
local_in_edges_tensor generation:  0.0012736320495605469
mini_batch_src_global generation:  0.0015742778778076172
r_  generation:  0.010647773742675781
local_output_nid generation:  0.002145051956176758
local_in_edges_tensor generation:  0.0011219978332519531
mini_batch_src_global generation:  0.0014281272888183594
r_  generation:  0.01001119613647461
local_output_nid generation:  0.001987457275390625
local_in_edges_tensor generation:  0.00098419189453125
mini_batch_src_global generation:  0.006827831268310547
r_  generation:  0.017542600631713867
local_output_nid generation:  0.0022668838500976562
local_in_edges_tensor generation:  0.0011162757873535156
mini_batch_src_global generation:  0.0013017654418945312
r_  generation:  0.010487556457519531
local_output_nid generation:  0.002268075942993164
local_in_edges_tensor generation:  0.0015964508056640625
mini_batch_src_global generation:  0.0035843849182128906
r_  generation:  0.018797636032104492
local_output_nid generation:  0.0022211074829101562
local_in_edges_tensor generation:  0.001119852066040039
mini_batch_src_global generation:  0.0014848709106445312
r_  generation:  0.010965108871459961
local_output_nid generation:  0.0020494461059570312
local_in_edges_tensor generation:  0.0010745525360107422
mini_batch_src_global generation:  0.0011432170867919922
r_  generation:  0.010255575180053711
local_output_nid generation:  0.0019490718841552734
local_in_edges_tensor generation:  0.001039266586303711
mini_batch_src_global generation:  0.0011415481567382812
r_  generation:  0.010211467742919922
local_output_nid generation:  0.0019030570983886719
local_in_edges_tensor generation:  0.0010101795196533203
mini_batch_src_global generation:  0.001191854476928711
r_  generation:  0.0104522705078125
local_output_nid generation:  0.0018837451934814453
local_in_edges_tensor generation:  0.0010046958923339844
mini_batch_src_global generation:  0.0011444091796875
r_  generation:  0.010248184204101562
local_output_nid generation:  0.0018804073333740234
local_in_edges_tensor generation:  0.0009725093841552734
mini_batch_src_global generation:  0.001191854476928711
r_  generation:  0.010177135467529297
local_output_nid generation:  0.0018470287322998047
local_in_edges_tensor generation:  0.0009698867797851562
mini_batch_src_global generation:  0.0011644363403320312
r_  generation:  0.009827613830566406
local_output_nid generation:  0.001836538314819336
local_in_edges_tensor generation:  0.0009796619415283203
mini_batch_src_global generation:  0.00119781494140625
r_  generation:  0.010475397109985352
local_output_nid generation:  0.001789093017578125
local_in_edges_tensor generation:  0.0009672641754150391
mini_batch_src_global generation:  0.0011692047119140625
r_  generation:  0.0102996826171875
local_output_nid generation:  0.0017926692962646484
local_in_edges_tensor generation:  0.0009717941284179688
mini_batch_src_global generation:  0.0011324882507324219
r_  generation:  0.009962320327758789
local_output_nid generation:  0.0017936229705810547
local_in_edges_tensor generation:  0.0009999275207519531
mini_batch_src_global generation:  0.0011229515075683594
r_  generation:  0.009971141815185547
local_output_nid generation:  0.0017619132995605469
local_in_edges_tensor generation:  0.0009381771087646484
mini_batch_src_global generation:  0.001104116439819336
r_  generation:  0.009877920150756836
local_output_nid generation:  0.0017480850219726562
local_in_edges_tensor generation:  0.0009496212005615234
mini_batch_src_global generation:  0.0011548995971679688
r_  generation:  0.010443449020385742
local_output_nid generation:  0.0017342567443847656
local_in_edges_tensor generation:  0.0009386539459228516
mini_batch_src_global generation:  0.0011532306671142578
r_  generation:  0.010189533233642578
local_output_nid generation:  0.0017421245574951172
local_in_edges_tensor generation:  0.0009474754333496094
mini_batch_src_global generation:  0.0011878013610839844
r_  generation:  0.010150909423828125
local_output_nid generation:  0.0017123222351074219
local_in_edges_tensor generation:  0.0009837150573730469
mini_batch_src_global generation:  0.0011379718780517578
r_  generation:  0.010386228561401367
local_output_nid generation:  0.001708984375
local_in_edges_tensor generation:  0.0009531974792480469
mini_batch_src_global generation:  0.001177072525024414
r_  generation:  0.010511159896850586
local_output_nid generation:  0.0017046928405761719
local_in_edges_tensor generation:  0.0009582042694091797
mini_batch_src_global generation:  0.0011970996856689453
r_  generation:  0.010303497314453125
local_output_nid generation:  0.0016851425170898438
local_in_edges_tensor generation:  0.0009427070617675781
mini_batch_src_global generation:  0.0010972023010253906
r_  generation:  0.009708642959594727
local_output_nid generation:  0.0016772747039794922
local_in_edges_tensor generation:  0.0009522438049316406
mini_batch_src_global generation:  0.0012035369873046875
r_  generation:  0.01043248176574707
local_output_nid generation:  0.0016522407531738281
local_in_edges_tensor generation:  0.0009436607360839844
mini_batch_src_global generation:  0.001220703125
r_  generation:  0.010816335678100586
----------------------check_connections_block total spend ----------------------------- 0.6436903476715088
generate_one_block  0.02419424057006836
generate_one_block  0.021662473678588867
generate_one_block  0.0189359188079834
generate_one_block  0.018798351287841797
generate_one_block  0.01821112632751465
generate_one_block  0.01845383644104004
generate_one_block  0.0181577205657959
generate_one_block  0.01800823211669922
generate_one_block  0.019617319107055664
generate_one_block  0.03107428550720215
generate_one_block  0.018713951110839844
generate_one_block  0.01843547821044922
generate_one_block  0.01796746253967285
generate_one_block  0.018010377883911133
generate_one_block  0.01836705207824707
generate_one_block  0.01792740821838379
generate_one_block  0.017975330352783203
generate_one_block  0.01721644401550293
generate_one_block  0.01845097541809082
generate_one_block  0.01800537109375
generate_one_block  0.017733335494995117
generate_one_block  0.01762533187866211
generate_one_block  0.021422624588012695
generate_one_block  0.019063472747802734
generate_one_block  0.01804351806640625
generate_one_block  0.017859220504760742
generate_one_block  0.01824951171875
generate_one_block  0.01826786994934082
generate_one_block  0.01807379722595215
generate_one_block  0.017195463180541992
generate_one_block  0.018234968185424805
generate_one_block  0.019037723541259766
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.039887428283691406
gen group dst list time:  0.023180723190307617
time for parepare:  0.021763324737548828
local_output_nid generation:  0.006257534027099609
local_in_edges_tensor generation:  0.018931150436401367
mini_batch_src_global generation:  0.017919301986694336
r_  generation:  0.1630091667175293
local_output_nid generation:  0.00897526741027832
local_in_edges_tensor generation:  0.012053728103637695
mini_batch_src_global generation:  0.021120786666870117
r_  generation:  0.1697697639465332
local_output_nid generation:  0.009122371673583984
local_in_edges_tensor generation:  0.03587651252746582
mini_batch_src_global generation:  0.020119428634643555
r_  generation:  0.1705491542816162
local_output_nid generation:  0.009777307510375977
local_in_edges_tensor generation:  0.010443925857543945
mini_batch_src_global generation:  0.023175716400146484
r_  generation:  0.17479681968688965
local_output_nid generation:  0.009572982788085938
local_in_edges_tensor generation:  0.008950233459472656
mini_batch_src_global generation:  0.021861553192138672
r_  generation:  0.20172119140625
local_output_nid generation:  0.015052318572998047
local_in_edges_tensor generation:  0.015223503112792969
mini_batch_src_global generation:  0.02802109718322754
r_  generation:  0.20193696022033691
local_output_nid generation:  0.014345407485961914
local_in_edges_tensor generation:  0.0136871337890625
mini_batch_src_global generation:  0.03513908386230469
r_  generation:  0.18165993690490723
local_output_nid generation:  0.013797760009765625
local_in_edges_tensor generation:  0.010555028915405273
mini_batch_src_global generation:  0.024868249893188477
r_  generation:  0.1820998191833496
local_output_nid generation:  0.01058506965637207
local_in_edges_tensor generation:  0.013251304626464844
mini_batch_src_global generation:  0.02482151985168457
r_  generation:  0.19363832473754883
local_output_nid generation:  0.009583234786987305
local_in_edges_tensor generation:  0.00929117202758789
mini_batch_src_global generation:  0.023190975189208984
r_  generation:  0.1858992576599121
local_output_nid generation:  0.010035037994384766
local_in_edges_tensor generation:  0.010821342468261719
mini_batch_src_global generation:  0.023360490798950195
r_  generation:  0.19036149978637695
local_output_nid generation:  0.009988546371459961
local_in_edges_tensor generation:  0.010784149169921875
mini_batch_src_global generation:  0.025580167770385742
r_  generation:  0.18770313262939453
local_output_nid generation:  0.0093231201171875
local_in_edges_tensor generation:  0.014788389205932617
mini_batch_src_global generation:  0.024895906448364258
r_  generation:  0.18073248863220215
local_output_nid generation:  0.009418725967407227
local_in_edges_tensor generation:  0.012065410614013672
mini_batch_src_global generation:  0.024043798446655273
r_  generation:  0.19043493270874023
local_output_nid generation:  0.00959920883178711
local_in_edges_tensor generation:  0.009902477264404297
mini_batch_src_global generation:  0.027832984924316406
r_  generation:  0.1919245719909668
local_output_nid generation:  0.009279012680053711
local_in_edges_tensor generation:  0.009563922882080078
mini_batch_src_global generation:  0.0241546630859375
r_  generation:  0.18360185623168945
local_output_nid generation:  0.010238170623779297
local_in_edges_tensor generation:  0.016514062881469727
mini_batch_src_global generation:  0.02364373207092285
r_  generation:  0.18508410453796387
local_output_nid generation:  0.009182214736938477
local_in_edges_tensor generation:  0.010579347610473633
mini_batch_src_global generation:  0.02240157127380371
r_  generation:  0.18213772773742676
local_output_nid generation:  0.012070178985595703
local_in_edges_tensor generation:  0.012896060943603516
mini_batch_src_global generation:  0.02351212501525879
r_  generation:  0.186110258102417
local_output_nid generation:  0.009468793869018555
local_in_edges_tensor generation:  0.01002812385559082
mini_batch_src_global generation:  0.023637771606445312
r_  generation:  0.18024230003356934
local_output_nid generation:  0.009517669677734375
local_in_edges_tensor generation:  0.008879661560058594
mini_batch_src_global generation:  0.02282404899597168
r_  generation:  0.17932915687561035
local_output_nid generation:  0.009441614151000977
local_in_edges_tensor generation:  0.009080648422241211
mini_batch_src_global generation:  0.022644519805908203
r_  generation:  0.17791461944580078
local_output_nid generation:  0.009393692016601562
local_in_edges_tensor generation:  0.008947372436523438
mini_batch_src_global generation:  0.02259230613708496
r_  generation:  0.17662787437438965
local_output_nid generation:  0.00963735580444336
local_in_edges_tensor generation:  0.009315252304077148
mini_batch_src_global generation:  0.023274898529052734
r_  generation:  0.1837444305419922
local_output_nid generation:  0.009575128555297852
local_in_edges_tensor generation:  0.011091232299804688
mini_batch_src_global generation:  0.022864103317260742
r_  generation:  0.18420672416687012
local_output_nid generation:  0.009457826614379883
local_in_edges_tensor generation:  0.009876728057861328
mini_batch_src_global generation:  0.0231783390045166
r_  generation:  0.18282842636108398
local_output_nid generation:  0.00952601432800293
local_in_edges_tensor generation:  0.010107040405273438
mini_batch_src_global generation:  0.02343606948852539
r_  generation:  0.1973428726196289
local_output_nid generation:  0.00950169563293457
local_in_edges_tensor generation:  0.009808778762817383
mini_batch_src_global generation:  0.023103952407836914
r_  generation:  0.183882474899292
local_output_nid generation:  0.009496927261352539
local_in_edges_tensor generation:  0.011586904525756836
mini_batch_src_global generation:  0.02422785758972168
r_  generation:  0.18692278861999512
local_output_nid generation:  0.009294748306274414
local_in_edges_tensor generation:  0.009652853012084961
mini_batch_src_global generation:  0.022336483001708984
r_  generation:  0.17606019973754883
local_output_nid generation:  0.009776592254638672
local_in_edges_tensor generation:  0.009218931198120117
mini_batch_src_global generation:  0.023089170455932617
r_  generation:  0.18894696235656738
local_output_nid generation:  0.011594772338867188
local_in_edges_tensor generation:  0.014299154281616211
mini_batch_src_global generation:  0.025278329849243164
r_  generation:  0.19928455352783203
----------------------check_connections_block total spend ----------------------------- 8.731591701507568
generate_one_block  0.2619354724884033
generate_one_block  0.24776959419250488
generate_one_block  0.2494213581085205
generate_one_block  0.2531602382659912
generate_one_block  0.266979455947876
generate_one_block  0.25107240676879883
generate_one_block  0.2470083236694336
generate_one_block  0.24635720252990723
generate_one_block  0.2615833282470703
generate_one_block  0.25066041946411133
generate_one_block  0.2586808204650879
generate_one_block  0.2518949508666992
generate_one_block  0.2386016845703125
generate_one_block  0.24475884437561035
generate_one_block  0.2505009174346924
generate_one_block  0.24586129188537598
generate_one_block  0.24122881889343262
generate_one_block  0.23379063606262207
generate_one_block  0.2536954879760742
generate_one_block  0.2532634735107422
generate_one_block  0.24203705787658691
generate_one_block  0.2449476718902588
generate_one_block  0.2475738525390625
generate_one_block  0.2561779022216797
generate_one_block  0.24016928672790527
generate_one_block  0.24578332901000977
generate_one_block  0.2533833980560303
generate_one_block  0.25466299057006836
generate_one_block  0.25388026237487793
generate_one_block  0.23363351821899414
generate_one_block  0.2574610710144043
generate_one_block  0.2666499614715576
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04517197608947754
gen group dst list time:  0.11358761787414551
time for parepare:  0.019503355026245117
local_output_nid generation:  0.02930426597595215
local_in_edges_tensor generation:  0.04558086395263672
mini_batch_src_global generation:  0.03974199295043945
r_  generation:  0.4298064708709717
local_output_nid generation:  0.035016775131225586
local_in_edges_tensor generation:  0.03351616859436035
mini_batch_src_global generation:  0.05043315887451172
r_  generation:  0.42992615699768066
local_output_nid generation:  0.03472757339477539
local_in_edges_tensor generation:  0.029368162155151367
mini_batch_src_global generation:  0.05052471160888672
r_  generation:  0.4404168128967285
local_output_nid generation:  0.034903764724731445
local_in_edges_tensor generation:  0.031000137329101562
mini_batch_src_global generation:  0.0499875545501709
r_  generation:  0.4375269412994385
local_output_nid generation:  0.03647923469543457
local_in_edges_tensor generation:  0.029599666595458984
mini_batch_src_global generation:  0.04925656318664551
r_  generation:  0.43979811668395996
local_output_nid generation:  0.03497958183288574
local_in_edges_tensor generation:  0.031189918518066406
mini_batch_src_global generation:  0.050885677337646484
r_  generation:  0.44036388397216797
local_output_nid generation:  0.03378033638000488
local_in_edges_tensor generation:  0.031466007232666016
mini_batch_src_global generation:  0.05021166801452637
r_  generation:  0.4397454261779785
local_output_nid generation:  0.03315258026123047
local_in_edges_tensor generation:  0.030978918075561523
mini_batch_src_global generation:  0.05293917655944824
r_  generation:  0.43503355979919434
local_output_nid generation:  0.03340625762939453
local_in_edges_tensor generation:  0.03106999397277832
mini_batch_src_global generation:  0.05313849449157715
r_  generation:  0.45285797119140625
local_output_nid generation:  0.03701353073120117
local_in_edges_tensor generation:  0.027074575424194336
mini_batch_src_global generation:  0.059676408767700195
r_  generation:  0.43487548828125
local_output_nid generation:  0.030634164810180664
local_in_edges_tensor generation:  0.02722001075744629
mini_batch_src_global generation:  0.04956984519958496
r_  generation:  0.43878602981567383
local_output_nid generation:  0.030667781829833984
local_in_edges_tensor generation:  0.03224015235900879
mini_batch_src_global generation:  0.050508737564086914
r_  generation:  0.4350757598876953
local_output_nid generation:  0.030325889587402344
local_in_edges_tensor generation:  0.027640104293823242
mini_batch_src_global generation:  0.049243927001953125
r_  generation:  0.43459486961364746
local_output_nid generation:  0.030348539352416992
local_in_edges_tensor generation:  0.02712106704711914
mini_batch_src_global generation:  0.051091670989990234
r_  generation:  0.4353458881378174
local_output_nid generation:  0.030826807022094727
local_in_edges_tensor generation:  0.030544042587280273
mini_batch_src_global generation:  0.0507969856262207
r_  generation:  0.44037866592407227
local_output_nid generation:  0.030544281005859375
local_in_edges_tensor generation:  0.027411460876464844
mini_batch_src_global generation:  0.050932884216308594
r_  generation:  0.43578577041625977
local_output_nid generation:  0.030666351318359375
local_in_edges_tensor generation:  0.02881145477294922
mini_batch_src_global generation:  0.05147075653076172
r_  generation:  0.4386177062988281
local_output_nid generation:  0.030255556106567383
local_in_edges_tensor generation:  0.030655384063720703
mini_batch_src_global generation:  0.05104684829711914
r_  generation:  0.4324040412902832
local_output_nid generation:  0.0309603214263916
local_in_edges_tensor generation:  0.026932477951049805
mini_batch_src_global generation:  0.04988837242126465
r_  generation:  0.4418644905090332
local_output_nid generation:  0.030556917190551758
local_in_edges_tensor generation:  0.02656078338623047
mini_batch_src_global generation:  0.0508120059967041
r_  generation:  0.435272216796875
local_output_nid generation:  0.03062272071838379
local_in_edges_tensor generation:  0.029254674911499023
mini_batch_src_global generation:  0.05151796340942383
r_  generation:  0.44898128509521484
local_output_nid generation:  0.03049325942993164
local_in_edges_tensor generation:  0.027414560317993164
mini_batch_src_global generation:  0.05064558982849121
r_  generation:  0.43474888801574707
local_output_nid generation:  0.030583620071411133
local_in_edges_tensor generation:  0.02892303466796875
mini_batch_src_global generation:  0.053884267807006836
r_  generation:  0.4365353584289551
local_output_nid generation:  0.03091716766357422
local_in_edges_tensor generation:  0.029447317123413086
mini_batch_src_global generation:  0.05072188377380371
r_  generation:  0.4408609867095947
local_output_nid generation:  0.031203508377075195
local_in_edges_tensor generation:  0.03246331214904785
mini_batch_src_global generation:  0.049479007720947266
r_  generation:  0.44828295707702637
local_output_nid generation:  0.030773162841796875
local_in_edges_tensor generation:  0.03838849067687988
mini_batch_src_global generation:  0.05033993721008301
r_  generation:  0.4399230480194092
local_output_nid generation:  0.030579328536987305
local_in_edges_tensor generation:  0.027227401733398438
mini_batch_src_global generation:  0.05000114440917969
r_  generation:  0.43946099281311035
local_output_nid generation:  0.030719280242919922
local_in_edges_tensor generation:  0.027040958404541016
mini_batch_src_global generation:  0.050650596618652344
r_  generation:  0.436126708984375
local_output_nid generation:  0.030637502670288086
local_in_edges_tensor generation:  0.02720475196838379
mini_batch_src_global generation:  0.049942970275878906
r_  generation:  0.44118833541870117
local_output_nid generation:  0.030676841735839844
local_in_edges_tensor generation:  0.027042627334594727
mini_batch_src_global generation:  0.05300259590148926
r_  generation:  0.4362456798553467
local_output_nid generation:  0.03091287612915039
local_in_edges_tensor generation:  0.03076004981994629
mini_batch_src_global generation:  0.0527949333190918
r_  generation:  0.4486734867095947
local_output_nid generation:  0.03183317184448242
local_in_edges_tensor generation:  0.029633283615112305
mini_batch_src_global generation:  0.0522000789642334
r_  generation:  0.45125865936279297
----------------------check_connections_block total spend ----------------------------- 20.79082179069519
generate_one_block  0.6065094470977783
generate_one_block  0.5836076736450195
generate_one_block  0.5864286422729492
generate_one_block  0.5859746932983398
generate_one_block  0.6818156242370605
generate_one_block  0.5916287899017334
generate_one_block  0.5858438014984131
generate_one_block  0.5889689922332764
generate_one_block  0.5874252319335938
generate_one_block  0.5810940265655518
generate_one_block  0.5876560211181641
generate_one_block  0.5872802734375
generate_one_block  0.571256160736084
generate_one_block  0.5860958099365234
generate_one_block  0.5906059741973877
generate_one_block  0.57720947265625
generate_one_block  0.5875098705291748
generate_one_block  0.5837123394012451
generate_one_block  0.5925579071044922
generate_one_block  0.5837616920471191
generate_one_block  0.5829200744628906
generate_one_block  0.5791323184967041
generate_one_block  0.5804822444915771
generate_one_block  0.5911345481872559
generate_one_block  0.6090044975280762
generate_one_block  0.5791263580322266
generate_one_block  0.5832068920135498
generate_one_block  0.574845552444458
generate_one_block  0.5872495174407959
generate_one_block  0.5824661254882812
generate_one_block  0.6112802028656006
generate_one_block  0.6081118583679199
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.12633275985717773  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

connection checking time:  29.52241349220276
block generation total time  26.900487661361694
average batch blocks generation time:  0.840640239417553
block dataloader generation time/epoch 59.49978870815701
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10690450668334961  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.96476984024048  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.1067805290222168  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.912492752075195  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10660505294799805  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.783225536346436  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.1067509651184082  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.986111640930176  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10644721984863281  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.9350528717041  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10693216323852539  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 19.171523094177246  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10683250427246094  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.888981342315674  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10667228698730469  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.83001136779785  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10719537734985352  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 19.5980224609375  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10620689392089844  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.923911094665527  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.1068878173828125  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 19.18012523651123  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.1066441535949707  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 19.12636089324951  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10632658004760742  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.502559185028076  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10650920867919922  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.861223220825195  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10807323455810547  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 19.2090106010437  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10624170303344727  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.819636821746826  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10674905776977539  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.80457353591919  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10619163513183594  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.32332420349121  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10688161849975586  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 19.16001605987549  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10620594024658203  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.802220344543457  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10658502578735352  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.749207019805908  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10639190673828125  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.63458251953125  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10644817352294922  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.57408905029297  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10683488845825195  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 19.122771739959717  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10679388046264648  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.84572744369507  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10649681091308594  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.791872024536133  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10666704177856445  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 19.0897536277771  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10640192031860352  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.830965995788574  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10662412643432617  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 19.084325313568115  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10629081726074219  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 18.331322193145752  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10698652267456055  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 19.290597915649414  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10727214813232422  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 19.60676097869873  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.035551272332668304 |0.020107515156269073 |0.5561704039573669 |9.479373693466187e-05 |1.068896159529686 |0.0055539608001708984 |
----------------------------------------------------------pseudo_mini_loss sum 1.4204052686691284
Total (block generation + training)time/epoch 113.1893691221873
Training time/epoch 53.847689390182495
Training time without block to device /epoch 53.204248905181885
Training time without total dataloading part /epoch 52.01071739196777
load block tensor time/epoch 1.1376407146453857
block to device time/epoch 0.6434404850006104
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 18 |
Number of nodes for computation during this epoch:  9120779
Number of first layer input nodes during this epoch:  4764376
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.1278824806213379  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024467945098876953
random selection method range initialization spend 0.00635075569152832
time for parepare:  0.020825862884521484
local_output_nid generation:  0.0013797283172607422
local_in_edges_tensor generation:  0.0069866180419921875
mini_batch_src_global generation:  0.0019164085388183594
r_  generation:  0.011278152465820312
local_output_nid generation:  0.0016467571258544922
local_in_edges_tensor generation:  0.0010788440704345703
mini_batch_src_global generation:  0.001664876937866211
r_  generation:  0.010529279708862305
local_output_nid generation:  0.0016503334045410156
local_in_edges_tensor generation:  0.0009937286376953125
mini_batch_src_global generation:  0.0011997222900390625
r_  generation:  0.010077238082885742
local_output_nid generation:  0.001611948013305664
local_in_edges_tensor generation:  0.0009598731994628906
mini_batch_src_global generation:  0.0011527538299560547
r_  generation:  0.009908437728881836
local_output_nid generation:  0.0016031265258789062
local_in_edges_tensor generation:  0.0009570121765136719
mini_batch_src_global generation:  0.0011248588562011719
r_  generation:  0.009916067123413086
local_output_nid generation:  0.0016021728515625
local_in_edges_tensor generation:  0.0009560585021972656
mini_batch_src_global generation:  0.001279592514038086
r_  generation:  0.010308265686035156
local_output_nid generation:  0.0015878677368164062
local_in_edges_tensor generation:  0.0009412765502929688
mini_batch_src_global generation:  0.0011370182037353516
r_  generation:  0.010087966918945312
local_output_nid generation:  0.0016160011291503906
local_in_edges_tensor generation:  0.0009253025054931641
mini_batch_src_global generation:  0.0011417865753173828
r_  generation:  0.010222196578979492
local_output_nid generation:  0.0015909671783447266
local_in_edges_tensor generation:  0.0009398460388183594
mini_batch_src_global generation:  0.0011067390441894531
r_  generation:  0.010271072387695312
local_output_nid generation:  0.0016012191772460938
local_in_edges_tensor generation:  0.0008690357208251953
mini_batch_src_global generation:  0.0010750293731689453
r_  generation:  0.011987924575805664
local_output_nid generation:  0.001672506332397461
local_in_edges_tensor generation:  0.0009615421295166016
mini_batch_src_global generation:  0.0012760162353515625
r_  generation:  0.010524272918701172
local_output_nid generation:  0.0016739368438720703
local_in_edges_tensor generation:  0.0009105205535888672
mini_batch_src_global generation:  0.0011813640594482422
r_  generation:  0.009929180145263672
local_output_nid generation:  0.0015769004821777344
local_in_edges_tensor generation:  0.0009021759033203125
mini_batch_src_global generation:  0.0012054443359375
r_  generation:  0.010364770889282227
local_output_nid generation:  0.0015964508056640625
local_in_edges_tensor generation:  0.0009200572967529297
mini_batch_src_global generation:  0.0011706352233886719
r_  generation:  0.010512351989746094
local_output_nid generation:  0.001638650894165039
local_in_edges_tensor generation:  0.0009377002716064453
mini_batch_src_global generation:  0.0011229515075683594
r_  generation:  0.010354042053222656
local_output_nid generation:  0.001592397689819336
local_in_edges_tensor generation:  0.0008881092071533203
mini_batch_src_global generation:  0.0012009143829345703
r_  generation:  0.010424613952636719
local_output_nid generation:  0.0015857219696044922
local_in_edges_tensor generation:  0.0009009838104248047
mini_batch_src_global generation:  0.0011415481567382812
r_  generation:  0.010283946990966797
local_output_nid generation:  0.0015785694122314453
local_in_edges_tensor generation:  0.0009088516235351562
mini_batch_src_global generation:  0.0011761188507080078
r_  generation:  0.010112524032592773
local_output_nid generation:  0.0015749931335449219
local_in_edges_tensor generation:  0.0009169578552246094
mini_batch_src_global generation:  0.0011105537414550781
r_  generation:  0.009736776351928711
local_output_nid generation:  0.0015711784362792969
local_in_edges_tensor generation:  0.0009329319000244141
mini_batch_src_global generation:  0.0011615753173828125
r_  generation:  0.010437488555908203
local_output_nid generation:  0.0015759468078613281
local_in_edges_tensor generation:  0.0009233951568603516
mini_batch_src_global generation:  0.0012044906616210938
r_  generation:  0.010746240615844727
local_output_nid generation:  0.0015866756439208984
local_in_edges_tensor generation:  0.0009098052978515625
mini_batch_src_global generation:  0.0012230873107910156
r_  generation:  0.010323286056518555
local_output_nid generation:  0.0015790462493896484
local_in_edges_tensor generation:  0.0009243488311767578
mini_batch_src_global generation:  0.0011873245239257812
r_  generation:  0.010208606719970703
local_output_nid generation:  0.0016014575958251953
local_in_edges_tensor generation:  0.0008938312530517578
mini_batch_src_global generation:  0.0010693073272705078
r_  generation:  0.009625673294067383
local_output_nid generation:  0.0015704631805419922
local_in_edges_tensor generation:  0.00090789794921875
mini_batch_src_global generation:  0.0011856555938720703
r_  generation:  0.01031804084777832
local_output_nid generation:  0.0015718936920166016
local_in_edges_tensor generation:  0.0009133815765380859
mini_batch_src_global generation:  0.0012187957763671875
r_  generation:  0.01038217544555664
local_output_nid generation:  0.0015797615051269531
local_in_edges_tensor generation:  0.0008938312530517578
mini_batch_src_global generation:  0.0011219978332519531
r_  generation:  0.010153770446777344
local_output_nid generation:  0.0015838146209716797
local_in_edges_tensor generation:  0.0009188652038574219
mini_batch_src_global generation:  0.0011610984802246094
r_  generation:  0.010628223419189453
local_output_nid generation:  0.0015940666198730469
local_in_edges_tensor generation:  0.0009148120880126953
mini_batch_src_global generation:  0.0011649131774902344
r_  generation:  0.010516881942749023
local_output_nid generation:  0.0015823841094970703
local_in_edges_tensor generation:  0.0008981227874755859
mini_batch_src_global generation:  0.001194000244140625
r_  generation:  0.010104179382324219
local_output_nid generation:  0.0015933513641357422
local_in_edges_tensor generation:  0.0008904933929443359
mini_batch_src_global generation:  0.0011606216430664062
r_  generation:  0.010595083236694336
local_output_nid generation:  0.0015897750854492188
local_in_edges_tensor generation:  0.0009157657623291016
mini_batch_src_global generation:  0.0011851787567138672
r_  generation:  0.010548114776611328
----------------------check_connections_block total spend ----------------------------- 0.5740771293640137
generate_one_block  0.021636486053466797
generate_one_block  0.021441221237182617
generate_one_block  0.01934814453125
generate_one_block  0.01838850975036621
generate_one_block  0.018247127532958984
generate_one_block  0.018430709838867188
generate_one_block  0.017798900604248047
generate_one_block  0.018316984176635742
generate_one_block  0.01816415786743164
generate_one_block  0.019290685653686523
generate_one_block  0.0197908878326416
generate_one_block  0.0182802677154541
generate_one_block  0.018148422241210938
generate_one_block  0.01815938949584961
generate_one_block  0.017960548400878906
generate_one_block  0.018230438232421875
generate_one_block  0.018073081970214844
generate_one_block  0.017838478088378906
generate_one_block  0.01736903190612793
generate_one_block  0.0184633731842041
generate_one_block  0.018758535385131836
generate_one_block  0.018128156661987305
generate_one_block  0.02144932746887207
generate_one_block  0.0177154541015625
generate_one_block  0.018353939056396484
generate_one_block  0.018535852432250977
generate_one_block  0.017904996871948242
generate_one_block  0.01871013641357422
generate_one_block  0.01975250244140625
generate_one_block  0.01863241195678711
generate_one_block  0.019125699996948242
generate_one_block  0.01860356330871582
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03931021690368652
gen group dst list time:  0.0233309268951416
time for parepare:  0.021975278854370117
local_output_nid generation:  0.006747007369995117
local_in_edges_tensor generation:  0.019692420959472656
mini_batch_src_global generation:  0.02294921875
r_  generation:  0.17566180229187012
local_output_nid generation:  0.009393930435180664
local_in_edges_tensor generation:  0.01245880126953125
mini_batch_src_global generation:  0.022574663162231445
r_  generation:  0.17083334922790527
local_output_nid generation:  0.009475946426391602
local_in_edges_tensor generation:  0.12293171882629395
mini_batch_src_global generation:  0.021669864654541016
r_  generation:  0.17693710327148438
local_output_nid generation:  0.009468317031860352
local_in_edges_tensor generation:  0.01200103759765625
mini_batch_src_global generation:  0.021878719329833984
r_  generation:  0.17152094841003418
local_output_nid generation:  0.009296417236328125
local_in_edges_tensor generation:  0.009824275970458984
mini_batch_src_global generation:  0.02164602279663086
r_  generation:  0.17364907264709473
local_output_nid generation:  0.009216070175170898
local_in_edges_tensor generation:  0.009935855865478516
mini_batch_src_global generation:  0.02262568473815918
r_  generation:  0.17980074882507324
local_output_nid generation:  0.008839130401611328
local_in_edges_tensor generation:  0.011607885360717773
mini_batch_src_global generation:  0.02192401885986328
r_  generation:  0.17390131950378418
local_output_nid generation:  0.00910329818725586
local_in_edges_tensor generation:  0.009993553161621094
mini_batch_src_global generation:  0.02317667007446289
r_  generation:  0.18117594718933105
local_output_nid generation:  0.00912618637084961
local_in_edges_tensor generation:  0.009207487106323242
mini_batch_src_global generation:  0.022796630859375
r_  generation:  0.18042945861816406
local_output_nid generation:  0.009913444519042969
local_in_edges_tensor generation:  0.01037454605102539
mini_batch_src_global generation:  0.025002241134643555
r_  generation:  0.18955779075622559
local_output_nid generation:  0.009531736373901367
local_in_edges_tensor generation:  0.009831666946411133
mini_batch_src_global generation:  0.023130178451538086
r_  generation:  0.18215203285217285
local_output_nid generation:  0.00942850112915039
local_in_edges_tensor generation:  0.009077310562133789
mini_batch_src_global generation:  0.02248978614807129
r_  generation:  0.17589282989501953
local_output_nid generation:  0.009692192077636719
local_in_edges_tensor generation:  0.009308338165283203
mini_batch_src_global generation:  0.023110628128051758
r_  generation:  0.18194246292114258
local_output_nid generation:  0.009515523910522461
local_in_edges_tensor generation:  0.009047508239746094
mini_batch_src_global generation:  0.023418664932250977
r_  generation:  0.18136286735534668
local_output_nid generation:  0.009500980377197266
local_in_edges_tensor generation:  0.009032726287841797
mini_batch_src_global generation:  0.02277517318725586
r_  generation:  0.18239259719848633
local_output_nid generation:  0.009466409683227539
local_in_edges_tensor generation:  0.009146928787231445
mini_batch_src_global generation:  0.023547649383544922
r_  generation:  0.18320631980895996
local_output_nid generation:  0.009588479995727539
local_in_edges_tensor generation:  0.009121179580688477
mini_batch_src_global generation:  0.02272820472717285
r_  generation:  0.18211984634399414
local_output_nid generation:  0.00924229621887207
local_in_edges_tensor generation:  0.009047746658325195
mini_batch_src_global generation:  0.02291083335876465
r_  generation:  0.17523193359375
local_output_nid generation:  0.009284496307373047
local_in_edges_tensor generation:  0.008917093276977539
mini_batch_src_global generation:  0.02197551727294922
r_  generation:  0.17686128616333008
local_output_nid generation:  0.009781599044799805
local_in_edges_tensor generation:  0.009032249450683594
mini_batch_src_global generation:  0.023417949676513672
r_  generation:  0.1884751319885254
local_output_nid generation:  0.009855031967163086
local_in_edges_tensor generation:  0.009636640548706055
mini_batch_src_global generation:  0.023957014083862305
r_  generation:  0.1866750717163086
local_output_nid generation:  0.009674549102783203
local_in_edges_tensor generation:  0.009941339492797852
mini_batch_src_global generation:  0.023205995559692383
r_  generation:  0.18456244468688965
local_output_nid generation:  0.009516477584838867
local_in_edges_tensor generation:  0.009134769439697266
mini_batch_src_global generation:  0.02254462242126465
r_  generation:  0.18192672729492188
local_output_nid generation:  0.00911402702331543
local_in_edges_tensor generation:  0.009533882141113281
mini_batch_src_global generation:  0.021952152252197266
r_  generation:  0.16902875900268555
local_output_nid generation:  0.009428262710571289
local_in_edges_tensor generation:  0.009195089340209961
mini_batch_src_global generation:  0.022817134857177734
r_  generation:  0.18378186225891113
local_output_nid generation:  0.009648323059082031
local_in_edges_tensor generation:  0.010518789291381836
mini_batch_src_global generation:  0.023103713989257812
r_  generation:  0.18375754356384277
local_output_nid generation:  0.009404182434082031
local_in_edges_tensor generation:  0.009611845016479492
mini_batch_src_global generation:  0.022556781768798828
r_  generation:  0.1845705509185791
local_output_nid generation:  0.00953221321105957
local_in_edges_tensor generation:  0.009918928146362305
mini_batch_src_global generation:  0.02356863021850586
r_  generation:  0.18728327751159668
local_output_nid generation:  0.009585142135620117
local_in_edges_tensor generation:  0.010042667388916016
mini_batch_src_global generation:  0.022884607315063477
r_  generation:  0.18565058708190918
local_output_nid generation:  0.009429454803466797
local_in_edges_tensor generation:  0.009578943252563477
mini_batch_src_global generation:  0.022754669189453125
r_  generation:  0.18110394477844238
local_output_nid generation:  0.0097198486328125
local_in_edges_tensor generation:  0.009277105331420898
mini_batch_src_global generation:  0.023160457611083984
r_  generation:  0.18943405151367188
local_output_nid generation:  0.009480953216552734
local_in_edges_tensor generation:  0.009149312973022461
mini_batch_src_global generation:  0.022994279861450195
r_  generation:  0.1847219467163086
----------------------check_connections_block total spend ----------------------------- 8.57933497428894
generate_one_block  0.26638293266296387
generate_one_block  0.2428896427154541
generate_one_block  0.26210808753967285
generate_one_block  0.2387549877166748
generate_one_block  0.24007272720336914
generate_one_block  0.2485649585723877
generate_one_block  0.23172736167907715
generate_one_block  0.2509582042694092
generate_one_block  0.24425721168518066
generate_one_block  0.2590513229370117
generate_one_block  0.2436220645904541
generate_one_block  0.23781800270080566
generate_one_block  0.2496950626373291
generate_one_block  0.24871349334716797
generate_one_block  0.24343323707580566
generate_one_block  0.24803495407104492
generate_one_block  0.24476122856140137
generate_one_block  0.23759746551513672
generate_one_block  0.2329542636871338
generate_one_block  0.25525808334350586
generate_one_block  0.2499537467956543
generate_one_block  0.2462317943572998
generate_one_block  0.2439579963684082
generate_one_block  0.22863340377807617
generate_one_block  0.24680399894714355
generate_one_block  0.249373197555542
generate_one_block  0.24232149124145508
generate_one_block  0.25281310081481934
generate_one_block  0.2466599941253662
generate_one_block  0.24619197845458984
generate_one_block  0.2536044120788574
generate_one_block  0.24708843231201172
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03490018844604492
gen group dst list time:  0.10409164428710938
time for parepare:  0.01838374137878418
local_output_nid generation:  0.025540828704833984
local_in_edges_tensor generation:  0.04171633720397949
mini_batch_src_global generation:  0.04015612602233887
r_  generation:  0.43108367919921875
local_output_nid generation:  0.031632423400878906
local_in_edges_tensor generation:  0.02927088737487793
mini_batch_src_global generation:  0.049844980239868164
r_  generation:  0.43070530891418457
local_output_nid generation:  0.03177595138549805
local_in_edges_tensor generation:  0.02912425994873047
mini_batch_src_global generation:  0.05038094520568848
r_  generation:  0.4367802143096924
local_output_nid generation:  0.03159284591674805
local_in_edges_tensor generation:  0.02728867530822754
mini_batch_src_global generation:  0.04914045333862305
r_  generation:  0.43949151039123535
local_output_nid generation:  0.031230688095092773
local_in_edges_tensor generation:  0.02878260612487793
mini_batch_src_global generation:  0.05320382118225098
r_  generation:  0.437732458114624
local_output_nid generation:  0.03192019462585449
local_in_edges_tensor generation:  0.0281217098236084
mini_batch_src_global generation:  0.051172494888305664
r_  generation:  0.43782472610473633
local_output_nid generation:  0.03042125701904297
local_in_edges_tensor generation:  0.02699899673461914
mini_batch_src_global generation:  0.050653696060180664
r_  generation:  0.4345662593841553
local_output_nid generation:  0.029417037963867188
local_in_edges_tensor generation:  0.027389049530029297
mini_batch_src_global generation:  0.05296516418457031
r_  generation:  0.4375452995300293
local_output_nid generation:  0.029772281646728516
local_in_edges_tensor generation:  0.030125141143798828
mini_batch_src_global generation:  0.05074906349182129
r_  generation:  0.4379231929779053
local_output_nid generation:  0.0315091609954834
local_in_edges_tensor generation:  0.09407806396484375
mini_batch_src_global generation:  0.051245927810668945
r_  generation:  0.4467616081237793
local_output_nid generation:  0.029597759246826172
local_in_edges_tensor generation:  0.03149747848510742
mini_batch_src_global generation:  0.0502321720123291
r_  generation:  0.4394643306732178
local_output_nid generation:  0.029778003692626953
local_in_edges_tensor generation:  0.02685856819152832
mini_batch_src_global generation:  0.05113363265991211
r_  generation:  0.44524073600769043
local_output_nid generation:  0.029953479766845703
local_in_edges_tensor generation:  0.03151249885559082
mini_batch_src_global generation:  0.052817344665527344
r_  generation:  0.441387414932251
local_output_nid generation:  0.02941751480102539
local_in_edges_tensor generation:  0.029676198959350586
mini_batch_src_global generation:  0.051860809326171875
r_  generation:  0.4392518997192383
local_output_nid generation:  0.029799938201904297
local_in_edges_tensor generation:  0.027326583862304688
mini_batch_src_global generation:  0.050009727478027344
r_  generation:  0.4407310485839844
local_output_nid generation:  0.029593706130981445
local_in_edges_tensor generation:  0.027651548385620117
mini_batch_src_global generation:  0.05308079719543457
r_  generation:  0.4423387050628662
local_output_nid generation:  0.029700756072998047
local_in_edges_tensor generation:  0.029219388961791992
mini_batch_src_global generation:  0.050856828689575195
r_  generation:  0.4445459842681885
local_output_nid generation:  0.02956366539001465
local_in_edges_tensor generation:  0.030562162399291992
mini_batch_src_global generation:  0.05153656005859375
r_  generation:  0.4382143020629883
local_output_nid generation:  0.029430627822875977
local_in_edges_tensor generation:  0.029273509979248047
mini_batch_src_global generation:  0.05003190040588379
r_  generation:  0.43721842765808105
local_output_nid generation:  0.029743194580078125
local_in_edges_tensor generation:  0.027355194091796875
mini_batch_src_global generation:  0.05332756042480469
r_  generation:  0.4433901309967041
local_output_nid generation:  0.03000926971435547
local_in_edges_tensor generation:  0.029197216033935547
mini_batch_src_global generation:  0.05095982551574707
r_  generation:  0.44212818145751953
local_output_nid generation:  0.029855966567993164
local_in_edges_tensor generation:  0.027869462966918945
mini_batch_src_global generation:  0.05182504653930664
r_  generation:  0.4406876564025879
local_output_nid generation:  0.02974867820739746
local_in_edges_tensor generation:  0.027783632278442383
mini_batch_src_global generation:  0.05109000205993652
r_  generation:  0.436964750289917
local_output_nid generation:  0.03033447265625
local_in_edges_tensor generation:  0.02975916862487793
mini_batch_src_global generation:  0.05108451843261719
r_  generation:  0.43394994735717773
local_output_nid generation:  0.029283761978149414
local_in_edges_tensor generation:  0.02819061279296875
mini_batch_src_global generation:  0.04972720146179199
r_  generation:  0.4458918571472168
local_output_nid generation:  0.03003716468811035
local_in_edges_tensor generation:  0.029587268829345703
mini_batch_src_global generation:  0.05103421211242676
r_  generation:  0.44269418716430664
local_output_nid generation:  0.03003668785095215
local_in_edges_tensor generation:  0.0300443172454834
mini_batch_src_global generation:  0.050559282302856445
r_  generation:  0.44103026390075684
local_output_nid generation:  0.02978229522705078
local_in_edges_tensor generation:  0.029217958450317383
mini_batch_src_global generation:  0.05104804039001465
r_  generation:  0.44367313385009766
local_output_nid generation:  0.029970645904541016
local_in_edges_tensor generation:  0.031048059463500977
mini_batch_src_global generation:  0.05057954788208008
r_  generation:  0.43573975563049316
local_output_nid generation:  0.02983832359313965
local_in_edges_tensor generation:  0.027811765670776367
mini_batch_src_global generation:  0.05353379249572754
r_  generation:  0.43978452682495117
local_output_nid generation:  0.03009343147277832
local_in_edges_tensor generation:  0.03254342079162598
mini_batch_src_global generation:  0.05444049835205078
r_  generation:  0.44199633598327637
local_output_nid generation:  0.030534029006958008
local_in_edges_tensor generation:  0.029850006103515625
mini_batch_src_global generation:  0.0523226261138916
r_  generation:  0.4397704601287842
----------------------check_connections_block total spend ----------------------------- 20.808797597885132
generate_one_block  0.5813205242156982
generate_one_block  0.5764756202697754
generate_one_block  0.578458309173584
generate_one_block  0.5790417194366455
generate_one_block  0.5750927925109863
generate_one_block  0.5803470611572266
generate_one_block  0.5991394519805908
generate_one_block  0.580876350402832
generate_one_block  0.5783185958862305
generate_one_block  0.5858604907989502
generate_one_block  0.5793547630310059
generate_one_block  0.5746183395385742
generate_one_block  0.5859427452087402
generate_one_block  0.5753512382507324
generate_one_block  0.5775117874145508
generate_one_block  0.5824494361877441
generate_one_block  0.5840802192687988
generate_one_block  0.5731222629547119
generate_one_block  0.579317569732666
generate_one_block  0.5904033184051514
generate_one_block  0.5869221687316895
generate_one_block  0.5810952186584473
generate_one_block  0.5785679817199707
generate_one_block  0.5684340000152588
generate_one_block  0.5778462886810303
generate_one_block  0.5853033065795898
generate_one_block  0.5840423107147217
generate_one_block  0.5881326198577881
generate_one_block  0.5742979049682617
generate_one_block  0.5847232341766357
generate_one_block  0.5905306339263916
generate_one_block  0.5818271636962891
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.1278824806213379  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

connection checking time:  29.388132572174072
block generation total time  26.47909426689148
average batch blocks generation time:  0.8274716958403587
block dataloader generation time/epoch 59.466673135757446
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7244873046875 GB
    Memory Allocated: 0.10709333419799805  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.549752235412598  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10663509368896484  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.927334785461426  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10668516159057617  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.123749256134033  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10640668869018555  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.736958026885986  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10643386840820312  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.650086402893066  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10692501068115234  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.094797611236572  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10619306564331055  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.281251430511475  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10639142990112305  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.06043004989624  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10645055770874023  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.895646572113037  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10709428787231445  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.552627086639404  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10630369186401367  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.904354095458984  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10663509368896484  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.563538074493408  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.1067037582397461  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.926538467407227  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10632991790771484  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.964827060699463  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10662508010864258  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.801372051239014  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.1066594123840332  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.060504913330078  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10668659210205078  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.902743816375732  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10644912719726562  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.419615745544434  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10648298263549805  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.412985801696777  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10699224472045898  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.24943208694458  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10693979263305664  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.176781177520752  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10663270950317383  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.961369514465332  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10663175582885742  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.872532844543457  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10604286193847656  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.085157871246338  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10637187957763672  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.903493404388428  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10669994354248047  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.01719903945923  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10670280456542969  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.828044414520264  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10667037963867188  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.104226112365723  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10649967193603516  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.84376096725464  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10655593872070312  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.851221561431885  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10692834854125977  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.24981451034546  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10691690444946289  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.061415195465088  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02935943752527237 |0.02025119960308075 |0.5535875558853149 |9.484589099884033e-05 |1.0650152191519737 |0.005276203155517578 |
----------------------------------------------------------pseudo_mini_loss sum 1.3958871364593506
Total (block generation + training)time/epoch 113.13136930465699
Training time/epoch 53.44051146507263
Training time without block to device /epoch 52.79247307777405
Training time without total dataloading part /epoch 51.80360007286072
load block tensor time/epoch 0.9395020008087158
block to device time/epoch 0.648038387298584
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 19 |
Number of nodes for computation during this epoch:  9115645
Number of first layer input nodes during this epoch:  4763102
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.12713861465454102  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027061939239501953
random selection method range initialization spend 0.005362749099731445
time for parepare:  0.02121114730834961
local_output_nid generation:  0.0014083385467529297
local_in_edges_tensor generation:  0.006386280059814453
mini_batch_src_global generation:  0.0017137527465820312
r_  generation:  0.01065206527709961
local_output_nid generation:  0.0016412734985351562
local_in_edges_tensor generation:  0.001096963882446289
mini_batch_src_global generation:  0.0017237663269042969
r_  generation:  0.011287212371826172
local_output_nid generation:  0.0016875267028808594
local_in_edges_tensor generation:  0.0009794235229492188
mini_batch_src_global generation:  0.0012197494506835938
r_  generation:  0.009999990463256836
local_output_nid generation:  0.001661062240600586
local_in_edges_tensor generation:  0.0009627342224121094
mini_batch_src_global generation:  0.001142740249633789
r_  generation:  0.009872198104858398
local_output_nid generation:  0.0016124248504638672
local_in_edges_tensor generation:  0.0009377002716064453
mini_batch_src_global generation:  0.0012481212615966797
r_  generation:  0.010150909423828125
local_output_nid generation:  0.0015921592712402344
local_in_edges_tensor generation:  0.0009348392486572266
mini_batch_src_global generation:  0.0010728836059570312
r_  generation:  0.009518623352050781
local_output_nid generation:  0.0015900135040283203
local_in_edges_tensor generation:  0.0009357929229736328
mini_batch_src_global generation:  0.001148223876953125
r_  generation:  0.00995492935180664
local_output_nid generation:  0.0016100406646728516
local_in_edges_tensor generation:  0.000949859619140625
mini_batch_src_global generation:  0.0011475086212158203
r_  generation:  0.010575532913208008
local_output_nid generation:  0.0015976428985595703
local_in_edges_tensor generation:  0.0009047985076904297
mini_batch_src_global generation:  0.0010967254638671875
r_  generation:  0.01008749008178711
local_output_nid generation:  0.001600027084350586
local_in_edges_tensor generation:  0.0009088516235351562
mini_batch_src_global generation:  0.0011425018310546875
r_  generation:  0.010229110717773438
local_output_nid generation:  0.0015804767608642578
local_in_edges_tensor generation:  0.0009284019470214844
mini_batch_src_global generation:  0.0011310577392578125
r_  generation:  0.010312795639038086
local_output_nid generation:  0.001589059829711914
local_in_edges_tensor generation:  0.0008943080902099609
mini_batch_src_global generation:  0.0010769367218017578
r_  generation:  0.00978994369506836
local_output_nid generation:  0.0015742778778076172
local_in_edges_tensor generation:  0.0009200572967529297
mini_batch_src_global generation:  0.00121307373046875
r_  generation:  0.010464906692504883
local_output_nid generation:  0.0015685558319091797
local_in_edges_tensor generation:  0.0009007453918457031
mini_batch_src_global generation:  0.0011882781982421875
r_  generation:  0.01038670539855957
local_output_nid generation:  0.0015900135040283203
local_in_edges_tensor generation:  0.0009081363677978516
mini_batch_src_global generation:  0.0011081695556640625
r_  generation:  0.010073423385620117
local_output_nid generation:  0.0015780925750732422
local_in_edges_tensor generation:  0.0009043216705322266
mini_batch_src_global generation:  0.0011429786682128906
r_  generation:  0.010353803634643555
local_output_nid generation:  0.0015654563903808594
local_in_edges_tensor generation:  0.0008859634399414062
mini_batch_src_global generation:  0.0010387897491455078
r_  generation:  0.012070894241333008
local_output_nid generation:  0.0016484260559082031
local_in_edges_tensor generation:  0.0009200572967529297
mini_batch_src_global generation:  0.0012001991271972656
r_  generation:  0.010288476943969727
local_output_nid generation:  0.0015993118286132812
local_in_edges_tensor generation:  0.0008776187896728516
mini_batch_src_global generation:  0.0010848045349121094
r_  generation:  0.00971221923828125
local_output_nid generation:  0.001581430435180664
local_in_edges_tensor generation:  0.0008890628814697266
mini_batch_src_global generation:  0.0011768341064453125
r_  generation:  0.010116338729858398
local_output_nid generation:  0.0015869140625
local_in_edges_tensor generation:  0.0008931159973144531
mini_batch_src_global generation:  0.0011720657348632812
r_  generation:  0.010510683059692383
local_output_nid generation:  0.0015950202941894531
local_in_edges_tensor generation:  0.0009081363677978516
mini_batch_src_global generation:  0.001117706298828125
r_  generation:  0.010142803192138672
local_output_nid generation:  0.001636505126953125
local_in_edges_tensor generation:  0.000885009765625
mini_batch_src_global generation:  0.0012135505676269531
r_  generation:  0.010592937469482422
local_output_nid generation:  0.0016238689422607422
local_in_edges_tensor generation:  0.0009124279022216797
mini_batch_src_global generation:  0.001188039779663086
r_  generation:  0.010353565216064453
local_output_nid generation:  0.0015799999237060547
local_in_edges_tensor generation:  0.0009009838104248047
mini_batch_src_global generation:  0.0011610984802246094
r_  generation:  0.010395526885986328
local_output_nid generation:  0.0015676021575927734
local_in_edges_tensor generation:  0.0008902549743652344
mini_batch_src_global generation:  0.0012385845184326172
r_  generation:  0.01075434684753418
local_output_nid generation:  0.0015873908996582031
local_in_edges_tensor generation:  0.0009133815765380859
mini_batch_src_global generation:  0.0012292861938476562
r_  generation:  0.010319709777832031
local_output_nid generation:  0.0015721321105957031
local_in_edges_tensor generation:  0.0009036064147949219
mini_batch_src_global generation:  0.001163482666015625
r_  generation:  0.010563135147094727
local_output_nid generation:  0.0015721321105957031
local_in_edges_tensor generation:  0.0009038448333740234
mini_batch_src_global generation:  0.0011916160583496094
r_  generation:  0.01070857048034668
local_output_nid generation:  0.0015811920166015625
local_in_edges_tensor generation:  0.0009307861328125
mini_batch_src_global generation:  0.0011975765228271484
r_  generation:  0.010272741317749023
local_output_nid generation:  0.0016145706176757812
local_in_edges_tensor generation:  0.0009348392486572266
mini_batch_src_global generation:  0.0011446475982666016
r_  generation:  0.009974241256713867
local_output_nid generation:  0.0015964508056640625
local_in_edges_tensor generation:  0.0009105205535888672
mini_batch_src_global generation:  0.001190185546875
r_  generation:  0.010251045227050781
----------------------check_connections_block total spend ----------------------------- 0.571972131729126
generate_one_block  0.024906635284423828
generate_one_block  0.02266550064086914
generate_one_block  0.019385337829589844
generate_one_block  0.018610239028930664
generate_one_block  0.018827199935913086
generate_one_block  0.017531156539916992
generate_one_block  0.018393754959106445
generate_one_block  0.0189974308013916
generate_one_block  0.018218517303466797
generate_one_block  0.018394947052001953
generate_one_block  0.018401622772216797
generate_one_block  0.020259857177734375
generate_one_block  0.01971149444580078
generate_one_block  0.018412351608276367
generate_one_block  0.017874479293823242
generate_one_block  0.018535614013671875
generate_one_block  0.019492626190185547
generate_one_block  0.018805980682373047
generate_one_block  0.01763629913330078
generate_one_block  0.01803421974182129
generate_one_block  0.018634796142578125
generate_one_block  0.01790642738342285
generate_one_block  0.018693208694458008
generate_one_block  0.018131732940673828
generate_one_block  0.018423080444335938
generate_one_block  0.018747329711914062
generate_one_block  0.018353700637817383
generate_one_block  0.0187380313873291
generate_one_block  0.018817663192749023
generate_one_block  0.017825603485107422
generate_one_block  0.017954111099243164
generate_one_block  0.01822972297668457
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03720569610595703
gen group dst list time:  0.02299046516418457
time for parepare:  0.02223348617553711
local_output_nid generation:  0.006597995758056641
local_in_edges_tensor generation:  0.018937110900878906
mini_batch_src_global generation:  0.0178983211517334
r_  generation:  0.16474580764770508
local_output_nid generation:  0.009862899780273438
local_in_edges_tensor generation:  0.013583660125732422
mini_batch_src_global generation:  0.023352384567260742
r_  generation:  0.18062162399291992
local_output_nid generation:  0.00943136215209961
local_in_edges_tensor generation:  0.03475809097290039
mini_batch_src_global generation:  0.02145528793334961
r_  generation:  0.17401790618896484
local_output_nid generation:  0.009434700012207031
local_in_edges_tensor generation:  0.012748956680297852
mini_batch_src_global generation:  0.022829294204711914
r_  generation:  0.17446160316467285
local_output_nid generation:  0.009495735168457031
local_in_edges_tensor generation:  0.011848926544189453
mini_batch_src_global generation:  0.022619962692260742
r_  generation:  0.184647798538208
local_output_nid generation:  0.008659839630126953
local_in_edges_tensor generation:  0.011541366577148438
mini_batch_src_global generation:  0.021025896072387695
r_  generation:  0.1666114330291748
local_output_nid generation:  0.009139537811279297
local_in_edges_tensor generation:  0.013048887252807617
mini_batch_src_global generation:  0.023439645767211914
r_  generation:  0.2402040958404541
local_output_nid generation:  0.009095430374145508
local_in_edges_tensor generation:  0.009738683700561523
mini_batch_src_global generation:  0.024141311645507812
r_  generation:  0.18613362312316895
local_output_nid generation:  0.009099960327148438
local_in_edges_tensor generation:  0.00977015495300293
mini_batch_src_global generation:  0.02384662628173828
r_  generation:  0.18176651000976562
local_output_nid generation:  0.00962519645690918
local_in_edges_tensor generation:  0.013171672821044922
mini_batch_src_global generation:  0.023555994033813477
r_  generation:  0.18575191497802734
local_output_nid generation:  0.009431123733520508
local_in_edges_tensor generation:  0.009876489639282227
mini_batch_src_global generation:  0.026243209838867188
r_  generation:  0.1932992935180664
local_output_nid generation:  0.009191036224365234
local_in_edges_tensor generation:  0.012735605239868164
mini_batch_src_global generation:  0.021825075149536133
r_  generation:  0.1743178367614746
local_output_nid generation:  0.009755849838256836
local_in_edges_tensor generation:  0.011839628219604492
mini_batch_src_global generation:  0.025565385818481445
r_  generation:  0.1874547004699707
local_output_nid generation:  0.009449481964111328
local_in_edges_tensor generation:  0.009999752044677734
mini_batch_src_global generation:  0.02412247657775879
r_  generation:  0.23469829559326172
local_output_nid generation:  0.009278297424316406
local_in_edges_tensor generation:  0.009503364562988281
mini_batch_src_global generation:  0.023331403732299805
r_  generation:  0.18067622184753418
local_output_nid generation:  0.009737253189086914
local_in_edges_tensor generation:  0.009984493255615234
mini_batch_src_global generation:  0.023215532302856445
r_  generation:  0.1879291534423828
local_output_nid generation:  0.010263442993164062
local_in_edges_tensor generation:  0.011846780776977539
mini_batch_src_global generation:  0.025447607040405273
r_  generation:  0.19704103469848633
local_output_nid generation:  0.00921487808227539
local_in_edges_tensor generation:  0.00937509536743164
mini_batch_src_global generation:  0.02312946319580078
r_  generation:  0.17368102073669434
local_output_nid generation:  0.009267568588256836
local_in_edges_tensor generation:  0.009656190872192383
mini_batch_src_global generation:  0.02138996124267578
r_  generation:  0.17710018157958984
local_output_nid generation:  0.009368181228637695
local_in_edges_tensor generation:  0.011759042739868164
mini_batch_src_global generation:  0.023249387741088867
r_  generation:  0.1827983856201172
local_output_nid generation:  0.009776592254638672
local_in_edges_tensor generation:  0.009966850280761719
mini_batch_src_global generation:  0.034528255462646484
r_  generation:  0.19883155822753906
local_output_nid generation:  0.010933160781860352
local_in_edges_tensor generation:  0.010112762451171875
mini_batch_src_global generation:  0.024225473403930664
r_  generation:  0.18134713172912598
local_output_nid generation:  0.009879112243652344
local_in_edges_tensor generation:  0.010145187377929688
mini_batch_src_global generation:  0.023563146591186523
r_  generation:  0.19228029251098633
local_output_nid generation:  0.009651660919189453
local_in_edges_tensor generation:  0.010027408599853516
mini_batch_src_global generation:  0.023395061492919922
r_  generation:  0.17871856689453125
local_output_nid generation:  0.009749889373779297
local_in_edges_tensor generation:  0.009830951690673828
mini_batch_src_global generation:  0.023016691207885742
r_  generation:  0.1855313777923584
local_output_nid generation:  0.009997367858886719
local_in_edges_tensor generation:  0.010712623596191406
mini_batch_src_global generation:  0.024880409240722656
r_  generation:  0.18810009956359863
local_output_nid generation:  0.009850263595581055
local_in_edges_tensor generation:  0.009883880615234375
mini_batch_src_global generation:  0.023232698440551758
r_  generation:  0.18660736083984375
local_output_nid generation:  0.010022640228271484
local_in_edges_tensor generation:  0.010034799575805664
mini_batch_src_global generation:  0.025099992752075195
r_  generation:  0.1906735897064209
local_output_nid generation:  0.010033845901489258
local_in_edges_tensor generation:  0.012307167053222656
mini_batch_src_global generation:  0.023755550384521484
r_  generation:  0.19491028785705566
local_output_nid generation:  0.009594917297363281
local_in_edges_tensor generation:  0.00954890251159668
mini_batch_src_global generation:  0.022917985916137695
r_  generation:  0.18018698692321777
local_output_nid generation:  0.009543418884277344
local_in_edges_tensor generation:  0.009780406951904297
mini_batch_src_global generation:  0.023859024047851562
r_  generation:  0.18654322624206543
local_output_nid generation:  0.009581565856933594
local_in_edges_tensor generation:  0.009736776351928711
mini_batch_src_global generation:  0.023021697998046875
r_  generation:  0.18334174156188965
----------------------check_connections_block total spend ----------------------------- 8.774592876434326
generate_one_block  0.25754404067993164
generate_one_block  0.26052308082580566
generate_one_block  0.24213027954101562
generate_one_block  0.2424771785736084
generate_one_block  0.27019548416137695
generate_one_block  0.22872328758239746
generate_one_block  0.2500460147857666
generate_one_block  0.25688719749450684
generate_one_block  0.24367189407348633
generate_one_block  0.24910783767700195
generate_one_block  0.25083184242248535
generate_one_block  0.23431849479675293
generate_one_block  0.2559194564819336
generate_one_block  0.25238847732543945
generate_one_block  0.24353766441345215
generate_one_block  0.2523653507232666
generate_one_block  0.26376867294311523
generate_one_block  0.23687100410461426
generate_one_block  0.2339763641357422
generate_one_block  0.2537205219268799
generate_one_block  0.25922060012817383
generate_one_block  0.24808859825134277
generate_one_block  0.25705480575561523
generate_one_block  0.24502038955688477
generate_one_block  0.25039052963256836
generate_one_block  0.25709962844848633
generate_one_block  0.24865365028381348
generate_one_block  0.2616569995880127
generate_one_block  0.2562432289123535
generate_one_block  0.2374885082244873
generate_one_block  0.2413177490234375
generate_one_block  0.24257493019104004
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03868818283081055
gen group dst list time:  0.11589479446411133
time for parepare:  0.01955103874206543
local_output_nid generation:  0.027593135833740234
local_in_edges_tensor generation:  0.05014657974243164
mini_batch_src_global generation:  0.04093456268310547
r_  generation:  0.42731285095214844
local_output_nid generation:  0.03262042999267578
local_in_edges_tensor generation:  0.03435683250427246
mini_batch_src_global generation:  0.051206350326538086
r_  generation:  0.42722272872924805
local_output_nid generation:  0.03273653984069824
local_in_edges_tensor generation:  0.03164410591125488
mini_batch_src_global generation:  0.04846525192260742
r_  generation:  0.4333326816558838
local_output_nid generation:  0.03307604789733887
local_in_edges_tensor generation:  0.027584552764892578
mini_batch_src_global generation:  0.05044841766357422
r_  generation:  0.4341127872467041
local_output_nid generation:  0.03243517875671387
local_in_edges_tensor generation:  0.03211331367492676
mini_batch_src_global generation:  0.05242276191711426
r_  generation:  0.43910908699035645
local_output_nid generation:  0.03278779983520508
local_in_edges_tensor generation:  0.026921749114990234
mini_batch_src_global generation:  0.05130600929260254
r_  generation:  0.4390888214111328
local_output_nid generation:  0.03116464614868164
local_in_edges_tensor generation:  0.031305789947509766
mini_batch_src_global generation:  0.051554203033447266
r_  generation:  0.45040416717529297
local_output_nid generation:  0.030679941177368164
local_in_edges_tensor generation:  0.026732921600341797
mini_batch_src_global generation:  0.05117464065551758
r_  generation:  0.44347643852233887
local_output_nid generation:  0.030406713485717773
local_in_edges_tensor generation:  0.028438568115234375
mini_batch_src_global generation:  0.05165863037109375
r_  generation:  0.4384582042694092
local_output_nid generation:  0.03063488006591797
local_in_edges_tensor generation:  0.033171892166137695
mini_batch_src_global generation:  0.05108475685119629
r_  generation:  0.44168853759765625
local_output_nid generation:  0.030740022659301758
local_in_edges_tensor generation:  0.031151771545410156
mini_batch_src_global generation:  0.0501704216003418
r_  generation:  0.43700242042541504
local_output_nid generation:  0.03043055534362793
local_in_edges_tensor generation:  0.029337167739868164
mini_batch_src_global generation:  0.05042600631713867
r_  generation:  0.43971729278564453
local_output_nid generation:  0.030580520629882812
local_in_edges_tensor generation:  0.03221392631530762
mini_batch_src_global generation:  0.05150294303894043
r_  generation:  0.43985629081726074
local_output_nid generation:  0.03041529655456543
local_in_edges_tensor generation:  0.029122352600097656
mini_batch_src_global generation:  0.05285477638244629
r_  generation:  0.44336438179016113
local_output_nid generation:  0.030343055725097656
local_in_edges_tensor generation:  0.027083635330200195
mini_batch_src_global generation:  0.04971814155578613
r_  generation:  0.4372882843017578
local_output_nid generation:  0.03300213813781738
local_in_edges_tensor generation:  0.029016733169555664
mini_batch_src_global generation:  0.05128812789916992
r_  generation:  0.4454224109649658
local_output_nid generation:  0.031044721603393555
local_in_edges_tensor generation:  0.0307614803314209
mini_batch_src_global generation:  0.05207014083862305
r_  generation:  0.4466991424560547
local_output_nid generation:  0.030098676681518555
local_in_edges_tensor generation:  0.03344845771789551
mini_batch_src_global generation:  0.053858280181884766
r_  generation:  0.43516087532043457
local_output_nid generation:  0.030694961547851562
local_in_edges_tensor generation:  0.03339123725891113
mini_batch_src_global generation:  0.05092024803161621
r_  generation:  0.436450719833374
local_output_nid generation:  0.030499935150146484
local_in_edges_tensor generation:  0.02849435806274414
mini_batch_src_global generation:  0.051186561584472656
r_  generation:  0.44098782539367676
local_output_nid generation:  0.0361788272857666
local_in_edges_tensor generation:  0.027963876724243164
mini_batch_src_global generation:  0.060010433197021484
r_  generation:  0.4444887638092041
local_output_nid generation:  0.031389474868774414
local_in_edges_tensor generation:  0.031184911727905273
mini_batch_src_global generation:  0.05135154724121094
r_  generation:  0.4377562999725342
local_output_nid generation:  0.031500816345214844
local_in_edges_tensor generation:  0.02764749526977539
mini_batch_src_global generation:  0.05043482780456543
r_  generation:  0.4394645690917969
local_output_nid generation:  0.0317683219909668
local_in_edges_tensor generation:  0.027523279190063477
mini_batch_src_global generation:  0.05100059509277344
r_  generation:  0.43696022033691406
local_output_nid generation:  0.03133964538574219
local_in_edges_tensor generation:  0.030750513076782227
mini_batch_src_global generation:  0.05480813980102539
r_  generation:  0.44055628776550293
local_output_nid generation:  0.03156685829162598
local_in_edges_tensor generation:  0.028178930282592773
mini_batch_src_global generation:  0.05204653739929199
r_  generation:  0.44596171379089355
local_output_nid generation:  0.03124713897705078
local_in_edges_tensor generation:  0.030105113983154297
mini_batch_src_global generation:  0.05052518844604492
r_  generation:  0.43965721130371094
local_output_nid generation:  0.03145456314086914
local_in_edges_tensor generation:  0.027568578720092773
mini_batch_src_global generation:  0.051377058029174805
r_  generation:  0.44028806686401367
local_output_nid generation:  0.04437088966369629
local_in_edges_tensor generation:  0.031462907791137695
mini_batch_src_global generation:  0.05092287063598633
r_  generation:  0.4411194324493408
local_output_nid generation:  0.031275033950805664
local_in_edges_tensor generation:  0.027423620223999023
mini_batch_src_global generation:  0.05129575729370117
r_  generation:  0.44217824935913086
local_output_nid generation:  0.03142952919006348
local_in_edges_tensor generation:  0.03096485137939453
mini_batch_src_global generation:  0.0504610538482666
r_  generation:  0.4468116760253906
local_output_nid generation:  0.03166556358337402
local_in_edges_tensor generation:  0.027682065963745117
mini_batch_src_global generation:  0.051511526107788086
r_  generation:  0.4470498561859131
----------------------check_connections_block total spend ----------------------------- 20.855714321136475
generate_one_block  0.598034143447876
generate_one_block  0.5822362899780273
generate_one_block  0.5792179107666016
generate_one_block  0.5844156742095947
generate_one_block  0.6919064521789551
generate_one_block  0.5819833278656006
generate_one_block  0.5851013660430908
generate_one_block  0.5860533714294434
generate_one_block  0.5881695747375488
generate_one_block  0.5855319499969482
generate_one_block  0.5843033790588379
generate_one_block  0.5832717418670654
generate_one_block  0.5848515033721924
generate_one_block  0.5835001468658447
generate_one_block  0.581838846206665
generate_one_block  0.584296464920044
generate_one_block  0.5894711017608643
generate_one_block  0.578052282333374
generate_one_block  0.5790791511535645
generate_one_block  0.5825483798980713
generate_one_block  0.5877411365509033
generate_one_block  0.5861485004425049
generate_one_block  0.5927441120147705
generate_one_block  0.5933659076690674
generate_one_block  0.6024785041809082
generate_one_block  0.5885312557220459
generate_one_block  0.5869102478027344
generate_one_block  0.5864524841308594
generate_one_block  0.5894808769226074
generate_one_block  0.5829558372497559
generate_one_block  0.5873432159423828
generate_one_block  0.5885133743286133
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.12713861465454102  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

connection checking time:  29.6303071975708
block generation total time  26.850342273712158
average batch blocks generation time:  0.8390731960535049
block dataloader generation time/epoch 59.504148960113525
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10681867599487305  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.89562749862671  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10683202743530273  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.57054853439331  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10658884048461914  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.846139907836914  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10666131973266602  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.929590225219727  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10678815841674805  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.251315593719482  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10600090026855469  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.088890075683594  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10678291320800781  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.115782260894775  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10657691955566406  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.299798488616943  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10651540756225586  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.86672067642212  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10664987564086914  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.03103542327881  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10673189163208008  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.044204235076904  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10625886917114258  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.2111554145813  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10663509368896484  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.164859294891357  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10648965835571289  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.89884662628174  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10638427734375  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.468735218048096  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.1065521240234375  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.037054538726807  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10830211639404297  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.61983585357666  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10586786270141602  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.364503383636475  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10619640350341797  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.20387601852417  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10640668869018555  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.623466968536377  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.1069793701171875  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.261294841766357  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10651922225952148  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.778696537017822  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10677289962768555  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.234621047973633  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10651254653930664  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.77503538131714  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10666084289550781  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.953654766082764  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10706806182861328  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.281842708587646  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10660552978515625  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.93184757232666  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10673189163208008  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.302629470825195  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10696744918823242  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.345924854278564  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10625839233398438  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.56598711013794  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10635662078857422  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.708210468292236  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10680961608886719  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.896745204925537  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.035175733268260956 |0.022585079073905945 |0.5655187517404556 |9.988248348236084e-05 |1.0780748650431633 |0.008186817169189453 |
----------------------------------------------------------pseudo_mini_loss sum 1.3778941631317139
Total (block generation + training)time/epoch 113.24544356086038
Training time/epoch 54.50697469711304
Training time without block to device /epoch 53.78425216674805
Training time without total dataloading part /epoch 52.60637879371643
load block tensor time/epoch 1.1256234645843506
block to device time/epoch 0.7227225303649902
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 20 |
Number of nodes for computation during this epoch:  9116095
Number of first layer input nodes during this epoch:  4761737
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.12687349319458008  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024427175521850586
random selection method range initialization spend 0.006308555603027344
time for parepare:  0.021930932998657227
local_output_nid generation:  0.0014567375183105469
local_in_edges_tensor generation:  0.0041234493255615234
mini_batch_src_global generation:  0.0025360584259033203
r_  generation:  0.01220083236694336
local_output_nid generation:  0.0016825199127197266
local_in_edges_tensor generation:  0.0010142326354980469
mini_batch_src_global generation:  0.0016770362854003906
r_  generation:  0.010366678237915039
local_output_nid generation:  0.0016453266143798828
local_in_edges_tensor generation:  0.0009295940399169922
mini_batch_src_global generation:  0.0013039112091064453
r_  generation:  0.010184049606323242
local_output_nid generation:  0.0016117095947265625
local_in_edges_tensor generation:  0.0009407997131347656
mini_batch_src_global generation:  0.0011780261993408203
r_  generation:  0.00952911376953125
local_output_nid generation:  0.0015935897827148438
local_in_edges_tensor generation:  0.0009241104125976562
mini_batch_src_global generation:  0.0012059211730957031
r_  generation:  0.009990215301513672
local_output_nid generation:  0.0016131401062011719
local_in_edges_tensor generation:  0.0009188652038574219
mini_batch_src_global generation:  0.0012054443359375
r_  generation:  0.01018071174621582
local_output_nid generation:  0.0015976428985595703
local_in_edges_tensor generation:  0.0009245872497558594
mini_batch_src_global generation:  0.001226186752319336
r_  generation:  0.010465621948242188
local_output_nid generation:  0.0016009807586669922
local_in_edges_tensor generation:  0.0009217262268066406
mini_batch_src_global generation:  0.0012280941009521484
r_  generation:  0.010289430618286133
local_output_nid generation:  0.0015969276428222656
local_in_edges_tensor generation:  0.0008902549743652344
mini_batch_src_global generation:  0.0012199878692626953
r_  generation:  0.010258197784423828
local_output_nid generation:  0.0015864372253417969
local_in_edges_tensor generation:  0.0009133815765380859
mini_batch_src_global generation:  0.0012578964233398438
r_  generation:  0.010516643524169922
local_output_nid generation:  0.0015912055969238281
local_in_edges_tensor generation:  0.0009114742279052734
mini_batch_src_global generation:  0.001188516616821289
r_  generation:  0.01031637191772461
local_output_nid generation:  0.0016207695007324219
local_in_edges_tensor generation:  0.0009064674377441406
mini_batch_src_global generation:  0.0011565685272216797
r_  generation:  0.010142326354980469
local_output_nid generation:  0.0016107559204101562
local_in_edges_tensor generation:  0.0008952617645263672
mini_batch_src_global generation:  0.0012135505676269531
r_  generation:  0.009970903396606445
local_output_nid generation:  0.0015864372253417969
local_in_edges_tensor generation:  0.0010063648223876953
mini_batch_src_global generation:  0.0012288093566894531
r_  generation:  0.01056528091430664
local_output_nid generation:  0.0016031265258789062
local_in_edges_tensor generation:  0.000896453857421875
mini_batch_src_global generation:  0.0011489391326904297
r_  generation:  0.011914968490600586
local_output_nid generation:  0.0016021728515625
local_in_edges_tensor generation:  0.0015430450439453125
mini_batch_src_global generation:  0.0011975765228271484
r_  generation:  0.010318756103515625
local_output_nid generation:  0.0015964508056640625
local_in_edges_tensor generation:  0.0010528564453125
mini_batch_src_global generation:  0.0011758804321289062
r_  generation:  0.010254383087158203
local_output_nid generation:  0.0015964508056640625
local_in_edges_tensor generation:  0.0009133815765380859
mini_batch_src_global generation:  0.0011036396026611328
r_  generation:  0.009507179260253906
local_output_nid generation:  0.001608133316040039
local_in_edges_tensor generation:  0.0009150505065917969
mini_batch_src_global generation:  0.0011484622955322266
r_  generation:  0.010291099548339844
local_output_nid generation:  0.001583099365234375
local_in_edges_tensor generation:  0.0008938312530517578
mini_batch_src_global generation:  0.0011773109436035156
r_  generation:  0.010344982147216797
local_output_nid generation:  0.0015807151794433594
local_in_edges_tensor generation:  0.0009109973907470703
mini_batch_src_global generation:  0.0012378692626953125
r_  generation:  0.010693788528442383
local_output_nid generation:  0.001592397689819336
local_in_edges_tensor generation:  0.0009770393371582031
mini_batch_src_global generation:  0.0012743473052978516
r_  generation:  0.010743141174316406
local_output_nid generation:  0.0015919208526611328
local_in_edges_tensor generation:  0.0009593963623046875
mini_batch_src_global generation:  0.0012118816375732422
r_  generation:  0.010474205017089844
local_output_nid generation:  0.0015883445739746094
local_in_edges_tensor generation:  0.0009059906005859375
mini_batch_src_global generation:  0.0011715888977050781
r_  generation:  0.010425567626953125
local_output_nid generation:  0.0015804767608642578
local_in_edges_tensor generation:  0.0008859634399414062
mini_batch_src_global generation:  0.0011818408966064453
r_  generation:  0.010270357131958008
local_output_nid generation:  0.0016129016876220703
local_in_edges_tensor generation:  0.0009243488311767578
mini_batch_src_global generation:  0.0012149810791015625
r_  generation:  0.010793447494506836
local_output_nid generation:  0.0016314983367919922
local_in_edges_tensor generation:  0.0009257793426513672
mini_batch_src_global generation:  0.0012249946594238281
r_  generation:  0.010736227035522461
local_output_nid generation:  0.0015795230865478516
local_in_edges_tensor generation:  0.0009160041809082031
mini_batch_src_global generation:  0.0011332035064697266
r_  generation:  0.00982975959777832
local_output_nid generation:  0.001589059829711914
local_in_edges_tensor generation:  0.0009031295776367188
mini_batch_src_global generation:  0.0011606216430664062
r_  generation:  0.010200023651123047
local_output_nid generation:  0.0016093254089355469
local_in_edges_tensor generation:  0.0009057521820068359
mini_batch_src_global generation:  0.0011675357818603516
r_  generation:  0.010232686996459961
local_output_nid generation:  0.0016031265258789062
local_in_edges_tensor generation:  0.0009033679962158203
mini_batch_src_global generation:  0.0012180805206298828
r_  generation:  0.010450363159179688
local_output_nid generation:  0.001590728759765625
local_in_edges_tensor generation:  0.0008885860443115234
mini_batch_src_global generation:  0.0011737346649169922
r_  generation:  0.010383844375610352
----------------------check_connections_block total spend ----------------------------- 0.576167106628418
generate_one_block  0.02558588981628418
generate_one_block  0.020968914031982422
generate_one_block  0.019320964813232422
generate_one_block  0.017749309539794922
generate_one_block  0.01852273941040039
generate_one_block  0.018404722213745117
generate_one_block  0.018665075302124023
generate_one_block  0.01863384246826172
generate_one_block  0.018435239791870117
generate_one_block  0.018473386764526367
generate_one_block  0.01833939552307129
generate_one_block  0.020905017852783203
generate_one_block  0.018624544143676758
generate_one_block  0.01904439926147461
generate_one_block  0.01764988899230957
generate_one_block  0.018300533294677734
generate_one_block  0.01811671257019043
generate_one_block  0.01701951026916504
generate_one_block  0.018212318420410156
generate_one_block  0.01814746856689453
generate_one_block  0.018920183181762695
generate_one_block  0.01903533935546875
generate_one_block  0.018560171127319336
generate_one_block  0.018123626708984375
generate_one_block  0.018213987350463867
generate_one_block  0.018952608108520508
generate_one_block  0.021284818649291992
generate_one_block  0.017284393310546875
generate_one_block  0.018090486526489258
generate_one_block  0.01807379722595215
generate_one_block  0.018342971801757812
generate_one_block  0.018213510513305664
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04102516174316406
gen group dst list time:  0.026011228561401367
time for parepare:  0.022038698196411133
local_output_nid generation:  0.006839752197265625
local_in_edges_tensor generation:  0.018437862396240234
mini_batch_src_global generation:  0.02072620391845703
r_  generation:  0.173691987991333
local_output_nid generation:  0.009156465530395508
local_in_edges_tensor generation:  0.011621236801147461
mini_batch_src_global generation:  0.023844480514526367
r_  generation:  0.16837120056152344
local_output_nid generation:  0.009436845779418945
local_in_edges_tensor generation:  0.03506064414978027
mini_batch_src_global generation:  0.0235750675201416
r_  generation:  0.17627167701721191
local_output_nid generation:  0.009254932403564453
local_in_edges_tensor generation:  0.013025522232055664
mini_batch_src_global generation:  0.03226304054260254
r_  generation:  0.18544435501098633
local_output_nid generation:  0.014646530151367188
local_in_edges_tensor generation:  0.015370845794677734
mini_batch_src_global generation:  0.024585247039794922
r_  generation:  0.193817138671875
local_output_nid generation:  0.014493465423583984
local_in_edges_tensor generation:  0.014334678649902344
mini_batch_src_global generation:  0.027766704559326172
r_  generation:  0.19848012924194336
local_output_nid generation:  0.014713764190673828
local_in_edges_tensor generation:  0.019030094146728516
mini_batch_src_global generation:  0.031199932098388672
r_  generation:  0.18872451782226562
local_output_nid generation:  0.012915372848510742
local_in_edges_tensor generation:  0.012976646423339844
mini_batch_src_global generation:  0.02667713165283203
r_  generation:  0.18766355514526367
local_output_nid generation:  0.010432004928588867
local_in_edges_tensor generation:  0.009664058685302734
mini_batch_src_global generation:  0.025997638702392578
r_  generation:  0.1841905117034912
local_output_nid generation:  0.009934425354003906
local_in_edges_tensor generation:  0.01024174690246582
mini_batch_src_global generation:  0.0254669189453125
r_  generation:  0.18291449546813965
local_output_nid generation:  0.009669780731201172
local_in_edges_tensor generation:  0.00948190689086914
mini_batch_src_global generation:  0.02292609214782715
r_  generation:  0.21228933334350586
local_output_nid generation:  0.015089273452758789
local_in_edges_tensor generation:  0.012428522109985352
mini_batch_src_global generation:  0.026476383209228516
r_  generation:  0.21498847007751465
local_output_nid generation:  0.015213966369628906
local_in_edges_tensor generation:  0.012573480606079102
mini_batch_src_global generation:  0.031389713287353516
r_  generation:  0.1884596347808838
local_output_nid generation:  0.011727094650268555
local_in_edges_tensor generation:  0.010893106460571289
mini_batch_src_global generation:  0.023753643035888672
r_  generation:  0.18868231773376465
local_output_nid generation:  0.009943246841430664
local_in_edges_tensor generation:  0.00941777229309082
mini_batch_src_global generation:  0.034063100814819336
r_  generation:  0.18081378936767578
local_output_nid generation:  0.009820938110351562
local_in_edges_tensor generation:  0.009272336959838867
mini_batch_src_global generation:  0.026627540588378906
r_  generation:  0.19488096237182617
local_output_nid generation:  0.011979103088378906
local_in_edges_tensor generation:  0.010785818099975586
mini_batch_src_global generation:  0.023244142532348633
r_  generation:  0.17995977401733398
local_output_nid generation:  0.009288549423217773
local_in_edges_tensor generation:  0.01182413101196289
mini_batch_src_global generation:  0.022019147872924805
r_  generation:  0.17318511009216309
local_output_nid generation:  0.009618759155273438
local_in_edges_tensor generation:  0.009128332138061523
mini_batch_src_global generation:  0.0228731632232666
r_  generation:  0.1837477684020996
local_output_nid generation:  0.009334564208984375
local_in_edges_tensor generation:  0.010346412658691406
mini_batch_src_global generation:  0.022886037826538086
r_  generation:  0.23575878143310547
local_output_nid generation:  0.009837627410888672
local_in_edges_tensor generation:  0.009974479675292969
mini_batch_src_global generation:  0.024366378784179688
r_  generation:  0.1880331039428711
local_output_nid generation:  0.009882688522338867
local_in_edges_tensor generation:  0.010160446166992188
mini_batch_src_global generation:  0.023305892944335938
r_  generation:  0.18815326690673828
local_output_nid generation:  0.009587764739990234
local_in_edges_tensor generation:  0.00984501838684082
mini_batch_src_global generation:  0.023862123489379883
r_  generation:  0.1868438720703125
local_output_nid generation:  0.009542703628540039
local_in_edges_tensor generation:  0.009634733200073242
mini_batch_src_global generation:  0.02484750747680664
r_  generation:  0.18677592277526855
local_output_nid generation:  0.00950169563293457
local_in_edges_tensor generation:  0.009707212448120117
mini_batch_src_global generation:  0.035538673400878906
r_  generation:  0.18527507781982422
local_output_nid generation:  0.009804010391235352
local_in_edges_tensor generation:  0.011401653289794922
mini_batch_src_global generation:  0.024242162704467773
r_  generation:  0.19404888153076172
local_output_nid generation:  0.009804725646972656
local_in_edges_tensor generation:  0.009869098663330078
mini_batch_src_global generation:  0.02448129653930664
r_  generation:  0.1939258575439453
local_output_nid generation:  0.009234189987182617
local_in_edges_tensor generation:  0.00860905647277832
mini_batch_src_global generation:  0.022439002990722656
r_  generation:  0.18111634254455566
local_output_nid generation:  0.009485006332397461
local_in_edges_tensor generation:  0.012675285339355469
mini_batch_src_global generation:  0.023972272872924805
r_  generation:  0.1883378028869629
local_output_nid generation:  0.010246515274047852
local_in_edges_tensor generation:  0.011249780654907227
mini_batch_src_global generation:  0.02250814437866211
r_  generation:  0.1870875358581543
local_output_nid generation:  0.009529829025268555
local_in_edges_tensor generation:  0.01189875602722168
mini_batch_src_global generation:  0.02538919448852539
r_  generation:  0.1937723159790039
local_output_nid generation:  0.009912729263305664
local_in_edges_tensor generation:  0.008959293365478516
mini_batch_src_global generation:  0.023183584213256836
r_  generation:  0.18883562088012695
----------------------check_connections_block total spend ----------------------------- 8.99647307395935
generate_one_block  0.27793407440185547
generate_one_block  0.24290180206298828
generate_one_block  0.2564256191253662
generate_one_block  0.23258066177368164
generate_one_block  0.26082658767700195
generate_one_block  0.2481708526611328
generate_one_block  0.25257277488708496
generate_one_block  0.2541379928588867
generate_one_block  0.2492530345916748
generate_one_block  0.2477407455444336
generate_one_block  0.2465205192565918
generate_one_block  0.25875329971313477
generate_one_block  0.23999357223510742
generate_one_block  0.25129103660583496
generate_one_block  0.23984599113464355
generate_one_block  0.24728608131408691
generate_one_block  0.24394893646240234
generate_one_block  0.2331221103668213
generate_one_block  0.2487020492553711
generate_one_block  0.25205492973327637
generate_one_block  0.25678491592407227
generate_one_block  0.2579507827758789
generate_one_block  0.2536277770996094
generate_one_block  0.2509181499481201
generate_one_block  0.25084543228149414
generate_one_block  0.2608520984649658
generate_one_block  0.259274959564209
generate_one_block  0.23681378364562988
generate_one_block  0.25363922119140625
generate_one_block  0.2455306053161621
generate_one_block  0.24898314476013184
generate_one_block  0.24193763732910156
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04665350914001465
gen group dst list time:  0.114501953125
time for parepare:  0.01874065399169922
local_output_nid generation:  0.027337312698364258
local_in_edges_tensor generation:  0.04500150680541992
mini_batch_src_global generation:  0.03950619697570801
r_  generation:  0.4257392883300781
local_output_nid generation:  0.03117656707763672
local_in_edges_tensor generation:  0.03430819511413574
mini_batch_src_global generation:  0.04994630813598633
r_  generation:  0.4220137596130371
local_output_nid generation:  0.03154492378234863
local_in_edges_tensor generation:  0.0276186466217041
mini_batch_src_global generation:  0.04826712608337402
r_  generation:  0.43034863471984863
local_output_nid generation:  0.03133058547973633
local_in_edges_tensor generation:  0.030097007751464844
mini_batch_src_global generation:  0.05136561393737793
r_  generation:  0.42800188064575195
local_output_nid generation:  0.0313260555267334
local_in_edges_tensor generation:  0.027313947677612305
mini_batch_src_global generation:  0.04956459999084473
r_  generation:  0.4518313407897949
local_output_nid generation:  0.03146529197692871
local_in_edges_tensor generation:  0.027193784713745117
mini_batch_src_global generation:  0.05466580390930176
r_  generation:  0.438753604888916
local_output_nid generation:  0.03032660484313965
local_in_edges_tensor generation:  0.03120255470275879
mini_batch_src_global generation:  0.05036568641662598
r_  generation:  0.4422769546508789
local_output_nid generation:  0.031922340393066406
local_in_edges_tensor generation:  0.03162813186645508
mini_batch_src_global generation:  0.05070686340332031
r_  generation:  0.43591952323913574
local_output_nid generation:  0.029599666595458984
local_in_edges_tensor generation:  0.028816699981689453
mini_batch_src_global generation:  0.05201840400695801
r_  generation:  0.4414229393005371
local_output_nid generation:  0.029551029205322266
local_in_edges_tensor generation:  0.02945113182067871
mini_batch_src_global generation:  0.052617788314819336
r_  generation:  0.43874192237854004
local_output_nid generation:  0.029651165008544922
local_in_edges_tensor generation:  0.027174711227416992
mini_batch_src_global generation:  0.0520937442779541
r_  generation:  0.44338035583496094
local_output_nid generation:  0.029939889907836914
local_in_edges_tensor generation:  0.027043581008911133
mini_batch_src_global generation:  0.05100393295288086
r_  generation:  0.434859037399292
local_output_nid generation:  0.03026413917541504
local_in_edges_tensor generation:  0.034502506256103516
mini_batch_src_global generation:  0.049913644790649414
r_  generation:  0.43934178352355957
local_output_nid generation:  0.030165433883666992
local_in_edges_tensor generation:  0.02884054183959961
mini_batch_src_global generation:  0.052289485931396484
r_  generation:  0.4354255199432373
local_output_nid generation:  0.029659271240234375
local_in_edges_tensor generation:  0.03046870231628418
mini_batch_src_global generation:  0.04939842224121094
r_  generation:  0.43411779403686523
local_output_nid generation:  0.029671907424926758
local_in_edges_tensor generation:  0.030812501907348633
mini_batch_src_global generation:  0.0527801513671875
r_  generation:  0.4623563289642334
local_output_nid generation:  0.03062272071838379
local_in_edges_tensor generation:  0.02704334259033203
mini_batch_src_global generation:  0.051120758056640625
r_  generation:  0.44940185546875
local_output_nid generation:  0.03128814697265625
local_in_edges_tensor generation:  0.030063867568969727
mini_batch_src_global generation:  0.05072927474975586
r_  generation:  0.42896604537963867
local_output_nid generation:  0.030118942260742188
local_in_edges_tensor generation:  0.026804447174072266
mini_batch_src_global generation:  0.05124950408935547
r_  generation:  0.43549680709838867
local_output_nid generation:  0.030399322509765625
local_in_edges_tensor generation:  0.028851032257080078
mini_batch_src_global generation:  0.05263352394104004
r_  generation:  0.4323997497558594
local_output_nid generation:  0.030894994735717773
local_in_edges_tensor generation:  0.028018474578857422
mini_batch_src_global generation:  0.050015926361083984
r_  generation:  0.44563937187194824
local_output_nid generation:  0.030699968338012695
local_in_edges_tensor generation:  0.027338504791259766
mini_batch_src_global generation:  0.050963640213012695
r_  generation:  0.44062256813049316
local_output_nid generation:  0.030606985092163086
local_in_edges_tensor generation:  0.029134035110473633
mini_batch_src_global generation:  0.05055069923400879
r_  generation:  0.44093966484069824
local_output_nid generation:  0.030334949493408203
local_in_edges_tensor generation:  0.02689194679260254
mini_batch_src_global generation:  0.05114436149597168
r_  generation:  0.4330730438232422
local_output_nid generation:  0.0302276611328125
local_in_edges_tensor generation:  0.02710866928100586
mini_batch_src_global generation:  0.04966425895690918
r_  generation:  0.44084644317626953
local_output_nid generation:  0.030462980270385742
local_in_edges_tensor generation:  0.031293392181396484
mini_batch_src_global generation:  0.05257081985473633
r_  generation:  0.4388554096221924
local_output_nid generation:  0.030842065811157227
local_in_edges_tensor generation:  0.028794527053833008
mini_batch_src_global generation:  0.05001640319824219
r_  generation:  0.441514253616333
local_output_nid generation:  0.03192257881164551
local_in_edges_tensor generation:  0.02764153480529785
mini_batch_src_global generation:  0.051111698150634766
r_  generation:  0.4300346374511719
local_output_nid generation:  0.030481815338134766
local_in_edges_tensor generation:  0.027303695678710938
mini_batch_src_global generation:  0.05038094520568848
r_  generation:  0.436443567276001
local_output_nid generation:  0.03033590316772461
local_in_edges_tensor generation:  0.026446104049682617
mini_batch_src_global generation:  0.05266165733337402
r_  generation:  0.4341700077056885
local_output_nid generation:  0.030438661575317383
local_in_edges_tensor generation:  0.02972888946533203
mini_batch_src_global generation:  0.05067038536071777
r_  generation:  0.44098925590515137
local_output_nid generation:  0.030222415924072266
local_in_edges_tensor generation:  0.028727293014526367
mini_batch_src_global generation:  0.05115485191345215
r_  generation:  0.4341616630554199
----------------------check_connections_block total spend ----------------------------- 20.692504167556763
generate_one_block  0.6050946712493896
generate_one_block  0.5840728282928467
generate_one_block  0.5747294425964355
generate_one_block  0.5797395706176758
generate_one_block  0.687232255935669
generate_one_block  0.5849306583404541
generate_one_block  0.5835483074188232
generate_one_block  0.5843822956085205
generate_one_block  0.5828697681427002
generate_one_block  0.5853729248046875
generate_one_block  0.5876083374023438
generate_one_block  0.5826749801635742
generate_one_block  0.5784769058227539
generate_one_block  0.5855386257171631
generate_one_block  0.5793383121490479
generate_one_block  0.5819320678710938
generate_one_block  0.5849194526672363
generate_one_block  0.587533712387085
generate_one_block  0.5818324089050293
generate_one_block  0.5829999446868896
generate_one_block  0.5915136337280273
generate_one_block  0.5833749771118164
generate_one_block  0.5846560001373291
generate_one_block  0.5785095691680908
generate_one_block  0.5972216129302979
generate_one_block  0.590104341506958
generate_one_block  0.5964887142181396
generate_one_block  0.5746073722839355
generate_one_block  0.5785889625549316
generate_one_block  0.5801272392272949
generate_one_block  0.5894930362701416
generate_one_block  0.5915186405181885
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.12687349319458008  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

connection checking time:  29.688977241516113
block generation total time  26.82225275039673
average batch blocks generation time:  0.8381953984498978
block dataloader generation time/epoch 59.53844952583313
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10701608657836914  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.454484462738037  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10633230209350586  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.58074426651001  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10648155212402344  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.79233169555664  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10611677169799805  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.378657817840576  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10629653930664062  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.805001258850098  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10652780532836914  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.96936559677124  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10692310333251953  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.24750280380249  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10667848587036133  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.272376537322998  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10647296905517578  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.04023551940918  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10651206970214844  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.060710906982422  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10675716400146484  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.878230094909668  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10666847229003906  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.757208347320557  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10628223419189453  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.49617099761963  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10666370391845703  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.07532024383545  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10583066940307617  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.36814260482788  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10678958892822266  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.87707805633545  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10664606094360352  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.787962436676025  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10610151290893555  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.11812734603882  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.1063838005065918  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.772666454315186  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10656595230102539  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.695341110229492  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.1069788932800293  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.248137950897217  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10706424713134766  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.173490524291992  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.1067500114440918  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.118351936340332  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10645008087158203  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.881306648254395  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10656356811523438  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.06133270263672  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.1070241928100586  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.46570110321045  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10712671279907227  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.43318271636963  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10613679885864258  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.23847198486328  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10663938522338867  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.939985752105713  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10643959045410156  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.791935443878174  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10673332214355469  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.039098739624023  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10649728775024414  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.721172332763672  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.029220424592494965 |0.020857609808444977 |0.5537318736314774 |9.559094905853271e-05 |1.0652219578623772 |0.005314826965332031 |
----------------------------------------------------------pseudo_mini_loss sum 1.3545068502426147
Total (block generation + training)time/epoch 113.25717816750209
Training time/epoch 53.470219373703
Training time without block to device /epoch 52.802775859832764
Training time without total dataloading part /epoch 51.81489634513855
load block tensor time/epoch 0.9350535869598389
block to device time/epoch 0.6674435138702393
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 21 |
Number of nodes for computation during this epoch:  9111509
Number of first layer input nodes during this epoch:  4760639
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.12665176391601562  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026352405548095703
random selection method range initialization spend 0.0065457820892333984
time for parepare:  0.02237248420715332
local_output_nid generation:  0.0014183521270751953
local_in_edges_tensor generation:  0.0068356990814208984
mini_batch_src_global generation:  0.0023996829986572266
r_  generation:  0.010615110397338867
local_output_nid generation:  0.0016243457794189453
local_in_edges_tensor generation:  0.0010807514190673828
mini_batch_src_global generation:  0.0016536712646484375
r_  generation:  0.010386943817138672
local_output_nid generation:  0.001678466796875
local_in_edges_tensor generation:  0.0009496212005615234
mini_batch_src_global generation:  0.0012156963348388672
r_  generation:  0.009975910186767578
local_output_nid generation:  0.0016400814056396484
local_in_edges_tensor generation:  0.0009140968322753906
mini_batch_src_global generation:  0.0011355876922607422
r_  generation:  0.009764671325683594
local_output_nid generation:  0.0016033649444580078
local_in_edges_tensor generation:  0.0009038448333740234
mini_batch_src_global generation:  0.0011212825775146484
r_  generation:  0.009928703308105469
local_output_nid generation:  0.001585245132446289
local_in_edges_tensor generation:  0.0008709430694580078
mini_batch_src_global generation:  0.0011510848999023438
r_  generation:  0.010127067565917969
local_output_nid generation:  0.0015926361083984375
local_in_edges_tensor generation:  0.0009179115295410156
mini_batch_src_global generation:  0.0012042522430419922
r_  generation:  0.010654449462890625
local_output_nid generation:  0.0015730857849121094
local_in_edges_tensor generation:  0.0008978843688964844
mini_batch_src_global generation:  0.0011434555053710938
r_  generation:  0.009938478469848633
local_output_nid generation:  0.0015871524810791016
local_in_edges_tensor generation:  0.00091552734375
mini_batch_src_global generation:  0.00115203857421875
r_  generation:  0.010378837585449219
local_output_nid generation:  0.0015909671783447266
local_in_edges_tensor generation:  0.0009322166442871094
mini_batch_src_global generation:  0.0011959075927734375
r_  generation:  0.01062321662902832
local_output_nid generation:  0.0015823841094970703
local_in_edges_tensor generation:  0.0009202957153320312
mini_batch_src_global generation:  0.0011785030364990234
r_  generation:  0.01047205924987793
local_output_nid generation:  0.0015761852264404297
local_in_edges_tensor generation:  0.0009026527404785156
mini_batch_src_global generation:  0.0011637210845947266
r_  generation:  0.010304927825927734
local_output_nid generation:  0.0015859603881835938
local_in_edges_tensor generation:  0.0009171962738037109
mini_batch_src_global generation:  0.0011706352233886719
r_  generation:  0.010539054870605469
local_output_nid generation:  0.0016028881072998047
local_in_edges_tensor generation:  0.0008924007415771484
mini_batch_src_global generation:  0.0011179447174072266
r_  generation:  0.010337591171264648
local_output_nid generation:  0.0015802383422851562
local_in_edges_tensor generation:  0.0008840560913085938
mini_batch_src_global generation:  0.0011086463928222656
r_  generation:  0.010092020034790039
local_output_nid generation:  0.0015916824340820312
local_in_edges_tensor generation:  0.0009551048278808594
mini_batch_src_global generation:  0.0011289119720458984
r_  generation:  0.010180473327636719
local_output_nid generation:  0.0015895366668701172
local_in_edges_tensor generation:  0.00091552734375
mini_batch_src_global generation:  0.0011687278747558594
r_  generation:  0.010544538497924805
local_output_nid generation:  0.0016150474548339844
local_in_edges_tensor generation:  0.0008952617645263672
mini_batch_src_global generation:  0.001119375228881836
r_  generation:  0.01003885269165039
local_output_nid generation:  0.0016093254089355469
local_in_edges_tensor generation:  0.0009162425994873047
mini_batch_src_global generation:  0.0012409687042236328
r_  generation:  0.010733604431152344
local_output_nid generation:  0.001567840576171875
local_in_edges_tensor generation:  0.0009036064147949219
mini_batch_src_global generation:  0.0011365413665771484
r_  generation:  0.01020669937133789
local_output_nid generation:  0.0015697479248046875
local_in_edges_tensor generation:  0.0008866786956787109
mini_batch_src_global generation:  0.0011870861053466797
r_  generation:  0.010223627090454102
local_output_nid generation:  0.001569986343383789
local_in_edges_tensor generation:  0.000858306884765625
mini_batch_src_global generation:  0.0011281967163085938
r_  generation:  0.010228872299194336
local_output_nid generation:  0.0015609264373779297
local_in_edges_tensor generation:  0.0009045600891113281
mini_batch_src_global generation:  0.0011494159698486328
r_  generation:  0.010506868362426758
local_output_nid generation:  0.0015704631805419922
local_in_edges_tensor generation:  0.0009164810180664062
mini_batch_src_global generation:  0.0012309551239013672
r_  generation:  0.010539770126342773
local_output_nid generation:  0.00157928466796875
local_in_edges_tensor generation:  0.0008997917175292969
mini_batch_src_global generation:  0.0010998249053955078
r_  generation:  0.010005712509155273
local_output_nid generation:  0.0015909671783447266
local_in_edges_tensor generation:  0.0009150505065917969
mini_batch_src_global generation:  0.001222372055053711
r_  generation:  0.010890960693359375
local_output_nid generation:  0.0015926361083984375
local_in_edges_tensor generation:  0.0009784698486328125
mini_batch_src_global generation:  0.0012140274047851562
r_  generation:  0.010273218154907227
local_output_nid generation:  0.001596212387084961
local_in_edges_tensor generation:  0.0009036064147949219
mini_batch_src_global generation:  0.0011491775512695312
r_  generation:  0.010257959365844727
local_output_nid generation:  0.0015914440155029297
local_in_edges_tensor generation:  0.0008690357208251953
mini_batch_src_global generation:  0.0011539459228515625
r_  generation:  0.01045536994934082
local_output_nid generation:  0.0015735626220703125
local_in_edges_tensor generation:  0.0009016990661621094
mini_batch_src_global generation:  0.0012578964233398438
r_  generation:  0.010371685028076172
local_output_nid generation:  0.0016336441040039062
local_in_edges_tensor generation:  0.0009059906005859375
mini_batch_src_global generation:  0.0012123584747314453
r_  generation:  0.010718107223510742
local_output_nid generation:  0.0016064643859863281
local_in_edges_tensor generation:  0.0008919239044189453
mini_batch_src_global generation:  0.001117706298828125
r_  generation:  0.009861946105957031
----------------------check_connections_block total spend ----------------------------- 0.5736892223358154
generate_one_block  0.0240936279296875
generate_one_block  0.02142190933227539
generate_one_block  0.018999099731445312
generate_one_block  0.018254995346069336
generate_one_block  0.018259048461914062
generate_one_block  0.01818060874938965
generate_one_block  0.018936872482299805
generate_one_block  0.017915010452270508
generate_one_block  0.018682003021240234
generate_one_block  0.01915264129638672
generate_one_block  0.018462181091308594
generate_one_block  0.02111673355102539
generate_one_block  0.02094292640686035
generate_one_block  0.018325090408325195
generate_one_block  0.017743587493896484
generate_one_block  0.01811838150024414
generate_one_block  0.018502235412597656
generate_one_block  0.01770806312561035
generate_one_block  0.019166946411132812
generate_one_block  0.018424510955810547
generate_one_block  0.0180206298828125
generate_one_block  0.018056631088256836
generate_one_block  0.018401145935058594
generate_one_block  0.018595457077026367
generate_one_block  0.017481327056884766
generate_one_block  0.01909923553466797
generate_one_block  0.017975568771362305
generate_one_block  0.018101930618286133
generate_one_block  0.018042564392089844
generate_one_block  0.01826167106628418
generate_one_block  0.018675565719604492
generate_one_block  0.01750636100769043
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03842973709106445
gen group dst list time:  0.022866249084472656
time for parepare:  0.022458314895629883
local_output_nid generation:  0.006390571594238281
local_in_edges_tensor generation:  0.01816248893737793
mini_batch_src_global generation:  0.017409563064575195
r_  generation:  0.1617591381072998
local_output_nid generation:  0.009433984756469727
local_in_edges_tensor generation:  0.012115240097045898
mini_batch_src_global generation:  0.020650625228881836
r_  generation:  0.17129731178283691
local_output_nid generation:  0.009321928024291992
local_in_edges_tensor generation:  0.03283214569091797
mini_batch_src_global generation:  0.01992964744567871
r_  generation:  0.17207932472229004
local_output_nid generation:  0.009401321411132812
local_in_edges_tensor generation:  0.009859323501586914
mini_batch_src_global generation:  0.020117521286010742
r_  generation:  0.20763087272644043
local_output_nid generation:  0.01523590087890625
local_in_edges_tensor generation:  0.015620946884155273
mini_batch_src_global generation:  0.026677370071411133
r_  generation:  0.2011735439300537
local_output_nid generation:  0.014982461929321289
local_in_edges_tensor generation:  0.014954328536987305
mini_batch_src_global generation:  0.025469064712524414
r_  generation:  0.1994621753692627
local_output_nid generation:  0.015354156494140625
local_in_edges_tensor generation:  0.016806364059448242
mini_batch_src_global generation:  0.028077363967895508
r_  generation:  0.20902752876281738
local_output_nid generation:  0.01497650146484375
local_in_edges_tensor generation:  0.013248920440673828
mini_batch_src_global generation:  0.026770353317260742
r_  generation:  0.19925594329833984
local_output_nid generation:  0.015254020690917969
local_in_edges_tensor generation:  0.019251108169555664
mini_batch_src_global generation:  0.030722856521606445
r_  generation:  0.18512701988220215
local_output_nid generation:  0.013848304748535156
local_in_edges_tensor generation:  0.011417150497436523
mini_batch_src_global generation:  0.02469778060913086
r_  generation:  0.18958544731140137
local_output_nid generation:  0.010927200317382812
local_in_edges_tensor generation:  0.010538816452026367
mini_batch_src_global generation:  0.024082422256469727
r_  generation:  0.18654894828796387
local_output_nid generation:  0.010041475296020508
local_in_edges_tensor generation:  0.009611129760742188
mini_batch_src_global generation:  0.022723913192749023
r_  generation:  0.18323493003845215
local_output_nid generation:  0.010027885437011719
local_in_edges_tensor generation:  0.009136676788330078
mini_batch_src_global generation:  0.026334524154663086
r_  generation:  0.1939537525177002
local_output_nid generation:  0.009628534317016602
local_in_edges_tensor generation:  0.01360630989074707
mini_batch_src_global generation:  0.023752212524414062
r_  generation:  0.18468117713928223
local_output_nid generation:  0.01040792465209961
local_in_edges_tensor generation:  0.012371540069580078
mini_batch_src_global generation:  0.023238420486450195
r_  generation:  0.18492770195007324
local_output_nid generation:  0.009420156478881836
local_in_edges_tensor generation:  0.010470867156982422
mini_batch_src_global generation:  0.022531747817993164
r_  generation:  0.18955659866333008
local_output_nid generation:  0.009549140930175781
local_in_edges_tensor generation:  0.011934995651245117
mini_batch_src_global generation:  0.0245206356048584
r_  generation:  0.18889522552490234
local_output_nid generation:  0.009286642074584961
local_in_edges_tensor generation:  0.012039899826049805
mini_batch_src_global generation:  0.0261688232421875
r_  generation:  0.18032050132751465
local_output_nid generation:  0.009660959243774414
local_in_edges_tensor generation:  0.010001897811889648
mini_batch_src_global generation:  0.02469491958618164
r_  generation:  0.18628716468811035
local_output_nid generation:  0.009369611740112305
local_in_edges_tensor generation:  0.009290456771850586
mini_batch_src_global generation:  0.02375316619873047
r_  generation:  0.1813044548034668
local_output_nid generation:  0.009369850158691406
local_in_edges_tensor generation:  0.00916433334350586
mini_batch_src_global generation:  0.022886276245117188
r_  generation:  0.18128418922424316
local_output_nid generation:  0.009408235549926758
local_in_edges_tensor generation:  0.00927281379699707
mini_batch_src_global generation:  0.023625612258911133
r_  generation:  0.18378639221191406
local_output_nid generation:  0.009490966796875
local_in_edges_tensor generation:  0.01005244255065918
mini_batch_src_global generation:  0.024310588836669922
r_  generation:  0.18285584449768066
local_output_nid generation:  0.009670019149780273
local_in_edges_tensor generation:  0.009986162185668945
mini_batch_src_global generation:  0.02468132972717285
r_  generation:  0.1908271312713623
local_output_nid generation:  0.009141683578491211
local_in_edges_tensor generation:  0.009702920913696289
mini_batch_src_global generation:  0.023174285888671875
r_  generation:  0.1795666217803955
local_output_nid generation:  0.009819507598876953
local_in_edges_tensor generation:  0.00974130630493164
mini_batch_src_global generation:  0.02696990966796875
r_  generation:  0.20337486267089844
local_output_nid generation:  0.011729717254638672
local_in_edges_tensor generation:  0.009365081787109375
mini_batch_src_global generation:  0.023718595504760742
r_  generation:  0.2166435718536377
local_output_nid generation:  0.009459972381591797
local_in_edges_tensor generation:  0.009734630584716797
mini_batch_src_global generation:  0.023220300674438477
r_  generation:  0.18269681930541992
local_output_nid generation:  0.009524106979370117
local_in_edges_tensor generation:  0.009737253189086914
mini_batch_src_global generation:  0.022944927215576172
r_  generation:  0.1827223300933838
local_output_nid generation:  0.0096588134765625
local_in_edges_tensor generation:  0.009881973266601562
mini_batch_src_global generation:  0.023397207260131836
r_  generation:  0.18632888793945312
local_output_nid generation:  0.009699106216430664
local_in_edges_tensor generation:  0.010742664337158203
mini_batch_src_global generation:  0.023682832717895508
r_  generation:  0.19094443321228027
local_output_nid generation:  0.00933694839477539
local_in_edges_tensor generation:  0.009061813354492188
mini_batch_src_global generation:  0.022633075714111328
r_  generation:  0.1759185791015625
----------------------check_connections_block total spend ----------------------------- 8.886965274810791
generate_one_block  0.2508859634399414
generate_one_block  0.24337077140808105
generate_one_block  0.23812460899353027
generate_one_block  0.24239277839660645
generate_one_block  0.2599480152130127
generate_one_block  0.24270844459533691
generate_one_block  0.25356101989746094
generate_one_block  0.24198603630065918
generate_one_block  0.25509095191955566
generate_one_block  0.26044344902038574
generate_one_block  0.2518773078918457
generate_one_block  0.24338245391845703
generate_one_block  0.2525303363800049
generate_one_block  0.24158477783203125
generate_one_block  0.23905086517333984
generate_one_block  0.24250125885009766
generate_one_block  0.2488410472869873
generate_one_block  0.24988102912902832
generate_one_block  0.25382041931152344
generate_one_block  0.2498328685760498
generate_one_block  0.24062252044677734
generate_one_block  0.2471153736114502
generate_one_block  0.24866700172424316
generate_one_block  0.25456929206848145
generate_one_block  0.23482227325439453
generate_one_block  0.25887608528137207
generate_one_block  0.24484515190124512
generate_one_block  0.24458718299865723
generate_one_block  0.2459697723388672
generate_one_block  0.24771881103515625
generate_one_block  0.25476789474487305
generate_one_block  0.23380446434020996
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.038034915924072266
gen group dst list time:  0.11251521110534668
time for parepare:  0.02027297019958496
local_output_nid generation:  0.026369810104370117
local_in_edges_tensor generation:  0.04881477355957031
mini_batch_src_global generation:  0.039069414138793945
r_  generation:  0.4340982437133789
local_output_nid generation:  0.0321807861328125
local_in_edges_tensor generation:  0.0387425422668457
mini_batch_src_global generation:  0.050275325775146484
r_  generation:  0.42998194694519043
local_output_nid generation:  0.0321040153503418
local_in_edges_tensor generation:  0.03854846954345703
mini_batch_src_global generation:  0.04823422431945801
r_  generation:  0.44690465927124023
local_output_nid generation:  0.03450918197631836
local_in_edges_tensor generation:  0.03081369400024414
mini_batch_src_global generation:  0.04983782768249512
r_  generation:  0.4306313991546631
local_output_nid generation:  0.03242635726928711
local_in_edges_tensor generation:  0.03002619743347168
mini_batch_src_global generation:  0.04927349090576172
r_  generation:  0.4365098476409912
local_output_nid generation:  0.032401323318481445
local_in_edges_tensor generation:  0.027324438095092773
mini_batch_src_global generation:  0.05107855796813965
r_  generation:  0.43404364585876465
local_output_nid generation:  0.031319618225097656
local_in_edges_tensor generation:  0.031096696853637695
mini_batch_src_global generation:  0.04960489273071289
r_  generation:  0.45601439476013184
local_output_nid generation:  0.03081965446472168
local_in_edges_tensor generation:  0.026610374450683594
mini_batch_src_global generation:  0.05063676834106445
r_  generation:  0.4363584518432617
local_output_nid generation:  0.0304257869720459
local_in_edges_tensor generation:  0.0324094295501709
mini_batch_src_global generation:  0.049961090087890625
r_  generation:  0.4396817684173584
local_output_nid generation:  0.030737876892089844
local_in_edges_tensor generation:  0.031751394271850586
mini_batch_src_global generation:  0.05355715751647949
r_  generation:  0.4421567916870117
local_output_nid generation:  0.030978679656982422
local_in_edges_tensor generation:  0.03308844566345215
mini_batch_src_global generation:  0.0518341064453125
r_  generation:  0.4455721378326416
local_output_nid generation:  0.03035569190979004
local_in_edges_tensor generation:  0.03593158721923828
mini_batch_src_global generation:  0.05083966255187988
r_  generation:  0.44254064559936523
local_output_nid generation:  0.03337407112121582
local_in_edges_tensor generation:  0.03548240661621094
mini_batch_src_global generation:  0.04937434196472168
r_  generation:  0.4539661407470703
local_output_nid generation:  0.031052350997924805
local_in_edges_tensor generation:  0.026811599731445312
mini_batch_src_global generation:  0.052498817443847656
r_  generation:  0.43401432037353516
local_output_nid generation:  0.031128644943237305
local_in_edges_tensor generation:  0.03253650665283203
mini_batch_src_global generation:  0.0496063232421875
r_  generation:  0.4362833499908447
local_output_nid generation:  0.030292034149169922
local_in_edges_tensor generation:  0.027083873748779297
mini_batch_src_global generation:  0.050501108169555664
r_  generation:  0.4396183490753174
local_output_nid generation:  0.03047943115234375
local_in_edges_tensor generation:  0.030426979064941406
mini_batch_src_global generation:  0.04938244819641113
r_  generation:  0.4392876625061035
local_output_nid generation:  0.03024005889892578
local_in_edges_tensor generation:  0.027013063430786133
mini_batch_src_global generation:  0.05119657516479492
r_  generation:  0.43236494064331055
local_output_nid generation:  0.030772686004638672
local_in_edges_tensor generation:  0.029315471649169922
mini_batch_src_global generation:  0.05147671699523926
r_  generation:  0.44488096237182617
local_output_nid generation:  0.030550003051757812
local_in_edges_tensor generation:  0.028392791748046875
mini_batch_src_global generation:  0.050889015197753906
r_  generation:  0.43553924560546875
local_output_nid generation:  0.030085086822509766
local_in_edges_tensor generation:  0.028599262237548828
mini_batch_src_global generation:  0.05139946937561035
r_  generation:  0.4344751834869385
local_output_nid generation:  0.030406951904296875
local_in_edges_tensor generation:  0.027024507522583008
mini_batch_src_global generation:  0.0498356819152832
r_  generation:  0.4446449279785156
local_output_nid generation:  0.030555009841918945
local_in_edges_tensor generation:  0.030771970748901367
mini_batch_src_global generation:  0.05058431625366211
r_  generation:  0.4396045207977295
local_output_nid generation:  0.030714988708496094
local_in_edges_tensor generation:  0.02742934226989746
mini_batch_src_global generation:  0.050696372985839844
r_  generation:  0.4384496212005615
local_output_nid generation:  0.030214786529541016
local_in_edges_tensor generation:  0.02893376350402832
mini_batch_src_global generation:  0.049794673919677734
r_  generation:  0.4343910217285156
local_output_nid generation:  0.030604839324951172
local_in_edges_tensor generation:  0.02924370765686035
mini_batch_src_global generation:  0.0528261661529541
r_  generation:  0.450728178024292
local_output_nid generation:  0.03256702423095703
local_in_edges_tensor generation:  0.028695106506347656
mini_batch_src_global generation:  0.05582690238952637
r_  generation:  0.448514461517334
local_output_nid generation:  0.03072190284729004
local_in_edges_tensor generation:  0.02946162223815918
mini_batch_src_global generation:  0.05334758758544922
r_  generation:  0.44727063179016113
local_output_nid generation:  0.030330657958984375
local_in_edges_tensor generation:  0.03441929817199707
mini_batch_src_global generation:  0.05343985557556152
r_  generation:  0.4450862407684326
local_output_nid generation:  0.03170371055603027
local_in_edges_tensor generation:  0.0356903076171875
mini_batch_src_global generation:  0.059366703033447266
r_  generation:  0.44571375846862793
local_output_nid generation:  0.031781673431396484
local_in_edges_tensor generation:  0.03303980827331543
mini_batch_src_global generation:  0.04963254928588867
r_  generation:  0.443117618560791
local_output_nid generation:  0.03026103973388672
local_in_edges_tensor generation:  0.03116297721862793
mini_batch_src_global generation:  0.050446510314941406
r_  generation:  0.43843746185302734
----------------------check_connections_block total spend ----------------------------- 20.900023937225342
generate_one_block  0.5949244499206543
generate_one_block  0.607213020324707
generate_one_block  0.5873639583587646
generate_one_block  0.5877213478088379
generate_one_block  0.7027482986450195
generate_one_block  0.5953805446624756
generate_one_block  0.5978691577911377
generate_one_block  0.5873556137084961
generate_one_block  0.5892705917358398
generate_one_block  0.5907256603240967
generate_one_block  0.5820729732513428
generate_one_block  0.5762383937835693
generate_one_block  0.5838837623596191
generate_one_block  0.5761702060699463
generate_one_block  0.5855765342712402
generate_one_block  0.5949907302856445
generate_one_block  0.5871574878692627
generate_one_block  0.5845730304718018
generate_one_block  0.5879707336425781
generate_one_block  0.5853843688964844
generate_one_block  0.5852751731872559
generate_one_block  0.5891458988189697
generate_one_block  0.5885457992553711
generate_one_block  0.5947713851928711
generate_one_block  0.596717357635498
generate_one_block  0.5944335460662842
generate_one_block  0.5851657390594482
generate_one_block  0.5904858112335205
generate_one_block  0.5819032192230225
generate_one_block  0.6001453399658203
generate_one_block  0.5930342674255371
generate_one_block  0.576103687286377
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.12665176391601562  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

connection checking time:  29.786989212036133
block generation total time  26.878498315811157
average batch blocks generation time:  0.8399530723690987
block dataloader generation time/epoch 59.578865656485924
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10644817352294922  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.608006477355957  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10647869110107422  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.63461971282959  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10648822784423828  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.60880470275879  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10657882690429688  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.772579193115234  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10665750503540039  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.876928329467773  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10644245147705078  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.836398601531982  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10666561126708984  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.312238216400146  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10630464553833008  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.699593544006348  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10651206970214844  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.00849199295044  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.1071624755859375  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.487308979034424  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10674047470092773  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.203474521636963  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10653257369995117  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.768518447875977  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10698556900024414  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.273757457733154  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10641145706176758  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.660417556762695  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.1066584587097168  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.645939350128174  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10645008087158203  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.77433490753174  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10689592361450195  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.066709995269775  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10623741149902344  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.59482192993164  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10689592361450195  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.193445682525635  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10663461685180664  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.806589603424072  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10628843307495117  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.64005756378174  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.1065969467163086  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.972476482391357  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.1066732406616211  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.033530712127686  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10690927505493164  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.319894313812256  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10615110397338867  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.352005004882812  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10689830780029297  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.441301345825195  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10676765441894531  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.88218402862549  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10642480850219727  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.805986881256104  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10641622543334961  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.894370079040527  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10692691802978516  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.067400455474854  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10711002349853516  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.320809841156006  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.1060938835144043  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.361201763153076  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.034960485994815826 |0.022517748177051544 |0.5568630024790764 |9.504705667495728e-05 |1.0693288743495941 |0.008243560791015625 |
----------------------------------------------------------pseudo_mini_loss sum 1.3339009284973145
Total (block generation + training)time/epoch 113.31468356572665
Training time/epoch 53.940523862838745
Training time without block to device /epoch 53.219955921173096
Training time without total dataloading part /epoch 52.04942512512207
load block tensor time/epoch 1.1187355518341064
block to device time/epoch 0.7205679416656494
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 22 |
Number of nodes for computation during this epoch:  9113814
Number of first layer input nodes during this epoch:  4762345
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.1258859634399414  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02425837516784668
random selection method range initialization spend 0.0056993961334228516
time for parepare:  0.021669864654541016
local_output_nid generation:  0.0014188289642333984
local_in_edges_tensor generation:  0.010397672653198242
mini_batch_src_global generation:  0.0018188953399658203
r_  generation:  0.010347843170166016
local_output_nid generation:  0.0016770362854003906
local_in_edges_tensor generation:  0.001085519790649414
mini_batch_src_global generation:  0.0016491413116455078
r_  generation:  0.010159730911254883
local_output_nid generation:  0.0016193389892578125
local_in_edges_tensor generation:  0.0009891986846923828
mini_batch_src_global generation:  0.00119781494140625
r_  generation:  0.010143756866455078
local_output_nid generation:  0.0016031265258789062
local_in_edges_tensor generation:  0.0009791851043701172
mini_batch_src_global generation:  0.0011703968048095703
r_  generation:  0.010017871856689453
local_output_nid generation:  0.0016095638275146484
local_in_edges_tensor generation:  0.0009653568267822266
mini_batch_src_global generation:  0.0011382102966308594
r_  generation:  0.009979486465454102
local_output_nid generation:  0.0015850067138671875
local_in_edges_tensor generation:  0.0009322166442871094
mini_batch_src_global generation:  0.0011305809020996094
r_  generation:  0.009904146194458008
local_output_nid generation:  0.001600503921508789
local_in_edges_tensor generation:  0.0009341239929199219
mini_batch_src_global generation:  0.0011410713195800781
r_  generation:  0.009989023208618164
local_output_nid generation:  0.001577138900756836
local_in_edges_tensor generation:  0.0009500980377197266
mini_batch_src_global generation:  0.0011491775512695312
r_  generation:  0.010233879089355469
local_output_nid generation:  0.001580953598022461
local_in_edges_tensor generation:  0.0009367465972900391
mini_batch_src_global generation:  0.0011224746704101562
r_  generation:  0.01026463508605957
local_output_nid generation:  0.0015702247619628906
local_in_edges_tensor generation:  0.0008955001831054688
mini_batch_src_global generation:  0.0011394023895263672
r_  generation:  0.009844541549682617
local_output_nid generation:  0.0015745162963867188
local_in_edges_tensor generation:  0.0009176731109619141
mini_batch_src_global generation:  0.0011098384857177734
r_  generation:  0.010288000106811523
local_output_nid generation:  0.0015680789947509766
local_in_edges_tensor generation:  0.0009284019470214844
mini_batch_src_global generation:  0.0011899471282958984
r_  generation:  0.01057291030883789
local_output_nid generation:  0.0015811920166015625
local_in_edges_tensor generation:  0.0009057521820068359
mini_batch_src_global generation:  0.001199960708618164
r_  generation:  0.010360479354858398
local_output_nid generation:  0.0015749931335449219
local_in_edges_tensor generation:  0.0009145736694335938
mini_batch_src_global generation:  0.0011386871337890625
r_  generation:  0.010082006454467773
local_output_nid generation:  0.0015821456909179688
local_in_edges_tensor generation:  0.0009028911590576172
mini_batch_src_global generation:  0.0011098384857177734
r_  generation:  0.01000356674194336
local_output_nid generation:  0.001581430435180664
local_in_edges_tensor generation:  0.0009238719940185547
mini_batch_src_global generation:  0.001209259033203125
r_  generation:  0.010353803634643555
local_output_nid generation:  0.0015954971313476562
local_in_edges_tensor generation:  0.0009191036224365234
mini_batch_src_global generation:  0.0011391639709472656
r_  generation:  0.010234594345092773
local_output_nid generation:  0.0015969276428222656
local_in_edges_tensor generation:  0.0009162425994873047
mini_batch_src_global generation:  0.0011861324310302734
r_  generation:  0.010631799697875977
local_output_nid generation:  0.001583099365234375
local_in_edges_tensor generation:  0.0009179115295410156
mini_batch_src_global generation:  0.0011718273162841797
r_  generation:  0.010290384292602539
local_output_nid generation:  0.001573801040649414
local_in_edges_tensor generation:  0.0009226799011230469
mini_batch_src_global generation:  0.0011589527130126953
r_  generation:  0.010473251342773438
local_output_nid generation:  0.0015909671783447266
local_in_edges_tensor generation:  0.0009253025054931641
mini_batch_src_global generation:  0.0012159347534179688
r_  generation:  0.010275840759277344
local_output_nid generation:  0.0015950202941894531
local_in_edges_tensor generation:  0.0008914470672607422
mini_batch_src_global generation:  0.0011606216430664062
r_  generation:  0.010501623153686523
local_output_nid generation:  0.0015654563903808594
local_in_edges_tensor generation:  0.0009119510650634766
mini_batch_src_global generation:  0.0011777877807617188
r_  generation:  0.010507583618164062
local_output_nid generation:  0.0015919208526611328
local_in_edges_tensor generation:  0.0009183883666992188
mini_batch_src_global generation:  0.0011408329010009766
r_  generation:  0.01008462905883789
local_output_nid generation:  0.0015878677368164062
local_in_edges_tensor generation:  0.0009062290191650391
mini_batch_src_global generation:  0.0011780261993408203
r_  generation:  0.010504484176635742
local_output_nid generation:  0.0015769004821777344
local_in_edges_tensor generation:  0.0009098052978515625
mini_batch_src_global generation:  0.0011403560638427734
r_  generation:  0.010113954544067383
local_output_nid generation:  0.0015726089477539062
local_in_edges_tensor generation:  0.0008835792541503906
mini_batch_src_global generation:  0.0011260509490966797
r_  generation:  0.010497570037841797
local_output_nid generation:  0.001573324203491211
local_in_edges_tensor generation:  0.0008947849273681641
mini_batch_src_global generation:  0.0012171268463134766
r_  generation:  0.010240554809570312
local_output_nid generation:  0.0015680789947509766
local_in_edges_tensor generation:  0.0009219646453857422
mini_batch_src_global generation:  0.0011749267578125
r_  generation:  0.010152816772460938
local_output_nid generation:  0.0015769004821777344
local_in_edges_tensor generation:  0.0009222030639648438
mini_batch_src_global generation:  0.0011818408966064453
r_  generation:  0.010652542114257812
local_output_nid generation:  0.0015888214111328125
local_in_edges_tensor generation:  0.0009124279022216797
mini_batch_src_global generation:  0.0011510848999023438
r_  generation:  0.010098457336425781
local_output_nid generation:  0.0015745162963867188
local_in_edges_tensor generation:  0.00089263916015625
mini_batch_src_global generation:  0.0011544227600097656
r_  generation:  0.010267257690429688
----------------------check_connections_block total spend ----------------------------- 0.5744106769561768
generate_one_block  0.027721405029296875
generate_one_block  0.02096104621887207
generate_one_block  0.019434690475463867
generate_one_block  0.01871633529663086
generate_one_block  0.01844167709350586
generate_one_block  0.01804637908935547
generate_one_block  0.01789999008178711
generate_one_block  0.018555164337158203
generate_one_block  0.01821613311767578
generate_one_block  0.017635107040405273
generate_one_block  0.018337249755859375
generate_one_block  0.021805524826049805
generate_one_block  0.019217252731323242
generate_one_block  0.01809406280517578
generate_one_block  0.017734766006469727
generate_one_block  0.018522024154663086
generate_one_block  0.01794719696044922
generate_one_block  0.018753767013549805
generate_one_block  0.018111467361450195
generate_one_block  0.01852893829345703
generate_one_block  0.01829695701599121
generate_one_block  0.01850605010986328
generate_one_block  0.018663883209228516
generate_one_block  0.017787456512451172
generate_one_block  0.01855921745300293
generate_one_block  0.017887353897094727
generate_one_block  0.0184934139251709
generate_one_block  0.018184423446655273
generate_one_block  0.01763916015625
generate_one_block  0.018893718719482422
generate_one_block  0.017740249633789062
generate_one_block  0.018278121948242188
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03889203071594238
gen group dst list time:  0.02333211898803711
time for parepare:  0.02174687385559082
local_output_nid generation:  0.006198406219482422
local_in_edges_tensor generation:  0.020549535751342773
mini_batch_src_global generation:  0.017628908157348633
r_  generation:  0.15949249267578125
local_output_nid generation:  0.00907754898071289
local_in_edges_tensor generation:  0.011957883834838867
mini_batch_src_global generation:  0.0218350887298584
r_  generation:  0.16643309593200684
local_output_nid generation:  0.00956273078918457
local_in_edges_tensor generation:  0.034929752349853516
mini_batch_src_global generation:  0.021252870559692383
r_  generation:  0.17309260368347168
local_output_nid generation:  0.009469747543334961
local_in_edges_tensor generation:  0.010632753372192383
mini_batch_src_global generation:  0.022623062133789062
r_  generation:  0.18169665336608887
local_output_nid generation:  0.009357690811157227
local_in_edges_tensor generation:  0.00934290885925293
mini_batch_src_global generation:  0.02465677261352539
r_  generation:  0.17707395553588867
local_output_nid generation:  0.008785247802734375
local_in_edges_tensor generation:  0.008978843688964844
mini_batch_src_global generation:  0.02221536636352539
r_  generation:  0.1765296459197998
local_output_nid generation:  0.008822441101074219
local_in_edges_tensor generation:  0.008981466293334961
mini_batch_src_global generation:  0.022951126098632812
r_  generation:  0.1768507957458496
local_output_nid generation:  0.009127616882324219
local_in_edges_tensor generation:  0.012450695037841797
mini_batch_src_global generation:  0.026957273483276367
r_  generation:  0.18546295166015625
local_output_nid generation:  0.009050130844116211
local_in_edges_tensor generation:  0.009252548217773438
mini_batch_src_global generation:  0.02323436737060547
r_  generation:  0.17878007888793945
local_output_nid generation:  0.009256601333618164
local_in_edges_tensor generation:  0.009756326675415039
mini_batch_src_global generation:  0.02192234992980957
r_  generation:  0.17249631881713867
local_output_nid generation:  0.009476900100708008
local_in_edges_tensor generation:  0.009175539016723633
mini_batch_src_global generation:  0.023209095001220703
r_  generation:  0.1836235523223877
local_output_nid generation:  0.009726285934448242
local_in_edges_tensor generation:  0.00921320915222168
mini_batch_src_global generation:  0.02372288703918457
r_  generation:  0.18546032905578613
local_output_nid generation:  0.009559869766235352
local_in_edges_tensor generation:  0.009293079376220703
mini_batch_src_global generation:  0.023619651794433594
r_  generation:  0.1816556453704834
local_output_nid generation:  0.009468793869018555
local_in_edges_tensor generation:  0.009215116500854492
mini_batch_src_global generation:  0.02244734764099121
r_  generation:  0.1791684627532959
local_output_nid generation:  0.009247779846191406
local_in_edges_tensor generation:  0.008935213088989258
mini_batch_src_global generation:  0.022535324096679688
r_  generation:  0.17695116996765137
local_output_nid generation:  0.009525775909423828
local_in_edges_tensor generation:  0.010035276412963867
mini_batch_src_global generation:  0.02409195899963379
r_  generation:  0.1833782196044922
local_output_nid generation:  0.009204864501953125
local_in_edges_tensor generation:  0.009531497955322266
mini_batch_src_global generation:  0.022910594940185547
r_  generation:  0.17865586280822754
local_output_nid generation:  0.009816646575927734
local_in_edges_tensor generation:  0.010043144226074219
mini_batch_src_global generation:  0.024426937103271484
r_  generation:  0.18614745140075684
local_output_nid generation:  0.009492635726928711
local_in_edges_tensor generation:  0.009579658508300781
mini_batch_src_global generation:  0.023044109344482422
r_  generation:  0.18189215660095215
local_output_nid generation:  0.009694814682006836
local_in_edges_tensor generation:  0.009540796279907227
mini_batch_src_global generation:  0.023044109344482422
r_  generation:  0.1827411651611328
local_output_nid generation:  0.009622335433959961
local_in_edges_tensor generation:  0.009898900985717773
mini_batch_src_global generation:  0.023320913314819336
r_  generation:  0.18227148056030273
local_output_nid generation:  0.011131525039672852
local_in_edges_tensor generation:  0.00990152359008789
mini_batch_src_global generation:  0.023085594177246094
r_  generation:  0.1802995204925537
local_output_nid generation:  0.009807825088500977
local_in_edges_tensor generation:  0.009966611862182617
mini_batch_src_global generation:  0.023679256439208984
r_  generation:  0.18558692932128906
local_output_nid generation:  0.00931406021118164
local_in_edges_tensor generation:  0.00951242446899414
mini_batch_src_global generation:  0.022791385650634766
r_  generation:  0.1785261631011963
local_output_nid generation:  0.009704828262329102
local_in_edges_tensor generation:  0.00975346565246582
mini_batch_src_global generation:  0.02331089973449707
r_  generation:  0.18220305442810059
local_output_nid generation:  0.009332656860351562
local_in_edges_tensor generation:  0.008975744247436523
mini_batch_src_global generation:  0.022954940795898438
r_  generation:  0.18306231498718262
local_output_nid generation:  0.009554624557495117
local_in_edges_tensor generation:  0.009090900421142578
mini_batch_src_global generation:  0.02285146713256836
r_  generation:  0.18300604820251465
local_output_nid generation:  0.009557723999023438
local_in_edges_tensor generation:  0.011222124099731445
mini_batch_src_global generation:  0.023336410522460938
r_  generation:  0.18471598625183105
local_output_nid generation:  0.00923013687133789
local_in_edges_tensor generation:  0.00900578498840332
mini_batch_src_global generation:  0.022519350051879883
r_  generation:  0.17662811279296875
local_output_nid generation:  0.00963282585144043
local_in_edges_tensor generation:  0.009361028671264648
mini_batch_src_global generation:  0.023672103881835938
r_  generation:  0.18777775764465332
local_output_nid generation:  0.00925898551940918
local_in_edges_tensor generation:  0.008660554885864258
mini_batch_src_global generation:  0.022881746292114258
r_  generation:  0.17947840690612793
local_output_nid generation:  0.00957345962524414
local_in_edges_tensor generation:  0.009688138961791992
mini_batch_src_global generation:  0.022839784622192383
r_  generation:  0.18520545959472656
----------------------check_connections_block total spend ----------------------------- 8.455633163452148
generate_one_block  0.23584580421447754
generate_one_block  0.23974132537841797
generate_one_block  0.24641776084899902
generate_one_block  0.24988746643066406
generate_one_block  0.26021909713745117
generate_one_block  0.2424182891845703
generate_one_block  0.24321365356445312
generate_one_block  0.2546558380126953
generate_one_block  0.24288702011108398
generate_one_block  0.23233485221862793
generate_one_block  0.2481377124786377
generate_one_block  0.25115489959716797
generate_one_block  0.2448253631591797
generate_one_block  0.24057984352111816
generate_one_block  0.23696422576904297
generate_one_block  0.25091552734375
generate_one_block  0.2405550479888916
generate_one_block  0.256040096282959
generate_one_block  0.24489331245422363
generate_one_block  0.2541975975036621
generate_one_block  0.25002551078796387
generate_one_block  0.24434256553649902
generate_one_block  0.25143933296203613
generate_one_block  0.2411653995513916
generate_one_block  0.2469482421875
generate_one_block  0.248093843460083
generate_one_block  0.24491643905639648
generate_one_block  0.25304317474365234
generate_one_block  0.23674368858337402
generate_one_block  0.2548084259033203
generate_one_block  0.24010396003723145
generate_one_block  0.2458970546722412
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03576326370239258
gen group dst list time:  0.10619187355041504
time for parepare:  0.020219087600708008
local_output_nid generation:  0.0251615047454834
local_in_edges_tensor generation:  0.04210972785949707
mini_batch_src_global generation:  0.038681983947753906
r_  generation:  0.42004871368408203
local_output_nid generation:  0.03141427040100098
local_in_edges_tensor generation:  0.034951210021972656
mini_batch_src_global generation:  0.04956936836242676
r_  generation:  0.42421483993530273
local_output_nid generation:  0.031923770904541016
local_in_edges_tensor generation:  0.030190706253051758
mini_batch_src_global generation:  0.04807114601135254
r_  generation:  0.4329512119293213
local_output_nid generation:  0.03178524971008301
local_in_edges_tensor generation:  0.03011918067932129
mini_batch_src_global generation:  0.051743268966674805
r_  generation:  0.4290964603424072
local_output_nid generation:  0.03173184394836426
local_in_edges_tensor generation:  0.027849674224853516
mini_batch_src_global generation:  0.04975175857543945
r_  generation:  0.43819189071655273
local_output_nid generation:  0.03155994415283203
local_in_edges_tensor generation:  0.028921127319335938
mini_batch_src_global generation:  0.05217790603637695
r_  generation:  0.4313163757324219
local_output_nid generation:  0.030404329299926758
local_in_edges_tensor generation:  0.0278322696685791
mini_batch_src_global generation:  0.049872398376464844
r_  generation:  0.43392348289489746
local_output_nid generation:  0.02995443344116211
local_in_edges_tensor generation:  0.02795863151550293
mini_batch_src_global generation:  0.05781269073486328
r_  generation:  0.43758344650268555
local_output_nid generation:  0.029766559600830078
local_in_edges_tensor generation:  0.029325008392333984
mini_batch_src_global generation:  0.05746889114379883
r_  generation:  0.4314754009246826
local_output_nid generation:  0.02933979034423828
local_in_edges_tensor generation:  0.029287338256835938
mini_batch_src_global generation:  0.05385541915893555
r_  generation:  0.4280827045440674
local_output_nid generation:  0.029546022415161133
local_in_edges_tensor generation:  0.02796030044555664
mini_batch_src_global generation:  0.050922393798828125
r_  generation:  0.436356782913208
local_output_nid generation:  0.029972314834594727
local_in_edges_tensor generation:  0.03205680847167969
mini_batch_src_global generation:  0.05091691017150879
r_  generation:  0.43114638328552246
local_output_nid generation:  0.030088186264038086
local_in_edges_tensor generation:  0.03085041046142578
mini_batch_src_global generation:  0.04951834678649902
r_  generation:  0.432919979095459
local_output_nid generation:  0.02927422523498535
local_in_edges_tensor generation:  0.027031421661376953
mini_batch_src_global generation:  0.050868988037109375
r_  generation:  0.42998290061950684
local_output_nid generation:  0.0296783447265625
local_in_edges_tensor generation:  0.02721428871154785
mini_batch_src_global generation:  0.04945850372314453
r_  generation:  0.4304673671722412
local_output_nid generation:  0.029527902603149414
local_in_edges_tensor generation:  0.030865192413330078
mini_batch_src_global generation:  0.05103874206542969
r_  generation:  0.42977333068847656
local_output_nid generation:  0.029486656188964844
local_in_edges_tensor generation:  0.029389381408691406
mini_batch_src_global generation:  0.04979348182678223
r_  generation:  0.43151283264160156
local_output_nid generation:  0.02992105484008789
local_in_edges_tensor generation:  0.029764890670776367
mini_batch_src_global generation:  0.051113128662109375
r_  generation:  0.4362831115722656
local_output_nid generation:  0.029345273971557617
local_in_edges_tensor generation:  0.030556440353393555
mini_batch_src_global generation:  0.04955267906188965
r_  generation:  0.4342198371887207
local_output_nid generation:  0.030238628387451172
local_in_edges_tensor generation:  0.027663230895996094
mini_batch_src_global generation:  0.05104207992553711
r_  generation:  0.4351522922515869
local_output_nid generation:  0.029469728469848633
local_in_edges_tensor generation:  0.02689075469970703
mini_batch_src_global generation:  0.04984450340270996
r_  generation:  0.4324052333831787
local_output_nid generation:  0.0296785831451416
local_in_edges_tensor generation:  0.0293581485748291
mini_batch_src_global generation:  0.05072736740112305
r_  generation:  0.4342076778411865
local_output_nid generation:  0.029996395111083984
local_in_edges_tensor generation:  0.03065776824951172
mini_batch_src_global generation:  0.05186009407043457
r_  generation:  0.4418020248413086
local_output_nid generation:  0.02928948402404785
local_in_edges_tensor generation:  0.028183460235595703
mini_batch_src_global generation:  0.05080270767211914
r_  generation:  0.4309422969818115
local_output_nid generation:  0.029578685760498047
local_in_edges_tensor generation:  0.027040481567382812
mini_batch_src_global generation:  0.04960179328918457
r_  generation:  0.4336678981781006
local_output_nid generation:  0.029547929763793945
local_in_edges_tensor generation:  0.028048276901245117
mini_batch_src_global generation:  0.05006694793701172
r_  generation:  0.43741536140441895
local_output_nid generation:  0.029590845108032227
local_in_edges_tensor generation:  0.028894662857055664
mini_batch_src_global generation:  0.05097842216491699
r_  generation:  0.4371459484100342
local_output_nid generation:  0.029339313507080078
local_in_edges_tensor generation:  0.029463768005371094
mini_batch_src_global generation:  0.05071902275085449
r_  generation:  0.43769145011901855
local_output_nid generation:  0.029481172561645508
local_in_edges_tensor generation:  0.029393911361694336
mini_batch_src_global generation:  0.05169343948364258
r_  generation:  0.43668103218078613
local_output_nid generation:  0.030071258544921875
local_in_edges_tensor generation:  0.027341365814208984
mini_batch_src_global generation:  0.05118727684020996
r_  generation:  0.442608118057251
local_output_nid generation:  0.029697895050048828
local_in_edges_tensor generation:  0.030378103256225586
mini_batch_src_global generation:  0.04947543144226074
r_  generation:  0.43984508514404297
local_output_nid generation:  0.0298004150390625
local_in_edges_tensor generation:  0.029631614685058594
mini_batch_src_global generation:  0.05035543441772461
r_  generation:  0.43807435035705566
----------------------check_connections_block total spend ----------------------------- 20.508599281311035
generate_one_block  0.5937666893005371
generate_one_block  0.5699527263641357
generate_one_block  0.5733938217163086
generate_one_block  0.5820939540863037
generate_one_block  0.6890299320220947
generate_one_block  0.5791933536529541
generate_one_block  0.5761556625366211
generate_one_block  0.5908000469207764
generate_one_block  0.572676420211792
generate_one_block  0.5672919750213623
generate_one_block  0.5782914161682129
generate_one_block  0.58579421043396
generate_one_block  0.5805549621582031
generate_one_block  0.5707416534423828
generate_one_block  0.5687670707702637
generate_one_block  0.5872166156768799
generate_one_block  0.5786120891571045
generate_one_block  0.5876054763793945
generate_one_block  0.5760595798492432
generate_one_block  0.5768132209777832
generate_one_block  0.5795638561248779
generate_one_block  0.5799920558929443
generate_one_block  0.5837481021881104
generate_one_block  0.5757954120635986
generate_one_block  0.5940344333648682
generate_one_block  0.5736143589019775
generate_one_block  0.5836949348449707
generate_one_block  0.5761284828186035
generate_one_block  0.5713467597961426
generate_one_block  0.5894262790679932
generate_one_block  0.5755107402801514
generate_one_block  0.5884349346160889
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.1258859634399414  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

connection checking time:  28.964232444763184
block generation total time  26.529513597488403
average batch blocks generation time:  0.8290472999215126
block dataloader generation time/epoch 59.52035273824419
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10627174377441406  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.44782257080078  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10614681243896484  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.649909496307373  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10663175582885742  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.974250316619873  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10645866394042969  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.10720729827881  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.106781005859375  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.951268196105957  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10648632049560547  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.82869005203247  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10636425018310547  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.81408977508545  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10716724395751953  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.388493537902832  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10663509368896484  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.85880947113037  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10620975494384766  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.340039253234863  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.1066899299621582  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.12001132965088  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10709095001220703  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.288890838623047  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10688495635986328  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.0244083404541  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10627460479736328  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.74246072769165  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10619068145751953  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.63124704360962  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10659408569335938  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.038551330566406  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.1062779426574707  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.718295097351074  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.1068115234375  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.26373291015625  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.1065378189086914  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.927492141723633  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10662269592285156  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.010127067565918  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10658550262451172  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.927916049957275  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10671186447143555  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.92586898803711  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10706901550292969  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.173790454864502  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10635614395141602  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.754119873046875  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10669660568237305  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.9889874458313  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.1063833236694336  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.907033443450928  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10656881332397461  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.973700046539307  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10657024383544922  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.11082172393799  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10626077651977539  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.410564422607422  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10689401626586914  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.386662483215332  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10649871826171875  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.677111625671387  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10681724548339844  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.984735012054443  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03377777338027954 |0.019727803766727448 |0.554318368434906 |9.433180093765259e-05 |1.0703922137618065 |0.008295059204101562 |
----------------------------------------------------------pseudo_mini_loss sum 1.3196922540664673
Total (block generation + training)time/epoch 113.25831345149449
Training time/epoch 53.76552939414978
Training time without block to device /epoch 53.1342396736145
Training time without total dataloading part /epoch 52.002052307128906
load block tensor time/epoch 1.0808887481689453
block to device time/epoch 0.6312897205352783
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 23 |
Number of nodes for computation during this epoch:  9109521
Number of first layer input nodes during this epoch:  4760302
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.12698030471801758  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024646759033203125
random selection method range initialization spend 0.0051686763763427734
time for parepare:  0.020494937896728516
local_output_nid generation:  0.0015060901641845703
local_in_edges_tensor generation:  0.005780696868896484
mini_batch_src_global generation:  0.0019245147705078125
r_  generation:  0.011261463165283203
local_output_nid generation:  0.0017352104187011719
local_in_edges_tensor generation:  0.0010571479797363281
mini_batch_src_global generation:  0.0017001628875732422
r_  generation:  0.010335683822631836
local_output_nid generation:  0.001661062240600586
local_in_edges_tensor generation:  0.0009479522705078125
mini_batch_src_global generation:  0.0011739730834960938
r_  generation:  0.010081052780151367
local_output_nid generation:  0.001630544662475586
local_in_edges_tensor generation:  0.0009212493896484375
mini_batch_src_global generation:  0.001199483871459961
r_  generation:  0.009818792343139648
local_output_nid generation:  0.001615762710571289
local_in_edges_tensor generation:  0.0009248256683349609
mini_batch_src_global generation:  0.0011572837829589844
r_  generation:  0.010069608688354492
local_output_nid generation:  0.0015990734100341797
local_in_edges_tensor generation:  0.0009100437164306641
mini_batch_src_global generation:  0.0011739730834960938
r_  generation:  0.009820222854614258
local_output_nid generation:  0.0015947818756103516
local_in_edges_tensor generation:  0.0009119510650634766
mini_batch_src_global generation:  0.0011610984802246094
r_  generation:  0.009761810302734375
local_output_nid generation:  0.0015971660614013672
local_in_edges_tensor generation:  0.0009088516235351562
mini_batch_src_global generation:  0.0011153221130371094
r_  generation:  0.009985208511352539
local_output_nid generation:  0.001592397689819336
local_in_edges_tensor generation:  0.0009279251098632812
mini_batch_src_global generation:  0.001203775405883789
r_  generation:  0.010208368301391602
local_output_nid generation:  0.0016055107116699219
local_in_edges_tensor generation:  0.0008628368377685547
mini_batch_src_global generation:  0.0011553764343261719
r_  generation:  0.009863853454589844
local_output_nid generation:  0.0015940666198730469
local_in_edges_tensor generation:  0.0008974075317382812
mini_batch_src_global generation:  0.0010843276977539062
r_  generation:  0.009904861450195312
local_output_nid generation:  0.0016016960144042969
local_in_edges_tensor generation:  0.0008690357208251953
mini_batch_src_global generation:  0.0010538101196289062
r_  generation:  0.01201629638671875
local_output_nid generation:  0.0016851425170898438
local_in_edges_tensor generation:  0.0009725093841552734
mini_batch_src_global generation:  0.0013513565063476562
r_  generation:  0.01094675064086914
local_output_nid generation:  0.0016105175018310547
local_in_edges_tensor generation:  0.0009095668792724609
mini_batch_src_global generation:  0.0012068748474121094
r_  generation:  0.010387897491455078
local_output_nid generation:  0.001626729965209961
local_in_edges_tensor generation:  0.0009105205535888672
mini_batch_src_global generation:  0.0011587142944335938
r_  generation:  0.010165691375732422
local_output_nid generation:  0.0015921592712402344
local_in_edges_tensor generation:  0.0009222030639648438
mini_batch_src_global generation:  0.001222848892211914
r_  generation:  0.010230064392089844
local_output_nid generation:  0.0015957355499267578
local_in_edges_tensor generation:  0.0009045600891113281
mini_batch_src_global generation:  0.0011489391326904297
r_  generation:  0.010161638259887695
local_output_nid generation:  0.0015985965728759766
local_in_edges_tensor generation:  0.0008950233459472656
mini_batch_src_global generation:  0.001165628433227539
r_  generation:  0.010266304016113281
local_output_nid generation:  0.0015881061553955078
local_in_edges_tensor generation:  0.0008728504180908203
mini_batch_src_global generation:  0.0011589527130126953
r_  generation:  0.009810686111450195
local_output_nid generation:  0.0015807151794433594
local_in_edges_tensor generation:  0.0008678436279296875
mini_batch_src_global generation:  0.0011932849884033203
r_  generation:  0.010352134704589844
local_output_nid generation:  0.001605987548828125
local_in_edges_tensor generation:  0.0009055137634277344
mini_batch_src_global generation:  0.0012059211730957031
r_  generation:  0.010568618774414062
local_output_nid generation:  0.001590728759765625
local_in_edges_tensor generation:  0.0008671283721923828
mini_batch_src_global generation:  0.0012056827545166016
r_  generation:  0.010318994522094727
local_output_nid generation:  0.0015857219696044922
local_in_edges_tensor generation:  0.0008754730224609375
mini_batch_src_global generation:  0.0011682510375976562
r_  generation:  0.010049581527709961
local_output_nid generation:  0.0016312599182128906
local_in_edges_tensor generation:  0.0009014606475830078
mini_batch_src_global generation:  0.0011763572692871094
r_  generation:  0.010205984115600586
local_output_nid generation:  0.0016179084777832031
local_in_edges_tensor generation:  0.0008993148803710938
mini_batch_src_global generation:  0.0011889934539794922
r_  generation:  0.010100364685058594
local_output_nid generation:  0.0015997886657714844
local_in_edges_tensor generation:  0.0008902549743652344
mini_batch_src_global generation:  0.0011894702911376953
r_  generation:  0.010097026824951172
local_output_nid generation:  0.0015773773193359375
local_in_edges_tensor generation:  0.0008997917175292969
mini_batch_src_global generation:  0.0012009143829345703
r_  generation:  0.010246515274047852
local_output_nid generation:  0.001585245132446289
local_in_edges_tensor generation:  0.0009214878082275391
mini_batch_src_global generation:  0.0011532306671142578
r_  generation:  0.010298013687133789
local_output_nid generation:  0.0015952587127685547
local_in_edges_tensor generation:  0.0008871555328369141
mini_batch_src_global generation:  0.0011584758758544922
r_  generation:  0.010503768920898438
local_output_nid generation:  0.001585245132446289
local_in_edges_tensor generation:  0.001050710678100586
mini_batch_src_global generation:  0.0011782646179199219
r_  generation:  0.010236740112304688
local_output_nid generation:  0.001577615737915039
local_in_edges_tensor generation:  0.0008802413940429688
mini_batch_src_global generation:  0.0011763572692871094
r_  generation:  0.010016202926635742
local_output_nid generation:  0.0015728473663330078
local_in_edges_tensor generation:  0.0008695125579833984
mini_batch_src_global generation:  0.0011196136474609375
r_  generation:  0.010149478912353516
----------------------check_connections_block total spend ----------------------------- 0.5680756568908691
generate_one_block  0.025116682052612305
generate_one_block  0.02121138572692871
generate_one_block  0.019025564193725586
generate_one_block  0.018246173858642578
generate_one_block  0.018410682678222656
generate_one_block  0.017786264419555664
generate_one_block  0.017480134963989258
generate_one_block  0.017940044403076172
generate_one_block  0.018149852752685547
generate_one_block  0.017499923706054688
generate_one_block  0.0174710750579834
generate_one_block  0.022384166717529297
generate_one_block  0.02121734619140625
generate_one_block  0.018642187118530273
generate_one_block  0.01784539222717285
generate_one_block  0.01804947853088379
generate_one_block  0.017702579498291016
generate_one_block  0.01811814308166504
generate_one_block  0.01720118522644043
generate_one_block  0.018033504486083984
generate_one_block  0.018598556518554688
generate_one_block  0.018169641494750977
generate_one_block  0.017650127410888672
generate_one_block  0.017867326736450195
generate_one_block  0.017725467681884766
generate_one_block  0.017704010009765625
generate_one_block  0.01807713508605957
generate_one_block  0.018121719360351562
generate_one_block  0.01824808120727539
generate_one_block  0.017893552780151367
generate_one_block  0.017579317092895508
generate_one_block  0.017975807189941406
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03731131553649902
gen group dst list time:  0.02307915687561035
time for parepare:  0.022591590881347656
local_output_nid generation:  0.006793975830078125
local_in_edges_tensor generation:  0.019039630889892578
mini_batch_src_global generation:  0.019268035888671875
r_  generation:  0.1724255084991455
local_output_nid generation:  0.00899958610534668
local_in_edges_tensor generation:  0.012316465377807617
mini_batch_src_global generation:  0.022551298141479492
r_  generation:  0.20084166526794434
local_output_nid generation:  0.015459060668945312
local_in_edges_tensor generation:  0.04978179931640625
mini_batch_src_global generation:  0.022626638412475586
r_  generation:  0.17593669891357422
local_output_nid generation:  0.01161050796508789
local_in_edges_tensor generation:  0.009690999984741211
mini_batch_src_global generation:  0.02122354507446289
r_  generation:  0.17913222312927246
local_output_nid generation:  0.01011204719543457
local_in_edges_tensor generation:  0.012125492095947266
mini_batch_src_global generation:  0.0227200984954834
r_  generation:  0.18565654754638672
local_output_nid generation:  0.009580135345458984
local_in_edges_tensor generation:  0.011937379837036133
mini_batch_src_global generation:  0.02303767204284668
r_  generation:  0.17710018157958984
local_output_nid generation:  0.00897836685180664
local_in_edges_tensor generation:  0.012016773223876953
mini_batch_src_global generation:  0.0227658748626709
r_  generation:  0.176865816116333
local_output_nid generation:  0.009079217910766602
local_in_edges_tensor generation:  0.01797938346862793
mini_batch_src_global generation:  0.023120880126953125
r_  generation:  0.18537282943725586
local_output_nid generation:  0.00908970832824707
local_in_edges_tensor generation:  0.011716604232788086
mini_batch_src_global generation:  0.025649070739746094
r_  generation:  0.1909160614013672
local_output_nid generation:  0.009545326232910156
local_in_edges_tensor generation:  0.011359691619873047
mini_batch_src_global generation:  0.023237228393554688
r_  generation:  0.18055987358093262
local_output_nid generation:  0.010015010833740234
local_in_edges_tensor generation:  0.011969566345214844
mini_batch_src_global generation:  0.02516031265258789
r_  generation:  0.1830127239227295
local_output_nid generation:  0.010048627853393555
local_in_edges_tensor generation:  0.01339578628540039
mini_batch_src_global generation:  0.02574634552001953
r_  generation:  0.2007582187652588
local_output_nid generation:  0.009719133377075195
local_in_edges_tensor generation:  0.013697147369384766
mini_batch_src_global generation:  0.025353431701660156
r_  generation:  0.20165610313415527
local_output_nid generation:  0.011922359466552734
local_in_edges_tensor generation:  0.009360074996948242
mini_batch_src_global generation:  0.025270462036132812
r_  generation:  0.187453031539917
local_output_nid generation:  0.009497404098510742
local_in_edges_tensor generation:  0.009125471115112305
mini_batch_src_global generation:  0.023087739944458008
r_  generation:  0.1779634952545166
local_output_nid generation:  0.009595632553100586
local_in_edges_tensor generation:  0.010914325714111328
mini_batch_src_global generation:  0.0235292911529541
r_  generation:  0.18346643447875977
local_output_nid generation:  0.009402036666870117
local_in_edges_tensor generation:  0.009514093399047852
mini_batch_src_global generation:  0.02408766746520996
r_  generation:  0.18035292625427246
local_output_nid generation:  0.009650707244873047
local_in_edges_tensor generation:  0.01210331916809082
mini_batch_src_global generation:  0.024644851684570312
r_  generation:  0.18006134033203125
local_output_nid generation:  0.009364843368530273
local_in_edges_tensor generation:  0.010561704635620117
mini_batch_src_global generation:  0.022157669067382812
r_  generation:  0.17258381843566895
local_output_nid generation:  0.009649991989135742
local_in_edges_tensor generation:  0.009209394454956055
mini_batch_src_global generation:  0.022471904754638672
r_  generation:  0.1764543056488037
local_output_nid generation:  0.012455940246582031
local_in_edges_tensor generation:  0.009709835052490234
mini_batch_src_global generation:  0.024061918258666992
r_  generation:  0.19085454940795898
local_output_nid generation:  0.009727954864501953
local_in_edges_tensor generation:  0.010256052017211914
mini_batch_src_global generation:  0.024370670318603516
r_  generation:  0.1879279613494873
local_output_nid generation:  0.00946664810180664
local_in_edges_tensor generation:  0.009687662124633789
mini_batch_src_global generation:  0.02299785614013672
r_  generation:  0.18109583854675293
local_output_nid generation:  0.009625673294067383
local_in_edges_tensor generation:  0.012932777404785156
mini_batch_src_global generation:  0.023563623428344727
r_  generation:  0.1918959617614746
local_output_nid generation:  0.009526491165161133
local_in_edges_tensor generation:  0.009084463119506836
mini_batch_src_global generation:  0.023364543914794922
r_  generation:  0.1839742660522461
local_output_nid generation:  0.009593486785888672
local_in_edges_tensor generation:  0.009828329086303711
mini_batch_src_global generation:  0.022954702377319336
r_  generation:  0.18390655517578125
local_output_nid generation:  0.009607076644897461
local_in_edges_tensor generation:  0.010660171508789062
mini_batch_src_global generation:  0.023097515106201172
r_  generation:  0.18456101417541504
local_output_nid generation:  0.009684085845947266
local_in_edges_tensor generation:  0.009372711181640625
mini_batch_src_global generation:  0.02291131019592285
r_  generation:  0.18195128440856934
local_output_nid generation:  0.00964808464050293
local_in_edges_tensor generation:  0.009272336959838867
mini_batch_src_global generation:  0.023861169815063477
r_  generation:  0.18599796295166016
local_output_nid generation:  0.009668111801147461
local_in_edges_tensor generation:  0.009361505508422852
mini_batch_src_global generation:  0.023740768432617188
r_  generation:  0.18419623374938965
local_output_nid generation:  0.009485244750976562
local_in_edges_tensor generation:  0.009227514266967773
mini_batch_src_global generation:  0.023326396942138672
r_  generation:  0.17937374114990234
local_output_nid generation:  0.00945591926574707
local_in_edges_tensor generation:  0.010093927383422852
mini_batch_src_global generation:  0.02320408821105957
r_  generation:  0.18379926681518555
----------------------check_connections_block total spend ----------------------------- 8.67950701713562
generate_one_block  0.27799367904663086
generate_one_block  0.2482614517211914
generate_one_block  0.24302315711975098
generate_one_block  0.2460315227508545
generate_one_block  0.2669856548309326
generate_one_block  0.24429011344909668
generate_one_block  0.24078845977783203
generate_one_block  0.2588961124420166
generate_one_block  0.2544879913330078
generate_one_block  0.238236665725708
generate_one_block  0.24298882484436035
generate_one_block  0.2712094783782959
generate_one_block  0.2584962844848633
generate_one_block  0.2577939033508301
generate_one_block  0.2435591220855713
generate_one_block  0.24814224243164062
generate_one_block  0.24056649208068848
generate_one_block  0.24409842491149902
generate_one_block  0.23160338401794434
generate_one_block  0.24317407608032227
generate_one_block  0.25846338272094727
generate_one_block  0.2546424865722656
generate_one_block  0.24236679077148438
generate_one_block  0.24671721458435059
generate_one_block  0.24835968017578125
generate_one_block  0.24442601203918457
generate_one_block  0.24541950225830078
generate_one_block  0.2456963062286377
generate_one_block  0.24945998191833496
generate_one_block  0.24783921241760254
generate_one_block  0.23944473266601562
generate_one_block  0.24494266510009766
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04280543327331543
gen group dst list time:  0.1125633716583252
time for parepare:  0.01800990104675293
local_output_nid generation:  0.02693796157836914
local_in_edges_tensor generation:  0.05346417427062988
mini_batch_src_global generation:  0.051462411880493164
r_  generation:  0.43440866470336914
local_output_nid generation:  0.03167867660522461
local_in_edges_tensor generation:  0.037613868713378906
mini_batch_src_global generation:  0.052181243896484375
r_  generation:  0.42638635635375977
local_output_nid generation:  0.03416848182678223
local_in_edges_tensor generation:  0.034913063049316406
mini_batch_src_global generation:  0.04779529571533203
r_  generation:  0.4364147186279297
local_output_nid generation:  0.032295942306518555
local_in_edges_tensor generation:  0.03200840950012207
mini_batch_src_global generation:  0.05128669738769531
r_  generation:  0.4344329833984375
local_output_nid generation:  0.03164029121398926
local_in_edges_tensor generation:  0.03310537338256836
mini_batch_src_global generation:  0.04954695701599121
r_  generation:  0.4382972717285156
local_output_nid generation:  0.03182673454284668
local_in_edges_tensor generation:  0.03186917304992676
mini_batch_src_global generation:  0.051910400390625
r_  generation:  0.4342029094696045
local_output_nid generation:  0.030590057373046875
local_in_edges_tensor generation:  0.032173871994018555
mini_batch_src_global generation:  0.04962491989135742
r_  generation:  0.4386634826660156
local_output_nid generation:  0.02953171730041504
local_in_edges_tensor generation:  0.03754854202270508
mini_batch_src_global generation:  0.052622079849243164
r_  generation:  0.43715429306030273
local_output_nid generation:  0.029931306838989258
local_in_edges_tensor generation:  0.030916690826416016
mini_batch_src_global generation:  0.05093264579772949
r_  generation:  0.4443845748901367
local_output_nid generation:  0.029812097549438477
local_in_edges_tensor generation:  0.030182361602783203
mini_batch_src_global generation:  0.05089402198791504
r_  generation:  0.43378663063049316
local_output_nid generation:  0.030688047409057617
local_in_edges_tensor generation:  0.032880306243896484
mini_batch_src_global generation:  0.0497744083404541
r_  generation:  0.4397268295288086
local_output_nid generation:  0.030009984970092773
local_in_edges_tensor generation:  0.031755924224853516
mini_batch_src_global generation:  0.051264286041259766
r_  generation:  0.43970274925231934
local_output_nid generation:  0.030136585235595703
local_in_edges_tensor generation:  0.032720327377319336
mini_batch_src_global generation:  0.050481557846069336
r_  generation:  0.443378210067749
local_output_nid generation:  0.030323505401611328
local_in_edges_tensor generation:  0.03170037269592285
mini_batch_src_global generation:  0.05110740661621094
r_  generation:  0.45201945304870605
local_output_nid generation:  0.03253650665283203
local_in_edges_tensor generation:  0.03152728080749512
mini_batch_src_global generation:  0.05093550682067871
r_  generation:  0.4335620403289795
local_output_nid generation:  0.030584335327148438
local_in_edges_tensor generation:  0.031224966049194336
mini_batch_src_global generation:  0.052793025970458984
r_  generation:  0.4350111484527588
local_output_nid generation:  0.03042125701904297
local_in_edges_tensor generation:  0.031200647354125977
mini_batch_src_global generation:  0.04938960075378418
r_  generation:  0.4325556755065918
local_output_nid generation:  0.030596017837524414
local_in_edges_tensor generation:  0.031215429306030273
mini_batch_src_global generation:  0.05263257026672363
r_  generation:  0.4364030361175537
local_output_nid generation:  0.030481338500976562
local_in_edges_tensor generation:  0.029726505279541016
mini_batch_src_global generation:  0.049268245697021484
r_  generation:  0.4377133846282959
local_output_nid generation:  0.030495643615722656
local_in_edges_tensor generation:  0.031377315521240234
mini_batch_src_global generation:  0.05228781700134277
r_  generation:  0.4305250644683838
local_output_nid generation:  0.03096294403076172
local_in_edges_tensor generation:  0.03300642967224121
mini_batch_src_global generation:  0.05165386199951172
r_  generation:  0.439439058303833
local_output_nid generation:  0.030900955200195312
local_in_edges_tensor generation:  0.03151822090148926
mini_batch_src_global generation:  0.05088376998901367
r_  generation:  0.4384596347808838
local_output_nid generation:  0.03066849708557129
local_in_edges_tensor generation:  0.03184914588928223
mini_batch_src_global generation:  0.05091547966003418
r_  generation:  0.43885111808776855
local_output_nid generation:  0.03045034408569336
local_in_edges_tensor generation:  0.029340028762817383
mini_batch_src_global generation:  0.05078482627868652
r_  generation:  0.43680739402770996
local_output_nid generation:  0.0307924747467041
local_in_edges_tensor generation:  0.031868934631347656
mini_batch_src_global generation:  0.052355051040649414
r_  generation:  0.4423391819000244
local_output_nid generation:  0.030533552169799805
local_in_edges_tensor generation:  0.029811859130859375
mini_batch_src_global generation:  0.051218509674072266
r_  generation:  0.4479193687438965
local_output_nid generation:  0.03074932098388672
local_in_edges_tensor generation:  0.03180074691772461
mini_batch_src_global generation:  0.050923824310302734
r_  generation:  0.4415462017059326
local_output_nid generation:  0.030889034271240234
local_in_edges_tensor generation:  0.03355669975280762
mini_batch_src_global generation:  0.0516512393951416
r_  generation:  0.43805956840515137
local_output_nid generation:  0.03107452392578125
local_in_edges_tensor generation:  0.0335240364074707
mini_batch_src_global generation:  0.0509183406829834
r_  generation:  0.4420440196990967
local_output_nid generation:  0.0309755802154541
local_in_edges_tensor generation:  0.0315241813659668
mini_batch_src_global generation:  0.05153656005859375
r_  generation:  0.4358818531036377
local_output_nid generation:  0.030569076538085938
local_in_edges_tensor generation:  0.02958083152770996
mini_batch_src_global generation:  0.052399635314941406
r_  generation:  0.4387176036834717
local_output_nid generation:  0.03049015998840332
local_in_edges_tensor generation:  0.029953956604003906
mini_batch_src_global generation:  0.050670623779296875
r_  generation:  0.44019269943237305
----------------------check_connections_block total spend ----------------------------- 20.81509757041931
generate_one_block  0.601870059967041
generate_one_block  0.5840110778808594
generate_one_block  0.5787558555603027
generate_one_block  0.5856869220733643
generate_one_block  0.6837713718414307
generate_one_block  0.5785162448883057
generate_one_block  0.577826738357544
generate_one_block  0.5886368751525879
generate_one_block  0.5896856784820557
generate_one_block  0.5748844146728516
generate_one_block  0.5770947933197021
generate_one_block  0.5912463665008545
generate_one_block  0.5943365097045898
generate_one_block  0.5838770866394043
generate_one_block  0.5771896839141846
generate_one_block  0.5750865936279297
generate_one_block  0.5740165710449219
generate_one_block  0.5818922519683838
generate_one_block  0.577916145324707
generate_one_block  0.5765485763549805
generate_one_block  0.5929691791534424
generate_one_block  0.583829402923584
generate_one_block  0.5756993293762207
generate_one_block  0.5790386199951172
generate_one_block  0.6001427173614502
generate_one_block  0.5793063640594482
generate_one_block  0.5845952033996582
generate_one_block  0.5905625820159912
generate_one_block  0.5963478088378906
generate_one_block  0.5867295265197754
generate_one_block  0.5767040252685547
generate_one_block  0.5805296897888184
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.12698030471801758  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

connection checking time:  29.49460458755493
block generation total time  26.747709274291992
average batch blocks generation time:  0.8358659148216248
block dataloader generation time/epoch 59.523331276575725
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10716867446899414  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.546308040618896  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10676717758178711  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.894980430603027  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10656881332397461  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.755058765411377  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10666942596435547  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.923285007476807  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.1063990592956543  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.057119369506836  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10632705688476562  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.57609796524048  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10646581649780273  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.432571411132812  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10645866394042969  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.045872688293457  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10667657852172852  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 19.101973056793213  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.1063380241394043  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.551144123077393  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.1064143180847168  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.72641658782959  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.10712194442749023  GigaBytes
Max Memory Allocated: 19.77164602279663  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7733154296875 GB
    Memory Allocated: 19.835639476776123  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10681629180908203  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.26701784133911  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10706758499145508  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.34829807281494  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10634469985961914  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.550966262817383  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10668754577636719  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.02465581893921  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10655879974365234  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.65454387664795  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10648441314697266  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.91620635986328  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10628652572631836  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.29312753677368  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10660600662231445  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.616209030151367  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10709428787231445  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.42067003250122  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10686874389648438  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.22511625289917  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10645675659179688  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.76571035385132  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10640335083007812  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.87988042831421  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10648250579833984  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.849459648132324  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.1064748764038086  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.830849647521973  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10652637481689453  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.957763671875  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10687065124511719  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.916756629943848  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10682487487792969  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.126265048980713  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10665655136108398  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.98229694366455  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10652017593383789  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.6803035736084  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10643959045410156  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.824830055236816  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.030150391161441803 |0.019925624132156372 |0.5567292273044586 |9.435415267944336e-05 |1.0725616440176964 |0.005503654479980469 |
----------------------------------------------------------pseudo_mini_loss sum 1.3165409564971924
Total (block generation + training)time/epoch 113.2658182779948
Training time/epoch 53.80553650856018
Training time without block to device /epoch 53.16791653633118
Training time without total dataloading part /epoch 52.14583086967468
load block tensor time/epoch 0.9648125171661377
block to device time/epoch 0.6376199722290039
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 24 |
Number of nodes for computation during this epoch:  9117150
Number of first layer input nodes during this epoch:  4762613
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.12645626068115234  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024974822998046875
random selection method range initialization spend 0.00769495964050293
time for parepare:  0.021839141845703125
local_output_nid generation:  0.0014028549194335938
local_in_edges_tensor generation:  0.008289813995361328
mini_batch_src_global generation:  0.0023920536041259766
r_  generation:  0.01134181022644043
local_output_nid generation:  0.0016946792602539062
local_in_edges_tensor generation:  0.001135110855102539
mini_batch_src_global generation:  0.0016906261444091797
r_  generation:  0.010429620742797852
local_output_nid generation:  0.0016293525695800781
local_in_edges_tensor generation:  0.000995635986328125
mini_batch_src_global generation:  0.0012178421020507812
r_  generation:  0.010122537612915039
local_output_nid generation:  0.0016384124755859375
local_in_edges_tensor generation:  0.0010063648223876953
mini_batch_src_global generation:  0.0012192726135253906
r_  generation:  0.010105371475219727
local_output_nid generation:  0.0015952587127685547
local_in_edges_tensor generation:  0.0009894371032714844
mini_batch_src_global generation:  0.0011546611785888672
r_  generation:  0.009892940521240234
local_output_nid generation:  0.0015900135040283203
local_in_edges_tensor generation:  0.0009515285491943359
mini_batch_src_global generation:  0.0011947154998779297
r_  generation:  0.010304689407348633
local_output_nid generation:  0.0015997886657714844
local_in_edges_tensor generation:  0.0009741783142089844
mini_batch_src_global generation:  0.001215219497680664
r_  generation:  0.010463714599609375
local_output_nid generation:  0.0015811920166015625
local_in_edges_tensor generation:  0.0009450912475585938
mini_batch_src_global generation:  0.0011746883392333984
r_  generation:  0.009824275970458984
local_output_nid generation:  0.0015883445739746094
local_in_edges_tensor generation:  0.0009548664093017578
mini_batch_src_global generation:  0.001171112060546875
r_  generation:  0.010269641876220703
local_output_nid generation:  0.0015876293182373047
local_in_edges_tensor generation:  0.0009295940399169922
mini_batch_src_global generation:  0.0012056827545166016
r_  generation:  0.010006189346313477
local_output_nid generation:  0.0015926361083984375
local_in_edges_tensor generation:  0.0009524822235107422
mini_batch_src_global generation:  0.00115203857421875
r_  generation:  0.010401010513305664
local_output_nid generation:  0.0015926361083984375
local_in_edges_tensor generation:  0.0009343624114990234
mini_batch_src_global generation:  0.0011560916900634766
r_  generation:  0.010325431823730469
local_output_nid generation:  0.0015799999237060547
local_in_edges_tensor generation:  0.0009524822235107422
mini_batch_src_global generation:  0.001194000244140625
r_  generation:  0.010815143585205078
local_output_nid generation:  0.0015859603881835938
local_in_edges_tensor generation:  0.0009157657623291016
mini_batch_src_global generation:  0.0011739730834960938
r_  generation:  0.010024070739746094
local_output_nid generation:  0.0015811920166015625
local_in_edges_tensor generation:  0.0009400844573974609
mini_batch_src_global generation:  0.0011906623840332031
r_  generation:  0.010553598403930664
local_output_nid generation:  0.0016026496887207031
local_in_edges_tensor generation:  0.0009284019470214844
mini_batch_src_global generation:  0.0011348724365234375
r_  generation:  0.009952306747436523
local_output_nid generation:  0.0016002655029296875
local_in_edges_tensor generation:  0.0009133815765380859
mini_batch_src_global generation:  0.0011286735534667969
r_  generation:  0.010067939758300781
local_output_nid generation:  0.0015950202941894531
local_in_edges_tensor generation:  0.0009508132934570312
mini_batch_src_global generation:  0.0011889934539794922
r_  generation:  0.010889768600463867
local_output_nid generation:  0.0015838146209716797
local_in_edges_tensor generation:  0.0009474754333496094
mini_batch_src_global generation:  0.0011944770812988281
r_  generation:  0.010487794876098633
local_output_nid generation:  0.0015940666198730469
local_in_edges_tensor generation:  0.0009500980377197266
mini_batch_src_global generation:  0.0012378692626953125
r_  generation:  0.010673999786376953
local_output_nid generation:  0.0015995502471923828
local_in_edges_tensor generation:  0.0009181499481201172
mini_batch_src_global generation:  0.0011532306671142578
r_  generation:  0.01016378402709961
local_output_nid generation:  0.001598358154296875
local_in_edges_tensor generation:  0.0009267330169677734
mini_batch_src_global generation:  0.0012400150299072266
r_  generation:  0.010365962982177734
local_output_nid generation:  0.0015950202941894531
local_in_edges_tensor generation:  0.0009148120880126953
mini_batch_src_global generation:  0.0011725425720214844
r_  generation:  0.010300874710083008
local_output_nid generation:  0.0016021728515625
local_in_edges_tensor generation:  0.0009226799011230469
mini_batch_src_global generation:  0.0011475086212158203
r_  generation:  0.010406494140625
local_output_nid generation:  0.0015854835510253906
local_in_edges_tensor generation:  0.0009305477142333984
mini_batch_src_global generation:  0.0011448860168457031
r_  generation:  0.010217905044555664
local_output_nid generation:  0.0015919208526611328
local_in_edges_tensor generation:  0.0009195804595947266
mini_batch_src_global generation:  0.0012006759643554688
r_  generation:  0.010321378707885742
local_output_nid generation:  0.0015971660614013672
local_in_edges_tensor generation:  0.0009095668792724609
mini_batch_src_global generation:  0.0012335777282714844
r_  generation:  0.01041102409362793
local_output_nid generation:  0.0016047954559326172
local_in_edges_tensor generation:  0.0008945465087890625
mini_batch_src_global generation:  0.0011446475982666016
r_  generation:  0.010324478149414062
local_output_nid generation:  0.001592874526977539
local_in_edges_tensor generation:  0.0008852481842041016
mini_batch_src_global generation:  0.0012285709381103516
r_  generation:  0.010506629943847656
local_output_nid generation:  0.0015795230865478516
local_in_edges_tensor generation:  0.0008890628814697266
mini_batch_src_global generation:  0.0011324882507324219
r_  generation:  0.009803533554077148
local_output_nid generation:  0.0015985965728759766
local_in_edges_tensor generation:  0.0008916854858398438
mini_batch_src_global generation:  0.0011718273162841797
r_  generation:  0.010370492935180664
local_output_nid generation:  0.0015950202941894531
local_in_edges_tensor generation:  0.0009284019470214844
mini_batch_src_global generation:  0.0011687278747558594
r_  generation:  0.010181188583374023
----------------------check_connections_block total spend ----------------------------- 0.577993631362915
generate_one_block  0.020346879959106445
generate_one_block  0.0215146541595459
generate_one_block  0.01924753189086914
generate_one_block  0.018651247024536133
generate_one_block  0.018203020095825195
generate_one_block  0.018474340438842773
generate_one_block  0.01877760887145996
generate_one_block  0.017664194107055664
generate_one_block  0.0184171199798584
generate_one_block  0.017911195755004883
generate_one_block  0.01824212074279785
generate_one_block  0.021120309829711914
generate_one_block  0.019955158233642578
generate_one_block  0.018042802810668945
generate_one_block  0.01863718032836914
generate_one_block  0.017641782760620117
generate_one_block  0.017911195755004883
generate_one_block  0.019089221954345703
generate_one_block  0.018496036529541016
generate_one_block  0.01896977424621582
generate_one_block  0.01795363426208496
generate_one_block  0.018416881561279297
generate_one_block  0.01828765869140625
generate_one_block  0.01819157600402832
generate_one_block  0.017983198165893555
generate_one_block  0.018124818801879883
generate_one_block  0.018393993377685547
generate_one_block  0.018163681030273438
generate_one_block  0.018329858779907227
generate_one_block  0.017375707626342773
generate_one_block  0.018225431442260742
generate_one_block  0.0178525447845459
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.040782928466796875
gen group dst list time:  0.02584552764892578
time for parepare:  0.022160768508911133
local_output_nid generation:  0.006374835968017578
local_in_edges_tensor generation:  0.0201568603515625
mini_batch_src_global generation:  0.017534494400024414
r_  generation:  0.16041350364685059
local_output_nid generation:  0.00948333740234375
local_in_edges_tensor generation:  0.012239217758178711
mini_batch_src_global generation:  0.02242898941040039
r_  generation:  0.1706538200378418
local_output_nid generation:  0.009557723999023438
local_in_edges_tensor generation:  0.03647327423095703
mini_batch_src_global generation:  0.02155470848083496
r_  generation:  0.17528676986694336
local_output_nid generation:  0.009505987167358398
local_in_edges_tensor generation:  0.01149439811706543
mini_batch_src_global generation:  0.021526098251342773
r_  generation:  0.17897462844848633
local_output_nid generation:  0.0092315673828125
local_in_edges_tensor generation:  0.009178876876831055
mini_batch_src_global generation:  0.022073984146118164
r_  generation:  0.17755532264709473
local_output_nid generation:  0.009088516235351562
local_in_edges_tensor generation:  0.009357452392578125
mini_batch_src_global generation:  0.0225675106048584
r_  generation:  0.17870712280273438
local_output_nid generation:  0.009237051010131836
local_in_edges_tensor generation:  0.01251983642578125
mini_batch_src_global generation:  0.024209976196289062
r_  generation:  0.1848440170288086
local_output_nid generation:  0.008725404739379883
local_in_edges_tensor generation:  0.008898496627807617
mini_batch_src_global generation:  0.022886276245117188
r_  generation:  0.17302680015563965
local_output_nid generation:  0.009067296981811523
local_in_edges_tensor generation:  0.0094146728515625
mini_batch_src_global generation:  0.02618241310119629
r_  generation:  0.18685221672058105
local_output_nid generation:  0.00928640365600586
local_in_edges_tensor generation:  0.009085416793823242
mini_batch_src_global generation:  0.023001432418823242
r_  generation:  0.18274235725402832
local_output_nid generation:  0.009336233139038086
local_in_edges_tensor generation:  0.009266138076782227
mini_batch_src_global generation:  0.022877931594848633
r_  generation:  0.18276095390319824
local_output_nid generation:  0.009366750717163086
local_in_edges_tensor generation:  0.009001731872558594
mini_batch_src_global generation:  0.023121118545532227
r_  generation:  0.18191099166870117
local_output_nid generation:  0.009773731231689453
local_in_edges_tensor generation:  0.00979304313659668
mini_batch_src_global generation:  0.024660825729370117
r_  generation:  0.1871485710144043
local_output_nid generation:  0.009428977966308594
local_in_edges_tensor generation:  0.009159088134765625
mini_batch_src_global generation:  0.022975444793701172
r_  generation:  0.17800378799438477
local_output_nid generation:  0.009597301483154297
local_in_edges_tensor generation:  0.009224653244018555
mini_batch_src_global generation:  0.023202896118164062
r_  generation:  0.1846613883972168
local_output_nid generation:  0.00936436653137207
local_in_edges_tensor generation:  0.010321378707885742
mini_batch_src_global generation:  0.022190332412719727
r_  generation:  0.17230820655822754
local_output_nid generation:  0.009364604949951172
local_in_edges_tensor generation:  0.009048938751220703
mini_batch_src_global generation:  0.02265787124633789
r_  generation:  0.18395185470581055
local_output_nid generation:  0.009870290756225586
local_in_edges_tensor generation:  0.00937962532043457
mini_batch_src_global generation:  0.02527308464050293
r_  generation:  0.19026875495910645
local_output_nid generation:  0.009636878967285156
local_in_edges_tensor generation:  0.009977579116821289
mini_batch_src_global generation:  0.02347397804260254
r_  generation:  0.18710613250732422
local_output_nid generation:  0.009832143783569336
local_in_edges_tensor generation:  0.009994745254516602
mini_batch_src_global generation:  0.02503037452697754
r_  generation:  0.19017958641052246
local_output_nid generation:  0.009546995162963867
local_in_edges_tensor generation:  0.009062051773071289
mini_batch_src_global generation:  0.027123689651489258
r_  generation:  0.18378782272338867
local_output_nid generation:  0.00951695442199707
local_in_edges_tensor generation:  0.009926080703735352
mini_batch_src_global generation:  0.023460865020751953
r_  generation:  0.18445110321044922
local_output_nid generation:  0.009524345397949219
local_in_edges_tensor generation:  0.009857416152954102
mini_batch_src_global generation:  0.02323746681213379
r_  generation:  0.18507099151611328
local_output_nid generation:  0.009504556655883789
local_in_edges_tensor generation:  0.009137630462646484
mini_batch_src_global generation:  0.023073196411132812
r_  generation:  0.18110156059265137
local_output_nid generation:  0.009485244750976562
local_in_edges_tensor generation:  0.008937835693359375
mini_batch_src_global generation:  0.023886680603027344
r_  generation:  0.18327689170837402
local_output_nid generation:  0.00945734977722168
local_in_edges_tensor generation:  0.009612798690795898
mini_batch_src_global generation:  0.02304387092590332
r_  generation:  0.17904877662658691
local_output_nid generation:  0.009605646133422852
local_in_edges_tensor generation:  0.00986480712890625
mini_batch_src_global generation:  0.023869037628173828
r_  generation:  0.1864309310913086
local_output_nid generation:  0.009476900100708008
local_in_edges_tensor generation:  0.00974130630493164
mini_batch_src_global generation:  0.0234067440032959
r_  generation:  0.18268561363220215
local_output_nid generation:  0.009557247161865234
local_in_edges_tensor generation:  0.008965492248535156
mini_batch_src_global generation:  0.022979021072387695
r_  generation:  0.18633198738098145
local_output_nid generation:  0.00923013687133789
local_in_edges_tensor generation:  0.008966684341430664
mini_batch_src_global generation:  0.02301955223083496
r_  generation:  0.1780846118927002
local_output_nid generation:  0.009481430053710938
local_in_edges_tensor generation:  0.009054422378540039
mini_batch_src_global generation:  0.022782325744628906
r_  generation:  0.18604207038879395
local_output_nid generation:  0.009332418441772461
local_in_edges_tensor generation:  0.008869409561157227
mini_batch_src_global generation:  0.022933483123779297
r_  generation:  0.18025493621826172
----------------------check_connections_block total spend ----------------------------- 8.507734537124634
generate_one_block  0.2428886890411377
generate_one_block  0.240706205368042
generate_one_block  0.2426774501800537
generate_one_block  0.2478795051574707
generate_one_block  0.2612760066986084
generate_one_block  0.2448587417602539
generate_one_block  0.2516345977783203
generate_one_block  0.23318886756896973
generate_one_block  0.24914932250976562
generate_one_block  0.2458653450012207
generate_one_block  0.24166083335876465
generate_one_block  0.24499750137329102
generate_one_block  0.2507038116455078
generate_one_block  0.23914575576782227
generate_one_block  0.24654150009155273
generate_one_block  0.22774767875671387
generate_one_block  0.2411048412322998
generate_one_block  0.25730133056640625
generate_one_block  0.25032758712768555
generate_one_block  0.26163434982299805
generate_one_block  0.24434494972229004
generate_one_block  0.2492976188659668
generate_one_block  0.2469501495361328
generate_one_block  0.24056434631347656
generate_one_block  0.24549508094787598
generate_one_block  0.2448265552520752
generate_one_block  0.24719738960266113
generate_one_block  0.24982118606567383
generate_one_block  0.24660968780517578
generate_one_block  0.23603057861328125
generate_one_block  0.24815750122070312
generate_one_block  0.24196696281433105
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03962087631225586
gen group dst list time:  0.10543274879455566
time for parepare:  0.020084381103515625
local_output_nid generation:  0.026009559631347656
local_in_edges_tensor generation:  0.04227471351623535
mini_batch_src_global generation:  0.04028010368347168
r_  generation:  0.4263949394226074
local_output_nid generation:  0.03223562240600586
local_in_edges_tensor generation:  0.03469419479370117
mini_batch_src_global generation:  0.05069780349731445
r_  generation:  0.42893433570861816
local_output_nid generation:  0.03162646293640137
local_in_edges_tensor generation:  0.02874279022216797
mini_batch_src_global generation:  0.04820704460144043
r_  generation:  0.43639445304870605
local_output_nid generation:  0.03157687187194824
local_in_edges_tensor generation:  0.026910781860351562
mini_batch_src_global generation:  0.048955440521240234
r_  generation:  0.4260447025299072
local_output_nid generation:  0.03227043151855469
local_in_edges_tensor generation:  0.02840137481689453
mini_batch_src_global generation:  0.048815011978149414
r_  generation:  0.4347093105316162
local_output_nid generation:  0.03223681449890137
local_in_edges_tensor generation:  0.030887365341186523
mini_batch_src_global generation:  0.05253744125366211
r_  generation:  0.43234968185424805
local_output_nid generation:  0.031020402908325195
local_in_edges_tensor generation:  0.03058171272277832
mini_batch_src_global generation:  0.04913067817687988
r_  generation:  0.438122034072876
local_output_nid generation:  0.029723405838012695
local_in_edges_tensor generation:  0.02708578109741211
mini_batch_src_global generation:  0.04976224899291992
r_  generation:  0.43567991256713867
local_output_nid generation:  0.02999091148376465
local_in_edges_tensor generation:  0.02975749969482422
mini_batch_src_global generation:  0.05004382133483887
r_  generation:  0.43965864181518555
local_output_nid generation:  0.030125856399536133
local_in_edges_tensor generation:  0.025988101959228516
mini_batch_src_global generation:  0.050452232360839844
r_  generation:  0.4357306957244873
local_output_nid generation:  0.0296480655670166
local_in_edges_tensor generation:  0.028246164321899414
mini_batch_src_global generation:  0.04930925369262695
r_  generation:  0.43843603134155273
local_output_nid generation:  0.02973341941833496
local_in_edges_tensor generation:  0.026844024658203125
mini_batch_src_global generation:  0.05008101463317871
r_  generation:  0.43855786323547363
local_output_nid generation:  0.03072667121887207
local_in_edges_tensor generation:  0.02875685691833496
mini_batch_src_global generation:  0.04994964599609375
r_  generation:  0.43760108947753906
local_output_nid generation:  0.030017852783203125
local_in_edges_tensor generation:  0.027016878128051758
mini_batch_src_global generation:  0.05058097839355469
r_  generation:  0.43488287925720215
local_output_nid generation:  0.03018808364868164
local_in_edges_tensor generation:  0.028305530548095703
mini_batch_src_global generation:  0.04941296577453613
r_  generation:  0.43497586250305176
local_output_nid generation:  0.02969217300415039
local_in_edges_tensor generation:  0.02707815170288086
mini_batch_src_global generation:  0.04998970031738281
r_  generation:  0.43323802947998047
local_output_nid generation:  0.03030252456665039
local_in_edges_tensor generation:  0.028840303421020508
mini_batch_src_global generation:  0.04941844940185547
r_  generation:  0.440047025680542
local_output_nid generation:  0.03004002571105957
local_in_edges_tensor generation:  0.031401634216308594
mini_batch_src_global generation:  0.05118870735168457
r_  generation:  0.4391143321990967
local_output_nid generation:  0.029725074768066406
local_in_edges_tensor generation:  0.029161453247070312
mini_batch_src_global generation:  0.049757957458496094
r_  generation:  0.4413313865661621
local_output_nid generation:  0.030142784118652344
local_in_edges_tensor generation:  0.027783870697021484
mini_batch_src_global generation:  0.053830623626708984
r_  generation:  0.43876051902770996
local_output_nid generation:  0.029870986938476562
local_in_edges_tensor generation:  0.029050350189208984
mini_batch_src_global generation:  0.04972338676452637
r_  generation:  0.4367070198059082
local_output_nid generation:  0.03009486198425293
local_in_edges_tensor generation:  0.026936054229736328
mini_batch_src_global generation:  0.05076026916503906
r_  generation:  0.43740248680114746
local_output_nid generation:  0.030256032943725586
local_in_edges_tensor generation:  0.02874922752380371
mini_batch_src_global generation:  0.04982137680053711
r_  generation:  0.43684816360473633
local_output_nid generation:  0.030225515365600586
local_in_edges_tensor generation:  0.02906203269958496
mini_batch_src_global generation:  0.05032801628112793
r_  generation:  0.43640828132629395
local_output_nid generation:  0.03030705451965332
local_in_edges_tensor generation:  0.02737259864807129
mini_batch_src_global generation:  0.04908895492553711
r_  generation:  0.4394562244415283
local_output_nid generation:  0.029948711395263672
local_in_edges_tensor generation:  0.027082204818725586
mini_batch_src_global generation:  0.050649404525756836
r_  generation:  0.4352383613586426
local_output_nid generation:  0.03032207489013672
local_in_edges_tensor generation:  0.02876567840576172
mini_batch_src_global generation:  0.050862789154052734
r_  generation:  0.444765567779541
local_output_nid generation:  0.030166149139404297
local_in_edges_tensor generation:  0.030530691146850586
mini_batch_src_global generation:  0.0519256591796875
r_  generation:  0.441422700881958
local_output_nid generation:  0.030084609985351562
local_in_edges_tensor generation:  0.027462244033813477
mini_batch_src_global generation:  0.05039572715759277
r_  generation:  0.443523645401001
local_output_nid generation:  0.03014850616455078
local_in_edges_tensor generation:  0.027270078659057617
mini_batch_src_global generation:  0.05099225044250488
r_  generation:  0.4329686164855957
local_output_nid generation:  0.030202150344848633
local_in_edges_tensor generation:  0.03310418128967285
mini_batch_src_global generation:  0.050447940826416016
r_  generation:  0.4384496212005615
local_output_nid generation:  0.029987573623657227
local_in_edges_tensor generation:  0.02899932861328125
mini_batch_src_global generation:  0.05127525329589844
r_  generation:  0.43916749954223633
----------------------check_connections_block total spend ----------------------------- 20.59623885154724
generate_one_block  0.5818831920623779
generate_one_block  0.5841841697692871
generate_one_block  0.5778679847717285
generate_one_block  0.5747177600860596
generate_one_block  0.6689810752868652
generate_one_block  0.5864293575286865
generate_one_block  0.5844423770904541
generate_one_block  0.5705156326293945
generate_one_block  0.5854082107543945
generate_one_block  0.5834317207336426
generate_one_block  0.571871280670166
generate_one_block  0.6121101379394531
generate_one_block  0.6098344326019287
generate_one_block  0.5832831859588623
generate_one_block  0.5814580917358398
generate_one_block  0.5710821151733398
generate_one_block  0.5929162502288818
generate_one_block  0.6058051586151123
generate_one_block  0.5892043113708496
generate_one_block  0.5979938507080078
generate_one_block  0.5930023193359375
generate_one_block  0.5860798358917236
generate_one_block  0.5964314937591553
generate_one_block  0.5841665267944336
generate_one_block  0.596843957901001
generate_one_block  0.578458309173584
generate_one_block  0.6063642501831055
generate_one_block  0.5980157852172852
generate_one_block  0.5806698799133301
generate_one_block  0.5758600234985352
generate_one_block  0.5905687808990479
generate_one_block  0.5802943706512451
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.12645626068115234  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

connection checking time:  29.103973388671875
block generation total time  26.742727756500244
average batch blocks generation time:  0.8357102423906326
block dataloader generation time/epoch 59.502914756536484
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10647964477539062  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.5185284614563  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.1067972183227539  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.8417329788208  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10641670227050781  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.843372344970703  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10629129409790039  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.032451629638672  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10665464401245117  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.947144985198975  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10652828216552734  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.973642349243164  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10698604583740234  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.246081829071045  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10613250732421875  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.381449222564697  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10685491561889648  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.09726047515869  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10654640197753906  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.944780826568604  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10616302490234375  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.655556678771973  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10652971267700195  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.87998676300049  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10697031021118164  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.240304946899414  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10640668869018555  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.67178773880005  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10652494430541992  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.003278255462646  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10612916946411133  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.185683727264404  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10654783248901367  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.80054998397827  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10718679428100586  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.487449169158936  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10646581649780273  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.057988166809082  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10721969604492188  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.405181884765625  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10657835006713867  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.923709392547607  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.1066884994506836  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.025926113128662  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10672378540039062  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.076437950134277  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.1065826416015625  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.700268268585205  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.1066904067993164  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.959954261779785  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.1063690185546875  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.830779552459717  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10683250427246094  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.017016887664795  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.1065211296081543  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.007678985595703  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10651826858520508  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.946346759796143  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.1063227653503418  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.483009338378906  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10668802261352539  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.02585458755493  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10628461837768555  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.690595626831055  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.030495278537273407 |0.021944232285022736 |0.5568693801760674 |9.495764970779419e-05 |1.0698412358760834 |0.005802154541015625 |
----------------------------------------------------------pseudo_mini_loss sum 1.2907497882843018
Total (block generation + training)time/epoch 113.24862441420555
Training time/epoch 53.79377770423889
Training time without block to device /epoch 53.091562271118164
Training time without total dataloading part /epoch 52.06358051300049
load block tensor time/epoch 0.975848913192749
block to device time/epoch 0.7022154331207275
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 25 |
Number of nodes for computation during this epoch:  9111119
Number of first layer input nodes during this epoch:  4760784
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.12619829177856445  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02973771095275879
random selection method range initialization spend 0.00567626953125
time for parepare:  0.02460503578186035
local_output_nid generation:  0.0018265247344970703
local_in_edges_tensor generation:  0.008088350296020508
mini_batch_src_global generation:  0.002542734146118164
r_  generation:  0.01061868667602539
local_output_nid generation:  0.0018711090087890625
local_in_edges_tensor generation:  0.0012705326080322266
mini_batch_src_global generation:  0.002182483673095703
r_  generation:  0.01117563247680664
local_output_nid generation:  0.0021011829376220703
local_in_edges_tensor generation:  0.0012629032135009766
mini_batch_src_global generation:  0.001703023910522461
r_  generation:  0.010715246200561523
local_output_nid generation:  0.0021631717681884766
local_in_edges_tensor generation:  0.0012502670288085938
mini_batch_src_global generation:  0.0016400814056396484
r_  generation:  0.010754823684692383
local_output_nid generation:  0.002203226089477539
local_in_edges_tensor generation:  0.0012247562408447266
mini_batch_src_global generation:  0.0015034675598144531
r_  generation:  0.010159969329833984
local_output_nid generation:  0.0046041011810302734
local_in_edges_tensor generation:  0.0013277530670166016
mini_batch_src_global generation:  0.0015566349029541016
r_  generation:  0.01070094108581543
local_output_nid generation:  0.002251148223876953
local_in_edges_tensor generation:  0.0012333393096923828
mini_batch_src_global generation:  0.0015201568603515625
r_  generation:  0.010709762573242188
local_output_nid generation:  0.002277374267578125
local_in_edges_tensor generation:  0.001222848892211914
mini_batch_src_global generation:  0.0015671253204345703
r_  generation:  0.01066136360168457
local_output_nid generation:  0.002294778823852539
local_in_edges_tensor generation:  0.0011892318725585938
mini_batch_src_global generation:  0.0015375614166259766
r_  generation:  0.010829925537109375
local_output_nid generation:  0.002277851104736328
local_in_edges_tensor generation:  0.0012242794036865234
mini_batch_src_global generation:  0.0015287399291992188
r_  generation:  0.010549545288085938
local_output_nid generation:  0.002260446548461914
local_in_edges_tensor generation:  0.0011980533599853516
mini_batch_src_global generation:  0.0014929771423339844
r_  generation:  0.010988712310791016
local_output_nid generation:  0.002285480499267578
local_in_edges_tensor generation:  0.001220703125
mini_batch_src_global generation:  0.0014376640319824219
r_  generation:  0.0106048583984375
local_output_nid generation:  0.002348184585571289
local_in_edges_tensor generation:  0.0012569427490234375
mini_batch_src_global generation:  0.001508951187133789
r_  generation:  0.011209487915039062
local_output_nid generation:  0.002348184585571289
local_in_edges_tensor generation:  0.0011904239654541016
mini_batch_src_global generation:  0.0014126300811767578
r_  generation:  0.015158653259277344
local_output_nid generation:  0.003751516342163086
local_in_edges_tensor generation:  0.0018503665924072266
mini_batch_src_global generation:  0.0030612945556640625
r_  generation:  0.013633966445922852
local_output_nid generation:  0.002292156219482422
local_in_edges_tensor generation:  0.0010950565338134766
mini_batch_src_global generation:  0.0014798641204833984
r_  generation:  0.010514020919799805
local_output_nid generation:  0.002191781997680664
local_in_edges_tensor generation:  0.0010297298431396484
mini_batch_src_global generation:  0.0013308525085449219
r_  generation:  0.010493755340576172
local_output_nid generation:  0.0020978450775146484
local_in_edges_tensor generation:  0.0010485649108886719
mini_batch_src_global generation:  0.0012352466583251953
r_  generation:  0.010324478149414062
local_output_nid generation:  0.002039194107055664
local_in_edges_tensor generation:  0.0010132789611816406
mini_batch_src_global generation:  0.0011837482452392578
r_  generation:  0.010236263275146484
local_output_nid generation:  0.0019617080688476562
local_in_edges_tensor generation:  0.0010273456573486328
mini_batch_src_global generation:  0.0012006759643554688
r_  generation:  0.01034402847290039
local_output_nid generation:  0.0019540786743164062
local_in_edges_tensor generation:  0.001054525375366211
mini_batch_src_global generation:  0.0011785030364990234
r_  generation:  0.010314702987670898
local_output_nid generation:  0.0018889904022216797
local_in_edges_tensor generation:  0.0009737014770507812
mini_batch_src_global generation:  0.0011444091796875
r_  generation:  0.010343790054321289
local_output_nid generation:  0.0018472671508789062
local_in_edges_tensor generation:  0.0009534358978271484
mini_batch_src_global generation:  0.0011188983917236328
r_  generation:  0.010130643844604492
local_output_nid generation:  0.0018239021301269531
local_in_edges_tensor generation:  0.0009617805480957031
mini_batch_src_global generation:  0.0011179447174072266
r_  generation:  0.010129213333129883
local_output_nid generation:  0.001819610595703125
local_in_edges_tensor generation:  0.0009377002716064453
mini_batch_src_global generation:  0.0011184215545654297
r_  generation:  0.010044574737548828
local_output_nid generation:  0.001773834228515625
local_in_edges_tensor generation:  0.0009453296661376953
mini_batch_src_global generation:  0.0011174678802490234
r_  generation:  0.010099172592163086
local_output_nid generation:  0.0017445087432861328
local_in_edges_tensor generation:  0.000934600830078125
mini_batch_src_global generation:  0.0011751651763916016
r_  generation:  0.009984016418457031
local_output_nid generation:  0.0017404556274414062
local_in_edges_tensor generation:  0.0009722709655761719
mini_batch_src_global generation:  0.0011513233184814453
r_  generation:  0.010442256927490234
local_output_nid generation:  0.0017309188842773438
local_in_edges_tensor generation:  0.0009479522705078125
mini_batch_src_global generation:  0.0011653900146484375
r_  generation:  0.010181903839111328
local_output_nid generation:  0.001692056655883789
local_in_edges_tensor generation:  0.0009341239929199219
mini_batch_src_global generation:  0.0011436939239501953
r_  generation:  0.010322093963623047
local_output_nid generation:  0.0016949176788330078
local_in_edges_tensor generation:  0.0009388923645019531
mini_batch_src_global generation:  0.0012001991271972656
r_  generation:  0.010166406631469727
local_output_nid generation:  0.0016815662384033203
local_in_edges_tensor generation:  0.0009355545043945312
mini_batch_src_global generation:  0.0011377334594726562
r_  generation:  0.010134220123291016
----------------------check_connections_block total spend ----------------------------- 0.6314833164215088
generate_one_block  0.024479150772094727
generate_one_block  0.021701335906982422
generate_one_block  0.019761323928833008
generate_one_block  0.019214153289794922
generate_one_block  0.018094539642333984
generate_one_block  0.018543004989624023
generate_one_block  0.01831841468811035
generate_one_block  0.01859307289123535
generate_one_block  0.01862955093383789
generate_one_block  0.0184328556060791
generate_one_block  0.018582820892333984
generate_one_block  0.02104926109313965
generate_one_block  0.020110130310058594
generate_one_block  0.018296480178833008
generate_one_block  0.01857757568359375
generate_one_block  0.019773244857788086
generate_one_block  0.018520593643188477
generate_one_block  0.01837897300720215
generate_one_block  0.017988920211791992
generate_one_block  0.018214941024780273
generate_one_block  0.019472122192382812
generate_one_block  0.01815629005432129
generate_one_block  0.01781177520751953
generate_one_block  0.017720460891723633
generate_one_block  0.01786184310913086
generate_one_block  0.017720699310302734
generate_one_block  0.018767356872558594
generate_one_block  0.01834893226623535
generate_one_block  0.017970561981201172
generate_one_block  0.01828289031982422
generate_one_block  0.01795816421508789
generate_one_block  0.0177609920501709
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04847860336303711
gen group dst list time:  0.025454044342041016
time for parepare:  0.021917343139648438
local_output_nid generation:  0.006422519683837891
local_in_edges_tensor generation:  0.02093052864074707
mini_batch_src_global generation:  0.019898653030395508
r_  generation:  0.16846609115600586
local_output_nid generation:  0.009239673614501953
local_in_edges_tensor generation:  0.012115716934204102
mini_batch_src_global generation:  0.024837732315063477
r_  generation:  0.1785106658935547
local_output_nid generation:  0.009486913681030273
local_in_edges_tensor generation:  0.03794980049133301
mini_batch_src_global generation:  0.024508237838745117
r_  generation:  0.2132251262664795
local_output_nid generation:  0.009635448455810547
local_in_edges_tensor generation:  0.012269258499145508
mini_batch_src_global generation:  0.04465341567993164
r_  generation:  0.20352888107299805
local_output_nid generation:  0.014267683029174805
local_in_edges_tensor generation:  0.0188748836517334
mini_batch_src_global generation:  0.03745722770690918
r_  generation:  0.21385765075683594
local_output_nid generation:  0.012745380401611328
local_in_edges_tensor generation:  0.013516902923583984
mini_batch_src_global generation:  0.024531126022338867
r_  generation:  0.1864001750946045
local_output_nid generation:  0.010960817337036133
local_in_edges_tensor generation:  0.011698246002197266
mini_batch_src_global generation:  0.022622346878051758
r_  generation:  0.1853182315826416
local_output_nid generation:  0.009556055068969727
local_in_edges_tensor generation:  0.009449958801269531
mini_batch_src_global generation:  0.023167848587036133
r_  generation:  0.1819612979888916
local_output_nid generation:  0.009488344192504883
local_in_edges_tensor generation:  0.012233495712280273
mini_batch_src_global generation:  0.02423548698425293
r_  generation:  0.19658589363098145
local_output_nid generation:  0.011989355087280273
local_in_edges_tensor generation:  0.010244131088256836
mini_batch_src_global generation:  0.023495912551879883
r_  generation:  0.18111062049865723
local_output_nid generation:  0.009759664535522461
local_in_edges_tensor generation:  0.010869503021240234
mini_batch_src_global generation:  0.0249326229095459
r_  generation:  0.18709826469421387
local_output_nid generation:  0.00957632064819336
local_in_edges_tensor generation:  0.009387969970703125
mini_batch_src_global generation:  0.02390575408935547
r_  generation:  0.17765474319458008
local_output_nid generation:  0.010141134262084961
local_in_edges_tensor generation:  0.009133338928222656
mini_batch_src_global generation:  0.024678945541381836
r_  generation:  0.18907952308654785
local_output_nid generation:  0.009574413299560547
local_in_edges_tensor generation:  0.008965015411376953
mini_batch_src_global generation:  0.03612780570983887
r_  generation:  0.1994917392730713
local_output_nid generation:  0.01166081428527832
local_in_edges_tensor generation:  0.009292125701904297
mini_batch_src_global generation:  0.024823904037475586
r_  generation:  0.18973207473754883
local_output_nid generation:  0.010352373123168945
local_in_edges_tensor generation:  0.010051250457763672
mini_batch_src_global generation:  0.0238492488861084
r_  generation:  0.18878841400146484
local_output_nid generation:  0.009953498840332031
local_in_edges_tensor generation:  0.011626482009887695
mini_batch_src_global generation:  0.023922443389892578
r_  generation:  0.20110082626342773
local_output_nid generation:  0.009937047958374023
local_in_edges_tensor generation:  0.009201288223266602
mini_batch_src_global generation:  0.023327112197875977
r_  generation:  0.19142818450927734
local_output_nid generation:  0.009880781173706055
local_in_edges_tensor generation:  0.01186990737915039
mini_batch_src_global generation:  0.02416205406188965
r_  generation:  0.18506288528442383
local_output_nid generation:  0.009704351425170898
local_in_edges_tensor generation:  0.009783744812011719
mini_batch_src_global generation:  0.024917125701904297
r_  generation:  0.19090771675109863
local_output_nid generation:  0.009777545928955078
local_in_edges_tensor generation:  0.012848615646362305
mini_batch_src_global generation:  0.026183605194091797
r_  generation:  0.2333066463470459
local_output_nid generation:  0.016234874725341797
local_in_edges_tensor generation:  0.01875162124633789
mini_batch_src_global generation:  0.05049562454223633
r_  generation:  0.1913599967956543
local_output_nid generation:  0.012388229370117188
local_in_edges_tensor generation:  0.011165380477905273
mini_batch_src_global generation:  0.036544084548950195
r_  generation:  0.17963194847106934
local_output_nid generation:  0.01155996322631836
local_in_edges_tensor generation:  0.01488637924194336
mini_batch_src_global generation:  0.024077653884887695
r_  generation:  0.18442249298095703
local_output_nid generation:  0.010970592498779297
local_in_edges_tensor generation:  0.00917816162109375
mini_batch_src_global generation:  0.02303004264831543
r_  generation:  0.1814877986907959
local_output_nid generation:  0.009847879409790039
local_in_edges_tensor generation:  0.009623050689697266
mini_batch_src_global generation:  0.022174596786499023
r_  generation:  0.1759343147277832
local_output_nid generation:  0.009227275848388672
local_in_edges_tensor generation:  0.010912895202636719
mini_batch_src_global generation:  0.022352933883666992
r_  generation:  0.21995878219604492
local_output_nid generation:  0.009621381759643555
local_in_edges_tensor generation:  0.010657072067260742
mini_batch_src_global generation:  0.03760266304016113
r_  generation:  0.2292187213897705
local_output_nid generation:  0.010447502136230469
local_in_edges_tensor generation:  0.008924007415771484
mini_batch_src_global generation:  0.02435302734375
r_  generation:  0.18205523490905762
local_output_nid generation:  0.009891271591186523
local_in_edges_tensor generation:  0.009145259857177734
mini_batch_src_global generation:  0.023481130599975586
r_  generation:  0.18309378623962402
local_output_nid generation:  0.009837150573730469
local_in_edges_tensor generation:  0.009111404418945312
mini_batch_src_global generation:  0.03429007530212402
r_  generation:  0.2073497772216797
local_output_nid generation:  0.014876604080200195
local_in_edges_tensor generation:  0.012121438980102539
mini_batch_src_global generation:  0.02720022201538086
r_  generation:  0.23998546600341797
----------------------check_connections_block total spend ----------------------------- 9.26247787475586
generate_one_block  0.27050232887268066
generate_one_block  0.2517275810241699
generate_one_block  0.25139284133911133
generate_one_block  0.25039124488830566
generate_one_block  0.25687432289123535
generate_one_block  0.24513697624206543
generate_one_block  0.24560999870300293
generate_one_block  0.24717497825622559
generate_one_block  0.2487502098083496
generate_one_block  0.2532474994659424
generate_one_block  0.2592897415161133
generate_one_block  0.24786758422851562
generate_one_block  0.27146315574645996
generate_one_block  0.25225400924682617
generate_one_block  0.25707030296325684
generate_one_block  0.25600314140319824
generate_one_block  0.25303077697753906
generate_one_block  0.24641704559326172
generate_one_block  0.24215984344482422
generate_one_block  0.25146985054016113
generate_one_block  0.24204254150390625
generate_one_block  0.2405078411102295
generate_one_block  0.24033689498901367
generate_one_block  0.24672293663024902
generate_one_block  0.2470402717590332
generate_one_block  0.23829984664916992
generate_one_block  0.2349414825439453
generate_one_block  0.2526371479034424
generate_one_block  0.24360442161560059
generate_one_block  0.2461252212524414
generate_one_block  0.2439556121826172
generate_one_block  0.24269366264343262
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04562735557556152
gen group dst list time:  0.11389851570129395
time for parepare:  0.03713631629943848
local_output_nid generation:  0.027028322219848633
local_in_edges_tensor generation:  0.04954695701599121
mini_batch_src_global generation:  0.039434194564819336
r_  generation:  0.4276766777038574
local_output_nid generation:  0.03244900703430176
local_in_edges_tensor generation:  0.04076075553894043
mini_batch_src_global generation:  0.05222368240356445
r_  generation:  0.4293227195739746
local_output_nid generation:  0.03320741653442383
local_in_edges_tensor generation:  0.0351715087890625
mini_batch_src_global generation:  0.049094438552856445
r_  generation:  0.43964266777038574
local_output_nid generation:  0.03194117546081543
local_in_edges_tensor generation:  0.03101062774658203
mini_batch_src_global generation:  0.0516819953918457
r_  generation:  0.44358015060424805
local_output_nid generation:  0.03170466423034668
local_in_edges_tensor generation:  0.027189970016479492
mini_batch_src_global generation:  0.051206350326538086
r_  generation:  0.43935251235961914
local_output_nid generation:  0.03178143501281738
local_in_edges_tensor generation:  0.0319368839263916
mini_batch_src_global generation:  0.05079793930053711
r_  generation:  0.43592357635498047
local_output_nid generation:  0.031332969665527344
local_in_edges_tensor generation:  0.03251338005065918
mini_batch_src_global generation:  0.049639225006103516
r_  generation:  0.46285009384155273
local_output_nid generation:  0.03283238410949707
local_in_edges_tensor generation:  0.03125810623168945
mini_batch_src_global generation:  0.05256843566894531
r_  generation:  0.43322038650512695
local_output_nid generation:  0.030855417251586914
local_in_edges_tensor generation:  0.03090977668762207
mini_batch_src_global generation:  0.050637006759643555
r_  generation:  0.4380342960357666
local_output_nid generation:  0.030437946319580078
local_in_edges_tensor generation:  0.026587486267089844
mini_batch_src_global generation:  0.051203250885009766
r_  generation:  0.42984628677368164
local_output_nid generation:  0.030484676361083984
local_in_edges_tensor generation:  0.028489351272583008
mini_batch_src_global generation:  0.05394792556762695
r_  generation:  0.4414334297180176
local_output_nid generation:  0.030404329299926758
local_in_edges_tensor generation:  0.0293428897857666
mini_batch_src_global generation:  0.05084085464477539
r_  generation:  0.44317078590393066
local_output_nid generation:  0.030747175216674805
local_in_edges_tensor generation:  0.028829336166381836
mini_batch_src_global generation:  0.053145647048950195
r_  generation:  0.44174885749816895
local_output_nid generation:  0.03039860725402832
local_in_edges_tensor generation:  0.029054880142211914
mini_batch_src_global generation:  0.05095100402832031
r_  generation:  0.4356513023376465
local_output_nid generation:  0.030048608779907227
local_in_edges_tensor generation:  0.03392529487609863
mini_batch_src_global generation:  0.049759864807128906
r_  generation:  0.4355888366699219
local_output_nid generation:  0.031220197677612305
local_in_edges_tensor generation:  0.030280351638793945
mini_batch_src_global generation:  0.056229591369628906
r_  generation:  0.4431345462799072
local_output_nid generation:  0.03064107894897461
local_in_edges_tensor generation:  0.027631044387817383
mini_batch_src_global generation:  0.04987287521362305
r_  generation:  0.43903040885925293
local_output_nid generation:  0.032193899154663086
local_in_edges_tensor generation:  0.031058788299560547
mini_batch_src_global generation:  0.05264091491699219
r_  generation:  0.4442760944366455
local_output_nid generation:  0.030501365661621094
local_in_edges_tensor generation:  0.029233694076538086
mini_batch_src_global generation:  0.0499567985534668
r_  generation:  0.44541406631469727
local_output_nid generation:  0.030593156814575195
local_in_edges_tensor generation:  0.026777267456054688
mini_batch_src_global generation:  0.0506901741027832
r_  generation:  0.4328446388244629
local_output_nid generation:  0.03050851821899414
local_in_edges_tensor generation:  0.028924942016601562
mini_batch_src_global generation:  0.05137228965759277
r_  generation:  0.439849853515625
local_output_nid generation:  0.03043818473815918
local_in_edges_tensor generation:  0.02946162223815918
mini_batch_src_global generation:  0.050690650939941406
r_  generation:  0.43404531478881836
local_output_nid generation:  0.030384302139282227
local_in_edges_tensor generation:  0.030927658081054688
mini_batch_src_global generation:  0.049590349197387695
r_  generation:  0.43685388565063477
local_output_nid generation:  0.030150413513183594
local_in_edges_tensor generation:  0.030373334884643555
mini_batch_src_global generation:  0.05097198486328125
r_  generation:  0.4417538642883301
local_output_nid generation:  0.030448436737060547
local_in_edges_tensor generation:  0.028597593307495117
mini_batch_src_global generation:  0.051416873931884766
r_  generation:  0.4495728015899658
local_output_nid generation:  0.032469749450683594
local_in_edges_tensor generation:  0.0271453857421875
mini_batch_src_global generation:  0.05176901817321777
r_  generation:  0.43191051483154297
local_output_nid generation:  0.02973794937133789
local_in_edges_tensor generation:  0.02818918228149414
mini_batch_src_global generation:  0.04930877685546875
r_  generation:  0.42949509620666504
local_output_nid generation:  0.030303001403808594
local_in_edges_tensor generation:  0.026978731155395508
mini_batch_src_global generation:  0.0510256290435791
r_  generation:  0.4355041980743408
local_output_nid generation:  0.0304872989654541
local_in_edges_tensor generation:  0.030487060546875
mini_batch_src_global generation:  0.05048799514770508
r_  generation:  0.4432692527770996
local_output_nid generation:  0.030284404754638672
local_in_edges_tensor generation:  0.02875685691833496
mini_batch_src_global generation:  0.05135297775268555
r_  generation:  0.43720149993896484
local_output_nid generation:  0.030460119247436523
local_in_edges_tensor generation:  0.02679133415222168
mini_batch_src_global generation:  0.04996371269226074
r_  generation:  0.44144463539123535
local_output_nid generation:  0.03056788444519043
local_in_edges_tensor generation:  0.030802249908447266
mini_batch_src_global generation:  0.05064892768859863
r_  generation:  0.43357181549072266
----------------------check_connections_block total spend ----------------------------- 20.768863677978516
generate_one_block  0.593071699142456
generate_one_block  0.5864052772521973
generate_one_block  0.591801643371582
generate_one_block  0.5870664119720459
generate_one_block  0.6842081546783447
generate_one_block  0.5807147026062012
generate_one_block  0.5787911415100098
generate_one_block  0.5822052955627441
generate_one_block  0.5999946594238281
generate_one_block  0.5686323642730713
generate_one_block  0.5804448127746582
generate_one_block  0.573601484298706
generate_one_block  0.5830416679382324
generate_one_block  0.5770213603973389
generate_one_block  0.5749599933624268
generate_one_block  0.5795536041259766
generate_one_block  0.5821404457092285
generate_one_block  0.5803067684173584
generate_one_block  0.5755047798156738
generate_one_block  0.5794093608856201
generate_one_block  0.5759842395782471
generate_one_block  0.5762810707092285
generate_one_block  0.5770070552825928
generate_one_block  0.5805718898773193
generate_one_block  0.5927605628967285
generate_one_block  0.5755941867828369
generate_one_block  0.5698416233062744
generate_one_block  0.5850372314453125
generate_one_block  0.5801723003387451
generate_one_block  0.579667329788208
generate_one_block  0.5884060859680176
generate_one_block  0.5837843418121338
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.12619829177856445  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

connection checking time:  30.031341552734375
block generation total time  26.68072485923767
average batch blocks generation time:  0.8337726518511772
block dataloader generation time/epoch 59.54033263991861
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10668611526489258  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.80558681488037  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10691118240356445  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.120790481567383  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10670280456542969  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.19913673400879  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10689067840576172  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.18778657913208  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10630989074707031  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.675212860107422  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10660505294799805  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.999460220336914  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10648250579833984  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.957499027252197  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10653018951416016  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.984899520874023  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10805988311767578  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.15659189224243  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10631656646728516  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.86781072616577  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10669660568237305  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.266786575317383  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10640573501586914  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.70450448989868  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10699272155761719  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.328528881072998  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.1063995361328125  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.882785320281982  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10625600814819336  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.13632583618164  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10692501068115234  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.111130237579346  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10675048828125  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.072020053863525  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10700559616088867  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.108445644378662  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10645294189453125  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.63458776473999  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10642099380493164  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.869138717651367  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10674285888671875  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.82627248764038  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10629081726074219  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.626685619354248  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10651540756225586  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.61417007446289  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10645818710327148  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.856704711914062  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10667991638183594  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.68637180328369  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.1062321662902832  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.58146333694458  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10578632354736328  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.219550609588623  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10654115676879883  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.09127712249756  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10668420791625977  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.806718826293945  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10634374618530273  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.85121202468872  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10668420791625977  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.868712902069092  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10665225982666016  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.71791982650757  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03425717353820801 |0.019758231937885284 |0.5528123006224632 |9.388476610183716e-05 |1.0654137209057808 |0.005504608154296875 |
----------------------------------------------------------pseudo_mini_loss sum 1.2709263563156128
Total (block generation + training)time/epoch 113.27609837756438
Training time/epoch 53.57637858390808
Training time without block to device /epoch 52.94411516189575
Training time without total dataloading part /epoch 51.791741609573364
load block tensor time/epoch 1.0962295532226562
block to device time/epoch 0.6322634220123291
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 26 |
Number of nodes for computation during this epoch:  9110642
Number of first layer input nodes during this epoch:  4760884
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.12656545639038086  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025162220001220703
random selection method range initialization spend 0.0069844722747802734
time for parepare:  0.020776748657226562
local_output_nid generation:  0.0013463497161865234
local_in_edges_tensor generation:  0.0040819644927978516
mini_batch_src_global generation:  0.0023109912872314453
r_  generation:  0.01203775405883789
local_output_nid generation:  0.001667022705078125
local_in_edges_tensor generation:  0.0010576248168945312
mini_batch_src_global generation:  0.0014979839324951172
r_  generation:  0.01013040542602539
local_output_nid generation:  0.0016300678253173828
local_in_edges_tensor generation:  0.0010106563568115234
mini_batch_src_global generation:  0.0012273788452148438
r_  generation:  0.010086536407470703
local_output_nid generation:  0.001589059829711914
local_in_edges_tensor generation:  0.0009403228759765625
mini_batch_src_global generation:  0.001171112060546875
r_  generation:  0.010069608688354492
local_output_nid generation:  0.0015866756439208984
local_in_edges_tensor generation:  0.0009138584136962891
mini_batch_src_global generation:  0.001230001449584961
r_  generation:  0.01020956039428711
local_output_nid generation:  0.0015895366668701172
local_in_edges_tensor generation:  0.0009300708770751953
mini_batch_src_global generation:  0.0011751651763916016
r_  generation:  0.010051965713500977
local_output_nid generation:  0.0015876293182373047
local_in_edges_tensor generation:  0.0009312629699707031
mini_batch_src_global generation:  0.0011925697326660156
r_  generation:  0.00995326042175293
local_output_nid generation:  0.0015614032745361328
local_in_edges_tensor generation:  0.0009770393371582031
mini_batch_src_global generation:  0.001132965087890625
r_  generation:  0.00996541976928711
local_output_nid generation:  0.0015642642974853516
local_in_edges_tensor generation:  0.0008890628814697266
mini_batch_src_global generation:  0.0010800361633300781
r_  generation:  0.009976387023925781
local_output_nid generation:  0.0015752315521240234
local_in_edges_tensor generation:  0.0009255409240722656
mini_batch_src_global generation:  0.001127481460571289
r_  generation:  0.010075092315673828
local_output_nid generation:  0.0015692710876464844
local_in_edges_tensor generation:  0.0009214878082275391
mini_batch_src_global generation:  0.0011069774627685547
r_  generation:  0.010041236877441406
local_output_nid generation:  0.0015590190887451172
local_in_edges_tensor generation:  0.0008618831634521484
mini_batch_src_global generation:  0.0011589527130126953
r_  generation:  0.010253667831420898
local_output_nid generation:  0.001585245132446289
local_in_edges_tensor generation:  0.0008661746978759766
mini_batch_src_global generation:  0.0011279582977294922
r_  generation:  0.010247230529785156
local_output_nid generation:  0.0015964508056640625
local_in_edges_tensor generation:  0.0009315013885498047
mini_batch_src_global generation:  0.0011749267578125
r_  generation:  0.010500907897949219
local_output_nid generation:  0.0015604496002197266
local_in_edges_tensor generation:  0.0009472370147705078
mini_batch_src_global generation:  0.001224517822265625
r_  generation:  0.010587692260742188
local_output_nid generation:  0.0015723705291748047
local_in_edges_tensor generation:  0.0008714199066162109
mini_batch_src_global generation:  0.0011096000671386719
r_  generation:  0.01004338264465332
local_output_nid generation:  0.0015630722045898438
local_in_edges_tensor generation:  0.0009777545928955078
mini_batch_src_global generation:  0.0011372566223144531
r_  generation:  0.010267972946166992
local_output_nid generation:  0.001558542251586914
local_in_edges_tensor generation:  0.0008821487426757812
mini_batch_src_global generation:  0.0012199878692626953
r_  generation:  0.010419607162475586
local_output_nid generation:  0.001552581787109375
local_in_edges_tensor generation:  0.0008831024169921875
mini_batch_src_global generation:  0.0012581348419189453
r_  generation:  0.010355234146118164
local_output_nid generation:  0.0015649795532226562
local_in_edges_tensor generation:  0.0008826255798339844
mini_batch_src_global generation:  0.0011429786682128906
r_  generation:  0.010159015655517578
local_output_nid generation:  0.001544952392578125
local_in_edges_tensor generation:  0.0009443759918212891
mini_batch_src_global generation:  0.0011303424835205078
r_  generation:  0.009686946868896484
local_output_nid generation:  0.0015568733215332031
local_in_edges_tensor generation:  0.0008909702301025391
mini_batch_src_global generation:  0.001138448715209961
r_  generation:  0.010330915451049805
local_output_nid generation:  0.0015676021575927734
local_in_edges_tensor generation:  0.0008871555328369141
mini_batch_src_global generation:  0.0011222362518310547
r_  generation:  0.010303258895874023
local_output_nid generation:  0.0015842914581298828
local_in_edges_tensor generation:  0.0008738040924072266
mini_batch_src_global generation:  0.0012078285217285156
r_  generation:  0.009883880615234375
local_output_nid generation:  0.001596212387084961
local_in_edges_tensor generation:  0.0008928775787353516
mini_batch_src_global generation:  0.0011675357818603516
r_  generation:  0.010521411895751953
local_output_nid generation:  0.0015764236450195312
local_in_edges_tensor generation:  0.0008728504180908203
mini_batch_src_global generation:  0.0012047290802001953
r_  generation:  0.01027059555053711
local_output_nid generation:  0.0015578269958496094
local_in_edges_tensor generation:  0.0008840560913085938
mini_batch_src_global generation:  0.001127004623413086
r_  generation:  0.010106801986694336
local_output_nid generation:  0.0015664100646972656
local_in_edges_tensor generation:  0.0008862018585205078
mini_batch_src_global generation:  0.0011284351348876953
r_  generation:  0.010062694549560547
local_output_nid generation:  0.0015697479248046875
local_in_edges_tensor generation:  0.0009045600891113281
mini_batch_src_global generation:  0.0010988712310791016
r_  generation:  0.010060787200927734
local_output_nid generation:  0.0015790462493896484
local_in_edges_tensor generation:  0.0008623600006103516
mini_batch_src_global generation:  0.001123666763305664
r_  generation:  0.01025390625
local_output_nid generation:  0.0016007423400878906
local_in_edges_tensor generation:  0.0008914470672607422
mini_batch_src_global generation:  0.001163482666015625
r_  generation:  0.010219335556030273
local_output_nid generation:  0.001558542251586914
local_in_edges_tensor generation:  0.0008714199066162109
mini_batch_src_global generation:  0.00113677978515625
r_  generation:  0.010221004486083984
----------------------check_connections_block total spend ----------------------------- 0.5632479190826416
generate_one_block  0.025003671646118164
generate_one_block  0.020494699478149414
generate_one_block  0.019205331802368164
generate_one_block  0.018491268157958984
generate_one_block  0.01869797706604004
generate_one_block  0.018064260482788086
generate_one_block  0.017796754837036133
generate_one_block  0.01787567138671875
generate_one_block  0.021433115005493164
generate_one_block  0.018031835556030273
generate_one_block  0.017645597457885742
generate_one_block  0.020567893981933594
generate_one_block  0.01893472671508789
generate_one_block  0.018183469772338867
generate_one_block  0.018471479415893555
generate_one_block  0.017842531204223633
generate_one_block  0.017985820770263672
generate_one_block  0.018306255340576172
generate_one_block  0.018021821975708008
generate_one_block  0.017889976501464844
generate_one_block  0.016968965530395508
generate_one_block  0.01837944984436035
generate_one_block  0.01803112030029297
generate_one_block  0.017296791076660156
generate_one_block  0.018779754638671875
generate_one_block  0.01807427406311035
generate_one_block  0.017647981643676758
generate_one_block  0.017592906951904297
generate_one_block  0.017653942108154297
generate_one_block  0.01829838752746582
generate_one_block  0.01806497573852539
generate_one_block  0.018142223358154297
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.039699554443359375
gen group dst list time:  0.02243185043334961
time for parepare:  0.019423961639404297
local_output_nid generation:  0.006679058074951172
local_in_edges_tensor generation:  0.019389867782592773
mini_batch_src_global generation:  0.019280195236206055
r_  generation:  0.16965866088867188
local_output_nid generation:  0.00904393196105957
local_in_edges_tensor generation:  0.011983871459960938
mini_batch_src_global generation:  0.02162337303161621
r_  generation:  0.2000563144683838
local_output_nid generation:  0.015592813491821289
local_in_edges_tensor generation:  0.047461509704589844
mini_batch_src_global generation:  0.024760007858276367
r_  generation:  0.17686152458190918
local_output_nid generation:  0.011540889739990234
local_in_edges_tensor generation:  0.011515378952026367
mini_batch_src_global generation:  0.02444291114807129
r_  generation:  0.18564391136169434
local_output_nid generation:  0.010425806045532227
local_in_edges_tensor generation:  0.01098489761352539
mini_batch_src_global generation:  0.025495290756225586
r_  generation:  0.18594980239868164
local_output_nid generation:  0.009222745895385742
local_in_edges_tensor generation:  0.01194310188293457
mini_batch_src_global generation:  0.028088092803955078
r_  generation:  0.1822350025177002
local_output_nid generation:  0.008994340896606445
local_in_edges_tensor generation:  0.010345935821533203
mini_batch_src_global generation:  0.025901079177856445
r_  generation:  0.17971491813659668
local_output_nid generation:  0.008923530578613281
local_in_edges_tensor generation:  0.009016275405883789
mini_batch_src_global generation:  0.024761199951171875
r_  generation:  0.19078922271728516
local_output_nid generation:  0.01118779182434082
local_in_edges_tensor generation:  0.011122465133666992
mini_batch_src_global generation:  0.02344799041748047
r_  generation:  0.17522120475769043
local_output_nid generation:  0.009169340133666992
local_in_edges_tensor generation:  0.008952140808105469
mini_batch_src_global generation:  0.02246689796447754
r_  generation:  0.17829465866088867
local_output_nid generation:  0.009078502655029297
local_in_edges_tensor generation:  0.010370731353759766
mini_batch_src_global generation:  0.022363901138305664
r_  generation:  0.1780109405517578
local_output_nid generation:  0.009223222732543945
local_in_edges_tensor generation:  0.008819818496704102
mini_batch_src_global generation:  0.022766590118408203
r_  generation:  0.17867588996887207
local_output_nid generation:  0.009482145309448242
local_in_edges_tensor generation:  0.009163141250610352
mini_batch_src_global generation:  0.02272486686706543
r_  generation:  0.1806802749633789
local_output_nid generation:  0.009400129318237305
local_in_edges_tensor generation:  0.008941888809204102
mini_batch_src_global generation:  0.02280902862548828
r_  generation:  0.18020963668823242
local_output_nid generation:  0.009605884552001953
local_in_edges_tensor generation:  0.009311437606811523
mini_batch_src_global generation:  0.023694515228271484
r_  generation:  0.18721508979797363
local_output_nid generation:  0.009356260299682617
local_in_edges_tensor generation:  0.008961677551269531
mini_batch_src_global generation:  0.023474693298339844
r_  generation:  0.1868588924407959
local_output_nid generation:  0.009484291076660156
local_in_edges_tensor generation:  0.009251117706298828
mini_batch_src_global generation:  0.023456811904907227
r_  generation:  0.22055602073669434
local_output_nid generation:  0.00960397720336914
local_in_edges_tensor generation:  0.009891271591186523
mini_batch_src_global generation:  0.0248565673828125
r_  generation:  0.22178936004638672
local_output_nid generation:  0.009479045867919922
local_in_edges_tensor generation:  0.01047205924987793
mini_batch_src_global generation:  0.022936582565307617
r_  generation:  0.18922758102416992
local_output_nid generation:  0.009505748748779297
local_in_edges_tensor generation:  0.009146928787231445
mini_batch_src_global generation:  0.022902488708496094
r_  generation:  0.17914628982543945
local_output_nid generation:  0.009110212326049805
local_in_edges_tensor generation:  0.00947713851928711
mini_batch_src_global generation:  0.024079084396362305
r_  generation:  0.17941856384277344
local_output_nid generation:  0.009762763977050781
local_in_edges_tensor generation:  0.009310483932495117
mini_batch_src_global generation:  0.023552894592285156
r_  generation:  0.19099831581115723
local_output_nid generation:  0.009406566619873047
local_in_edges_tensor generation:  0.014317512512207031
mini_batch_src_global generation:  0.024349212646484375
r_  generation:  0.1884171962738037
local_output_nid generation:  0.010070323944091797
local_in_edges_tensor generation:  0.013254165649414062
mini_batch_src_global generation:  0.021886348724365234
r_  generation:  0.17534160614013672
local_output_nid generation:  0.00978231430053711
local_in_edges_tensor generation:  0.010420083999633789
mini_batch_src_global generation:  0.026750564575195312
r_  generation:  0.1936938762664795
local_output_nid generation:  0.009489297866821289
local_in_edges_tensor generation:  0.01245737075805664
mini_batch_src_global generation:  0.02365875244140625
r_  generation:  0.18739771842956543
local_output_nid generation:  0.010921955108642578
local_in_edges_tensor generation:  0.010119199752807617
mini_batch_src_global generation:  0.023261547088623047
r_  generation:  0.184922456741333
local_output_nid generation:  0.00940084457397461
local_in_edges_tensor generation:  0.010477542877197266
mini_batch_src_global generation:  0.02270793914794922
r_  generation:  0.18357467651367188
local_output_nid generation:  0.01275777816772461
local_in_edges_tensor generation:  0.00979757308959961
mini_batch_src_global generation:  0.028489112854003906
r_  generation:  0.1813974380493164
local_output_nid generation:  0.009535074234008789
local_in_edges_tensor generation:  0.010134458541870117
mini_batch_src_global generation:  0.023117542266845703
r_  generation:  0.18428921699523926
local_output_nid generation:  0.009500741958618164
local_in_edges_tensor generation:  0.0098876953125
mini_batch_src_global generation:  0.023046255111694336
r_  generation:  0.18406057357788086
local_output_nid generation:  0.009604930877685547
local_in_edges_tensor generation:  0.010085582733154297
mini_batch_src_global generation:  0.02356886863708496
r_  generation:  0.18771982192993164
----------------------check_connections_block total spend ----------------------------- 8.720990180969238
generate_one_block  0.2691957950592041
generate_one_block  0.23563647270202637
generate_one_block  0.2470378875732422
generate_one_block  0.2509431838989258
generate_one_block  0.26802754402160645
generate_one_block  0.2427361011505127
generate_one_block  0.24476122856140137
generate_one_block  0.24543333053588867
generate_one_block  0.24219679832458496
generate_one_block  0.25795626640319824
generate_one_block  0.2442488670349121
generate_one_block  0.2477271556854248
generate_one_block  0.25171470642089844
generate_one_block  0.2490382194519043
generate_one_block  0.25275516510009766
generate_one_block  0.2518150806427002
generate_one_block  0.25099802017211914
generate_one_block  0.2557942867279053
generate_one_block  0.2469625473022461
generate_one_block  0.2506880760192871
generate_one_block  0.23532557487487793
generate_one_block  0.2550513744354248
generate_one_block  0.2474994659423828
generate_one_block  0.23245930671691895
generate_one_block  0.25613999366760254
generate_one_block  0.254148006439209
generate_one_block  0.2511897087097168
generate_one_block  0.24763202667236328
generate_one_block  0.24347329139709473
generate_one_block  0.24836277961730957
generate_one_block  0.24910688400268555
generate_one_block  0.2499852180480957
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0352940559387207
gen group dst list time:  0.11559557914733887
time for parepare:  0.01998448371887207
local_output_nid generation:  0.02717280387878418
local_in_edges_tensor generation:  0.04666614532470703
mini_batch_src_global generation:  0.03963065147399902
r_  generation:  0.4281904697418213
local_output_nid generation:  0.03147554397583008
local_in_edges_tensor generation:  0.03228569030761719
mini_batch_src_global generation:  0.051572561264038086
r_  generation:  0.42367124557495117
local_output_nid generation:  0.03176093101501465
local_in_edges_tensor generation:  0.030375242233276367
mini_batch_src_global generation:  0.05004477500915527
r_  generation:  0.45015597343444824
local_output_nid generation:  0.03440356254577637
local_in_edges_tensor generation:  0.030266761779785156
mini_batch_src_global generation:  0.04998302459716797
r_  generation:  0.43220019340515137
local_output_nid generation:  0.03152298927307129
local_in_edges_tensor generation:  0.02944159507751465
mini_batch_src_global generation:  0.05109715461730957
r_  generation:  0.4451427459716797
local_output_nid generation:  0.03150129318237305
local_in_edges_tensor generation:  0.03151392936706543
mini_batch_src_global generation:  0.05042576789855957
r_  generation:  0.4413871765136719
local_output_nid generation:  0.030125856399536133
local_in_edges_tensor generation:  0.028623104095458984
mini_batch_src_global generation:  0.04999232292175293
r_  generation:  0.4421560764312744
local_output_nid generation:  0.02952408790588379
local_in_edges_tensor generation:  0.030391693115234375
mini_batch_src_global generation:  0.05099821090698242
r_  generation:  0.4397459030151367
local_output_nid generation:  0.029419422149658203
local_in_edges_tensor generation:  0.03440260887145996
mini_batch_src_global generation:  0.0498356819152832
r_  generation:  0.4413316249847412
local_output_nid generation:  0.029332399368286133
local_in_edges_tensor generation:  0.028513669967651367
mini_batch_src_global generation:  0.05058908462524414
r_  generation:  0.44117069244384766
local_output_nid generation:  0.03067183494567871
local_in_edges_tensor generation:  0.033537864685058594
mini_batch_src_global generation:  0.05202746391296387
r_  generation:  0.4430410861968994
local_output_nid generation:  0.03102707862854004
local_in_edges_tensor generation:  0.02666616439819336
mini_batch_src_global generation:  0.050863027572631836
r_  generation:  0.43893957138061523
local_output_nid generation:  0.030003786087036133
local_in_edges_tensor generation:  0.03088998794555664
mini_batch_src_global generation:  0.05122017860412598
r_  generation:  0.44120311737060547
local_output_nid generation:  0.029741525650024414
local_in_edges_tensor generation:  0.029314517974853516
mini_batch_src_global generation:  0.05186104774475098
r_  generation:  0.4381239414215088
local_output_nid generation:  0.029953718185424805
local_in_edges_tensor generation:  0.02887725830078125
mini_batch_src_global generation:  0.05169844627380371
r_  generation:  0.45016980171203613
local_output_nid generation:  0.03249859809875488
local_in_edges_tensor generation:  0.02672719955444336
mini_batch_src_global generation:  0.0545504093170166
r_  generation:  0.44766974449157715
local_output_nid generation:  0.03272724151611328
local_in_edges_tensor generation:  0.028639554977416992
mini_batch_src_global generation:  0.0510556697845459
r_  generation:  0.4441084861755371
local_output_nid generation:  0.030599594116210938
local_in_edges_tensor generation:  0.02893996238708496
mini_batch_src_global generation:  0.050987958908081055
r_  generation:  0.43999600410461426
local_output_nid generation:  0.030466794967651367
local_in_edges_tensor generation:  0.026869535446166992
mini_batch_src_global generation:  0.04959726333618164
r_  generation:  0.4411749839782715
local_output_nid generation:  0.030568838119506836
local_in_edges_tensor generation:  0.028292417526245117
mini_batch_src_global generation:  0.052370548248291016
r_  generation:  0.4478604793548584
local_output_nid generation:  0.030249595642089844
local_in_edges_tensor generation:  0.030584335327148438
mini_batch_src_global generation:  0.050102949142456055
r_  generation:  0.4333326816558838
local_output_nid generation:  0.030575990676879883
local_in_edges_tensor generation:  0.027241230010986328
mini_batch_src_global generation:  0.051023006439208984
r_  generation:  0.4428987503051758
local_output_nid generation:  0.030452489852905273
local_in_edges_tensor generation:  0.028659820556640625
mini_batch_src_global generation:  0.050104618072509766
r_  generation:  0.4466586112976074
local_output_nid generation:  0.03029942512512207
local_in_edges_tensor generation:  0.026925086975097656
mini_batch_src_global generation:  0.050423383712768555
r_  generation:  0.4415121078491211
local_output_nid generation:  0.030464649200439453
local_in_edges_tensor generation:  0.028792142868041992
mini_batch_src_global generation:  0.049933433532714844
r_  generation:  0.4424920082092285
local_output_nid generation:  0.031117916107177734
local_in_edges_tensor generation:  0.03149008750915527
mini_batch_src_global generation:  0.05127668380737305
r_  generation:  0.4448268413543701
local_output_nid generation:  0.03043508529663086
local_in_edges_tensor generation:  0.026706218719482422
mini_batch_src_global generation:  0.04906964302062988
r_  generation:  0.4442329406738281
local_output_nid generation:  0.030229568481445312
local_in_edges_tensor generation:  0.02847456932067871
mini_batch_src_global generation:  0.05304718017578125
r_  generation:  0.444138765335083
local_output_nid generation:  0.030402183532714844
local_in_edges_tensor generation:  0.027146100997924805
mini_batch_src_global generation:  0.049803972244262695
r_  generation:  0.4416322708129883
local_output_nid generation:  0.030617713928222656
local_in_edges_tensor generation:  0.029003381729125977
mini_batch_src_global generation:  0.052464962005615234
r_  generation:  0.4411275386810303
local_output_nid generation:  0.030440092086791992
local_in_edges_tensor generation:  0.03080272674560547
mini_batch_src_global generation:  0.05022263526916504
r_  generation:  0.4410088062286377
local_output_nid generation:  0.03046727180480957
local_in_edges_tensor generation:  0.027861356735229492
mini_batch_src_global generation:  0.05415034294128418
r_  generation:  0.439206600189209
----------------------check_connections_block total spend ----------------------------- 20.79545760154724
generate_one_block  0.5976738929748535
generate_one_block  0.5816617012023926
generate_one_block  0.5882205963134766
generate_one_block  0.5900332927703857
generate_one_block  0.6886348724365234
generate_one_block  0.5816442966461182
generate_one_block  0.5877022743225098
generate_one_block  0.5802590847015381
generate_one_block  0.5799863338470459
generate_one_block  0.5784738063812256
generate_one_block  0.5813591480255127
generate_one_block  0.5899932384490967
generate_one_block  0.5870981216430664
generate_one_block  0.5797443389892578
generate_one_block  0.5879278182983398
generate_one_block  0.5918750762939453
generate_one_block  0.589881181716919
generate_one_block  0.580836296081543
generate_one_block  0.5779588222503662
generate_one_block  0.5810112953186035
generate_one_block  0.576472282409668
generate_one_block  0.590216875076294
generate_one_block  0.579481840133667
generate_one_block  0.5767874717712402
generate_one_block  0.6053154468536377
generate_one_block  0.5894773006439209
generate_one_block  0.5833947658538818
generate_one_block  0.5804431438446045
generate_one_block  0.5932042598724365
generate_one_block  0.5926380157470703
generate_one_block  0.5788841247558594
generate_one_block  0.5856993198394775
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.12656545639038086  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

connection checking time:  29.51644778251648
block generation total time  26.810030698776245
average batch blocks generation time:  0.8378134593367577
block dataloader generation time/epoch 59.546073185073006
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10696029663085938  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.311787605285645  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.1063075065612793  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.459579467773438  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10795116424560547  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.008477687835693  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.1066136360168457  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.169411659240723  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10683155059814453  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.254143238067627  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.1061854362487793  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.798677921295166  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10659646987915039  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.892559051513672  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10642242431640625  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.810945510864258  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10638761520385742  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.495978832244873  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10636472702026367  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.70173406600952  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10643434524536133  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.731672763824463  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10670328140258789  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.854790210723877  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10670089721679688  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.903799057006836  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.1064748764038086  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.875380992889404  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10692405700683594  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.145851135253906  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10677337646484375  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.13815975189209  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10654878616333008  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.039592266082764  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.1069021224975586  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.144527435302734  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10654687881469727  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.819759845733643  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10665321350097656  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.70387840270996  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10606241226196289  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.234923839569092  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10693120956420898  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.19905138015747  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10655021667480469  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.882065773010254  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10629129409790039  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.174126148223877  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.1069183349609375  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.258856296539307  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10680723190307617  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.15833854675293  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10654830932617188  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.895588397979736  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10653066635131836  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.799402236938477  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10654449462890625  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.782191276550293  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10684967041015625  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.046714782714844  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.1066746711730957  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.9952130317688  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10654401779174805  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.05594301223755  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03353416919708252 |0.020948626101017 |0.5615302547812462 |9.647011756896973e-05 |1.069273293018341 |0.00538325309753418 |
----------------------------------------------------------pseudo_mini_loss sum 1.259975790977478
Total (block generation + training)time/epoch 113.29604617754619
Training time/epoch 53.99123287200928
Training time without block to device /epoch 53.32087683677673
Training time without total dataloading part /epoch 52.19418382644653
load block tensor time/epoch 1.0730934143066406
block to device time/epoch 0.670356035232544
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 27 |
Number of nodes for computation during this epoch:  9114868
Number of first layer input nodes during this epoch:  4763036
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.1265716552734375  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023689746856689453
random selection method range initialization spend 0.006716251373291016
time for parepare:  0.021458148956298828
local_output_nid generation:  0.0014023780822753906
local_in_edges_tensor generation:  0.003992557525634766
mini_batch_src_global generation:  0.002364635467529297
r_  generation:  0.011723518371582031
local_output_nid generation:  0.0016942024230957031
local_in_edges_tensor generation:  0.0009942054748535156
mini_batch_src_global generation:  0.0016713142395019531
r_  generation:  0.01028299331665039
local_output_nid generation:  0.0016369819641113281
local_in_edges_tensor generation:  0.0009033679962158203
mini_batch_src_global generation:  0.0012042522430419922
r_  generation:  0.00969386100769043
local_output_nid generation:  0.0016198158264160156
local_in_edges_tensor generation:  0.0008935928344726562
mini_batch_src_global generation:  0.0012009143829345703
r_  generation:  0.009916543960571289
local_output_nid generation:  0.0015897750854492188
local_in_edges_tensor generation:  0.0009050369262695312
mini_batch_src_global generation:  0.0011837482452392578
r_  generation:  0.010016441345214844
local_output_nid generation:  0.0015912055969238281
local_in_edges_tensor generation:  0.0008924007415771484
mini_batch_src_global generation:  0.0011668205261230469
r_  generation:  0.010024070739746094
local_output_nid generation:  0.0015864372253417969
local_in_edges_tensor generation:  0.0008921623229980469
mini_batch_src_global generation:  0.0011470317840576172
r_  generation:  0.009978294372558594
local_output_nid generation:  0.0015728473663330078
local_in_edges_tensor generation:  0.0008897781372070312
mini_batch_src_global generation:  0.0011920928955078125
r_  generation:  0.010225057601928711
local_output_nid generation:  0.0015931129455566406
local_in_edges_tensor generation:  0.0008766651153564453
mini_batch_src_global generation:  0.0011584758758544922
r_  generation:  0.010374069213867188
local_output_nid generation:  0.001592874526977539
local_in_edges_tensor generation:  0.0008790493011474609
mini_batch_src_global generation:  0.001134634017944336
r_  generation:  0.010118246078491211
local_output_nid generation:  0.0016052722930908203
local_in_edges_tensor generation:  0.0009121894836425781
mini_batch_src_global generation:  0.0011794567108154297
r_  generation:  0.010536432266235352
local_output_nid generation:  0.0015854835510253906
local_in_edges_tensor generation:  0.0009174346923828125
mini_batch_src_global generation:  0.0012111663818359375
r_  generation:  0.010817289352416992
local_output_nid generation:  0.0015833377838134766
local_in_edges_tensor generation:  0.0009236335754394531
mini_batch_src_global generation:  0.0012640953063964844
r_  generation:  0.010669946670532227
local_output_nid generation:  0.001583099365234375
local_in_edges_tensor generation:  0.0009119510650634766
mini_batch_src_global generation:  0.0011799335479736328
r_  generation:  0.010612010955810547
local_output_nid generation:  0.0015845298767089844
local_in_edges_tensor generation:  0.0009057521820068359
mini_batch_src_global generation:  0.0011641979217529297
r_  generation:  0.010421276092529297
local_output_nid generation:  0.0015897750854492188
local_in_edges_tensor generation:  0.0009400844573974609
mini_batch_src_global generation:  0.00127410888671875
r_  generation:  0.0110626220703125
local_output_nid generation:  0.0015909671783447266
local_in_edges_tensor generation:  0.0009398460388183594
mini_batch_src_global generation:  0.0012173652648925781
r_  generation:  0.010677814483642578
local_output_nid generation:  0.001585245132446289
local_in_edges_tensor generation:  0.00089263916015625
mini_batch_src_global generation:  0.0011415481567382812
r_  generation:  0.010186195373535156
local_output_nid generation:  0.0015981197357177734
local_in_edges_tensor generation:  0.0009090900421142578
mini_batch_src_global generation:  0.0011434555053710938
r_  generation:  0.010398387908935547
local_output_nid generation:  0.0015878677368164062
local_in_edges_tensor generation:  0.0008924007415771484
mini_batch_src_global generation:  0.0011506080627441406
r_  generation:  0.010414838790893555
local_output_nid generation:  0.001592874526977539
local_in_edges_tensor generation:  0.0008955001831054688
mini_batch_src_global generation:  0.0012335777282714844
r_  generation:  0.010729551315307617
local_output_nid generation:  0.0015902519226074219
local_in_edges_tensor generation:  0.0009059906005859375
mini_batch_src_global generation:  0.001203298568725586
r_  generation:  0.010748147964477539
local_output_nid generation:  0.0015964508056640625
local_in_edges_tensor generation:  0.0008707046508789062
mini_batch_src_global generation:  0.0012094974517822266
r_  generation:  0.010702371597290039
local_output_nid generation:  0.0015876293182373047
local_in_edges_tensor generation:  0.0008873939514160156
mini_batch_src_global generation:  0.0011868476867675781
r_  generation:  0.010625123977661133
local_output_nid generation:  0.0015666484832763672
local_in_edges_tensor generation:  0.0009002685546875
mini_batch_src_global generation:  0.0012137889862060547
r_  generation:  0.010544300079345703
local_output_nid generation:  0.0015766620635986328
local_in_edges_tensor generation:  0.0008924007415771484
mini_batch_src_global generation:  0.0012252330780029297
r_  generation:  0.010504484176635742
local_output_nid generation:  0.001600503921508789
local_in_edges_tensor generation:  0.0008966922760009766
mini_batch_src_global generation:  0.0011508464813232422
r_  generation:  0.010304927825927734
local_output_nid generation:  0.0015904903411865234
local_in_edges_tensor generation:  0.0008931159973144531
mini_batch_src_global generation:  0.0011463165283203125
r_  generation:  0.010430574417114258
local_output_nid generation:  0.0015752315521240234
local_in_edges_tensor generation:  0.0008924007415771484
mini_batch_src_global generation:  0.0012500286102294922
r_  generation:  0.010631561279296875
local_output_nid generation:  0.001575469970703125
local_in_edges_tensor generation:  0.0008931159973144531
mini_batch_src_global generation:  0.0011827945709228516
r_  generation:  0.010603189468383789
local_output_nid generation:  0.0015914440155029297
local_in_edges_tensor generation:  0.0008776187896728516
mini_batch_src_global generation:  0.0011112689971923828
r_  generation:  0.010091543197631836
local_output_nid generation:  0.0016021728515625
local_in_edges_tensor generation:  0.0008935928344726562
mini_batch_src_global generation:  0.0011365413665771484
r_  generation:  0.010326147079467773
----------------------check_connections_block total spend ----------------------------- 0.5744361877441406
generate_one_block  0.024233341217041016
generate_one_block  0.02096271514892578
generate_one_block  0.018218040466308594
generate_one_block  0.01831650733947754
generate_one_block  0.01840496063232422
generate_one_block  0.018011808395385742
generate_one_block  0.017946720123291016
generate_one_block  0.01806950569152832
generate_one_block  0.01825571060180664
generate_one_block  0.01762533187866211
generate_one_block  0.01848316192626953
generate_one_block  0.02183079719543457
generate_one_block  0.019547462463378906
generate_one_block  0.018285751342773438
generate_one_block  0.018286943435668945
generate_one_block  0.01918792724609375
generate_one_block  0.018650293350219727
generate_one_block  0.017754077911376953
generate_one_block  0.017982006072998047
generate_one_block  0.018001794815063477
generate_one_block  0.018589019775390625
generate_one_block  0.01870107650756836
generate_one_block  0.01859450340270996
generate_one_block  0.01824045181274414
generate_one_block  0.018473386764526367
generate_one_block  0.018377304077148438
generate_one_block  0.017960071563720703
generate_one_block  0.018071413040161133
generate_one_block  0.018405914306640625
generate_one_block  0.018393754959106445
generate_one_block  0.017515182495117188
generate_one_block  0.01808023452758789
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03947162628173828
gen group dst list time:  0.025259017944335938
time for parepare:  0.022174835205078125
local_output_nid generation:  0.0063817501068115234
local_in_edges_tensor generation:  0.018208980560302734
mini_batch_src_global generation:  0.02008223533630371
r_  generation:  0.16628432273864746
local_output_nid generation:  0.008913993835449219
local_in_edges_tensor generation:  0.01183462142944336
mini_batch_src_global generation:  0.024300098419189453
r_  generation:  0.19966840744018555
local_output_nid generation:  0.014824867248535156
local_in_edges_tensor generation:  0.05089282989501953
mini_batch_src_global generation:  0.022316932678222656
r_  generation:  0.18884968757629395
local_output_nid generation:  0.015824556350708008
local_in_edges_tensor generation:  0.01919841766357422
mini_batch_src_global generation:  0.030911684036254883
r_  generation:  0.17423009872436523
local_output_nid generation:  0.013986349105834961
local_in_edges_tensor generation:  0.01379704475402832
mini_batch_src_global generation:  0.02517223358154297
r_  generation:  0.1807098388671875
local_output_nid generation:  0.01081991195678711
local_in_edges_tensor generation:  0.009838581085205078
mini_batch_src_global generation:  0.025766611099243164
r_  generation:  0.17688512802124023
local_output_nid generation:  0.00962209701538086
local_in_edges_tensor generation:  0.009813070297241211
mini_batch_src_global generation:  0.024770736694335938
r_  generation:  0.1804213523864746
local_output_nid generation:  0.009344339370727539
local_in_edges_tensor generation:  0.008910179138183594
mini_batch_src_global generation:  0.022989273071289062
r_  generation:  0.17710447311401367
local_output_nid generation:  0.010723352432250977
local_in_edges_tensor generation:  0.010046005249023438
mini_batch_src_global generation:  0.022686243057250977
r_  generation:  0.1846923828125
local_output_nid generation:  0.009408712387084961
local_in_edges_tensor generation:  0.009135961532592773
mini_batch_src_global generation:  0.022541522979736328
r_  generation:  0.17537641525268555
local_output_nid generation:  0.009622335433959961
local_in_edges_tensor generation:  0.010349273681640625
mini_batch_src_global generation:  0.02533411979675293
r_  generation:  0.18701910972595215
local_output_nid generation:  0.01002359390258789
local_in_edges_tensor generation:  0.01199650764465332
mini_batch_src_global generation:  0.023981332778930664
r_  generation:  0.19105267524719238
local_output_nid generation:  0.012103557586669922
local_in_edges_tensor generation:  0.014329910278320312
mini_batch_src_global generation:  0.02460622787475586
r_  generation:  0.18977952003479004
local_output_nid generation:  0.010734319686889648
local_in_edges_tensor generation:  0.011451959609985352
mini_batch_src_global generation:  0.023478269577026367
r_  generation:  0.18370652198791504
local_output_nid generation:  0.010202884674072266
local_in_edges_tensor generation:  0.010519742965698242
mini_batch_src_global generation:  0.023363351821899414
r_  generation:  0.21911001205444336
local_output_nid generation:  0.010333776473999023
local_in_edges_tensor generation:  0.015467166900634766
mini_batch_src_global generation:  0.025809288024902344
r_  generation:  0.2294912338256836
local_output_nid generation:  0.012466192245483398
local_in_edges_tensor generation:  0.010957479476928711
mini_batch_src_global generation:  0.027802705764770508
r_  generation:  0.19053339958190918
local_output_nid generation:  0.009647369384765625
local_in_edges_tensor generation:  0.009529590606689453
mini_batch_src_global generation:  0.023135900497436523
r_  generation:  0.1810598373413086
local_output_nid generation:  0.009842157363891602
local_in_edges_tensor generation:  0.011038064956665039
mini_batch_src_global generation:  0.022409439086914062
r_  generation:  0.17983484268188477
local_output_nid generation:  0.009769201278686523
local_in_edges_tensor generation:  0.009614944458007812
mini_batch_src_global generation:  0.023375749588012695
r_  generation:  0.18074560165405273
local_output_nid generation:  0.009940862655639648
local_in_edges_tensor generation:  0.009862184524536133
mini_batch_src_global generation:  0.0234222412109375
r_  generation:  0.23918700218200684
local_output_nid generation:  0.010732173919677734
local_in_edges_tensor generation:  0.008938074111938477
mini_batch_src_global generation:  0.02374744415283203
r_  generation:  0.19110345840454102
local_output_nid generation:  0.010134696960449219
local_in_edges_tensor generation:  0.012828588485717773
mini_batch_src_global generation:  0.024928808212280273
r_  generation:  0.18991661071777344
local_output_nid generation:  0.010010004043579102
local_in_edges_tensor generation:  0.009112119674682617
mini_batch_src_global generation:  0.023542165756225586
r_  generation:  0.18347644805908203
local_output_nid generation:  0.010024547576904297
local_in_edges_tensor generation:  0.011809587478637695
mini_batch_src_global generation:  0.024172067642211914
r_  generation:  0.19535303115844727
local_output_nid generation:  0.01239776611328125
local_in_edges_tensor generation:  0.010617733001708984
mini_batch_src_global generation:  0.023207902908325195
r_  generation:  0.21787643432617188
local_output_nid generation:  0.010033369064331055
local_in_edges_tensor generation:  0.009008169174194336
mini_batch_src_global generation:  0.023178577423095703
r_  generation:  0.18286895751953125
local_output_nid generation:  0.010146617889404297
local_in_edges_tensor generation:  0.009049415588378906
mini_batch_src_global generation:  0.0234375
r_  generation:  0.18322324752807617
local_output_nid generation:  0.010194778442382812
local_in_edges_tensor generation:  0.00982809066772461
mini_batch_src_global generation:  0.024173498153686523
r_  generation:  0.18425703048706055
local_output_nid generation:  0.010343551635742188
local_in_edges_tensor generation:  0.009716510772705078
mini_batch_src_global generation:  0.023635387420654297
r_  generation:  0.18576741218566895
local_output_nid generation:  0.009673118591308594
local_in_edges_tensor generation:  0.011297464370727539
mini_batch_src_global generation:  0.02269577980041504
r_  generation:  0.17691826820373535
local_output_nid generation:  0.009578227996826172
local_in_edges_tensor generation:  0.009063720703125
mini_batch_src_global generation:  0.03618979454040527
r_  generation:  0.2398383617401123
----------------------check_connections_block total spend ----------------------------- 8.983020782470703
generate_one_block  0.2664215564727783
generate_one_block  0.24987411499023438
generate_one_block  0.2501697540283203
generate_one_block  0.24255728721618652
generate_one_block  0.269026517868042
generate_one_block  0.24030089378356934
generate_one_block  0.2395033836364746
generate_one_block  0.23971867561340332
generate_one_block  0.24651694297790527
generate_one_block  0.2349240779876709
generate_one_block  0.24759435653686523
generate_one_block  0.260148286819458
generate_one_block  0.2564394474029541
generate_one_block  0.24997782707214355
generate_one_block  0.2541842460632324
generate_one_block  0.25903964042663574
generate_one_block  0.2749214172363281
generate_one_block  0.2416079044342041
generate_one_block  0.23860716819763184
generate_one_block  0.25051259994506836
generate_one_block  0.25086545944213867
generate_one_block  0.24858403205871582
generate_one_block  0.25355958938598633
generate_one_block  0.24524760246276855
generate_one_block  0.24957036972045898
generate_one_block  0.2467045783996582
generate_one_block  0.24624419212341309
generate_one_block  0.2441844940185547
generate_one_block  0.24932050704956055
generate_one_block  0.25019001960754395
generate_one_block  0.24155068397521973
generate_one_block  0.2526531219482422
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0489349365234375
gen group dst list time:  0.11310148239135742
time for parepare:  0.01824188232421875
local_output_nid generation:  0.026737689971923828
local_in_edges_tensor generation:  0.047228097915649414
mini_batch_src_global generation:  0.03895688056945801
r_  generation:  0.42586541175842285
local_output_nid generation:  0.033792972564697266
local_in_edges_tensor generation:  0.03757834434509277
mini_batch_src_global generation:  0.0498960018157959
r_  generation:  0.4318113327026367
local_output_nid generation:  0.031807899475097656
local_in_edges_tensor generation:  0.029787778854370117
mini_batch_src_global generation:  0.04828643798828125
r_  generation:  0.4304330348968506
local_output_nid generation:  0.03150057792663574
local_in_edges_tensor generation:  0.030371665954589844
mini_batch_src_global generation:  0.04970979690551758
r_  generation:  0.4271211624145508
local_output_nid generation:  0.031975507736206055
local_in_edges_tensor generation:  0.029603958129882812
mini_batch_src_global generation:  0.04912614822387695
r_  generation:  0.4358513355255127
local_output_nid generation:  0.031957149505615234
local_in_edges_tensor generation:  0.0269162654876709
mini_batch_src_global generation:  0.05215597152709961
r_  generation:  0.4393582344055176
local_output_nid generation:  0.030347824096679688
local_in_edges_tensor generation:  0.030410289764404297
mini_batch_src_global generation:  0.051111459732055664
r_  generation:  0.4421522617340088
local_output_nid generation:  0.03065347671508789
local_in_edges_tensor generation:  0.028984546661376953
mini_batch_src_global generation:  0.0511012077331543
r_  generation:  0.434633731842041
local_output_nid generation:  0.02982616424560547
local_in_edges_tensor generation:  0.036478519439697266
mini_batch_src_global generation:  0.04953622817993164
r_  generation:  0.4418363571166992
local_output_nid generation:  0.03500723838806152
local_in_edges_tensor generation:  0.029095172882080078
mini_batch_src_global generation:  0.06115317344665527
r_  generation:  0.4370570182800293
local_output_nid generation:  0.03057694435119629
local_in_edges_tensor generation:  0.032447099685668945
mini_batch_src_global generation:  0.04976940155029297
r_  generation:  0.43880200386047363
local_output_nid generation:  0.03065967559814453
local_in_edges_tensor generation:  0.028908252716064453
mini_batch_src_global generation:  0.05040764808654785
r_  generation:  0.4388844966888428
local_output_nid generation:  0.030828237533569336
local_in_edges_tensor generation:  0.0309293270111084
mini_batch_src_global generation:  0.05026602745056152
r_  generation:  0.4493827819824219
local_output_nid generation:  0.030669689178466797
local_in_edges_tensor generation:  0.02831888198852539
mini_batch_src_global generation:  0.050931453704833984
r_  generation:  0.43987154960632324
local_output_nid generation:  0.030776262283325195
local_in_edges_tensor generation:  0.028686046600341797
mini_batch_src_global generation:  0.04981040954589844
r_  generation:  0.45015501976013184
local_output_nid generation:  0.0306093692779541
local_in_edges_tensor generation:  0.028891801834106445
mini_batch_src_global generation:  0.05128192901611328
r_  generation:  0.442307710647583
local_output_nid generation:  0.0305325984954834
local_in_edges_tensor generation:  0.028558731079101562
mini_batch_src_global generation:  0.05164194107055664
r_  generation:  0.442413330078125
local_output_nid generation:  0.030513763427734375
local_in_edges_tensor generation:  0.029398202896118164
mini_batch_src_global generation:  0.051004886627197266
r_  generation:  0.43317699432373047
local_output_nid generation:  0.030575275421142578
local_in_edges_tensor generation:  0.027543306350708008
mini_batch_src_global generation:  0.04961204528808594
r_  generation:  0.44022631645202637
local_output_nid generation:  0.030553340911865234
local_in_edges_tensor generation:  0.027005434036254883
mini_batch_src_global generation:  0.051125288009643555
r_  generation:  0.43590283393859863
local_output_nid generation:  0.03071904182434082
local_in_edges_tensor generation:  0.028615236282348633
mini_batch_src_global generation:  0.051793575286865234
r_  generation:  0.43975162506103516
local_output_nid generation:  0.030774831771850586
local_in_edges_tensor generation:  0.03446173667907715
mini_batch_src_global generation:  0.053710222244262695
r_  generation:  0.4372551441192627
local_output_nid generation:  0.030690670013427734
local_in_edges_tensor generation:  0.028927326202392578
mini_batch_src_global generation:  0.050601959228515625
r_  generation:  0.44280147552490234
local_output_nid generation:  0.030510663986206055
local_in_edges_tensor generation:  0.03340888023376465
mini_batch_src_global generation:  0.050917863845825195
r_  generation:  0.4402940273284912
local_output_nid generation:  0.030655622482299805
local_in_edges_tensor generation:  0.027634620666503906
mini_batch_src_global generation:  0.05008220672607422
r_  generation:  0.4433412551879883
local_output_nid generation:  0.032578468322753906
local_in_edges_tensor generation:  0.028272151947021484
mini_batch_src_global generation:  0.05303549766540527
r_  generation:  0.4394266605377197
local_output_nid generation:  0.03046560287475586
local_in_edges_tensor generation:  0.029497146606445312
mini_batch_src_global generation:  0.04992055892944336
r_  generation:  0.44595980644226074
local_output_nid generation:  0.030666112899780273
local_in_edges_tensor generation:  0.028618574142456055
mini_batch_src_global generation:  0.051300048828125
r_  generation:  0.4361264705657959
local_output_nid generation:  0.030756235122680664
local_in_edges_tensor generation:  0.03455018997192383
mini_batch_src_global generation:  0.05173063278198242
r_  generation:  0.44333362579345703
local_output_nid generation:  0.03090643882751465
local_in_edges_tensor generation:  0.028624534606933594
mini_batch_src_global generation:  0.053092002868652344
r_  generation:  0.44145894050598145
local_output_nid generation:  0.030371904373168945
local_in_edges_tensor generation:  0.030994415283203125
mini_batch_src_global generation:  0.05065417289733887
r_  generation:  0.4529564380645752
local_output_nid generation:  0.03280210494995117
local_in_edges_tensor generation:  0.02782154083251953
mini_batch_src_global generation:  0.051602840423583984
r_  generation:  0.4375264644622803
----------------------check_connections_block total spend ----------------------------- 20.768086671829224
generate_one_block  0.5897305011749268
generate_one_block  0.5753519535064697
generate_one_block  0.5759294033050537
generate_one_block  0.5773637294769287
generate_one_block  0.6915550231933594
generate_one_block  0.5858726501464844
generate_one_block  0.5793194770812988
generate_one_block  0.5864758491516113
generate_one_block  0.58168625831604
generate_one_block  0.5790808200836182
generate_one_block  0.5790836811065674
generate_one_block  0.5869057178497314
generate_one_block  0.5840983390808105
generate_one_block  0.5815567970275879
generate_one_block  0.5851583480834961
generate_one_block  0.5878894329071045
generate_one_block  0.5860903263092041
generate_one_block  0.5767779350280762
generate_one_block  0.5804815292358398
generate_one_block  0.580082893371582
generate_one_block  0.5844879150390625
generate_one_block  0.5856902599334717
generate_one_block  0.5857686996459961
generate_one_block  0.5816960334777832
generate_one_block  0.6016671657562256
generate_one_block  0.5858912467956543
generate_one_block  0.5804412364959717
generate_one_block  0.585345983505249
generate_one_block  0.5939846038818359
generate_one_block  0.5798943042755127
generate_one_block  0.5839648246765137
generate_one_block  0.5813415050506592
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.1265716552734375  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

connection checking time:  29.751107454299927
block generation total time  26.771385192871094
average batch blocks generation time:  0.8366057872772217
block dataloader generation time/epoch 59.562671410410026
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10656452178955078  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.779615879058838  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10644197463989258  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.623714923858643  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10619401931762695  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.50020742416382  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.1065835952758789  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.58102321624756  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10637903213500977  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.965094089508057  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.1066441535949707  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.79242992401123  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.1065053939819336  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.766512870788574  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.1064453125  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.70085906982422  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10635900497436523  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.881492614746094  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10654258728027344  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.4943904876709  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10673046112060547  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.00710916519165  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10655832290649414  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.180038928985596  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10682868957519531  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.146725177764893  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10661602020263672  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.971269130706787  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10667228698730469  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.162019729614258  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10683679580688477  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.49673318862915  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10673904418945312  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.304206371307373  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.1064605712890625  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.687853813171387  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10650253295898438  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.737792015075684  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10648775100708008  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.79768466949463  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10660886764526367  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.1061110496521  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10663747787475586  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.092953205108643  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10666275024414062  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.063777446746826  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10662126541137695  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.83291006088257  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10684537887573242  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.042893409729004  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10675764083862305  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.05931282043457  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10659313201904297  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.936129570007324  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10651779174804688  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.88770341873169  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10686874389648438  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.12013006210327  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10693550109863281  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.121103763580322  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.1061410903930664  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.49514865875244  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10675668716430664  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.017478942871094  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02998131513595581 |0.021401964128017426 |0.562999963760376 |9.796768426895142e-05 |1.0745707005262375 |0.005201101303100586 |
----------------------------------------------------------pseudo_mini_loss sum 1.2442971467971802
Total (block generation + training)time/epoch 113.33182175535904
Training time/epoch 54.11410164833069
Training time without block to device /epoch 53.42923879623413
Training time without total dataloading part /epoch 52.41059732437134
load block tensor time/epoch 0.9594020843505859
block to device time/epoch 0.6848628520965576
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 28 |
Number of nodes for computation during this epoch:  9112239
Number of first layer input nodes during this epoch:  4761491
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.12683725357055664  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02518939971923828
random selection method range initialization spend 0.0065729618072509766
time for parepare:  0.021440744400024414
local_output_nid generation:  0.001428365707397461
local_in_edges_tensor generation:  0.004755258560180664
mini_batch_src_global generation:  0.003476858139038086
r_  generation:  0.01587653160095215
local_output_nid generation:  0.0025413036346435547
local_in_edges_tensor generation:  0.001421213150024414
mini_batch_src_global generation:  0.002367734909057617
r_  generation:  0.011534690856933594
local_output_nid generation:  0.002412080764770508
local_in_edges_tensor generation:  0.0012955665588378906
mini_batch_src_global generation:  0.0015745162963867188
r_  generation:  0.010055303573608398
local_output_nid generation:  0.0023479461669921875
local_in_edges_tensor generation:  0.0012278556823730469
mini_batch_src_global generation:  0.0015513896942138672
r_  generation:  0.010418891906738281
local_output_nid generation:  0.002350330352783203
local_in_edges_tensor generation:  0.0012331008911132812
mini_batch_src_global generation:  0.0015444755554199219
r_  generation:  0.010607719421386719
local_output_nid generation:  0.0023212432861328125
local_in_edges_tensor generation:  0.0011935234069824219
mini_batch_src_global generation:  0.0014758110046386719
r_  generation:  0.01040792465209961
local_output_nid generation:  0.0023260116577148438
local_in_edges_tensor generation:  0.0011572837829589844
mini_batch_src_global generation:  0.001451253890991211
r_  generation:  0.009989738464355469
local_output_nid generation:  0.002297639846801758
local_in_edges_tensor generation:  0.0012066364288330078
mini_batch_src_global generation:  0.0014603137969970703
r_  generation:  0.010631799697875977
local_output_nid generation:  0.0022928714752197266
local_in_edges_tensor generation:  0.0011975765228271484
mini_batch_src_global generation:  0.0014274120330810547
r_  generation:  0.010477542877197266
local_output_nid generation:  0.0023336410522460938
local_in_edges_tensor generation:  0.0011665821075439453
mini_batch_src_global generation:  0.0014369487762451172
r_  generation:  0.010589122772216797
local_output_nid generation:  0.002373218536376953
local_in_edges_tensor generation:  0.0012192726135253906
mini_batch_src_global generation:  0.0014963150024414062
r_  generation:  0.010685205459594727
local_output_nid generation:  0.002326488494873047
local_in_edges_tensor generation:  0.001483917236328125
mini_batch_src_global generation:  0.004827022552490234
r_  generation:  0.015191078186035156
local_output_nid generation:  0.0026292800903320312
local_in_edges_tensor generation:  0.0012869834899902344
mini_batch_src_global generation:  0.0015377998352050781
r_  generation:  0.010827064514160156
local_output_nid generation:  0.0022242069244384766
local_in_edges_tensor generation:  0.0010609626770019531
mini_batch_src_global generation:  0.0013127326965332031
r_  generation:  0.010733604431152344
local_output_nid generation:  0.002101898193359375
local_in_edges_tensor generation:  0.0010526180267333984
mini_batch_src_global generation:  0.0012736320495605469
r_  generation:  0.010648965835571289
local_output_nid generation:  0.0020177364349365234
local_in_edges_tensor generation:  0.0010249614715576172
mini_batch_src_global generation:  0.0012583732604980469
r_  generation:  0.010855674743652344
local_output_nid generation:  0.001978635787963867
local_in_edges_tensor generation:  0.0010542869567871094
mini_batch_src_global generation:  0.0011944770812988281
r_  generation:  0.010149717330932617
local_output_nid generation:  0.0019407272338867188
local_in_edges_tensor generation:  0.0009801387786865234
mini_batch_src_global generation:  0.001180410385131836
r_  generation:  0.009963274002075195
local_output_nid generation:  0.0019040107727050781
local_in_edges_tensor generation:  0.0009624958038330078
mini_batch_src_global generation:  0.001214742660522461
r_  generation:  0.010243892669677734
local_output_nid generation:  0.0018520355224609375
local_in_edges_tensor generation:  0.0009615421295166016
mini_batch_src_global generation:  0.0011615753173828125
r_  generation:  0.010408401489257812
local_output_nid generation:  0.0018298625946044922
local_in_edges_tensor generation:  0.0009670257568359375
mini_batch_src_global generation:  0.00124359130859375
r_  generation:  0.010454893112182617
local_output_nid generation:  0.0018045902252197266
local_in_edges_tensor generation:  0.0009715557098388672
mini_batch_src_global generation:  0.0011835098266601562
r_  generation:  0.010603189468383789
local_output_nid generation:  0.001781463623046875
local_in_edges_tensor generation:  0.0009653568267822266
mini_batch_src_global generation:  0.0012581348419189453
r_  generation:  0.01064753532409668
local_output_nid generation:  0.0017740726470947266
local_in_edges_tensor generation:  0.0009393692016601562
mini_batch_src_global generation:  0.0011599063873291016
r_  generation:  0.010087013244628906
local_output_nid generation:  0.0017461776733398438
local_in_edges_tensor generation:  0.0009436607360839844
mini_batch_src_global generation:  0.001165151596069336
r_  generation:  0.009977340698242188
local_output_nid generation:  0.001729726791381836
local_in_edges_tensor generation:  0.000934600830078125
mini_batch_src_global generation:  0.0012347698211669922
r_  generation:  0.010495662689208984
local_output_nid generation:  0.0017044544219970703
local_in_edges_tensor generation:  0.0009469985961914062
mini_batch_src_global generation:  0.0012116432189941406
r_  generation:  0.010525941848754883
local_output_nid generation:  0.001697540283203125
local_in_edges_tensor generation:  0.0009233951568603516
mini_batch_src_global generation:  0.0012073516845703125
r_  generation:  0.010251998901367188
local_output_nid generation:  0.0016720294952392578
local_in_edges_tensor generation:  0.0009257793426513672
mini_batch_src_global generation:  0.0012621879577636719
r_  generation:  0.010460615158081055
local_output_nid generation:  0.001669168472290039
local_in_edges_tensor generation:  0.0009210109710693359
mini_batch_src_global generation:  0.0011949539184570312
r_  generation:  0.01045846939086914
local_output_nid generation:  0.0016660690307617188
local_in_edges_tensor generation:  0.0009059906005859375
mini_batch_src_global generation:  0.0011508464813232422
r_  generation:  0.01005411148071289
local_output_nid generation:  0.0016584396362304688
local_in_edges_tensor generation:  0.0009458065032958984
mini_batch_src_global generation:  0.0014312267303466797
r_  generation:  0.010366439819335938
----------------------check_connections_block total spend ----------------------------- 0.6263575553894043
generate_one_block  0.024536848068237305
generate_one_block  0.02152562141418457
generate_one_block  0.01888751983642578
generate_one_block  0.01857280731201172
generate_one_block  0.018680810928344727
generate_one_block  0.01819443702697754
generate_one_block  0.01719498634338379
generate_one_block  0.018484115600585938
generate_one_block  0.017848730087280273
generate_one_block  0.01845860481262207
generate_one_block  0.018355369567871094
generate_one_block  0.021182537078857422
generate_one_block  0.019412517547607422
generate_one_block  0.018585681915283203
generate_one_block  0.018868446350097656
generate_one_block  0.019086837768554688
generate_one_block  0.017948389053344727
generate_one_block  0.017470121383666992
generate_one_block  0.018078327178955078
generate_one_block  0.017737865447998047
generate_one_block  0.01860332489013672
generate_one_block  0.018356800079345703
generate_one_block  0.01876664161682129
generate_one_block  0.017696619033813477
generate_one_block  0.017660856246948242
generate_one_block  0.018481016159057617
generate_one_block  0.018587350845336914
generate_one_block  0.017975807189941406
generate_one_block  0.01870107650756836
generate_one_block  0.018388748168945312
generate_one_block  0.0178372859954834
generate_one_block  0.018193721771240234
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03921389579772949
gen group dst list time:  0.025664091110229492
time for parepare:  0.021704912185668945
local_output_nid generation:  0.006371498107910156
local_in_edges_tensor generation:  0.017494916915893555
mini_batch_src_global generation:  0.01995253562927246
r_  generation:  0.16448593139648438
local_output_nid generation:  0.009337186813354492
local_in_edges_tensor generation:  0.01225137710571289
mini_batch_src_global generation:  0.02391958236694336
r_  generation:  0.1985011100769043
local_output_nid generation:  0.009406328201293945
local_in_edges_tensor generation:  0.037438392639160156
mini_batch_src_global generation:  0.023328542709350586
r_  generation:  0.20375990867614746
local_output_nid generation:  0.015257596969604492
local_in_edges_tensor generation:  0.013643980026245117
mini_batch_src_global generation:  0.031255483627319336
r_  generation:  0.18261981010437012
local_output_nid generation:  0.012078046798706055
local_in_edges_tensor generation:  0.008948564529418945
mini_batch_src_global generation:  0.037276268005371094
r_  generation:  0.18102812767028809
local_output_nid generation:  0.009706974029541016
local_in_edges_tensor generation:  0.01046895980834961
mini_batch_src_global generation:  0.035642147064208984
r_  generation:  0.2164905071258545
local_output_nid generation:  0.009548664093017578
local_in_edges_tensor generation:  0.013514995574951172
mini_batch_src_global generation:  0.02483344078063965
r_  generation:  0.17718052864074707
local_output_nid generation:  0.00947117805480957
local_in_edges_tensor generation:  0.01593160629272461
mini_batch_src_global generation:  0.02619028091430664
r_  generation:  0.18710541725158691
local_output_nid generation:  0.008954286575317383
local_in_edges_tensor generation:  0.01305389404296875
mini_batch_src_global generation:  0.023077011108398438
r_  generation:  0.1781325340270996
local_output_nid generation:  0.00941777229309082
local_in_edges_tensor generation:  0.010823965072631836
mini_batch_src_global generation:  0.023988962173461914
r_  generation:  0.19030094146728516
local_output_nid generation:  0.010259151458740234
local_in_edges_tensor generation:  0.014801502227783203
mini_batch_src_global generation:  0.023535966873168945
r_  generation:  0.18776631355285645
local_output_nid generation:  0.009566783905029297
local_in_edges_tensor generation:  0.011318206787109375
mini_batch_src_global generation:  0.022973299026489258
r_  generation:  0.18344664573669434
local_output_nid generation:  0.011146068572998047
local_in_edges_tensor generation:  0.009063243865966797
mini_batch_src_global generation:  0.024281024932861328
r_  generation:  0.1876988410949707
local_output_nid generation:  0.009461164474487305
local_in_edges_tensor generation:  0.010587215423583984
mini_batch_src_global generation:  0.023215293884277344
r_  generation:  0.1945507526397705
local_output_nid generation:  0.011876583099365234
local_in_edges_tensor generation:  0.010968446731567383
mini_batch_src_global generation:  0.02548503875732422
r_  generation:  0.19061493873596191
local_output_nid generation:  0.010011672973632812
local_in_edges_tensor generation:  0.010193347930908203
mini_batch_src_global generation:  0.024114608764648438
r_  generation:  0.1910538673400879
local_output_nid generation:  0.009438753128051758
local_in_edges_tensor generation:  0.012123823165893555
mini_batch_src_global generation:  0.024465322494506836
r_  generation:  0.17999982833862305
local_output_nid generation:  0.009361028671264648
local_in_edges_tensor generation:  0.010797739028930664
mini_batch_src_global generation:  0.023067712783813477
r_  generation:  0.17315077781677246
local_output_nid generation:  0.009604454040527344
local_in_edges_tensor generation:  0.009112834930419922
mini_batch_src_global generation:  0.022796154022216797
r_  generation:  0.18094086647033691
local_output_nid generation:  0.009454965591430664
local_in_edges_tensor generation:  0.008986473083496094
mini_batch_src_global generation:  0.022260427474975586
r_  generation:  0.1769273281097412
local_output_nid generation:  0.009900569915771484
local_in_edges_tensor generation:  0.009116411209106445
mini_batch_src_global generation:  0.02358245849609375
r_  generation:  0.18935346603393555
local_output_nid generation:  0.009765148162841797
local_in_edges_tensor generation:  0.009268760681152344
mini_batch_src_global generation:  0.02362823486328125
r_  generation:  0.1995985507965088
local_output_nid generation:  0.010067462921142578
local_in_edges_tensor generation:  0.00974273681640625
mini_batch_src_global generation:  0.023571491241455078
r_  generation:  0.19010519981384277
local_output_nid generation:  0.009623050689697266
local_in_edges_tensor generation:  0.00881505012512207
mini_batch_src_global generation:  0.022574663162231445
r_  generation:  0.18185901641845703
local_output_nid generation:  0.0093841552734375
local_in_edges_tensor generation:  0.01548910140991211
mini_batch_src_global generation:  0.022086143493652344
r_  generation:  0.1784048080444336
local_output_nid generation:  0.009655475616455078
local_in_edges_tensor generation:  0.009314298629760742
mini_batch_src_global generation:  0.023226499557495117
r_  generation:  0.18811607360839844
local_output_nid generation:  0.01151418685913086
local_in_edges_tensor generation:  0.01062917709350586
mini_batch_src_global generation:  0.023670673370361328
r_  generation:  0.24285221099853516
local_output_nid generation:  0.00950002670288086
local_in_edges_tensor generation:  0.009017467498779297
mini_batch_src_global generation:  0.03056645393371582
r_  generation:  0.1864778995513916
local_output_nid generation:  0.009750127792358398
local_in_edges_tensor generation:  0.009264707565307617
mini_batch_src_global generation:  0.02590179443359375
r_  generation:  0.18903446197509766
local_output_nid generation:  0.010675907135009766
local_in_edges_tensor generation:  0.010686159133911133
mini_batch_src_global generation:  0.023590564727783203
r_  generation:  0.18712639808654785
local_output_nid generation:  0.00946044921875
local_in_edges_tensor generation:  0.011790990829467773
mini_batch_src_global generation:  0.022452592849731445
r_  generation:  0.17939162254333496
local_output_nid generation:  0.009638071060180664
local_in_edges_tensor generation:  0.009237527847290039
mini_batch_src_global generation:  0.022440671920776367
r_  generation:  0.1851511001586914
----------------------check_connections_block total spend ----------------------------- 8.878939151763916
generate_one_block  0.2708601951599121
generate_one_block  0.24859976768493652
generate_one_block  0.24129080772399902
generate_one_block  0.24792885780334473
generate_one_block  0.26426243782043457
generate_one_block  0.2398056983947754
generate_one_block  0.2290358543395996
generate_one_block  0.24860000610351562
generate_one_block  0.2401893138885498
generate_one_block  0.2569005489349365
generate_one_block  0.2481980323791504
generate_one_block  0.2449939250946045
generate_one_block  0.24871468544006348
generate_one_block  0.24930477142333984
generate_one_block  0.25919175148010254
generate_one_block  0.2716825008392334
generate_one_block  0.24832510948181152
generate_one_block  0.23629260063171387
generate_one_block  0.24663424491882324
generate_one_block  0.2507140636444092
generate_one_block  0.258220911026001
generate_one_block  0.25747084617614746
generate_one_block  0.2567281723022461
generate_one_block  0.2428572177886963
generate_one_block  0.2435758113861084
generate_one_block  0.2577188014984131
generate_one_block  0.25622105598449707
generate_one_block  0.24712204933166504
generate_one_block  0.2503945827484131
generate_one_block  0.2505674362182617
generate_one_block  0.23719358444213867
generate_one_block  0.24652600288391113
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.035494327545166016
gen group dst list time:  0.1194162368774414
time for parepare:  0.020342350006103516
local_output_nid generation:  0.02708268165588379
local_in_edges_tensor generation:  0.04563093185424805
mini_batch_src_global generation:  0.04139971733093262
r_  generation:  0.43332767486572266
local_output_nid generation:  0.03289198875427246
local_in_edges_tensor generation:  0.03495478630065918
mini_batch_src_global generation:  0.05002903938293457
r_  generation:  0.4229295253753662
local_output_nid generation:  0.03238630294799805
local_in_edges_tensor generation:  0.028896093368530273
mini_batch_src_global generation:  0.04875993728637695
r_  generation:  0.4328925609588623
local_output_nid generation:  0.032412052154541016
local_in_edges_tensor generation:  0.03084564208984375
mini_batch_src_global generation:  0.05179548263549805
r_  generation:  0.4327054023742676
local_output_nid generation:  0.03220200538635254
local_in_edges_tensor generation:  0.026930570602416992
mini_batch_src_global generation:  0.049419403076171875
r_  generation:  0.4368870258331299
local_output_nid generation:  0.03239941596984863
local_in_edges_tensor generation:  0.02685403823852539
mini_batch_src_global generation:  0.05086016654968262
r_  generation:  0.43200182914733887
local_output_nid generation:  0.030525684356689453
local_in_edges_tensor generation:  0.02666449546813965
mini_batch_src_global generation:  0.05124783515930176
r_  generation:  0.43255043029785156
local_output_nid generation:  0.03043389320373535
local_in_edges_tensor generation:  0.0292818546295166
mini_batch_src_global generation:  0.052843570709228516
r_  generation:  0.4447062015533447
local_output_nid generation:  0.03328132629394531
local_in_edges_tensor generation:  0.026713132858276367
mini_batch_src_global generation:  0.04961109161376953
r_  generation:  0.4360232353210449
local_output_nid generation:  0.0302278995513916
local_in_edges_tensor generation:  0.030590534210205078
mini_batch_src_global generation:  0.0533907413482666
r_  generation:  0.4361112117767334
local_output_nid generation:  0.030739784240722656
local_in_edges_tensor generation:  0.02694392204284668
mini_batch_src_global generation:  0.049883365631103516
r_  generation:  0.4368889331817627
local_output_nid generation:  0.030360937118530273
local_in_edges_tensor generation:  0.026801109313964844
mini_batch_src_global generation:  0.050780296325683594
r_  generation:  0.4332301616668701
local_output_nid generation:  0.03036189079284668
local_in_edges_tensor generation:  0.029194116592407227
mini_batch_src_global generation:  0.05009746551513672
r_  generation:  0.44017744064331055
local_output_nid generation:  0.030389785766601562
local_in_edges_tensor generation:  0.03433513641357422
mini_batch_src_global generation:  0.05047273635864258
r_  generation:  0.4370748996734619
local_output_nid generation:  0.030287981033325195
local_in_edges_tensor generation:  0.03372001647949219
mini_batch_src_global generation:  0.04990839958190918
r_  generation:  0.4394669532775879
local_output_nid generation:  0.030871868133544922
local_in_edges_tensor generation:  0.028922557830810547
mini_batch_src_global generation:  0.05343437194824219
r_  generation:  0.441561222076416
local_output_nid generation:  0.031145334243774414
local_in_edges_tensor generation:  0.027080059051513672
mini_batch_src_global generation:  0.04980754852294922
r_  generation:  0.4392998218536377
local_output_nid generation:  0.029880285263061523
local_in_edges_tensor generation:  0.028468608856201172
mini_batch_src_global generation:  0.05044388771057129
r_  generation:  0.4337029457092285
local_output_nid generation:  0.030286550521850586
local_in_edges_tensor generation:  0.033977508544921875
mini_batch_src_global generation:  0.050002336502075195
r_  generation:  0.437955379486084
local_output_nid generation:  0.03053736686706543
local_in_edges_tensor generation:  0.03229880332946777
mini_batch_src_global generation:  0.05057334899902344
r_  generation:  0.43649888038635254
local_output_nid generation:  0.03066849708557129
local_in_edges_tensor generation:  0.029648780822753906
mini_batch_src_global generation:  0.04964756965637207
r_  generation:  0.4402472972869873
local_output_nid generation:  0.030509233474731445
local_in_edges_tensor generation:  0.034876108169555664
mini_batch_src_global generation:  0.05131697654724121
r_  generation:  0.44084835052490234
local_output_nid generation:  0.03074169158935547
local_in_edges_tensor generation:  0.02883315086364746
mini_batch_src_global generation:  0.05281257629394531
r_  generation:  0.447507381439209
local_output_nid generation:  0.030293941497802734
local_in_edges_tensor generation:  0.029473543167114258
mini_batch_src_global generation:  0.06355929374694824
r_  generation:  0.4354128837585449
local_output_nid generation:  0.03169727325439453
local_in_edges_tensor generation:  0.028276443481445312
mini_batch_src_global generation:  0.04996967315673828
r_  generation:  0.44074058532714844
local_output_nid generation:  0.030483245849609375
local_in_edges_tensor generation:  0.028896331787109375
mini_batch_src_global generation:  0.05164599418640137
r_  generation:  0.4407494068145752
local_output_nid generation:  0.030429601669311523
local_in_edges_tensor generation:  0.03071284294128418
mini_batch_src_global generation:  0.05059504508972168
r_  generation:  0.44135475158691406
local_output_nid generation:  0.030652523040771484
local_in_edges_tensor generation:  0.026874065399169922
mini_batch_src_global generation:  0.05101943016052246
r_  generation:  0.43956899642944336
local_output_nid generation:  0.03067493438720703
local_in_edges_tensor generation:  0.028637409210205078
mini_batch_src_global generation:  0.04993462562561035
r_  generation:  0.44193553924560547
local_output_nid generation:  0.030895709991455078
local_in_edges_tensor generation:  0.026990175247192383
mini_batch_src_global generation:  0.05137753486633301
r_  generation:  0.4368422031402588
local_output_nid generation:  0.030730724334716797
local_in_edges_tensor generation:  0.030664920806884766
mini_batch_src_global generation:  0.049623727798461914
r_  generation:  0.43724608421325684
local_output_nid generation:  0.03108382225036621
local_in_edges_tensor generation:  0.028780460357666016
mini_batch_src_global generation:  0.05881476402282715
r_  generation:  0.44458889961242676
----------------------check_connections_block total spend ----------------------------- 20.721277475357056
generate_one_block  0.599541187286377
generate_one_block  0.5821986198425293
generate_one_block  0.5818405151367188
generate_one_block  0.5902712345123291
generate_one_block  0.6929876804351807
generate_one_block  0.578730583190918
generate_one_block  0.576169490814209
generate_one_block  0.5848410129547119
generate_one_block  0.5774979591369629
generate_one_block  0.588942289352417
generate_one_block  0.5831637382507324
generate_one_block  0.5787539482116699
generate_one_block  0.5855274200439453
generate_one_block  0.5873017311096191
generate_one_block  0.5863823890686035
generate_one_block  0.5940351486206055
generate_one_block  0.5787146091461182
generate_one_block  0.5775113105773926
generate_one_block  0.5775234699249268
generate_one_block  0.5881226062774658
generate_one_block  0.5989120006561279
generate_one_block  0.5815293788909912
generate_one_block  0.583773136138916
generate_one_block  0.5863265991210938
generate_one_block  0.5961809158325195
generate_one_block  0.5906355381011963
generate_one_block  0.5844752788543701
generate_one_block  0.580427885055542
generate_one_block  0.5876390933990479
generate_one_block  0.5798320770263672
generate_one_block  0.5907778739929199
generate_one_block  0.5862748622894287
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.12683725357055664  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

connection checking time:  29.60021662712097
block generation total time  26.832963228225708
average batch blocks generation time:  0.8385301008820534
block dataloader generation time/epoch 59.57902728319168
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10667037963867188  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.958373546600342  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.1068124771118164  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.05482244491577  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10656070709228516  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.74820375442505  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10694742202758789  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.093961238861084  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10692071914672852  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.970964431762695  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10675239562988281  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.82058095932007  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10596275329589844  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.04488229751587  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10685110092163086  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.158961296081543  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10625028610229492  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.487818717956543  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10695981979370117  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.27803897857666  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10654926300048828  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.03200387954712  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10657548904418945  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.936077117919922  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.1066594123840332  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.074406623840332  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10657978057861328  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.0990948677063  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10699605941772461  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.50561809539795  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10704469680786133  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.56018877029419  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.1065058708190918  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.779197692871094  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10624361038208008  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.263041496276855  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10659313201904297  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.77500629425049  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10643863677978516  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.64781427383423  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10691070556640625  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.28065013885498  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10648441314697266  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.10086727142334  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10703516006469727  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.286253452301025  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10617208480834961  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.604382038116455  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10646581649780273  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.462036609649658  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.1068572998046875  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.146106719970703  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.1067972183227539  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.207143306732178  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10648679733276367  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.77631902694702  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10645914077758789  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.950884342193604  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10671710968017578  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.00452709197998  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10656070709228516  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.52632999420166  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10684442520141602  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 18.904891967773438  GigaBytes
Max Memory Allocated: 19.943066596984863  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03665617108345032 |0.02176879346370697 |0.5671927779912949 |9.697675704956055e-05 |1.0735375732183456 |0.008619308471679688 |
----------------------------------------------------------pseudo_mini_loss sum 1.2367397546768188
Total (block generation + training)time/epoch 113.38175656795502
Training time/epoch 54.440486431121826
Training time without block to device /epoch 53.7438850402832
Training time without total dataloading part /epoch 52.51509380340576
load block tensor time/epoch 1.1729974746704102
block to device time/epoch 0.696601390838623
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 29 |
Number of nodes for computation during this epoch:  9119483
Number of first layer input nodes during this epoch:  4764396
