Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1647783641.728308
ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0213623046875 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02308368682861328
random selection method range initialization spend 0.0057904720306396484
time for parepare:  0.019344091415405273
local_output_nid generation:  0.0011143684387207031
local_in_edges_tensor generation:  0.003099679946899414
mini_batch_src_global generation:  0.0015039443969726562
r_  generation:  0.009380578994750977
local_output_nid generation:  0.0013935565948486328
local_in_edges_tensor generation:  0.0009007453918457031
mini_batch_src_global generation:  0.001497030258178711
r_  generation:  0.008104801177978516
local_output_nid generation:  0.0014693737030029297
local_in_edges_tensor generation:  0.0008189678192138672
mini_batch_src_global generation:  0.0009586811065673828
r_  generation:  0.007412910461425781
local_output_nid generation:  0.0014483928680419922
local_in_edges_tensor generation:  0.0007610321044921875
mini_batch_src_global generation:  0.0008487701416015625
r_  generation:  0.007467985153198242
local_output_nid generation:  0.0014233589172363281
local_in_edges_tensor generation:  0.000736236572265625
mini_batch_src_global generation:  0.0008819103240966797
r_  generation:  0.007653236389160156
local_output_nid generation:  0.0014462471008300781
local_in_edges_tensor generation:  0.0007140636444091797
mini_batch_src_global generation:  0.0008339881896972656
r_  generation:  0.007968902587890625
local_output_nid generation:  0.0013954639434814453
local_in_edges_tensor generation:  0.0007202625274658203
mini_batch_src_global generation:  0.0008337497711181641
r_  generation:  0.008105039596557617
local_output_nid generation:  0.0013775825500488281
local_in_edges_tensor generation:  0.0007195472717285156
mini_batch_src_global generation:  0.0008366107940673828
r_  generation:  0.008208513259887695
local_output_nid generation:  0.0014050006866455078
local_in_edges_tensor generation:  0.0007143020629882812
mini_batch_src_global generation:  0.0008227825164794922
r_  generation:  0.007958650588989258
local_output_nid generation:  0.0013916492462158203
local_in_edges_tensor generation:  0.0007207393646240234
mini_batch_src_global generation:  0.0008265972137451172
r_  generation:  0.00804591178894043
local_output_nid generation:  0.0013911724090576172
local_in_edges_tensor generation:  0.0007104873657226562
mini_batch_src_global generation:  0.0008432865142822266
r_  generation:  0.008242368698120117
local_output_nid generation:  0.0013976097106933594
local_in_edges_tensor generation:  0.0007073879241943359
mini_batch_src_global generation:  0.0008318424224853516
r_  generation:  0.008146286010742188
local_output_nid generation:  0.0013821125030517578
local_in_edges_tensor generation:  0.0006964206695556641
mini_batch_src_global generation:  0.0008242130279541016
r_  generation:  0.007958650588989258
local_output_nid generation:  0.0013628005981445312
local_in_edges_tensor generation:  0.0007052421569824219
mini_batch_src_global generation:  0.0008480548858642578
r_  generation:  0.008216381072998047
local_output_nid generation:  0.0013911724090576172
local_in_edges_tensor generation:  0.0006985664367675781
mini_batch_src_global generation:  0.0008347034454345703
r_  generation:  0.008182048797607422
local_output_nid generation:  0.0013878345489501953
local_in_edges_tensor generation:  0.0006937980651855469
mini_batch_src_global generation:  0.0008280277252197266
r_  generation:  0.007936239242553711
local_output_nid generation:  0.0013713836669921875
local_in_edges_tensor generation:  0.0007104873657226562
mini_batch_src_global generation:  0.0008540153503417969
r_  generation:  0.008454561233520508
local_output_nid generation:  0.001369476318359375
local_in_edges_tensor generation:  0.0006988048553466797
mini_batch_src_global generation:  0.0008463859558105469
r_  generation:  0.008021831512451172
local_output_nid generation:  0.0013709068298339844
local_in_edges_tensor generation:  0.0007107257843017578
mini_batch_src_global generation:  0.0008480548858642578
r_  generation:  0.008159399032592773
local_output_nid generation:  0.0013918876647949219
local_in_edges_tensor generation:  0.0007076263427734375
mini_batch_src_global generation:  0.000823974609375
r_  generation:  0.00787043571472168
local_output_nid generation:  0.0013775825500488281
local_in_edges_tensor generation:  0.000698089599609375
mini_batch_src_global generation:  0.0008287429809570312
r_  generation:  0.008055448532104492
local_output_nid generation:  0.0013835430145263672
local_in_edges_tensor generation:  0.0007028579711914062
mini_batch_src_global generation:  0.0008463859558105469
r_  generation:  0.008023500442504883
local_output_nid generation:  0.0013554096221923828
local_in_edges_tensor generation:  0.0007066726684570312
mini_batch_src_global generation:  0.0008590221405029297
r_  generation:  0.008378744125366211
local_output_nid generation:  0.001369476318359375
local_in_edges_tensor generation:  0.0007026195526123047
mini_batch_src_global generation:  0.0008628368377685547
r_  generation:  0.008564233779907227
local_output_nid generation:  0.0013861656188964844
local_in_edges_tensor generation:  0.0007145404815673828
mini_batch_src_global generation:  0.0008800029754638672
r_  generation:  0.008289098739624023
local_output_nid generation:  0.001367330551147461
local_in_edges_tensor generation:  0.0006873607635498047
mini_batch_src_global generation:  0.0008561611175537109
r_  generation:  0.008100509643554688
local_output_nid generation:  0.0013637542724609375
local_in_edges_tensor generation:  0.0006995201110839844
mini_batch_src_global generation:  0.0008304119110107422
r_  generation:  0.008024215698242188
local_output_nid generation:  0.0013744831085205078
local_in_edges_tensor generation:  0.000713348388671875
mini_batch_src_global generation:  0.0008604526519775391
r_  generation:  0.00829172134399414
local_output_nid generation:  0.0013577938079833984
local_in_edges_tensor generation:  0.0006909370422363281
mini_batch_src_global generation:  0.0008764266967773438
r_  generation:  0.008566617965698242
local_output_nid generation:  0.0013546943664550781
local_in_edges_tensor generation:  0.0052835941314697266
mini_batch_src_global generation:  0.0010983943939208984
r_  generation:  0.008369922637939453
local_output_nid generation:  0.0012717247009277344
local_in_edges_tensor generation:  0.0007429122924804688
mini_batch_src_global generation:  0.0009903907775878906
r_  generation:  0.007911920547485352
local_output_nid generation:  0.001268625259399414
local_in_edges_tensor generation:  0.0007009506225585938
mini_batch_src_global generation:  0.0008981227874755859
r_  generation:  0.008103132247924805
----------------------check_connections_block total spend ----------------------------- 0.46247410774230957
generate_one_block  0.0141754150390625
generate_one_block  0.013545513153076172
generate_one_block  0.012542486190795898
generate_one_block  0.01270604133605957
generate_one_block  0.012783527374267578
generate_one_block  0.013224601745605469
generate_one_block  0.013163566589355469
generate_one_block  0.013242959976196289
generate_one_block  0.013025045394897461
generate_one_block  0.013361454010009766
generate_one_block  0.013282537460327148
generate_one_block  0.012978792190551758
generate_one_block  0.012640237808227539
generate_one_block  0.012953758239746094
generate_one_block  0.013011693954467773
generate_one_block  0.012593507766723633
generate_one_block  0.013365983963012695
generate_one_block  0.012766838073730469
generate_one_block  0.012879133224487305
generate_one_block  0.012563228607177734
generate_one_block  0.012855291366577148
generate_one_block  0.012818574905395508
generate_one_block  0.013414144515991211
generate_one_block  0.013143539428710938
generate_one_block  0.013080835342407227
generate_one_block  0.012990474700927734
generate_one_block  0.012855768203735352
generate_one_block  0.013306617736816406
generate_one_block  0.013357162475585938
generate_one_block  0.012914180755615234
generate_one_block  0.012988090515136719
generate_one_block  0.012709379196166992
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.038199663162231445
gen group dst list time:  0.02130866050720215
time for parepare:  0.018872499465942383
local_output_nid generation:  0.004782438278198242
local_in_edges_tensor generation:  0.010564804077148438
mini_batch_src_global generation:  0.012111663818359375
r_  generation:  0.12001395225524902
local_output_nid generation:  0.007833719253540039
local_in_edges_tensor generation:  0.011941909790039062
mini_batch_src_global generation:  0.0165102481842041
r_  generation:  0.12855267524719238
local_output_nid generation:  0.007471799850463867
local_in_edges_tensor generation:  0.0069425106048583984
mini_batch_src_global generation:  0.013181209564208984
r_  generation:  0.12054443359375
local_output_nid generation:  0.0073223114013671875
local_in_edges_tensor generation:  0.00989222526550293
mini_batch_src_global generation:  0.014878511428833008
r_  generation:  0.12584900856018066
local_output_nid generation:  0.007146358489990234
local_in_edges_tensor generation:  0.008318185806274414
mini_batch_src_global generation:  0.0156710147857666
r_  generation:  0.13065266609191895
local_output_nid generation:  0.010350942611694336
local_in_edges_tensor generation:  0.010876893997192383
mini_batch_src_global generation:  0.015836715698242188
r_  generation:  0.1369335651397705
local_output_nid generation:  0.008355379104614258
local_in_edges_tensor generation:  0.007989883422851562
mini_batch_src_global generation:  0.01627969741821289
r_  generation:  0.13862085342407227
local_output_nid generation:  0.01218724250793457
local_in_edges_tensor generation:  0.016349315643310547
mini_batch_src_global generation:  0.0214693546295166
r_  generation:  0.138016939163208
local_output_nid generation:  0.007691621780395508
local_in_edges_tensor generation:  0.01009821891784668
mini_batch_src_global generation:  0.016181230545043945
r_  generation:  0.1344153881072998
local_output_nid generation:  0.007577419281005859
local_in_edges_tensor generation:  0.008396387100219727
mini_batch_src_global generation:  0.016307353973388672
r_  generation:  0.13356590270996094
local_output_nid generation:  0.007621049880981445
local_in_edges_tensor generation:  0.008509397506713867
mini_batch_src_global generation:  0.01764988899230957
r_  generation:  0.13626909255981445
local_output_nid generation:  0.007542133331298828
local_in_edges_tensor generation:  0.008153438568115234
mini_batch_src_global generation:  0.016474246978759766
r_  generation:  0.13515496253967285
local_output_nid generation:  0.007269620895385742
local_in_edges_tensor generation:  0.008230924606323242
mini_batch_src_global generation:  0.016241788864135742
r_  generation:  0.13225054740905762
local_output_nid generation:  0.0076024532318115234
local_in_edges_tensor generation:  0.009509563446044922
mini_batch_src_global generation:  0.016272306442260742
r_  generation:  0.13478994369506836
local_output_nid generation:  0.00750279426574707
local_in_edges_tensor generation:  0.0073587894439697266
mini_batch_src_global generation:  0.016467571258544922
r_  generation:  0.13545918464660645
local_output_nid generation:  0.00731205940246582
local_in_edges_tensor generation:  0.007173061370849609
mini_batch_src_global generation:  0.015478849411010742
r_  generation:  0.12893891334533691
local_output_nid generation:  0.007652759552001953
local_in_edges_tensor generation:  0.008961915969848633
mini_batch_src_global generation:  0.01650071144104004
r_  generation:  0.13698291778564453
local_output_nid generation:  0.007419586181640625
local_in_edges_tensor generation:  0.0073277950286865234
mini_batch_src_global generation:  0.01607513427734375
r_  generation:  0.16753625869750977
local_output_nid generation:  0.010077476501464844
local_in_edges_tensor generation:  0.00956416130065918
mini_batch_src_global generation:  0.023621559143066406
r_  generation:  0.13639545440673828
local_output_nid generation:  0.007549762725830078
local_in_edges_tensor generation:  0.008551597595214844
mini_batch_src_global generation:  0.016090869903564453
r_  generation:  0.13318538665771484
local_output_nid generation:  0.009153604507446289
local_in_edges_tensor generation:  0.008434057235717773
mini_batch_src_global generation:  0.015985965728759766
r_  generation:  0.13680243492126465
local_output_nid generation:  0.007498502731323242
local_in_edges_tensor generation:  0.011147499084472656
mini_batch_src_global generation:  0.01597142219543457
r_  generation:  0.19190192222595215
local_output_nid generation:  0.010569572448730469
local_in_edges_tensor generation:  0.011321544647216797
mini_batch_src_global generation:  0.018123865127563477
r_  generation:  0.1490330696105957
local_output_nid generation:  0.009681940078735352
local_in_edges_tensor generation:  0.01539158821105957
mini_batch_src_global generation:  0.017348766326904297
r_  generation:  0.14212846755981445
local_output_nid generation:  0.007725715637207031
local_in_edges_tensor generation:  0.009658575057983398
mini_batch_src_global generation:  0.016831159591674805
r_  generation:  0.13817644119262695
local_output_nid generation:  0.007540225982666016
local_in_edges_tensor generation:  0.007863521575927734
mini_batch_src_global generation:  0.01627039909362793
r_  generation:  0.15192365646362305
local_output_nid generation:  0.007393836975097656
local_in_edges_tensor generation:  0.008238077163696289
mini_batch_src_global generation:  0.015981197357177734
r_  generation:  0.13226652145385742
local_output_nid generation:  0.008461236953735352
local_in_edges_tensor generation:  0.008681535720825195
mini_batch_src_global generation:  0.017482757568359375
r_  generation:  0.1392650604248047
local_output_nid generation:  0.0077168941497802734
local_in_edges_tensor generation:  0.014659643173217773
mini_batch_src_global generation:  0.016746997833251953
r_  generation:  0.14287900924682617
local_output_nid generation:  0.008420705795288086
local_in_edges_tensor generation:  0.00965428352355957
mini_batch_src_global generation:  0.01602482795715332
r_  generation:  0.13565707206726074
local_output_nid generation:  0.007430076599121094
local_in_edges_tensor generation:  0.007567882537841797
mini_batch_src_global generation:  0.01587510108947754
r_  generation:  0.13471174240112305
local_output_nid generation:  0.007380962371826172
local_in_edges_tensor generation:  0.00734400749206543
mini_batch_src_global generation:  0.016114473342895508
r_  generation:  0.1356825828552246
----------------------check_connections_block total spend ----------------------------- 6.55543065071106
generate_one_block  0.17772293090820312
generate_one_block  0.1757044792175293
generate_one_block  0.18951034545898438
generate_one_block  0.1705925464630127
generate_one_block  0.1610090732574463
generate_one_block  0.1705324649810791
generate_one_block  0.17122697830200195
generate_one_block  0.17023730278015137
generate_one_block  0.16936850547790527
generate_one_block  0.1634526252746582
generate_one_block  0.18169641494750977
generate_one_block  0.16893959045410156
generate_one_block  0.1636061668395996
generate_one_block  0.1661851406097412
generate_one_block  0.16231369972229004
generate_one_block  0.18512654304504395
generate_one_block  0.17233705520629883
generate_one_block  0.16592860221862793
generate_one_block  0.1774919033050537
generate_one_block  0.1598501205444336
generate_one_block  0.16778969764709473
generate_one_block  0.16315746307373047
generate_one_block  0.17067527770996094
generate_one_block  0.1728978157043457
generate_one_block  0.17142486572265625
generate_one_block  0.17235374450683594
generate_one_block  0.1614084243774414
generate_one_block  0.16720938682556152
generate_one_block  0.17317962646484375
generate_one_block  0.16277194023132324
generate_one_block  0.16588258743286133
generate_one_block  0.16823625564575195
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04822731018066406
gen group dst list time:  0.10306048393249512
time for parepare:  0.021369218826293945
local_output_nid generation:  0.021761178970336914
local_in_edges_tensor generation:  0.057349205017089844
mini_batch_src_global generation:  0.036841630935668945
r_  generation:  0.3878474235534668
local_output_nid generation:  0.029627323150634766
local_in_edges_tensor generation:  0.0430145263671875
mini_batch_src_global generation:  0.046166181564331055
r_  generation:  0.39856648445129395
local_output_nid generation:  0.02774524688720703
local_in_edges_tensor generation:  0.02918720245361328
mini_batch_src_global generation:  0.045320987701416016
r_  generation:  0.39277195930480957
local_output_nid generation:  0.026126623153686523
local_in_edges_tensor generation:  0.02930760383605957
mini_batch_src_global generation:  0.048822641372680664
r_  generation:  0.39608335494995117
local_output_nid generation:  0.026370525360107422
local_in_edges_tensor generation:  0.02833700180053711
mini_batch_src_global generation:  0.04696297645568848
r_  generation:  0.3965435028076172
local_output_nid generation:  0.026477813720703125
local_in_edges_tensor generation:  0.03282928466796875
mini_batch_src_global generation:  0.0478215217590332
r_  generation:  0.4037783145904541
local_output_nid generation:  0.026290178298950195
local_in_edges_tensor generation:  0.03293585777282715
mini_batch_src_global generation:  0.0471196174621582
r_  generation:  0.41667866706848145
local_output_nid generation:  0.026602745056152344
local_in_edges_tensor generation:  0.03732442855834961
mini_batch_src_global generation:  0.0511631965637207
r_  generation:  0.40807652473449707
local_output_nid generation:  0.026877880096435547
local_in_edges_tensor generation:  0.03472018241882324
mini_batch_src_global generation:  0.04748702049255371
r_  generation:  0.40467190742492676
local_output_nid generation:  0.026546239852905273
local_in_edges_tensor generation:  0.02879643440246582
mini_batch_src_global generation:  0.05231142044067383
r_  generation:  0.3992478847503662
local_output_nid generation:  0.028118371963500977
local_in_edges_tensor generation:  0.025310993194580078
mini_batch_src_global generation:  0.04666590690612793
r_  generation:  0.4032437801361084
local_output_nid generation:  0.02736520767211914
local_in_edges_tensor generation:  0.030266284942626953
mini_batch_src_global generation:  0.04836702346801758
r_  generation:  0.4021031856536865
local_output_nid generation:  0.026825666427612305
local_in_edges_tensor generation:  0.02625250816345215
mini_batch_src_global generation:  0.04724740982055664
r_  generation:  0.39760756492614746
local_output_nid generation:  0.027212858200073242
local_in_edges_tensor generation:  0.03261375427246094
mini_batch_src_global generation:  0.04693198204040527
r_  generation:  0.40066981315612793
local_output_nid generation:  0.026968002319335938
local_in_edges_tensor generation:  0.03272604942321777
mini_batch_src_global generation:  0.04692482948303223
r_  generation:  0.4010443687438965
local_output_nid generation:  0.0265963077545166
local_in_edges_tensor generation:  0.026181459426879883
mini_batch_src_global generation:  0.04682469367980957
r_  generation:  0.3957178592681885
local_output_nid generation:  0.026860475540161133
local_in_edges_tensor generation:  0.03297829627990723
mini_batch_src_global generation:  0.04650592803955078
r_  generation:  0.39933347702026367
local_output_nid generation:  0.026628971099853516
local_in_edges_tensor generation:  0.03324007987976074
mini_batch_src_global generation:  0.050015926361083984
r_  generation:  0.4012882709503174
local_output_nid generation:  0.027146339416503906
local_in_edges_tensor generation:  0.025664567947387695
mini_batch_src_global generation:  0.04669761657714844
r_  generation:  0.4002807140350342
local_output_nid generation:  0.026873350143432617
local_in_edges_tensor generation:  0.026712417602539062
mini_batch_src_global generation:  0.05031847953796387
r_  generation:  0.40163230895996094
local_output_nid generation:  0.02683568000793457
local_in_edges_tensor generation:  0.026539087295532227
mini_batch_src_global generation:  0.04683971405029297
r_  generation:  0.4008028507232666
local_output_nid generation:  0.027002811431884766
local_in_edges_tensor generation:  0.0341949462890625
mini_batch_src_global generation:  0.047617435455322266
r_  generation:  0.3995640277862549
local_output_nid generation:  0.027195215225219727
local_in_edges_tensor generation:  0.02942633628845215
mini_batch_src_global generation:  0.05000162124633789
r_  generation:  0.40361618995666504
local_output_nid generation:  0.02735757827758789
local_in_edges_tensor generation:  0.036716461181640625
mini_batch_src_global generation:  0.047293663024902344
r_  generation:  0.4030473232269287
local_output_nid generation:  0.02726292610168457
local_in_edges_tensor generation:  0.03285551071166992
mini_batch_src_global generation:  0.047119140625
r_  generation:  0.40135622024536133
local_output_nid generation:  0.027201414108276367
local_in_edges_tensor generation:  0.02909064292907715
mini_batch_src_global generation:  0.04973483085632324
r_  generation:  0.4080805778503418
local_output_nid generation:  0.02732706069946289
local_in_edges_tensor generation:  0.026590347290039062
mini_batch_src_global generation:  0.04729938507080078
r_  generation:  0.3975183963775635
local_output_nid generation:  0.027158737182617188
local_in_edges_tensor generation:  0.02647256851196289
mini_batch_src_global generation:  0.04727888107299805
r_  generation:  0.42440104484558105
local_output_nid generation:  0.027530908584594727
local_in_edges_tensor generation:  0.03304553031921387
mini_batch_src_global generation:  0.04677009582519531
r_  generation:  0.4046165943145752
local_output_nid generation:  0.02716684341430664
local_in_edges_tensor generation:  0.028876781463623047
mini_batch_src_global generation:  0.046814918518066406
r_  generation:  0.40456056594848633
local_output_nid generation:  0.027060747146606445
local_in_edges_tensor generation:  0.02572035789489746
mini_batch_src_global generation:  0.045928955078125
r_  generation:  0.40097784996032715
local_output_nid generation:  0.026941537857055664
local_in_edges_tensor generation:  0.02916121482849121
mini_batch_src_global generation:  0.04654264450073242
r_  generation:  0.40437936782836914
----------------------check_connections_block total spend ----------------------------- 19.03504490852356
generate_one_block  0.6079330444335938
generate_one_block  0.5361964702606201
generate_one_block  0.5039613246917725
generate_one_block  0.509737491607666
generate_one_block  0.5169236660003662
generate_one_block  0.521826982498169
generate_one_block  0.5083703994750977
generate_one_block  0.52823805809021
generate_one_block  0.5210239887237549
generate_one_block  0.5042836666107178
generate_one_block  0.5148005485534668
generate_one_block  0.5196757316589355
generate_one_block  0.5026717185974121
generate_one_block  0.5140960216522217
generate_one_block  0.5196700096130371
generate_one_block  0.4971897602081299
generate_one_block  0.51407790184021
generate_one_block  0.506014347076416
generate_one_block  0.5159096717834473
generate_one_block  0.519263505935669
generate_one_block  0.5260329246520996
generate_one_block  0.5027949810028076
generate_one_block  0.5152177810668945
generate_one_block  0.5291798114776611
generate_one_block  0.5172634124755859
generate_one_block  0.522087812423706
generate_one_block  0.5066695213317871
generate_one_block  0.516918420791626
generate_one_block  0.5335934162139893
generate_one_block  0.5084397792816162
generate_one_block  0.5074005126953125
generate_one_block  0.5149836540222168
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0213623046875 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

connection checking time:  25.59047555923462
block generation total time  22.022265911102295
average batch blocks generation time:  0.6881958097219467
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1756591796875 GB
    Memory Allocated: 0.08707094192504883  GigaBytes
Max Memory Allocated: 0.08707094192504883  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7596435546875 GB
    Memory Allocated: 16.101819038391113  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5194091796875 GB
    Memory Allocated: 0.09372282028198242  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3201904296875 GB
    Memory Allocated: 16.071843147277832  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7010498046875 GB
    Memory Allocated: 0.09217214584350586  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7010498046875 GB
    Memory Allocated: 15.278959274291992  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7010498046875 GB
    Memory Allocated: 0.0926065444946289  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7010498046875 GB
    Memory Allocated: 15.506978988647461  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7010498046875 GB
    Memory Allocated: 0.09219884872436523  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7010498046875 GB
    Memory Allocated: 15.488100051879883  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7010498046875 GB
    Memory Allocated: 0.0934896469116211  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7440185546875 GB
    Memory Allocated: 15.866082668304443  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.09244155883789062  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.704651832580566  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.09375  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.932275295257568  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.09456729888916016  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.856705665588379  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.09252595901489258  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.689943790435791  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.0936126708984375  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.933137893676758  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.09347391128540039  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.845039367675781  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.09202098846435547  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.458826541900635  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.09279680252075195  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.747564315795898  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.0925288200378418  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.67913007736206  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.09238052368164062  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.266633033752441  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.09256267547607422  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.807632446289062  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.09245538711547852  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.570968627929688  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.09352779388427734  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.695812702178955  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.09264898300170898  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.581622123718262  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.09246492385864258  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.654839038848877  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.09251880645751953  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.60068941116333  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.09357452392578125  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.785650730133057  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.09369516372680664  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.884428024291992  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.09457588195800781  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.829522132873535  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.09344244003295898  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.769082069396973  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.09334564208984375  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.428802490234375  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.09356546401977539  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.804242610931396  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.09458446502685547  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.964032649993896  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.09271526336669922  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.614112377166748  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.09230995178222656  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.477980613708496  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.09229660034179688  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.632728576660156  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03577648103237152 |0.02411092072725296 |0.28582578152418137 |9.625405073165894e-05 |0.4367954209446907 |0.008480310440063477 |
----------------------------------------------------------pseudo_mini_loss sum 5.386971473693848
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  8575636
Number of first layer input nodes during this epoch:  4652776
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.12050199508666992  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01996016502380371
random selection method range initialization spend 0.0050487518310546875
time for parepare:  0.01842188835144043
local_output_nid generation:  0.0013422966003417969
local_in_edges_tensor generation:  0.003953218460083008
mini_batch_src_global generation:  0.0014960765838623047
r_  generation:  0.008512020111083984
local_output_nid generation:  0.0015003681182861328
local_in_edges_tensor generation:  0.00096893310546875
mini_batch_src_global generation:  0.001425027847290039
r_  generation:  0.008543729782104492
local_output_nid generation:  0.001522064208984375
local_in_edges_tensor generation:  0.0008966922760009766
mini_batch_src_global generation:  0.0010454654693603516
r_  generation:  0.008200645446777344
local_output_nid generation:  0.0014955997467041016
local_in_edges_tensor generation:  0.0008499622344970703
mini_batch_src_global generation:  0.0009751319885253906
r_  generation:  0.00828099250793457
local_output_nid generation:  0.0014834403991699219
local_in_edges_tensor generation:  0.0008358955383300781
mini_batch_src_global generation:  0.0009517669677734375
r_  generation:  0.00823664665222168
local_output_nid generation:  0.0014753341674804688
local_in_edges_tensor generation:  0.0008394718170166016
mini_batch_src_global generation:  0.0009362697601318359
r_  generation:  0.008114337921142578
local_output_nid generation:  0.0014603137969970703
local_in_edges_tensor generation:  0.0008401870727539062
mini_batch_src_global generation:  0.0009000301361083984
r_  generation:  0.007945060729980469
local_output_nid generation:  0.0014793872833251953
local_in_edges_tensor generation:  0.000820159912109375
mini_batch_src_global generation:  0.0009076595306396484
r_  generation:  0.008116960525512695
local_output_nid generation:  0.0014629364013671875
local_in_edges_tensor generation:  0.0007693767547607422
mini_batch_src_global generation:  0.0008876323699951172
r_  generation:  0.00797724723815918
local_output_nid generation:  0.0014407634735107422
local_in_edges_tensor generation:  0.0008020401000976562
mini_batch_src_global generation:  0.0010097026824951172
r_  generation:  0.008366107940673828
local_output_nid generation:  0.0014519691467285156
local_in_edges_tensor generation:  0.0008034706115722656
mini_batch_src_global generation:  0.0009453296661376953
r_  generation:  0.008463144302368164
local_output_nid generation:  0.001470327377319336
local_in_edges_tensor generation:  0.0008077621459960938
mini_batch_src_global generation:  0.0009405612945556641
r_  generation:  0.008320331573486328
local_output_nid generation:  0.0014653205871582031
local_in_edges_tensor generation:  0.0007886886596679688
mini_batch_src_global generation:  0.0008952617645263672
r_  generation:  0.007970094680786133
local_output_nid generation:  0.0014677047729492188
local_in_edges_tensor generation:  0.0008006095886230469
mini_batch_src_global generation:  0.0008816719055175781
r_  generation:  0.00794363021850586
local_output_nid generation:  0.001470327377319336
local_in_edges_tensor generation:  0.0007901191711425781
mini_batch_src_global generation:  0.0009179115295410156
r_  generation:  0.008565664291381836
local_output_nid generation:  0.0014824867248535156
local_in_edges_tensor generation:  0.0007650852203369141
mini_batch_src_global generation:  0.0008716583251953125
r_  generation:  0.00796818733215332
local_output_nid generation:  0.0014717578887939453
local_in_edges_tensor generation:  0.0007617473602294922
mini_batch_src_global generation:  0.0008661746978759766
r_  generation:  0.00800776481628418
local_output_nid generation:  0.001458883285522461
local_in_edges_tensor generation:  0.0007708072662353516
mini_batch_src_global generation:  0.0009810924530029297
r_  generation:  0.008426666259765625
local_output_nid generation:  0.0014808177947998047
local_in_edges_tensor generation:  0.0007889270782470703
mini_batch_src_global generation:  0.0009310245513916016
r_  generation:  0.008467435836791992
local_output_nid generation:  0.0014722347259521484
local_in_edges_tensor generation:  0.0007488727569580078
mini_batch_src_global generation:  0.0009365081787109375
r_  generation:  0.008349418640136719
local_output_nid generation:  0.001486063003540039
local_in_edges_tensor generation:  0.0007994174957275391
mini_batch_src_global generation:  0.0009188652038574219
r_  generation:  0.008324146270751953
local_output_nid generation:  0.0014719963073730469
local_in_edges_tensor generation:  0.0007750988006591797
mini_batch_src_global generation:  0.0010461807250976562
r_  generation:  0.008583307266235352
local_output_nid generation:  0.0014712810516357422
local_in_edges_tensor generation:  0.0007557868957519531
mini_batch_src_global generation:  0.0009386539459228516
r_  generation:  0.0083770751953125
local_output_nid generation:  0.001474142074584961
local_in_edges_tensor generation:  0.0007698535919189453
mini_batch_src_global generation:  0.00090789794921875
r_  generation:  0.008304357528686523
local_output_nid generation:  0.0014634132385253906
local_in_edges_tensor generation:  0.000743865966796875
mini_batch_src_global generation:  0.0008921623229980469
r_  generation:  0.008229494094848633
local_output_nid generation:  0.0014431476593017578
local_in_edges_tensor generation:  0.0007607936859130859
mini_batch_src_global generation:  0.0008788108825683594
r_  generation:  0.008315086364746094
local_output_nid generation:  0.001443624496459961
local_in_edges_tensor generation:  0.0007760524749755859
mini_batch_src_global generation:  0.0009126663208007812
r_  generation:  0.008503913879394531
local_output_nid generation:  0.0014522075653076172
local_in_edges_tensor generation:  0.0007314682006835938
mini_batch_src_global generation:  0.0008997917175292969
r_  generation:  0.008368492126464844
local_output_nid generation:  0.0014491081237792969
local_in_edges_tensor generation:  0.0007383823394775391
mini_batch_src_global generation:  0.0009064674377441406
r_  generation:  0.008271932601928711
local_output_nid generation:  0.0014414787292480469
local_in_edges_tensor generation:  0.0007402896881103516
mini_batch_src_global generation:  0.0008943080902099609
r_  generation:  0.008418083190917969
local_output_nid generation:  0.0014386177062988281
local_in_edges_tensor generation:  0.0007369518280029297
mini_batch_src_global generation:  0.0008990764617919922
r_  generation:  0.008507490158081055
local_output_nid generation:  0.001458883285522461
local_in_edges_tensor generation:  0.0007512569427490234
mini_batch_src_global generation:  0.0009136199951171875
r_  generation:  0.008313179016113281
----------------------check_connections_block total spend ----------------------------- 0.4768364429473877
generate_one_block  0.019858837127685547
generate_one_block  0.01744842529296875
generate_one_block  0.015502452850341797
generate_one_block  0.014991283416748047
generate_one_block  0.01504206657409668
generate_one_block  0.014552831649780273
generate_one_block  0.014298677444458008
generate_one_block  0.014432668685913086
generate_one_block  0.014664411544799805
generate_one_block  0.014887571334838867
generate_one_block  0.014818906784057617
generate_one_block  0.014673709869384766
generate_one_block  0.014072895050048828
generate_one_block  0.013900041580200195
generate_one_block  0.014916419982910156
generate_one_block  0.01391911506652832
generate_one_block  0.014145374298095703
generate_one_block  0.014595508575439453
generate_one_block  0.014834165573120117
generate_one_block  0.014485597610473633
generate_one_block  0.014580726623535156
generate_one_block  0.014944314956665039
generate_one_block  0.014600276947021484
generate_one_block  0.014345645904541016
generate_one_block  0.01436758041381836
generate_one_block  0.014418363571166992
generate_one_block  0.014665842056274414
generate_one_block  0.01428675651550293
generate_one_block  0.014522790908813477
generate_one_block  0.014488935470581055
generate_one_block  0.01442861557006836
generate_one_block  0.01431584358215332
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03608226776123047
gen group dst list time:  0.019032716751098633
time for parepare:  0.019133806228637695
local_output_nid generation:  0.005160331726074219
local_in_edges_tensor generation:  0.015018463134765625
mini_batch_src_global generation:  0.01140737533569336
r_  generation:  0.11609625816345215
local_output_nid generation:  0.008299827575683594
local_in_edges_tensor generation:  0.010206460952758789
mini_batch_src_global generation:  0.014354228973388672
r_  generation:  0.12127351760864258
local_output_nid generation:  0.008719205856323242
local_in_edges_tensor generation:  0.028103113174438477
mini_batch_src_global generation:  0.013723611831665039
r_  generation:  0.1284623146057129
local_output_nid generation:  0.009030342102050781
local_in_edges_tensor generation:  0.009309768676757812
mini_batch_src_global generation:  0.014454364776611328
r_  generation:  0.1291487216949463
local_output_nid generation:  0.009208440780639648
local_in_edges_tensor generation:  0.01071310043334961
mini_batch_src_global generation:  0.015521764755249023
r_  generation:  0.13544058799743652
local_output_nid generation:  0.009049177169799805
local_in_edges_tensor generation:  0.009553194046020508
mini_batch_src_global generation:  0.015680313110351562
r_  generation:  0.13039445877075195
local_output_nid generation:  0.008514881134033203
local_in_edges_tensor generation:  0.00817561149597168
mini_batch_src_global generation:  0.015483617782592773
r_  generation:  0.13045620918273926
local_output_nid generation:  0.008495807647705078
local_in_edges_tensor generation:  0.008683919906616211
mini_batch_src_global generation:  0.015691757202148438
r_  generation:  0.13092517852783203
local_output_nid generation:  0.008626699447631836
local_in_edges_tensor generation:  0.009301185607910156
mini_batch_src_global generation:  0.018598556518554688
r_  generation:  0.13211560249328613
local_output_nid generation:  0.008971691131591797
local_in_edges_tensor generation:  0.011563777923583984
mini_batch_src_global generation:  0.016443252563476562
r_  generation:  0.13612818717956543
local_output_nid generation:  0.00929880142211914
local_in_edges_tensor generation:  0.008539199829101562
mini_batch_src_global generation:  0.017191171646118164
r_  generation:  0.13786077499389648
local_output_nid generation:  0.009086132049560547
local_in_edges_tensor generation:  0.008019208908081055
mini_batch_src_global generation:  0.01744866371154785
r_  generation:  0.1353464126586914
local_output_nid generation:  0.008754968643188477
local_in_edges_tensor generation:  0.00775146484375
mini_batch_src_global generation:  0.018176555633544922
r_  generation:  0.12777495384216309
local_output_nid generation:  0.00872802734375
local_in_edges_tensor generation:  0.008835554122924805
mini_batch_src_global generation:  0.01539468765258789
r_  generation:  0.13083958625793457
local_output_nid generation:  0.009177684783935547
local_in_edges_tensor generation:  0.010537147521972656
mini_batch_src_global generation:  0.01623845100402832
r_  generation:  0.1427631378173828
local_output_nid generation:  0.008609533309936523
local_in_edges_tensor generation:  0.008919715881347656
mini_batch_src_global generation:  0.015628814697265625
r_  generation:  0.13048362731933594
local_output_nid generation:  0.009870052337646484
local_in_edges_tensor generation:  0.015474796295166016
mini_batch_src_global generation:  0.01706862449645996
r_  generation:  0.14017701148986816
local_output_nid generation:  0.011458635330200195
local_in_edges_tensor generation:  0.011419057846069336
mini_batch_src_global generation:  0.021249771118164062
r_  generation:  0.13763093948364258
local_output_nid generation:  0.009673357009887695
local_in_edges_tensor generation:  0.009445428848266602
mini_batch_src_global generation:  0.017743587493896484
r_  generation:  0.14013338088989258
local_output_nid generation:  0.009213924407958984
local_in_edges_tensor generation:  0.009388208389282227
mini_batch_src_global generation:  0.016686677932739258
r_  generation:  0.13704967498779297
local_output_nid generation:  0.009021759033203125
local_in_edges_tensor generation:  0.010504484176635742
mini_batch_src_global generation:  0.016614913940429688
r_  generation:  0.13799810409545898
local_output_nid generation:  0.009081840515136719
local_in_edges_tensor generation:  0.010728120803833008
mini_batch_src_global generation:  0.016694068908691406
r_  generation:  0.1402297019958496
local_output_nid generation:  0.009033441543579102
local_in_edges_tensor generation:  0.009278059005737305
mini_batch_src_global generation:  0.016249418258666992
r_  generation:  0.13969898223876953
local_output_nid generation:  0.008867263793945312
local_in_edges_tensor generation:  0.008239269256591797
mini_batch_src_global generation:  0.01619887351989746
r_  generation:  0.13309407234191895
local_output_nid generation:  0.008793354034423828
local_in_edges_tensor generation:  0.008782148361206055
mini_batch_src_global generation:  0.015966176986694336
r_  generation:  0.13517546653747559
local_output_nid generation:  0.008788347244262695
local_in_edges_tensor generation:  0.010414838790893555
mini_batch_src_global generation:  0.016453027725219727
r_  generation:  0.1359410285949707
local_output_nid generation:  0.008958101272583008
local_in_edges_tensor generation:  0.010517597198486328
mini_batch_src_global generation:  0.016229629516601562
r_  generation:  0.1411278247833252
local_output_nid generation:  0.008687973022460938
local_in_edges_tensor generation:  0.009256601333618164
mini_batch_src_global generation:  0.016237735748291016
r_  generation:  0.13539791107177734
local_output_nid generation:  0.008831024169921875
local_in_edges_tensor generation:  0.008352518081665039
mini_batch_src_global generation:  0.01618027687072754
r_  generation:  0.13745832443237305
local_output_nid generation:  0.008770227432250977
local_in_edges_tensor generation:  0.011049747467041016
mini_batch_src_global generation:  0.01682758331298828
r_  generation:  0.13881182670593262
local_output_nid generation:  0.008870840072631836
local_in_edges_tensor generation:  0.008279800415039062
mini_batch_src_global generation:  0.01714301109313965
r_  generation:  0.14151597023010254
local_output_nid generation:  0.008786201477050781
local_in_edges_tensor generation:  0.008198738098144531
mini_batch_src_global generation:  0.01609516143798828
r_  generation:  0.13379788398742676
----------------------check_connections_block total spend ----------------------------- 6.46265172958374
generate_one_block  0.1763136386871338
generate_one_block  0.16736865043640137
generate_one_block  0.17560458183288574
generate_one_block  0.17590808868408203
generate_one_block  0.19445562362670898
generate_one_block  0.17320537567138672
generate_one_block  0.17211318016052246
generate_one_block  0.1730806827545166
generate_one_block  0.17224669456481934
generate_one_block  0.17776107788085938
generate_one_block  0.1805722713470459
generate_one_block  0.17242002487182617
generate_one_block  0.16266965866088867
generate_one_block  0.16332149505615234
generate_one_block  0.18375682830810547
generate_one_block  0.16729998588562012
generate_one_block  0.1690235137939453
generate_one_block  0.179976224899292
generate_one_block  0.1829664707183838
generate_one_block  0.1971285343170166
generate_one_block  0.17682623863220215
generate_one_block  0.18140912055969238
generate_one_block  0.1768505573272705
generate_one_block  0.16887497901916504
generate_one_block  0.17185735702514648
generate_one_block  0.1741194725036621
generate_one_block  0.17978453636169434
generate_one_block  0.1741640567779541
generate_one_block  0.1796262264251709
generate_one_block  0.1784658432006836
generate_one_block  0.18373608589172363
generate_one_block  0.17013883590698242
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.07790446281433105
gen group dst list time:  0.09189248085021973
time for parepare:  0.01742100715637207
local_output_nid generation:  0.022119998931884766
local_in_edges_tensor generation:  0.05376458168029785
mini_batch_src_global generation:  0.03563117980957031
r_  generation:  0.3832230567932129
local_output_nid generation:  0.02799701690673828
local_in_edges_tensor generation:  0.038703203201293945
mini_batch_src_global generation:  0.04561448097229004
r_  generation:  0.38961291313171387
local_output_nid generation:  0.02836322784423828
local_in_edges_tensor generation:  0.03313493728637695
mini_batch_src_global generation:  0.045220375061035156
r_  generation:  0.4034726619720459
local_output_nid generation:  0.026643753051757812
local_in_edges_tensor generation:  0.028960466384887695
mini_batch_src_global generation:  0.04717111587524414
r_  generation:  0.3953108787536621
local_output_nid generation:  0.02660059928894043
local_in_edges_tensor generation:  0.029280662536621094
mini_batch_src_global generation:  0.05080771446228027
r_  generation:  0.40248918533325195
local_output_nid generation:  0.026287317276000977
local_in_edges_tensor generation:  0.033171892166137695
mini_batch_src_global generation:  0.050566911697387695
r_  generation:  0.3964858055114746
local_output_nid generation:  0.026221036911010742
local_in_edges_tensor generation:  0.025844573974609375
mini_batch_src_global generation:  0.04802560806274414
r_  generation:  0.40209341049194336
local_output_nid generation:  0.02621603012084961
local_in_edges_tensor generation:  0.029271602630615234
mini_batch_src_global generation:  0.047789812088012695
r_  generation:  0.3941769599914551
local_output_nid generation:  0.02646946907043457
local_in_edges_tensor generation:  0.029480934143066406
mini_batch_src_global generation:  0.047116756439208984
r_  generation:  0.4016413688659668
local_output_nid generation:  0.026450634002685547
local_in_edges_tensor generation:  0.0395510196685791
mini_batch_src_global generation:  0.04746699333190918
r_  generation:  0.3962845802307129
local_output_nid generation:  0.02675008773803711
local_in_edges_tensor generation:  0.029664993286132812
mini_batch_src_global generation:  0.048011064529418945
r_  generation:  0.4084033966064453
local_output_nid generation:  0.026661157608032227
local_in_edges_tensor generation:  0.03044748306274414
mini_batch_src_global generation:  0.047799110412597656
r_  generation:  0.39643311500549316
local_output_nid generation:  0.025935888290405273
local_in_edges_tensor generation:  0.026180505752563477
mini_batch_src_global generation:  0.045899391174316406
r_  generation:  0.39238953590393066
local_output_nid generation:  0.026154756546020508
local_in_edges_tensor generation:  0.02555537223815918
mini_batch_src_global generation:  0.04660987854003906
r_  generation:  0.39009714126586914
local_output_nid generation:  0.0265653133392334
local_in_edges_tensor generation:  0.032405853271484375
mini_batch_src_global generation:  0.047028541564941406
r_  generation:  0.4037332534790039
local_output_nid generation:  0.028334617614746094
local_in_edges_tensor generation:  0.025730371475219727
mini_batch_src_global generation:  0.04720759391784668
r_  generation:  0.3931910991668701
local_output_nid generation:  0.02652144432067871
local_in_edges_tensor generation:  0.02852773666381836
mini_batch_src_global generation:  0.04733395576477051
r_  generation:  0.402099609375
local_output_nid generation:  0.02689218521118164
local_in_edges_tensor generation:  0.03640556335449219
mini_batch_src_global generation:  0.04746437072753906
r_  generation:  0.401439905166626
local_output_nid generation:  0.0268709659576416
local_in_edges_tensor generation:  0.03300666809082031
mini_batch_src_global generation:  0.04724311828613281
r_  generation:  0.4149811267852783
local_output_nid generation:  0.02664637565612793
local_in_edges_tensor generation:  0.02867913246154785
mini_batch_src_global generation:  0.04738879203796387
r_  generation:  0.400646448135376
local_output_nid generation:  0.02654290199279785
local_in_edges_tensor generation:  0.029297828674316406
mini_batch_src_global generation:  0.04999423027038574
r_  generation:  0.4015355110168457
local_output_nid generation:  0.026557445526123047
local_in_edges_tensor generation:  0.0327000617980957
mini_batch_src_global generation:  0.046865224838256836
r_  generation:  0.40238332748413086
local_output_nid generation:  0.026622533798217773
local_in_edges_tensor generation:  0.029430866241455078
mini_batch_src_global generation:  0.049898386001586914
r_  generation:  0.4075644016265869
local_output_nid generation:  0.027427196502685547
local_in_edges_tensor generation:  0.026363134384155273
mini_batch_src_global generation:  0.04667258262634277
r_  generation:  0.39668869972229004
local_output_nid generation:  0.026767969131469727
local_in_edges_tensor generation:  0.028800249099731445
mini_batch_src_global generation:  0.049210309982299805
r_  generation:  0.39754772186279297
local_output_nid generation:  0.02660965919494629
local_in_edges_tensor generation:  0.029976367950439453
mini_batch_src_global generation:  0.04745316505432129
r_  generation:  0.40142178535461426
local_output_nid generation:  0.026626110076904297
local_in_edges_tensor generation:  0.02530050277709961
mini_batch_src_global generation:  0.047353506088256836
r_  generation:  0.40339207649230957
local_output_nid generation:  0.026457548141479492
local_in_edges_tensor generation:  0.030312538146972656
mini_batch_src_global generation:  0.04734158515930176
r_  generation:  0.39684462547302246
local_output_nid generation:  0.02677774429321289
local_in_edges_tensor generation:  0.03634381294250488
mini_batch_src_global generation:  0.04930830001831055
r_  generation:  0.4013650417327881
local_output_nid generation:  0.02655482292175293
local_in_edges_tensor generation:  0.032187700271606445
mini_batch_src_global generation:  0.04721426963806152
r_  generation:  0.4012448787689209
local_output_nid generation:  0.026731252670288086
local_in_edges_tensor generation:  0.03261232376098633
mini_batch_src_global generation:  0.04671502113342285
r_  generation:  0.41709256172180176
local_output_nid generation:  0.026663780212402344
local_in_edges_tensor generation:  0.030523061752319336
mini_batch_src_global generation:  0.04920482635498047
r_  generation:  0.39823102951049805
----------------------check_connections_block total spend ----------------------------- 18.950380325317383
generate_one_block  0.5388195514678955
generate_one_block  0.539419412612915
generate_one_block  0.5483355522155762
generate_one_block  0.5388174057006836
generate_one_block  0.6451930999755859
generate_one_block  0.530524730682373
generate_one_block  0.5247399806976318
generate_one_block  0.5242516994476318
generate_one_block  0.5843040943145752
generate_one_block  0.5422935485839844
generate_one_block  0.5397868156433105
generate_one_block  0.5351316928863525
generate_one_block  0.5394189357757568
generate_one_block  0.5196235179901123
generate_one_block  0.5417180061340332
generate_one_block  0.5181827545166016
generate_one_block  0.5494301319122314
generate_one_block  0.5465905666351318
generate_one_block  0.5378298759460449
generate_one_block  0.5225157737731934
generate_one_block  0.5381345748901367
generate_one_block  0.5425271987915039
generate_one_block  0.5359444618225098
generate_one_block  0.5352764129638672
generate_one_block  0.5529394149780273
generate_one_block  0.5603125095367432
generate_one_block  0.5324244499206543
generate_one_block  0.5333480834960938
generate_one_block  0.5601010322570801
generate_one_block  0.5583038330078125
generate_one_block  0.5819082260131836
generate_one_block  0.5347254276275635
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.12050199508666992  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

connection checking time:  25.413032054901123
block generation total time  23.065918684005737
average batch blocks generation time:  0.7208099588751793
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10388517379760742  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.51161003112793  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10282564163208008  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.466509342193604  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10384464263916016  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.83307933807373  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.1028909683227539  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.721168041229248  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.1050572395324707  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 16.04169750213623  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.1029820442199707  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.759147644042969  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10288286209106445  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.617980003356934  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10275602340698242  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.563268661499023  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10390853881835938  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.604954719543457  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10403823852539062  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.867403984069824  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.1050405502319336  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 16.006351947784424  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10315561294555664  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.700147151947021  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10251855850219727  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.078000545501709  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10253047943115234  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.221617698669434  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10505819320678711  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 16.012410163879395  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10262584686279297  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.220699310302734  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10294437408447266  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.603454113006592  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10425186157226562  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.846570491790771  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.1050567626953125  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 16.0653338432312  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10321283340454102  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.71593427658081  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10393333435058594  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.88891077041626  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10390901565551758  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.946869850158691  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10502910614013672  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.936285972595215  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10295963287353516  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.553921222686768  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.1027383804321289  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.724189281463623  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10295820236206055  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.687685489654541  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10399627685546875  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.742753982543945  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10267210006713867  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.600994110107422  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10501289367675781  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.848585605621338  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10407543182373047  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.806872844696045  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10503053665161133  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.960734844207764  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10291719436645508  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.55048131942749  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.035952769219875336 |0.012793689966201782 |0.2648978903889656 |9.100884199142456e-05 |0.431947723031044 |0.005898952484130859 |
----------------------------------------------------------pseudo_mini_loss sum 3.8340725898742676
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  8575726
Number of first layer input nodes during this epoch:  4653853
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.12047386169433594  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027915239334106445
random selection method range initialization spend 0.0065250396728515625
time for parepare:  0.021353483200073242
local_output_nid generation:  0.0014102458953857422
local_in_edges_tensor generation:  0.00588226318359375
mini_batch_src_global generation:  0.001954317092895508
r_  generation:  0.009764909744262695
local_output_nid generation:  0.0015726089477539062
local_in_edges_tensor generation:  0.0009205341339111328
mini_batch_src_global generation:  0.0015990734100341797
r_  generation:  0.008553028106689453
local_output_nid generation:  0.00162506103515625
local_in_edges_tensor generation:  0.000873565673828125
mini_batch_src_global generation:  0.001093149185180664
r_  generation:  0.007760524749755859
local_output_nid generation:  0.001567840576171875
local_in_edges_tensor generation:  0.0008060932159423828
mini_batch_src_global generation:  0.0010616779327392578
r_  generation:  0.007854461669921875
local_output_nid generation:  0.0015254020690917969
local_in_edges_tensor generation:  0.0007736682891845703
mini_batch_src_global generation:  0.0009970664978027344
r_  generation:  0.0077915191650390625
local_output_nid generation:  0.0015196800231933594
local_in_edges_tensor generation:  0.0008072853088378906
mini_batch_src_global generation:  0.0010726451873779297
r_  generation:  0.008279561996459961
local_output_nid generation:  0.0014882087707519531
local_in_edges_tensor generation:  0.0007939338684082031
mini_batch_src_global generation:  0.0010023117065429688
r_  generation:  0.008194684982299805
local_output_nid generation:  0.0015034675598144531
local_in_edges_tensor generation:  0.0007722377777099609
mini_batch_src_global generation:  0.0009586811065673828
r_  generation:  0.008000612258911133
local_output_nid generation:  0.0014858245849609375
local_in_edges_tensor generation:  0.0007817745208740234
mini_batch_src_global generation:  0.0009407997131347656
r_  generation:  0.00827789306640625
local_output_nid generation:  0.0014984607696533203
local_in_edges_tensor generation:  0.0007851123809814453
mini_batch_src_global generation:  0.0009822845458984375
r_  generation:  0.008358240127563477
local_output_nid generation:  0.0014774799346923828
local_in_edges_tensor generation:  0.0007746219635009766
mini_batch_src_global generation:  0.0009233951568603516
r_  generation:  0.00811004638671875
local_output_nid generation:  0.0014829635620117188
local_in_edges_tensor generation:  0.0007727146148681641
mini_batch_src_global generation:  0.0009429454803466797
r_  generation:  0.008075952529907227
local_output_nid generation:  0.001470327377319336
local_in_edges_tensor generation:  0.0007834434509277344
mini_batch_src_global generation:  0.0009622573852539062
r_  generation:  0.008407115936279297
local_output_nid generation:  0.001474142074584961
local_in_edges_tensor generation:  0.0007772445678710938
mini_batch_src_global generation:  0.0009598731994628906
r_  generation:  0.008333683013916016
local_output_nid generation:  0.0014772415161132812
local_in_edges_tensor generation:  0.000782012939453125
mini_batch_src_global generation:  0.0009491443634033203
r_  generation:  0.008146524429321289
local_output_nid generation:  0.0014853477478027344
local_in_edges_tensor generation:  0.0008025169372558594
mini_batch_src_global generation:  0.0009694099426269531
r_  generation:  0.008186817169189453
local_output_nid generation:  0.0014643669128417969
local_in_edges_tensor generation:  0.0007584095001220703
mini_batch_src_global generation:  0.0009720325469970703
r_  generation:  0.008386850357055664
local_output_nid generation:  0.0014674663543701172
local_in_edges_tensor generation:  0.0007810592651367188
mini_batch_src_global generation:  0.0009987354278564453
r_  generation:  0.008458137512207031
local_output_nid generation:  0.0014705657958984375
local_in_edges_tensor generation:  0.0007529258728027344
mini_batch_src_global generation:  0.0009529590606689453
r_  generation:  0.00827789306640625
local_output_nid generation:  0.001468658447265625
local_in_edges_tensor generation:  0.0007815361022949219
mini_batch_src_global generation:  0.0009543895721435547
r_  generation:  0.008232355117797852
local_output_nid generation:  0.0014736652374267578
local_in_edges_tensor generation:  0.0007576942443847656
mini_batch_src_global generation:  0.0009915828704833984
r_  generation:  0.008507728576660156
local_output_nid generation:  0.0014736652374267578
local_in_edges_tensor generation:  0.0007989406585693359
mini_batch_src_global generation:  0.0009701251983642578
r_  generation:  0.008481264114379883
local_output_nid generation:  0.0014543533325195312
local_in_edges_tensor generation:  0.0007643699645996094
mini_batch_src_global generation:  0.0009417533874511719
r_  generation:  0.008092641830444336
local_output_nid generation:  0.0014672279357910156
local_in_edges_tensor generation:  0.0008127689361572266
mini_batch_src_global generation:  0.0009198188781738281
r_  generation:  0.008230209350585938
local_output_nid generation:  0.001468658447265625
local_in_edges_tensor generation:  0.0007698535919189453
mini_batch_src_global generation:  0.0009427070617675781
r_  generation:  0.008341312408447266
local_output_nid generation:  0.0014462471008300781
local_in_edges_tensor generation:  0.0007359981536865234
mini_batch_src_global generation:  0.0009219646453857422
r_  generation:  0.00816202163696289
local_output_nid generation:  0.0014719963073730469
local_in_edges_tensor generation:  0.0007519721984863281
mini_batch_src_global generation:  0.0009164810180664062
r_  generation:  0.008234024047851562
local_output_nid generation:  0.0014677047729492188
local_in_edges_tensor generation:  0.0007150173187255859
mini_batch_src_global generation:  0.0009343624114990234
r_  generation:  0.00827789306640625
local_output_nid generation:  0.001455545425415039
local_in_edges_tensor generation:  0.0007681846618652344
mini_batch_src_global generation:  0.0009696483612060547
r_  generation:  0.008556365966796875
local_output_nid generation:  0.0014584064483642578
local_in_edges_tensor generation:  0.0007834434509277344
mini_batch_src_global generation:  0.0009310245513916016
r_  generation:  0.008068084716796875
local_output_nid generation:  0.0014750957489013672
local_in_edges_tensor generation:  0.0007579326629638672
mini_batch_src_global generation:  0.0009329319000244141
r_  generation:  0.008240938186645508
local_output_nid generation:  0.0014543533325195312
local_in_edges_tensor generation:  0.0007505416870117188
mini_batch_src_global generation:  0.0009336471557617188
r_  generation:  0.00833749771118164
----------------------check_connections_block total spend ----------------------------- 0.479755163192749
generate_one_block  0.021363258361816406
generate_one_block  0.018105506896972656
generate_one_block  0.014844655990600586
generate_one_block  0.014693737030029297
generate_one_block  0.014344215393066406
generate_one_block  0.014971733093261719
generate_one_block  0.01466989517211914
generate_one_block  0.01430058479309082
generate_one_block  0.014827966690063477
generate_one_block  0.01477670669555664
generate_one_block  0.014275550842285156
generate_one_block  0.014451742172241211
generate_one_block  0.014860868453979492
generate_one_block  0.014676570892333984
generate_one_block  0.014338016510009766
generate_one_block  0.014380455017089844
generate_one_block  0.014707803726196289
generate_one_block  0.014777183532714844
generate_one_block  0.014363527297973633
generate_one_block  0.014415740966796875
generate_one_block  0.014844179153442383
generate_one_block  0.014845609664916992
generate_one_block  0.014283418655395508
generate_one_block  0.014285087585449219
generate_one_block  0.014577388763427734
generate_one_block  0.014179468154907227
generate_one_block  0.0145721435546875
generate_one_block  0.014452457427978516
generate_one_block  0.014943838119506836
generate_one_block  0.014110088348388672
generate_one_block  0.014371156692504883
generate_one_block  0.01446986198425293
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03673434257507324
gen group dst list time:  0.02287125587463379
time for parepare:  0.019426584243774414
local_output_nid generation:  0.005217552185058594
local_in_edges_tensor generation:  0.01682877540588379
mini_batch_src_global generation:  0.01432347297668457
r_  generation:  0.12002992630004883
local_output_nid generation:  0.007790327072143555
local_in_edges_tensor generation:  0.010503530502319336
mini_batch_src_global generation:  0.018518924713134766
r_  generation:  0.15539932250976562
local_output_nid generation:  0.01233816146850586
local_in_edges_tensor generation:  0.04179263114929199
mini_batch_src_global generation:  0.015315055847167969
r_  generation:  0.146378755569458
local_output_nid generation:  0.014844655990600586
local_in_edges_tensor generation:  0.009657859802246094
mini_batch_src_global generation:  0.017557859420776367
r_  generation:  0.13129878044128418
local_output_nid generation:  0.009545087814331055
local_in_edges_tensor generation:  0.007763385772705078
mini_batch_src_global generation:  0.017258882522583008
r_  generation:  0.1322314739227295
local_output_nid generation:  0.009630203247070312
local_in_edges_tensor generation:  0.009159088134765625
mini_batch_src_global generation:  0.018881797790527344
r_  generation:  0.1381206512451172
local_output_nid generation:  0.00913238525390625
local_in_edges_tensor generation:  0.007474422454833984
mini_batch_src_global generation:  0.01833510398864746
r_  generation:  0.13511323928833008
local_output_nid generation:  0.008816003799438477
local_in_edges_tensor generation:  0.007325887680053711
mini_batch_src_global generation:  0.026789426803588867
r_  generation:  0.14774370193481445
local_output_nid generation:  0.012682199478149414
local_in_edges_tensor generation:  0.010126829147338867
mini_batch_src_global generation:  0.019907474517822266
r_  generation:  0.15293407440185547
local_output_nid generation:  0.013168811798095703
local_in_edges_tensor generation:  0.010350227355957031
mini_batch_src_global generation:  0.01858377456665039
r_  generation:  0.15286898612976074
local_output_nid generation:  0.013309955596923828
local_in_edges_tensor generation:  0.01066446304321289
mini_batch_src_global generation:  0.01894235610961914
r_  generation:  0.15050196647644043
local_output_nid generation:  0.013175010681152344
local_in_edges_tensor generation:  0.010241508483886719
mini_batch_src_global generation:  0.01864027976989746
r_  generation:  0.15148186683654785
local_output_nid generation:  0.013554096221923828
local_in_edges_tensor generation:  0.011425256729125977
mini_batch_src_global generation:  0.019616365432739258
r_  generation:  0.1696786880493164
local_output_nid generation:  0.013773918151855469
local_in_edges_tensor generation:  0.009981870651245117
mini_batch_src_global generation:  0.03356432914733887
r_  generation:  0.1454768180847168
local_output_nid generation:  0.009735822677612305
local_in_edges_tensor generation:  0.008735418319702148
mini_batch_src_global generation:  0.019287824630737305
r_  generation:  0.143967866897583
local_output_nid generation:  0.009237289428710938
local_in_edges_tensor generation:  0.007913827896118164
mini_batch_src_global generation:  0.017199039459228516
r_  generation:  0.14074444770812988
local_output_nid generation:  0.008946418762207031
local_in_edges_tensor generation:  0.007920980453491211
mini_batch_src_global generation:  0.016564607620239258
r_  generation:  0.1383192539215088
local_output_nid generation:  0.009065389633178711
local_in_edges_tensor generation:  0.007684946060180664
mini_batch_src_global generation:  0.02331399917602539
r_  generation:  0.14049887657165527
local_output_nid generation:  0.008652925491333008
local_in_edges_tensor generation:  0.007359743118286133
mini_batch_src_global generation:  0.02837204933166504
r_  generation:  0.15477657318115234
local_output_nid generation:  0.012871742248535156
local_in_edges_tensor generation:  0.010000467300415039
mini_batch_src_global generation:  0.02307915687561035
r_  generation:  0.15872454643249512
local_output_nid generation:  0.014443159103393555
local_in_edges_tensor generation:  0.018362760543823242
mini_batch_src_global generation:  0.02951836585998535
r_  generation:  0.17113304138183594
local_output_nid generation:  0.013470172882080078
local_in_edges_tensor generation:  0.015615701675415039
mini_batch_src_global generation:  0.023022890090942383
r_  generation:  0.17272472381591797
local_output_nid generation:  0.011823415756225586
local_in_edges_tensor generation:  0.010212898254394531
mini_batch_src_global generation:  0.03065180778503418
r_  generation:  0.15389204025268555
local_output_nid generation:  0.012626886367797852
local_in_edges_tensor generation:  0.009970664978027344
mini_batch_src_global generation:  0.019361257553100586
r_  generation:  0.15723943710327148
local_output_nid generation:  0.013210058212280273
local_in_edges_tensor generation:  0.013069629669189453
mini_batch_src_global generation:  0.01963973045349121
r_  generation:  0.16224455833435059
local_output_nid generation:  0.012907981872558594
local_in_edges_tensor generation:  0.014622688293457031
mini_batch_src_global generation:  0.01998138427734375
r_  generation:  0.15227150917053223
local_output_nid generation:  0.013309478759765625
local_in_edges_tensor generation:  0.010360002517700195
mini_batch_src_global generation:  0.022569656372070312
r_  generation:  0.15689921379089355
local_output_nid generation:  0.015353679656982422
local_in_edges_tensor generation:  0.011765003204345703
mini_batch_src_global generation:  0.01908707618713379
r_  generation:  0.17414212226867676
local_output_nid generation:  0.02016162872314453
local_in_edges_tensor generation:  0.010125160217285156
mini_batch_src_global generation:  0.017723798751831055
r_  generation:  0.14940905570983887
local_output_nid generation:  0.011352300643920898
local_in_edges_tensor generation:  0.00995945930480957
mini_batch_src_global generation:  0.015820741653442383
r_  generation:  0.13959407806396484
local_output_nid generation:  0.014440298080444336
local_in_edges_tensor generation:  0.010267257690429688
mini_batch_src_global generation:  0.03482866287231445
r_  generation:  0.15623068809509277
local_output_nid generation:  0.01050567626953125
local_in_edges_tensor generation:  0.010109901428222656
mini_batch_src_global generation:  0.036389827728271484
r_  generation:  0.15583539009094238
----------------------check_connections_block total spend ----------------------------- 7.4264161586761475
generate_one_block  0.18598604202270508
generate_one_block  0.1906735897064209
generate_one_block  0.18543386459350586
generate_one_block  0.1816267967224121
generate_one_block  0.19137859344482422
generate_one_block  0.1808624267578125
generate_one_block  0.17682504653930664
generate_one_block  0.17088818550109863
generate_one_block  0.20586633682250977
generate_one_block  0.17760300636291504
generate_one_block  0.16992855072021484
generate_one_block  0.17168307304382324
generate_one_block  0.1863536834716797
generate_one_block  0.19927430152893066
generate_one_block  0.17707109451293945
generate_one_block  0.17834186553955078
generate_one_block  0.17606401443481445
generate_one_block  0.18143558502197266
generate_one_block  0.17278814315795898
generate_one_block  0.21175932884216309
generate_one_block  0.1945781707763672
generate_one_block  0.17940068244934082
generate_one_block  0.17800164222717285
generate_one_block  0.18173766136169434
generate_one_block  0.17459392547607422
generate_one_block  0.1703019142150879
generate_one_block  0.17530417442321777
generate_one_block  0.17455148696899414
generate_one_block  0.1817455291748047
generate_one_block  0.1707606315612793
generate_one_block  0.1726231575012207
generate_one_block  0.17555618286132812
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03983473777770996
gen group dst list time:  0.12132072448730469
time for parepare:  0.023935556411743164
local_output_nid generation:  0.039826154708862305
local_in_edges_tensor generation:  0.06050825119018555
mini_batch_src_global generation:  0.0381770133972168
r_  generation:  0.39838576316833496
local_output_nid generation:  0.033684492111206055
local_in_edges_tensor generation:  0.03505206108093262
mini_batch_src_global generation:  0.046492576599121094
r_  generation:  0.41286134719848633
local_output_nid generation:  0.02850961685180664
local_in_edges_tensor generation:  0.028858661651611328
mini_batch_src_global generation:  0.05488085746765137
r_  generation:  0.4124767780303955
local_output_nid generation:  0.027459383010864258
local_in_edges_tensor generation:  0.0314943790435791
mini_batch_src_global generation:  0.04904532432556152
r_  generation:  0.403796911239624
local_output_nid generation:  0.0269167423248291
local_in_edges_tensor generation:  0.02966141700744629
mini_batch_src_global generation:  0.049584150314331055
r_  generation:  0.43421125411987305
local_output_nid generation:  0.033930063247680664
local_in_edges_tensor generation:  0.029487133026123047
mini_batch_src_global generation:  0.05405735969543457
r_  generation:  0.40535402297973633
local_output_nid generation:  0.03071427345275879
local_in_edges_tensor generation:  0.02803516387939453
mini_batch_src_global generation:  0.04757428169250488
r_  generation:  0.4097721576690674
local_output_nid generation:  0.030031681060791016
local_in_edges_tensor generation:  0.02710270881652832
mini_batch_src_global generation:  0.0480954647064209
r_  generation:  0.3966484069824219
local_output_nid generation:  0.030794620513916016
local_in_edges_tensor generation:  0.02487492561340332
mini_batch_src_global generation:  0.04729127883911133
r_  generation:  0.4159078598022461
local_output_nid generation:  0.030376672744750977
local_in_edges_tensor generation:  0.026687145233154297
mini_batch_src_global generation:  0.06513118743896484
r_  generation:  0.4111030101776123
local_output_nid generation:  0.030478477478027344
local_in_edges_tensor generation:  0.036073923110961914
mini_batch_src_global generation:  0.04860734939575195
r_  generation:  0.4116694927215576
local_output_nid generation:  0.030265331268310547
local_in_edges_tensor generation:  0.028330087661743164
mini_batch_src_global generation:  0.04749441146850586
r_  generation:  0.4021437168121338
local_output_nid generation:  0.030385255813598633
local_in_edges_tensor generation:  0.027184724807739258
mini_batch_src_global generation:  0.051026105880737305
r_  generation:  0.41067004203796387
local_output_nid generation:  0.030557870864868164
local_in_edges_tensor generation:  0.02547621726989746
mini_batch_src_global generation:  0.05080747604370117
r_  generation:  0.41802358627319336
local_output_nid generation:  0.03191113471984863
local_in_edges_tensor generation:  0.026597023010253906
mini_batch_src_global generation:  0.04759550094604492
r_  generation:  0.4136490821838379
local_output_nid generation:  0.031207561492919922
local_in_edges_tensor generation:  0.027114391326904297
mini_batch_src_global generation:  0.04806184768676758
r_  generation:  0.39949965476989746
local_output_nid generation:  0.030347585678100586
local_in_edges_tensor generation:  0.024789810180664062
mini_batch_src_global generation:  0.046608686447143555
r_  generation:  0.4052846431732178
local_output_nid generation:  0.0303955078125
local_in_edges_tensor generation:  0.02798008918762207
mini_batch_src_global generation:  0.04820847511291504
r_  generation:  0.4065437316894531
local_output_nid generation:  0.03011178970336914
local_in_edges_tensor generation:  0.030339479446411133
mini_batch_src_global generation:  0.04673480987548828
r_  generation:  0.4044797420501709
local_output_nid generation:  0.030416011810302734
local_in_edges_tensor generation:  0.025298357009887695
mini_batch_src_global generation:  0.07727336883544922
r_  generation:  0.4042775630950928
local_output_nid generation:  0.030328750610351562
local_in_edges_tensor generation:  0.028455018997192383
mini_batch_src_global generation:  0.06120920181274414
r_  generation:  0.40784454345703125
local_output_nid generation:  0.030563831329345703
local_in_edges_tensor generation:  0.027938365936279297
mini_batch_src_global generation:  0.05209469795227051
r_  generation:  0.41115760803222656
local_output_nid generation:  0.0303652286529541
local_in_edges_tensor generation:  0.033483266830444336
mini_batch_src_global generation:  0.04634881019592285
r_  generation:  0.4147953987121582
local_output_nid generation:  0.030361413955688477
local_in_edges_tensor generation:  0.03235197067260742
mini_batch_src_global generation:  0.04779815673828125
r_  generation:  0.40648937225341797
local_output_nid generation:  0.03031468391418457
local_in_edges_tensor generation:  0.029079675674438477
mini_batch_src_global generation:  0.04616665840148926
r_  generation:  0.4103810787200928
local_output_nid generation:  0.030377626419067383
local_in_edges_tensor generation:  0.027258872985839844
mini_batch_src_global generation:  0.047818660736083984
r_  generation:  0.4039151668548584
local_output_nid generation:  0.030514001846313477
local_in_edges_tensor generation:  0.026576757431030273
mini_batch_src_global generation:  0.04691720008850098
r_  generation:  0.40936923027038574
local_output_nid generation:  0.03052353858947754
local_in_edges_tensor generation:  0.030594587326049805
mini_batch_src_global generation:  0.04787778854370117
r_  generation:  0.40923595428466797
local_output_nid generation:  0.03053903579711914
local_in_edges_tensor generation:  0.02731776237487793
mini_batch_src_global generation:  0.047388315200805664
r_  generation:  0.4106791019439697
local_output_nid generation:  0.03018951416015625
local_in_edges_tensor generation:  0.02700185775756836
mini_batch_src_global generation:  0.04787850379943848
r_  generation:  0.42032337188720703
local_output_nid generation:  0.03244328498840332
local_in_edges_tensor generation:  0.026833534240722656
mini_batch_src_global generation:  0.0472714900970459
r_  generation:  0.4153881072998047
local_output_nid generation:  0.03156137466430664
local_in_edges_tensor generation:  0.024915218353271484
mini_batch_src_global generation:  0.04784035682678223
r_  generation:  0.40390872955322266
----------------------check_connections_block total spend ----------------------------- 19.526416063308716
generate_one_block  0.5462534427642822
generate_one_block  0.532846212387085
generate_one_block  0.5254147052764893
generate_one_block  0.5318126678466797
generate_one_block  0.6444168090820312
generate_one_block  0.5427320003509521
generate_one_block  0.5522623062133789
generate_one_block  0.5267715454101562
generate_one_block  0.5384385585784912
generate_one_block  0.5340135097503662
generate_one_block  0.5326318740844727
generate_one_block  0.5249195098876953
generate_one_block  0.538947343826294
generate_one_block  0.5478911399841309
generate_one_block  0.534233570098877
generate_one_block  0.5358970165252686
generate_one_block  0.5341601371765137
generate_one_block  0.5369877815246582
generate_one_block  0.5268003940582275
generate_one_block  0.5327246189117432
generate_one_block  0.5423672199249268
generate_one_block  0.549281120300293
generate_one_block  0.5364828109741211
generate_one_block  0.5293900966644287
generate_one_block  0.5456609725952148
generate_one_block  0.5305256843566895
generate_one_block  0.5386600494384766
generate_one_block  0.5450775623321533
generate_one_block  0.5539760589599609
generate_one_block  0.5267362594604492
generate_one_block  0.528254508972168
generate_one_block  0.5474398136138916
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.12047386169433594  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

connection checking time:  26.952832221984863
block generation total time  23.095005989074707
average batch blocks generation time:  0.7217189371585846
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.1028742790222168  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.706566333770752  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10288333892822266  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.755669593811035  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10379409790039062  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.424666404724121  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10270452499389648  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.569407939910889  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10296630859375  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.664546489715576  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.1040048599243164  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.993234157562256  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.1039896011352539  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.711674690246582  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10256099700927734  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.361343383789062  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10504007339477539  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.92555284500122  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.1030731201171875  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.733412265777588  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10290384292602539  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.528192043304443  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10277080535888672  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.486956596374512  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10504674911499023  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.968945026397705  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10418176651000977  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.938608169555664  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10378503799438477  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.806920051574707  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10424232482910156  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.839228630065918  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10394287109375  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.630714416503906  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10432291030883789  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.84952449798584  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10282325744628906  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.48897933959961  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10302400588989258  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.647303581237793  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10505247116088867  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.96159315109253  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10416793823242188  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.906873226165771  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10394287109375  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.634563446044922  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10280752182006836  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.752951622009277  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10394859313964844  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.631125926971436  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10282278060913086  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.46674108505249  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10399436950683594  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.724824905395508  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10326242446899414  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.716119766235352  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10506343841552734  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 16.05985736846924  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10300731658935547  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.544265270233154  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10269975662231445  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 15.59645128250122  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 0.10320234298706055  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 15.696458339691162  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03359515219926834 |0.011881321668624878 |0.2682136446237564 |9.305775165557861e-05 |0.4310382381081581 |0.006077289581298828 |
----------------------------------------------------------pseudo_mini_loss sum 3.342381477355957
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  8576555
Number of first layer input nodes during this epoch:  4655133
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 0.12053585052490234  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03125190734863281
random selection method range initialization spend 0.006638288497924805
time for parepare:  0.02308821678161621
local_output_nid generation:  0.001901388168334961
local_in_edges_tensor generation:  0.006270408630371094
mini_batch_src_global generation:  0.0020837783813476562
r_  generation:  0.009057044982910156
local_output_nid generation:  0.0018742084503173828
local_in_edges_tensor generation:  0.0011749267578125
mini_batch_src_global generation:  0.0019495487213134766
r_  generation:  0.009103775024414062
local_output_nid generation:  0.0019714832305908203
local_in_edges_tensor generation:  0.0010902881622314453
mini_batch_src_global generation:  0.0012049674987792969
r_  generation:  0.008271217346191406
local_output_nid generation:  0.0020341873168945312
local_in_edges_tensor generation:  0.0010595321655273438
mini_batch_src_global generation:  0.0011615753173828125
r_  generation:  0.016730546951293945
local_output_nid generation:  0.002420663833618164
local_in_edges_tensor generation:  0.0012040138244628906
mini_batch_src_global generation:  0.0013077259063720703
r_  generation:  0.008478403091430664
local_output_nid generation:  0.002079486846923828
local_in_edges_tensor generation:  0.0009860992431640625
mini_batch_src_global generation:  0.0011050701141357422
r_  generation:  0.008134603500366211
local_output_nid generation:  0.001955270767211914
local_in_edges_tensor generation:  0.0009136199951171875
mini_batch_src_global generation:  0.0012326240539550781
r_  generation:  0.008171558380126953
local_output_nid generation:  0.0018689632415771484
local_in_edges_tensor generation:  0.0008554458618164062
mini_batch_src_global generation:  0.0009381771087646484
r_  generation:  0.008169889450073242
local_output_nid generation:  0.0018243789672851562
local_in_edges_tensor generation:  0.0008401870727539062
mini_batch_src_global generation:  0.000926971435546875
r_  generation:  0.00832509994506836
local_output_nid generation:  0.0017652511596679688
local_in_edges_tensor generation:  0.0008885860443115234
mini_batch_src_global generation:  0.0009331703186035156
r_  generation:  0.008466243743896484
local_output_nid generation:  0.0017418861389160156
local_in_edges_tensor generation:  0.0008625984191894531
mini_batch_src_global generation:  0.0009455680847167969
r_  generation:  0.008164405822753906
local_output_nid generation:  0.0017054080963134766
local_in_edges_tensor generation:  0.0008311271667480469
mini_batch_src_global generation:  0.0009005069732666016
r_  generation:  0.008315801620483398
local_output_nid generation:  0.0016853809356689453
local_in_edges_tensor generation:  0.0008327960968017578
mini_batch_src_global generation:  0.0009443759918212891
r_  generation:  0.008469104766845703
local_output_nid generation:  0.00167083740234375
local_in_edges_tensor generation:  0.0008132457733154297
mini_batch_src_global generation:  0.0009446144104003906
r_  generation:  0.007920503616333008
local_output_nid generation:  0.001651763916015625
local_in_edges_tensor generation:  0.0007982254028320312
mini_batch_src_global generation:  0.0009100437164306641
r_  generation:  0.008412361145019531
local_output_nid generation:  0.0016183853149414062
local_in_edges_tensor generation:  0.0008134841918945312
mini_batch_src_global generation:  0.0009222030639648438
r_  generation:  0.008376836776733398
local_output_nid generation:  0.0015957355499267578
local_in_edges_tensor generation:  0.0008187294006347656
mini_batch_src_global generation:  0.0009095668792724609
r_  generation:  0.008258581161499023
local_output_nid generation:  0.0015673637390136719
local_in_edges_tensor generation:  0.0008134841918945312
mini_batch_src_global generation:  0.0009336471557617188
r_  generation:  0.008099079132080078
local_output_nid generation:  0.0015740394592285156
local_in_edges_tensor generation:  0.0007855892181396484
mini_batch_src_global generation:  0.0009016990661621094
r_  generation:  0.008345365524291992
local_output_nid generation:  0.0015456676483154297
local_in_edges_tensor generation:  0.0008177757263183594
mini_batch_src_global generation:  0.0008883476257324219
r_  generation:  0.007966279983520508
local_output_nid generation:  0.0015654563903808594
local_in_edges_tensor generation:  0.0007948875427246094
mini_batch_src_global generation:  0.0009298324584960938
r_  generation:  0.00848841667175293
local_output_nid generation:  0.0015568733215332031
local_in_edges_tensor generation:  0.0008003711700439453
mini_batch_src_global generation:  0.0009009838104248047
r_  generation:  0.008263826370239258
local_output_nid generation:  0.0015184879302978516
local_in_edges_tensor generation:  0.0007758140563964844
mini_batch_src_global generation:  0.0009965896606445312
r_  generation:  0.008499383926391602
local_output_nid generation:  0.001527547836303711
local_in_edges_tensor generation:  0.0008499622344970703
mini_batch_src_global generation:  0.0008828639984130859
r_  generation:  0.00827789306640625
local_output_nid generation:  0.0015366077423095703
local_in_edges_tensor generation:  0.0007941722869873047
mini_batch_src_global generation:  0.0009076595306396484
r_  generation:  0.008378028869628906
local_output_nid generation:  0.0014963150024414062
local_in_edges_tensor generation:  0.0008046627044677734
mini_batch_src_global generation:  0.0009524822235107422
r_  generation:  0.00807809829711914
local_output_nid generation:  0.0014989376068115234
local_in_edges_tensor generation:  0.0007960796356201172
mini_batch_src_global generation:  0.0008800029754638672
r_  generation:  0.008252620697021484
local_output_nid generation:  0.0015034675598144531
local_in_edges_tensor generation:  0.0007834434509277344
mini_batch_src_global generation:  0.0008747577667236328
r_  generation:  0.008260488510131836
local_output_nid generation:  0.0014827251434326172
local_in_edges_tensor generation:  0.0007758140563964844
mini_batch_src_global generation:  0.0008804798126220703
r_  generation:  0.008222103118896484
local_output_nid generation:  0.0014646053314208984
local_in_edges_tensor generation:  0.0007722377777099609
mini_batch_src_global generation:  0.0008835792541503906
r_  generation:  0.009917259216308594
local_output_nid generation:  0.0014777183532714844
local_in_edges_tensor generation:  0.0007824897766113281
mini_batch_src_global generation:  0.0009043216705322266
r_  generation:  0.008481979370117188
local_output_nid generation:  0.0014700889587402344
local_in_edges_tensor generation:  0.0007905960083007812
mini_batch_src_global generation:  0.0009026527404785156
r_  generation:  0.00824594497680664
----------------------check_connections_block total spend ----------------------------- 0.5112166404724121
generate_one_block  0.02380847930908203
generate_one_block  0.01784038543701172
generate_one_block  0.015292167663574219
generate_one_block  0.016570568084716797
generate_one_block  0.014627456665039062
generate_one_block  0.01461172103881836
generate_one_block  0.014384269714355469
generate_one_block  0.014536857604980469
generate_one_block  0.014649152755737305
generate_one_block  0.01479029655456543
generate_one_block  0.014234304428100586
generate_one_block  0.016208171844482422
generate_one_block  0.014760732650756836
generate_one_block  0.014034032821655273
generate_one_block  0.014626264572143555
generate_one_block  0.014558792114257812
generate_one_block  0.014333009719848633
generate_one_block  0.014146566390991211
generate_one_block  0.01650834083557129
generate_one_block  0.01396489143371582
generate_one_block  0.014862060546875
generate_one_block  0.014556169509887695
generate_one_block  0.01477813720703125
generate_one_block  0.014456033706665039
generate_one_block  0.014519929885864258
generate_one_block  0.01620173454284668
generate_one_block  0.01441049575805664
generate_one_block  0.01437687873840332
generate_one_block  0.014364004135131836
generate_one_block  0.014163970947265625
generate_one_block  0.014503002166748047
generate_one_block  0.014391183853149414
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03916811943054199
gen group dst list time:  0.020792722702026367
time for parepare:  0.021770954132080078
local_output_nid generation:  0.005494356155395508
local_in_edges_tensor generation:  0.016968965530395508
mini_batch_src_global generation:  0.016735315322875977
r_  generation:  0.1219794750213623
local_output_nid generation:  0.007875919342041016
local_in_edges_tensor generation:  0.00981450080871582
mini_batch_src_global generation:  0.014583110809326172
r_  generation:  0.1272289752960205
local_output_nid generation:  0.008166074752807617
local_in_edges_tensor generation:  0.02748394012451172
mini_batch_src_global generation:  0.013475179672241211
r_  generation:  0.13468027114868164
local_output_nid generation:  0.008537769317626953
local_in_edges_tensor generation:  0.007505655288696289
mini_batch_src_global generation:  0.01437234878540039
r_  generation:  0.13618779182434082
local_output_nid generation:  0.01029062271118164
local_in_edges_tensor generation:  0.010392427444458008
mini_batch_src_global generation:  0.01504659652709961
r_  generation:  0.13664650917053223
local_output_nid generation:  0.008404016494750977
local_in_edges_tensor generation:  0.00957036018371582
mini_batch_src_global generation:  0.01589369773864746
r_  generation:  0.13719701766967773
local_output_nid generation:  0.008025884628295898
local_in_edges_tensor generation:  0.0074138641357421875
mini_batch_src_global generation:  0.015907764434814453
r_  generation:  0.13621878623962402
local_output_nid generation:  0.007953882217407227
local_in_edges_tensor generation:  0.008243322372436523
mini_batch_src_global generation:  0.016800403594970703
r_  generation:  0.1359117031097412
local_output_nid generation:  0.008109331130981445
local_in_edges_tensor generation:  0.007476091384887695
mini_batch_src_global generation:  0.0170290470123291
r_  generation:  0.13910531997680664
local_output_nid generation:  0.008342504501342773
local_in_edges_tensor generation:  0.008399248123168945
mini_batch_src_global generation:  0.0186769962310791
r_  generation:  0.14040851593017578
local_output_nid generation:  0.008252382278442383
local_in_edges_tensor generation:  0.009984016418457031
mini_batch_src_global generation:  0.016011476516723633
r_  generation:  0.1335148811340332
local_output_nid generation:  0.008367776870727539
local_in_edges_tensor generation:  0.007611751556396484
mini_batch_src_global generation:  0.016384601593017578
r_  generation:  0.13782811164855957
local_output_nid generation:  0.008500814437866211
local_in_edges_tensor generation:  0.008186101913452148
mini_batch_src_global generation:  0.01687312126159668
r_  generation:  0.1404733657836914
local_output_nid generation:  0.008127450942993164
local_in_edges_tensor generation:  0.007349967956542969
mini_batch_src_global generation:  0.015893936157226562
r_  generation:  0.13216781616210938
local_output_nid generation:  0.008415937423706055
local_in_edges_tensor generation:  0.0075719356536865234
mini_batch_src_global generation:  0.016286373138427734
r_  generation:  0.1417980194091797
local_output_nid generation:  0.008376359939575195
local_in_edges_tensor generation:  0.007926702499389648
mini_batch_src_global generation:  0.019472122192382812
r_  generation:  0.13765835762023926
local_output_nid generation:  0.008401632308959961
local_in_edges_tensor generation:  0.007497549057006836
mini_batch_src_global generation:  0.018056869506835938
r_  generation:  0.13947391510009766
local_output_nid generation:  0.008291482925415039
local_in_edges_tensor generation:  0.008025884628295898
mini_batch_src_global generation:  0.017878055572509766
r_  generation:  0.13768768310546875
local_output_nid generation:  0.009121417999267578
local_in_edges_tensor generation:  0.008081197738647461
mini_batch_src_global generation:  0.017132282257080078
r_  generation:  0.13996529579162598
local_output_nid generation:  0.009459972381591797
local_in_edges_tensor generation:  0.009178400039672852
mini_batch_src_global generation:  0.01610732078552246
r_  generation:  0.1358795166015625
local_output_nid generation:  0.008689165115356445
local_in_edges_tensor generation:  0.007657051086425781
mini_batch_src_global generation:  0.01705002784729004
r_  generation:  0.14054226875305176
local_output_nid generation:  0.008586883544921875
local_in_edges_tensor generation:  0.008542776107788086
mini_batch_src_global generation:  0.016476154327392578
r_  generation:  0.13715600967407227
local_output_nid generation:  0.008739233016967773
local_in_edges_tensor generation:  0.008761882781982422
mini_batch_src_global generation:  0.016576528549194336
r_  generation:  0.13834333419799805
local_output_nid generation:  0.008653640747070312
local_in_edges_tensor generation:  0.007534027099609375
mini_batch_src_global generation:  0.016889333724975586
r_  generation:  0.13584446907043457
local_output_nid generation:  0.00854182243347168
local_in_edges_tensor generation:  0.0079803466796875
mini_batch_src_global generation:  0.016225337982177734
r_  generation:  0.139268159866333
local_output_nid generation:  0.008465290069580078
local_in_edges_tensor generation:  0.007457733154296875
mini_batch_src_global generation:  0.01825571060180664
r_  generation:  0.13494062423706055
local_output_nid generation:  0.008430719375610352
local_in_edges_tensor generation:  0.00737452507019043
mini_batch_src_global generation:  0.016206979751586914
r_  generation:  0.13842272758483887
local_output_nid generation:  0.008545398712158203
local_in_edges_tensor generation:  0.008418083190917969
mini_batch_src_global generation:  0.016132831573486328
r_  generation:  0.1392068862915039
local_output_nid generation:  0.008557796478271484
local_in_edges_tensor generation:  0.008062124252319336
mini_batch_src_global generation:  0.015857219696044922
r_  generation:  0.13883161544799805
local_output_nid generation:  0.008494853973388672
local_in_edges_tensor generation:  0.0074481964111328125
mini_batch_src_global generation:  0.016015291213989258
r_  generation:  0.14054512977600098
local_output_nid generation:  0.008640289306640625
local_in_edges_tensor generation:  0.009289741516113281
mini_batch_src_global generation:  0.016181230545043945
r_  generation:  0.14066243171691895
local_output_nid generation:  0.008581399917602539
local_in_edges_tensor generation:  0.007548809051513672
mini_batch_src_global generation:  0.01628851890563965
r_  generation:  0.13717961311340332
----------------------check_connections_block total spend ----------------------------- 6.517625570297241
generate_one_block  0.18137860298156738
generate_one_block  0.17048144340515137
generate_one_block  0.1752328872680664
generate_one_block  0.17590928077697754
generate_one_block  0.18795251846313477
generate_one_block  0.17481517791748047
generate_one_block  0.17460227012634277
generate_one_block  0.17746186256408691
generate_one_block  0.1757652759552002
generate_one_block  0.17822527885437012
generate_one_block  0.16892766952514648
generate_one_block  0.1759200096130371
generate_one_block  0.18423247337341309
generate_one_block  0.16829991340637207
generate_one_block  0.1768181324005127
generate_one_block  0.17547965049743652
generate_one_block  0.17308998107910156
generate_one_block  0.17394661903381348
generate_one_block  0.17960071563720703
generate_one_block  0.20900797843933105
generate_one_block  0.18503713607788086
generate_one_block  0.18056058883666992
generate_one_block  0.17786717414855957
generate_one_block  0.1754894256591797
generate_one_block  0.17737889289855957
generate_one_block  0.17321133613586426
generate_one_block  0.1767878532409668
generate_one_block  0.17766141891479492
generate_one_block  0.17651844024658203
generate_one_block  0.17840790748596191
generate_one_block  0.1866292953491211
generate_one_block  0.17917609214782715
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.032465219497680664
gen group dst list time:  0.10197114944458008
time for parepare:  0.02068328857421875
local_output_nid generation:  0.025240182876586914
local_in_edges_tensor generation:  0.05095982551574707
mini_batch_src_global generation:  0.03540825843811035
r_  generation:  0.39063405990600586
local_output_nid generation:  0.0287168025970459
local_in_edges_tensor generation:  0.031653642654418945
mini_batch_src_global generation:  0.04609990119934082
r_  generation:  0.38946080207824707
local_output_nid generation:  0.0289764404296875
local_in_edges_tensor generation:  0.03056192398071289
mini_batch_src_global generation:  0.04528069496154785
r_  generation:  0.4231746196746826
local_output_nid generation:  0.031375885009765625
local_in_edges_tensor generation:  0.025441408157348633
mini_batch_src_global generation:  0.050276756286621094
r_  generation:  0.39899373054504395
local_output_nid generation:  0.027512788772583008
local_in_edges_tensor generation:  0.027966022491455078
mini_batch_src_global generation:  0.046259403228759766
r_  generation:  0.4030630588531494
local_output_nid generation:  0.027513742446899414
local_in_edges_tensor generation:  0.025083303451538086
mini_batch_src_global generation:  0.04919552803039551
r_  generation:  0.4039173126220703
local_output_nid generation:  0.027713298797607422
local_in_edges_tensor generation:  0.029485464096069336
mini_batch_src_global generation:  0.04590296745300293
r_  generation:  0.4090750217437744
local_output_nid generation:  0.027749061584472656
local_in_edges_tensor generation:  0.029222726821899414
mini_batch_src_global generation:  0.04768848419189453
r_  generation:  0.40184903144836426
local_output_nid generation:  0.02793431282043457
local_in_edges_tensor generation:  0.026553630828857422
mini_batch_src_global generation:  0.046211957931518555
r_  generation:  0.40521979331970215
local_output_nid generation:  0.027753353118896484
local_in_edges_tensor generation:  0.02701568603515625
mini_batch_src_global generation:  0.053173065185546875
r_  generation:  0.39995408058166504
local_output_nid generation:  0.02750682830810547
local_in_edges_tensor generation:  0.027471542358398438
mini_batch_src_global generation:  0.045563459396362305
r_  generation:  0.4008917808532715
local_output_nid generation:  0.02779841423034668
local_in_edges_tensor generation:  0.025259733200073242
mini_batch_src_global generation:  0.04763460159301758
r_  generation:  0.39772701263427734
local_output_nid generation:  0.027723073959350586
local_in_edges_tensor generation:  0.03156590461730957
mini_batch_src_global generation:  0.046178340911865234
r_  generation:  0.4096255302429199
local_output_nid generation:  0.027369022369384766
local_in_edges_tensor generation:  0.025463581085205078
mini_batch_src_global generation:  0.04723787307739258
r_  generation:  0.39980506896972656
local_output_nid generation:  0.029370784759521484
local_in_edges_tensor generation:  0.025803804397583008
mini_batch_src_global generation:  0.046736717224121094
r_  generation:  0.4125955104827881
local_output_nid generation:  0.027982234954833984
local_in_edges_tensor generation:  0.03397870063781738
mini_batch_src_global generation:  0.04886603355407715
r_  generation:  0.40549588203430176
local_output_nid generation:  0.028830528259277344
local_in_edges_tensor generation:  0.028626441955566406
mini_batch_src_global generation:  0.04886794090270996
r_  generation:  0.40841197967529297
local_output_nid generation:  0.028238296508789062
local_in_edges_tensor generation:  0.025453567504882812
mini_batch_src_global generation:  0.05016183853149414
r_  generation:  0.4035625457763672
local_output_nid generation:  0.027627944946289062
local_in_edges_tensor generation:  0.026203155517578125
mini_batch_src_global generation:  0.04863929748535156
r_  generation:  0.4059765338897705
local_output_nid generation:  0.0273745059967041
local_in_edges_tensor generation:  0.026809215545654297
mini_batch_src_global generation:  0.04793286323547363
r_  generation:  0.4118485450744629
local_output_nid generation:  0.030061721801757812
local_in_edges_tensor generation:  0.026415586471557617
mini_batch_src_global generation:  0.050843238830566406
r_  generation:  0.415313720703125
local_output_nid generation:  0.027974605560302734
local_in_edges_tensor generation:  0.028133153915405273
mini_batch_src_global generation:  0.04841041564941406
r_  generation:  0.39873528480529785
local_output_nid generation:  0.0277712345123291
local_in_edges_tensor generation:  0.026417016983032227
mini_batch_src_global generation:  0.04661989212036133
r_  generation:  0.4022400379180908
local_output_nid generation:  0.027820110321044922
local_in_edges_tensor generation:  0.025159358978271484
mini_batch_src_global generation:  0.04804873466491699
r_  generation:  0.39632391929626465
local_output_nid generation:  0.027966737747192383
local_in_edges_tensor generation:  0.025870800018310547
mini_batch_src_global generation:  0.04829525947570801
r_  generation:  0.40364527702331543
local_output_nid generation:  0.027791738510131836
local_in_edges_tensor generation:  0.025449037551879883
mini_batch_src_global generation:  0.04810976982116699
r_  generation:  0.39566826820373535
local_output_nid generation:  0.027822256088256836
local_in_edges_tensor generation:  0.025566816329956055
mini_batch_src_global generation:  0.04717135429382324
r_  generation:  0.4036266803741455
local_output_nid generation:  0.027593135833740234
local_in_edges_tensor generation:  0.02488851547241211
mini_batch_src_global generation:  0.04783177375793457
r_  generation:  0.4023005962371826
local_output_nid generation:  0.02808690071105957
local_in_edges_tensor generation:  0.026522397994995117
mini_batch_src_global generation:  0.06036853790283203
r_  generation:  0.408811092376709
local_output_nid generation:  0.027973413467407227
local_in_edges_tensor generation:  0.028657197952270508
mini_batch_src_global generation:  0.04832577705383301
r_  generation:  0.4009549617767334
local_output_nid generation:  0.02834010124206543
local_in_edges_tensor generation:  0.027022838592529297
mini_batch_src_global generation:  0.04648995399475098
r_  generation:  0.4134814739227295
local_output_nid generation:  0.0282900333404541
local_in_edges_tensor generation:  0.028219223022460938
mini_batch_src_global generation:  0.04846811294555664
r_  generation:  0.4021472930908203
----------------------check_connections_block total spend ----------------------------- 19.124821424484253
generate_one_block  0.5464844703674316
generate_one_block  0.5323500633239746
generate_one_block  0.5395352840423584
generate_one_block  0.5402383804321289
generate_one_block  0.6250102519989014
generate_one_block  0.5402867794036865
generate_one_block  0.5404319763183594
generate_one_block  0.5430550575256348
generate_one_block  0.5267734527587891
generate_one_block  0.5337092876434326
generate_one_block  0.5254397392272949
generate_one_block  0.5382320880889893
generate_one_block  0.5464487075805664
generate_one_block  0.5255074501037598
generate_one_block  0.5415041446685791
generate_one_block  0.5367574691772461
generate_one_block  0.5413820743560791
generate_one_block  0.5339436531066895
generate_one_block  0.533775806427002
generate_one_block  0.5246989727020264
generate_one_block  0.5527842044830322
generate_one_block  0.5293807983398438
generate_one_block  0.5322654247283936
generate_one_block  0.5247762203216553
generate_one_block  0.5501725673675537
generate_one_block  0.5271522998809814
generate_one_block  0.5385303497314453
generate_one_block  0.5356237888336182
generate_one_block  0.5326855182647705
generate_one_block  0.5353331565856934
generate_one_block  0.5362751483917236
generate_one_block  0.5313968658447266
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 0.12053585052490234  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

connection checking time:  25.642446994781494
block generation total time  22.943814754486084
average batch blocks generation time:  0.7169942110776901
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 0.10299348831176758  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 15.741585731506348  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 0.10292577743530273  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 15.547826290130615  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 0.10400962829589844  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 15.753971099853516  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 0.10411739349365234  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 15.881381034851074  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 0.10286617279052734  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 15.682128429412842  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 0.10442638397216797  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 15.821794509887695  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 0.10500478744506836  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 15.810198783874512  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 0.10408544540405273  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 15.896039009094238  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 0.10401344299316406  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 15.754849910736084  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 0.1040802001953125  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 15.89424753189087  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 0.1038360595703125  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 15.436950206756592  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 0.10384750366210938  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 15.83621072769165  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 0.10407495498657227  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 16.029590129852295  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 0.10262346267700195  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 15.330876350402832  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 0.10501861572265625  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 15.822664260864258  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 0.10304737091064453  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 15.738982677459717  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 0.10399818420410156  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 15.692869186401367  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 0.10267877578735352  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 15.64313268661499  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 0.1050100326538086  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 15.813783645629883  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 0.10251379013061523  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 15.380695343017578  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 0.10504770278930664  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 16.000303745269775  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 0.10320091247558594  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 15.794224262237549  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 0.10299205780029297  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 15.705307960510254  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 0.10302162170410156  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 15.564765453338623  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 0.10282516479492188  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 15.70208740234375  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 0.10294342041015625  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 15.5086350440979  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 0.10289859771728516  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 15.678141593933105  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 0.1029806137084961  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 15.638224124908447  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 0.10293006896972656  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 15.601586818695068  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 0.10314750671386719  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 15.696930885314941  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 0.10303020477294922  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 15.764910221099854  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 0.10305929183959961  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 15.554673671722412  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03227725625038147 |0.010637454688549042 |0.27074084430933 |9.439140558242798e-05 |0.4313325807452202 |0.007756233215332031 |
----------------------------------------------------------pseudo_mini_loss sum 2.684847354888916
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  8579156
Number of first layer input nodes during this epoch:  4654729
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 0.12006092071533203  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.043047428131103516
random selection method range initialization spend 0.005595207214355469
time for parepare:  0.02503204345703125
local_output_nid generation:  0.0017888545989990234
local_in_edges_tensor generation:  0.003833770751953125
mini_batch_src_global generation:  0.0019183158874511719
r_  generation:  0.009073257446289062
local_output_nid generation:  0.0017917156219482422
local_in_edges_tensor generation:  0.0010790824890136719
mini_batch_src_global generation:  0.0016753673553466797
r_  generation:  0.010085821151733398
local_output_nid generation:  0.0018267631530761719
local_in_edges_tensor generation:  0.0009737014770507812
mini_batch_src_global generation:  0.0012595653533935547
r_  generation:  0.008202314376831055
local_output_nid generation:  0.0017507076263427734
local_in_edges_tensor generation:  0.0008897781372070312
mini_batch_src_global generation:  0.0011603832244873047
r_  generation:  0.008057117462158203
local_output_nid generation:  0.0016870498657226562
local_in_edges_tensor generation:  0.0008368492126464844
mini_batch_src_global generation:  0.0010144710540771484
r_  generation:  0.008075475692749023
local_output_nid generation:  0.0016407966613769531
local_in_edges_tensor generation:  0.0008003711700439453
mini_batch_src_global generation:  0.001009225845336914
r_  generation:  0.008273601531982422
local_output_nid generation:  0.0016112327575683594
local_in_edges_tensor generation:  0.0007901191711425781
mini_batch_src_global generation:  0.0010151863098144531
r_  generation:  0.010375738143920898
local_output_nid generation:  0.0016078948974609375
local_in_edges_tensor generation:  0.0007901191711425781
mini_batch_src_global generation:  0.0009806156158447266
r_  generation:  0.008098125457763672
local_output_nid generation:  0.0015676021575927734
local_in_edges_tensor generation:  0.0007700920104980469
mini_batch_src_global generation:  0.0009326934814453125
r_  generation:  0.008386850357055664
local_output_nid generation:  0.001569986343383789
local_in_edges_tensor generation:  0.0007696151733398438
mini_batch_src_global generation:  0.0009565353393554688
r_  generation:  0.008270502090454102
local_output_nid generation:  0.0015416145324707031
local_in_edges_tensor generation:  0.0009093284606933594
mini_batch_src_global generation:  0.0009789466857910156
r_  generation:  0.009499073028564453
local_output_nid generation:  0.0015742778778076172
local_in_edges_tensor generation:  0.0008111000061035156
mini_batch_src_global generation:  0.0009558200836181641
r_  generation:  0.008289813995361328
local_output_nid generation:  0.0015423297882080078
local_in_edges_tensor generation:  0.0009100437164306641
mini_batch_src_global generation:  0.0009810924530029297
r_  generation:  0.008007049560546875
local_output_nid generation:  0.0015447139739990234
local_in_edges_tensor generation:  0.0007846355438232422
mini_batch_src_global generation:  0.0010342597961425781
r_  generation:  0.011617898941040039
local_output_nid generation:  0.0027642250061035156
local_in_edges_tensor generation:  0.0007979869842529297
mini_batch_src_global generation:  0.001031637191772461
r_  generation:  0.008347511291503906
local_output_nid generation:  0.001605987548828125
local_in_edges_tensor generation:  0.00079345703125
mini_batch_src_global generation:  0.00095367431640625
r_  generation:  0.008220195770263672
local_output_nid generation:  0.001535654067993164
local_in_edges_tensor generation:  0.00078582763671875
mini_batch_src_global generation:  0.0009434223175048828
r_  generation:  0.008317232131958008
local_output_nid generation:  0.0015294551849365234
local_in_edges_tensor generation:  0.0007851123809814453
mini_batch_src_global generation:  0.0009639263153076172
r_  generation:  0.00839853286743164
local_output_nid generation:  0.0015358924865722656
local_in_edges_tensor generation:  0.0009074211120605469
mini_batch_src_global generation:  0.000982046127319336
r_  generation:  0.00816488265991211
local_output_nid generation:  0.00151824951171875
local_in_edges_tensor generation:  0.0007660388946533203
mini_batch_src_global generation:  0.0009260177612304688
r_  generation:  0.008242607116699219
local_output_nid generation:  0.0015282630920410156
local_in_edges_tensor generation:  0.0008697509765625
mini_batch_src_global generation:  0.0009634494781494141
r_  generation:  0.008177995681762695
local_output_nid generation:  0.0015096664428710938
local_in_edges_tensor generation:  0.0007684230804443359
mini_batch_src_global generation:  0.0027348995208740234
r_  generation:  0.008267402648925781
local_output_nid generation:  0.0015149116516113281
local_in_edges_tensor generation:  0.0009434223175048828
mini_batch_src_global generation:  0.0009641647338867188
r_  generation:  0.008012056350708008
local_output_nid generation:  0.0015294551849365234
local_in_edges_tensor generation:  0.0007727146148681641
mini_batch_src_global generation:  0.0009288787841796875
r_  generation:  0.008201122283935547
local_output_nid generation:  0.0015139579772949219
local_in_edges_tensor generation:  0.0007648468017578125
mini_batch_src_global generation:  0.0009469985961914062
r_  generation:  0.008202552795410156
local_output_nid generation:  0.001504659652709961
local_in_edges_tensor generation:  0.0008318424224853516
mini_batch_src_global generation:  0.0009315013885498047
r_  generation:  0.008048057556152344
local_output_nid generation:  0.0015146732330322266
local_in_edges_tensor generation:  0.0007648468017578125
mini_batch_src_global generation:  0.0009336471557617188
r_  generation:  0.00829458236694336
local_output_nid generation:  0.0014958381652832031
local_in_edges_tensor generation:  0.0007658004760742188
mini_batch_src_global generation:  0.0009114742279052734
r_  generation:  0.00820612907409668
local_output_nid generation:  0.001489877700805664
local_in_edges_tensor generation:  0.0007495880126953125
mini_batch_src_global generation:  0.0009148120880126953
r_  generation:  0.008570194244384766
local_output_nid generation:  0.0014913082122802734
local_in_edges_tensor generation:  0.0008358955383300781
mini_batch_src_global generation:  0.0009648799896240234
r_  generation:  0.008020162582397461
local_output_nid generation:  0.0014944076538085938
local_in_edges_tensor generation:  0.0007600784301757812
mini_batch_src_global generation:  0.0009522438049316406
r_  generation:  0.008649349212646484
local_output_nid generation:  0.0014808177947998047
local_in_edges_tensor generation:  0.0007483959197998047
mini_batch_src_global generation:  0.0010275840759277344
r_  generation:  0.008002758026123047
----------------------check_connections_block total spend ----------------------------- 0.503481388092041
generate_one_block  0.017228364944458008
generate_one_block  0.018794536590576172
generate_one_block  0.015248775482177734
generate_one_block  0.014950037002563477
generate_one_block  0.014636754989624023
generate_one_block  0.01470327377319336
generate_one_block  0.014764785766601562
generate_one_block  0.014491081237792969
generate_one_block  0.014847278594970703
generate_one_block  0.01773858070373535
generate_one_block  0.01877307891845703
generate_one_block  0.014786720275878906
generate_one_block  0.014223575592041016
generate_one_block  0.014585733413696289
generate_one_block  0.014794349670410156
generate_one_block  0.014433622360229492
generate_one_block  0.014544010162353516
generate_one_block  0.014720916748046875
generate_one_block  0.014331579208374023
generate_one_block  0.014572858810424805
generate_one_block  0.01425790786743164
generate_one_block  0.014480113983154297
generate_one_block  0.014022588729858398
generate_one_block  0.014246702194213867
generate_one_block  0.014719486236572266
generate_one_block  0.014160871505737305
generate_one_block  0.01457834243774414
generate_one_block  0.014271259307861328
generate_one_block  0.014314889907836914
generate_one_block  0.013956785202026367
generate_one_block  0.014846086502075195
generate_one_block  0.014139413833618164
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03554940223693848
gen group dst list time:  0.021093368530273438
time for parepare:  0.02196812629699707
local_output_nid generation:  0.005676746368408203
local_in_edges_tensor generation:  0.017578601837158203
mini_batch_src_global generation:  0.0125732421875
r_  generation:  0.12008881568908691
local_output_nid generation:  0.008270740509033203
local_in_edges_tensor generation:  0.010669469833374023
mini_batch_src_global generation:  0.01637125015258789
r_  generation:  0.15935158729553223
local_output_nid generation:  0.012923955917358398
local_in_edges_tensor generation:  0.043216705322265625
mini_batch_src_global generation:  0.015681028366088867
r_  generation:  0.14393973350524902
local_output_nid generation:  0.013343572616577148
local_in_edges_tensor generation:  0.013106107711791992
mini_batch_src_global generation:  0.016224145889282227
r_  generation:  0.1459367275238037
local_output_nid generation:  0.013386249542236328
local_in_edges_tensor generation:  0.015896320343017578
mini_batch_src_global generation:  0.020125865936279297
r_  generation:  0.1504826545715332
local_output_nid generation:  0.014082670211791992
local_in_edges_tensor generation:  0.010439872741699219
mini_batch_src_global generation:  0.01858353614807129
r_  generation:  0.15287232398986816
local_output_nid generation:  0.013567686080932617
local_in_edges_tensor generation:  0.009766578674316406
mini_batch_src_global generation:  0.019645214080810547
r_  generation:  0.14005064964294434
local_output_nid generation:  0.010608911514282227
local_in_edges_tensor generation:  0.008519172668457031
mini_batch_src_global generation:  0.01880812644958496
r_  generation:  0.1634807586669922
local_output_nid generation:  0.01354837417602539
local_in_edges_tensor generation:  0.010545969009399414
mini_batch_src_global generation:  0.03035116195678711
r_  generation:  0.14003300666809082
local_output_nid generation:  0.010887861251831055
local_in_edges_tensor generation:  0.008504390716552734
mini_batch_src_global generation:  0.018768787384033203
r_  generation:  0.1409752368927002
local_output_nid generation:  0.010061264038085938
local_in_edges_tensor generation:  0.008870601654052734
mini_batch_src_global generation:  0.01950979232788086
r_  generation:  0.14600467681884766
local_output_nid generation:  0.009363889694213867
local_in_edges_tensor generation:  0.007719278335571289
mini_batch_src_global generation:  0.016774892807006836
r_  generation:  0.13973689079284668
local_output_nid generation:  0.008893728256225586
local_in_edges_tensor generation:  0.010387659072875977
mini_batch_src_global generation:  0.01653146743774414
r_  generation:  0.13634347915649414
local_output_nid generation:  0.009079694747924805
local_in_edges_tensor generation:  0.007764577865600586
mini_batch_src_global generation:  0.027768373489379883
r_  generation:  0.17312121391296387
local_output_nid generation:  0.010162591934204102
local_in_edges_tensor generation:  0.008608818054199219
mini_batch_src_global generation:  0.03496098518371582
r_  generation:  0.14462590217590332
local_output_nid generation:  0.008929014205932617
local_in_edges_tensor generation:  0.008838891983032227
mini_batch_src_global generation:  0.02146005630493164
r_  generation:  0.14087796211242676
local_output_nid generation:  0.008819341659545898
local_in_edges_tensor generation:  0.012799739837646484
mini_batch_src_global generation:  0.01840662956237793
r_  generation:  0.13902854919433594
local_output_nid generation:  0.008913278579711914
local_in_edges_tensor generation:  0.007929563522338867
mini_batch_src_global generation:  0.016861677169799805
r_  generation:  0.14218735694885254
local_output_nid generation:  0.008433341979980469
local_in_edges_tensor generation:  0.0075571537017822266
mini_batch_src_global generation:  0.016732215881347656
r_  generation:  0.1361856460571289
local_output_nid generation:  0.00880575180053711
local_in_edges_tensor generation:  0.008108854293823242
mini_batch_src_global generation:  0.01635885238647461
r_  generation:  0.13766169548034668
local_output_nid generation:  0.008642435073852539
local_in_edges_tensor generation:  0.0075037479400634766
mini_batch_src_global generation:  0.016310930252075195
r_  generation:  0.13782310485839844
local_output_nid generation:  0.008731603622436523
local_in_edges_tensor generation:  0.008653402328491211
mini_batch_src_global generation:  0.016722679138183594
r_  generation:  0.1398308277130127
local_output_nid generation:  0.008461713790893555
local_in_edges_tensor generation:  0.013766765594482422
mini_batch_src_global generation:  0.017455101013183594
r_  generation:  0.13719606399536133
local_output_nid generation:  0.00863194465637207
local_in_edges_tensor generation:  0.008149862289428711
mini_batch_src_global generation:  0.019556760787963867
r_  generation:  0.13582253456115723
local_output_nid generation:  0.009717941284179688
local_in_edges_tensor generation:  0.008144855499267578
mini_batch_src_global generation:  0.016752004623413086
r_  generation:  0.13855934143066406
local_output_nid generation:  0.00872659683227539
local_in_edges_tensor generation:  0.008001327514648438
mini_batch_src_global generation:  0.016276121139526367
r_  generation:  0.1365528106689453
local_output_nid generation:  0.008879899978637695
local_in_edges_tensor generation:  0.007637500762939453
mini_batch_src_global generation:  0.016153812408447266
r_  generation:  0.14005470275878906
local_output_nid generation:  0.00878596305847168
local_in_edges_tensor generation:  0.0076830387115478516
mini_batch_src_global generation:  0.01685619354248047
r_  generation:  0.13856816291809082
local_output_nid generation:  0.00874018669128418
local_in_edges_tensor generation:  0.007610797882080078
mini_batch_src_global generation:  0.016852378845214844
r_  generation:  0.18230772018432617
local_output_nid generation:  0.008609533309936523
local_in_edges_tensor generation:  0.008063793182373047
mini_batch_src_global generation:  0.016476154327392578
r_  generation:  0.1359996795654297
local_output_nid generation:  0.008826732635498047
local_in_edges_tensor generation:  0.007902860641479492
mini_batch_src_global generation:  0.016674280166625977
r_  generation:  0.14365267753601074
local_output_nid generation:  0.00846552848815918
local_in_edges_tensor generation:  0.007384061813354492
mini_batch_src_global generation:  0.016060829162597656
r_  generation:  0.136763334274292
----------------------check_connections_block total spend ----------------------------- 6.932027816772461
generate_one_block  0.18599891662597656
generate_one_block  0.18881940841674805
generate_one_block  0.18442964553833008
generate_one_block  0.17990446090698242
generate_one_block  0.19053006172180176
generate_one_block  0.17742228507995605
generate_one_block  0.18064641952514648
generate_one_block  0.17751026153564453
generate_one_block  0.17622876167297363
generate_one_block  0.17517375946044922
generate_one_block  0.18069672584533691
generate_one_block  0.17692160606384277
generate_one_block  0.17101669311523438
generate_one_block  0.17766475677490234
generate_one_block  0.1797161102294922
generate_one_block  0.17744851112365723
generate_one_block  0.17999958992004395
generate_one_block  0.1974334716796875
generate_one_block  0.1780717372894287
generate_one_block  0.20861482620239258
generate_one_block  0.1773548126220703
generate_one_block  0.17837214469909668
generate_one_block  0.17238426208496094
generate_one_block  0.1730210781097412
generate_one_block  0.17784595489501953
generate_one_block  0.1745738983154297
generate_one_block  0.17619657516479492
generate_one_block  0.17765092849731445
generate_one_block  0.18367218971252441
generate_one_block  0.17281055450439453
generate_one_block  0.18196773529052734
generate_one_block  0.1726393699645996
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.039014339447021484
gen group dst list time:  0.10173416137695312
time for parepare:  0.020661354064941406
local_output_nid generation:  0.02426886558532715
local_in_edges_tensor generation:  0.04347705841064453
mini_batch_src_global generation:  0.03680562973022461
r_  generation:  0.3982698917388916
local_output_nid generation:  0.029471158981323242
local_in_edges_tensor generation:  0.03277993202209473
mini_batch_src_global generation:  0.05210614204406738
r_  generation:  0.4194483757019043
local_output_nid generation:  0.03164172172546387
local_in_edges_tensor generation:  0.024657726287841797
mini_batch_src_global generation:  0.04750561714172363
r_  generation:  0.4055500030517578
local_output_nid generation:  0.029609203338623047
local_in_edges_tensor generation:  0.0254514217376709
mini_batch_src_global generation:  0.0476992130279541
r_  generation:  0.400470495223999
local_output_nid generation:  0.02864527702331543
local_in_edges_tensor generation:  0.027078866958618164
mini_batch_src_global generation:  0.04669785499572754
r_  generation:  0.40770888328552246
local_output_nid generation:  0.027565479278564453
local_in_edges_tensor generation:  0.028591156005859375
mini_batch_src_global generation:  0.04776263236999512
r_  generation:  0.4029703140258789
local_output_nid generation:  0.027533292770385742
local_in_edges_tensor generation:  0.024955272674560547
mini_batch_src_global generation:  0.048673152923583984
r_  generation:  0.41061902046203613
local_output_nid generation:  0.027280092239379883
local_in_edges_tensor generation:  0.028136253356933594
mini_batch_src_global generation:  0.04836082458496094
r_  generation:  0.4061305522918701
local_output_nid generation:  0.02714705467224121
local_in_edges_tensor generation:  0.030074357986450195
mini_batch_src_global generation:  0.04674792289733887
r_  generation:  0.4066274166107178
local_output_nid generation:  0.027237653732299805
local_in_edges_tensor generation:  0.02805304527282715
mini_batch_src_global generation:  0.04832649230957031
r_  generation:  0.4014298915863037
local_output_nid generation:  0.028015851974487305
local_in_edges_tensor generation:  0.029178142547607422
mini_batch_src_global generation:  0.050140380859375
r_  generation:  0.40741515159606934
local_output_nid generation:  0.02752518653869629
local_in_edges_tensor generation:  0.02675175666809082
mini_batch_src_global generation:  0.04953408241271973
r_  generation:  0.40353870391845703
local_output_nid generation:  0.027309179306030273
local_in_edges_tensor generation:  0.029964208602905273
mini_batch_src_global generation:  0.04644918441772461
r_  generation:  0.404630184173584
local_output_nid generation:  0.027571916580200195
local_in_edges_tensor generation:  0.027822017669677734
mini_batch_src_global generation:  0.04977607727050781
r_  generation:  0.4057769775390625
local_output_nid generation:  0.029443979263305664
local_in_edges_tensor generation:  0.024895668029785156
mini_batch_src_global generation:  0.04648995399475098
r_  generation:  0.41251230239868164
local_output_nid generation:  0.027812719345092773
local_in_edges_tensor generation:  0.027276039123535156
mini_batch_src_global generation:  0.048433780670166016
r_  generation:  0.4031987190246582
local_output_nid generation:  0.027684926986694336
local_in_edges_tensor generation:  0.02843022346496582
mini_batch_src_global generation:  0.04685521125793457
r_  generation:  0.40618419647216797
local_output_nid generation:  0.028464555740356445
local_in_edges_tensor generation:  0.02686023712158203
mini_batch_src_global generation:  0.049988746643066406
r_  generation:  0.4046037197113037
local_output_nid generation:  0.027529239654541016
local_in_edges_tensor generation:  0.025200605392456055
mini_batch_src_global generation:  0.048499345779418945
r_  generation:  0.4229118824005127
local_output_nid generation:  0.029723644256591797
local_in_edges_tensor generation:  0.0285642147064209
mini_batch_src_global generation:  0.04857468605041504
r_  generation:  0.4035944938659668
local_output_nid generation:  0.02770686149597168
local_in_edges_tensor generation:  0.02570652961730957
mini_batch_src_global generation:  0.046502113342285156
r_  generation:  0.4072396755218506
local_output_nid generation:  0.0277252197265625
local_in_edges_tensor generation:  0.02692270278930664
mini_batch_src_global generation:  0.04786944389343262
r_  generation:  0.40152978897094727
local_output_nid generation:  0.02736949920654297
local_in_edges_tensor generation:  0.025838375091552734
mini_batch_src_global generation:  0.04606962203979492
r_  generation:  0.40107226371765137
local_output_nid generation:  0.027401447296142578
local_in_edges_tensor generation:  0.024670124053955078
mini_batch_src_global generation:  0.04699540138244629
r_  generation:  0.39903855323791504
local_output_nid generation:  0.027795791625976562
local_in_edges_tensor generation:  0.027849197387695312
mini_batch_src_global generation:  0.05058622360229492
r_  generation:  0.4077613353729248
local_output_nid generation:  0.027515649795532227
local_in_edges_tensor generation:  0.025344133377075195
mini_batch_src_global generation:  0.04776191711425781
r_  generation:  0.39876818656921387
local_output_nid generation:  0.02767181396484375
local_in_edges_tensor generation:  0.024182558059692383
mini_batch_src_global generation:  0.04622387886047363
r_  generation:  0.40580320358276367
local_output_nid generation:  0.027526378631591797
local_in_edges_tensor generation:  0.02820587158203125
mini_batch_src_global generation:  0.047894954681396484
r_  generation:  0.40265631675720215
local_output_nid generation:  0.02770829200744629
local_in_edges_tensor generation:  0.026540040969848633
mini_batch_src_global generation:  0.048677921295166016
r_  generation:  0.4115464687347412
local_output_nid generation:  0.027559757232666016
local_in_edges_tensor generation:  0.02457284927368164
mini_batch_src_global generation:  0.047679901123046875
r_  generation:  0.3969686031341553
local_output_nid generation:  0.027799367904663086
local_in_edges_tensor generation:  0.02464127540588379
mini_batch_src_global generation:  0.04706072807312012
r_  generation:  0.41387510299682617
local_output_nid generation:  0.027491092681884766
local_in_edges_tensor generation:  0.026926517486572266
mini_batch_src_global generation:  0.04796743392944336
r_  generation:  0.39964866638183594
----------------------check_connections_block total spend ----------------------------- 19.15368151664734
generate_one_block  0.5418477058410645
generate_one_block  0.5398862361907959
generate_one_block  0.5347857475280762
generate_one_block  0.5350730419158936
generate_one_block  0.6223859786987305
generate_one_block  0.5340445041656494
generate_one_block  0.5402340888977051
generate_one_block  0.5409693717956543
generate_one_block  0.5410468578338623
generate_one_block  0.5332362651824951
generate_one_block  0.5395636558532715
generate_one_block  0.5378372669219971
generate_one_block  0.531963586807251
generate_one_block  0.5363473892211914
generate_one_block  0.539292573928833
generate_one_block  0.5372517108917236
generate_one_block  0.5330431461334229
generate_one_block  0.5456802845001221
generate_one_block  0.5336897373199463
generate_one_block  0.5304038524627686
generate_one_block  0.538015604019165
generate_one_block  0.531435489654541
generate_one_block  0.5235846042633057
generate_one_block  0.5287473201751709
generate_one_block  0.5685694217681885
generate_one_block  0.5326104164123535
generate_one_block  0.532372236251831
generate_one_block  0.5343143939971924
generate_one_block  0.5422642230987549
generate_one_block  0.5270512104034424
generate_one_block  0.544447660446167
generate_one_block  0.5332365036010742
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 0.12006092071533203  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

connection checking time:  26.0857093334198
block generation total time  23.02796959877014
average batch blocks generation time:  0.7196240499615669
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 0.10402441024780273  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 15.857306003570557  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 0.1043100357055664  GigaBytes
Max Memory Allocated: 16.132555961608887  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7596435546875 GB
    Memory Allocated: 16.221023082733154  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1463623046875 GB
    Memory Allocated: 0.1039128303527832  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1463623046875 GB
    Memory Allocated: 15.922558307647705  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1463623046875 GB
    Memory Allocated: 0.10415077209472656  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1463623046875 GB
    Memory Allocated: 15.939136981964111  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1463623046875 GB
    Memory Allocated: 0.10401344299316406  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1463623046875 GB
    Memory Allocated: 15.744199275970459  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1463623046875 GB
    Memory Allocated: 0.10309648513793945  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1463623046875 GB
    Memory Allocated: 15.76893663406372  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1463623046875 GB
    Memory Allocated: 0.10403585433959961  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1463623046875 GB
    Memory Allocated: 15.952451229095459  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1463623046875 GB
    Memory Allocated: 0.1040492057800293  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1463623046875 GB
    Memory Allocated: 15.874521732330322  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1463623046875 GB
    Memory Allocated: 0.10396003723144531  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1463623046875 GB
    Memory Allocated: 15.637197494506836  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1463623046875 GB
    Memory Allocated: 0.10298776626586914  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1463623046875 GB
    Memory Allocated: 15.732615947723389  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1463623046875 GB
    Memory Allocated: 0.10404586791992188  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1463623046875 GB
    Memory Allocated: 15.985595703125  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1463623046875 GB
    Memory Allocated: 0.10413980484008789  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1463623046875 GB
    Memory Allocated: 15.791125774383545  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1463623046875 GB
    Memory Allocated: 0.10386276245117188  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1463623046875 GB
    Memory Allocated: 15.533635139465332  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1463623046875 GB
    Memory Allocated: 0.10408592224121094  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1463623046875 GB
    Memory Allocated: 15.863588809967041  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1463623046875 GB
    Memory Allocated: 0.10501480102539062  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1463623046875 GB
    Memory Allocated: 15.801462650299072  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1463623046875 GB
    Memory Allocated: 0.10323333740234375  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1463623046875 GB
    Memory Allocated: 15.77393627166748  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1463623046875 GB
    Memory Allocated: 0.10393714904785156  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1463623046875 GB
    Memory Allocated: 15.601856231689453  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1463623046875 GB
    Memory Allocated: 0.10414361953735352  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1463623046875 GB
    Memory Allocated: 16.002451419830322  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1463623046875 GB
    Memory Allocated: 0.10394001007080078  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1463623046875 GB
    Memory Allocated: 15.622913837432861  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1463623046875 GB
    Memory Allocated: 0.1031179428100586  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1463623046875 GB
    Memory Allocated: 15.68554973602295  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1463623046875 GB
    Memory Allocated: 0.1039419174194336  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1463623046875 GB
    Memory Allocated: 15.628927230834961  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1463623046875 GB
    Memory Allocated: 0.10309553146362305  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1463623046875 GB
    Memory Allocated: 15.610238075256348  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1463623046875 GB
    Memory Allocated: 0.10254526138305664  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1463623046875 GB
    Memory Allocated: 15.280782699584961  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1463623046875 GB
    Memory Allocated: 0.1028132438659668  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1658935546875 GB
    Memory Allocated: 15.425957202911377  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.10397052764892578  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.695148944854736  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.10296440124511719  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.4905424118042  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.10389328002929688  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.577126026153564  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.10310220718383789  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.586738586425781  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.10401248931884766  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.775233268737793  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.10276126861572266  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.397332191467285  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.10503482818603516  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.880778789520264  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.10260295867919922  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.360160827636719  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03349100798368454 |0.010886356234550476 |0.2643117234110832 |8.969008922576904e-05 |0.42985859513282776 |0.0035736560821533203 |
----------------------------------------------------------pseudo_mini_loss sum 2.3203413486480713
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  8581482
Number of first layer input nodes during this epoch:  4656402
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.1201319694519043  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022139549255371094
random selection method range initialization spend 0.006588459014892578
time for parepare:  0.02249741554260254
local_output_nid generation:  0.0013077259063720703
local_in_edges_tensor generation:  0.003668546676635742
mini_batch_src_global generation:  0.0030372142791748047
r_  generation:  0.013337850570678711
local_output_nid generation:  0.0024406909942626953
local_in_edges_tensor generation:  0.0012814998626708984
mini_batch_src_global generation:  0.0018579959869384766
r_  generation:  0.00890207290649414
local_output_nid generation:  0.0022652149200439453
local_in_edges_tensor generation:  0.0011081695556640625
mini_batch_src_global generation:  0.0013153553009033203
r_  generation:  0.008272886276245117
local_output_nid generation:  0.002230405807495117
local_in_edges_tensor generation:  0.0010738372802734375
mini_batch_src_global generation:  0.0011920928955078125
r_  generation:  0.008445978164672852
local_output_nid generation:  0.002135038375854492
local_in_edges_tensor generation:  0.001066446304321289
mini_batch_src_global generation:  0.0012645721435546875
r_  generation:  0.008117198944091797
local_output_nid generation:  0.0021736621856689453
local_in_edges_tensor generation:  0.0010559558868408203
mini_batch_src_global generation:  0.0012209415435791016
r_  generation:  0.010004043579101562
local_output_nid generation:  0.0022249221801757812
local_in_edges_tensor generation:  0.0010960102081298828
mini_batch_src_global generation:  0.0013151168823242188
r_  generation:  0.008387088775634766
local_output_nid generation:  0.0021789073944091797
local_in_edges_tensor generation:  0.0011105537414550781
mini_batch_src_global generation:  0.0011868476867675781
r_  generation:  0.008494138717651367
local_output_nid generation:  0.002208709716796875
local_in_edges_tensor generation:  0.0010616779327392578
mini_batch_src_global generation:  0.0011889934539794922
r_  generation:  0.008281946182250977
local_output_nid generation:  0.0021512508392333984
local_in_edges_tensor generation:  0.0010654926300048828
mini_batch_src_global generation:  0.0012657642364501953
r_  generation:  0.008268117904663086
local_output_nid generation:  0.002230405807495117
local_in_edges_tensor generation:  0.0010709762573242188
mini_batch_src_global generation:  0.0012247562408447266
r_  generation:  0.008626937866210938
local_output_nid generation:  0.0021774768829345703
local_in_edges_tensor generation:  0.0010323524475097656
mini_batch_src_global generation:  0.0011529922485351562
r_  generation:  0.008513450622558594
local_output_nid generation:  0.0021860599517822266
local_in_edges_tensor generation:  0.0010437965393066406
mini_batch_src_global generation:  0.0011353492736816406
r_  generation:  0.008330583572387695
local_output_nid generation:  0.0021491050720214844
local_in_edges_tensor generation:  0.0010561943054199219
mini_batch_src_global generation:  0.0011477470397949219
r_  generation:  0.00845646858215332
local_output_nid generation:  0.002162933349609375
local_in_edges_tensor generation:  0.0010640621185302734
mini_batch_src_global generation:  0.001216888427734375
r_  generation:  0.020349740982055664
local_output_nid generation:  0.0028951168060302734
local_in_edges_tensor generation:  0.0012786388397216797
mini_batch_src_global generation:  0.0018856525421142578
r_  generation:  0.008669137954711914
local_output_nid generation:  0.0022885799407958984
local_in_edges_tensor generation:  0.0010178089141845703
mini_batch_src_global generation:  0.0012781620025634766
r_  generation:  0.008465766906738281
local_output_nid generation:  0.0021486282348632812
local_in_edges_tensor generation:  0.0009815692901611328
mini_batch_src_global generation:  0.0011348724365234375
r_  generation:  0.008671283721923828
local_output_nid generation:  0.0020656585693359375
local_in_edges_tensor generation:  0.0009799003601074219
mini_batch_src_global generation:  0.001043558120727539
r_  generation:  0.008330106735229492
local_output_nid generation:  0.0049936771392822266
local_in_edges_tensor generation:  0.0010862350463867188
mini_batch_src_global generation:  0.001003265380859375
r_  generation:  0.00848531723022461
local_output_nid generation:  0.001950979232788086
local_in_edges_tensor generation:  0.0008933544158935547
mini_batch_src_global generation:  0.0009963512420654297
r_  generation:  0.00832986831665039
local_output_nid generation:  0.0019042491912841797
local_in_edges_tensor generation:  0.0008661746978759766
mini_batch_src_global generation:  0.0009660720825195312
r_  generation:  0.008239507675170898
local_output_nid generation:  0.001850128173828125
local_in_edges_tensor generation:  0.0008966922760009766
mini_batch_src_global generation:  0.0009908676147460938
r_  generation:  0.008208036422729492
local_output_nid generation:  0.00180816650390625
local_in_edges_tensor generation:  0.0008373260498046875
mini_batch_src_global generation:  0.001027822494506836
r_  generation:  0.00834512710571289
local_output_nid generation:  0.0018200874328613281
local_in_edges_tensor generation:  0.0008616447448730469
mini_batch_src_global generation:  0.0009534358978271484
r_  generation:  0.008341550827026367
local_output_nid generation:  0.0017592906951904297
local_in_edges_tensor generation:  0.0008716583251953125
mini_batch_src_global generation:  0.0009951591491699219
r_  generation:  0.009737491607666016
local_output_nid generation:  0.0017459392547607422
local_in_edges_tensor generation:  0.002575397491455078
mini_batch_src_global generation:  0.0009577274322509766
r_  generation:  0.008267879486083984
local_output_nid generation:  0.0017085075378417969
local_in_edges_tensor generation:  0.0008368492126464844
mini_batch_src_global generation:  0.0009660720825195312
r_  generation:  0.008183002471923828
local_output_nid generation:  0.0016922950744628906
local_in_edges_tensor generation:  0.0008130073547363281
mini_batch_src_global generation:  0.0010175704956054688
r_  generation:  0.008403539657592773
local_output_nid generation:  0.0016438961029052734
local_in_edges_tensor generation:  0.0008025169372558594
mini_batch_src_global generation:  0.0009541511535644531
r_  generation:  0.008119344711303711
local_output_nid generation:  0.001622915267944336
local_in_edges_tensor generation:  0.0008590221405029297
mini_batch_src_global generation:  0.0009136199951171875
r_  generation:  0.008008718490600586
local_output_nid generation:  0.0016164779663085938
local_in_edges_tensor generation:  0.0008022785186767578
mini_batch_src_global generation:  0.0009310245513916016
r_  generation:  0.008287906646728516
----------------------check_connections_block total spend ----------------------------- 0.5473024845123291
generate_one_block  0.025538921356201172
generate_one_block  0.017541170120239258
generate_one_block  0.015428781509399414
generate_one_block  0.015199899673461914
generate_one_block  0.014583349227905273
generate_one_block  0.01554107666015625
generate_one_block  0.014631509780883789
generate_one_block  0.016338348388671875
generate_one_block  0.014641046524047852
generate_one_block  0.01433706283569336
generate_one_block  0.014984130859375
generate_one_block  0.01503443717956543
generate_one_block  0.014450550079345703
generate_one_block  0.014458417892456055
generate_one_block  0.01612687110900879
generate_one_block  0.01469111442565918
generate_one_block  0.01465296745300293
generate_one_block  0.015026092529296875
generate_one_block  0.0144500732421875
generate_one_block  0.014623641967773438
generate_one_block  0.014747858047485352
generate_one_block  0.0162813663482666
generate_one_block  0.014354944229125977
generate_one_block  0.014562845230102539
generate_one_block  0.014630794525146484
generate_one_block  0.01510763168334961
generate_one_block  0.014351606369018555
generate_one_block  0.01429891586303711
generate_one_block  0.01613330841064453
generate_one_block  0.014201641082763672
generate_one_block  0.013941049575805664
generate_one_block  0.014549970626831055
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.07102489471435547
gen group dst list time:  0.022746801376342773
time for parepare:  0.022408008575439453
local_output_nid generation:  0.005358219146728516
local_in_edges_tensor generation:  0.01607966423034668
mini_batch_src_global generation:  0.013765811920166016
r_  generation:  0.11785292625427246
local_output_nid generation:  0.007821798324584961
local_in_edges_tensor generation:  0.00957489013671875
mini_batch_src_global generation:  0.01731133460998535
r_  generation:  0.12726569175720215
local_output_nid generation:  0.007777690887451172
local_in_edges_tensor generation:  0.02965998649597168
mini_batch_src_global generation:  0.01582050323486328
r_  generation:  0.13288164138793945
local_output_nid generation:  0.008503913879394531
local_in_edges_tensor generation:  0.008002996444702148
mini_batch_src_global generation:  0.01706695556640625
r_  generation:  0.1718769073486328
local_output_nid generation:  0.008279800415039062
local_in_edges_tensor generation:  0.007898330688476562
mini_batch_src_global generation:  0.017162084579467773
r_  generation:  0.18683934211730957
local_output_nid generation:  0.00871896743774414
local_in_edges_tensor generation:  0.008838176727294922
mini_batch_src_global generation:  0.021811485290527344
r_  generation:  0.14485859870910645
local_output_nid generation:  0.008238792419433594
local_in_edges_tensor generation:  0.011024713516235352
mini_batch_src_global generation:  0.020003318786621094
r_  generation:  0.13809537887573242
local_output_nid generation:  0.007809638977050781
local_in_edges_tensor generation:  0.008062601089477539
mini_batch_src_global generation:  0.020783424377441406
r_  generation:  0.14055132865905762
local_output_nid generation:  0.00800013542175293
local_in_edges_tensor generation:  0.007962226867675781
mini_batch_src_global generation:  0.028911352157592773
r_  generation:  0.15918374061584473
local_output_nid generation:  0.012063264846801758
local_in_edges_tensor generation:  0.018055200576782227
mini_batch_src_global generation:  0.01934504508972168
r_  generation:  0.164351224899292
local_output_nid generation:  0.01490473747253418
local_in_edges_tensor generation:  0.012035369873046875
mini_batch_src_global generation:  0.0205228328704834
r_  generation:  0.1577012538909912
local_output_nid generation:  0.013839960098266602
local_in_edges_tensor generation:  0.012401819229125977
mini_batch_src_global generation:  0.019617319107055664
r_  generation:  0.1753706932067871
local_output_nid generation:  0.011567115783691406
local_in_edges_tensor generation:  0.008777379989624023
mini_batch_src_global generation:  0.045738935470581055
r_  generation:  0.1706223487854004
local_output_nid generation:  0.009895563125610352
local_in_edges_tensor generation:  0.008087873458862305
mini_batch_src_global generation:  0.02096700668334961
r_  generation:  0.1373462677001953
local_output_nid generation:  0.014167547225952148
local_in_edges_tensor generation:  0.008174657821655273
mini_batch_src_global generation:  0.04590606689453125
r_  generation:  0.16622400283813477
local_output_nid generation:  0.010589599609375
local_in_edges_tensor generation:  0.008666515350341797
mini_batch_src_global generation:  0.019025087356567383
r_  generation:  0.14882445335388184
local_output_nid generation:  0.009276866912841797
local_in_edges_tensor generation:  0.00831460952758789
mini_batch_src_global generation:  0.01893472671508789
r_  generation:  0.1507720947265625
local_output_nid generation:  0.009033441543579102
local_in_edges_tensor generation:  0.007780551910400391
mini_batch_src_global generation:  0.019481420516967773
r_  generation:  0.14850115776062012
local_output_nid generation:  0.008608341217041016
local_in_edges_tensor generation:  0.007518768310546875
mini_batch_src_global generation:  0.018486976623535156
r_  generation:  0.14470982551574707
local_output_nid generation:  0.008673429489135742
local_in_edges_tensor generation:  0.007607460021972656
mini_batch_src_global generation:  0.027342796325683594
r_  generation:  0.14934062957763672
local_output_nid generation:  0.008641719818115234
local_in_edges_tensor generation:  0.007844209671020508
mini_batch_src_global generation:  0.034594058990478516
r_  generation:  0.15239572525024414
local_output_nid generation:  0.008120536804199219
local_in_edges_tensor generation:  0.007333517074584961
mini_batch_src_global generation:  0.03394055366516113
r_  generation:  0.14737558364868164
local_output_nid generation:  0.008304357528686523
local_in_edges_tensor generation:  0.007280826568603516
mini_batch_src_global generation:  0.03478431701660156
r_  generation:  0.1449894905090332
local_output_nid generation:  0.008506059646606445
local_in_edges_tensor generation:  0.0074427127838134766
mini_batch_src_global generation:  0.021060466766357422
r_  generation:  0.17633676528930664
local_output_nid generation:  0.008383035659790039
local_in_edges_tensor generation:  0.0075397491455078125
mini_batch_src_global generation:  0.018439769744873047
r_  generation:  0.14895868301391602
local_output_nid generation:  0.008735418319702148
local_in_edges_tensor generation:  0.008572101593017578
mini_batch_src_global generation:  0.01939082145690918
r_  generation:  0.1647031307220459
local_output_nid generation:  0.008286476135253906
local_in_edges_tensor generation:  0.007349967956542969
mini_batch_src_global generation:  0.018381118774414062
r_  generation:  0.1473827362060547
local_output_nid generation:  0.008445501327514648
local_in_edges_tensor generation:  0.008104085922241211
mini_batch_src_global generation:  0.017943143844604492
r_  generation:  0.14845061302185059
local_output_nid generation:  0.008559226989746094
local_in_edges_tensor generation:  0.00836944580078125
mini_batch_src_global generation:  0.018707275390625
r_  generation:  0.1480579376220703
local_output_nid generation:  0.008301496505737305
local_in_edges_tensor generation:  0.010557413101196289
mini_batch_src_global generation:  0.018255233764648438
r_  generation:  0.14376449584960938
local_output_nid generation:  0.00815272331237793
local_in_edges_tensor generation:  0.007411956787109375
mini_batch_src_global generation:  0.01804804801940918
r_  generation:  0.14196419715881348
local_output_nid generation:  0.008353710174560547
local_in_edges_tensor generation:  0.007358551025390625
mini_batch_src_global generation:  0.01827859878540039
r_  generation:  0.18381500244140625
----------------------check_connections_block total spend ----------------------------- 7.362346410751343
generate_one_block  0.1821272373199463
generate_one_block  0.17350506782531738
generate_one_block  0.18239521980285645
generate_one_block  0.18521809577941895
generate_one_block  0.19046640396118164
generate_one_block  0.18828940391540527
generate_one_block  0.17936015129089355
generate_one_block  0.17824840545654297
generate_one_block  0.17655634880065918
generate_one_block  0.16764163970947266
generate_one_block  0.17919301986694336
generate_one_block  0.17816591262817383
generate_one_block  0.17304444313049316
generate_one_block  0.1711254119873047
generate_one_block  0.1708967685699463
generate_one_block  0.17799139022827148
generate_one_block  0.18099355697631836
generate_one_block  0.18145489692687988
generate_one_block  0.17249107360839844
generate_one_block  0.2096390724182129
generate_one_block  0.18325042724609375
generate_one_block  0.1878824234008789
generate_one_block  0.1725597381591797
generate_one_block  0.17740345001220703
generate_one_block  0.1774883270263672
generate_one_block  0.18616247177124023
generate_one_block  0.17203307151794434
generate_one_block  0.17245769500732422
generate_one_block  0.17850112915039062
generate_one_block  0.17033982276916504
generate_one_block  0.1678774356842041
generate_one_block  0.17660975456237793
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0353395938873291
gen group dst list time:  0.11876106262207031
time for parepare:  0.02098250389099121
local_output_nid generation:  0.023081302642822266
local_in_edges_tensor generation:  0.04626011848449707
mini_batch_src_global generation:  0.04976987838745117
r_  generation:  0.39614105224609375
local_output_nid generation:  0.028831958770751953
local_in_edges_tensor generation:  0.03072667121887207
mini_batch_src_global generation:  0.04754972457885742
r_  generation:  0.403165340423584
local_output_nid generation:  0.031002283096313477
local_in_edges_tensor generation:  0.02891254425048828
mini_batch_src_global generation:  0.051380157470703125
r_  generation:  0.4116532802581787
local_output_nid generation:  0.030904293060302734
local_in_edges_tensor generation:  0.0319066047668457
mini_batch_src_global generation:  0.047957658767700195
r_  generation:  0.42644453048706055
local_output_nid generation:  0.03183603286743164
local_in_edges_tensor generation:  0.03078627586364746
mini_batch_src_global generation:  0.04723215103149414
r_  generation:  0.4068610668182373
local_output_nid generation:  0.030409812927246094
local_in_edges_tensor generation:  0.025737285614013672
mini_batch_src_global generation:  0.051918983459472656
r_  generation:  0.4085559844970703
local_output_nid generation:  0.027936458587646484
local_in_edges_tensor generation:  0.027217626571655273
mini_batch_src_global generation:  0.0468897819519043
r_  generation:  0.4066610336303711
local_output_nid generation:  0.027691364288330078
local_in_edges_tensor generation:  0.026521682739257812
mini_batch_src_global generation:  0.04808378219604492
r_  generation:  0.41060519218444824
local_output_nid generation:  0.02781081199645996
local_in_edges_tensor generation:  0.024634838104248047
mini_batch_src_global generation:  0.04840254783630371
r_  generation:  0.4104914665222168
local_output_nid generation:  0.027394771575927734
local_in_edges_tensor generation:  0.02897167205810547
mini_batch_src_global generation:  0.04765439033508301
r_  generation:  0.39905738830566406
local_output_nid generation:  0.028939485549926758
local_in_edges_tensor generation:  0.0254819393157959
mini_batch_src_global generation:  0.04975724220275879
r_  generation:  0.41179418563842773
local_output_nid generation:  0.030650615692138672
local_in_edges_tensor generation:  0.029804706573486328
mini_batch_src_global generation:  0.048294782638549805
r_  generation:  0.40883636474609375
local_output_nid generation:  0.02972722053527832
local_in_edges_tensor generation:  0.029584169387817383
mini_batch_src_global generation:  0.04841732978820801
r_  generation:  0.41121339797973633
local_output_nid generation:  0.027939319610595703
local_in_edges_tensor generation:  0.03223824501037598
mini_batch_src_global generation:  0.0480809211730957
r_  generation:  0.4275822639465332
local_output_nid generation:  0.030176162719726562
local_in_edges_tensor generation:  0.026181459426879883
mini_batch_src_global generation:  0.04709172248840332
r_  generation:  0.40581369400024414
local_output_nid generation:  0.02791881561279297
local_in_edges_tensor generation:  0.03196382522583008
mini_batch_src_global generation:  0.04931235313415527
r_  generation:  0.4010436534881592
local_output_nid generation:  0.02817082405090332
local_in_edges_tensor generation:  0.02554631233215332
mini_batch_src_global generation:  0.046783447265625
r_  generation:  0.4102060794830322
local_output_nid generation:  0.02805495262145996
local_in_edges_tensor generation:  0.026173830032348633
mini_batch_src_global generation:  0.048330068588256836
r_  generation:  0.4005453586578369
local_output_nid generation:  0.027822494506835938
local_in_edges_tensor generation:  0.025066375732421875
mini_batch_src_global generation:  0.04661965370178223
r_  generation:  0.4158511161804199
local_output_nid generation:  0.028261423110961914
local_in_edges_tensor generation:  0.026790380477905273
mini_batch_src_global generation:  0.04995012283325195
r_  generation:  0.4052720069885254
local_output_nid generation:  0.028174161911010742
local_in_edges_tensor generation:  0.026674747467041016
mini_batch_src_global generation:  0.04993581771850586
r_  generation:  0.4134840965270996
local_output_nid generation:  0.02789759635925293
local_in_edges_tensor generation:  0.02808380126953125
mini_batch_src_global generation:  0.04769253730773926
r_  generation:  0.40067577362060547
local_output_nid generation:  0.02779555320739746
local_in_edges_tensor generation:  0.02680802345275879
mini_batch_src_global generation:  0.04784059524536133
r_  generation:  0.4059624671936035
local_output_nid generation:  0.028785228729248047
local_in_edges_tensor generation:  0.025243282318115234
mini_batch_src_global generation:  0.06618237495422363
r_  generation:  0.4095304012298584
local_output_nid generation:  0.029676437377929688
local_in_edges_tensor generation:  0.02977585792541504
mini_batch_src_global generation:  0.049498796463012695
r_  generation:  0.4157233238220215
local_output_nid generation:  0.028322458267211914
local_in_edges_tensor generation:  0.03436779975891113
mini_batch_src_global generation:  0.050436973571777344
r_  generation:  0.41698288917541504
local_output_nid generation:  0.028880596160888672
local_in_edges_tensor generation:  0.044554710388183594
mini_batch_src_global generation:  0.046190738677978516
r_  generation:  0.4045255184173584
local_output_nid generation:  0.027997493743896484
local_in_edges_tensor generation:  0.026627302169799805
mini_batch_src_global generation:  0.04740262031555176
r_  generation:  0.3984866142272949
local_output_nid generation:  0.02812647819519043
local_in_edges_tensor generation:  0.025058507919311523
mini_batch_src_global generation:  0.048150062561035156
r_  generation:  0.407259464263916
local_output_nid generation:  0.027836084365844727
local_in_edges_tensor generation:  0.026372909545898438
mini_batch_src_global generation:  0.04925060272216797
r_  generation:  0.39829230308532715
local_output_nid generation:  0.027718782424926758
local_in_edges_tensor generation:  0.024388790130615234
mini_batch_src_global generation:  0.045801639556884766
r_  generation:  0.4070425033569336
local_output_nid generation:  0.027887344360351562
local_in_edges_tensor generation:  0.02488994598388672
mini_batch_src_global generation:  0.05068802833557129
r_  generation:  0.406752347946167
----------------------check_connections_block total spend ----------------------------- 19.406249046325684
generate_one_block  0.5418503284454346
generate_one_block  0.5257682800292969
generate_one_block  0.5383167266845703
generate_one_block  0.540576696395874
generate_one_block  0.6289994716644287
generate_one_block  0.5573337078094482
generate_one_block  0.5424494743347168
generate_one_block  0.5503149032592773
generate_one_block  0.535714864730835
generate_one_block  0.5317959785461426
generate_one_block  0.5365839004516602
generate_one_block  0.5456030368804932
generate_one_block  0.533332109451294
generate_one_block  0.5494711399078369
generate_one_block  0.5377383232116699
generate_one_block  0.5339024066925049
generate_one_block  0.5431296825408936
generate_one_block  0.5407581329345703
generate_one_block  0.5280182361602783
generate_one_block  0.5431473255157471
generate_one_block  0.5479328632354736
generate_one_block  0.5334360599517822
generate_one_block  0.5323081016540527
generate_one_block  0.5417354106903076
generate_one_block  0.553180456161499
generate_one_block  0.5541093349456787
generate_one_block  0.5310356616973877
generate_one_block  0.527686357498169
generate_one_block  0.5391585826873779
generate_one_block  0.5273616313934326
generate_one_block  0.5261750221252441
generate_one_block  0.5434987545013428
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.1201319694519043  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

connection checking time:  26.768595457077026
block generation total time  23.06379222869873
average batch blocks generation time:  0.7207435071468353
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.1027517318725586  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.372389316558838  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.10283565521240234  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.50022554397583  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.10500812530517578  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.838225364685059  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.10411977767944336  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.995305061340332  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.10386180877685547  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.506083965301514  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.10435867309570312  GigaBytes
Max Memory Allocated: 16.253660202026367  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 16.22855806350708  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.10295581817626953  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.69568395614624  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.10307073593139648  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.72313117980957  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.1029515266418457  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.771354675292969  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.10267877578735352  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.339967727661133  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.10403203964233398  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.920971393585205  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.1042327880859375  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.916742324829102  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.10278844833374023  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.672459125518799  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.1032557487487793  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.550397872924805  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.10281181335449219  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.504162788391113  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.10300683975219727  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.759517669677734  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.1050405502319336  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.987182140350342  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.1040029525756836  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 16.013814449310303  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.10290670394897461  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.566901206970215  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.10421609878540039  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.847880840301514  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.10503435134887695  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.972994327545166  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.10286378860473633  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.60707712173462  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.10383033752441406  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.435094356536865  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.10300683975219727  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.653332710266113  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.10294342041015625  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.76786994934082  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.10423469543457031  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 16.145524978637695  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.10246896743774414  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.496817111968994  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.10312223434448242  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.570512294769287  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.10501909255981445  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.866835117340088  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.10286712646484375  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.418987274169922  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.10268974304199219  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.336528778076172  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.1028895378112793  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.725610256195068  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.036543332040309906 |0.011474967002868652 |0.2629321962594986 |8.968263864517212e-05 |0.42886773496866226 |0.0057179927825927734 |
----------------------------------------------------------pseudo_mini_loss sum 2.1409661769866943
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  8579353
Number of first layer input nodes during this epoch:  4654776
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.12000131607055664  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020949363708496094
random selection method range initialization spend 0.00541996955871582
time for parepare:  0.018784284591674805
local_output_nid generation:  0.0013580322265625
local_in_edges_tensor generation:  0.003940105438232422
mini_batch_src_global generation:  0.0024416446685791016
r_  generation:  0.018000125885009766
local_output_nid generation:  0.0023698806762695312
local_in_edges_tensor generation:  0.0013382434844970703
mini_batch_src_global generation:  0.0021080970764160156
r_  generation:  0.010324478149414062
local_output_nid generation:  0.0015683174133300781
local_in_edges_tensor generation:  0.0008647441864013672
mini_batch_src_global generation:  0.0009987354278564453
r_  generation:  0.007898807525634766
local_output_nid generation:  0.0015530586242675781
local_in_edges_tensor generation:  0.0008423328399658203
mini_batch_src_global generation:  0.0009617805480957031
r_  generation:  0.008115768432617188
local_output_nid generation:  0.001543283462524414
local_in_edges_tensor generation:  0.0008339881896972656
mini_batch_src_global generation:  0.0009520053863525391
r_  generation:  0.008183479309082031
local_output_nid generation:  0.0015482902526855469
local_in_edges_tensor generation:  0.0008122920989990234
mini_batch_src_global generation:  0.0009653568267822266
r_  generation:  0.008582830429077148
local_output_nid generation:  0.0015208721160888672
local_in_edges_tensor generation:  0.0007765293121337891
mini_batch_src_global generation:  0.0009686946868896484
r_  generation:  0.008307695388793945
local_output_nid generation:  0.0015063285827636719
local_in_edges_tensor generation:  0.0007998943328857422
mini_batch_src_global generation:  0.0011248588562011719
r_  generation:  0.007989883422851562
local_output_nid generation:  0.0014989376068115234
local_in_edges_tensor generation:  0.000789642333984375
mini_batch_src_global generation:  0.0009872913360595703
r_  generation:  0.00810098648071289
local_output_nid generation:  0.001520395278930664
local_in_edges_tensor generation:  0.0007882118225097656
mini_batch_src_global generation:  0.0008971691131591797
r_  generation:  0.008151054382324219
local_output_nid generation:  0.0014944076538085938
local_in_edges_tensor generation:  0.0008037090301513672
mini_batch_src_global generation:  0.0009570121765136719
r_  generation:  0.008562803268432617
local_output_nid generation:  0.0015103816986083984
local_in_edges_tensor generation:  0.0007793903350830078
mini_batch_src_global generation:  0.0009148120880126953
r_  generation:  0.008272171020507812
local_output_nid generation:  0.0015056133270263672
local_in_edges_tensor generation:  0.0007615089416503906
mini_batch_src_global generation:  0.0009090900421142578
r_  generation:  0.008376359939575195
local_output_nid generation:  0.0014965534210205078
local_in_edges_tensor generation:  0.0007739067077636719
mini_batch_src_global generation:  0.0009856224060058594
r_  generation:  0.008083105087280273
local_output_nid generation:  0.0015001296997070312
local_in_edges_tensor generation:  0.0007536411285400391
mini_batch_src_global generation:  0.0009207725524902344
r_  generation:  0.008264541625976562
local_output_nid generation:  0.0015058517456054688
local_in_edges_tensor generation:  0.0007615089416503906
mini_batch_src_global generation:  0.0009334087371826172
r_  generation:  0.008410930633544922
local_output_nid generation:  0.0014798641204833984
local_in_edges_tensor generation:  0.0007848739624023438
mini_batch_src_global generation:  0.0009188652038574219
r_  generation:  0.008049726486206055
local_output_nid generation:  0.0014841556549072266
local_in_edges_tensor generation:  0.0007672309875488281
mini_batch_src_global generation:  0.0009009838104248047
r_  generation:  0.008103609085083008
local_output_nid generation:  0.001501321792602539
local_in_edges_tensor generation:  0.0007550716400146484
mini_batch_src_global generation:  0.000919342041015625
r_  generation:  0.008268356323242188
local_output_nid generation:  0.0014884471893310547
local_in_edges_tensor generation:  0.0007777214050292969
mini_batch_src_global generation:  0.0009486675262451172
r_  generation:  0.010537862777709961
local_output_nid generation:  0.0016140937805175781
local_in_edges_tensor generation:  0.0008094310760498047
mini_batch_src_global generation:  0.0009458065032958984
r_  generation:  0.008461713790893555
local_output_nid generation:  0.0015108585357666016
local_in_edges_tensor generation:  0.0007741451263427734
mini_batch_src_global generation:  0.0009636878967285156
r_  generation:  0.009507417678833008
local_output_nid generation:  0.001554727554321289
local_in_edges_tensor generation:  0.0008530616760253906
mini_batch_src_global generation:  0.0009748935699462891
r_  generation:  0.008371114730834961
local_output_nid generation:  0.0015215873718261719
local_in_edges_tensor generation:  0.0008301734924316406
mini_batch_src_global generation:  0.0009491443634033203
r_  generation:  0.008414030075073242
local_output_nid generation:  0.0015101432800292969
local_in_edges_tensor generation:  0.0007762908935546875
mini_batch_src_global generation:  0.0009582042694091797
r_  generation:  0.008415699005126953
local_output_nid generation:  0.0014982223510742188
local_in_edges_tensor generation:  0.0007977485656738281
mini_batch_src_global generation:  0.0009322166442871094
r_  generation:  0.008441448211669922
local_output_nid generation:  0.0014910697937011719
local_in_edges_tensor generation:  0.0007498264312744141
mini_batch_src_global generation:  0.0009415149688720703
r_  generation:  0.00840139389038086
local_output_nid generation:  0.0014903545379638672
local_in_edges_tensor generation:  0.0008008480072021484
mini_batch_src_global generation:  0.0009191036224365234
r_  generation:  0.008315801620483398
local_output_nid generation:  0.001535654067993164
local_in_edges_tensor generation:  0.0007908344268798828
mini_batch_src_global generation:  0.0009217262268066406
r_  generation:  0.008106708526611328
local_output_nid generation:  0.00148773193359375
local_in_edges_tensor generation:  0.0007946491241455078
mini_batch_src_global generation:  0.0009484291076660156
r_  generation:  0.008590221405029297
local_output_nid generation:  0.0014910697937011719
local_in_edges_tensor generation:  0.0007967948913574219
mini_batch_src_global generation:  0.0009963512420654297
r_  generation:  0.009489774703979492
local_output_nid generation:  0.0015075206756591797
local_in_edges_tensor generation:  0.0008444786071777344
mini_batch_src_global generation:  0.0009891986846923828
r_  generation:  0.008110523223876953
----------------------check_connections_block total spend ----------------------------- 0.500377893447876
generate_one_block  0.020400047302246094
generate_one_block  0.01928424835205078
generate_one_block  0.015216588973999023
generate_one_block  0.014917135238647461
generate_one_block  0.014668464660644531
generate_one_block  0.015025138854980469
generate_one_block  0.014679908752441406
generate_one_block  0.01411294937133789
generate_one_block  0.01643681526184082
generate_one_block  0.014599323272705078
generate_one_block  0.014847040176391602
generate_one_block  0.014566421508789062
generate_one_block  0.014423131942749023
generate_one_block  0.014072895050048828
generate_one_block  0.014425516128540039
generate_one_block  0.01650214195251465
generate_one_block  0.014095544815063477
generate_one_block  0.014146089553833008
generate_one_block  0.014522790908813477
generate_one_block  0.014637470245361328
generate_one_block  0.01416635513305664
generate_one_block  0.015042304992675781
generate_one_block  0.01623082160949707
generate_one_block  0.014502525329589844
generate_one_block  0.014595508575439453
generate_one_block  0.014442682266235352
generate_one_block  0.014446735382080078
generate_one_block  0.013993263244628906
generate_one_block  0.01408696174621582
generate_one_block  0.01493382453918457
generate_one_block  0.016736507415771484
generate_one_block  0.01399993896484375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03582930564880371
gen group dst list time:  0.01850152015686035
time for parepare:  0.022286415100097656
local_output_nid generation:  0.0054988861083984375
local_in_edges_tensor generation:  0.014707088470458984
mini_batch_src_global generation:  0.01182103157043457
r_  generation:  0.12050652503967285
local_output_nid generation:  0.0076694488525390625
local_in_edges_tensor generation:  0.008926868438720703
mini_batch_src_global generation:  0.014510393142700195
r_  generation:  0.1262364387512207
local_output_nid generation:  0.008150815963745117
local_in_edges_tensor generation:  0.0350034236907959
mini_batch_src_global generation:  0.013534307479858398
r_  generation:  0.13093352317810059
local_output_nid generation:  0.008252382278442383
local_in_edges_tensor generation:  0.009873151779174805
mini_batch_src_global generation:  0.015220403671264648
r_  generation:  0.13783812522888184
local_output_nid generation:  0.008408784866333008
local_in_edges_tensor generation:  0.009771347045898438
mini_batch_src_global generation:  0.015382766723632812
r_  generation:  0.14516592025756836
local_output_nid generation:  0.0107879638671875
local_in_edges_tensor generation:  0.009504556655883789
mini_batch_src_global generation:  0.016772985458374023
r_  generation:  0.14319157600402832
local_output_nid generation:  0.00825047492980957
local_in_edges_tensor generation:  0.008295774459838867
mini_batch_src_global generation:  0.016132593154907227
r_  generation:  0.13476157188415527
local_output_nid generation:  0.00794672966003418
local_in_edges_tensor generation:  0.008085966110229492
mini_batch_src_global generation:  0.015764474868774414
r_  generation:  0.1331639289855957
local_output_nid generation:  0.008123636245727539
local_in_edges_tensor generation:  0.007609844207763672
mini_batch_src_global generation:  0.01631641387939453
r_  generation:  0.13683652877807617
local_output_nid generation:  0.008262157440185547
local_in_edges_tensor generation:  0.007684469223022461
mini_batch_src_global generation:  0.016224145889282227
r_  generation:  0.13689160346984863
local_output_nid generation:  0.008549690246582031
local_in_edges_tensor generation:  0.0077173709869384766
mini_batch_src_global generation:  0.01653313636779785
r_  generation:  0.13795876502990723
local_output_nid generation:  0.008444547653198242
local_in_edges_tensor generation:  0.007596015930175781
mini_batch_src_global generation:  0.016202688217163086
r_  generation:  0.13581109046936035
local_output_nid generation:  0.0084991455078125
local_in_edges_tensor generation:  0.007508516311645508
mini_batch_src_global generation:  0.016027212142944336
r_  generation:  0.16428160667419434
local_output_nid generation:  0.013409614562988281
local_in_edges_tensor generation:  0.010253667831420898
mini_batch_src_global generation:  0.022676944732666016
r_  generation:  0.16155362129211426
local_output_nid generation:  0.011902332305908203
local_in_edges_tensor generation:  0.008957624435424805
mini_batch_src_global generation:  0.02144932746887207
r_  generation:  0.1684253215789795
local_output_nid generation:  0.009556293487548828
local_in_edges_tensor generation:  0.008370399475097656
mini_batch_src_global generation:  0.017256498336791992
r_  generation:  0.16812896728515625
local_output_nid generation:  0.013378381729125977
local_in_edges_tensor generation:  0.010547637939453125
mini_batch_src_global generation:  0.027278900146484375
r_  generation:  0.17845678329467773
local_output_nid generation:  0.011055946350097656
local_in_edges_tensor generation:  0.009103536605834961
mini_batch_src_global generation:  0.016957521438598633
r_  generation:  0.14059114456176758
local_output_nid generation:  0.009302377700805664
local_in_edges_tensor generation:  0.008134841918945312
mini_batch_src_global generation:  0.016558170318603516
r_  generation:  0.1432483196258545
local_output_nid generation:  0.009008169174194336
local_in_edges_tensor generation:  0.008854150772094727
mini_batch_src_global generation:  0.017426729202270508
r_  generation:  0.1419200897216797
local_output_nid generation:  0.009886026382446289
local_in_edges_tensor generation:  0.007623195648193359
mini_batch_src_global generation:  0.01625800132751465
r_  generation:  0.13669824600219727
local_output_nid generation:  0.008949041366577148
local_in_edges_tensor generation:  0.010715246200561523
mini_batch_src_global generation:  0.017637968063354492
r_  generation:  0.18045663833618164
local_output_nid generation:  0.008620023727416992
local_in_edges_tensor generation:  0.011753559112548828
mini_batch_src_global generation:  0.01676487922668457
r_  generation:  0.17349672317504883
local_output_nid generation:  0.00874018669128418
local_in_edges_tensor generation:  0.009334325790405273
mini_batch_src_global generation:  0.017212629318237305
r_  generation:  0.17830896377563477
local_output_nid generation:  0.009580373764038086
local_in_edges_tensor generation:  0.008116006851196289
mini_batch_src_global generation:  0.017659902572631836
r_  generation:  0.14111614227294922
local_output_nid generation:  0.008527040481567383
local_in_edges_tensor generation:  0.007651329040527344
mini_batch_src_global generation:  0.016504287719726562
r_  generation:  0.13915252685546875
local_output_nid generation:  0.008634328842163086
local_in_edges_tensor generation:  0.007597208023071289
mini_batch_src_global generation:  0.01642918586730957
r_  generation:  0.13745331764221191
local_output_nid generation:  0.008368492126464844
local_in_edges_tensor generation:  0.007606983184814453
mini_batch_src_global generation:  0.015949726104736328
r_  generation:  0.13573122024536133
local_output_nid generation:  0.008378028869628906
local_in_edges_tensor generation:  0.007459402084350586
mini_batch_src_global generation:  0.016223430633544922
r_  generation:  0.137542724609375
local_output_nid generation:  0.008701324462890625
local_in_edges_tensor generation:  0.0088653564453125
mini_batch_src_global generation:  0.028781414031982422
r_  generation:  0.142594575881958
local_output_nid generation:  0.008785247802734375
local_in_edges_tensor generation:  0.008382081985473633
mini_batch_src_global generation:  0.016887187957763672
r_  generation:  0.14330196380615234
local_output_nid generation:  0.008327484130859375
local_in_edges_tensor generation:  0.0074100494384765625
mini_batch_src_global generation:  0.01612114906311035
r_  generation:  0.13403534889221191
----------------------check_connections_block total spend ----------------------------- 6.883088827133179
generate_one_block  0.18152308464050293
generate_one_block  0.1682720184326172
generate_one_block  0.17917275428771973
generate_one_block  0.18342232704162598
generate_one_block  0.19397521018981934
generate_one_block  0.18221163749694824
generate_one_block  0.1816389560699463
generate_one_block  0.17249846458435059
generate_one_block  0.17700743675231934
generate_one_block  0.17301082611083984
generate_one_block  0.17876148223876953
generate_one_block  0.1714024543762207
generate_one_block  0.17127323150634766
generate_one_block  0.16762542724609375
generate_one_block  0.17672967910766602
generate_one_block  0.1776573657989502
generate_one_block  0.16760778427124023
generate_one_block  0.17284536361694336
generate_one_block  0.17869043350219727
generate_one_block  0.21532201766967773
generate_one_block  0.177229642868042
generate_one_block  0.1965160369873047
generate_one_block  0.1793498992919922
generate_one_block  0.17560696601867676
generate_one_block  0.1807253360748291
generate_one_block  0.17742395401000977
generate_one_block  0.17697739601135254
generate_one_block  0.1735529899597168
generate_one_block  0.17188286781311035
generate_one_block  0.18434691429138184
generate_one_block  0.1840062141418457
generate_one_block  0.16830801963806152
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03436565399169922
gen group dst list time:  0.1020359992980957
time for parepare:  0.01974797248840332
local_output_nid generation:  0.023865938186645508
local_in_edges_tensor generation:  0.051306724548339844
mini_batch_src_global generation:  0.03825664520263672
r_  generation:  0.3892395496368408
local_output_nid generation:  0.028744935989379883
local_in_edges_tensor generation:  0.033042192459106445
mini_batch_src_global generation:  0.04786181449890137
r_  generation:  0.39037370681762695
local_output_nid generation:  0.029244184494018555
local_in_edges_tensor generation:  0.03595232963562012
mini_batch_src_global generation:  0.047481536865234375
r_  generation:  0.42470574378967285
local_output_nid generation:  0.03210043907165527
local_in_edges_tensor generation:  0.03378105163574219
mini_batch_src_global generation:  0.04987788200378418
r_  generation:  0.3990926742553711
local_output_nid generation:  0.029482126235961914
local_in_edges_tensor generation:  0.02589130401611328
mini_batch_src_global generation:  0.047135114669799805
r_  generation:  0.40612316131591797
local_output_nid generation:  0.02921128273010254
local_in_edges_tensor generation:  0.0276186466217041
mini_batch_src_global generation:  0.049515485763549805
r_  generation:  0.40291380882263184
local_output_nid generation:  0.027856111526489258
local_in_edges_tensor generation:  0.026349306106567383
mini_batch_src_global generation:  0.04689908027648926
r_  generation:  0.4077432155609131
local_output_nid generation:  0.028020143508911133
local_in_edges_tensor generation:  0.025884151458740234
mini_batch_src_global generation:  0.047414541244506836
r_  generation:  0.40935635566711426
local_output_nid generation:  0.02736210823059082
local_in_edges_tensor generation:  0.02632617950439453
mini_batch_src_global generation:  0.04853963851928711
r_  generation:  0.4108285903930664
local_output_nid generation:  0.028188228607177734
local_in_edges_tensor generation:  0.02865457534790039
mini_batch_src_global generation:  0.04853034019470215
r_  generation:  0.4023864269256592
local_output_nid generation:  0.027878761291503906
local_in_edges_tensor generation:  0.027927398681640625
mini_batch_src_global generation:  0.0489504337310791
r_  generation:  0.41202354431152344
local_output_nid generation:  0.029414892196655273
local_in_edges_tensor generation:  0.02992391586303711
mini_batch_src_global generation:  0.04751300811767578
r_  generation:  0.3989887237548828
local_output_nid generation:  0.027708053588867188
local_in_edges_tensor generation:  0.028059720993041992
mini_batch_src_global generation:  0.04782390594482422
r_  generation:  0.40590739250183105
local_output_nid generation:  0.028189897537231445
local_in_edges_tensor generation:  0.02921009063720703
mini_batch_src_global generation:  0.04762411117553711
r_  generation:  0.3970780372619629
local_output_nid generation:  0.027768611907958984
local_in_edges_tensor generation:  0.028798818588256836
mini_batch_src_global generation:  0.04748344421386719
r_  generation:  0.41129398345947266
local_output_nid generation:  0.02786993980407715
local_in_edges_tensor generation:  0.029031038284301758
mini_batch_src_global generation:  0.04990410804748535
r_  generation:  0.40438032150268555
local_output_nid generation:  0.027411699295043945
local_in_edges_tensor generation:  0.027823448181152344
mini_batch_src_global generation:  0.04675793647766113
r_  generation:  0.4030320644378662
local_output_nid generation:  0.027804136276245117
local_in_edges_tensor generation:  0.026543617248535156
mini_batch_src_global generation:  0.04752707481384277
r_  generation:  0.4033503532409668
local_output_nid generation:  0.027937889099121094
local_in_edges_tensor generation:  0.029371976852416992
mini_batch_src_global generation:  0.04848814010620117
r_  generation:  0.41173624992370605
local_output_nid generation:  0.0280306339263916
local_in_edges_tensor generation:  0.02877950668334961
mini_batch_src_global generation:  0.052034616470336914
r_  generation:  0.40804386138916016
local_output_nid generation:  0.027541160583496094
local_in_edges_tensor generation:  0.03106546401977539
mini_batch_src_global generation:  0.046803951263427734
r_  generation:  0.40946483612060547
local_output_nid generation:  0.02818751335144043
local_in_edges_tensor generation:  0.027852535247802734
mini_batch_src_global generation:  0.0493931770324707
r_  generation:  0.4271886348724365
local_output_nid generation:  0.03019404411315918
local_in_edges_tensor generation:  0.02639031410217285
mini_batch_src_global generation:  0.04897046089172363
r_  generation:  0.41163063049316406
local_output_nid generation:  0.027904272079467773
local_in_edges_tensor generation:  0.025870561599731445
mini_batch_src_global generation:  0.04826164245605469
r_  generation:  0.4037296772003174
local_output_nid generation:  0.027851581573486328
local_in_edges_tensor generation:  0.030088186264038086
mini_batch_src_global generation:  0.04797053337097168
r_  generation:  0.4126091003417969
local_output_nid generation:  0.02752518653869629
local_in_edges_tensor generation:  0.02922677993774414
mini_batch_src_global generation:  0.04861927032470703
r_  generation:  0.40084385871887207
local_output_nid generation:  0.027804851531982422
local_in_edges_tensor generation:  0.025255918502807617
mini_batch_src_global generation:  0.046736955642700195
r_  generation:  0.40897202491760254
local_output_nid generation:  0.02743077278137207
local_in_edges_tensor generation:  0.03112506866455078
mini_batch_src_global generation:  0.04797220230102539
r_  generation:  0.3974595069885254
local_output_nid generation:  0.027591228485107422
local_in_edges_tensor generation:  0.025078535079956055
mini_batch_src_global generation:  0.0460512638092041
r_  generation:  0.40710902214050293
local_output_nid generation:  0.027940750122070312
local_in_edges_tensor generation:  0.02514958381652832
mini_batch_src_global generation:  0.04765677452087402
r_  generation:  0.4029417037963867
local_output_nid generation:  0.027879714965820312
local_in_edges_tensor generation:  0.02652287483215332
mini_batch_src_global generation:  0.04740166664123535
r_  generation:  0.41621828079223633
local_output_nid generation:  0.027312040328979492
local_in_edges_tensor generation:  0.02600240707397461
mini_batch_src_global generation:  0.04804277420043945
r_  generation:  0.3958892822265625
----------------------check_connections_block total spend ----------------------------- 19.23006510734558
generate_one_block  0.5339341163635254
generate_one_block  0.5278549194335938
generate_one_block  0.531933069229126
generate_one_block  0.5330872535705566
generate_one_block  0.6323177814483643
generate_one_block  0.5365581512451172
generate_one_block  0.5275683403015137
generate_one_block  0.5334174633026123
generate_one_block  0.5366711616516113
generate_one_block  0.5344593524932861
generate_one_block  0.5395877361297607
generate_one_block  0.5294473171234131
generate_one_block  0.5305778980255127
generate_one_block  0.52632737159729
generate_one_block  0.535231351852417
generate_one_block  0.5395808219909668
generate_one_block  0.5240843296051025
generate_one_block  0.5368077754974365
generate_one_block  0.537003755569458
generate_one_block  0.5406105518341064
generate_one_block  0.5342652797698975
generate_one_block  0.5550055503845215
generate_one_block  0.5329949855804443
generate_one_block  0.5348894596099854
generate_one_block  0.5555264949798584
generate_one_block  0.5289332866668701
generate_one_block  0.5302681922912598
generate_one_block  0.5256924629211426
generate_one_block  0.52884840965271
generate_one_block  0.5461874008178711
generate_one_block  0.5403013229370117
generate_one_block  0.5240869522094727
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.12000131607055664  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

connection checking time:  26.11315393447876
block generation total time  22.920634508132935
average batch blocks generation time:  0.7162698283791542
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.10248661041259766  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.38027048110962  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.10239648818969727  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.306178092956543  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.10398578643798828  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.695902347564697  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.10411596298217773  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.853233337402344  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.10389900207519531  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.880409717559814  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.10429716110229492  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 16.042795181274414  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.10285425186157227  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.699730396270752  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.10286664962768555  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.48193359375  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.1038980484008789  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.86523151397705  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.10280275344848633  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.709934711456299  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.10503149032592773  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.88837194442749  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.10294628143310547  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.549803733825684  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.10390949249267578  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.583835124969482  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.10271072387695312  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.357227802276611  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.10401725769042969  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.742809295654297  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.10403251647949219  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.856002807617188  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.10271644592285156  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.367992877960205  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.1029958724975586  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.708966732025146  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.10501432418823242  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.86497449874878  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.10403299331665039  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.900862216949463  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.1028294563293457  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 15.492829322814941  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 0.10431528091430664  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.085636138916016  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10500955581665039  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.8407301902771  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10412120819091797  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.811037063598633  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10503196716308594  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.951974391937256  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10274934768676758  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.7501802444458  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10399341583251953  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.71239709854126  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1027379035949707  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.423824787139893  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1038360595703125  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.44422197341919  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10421609878540039  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.986186981201172  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10506868362426758  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.092864513397217  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10240459442138672  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.317081451416016  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03349454700946808 |0.010106518864631653 |0.2629666328430176 |9.065121412277222e-05 |0.42688143253326416 |0.006832122802734375 |
----------------------------------------------------------pseudo_mini_loss sum 1.9842536449432373
 Run 0| Epoch 6 |
Number of nodes for computation during this epoch:  8574090
Number of first layer input nodes during this epoch:  4652151
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.11870574951171875  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02092289924621582
random selection method range initialization spend 0.00657343864440918
time for parepare:  0.01942586898803711
local_output_nid generation:  0.0013916492462158203
local_in_edges_tensor generation:  0.0044629573822021484
mini_batch_src_global generation:  0.0027303695678710938
r_  generation:  0.01596236228942871
local_output_nid generation:  0.002698659896850586
local_in_edges_tensor generation:  0.0013396739959716797
mini_batch_src_global generation:  0.0019078254699707031
r_  generation:  0.00918722152709961
local_output_nid generation:  0.0023162364959716797
local_in_edges_tensor generation:  0.0011861324310302734
mini_batch_src_global generation:  0.0014467239379882812
r_  generation:  0.008664131164550781
local_output_nid generation:  0.002241373062133789
local_in_edges_tensor generation:  0.00112152099609375
mini_batch_src_global generation:  0.0013375282287597656
r_  generation:  0.008411169052124023
local_output_nid generation:  0.0021648406982421875
local_in_edges_tensor generation:  0.001054525375366211
mini_batch_src_global generation:  0.0012505054473876953
r_  generation:  0.008371114730834961
local_output_nid generation:  0.0021600723266601562
local_in_edges_tensor generation:  0.0010814666748046875
mini_batch_src_global generation:  0.0012178421020507812
r_  generation:  0.008334159851074219
local_output_nid generation:  0.0021245479583740234
local_in_edges_tensor generation:  0.00107574462890625
mini_batch_src_global generation:  0.0011935234069824219
r_  generation:  0.00855398178100586
local_output_nid generation:  0.0021333694458007812
local_in_edges_tensor generation:  0.0010616779327392578
mini_batch_src_global generation:  0.001116037368774414
r_  generation:  0.008125066757202148
local_output_nid generation:  0.002157449722290039
local_in_edges_tensor generation:  0.0011026859283447266
mini_batch_src_global generation:  0.0011081695556640625
r_  generation:  0.008486747741699219
local_output_nid generation:  0.002094745635986328
local_in_edges_tensor generation:  0.001012563705444336
mini_batch_src_global generation:  0.0012485980987548828
r_  generation:  0.008322715759277344
local_output_nid generation:  0.0021414756774902344
local_in_edges_tensor generation:  0.0010225772857666016
mini_batch_src_global generation:  0.0010633468627929688
r_  generation:  0.008477210998535156
local_output_nid generation:  0.0021047592163085938
local_in_edges_tensor generation:  0.0010335445404052734
mini_batch_src_global generation:  0.0011017322540283203
r_  generation:  0.008474588394165039
local_output_nid generation:  0.0021452903747558594
local_in_edges_tensor generation:  0.001024007797241211
mini_batch_src_global generation:  0.0010938644409179688
r_  generation:  0.008509159088134766
local_output_nid generation:  0.0021071434020996094
local_in_edges_tensor generation:  0.0009889602661132812
mini_batch_src_global generation:  0.0010790824890136719
r_  generation:  0.008328437805175781
local_output_nid generation:  0.0021147727966308594
local_in_edges_tensor generation:  0.001010894775390625
mini_batch_src_global generation:  0.0010635852813720703
r_  generation:  0.008445501327514648
local_output_nid generation:  0.0021066665649414062
local_in_edges_tensor generation:  0.0009748935699462891
mini_batch_src_global generation:  0.0010445117950439453
r_  generation:  0.008242607116699219
local_output_nid generation:  0.0020990371704101562
local_in_edges_tensor generation:  0.0010366439819335938
mini_batch_src_global generation:  0.0010411739349365234
r_  generation:  0.008398771286010742
local_output_nid generation:  0.0021109580993652344
local_in_edges_tensor generation:  0.0009620189666748047
mini_batch_src_global generation:  0.0010223388671875
r_  generation:  0.008216142654418945
local_output_nid generation:  0.002070903778076172
local_in_edges_tensor generation:  0.0009980201721191406
mini_batch_src_global generation:  0.0010023117065429688
r_  generation:  0.00842905044555664
local_output_nid generation:  0.0020492076873779297
local_in_edges_tensor generation:  0.0009558200836181641
mini_batch_src_global generation:  0.0010640621185302734
r_  generation:  0.008428335189819336
local_output_nid generation:  0.0020935535430908203
local_in_edges_tensor generation:  0.000997304916381836
mini_batch_src_global generation:  0.0011036396026611328
r_  generation:  0.00867009162902832
local_output_nid generation:  0.0020983219146728516
local_in_edges_tensor generation:  0.0009646415710449219
mini_batch_src_global generation:  0.0011200904846191406
r_  generation:  0.00834345817565918
local_output_nid generation:  0.0020830631256103516
local_in_edges_tensor generation:  0.00099945068359375
mini_batch_src_global generation:  0.0010426044464111328
r_  generation:  0.008401632308959961
local_output_nid generation:  0.002097606658935547
local_in_edges_tensor generation:  0.0009529590606689453
mini_batch_src_global generation:  0.0010864734649658203
r_  generation:  0.008386850357055664
local_output_nid generation:  0.002060413360595703
local_in_edges_tensor generation:  0.0010030269622802734
mini_batch_src_global generation:  0.0010325908660888672
r_  generation:  0.00856471061706543
local_output_nid generation:  0.002082347869873047
local_in_edges_tensor generation:  0.0010013580322265625
mini_batch_src_global generation:  0.0010540485382080078
r_  generation:  0.008321762084960938
local_output_nid generation:  0.0021131038665771484
local_in_edges_tensor generation:  0.0010106563568115234
mini_batch_src_global generation:  0.0010523796081542969
r_  generation:  0.008565664291381836
local_output_nid generation:  0.002069711685180664
local_in_edges_tensor generation:  0.001013040542602539
mini_batch_src_global generation:  0.0010943412780761719
r_  generation:  0.008521080017089844
local_output_nid generation:  0.0020990371704101562
local_in_edges_tensor generation:  0.0009982585906982422
mini_batch_src_global generation:  0.0010287761688232422
r_  generation:  0.008425712585449219
local_output_nid generation:  0.0020995140075683594
local_in_edges_tensor generation:  0.0010309219360351562
mini_batch_src_global generation:  0.0010559558868408203
r_  generation:  0.0085296630859375
local_output_nid generation:  0.0020961761474609375
local_in_edges_tensor generation:  0.0009739398956298828
mini_batch_src_global generation:  0.0010249614715576172
r_  generation:  0.008436918258666992
local_output_nid generation:  0.0021071434020996094
local_in_edges_tensor generation:  0.0009839534759521484
mini_batch_src_global generation:  0.0010154247283935547
r_  generation:  0.00837850570678711
----------------------check_connections_block total spend ----------------------------- 0.5362014770507812
generate_one_block  0.019316911697387695
generate_one_block  0.019934415817260742
generate_one_block  0.01705002784729004
generate_one_block  0.01619410514831543
generate_one_block  0.015492916107177734
generate_one_block  0.015353202819824219
generate_one_block  0.015244245529174805
generate_one_block  0.015062808990478516
generate_one_block  0.015483379364013672
generate_one_block  0.015104055404663086
generate_one_block  0.01508784294128418
generate_one_block  0.015445947647094727
generate_one_block  0.015262842178344727
generate_one_block  0.01514291763305664
generate_one_block  0.014978170394897461
generate_one_block  0.015137672424316406
generate_one_block  0.01509404182434082
generate_one_block  0.015013456344604492
generate_one_block  0.014967203140258789
generate_one_block  0.015081167221069336
generate_one_block  0.015327692031860352
generate_one_block  0.015038013458251953
generate_one_block  0.014941930770874023
generate_one_block  0.015120744705200195
generate_one_block  0.015116453170776367
generate_one_block  0.014940738677978516
generate_one_block  0.01527547836303711
generate_one_block  0.015364885330200195
generate_one_block  0.015148639678955078
generate_one_block  0.015360593795776367
generate_one_block  0.015008211135864258
generate_one_block  0.015006065368652344
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03941202163696289
gen group dst list time:  0.023293018341064453
time for parepare:  0.02624678611755371
local_output_nid generation:  0.00808405876159668
local_in_edges_tensor generation:  0.017736434936523438
mini_batch_src_global generation:  0.01268768310546875
r_  generation:  0.13920187950134277
local_output_nid generation:  0.009439468383789062
local_in_edges_tensor generation:  0.010677099227905273
mini_batch_src_global generation:  0.030776500701904297
r_  generation:  0.13130545616149902
local_output_nid generation:  0.00878453254699707
local_in_edges_tensor generation:  0.030961990356445312
mini_batch_src_global generation:  0.017583847045898438
r_  generation:  0.14061284065246582
local_output_nid generation:  0.008643150329589844
local_in_edges_tensor generation:  0.009169816970825195
mini_batch_src_global generation:  0.018398046493530273
r_  generation:  0.14707589149475098
local_output_nid generation:  0.008485555648803711
local_in_edges_tensor generation:  0.00800466537475586
mini_batch_src_global generation:  0.018862009048461914
r_  generation:  0.14342570304870605
local_output_nid generation:  0.008253097534179688
local_in_edges_tensor generation:  0.010342121124267578
mini_batch_src_global generation:  0.01981377601623535
r_  generation:  0.14278364181518555
local_output_nid generation:  0.00798344612121582
local_in_edges_tensor generation:  0.007790565490722656
mini_batch_src_global generation:  0.01981377601623535
r_  generation:  0.14268922805786133
local_output_nid generation:  0.007888078689575195
local_in_edges_tensor generation:  0.008195161819458008
mini_batch_src_global generation:  0.017813444137573242
r_  generation:  0.13871479034423828
local_output_nid generation:  0.007893562316894531
local_in_edges_tensor generation:  0.008860588073730469
mini_batch_src_global generation:  0.01787543296813965
r_  generation:  0.14321494102478027
local_output_nid generation:  0.00785970687866211
local_in_edges_tensor generation:  0.007618904113769531
mini_batch_src_global generation:  0.02686333656311035
r_  generation:  0.14162373542785645
local_output_nid generation:  0.013119697570800781
local_in_edges_tensor generation:  0.010690927505493164
mini_batch_src_global generation:  0.016672134399414062
r_  generation:  0.14701080322265625
local_output_nid generation:  0.013564586639404297
local_in_edges_tensor generation:  0.011496543884277344
mini_batch_src_global generation:  0.017242431640625
r_  generation:  0.14793634414672852
local_output_nid generation:  0.013736724853515625
local_in_edges_tensor generation:  0.009111166000366211
mini_batch_src_global generation:  0.02132868766784668
r_  generation:  0.1455228328704834
local_output_nid generation:  0.009273529052734375
local_in_edges_tensor generation:  0.008084774017333984
mini_batch_src_global generation:  0.018338918685913086
r_  generation:  0.1459496021270752
local_output_nid generation:  0.008668899536132812
local_in_edges_tensor generation:  0.00781702995300293
mini_batch_src_global generation:  0.017841577529907227
r_  generation:  0.14487004280090332
local_output_nid generation:  0.008617877960205078
local_in_edges_tensor generation:  0.008340835571289062
mini_batch_src_global generation:  0.018543004989624023
r_  generation:  0.14730095863342285
local_output_nid generation:  0.008374691009521484
local_in_edges_tensor generation:  0.008926868438720703
mini_batch_src_global generation:  0.021739482879638672
r_  generation:  0.14816761016845703
local_output_nid generation:  0.008452177047729492
local_in_edges_tensor generation:  0.011170387268066406
mini_batch_src_global generation:  0.02075362205505371
r_  generation:  0.14679503440856934
local_output_nid generation:  0.008314371109008789
local_in_edges_tensor generation:  0.008013010025024414
mini_batch_src_global generation:  0.019846439361572266
r_  generation:  0.14805865287780762
local_output_nid generation:  0.008236169815063477
local_in_edges_tensor generation:  0.007730960845947266
mini_batch_src_global generation:  0.019808053970336914
r_  generation:  0.1533806324005127
local_output_nid generation:  0.011642694473266602
local_in_edges_tensor generation:  0.009755134582519531
mini_batch_src_global generation:  0.018541574478149414
r_  generation:  0.1462559700012207
local_output_nid generation:  0.008559942245483398
local_in_edges_tensor generation:  0.008235692977905273
mini_batch_src_global generation:  0.018804073333740234
r_  generation:  0.1634049415588379
local_output_nid generation:  0.013553142547607422
local_in_edges_tensor generation:  0.010452985763549805
mini_batch_src_global generation:  0.018569231033325195
r_  generation:  0.15144014358520508
local_output_nid generation:  0.01397252082824707
local_in_edges_tensor generation:  0.010827302932739258
mini_batch_src_global generation:  0.018159151077270508
r_  generation:  0.16813063621520996
local_output_nid generation:  0.011678218841552734
local_in_edges_tensor generation:  0.009126663208007812
mini_batch_src_global generation:  0.026680469512939453
r_  generation:  0.14672064781188965
local_output_nid generation:  0.009564876556396484
local_in_edges_tensor generation:  0.00861215591430664
mini_batch_src_global generation:  0.019147634506225586
r_  generation:  0.14596247673034668
local_output_nid generation:  0.009160280227661133
local_in_edges_tensor generation:  0.007983922958374023
mini_batch_src_global generation:  0.018349170684814453
r_  generation:  0.14933037757873535
local_output_nid generation:  0.008942604064941406
local_in_edges_tensor generation:  0.009015798568725586
mini_batch_src_global generation:  0.01877284049987793
r_  generation:  0.15027570724487305
local_output_nid generation:  0.008738517761230469
local_in_edges_tensor generation:  0.008263826370239258
mini_batch_src_global generation:  0.01920628547668457
r_  generation:  0.14864516258239746
local_output_nid generation:  0.008751153945922852
local_in_edges_tensor generation:  0.007905006408691406
mini_batch_src_global generation:  0.018878459930419922
r_  generation:  0.1516408920288086
local_output_nid generation:  0.00860452651977539
local_in_edges_tensor generation:  0.007780551910400391
mini_batch_src_global generation:  0.01851820945739746
r_  generation:  0.14931297302246094
local_output_nid generation:  0.008644819259643555
local_in_edges_tensor generation:  0.008295059204101562
mini_batch_src_global generation:  0.018876075744628906
r_  generation:  0.15047574043273926
----------------------check_connections_block total spend ----------------------------- 7.095730304718018
generate_one_block  0.19296479225158691
generate_one_block  0.17255854606628418
generate_one_block  0.18694734573364258
generate_one_block  0.1849534511566162
generate_one_block  0.1961956024169922
generate_one_block  0.17852401733398438
generate_one_block  0.1820211410522461
generate_one_block  0.18170976638793945
generate_one_block  0.18300461769104004
generate_one_block  0.17420291900634766
generate_one_block  0.1757497787475586
generate_one_block  0.18195295333862305
generate_one_block  0.17493128776550293
generate_one_block  0.17412924766540527
generate_one_block  0.17130208015441895
generate_one_block  0.17499780654907227
generate_one_block  0.1759960651397705
generate_one_block  0.17675471305847168
generate_one_block  0.17334532737731934
generate_one_block  0.2072606086730957
generate_one_block  0.17629718780517578
generate_one_block  0.1771106719970703
generate_one_block  0.17550945281982422
generate_one_block  0.17583012580871582
generate_one_block  0.18008852005004883
generate_one_block  0.1809675693511963
generate_one_block  0.19385123252868652
generate_one_block  0.1808004379272461
generate_one_block  0.18015408515930176
generate_one_block  0.18286681175231934
generate_one_block  0.17828583717346191
generate_one_block  0.1758427619934082
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.035280704498291016
gen group dst list time:  0.10044980049133301
time for parepare:  0.02095198631286621
local_output_nid generation:  0.023496627807617188
local_in_edges_tensor generation:  0.04626727104187012
mini_batch_src_global generation:  0.03672170639038086
r_  generation:  0.4043116569519043
local_output_nid generation:  0.03020024299621582
local_in_edges_tensor generation:  0.031932830810546875
mini_batch_src_global generation:  0.04947161674499512
r_  generation:  0.3912510871887207
local_output_nid generation:  0.02886199951171875
local_in_edges_tensor generation:  0.03056955337524414
mini_batch_src_global generation:  0.04750370979309082
r_  generation:  0.4046361446380615
local_output_nid generation:  0.02912139892578125
local_in_edges_tensor generation:  0.030755043029785156
mini_batch_src_global generation:  0.04755806922912598
r_  generation:  0.40160107612609863
local_output_nid generation:  0.029046058654785156
local_in_edges_tensor generation:  0.026502609252929688
mini_batch_src_global generation:  0.04637503623962402
r_  generation:  0.413585901260376
local_output_nid generation:  0.029501676559448242
local_in_edges_tensor generation:  0.027773380279541016
mini_batch_src_global generation:  0.050209999084472656
r_  generation:  0.4240236282348633
local_output_nid generation:  0.029963016510009766
local_in_edges_tensor generation:  0.03160452842712402
mini_batch_src_global generation:  0.04708671569824219
r_  generation:  0.4026954174041748
local_output_nid generation:  0.027635812759399414
local_in_edges_tensor generation:  0.026729583740234375
mini_batch_src_global generation:  0.04812216758728027
r_  generation:  0.4012455940246582
local_output_nid generation:  0.02774810791015625
local_in_edges_tensor generation:  0.025423526763916016
mini_batch_src_global generation:  0.04801344871520996
r_  generation:  0.4048013687133789
local_output_nid generation:  0.027358055114746094
local_in_edges_tensor generation:  0.028694868087768555
mini_batch_src_global generation:  0.047997236251831055
r_  generation:  0.41210436820983887
local_output_nid generation:  0.02757406234741211
local_in_edges_tensor generation:  0.02536487579345703
mini_batch_src_global generation:  0.04589653015136719
r_  generation:  0.40431809425354004
local_output_nid generation:  0.02910900115966797
local_in_edges_tensor generation:  0.024155378341674805
mini_batch_src_global generation:  0.04962468147277832
r_  generation:  0.40633535385131836
local_output_nid generation:  0.028861522674560547
local_in_edges_tensor generation:  0.03034687042236328
mini_batch_src_global generation:  0.04638314247131348
r_  generation:  0.40761470794677734
local_output_nid generation:  0.028319358825683594
local_in_edges_tensor generation:  0.03139209747314453
mini_batch_src_global generation:  0.04901623725891113
r_  generation:  0.4075655937194824
local_output_nid generation:  0.027417659759521484
local_in_edges_tensor generation:  0.02717280387878418
mini_batch_src_global generation:  0.04904532432556152
r_  generation:  0.40433382987976074
local_output_nid generation:  0.027699708938598633
local_in_edges_tensor generation:  0.030233144760131836
mini_batch_src_global generation:  0.051052093505859375
r_  generation:  0.42681312561035156
local_output_nid generation:  0.030150651931762695
local_in_edges_tensor generation:  0.027108192443847656
mini_batch_src_global generation:  0.04973316192626953
r_  generation:  0.40588831901550293
local_output_nid generation:  0.027863502502441406
local_in_edges_tensor generation:  0.028833389282226562
mini_batch_src_global generation:  0.048454999923706055
r_  generation:  0.40302228927612305
local_output_nid generation:  0.027676105499267578
local_in_edges_tensor generation:  0.02530193328857422
mini_batch_src_global generation:  0.04729771614074707
r_  generation:  0.4021275043487549
local_output_nid generation:  0.027701854705810547
local_in_edges_tensor generation:  0.025321483612060547
mini_batch_src_global generation:  0.047983646392822266
r_  generation:  0.4064786434173584
local_output_nid generation:  0.027695655822753906
local_in_edges_tensor generation:  0.026928424835205078
mini_batch_src_global generation:  0.0470280647277832
r_  generation:  0.408038854598999
local_output_nid generation:  0.027852773666381836
local_in_edges_tensor generation:  0.02693629264831543
mini_batch_src_global generation:  0.04968404769897461
r_  generation:  0.40335679054260254
local_output_nid generation:  0.027617931365966797
local_in_edges_tensor generation:  0.025391340255737305
mini_batch_src_global generation:  0.047315359115600586
r_  generation:  0.4047129154205322
local_output_nid generation:  0.027832746505737305
local_in_edges_tensor generation:  0.02865123748779297
mini_batch_src_global generation:  0.048332929611206055
r_  generation:  0.40415167808532715
local_output_nid generation:  0.027401447296142578
local_in_edges_tensor generation:  0.026627063751220703
mini_batch_src_global generation:  0.04710721969604492
r_  generation:  0.4053080081939697
local_output_nid generation:  0.027959108352661133
local_in_edges_tensor generation:  0.026985883712768555
mini_batch_src_global generation:  0.048193931579589844
r_  generation:  0.4098231792449951
local_output_nid generation:  0.02772974967956543
local_in_edges_tensor generation:  0.02696514129638672
mini_batch_src_global generation:  0.04668116569519043
r_  generation:  0.4077484607696533
local_output_nid generation:  0.027895450592041016
local_in_edges_tensor generation:  0.03135514259338379
mini_batch_src_global generation:  0.04870414733886719
r_  generation:  0.4102201461791992
local_output_nid generation:  0.027775287628173828
local_in_edges_tensor generation:  0.029459238052368164
mini_batch_src_global generation:  0.04718279838562012
r_  generation:  0.41197776794433594
local_output_nid generation:  0.028951406478881836
local_in_edges_tensor generation:  0.025407791137695312
mini_batch_src_global generation:  0.048547983169555664
r_  generation:  0.4094526767730713
local_output_nid generation:  0.027518272399902344
local_in_edges_tensor generation:  0.02516031265258789
mini_batch_src_global generation:  0.047882080078125
r_  generation:  0.4072089195251465
local_output_nid generation:  0.029855012893676758
local_in_edges_tensor generation:  0.031508445739746094
mini_batch_src_global generation:  0.048059701919555664
r_  generation:  0.4043312072753906
----------------------check_connections_block total spend ----------------------------- 19.258675575256348
generate_one_block  0.5516176223754883
generate_one_block  0.5346603393554688
generate_one_block  0.5418121814727783
generate_one_block  0.5451266765594482
generate_one_block  0.6451716423034668
generate_one_block  0.5274121761322021
generate_one_block  0.5324387550354004
generate_one_block  0.5328552722930908
generate_one_block  0.537926435470581
generate_one_block  0.5280978679656982
generate_one_block  0.5281901359558105
generate_one_block  0.5323336124420166
generate_one_block  0.5335996150970459
generate_one_block  0.5328342914581299
generate_one_block  0.541334867477417
generate_one_block  0.538588285446167
generate_one_block  0.5398638248443604
generate_one_block  0.5373365879058838
generate_one_block  0.5301544666290283
generate_one_block  0.5340514183044434
generate_one_block  0.5377440452575684
generate_one_block  0.5357551574707031
generate_one_block  0.5433037281036377
generate_one_block  0.537339448928833
generate_one_block  0.5502727031707764
generate_one_block  0.5421192646026611
generate_one_block  0.5302286148071289
generate_one_block  0.5385522842407227
generate_one_block  0.5426173210144043
generate_one_block  0.5348548889160156
generate_one_block  0.5342333316802979
generate_one_block  0.5367496013641357
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.11870574951171875  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

connection checking time:  26.354405879974365
block generation total time  23.066283226013184
average batch blocks generation time:  0.720821350812912
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10402870178222656  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.898044109344482  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1029062271118164  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.466109275817871  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10506772994995117  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.06035089492798  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10422515869140625  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.94808053970337  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10500955581665039  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.845318794250488  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10300827026367188  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.746993064880371  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10285139083862305  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.687492847442627  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10332965850830078  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.703235626220703  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10502243041992188  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.844359874725342  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10290002822875977  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.502801418304443  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10263776779174805  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.511523723602295  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10295295715332031  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.752041816711426  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10389518737792969  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.555180072784424  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10284090042114258  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.609950065612793  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10382461547851562  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.426496505737305  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1032109260559082  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.684135913848877  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10398101806640625  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.7106351852417  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10322141647338867  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.740875244140625  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10282135009765625  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.552993297576904  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1029810905456543  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.653079986572266  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1039724349975586  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.698258399963379  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10312128067016602  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.694393634796143  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10498666763305664  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.730955123901367  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10325288772583008  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.73561143875122  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10292673110961914  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.771824836730957  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10413742065429688  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.759819030761719  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10402202606201172  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.773132801055908  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10391998291015625  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.939017295837402  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10500717163085938  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.792286396026611  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10400962829589844  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.953380584716797  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10393428802490234  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.633389949798584  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10325193405151367  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.587316989898682  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03657940775156021 |0.012030549347400665 |0.2635270655155182 |9.073317050933838e-05 |0.429657444357872 |0.0053102970123291016 |
----------------------------------------------------------pseudo_mini_loss sum 1.8809373378753662
 Run 0| Epoch 7 |
Number of nodes for computation during this epoch:  8581747
Number of first layer input nodes during this epoch:  4657334
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.12014341354370117  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020404815673828125
random selection method range initialization spend 0.0053484439849853516
time for parepare:  0.020263195037841797
local_output_nid generation:  0.0013544559478759766
local_in_edges_tensor generation:  0.003953695297241211
mini_batch_src_global generation:  0.0015630722045898438
r_  generation:  0.015641450881958008
local_output_nid generation:  0.0026407241821289062
local_in_edges_tensor generation:  0.0012617111206054688
mini_batch_src_global generation:  0.0019087791442871094
r_  generation:  0.008738994598388672
local_output_nid generation:  0.002330780029296875
local_in_edges_tensor generation:  0.0011641979217529297
mini_batch_src_global generation:  0.0012357234954833984
r_  generation:  0.008359432220458984
local_output_nid generation:  0.0022716522216796875
local_in_edges_tensor generation:  0.001071929931640625
mini_batch_src_global generation:  0.0010445117950439453
r_  generation:  0.008117914199829102
local_output_nid generation:  0.002169370651245117
local_in_edges_tensor generation:  0.0010304450988769531
mini_batch_src_global generation:  0.0010139942169189453
r_  generation:  0.008135318756103516
local_output_nid generation:  0.0021653175354003906
local_in_edges_tensor generation:  0.0010459423065185547
mini_batch_src_global generation:  0.001043081283569336
r_  generation:  0.008532047271728516
local_output_nid generation:  0.0021209716796875
local_in_edges_tensor generation:  0.001016855239868164
mini_batch_src_global generation:  0.0009906291961669922
r_  generation:  0.008267402648925781
local_output_nid generation:  0.0021431446075439453
local_in_edges_tensor generation:  0.0009927749633789062
mini_batch_src_global generation:  0.0011675357818603516
r_  generation:  0.008363008499145508
local_output_nid generation:  0.0020935535430908203
local_in_edges_tensor generation:  0.0009925365447998047
mini_batch_src_global generation:  0.0010230541229248047
r_  generation:  0.019118547439575195
local_output_nid generation:  0.002871274948120117
local_in_edges_tensor generation:  0.0012085437774658203
mini_batch_src_global generation:  0.0013060569763183594
r_  generation:  0.008797645568847656
local_output_nid generation:  0.002148151397705078
local_in_edges_tensor generation:  0.0009744167327880859
mini_batch_src_global generation:  0.0011174678802490234
r_  generation:  0.008673906326293945
local_output_nid generation:  0.001993894577026367
local_in_edges_tensor generation:  0.0008780956268310547
mini_batch_src_global generation:  0.0010063648223876953
r_  generation:  0.008497238159179688
local_output_nid generation:  0.0019104480743408203
local_in_edges_tensor generation:  0.0009505748748779297
mini_batch_src_global generation:  0.0009553432464599609
r_  generation:  0.00812220573425293
local_output_nid generation:  0.0018706321716308594
local_in_edges_tensor generation:  0.0008647441864013672
mini_batch_src_global generation:  0.0009615421295166016
r_  generation:  0.008223295211791992
local_output_nid generation:  0.0018243789672851562
local_in_edges_tensor generation:  0.0008776187896728516
mini_batch_src_global generation:  0.0009176731109619141
r_  generation:  0.008457183837890625
local_output_nid generation:  0.0017886161804199219
local_in_edges_tensor generation:  0.0008492469787597656
mini_batch_src_global generation:  0.0008955001831054688
r_  generation:  0.008186101913452148
local_output_nid generation:  0.0017354488372802734
local_in_edges_tensor generation:  0.0008275508880615234
mini_batch_src_global generation:  0.0008969306945800781
r_  generation:  0.008308172225952148
local_output_nid generation:  0.0017163753509521484
local_in_edges_tensor generation:  0.000820159912109375
mini_batch_src_global generation:  0.0009317398071289062
r_  generation:  0.008449792861938477
local_output_nid generation:  0.001688241958618164
local_in_edges_tensor generation:  0.0007998943328857422
mini_batch_src_global generation:  0.0009138584136962891
r_  generation:  0.00844717025756836
local_output_nid generation:  0.001668691635131836
local_in_edges_tensor generation:  0.0008080005645751953
mini_batch_src_global generation:  0.0008857250213623047
r_  generation:  0.008337736129760742
local_output_nid generation:  0.0016214847564697266
local_in_edges_tensor generation:  0.0007793903350830078
mini_batch_src_global generation:  0.0008897781372070312
r_  generation:  0.008264780044555664
local_output_nid generation:  0.00160980224609375
local_in_edges_tensor generation:  0.0007958412170410156
mini_batch_src_global generation:  0.0008931159973144531
r_  generation:  0.008327960968017578
local_output_nid generation:  0.0016083717346191406
local_in_edges_tensor generation:  0.0007598400115966797
mini_batch_src_global generation:  0.0008783340454101562
r_  generation:  0.008222103118896484
local_output_nid generation:  0.0015740394592285156
local_in_edges_tensor generation:  0.0007688999176025391
mini_batch_src_global generation:  0.0008690357208251953
r_  generation:  0.008209466934204102
local_output_nid generation:  0.0015664100646972656
local_in_edges_tensor generation:  0.0008008480072021484
mini_batch_src_global generation:  0.0009744167327880859
r_  generation:  0.008574724197387695
local_output_nid generation:  0.001600027084350586
local_in_edges_tensor generation:  0.0007729530334472656
mini_batch_src_global generation:  0.0009019374847412109
r_  generation:  0.008371829986572266
local_output_nid generation:  0.001522064208984375
local_in_edges_tensor generation:  0.0007834434509277344
mini_batch_src_global generation:  0.0008704662322998047
r_  generation:  0.00834345817565918
local_output_nid generation:  0.0015201568603515625
local_in_edges_tensor generation:  0.00077056884765625
mini_batch_src_global generation:  0.0008745193481445312
r_  generation:  0.008180379867553711
local_output_nid generation:  0.0015177726745605469
local_in_edges_tensor generation:  0.0007767677307128906
mini_batch_src_global generation:  0.0010457038879394531
r_  generation:  0.008516073226928711
local_output_nid generation:  0.0014994144439697266
local_in_edges_tensor generation:  0.0007541179656982422
mini_batch_src_global generation:  0.0008924007415771484
r_  generation:  0.008205413818359375
local_output_nid generation:  0.0014882087707519531
local_in_edges_tensor generation:  0.0007886886596679688
mini_batch_src_global generation:  0.0010073184967041016
r_  generation:  0.008342981338500977
local_output_nid generation:  0.0014801025390625
local_in_edges_tensor generation:  0.0007531642913818359
mini_batch_src_global generation:  0.0008780956268310547
r_  generation:  0.008300304412841797
----------------------check_connections_block total spend ----------------------------- 0.5245273113250732
generate_one_block  0.019942045211791992
generate_one_block  0.017373323440551758
generate_one_block  0.015242815017700195
generate_one_block  0.014758586883544922
generate_one_block  0.014600753784179688
generate_one_block  0.014850616455078125
generate_one_block  0.014508962631225586
generate_one_block  0.01457524299621582
generate_one_block  0.014809370040893555
generate_one_block  0.01434016227722168
generate_one_block  0.014726400375366211
generate_one_block  0.014572858810424805
generate_one_block  0.014138460159301758
generate_one_block  0.014411211013793945
generate_one_block  0.014443635940551758
generate_one_block  0.01431417465209961
generate_one_block  0.014410257339477539
generate_one_block  0.014662504196166992
generate_one_block  0.014659643173217773
generate_one_block  0.014392614364624023
generate_one_block  0.014261245727539062
generate_one_block  0.014513015747070312
generate_one_block  0.01437830924987793
generate_one_block  0.01431584358215332
generate_one_block  0.014787912368774414
generate_one_block  0.014524221420288086
generate_one_block  0.014430999755859375
generate_one_block  0.01427006721496582
generate_one_block  0.014523506164550781
generate_one_block  0.014290809631347656
generate_one_block  0.014498233795166016
generate_one_block  0.01433563232421875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.039174556732177734
gen group dst list time:  0.021021127700805664
time for parepare:  0.021552324295043945
local_output_nid generation:  0.0053255558013916016
local_in_edges_tensor generation:  0.015764236450195312
mini_batch_src_global generation:  0.012548208236694336
r_  generation:  0.11742496490478516
local_output_nid generation:  0.007632732391357422
local_in_edges_tensor generation:  0.009487628936767578
mini_batch_src_global generation:  0.015365362167358398
r_  generation:  0.1276867389678955
local_output_nid generation:  0.007976055145263672
local_in_edges_tensor generation:  0.032419681549072266
mini_batch_src_global generation:  0.014837265014648438
r_  generation:  0.16606450080871582
local_output_nid generation:  0.012982845306396484
local_in_edges_tensor generation:  0.010364294052124023
mini_batch_src_global generation:  0.016993284225463867
r_  generation:  0.1483747959136963
local_output_nid generation:  0.01346445083618164
local_in_edges_tensor generation:  0.010470390319824219
mini_batch_src_global generation:  0.018096208572387695
r_  generation:  0.1536705493927002
local_output_nid generation:  0.014223814010620117
local_in_edges_tensor generation:  0.011179924011230469
mini_batch_src_global generation:  0.019884109497070312
r_  generation:  0.14116382598876953
local_output_nid generation:  0.009181976318359375
local_in_edges_tensor generation:  0.008616447448730469
mini_batch_src_global generation:  0.01592731475830078
r_  generation:  0.14040374755859375
local_output_nid generation:  0.0095062255859375
local_in_edges_tensor generation:  0.009029865264892578
mini_batch_src_global generation:  0.017038822174072266
r_  generation:  0.14090967178344727
local_output_nid generation:  0.008383750915527344
local_in_edges_tensor generation:  0.009487152099609375
mini_batch_src_global generation:  0.017441749572753906
r_  generation:  0.14162611961364746
local_output_nid generation:  0.008134841918945312
local_in_edges_tensor generation:  0.008295059204101562
mini_batch_src_global generation:  0.017384052276611328
r_  generation:  0.13921332359313965
local_output_nid generation:  0.00874018669128418
local_in_edges_tensor generation:  0.009888887405395508
mini_batch_src_global generation:  0.019204139709472656
r_  generation:  0.1434342861175537
local_output_nid generation:  0.011081457138061523
local_in_edges_tensor generation:  0.011677742004394531
mini_batch_src_global generation:  0.01658463478088379
r_  generation:  0.1382896900177002
local_output_nid generation:  0.010782480239868164
local_in_edges_tensor generation:  0.008777618408203125
mini_batch_src_global generation:  0.01598381996154785
r_  generation:  0.17736101150512695
local_output_nid generation:  0.008404016494750977
local_in_edges_tensor generation:  0.010335683822631836
mini_batch_src_global generation:  0.017733097076416016
r_  generation:  0.14853239059448242
local_output_nid generation:  0.011088371276855469
local_in_edges_tensor generation:  0.008176565170288086
mini_batch_src_global generation:  0.01627349853515625
r_  generation:  0.13893342018127441
local_output_nid generation:  0.008547067642211914
local_in_edges_tensor generation:  0.00817561149597168
mini_batch_src_global generation:  0.01737523078918457
r_  generation:  0.1377098560333252
local_output_nid generation:  0.008441925048828125
local_in_edges_tensor generation:  0.009122371673583984
mini_batch_src_global generation:  0.016543865203857422
r_  generation:  0.13982558250427246
local_output_nid generation:  0.008518218994140625
local_in_edges_tensor generation:  0.008578300476074219
mini_batch_src_global generation:  0.017809391021728516
r_  generation:  0.14115262031555176
local_output_nid generation:  0.00846242904663086
local_in_edges_tensor generation:  0.008215904235839844
mini_batch_src_global generation:  0.016951799392700195
r_  generation:  0.14223742485046387
local_output_nid generation:  0.008391141891479492
local_in_edges_tensor generation:  0.007418155670166016
mini_batch_src_global generation:  0.016841411590576172
r_  generation:  0.13680696487426758
local_output_nid generation:  0.008458852767944336
local_in_edges_tensor generation:  0.007523298263549805
mini_batch_src_global generation:  0.015957355499267578
r_  generation:  0.1368262767791748
local_output_nid generation:  0.008666038513183594
local_in_edges_tensor generation:  0.007632255554199219
mini_batch_src_global generation:  0.016603708267211914
r_  generation:  0.13782906532287598
local_output_nid generation:  0.00850677490234375
local_in_edges_tensor generation:  0.007539272308349609
mini_batch_src_global generation:  0.016215085983276367
r_  generation:  0.1358475685119629
local_output_nid generation:  0.00858926773071289
local_in_edges_tensor generation:  0.007580995559692383
mini_batch_src_global generation:  0.01686406135559082
r_  generation:  0.1382303237915039
local_output_nid generation:  0.008759260177612305
local_in_edges_tensor generation:  0.009892702102661133
mini_batch_src_global generation:  0.01674342155456543
r_  generation:  0.1437358856201172
local_output_nid generation:  0.008531332015991211
local_in_edges_tensor generation:  0.008240222930908203
mini_batch_src_global generation:  0.016911029815673828
r_  generation:  0.13995742797851562
local_output_nid generation:  0.008617162704467773
local_in_edges_tensor generation:  0.007559537887573242
mini_batch_src_global generation:  0.016677141189575195
r_  generation:  0.13956737518310547
local_output_nid generation:  0.00849151611328125
local_in_edges_tensor generation:  0.0073621273040771484
mini_batch_src_global generation:  0.018129587173461914
r_  generation:  0.18533968925476074
local_output_nid generation:  0.008546113967895508
local_in_edges_tensor generation:  0.00905156135559082
mini_batch_src_global generation:  0.016245603561401367
r_  generation:  0.14707279205322266
local_output_nid generation:  0.008665084838867188
local_in_edges_tensor generation:  0.007977962493896484
mini_batch_src_global generation:  0.01647782325744629
r_  generation:  0.14383220672607422
local_output_nid generation:  0.009613990783691406
local_in_edges_tensor generation:  0.009169816970825195
mini_batch_src_global generation:  0.017798662185668945
r_  generation:  0.19330692291259766
local_output_nid generation:  0.008369684219360352
local_in_edges_tensor generation:  0.0079193115234375
mini_batch_src_global generation:  0.017036914825439453
r_  generation:  0.13948345184326172
----------------------check_connections_block total spend ----------------------------- 6.865842819213867
generate_one_block  0.1825852394104004
generate_one_block  0.17192411422729492
generate_one_block  0.17761564254760742
generate_one_block  0.17237305641174316
generate_one_block  0.1907343864440918
generate_one_block  0.181884765625
generate_one_block  0.17299270629882812
generate_one_block  0.17989683151245117
generate_one_block  0.18244433403015137
generate_one_block  0.17856979370117188
generate_one_block  0.1801595687866211
generate_one_block  0.17333650588989258
generate_one_block  0.1693570613861084
generate_one_block  0.18001508712768555
generate_one_block  0.17585301399230957
generate_one_block  0.1764974594116211
generate_one_block  0.17757320404052734
generate_one_block  0.18065190315246582
generate_one_block  0.1837306022644043
generate_one_block  0.2067718505859375
generate_one_block  0.1752183437347412
generate_one_block  0.18311381340026855
generate_one_block  0.17484307289123535
generate_one_block  0.18102693557739258
generate_one_block  0.1871492862701416
generate_one_block  0.18655967712402344
generate_one_block  0.17657256126403809
generate_one_block  0.1714920997619629
generate_one_block  0.17863059043884277
generate_one_block  0.1762220859527588
generate_one_block  0.17953896522521973
generate_one_block  0.1763296127319336
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03364968299865723
gen group dst list time:  0.10413408279418945
time for parepare:  0.020659208297729492
local_output_nid generation:  0.023004770278930664
local_in_edges_tensor generation:  0.04704546928405762
mini_batch_src_global generation:  0.03597688674926758
r_  generation:  0.38531923294067383
local_output_nid generation:  0.028828144073486328
local_in_edges_tensor generation:  0.032389163970947266
mini_batch_src_global generation:  0.04846906661987305
r_  generation:  0.39426732063293457
local_output_nid generation:  0.028836965560913086
local_in_edges_tensor generation:  0.032073974609375
mini_batch_src_global generation:  0.04748964309692383
r_  generation:  0.4084343910217285
local_output_nid generation:  0.028640031814575195
local_in_edges_tensor generation:  0.024742603302001953
mini_batch_src_global generation:  0.04801154136657715
r_  generation:  0.39435887336730957
local_output_nid generation:  0.03191208839416504
local_in_edges_tensor generation:  0.03290748596191406
mini_batch_src_global generation:  0.04808163642883301
r_  generation:  0.4113790988922119
local_output_nid generation:  0.030113935470581055
local_in_edges_tensor generation:  0.030135393142700195
mini_batch_src_global generation:  0.048161983489990234
r_  generation:  0.4040074348449707
local_output_nid generation:  0.027106523513793945
local_in_edges_tensor generation:  0.028327465057373047
mini_batch_src_global generation:  0.047049522399902344
r_  generation:  0.4048910140991211
local_output_nid generation:  0.026903152465820312
local_in_edges_tensor generation:  0.029439687728881836
mini_batch_src_global generation:  0.04961967468261719
r_  generation:  0.3996717929840088
local_output_nid generation:  0.02741384506225586
local_in_edges_tensor generation:  0.030426502227783203
mini_batch_src_global generation:  0.049027442932128906
r_  generation:  0.4082198143005371
local_output_nid generation:  0.027088642120361328
local_in_edges_tensor generation:  0.026048660278320312
mini_batch_src_global generation:  0.0480649471282959
r_  generation:  0.3986999988555908
local_output_nid generation:  0.02732706069946289
local_in_edges_tensor generation:  0.02604079246520996
mini_batch_src_global generation:  0.04657340049743652
r_  generation:  0.4112846851348877
local_output_nid generation:  0.02708578109741211
local_in_edges_tensor generation:  0.028118133544921875
mini_batch_src_global generation:  0.0567779541015625
r_  generation:  0.40725231170654297
local_output_nid generation:  0.02884197235107422
local_in_edges_tensor generation:  0.027811050415039062
mini_batch_src_global generation:  0.04611682891845703
r_  generation:  0.403914213180542
local_output_nid generation:  0.02762770652770996
local_in_edges_tensor generation:  0.025550127029418945
mini_batch_src_global generation:  0.04786801338195801
r_  generation:  0.398831844329834
local_output_nid generation:  0.02805018424987793
local_in_edges_tensor generation:  0.025191307067871094
mini_batch_src_global generation:  0.048282623291015625
r_  generation:  0.4063987731933594
local_output_nid generation:  0.02765059471130371
local_in_edges_tensor generation:  0.02523636817932129
mini_batch_src_global generation:  0.047794342041015625
r_  generation:  0.4012870788574219
local_output_nid generation:  0.02774810791015625
local_in_edges_tensor generation:  0.02772998809814453
mini_batch_src_global generation:  0.04798531532287598
r_  generation:  0.4117751121520996
local_output_nid generation:  0.027762413024902344
local_in_edges_tensor generation:  0.02674126625061035
mini_batch_src_global generation:  0.047664642333984375
r_  generation:  0.40318799018859863
local_output_nid generation:  0.028128385543823242
local_in_edges_tensor generation:  0.03097844123840332
mini_batch_src_global generation:  0.04784679412841797
r_  generation:  0.40926694869995117
local_output_nid generation:  0.02794170379638672
local_in_edges_tensor generation:  0.027651071548461914
mini_batch_src_global generation:  0.04771757125854492
r_  generation:  0.39872169494628906
local_output_nid generation:  0.027609586715698242
local_in_edges_tensor generation:  0.025167465209960938
mini_batch_src_global generation:  0.0465693473815918
r_  generation:  0.40386533737182617
local_output_nid generation:  0.028433799743652344
local_in_edges_tensor generation:  0.0259244441986084
mini_batch_src_global generation:  0.04732990264892578
r_  generation:  0.40297794342041016
local_output_nid generation:  0.027683019638061523
local_in_edges_tensor generation:  0.029103517532348633
mini_batch_src_global generation:  0.046076059341430664
r_  generation:  0.405472993850708
local_output_nid generation:  0.029992341995239258
local_in_edges_tensor generation:  0.03558087348937988
mini_batch_src_global generation:  0.047878265380859375
r_  generation:  0.40563440322875977
local_output_nid generation:  0.02860403060913086
local_in_edges_tensor generation:  0.03173470497131348
mini_batch_src_global generation:  0.0469670295715332
r_  generation:  0.411712646484375
local_output_nid generation:  0.029307842254638672
local_in_edges_tensor generation:  0.024860858917236328
mini_batch_src_global generation:  0.04941582679748535
r_  generation:  0.40291452407836914
local_output_nid generation:  0.0277252197265625
local_in_edges_tensor generation:  0.02713179588317871
mini_batch_src_global generation:  0.04844069480895996
r_  generation:  0.4082505702972412
local_output_nid generation:  0.027584314346313477
local_in_edges_tensor generation:  0.02855062484741211
mini_batch_src_global generation:  0.046930789947509766
r_  generation:  0.4055759906768799
local_output_nid generation:  0.02794957160949707
local_in_edges_tensor generation:  0.02477741241455078
mini_batch_src_global generation:  0.04773116111755371
r_  generation:  0.4054677486419678
local_output_nid generation:  0.027819395065307617
local_in_edges_tensor generation:  0.025116920471191406
mini_batch_src_global generation:  0.05003833770751953
r_  generation:  0.40097951889038086
local_output_nid generation:  0.02781224250793457
local_in_edges_tensor generation:  0.02875685691833496
mini_batch_src_global generation:  0.047013282775878906
r_  generation:  0.4097719192504883
local_output_nid generation:  0.027833938598632812
local_in_edges_tensor generation:  0.026902198791503906
mini_batch_src_global generation:  0.05999493598937988
r_  generation:  0.4092872142791748
----------------------check_connections_block total spend ----------------------------- 19.186400890350342
generate_one_block  0.5367059707641602
generate_one_block  0.5267765522003174
generate_one_block  0.5331337451934814
generate_one_block  0.5212440490722656
generate_one_block  0.73386549949646
generate_one_block  0.5376734733581543
generate_one_block  0.5328400135040283
generate_one_block  0.5423572063446045
generate_one_block  0.5526385307312012
generate_one_block  0.535433292388916
generate_one_block  0.5376214981079102
generate_one_block  0.5321455001831055
generate_one_block  0.5314557552337646
generate_one_block  0.5329689979553223
generate_one_block  0.5556004047393799
generate_one_block  0.5397617816925049
generate_one_block  0.5427494049072266
generate_one_block  0.5444068908691406
generate_one_block  0.5443334579467773
generate_one_block  0.5324029922485352
generate_one_block  0.5313997268676758
generate_one_block  0.5341012477874756
generate_one_block  0.5323197841644287
generate_one_block  0.5395140647888184
generate_one_block  0.5536534786224365
generate_one_block  0.534325361251831
generate_one_block  0.5292994976043701
generate_one_block  0.5255565643310547
generate_one_block  0.5313205718994141
generate_one_block  0.5389442443847656
generate_one_block  0.539741039276123
generate_one_block  0.5389337539672852
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.12014341354370117  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

connection checking time:  26.05224370956421
block generation total time  23.116888523101807
average batch blocks generation time:  0.7224027663469315
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10374879837036133  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.392177104949951  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10286855697631836  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.526994705200195  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1050105094909668  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.82236099243164  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10275077819824219  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.491795063018799  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1049952507019043  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.767058849334717  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10386419296264648  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.8115873336792  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10269546508789062  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.442445755004883  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10401773452758789  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.894157409667969  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10504579544067383  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.02937602996826  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10287618637084961  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.716500759124756  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10503053665161133  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.93370532989502  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10299348831176758  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.54468822479248  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10385704040527344  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.436923503875732  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10302400588989258  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.742747783660889  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10397911071777344  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.645774364471436  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1031794548034668  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.71396017074585  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10390710830688477  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.769161224365234  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1038355827331543  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.963637828826904  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1050577163696289  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.058282375335693  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10305070877075195  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.532042980194092  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10282325744628906  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.557404041290283  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10309267044067383  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.778363227844238  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10382461547851562  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.455252170562744  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1041269302368164  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.806793689727783  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10505962371826172  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.031121730804443  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10412979125976562  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.824341773986816  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10298919677734375  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.672456741333008  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10275840759277344  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.462735176086426  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10292577743530273  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.745535373687744  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10301399230957031  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.728169918060303  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10502099990844727  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.840428352355957  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10296154022216797  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.73075246810913  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03356879949569702 |0.010993048548698425 |0.26393973082304 |9.050220251083374e-05 |0.4286549761891365 |0.005688905715942383 |
----------------------------------------------------------pseudo_mini_loss sum 1.791883111000061
 Run 0| Epoch 8 |
Number of nodes for computation during this epoch:  8579645
Number of first layer input nodes during this epoch:  4655874
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.12007474899291992  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024359941482543945
random selection method range initialization spend 0.006673574447631836
time for parepare:  0.021235227584838867
local_output_nid generation:  0.001356363296508789
local_in_edges_tensor generation:  0.00424647331237793
mini_batch_src_global generation:  0.003312349319458008
r_  generation:  0.011033058166503906
local_output_nid generation:  0.0024461746215820312
local_in_edges_tensor generation:  0.0012004375457763672
mini_batch_src_global generation:  0.0020072460174560547
r_  generation:  0.008427619934082031
local_output_nid generation:  0.0023055076599121094
local_in_edges_tensor generation:  0.0011277198791503906
mini_batch_src_global generation:  0.001238107681274414
r_  generation:  0.008157968521118164
local_output_nid generation:  0.0022296905517578125
local_in_edges_tensor generation:  0.0011060237884521484
mini_batch_src_global generation:  0.0011742115020751953
r_  generation:  0.008417367935180664
local_output_nid generation:  0.002151012420654297
local_in_edges_tensor generation:  0.0010423660278320312
mini_batch_src_global generation:  0.0011324882507324219
r_  generation:  0.0081024169921875
local_output_nid generation:  0.0021452903747558594
local_in_edges_tensor generation:  0.001064300537109375
mini_batch_src_global generation:  0.0011210441589355469
r_  generation:  0.008440256118774414
local_output_nid generation:  0.002083301544189453
local_in_edges_tensor generation:  0.0010235309600830078
mini_batch_src_global generation:  0.0011234283447265625
r_  generation:  0.00832223892211914
local_output_nid generation:  0.0021004676818847656
local_in_edges_tensor generation:  0.001062631607055664
mini_batch_src_global generation:  0.0010645389556884766
r_  generation:  0.008150577545166016
local_output_nid generation:  0.002093076705932617
local_in_edges_tensor generation:  0.0010237693786621094
mini_batch_src_global generation:  0.0010819435119628906
r_  generation:  0.008435487747192383
local_output_nid generation:  0.002117156982421875
local_in_edges_tensor generation:  0.0010755062103271484
mini_batch_src_global generation:  0.0010974407196044922
r_  generation:  0.008456707000732422
local_output_nid generation:  0.002101421356201172
local_in_edges_tensor generation:  0.003763437271118164
mini_batch_src_global generation:  0.0011675357818603516
r_  generation:  0.008368968963623047
local_output_nid generation:  0.002135753631591797
local_in_edges_tensor generation:  0.0010175704956054688
mini_batch_src_global generation:  0.0010769367218017578
r_  generation:  0.008392095565795898
local_output_nid generation:  0.002122163772583008
local_in_edges_tensor generation:  0.001089334487915039
mini_batch_src_global generation:  0.0010979175567626953
r_  generation:  0.008351802825927734
local_output_nid generation:  0.0020949840545654297
local_in_edges_tensor generation:  0.0010192394256591797
mini_batch_src_global generation:  0.0010693073272705078
r_  generation:  0.008625268936157227
local_output_nid generation:  0.0037965774536132812
local_in_edges_tensor generation:  0.0017669200897216797
mini_batch_src_global generation:  0.003099679946899414
r_  generation:  0.01218724250793457
local_output_nid generation:  0.0023632049560546875
local_in_edges_tensor generation:  0.0010733604431152344
mini_batch_src_global generation:  0.001348257064819336
r_  generation:  0.008601665496826172
local_output_nid generation:  0.0021386146545410156
local_in_edges_tensor generation:  0.003511667251586914
mini_batch_src_global generation:  0.0014667510986328125
r_  generation:  0.0087890625
local_output_nid generation:  0.0022089481353759766
local_in_edges_tensor generation:  0.0011103153228759766
mini_batch_src_global generation:  0.001056671142578125
r_  generation:  0.00856637954711914
local_output_nid generation:  0.0019979476928710938
local_in_edges_tensor generation:  0.0009405612945556641
mini_batch_src_global generation:  0.0009770393371582031
r_  generation:  0.00831747055053711
local_output_nid generation:  0.0019321441650390625
local_in_edges_tensor generation:  0.0009465217590332031
mini_batch_src_global generation:  0.0009479522705078125
r_  generation:  0.008135557174682617
local_output_nid generation:  0.0018610954284667969
local_in_edges_tensor generation:  0.0008909702301025391
mini_batch_src_global generation:  0.0009343624114990234
r_  generation:  0.008531570434570312
local_output_nid generation:  0.0018305778503417969
local_in_edges_tensor generation:  0.0010027885437011719
mini_batch_src_global generation:  0.0009512901306152344
r_  generation:  0.008469581604003906
local_output_nid generation:  0.0017933845520019531
local_in_edges_tensor generation:  0.0009005069732666016
mini_batch_src_global generation:  0.0009131431579589844
r_  generation:  0.008450031280517578
local_output_nid generation:  0.0017507076263427734
local_in_edges_tensor generation:  0.0036263465881347656
mini_batch_src_global generation:  0.0010104179382324219
r_  generation:  0.008531808853149414
local_output_nid generation:  0.0017452239990234375
local_in_edges_tensor generation:  0.0008828639984130859
mini_batch_src_global generation:  0.0009529590606689453
r_  generation:  0.00856781005859375
local_output_nid generation:  0.0016870498657226562
local_in_edges_tensor generation:  0.0009107589721679688
mini_batch_src_global generation:  0.0008997917175292969
r_  generation:  0.008136272430419922
local_output_nid generation:  0.001680135726928711
local_in_edges_tensor generation:  0.0008358955383300781
mini_batch_src_global generation:  0.0009000301361083984
r_  generation:  0.008330345153808594
local_output_nid generation:  0.0016498565673828125
local_in_edges_tensor generation:  0.0008652210235595703
mini_batch_src_global generation:  0.0009000301361083984
r_  generation:  0.008183956146240234
local_output_nid generation:  0.001619100570678711
local_in_edges_tensor generation:  0.0008409023284912109
mini_batch_src_global generation:  0.0009007453918457031
r_  generation:  0.008301019668579102
local_output_nid generation:  0.001622915267944336
local_in_edges_tensor generation:  0.0009453296661376953
mini_batch_src_global generation:  0.0009250640869140625
r_  generation:  0.00808262825012207
local_output_nid generation:  0.0016031265258789062
local_in_edges_tensor generation:  0.0008215904235839844
mini_batch_src_global generation:  0.0009109973907470703
r_  generation:  0.010654687881469727
local_output_nid generation:  0.002140522003173828
local_in_edges_tensor generation:  0.0009407997131347656
mini_batch_src_global generation:  0.0009407997131347656
r_  generation:  0.00847315788269043
----------------------check_connections_block total spend ----------------------------- 0.5488235950469971
generate_one_block  0.022795677185058594
generate_one_block  0.017920732498168945
generate_one_block  0.015244722366333008
generate_one_block  0.015269279479980469
generate_one_block  0.016350746154785156
generate_one_block  0.014726400375366211
generate_one_block  0.014436721801757812
generate_one_block  0.014412879943847656
generate_one_block  0.014809846878051758
generate_one_block  0.014850139617919922
generate_one_block  0.014440774917602539
generate_one_block  0.016651391983032227
generate_one_block  0.014935970306396484
generate_one_block  0.014979124069213867
generate_one_block  0.014826774597167969
generate_one_block  0.014683008193969727
generate_one_block  0.014681339263916016
generate_one_block  0.01483154296875
generate_one_block  0.016180753707885742
generate_one_block  0.014313220977783203
generate_one_block  0.014890909194946289
generate_one_block  0.014755725860595703
generate_one_block  0.014816761016845703
generate_one_block  0.014545679092407227
generate_one_block  0.014843940734863281
generate_one_block  0.015939950942993164
generate_one_block  0.014549493789672852
generate_one_block  0.014418840408325195
generate_one_block  0.014236927032470703
generate_one_block  0.014008522033691406
generate_one_block  0.014636039733886719
generate_one_block  0.014809846878051758
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03745079040527344
gen group dst list time:  0.02423262596130371
time for parepare:  0.022614240646362305
local_output_nid generation:  0.005677938461303711
local_in_edges_tensor generation:  0.016158580780029297
mini_batch_src_global generation:  0.02022719383239746
r_  generation:  0.12507271766662598
local_output_nid generation:  0.00906515121459961
local_in_edges_tensor generation:  0.009658098220825195
mini_batch_src_global generation:  0.01788949966430664
r_  generation:  0.158095121383667
local_output_nid generation:  0.008464336395263672
local_in_edges_tensor generation:  0.0334012508392334
mini_batch_src_global generation:  0.01680922508239746
r_  generation:  0.1309192180633545
local_output_nid generation:  0.008428573608398438
local_in_edges_tensor generation:  0.008111238479614258
mini_batch_src_global generation:  0.01777362823486328
r_  generation:  0.13459229469299316
local_output_nid generation:  0.008191585540771484
local_in_edges_tensor generation:  0.007336854934692383
mini_batch_src_global generation:  0.026926279067993164
r_  generation:  0.14926576614379883
local_output_nid generation:  0.00980997085571289
local_in_edges_tensor generation:  0.008104085922241211
mini_batch_src_global generation:  0.02902817726135254
r_  generation:  0.13885712623596191
local_output_nid generation:  0.00847935676574707
local_in_edges_tensor generation:  0.007622480392456055
mini_batch_src_global generation:  0.018259286880493164
r_  generation:  0.13426971435546875
local_output_nid generation:  0.007969141006469727
local_in_edges_tensor generation:  0.009016752243041992
mini_batch_src_global generation:  0.026684045791625977
r_  generation:  0.16588592529296875
local_output_nid generation:  0.008834123611450195
local_in_edges_tensor generation:  0.007861614227294922
mini_batch_src_global generation:  0.03386688232421875
r_  generation:  0.1395261287689209
local_output_nid generation:  0.00838780403137207
local_in_edges_tensor generation:  0.009810447692871094
mini_batch_src_global generation:  0.019030332565307617
r_  generation:  0.13939142227172852
local_output_nid generation:  0.00843358039855957
local_in_edges_tensor generation:  0.007390022277832031
mini_batch_src_global generation:  0.025444746017456055
r_  generation:  0.1538996696472168
local_output_nid generation:  0.013050556182861328
local_in_edges_tensor generation:  0.010304450988769531
mini_batch_src_global generation:  0.01896381378173828
r_  generation:  0.15980195999145508
local_output_nid generation:  0.014673948287963867
local_in_edges_tensor generation:  0.010501384735107422
mini_batch_src_global generation:  0.0364224910736084
r_  generation:  0.1423337459564209
local_output_nid generation:  0.009476661682128906
local_in_edges_tensor generation:  0.008601188659667969
mini_batch_src_global generation:  0.021758556365966797
r_  generation:  0.14334893226623535
local_output_nid generation:  0.008941650390625
local_in_edges_tensor generation:  0.00842142105102539
mini_batch_src_global generation:  0.01960444450378418
r_  generation:  0.14412999153137207
local_output_nid generation:  0.008485794067382812
local_in_edges_tensor generation:  0.007546901702880859
mini_batch_src_global generation:  0.01909804344177246
r_  generation:  0.13875102996826172
local_output_nid generation:  0.008501052856445312
local_in_edges_tensor generation:  0.007489919662475586
mini_batch_src_global generation:  0.016443252563476562
r_  generation:  0.13746404647827148
local_output_nid generation:  0.008435249328613281
local_in_edges_tensor generation:  0.009340047836303711
mini_batch_src_global generation:  0.028656721115112305
r_  generation:  0.16255712509155273
local_output_nid generation:  0.012928009033203125
local_in_edges_tensor generation:  0.010016918182373047
mini_batch_src_global generation:  0.020213842391967773
r_  generation:  0.15716242790222168
local_output_nid generation:  0.013117074966430664
local_in_edges_tensor generation:  0.010397195816040039
mini_batch_src_global generation:  0.019822359085083008
r_  generation:  0.16029667854309082
local_output_nid generation:  0.01354527473449707
local_in_edges_tensor generation:  0.011275768280029297
mini_batch_src_global generation:  0.01998305320739746
r_  generation:  0.14817476272583008
local_output_nid generation:  0.011059045791625977
local_in_edges_tensor generation:  0.01010894775390625
mini_batch_src_global generation:  0.02701878547668457
r_  generation:  0.1750349998474121
local_output_nid generation:  0.00945138931274414
local_in_edges_tensor generation:  0.008298873901367188
mini_batch_src_global generation:  0.017987728118896484
r_  generation:  0.14472222328186035
local_output_nid generation:  0.008807897567749023
local_in_edges_tensor generation:  0.007737874984741211
mini_batch_src_global generation:  0.016958951950073242
r_  generation:  0.141524076461792
local_output_nid generation:  0.008624553680419922
local_in_edges_tensor generation:  0.008139371871948242
mini_batch_src_global generation:  0.01708674430847168
r_  generation:  0.14664268493652344
local_output_nid generation:  0.008293390274047852
local_in_edges_tensor generation:  0.007977485656738281
mini_batch_src_global generation:  0.02057361602783203
r_  generation:  0.13960528373718262
local_output_nid generation:  0.008351564407348633
local_in_edges_tensor generation:  0.010703325271606445
mini_batch_src_global generation:  0.017220020294189453
r_  generation:  0.14105772972106934
local_output_nid generation:  0.008235931396484375
local_in_edges_tensor generation:  0.007928848266601562
mini_batch_src_global generation:  0.027471303939819336
r_  generation:  0.1574392318725586
local_output_nid generation:  0.011407136917114258
local_in_edges_tensor generation:  0.008190631866455078
mini_batch_src_global generation:  0.02353072166442871
r_  generation:  0.14030814170837402
local_output_nid generation:  0.008261680603027344
local_in_edges_tensor generation:  0.007281303405761719
mini_batch_src_global generation:  0.01666092872619629
r_  generation:  0.13552093505859375
local_output_nid generation:  0.00849771499633789
local_in_edges_tensor generation:  0.007550716400146484
mini_batch_src_global generation:  0.01766657829284668
r_  generation:  0.14370155334472656
local_output_nid generation:  0.008431434631347656
local_in_edges_tensor generation:  0.007972002029418945
mini_batch_src_global generation:  0.016997575759887695
r_  generation:  0.14360499382019043
----------------------check_connections_block total spend ----------------------------- 7.120736598968506
generate_one_block  0.18076372146606445
generate_one_block  0.1717231273651123
generate_one_block  0.17272734642028809
generate_one_block  0.17808246612548828
generate_one_block  0.20486688613891602
generate_one_block  0.19958209991455078
generate_one_block  0.17895793914794922
generate_one_block  0.17005300521850586
generate_one_block  0.17727327346801758
generate_one_block  0.17800045013427734
generate_one_block  0.1688249111175537
generate_one_block  0.17412710189819336
generate_one_block  0.17554974555969238
generate_one_block  0.17900896072387695
generate_one_block  0.18172740936279297
generate_one_block  0.17494726181030273
generate_one_block  0.17416930198669434
generate_one_block  0.18123316764831543
generate_one_block  0.17878127098083496
generate_one_block  0.18361616134643555
generate_one_block  0.18065357208251953
generate_one_block  0.19074416160583496
generate_one_block  0.18233442306518555
generate_one_block  0.17767119407653809
generate_one_block  0.17905235290527344
generate_one_block  0.17185330390930176
generate_one_block  0.1762080192565918
generate_one_block  0.17631316184997559
generate_one_block  0.174483060836792
generate_one_block  0.16906952857971191
generate_one_block  0.18149495124816895
generate_one_block  0.18096327781677246
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03728771209716797
gen group dst list time:  0.1193552017211914
time for parepare:  0.020992279052734375
local_output_nid generation:  0.023163318634033203
local_in_edges_tensor generation:  0.04372000694274902
mini_batch_src_global generation:  0.03637242317199707
r_  generation:  0.41022610664367676
local_output_nid generation:  0.028969287872314453
local_in_edges_tensor generation:  0.03333091735839844
mini_batch_src_global generation:  0.04845142364501953
r_  generation:  0.40010952949523926
local_output_nid generation:  0.029825448989868164
local_in_edges_tensor generation:  0.028649330139160156
mini_batch_src_global generation:  0.04596400260925293
r_  generation:  0.4102609157562256
local_output_nid generation:  0.029141664505004883
local_in_edges_tensor generation:  0.035257577896118164
mini_batch_src_global generation:  0.05055880546569824
r_  generation:  0.41889429092407227
local_output_nid generation:  0.032021522521972656
local_in_edges_tensor generation:  0.030388355255126953
mini_batch_src_global generation:  0.048715829849243164
r_  generation:  0.4209866523742676
local_output_nid generation:  0.030056476593017578
local_in_edges_tensor generation:  0.02867722511291504
mini_batch_src_global generation:  0.04781198501586914
r_  generation:  0.39752197265625
local_output_nid generation:  0.030325889587402344
local_in_edges_tensor generation:  0.02433609962463379
mini_batch_src_global generation:  0.04688525199890137
r_  generation:  0.40313267707824707
local_output_nid generation:  0.02765798568725586
local_in_edges_tensor generation:  0.02493572235107422
mini_batch_src_global generation:  0.04748940467834473
r_  generation:  0.39338088035583496
local_output_nid generation:  0.027735233306884766
local_in_edges_tensor generation:  0.027933120727539062
mini_batch_src_global generation:  0.0482790470123291
r_  generation:  0.4118337631225586
local_output_nid generation:  0.028496980667114258
local_in_edges_tensor generation:  0.03243565559387207
mini_batch_src_global generation:  0.04890894889831543
r_  generation:  0.402726411819458
local_output_nid generation:  0.027611970901489258
local_in_edges_tensor generation:  0.025252580642700195
mini_batch_src_global generation:  0.04635882377624512
r_  generation:  0.4006979465484619
local_output_nid generation:  0.027624130249023438
local_in_edges_tensor generation:  0.026102304458618164
mini_batch_src_global generation:  0.0478518009185791
r_  generation:  0.3984971046447754
local_output_nid generation:  0.02774953842163086
local_in_edges_tensor generation:  0.024942398071289062
mini_batch_src_global generation:  0.04608774185180664
r_  generation:  0.41153573989868164
local_output_nid generation:  0.029812335968017578
local_in_edges_tensor generation:  0.027025461196899414
mini_batch_src_global generation:  0.05214381217956543
r_  generation:  0.40521812438964844
local_output_nid generation:  0.03029632568359375
local_in_edges_tensor generation:  0.029109477996826172
mini_batch_src_global generation:  0.04651451110839844
r_  generation:  0.42128992080688477
local_output_nid generation:  0.028124094009399414
local_in_edges_tensor generation:  0.037220001220703125
mini_batch_src_global generation:  0.048142433166503906
r_  generation:  0.40509748458862305
local_output_nid generation:  0.02762436866760254
local_in_edges_tensor generation:  0.031897783279418945
mini_batch_src_global generation:  0.04645943641662598
r_  generation:  0.40659189224243164
local_output_nid generation:  0.028004884719848633
local_in_edges_tensor generation:  0.027129173278808594
mini_batch_src_global generation:  0.061966657638549805
r_  generation:  0.4054141044616699
local_output_nid generation:  0.028970956802368164
local_in_edges_tensor generation:  0.02956557273864746
mini_batch_src_global generation:  0.047226905822753906
r_  generation:  0.4054858684539795
local_output_nid generation:  0.027707576751708984
local_in_edges_tensor generation:  0.027177810668945312
mini_batch_src_global generation:  0.048333168029785156
r_  generation:  0.3979337215423584
local_output_nid generation:  0.027936935424804688
local_in_edges_tensor generation:  0.027485132217407227
mini_batch_src_global generation:  0.046950578689575195
r_  generation:  0.4072840213775635
local_output_nid generation:  0.027838945388793945
local_in_edges_tensor generation:  0.03076028823852539
mini_batch_src_global generation:  0.04862093925476074
r_  generation:  0.4016435146331787
local_output_nid generation:  0.02817702293395996
local_in_edges_tensor generation:  0.026477336883544922
mini_batch_src_global generation:  0.04661917686462402
r_  generation:  0.4074857234954834
local_output_nid generation:  0.02781820297241211
local_in_edges_tensor generation:  0.027351856231689453
mini_batch_src_global generation:  0.04819512367248535
r_  generation:  0.39943861961364746
local_output_nid generation:  0.027960777282714844
local_in_edges_tensor generation:  0.025715112686157227
mini_batch_src_global generation:  0.046395301818847656
r_  generation:  0.4071080684661865
local_output_nid generation:  0.027720212936401367
local_in_edges_tensor generation:  0.02672576904296875
mini_batch_src_global generation:  0.04763293266296387
r_  generation:  0.39542484283447266
local_output_nid generation:  0.027750253677368164
local_in_edges_tensor generation:  0.0250089168548584
mini_batch_src_global generation:  0.04597926139831543
r_  generation:  0.40610551834106445
local_output_nid generation:  0.02787017822265625
local_in_edges_tensor generation:  0.027933597564697266
mini_batch_src_global generation:  0.04789543151855469
r_  generation:  0.42044854164123535
local_output_nid generation:  0.027378320693969727
local_in_edges_tensor generation:  0.025890350341796875
mini_batch_src_global generation:  0.046504974365234375
r_  generation:  0.4068603515625
local_output_nid generation:  0.027336597442626953
local_in_edges_tensor generation:  0.02935338020324707
mini_batch_src_global generation:  0.04822278022766113
r_  generation:  0.4002077579498291
local_output_nid generation:  0.02802896499633789
local_in_edges_tensor generation:  0.025385379791259766
mini_batch_src_global generation:  0.046179771423339844
r_  generation:  0.41294121742248535
local_output_nid generation:  0.027982711791992188
local_in_edges_tensor generation:  0.028494596481323242
mini_batch_src_global generation:  0.047574758529663086
r_  generation:  0.40613555908203125
----------------------check_connections_block total spend ----------------------------- 19.225014448165894
generate_one_block  0.5375208854675293
generate_one_block  0.5290629863739014
generate_one_block  0.5359487533569336
generate_one_block  0.5380880832672119
generate_one_block  0.6391432285308838
generate_one_block  0.5381324291229248
generate_one_block  0.538316011428833
generate_one_block  0.54036545753479
generate_one_block  0.5379073619842529
generate_one_block  0.5361437797546387
generate_one_block  0.5230238437652588
generate_one_block  0.5259292125701904
generate_one_block  0.5367288589477539
generate_one_block  0.5382490158081055
generate_one_block  0.5457479953765869
generate_one_block  0.5522511005401611
generate_one_block  0.524632453918457
generate_one_block  0.5417509078979492
generate_one_block  0.5368101596832275
generate_one_block  0.5334982872009277
generate_one_block  0.5391430854797363
generate_one_block  0.5443806648254395
generate_one_block  0.5399534702301025
generate_one_block  0.5334537029266357
generate_one_block  0.549025297164917
generate_one_block  0.5260250568389893
generate_one_block  0.5306220054626465
generate_one_block  0.537214994430542
generate_one_block  0.5362734794616699
generate_one_block  0.5346255302429199
generate_one_block  0.5460491180419922
generate_one_block  0.5390300750732422
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.12007474899291992  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

connection checking time:  26.3457510471344
block generation total time  23.00990390777588
average batch blocks generation time:  0.7190594971179962
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10271501541137695  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.460795879364014  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10297250747680664  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.495545864105225  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10286951065063477  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.673939228057861  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10293197631835938  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.736137390136719  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10393238067626953  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.613385200500488  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10259723663330078  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.750061511993408  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10271596908569336  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.52670955657959  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10279130935668945  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.36851692199707  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.105010986328125  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.835659503936768  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10307598114013672  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.746577739715576  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10373497009277344  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.352815628051758  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10295772552490234  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.574525833129883  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10392475128173828  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.614526748657227  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10299301147460938  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.831954002380371  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10503816604614258  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.00905990600586  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1041264533996582  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.75356912612915  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10274648666381836  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.606967449188232  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10410356521606445  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.985966205596924  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10498905181884766  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.764139652252197  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10286855697631836  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.801929473876953  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10502433776855469  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.876349925994873  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10390472412109375  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.057658672332764  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10505056381225586  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.007004261016846  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10388422012329102  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.89603042602539  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10503292083740234  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.885079860687256  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1029353141784668  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.40626573562622  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10294675827026367  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.689718246459961  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1030120849609375  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.69307565689087  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10287141799926758  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.60773515701294  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10232973098754883  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.35244083404541  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10503387451171875  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.956700801849365  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10406637191772461  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.87558889389038  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03655093163251877 |0.012193851172924042 |0.2632661238312721 |9.030848741531372e-05 |0.428229495882988 |0.004606485366821289 |
----------------------------------------------------------pseudo_mini_loss sum 1.7271031141281128
 Run 0| Epoch 9 |
Number of nodes for computation during this epoch:  8573100
Number of first layer input nodes during this epoch:  4651491
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.12221813201904297  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022070884704589844
random selection method range initialization spend 0.005260467529296875
time for parepare:  0.02028036117553711
local_output_nid generation:  0.0013942718505859375
local_in_edges_tensor generation:  0.003690481185913086
mini_batch_src_global generation:  0.0015609264373779297
r_  generation:  0.008699178695678711
local_output_nid generation:  0.0015420913696289062
local_in_edges_tensor generation:  0.0009369850158691406
mini_batch_src_global generation:  0.0015027523040771484
r_  generation:  0.00838613510131836
local_output_nid generation:  0.0015909671783447266
local_in_edges_tensor generation:  0.0008704662322998047
mini_batch_src_global generation:  0.0010237693786621094
r_  generation:  0.008020639419555664
local_output_nid generation:  0.0015523433685302734
local_in_edges_tensor generation:  0.0008268356323242188
mini_batch_src_global generation:  0.00096893310546875
r_  generation:  0.007855415344238281
local_output_nid generation:  0.00152587890625
local_in_edges_tensor generation:  0.0008082389831542969
mini_batch_src_global generation:  0.0009005069732666016
r_  generation:  0.008095741271972656
local_output_nid generation:  0.0015037059783935547
local_in_edges_tensor generation:  0.0007767677307128906
mini_batch_src_global generation:  0.0009276866912841797
r_  generation:  0.008187294006347656
local_output_nid generation:  0.0014870166778564453
local_in_edges_tensor generation:  0.0007686614990234375
mini_batch_src_global generation:  0.0009064674377441406
r_  generation:  0.008283138275146484
local_output_nid generation:  0.0014870166778564453
local_in_edges_tensor generation:  0.0007810592651367188
mini_batch_src_global generation:  0.0009059906005859375
r_  generation:  0.00831151008605957
local_output_nid generation:  0.00148773193359375
local_in_edges_tensor generation:  0.0007894039154052734
mini_batch_src_global generation:  0.0008907318115234375
r_  generation:  0.008400440216064453
local_output_nid generation:  0.0014705657958984375
local_in_edges_tensor generation:  0.0007841587066650391
mini_batch_src_global generation:  0.000934600830078125
r_  generation:  0.008208751678466797
local_output_nid generation:  0.001493215560913086
local_in_edges_tensor generation:  0.0007674694061279297
mini_batch_src_global generation:  0.0008988380432128906
r_  generation:  0.008299112319946289
local_output_nid generation:  0.0014619827270507812
local_in_edges_tensor generation:  0.0007643699645996094
mini_batch_src_global generation:  0.00087738037109375
r_  generation:  0.008217573165893555
local_output_nid generation:  0.0014753341674804688
local_in_edges_tensor generation:  0.0007877349853515625
mini_batch_src_global generation:  0.0008742809295654297
r_  generation:  0.007972002029418945
local_output_nid generation:  0.0014920234680175781
local_in_edges_tensor generation:  0.0007572174072265625
mini_batch_src_global generation:  0.0008776187896728516
r_  generation:  0.00822305679321289
local_output_nid generation:  0.0014655590057373047
local_in_edges_tensor generation:  0.0008082389831542969
mini_batch_src_global generation:  0.0010352134704589844
r_  generation:  0.009592533111572266
local_output_nid generation:  0.0015268325805664062
local_in_edges_tensor generation:  0.0008096694946289062
mini_batch_src_global generation:  0.0010313987731933594
r_  generation:  0.008487701416015625
local_output_nid generation:  0.0015234947204589844
local_in_edges_tensor generation:  0.0007793903350830078
mini_batch_src_global generation:  0.0009069442749023438
r_  generation:  0.008202552795410156
local_output_nid generation:  0.0015020370483398438
local_in_edges_tensor generation:  0.0007805824279785156
mini_batch_src_global generation:  0.0008947849273681641
r_  generation:  0.008189678192138672
local_output_nid generation:  0.0015079975128173828
local_in_edges_tensor generation:  0.0007710456848144531
mini_batch_src_global generation:  0.0008878707885742188
r_  generation:  0.008192300796508789
local_output_nid generation:  0.0014810562133789062
local_in_edges_tensor generation:  0.00074005126953125
mini_batch_src_global generation:  0.0009102821350097656
r_  generation:  0.008480548858642578
local_output_nid generation:  0.0014851093292236328
local_in_edges_tensor generation:  0.0007643699645996094
mini_batch_src_global generation:  0.0008630752563476562
r_  generation:  0.00822138786315918
local_output_nid generation:  0.0014736652374267578
local_in_edges_tensor generation:  0.0007479190826416016
mini_batch_src_global generation:  0.00089263916015625
r_  generation:  0.008279561996459961
local_output_nid generation:  0.0014739036560058594
local_in_edges_tensor generation:  0.0007510185241699219
mini_batch_src_global generation:  0.0008714199066162109
r_  generation:  0.008175373077392578
local_output_nid generation:  0.001474142074584961
local_in_edges_tensor generation:  0.0007479190826416016
mini_batch_src_global generation:  0.0008912086486816406
r_  generation:  0.008462667465209961
local_output_nid generation:  0.0014829635620117188
local_in_edges_tensor generation:  0.0007474422454833984
mini_batch_src_global generation:  0.0008716583251953125
r_  generation:  0.008197546005249023
local_output_nid generation:  0.001462697982788086
local_in_edges_tensor generation:  0.0007486343383789062
mini_batch_src_global generation:  0.0009005069732666016
r_  generation:  0.00820016860961914
local_output_nid generation:  0.0014526844024658203
local_in_edges_tensor generation:  0.00075531005859375
mini_batch_src_global generation:  0.0008623600006103516
r_  generation:  0.00823068618774414
local_output_nid generation:  0.0014598369598388672
local_in_edges_tensor generation:  0.0007510185241699219
mini_batch_src_global generation:  0.0008549690246582031
r_  generation:  0.008069515228271484
local_output_nid generation:  0.0014548301696777344
local_in_edges_tensor generation:  0.0007472038269042969
mini_batch_src_global generation:  0.0008988380432128906
r_  generation:  0.00820159912109375
local_output_nid generation:  0.0014472007751464844
local_in_edges_tensor generation:  0.0007483959197998047
mini_batch_src_global generation:  0.0008952617645263672
r_  generation:  0.008553504943847656
local_output_nid generation:  0.0014600753784179688
local_in_edges_tensor generation:  0.0007827281951904297
mini_batch_src_global generation:  0.0009510517120361328
r_  generation:  0.009660482406616211
local_output_nid generation:  0.0015079975128173828
local_in_edges_tensor generation:  0.0007627010345458984
mini_batch_src_global generation:  0.0009670257568359375
r_  generation:  0.008541345596313477
----------------------check_connections_block total spend ----------------------------- 0.47640275955200195
generate_one_block  0.019977092742919922
generate_one_block  0.017533540725708008
generate_one_block  0.014954328536987305
generate_one_block  0.014302253723144531
generate_one_block  0.014657258987426758
generate_one_block  0.014464855194091797
generate_one_block  0.01442575454711914
generate_one_block  0.014661550521850586
generate_one_block  0.014576911926269531
generate_one_block  0.014254093170166016
generate_one_block  0.014455795288085938
generate_one_block  0.014350414276123047
generate_one_block  0.013971567153930664
generate_one_block  0.014327764511108398
generate_one_block  0.014977216720581055
generate_one_block  0.01474142074584961
generate_one_block  0.014232397079467773
generate_one_block  0.014308452606201172
generate_one_block  0.014251470565795898
generate_one_block  0.014594793319702148
generate_one_block  0.014171361923217773
generate_one_block  0.014340400695800781
generate_one_block  0.014321565628051758
generate_one_block  0.014663457870483398
generate_one_block  0.014194488525390625
generate_one_block  0.014304876327514648
generate_one_block  0.014222145080566406
generate_one_block  0.014022350311279297
generate_one_block  0.014291048049926758
generate_one_block  0.014818191528320312
generate_one_block  0.014966964721679688
generate_one_block  0.014815807342529297
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03498220443725586
gen group dst list time:  0.02089095115661621
time for parepare:  0.022055625915527344
local_output_nid generation:  0.0054514408111572266
local_in_edges_tensor generation:  0.014477968215942383
mini_batch_src_global generation:  0.012833595275878906
r_  generation:  0.12219405174255371
local_output_nid generation:  0.007784128189086914
local_in_edges_tensor generation:  0.009390830993652344
mini_batch_src_global generation:  0.01582479476928711
r_  generation:  0.16370630264282227
local_output_nid generation:  0.008228778839111328
local_in_edges_tensor generation:  0.02959275245666504
mini_batch_src_global generation:  0.014513731002807617
r_  generation:  0.13051462173461914
local_output_nid generation:  0.008056163787841797
local_in_edges_tensor generation:  0.009101390838623047
mini_batch_src_global generation:  0.015029191970825195
r_  generation:  0.1258714199066162
local_output_nid generation:  0.008250236511230469
local_in_edges_tensor generation:  0.009498119354248047
mini_batch_src_global generation:  0.015648841857910156
r_  generation:  0.13713812828063965
local_output_nid generation:  0.008147954940795898
local_in_edges_tensor generation:  0.007953643798828125
mini_batch_src_global generation:  0.016952037811279297
r_  generation:  0.13296818733215332
local_output_nid generation:  0.007975578308105469
local_in_edges_tensor generation:  0.008154869079589844
mini_batch_src_global generation:  0.016600847244262695
r_  generation:  0.13608193397521973
local_output_nid generation:  0.007963418960571289
local_in_edges_tensor generation:  0.008146047592163086
mini_batch_src_global generation:  0.016168594360351562
r_  generation:  0.13568806648254395
local_output_nid generation:  0.007866621017456055
local_in_edges_tensor generation:  0.008595705032348633
mini_batch_src_global generation:  0.01635599136352539
r_  generation:  0.13745617866516113
local_output_nid generation:  0.008207082748413086
local_in_edges_tensor generation:  0.007471323013305664
mini_batch_src_global generation:  0.016261577606201172
r_  generation:  0.13287043571472168
local_output_nid generation:  0.00839686393737793
local_in_edges_tensor generation:  0.007707118988037109
mini_batch_src_global generation:  0.016593217849731445
r_  generation:  0.13871002197265625
local_output_nid generation:  0.008187055587768555
local_in_edges_tensor generation:  0.0073816776275634766
mini_batch_src_global generation:  0.016608715057373047
r_  generation:  0.13356518745422363
local_output_nid generation:  0.008150577545166016
local_in_edges_tensor generation:  0.007250547409057617
mini_batch_src_global generation:  0.01603412628173828
r_  generation:  0.15777063369750977
local_output_nid generation:  0.008344173431396484
local_in_edges_tensor generation:  0.008032083511352539
mini_batch_src_global generation:  0.017432451248168945
r_  generation:  0.17100262641906738
local_output_nid generation:  0.013878345489501953
local_in_edges_tensor generation:  0.013956785202026367
mini_batch_src_global generation:  0.02231764793395996
r_  generation:  0.18038392066955566
local_output_nid generation:  0.011731624603271484
local_in_edges_tensor generation:  0.01173090934753418
mini_batch_src_global generation:  0.018420696258544922
r_  generation:  0.14252781867980957
local_output_nid generation:  0.00904703140258789
local_in_edges_tensor generation:  0.009139776229858398
mini_batch_src_global generation:  0.01666879653930664
r_  generation:  0.140181303024292
local_output_nid generation:  0.008708000183105469
local_in_edges_tensor generation:  0.007791042327880859
mini_batch_src_global generation:  0.018543243408203125
r_  generation:  0.1403520107269287
local_output_nid generation:  0.008550643920898438
local_in_edges_tensor generation:  0.008178472518920898
mini_batch_src_global generation:  0.01621413230895996
r_  generation:  0.14288783073425293
local_output_nid generation:  0.008594989776611328
local_in_edges_tensor generation:  0.00782465934753418
mini_batch_src_global generation:  0.017643213272094727
r_  generation:  0.14324665069580078
local_output_nid generation:  0.008185148239135742
local_in_edges_tensor generation:  0.00824737548828125
mini_batch_src_global generation:  0.016130447387695312
r_  generation:  0.14153599739074707
local_output_nid generation:  0.008403301239013672
local_in_edges_tensor generation:  0.009057998657226562
mini_batch_src_global generation:  0.017458438873291016
r_  generation:  0.14193391799926758
local_output_nid generation:  0.008414745330810547
local_in_edges_tensor generation:  0.014064550399780273
mini_batch_src_global generation:  0.016344070434570312
r_  generation:  0.14144611358642578
local_output_nid generation:  0.009308815002441406
local_in_edges_tensor generation:  0.009486675262451172
mini_batch_src_global generation:  0.017693042755126953
r_  generation:  0.14122962951660156
local_output_nid generation:  0.008204460144042969
local_in_edges_tensor generation:  0.007614612579345703
mini_batch_src_global generation:  0.016072511672973633
r_  generation:  0.148331880569458
local_output_nid generation:  0.01061701774597168
local_in_edges_tensor generation:  0.008053302764892578
mini_batch_src_global generation:  0.016567707061767578
r_  generation:  0.13680243492126465
local_output_nid generation:  0.008458137512207031
local_in_edges_tensor generation:  0.008267402648925781
mini_batch_src_global generation:  0.015801429748535156
r_  generation:  0.13835978507995605
local_output_nid generation:  0.00836181640625
local_in_edges_tensor generation:  0.008061647415161133
mini_batch_src_global generation:  0.016359567642211914
r_  generation:  0.13553380966186523
local_output_nid generation:  0.008470535278320312
local_in_edges_tensor generation:  0.008148908615112305
mini_batch_src_global generation:  0.016355037689208984
r_  generation:  0.13947796821594238
local_output_nid generation:  0.008720874786376953
local_in_edges_tensor generation:  0.008942365646362305
mini_batch_src_global generation:  0.01680159568786621
r_  generation:  0.14254307746887207
local_output_nid generation:  0.008886575698852539
local_in_edges_tensor generation:  0.008603334426879883
mini_batch_src_global generation:  0.017299175262451172
r_  generation:  0.14755988121032715
local_output_nid generation:  0.008663654327392578
local_in_edges_tensor generation:  0.008405447006225586
mini_batch_src_global generation:  0.017360210418701172
r_  generation:  0.14346718788146973
----------------------check_connections_block total spend ----------------------------- 6.7279510498046875
generate_one_block  0.1785595417022705
generate_one_block  0.17645692825317383
generate_one_block  0.17567038536071777
generate_one_block  0.17065906524658203
generate_one_block  0.20872044563293457
generate_one_block  0.1764976978302002
generate_one_block  0.1763594150543213
generate_one_block  0.17899203300476074
generate_one_block  0.17797565460205078
generate_one_block  0.17311477661132812
generate_one_block  0.1771395206451416
generate_one_block  0.17226624488830566
generate_one_block  0.17096853256225586
generate_one_block  0.17998075485229492
generate_one_block  0.18388128280639648
generate_one_block  0.1865394115447998
generate_one_block  0.17313861846923828
generate_one_block  0.1749279499053955
generate_one_block  0.17510366439819336
generate_one_block  0.18350005149841309
generate_one_block  0.17304563522338867
generate_one_block  0.1800854206085205
generate_one_block  0.17365121841430664
generate_one_block  0.1808030605316162
generate_one_block  0.17354226112365723
generate_one_block  0.1729869842529297
generate_one_block  0.17320871353149414
generate_one_block  0.171736478805542
generate_one_block  0.1793060302734375
generate_one_block  0.1855456829071045
generate_one_block  0.18513894081115723
generate_one_block  0.1948690414428711
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.038050174713134766
gen group dst list time:  0.09660577774047852
time for parepare:  0.018914222717285156
local_output_nid generation:  0.022992610931396484
local_in_edges_tensor generation:  0.04793524742126465
mini_batch_src_global generation:  0.038683414459228516
r_  generation:  0.3936450481414795
local_output_nid generation:  0.029700279235839844
local_in_edges_tensor generation:  0.03776049613952637
mini_batch_src_global generation:  0.04995441436767578
r_  generation:  0.3956422805786133
local_output_nid generation:  0.029020309448242188
local_in_edges_tensor generation:  0.029019832611083984
mini_batch_src_global generation:  0.04534721374511719
r_  generation:  0.407365083694458
local_output_nid generation:  0.02905559539794922
local_in_edges_tensor generation:  0.027217864990234375
mini_batch_src_global generation:  0.04651331901550293
r_  generation:  0.3950333595275879
local_output_nid generation:  0.029038429260253906
local_in_edges_tensor generation:  0.030760526657104492
mini_batch_src_global generation:  0.04570341110229492
r_  generation:  0.4076251983642578
local_output_nid generation:  0.029703378677368164
local_in_edges_tensor generation:  0.030623674392700195
mini_batch_src_global generation:  0.05006551742553711
r_  generation:  0.4131169319152832
local_output_nid generation:  0.02936577796936035
local_in_edges_tensor generation:  0.027044296264648438
mini_batch_src_global generation:  0.04711318016052246
r_  generation:  0.4043707847595215
local_output_nid generation:  0.028113365173339844
local_in_edges_tensor generation:  0.027901172637939453
mini_batch_src_global generation:  0.04858541488647461
r_  generation:  0.4024167060852051
local_output_nid generation:  0.027834415435791016
local_in_edges_tensor generation:  0.02702045440673828
mini_batch_src_global generation:  0.046750783920288086
r_  generation:  0.4060943126678467
local_output_nid generation:  0.029340267181396484
local_in_edges_tensor generation:  0.026902198791503906
mini_batch_src_global generation:  0.04770827293395996
r_  generation:  0.39690566062927246
local_output_nid generation:  0.027744054794311523
local_in_edges_tensor generation:  0.027787208557128906
mini_batch_src_global generation:  0.04697561264038086
r_  generation:  0.40680885314941406
local_output_nid generation:  0.027463912963867188
local_in_edges_tensor generation:  0.026348352432250977
mini_batch_src_global generation:  0.04766130447387695
r_  generation:  0.3957536220550537
local_output_nid generation:  0.027484893798828125
local_in_edges_tensor generation:  0.02707052230834961
mini_batch_src_global generation:  0.04659557342529297
r_  generation:  0.4032437801361084
local_output_nid generation:  0.027834177017211914
local_in_edges_tensor generation:  0.02699589729309082
mini_batch_src_global generation:  0.04864764213562012
r_  generation:  0.40044355392456055
local_output_nid generation:  0.02800440788269043
local_in_edges_tensor generation:  0.02879643440246582
mini_batch_src_global generation:  0.04677724838256836
r_  generation:  0.4086437225341797
local_output_nid generation:  0.027765274047851562
local_in_edges_tensor generation:  0.027192115783691406
mini_batch_src_global generation:  0.04865288734436035
r_  generation:  0.4034426212310791
local_output_nid generation:  0.027656078338623047
local_in_edges_tensor generation:  0.026621580123901367
mini_batch_src_global generation:  0.04707074165344238
r_  generation:  0.41400671005249023
local_output_nid generation:  0.02782130241394043
local_in_edges_tensor generation:  0.027024269104003906
mini_batch_src_global generation:  0.051131486892700195
r_  generation:  0.40496301651000977
local_output_nid generation:  0.027877092361450195
local_in_edges_tensor generation:  0.03167986869812012
mini_batch_src_global generation:  0.04747128486633301
r_  generation:  0.4103696346282959
local_output_nid generation:  0.028148174285888672
local_in_edges_tensor generation:  0.027517318725585938
mini_batch_src_global generation:  0.049185752868652344
r_  generation:  0.4058547019958496
local_output_nid generation:  0.028844833374023438
local_in_edges_tensor generation:  0.028050899505615234
mini_batch_src_global generation:  0.048666954040527344
r_  generation:  0.407634973526001
local_output_nid generation:  0.02754044532775879
local_in_edges_tensor generation:  0.02725958824157715
mini_batch_src_global generation:  0.04997086524963379
r_  generation:  0.40149950981140137
local_output_nid generation:  0.027669668197631836
local_in_edges_tensor generation:  0.02866983413696289
mini_batch_src_global generation:  0.04717302322387695
r_  generation:  0.4072458744049072
local_output_nid generation:  0.027805089950561523
local_in_edges_tensor generation:  0.02605724334716797
mini_batch_src_global generation:  0.050079345703125
r_  generation:  0.4012465476989746
local_output_nid generation:  0.027474164962768555
local_in_edges_tensor generation:  0.025508880615234375
mini_batch_src_global generation:  0.046273231506347656
r_  generation:  0.40348052978515625
local_output_nid generation:  0.027382612228393555
local_in_edges_tensor generation:  0.025080442428588867
mini_batch_src_global generation:  0.04792308807373047
r_  generation:  0.3997926712036133
local_output_nid generation:  0.02935624122619629
local_in_edges_tensor generation:  0.02818894386291504
mini_batch_src_global generation:  0.047768592834472656
r_  generation:  0.4067964553833008
local_output_nid generation:  0.027721881866455078
local_in_edges_tensor generation:  0.02712559700012207
mini_batch_src_global generation:  0.04951214790344238
r_  generation:  0.39818572998046875
local_output_nid generation:  0.027910709381103516
local_in_edges_tensor generation:  0.0326075553894043
mini_batch_src_global generation:  0.05994462966918945
r_  generation:  0.409588098526001
local_output_nid generation:  0.029023170471191406
local_in_edges_tensor generation:  0.026721954345703125
mini_batch_src_global generation:  0.048313140869140625
r_  generation:  0.40150880813598633
local_output_nid generation:  0.028032541275024414
local_in_edges_tensor generation:  0.02798175811767578
mini_batch_src_global generation:  0.04776906967163086
r_  generation:  0.41074466705322266
local_output_nid generation:  0.02785515785217285
local_in_edges_tensor generation:  0.028261184692382812
mini_batch_src_global generation:  0.04878640174865723
r_  generation:  0.40532350540161133
----------------------check_connections_block total spend ----------------------------- 19.170395374298096
generate_one_block  0.5446622371673584
generate_one_block  0.5246319770812988
generate_one_block  0.5352964401245117
generate_one_block  0.5282375812530518
generate_one_block  0.6357595920562744
generate_one_block  0.5324475765228271
generate_one_block  0.5313146114349365
generate_one_block  0.5348756313323975
generate_one_block  0.5316574573516846
generate_one_block  0.5242865085601807
generate_one_block  0.5332860946655273
generate_one_block  0.5264041423797607
generate_one_block  0.5237991809844971
generate_one_block  0.5400350093841553
generate_one_block  0.5386691093444824
generate_one_block  0.5313906669616699
generate_one_block  0.5326991081237793
generate_one_block  0.5318937301635742
generate_one_block  0.5358202457427979
generate_one_block  0.5438034534454346
generate_one_block  0.5282940864562988
generate_one_block  0.5317590236663818
generate_one_block  0.532660961151123
generate_one_block  0.5399162769317627
generate_one_block  0.5400862693786621
generate_one_block  0.5292549133300781
generate_one_block  0.5314798355102539
generate_one_block  0.5314550399780273
generate_one_block  0.5470798015594482
generate_one_block  0.5377793312072754
generate_one_block  0.5491585731506348
generate_one_block  0.542914867401123
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.12221813201904297  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

connection checking time:  25.898346424102783
block generation total time  22.91718077659607
average batch blocks generation time:  0.7161618992686272
block dataloader generation time/epoch 51.33181810379028
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10394144058227539  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.644509315490723  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10290193557739258  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.673400402069092  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10400009155273438  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.750241756439209  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10270214080810547  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.240485668182373  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10402393341064453  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.81879997253418  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10283470153808594  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.613730430603027  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10293865203857422  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.715153694152832  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10417032241821289  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.845424175262451  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10299301147460938  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.790012836456299  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10281038284301758  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.532634735107422  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10500478744506836  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.811144828796387  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10274124145507812  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.372501373291016  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10380840301513672  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.400643825531006  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10393190383911133  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.863710880279541  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10506010055541992  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.065943241119385  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10390377044677734  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.949657917022705  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10286426544189453  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.56663703918457  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10306692123413086  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.69608736038208  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1039581298828125  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.640762329101562  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1041264533996582  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.857802867889404  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10280466079711914  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.54373025894165  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10274934768676758  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.800271034240723  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10285043716430664  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.574580669403076  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10380029678344727  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.854144096374512  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10249090194702148  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.445443153381348  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10295295715332031  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.585699558258057  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10388469696044922  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.53022289276123  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1030721664428711  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.524463176727295  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10498714447021484  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.76511526107788  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10394668579101562  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.96773386001587  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10508394241333008  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.187060832977295  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1039743423461914  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.04007053375244  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.034081973135471344 |0.012459926307201385 |0.26264704018831253 |8.931010961532593e-05 |0.42707327008247375 |0.003545999526977539 |
----------------------------------------------------------pseudo_mini_loss sum 1.6605418920516968
Total (block generation + training)time/epoch 74.95265913009644
Training time/epoch 23.620560884475708
Training time without block to device /epoch 23.221843242645264
Training time without total dataloading part /epoch 22.07745385169983
load block tensor time/epoch 1.090623140335083
block to device time/epoch 0.39871764183044434
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 10 |
Number of nodes for computation during this epoch:  8573355
Number of first layer input nodes during this epoch:  4651638
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.12189340591430664  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025183677673339844
random selection method range initialization spend 0.005638837814331055
time for parepare:  0.02373361587524414
local_output_nid generation:  0.0017518997192382812
local_in_edges_tensor generation:  0.005105495452880859
mini_batch_src_global generation:  0.003981351852416992
r_  generation:  0.008406400680541992
local_output_nid generation:  0.0017063617706298828
local_in_edges_tensor generation:  0.0011415481567382812
mini_batch_src_global generation:  0.002931833267211914
r_  generation:  0.008461236953735352
local_output_nid generation:  0.001863718032836914
local_in_edges_tensor generation:  0.001112222671508789
mini_batch_src_global generation:  0.0012412071228027344
r_  generation:  0.007927656173706055
local_output_nid generation:  0.0018954277038574219
local_in_edges_tensor generation:  0.0010592937469482422
mini_batch_src_global generation:  0.0012319087982177734
r_  generation:  0.008201360702514648
local_output_nid generation:  0.0018968582153320312
local_in_edges_tensor generation:  0.001064300537109375
mini_batch_src_global generation:  0.0011410713195800781
r_  generation:  0.008084535598754883
local_output_nid generation:  0.0019550323486328125
local_in_edges_tensor generation:  0.0010232925415039062
mini_batch_src_global generation:  0.0012056827545166016
r_  generation:  0.00798177719116211
local_output_nid generation:  0.001950979232788086
local_in_edges_tensor generation:  0.0010378360748291016
mini_batch_src_global generation:  0.0010993480682373047
r_  generation:  0.008405208587646484
local_output_nid generation:  0.001967191696166992
local_in_edges_tensor generation:  0.0010521411895751953
mini_batch_src_global generation:  0.0012485980987548828
r_  generation:  0.008412837982177734
local_output_nid generation:  0.0019965171813964844
local_in_edges_tensor generation:  0.0010197162628173828
mini_batch_src_global generation:  0.0011277198791503906
r_  generation:  0.008324861526489258
local_output_nid generation:  0.0020020008087158203
local_in_edges_tensor generation:  0.001033782958984375
mini_batch_src_global generation:  0.0010745525360107422
r_  generation:  0.00847315788269043
local_output_nid generation:  0.0020399093627929688
local_in_edges_tensor generation:  0.0010099411010742188
mini_batch_src_global generation:  0.0010581016540527344
r_  generation:  0.00848698616027832
local_output_nid generation:  0.0020170211791992188
local_in_edges_tensor generation:  0.0010638236999511719
mini_batch_src_global generation:  0.0010480880737304688
r_  generation:  0.008255720138549805
local_output_nid generation:  0.0020570755004882812
local_in_edges_tensor generation:  0.001024484634399414
mini_batch_src_global generation:  0.0010476112365722656
r_  generation:  0.008376836776733398
local_output_nid generation:  0.0020265579223632812
local_in_edges_tensor generation:  0.0010280609130859375
mini_batch_src_global generation:  0.0010900497436523438
r_  generation:  0.00850820541381836
local_output_nid generation:  0.0020508766174316406
local_in_edges_tensor generation:  0.0010025501251220703
mini_batch_src_global generation:  0.0010306835174560547
r_  generation:  0.008538246154785156
local_output_nid generation:  0.0020599365234375
local_in_edges_tensor generation:  0.000986337661743164
mini_batch_src_global generation:  0.0010819435119628906
r_  generation:  0.00863027572631836
local_output_nid generation:  0.002041339874267578
local_in_edges_tensor generation:  0.001068115234375
mini_batch_src_global generation:  0.0010454654693603516
r_  generation:  0.008391380310058594
local_output_nid generation:  0.002058267593383789
local_in_edges_tensor generation:  0.0011322498321533203
mini_batch_src_global generation:  0.0011446475982666016
r_  generation:  0.010111331939697266
local_output_nid generation:  0.0021486282348632812
local_in_edges_tensor generation:  0.0010361671447753906
mini_batch_src_global generation:  0.0011553764343261719
r_  generation:  0.008550643920898438
local_output_nid generation:  0.002137422561645508
local_in_edges_tensor generation:  0.00101470947265625
mini_batch_src_global generation:  0.0010869503021240234
r_  generation:  0.008390426635742188
local_output_nid generation:  0.0021255016326904297
local_in_edges_tensor generation:  0.0010383129119873047
mini_batch_src_global generation:  0.0012009143829345703
r_  generation:  0.008536100387573242
local_output_nid generation:  0.0021080970764160156
local_in_edges_tensor generation:  0.0010406970977783203
mini_batch_src_global generation:  0.0010900497436523438
r_  generation:  0.008272886276245117
local_output_nid generation:  0.002119779586791992
local_in_edges_tensor generation:  0.0010013580322265625
mini_batch_src_global generation:  0.001107931137084961
r_  generation:  0.008563756942749023
local_output_nid generation:  0.0020859241485595703
local_in_edges_tensor generation:  0.0010209083557128906
mini_batch_src_global generation:  0.001064300537109375
r_  generation:  0.00838160514831543
local_output_nid generation:  0.0020940303802490234
local_in_edges_tensor generation:  0.0010526180267333984
mini_batch_src_global generation:  0.001081705093383789
r_  generation:  0.008315086364746094
local_output_nid generation:  0.0020935535430908203
local_in_edges_tensor generation:  0.0009899139404296875
mini_batch_src_global generation:  0.0010933876037597656
r_  generation:  0.008487939834594727
local_output_nid generation:  0.0021123886108398438
local_in_edges_tensor generation:  0.0010287761688232422
mini_batch_src_global generation:  0.0012257099151611328
r_  generation:  0.00813436508178711
local_output_nid generation:  0.002123117446899414
local_in_edges_tensor generation:  0.0009756088256835938
mini_batch_src_global generation:  0.0010704994201660156
r_  generation:  0.008420705795288086
local_output_nid generation:  0.0021011829376220703
local_in_edges_tensor generation:  0.0010030269622802734
mini_batch_src_global generation:  0.001077890396118164
r_  generation:  0.008697986602783203
local_output_nid generation:  0.0021293163299560547
local_in_edges_tensor generation:  0.0010497570037841797
mini_batch_src_global generation:  0.0010454654693603516
r_  generation:  0.008453607559204102
local_output_nid generation:  0.002123117446899414
local_in_edges_tensor generation:  0.0010547637939453125
mini_batch_src_global generation:  0.0010557174682617188
r_  generation:  0.00815272331237793
local_output_nid generation:  0.0021059513092041016
local_in_edges_tensor generation:  0.0010075569152832031
mini_batch_src_global generation:  0.0010187625885009766
r_  generation:  0.008286476135253906
----------------------check_connections_block total spend ----------------------------- 0.5318155288696289
generate_one_block  0.023555994033813477
generate_one_block  0.020310163497924805
generate_one_block  0.015928268432617188
generate_one_block  0.016033172607421875
generate_one_block  0.015266895294189453
generate_one_block  0.015090703964233398
generate_one_block  0.032233238220214844
generate_one_block  0.015286922454833984
generate_one_block  0.014725208282470703
generate_one_block  0.014636754989624023
generate_one_block  0.01463937759399414
generate_one_block  0.01454615592956543
generate_one_block  0.01439809799194336
generate_one_block  0.01459050178527832
generate_one_block  0.014374256134033203
generate_one_block  0.014738321304321289
generate_one_block  0.016748666763305664
generate_one_block  0.015088319778442383
generate_one_block  0.014515161514282227
generate_one_block  0.014325380325317383
generate_one_block  0.014605998992919922
generate_one_block  0.014065265655517578
generate_one_block  0.01484537124633789
generate_one_block  0.016845703125
generate_one_block  0.014197826385498047
generate_one_block  0.014616250991821289
generate_one_block  0.013960123062133789
generate_one_block  0.014322519302368164
generate_one_block  0.014742374420166016
generate_one_block  0.014077425003051758
generate_one_block  0.016448974609375
generate_one_block  0.014107227325439453
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0446474552154541
gen group dst list time:  0.024013757705688477
time for parepare:  0.024898052215576172
local_output_nid generation:  0.005681276321411133
local_in_edges_tensor generation:  0.01725912094116211
mini_batch_src_global generation:  0.015451431274414062
r_  generation:  0.1286463737487793
local_output_nid generation:  0.008330345153808594
local_in_edges_tensor generation:  0.011530876159667969
mini_batch_src_global generation:  0.018822669982910156
r_  generation:  0.1342935562133789
local_output_nid generation:  0.00812840461730957
local_in_edges_tensor generation:  0.033448219299316406
mini_batch_src_global generation:  0.016887187957763672
r_  generation:  0.12956809997558594
local_output_nid generation:  0.008548736572265625
local_in_edges_tensor generation:  0.008556365966796875
mini_batch_src_global generation:  0.020725488662719727
r_  generation:  0.13794183731079102
local_output_nid generation:  0.008259296417236328
local_in_edges_tensor generation:  0.01163935661315918
mini_batch_src_global generation:  0.029323339462280273
r_  generation:  0.17502760887145996
local_output_nid generation:  0.008797645568847656
local_in_edges_tensor generation:  0.008430242538452148
mini_batch_src_global generation:  0.018746614456176758
r_  generation:  0.13528895378112793
local_output_nid generation:  0.008048534393310547
local_in_edges_tensor generation:  0.00827646255493164
mini_batch_src_global generation:  0.016251087188720703
r_  generation:  0.13704323768615723
local_output_nid generation:  0.007967472076416016
local_in_edges_tensor generation:  0.009143352508544922
mini_batch_src_global generation:  0.016463518142700195
r_  generation:  0.1352999210357666
local_output_nid generation:  0.008040904998779297
local_in_edges_tensor generation:  0.008032560348510742
mini_batch_src_global generation:  0.01667475700378418
r_  generation:  0.13640761375427246
local_output_nid generation:  0.008244514465332031
local_in_edges_tensor generation:  0.007709026336669922
mini_batch_src_global generation:  0.016469240188598633
r_  generation:  0.13496875762939453
local_output_nid generation:  0.008632421493530273
local_in_edges_tensor generation:  0.008796453475952148
mini_batch_src_global generation:  0.017487287521362305
r_  generation:  0.17329168319702148
local_output_nid generation:  0.008584737777709961
local_in_edges_tensor generation:  0.0077669620513916016
mini_batch_src_global generation:  0.01635265350341797
r_  generation:  0.1313180923461914
local_output_nid generation:  0.008665084838867188
local_in_edges_tensor generation:  0.007476806640625
mini_batch_src_global generation:  0.01632070541381836
r_  generation:  0.13575267791748047
local_output_nid generation:  0.008785247802734375
local_in_edges_tensor generation:  0.00751948356628418
mini_batch_src_global generation:  0.01635909080505371
r_  generation:  0.13611340522766113
local_output_nid generation:  0.00843358039855957
local_in_edges_tensor generation:  0.007562160491943359
mini_batch_src_global generation:  0.01631021499633789
r_  generation:  0.1389472484588623
local_output_nid generation:  0.00846099853515625
local_in_edges_tensor generation:  0.008800745010375977
mini_batch_src_global generation:  0.016985416412353516
r_  generation:  0.14440703392028809
local_output_nid generation:  0.0084228515625
local_in_edges_tensor generation:  0.00818777084350586
mini_batch_src_global generation:  0.016602516174316406
r_  generation:  0.14165282249450684
local_output_nid generation:  0.008494853973388672
local_in_edges_tensor generation:  0.011499166488647461
mini_batch_src_global generation:  0.017368078231811523
r_  generation:  0.14331269264221191
local_output_nid generation:  0.008274078369140625
local_in_edges_tensor generation:  0.008245468139648438
mini_batch_src_global generation:  0.016636371612548828
r_  generation:  0.1414797306060791
local_output_nid generation:  0.00932621955871582
local_in_edges_tensor generation:  0.007478952407836914
mini_batch_src_global generation:  0.016337156295776367
r_  generation:  0.13542938232421875
local_output_nid generation:  0.0085601806640625
local_in_edges_tensor generation:  0.00818943977355957
mini_batch_src_global generation:  0.01721644401550293
r_  generation:  0.14139986038208008
local_output_nid generation:  0.008487462997436523
local_in_edges_tensor generation:  0.007295131683349609
mini_batch_src_global generation:  0.016477584838867188
r_  generation:  0.1330573558807373
local_output_nid generation:  0.0087432861328125
local_in_edges_tensor generation:  0.00815439224243164
mini_batch_src_global generation:  0.017386436462402344
r_  generation:  0.14225387573242188
local_output_nid generation:  0.008375167846679688
local_in_edges_tensor generation:  0.008037805557250977
mini_batch_src_global generation:  0.016692161560058594
r_  generation:  0.13777923583984375
local_output_nid generation:  0.008407115936279297
local_in_edges_tensor generation:  0.007422447204589844
mini_batch_src_global generation:  0.01591658592224121
r_  generation:  0.1357893943786621
local_output_nid generation:  0.008604288101196289
local_in_edges_tensor generation:  0.007970809936523438
mini_batch_src_global generation:  0.017781496047973633
r_  generation:  0.1413125991821289
local_output_nid generation:  0.008582592010498047
local_in_edges_tensor generation:  0.007821798324584961
mini_batch_src_global generation:  0.01648116111755371
r_  generation:  0.13847041130065918
local_output_nid generation:  0.008534431457519531
local_in_edges_tensor generation:  0.00764918327331543
mini_batch_src_global generation:  0.016431331634521484
r_  generation:  0.13974881172180176
local_output_nid generation:  0.010316133499145508
local_in_edges_tensor generation:  0.008373498916625977
mini_batch_src_global generation:  0.01768946647644043
r_  generation:  0.1447596549987793
local_output_nid generation:  0.00844120979309082
local_in_edges_tensor generation:  0.00821685791015625
mini_batch_src_global generation:  0.01647496223449707
r_  generation:  0.1378161907196045
local_output_nid generation:  0.008437156677246094
local_in_edges_tensor generation:  0.007978439331054688
mini_batch_src_global generation:  0.016071319580078125
r_  generation:  0.13880062103271484
local_output_nid generation:  0.008390665054321289
local_in_edges_tensor generation:  0.007442951202392578
mini_batch_src_global generation:  0.016306638717651367
r_  generation:  0.13606786727905273
----------------------check_connections_block total spend ----------------------------- 6.6937620639801025
generate_one_block  0.18916630744934082
generate_one_block  0.18079590797424316
generate_one_block  0.16594552993774414
generate_one_block  0.17790722846984863
generate_one_block  0.2012038230895996
generate_one_block  0.16725921630859375
generate_one_block  0.17895102500915527
generate_one_block  0.17830371856689453
generate_one_block  0.17761683464050293
generate_one_block  0.17562079429626465
generate_one_block  0.18094325065612793
generate_one_block  0.16914057731628418
generate_one_block  0.1752464771270752
generate_one_block  0.18776845932006836
generate_one_block  0.17522811889648438
generate_one_block  0.18342256546020508
generate_one_block  0.1815652847290039
generate_one_block  0.18558001518249512
generate_one_block  0.18310904502868652
generate_one_block  0.1816270351409912
generate_one_block  0.1825270652770996
generate_one_block  0.16990447044372559
generate_one_block  0.18230605125427246
generate_one_block  0.17750024795532227
generate_one_block  0.1745312213897705
generate_one_block  0.1840376853942871
generate_one_block  0.17545509338378906
generate_one_block  0.17980718612670898
generate_one_block  0.18348288536071777
generate_one_block  0.17298483848571777
generate_one_block  0.17271995544433594
generate_one_block  0.17668938636779785
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.036554574966430664
gen group dst list time:  0.11068463325500488
time for parepare:  0.021010160446166992
local_output_nid generation:  0.0237274169921875
local_in_edges_tensor generation:  0.04694795608520508
mini_batch_src_global generation:  0.037807464599609375
r_  generation:  0.39184141159057617
local_output_nid generation:  0.029034137725830078
local_in_edges_tensor generation:  0.03203439712524414
mini_batch_src_global generation:  0.049295902252197266
r_  generation:  0.39423131942749023
local_output_nid generation:  0.028305530548095703
local_in_edges_tensor generation:  0.02508854866027832
mini_batch_src_global generation:  0.045668601989746094
r_  generation:  0.3950793743133545
local_output_nid generation:  0.029343843460083008
local_in_edges_tensor generation:  0.02643871307373047
mini_batch_src_global generation:  0.04986929893493652
r_  generation:  0.4010591506958008
local_output_nid generation:  0.028853178024291992
local_in_edges_tensor generation:  0.025063037872314453
mini_batch_src_global generation:  0.046659231185913086
r_  generation:  0.4059562683105469
local_output_nid generation:  0.027814149856567383
local_in_edges_tensor generation:  0.0261688232421875
mini_batch_src_global generation:  0.047799110412597656
r_  generation:  0.40839314460754395
local_output_nid generation:  0.02697277069091797
local_in_edges_tensor generation:  0.02638864517211914
mini_batch_src_global generation:  0.04642987251281738
r_  generation:  0.407576322555542
local_output_nid generation:  0.027247190475463867
local_in_edges_tensor generation:  0.026187896728515625
mini_batch_src_global generation:  0.04783201217651367
r_  generation:  0.4006228446960449
local_output_nid generation:  0.027189016342163086
local_in_edges_tensor generation:  0.0291593074798584
mini_batch_src_global generation:  0.04738187789916992
r_  generation:  0.40923357009887695
local_output_nid generation:  0.027630090713500977
local_in_edges_tensor generation:  0.02689337730407715
mini_batch_src_global generation:  0.04884481430053711
r_  generation:  0.3996999263763428
local_output_nid generation:  0.027278661727905273
local_in_edges_tensor generation:  0.026879549026489258
mini_batch_src_global generation:  0.04687690734863281
r_  generation:  0.406998872756958
local_output_nid generation:  0.026424646377563477
local_in_edges_tensor generation:  0.02642989158630371
mini_batch_src_global generation:  0.04781079292297363
r_  generation:  0.3926835060119629
local_output_nid generation:  0.027101755142211914
local_in_edges_tensor generation:  0.026595115661621094
mini_batch_src_global generation:  0.04845476150512695
r_  generation:  0.40703344345092773
local_output_nid generation:  0.026848554611206055
local_in_edges_tensor generation:  0.035242557525634766
mini_batch_src_global generation:  0.04797935485839844
r_  generation:  0.40189576148986816
local_output_nid generation:  0.027226686477661133
local_in_edges_tensor generation:  0.026595115661621094
mini_batch_src_global generation:  0.046456336975097656
r_  generation:  0.40613770484924316
local_output_nid generation:  0.02706289291381836
local_in_edges_tensor generation:  0.030577898025512695
mini_batch_src_global generation:  0.04842042922973633
r_  generation:  0.40584683418273926
local_output_nid generation:  0.027147769927978516
local_in_edges_tensor generation:  0.02894759178161621
mini_batch_src_global generation:  0.04760551452636719
r_  generation:  0.4088568687438965
local_output_nid generation:  0.027286052703857422
local_in_edges_tensor generation:  0.027642011642456055
mini_batch_src_global generation:  0.05188322067260742
r_  generation:  0.40636396408081055
local_output_nid generation:  0.027167081832885742
local_in_edges_tensor generation:  0.028020381927490234
mini_batch_src_global generation:  0.04711794853210449
r_  generation:  0.40866827964782715
local_output_nid generation:  0.027094364166259766
local_in_edges_tensor generation:  0.026999473571777344
mini_batch_src_global generation:  0.050063371658325195
r_  generation:  0.4195399284362793
local_output_nid generation:  0.03057718276977539
local_in_edges_tensor generation:  0.027219772338867188
mini_batch_src_global generation:  0.04974222183227539
r_  generation:  0.40882253646850586
local_output_nid generation:  0.0283660888671875
local_in_edges_tensor generation:  0.03071117401123047
mini_batch_src_global generation:  0.04818415641784668
r_  generation:  0.3975222110748291
local_output_nid generation:  0.027924299240112305
local_in_edges_tensor generation:  0.02573704719543457
mini_batch_src_global generation:  0.04703354835510254
r_  generation:  0.4099743366241455
local_output_nid generation:  0.02760791778564453
local_in_edges_tensor generation:  0.026393651962280273
mini_batch_src_global generation:  0.048571109771728516
r_  generation:  0.39839792251586914
local_output_nid generation:  0.027443885803222656
local_in_edges_tensor generation:  0.025435686111450195
mini_batch_src_global generation:  0.04639863967895508
r_  generation:  0.40218377113342285
local_output_nid generation:  0.027591466903686523
local_in_edges_tensor generation:  0.027684450149536133
mini_batch_src_global generation:  0.04826998710632324
r_  generation:  0.40528011322021484
local_output_nid generation:  0.02776622772216797
local_in_edges_tensor generation:  0.027420759201049805
mini_batch_src_global generation:  0.04659271240234375
r_  generation:  0.4076957702636719
local_output_nid generation:  0.028038978576660156
local_in_edges_tensor generation:  0.02694225311279297
mini_batch_src_global generation:  0.06026577949523926
r_  generation:  0.4099917411804199
local_output_nid generation:  0.027778148651123047
local_in_edges_tensor generation:  0.026824474334716797
mini_batch_src_global generation:  0.0471043586730957
r_  generation:  0.4062833786010742
local_output_nid generation:  0.027270793914794922
local_in_edges_tensor generation:  0.02543020248413086
mini_batch_src_global generation:  0.04764962196350098
r_  generation:  0.3977665901184082
local_output_nid generation:  0.027759552001953125
local_in_edges_tensor generation:  0.025171756744384766
mini_batch_src_global generation:  0.04633069038391113
r_  generation:  0.4077630043029785
local_output_nid generation:  0.027187347412109375
local_in_edges_tensor generation:  0.026575565338134766
mini_batch_src_global generation:  0.0473177433013916
r_  generation:  0.3975331783294678
----------------------check_connections_block total spend ----------------------------- 19.10897922515869
generate_one_block  0.5434057712554932
generate_one_block  0.5392582416534424
generate_one_block  0.5231328010559082
generate_one_block  0.536731481552124
generate_one_block  0.6386592388153076
generate_one_block  0.5324327945709229
generate_one_block  0.5337557792663574
generate_one_block  0.5368072986602783
generate_one_block  0.5361196994781494
generate_one_block  0.5315494537353516
generate_one_block  0.5370490550994873
generate_one_block  0.5255069732666016
generate_one_block  0.5284566879272461
generate_one_block  0.5371901988983154
generate_one_block  0.5292222499847412
generate_one_block  0.5391016006469727
generate_one_block  0.537013053894043
generate_one_block  0.5406861305236816
generate_one_block  0.5380089282989502
generate_one_block  0.5352025032043457
generate_one_block  0.5300216674804688
generate_one_block  0.5232102870941162
generate_one_block  0.5430972576141357
generate_one_block  0.5291857719421387
generate_one_block  0.5363497734069824
generate_one_block  0.5380246639251709
generate_one_block  0.5382368564605713
generate_one_block  0.5376660823822021
generate_one_block  0.5352928638458252
generate_one_block  0.5339188575744629
generate_one_block  0.5307025909423828
generate_one_block  0.5299232006072998
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.12189340591430664  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

connection checking time:  25.802741289138794
block generation total time  22.93326711654663
average batch blocks generation time:  0.7166645973920822
block dataloader generation time/epoch 51.335514307022095
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10396718978881836  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.882640361785889  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10416364669799805  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.00225067138672  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10236883163452148  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.224846839904785  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10437917709350586  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.948389053344727  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10390377044677734  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.534128189086914  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10297489166259766  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.376171112060547  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10373353958129883  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.83954668045044  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1028757095336914  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.767646789550781  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10501289367675781  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.847689151763916  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10297441482543945  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.705845832824707  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10504388809204102  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.935065269470215  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10262727737426758  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.242473125457764  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10396194458007812  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.68430471420288  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10294485092163086  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.706512928009033  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10289478302001953  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.580183029174805  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10411310195922852  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.974908828735352  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10501527786254883  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.867367267608643  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10429859161376953  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.07999277114868  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10397577285766602  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.961779117584229  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1031041145324707  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.632656574249268  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10503005981445312  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.893292427062988  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10251617431640625  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.309314727783203  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10503864288330078  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.976473331451416  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10297060012817383  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.606539249420166  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10249948501586914  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.355082035064697  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1041264533996582  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.969924449920654  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10289573669433594  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.609601020812988  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10304784774780273  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.709850788116455  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10381126403808594  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.888126850128174  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10245418548583984  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.402076244354248  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1038808822631836  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.523785591125488  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10252952575683594  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.469032287597656  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03386890888214111 |0.012563802301883698 |0.2649221196770668 |9.100884199142456e-05 |0.4294348433613777 |0.0060384273529052734 |
----------------------------------------------------------pseudo_mini_loss sum 1.6064327955245972
Total (block generation + training)time/epoch 75.02816605567932
Training time/epoch 23.764190435409546
Training time without block to device /epoch 23.362148761749268
Training time without total dataloading part /epoch 22.228373527526855
load block tensor time/epoch 1.0838050842285156
block to device time/epoch 0.4020416736602783
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 11 |
Number of nodes for computation during this epoch:  8570470
Number of first layer input nodes during this epoch:  4651149
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.11995744705200195  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021015167236328125
random selection method range initialization spend 0.005237579345703125
time for parepare:  0.02072763442993164
local_output_nid generation:  0.0014717578887939453
local_in_edges_tensor generation:  0.006196260452270508
mini_batch_src_global generation:  0.0015978813171386719
r_  generation:  0.00875544548034668
local_output_nid generation:  0.001539468765258789
local_in_edges_tensor generation:  0.0009479522705078125
mini_batch_src_global generation:  0.0014798641204833984
r_  generation:  0.008557796478271484
local_output_nid generation:  0.0015778541564941406
local_in_edges_tensor generation:  0.0009584426879882812
mini_batch_src_global generation:  0.0010416507720947266
r_  generation:  0.008093833923339844
local_output_nid generation:  0.0015604496002197266
local_in_edges_tensor generation:  0.0008797645568847656
mini_batch_src_global generation:  0.0009400844573974609
r_  generation:  0.007945775985717773
local_output_nid generation:  0.0014941692352294922
local_in_edges_tensor generation:  0.0008318424224853516
mini_batch_src_global generation:  0.0009608268737792969
r_  generation:  0.00823211669921875
local_output_nid generation:  0.0014939308166503906
local_in_edges_tensor generation:  0.0008497238159179688
mini_batch_src_global generation:  0.0009291172027587891
r_  generation:  0.00805211067199707
local_output_nid generation:  0.0014834403991699219
local_in_edges_tensor generation:  0.0007996559143066406
mini_batch_src_global generation:  0.00090789794921875
r_  generation:  0.008138179779052734
local_output_nid generation:  0.0014872550964355469
local_in_edges_tensor generation:  0.0007870197296142578
mini_batch_src_global generation:  0.000881195068359375
r_  generation:  0.008140802383422852
local_output_nid generation:  0.0014801025390625
local_in_edges_tensor generation:  0.0008141994476318359
mini_batch_src_global generation:  0.000896453857421875
r_  generation:  0.010413885116577148
local_output_nid generation:  0.0015254020690917969
local_in_edges_tensor generation:  0.0019481182098388672
mini_batch_src_global generation:  0.0009057521820068359
r_  generation:  0.00826883316040039
local_output_nid generation:  0.0014944076538085938
local_in_edges_tensor generation:  0.0009679794311523438
mini_batch_src_global generation:  0.0009098052978515625
r_  generation:  0.00831913948059082
local_output_nid generation:  0.0014681816101074219
local_in_edges_tensor generation:  0.0008745193481445312
mini_batch_src_global generation:  0.0009272098541259766
r_  generation:  0.008059501647949219
local_output_nid generation:  0.001474142074584961
local_in_edges_tensor generation:  0.0007808208465576172
mini_batch_src_global generation:  0.0008928775787353516
r_  generation:  0.008112907409667969
local_output_nid generation:  0.0014734268188476562
local_in_edges_tensor generation:  0.0007691383361816406
mini_batch_src_global generation:  0.0009484291076660156
r_  generation:  0.00830221176147461
local_output_nid generation:  0.0014767646789550781
local_in_edges_tensor generation:  0.0007550716400146484
mini_batch_src_global generation:  0.0008983612060546875
r_  generation:  0.00826883316040039
local_output_nid generation:  0.0014731884002685547
local_in_edges_tensor generation:  0.0009379386901855469
mini_batch_src_global generation:  0.0009555816650390625
r_  generation:  0.00949549674987793
local_output_nid generation:  0.001508474349975586
local_in_edges_tensor generation:  0.0008058547973632812
mini_batch_src_global generation:  0.0009567737579345703
r_  generation:  0.008477926254272461
local_output_nid generation:  0.0015177726745605469
local_in_edges_tensor generation:  0.0007810592651367188
mini_batch_src_global generation:  0.0009133815765380859
r_  generation:  0.008234977722167969
local_output_nid generation:  0.0015077590942382812
local_in_edges_tensor generation:  0.0007712841033935547
mini_batch_src_global generation:  0.0009200572967529297
r_  generation:  0.008432865142822266
local_output_nid generation:  0.0014858245849609375
local_in_edges_tensor generation:  0.0007624626159667969
mini_batch_src_global generation:  0.0008985996246337891
r_  generation:  0.00818490982055664
local_output_nid generation:  0.001491546630859375
local_in_edges_tensor generation:  0.0007815361022949219
mini_batch_src_global generation:  0.0008900165557861328
r_  generation:  0.00809621810913086
local_output_nid generation:  0.0014874935150146484
local_in_edges_tensor generation:  0.0007643699645996094
mini_batch_src_global generation:  0.0008795261383056641
r_  generation:  0.008148670196533203
local_output_nid generation:  0.0014557838439941406
local_in_edges_tensor generation:  0.0007615089416503906
mini_batch_src_global generation:  0.0009992122650146484
r_  generation:  0.008384943008422852
local_output_nid generation:  0.0033273696899414062
local_in_edges_tensor generation:  0.0007908344268798828
mini_batch_src_global generation:  0.0009222030639648438
r_  generation:  0.008508682250976562
local_output_nid generation:  0.0015099048614501953
local_in_edges_tensor generation:  0.0008194446563720703
mini_batch_src_global generation:  0.0008885860443115234
r_  generation:  0.008157014846801758
local_output_nid generation:  0.0014636516571044922
local_in_edges_tensor generation:  0.0007593631744384766
mini_batch_src_global generation:  0.0009160041809082031
r_  generation:  0.008367300033569336
local_output_nid generation:  0.001474142074584961
local_in_edges_tensor generation:  0.0008320808410644531
mini_batch_src_global generation:  0.0010433197021484375
r_  generation:  0.009441614151000977
local_output_nid generation:  0.0015010833740234375
local_in_edges_tensor generation:  0.0007889270782470703
mini_batch_src_global generation:  0.0009450912475585938
r_  generation:  0.008316516876220703
local_output_nid generation:  0.0015101432800292969
local_in_edges_tensor generation:  0.0007989406585693359
mini_batch_src_global generation:  0.0009284019470214844
r_  generation:  0.008480072021484375
local_output_nid generation:  0.001495361328125
local_in_edges_tensor generation:  0.0007803440093994141
mini_batch_src_global generation:  0.0009031295776367188
r_  generation:  0.008103370666503906
local_output_nid generation:  0.001506805419921875
local_in_edges_tensor generation:  0.0007627010345458984
mini_batch_src_global generation:  0.0009160041809082031
r_  generation:  0.00814676284790039
local_output_nid generation:  0.0014960765838623047
local_in_edges_tensor generation:  0.0007746219635009766
mini_batch_src_global generation:  0.0009021759033203125
r_  generation:  0.008165359497070312
----------------------check_connections_block total spend ----------------------------- 0.48789000511169434
generate_one_block  0.02110767364501953
generate_one_block  0.017636775970458984
generate_one_block  0.015122652053833008
generate_one_block  0.01443624496459961
generate_one_block  0.01735067367553711
generate_one_block  0.01448369026184082
generate_one_block  0.014290332794189453
generate_one_block  0.014374971389770508
generate_one_block  0.014578580856323242
generate_one_block  0.01431584358215332
generate_one_block  0.014446020126342773
generate_one_block  0.014357328414916992
generate_one_block  0.014380931854248047
generate_one_block  0.014564275741577148
generate_one_block  0.014371633529663086
generate_one_block  0.014954566955566406
generate_one_block  0.014699459075927734
generate_one_block  0.014488697052001953
generate_one_block  0.016188383102416992
generate_one_block  0.014419078826904297
generate_one_block  0.014212369918823242
generate_one_block  0.014089822769165039
generate_one_block  0.014607667922973633
generate_one_block  0.014431238174438477
generate_one_block  0.014194726943969727
generate_one_block  0.014515161514282227
generate_one_block  0.015045166015625
generate_one_block  0.014384746551513672
generate_one_block  0.014660358428955078
generate_one_block  0.014007568359375
generate_one_block  0.014139890670776367
generate_one_block  0.01430368423461914
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03634476661682129
gen group dst list time:  0.02083897590637207
time for parepare:  0.023775815963745117
local_output_nid generation:  0.005622148513793945
local_in_edges_tensor generation:  0.01596689224243164
mini_batch_src_global generation:  0.013065576553344727
r_  generation:  0.1246335506439209
local_output_nid generation:  0.007775545120239258
local_in_edges_tensor generation:  0.009837865829467773
mini_batch_src_global generation:  0.016514062881469727
r_  generation:  0.1648106575012207
local_output_nid generation:  0.013727664947509766
local_in_edges_tensor generation:  0.04536008834838867
mini_batch_src_global generation:  0.01663661003112793
r_  generation:  0.14001917839050293
local_output_nid generation:  0.012172937393188477
local_in_edges_tensor generation:  0.013305902481079102
mini_batch_src_global generation:  0.018329381942749023
r_  generation:  0.13186907768249512
local_output_nid generation:  0.010396718978881836
local_in_edges_tensor generation:  0.009559869766235352
mini_batch_src_global generation:  0.01911759376525879
r_  generation:  0.13939666748046875
local_output_nid generation:  0.009518146514892578
local_in_edges_tensor generation:  0.009745359420776367
mini_batch_src_global generation:  0.01935577392578125
r_  generation:  0.13573408126831055
local_output_nid generation:  0.008244752883911133
local_in_edges_tensor generation:  0.007566690444946289
mini_batch_src_global generation:  0.018960952758789062
r_  generation:  0.17080473899841309
local_output_nid generation:  0.008123397827148438
local_in_edges_tensor generation:  0.010698318481445312
mini_batch_src_global generation:  0.02193284034729004
r_  generation:  0.1378486156463623
local_output_nid generation:  0.008242130279541016
local_in_edges_tensor generation:  0.00801539421081543
mini_batch_src_global generation:  0.01895618438720703
r_  generation:  0.13828468322753906
local_output_nid generation:  0.008549690246582031
local_in_edges_tensor generation:  0.007670164108276367
mini_batch_src_global generation:  0.025331735610961914
r_  generation:  0.14287209510803223
local_output_nid generation:  0.010313272476196289
local_in_edges_tensor generation:  0.007776021957397461
mini_batch_src_global generation:  0.019305706024169922
r_  generation:  0.13605308532714844
local_output_nid generation:  0.008851289749145508
local_in_edges_tensor generation:  0.00762629508972168
mini_batch_src_global generation:  0.016448020935058594
r_  generation:  0.13364744186401367
local_output_nid generation:  0.008858203887939453
local_in_edges_tensor generation:  0.00752711296081543
mini_batch_src_global generation:  0.016220808029174805
r_  generation:  0.1345963478088379
local_output_nid generation:  0.009019613265991211
local_in_edges_tensor generation:  0.008282184600830078
mini_batch_src_global generation:  0.016383647918701172
r_  generation:  0.13644766807556152
local_output_nid generation:  0.00898122787475586
local_in_edges_tensor generation:  0.007489204406738281
mini_batch_src_global generation:  0.016274213790893555
r_  generation:  0.13545513153076172
local_output_nid generation:  0.009402275085449219
local_in_edges_tensor generation:  0.008798837661743164
mini_batch_src_global generation:  0.01810479164123535
r_  generation:  0.14324259757995605
local_output_nid generation:  0.009164571762084961
local_in_edges_tensor generation:  0.00786900520324707
mini_batch_src_global generation:  0.016894817352294922
r_  generation:  0.13934612274169922
local_output_nid generation:  0.008791685104370117
local_in_edges_tensor generation:  0.007531881332397461
mini_batch_src_global generation:  0.01650071144104004
r_  generation:  0.1367807388305664
local_output_nid generation:  0.008825302124023438
local_in_edges_tensor generation:  0.007700204849243164
mini_batch_src_global generation:  0.016775846481323242
r_  generation:  0.17221879959106445
local_output_nid generation:  0.013295650482177734
local_in_edges_tensor generation:  0.010465145111083984
mini_batch_src_global generation:  0.020264863967895508
r_  generation:  0.15481233596801758
local_output_nid generation:  0.015377044677734375
local_in_edges_tensor generation:  0.012900590896606445
mini_batch_src_global generation:  0.033440589904785156
r_  generation:  0.13947534561157227
local_output_nid generation:  0.010917425155639648
local_in_edges_tensor generation:  0.008132696151733398
mini_batch_src_global generation:  0.016748905181884766
r_  generation:  0.1357419490814209
local_output_nid generation:  0.009651422500610352
local_in_edges_tensor generation:  0.00884866714477539
mini_batch_src_global generation:  0.017464637756347656
r_  generation:  0.1393742561340332
local_output_nid generation:  0.009341001510620117
local_in_edges_tensor generation:  0.009288787841796875
mini_batch_src_global generation:  0.016518354415893555
r_  generation:  0.13798856735229492
local_output_nid generation:  0.00901031494140625
local_in_edges_tensor generation:  0.007572174072265625
mini_batch_src_global generation:  0.016103029251098633
r_  generation:  0.13602280616760254
local_output_nid generation:  0.0091552734375
local_in_edges_tensor generation:  0.007715463638305664
mini_batch_src_global generation:  0.01670527458190918
r_  generation:  0.13950705528259277
local_output_nid generation:  0.009267807006835938
local_in_edges_tensor generation:  0.009420394897460938
mini_batch_src_global generation:  0.017151594161987305
r_  generation:  0.14443564414978027
local_output_nid generation:  0.008996009826660156
local_in_edges_tensor generation:  0.00792241096496582
mini_batch_src_global generation:  0.01724982261657715
r_  generation:  0.14069461822509766
local_output_nid generation:  0.00888967514038086
local_in_edges_tensor generation:  0.008117914199829102
mini_batch_src_global generation:  0.016592025756835938
r_  generation:  0.14126920700073242
local_output_nid generation:  0.008652210235595703
local_in_edges_tensor generation:  0.007360219955444336
mini_batch_src_global generation:  0.0160369873046875
r_  generation:  0.1871790885925293
local_output_nid generation:  0.008680105209350586
local_in_edges_tensor generation:  0.007547140121459961
mini_batch_src_global generation:  0.019235610961914062
r_  generation:  0.14075231552124023
local_output_nid generation:  0.008809089660644531
local_in_edges_tensor generation:  0.007519960403442383
mini_batch_src_global generation:  0.016479015350341797
r_  generation:  0.1385059356689453
----------------------check_connections_block total spend ----------------------------- 6.874409198760986
generate_one_block  0.1839127540588379
generate_one_block  0.17999529838562012
generate_one_block  0.1783456802368164
generate_one_block  0.17120957374572754
generate_one_block  0.20869898796081543
generate_one_block  0.17842960357666016
generate_one_block  0.17801785469055176
generate_one_block  0.1763622760772705
generate_one_block  0.1805257797241211
generate_one_block  0.17625021934509277
generate_one_block  0.17375564575195312
generate_one_block  0.17165112495422363
generate_one_block  0.17222905158996582
generate_one_block  0.17618060111999512
generate_one_block  0.17459988594055176
generate_one_block  0.18589210510253906
generate_one_block  0.17821788787841797
generate_one_block  0.1747732162475586
generate_one_block  0.1752476692199707
generate_one_block  0.17942070960998535
generate_one_block  0.18034052848815918
generate_one_block  0.17869305610656738
generate_one_block  0.1850440502166748
generate_one_block  0.17998886108398438
generate_one_block  0.17761445045471191
generate_one_block  0.18728065490722656
generate_one_block  0.19067668914794922
generate_one_block  0.18183636665344238
generate_one_block  0.1816272735595703
generate_one_block  0.1712045669555664
generate_one_block  0.17589354515075684
generate_one_block  0.1780409812927246
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03254437446594238
gen group dst list time:  0.10632705688476562
time for parepare:  0.021481752395629883
local_output_nid generation:  0.02439594268798828
local_in_edges_tensor generation:  0.04657554626464844
mini_batch_src_global generation:  0.03709077835083008
r_  generation:  0.3935561180114746
local_output_nid generation:  0.029241561889648438
local_in_edges_tensor generation:  0.031533002853393555
mini_batch_src_global generation:  0.04732775688171387
r_  generation:  0.3919391632080078
local_output_nid generation:  0.029099225997924805
local_in_edges_tensor generation:  0.02706122398376465
mini_batch_src_global generation:  0.047333717346191406
r_  generation:  0.4072413444519043
local_output_nid generation:  0.028752803802490234
local_in_edges_tensor generation:  0.03081798553466797
mini_batch_src_global generation:  0.04754757881164551
r_  generation:  0.3949592113494873
local_output_nid generation:  0.029023408889770508
local_in_edges_tensor generation:  0.025513410568237305
mini_batch_src_global generation:  0.04680180549621582
r_  generation:  0.41033077239990234
local_output_nid generation:  0.02828812599182129
local_in_edges_tensor generation:  0.0253448486328125
mini_batch_src_global generation:  0.048250436782836914
r_  generation:  0.4000556468963623
local_output_nid generation:  0.026885032653808594
local_in_edges_tensor generation:  0.024929285049438477
mini_batch_src_global generation:  0.046025991439819336
r_  generation:  0.41649556159973145
local_output_nid generation:  0.027256011962890625
local_in_edges_tensor generation:  0.027234792709350586
mini_batch_src_global generation:  0.04921841621398926
r_  generation:  0.3985416889190674
local_output_nid generation:  0.027458667755126953
local_in_edges_tensor generation:  0.025795459747314453
mini_batch_src_global generation:  0.04652881622314453
r_  generation:  0.40695762634277344
local_output_nid generation:  0.026767969131469727
local_in_edges_tensor generation:  0.024985074996948242
mini_batch_src_global generation:  0.04742598533630371
r_  generation:  0.39550042152404785
local_output_nid generation:  0.026916027069091797
local_in_edges_tensor generation:  0.026143312454223633
mini_batch_src_global generation:  0.04588580131530762
r_  generation:  0.404926061630249
local_output_nid generation:  0.026792287826538086
local_in_edges_tensor generation:  0.02904367446899414
mini_batch_src_global generation:  0.04935145378112793
r_  generation:  0.40572261810302734
local_output_nid generation:  0.026604652404785156
local_in_edges_tensor generation:  0.030211448669433594
mini_batch_src_global generation:  0.04647254943847656
r_  generation:  0.4016890525817871
local_output_nid generation:  0.02732253074645996
local_in_edges_tensor generation:  0.027971267700195312
mini_batch_src_global generation:  0.048485755920410156
r_  generation:  0.401644229888916
local_output_nid generation:  0.02680206298828125
local_in_edges_tensor generation:  0.028226137161254883
mini_batch_src_global generation:  0.0466160774230957
r_  generation:  0.40204453468322754
local_output_nid generation:  0.027847766876220703
local_in_edges_tensor generation:  0.026805877685546875
mini_batch_src_global generation:  0.04874777793884277
r_  generation:  0.4108295440673828
local_output_nid generation:  0.027107715606689453
local_in_edges_tensor generation:  0.03142237663269043
mini_batch_src_global generation:  0.04701590538024902
r_  generation:  0.41214942932128906
local_output_nid generation:  0.027433156967163086
local_in_edges_tensor generation:  0.02649235725402832
mini_batch_src_global generation:  0.05106782913208008
r_  generation:  0.4011220932006836
local_output_nid generation:  0.028209447860717773
local_in_edges_tensor generation:  0.0270230770111084
mini_batch_src_global generation:  0.04612135887145996
r_  generation:  0.40830111503601074
local_output_nid generation:  0.03206276893615723
local_in_edges_tensor generation:  0.03229641914367676
mini_batch_src_global generation:  0.0586545467376709
r_  generation:  0.41221046447753906
local_output_nid generation:  0.02868962287902832
local_in_edges_tensor generation:  0.028486013412475586
mini_batch_src_global generation:  0.04626941680908203
r_  generation:  0.4057776927947998
local_output_nid generation:  0.027709245681762695
local_in_edges_tensor generation:  0.02975296974182129
mini_batch_src_global generation:  0.047933101654052734
r_  generation:  0.3962686061859131
local_output_nid generation:  0.02812671661376953
local_in_edges_tensor generation:  0.02538323402404785
mini_batch_src_global generation:  0.046637535095214844
r_  generation:  0.4073667526245117
local_output_nid generation:  0.027839183807373047
local_in_edges_tensor generation:  0.032071590423583984
mini_batch_src_global generation:  0.04767918586730957
r_  generation:  0.40286993980407715
local_output_nid generation:  0.02804875373840332
local_in_edges_tensor generation:  0.03819155693054199
mini_batch_src_global generation:  0.04845309257507324
r_  generation:  0.41059207916259766
local_output_nid generation:  0.027966976165771484
local_in_edges_tensor generation:  0.0263211727142334
mini_batch_src_global generation:  0.04945874214172363
r_  generation:  0.4069695472717285
local_output_nid generation:  0.028238773345947266
local_in_edges_tensor generation:  0.031314849853515625
mini_batch_src_global generation:  0.047315359115600586
r_  generation:  0.4093163013458252
local_output_nid generation:  0.02799701690673828
local_in_edges_tensor generation:  0.024625062942504883
mini_batch_src_global generation:  0.04743504524230957
r_  generation:  0.4006357192993164
local_output_nid generation:  0.028200149536132812
local_in_edges_tensor generation:  0.02530074119567871
mini_batch_src_global generation:  0.048117637634277344
r_  generation:  0.4091193675994873
local_output_nid generation:  0.027680635452270508
local_in_edges_tensor generation:  0.026641130447387695
mini_batch_src_global generation:  0.046923160552978516
r_  generation:  0.40125346183776855
local_output_nid generation:  0.02768397331237793
local_in_edges_tensor generation:  0.024877309799194336
mini_batch_src_global generation:  0.04861140251159668
r_  generation:  0.4062924385070801
local_output_nid generation:  0.027999401092529297
local_in_edges_tensor generation:  0.027003049850463867
mini_batch_src_global generation:  0.04721498489379883
r_  generation:  0.40898704528808594
----------------------check_connections_block total spend ----------------------------- 19.13911771774292
generate_one_block  0.5519495010375977
generate_one_block  0.541658878326416
generate_one_block  0.5349345207214355
generate_one_block  0.5326993465423584
generate_one_block  0.6446270942687988
generate_one_block  0.5332975387573242
generate_one_block  0.5444393157958984
generate_one_block  0.5307810306549072
generate_one_block  0.5335891246795654
generate_one_block  0.5246551036834717
generate_one_block  0.5241928100585938
generate_one_block  0.5321390628814697
generate_one_block  0.5270202159881592
generate_one_block  0.5398375988006592
generate_one_block  0.5421204566955566
generate_one_block  0.5463380813598633
generate_one_block  0.533562183380127
generate_one_block  0.5286140441894531
generate_one_block  0.5276937484741211
generate_one_block  0.5309340953826904
generate_one_block  0.5380263328552246
generate_one_block  0.5245401859283447
generate_one_block  0.5383186340332031
generate_one_block  0.5434346199035645
generate_one_block  0.5454318523406982
generate_one_block  0.5367865562438965
generate_one_block  0.543046236038208
generate_one_block  0.5298740863800049
generate_one_block  0.5467824935913086
generate_one_block  0.5278124809265137
generate_one_block  0.5269887447357178
generate_one_block  0.5315656661987305
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.11995744705200195  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

connection checking time:  26.013526916503906
block generation total time  22.97964859008789
average batch blocks generation time:  0.7181140184402466
block dataloader generation time/epoch 51.38284166653951
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10500669479370117  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.832836627960205  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10399103164672852  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.854989528656006  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10501670837402344  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.853211402893066  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10297775268554688  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.552613258361816  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10505867004394531  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.074589729309082  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10309362411499023  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.704903602600098  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10280513763427734  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.472463130950928  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10296154022216797  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.668927192687988  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1039896011352539  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.702252388000488  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10275697708129883  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.495836734771729  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10388851165771484  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.590909481048584  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10290145874023438  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.476000785827637  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10246419906616211  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.43679666519165  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10395956039428711  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.719974040985107  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10281801223754883  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.530633926391602  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10456609725952148  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.187857627868652  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10272407531738281  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.751823425292969  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10283231735229492  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.57679557800293  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1029367446899414  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.662672996520996  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10294055938720703  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.548876762390137  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1028890609741211  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.676966667175293  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10278797149658203  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.448256015777588  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10397100448608398  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.819808959960938  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10319042205810547  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.794050693511963  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1038980484008789  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.549849510192871  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10409927368164062  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.822144031524658  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10507488250732422  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.094834327697754  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10296106338500977  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.773419380187988  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1050271987915039  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.940454483032227  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10245418548583984  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.340705394744873  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10269880294799805  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.556958198547363  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10279130935668945  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.548070430755615  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.033534593880176544 |0.012462109327316284 |0.26453763991594315 |9.100139141082764e-05 |0.4292808249592781 |0.0058002471923828125 |
----------------------------------------------------------pseudo_mini_loss sum 1.562525987625122
Total (block generation + training)time/epoch 75.08900618553162
Training time/epoch 23.73292303085327
Training time without block to device /epoch 23.33413553237915
Training time without total dataloading part /epoch 22.21090316772461
load block tensor time/epoch 1.0731070041656494
block to device time/epoch 0.3987874984741211
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 12 |
Number of nodes for computation during this epoch:  8573942
Number of first layer input nodes during this epoch:  4652407
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.11959362030029297  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02574777603149414
random selection method range initialization spend 0.0066204071044921875
time for parepare:  0.026080608367919922
local_output_nid generation:  0.0017819404602050781
local_in_edges_tensor generation:  0.006421327590942383
mini_batch_src_global generation:  0.0021474361419677734
r_  generation:  0.008885860443115234
local_output_nid generation:  0.0017693042755126953
local_in_edges_tensor generation:  0.0012054443359375
mini_batch_src_global generation:  0.0019426345825195312
r_  generation:  0.00860595703125
local_output_nid generation:  0.0019843578338623047
local_in_edges_tensor generation:  0.0011050701141357422
mini_batch_src_global generation:  0.0012745857238769531
r_  generation:  0.00815272331237793
local_output_nid generation:  0.0019910335540771484
local_in_edges_tensor generation:  0.001108407974243164
mini_batch_src_global generation:  0.001363992691040039
r_  generation:  0.008175373077392578
local_output_nid generation:  0.002009153366088867
local_in_edges_tensor generation:  0.0011570453643798828
mini_batch_src_global generation:  0.0012936592102050781
r_  generation:  0.00820469856262207
local_output_nid generation:  0.002036571502685547
local_in_edges_tensor generation:  0.0010008811950683594
mini_batch_src_global generation:  0.0011191368103027344
r_  generation:  0.008207321166992188
local_output_nid generation:  0.002046823501586914
local_in_edges_tensor generation:  0.0010211467742919922
mini_batch_src_global generation:  0.001135110855102539
r_  generation:  0.008381128311157227
local_output_nid generation:  0.002057313919067383
local_in_edges_tensor generation:  0.0010204315185546875
mini_batch_src_global generation:  0.00110626220703125
r_  generation:  0.008231401443481445
local_output_nid generation:  0.002039194107055664
local_in_edges_tensor generation:  0.0010058879852294922
mini_batch_src_global generation:  0.001085519790649414
r_  generation:  0.008251667022705078
local_output_nid generation:  0.0020875930786132812
local_in_edges_tensor generation:  0.0009756088256835938
mini_batch_src_global generation:  0.0010914802551269531
r_  generation:  0.008330821990966797
local_output_nid generation:  0.002085447311401367
local_in_edges_tensor generation:  0.0010106563568115234
mini_batch_src_global generation:  0.0010943412780761719
r_  generation:  0.008388280868530273
local_output_nid generation:  0.0021054744720458984
local_in_edges_tensor generation:  0.0010263919830322266
mini_batch_src_global generation:  0.00107574462890625
r_  generation:  0.008417844772338867
local_output_nid generation:  0.002117633819580078
local_in_edges_tensor generation:  0.0010886192321777344
mini_batch_src_global generation:  0.0011858940124511719
r_  generation:  0.008694648742675781
local_output_nid generation:  0.0021467208862304688
local_in_edges_tensor generation:  0.0010852813720703125
mini_batch_src_global generation:  0.001306295394897461
r_  generation:  0.011186838150024414
local_output_nid generation:  0.0022122859954833984
local_in_edges_tensor generation:  0.0011181831359863281
mini_batch_src_global generation:  0.0011031627655029297
r_  generation:  0.008394956588745117
local_output_nid generation:  0.0038177967071533203
local_in_edges_tensor generation:  0.0018417835235595703
mini_batch_src_global generation:  0.002573251724243164
r_  generation:  0.013670682907104492
local_output_nid generation:  0.0024132728576660156
local_in_edges_tensor generation:  0.0010995864868164062
mini_batch_src_global generation:  0.0013642311096191406
r_  generation:  0.008671760559082031
local_output_nid generation:  0.0021774768829345703
local_in_edges_tensor generation:  0.001039266586303711
mini_batch_src_global generation:  0.0010750293731689453
r_  generation:  0.008325815200805664
local_output_nid generation:  0.002040386199951172
local_in_edges_tensor generation:  0.0009591579437255859
mini_batch_src_global generation:  0.0010411739349365234
r_  generation:  0.00872039794921875
local_output_nid generation:  0.0019664764404296875
local_in_edges_tensor generation:  0.0009596347808837891
mini_batch_src_global generation:  0.0009799003601074219
r_  generation:  0.008113861083984375
local_output_nid generation:  0.0019295215606689453
local_in_edges_tensor generation:  0.0008878707885742188
mini_batch_src_global generation:  0.0009829998016357422
r_  generation:  0.008275985717773438
local_output_nid generation:  0.0018813610076904297
local_in_edges_tensor generation:  0.0009210109710693359
mini_batch_src_global generation:  0.0012683868408203125
r_  generation:  0.008617162704467773
local_output_nid generation:  0.0018229484558105469
local_in_edges_tensor generation:  0.0008828639984130859
mini_batch_src_global generation:  0.0009698867797851562
r_  generation:  0.008105993270874023
local_output_nid generation:  0.0017871856689453125
local_in_edges_tensor generation:  0.0008556842803955078
mini_batch_src_global generation:  0.0009307861328125
r_  generation:  0.008032560348510742
local_output_nid generation:  0.0017614364624023438
local_in_edges_tensor generation:  0.0008428096771240234
mini_batch_src_global generation:  0.0009281635284423828
r_  generation:  0.008488893508911133
local_output_nid generation:  0.0017163753509521484
local_in_edges_tensor generation:  0.0008330345153808594
mini_batch_src_global generation:  0.0009551048278808594
r_  generation:  0.008104324340820312
local_output_nid generation:  0.0016913414001464844
local_in_edges_tensor generation:  0.0008177757263183594
mini_batch_src_global generation:  0.0009069442749023438
r_  generation:  0.00861811637878418
local_output_nid generation:  0.0016820430755615234
local_in_edges_tensor generation:  0.0008196830749511719
mini_batch_src_global generation:  0.0009377002716064453
r_  generation:  0.008299827575683594
local_output_nid generation:  0.0016436576843261719
local_in_edges_tensor generation:  0.0008444786071777344
mini_batch_src_global generation:  0.0010263919830322266
r_  generation:  0.009536027908325195
local_output_nid generation:  0.0016524791717529297
local_in_edges_tensor generation:  0.0008356571197509766
mini_batch_src_global generation:  0.0010457038879394531
r_  generation:  0.008362054824829102
local_output_nid generation:  0.0016238689422607422
local_in_edges_tensor generation:  0.0008211135864257812
mini_batch_src_global generation:  0.0009865760803222656
r_  generation:  0.008641719818115234
local_output_nid generation:  0.0016014575958251953
local_in_edges_tensor generation:  0.0008080005645751953
mini_batch_src_global generation:  0.0009350776672363281
r_  generation:  0.00842595100402832
----------------------check_connections_block total spend ----------------------------- 0.544731616973877
generate_one_block  0.022879600524902344
generate_one_block  0.017585277557373047
generate_one_block  0.015019655227661133
generate_one_block  0.01491689682006836
generate_one_block  0.014819860458374023
generate_one_block  0.014549016952514648
generate_one_block  0.014554500579833984
generate_one_block  0.01610112190246582
generate_one_block  0.01425480842590332
generate_one_block  0.01439809799194336
generate_one_block  0.014641523361206055
generate_one_block  0.014706611633300781
generate_one_block  0.014900445938110352
generate_one_block  0.015058279037475586
generate_one_block  0.015868425369262695
generate_one_block  0.013952493667602539
generate_one_block  0.014539003372192383
generate_one_block  0.014502286911010742
generate_one_block  0.014718055725097656
generate_one_block  0.014234066009521484
generate_one_block  0.014508962631225586
generate_one_block  0.01875138282775879
generate_one_block  0.014148712158203125
generate_one_block  0.013947010040283203
generate_one_block  0.014986038208007812
generate_one_block  0.01428675651550293
generate_one_block  0.014436483383178711
generate_one_block  0.014569759368896484
generate_one_block  0.015068531036376953
generate_one_block  0.014478445053100586
generate_one_block  0.014836311340332031
generate_one_block  0.014514684677124023
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.06324982643127441
gen group dst list time:  0.02552962303161621
time for parepare:  0.022563457489013672
local_output_nid generation:  0.005574703216552734
local_in_edges_tensor generation:  0.019128799438476562
mini_batch_src_global generation:  0.015366315841674805
r_  generation:  0.12445950508117676
local_output_nid generation:  0.007788181304931641
local_in_edges_tensor generation:  0.009812116622924805
mini_batch_src_global generation:  0.02582836151123047
r_  generation:  0.13746881484985352
local_output_nid generation:  0.012185335159301758
local_in_edges_tensor generation:  0.04099106788635254
mini_batch_src_global generation:  0.015158414840698242
r_  generation:  0.14146995544433594
local_output_nid generation:  0.013326883316040039
local_in_edges_tensor generation:  0.011766672134399414
mini_batch_src_global generation:  0.016733646392822266
r_  generation:  0.14507389068603516
local_output_nid generation:  0.013680219650268555
local_in_edges_tensor generation:  0.011851072311401367
mini_batch_src_global generation:  0.018241167068481445
r_  generation:  0.14934492111206055
local_output_nid generation:  0.013683795928955078
local_in_edges_tensor generation:  0.011332035064697266
mini_batch_src_global generation:  0.017852067947387695
r_  generation:  0.14938688278198242
local_output_nid generation:  0.013591766357421875
local_in_edges_tensor generation:  0.01093149185180664
mini_batch_src_global generation:  0.01839447021484375
r_  generation:  0.14954233169555664
local_output_nid generation:  0.013140439987182617
local_in_edges_tensor generation:  0.011001348495483398
mini_batch_src_global generation:  0.018285036087036133
r_  generation:  0.1533825397491455
local_output_nid generation:  0.01297140121459961
local_in_edges_tensor generation:  0.01101231575012207
mini_batch_src_global generation:  0.04554343223571777
r_  generation:  0.14319682121276855
local_output_nid generation:  0.01100611686706543
local_in_edges_tensor generation:  0.00970768928527832
mini_batch_src_global generation:  0.020638465881347656
r_  generation:  0.1409752368927002
local_output_nid generation:  0.010046243667602539
local_in_edges_tensor generation:  0.009405136108398438
mini_batch_src_global generation:  0.019381284713745117
r_  generation:  0.1598644256591797
local_output_nid generation:  0.013361454010009766
local_in_edges_tensor generation:  0.01205897331237793
mini_batch_src_global generation:  0.03961491584777832
r_  generation:  0.14339232444763184
local_output_nid generation:  0.011277198791503906
local_in_edges_tensor generation:  0.009102582931518555
mini_batch_src_global generation:  0.020093441009521484
r_  generation:  0.14599323272705078
local_output_nid generation:  0.00979757308959961
local_in_edges_tensor generation:  0.008674144744873047
mini_batch_src_global generation:  0.020197629928588867
r_  generation:  0.14614033699035645
local_output_nid generation:  0.008870601654052734
local_in_edges_tensor generation:  0.009342432022094727
mini_batch_src_global generation:  0.01941227912902832
r_  generation:  0.13923025131225586
local_output_nid generation:  0.008644580841064453
local_in_edges_tensor generation:  0.007798194885253906
mini_batch_src_global generation:  0.019358396530151367
r_  generation:  0.1369938850402832
local_output_nid generation:  0.008913993835449219
local_in_edges_tensor generation:  0.0075604915618896484
mini_batch_src_global generation:  0.019749879837036133
r_  generation:  0.14311623573303223
local_output_nid generation:  0.008617639541625977
local_in_edges_tensor generation:  0.007500410079956055
mini_batch_src_global generation:  0.017451047897338867
r_  generation:  0.14275121688842773
local_output_nid generation:  0.008756637573242188
local_in_edges_tensor generation:  0.008154869079589844
mini_batch_src_global generation:  0.018054723739624023
r_  generation:  0.14735722541809082
local_output_nid generation:  0.008550167083740234
local_in_edges_tensor generation:  0.00843954086303711
mini_batch_src_global generation:  0.017685413360595703
r_  generation:  0.14018893241882324
local_output_nid generation:  0.00881648063659668
local_in_edges_tensor generation:  0.00797581672668457
mini_batch_src_global generation:  0.017091035842895508
r_  generation:  0.14289069175720215
local_output_nid generation:  0.008878707885742188
local_in_edges_tensor generation:  0.008589029312133789
mini_batch_src_global generation:  0.018482446670532227
r_  generation:  0.14526009559631348
local_output_nid generation:  0.008438348770141602
local_in_edges_tensor generation:  0.007208585739135742
mini_batch_src_global generation:  0.016871929168701172
r_  generation:  0.13898897171020508
local_output_nid generation:  0.008476972579956055
local_in_edges_tensor generation:  0.00721287727355957
mini_batch_src_global generation:  0.016975879669189453
r_  generation:  0.13713288307189941
local_output_nid generation:  0.008764028549194336
local_in_edges_tensor generation:  0.007578849792480469
mini_batch_src_global generation:  0.0180819034576416
r_  generation:  0.1432819366455078
local_output_nid generation:  0.008557319641113281
local_in_edges_tensor generation:  0.007334709167480469
mini_batch_src_global generation:  0.017412424087524414
r_  generation:  0.14008784294128418
local_output_nid generation:  0.008760452270507812
local_in_edges_tensor generation:  0.0073015689849853516
mini_batch_src_global generation:  0.017534494400024414
r_  generation:  0.14218974113464355
local_output_nid generation:  0.00872182846069336
local_in_edges_tensor generation:  0.009019136428833008
mini_batch_src_global generation:  0.017895221710205078
r_  generation:  0.1435401439666748
local_output_nid generation:  0.008966922760009766
local_in_edges_tensor generation:  0.008231163024902344
mini_batch_src_global generation:  0.018848657608032227
r_  generation:  0.14988088607788086
local_output_nid generation:  0.008670330047607422
local_in_edges_tensor generation:  0.007408857345581055
mini_batch_src_global generation:  0.01759624481201172
r_  generation:  0.1449127197265625
local_output_nid generation:  0.008821725845336914
local_in_edges_tensor generation:  0.007594108581542969
mini_batch_src_global generation:  0.01859593391418457
r_  generation:  0.15493297576904297
local_output_nid generation:  0.00871419906616211
local_in_edges_tensor generation:  0.007406473159790039
mini_batch_src_global generation:  0.01785898208618164
r_  generation:  0.1482257843017578
----------------------check_connections_block total spend ----------------------------- 7.027574062347412
generate_one_block  0.19269561767578125
generate_one_block  0.18005013465881348
generate_one_block  0.17894220352172852
generate_one_block  0.18311738967895508
generate_one_block  0.21785283088684082
generate_one_block  0.1845107078552246
generate_one_block  0.17670512199401855
generate_one_block  0.17733478546142578
generate_one_block  0.18107175827026367
generate_one_block  0.17790579795837402
generate_one_block  0.17820215225219727
generate_one_block  0.17928123474121094
generate_one_block  0.18198728561401367
generate_one_block  0.1820223331451416
generate_one_block  0.17219853401184082
generate_one_block  0.1707017421722412
generate_one_block  0.17654728889465332
generate_one_block  0.17430663108825684
generate_one_block  0.18155813217163086
generate_one_block  0.18267250061035156
generate_one_block  0.1818697452545166
generate_one_block  0.1875152587890625
generate_one_block  0.1855611801147461
generate_one_block  0.1724715232849121
generate_one_block  0.17974591255187988
generate_one_block  0.17455816268920898
generate_one_block  0.1794590950012207
generate_one_block  0.18267273902893066
generate_one_block  0.18824553489685059
generate_one_block  0.17586898803710938
generate_one_block  0.18635010719299316
generate_one_block  0.17998385429382324
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03538250923156738
gen group dst list time:  0.10813093185424805
time for parepare:  0.021132707595825195
local_output_nid generation:  0.024623870849609375
local_in_edges_tensor generation:  0.04581928253173828
mini_batch_src_global generation:  0.03867745399475098
r_  generation:  0.3980679512023926
local_output_nid generation:  0.02845478057861328
local_in_edges_tensor generation:  0.03164982795715332
mini_batch_src_global generation:  0.04680180549621582
r_  generation:  0.39652228355407715
local_output_nid generation:  0.028916597366333008
local_in_edges_tensor generation:  0.02598857879638672
mini_batch_src_global generation:  0.04561495780944824
r_  generation:  0.4264340400695801
local_output_nid generation:  0.03193402290344238
local_in_edges_tensor generation:  0.03307700157165527
mini_batch_src_global generation:  0.04790329933166504
r_  generation:  0.3991384506225586
local_output_nid generation:  0.0296938419342041
local_in_edges_tensor generation:  0.027288198471069336
mini_batch_src_global generation:  0.04647397994995117
r_  generation:  0.4105966091156006
local_output_nid generation:  0.028841257095336914
local_in_edges_tensor generation:  0.026596784591674805
mini_batch_src_global generation:  0.04802846908569336
r_  generation:  0.4016895294189453
local_output_nid generation:  0.027991533279418945
local_in_edges_tensor generation:  0.027172088623046875
mini_batch_src_global generation:  0.04707598686218262
r_  generation:  0.4106128215789795
local_output_nid generation:  0.02746748924255371
local_in_edges_tensor generation:  0.026018619537353516
mini_batch_src_global generation:  0.04851555824279785
r_  generation:  0.3989067077636719
local_output_nid generation:  0.0273745059967041
local_in_edges_tensor generation:  0.02577805519104004
mini_batch_src_global generation:  0.046198129653930664
r_  generation:  0.40535473823547363
local_output_nid generation:  0.02773761749267578
local_in_edges_tensor generation:  0.026716232299804688
mini_batch_src_global generation:  0.04788470268249512
r_  generation:  0.40321922302246094
local_output_nid generation:  0.027441740036010742
local_in_edges_tensor generation:  0.02597212791442871
mini_batch_src_global generation:  0.04654264450073242
r_  generation:  0.40499234199523926
local_output_nid generation:  0.027539968490600586
local_in_edges_tensor generation:  0.027501344680786133
mini_batch_src_global generation:  0.0495305061340332
r_  generation:  0.39854979515075684
local_output_nid generation:  0.02780294418334961
local_in_edges_tensor generation:  0.025958776473999023
mini_batch_src_global generation:  0.04630875587463379
r_  generation:  0.41147637367248535
local_output_nid generation:  0.02772212028503418
local_in_edges_tensor generation:  0.026409387588500977
mini_batch_src_global generation:  0.047867774963378906
r_  generation:  0.4134550094604492
local_output_nid generation:  0.027436494827270508
local_in_edges_tensor generation:  0.03151106834411621
mini_batch_src_global generation:  0.0462493896484375
r_  generation:  0.4081261157989502
local_output_nid generation:  0.02740764617919922
local_in_edges_tensor generation:  0.027349233627319336
mini_batch_src_global generation:  0.04977536201477051
r_  generation:  0.3950808048248291
local_output_nid generation:  0.02740788459777832
local_in_edges_tensor generation:  0.024376869201660156
mini_batch_src_global generation:  0.047524213790893555
r_  generation:  0.4074537754058838
local_output_nid generation:  0.027184009552001953
local_in_edges_tensor generation:  0.02494215965270996
mini_batch_src_global generation:  0.04730653762817383
r_  generation:  0.3988971710205078
local_output_nid generation:  0.02762317657470703
local_in_edges_tensor generation:  0.02843761444091797
mini_batch_src_global generation:  0.048780202865600586
r_  generation:  0.41472578048706055
local_output_nid generation:  0.02722001075744629
local_in_edges_tensor generation:  0.026004552841186523
mini_batch_src_global generation:  0.04793286323547363
r_  generation:  0.40332627296447754
local_output_nid generation:  0.02873682975769043
local_in_edges_tensor generation:  0.02681255340576172
mini_batch_src_global generation:  0.050891876220703125
r_  generation:  0.4140176773071289
local_output_nid generation:  0.02772068977355957
local_in_edges_tensor generation:  0.028810501098632812
mini_batch_src_global generation:  0.048775672912597656
r_  generation:  0.4083681106567383
local_output_nid generation:  0.02760791778564453
local_in_edges_tensor generation:  0.024912357330322266
mini_batch_src_global generation:  0.0480806827545166
r_  generation:  0.40997838973999023
local_output_nid generation:  0.0278627872467041
local_in_edges_tensor generation:  0.02491903305053711
mini_batch_src_global generation:  0.047370195388793945
r_  generation:  0.4024357795715332
local_output_nid generation:  0.028038740158081055
local_in_edges_tensor generation:  0.02734851837158203
mini_batch_src_global generation:  0.046617984771728516
r_  generation:  0.41619110107421875
local_output_nid generation:  0.02793574333190918
local_in_edges_tensor generation:  0.02955150604248047
mini_batch_src_global generation:  0.0476984977722168
r_  generation:  0.40262651443481445
local_output_nid generation:  0.027756929397583008
local_in_edges_tensor generation:  0.028547286987304688
mini_batch_src_global generation:  0.04712677001953125
r_  generation:  0.4128987789154053
local_output_nid generation:  0.027930736541748047
local_in_edges_tensor generation:  0.02512359619140625
mini_batch_src_global generation:  0.0499420166015625
r_  generation:  0.4047057628631592
local_output_nid generation:  0.02818775177001953
local_in_edges_tensor generation:  0.030165433883666992
mini_batch_src_global generation:  0.04837942123413086
r_  generation:  0.4245481491088867
local_output_nid generation:  0.02928924560546875
local_in_edges_tensor generation:  0.029013633728027344
mini_batch_src_global generation:  0.04835104942321777
r_  generation:  0.4012947082519531
local_output_nid generation:  0.027864456176757812
local_in_edges_tensor generation:  0.025472640991210938
mini_batch_src_global generation:  0.046446800231933594
r_  generation:  0.41280555725097656
local_output_nid generation:  0.027714967727661133
local_in_edges_tensor generation:  0.024843215942382812
mini_batch_src_global generation:  0.047930002212524414
r_  generation:  0.3989701271057129
----------------------check_connections_block total spend ----------------------------- 19.211175203323364
generate_one_block  0.5440599918365479
generate_one_block  0.5411765575408936
generate_one_block  0.5344722270965576
generate_one_block  0.5322151184082031
generate_one_block  0.64766526222229
generate_one_block  0.533151388168335
generate_one_block  0.535473108291626
generate_one_block  0.5296571254730225
generate_one_block  0.533623218536377
generate_one_block  0.5371060371398926
generate_one_block  0.5344088077545166
generate_one_block  0.5364603996276855
generate_one_block  0.5413126945495605
generate_one_block  0.5376384258270264
generate_one_block  0.5346040725708008
generate_one_block  0.5284981727600098
generate_one_block  0.5390791893005371
generate_one_block  0.5363259315490723
generate_one_block  0.552978515625
generate_one_block  0.53863525390625
generate_one_block  0.5462636947631836
generate_one_block  0.543414831161499
generate_one_block  0.5312480926513672
generate_one_block  0.5331857204437256
generate_one_block  0.55596923828125
generate_one_block  0.5270576477050781
generate_one_block  0.5317251682281494
generate_one_block  0.5391819477081299
generate_one_block  0.5520527362823486
generate_one_block  0.5417547225952148
generate_one_block  0.5418164730072021
generate_one_block  0.5337517261505127
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.11959362030029297  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

connection checking time:  26.238749265670776
block generation total time  23.129929780960083
average batch blocks generation time:  0.7228103056550026
block dataloader generation time/epoch 51.53982639312744
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.105010986328125  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.8455491065979  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10306882858276367  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.69188928604126  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10274696350097656  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.52956771850586  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10319089889526367  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.780009269714355  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10502099990844727  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.834431171417236  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10413265228271484  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.82501745223999  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10398483276367188  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.675831317901611  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10283565521240234  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.638318538665771  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10289907455444336  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.627020835876465  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1030263900756836  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.737086772918701  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10258054733276367  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.606043338775635  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10296773910522461  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.679327011108398  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10503816604614258  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.923041820526123  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10419273376464844  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.95034646987915  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10381031036376953  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.395802021026611  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10265350341796875  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.322134017944336  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10282659530639648  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.71626615524292  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10309743881225586  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.543548107147217  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10503196716308594  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.974688053131104  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1029348373413086  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.671645641326904  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10500383377075195  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.822858810424805  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10426807403564453  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.107325077056885  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10269927978515625  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.438183307647705  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10273218154907227  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.38634443283081  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10501813888549805  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.80168342590332  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10281753540039062  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.487443447113037  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1029195785522461  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.579177856445312  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10413360595703125  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.811962604522705  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10507678985595703  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.15987205505371  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10289239883422852  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.66110372543335  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1039271354675293  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.072601318359375  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10275602340698242  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.674251079559326  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.037031009793281555 |0.01262647658586502 |0.2657400667667389 |9.177625179290771e-05 |0.4306843802332878 |0.005337953567504883 |
----------------------------------------------------------pseudo_mini_loss sum 1.5226110219955444
Total (block generation + training)time/epoch 75.30345165729523
Training time/epoch 23.935732126235962
Training time without block to device /epoch 23.53168487548828
Training time without total dataloading part /epoch 22.293857097625732
load block tensor time/epoch 1.1849923133850098
block to device time/epoch 0.40404725074768066
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 13 |
Number of nodes for computation during this epoch:  8576463
Number of first layer input nodes during this epoch:  4653952
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1194448471069336  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022755861282348633
random selection method range initialization spend 0.006343364715576172
time for parepare:  0.022362947463989258
local_output_nid generation:  0.0013353824615478516
local_in_edges_tensor generation:  0.006549358367919922
mini_batch_src_global generation:  0.0021293163299560547
r_  generation:  0.01679229736328125
local_output_nid generation:  0.0018434524536132812
local_in_edges_tensor generation:  0.0010340213775634766
mini_batch_src_global generation:  0.0017566680908203125
r_  generation:  0.009709835052490234
local_output_nid generation:  0.0015833377838134766
local_in_edges_tensor generation:  0.0008482933044433594
mini_batch_src_global generation:  0.0010950565338134766
r_  generation:  0.00829935073852539
local_output_nid generation:  0.0015456676483154297
local_in_edges_tensor generation:  0.0007848739624023438
mini_batch_src_global generation:  0.0010101795196533203
r_  generation:  0.007969141006469727
local_output_nid generation:  0.003452301025390625
local_in_edges_tensor generation:  0.000858306884765625
mini_batch_src_global generation:  0.0009891986846923828
r_  generation:  0.008293867111206055
local_output_nid generation:  0.0015392303466796875
local_in_edges_tensor generation:  0.0008685588836669922
mini_batch_src_global generation:  0.001054525375366211
r_  generation:  0.008408069610595703
local_output_nid generation:  0.0015447139739990234
local_in_edges_tensor generation:  0.0008020401000976562
mini_batch_src_global generation:  0.0009572505950927734
r_  generation:  0.008203268051147461
local_output_nid generation:  0.0015065670013427734
local_in_edges_tensor generation:  0.0007975101470947266
mini_batch_src_global generation:  0.0009050369262695312
r_  generation:  0.008213281631469727
local_output_nid generation:  0.0015053749084472656
local_in_edges_tensor generation:  0.0008215904235839844
mini_batch_src_global generation:  0.0009472370147705078
r_  generation:  0.008413553237915039
local_output_nid generation:  0.0015225410461425781
local_in_edges_tensor generation:  0.0007786750793457031
mini_batch_src_global generation:  0.0009260177612304688
r_  generation:  0.00832509994506836
local_output_nid generation:  0.0014908313751220703
local_in_edges_tensor generation:  0.0008196830749511719
mini_batch_src_global generation:  0.0009171962738037109
r_  generation:  0.008247852325439453
local_output_nid generation:  0.0015087127685546875
local_in_edges_tensor generation:  0.0008099079132080078
mini_batch_src_global generation:  0.0009253025054931641
r_  generation:  0.010297775268554688
local_output_nid generation:  0.001493692398071289
local_in_edges_tensor generation:  0.0007884502410888672
mini_batch_src_global generation:  0.0009355545043945312
r_  generation:  0.008276939392089844
local_output_nid generation:  0.0015025138854980469
local_in_edges_tensor generation:  0.0008094310760498047
mini_batch_src_global generation:  0.0010514259338378906
r_  generation:  0.008554697036743164
local_output_nid generation:  0.0014965534210205078
local_in_edges_tensor generation:  0.0007812976837158203
mini_batch_src_global generation:  0.0009479522705078125
r_  generation:  0.008302450180053711
local_output_nid generation:  0.001497030258178711
local_in_edges_tensor generation:  0.0007736682891845703
mini_batch_src_global generation:  0.000965118408203125
r_  generation:  0.00812077522277832
local_output_nid generation:  0.001500844955444336
local_in_edges_tensor generation:  0.0007498264312744141
mini_batch_src_global generation:  0.0008804798126220703
r_  generation:  0.00789189338684082
local_output_nid generation:  0.001482248306274414
local_in_edges_tensor generation:  0.0007841587066650391
mini_batch_src_global generation:  0.0009014606475830078
r_  generation:  0.008219003677368164
local_output_nid generation:  0.0014889240264892578
local_in_edges_tensor generation:  0.0007510185241699219
mini_batch_src_global generation:  0.0009543895721435547
r_  generation:  0.008368253707885742
local_output_nid generation:  0.0014872550964355469
local_in_edges_tensor generation:  0.002142667770385742
mini_batch_src_global generation:  0.0009632110595703125
r_  generation:  0.008324623107910156
local_output_nid generation:  0.0014705657958984375
local_in_edges_tensor generation:  0.0007679462432861328
mini_batch_src_global generation:  0.0009160041809082031
r_  generation:  0.008280277252197266
local_output_nid generation:  0.0015206336975097656
local_in_edges_tensor generation:  0.0007569789886474609
mini_batch_src_global generation:  0.0009272098541259766
r_  generation:  0.00844120979309082
local_output_nid generation:  0.0014581680297851562
local_in_edges_tensor generation:  0.0007426738739013672
mini_batch_src_global generation:  0.0009396076202392578
r_  generation:  0.008479118347167969
local_output_nid generation:  0.0014903545379638672
local_in_edges_tensor generation:  0.0008192062377929688
mini_batch_src_global generation:  0.0009336471557617188
r_  generation:  0.008062124252319336
local_output_nid generation:  0.0014789104461669922
local_in_edges_tensor generation:  0.0007810592651367188
mini_batch_src_global generation:  0.0009999275207519531
r_  generation:  0.008663177490234375
local_output_nid generation:  0.0014653205871582031
local_in_edges_tensor generation:  0.0007762908935546875
mini_batch_src_global generation:  0.0010166168212890625
r_  generation:  0.009505748748779297
local_output_nid generation:  0.0014960765838623047
local_in_edges_tensor generation:  0.0007791519165039062
mini_batch_src_global generation:  0.0009617805480957031
r_  generation:  0.009724855422973633
local_output_nid generation:  0.0015192031860351562
local_in_edges_tensor generation:  0.0007991790771484375
mini_batch_src_global generation:  0.0009911060333251953
r_  generation:  0.008134603500366211
local_output_nid generation:  0.0015254020690917969
local_in_edges_tensor generation:  0.0007643699645996094
mini_batch_src_global generation:  0.0009450912475585938
r_  generation:  0.008187294006347656
local_output_nid generation:  0.0014977455139160156
local_in_edges_tensor generation:  0.0007672309875488281
mini_batch_src_global generation:  0.0009663105010986328
r_  generation:  0.008484840393066406
local_output_nid generation:  0.0014765262603759766
local_in_edges_tensor generation:  0.0007894039154052734
mini_batch_src_global generation:  0.001004934310913086
r_  generation:  0.00848841667175293
local_output_nid generation:  0.0014727115631103516
local_in_edges_tensor generation:  0.0007634162902832031
mini_batch_src_global generation:  0.0009174346923828125
r_  generation:  0.008416414260864258
----------------------check_connections_block total spend ----------------------------- 0.5054314136505127
generate_one_block  0.020299434661865234
generate_one_block  0.019168376922607422
generate_one_block  0.015672922134399414
generate_one_block  0.014675378799438477
generate_one_block  0.014987707138061523
generate_one_block  0.01512002944946289
generate_one_block  0.014519691467285156
generate_one_block  0.014586925506591797
generate_one_block  0.016492128372192383
generate_one_block  0.014694929122924805
generate_one_block  0.014317989349365234
generate_one_block  0.014867544174194336
generate_one_block  0.014511585235595703
generate_one_block  0.014989852905273438
generate_one_block  0.014257669448852539
generate_one_block  0.015923023223876953
generate_one_block  0.01374053955078125
generate_one_block  0.014438629150390625
generate_one_block  0.01467752456665039
generate_one_block  0.014495849609375
generate_one_block  0.014480113983154297
generate_one_block  0.014715194702148438
generate_one_block  0.01714158058166504
generate_one_block  0.01418757438659668
generate_one_block  0.015146255493164062
generate_one_block  0.01500844955444336
generate_one_block  0.01452183723449707
generate_one_block  0.014391899108886719
generate_one_block  0.014249324798583984
generate_one_block  0.01708817481994629
generate_one_block  0.014920949935913086
generate_one_block  0.014544963836669922
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.036257028579711914
gen group dst list time:  0.023969173431396484
time for parepare:  0.024705171585083008
local_output_nid generation:  0.005692481994628906
local_in_edges_tensor generation:  0.019580602645874023
mini_batch_src_global generation:  0.013993501663208008
r_  generation:  0.126983642578125
local_output_nid generation:  0.008014202117919922
local_in_edges_tensor generation:  0.012125492095947266
mini_batch_src_global generation:  0.015068292617797852
r_  generation:  0.1647477149963379
local_output_nid generation:  0.008223772048950195
local_in_edges_tensor generation:  0.031185388565063477
mini_batch_src_global generation:  0.015107393264770508
r_  generation:  0.1356525421142578
local_output_nid generation:  0.008272171020507812
local_in_edges_tensor generation:  0.008084774017333984
mini_batch_src_global generation:  0.01558065414428711
r_  generation:  0.13232851028442383
local_output_nid generation:  0.008443832397460938
local_in_edges_tensor generation:  0.009920120239257812
mini_batch_src_global generation:  0.015648603439331055
r_  generation:  0.13940024375915527
local_output_nid generation:  0.008496522903442383
local_in_edges_tensor generation:  0.010000944137573242
mini_batch_src_global generation:  0.017394304275512695
r_  generation:  0.14098811149597168
local_output_nid generation:  0.008217811584472656
local_in_edges_tensor generation:  0.007524013519287109
mini_batch_src_global generation:  0.02552008628845215
r_  generation:  0.15156936645507812
local_output_nid generation:  0.007839679718017578
local_in_edges_tensor generation:  0.00951075553894043
mini_batch_src_global generation:  0.027031421661376953
r_  generation:  0.16277575492858887
local_output_nid generation:  0.00935220718383789
local_in_edges_tensor generation:  0.0076978206634521484
mini_batch_src_global generation:  0.017803192138671875
r_  generation:  0.14205026626586914
local_output_nid generation:  0.008222103118896484
local_in_edges_tensor generation:  0.007778644561767578
mini_batch_src_global generation:  0.017250537872314453
r_  generation:  0.13699913024902344
local_output_nid generation:  0.00822591781616211
local_in_edges_tensor generation:  0.00868535041809082
mini_batch_src_global generation:  0.016101598739624023
r_  generation:  0.135786771774292
local_output_nid generation:  0.008324861526489258
local_in_edges_tensor generation:  0.008079767227172852
mini_batch_src_global generation:  0.017180681228637695
r_  generation:  0.1403651237487793
local_output_nid generation:  0.008346080780029297
local_in_edges_tensor generation:  0.008089780807495117
mini_batch_src_global generation:  0.01604604721069336
r_  generation:  0.14331722259521484
local_output_nid generation:  0.008561134338378906
local_in_edges_tensor generation:  0.009428739547729492
mini_batch_src_global generation:  0.017946720123291016
r_  generation:  0.14228391647338867
local_output_nid generation:  0.00827646255493164
local_in_edges_tensor generation:  0.007577180862426758
mini_batch_src_global generation:  0.016254186630249023
r_  generation:  0.13834118843078613
local_output_nid generation:  0.008402347564697266
local_in_edges_tensor generation:  0.00746917724609375
mini_batch_src_global generation:  0.016211748123168945
r_  generation:  0.13425159454345703
local_output_nid generation:  0.007913589477539062
local_in_edges_tensor generation:  0.007709503173828125
mini_batch_src_global generation:  0.015194416046142578
r_  generation:  0.13329100608825684
local_output_nid generation:  0.008314371109008789
local_in_edges_tensor generation:  0.008512258529663086
mini_batch_src_global generation:  0.01692032814025879
r_  generation:  0.13597989082336426
local_output_nid generation:  0.008373260498046875
local_in_edges_tensor generation:  0.008720159530639648
mini_batch_src_global generation:  0.016094207763671875
r_  generation:  0.141953706741333
local_output_nid generation:  0.008126258850097656
local_in_edges_tensor generation:  0.007926225662231445
mini_batch_src_global generation:  0.016770601272583008
r_  generation:  0.1387491226196289
local_output_nid generation:  0.008286714553833008
local_in_edges_tensor generation:  0.007606983184814453
mini_batch_src_global generation:  0.01614665985107422
r_  generation:  0.1436460018157959
local_output_nid generation:  0.008363723754882812
local_in_edges_tensor generation:  0.010822772979736328
mini_batch_src_global generation:  0.016930103302001953
r_  generation:  0.14134836196899414
local_output_nid generation:  0.009306907653808594
local_in_edges_tensor generation:  0.00780940055847168
mini_batch_src_global generation:  0.016451597213745117
r_  generation:  0.14645099639892578
local_output_nid generation:  0.009198904037475586
local_in_edges_tensor generation:  0.00764918327331543
mini_batch_src_global generation:  0.016555309295654297
r_  generation:  0.134840726852417
local_output_nid generation:  0.00870203971862793
local_in_edges_tensor generation:  0.008352041244506836
mini_batch_src_global generation:  0.0173184871673584
r_  generation:  0.14614319801330566
local_output_nid generation:  0.008724212646484375
local_in_edges_tensor generation:  0.010122299194335938
mini_batch_src_global generation:  0.01800370216369629
r_  generation:  0.1450941562652588
local_output_nid generation:  0.008501768112182617
local_in_edges_tensor generation:  0.007506370544433594
mini_batch_src_global generation:  0.01681995391845703
r_  generation:  0.14060401916503906
local_output_nid generation:  0.00844264030456543
local_in_edges_tensor generation:  0.007491350173950195
mini_batch_src_global generation:  0.016251802444458008
r_  generation:  0.1360304355621338
local_output_nid generation:  0.008472204208374023
local_in_edges_tensor generation:  0.007476329803466797
mini_batch_src_global generation:  0.01574110984802246
r_  generation:  0.1400291919708252
local_output_nid generation:  0.008499860763549805
local_in_edges_tensor generation:  0.007781982421875
mini_batch_src_global generation:  0.016731739044189453
r_  generation:  0.13953256607055664
local_output_nid generation:  0.008625268936157227
local_in_edges_tensor generation:  0.00783991813659668
mini_batch_src_global generation:  0.016547441482543945
r_  generation:  0.1439526081085205
local_output_nid generation:  0.008500337600708008
local_in_edges_tensor generation:  0.008080005645751953
mini_batch_src_global generation:  0.016629457473754883
r_  generation:  0.1397089958190918
----------------------check_connections_block total spend ----------------------------- 6.743236303329468
generate_one_block  0.17851567268371582
generate_one_block  0.17314553260803223
generate_one_block  0.1815171241760254
generate_one_block  0.17530345916748047
generate_one_block  0.2093062400817871
generate_one_block  0.18510746955871582
generate_one_block  0.1741793155670166
generate_one_block  0.17414593696594238
generate_one_block  0.18225622177124023
generate_one_block  0.1775951385498047
generate_one_block  0.17016148567199707
generate_one_block  0.1773972511291504
generate_one_block  0.17558002471923828
generate_one_block  0.18101239204406738
generate_one_block  0.17570185661315918
generate_one_block  0.17058753967285156
generate_one_block  0.16478776931762695
generate_one_block  0.17540812492370605
generate_one_block  0.1786952018737793
generate_one_block  0.18194103240966797
generate_one_block  0.17761468887329102
generate_one_block  0.1773521900177002
generate_one_block  0.17728829383850098
generate_one_block  0.17022299766540527
generate_one_block  0.1826612949371338
generate_one_block  0.18608736991882324
generate_one_block  0.1737840175628662
generate_one_block  0.17116880416870117
generate_one_block  0.1729879379272461
generate_one_block  0.17830228805541992
generate_one_block  0.18141388893127441
generate_one_block  0.1771411895751953
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03319406509399414
gen group dst list time:  0.09687566757202148
time for parepare:  0.018504858016967773
local_output_nid generation:  0.022661447525024414
local_in_edges_tensor generation:  0.04028153419494629
mini_batch_src_global generation:  0.03637838363647461
r_  generation:  0.3904705047607422
local_output_nid generation:  0.028787612915039062
local_in_edges_tensor generation:  0.03146624565124512
mini_batch_src_global generation:  0.047957420349121094
r_  generation:  0.3951268196105957
local_output_nid generation:  0.0287783145904541
local_in_edges_tensor generation:  0.034937381744384766
mini_batch_src_global generation:  0.049378395080566406
r_  generation:  0.41384148597717285
local_output_nid generation:  0.029018163681030273
local_in_edges_tensor generation:  0.03193259239196777
mini_batch_src_global generation:  0.04888510704040527
r_  generation:  0.4012491703033447
local_output_nid generation:  0.0300290584564209
local_in_edges_tensor generation:  0.02747797966003418
mini_batch_src_global generation:  0.046869516372680664
r_  generation:  0.41470789909362793
local_output_nid generation:  0.028528928756713867
local_in_edges_tensor generation:  0.03206324577331543
mini_batch_src_global generation:  0.050019264221191406
r_  generation:  0.40681982040405273
local_output_nid generation:  0.027306079864501953
local_in_edges_tensor generation:  0.029106616973876953
mini_batch_src_global generation:  0.048059701919555664
r_  generation:  0.41338372230529785
local_output_nid generation:  0.028864622116088867
local_in_edges_tensor generation:  0.03127932548522949
mini_batch_src_global generation:  0.048464059829711914
r_  generation:  0.4014711380004883
local_output_nid generation:  0.027863264083862305
local_in_edges_tensor generation:  0.02636265754699707
mini_batch_src_global generation:  0.0469207763671875
r_  generation:  0.4131653308868408
local_output_nid generation:  0.02785205841064453
local_in_edges_tensor generation:  0.026669979095458984
mini_batch_src_global generation:  0.04852437973022461
r_  generation:  0.400860071182251
local_output_nid generation:  0.02758336067199707
local_in_edges_tensor generation:  0.025417804718017578
mini_batch_src_global generation:  0.04624032974243164
r_  generation:  0.406294584274292
local_output_nid generation:  0.030861616134643555
local_in_edges_tensor generation:  0.02481698989868164
mini_batch_src_global generation:  0.047508955001831055
r_  generation:  0.4120938777923584
local_output_nid generation:  0.027402639389038086
local_in_edges_tensor generation:  0.025072336196899414
mini_batch_src_global generation:  0.04600214958190918
r_  generation:  0.4055957794189453
local_output_nid generation:  0.02795863151550293
local_in_edges_tensor generation:  0.031236886978149414
mini_batch_src_global generation:  0.049855709075927734
r_  generation:  0.40891361236572266
local_output_nid generation:  0.027276992797851562
local_in_edges_tensor generation:  0.025135517120361328
mini_batch_src_global generation:  0.04645395278930664
r_  generation:  0.40436267852783203
local_output_nid generation:  0.027104854583740234
local_in_edges_tensor generation:  0.03013920783996582
mini_batch_src_global generation:  0.04783487319946289
r_  generation:  0.3978157043457031
local_output_nid generation:  0.02719402313232422
local_in_edges_tensor generation:  0.029012203216552734
mini_batch_src_global generation:  0.04637312889099121
r_  generation:  0.40032076835632324
local_output_nid generation:  0.02748894691467285
local_in_edges_tensor generation:  0.02624988555908203
mini_batch_src_global generation:  0.04991507530212402
r_  generation:  0.40088462829589844
local_output_nid generation:  0.02730584144592285
local_in_edges_tensor generation:  0.02784132957458496
mini_batch_src_global generation:  0.04673361778259277
r_  generation:  0.411252498626709
local_output_nid generation:  0.027615785598754883
local_in_edges_tensor generation:  0.027065038681030273
mini_batch_src_global generation:  0.051222801208496094
r_  generation:  0.40168213844299316
local_output_nid generation:  0.027605772018432617
local_in_edges_tensor generation:  0.027150392532348633
mini_batch_src_global generation:  0.052838802337646484
r_  generation:  0.41190361976623535
local_output_nid generation:  0.027333974838256836
local_in_edges_tensor generation:  0.024834156036376953
mini_batch_src_global generation:  0.048459529876708984
r_  generation:  0.40385007858276367
local_output_nid generation:  0.028928756713867188
local_in_edges_tensor generation:  0.024231910705566406
mini_batch_src_global generation:  0.04871511459350586
r_  generation:  0.40747737884521484
local_output_nid generation:  0.027546167373657227
local_in_edges_tensor generation:  0.02501654624938965
mini_batch_src_global generation:  0.0485537052154541
r_  generation:  0.4023106098175049
local_output_nid generation:  0.02768707275390625
local_in_edges_tensor generation:  0.027822256088256836
mini_batch_src_global generation:  0.05285286903381348
r_  generation:  0.4111781120300293
local_output_nid generation:  0.028139352798461914
local_in_edges_tensor generation:  0.031371116638183594
mini_batch_src_global generation:  0.04896140098571777
r_  generation:  0.4266340732574463
local_output_nid generation:  0.02986288070678711
local_in_edges_tensor generation:  0.029420137405395508
mini_batch_src_global generation:  0.048863887786865234
r_  generation:  0.40671300888061523
local_output_nid generation:  0.02761387825012207
local_in_edges_tensor generation:  0.02680373191833496
mini_batch_src_global generation:  0.04831814765930176
r_  generation:  0.3997213840484619
local_output_nid generation:  0.027236223220825195
local_in_edges_tensor generation:  0.025057315826416016
mini_batch_src_global generation:  0.04702949523925781
r_  generation:  0.40505337715148926
local_output_nid generation:  0.027648210525512695
local_in_edges_tensor generation:  0.026087045669555664
mini_batch_src_global generation:  0.047804832458496094
r_  generation:  0.3990921974182129
local_output_nid generation:  0.027594804763793945
local_in_edges_tensor generation:  0.026562929153442383
mini_batch_src_global generation:  0.04722452163696289
r_  generation:  0.41053152084350586
local_output_nid generation:  0.027662277221679688
local_in_edges_tensor generation:  0.0280306339263916
mini_batch_src_global generation:  0.05041933059692383
r_  generation:  0.40569210052490234
----------------------check_connections_block total spend ----------------------------- 19.23456859588623
generate_one_block  0.5392253398895264
generate_one_block  0.5268959999084473
generate_one_block  0.543447732925415
generate_one_block  0.5342423915863037
generate_one_block  0.6469542980194092
generate_one_block  0.545184850692749
generate_one_block  0.526789665222168
generate_one_block  0.533440351486206
generate_one_block  0.5390942096710205
generate_one_block  0.5353603363037109
generate_one_block  0.5270745754241943
generate_one_block  0.5369188785552979
generate_one_block  0.5275986194610596
generate_one_block  0.5493309497833252
generate_one_block  0.52980637550354
generate_one_block  0.5263283252716064
generate_one_block  0.5355846881866455
generate_one_block  0.5367801189422607
generate_one_block  0.5429646968841553
generate_one_block  0.5359623432159424
generate_one_block  0.5454678535461426
generate_one_block  0.5376718044281006
generate_one_block  0.5308403968811035
generate_one_block  0.5387160778045654
generate_one_block  0.570939302444458
generate_one_block  0.5470974445343018
generate_one_block  0.5361912250518799
generate_one_block  0.5343208312988281
generate_one_block  0.5324866771697998
generate_one_block  0.5449573993682861
generate_one_block  0.5467779636383057
generate_one_block  0.547523021697998
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1194448471069336  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

connection checking time:  25.9778048992157
block generation total time  23.020344495773315
average batch blocks generation time:  0.7193857654929161
block dataloader generation time/epoch 51.544243240356444
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10283374786376953  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.432904720306396  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10294485092163086  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.469721794128418  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10504579544067383  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.008281707763672  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10312318801879883  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.601091384887695  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1039896011352539  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.949028015136719  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1042628288269043  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.123064517974854  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10391616821289062  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.586586475372314  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10301589965820312  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.634098529815674  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1050424575805664  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.955324172973633  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1032114028930664  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.710604667663574  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10382652282714844  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.443361282348633  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10302448272705078  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.779231548309326  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10279655456542969  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.582107067108154  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1043548583984375  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.00844144821167  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10385799407958984  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.500353336334229  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10266399383544922  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.48865556716919  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10262250900268555  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.148743629455566  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10322999954223633  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.64875316619873  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10402202606201172  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.797120094299316  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10308647155761719  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.744235038757324  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10393476486206055  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.797032833099365  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10290384292602539  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.71204662322998  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10398292541503906  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.734930038452148  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10257387161254883  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.424738883972168  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10398721694946289  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.05460500717163  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10438299179077148  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.150752544403076  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10289621353149414  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.626611232757568  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10302400588989258  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.499587535858154  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1028599739074707  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.60457181930542  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10305404663085938  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.623688220977783  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10502958297729492  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.876135349273682  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10303640365600586  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.776070594787598  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.037949785590171814 |0.013107165694236755 |0.26764190196990967 |9.170174598693848e-05 |0.43023478239774704 |0.00470280647277832 |
----------------------------------------------------------pseudo_mini_loss sum 1.4914029836654663
Total (block generation + training)time/epoch 75.36001043319702
Training time/epoch 24.024069786071777
Training time without block to device /epoch 23.6046404838562
Training time without total dataloading part /epoch 22.339691162109375
load block tensor time/epoch 1.214393138885498
block to device time/epoch 0.41942930221557617
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 14 |
Number of nodes for computation during this epoch:  8577051
Number of first layer input nodes during this epoch:  4655134
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.12016534805297852  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02506279945373535
random selection method range initialization spend 0.00677037239074707
time for parepare:  0.023725032806396484
local_output_nid generation:  0.0017619132995605469
local_in_edges_tensor generation:  0.005287647247314453
mini_batch_src_global generation:  0.002136707305908203
r_  generation:  0.008411407470703125
local_output_nid generation:  0.0017018318176269531
local_in_edges_tensor generation:  0.0011415481567382812
mini_batch_src_global generation:  0.001985788345336914
r_  generation:  0.00866556167602539
local_output_nid generation:  0.0018336772918701172
local_in_edges_tensor generation:  0.0011234283447265625
mini_batch_src_global generation:  0.0013659000396728516
r_  generation:  0.011219024658203125
local_output_nid generation:  0.0019366741180419922
local_in_edges_tensor generation:  0.001149892807006836
mini_batch_src_global generation:  0.0013782978057861328
r_  generation:  0.008566617965698242
local_output_nid generation:  0.0035212039947509766
local_in_edges_tensor generation:  0.0017657279968261719
mini_batch_src_global generation:  0.0034325122833251953
r_  generation:  0.013706445693969727
local_output_nid generation:  0.002139568328857422
local_in_edges_tensor generation:  0.0010480880737304688
mini_batch_src_global generation:  0.0013577938079833984
r_  generation:  0.008386373519897461
local_output_nid generation:  0.0019626617431640625
local_in_edges_tensor generation:  0.0008885860443115234
mini_batch_src_global generation:  0.0011167526245117188
r_  generation:  0.008273601531982422
local_output_nid generation:  0.0019121170043945312
local_in_edges_tensor generation:  0.0009129047393798828
mini_batch_src_global generation:  0.0010251998901367188
r_  generation:  0.008103132247924805
local_output_nid generation:  0.0018091201782226562
local_in_edges_tensor generation:  0.0008406639099121094
mini_batch_src_global generation:  0.0009677410125732422
r_  generation:  0.010361433029174805
local_output_nid generation:  0.0018482208251953125
local_in_edges_tensor generation:  0.0009675025939941406
mini_batch_src_global generation:  0.001054525375366211
r_  generation:  0.008580207824707031
local_output_nid generation:  0.0017459392547607422
local_in_edges_tensor generation:  0.0008218288421630859
mini_batch_src_global generation:  0.0009601116180419922
r_  generation:  0.008351564407348633
local_output_nid generation:  0.0017552375793457031
local_in_edges_tensor generation:  0.0008876323699951172
mini_batch_src_global generation:  0.0009894371032714844
r_  generation:  0.008597373962402344
local_output_nid generation:  0.0017042160034179688
local_in_edges_tensor generation:  0.000827789306640625
mini_batch_src_global generation:  0.0009262561798095703
r_  generation:  0.008303403854370117
local_output_nid generation:  0.001683950424194336
local_in_edges_tensor generation:  0.000858306884765625
mini_batch_src_global generation:  0.0009598731994628906
r_  generation:  0.008454084396362305
local_output_nid generation:  0.0016455650329589844
local_in_edges_tensor generation:  0.0007898807525634766
mini_batch_src_global generation:  0.000934600830078125
r_  generation:  0.008362054824829102
local_output_nid generation:  0.0016088485717773438
local_in_edges_tensor generation:  0.0008695125579833984
mini_batch_src_global generation:  0.0009543895721435547
r_  generation:  0.008196353912353516
local_output_nid generation:  0.0035352706909179688
local_in_edges_tensor generation:  0.0008423328399658203
mini_batch_src_global generation:  0.0009713172912597656
r_  generation:  0.008292436599731445
local_output_nid generation:  0.001608133316040039
local_in_edges_tensor generation:  0.0007984638214111328
mini_batch_src_global generation:  0.0009565353393554688
r_  generation:  0.008332252502441406
local_output_nid generation:  0.0015702247619628906
local_in_edges_tensor generation:  0.0008406639099121094
mini_batch_src_global generation:  0.0009386539459228516
r_  generation:  0.008437156677246094
local_output_nid generation:  0.0015521049499511719
local_in_edges_tensor generation:  0.0007879734039306641
mini_batch_src_global generation:  0.0009250640869140625
r_  generation:  0.008243560791015625
local_output_nid generation:  0.0015976428985595703
local_in_edges_tensor generation:  0.0009026527404785156
mini_batch_src_global generation:  0.0011076927185058594
r_  generation:  0.009618520736694336
local_output_nid generation:  0.0015797615051269531
local_in_edges_tensor generation:  0.0008156299591064453
mini_batch_src_global generation:  0.0009496212005615234
r_  generation:  0.00837564468383789
local_output_nid generation:  0.0015723705291748047
local_in_edges_tensor generation:  0.0008151531219482422
mini_batch_src_global generation:  0.0009496212005615234
r_  generation:  0.00831460952758789
local_output_nid generation:  0.001543283462524414
local_in_edges_tensor generation:  0.0008013248443603516
mini_batch_src_global generation:  0.0009381771087646484
r_  generation:  0.008548259735107422
local_output_nid generation:  0.0015995502471923828
local_in_edges_tensor generation:  0.0008687973022460938
mini_batch_src_global generation:  0.0009388923645019531
r_  generation:  0.008174657821655273
local_output_nid generation:  0.0015411376953125
local_in_edges_tensor generation:  0.0008287429809570312
mini_batch_src_global generation:  0.0010061264038085938
r_  generation:  0.008408308029174805
local_output_nid generation:  0.00151824951171875
local_in_edges_tensor generation:  0.0008189678192138672
mini_batch_src_global generation:  0.0009329319000244141
r_  generation:  0.008335590362548828
local_output_nid generation:  0.0014882087707519531
local_in_edges_tensor generation:  0.0007741451263427734
mini_batch_src_global generation:  0.0009214878082275391
r_  generation:  0.008422136306762695
local_output_nid generation:  0.0014719963073730469
local_in_edges_tensor generation:  0.0007951259613037109
mini_batch_src_global generation:  0.0009465217590332031
r_  generation:  0.008440971374511719
local_output_nid generation:  0.0014870166778564453
local_in_edges_tensor generation:  0.0009150505065917969
mini_batch_src_global generation:  0.0011897087097167969
r_  generation:  0.008121252059936523
local_output_nid generation:  0.0014853477478027344
local_in_edges_tensor generation:  0.0007767677307128906
mini_batch_src_global generation:  0.0009229183197021484
r_  generation:  0.010155677795410156
local_output_nid generation:  0.001544952392578125
local_in_edges_tensor generation:  0.0008766651153564453
mini_batch_src_global generation:  0.0010006427764892578
r_  generation:  0.008490800857543945
----------------------check_connections_block total spend ----------------------------- 0.5280427932739258
generate_one_block  0.02249455451965332
generate_one_block  0.017894744873046875
generate_one_block  0.01551508903503418
generate_one_block  0.015478134155273438
generate_one_block  0.01620173454284668
generate_one_block  0.01493382453918457
generate_one_block  0.01454019546508789
generate_one_block  0.014564752578735352
generate_one_block  0.014618396759033203
generate_one_block  0.015034914016723633
generate_one_block  0.014626741409301758
generate_one_block  0.017044782638549805
generate_one_block  0.014624595642089844
generate_one_block  0.014997005462646484
generate_one_block  0.014722824096679688
generate_one_block  0.01450204849243164
generate_one_block  0.014515161514282227
generate_one_block  0.01466679573059082
generate_one_block  0.01621532440185547
generate_one_block  0.014808416366577148
generate_one_block  0.015460491180419922
generate_one_block  0.014640331268310547
generate_one_block  0.014638185501098633
generate_one_block  0.014532089233398438
generate_one_block  0.014496326446533203
generate_one_block  0.017475605010986328
generate_one_block  0.01578807830810547
generate_one_block  0.014760494232177734
generate_one_block  0.014775753021240234
generate_one_block  0.014353036880493164
generate_one_block  0.01446533203125
generate_one_block  0.0151519775390625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04652571678161621
gen group dst list time:  0.02419734001159668
time for parepare:  0.02253580093383789
local_output_nid generation:  0.0058476924896240234
local_in_edges_tensor generation:  0.016657114028930664
mini_batch_src_global generation:  0.01504373550415039
r_  generation:  0.12348365783691406
local_output_nid generation:  0.007769107818603516
local_in_edges_tensor generation:  0.009729623794555664
mini_batch_src_global generation:  0.02696371078491211
r_  generation:  0.13654375076293945
local_output_nid generation:  0.008085250854492188
local_in_edges_tensor generation:  0.03165245056152344
mini_batch_src_global generation:  0.023583173751831055
r_  generation:  0.15022754669189453
local_output_nid generation:  0.010154008865356445
local_in_edges_tensor generation:  0.010065555572509766
mini_batch_src_global generation:  0.019527912139892578
r_  generation:  0.14038515090942383
local_output_nid generation:  0.008869171142578125
local_in_edges_tensor generation:  0.00757288932800293
mini_batch_src_global generation:  0.01883244514465332
r_  generation:  0.13605546951293945
local_output_nid generation:  0.008761405944824219
local_in_edges_tensor generation:  0.00797724723815918
mini_batch_src_global generation:  0.017426490783691406
r_  generation:  0.1383061408996582
local_output_nid generation:  0.008383750915527344
local_in_edges_tensor generation:  0.007590293884277344
mini_batch_src_global generation:  0.01670527458190918
r_  generation:  0.13962674140930176
local_output_nid generation:  0.00810861587524414
local_in_edges_tensor generation:  0.007318735122680664
mini_batch_src_global generation:  0.01671576499938965
r_  generation:  0.1380767822265625
local_output_nid generation:  0.008060932159423828
local_in_edges_tensor generation:  0.007375955581665039
mini_batch_src_global generation:  0.016633033752441406
r_  generation:  0.14111757278442383
local_output_nid generation:  0.009052038192749023
local_in_edges_tensor generation:  0.008162975311279297
mini_batch_src_global generation:  0.03000497817993164
r_  generation:  0.15664935111999512
local_output_nid generation:  0.008374691009521484
local_in_edges_tensor generation:  0.00774693489074707
mini_batch_src_global generation:  0.026699304580688477
r_  generation:  0.1561596393585205
local_output_nid generation:  0.013134956359863281
local_in_edges_tensor generation:  0.01086115837097168
mini_batch_src_global generation:  0.020322084426879883
r_  generation:  0.17462778091430664
local_output_nid generation:  0.01369333267211914
local_in_edges_tensor generation:  0.00863194465637207
mini_batch_src_global generation:  0.02013230323791504
r_  generation:  0.14205670356750488
local_output_nid generation:  0.009791851043701172
local_in_edges_tensor generation:  0.008685588836669922
mini_batch_src_global generation:  0.02081751823425293
r_  generation:  0.14617037773132324
local_output_nid generation:  0.009042978286743164
local_in_edges_tensor generation:  0.007667064666748047
mini_batch_src_global generation:  0.01970672607421875
r_  generation:  0.16540837287902832
local_output_nid generation:  0.013434886932373047
local_in_edges_tensor generation:  0.010254859924316406
mini_batch_src_global generation:  0.026906967163085938
r_  generation:  0.16873598098754883
local_output_nid generation:  0.010877847671508789
local_in_edges_tensor generation:  0.009109020233154297
mini_batch_src_global generation:  0.03138399124145508
r_  generation:  0.14233708381652832
local_output_nid generation:  0.009222269058227539
local_in_edges_tensor generation:  0.00838470458984375
mini_batch_src_global generation:  0.01762866973876953
r_  generation:  0.14168667793273926
local_output_nid generation:  0.008642435073852539
local_in_edges_tensor generation:  0.008125066757202148
mini_batch_src_global generation:  0.01720452308654785
r_  generation:  0.14233803749084473
local_output_nid generation:  0.008538484573364258
local_in_edges_tensor generation:  0.008104085922241211
mini_batch_src_global generation:  0.017753124237060547
r_  generation:  0.14360523223876953
local_output_nid generation:  0.00922846794128418
local_in_edges_tensor generation:  0.008410215377807617
mini_batch_src_global generation:  0.019500732421875
r_  generation:  0.1470334529876709
local_output_nid generation:  0.008388519287109375
local_in_edges_tensor generation:  0.008553504943847656
mini_batch_src_global generation:  0.018006086349487305
r_  generation:  0.14172577857971191
local_output_nid generation:  0.00815892219543457
local_in_edges_tensor generation:  0.007382392883300781
mini_batch_src_global generation:  0.016900300979614258
r_  generation:  0.13893723487854004
local_output_nid generation:  0.008312702178955078
local_in_edges_tensor generation:  0.007861614227294922
mini_batch_src_global generation:  0.01750016212463379
r_  generation:  0.14115524291992188
local_output_nid generation:  0.00820612907409668
local_in_edges_tensor generation:  0.007331132888793945
mini_batch_src_global generation:  0.016837596893310547
r_  generation:  0.1406574249267578
local_output_nid generation:  0.008298158645629883
local_in_edges_tensor generation:  0.007866144180297852
mini_batch_src_global generation:  0.018225908279418945
r_  generation:  0.14105701446533203
local_output_nid generation:  0.008199930191040039
local_in_edges_tensor generation:  0.007304191589355469
mini_batch_src_global generation:  0.01682114601135254
r_  generation:  0.14205074310302734
local_output_nid generation:  0.00834202766418457
local_in_edges_tensor generation:  0.0074613094329833984
mini_batch_src_global generation:  0.017392635345458984
r_  generation:  0.17849373817443848
local_output_nid generation:  0.008410453796386719
local_in_edges_tensor generation:  0.00800776481628418
mini_batch_src_global generation:  0.019903182983398438
r_  generation:  0.1440274715423584
local_output_nid generation:  0.00817251205444336
local_in_edges_tensor generation:  0.00714874267578125
mini_batch_src_global generation:  0.01714777946472168
r_  generation:  0.13686871528625488
local_output_nid generation:  0.008391380310058594
local_in_edges_tensor generation:  0.007381916046142578
mini_batch_src_global generation:  0.028133869171142578
r_  generation:  0.14152050018310547
local_output_nid generation:  0.008583307266235352
local_in_edges_tensor generation:  0.008272171020507812
mini_batch_src_global generation:  0.01753973960876465
r_  generation:  0.14560747146606445
----------------------check_connections_block total spend ----------------------------- 7.051140546798706
generate_one_block  0.1754169464111328
generate_one_block  0.17566537857055664
generate_one_block  0.17924141883850098
generate_one_block  0.18614625930786133
generate_one_block  0.20287227630615234
generate_one_block  0.1793825626373291
generate_one_block  0.1943671703338623
generate_one_block  0.18176746368408203
generate_one_block  0.18143153190612793
generate_one_block  0.19021368026733398
generate_one_block  0.17989158630371094
generate_one_block  0.18729138374328613
generate_one_block  0.18360400199890137
generate_one_block  0.18490862846374512
generate_one_block  0.17888212203979492
generate_one_block  0.17528152465820312
generate_one_block  0.17572474479675293
generate_one_block  0.1812288761138916
generate_one_block  0.18063902854919434
generate_one_block  0.1816716194152832
generate_one_block  0.18717336654663086
generate_one_block  0.17951679229736328
generate_one_block  0.17392516136169434
generate_one_block  0.17926812171936035
generate_one_block  0.17868828773498535
generate_one_block  0.18194293975830078
generate_one_block  0.18107914924621582
generate_one_block  0.18082189559936523
generate_one_block  0.177628755569458
generate_one_block  0.16798734664916992
generate_one_block  0.17150020599365234
generate_one_block  0.1823592185974121
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03436756134033203
gen group dst list time:  0.10626697540283203
time for parepare:  0.01938796043395996
local_output_nid generation:  0.023067951202392578
local_in_edges_tensor generation:  0.043775081634521484
mini_batch_src_global generation:  0.04873371124267578
r_  generation:  0.3957688808441162
local_output_nid generation:  0.028744935989379883
local_in_edges_tensor generation:  0.0320429801940918
mini_batch_src_global generation:  0.048540592193603516
r_  generation:  0.39604663848876953
local_output_nid generation:  0.02878737449645996
local_in_edges_tensor generation:  0.028061389923095703
mini_batch_src_global generation:  0.046181678771972656
r_  generation:  0.40655970573425293
local_output_nid generation:  0.03091573715209961
local_in_edges_tensor generation:  0.026719331741333008
mini_batch_src_global generation:  0.05012369155883789
r_  generation:  0.4226863384246826
local_output_nid generation:  0.02893972396850586
local_in_edges_tensor generation:  0.026564359664916992
mini_batch_src_global generation:  0.04643368721008301
r_  generation:  0.4150052070617676
local_output_nid generation:  0.02934432029724121
local_in_edges_tensor generation:  0.03056955337524414
mini_batch_src_global generation:  0.05111503601074219
r_  generation:  0.40497851371765137
local_output_nid generation:  0.027093887329101562
local_in_edges_tensor generation:  0.02749466896057129
mini_batch_src_global generation:  0.047154903411865234
r_  generation:  0.40760111808776855
local_output_nid generation:  0.02691650390625
local_in_edges_tensor generation:  0.02631211280822754
mini_batch_src_global generation:  0.047926902770996094
r_  generation:  0.3968820571899414
local_output_nid generation:  0.02716207504272461
local_in_edges_tensor generation:  0.026633739471435547
mini_batch_src_global generation:  0.047228336334228516
r_  generation:  0.4152207374572754
local_output_nid generation:  0.02942514419555664
local_in_edges_tensor generation:  0.034923553466796875
mini_batch_src_global generation:  0.050167083740234375
r_  generation:  0.4272468090057373
local_output_nid generation:  0.029798269271850586
local_in_edges_tensor generation:  0.030867815017700195
mini_batch_src_global generation:  0.04793500900268555
r_  generation:  0.4037330150604248
local_output_nid generation:  0.02771472930908203
local_in_edges_tensor generation:  0.02832174301147461
mini_batch_src_global generation:  0.04988265037536621
r_  generation:  0.4018580913543701
local_output_nid generation:  0.027781963348388672
local_in_edges_tensor generation:  0.02767658233642578
mini_batch_src_global generation:  0.04679584503173828
r_  generation:  0.4054737091064453
local_output_nid generation:  0.027932167053222656
local_in_edges_tensor generation:  0.02665996551513672
mini_batch_src_global generation:  0.05003952980041504
r_  generation:  0.40599894523620605
local_output_nid generation:  0.02761054039001465
local_in_edges_tensor generation:  0.02499532699584961
mini_batch_src_global generation:  0.04790759086608887
r_  generation:  0.40517520904541016
local_output_nid generation:  0.027695417404174805
local_in_edges_tensor generation:  0.02493000030517578
mini_batch_src_global generation:  0.05117988586425781
r_  generation:  0.40279555320739746
local_output_nid generation:  0.027963638305664062
local_in_edges_tensor generation:  0.026111602783203125
mini_batch_src_global generation:  0.048209190368652344
r_  generation:  0.4158024787902832
local_output_nid generation:  0.028356075286865234
local_in_edges_tensor generation:  0.031194686889648438
mini_batch_src_global generation:  0.05122685432434082
r_  generation:  0.4107491970062256
local_output_nid generation:  0.027683496475219727
local_in_edges_tensor generation:  0.028590917587280273
mini_batch_src_global generation:  0.04718589782714844
r_  generation:  0.41416096687316895
local_output_nid generation:  0.02767157554626465
local_in_edges_tensor generation:  0.032247066497802734
mini_batch_src_global generation:  0.04766964912414551
r_  generation:  0.40474581718444824
local_output_nid generation:  0.0290219783782959
local_in_edges_tensor generation:  0.03294014930725098
mini_batch_src_global generation:  0.047011375427246094
r_  generation:  0.434600830078125
local_output_nid generation:  0.03009033203125
local_in_edges_tensor generation:  0.030179977416992188
mini_batch_src_global generation:  0.048586368560791016
r_  generation:  0.4014608860015869
local_output_nid generation:  0.02760148048400879
local_in_edges_tensor generation:  0.028607606887817383
mini_batch_src_global generation:  0.04783773422241211
r_  generation:  0.4177076816558838
local_output_nid generation:  0.027741432189941406
local_in_edges_tensor generation:  0.02689528465270996
mini_batch_src_global generation:  0.04793977737426758
r_  generation:  0.4008042812347412
local_output_nid generation:  0.027715682983398438
local_in_edges_tensor generation:  0.025083303451538086
mini_batch_src_global generation:  0.045916080474853516
r_  generation:  0.4060359001159668
local_output_nid generation:  0.027825117111206055
local_in_edges_tensor generation:  0.024997711181640625
mini_batch_src_global generation:  0.0493006706237793
r_  generation:  0.39893412590026855
local_output_nid generation:  0.02751755714416504
local_in_edges_tensor generation:  0.027385473251342773
mini_batch_src_global generation:  0.04662919044494629
r_  generation:  0.40387725830078125
local_output_nid generation:  0.027888059616088867
local_in_edges_tensor generation:  0.026068925857543945
mini_batch_src_global generation:  0.04979825019836426
r_  generation:  0.3998098373413086
local_output_nid generation:  0.027502775192260742
local_in_edges_tensor generation:  0.02470874786376953
mini_batch_src_global generation:  0.046250343322753906
r_  generation:  0.4096548557281494
local_output_nid generation:  0.027404308319091797
local_in_edges_tensor generation:  0.026671648025512695
mini_batch_src_global generation:  0.047829627990722656
r_  generation:  0.39403820037841797
local_output_nid generation:  0.029330968856811523
local_in_edges_tensor generation:  0.02494359016418457
mini_batch_src_global generation:  0.04620623588562012
r_  generation:  0.40532875061035156
local_output_nid generation:  0.027734041213989258
local_in_edges_tensor generation:  0.027956724166870117
mini_batch_src_global generation:  0.04968523979187012
r_  generation:  0.40451645851135254
----------------------check_connections_block total spend ----------------------------- 19.301551818847656
generate_one_block  0.54227614402771
generate_one_block  0.5388717651367188
generate_one_block  0.5343616008758545
generate_one_block  0.5441763401031494
generate_one_block  0.6279065608978271
generate_one_block  0.5367794036865234
generate_one_block  0.5359282493591309
generate_one_block  0.5308248996734619
generate_one_block  0.5463929176330566
generate_one_block  0.5491535663604736
generate_one_block  0.5273580551147461
generate_one_block  0.542614221572876
generate_one_block  0.5370573997497559
generate_one_block  0.5417940616607666
generate_one_block  0.5317513942718506
generate_one_block  0.5294957160949707
generate_one_block  0.5570127964019775
generate_one_block  0.5400538444519043
generate_one_block  0.5404231548309326
generate_one_block  0.5340015888214111
generate_one_block  0.5446643829345703
generate_one_block  0.5333027839660645
generate_one_block  0.53159499168396
generate_one_block  0.5386497974395752
generate_one_block  0.5487015247344971
generate_one_block  0.5386059284210205
generate_one_block  0.5334703922271729
generate_one_block  0.5416021347045898
generate_one_block  0.5351581573486328
generate_one_block  0.5243892669677734
generate_one_block  0.5319919586181641
generate_one_block  0.547004222869873
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.12016534805297852  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

connection checking time:  26.352692365646362
block generation total time  23.114888668060303
average batch blocks generation time:  0.7223402708768845
block dataloader generation time/epoch 51.638433376948036
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10251045227050781  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.393250942230225  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10288190841674805  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.714420795440674  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10399198532104492  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.83018970489502  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10415410995483398  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.1152081489563  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10280323028564453  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.585930347442627  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1032247543334961  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.68878698348999  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10289907455444336  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.721469402313232  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1025533676147461  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.487672328948975  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1039571762084961  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.685546875  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10426568984985352  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.90296220779419  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10256052017211914  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.576679706573486  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10394954681396484  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.04661798477173  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10398006439208984  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.740814208984375  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10417747497558594  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.975741863250732  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10282325744628906  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.584712028503418  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10302352905273438  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.454787731170654  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1040048599243164  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.743748188018799  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10433578491210938  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.898557186126709  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10501861572265625  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.823895931243896  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10303354263305664  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.7722487449646  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10508441925048828  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.18433952331543  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10298299789428711  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.756374835968018  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10263490676879883  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.544998168945312  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10330486297607422  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.700461387634277  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10387992858886719  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.537898540496826  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10297441482543945  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.708605766296387  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10262584686279297  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.550219535827637  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10319995880126953  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.75832748413086  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10289716720581055  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.654194355010986  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1027064323425293  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.179311752319336  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10376739501953125  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.43423318862915  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1040964126586914  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.873506546020508  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.037543319165706635 |0.012163050472736359 |0.2638772651553154 |8.947402238845825e-05 |0.4297918453812599 |0.005734443664550781 |
----------------------------------------------------------pseudo_mini_loss sum 1.4647902250289917
Total (block generation + training)time/epoch 75.4594697157542
Training time/epoch 23.847116470336914
Training time without block to device /epoch 23.45789885520935
Training time without total dataloading part /epoch 22.20600914955139
load block tensor time/epoch 1.2013862133026123
block to device time/epoch 0.3892176151275635
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 15 |
Number of nodes for computation during this epoch:  8576611
Number of first layer input nodes during this epoch:  4653796
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.12210893630981445  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020386219024658203
random selection method range initialization spend 0.005513906478881836
time for parepare:  0.020053625106811523
local_output_nid generation:  0.0013842582702636719
local_in_edges_tensor generation:  0.008991241455078125
mini_batch_src_global generation:  0.002849102020263672
r_  generation:  0.014168024063110352
local_output_nid generation:  0.0024061203002929688
local_in_edges_tensor generation:  0.0012423992156982422
mini_batch_src_global generation:  0.0019044876098632812
r_  generation:  0.008819580078125
local_output_nid generation:  0.0022797584533691406
local_in_edges_tensor generation:  0.0011212825775146484
mini_batch_src_global generation:  0.0011889934539794922
r_  generation:  0.008071184158325195
local_output_nid generation:  0.002183198928833008
local_in_edges_tensor generation:  0.001123189926147461
mini_batch_src_global generation:  0.0011005401611328125
r_  generation:  0.008161544799804688
local_output_nid generation:  0.0020945072174072266
local_in_edges_tensor generation:  0.001051187515258789
mini_batch_src_global generation:  0.0011467933654785156
r_  generation:  0.008296966552734375
local_output_nid generation:  0.0020923614501953125
local_in_edges_tensor generation:  0.001073598861694336
mini_batch_src_global generation:  0.001171112060546875
r_  generation:  0.008521318435668945
local_output_nid generation:  0.002092123031616211
local_in_edges_tensor generation:  0.001016855239868164
mini_batch_src_global generation:  0.0011224746704101562
r_  generation:  0.008446216583251953
local_output_nid generation:  0.002064943313598633
local_in_edges_tensor generation:  0.0010447502136230469
mini_batch_src_global generation:  0.0010695457458496094
r_  generation:  0.0080718994140625
local_output_nid generation:  0.0020754337310791016
local_in_edges_tensor generation:  0.0010492801666259766
mini_batch_src_global generation:  0.0010344982147216797
r_  generation:  0.008283615112304688
local_output_nid generation:  0.0020780563354492188
local_in_edges_tensor generation:  0.0010366439819335938
mini_batch_src_global generation:  0.0012433528900146484
r_  generation:  0.00856924057006836
local_output_nid generation:  0.002135038375854492
local_in_edges_tensor generation:  0.0010409355163574219
mini_batch_src_global generation:  0.001069784164428711
r_  generation:  0.008518457412719727
local_output_nid generation:  0.0020949840545654297
local_in_edges_tensor generation:  0.001016378402709961
mini_batch_src_global generation:  0.0010809898376464844
r_  generation:  0.008368730545043945
local_output_nid generation:  0.0020818710327148438
local_in_edges_tensor generation:  0.0009887218475341797
mini_batch_src_global generation:  0.001046895980834961
r_  generation:  0.008260726928710938
local_output_nid generation:  0.002090930938720703
local_in_edges_tensor generation:  0.0010218620300292969
mini_batch_src_global generation:  0.0010762214660644531
r_  generation:  0.008594036102294922
local_output_nid generation:  0.0021238327026367188
local_in_edges_tensor generation:  0.0010204315185546875
mini_batch_src_global generation:  0.00103759765625
r_  generation:  0.008305072784423828
local_output_nid generation:  0.002115964889526367
local_in_edges_tensor generation:  0.000993490219116211
mini_batch_src_global generation:  0.001051187515258789
r_  generation:  0.008350133895874023
local_output_nid generation:  0.0020759105682373047
local_in_edges_tensor generation:  0.0010151863098144531
mini_batch_src_global generation:  0.0010881423950195312
r_  generation:  0.008497953414916992
local_output_nid generation:  0.0020749568939208984
local_in_edges_tensor generation:  0.0010085105895996094
mini_batch_src_global generation:  0.0010747909545898438
r_  generation:  0.008535623550415039
local_output_nid generation:  0.0021142959594726562
local_in_edges_tensor generation:  0.0009984970092773438
mini_batch_src_global generation:  0.001077890396118164
r_  generation:  0.008560657501220703
local_output_nid generation:  0.002185344696044922
local_in_edges_tensor generation:  0.0010132789611816406
mini_batch_src_global generation:  0.0010454654693603516
r_  generation:  0.00854182243347168
local_output_nid generation:  0.0022046566009521484
local_in_edges_tensor generation:  0.0010211467742919922
mini_batch_src_global generation:  0.0010685920715332031
r_  generation:  0.008644342422485352
local_output_nid generation:  0.002190828323364258
local_in_edges_tensor generation:  0.001018524169921875
mini_batch_src_global generation:  0.0010445117950439453
r_  generation:  0.008450984954833984
local_output_nid generation:  0.0021507740020751953
local_in_edges_tensor generation:  0.0010211467742919922
mini_batch_src_global generation:  0.0010602474212646484
r_  generation:  0.008646249771118164
local_output_nid generation:  0.0021309852600097656
local_in_edges_tensor generation:  0.0010151863098144531
mini_batch_src_global generation:  0.001051187515258789
r_  generation:  0.008481025695800781
local_output_nid generation:  0.0021126270294189453
local_in_edges_tensor generation:  0.0010023117065429688
mini_batch_src_global generation:  0.001046895980834961
r_  generation:  0.008305072784423828
local_output_nid generation:  0.0021202564239501953
local_in_edges_tensor generation:  0.001032114028930664
mini_batch_src_global generation:  0.001039266586303711
r_  generation:  0.008157014846801758
local_output_nid generation:  0.0021219253540039062
local_in_edges_tensor generation:  0.000965118408203125
mini_batch_src_global generation:  0.0009987354278564453
r_  generation:  0.008420228958129883
local_output_nid generation:  0.0021164417266845703
local_in_edges_tensor generation:  0.001047372817993164
mini_batch_src_global generation:  0.0010464191436767578
r_  generation:  0.008353471755981445
local_output_nid generation:  0.002140522003173828
local_in_edges_tensor generation:  0.0009925365447998047
mini_batch_src_global generation:  0.0011980533599853516
r_  generation:  0.008325815200805664
local_output_nid generation:  0.0021140575408935547
local_in_edges_tensor generation:  0.0010399818420410156
mini_batch_src_global generation:  0.0011227130889892578
r_  generation:  0.008140802383422852
local_output_nid generation:  0.0021185874938964844
local_in_edges_tensor generation:  0.0010104179382324219
mini_batch_src_global generation:  0.001047372817993164
r_  generation:  0.008468151092529297
local_output_nid generation:  0.002101898193359375
local_in_edges_tensor generation:  0.0010650157928466797
mini_batch_src_global generation:  0.00109100341796875
r_  generation:  0.008306026458740234
----------------------check_connections_block total spend ----------------------------- 0.5376174449920654
generate_one_block  0.030627727508544922
generate_one_block  0.018108367919921875
generate_one_block  0.0153656005859375
generate_one_block  0.014827728271484375
generate_one_block  0.015046834945678711
generate_one_block  0.015233993530273438
generate_one_block  0.014885902404785156
generate_one_block  0.014333486557006836
generate_one_block  0.014610052108764648
generate_one_block  0.014966487884521484
generate_one_block  0.014666080474853516
generate_one_block  0.014813899993896484
generate_one_block  0.01448512077331543
generate_one_block  0.014840126037597656
generate_one_block  0.014302492141723633
generate_one_block  0.014506340026855469
generate_one_block  0.014647722244262695
generate_one_block  0.014909029006958008
generate_one_block  0.014684438705444336
generate_one_block  0.014291048049926758
generate_one_block  0.016426563262939453
generate_one_block  0.018039226531982422
generate_one_block  0.014972686767578125
generate_one_block  0.014526605606079102
generate_one_block  0.014411449432373047
generate_one_block  0.01414179801940918
generate_one_block  0.014518499374389648
generate_one_block  0.015893220901489258
generate_one_block  0.01442098617553711
generate_one_block  0.014073610305786133
generate_one_block  0.014717817306518555
generate_one_block  0.014447212219238281
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03631234169006348
gen group dst list time:  0.020749330520629883
time for parepare:  0.022450923919677734
local_output_nid generation:  0.0055162906646728516
local_in_edges_tensor generation:  0.0171964168548584
mini_batch_src_global generation:  0.013367176055908203
r_  generation:  0.12790465354919434
local_output_nid generation:  0.0076904296875
local_in_edges_tensor generation:  0.009607791900634766
mini_batch_src_global generation:  0.016086578369140625
r_  generation:  0.12891507148742676
local_output_nid generation:  0.008034706115722656
local_in_edges_tensor generation:  0.030581235885620117
mini_batch_src_global generation:  0.01489710807800293
r_  generation:  0.13593554496765137
local_output_nid generation:  0.008315086364746094
local_in_edges_tensor generation:  0.009748697280883789
mini_batch_src_global generation:  0.015081644058227539
r_  generation:  0.13470935821533203
local_output_nid generation:  0.008415699005126953
local_in_edges_tensor generation:  0.010227441787719727
mini_batch_src_global generation:  0.01642918586730957
r_  generation:  0.14069175720214844
local_output_nid generation:  0.00844883918762207
local_in_edges_tensor generation:  0.010050535202026367
mini_batch_src_global generation:  0.01966714859008789
r_  generation:  0.1451563835144043
local_output_nid generation:  0.008372306823730469
local_in_edges_tensor generation:  0.011909008026123047
mini_batch_src_global generation:  0.0186917781829834
r_  generation:  0.1433703899383545
local_output_nid generation:  0.007890462875366211
local_in_edges_tensor generation:  0.009172201156616211
mini_batch_src_global generation:  0.01823878288269043
r_  generation:  0.13516020774841309
local_output_nid generation:  0.00875091552734375
local_in_edges_tensor generation:  0.00974130630493164
mini_batch_src_global generation:  0.019569873809814453
r_  generation:  0.1416916847229004
local_output_nid generation:  0.008235454559326172
local_in_edges_tensor generation:  0.00866556167602539
mini_batch_src_global generation:  0.01934957504272461
r_  generation:  0.14257431030273438
local_output_nid generation:  0.008463382720947266
local_in_edges_tensor generation:  0.009987115859985352
mini_batch_src_global generation:  0.016242504119873047
r_  generation:  0.14267301559448242
local_output_nid generation:  0.008546113967895508
local_in_edges_tensor generation:  0.01059865951538086
mini_batch_src_global generation:  0.016928672790527344
r_  generation:  0.1363227367401123
local_output_nid generation:  0.00847315788269043
local_in_edges_tensor generation:  0.008873701095581055
mini_batch_src_global generation:  0.016074419021606445
r_  generation:  0.14389896392822266
local_output_nid generation:  0.009918689727783203
local_in_edges_tensor generation:  0.008796930313110352
mini_batch_src_global generation:  0.01780986785888672
r_  generation:  0.14078974723815918
local_output_nid generation:  0.00838613510131836
local_in_edges_tensor generation:  0.007666110992431641
mini_batch_src_global generation:  0.015982389450073242
r_  generation:  0.13700127601623535
local_output_nid generation:  0.008522748947143555
local_in_edges_tensor generation:  0.007645606994628906
mini_batch_src_global generation:  0.016755342483520508
r_  generation:  0.1373603343963623
local_output_nid generation:  0.008624076843261719
local_in_edges_tensor generation:  0.008017778396606445
mini_batch_src_global generation:  0.016411781311035156
r_  generation:  0.14257335662841797
local_output_nid generation:  0.00867605209350586
local_in_edges_tensor generation:  0.0094757080078125
mini_batch_src_global generation:  0.017734766006469727
r_  generation:  0.1414175033569336
local_output_nid generation:  0.008527755737304688
local_in_edges_tensor generation:  0.007728099822998047
mini_batch_src_global generation:  0.01637554168701172
r_  generation:  0.1410350799560547
local_output_nid generation:  0.00846242904663086
local_in_edges_tensor generation:  0.007668495178222656
mini_batch_src_global generation:  0.01677107810974121
r_  generation:  0.1380763053894043
local_output_nid generation:  0.008406639099121094
local_in_edges_tensor generation:  0.0076618194580078125
mini_batch_src_global generation:  0.016041040420532227
r_  generation:  0.14031147956848145
local_output_nid generation:  0.008419036865234375
local_in_edges_tensor generation:  0.007778644561767578
mini_batch_src_global generation:  0.016570568084716797
r_  generation:  0.13973689079284668
local_output_nid generation:  0.008704423904418945
local_in_edges_tensor generation:  0.007947444915771484
mini_batch_src_global generation:  0.016382455825805664
r_  generation:  0.14494013786315918
local_output_nid generation:  0.008625984191894531
local_in_edges_tensor generation:  0.007914543151855469
mini_batch_src_global generation:  0.016991376876831055
r_  generation:  0.1383676528930664
local_output_nid generation:  0.008591175079345703
local_in_edges_tensor generation:  0.007544040679931641
mini_batch_src_global generation:  0.01605987548828125
r_  generation:  0.1422274112701416
local_output_nid generation:  0.008397579193115234
local_in_edges_tensor generation:  0.008205175399780273
mini_batch_src_global generation:  0.01615428924560547
r_  generation:  0.13407206535339355
local_output_nid generation:  0.008560895919799805
local_in_edges_tensor generation:  0.007726907730102539
mini_batch_src_global generation:  0.0157320499420166
r_  generation:  0.14044666290283203
local_output_nid generation:  0.008542776107788086
local_in_edges_tensor generation:  0.007688999176025391
mini_batch_src_global generation:  0.01625204086303711
r_  generation:  0.1378483772277832
local_output_nid generation:  0.008565425872802734
local_in_edges_tensor generation:  0.007588624954223633
mini_batch_src_global generation:  0.016029834747314453
r_  generation:  0.1410973072052002
local_output_nid generation:  0.008282899856567383
local_in_edges_tensor generation:  0.007429599761962891
mini_batch_src_global generation:  0.016405105590820312
r_  generation:  0.13533544540405273
local_output_nid generation:  0.008601188659667969
local_in_edges_tensor generation:  0.00870060920715332
mini_batch_src_global generation:  0.016648054122924805
r_  generation:  0.1422731876373291
local_output_nid generation:  0.008561134338378906
local_in_edges_tensor generation:  0.008014202117919922
mini_batch_src_global generation:  0.016983747482299805
r_  generation:  0.1395876407623291
----------------------check_connections_block total spend ----------------------------- 6.652266502380371
generate_one_block  0.1847071647644043
generate_one_block  0.17233562469482422
generate_one_block  0.1775662899017334
generate_one_block  0.17855215072631836
generate_one_block  0.20981216430664062
generate_one_block  0.18484258651733398
generate_one_block  0.18125104904174805
generate_one_block  0.17090988159179688
generate_one_block  0.17387151718139648
generate_one_block  0.17937564849853516
generate_one_block  0.1772022247314453
generate_one_block  0.17073726654052734
generate_one_block  0.17738080024719238
generate_one_block  0.18784046173095703
generate_one_block  0.1896500587463379
generate_one_block  0.18063759803771973
generate_one_block  0.18340325355529785
generate_one_block  0.18694114685058594
generate_one_block  0.18109679222106934
generate_one_block  0.17996954917907715
generate_one_block  0.1803116798400879
generate_one_block  0.1778857707977295
generate_one_block  0.18430829048156738
generate_one_block  0.17848563194274902
generate_one_block  0.1814734935760498
generate_one_block  0.17723727226257324
generate_one_block  0.17857646942138672
generate_one_block  0.1776566505432129
generate_one_block  0.17802643775939941
generate_one_block  0.17394375801086426
generate_one_block  0.18376708030700684
generate_one_block  0.17943501472473145
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03427243232727051
gen group dst list time:  0.10332298278808594
time for parepare:  0.020026206970214844
local_output_nid generation:  0.02484750747680664
local_in_edges_tensor generation:  0.04473090171813965
mini_batch_src_global generation:  0.03700733184814453
r_  generation:  0.4079012870788574
local_output_nid generation:  0.030327320098876953
local_in_edges_tensor generation:  0.032419681549072266
mini_batch_src_global generation:  0.04715085029602051
r_  generation:  0.3913900852203369
local_output_nid generation:  0.029515504837036133
local_in_edges_tensor generation:  0.027434825897216797
mini_batch_src_global generation:  0.04768967628479004
r_  generation:  0.405073881149292
local_output_nid generation:  0.02960944175720215
local_in_edges_tensor generation:  0.02782607078552246
mini_batch_src_global generation:  0.047235727310180664
r_  generation:  0.40006279945373535
local_output_nid generation:  0.029605627059936523
local_in_edges_tensor generation:  0.0269014835357666
mini_batch_src_global generation:  0.04650139808654785
r_  generation:  0.4093008041381836
local_output_nid generation:  0.028980493545532227
local_in_edges_tensor generation:  0.029169082641601562
mini_batch_src_global generation:  0.04816889762878418
r_  generation:  0.41553449630737305
local_output_nid generation:  0.027767658233642578
local_in_edges_tensor generation:  0.02886223793029785
mini_batch_src_global generation:  0.04727983474731445
r_  generation:  0.41420984268188477
local_output_nid generation:  0.02964043617248535
local_in_edges_tensor generation:  0.024692773818969727
mini_batch_src_global generation:  0.04896950721740723
r_  generation:  0.3965914249420166
local_output_nid generation:  0.027845144271850586
local_in_edges_tensor generation:  0.025600433349609375
mini_batch_src_global generation:  0.046895742416381836
r_  generation:  0.4112110137939453
local_output_nid generation:  0.027596712112426758
local_in_edges_tensor generation:  0.03012561798095703
mini_batch_src_global generation:  0.04801011085510254
r_  generation:  0.40475034713745117
local_output_nid generation:  0.027601957321166992
local_in_edges_tensor generation:  0.03123617172241211
mini_batch_src_global generation:  0.04636979103088379
r_  generation:  0.4115946292877197
local_output_nid generation:  0.027350187301635742
local_in_edges_tensor generation:  0.024576425552368164
mini_batch_src_global generation:  0.04868793487548828
r_  generation:  0.4032740592956543
local_output_nid generation:  0.028141498565673828
local_in_edges_tensor generation:  0.027397632598876953
mini_batch_src_global generation:  0.04816722869873047
r_  generation:  0.41164708137512207
local_output_nid generation:  0.029257535934448242
local_in_edges_tensor generation:  0.027918100357055664
mini_batch_src_global generation:  0.05010390281677246
r_  generation:  0.4068574905395508
local_output_nid generation:  0.02751469612121582
local_in_edges_tensor generation:  0.03337383270263672
mini_batch_src_global generation:  0.04612112045288086
r_  generation:  0.40541768074035645
local_output_nid generation:  0.027855396270751953
local_in_edges_tensor generation:  0.025374412536621094
mini_batch_src_global generation:  0.04974079132080078
r_  generation:  0.4007594585418701
local_output_nid generation:  0.02797698974609375
local_in_edges_tensor generation:  0.02790355682373047
mini_batch_src_global generation:  0.04628920555114746
r_  generation:  0.4107813835144043
local_output_nid generation:  0.027707576751708984
local_in_edges_tensor generation:  0.027901649475097656
mini_batch_src_global generation:  0.04816007614135742
r_  generation:  0.41219258308410645
local_output_nid generation:  0.02900099754333496
local_in_edges_tensor generation:  0.026698589324951172
mini_batch_src_global generation:  0.04808473587036133
r_  generation:  0.41242408752441406
local_output_nid generation:  0.027448415756225586
local_in_edges_tensor generation:  0.024521350860595703
mini_batch_src_global generation:  0.04824328422546387
r_  generation:  0.3990645408630371
local_output_nid generation:  0.027570009231567383
local_in_edges_tensor generation:  0.024951934814453125
mini_batch_src_global generation:  0.046132564544677734
r_  generation:  0.4051506519317627
local_output_nid generation:  0.027771472930908203
local_in_edges_tensor generation:  0.02671527862548828
mini_batch_src_global generation:  0.04734301567077637
r_  generation:  0.4004545211791992
local_output_nid generation:  0.027551889419555664
local_in_edges_tensor generation:  0.02506279945373535
mini_batch_src_global generation:  0.04784750938415527
r_  generation:  0.41219592094421387
local_output_nid generation:  0.02776169776916504
local_in_edges_tensor generation:  0.026205778121948242
mini_batch_src_global generation:  0.04818081855773926
r_  generation:  0.39914536476135254
local_output_nid generation:  0.027584075927734375
local_in_edges_tensor generation:  0.024880409240722656
mini_batch_src_global generation:  0.04625749588012695
r_  generation:  0.4201695919036865
local_output_nid generation:  0.027478456497192383
local_in_edges_tensor generation:  0.02608323097229004
mini_batch_src_global generation:  0.04764366149902344
r_  generation:  0.3983423709869385
local_output_nid generation:  0.027765512466430664
local_in_edges_tensor generation:  0.026628971099853516
mini_batch_src_global generation:  0.04589533805847168
r_  generation:  0.4021029472351074
local_output_nid generation:  0.02753162384033203
local_in_edges_tensor generation:  0.024270057678222656
mini_batch_src_global generation:  0.047434329986572266
r_  generation:  0.40137267112731934
local_output_nid generation:  0.02764153480529785
local_in_edges_tensor generation:  0.024550437927246094
mini_batch_src_global generation:  0.04700136184692383
r_  generation:  0.4107940196990967
local_output_nid generation:  0.027486562728881836
local_in_edges_tensor generation:  0.02467799186706543
mini_batch_src_global generation:  0.04797172546386719
r_  generation:  0.3990592956542969
local_output_nid generation:  0.027796506881713867
local_in_edges_tensor generation:  0.030764341354370117
mini_batch_src_global generation:  0.04695940017700195
r_  generation:  0.41207194328308105
local_output_nid generation:  0.027680158615112305
local_in_edges_tensor generation:  0.02811598777770996
mini_batch_src_global generation:  0.049707651138305664
r_  generation:  0.40900373458862305
----------------------check_connections_block total spend ----------------------------- 19.18340754508972
generate_one_block  0.5569467544555664
generate_one_block  0.5319154262542725
generate_one_block  0.5432744026184082
generate_one_block  0.5432794094085693
generate_one_block  0.627126932144165
generate_one_block  0.5457825660705566
generate_one_block  0.5435128211975098
generate_one_block  0.5293159484863281
generate_one_block  0.5283114910125732
generate_one_block  0.5387945175170898
generate_one_block  0.5385818481445312
generate_one_block  0.5313358306884766
generate_one_block  0.5398576259613037
generate_one_block  0.5483968257904053
generate_one_block  0.5256409645080566
generate_one_block  0.5344305038452148
generate_one_block  0.5536820888519287
generate_one_block  0.5395188331604004
generate_one_block  0.5405592918395996
generate_one_block  0.5287816524505615
generate_one_block  0.5312409400939941
generate_one_block  0.5326530933380127
generate_one_block  0.5366873741149902
generate_one_block  0.5406115055084229
generate_one_block  0.553184986114502
generate_one_block  0.5296628475189209
generate_one_block  0.5240068435668945
generate_one_block  0.5428707599639893
generate_one_block  0.5386009216308594
generate_one_block  0.5293481349945068
generate_one_block  0.5551557540893555
generate_one_block  0.5450103282928467
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.12210893630981445  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

connection checking time:  25.835674047470093
block generation total time  23.107270002365112
average batch blocks generation time:  0.7221021875739098
block dataloader generation time/epoch 51.62324047088623
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10391855239868164  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.894731521606445  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10309171676635742  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.494741439819336  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10500383377075195  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.828330516815186  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10428619384765625  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.820239543914795  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10502481460571289  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.845897674560547  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10419702529907227  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.093506336212158  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10502958297729492  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.942606925964355  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10272979736328125  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.414989471435547  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10393619537353516  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.596858978271484  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10407781600952148  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.810330867767334  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10500192642211914  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.790618896484375  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10274887084960938  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.491313457489014  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10396575927734375  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.66185188293457  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1041250228881836  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.958857536315918  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1026301383972168  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.37500810623169  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10278654098510742  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.654864311218262  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10502099990844727  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.86233901977539  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10438346862792969  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.964980125427246  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10500097274780273  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.818978309631348  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1026315689086914  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.55120325088501  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10280609130859375  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.613993644714355  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10313177108764648  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.613494873046875  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10503005981445312  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.89914321899414  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1030116081237793  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.758286952972412  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1038827896118164  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.803225040435791  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10270452499389648  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.370070457458496  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10265159606933594  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.494913578033447  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10313272476196289  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.64387321472168  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10389137268066406  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.543997764587402  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10269832611083984  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.361488342285156  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10391855239868164  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.86357069015503  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10427093505859375  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.794374942779541  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03231558948755264 |0.010406740009784698 |0.2692084014415741 |9.075552225112915e-05 |0.43031037598848343 |0.006092071533203125 |
----------------------------------------------------------pseudo_mini_loss sum 1.4335708618164062
Total (block generation + training)time/epoch 75.4429259300232
Training time/epoch 23.811261415481567
Training time without block to device /epoch 23.478245735168457
Training time without total dataloading part /epoch 22.39359712600708
load block tensor time/epoch 1.0340988636016846
block to device time/epoch 0.33301568031311035
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 16 |
Number of nodes for computation during this epoch:  8580563
Number of first layer input nodes during this epoch:  4656123
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.12211942672729492  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02133798599243164
random selection method range initialization spend 0.006391286849975586
time for parepare:  0.021206140518188477
local_output_nid generation:  0.0013675689697265625
local_in_edges_tensor generation:  0.0041196346282958984
mini_batch_src_global generation:  0.003000974655151367
r_  generation:  0.014365434646606445
local_output_nid generation:  0.0024805068969726562
local_in_edges_tensor generation:  0.0011997222900390625
mini_batch_src_global generation:  0.0020186901092529297
r_  generation:  0.008986234664916992
local_output_nid generation:  0.002269268035888672
local_in_edges_tensor generation:  0.0011475086212158203
mini_batch_src_global generation:  0.0013527870178222656
r_  generation:  0.008123636245727539
local_output_nid generation:  0.0021932125091552734
local_in_edges_tensor generation:  0.0010585784912109375
mini_batch_src_global generation:  0.0013015270233154297
r_  generation:  0.00811004638671875
local_output_nid generation:  0.0021409988403320312
local_in_edges_tensor generation:  0.0010650157928466797
mini_batch_src_global generation:  0.0011832714080810547
r_  generation:  0.008197784423828125
local_output_nid generation:  0.0021102428436279297
local_in_edges_tensor generation:  0.0010449886322021484
mini_batch_src_global generation:  0.0011951923370361328
r_  generation:  0.008063554763793945
local_output_nid generation:  0.0020787715911865234
local_in_edges_tensor generation:  0.000995635986328125
mini_batch_src_global generation:  0.0011444091796875
r_  generation:  0.008295297622680664
local_output_nid generation:  0.0020494461059570312
local_in_edges_tensor generation:  0.001058340072631836
mini_batch_src_global generation:  0.0011408329010009766
r_  generation:  0.008360147476196289
local_output_nid generation:  0.0020475387573242188
local_in_edges_tensor generation:  0.0010676383972167969
mini_batch_src_global generation:  0.0035004615783691406
r_  generation:  0.008623838424682617
local_output_nid generation:  0.0021185874938964844
local_in_edges_tensor generation:  0.0012183189392089844
mini_batch_src_global generation:  0.0011625289916992188
r_  generation:  0.008602380752563477
local_output_nid generation:  0.0021245479583740234
local_in_edges_tensor generation:  0.0010581016540527344
mini_batch_src_global generation:  0.0012269020080566406
r_  generation:  0.008668899536132812
local_output_nid generation:  0.0021142959594726562
local_in_edges_tensor generation:  0.001043558120727539
mini_batch_src_global generation:  0.0011551380157470703
r_  generation:  0.008682012557983398
local_output_nid generation:  0.0021142959594726562
local_in_edges_tensor generation:  0.0010728836059570312
mini_batch_src_global generation:  0.0011606216430664062
r_  generation:  0.008476018905639648
local_output_nid generation:  0.0021266937255859375
local_in_edges_tensor generation:  0.0010547637939453125
mini_batch_src_global generation:  0.0011258125305175781
r_  generation:  0.008470535278320312
local_output_nid generation:  0.0021429061889648438
local_in_edges_tensor generation:  0.001054525375366211
mini_batch_src_global generation:  0.001093149185180664
r_  generation:  0.009005308151245117
local_output_nid generation:  0.002117633819580078
local_in_edges_tensor generation:  0.0011038780212402344
mini_batch_src_global generation:  0.0011074542999267578
r_  generation:  0.008455276489257812
local_output_nid generation:  0.0021483898162841797
local_in_edges_tensor generation:  0.0010716915130615234
mini_batch_src_global generation:  0.0011339187622070312
r_  generation:  0.008428096771240234
local_output_nid generation:  0.0021097660064697266
local_in_edges_tensor generation:  0.001039743423461914
mini_batch_src_global generation:  0.0012676715850830078
r_  generation:  0.008214235305786133
local_output_nid generation:  0.0021381378173828125
local_in_edges_tensor generation:  0.0009984970092773438
mini_batch_src_global generation:  0.0010755062103271484
r_  generation:  0.00837254524230957
local_output_nid generation:  0.002117633819580078
local_in_edges_tensor generation:  0.0010290145874023438
mini_batch_src_global generation:  0.0013456344604492188
r_  generation:  0.008860349655151367
local_output_nid generation:  0.002129077911376953
local_in_edges_tensor generation:  0.0010113716125488281
mini_batch_src_global generation:  0.001132965087890625
r_  generation:  0.008656978607177734
local_output_nid generation:  0.002130746841430664
local_in_edges_tensor generation:  0.0010390281677246094
mini_batch_src_global generation:  0.0011057853698730469
r_  generation:  0.008241653442382812
local_output_nid generation:  0.0021479129791259766
local_in_edges_tensor generation:  0.000990152359008789
mini_batch_src_global generation:  0.0010569095611572266
r_  generation:  0.008280038833618164
local_output_nid generation:  0.0021462440490722656
local_in_edges_tensor generation:  0.0010161399841308594
mini_batch_src_global generation:  0.0011091232299804688
r_  generation:  0.008474588394165039
local_output_nid generation:  0.0021233558654785156
local_in_edges_tensor generation:  0.0010170936584472656
mini_batch_src_global generation:  0.0010671615600585938
r_  generation:  0.008341789245605469
local_output_nid generation:  0.0021436214447021484
local_in_edges_tensor generation:  0.0010008811950683594
mini_batch_src_global generation:  0.0010662078857421875
r_  generation:  0.0085296630859375
local_output_nid generation:  0.002104043960571289
local_in_edges_tensor generation:  0.0009870529174804688
mini_batch_src_global generation:  0.0010752677917480469
r_  generation:  0.008515596389770508
local_output_nid generation:  0.002145051956176758
local_in_edges_tensor generation:  0.0010561943054199219
mini_batch_src_global generation:  0.0011873245239257812
r_  generation:  0.010117292404174805
local_output_nid generation:  0.002179384231567383
local_in_edges_tensor generation:  0.0051267147064208984
mini_batch_src_global generation:  0.004077434539794922
r_  generation:  0.013339757919311523
local_output_nid generation:  0.0028219223022460938
local_in_edges_tensor generation:  0.0012288093566894531
mini_batch_src_global generation:  0.0013468265533447266
r_  generation:  0.008436441421508789
local_output_nid generation:  0.002346038818359375
local_in_edges_tensor generation:  0.0009732246398925781
mini_batch_src_global generation:  0.0010914802551269531
r_  generation:  0.00823521614074707
local_output_nid generation:  0.002202749252319336
local_in_edges_tensor generation:  0.0009388923645019531
mini_batch_src_global generation:  0.0009944438934326172
r_  generation:  0.008201122283935547
----------------------check_connections_block total spend ----------------------------- 0.5582916736602783
generate_one_block  0.021816253662109375
generate_one_block  0.017706871032714844
generate_one_block  0.01475977897644043
generate_one_block  0.014656782150268555
generate_one_block  0.014345884323120117
generate_one_block  0.014265060424804688
generate_one_block  0.014425039291381836
generate_one_block  0.016150474548339844
generate_one_block  0.018390178680419922
generate_one_block  0.014753103256225586
generate_one_block  0.014832258224487305
generate_one_block  0.015255212783813477
generate_one_block  0.014490365982055664
generate_one_block  0.014579057693481445
generate_one_block  0.016290903091430664
generate_one_block  0.014442682266235352
generate_one_block  0.014587163925170898
generate_one_block  0.014222383499145508
generate_one_block  0.014183759689331055
generate_one_block  0.015119552612304688
generate_one_block  0.014689207077026367
generate_one_block  0.014209747314453125
generate_one_block  0.014227151870727539
generate_one_block  0.014465808868408203
generate_one_block  0.014276742935180664
generate_one_block  0.014543533325195312
generate_one_block  0.01445913314819336
generate_one_block  0.015228748321533203
generate_one_block  0.014549732208251953
generate_one_block  0.014245986938476562
generate_one_block  0.014194250106811523
generate_one_block  0.0142364501953125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03677082061767578
gen group dst list time:  0.02329230308532715
time for parepare:  0.021817445755004883
local_output_nid generation:  0.005490303039550781
local_in_edges_tensor generation:  0.015937089920043945
mini_batch_src_global generation:  0.015485525131225586
r_  generation:  0.1286313533782959
local_output_nid generation:  0.0077702999114990234
local_in_edges_tensor generation:  0.009642839431762695
mini_batch_src_global generation:  0.018264293670654297
r_  generation:  0.15709757804870605
local_output_nid generation:  0.008069992065429688
local_in_edges_tensor generation:  0.0301973819732666
mini_batch_src_global generation:  0.016989707946777344
r_  generation:  0.13024020195007324
local_output_nid generation:  0.008214712142944336
local_in_edges_tensor generation:  0.009256601333618164
mini_batch_src_global generation:  0.017867326736450195
r_  generation:  0.13300800323486328
local_output_nid generation:  0.008047103881835938
local_in_edges_tensor generation:  0.007984161376953125
mini_batch_src_global generation:  0.02609109878540039
r_  generation:  0.15757393836975098
local_output_nid generation:  0.009691953659057617
local_in_edges_tensor generation:  0.007325887680053711
mini_batch_src_global generation:  0.01966118812561035
r_  generation:  0.13604307174682617
local_output_nid generation:  0.008060455322265625
local_in_edges_tensor generation:  0.008344411849975586
mini_batch_src_global generation:  0.01828908920288086
r_  generation:  0.13559293746948242
local_output_nid generation:  0.007927179336547852
local_in_edges_tensor generation:  0.007436037063598633
mini_batch_src_global generation:  0.01866888999938965
r_  generation:  0.13505959510803223
local_output_nid generation:  0.007997751235961914
local_in_edges_tensor generation:  0.008228778839111328
mini_batch_src_global generation:  0.019730091094970703
r_  generation:  0.14174652099609375
local_output_nid generation:  0.007944345474243164
local_in_edges_tensor generation:  0.00763392448425293
mini_batch_src_global generation:  0.01904129981994629
r_  generation:  0.1423356533050537
local_output_nid generation:  0.008430004119873047
local_in_edges_tensor generation:  0.009369373321533203
mini_batch_src_global generation:  0.017650127410888672
r_  generation:  0.19534873962402344
local_output_nid generation:  0.008285760879516602
local_in_edges_tensor generation:  0.00915670394897461
mini_batch_src_global generation:  0.017314434051513672
r_  generation:  0.14071059226989746
local_output_nid generation:  0.008359909057617188
local_in_edges_tensor generation:  0.007680654525756836
mini_batch_src_global generation:  0.016587257385253906
r_  generation:  0.13860726356506348
local_output_nid generation:  0.008265495300292969
local_in_edges_tensor generation:  0.0076520442962646484
mini_batch_src_global generation:  0.016671180725097656
r_  generation:  0.14153122901916504
local_output_nid generation:  0.008458375930786133
local_in_edges_tensor generation:  0.00756072998046875
mini_batch_src_global generation:  0.016805648803710938
r_  generation:  0.14390301704406738
local_output_nid generation:  0.008321523666381836
local_in_edges_tensor generation:  0.011260032653808594
mini_batch_src_global generation:  0.016669034957885742
r_  generation:  0.1383819580078125
local_output_nid generation:  0.008230924606323242
local_in_edges_tensor generation:  0.009042024612426758
mini_batch_src_global generation:  0.01641368865966797
r_  generation:  0.13763141632080078
local_output_nid generation:  0.008142232894897461
local_in_edges_tensor generation:  0.008880853652954102
mini_batch_src_global generation:  0.01586318016052246
r_  generation:  0.13171076774597168
local_output_nid generation:  0.008045196533203125
local_in_edges_tensor generation:  0.007363319396972656
mini_batch_src_global generation:  0.01625657081604004
r_  generation:  0.13937878608703613
local_output_nid generation:  0.00832056999206543
local_in_edges_tensor generation:  0.008302450180053711
mini_batch_src_global generation:  0.017711162567138672
r_  generation:  0.14128780364990234
local_output_nid generation:  0.008271217346191406
local_in_edges_tensor generation:  0.008545637130737305
mini_batch_src_global generation:  0.01697516441345215
r_  generation:  0.14201140403747559
local_output_nid generation:  0.008108139038085938
local_in_edges_tensor generation:  0.0074956417083740234
mini_batch_src_global generation:  0.0161592960357666
r_  generation:  0.1352219581604004
local_output_nid generation:  0.008255481719970703
local_in_edges_tensor generation:  0.00753021240234375
mini_batch_src_global generation:  0.015652894973754883
r_  generation:  0.17240357398986816
local_output_nid generation:  0.010760784149169922
local_in_edges_tensor generation:  0.008205413818359375
mini_batch_src_global generation:  0.020502567291259766
r_  generation:  0.13936591148376465
local_output_nid generation:  0.008249044418334961
local_in_edges_tensor generation:  0.007548809051513672
mini_batch_src_global generation:  0.016335010528564453
r_  generation:  0.1400318145751953
local_output_nid generation:  0.009239912033081055
local_in_edges_tensor generation:  0.007653951644897461
mini_batch_src_global generation:  0.02039194107055664
r_  generation:  0.14475536346435547
local_output_nid generation:  0.008342504501342773
local_in_edges_tensor generation:  0.007965087890625
mini_batch_src_global generation:  0.01897263526916504
r_  generation:  0.1418921947479248
local_output_nid generation:  0.008635520935058594
local_in_edges_tensor generation:  0.011220216751098633
mini_batch_src_global generation:  0.019591331481933594
r_  generation:  0.14628195762634277
local_output_nid generation:  0.00843501091003418
local_in_edges_tensor generation:  0.008237600326538086
mini_batch_src_global generation:  0.018577098846435547
r_  generation:  0.14325213432312012
local_output_nid generation:  0.008266687393188477
local_in_edges_tensor generation:  0.00808405876159668
mini_batch_src_global generation:  0.017621755599975586
r_  generation:  0.14575576782226562
local_output_nid generation:  0.010226964950561523
local_in_edges_tensor generation:  0.007922172546386719
mini_batch_src_global generation:  0.017683029174804688
r_  generation:  0.17360138893127441
local_output_nid generation:  0.013576745986938477
local_in_edges_tensor generation:  0.011846780776977539
mini_batch_src_global generation:  0.021846294403076172
r_  generation:  0.16832280158996582
----------------------check_connections_block total spend ----------------------------- 6.883357524871826
generate_one_block  0.184584379196167
generate_one_block  0.1986711025238037
generate_one_block  0.17243599891662598
generate_one_block  0.17629337310791016
generate_one_block  0.2027590274810791
generate_one_block  0.17545390129089355
generate_one_block  0.17522192001342773
generate_one_block  0.17393040657043457
generate_one_block  0.17964839935302734
generate_one_block  0.1773848533630371
generate_one_block  0.1810765266418457
generate_one_block  0.18264532089233398
generate_one_block  0.1959981918334961
generate_one_block  0.18104243278503418
generate_one_block  0.18555617332458496
generate_one_block  0.1798856258392334
generate_one_block  0.17734622955322266
generate_one_block  0.17033791542053223
generate_one_block  0.19766616821289062
generate_one_block  0.18646693229675293
generate_one_block  0.18055295944213867
generate_one_block  0.16919493675231934
generate_one_block  0.17150664329528809
generate_one_block  0.17824029922485352
generate_one_block  0.1721024513244629
generate_one_block  0.17677712440490723
generate_one_block  0.1793212890625
generate_one_block  0.186553955078125
generate_one_block  0.17792344093322754
generate_one_block  0.17312836647033691
generate_one_block  0.17104101181030273
generate_one_block  0.17435574531555176
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03418374061584473
gen group dst list time:  0.09860754013061523
time for parepare:  0.018890857696533203
local_output_nid generation:  0.024092912673950195
local_in_edges_tensor generation:  0.04419255256652832
mini_batch_src_global generation:  0.03718280792236328
r_  generation:  0.39359426498413086
local_output_nid generation:  0.0291750431060791
local_in_edges_tensor generation:  0.03271985054016113
mini_batch_src_global generation:  0.048601388931274414
r_  generation:  0.3999295234680176
local_output_nid generation:  0.029217243194580078
local_in_edges_tensor generation:  0.030561447143554688
mini_batch_src_global generation:  0.04766249656677246
r_  generation:  0.4252641201019287
local_output_nid generation:  0.032768964767456055
local_in_edges_tensor generation:  0.030447006225585938
mini_batch_src_global generation:  0.048592567443847656
r_  generation:  0.39572978019714355
local_output_nid generation:  0.02910470962524414
local_in_edges_tensor generation:  0.026396751403808594
mini_batch_src_global generation:  0.04654431343078613
r_  generation:  0.40409183502197266
local_output_nid generation:  0.02825307846069336
local_in_edges_tensor generation:  0.026302814483642578
mini_batch_src_global generation:  0.049371957778930664
r_  generation:  0.39698195457458496
local_output_nid generation:  0.027919292449951172
local_in_edges_tensor generation:  0.024772167205810547
mini_batch_src_global generation:  0.046544790267944336
r_  generation:  0.4031398296356201
local_output_nid generation:  0.027811527252197266
local_in_edges_tensor generation:  0.026200056076049805
mini_batch_src_global generation:  0.047586679458618164
r_  generation:  0.3956425189971924
local_output_nid generation:  0.027693986892700195
local_in_edges_tensor generation:  0.026210784912109375
mini_batch_src_global generation:  0.04658651351928711
r_  generation:  0.40763092041015625
local_output_nid generation:  0.0300290584564209
local_in_edges_tensor generation:  0.02697587013244629
mini_batch_src_global generation:  0.04815554618835449
r_  generation:  0.4144749641418457
local_output_nid generation:  0.02982354164123535
local_in_edges_tensor generation:  0.029704809188842773
mini_batch_src_global generation:  0.04708242416381836
r_  generation:  0.4140141010284424
local_output_nid generation:  0.027962207794189453
local_in_edges_tensor generation:  0.030448436737060547
mini_batch_src_global generation:  0.048651933670043945
r_  generation:  0.39982032775878906
local_output_nid generation:  0.028593778610229492
local_in_edges_tensor generation:  0.024190425872802734
mini_batch_src_global generation:  0.046705007553100586
r_  generation:  0.4032723903656006
local_output_nid generation:  0.028447628021240234
local_in_edges_tensor generation:  0.027745962142944336
mini_batch_src_global generation:  0.04957747459411621
r_  generation:  0.3983345031738281
local_output_nid generation:  0.027861356735229492
local_in_edges_tensor generation:  0.024632930755615234
mini_batch_src_global generation:  0.046536922454833984
r_  generation:  0.408646821975708
local_output_nid generation:  0.027589082717895508
local_in_edges_tensor generation:  0.02856612205505371
mini_batch_src_global generation:  0.04769110679626465
r_  generation:  0.3983011245727539
local_output_nid generation:  0.027454137802124023
local_in_edges_tensor generation:  0.026731491088867188
mini_batch_src_global generation:  0.04594111442565918
r_  generation:  0.40491366386413574
local_output_nid generation:  0.027430295944213867
local_in_edges_tensor generation:  0.024411678314208984
mini_batch_src_global generation:  0.04724931716918945
r_  generation:  0.39893460273742676
local_output_nid generation:  0.027849435806274414
local_in_edges_tensor generation:  0.0305788516998291
mini_batch_src_global generation:  0.0482790470123291
r_  generation:  0.412158727645874
local_output_nid generation:  0.02801346778869629
local_in_edges_tensor generation:  0.028441905975341797
mini_batch_src_global generation:  0.04821419715881348
r_  generation:  0.40622615814208984
local_output_nid generation:  0.02786874771118164
local_in_edges_tensor generation:  0.02848362922668457
mini_batch_src_global generation:  0.04863929748535156
r_  generation:  0.42324352264404297
local_output_nid generation:  0.0295865535736084
local_in_edges_tensor generation:  0.02659773826599121
mini_batch_src_global generation:  0.04956817626953125
r_  generation:  0.39462757110595703
local_output_nid generation:  0.02821660041809082
local_in_edges_tensor generation:  0.02859950065612793
mini_batch_src_global generation:  0.046385765075683594
r_  generation:  0.4052450656890869
local_output_nid generation:  0.027840614318847656
local_in_edges_tensor generation:  0.02504110336303711
mini_batch_src_global generation:  0.047361135482788086
r_  generation:  0.397996187210083
local_output_nid generation:  0.027965784072875977
local_in_edges_tensor generation:  0.025872468948364258
mini_batch_src_global generation:  0.04762458801269531
r_  generation:  0.4024524688720703
local_output_nid generation:  0.027688980102539062
local_in_edges_tensor generation:  0.025991439819335938
mini_batch_src_global generation:  0.047818899154663086
r_  generation:  0.3955204486846924
local_output_nid generation:  0.027551889419555664
local_in_edges_tensor generation:  0.025002002716064453
mini_batch_src_global generation:  0.045656681060791016
r_  generation:  0.4077260494232178
local_output_nid generation:  0.028075456619262695
local_in_edges_tensor generation:  0.028612136840820312
mini_batch_src_global generation:  0.04831385612487793
r_  generation:  0.4018747806549072
local_output_nid generation:  0.02797245979309082
local_in_edges_tensor generation:  0.025019168853759766
mini_batch_src_global generation:  0.047799110412597656
r_  generation:  0.4077188968658447
local_output_nid generation:  0.02761244773864746
local_in_edges_tensor generation:  0.025223255157470703
mini_batch_src_global generation:  0.047785282135009766
r_  generation:  0.3949151039123535
local_output_nid generation:  0.02747321128845215
local_in_edges_tensor generation:  0.024349451065063477
mini_batch_src_global generation:  0.04615449905395508
r_  generation:  0.4030439853668213
local_output_nid generation:  0.027562618255615234
local_in_edges_tensor generation:  0.02554798126220703
mini_batch_src_global generation:  0.049483537673950195
r_  generation:  0.40331530570983887
----------------------check_connections_block total spend ----------------------------- 19.08385992050171
generate_one_block  0.5466785430908203
generate_one_block  0.5368108749389648
generate_one_block  0.5312533378601074
generate_one_block  0.5416011810302734
generate_one_block  0.626305103302002
generate_one_block  0.5324559211730957
generate_one_block  0.5387191772460938
generate_one_block  0.5357058048248291
generate_one_block  0.5379586219787598
generate_one_block  0.5421714782714844
generate_one_block  0.543785810470581
generate_one_block  0.5479142665863037
generate_one_block  0.5345430374145508
generate_one_block  0.5280401706695557
generate_one_block  0.5368950366973877
generate_one_block  0.5297167301177979
generate_one_block  0.5347251892089844
generate_one_block  0.5286769866943359
generate_one_block  0.5354263782501221
generate_one_block  0.5570290088653564
generate_one_block  0.5392420291900635
generate_one_block  0.5307519435882568
generate_one_block  0.5289125442504883
generate_one_block  0.5326759815216064
generate_one_block  0.5421209335327148
generate_one_block  0.5364475250244141
generate_one_block  0.537285327911377
generate_one_block  0.5449495315551758
generate_one_block  0.5373990535736084
generate_one_block  0.5293929576873779
generate_one_block  0.5271921157836914
generate_one_block  0.5324902534484863
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.12211942672729492  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

connection checking time:  25.967217445373535
block generation total time  23.030375957489014
average batch blocks generation time:  0.7196992486715317
block dataloader generation time/epoch 51.62108129262924
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10405874252319336  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.025137901306152  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10282611846923828  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.661489486694336  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10390090942382812  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.57536268234253  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10291624069213867  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.693413257598877  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10267114639282227  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.38239049911499  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10283660888671875  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.650304317474365  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10393810272216797  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.644509315490723  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1029047966003418  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.588609218597412  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10390424728393555  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.85865306854248  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10411739349365234  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.790351867675781  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10504865646362305  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.03664493560791  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10410308837890625  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.908703327178955  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10388755798339844  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.553187370300293  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10290288925170898  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.754337310791016  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10502004623413086  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.85305118560791  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10264778137207031  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.701735973358154  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10396766662597656  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.693851470947266  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10288190841674805  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.312815189361572  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10393142700195312  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.55144739151001  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10435104370117188  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.981147766113281  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10400962829589844  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.944017887115479  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10281658172607422  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.455965995788574  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10271883010864258  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.473485469818115  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10304832458496094  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.719185829162598  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1038503646850586  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.56335163116455  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10262632369995117  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.71584701538086  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1028146743774414  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.66466999053955  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1042780876159668  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.177300930023193  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10502052307128906  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.879879474639893  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10285615921020508  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.536534786224365  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10269641876220703  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.491100311279297  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1027674674987793  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.647146224975586  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03413737565279007 |0.011530168354511261 |0.2641020342707634 |8.953362703323364e-05 |0.4290126860141754 |0.004550457000732422 |
----------------------------------------------------------pseudo_mini_loss sum 1.4088233709335327
Total (block generation + training)time/epoch 75.42582359910011
Training time/epoch 23.699657201766968
Training time without block to device /epoch 23.330691814422607
Training time without total dataloading part /epoch 22.187086582183838
load block tensor time/epoch 1.0923960208892822
block to device time/epoch 0.36896538734436035
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 17 |
Number of nodes for computation during this epoch:  8570793
Number of first layer input nodes during this epoch:  4651301
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.11951732635498047  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021237850189208984
random selection method range initialization spend 0.005216836929321289
time for parepare:  0.019876956939697266
local_output_nid generation:  0.001415252685546875
local_in_edges_tensor generation:  0.0059871673583984375
mini_batch_src_global generation:  0.0015895366668701172
r_  generation:  0.00873422622680664
local_output_nid generation:  0.0015437602996826172
local_in_edges_tensor generation:  0.0009474754333496094
mini_batch_src_global generation:  0.0014760494232177734
r_  generation:  0.008508682250976562
local_output_nid generation:  0.001590728759765625
local_in_edges_tensor generation:  0.0008690357208251953
mini_batch_src_global generation:  0.0009813308715820312
r_  generation:  0.008127689361572266
local_output_nid generation:  0.0015377998352050781
local_in_edges_tensor generation:  0.0008292198181152344
mini_batch_src_global generation:  0.0009627342224121094
r_  generation:  0.008041858673095703
local_output_nid generation:  0.001489877700805664
local_in_edges_tensor generation:  0.0007958412170410156
mini_batch_src_global generation:  0.0009052753448486328
r_  generation:  0.007958412170410156
local_output_nid generation:  0.0014901161193847656
local_in_edges_tensor generation:  0.0007827281951904297
mini_batch_src_global generation:  0.0009527206420898438
r_  generation:  0.008206844329833984
local_output_nid generation:  0.0014781951904296875
local_in_edges_tensor generation:  0.0007879734039306641
mini_batch_src_global generation:  0.000949859619140625
r_  generation:  0.00844717025756836
local_output_nid generation:  0.0014717578887939453
local_in_edges_tensor generation:  0.0007681846618652344
mini_batch_src_global generation:  0.0009016990661621094
r_  generation:  0.008243083953857422
local_output_nid generation:  0.001466989517211914
local_in_edges_tensor generation:  0.00079345703125
mini_batch_src_global generation:  0.0009548664093017578
r_  generation:  0.009788036346435547
local_output_nid generation:  0.0014941692352294922
local_in_edges_tensor generation:  0.0007851123809814453
mini_batch_src_global generation:  0.0009617805480957031
r_  generation:  0.008218765258789062
local_output_nid generation:  0.0014922618865966797
local_in_edges_tensor generation:  0.0008113384246826172
mini_batch_src_global generation:  0.000978708267211914
r_  generation:  0.009503602981567383
local_output_nid generation:  0.0015158653259277344
local_in_edges_tensor generation:  0.0008084774017333984
mini_batch_src_global generation:  0.0009462833404541016
r_  generation:  0.008363962173461914
local_output_nid generation:  0.0015130043029785156
local_in_edges_tensor generation:  0.0007984638214111328
mini_batch_src_global generation:  0.0009090900421142578
r_  generation:  0.008252620697021484
local_output_nid generation:  0.0015010833740234375
local_in_edges_tensor generation:  0.0007843971252441406
mini_batch_src_global generation:  0.0009341239929199219
r_  generation:  0.008233785629272461
local_output_nid generation:  0.0014808177947998047
local_in_edges_tensor generation:  0.0007812976837158203
mini_batch_src_global generation:  0.0009515285491943359
r_  generation:  0.008422374725341797
local_output_nid generation:  0.0014846324920654297
local_in_edges_tensor generation:  0.0007536411285400391
mini_batch_src_global generation:  0.0008945465087890625
r_  generation:  0.008374691009521484
local_output_nid generation:  0.0014767646789550781
local_in_edges_tensor generation:  0.0007669925689697266
mini_batch_src_global generation:  0.0009036064147949219
r_  generation:  0.008191585540771484
local_output_nid generation:  0.0014638900756835938
local_in_edges_tensor generation:  0.0007789134979248047
mini_batch_src_global generation:  0.0009639263153076172
r_  generation:  0.007928848266601562
local_output_nid generation:  0.001516103744506836
local_in_edges_tensor generation:  0.0007607936859130859
mini_batch_src_global generation:  0.0009691715240478516
r_  generation:  0.00848698616027832
local_output_nid generation:  0.0014767646789550781
local_in_edges_tensor generation:  0.0007729530334472656
mini_batch_src_global generation:  0.0009300708770751953
r_  generation:  0.008464336395263672
local_output_nid generation:  0.001470804214477539
local_in_edges_tensor generation:  0.0007536411285400391
mini_batch_src_global generation:  0.0009083747863769531
r_  generation:  0.008211374282836914
local_output_nid generation:  0.0014691352844238281
local_in_edges_tensor generation:  0.0007698535919189453
mini_batch_src_global generation:  0.0009059906005859375
r_  generation:  0.008116006851196289
local_output_nid generation:  0.0014462471008300781
local_in_edges_tensor generation:  0.0007536411285400391
mini_batch_src_global generation:  0.0008778572082519531
r_  generation:  0.008206367492675781
local_output_nid generation:  0.0014662742614746094
local_in_edges_tensor generation:  0.0007534027099609375
mini_batch_src_global generation:  0.001012563705444336
r_  generation:  0.008534431457519531
local_output_nid generation:  0.0014705657958984375
local_in_edges_tensor generation:  0.0007374286651611328
mini_batch_src_global generation:  0.0009002685546875
r_  generation:  0.008279800415039062
local_output_nid generation:  0.0014584064483642578
local_in_edges_tensor generation:  0.0007398128509521484
mini_batch_src_global generation:  0.000896453857421875
r_  generation:  0.008252382278442383
local_output_nid generation:  0.0014560222625732422
local_in_edges_tensor generation:  0.0007491111755371094
mini_batch_src_global generation:  0.0008950233459472656
r_  generation:  0.008419990539550781
local_output_nid generation:  0.0014407634735107422
local_in_edges_tensor generation:  0.0007524490356445312
mini_batch_src_global generation:  0.0008878707885742188
r_  generation:  0.008432388305664062
local_output_nid generation:  0.0014388561248779297
local_in_edges_tensor generation:  0.0007448196411132812
mini_batch_src_global generation:  0.0008869171142578125
r_  generation:  0.008294343948364258
local_output_nid generation:  0.001439809799194336
local_in_edges_tensor generation:  0.0007708072662353516
mini_batch_src_global generation:  0.0008857250213623047
r_  generation:  0.007986783981323242
local_output_nid generation:  0.0014464855194091797
local_in_edges_tensor generation:  0.0007328987121582031
mini_batch_src_global generation:  0.0008704662322998047
r_  generation:  0.008323431015014648
local_output_nid generation:  0.001445770263671875
local_in_edges_tensor generation:  0.0007669925689697266
mini_batch_src_global generation:  0.0009393692016601562
r_  generation:  0.009597063064575195
----------------------check_connections_block total spend ----------------------------- 0.480515718460083
generate_one_block  0.016545534133911133
generate_one_block  0.017327547073364258
generate_one_block  0.015103578567504883
generate_one_block  0.014760494232177734
generate_one_block  0.014580249786376953
generate_one_block  0.014628171920776367
generate_one_block  0.014667510986328125
generate_one_block  0.014520645141601562
generate_one_block  0.015362262725830078
generate_one_block  0.014326333999633789
generate_one_block  0.014945507049560547
generate_one_block  0.014712333679199219
generate_one_block  0.0142974853515625
generate_one_block  0.014184236526489258
generate_one_block  0.014461040496826172
generate_one_block  0.014395475387573242
generate_one_block  0.014173746109008789
generate_one_block  0.013844013214111328
generate_one_block  0.014696598052978516
generate_one_block  0.014539003372192383
generate_one_block  0.014225959777832031
generate_one_block  0.014139890670776367
generate_one_block  0.014275789260864258
generate_one_block  0.014557123184204102
generate_one_block  0.014478921890258789
generate_one_block  0.01436161994934082
generate_one_block  0.0144805908203125
generate_one_block  0.014514446258544922
generate_one_block  0.014406442642211914
generate_one_block  0.013959884643554688
generate_one_block  0.014568328857421875
generate_one_block  0.015282392501831055
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03620576858520508
gen group dst list time:  0.020816802978515625
time for parepare:  0.021613359451293945
local_output_nid generation:  0.005451202392578125
local_in_edges_tensor generation:  0.016126632690429688
mini_batch_src_global generation:  0.013061761856079102
r_  generation:  0.1242220401763916
local_output_nid generation:  0.008002758026123047
local_in_edges_tensor generation:  0.009642601013183594
mini_batch_src_global generation:  0.025249004364013672
r_  generation:  0.13666367530822754
local_output_nid generation:  0.012871980667114258
local_in_edges_tensor generation:  0.04244542121887207
mini_batch_src_global generation:  0.01620960235595703
r_  generation:  0.1446681022644043
local_output_nid generation:  0.013477802276611328
local_in_edges_tensor generation:  0.01074838638305664
mini_batch_src_global generation:  0.01596689224243164
r_  generation:  0.143082857131958
local_output_nid generation:  0.013375997543334961
local_in_edges_tensor generation:  0.010859489440917969
mini_batch_src_global generation:  0.018296480178833008
r_  generation:  0.1509997844696045
local_output_nid generation:  0.013213157653808594
local_in_edges_tensor generation:  0.012834548950195312
mini_batch_src_global generation:  0.019453763961791992
r_  generation:  0.14864540100097656
local_output_nid generation:  0.012744665145874023
local_in_edges_tensor generation:  0.010852336883544922
mini_batch_src_global generation:  0.018839359283447266
r_  generation:  0.15228557586669922
local_output_nid generation:  0.01267099380493164
local_in_edges_tensor generation:  0.011015176773071289
mini_batch_src_global generation:  0.018648624420166016
r_  generation:  0.1486361026763916
local_output_nid generation:  0.01312255859375
local_in_edges_tensor generation:  0.013853788375854492
mini_batch_src_global generation:  0.020415306091308594
r_  generation:  0.16164350509643555
local_output_nid generation:  0.014093637466430664
local_in_edges_tensor generation:  0.010118722915649414
mini_batch_src_global generation:  0.03968167304992676
r_  generation:  0.14256668090820312
local_output_nid generation:  0.010194063186645508
local_in_edges_tensor generation:  0.010607242584228516
mini_batch_src_global generation:  0.018785715103149414
r_  generation:  0.1482095718383789
local_output_nid generation:  0.009265661239624023
local_in_edges_tensor generation:  0.008268356323242188
mini_batch_src_global generation:  0.020694255828857422
r_  generation:  0.14489436149597168
local_output_nid generation:  0.008863210678100586
local_in_edges_tensor generation:  0.009696245193481445
mini_batch_src_global generation:  0.01780390739440918
r_  generation:  0.1419813632965088
local_output_nid generation:  0.008782386779785156
local_in_edges_tensor generation:  0.007592916488647461
mini_batch_src_global generation:  0.017669677734375
r_  generation:  0.1430060863494873
local_output_nid generation:  0.008884429931640625
local_in_edges_tensor generation:  0.007795810699462891
mini_batch_src_global generation:  0.017588138580322266
r_  generation:  0.1462411880493164
local_output_nid generation:  0.008682012557983398
local_in_edges_tensor generation:  0.007410526275634766
mini_batch_src_global generation:  0.026865243911743164
r_  generation:  0.1737217903137207
local_output_nid generation:  0.00964045524597168
local_in_edges_tensor generation:  0.011648178100585938
mini_batch_src_global generation:  0.021990060806274414
r_  generation:  0.14791417121887207
local_output_nid generation:  0.01092839241027832
local_in_edges_tensor generation:  0.011378288269042969
mini_batch_src_global generation:  0.017847061157226562
r_  generation:  0.13908839225769043
local_output_nid generation:  0.011798620223999023
local_in_edges_tensor generation:  0.010239124298095703
mini_batch_src_global generation:  0.0265047550201416
r_  generation:  0.16837167739868164
local_output_nid generation:  0.012936830520629883
local_in_edges_tensor generation:  0.015399694442749023
mini_batch_src_global generation:  0.01950836181640625
r_  generation:  0.15277457237243652
local_output_nid generation:  0.010277748107910156
local_in_edges_tensor generation:  0.010020971298217773
mini_batch_src_global generation:  0.017873764038085938
r_  generation:  0.1455838680267334
local_output_nid generation:  0.009211063385009766
local_in_edges_tensor generation:  0.00889277458190918
mini_batch_src_global generation:  0.020156145095825195
r_  generation:  0.1448836326599121
local_output_nid generation:  0.008945226669311523
local_in_edges_tensor generation:  0.011775732040405273
mini_batch_src_global generation:  0.01970386505126953
r_  generation:  0.15764808654785156
local_output_nid generation:  0.008925914764404297
local_in_edges_tensor generation:  0.007896184921264648
mini_batch_src_global generation:  0.018567323684692383
r_  generation:  0.14635252952575684
local_output_nid generation:  0.008862495422363281
local_in_edges_tensor generation:  0.008060932159423828
mini_batch_src_global generation:  0.017836809158325195
r_  generation:  0.16570830345153809
local_output_nid generation:  0.00852060317993164
local_in_edges_tensor generation:  0.008398056030273438
mini_batch_src_global generation:  0.01802968978881836
r_  generation:  0.14504766464233398
local_output_nid generation:  0.008863210678100586
local_in_edges_tensor generation:  0.009739160537719727
mini_batch_src_global generation:  0.01795196533203125
r_  generation:  0.1479647159576416
local_output_nid generation:  0.008774280548095703
local_in_edges_tensor generation:  0.008605003356933594
mini_batch_src_global generation:  0.018307924270629883
r_  generation:  0.14347314834594727
local_output_nid generation:  0.00866246223449707
local_in_edges_tensor generation:  0.007986783981323242
mini_batch_src_global generation:  0.018042325973510742
r_  generation:  0.14650845527648926
local_output_nid generation:  0.008464574813842773
local_in_edges_tensor generation:  0.007910013198852539
mini_batch_src_global generation:  0.017398357391357422
r_  generation:  0.13810992240905762
local_output_nid generation:  0.008805513381958008
local_in_edges_tensor generation:  0.007565498352050781
mini_batch_src_global generation:  0.01831793785095215
r_  generation:  0.14988017082214355
local_output_nid generation:  0.009098052978515625
local_in_edges_tensor generation:  0.010133981704711914
mini_batch_src_global generation:  0.019942045211791992
r_  generation:  0.17509984970092773
----------------------check_connections_block total spend ----------------------------- 7.265135765075684
generate_one_block  0.19008898735046387
generate_one_block  0.17453885078430176
generate_one_block  0.17368865013122559
generate_one_block  0.17524933815002441
generate_one_block  0.20600366592407227
generate_one_block  0.17880940437316895
generate_one_block  0.1755232810974121
generate_one_block  0.17676162719726562
generate_one_block  0.18570160865783691
generate_one_block  0.17407798767089844
generate_one_block  0.1824936866760254
generate_one_block  0.17801213264465332
generate_one_block  0.17140603065490723
generate_one_block  0.17603278160095215
generate_one_block  0.17677545547485352
generate_one_block  0.17618989944458008
generate_one_block  0.17351245880126953
generate_one_block  0.1642301082611084
generate_one_block  0.17683744430541992
generate_one_block  0.18157553672790527
generate_one_block  0.1717219352722168
generate_one_block  0.1718130111694336
generate_one_block  0.1700890064239502
generate_one_block  0.17628026008605957
generate_one_block  0.178178071975708
generate_one_block  0.18614411354064941
generate_one_block  0.18446063995361328
generate_one_block  0.17742705345153809
generate_one_block  0.17989802360534668
generate_one_block  0.1701817512512207
generate_one_block  0.18472743034362793
generate_one_block  0.18719196319580078
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03374171257019043
gen group dst list time:  0.09771156311035156
time for parepare:  0.01868915557861328
local_output_nid generation:  0.022727012634277344
local_in_edges_tensor generation:  0.044985294342041016
mini_batch_src_global generation:  0.03619050979614258
r_  generation:  0.38999009132385254
local_output_nid generation:  0.02804279327392578
local_in_edges_tensor generation:  0.03145194053649902
mini_batch_src_global generation:  0.04785299301147461
r_  generation:  0.3893716335296631
local_output_nid generation:  0.029108524322509766
local_in_edges_tensor generation:  0.02820420265197754
mini_batch_src_global generation:  0.04684805870056152
r_  generation:  0.39949679374694824
local_output_nid generation:  0.028157711029052734
local_in_edges_tensor generation:  0.029888629913330078
mini_batch_src_global generation:  0.04937314987182617
r_  generation:  0.4094209671020508
local_output_nid generation:  0.03101968765258789
local_in_edges_tensor generation:  0.02693033218383789
mini_batch_src_global generation:  0.047080278396606445
r_  generation:  0.40057945251464844
local_output_nid generation:  0.028226137161254883
local_in_edges_tensor generation:  0.029844284057617188
mini_batch_src_global generation:  0.04771709442138672
r_  generation:  0.39731693267822266
local_output_nid generation:  0.02748584747314453
local_in_edges_tensor generation:  0.025894880294799805
mini_batch_src_global generation:  0.046410322189331055
r_  generation:  0.40012216567993164
local_output_nid generation:  0.02734541893005371
local_in_edges_tensor generation:  0.027677059173583984
mini_batch_src_global generation:  0.04761362075805664
r_  generation:  0.39391016960144043
local_output_nid generation:  0.027309417724609375
local_in_edges_tensor generation:  0.02807307243347168
mini_batch_src_global generation:  0.04644370079040527
r_  generation:  0.40560460090637207
local_output_nid generation:  0.02675938606262207
local_in_edges_tensor generation:  0.03629255294799805
mini_batch_src_global generation:  0.04750871658325195
r_  generation:  0.3949894905090332
local_output_nid generation:  0.02757716178894043
local_in_edges_tensor generation:  0.024916410446166992
mini_batch_src_global generation:  0.04583382606506348
r_  generation:  0.4027831554412842
local_output_nid generation:  0.027311086654663086
local_in_edges_tensor generation:  0.02952265739440918
mini_batch_src_global generation:  0.04843306541442871
r_  generation:  0.3933753967285156
local_output_nid generation:  0.027050018310546875
local_in_edges_tensor generation:  0.0251619815826416
mini_batch_src_global generation:  0.04608559608459473
r_  generation:  0.3955230712890625
local_output_nid generation:  0.026935815811157227
local_in_edges_tensor generation:  0.023719310760498047
mini_batch_src_global generation:  0.04751086235046387
r_  generation:  0.3924126625061035
local_output_nid generation:  0.027376890182495117
local_in_edges_tensor generation:  0.026117563247680664
mini_batch_src_global generation:  0.046106576919555664
r_  generation:  0.40354251861572266
local_output_nid generation:  0.026877880096435547
local_in_edges_tensor generation:  0.028076171875
mini_batch_src_global generation:  0.0472569465637207
r_  generation:  0.39389681816101074
local_output_nid generation:  0.027468204498291016
local_in_edges_tensor generation:  0.027350187301635742
mini_batch_src_global generation:  0.04579472541809082
r_  generation:  0.4006924629211426
local_output_nid generation:  0.026467084884643555
local_in_edges_tensor generation:  0.02588057518005371
mini_batch_src_global generation:  0.04639911651611328
r_  generation:  0.3887941837310791
local_output_nid generation:  0.02754664421081543
local_in_edges_tensor generation:  0.03070545196533203
mini_batch_src_global generation:  0.045780181884765625
r_  generation:  0.4054872989654541
local_output_nid generation:  0.026818037033081055
local_in_edges_tensor generation:  0.02915501594543457
mini_batch_src_global generation:  0.04717206954956055
r_  generation:  0.39858579635620117
local_output_nid generation:  0.027849674224853516
local_in_edges_tensor generation:  0.026355981826782227
mini_batch_src_global generation:  0.04731941223144531
r_  generation:  0.40015554428100586
local_output_nid generation:  0.027210712432861328
local_in_edges_tensor generation:  0.02762627601623535
mini_batch_src_global generation:  0.04718947410583496
r_  generation:  0.39281749725341797
local_output_nid generation:  0.02694249153137207
local_in_edges_tensor generation:  0.024552106857299805
mini_batch_src_global generation:  0.04634690284729004
r_  generation:  0.398510217666626
local_output_nid generation:  0.02710247039794922
local_in_edges_tensor generation:  0.029262542724609375
mini_batch_src_global generation:  0.049675941467285156
r_  generation:  0.3950517177581787
local_output_nid generation:  0.027414560317993164
local_in_edges_tensor generation:  0.02512383460998535
mini_batch_src_global generation:  0.047373056411743164
r_  generation:  0.42110228538513184
local_output_nid generation:  0.02927088737487793
local_in_edges_tensor generation:  0.024770021438598633
mini_batch_src_global generation:  0.048358917236328125
r_  generation:  0.3921234607696533
local_output_nid generation:  0.02685093879699707
local_in_edges_tensor generation:  0.024904251098632812
mini_batch_src_global generation:  0.04658102989196777
r_  generation:  0.40180110931396484
local_output_nid generation:  0.026866912841796875
local_in_edges_tensor generation:  0.024389028549194336
mini_batch_src_global generation:  0.04749917984008789
r_  generation:  0.3914525508880615
local_output_nid generation:  0.027065515518188477
local_in_edges_tensor generation:  0.02672886848449707
mini_batch_src_global generation:  0.04684901237487793
r_  generation:  0.4030470848083496
local_output_nid generation:  0.027085304260253906
local_in_edges_tensor generation:  0.026344776153564453
mini_batch_src_global generation:  0.04890727996826172
r_  generation:  0.3919854164123535
local_output_nid generation:  0.027455568313598633
local_in_edges_tensor generation:  0.027219295501708984
mini_batch_src_global generation:  0.047332048416137695
r_  generation:  0.42092132568359375
local_output_nid generation:  0.027554750442504883
local_in_edges_tensor generation:  0.027653932571411133
mini_batch_src_global generation:  0.04825711250305176
r_  generation:  0.40752410888671875
----------------------check_connections_block total spend ----------------------------- 18.883418560028076
generate_one_block  0.5368807315826416
generate_one_block  0.5275058746337891
generate_one_block  0.5269043445587158
generate_one_block  0.5229032039642334
generate_one_block  0.6328160762786865
generate_one_block  0.5347433090209961
generate_one_block  0.5282254219055176
generate_one_block  0.5339756011962891
generate_one_block  0.5347952842712402
generate_one_block  0.5179569721221924
generate_one_block  0.5325198173522949
generate_one_block  0.5313737392425537
generate_one_block  0.522498607635498
generate_one_block  0.5260140895843506
generate_one_block  0.5344529151916504
generate_one_block  0.5194728374481201
generate_one_block  0.5286655426025391
generate_one_block  0.5193052291870117
generate_one_block  0.5359704494476318
generate_one_block  0.5304546356201172
generate_one_block  0.538140058517456
generate_one_block  0.521317720413208
generate_one_block  0.5285427570343018
generate_one_block  0.5441887378692627
generate_one_block  0.5512025356292725
generate_one_block  0.5230615139007568
generate_one_block  0.5221912860870361
generate_one_block  0.5192058086395264
generate_one_block  0.5320165157318115
generate_one_block  0.5202898979187012
generate_one_block  0.5442101955413818
generate_one_block  0.5572049617767334
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.11951732635498047  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

connection checking time:  26.14855432510376
block generation total time  22.784628868103027
average batch blocks generation time:  0.7120196521282196
block dataloader generation time/epoch 51.596911350886025
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10500478744506836  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.773565769195557  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10305070877075195  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.621028423309326  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10400390625  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.733906745910645  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10304069519042969  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.595503330230713  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10283470153808594  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.72478437423706  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10423040390014648  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.907910823822021  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10399723052978516  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.705394268035889  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10319709777832031  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.766723155975342  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10509395599365234  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.203766345977783  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10252094268798828  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.60256052017212  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10505342483520508  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.935145378112793  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10397005081176758  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.861659049987793  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10275745391845703  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.44858455657959  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10282707214355469  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.558505058288574  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10500621795654297  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.813065528869629  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10275650024414062  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.618100643157959  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1039276123046875  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.631861686706543  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10242652893066406  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.162272930145264  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10502338409423828  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.884595394134521  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10265111923217773  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.7469162940979  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10391998291015625  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.594306468963623  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10280799865722656  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.550025463104248  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10382461547851562  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.440723896026611  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10409784317016602  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.853901863098145  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1039876937866211  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.659283638000488  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10289764404296875  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.637201309204102  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10396194458007812  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.845439910888672  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10264730453491211  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.54477834701538  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1039118766784668  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.787485122680664  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10273408889770508  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.3401517868042  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10503911972045898  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.994612216949463  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10441160202026367  GigaBytes
Max Memory Allocated: 16.26074457168579  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.23909854888916  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03592866659164429 |0.010630935430526733 |0.26975710690021515 |9.312480688095093e-05 |0.4257310703396797 |0.006162881851196289 |
----------------------------------------------------------pseudo_mini_loss sum 1.3828567266464233
Total (block generation + training)time/epoch 75.40159956614177
Training time/epoch 23.80400037765503
Training time without block to device /epoch 23.463810443878174
Training time without total dataloading part /epoch 22.264764547348022
load block tensor time/epoch 1.1497173309326172
block to device time/epoch 0.34018993377685547
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 18 |
Number of nodes for computation during this epoch:  8579049
Number of first layer input nodes during this epoch:  4655144
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.12274789810180664  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0267484188079834
random selection method range initialization spend 0.005874156951904297
time for parepare:  0.02820563316345215
local_output_nid generation:  0.001825094223022461
local_in_edges_tensor generation:  0.005530834197998047
mini_batch_src_global generation:  0.0020127296447753906
r_  generation:  0.009049177169799805
local_output_nid generation:  0.001875162124633789
local_in_edges_tensor generation:  0.0012819766998291016
mini_batch_src_global generation:  0.0017199516296386719
r_  generation:  0.008954524993896484
local_output_nid generation:  0.001928091049194336
local_in_edges_tensor generation:  0.0010943412780761719
mini_batch_src_global generation:  0.0012369155883789062
r_  generation:  0.008293628692626953
local_output_nid generation:  0.001998424530029297
local_in_edges_tensor generation:  0.0011992454528808594
mini_batch_src_global generation:  0.0011527538299560547
r_  generation:  0.007975339889526367
local_output_nid generation:  0.0020051002502441406
local_in_edges_tensor generation:  0.0012538433074951172
mini_batch_src_global generation:  0.0010273456573486328
r_  generation:  0.008245229721069336
local_output_nid generation:  0.0020172595977783203
local_in_edges_tensor generation:  0.001055002212524414
mini_batch_src_global generation:  0.0011560916900634766
r_  generation:  0.01192474365234375
local_output_nid generation:  0.0020618438720703125
local_in_edges_tensor generation:  0.0010900497436523438
mini_batch_src_global generation:  0.0011134147644042969
r_  generation:  0.02054286003112793
local_output_nid generation:  0.0030448436737060547
local_in_edges_tensor generation:  0.0014541149139404297
mini_batch_src_global generation:  0.001569509506225586
r_  generation:  0.009004592895507812
local_output_nid generation:  0.0021905899047851562
local_in_edges_tensor generation:  0.0010154247283935547
mini_batch_src_global generation:  0.0010843276977539062
r_  generation:  0.008247852325439453
local_output_nid generation:  0.002022266387939453
local_in_edges_tensor generation:  0.0010678768157958984
mini_batch_src_global generation:  0.0010743141174316406
r_  generation:  0.009822845458984375
local_output_nid generation:  0.001993894577026367
local_in_edges_tensor generation:  0.0009534358978271484
mini_batch_src_global generation:  0.0010151863098144531
r_  generation:  0.008365631103515625
local_output_nid generation:  0.001893758773803711
local_in_edges_tensor generation:  0.0009326934814453125
mini_batch_src_global generation:  0.0009577274322509766
r_  generation:  0.010249137878417969
local_output_nid generation:  0.0018591880798339844
local_in_edges_tensor generation:  0.0008885860443115234
mini_batch_src_global generation:  0.0009548664093017578
r_  generation:  0.008456707000732422
local_output_nid generation:  0.0017971992492675781
local_in_edges_tensor generation:  0.0008647441864013672
mini_batch_src_global generation:  0.000911712646484375
r_  generation:  0.008281469345092773
local_output_nid generation:  0.001775979995727539
local_in_edges_tensor generation:  0.0008318424224853516
mini_batch_src_global generation:  0.0009014606475830078
r_  generation:  0.008209466934204102
local_output_nid generation:  0.001725912094116211
local_in_edges_tensor generation:  0.0008206367492675781
mini_batch_src_global generation:  0.0009295940399169922
r_  generation:  0.008406877517700195
local_output_nid generation:  0.0016930103302001953
local_in_edges_tensor generation:  0.0008220672607421875
mini_batch_src_global generation:  0.0009071826934814453
r_  generation:  0.008358478546142578
local_output_nid generation:  0.0016832351684570312
local_in_edges_tensor generation:  0.0008196830749511719
mini_batch_src_global generation:  0.0009059906005859375
r_  generation:  0.008268594741821289
local_output_nid generation:  0.0016620159149169922
local_in_edges_tensor generation:  0.0008890628814697266
mini_batch_src_global generation:  0.0008893013000488281
r_  generation:  0.01008915901184082
local_output_nid generation:  0.0016460418701171875
local_in_edges_tensor generation:  0.0008070468902587891
mini_batch_src_global generation:  0.0009241104125976562
r_  generation:  0.008423328399658203
local_output_nid generation:  0.001636505126953125
local_in_edges_tensor generation:  0.0008344650268554688
mini_batch_src_global generation:  0.000986337661743164
r_  generation:  0.008620500564575195
local_output_nid generation:  0.0016164779663085938
local_in_edges_tensor generation:  0.0008037090301513672
mini_batch_src_global generation:  0.0008909702301025391
r_  generation:  0.008298635482788086
local_output_nid generation:  0.0016095638275146484
local_in_edges_tensor generation:  0.0008020401000976562
mini_batch_src_global generation:  0.0008912086486816406
r_  generation:  0.008324861526489258
local_output_nid generation:  0.001560211181640625
local_in_edges_tensor generation:  0.0008881092071533203
mini_batch_src_global generation:  0.0009987354278564453
r_  generation:  0.007889986038208008
local_output_nid generation:  0.0015902519226074219
local_in_edges_tensor generation:  0.0007898807525634766
mini_batch_src_global generation:  0.0008842945098876953
r_  generation:  0.00836038589477539
local_output_nid generation:  0.0015511512756347656
local_in_edges_tensor generation:  0.0008370876312255859
mini_batch_src_global generation:  0.0009052753448486328
r_  generation:  0.008408784866333008
local_output_nid generation:  0.001554727554321289
local_in_edges_tensor generation:  0.000797271728515625
mini_batch_src_global generation:  0.0008759498596191406
r_  generation:  0.008243083953857422
local_output_nid generation:  0.0015366077423095703
local_in_edges_tensor generation:  0.0007967948913574219
mini_batch_src_global generation:  0.0009405612945556641
r_  generation:  0.008388757705688477
local_output_nid generation:  0.0015311241149902344
local_in_edges_tensor generation:  0.0008766651153564453
mini_batch_src_global generation:  0.0009191036224365234
r_  generation:  0.008475542068481445
local_output_nid generation:  0.0015261173248291016
local_in_edges_tensor generation:  0.0009477138519287109
mini_batch_src_global generation:  0.0008747577667236328
r_  generation:  0.008199930191040039
local_output_nid generation:  0.0015232563018798828
local_in_edges_tensor generation:  0.0008099079132080078
mini_batch_src_global generation:  0.0009019374847412109
r_  generation:  0.008422136306762695
local_output_nid generation:  0.0015015602111816406
local_in_edges_tensor generation:  0.0008089542388916016
mini_batch_src_global generation:  0.0009005069732666016
r_  generation:  0.008599281311035156
----------------------check_connections_block total spend ----------------------------- 0.5329952239990234
generate_one_block  0.017240047454833984
generate_one_block  0.022827863693237305
generate_one_block  0.015468835830688477
generate_one_block  0.014633655548095703
generate_one_block  0.014609336853027344
generate_one_block  0.014741182327270508
generate_one_block  0.014359474182128906
generate_one_block  0.016248226165771484
generate_one_block  0.014670372009277344
generate_one_block  0.015450239181518555
generate_one_block  0.014482975006103516
generate_one_block  0.014623403549194336
generate_one_block  0.014607429504394531
generate_one_block  0.014635562896728516
generate_one_block  0.015577554702758789
generate_one_block  0.014666557312011719
generate_one_block  0.014755010604858398
generate_one_block  0.014319658279418945
generate_one_block  0.01408696174621582
generate_one_block  0.014999866485595703
generate_one_block  0.014895915985107422
generate_one_block  0.014360904693603516
generate_one_block  0.014553308486938477
generate_one_block  0.013870000839233398
generate_one_block  0.014596223831176758
generate_one_block  0.014757633209228516
generate_one_block  0.014207601547241211
generate_one_block  0.014610767364501953
generate_one_block  0.01471710205078125
generate_one_block  0.014270782470703125
generate_one_block  0.01465749740600586
generate_one_block  0.014743328094482422
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.036360740661621094
gen group dst list time:  0.025050878524780273
time for parepare:  0.021856307983398438
local_output_nid generation:  0.0055751800537109375
local_in_edges_tensor generation:  0.01972198486328125
mini_batch_src_global generation:  0.014786243438720703
r_  generation:  0.12584638595581055
local_output_nid generation:  0.007768392562866211
local_in_edges_tensor generation:  0.009676933288574219
mini_batch_src_global generation:  0.015528202056884766
r_  generation:  0.1551671028137207
local_output_nid generation:  0.012991666793823242
local_in_edges_tensor generation:  0.039342403411865234
mini_batch_src_global generation:  0.01613903045654297
r_  generation:  0.13170361518859863
local_output_nid generation:  0.010145425796508789
local_in_edges_tensor generation:  0.00952911376953125
mini_batch_src_global generation:  0.015450000762939453
r_  generation:  0.1287860870361328
local_output_nid generation:  0.008743762969970703
local_in_edges_tensor generation:  0.008196830749511719
mini_batch_src_global generation:  0.015297412872314453
r_  generation:  0.1303393840789795
local_output_nid generation:  0.008628606796264648
local_in_edges_tensor generation:  0.007562398910522461
mini_batch_src_global generation:  0.016590356826782227
r_  generation:  0.1343832015991211
local_output_nid generation:  0.007984638214111328
local_in_edges_tensor generation:  0.007319211959838867
mini_batch_src_global generation:  0.015631914138793945
r_  generation:  0.12901687622070312
local_output_nid generation:  0.007896661758422852
local_in_edges_tensor generation:  0.007449626922607422
mini_batch_src_global generation:  0.01628255844116211
r_  generation:  0.1354527473449707
local_output_nid generation:  0.0078029632568359375
local_in_edges_tensor generation:  0.007481575012207031
mini_batch_src_global generation:  0.016458511352539062
r_  generation:  0.13724756240844727
local_output_nid generation:  0.008002996444702148
local_in_edges_tensor generation:  0.009549617767333984
mini_batch_src_global generation:  0.017714738845825195
r_  generation:  0.14305400848388672
local_output_nid generation:  0.00816965103149414
local_in_edges_tensor generation:  0.007480144500732422
mini_batch_src_global generation:  0.01658153533935547
r_  generation:  0.13854217529296875
local_output_nid generation:  0.008059978485107422
local_in_edges_tensor generation:  0.007479429244995117
mini_batch_src_global generation:  0.016279220581054688
r_  generation:  0.13838434219360352
local_output_nid generation:  0.0081787109375
local_in_edges_tensor generation:  0.007565498352050781
mini_batch_src_global generation:  0.016654014587402344
r_  generation:  0.1399097442626953
local_output_nid generation:  0.008054971694946289
local_in_edges_tensor generation:  0.008936643600463867
mini_batch_src_global generation:  0.0163266658782959
r_  generation:  0.14064383506774902
local_output_nid generation:  0.008081197738647461
local_in_edges_tensor generation:  0.0075130462646484375
mini_batch_src_global generation:  0.027553319931030273
r_  generation:  0.17878055572509766
local_output_nid generation:  0.008866548538208008
local_in_edges_tensor generation:  0.008209466934204102
mini_batch_src_global generation:  0.017975807189941406
r_  generation:  0.14144277572631836
local_output_nid generation:  0.008409976959228516
local_in_edges_tensor generation:  0.011294364929199219
mini_batch_src_global generation:  0.016474485397338867
r_  generation:  0.1404097080230713
local_output_nid generation:  0.00804448127746582
local_in_edges_tensor generation:  0.007959604263305664
mini_batch_src_global generation:  0.02843475341796875
r_  generation:  0.15682315826416016
local_output_nid generation:  0.009557723999023438
local_in_edges_tensor generation:  0.008716821670532227
mini_batch_src_global generation:  0.017891407012939453
r_  generation:  0.17505145072937012
local_output_nid generation:  0.010618448257446289
local_in_edges_tensor generation:  0.00973200798034668
mini_batch_src_global generation:  0.017497777938842773
r_  generation:  0.17609190940856934
local_output_nid generation:  0.014526128768920898
local_in_edges_tensor generation:  0.012229442596435547
mini_batch_src_global generation:  0.020951509475708008
r_  generation:  0.1817789077758789
local_output_nid generation:  0.01068735122680664
local_in_edges_tensor generation:  0.01206517219543457
mini_batch_src_global generation:  0.02691197395324707
r_  generation:  0.14047718048095703
local_output_nid generation:  0.009952068328857422
local_in_edges_tensor generation:  0.010808467864990234
mini_batch_src_global generation:  0.020964622497558594
r_  generation:  0.1385798454284668
local_output_nid generation:  0.010483503341674805
local_in_edges_tensor generation:  0.008260965347290039
mini_batch_src_global generation:  0.015689373016357422
r_  generation:  0.13172078132629395
local_output_nid generation:  0.00972294807434082
local_in_edges_tensor generation:  0.007749795913696289
mini_batch_src_global generation:  0.017436981201171875
r_  generation:  0.1383955478668213
local_output_nid generation:  0.009808063507080078
local_in_edges_tensor generation:  0.009145021438598633
mini_batch_src_global generation:  0.016336679458618164
r_  generation:  0.13804960250854492
local_output_nid generation:  0.009589672088623047
local_in_edges_tensor generation:  0.007956743240356445
mini_batch_src_global generation:  0.01617884635925293
r_  generation:  0.13670659065246582
local_output_nid generation:  0.009585142135620117
local_in_edges_tensor generation:  0.008187294006347656
mini_batch_src_global generation:  0.01665353775024414
r_  generation:  0.14037799835205078
local_output_nid generation:  0.009629964828491211
local_in_edges_tensor generation:  0.007987260818481445
mini_batch_src_global generation:  0.016398906707763672
r_  generation:  0.1376490592956543
local_output_nid generation:  0.009498834609985352
local_in_edges_tensor generation:  0.00792074203491211
mini_batch_src_global generation:  0.016664505004882812
r_  generation:  0.1388247013092041
local_output_nid generation:  0.009767293930053711
local_in_edges_tensor generation:  0.0077972412109375
mini_batch_src_global generation:  0.016754150390625
r_  generation:  0.17920613288879395
local_output_nid generation:  0.009663105010986328
local_in_edges_tensor generation:  0.007580757141113281
mini_batch_src_global generation:  0.01932692527770996
r_  generation:  0.17763638496398926
----------------------check_connections_block total spend ----------------------------- 6.929822683334351
generate_one_block  0.19425463676452637
generate_one_block  0.17685794830322266
generate_one_block  0.1798849105834961
generate_one_block  0.1727313995361328
generate_one_block  0.2038898468017578
generate_one_block  0.17699027061462402
generate_one_block  0.16932082176208496
generate_one_block  0.17833614349365234
generate_one_block  0.17549562454223633
generate_one_block  0.18546485900878906
generate_one_block  0.17628121376037598
generate_one_block  0.17802858352661133
generate_one_block  0.19648957252502441
generate_one_block  0.187408447265625
generate_one_block  0.1824333667755127
generate_one_block  0.18576312065124512
generate_one_block  0.18213319778442383
generate_one_block  0.1770772933959961
generate_one_block  0.18054461479187012
generate_one_block  0.3115270137786865
generate_one_block  0.182633638381958
generate_one_block  0.18174982070922852
generate_one_block  0.17924189567565918
generate_one_block  0.1680011749267578
generate_one_block  0.17837190628051758
generate_one_block  0.18022918701171875
generate_one_block  0.17463302612304688
generate_one_block  0.1792314052581787
generate_one_block  0.18185973167419434
generate_one_block  0.17786955833435059
generate_one_block  0.18253803253173828
generate_one_block  0.1781597137451172
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03519320487976074
gen group dst list time:  0.1039888858795166
time for parepare:  0.020166873931884766
local_output_nid generation:  0.023684024810791016
local_in_edges_tensor generation:  0.04744577407836914
mini_batch_src_global generation:  0.037244319915771484
r_  generation:  0.3983626365661621
local_output_nid generation:  0.028691530227661133
local_in_edges_tensor generation:  0.0326077938079834
mini_batch_src_global generation:  0.058585405349731445
r_  generation:  0.4011077880859375
local_output_nid generation:  0.028795480728149414
local_in_edges_tensor generation:  0.02733635902404785
mini_batch_src_global generation:  0.04726862907409668
r_  generation:  0.40822529792785645
local_output_nid generation:  0.028844594955444336
local_in_edges_tensor generation:  0.030225753784179688
mini_batch_src_global generation:  0.04749464988708496
r_  generation:  0.3982667922973633
local_output_nid generation:  0.029649019241333008
local_in_edges_tensor generation:  0.028890371322631836
mini_batch_src_global generation:  0.0460050106048584
r_  generation:  0.40790820121765137
local_output_nid generation:  0.02832937240600586
local_in_edges_tensor generation:  0.029022932052612305
mini_batch_src_global generation:  0.0482945442199707
r_  generation:  0.4053614139556885
local_output_nid generation:  0.026779651641845703
local_in_edges_tensor generation:  0.030383586883544922
mini_batch_src_global generation:  0.04648756980895996
r_  generation:  0.4033539295196533
local_output_nid generation:  0.026954174041748047
local_in_edges_tensor generation:  0.0355229377746582
mini_batch_src_global generation:  0.0558013916015625
r_  generation:  0.40349769592285156
local_output_nid generation:  0.02861928939819336
local_in_edges_tensor generation:  0.026716232299804688
mini_batch_src_global generation:  0.046602487564086914
r_  generation:  0.404735803604126
local_output_nid generation:  0.027818679809570312
local_in_edges_tensor generation:  0.026684284210205078
mini_batch_src_global generation:  0.04829907417297363
r_  generation:  0.4060688018798828
local_output_nid generation:  0.027630090713500977
local_in_edges_tensor generation:  0.026329994201660156
mini_batch_src_global generation:  0.04671645164489746
r_  generation:  0.4023168087005615
local_output_nid generation:  0.027873516082763672
local_in_edges_tensor generation:  0.027400732040405273
mini_batch_src_global generation:  0.04771280288696289
r_  generation:  0.40254783630371094
local_output_nid generation:  0.028225183486938477
local_in_edges_tensor generation:  0.027141809463500977
mini_batch_src_global generation:  0.049146175384521484
r_  generation:  0.4188411235809326
local_output_nid generation:  0.02761054039001465
local_in_edges_tensor generation:  0.027840852737426758
mini_batch_src_global generation:  0.05190086364746094
r_  generation:  0.4033701419830322
local_output_nid generation:  0.02769017219543457
local_in_edges_tensor generation:  0.02532339096069336
mini_batch_src_global generation:  0.04650235176086426
r_  generation:  0.40879082679748535
local_output_nid generation:  0.027872323989868164
local_in_edges_tensor generation:  0.028419017791748047
mini_batch_src_global generation:  0.05029463768005371
r_  generation:  0.4082818031311035
local_output_nid generation:  0.027890443801879883
local_in_edges_tensor generation:  0.0292050838470459
mini_batch_src_global generation:  0.046907663345336914
r_  generation:  0.40810322761535645
local_output_nid generation:  0.02779698371887207
local_in_edges_tensor generation:  0.02655935287475586
mini_batch_src_global generation:  0.047319650650024414
r_  generation:  0.4030582904815674
local_output_nid generation:  0.028586626052856445
local_in_edges_tensor generation:  0.02790236473083496
mini_batch_src_global generation:  0.04606032371520996
r_  generation:  0.406935453414917
local_output_nid generation:  0.028055667877197266
local_in_edges_tensor generation:  0.028781652450561523
mini_batch_src_global generation:  0.04796457290649414
r_  generation:  0.40906429290771484
local_output_nid generation:  0.027904987335205078
local_in_edges_tensor generation:  0.029851198196411133
mini_batch_src_global generation:  0.04751873016357422
r_  generation:  0.4121062755584717
local_output_nid generation:  0.027518749237060547
local_in_edges_tensor generation:  0.026682376861572266
mini_batch_src_global generation:  0.048395395278930664
r_  generation:  0.405017614364624
local_output_nid generation:  0.027703046798706055
local_in_edges_tensor generation:  0.028877735137939453
mini_batch_src_global generation:  0.048018693923950195
r_  generation:  0.40717315673828125
local_output_nid generation:  0.027381181716918945
local_in_edges_tensor generation:  0.024286270141601562
mini_batch_src_global generation:  0.04802656173706055
r_  generation:  0.3988454341888428
local_output_nid generation:  0.033121585845947266
local_in_edges_tensor generation:  0.026583194732666016
mini_batch_src_global generation:  0.056664466857910156
r_  generation:  0.4094235897064209
local_output_nid generation:  0.027754545211791992
local_in_edges_tensor generation:  0.028574228286743164
mini_batch_src_global generation:  0.04810047149658203
r_  generation:  0.4036128520965576
local_output_nid generation:  0.027562379837036133
local_in_edges_tensor generation:  0.026744365692138672
mini_batch_src_global generation:  0.04861187934875488
r_  generation:  0.40622830390930176
local_output_nid generation:  0.027676820755004883
local_in_edges_tensor generation:  0.024776697158813477
mini_batch_src_global generation:  0.047890424728393555
r_  generation:  0.4039013385772705
local_output_nid generation:  0.02750873565673828
local_in_edges_tensor generation:  0.024498939514160156
mini_batch_src_global generation:  0.046586036682128906
r_  generation:  0.40427637100219727
local_output_nid generation:  0.027712345123291016
local_in_edges_tensor generation:  0.02699756622314453
mini_batch_src_global generation:  0.04761171340942383
r_  generation:  0.4034123420715332
local_output_nid generation:  0.02789020538330078
local_in_edges_tensor generation:  0.03854084014892578
mini_batch_src_global generation:  0.04723978042602539
r_  generation:  0.41184353828430176
local_output_nid generation:  0.027951717376708984
local_in_edges_tensor generation:  0.026749134063720703
mini_batch_src_global generation:  0.04808402061462402
r_  generation:  0.4092869758605957
----------------------check_connections_block total spend ----------------------------- 19.223082780838013
generate_one_block  0.6440422534942627
generate_one_block  0.5331974029541016
generate_one_block  0.5348484516143799
generate_one_block  0.5238759517669678
generate_one_block  0.5255613327026367
generate_one_block  0.5434563159942627
generate_one_block  0.525749921798706
generate_one_block  0.5278878211975098
generate_one_block  0.5368995666503906
generate_one_block  0.5434284210205078
generate_one_block  0.5429620742797852
generate_one_block  0.5360474586486816
generate_one_block  0.5384914875030518
generate_one_block  0.5324807167053223
generate_one_block  0.5284848213195801
generate_one_block  0.5447690486907959
generate_one_block  0.5318713188171387
generate_one_block  0.5317857265472412
generate_one_block  0.5280182361602783
generate_one_block  0.543391227722168
generate_one_block  0.5385110378265381
generate_one_block  0.5377039909362793
generate_one_block  0.539902925491333
generate_one_block  0.5256378650665283
generate_one_block  0.5383861064910889
generate_one_block  0.534592866897583
generate_one_block  0.5336229801177979
generate_one_block  0.5335245132446289
generate_one_block  0.5268106460571289
generate_one_block  0.5364205837249756
generate_one_block  0.5482206344604492
generate_one_block  0.552269458770752
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.12274789810180664  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

connection checking time:  26.152905464172363
block generation total time  23.15828514099121
average batch blocks generation time:  0.7236964106559753
block dataloader generation time/epoch 51.625018095970155
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10505437850952148  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.031229972839355  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10307502746582031  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.747745037078857  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10402727127075195  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.80297040939331  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10263490676879883  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.46411657333374  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10384941101074219  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.488577842712402  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10427236557006836  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.82386589050293  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10264825820922852  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.231780529022217  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1027679443359375  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.778141021728516  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10291099548339844  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.650724411010742  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10422277450561523  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.13290548324585  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10272598266601562  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.662521839141846  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10314750671386719  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.570508480072021  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10400867462158203  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.733676433563232  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10277128219604492  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.701682567596436  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10393047332763672  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.6105055809021  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1040334701538086  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.807644367218018  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10401153564453125  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.795554161071777  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1029367446899414  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.461283206939697  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10382080078125  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.433042526245117  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1042933464050293  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.950847148895264  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1050252914428711  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.91098165512085  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10277128219604492  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.635016918182373  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10392093658447266  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.599081039428711  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1026158332824707  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.221496105194092  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10289192199707031  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.770193576812744  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10304498672485352  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.72262716293335  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10394573211669922  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.625457763671875  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10294580459594727  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.814791679382324  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10284423828125  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.629133224487305  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10308504104614258  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.75009536743164  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10503387451171875  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.978513717651367  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10429906845092773  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.803801536560059  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0379975363612175 |0.010426782071590424 |0.2649569883942604 |9.040534496307373e-05 |0.4287540167570114 |0.005953311920166016 |
----------------------------------------------------------pseudo_mini_loss sum 1.3679876327514648
Total (block generation + training)time/epoch 75.4299483537674
Training time/epoch 23.806862831115723
Training time without block to device /epoch 23.47320580482483
Training time without total dataloading part /epoch 22.207598447799683
load block tensor time/epoch 1.21592116355896
block to device time/epoch 0.33365702629089355
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 19 |
Number of nodes for computation during this epoch:  8576141
Number of first layer input nodes during this epoch:  4654816
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.12287092208862305  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025709152221679688
random selection method range initialization spend 0.006394386291503906
time for parepare:  0.02425241470336914
local_output_nid generation:  0.0016884803771972656
local_in_edges_tensor generation:  0.02438211441040039
mini_batch_src_global generation:  0.0027387142181396484
r_  generation:  0.009830951690673828
local_output_nid generation:  0.001775979995727539
local_in_edges_tensor generation:  0.0009791851043701172
mini_batch_src_global generation:  0.0016167163848876953
r_  generation:  0.00982522964477539
local_output_nid generation:  0.0017421245574951172
local_in_edges_tensor generation:  0.0009260177612304688
mini_batch_src_global generation:  0.0012042522430419922
r_  generation:  0.008175373077392578
local_output_nid generation:  0.0017194747924804688
local_in_edges_tensor generation:  0.0008676052093505859
mini_batch_src_global generation:  0.0011205673217773438
r_  generation:  0.008234739303588867
local_output_nid generation:  0.001682281494140625
local_in_edges_tensor generation:  0.0008041858673095703
mini_batch_src_global generation:  0.0010342597961425781
r_  generation:  0.008134603500366211
local_output_nid generation:  0.0016434192657470703
local_in_edges_tensor generation:  0.000881195068359375
mini_batch_src_global generation:  0.0010082721710205078
r_  generation:  0.007919788360595703
local_output_nid generation:  0.0016319751739501953
local_in_edges_tensor generation:  0.0008928775787353516
mini_batch_src_global generation:  0.0009756088256835938
r_  generation:  0.007961273193359375
local_output_nid generation:  0.0015990734100341797
local_in_edges_tensor generation:  0.0008263587951660156
mini_batch_src_global generation:  0.0009758472442626953
r_  generation:  0.008510351181030273
local_output_nid generation:  0.0016028881072998047
local_in_edges_tensor generation:  0.0008134841918945312
mini_batch_src_global generation:  0.0009503364562988281
r_  generation:  0.008407831192016602
local_output_nid generation:  0.001577138900756836
local_in_edges_tensor generation:  0.0008282661437988281
mini_batch_src_global generation:  0.0009529590606689453
r_  generation:  0.008260726928710938
local_output_nid generation:  0.0015707015991210938
local_in_edges_tensor generation:  0.0007870197296142578
mini_batch_src_global generation:  0.0009710788726806641
r_  generation:  0.008272409439086914
local_output_nid generation:  0.0015416145324707031
local_in_edges_tensor generation:  0.0007808208465576172
mini_batch_src_global generation:  0.0009515285491943359
r_  generation:  0.008124589920043945
local_output_nid generation:  0.001535654067993164
local_in_edges_tensor generation:  0.0007989406585693359
mini_batch_src_global generation:  0.0009412765502929688
r_  generation:  0.008408784866333008
local_output_nid generation:  0.0015358924865722656
local_in_edges_tensor generation:  0.0007658004760742188
mini_batch_src_global generation:  0.0009222030639648438
r_  generation:  0.008366107940673828
local_output_nid generation:  0.0015327930450439453
local_in_edges_tensor generation:  0.0007662773132324219
mini_batch_src_global generation:  0.0009074211120605469
r_  generation:  0.00822901725769043
local_output_nid generation:  0.0015115737915039062
local_in_edges_tensor generation:  0.0007762908935546875
mini_batch_src_global generation:  0.0009334087371826172
r_  generation:  0.00847005844116211
local_output_nid generation:  0.001512765884399414
local_in_edges_tensor generation:  0.0008466243743896484
mini_batch_src_global generation:  0.0010089874267578125
r_  generation:  0.00974273681640625
local_output_nid generation:  0.001581430435180664
local_in_edges_tensor generation:  0.0007822513580322266
mini_batch_src_global generation:  0.0009777545928955078
r_  generation:  0.007894754409790039
local_output_nid generation:  0.0015399456024169922
local_in_edges_tensor generation:  0.0007879734039306641
mini_batch_src_global generation:  0.0009596347808837891
r_  generation:  0.008058786392211914
local_output_nid generation:  0.0015408992767333984
local_in_edges_tensor generation:  0.0008032321929931641
mini_batch_src_global generation:  0.0009789466857910156
r_  generation:  0.008211612701416016
local_output_nid generation:  0.0015304088592529297
local_in_edges_tensor generation:  0.0007905960083007812
mini_batch_src_global generation:  0.0009496212005615234
r_  generation:  0.008538484573364258
local_output_nid generation:  0.0015273094177246094
local_in_edges_tensor generation:  0.0008475780487060547
mini_batch_src_global generation:  0.0009517669677734375
r_  generation:  0.008126497268676758
local_output_nid generation:  0.0015151500701904297
local_in_edges_tensor generation:  0.000762939453125
mini_batch_src_global generation:  0.0009043216705322266
r_  generation:  0.008310079574584961
local_output_nid generation:  0.001514434814453125
local_in_edges_tensor generation:  0.000762939453125
mini_batch_src_global generation:  0.0009183883666992188
r_  generation:  0.008378267288208008
local_output_nid generation:  0.0015053749084472656
local_in_edges_tensor generation:  0.0007696151733398438
mini_batch_src_global generation:  0.0009300708770751953
r_  generation:  0.00851297378540039
local_output_nid generation:  0.0014913082122802734
local_in_edges_tensor generation:  0.0007624626159667969
mini_batch_src_global generation:  0.0009284019470214844
r_  generation:  0.008475542068481445
local_output_nid generation:  0.0014824867248535156
local_in_edges_tensor generation:  0.0007634162902832031
mini_batch_src_global generation:  0.0009033679962158203
r_  generation:  0.008423566818237305
local_output_nid generation:  0.0014796257019042969
local_in_edges_tensor generation:  0.0007605552673339844
mini_batch_src_global generation:  0.0009143352508544922
r_  generation:  0.008365154266357422
local_output_nid generation:  0.001478433609008789
local_in_edges_tensor generation:  0.0007526874542236328
mini_batch_src_global generation:  0.0009243488311767578
r_  generation:  0.008509397506713867
local_output_nid generation:  0.0014710426330566406
local_in_edges_tensor generation:  0.0007736682891845703
mini_batch_src_global generation:  0.0009264945983886719
r_  generation:  0.008271455764770508
local_output_nid generation:  0.0014712810516357422
local_in_edges_tensor generation:  0.0007917881011962891
mini_batch_src_global generation:  0.0009112358093261719
r_  generation:  0.00815725326538086
local_output_nid generation:  0.0014863014221191406
local_in_edges_tensor generation:  0.0007779598236083984
mini_batch_src_global generation:  0.0009212493896484375
r_  generation:  0.008224725723266602
----------------------check_connections_block total spend ----------------------------- 0.5100429058074951
generate_one_block  0.017075538635253906
generate_one_block  0.018284082412719727
generate_one_block  0.015105009078979492
generate_one_block  0.014764785766601562
generate_one_block  0.014734029769897461
generate_one_block  0.014089107513427734
generate_one_block  0.01434779167175293
generate_one_block  0.014891624450683594
generate_one_block  0.014531612396240234
generate_one_block  0.014329671859741211
generate_one_block  0.014565229415893555
generate_one_block  0.014224052429199219
generate_one_block  0.014661788940429688
generate_one_block  0.014387130737304688
generate_one_block  0.01430964469909668
generate_one_block  0.014726400375366211
generate_one_block  0.015443086624145508
generate_one_block  0.013702154159545898
generate_one_block  0.013818502426147461
generate_one_block  0.014399528503417969
generate_one_block  0.014700174331665039
generate_one_block  0.014104127883911133
generate_one_block  0.0175323486328125
generate_one_block  0.015102386474609375
generate_one_block  0.014804601669311523
generate_one_block  0.014863729476928711
generate_one_block  0.01451873779296875
generate_one_block  0.014531612396240234
generate_one_block  0.01474761962890625
generate_one_block  0.014248847961425781
generate_one_block  0.014123678207397461
generate_one_block  0.014374256134033203
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03832578659057617
gen group dst list time:  0.023274898529052734
time for parepare:  0.02634406089782715
local_output_nid generation:  0.008226156234741211
local_in_edges_tensor generation:  0.0272674560546875
mini_batch_src_global generation:  0.013024330139160156
r_  generation:  0.14727330207824707
local_output_nid generation:  0.009660005569458008
local_in_edges_tensor generation:  0.013789892196655273
mini_batch_src_global generation:  0.030437707901000977
r_  generation:  0.1422581672668457
local_output_nid generation:  0.012850522994995117
local_in_edges_tensor generation:  0.0414423942565918
mini_batch_src_global generation:  0.01472783088684082
r_  generation:  0.16959023475646973
local_output_nid generation:  0.012315988540649414
local_in_edges_tensor generation:  0.013045072555541992
mini_batch_src_global generation:  0.03365135192871094
r_  generation:  0.14396119117736816
local_output_nid generation:  0.010337352752685547
local_in_edges_tensor generation:  0.011576414108276367
mini_batch_src_global generation:  0.019498586654663086
r_  generation:  0.14880108833312988
local_output_nid generation:  0.011681079864501953
local_in_edges_tensor generation:  0.010085582733154297
mini_batch_src_global generation:  0.019861459732055664
r_  generation:  0.1402873992919922
local_output_nid generation:  0.00848698616027832
local_in_edges_tensor generation:  0.013257503509521484
mini_batch_src_global generation:  0.020116090774536133
r_  generation:  0.14616680145263672
local_output_nid generation:  0.010666370391845703
local_in_edges_tensor generation:  0.011024951934814453
mini_batch_src_global generation:  0.021945953369140625
r_  generation:  0.1841871738433838
local_output_nid generation:  0.008199691772460938
local_in_edges_tensor generation:  0.008032083511352539
mini_batch_src_global generation:  0.02115178108215332
r_  generation:  0.16676974296569824
local_output_nid generation:  0.015997886657714844
local_in_edges_tensor generation:  0.011442422866821289
mini_batch_src_global generation:  0.02268052101135254
r_  generation:  0.1463181972503662
local_output_nid generation:  0.014052152633666992
local_in_edges_tensor generation:  0.012106180191040039
mini_batch_src_global generation:  0.018003463745117188
r_  generation:  0.15144872665405273
local_output_nid generation:  0.013674736022949219
local_in_edges_tensor generation:  0.011133432388305664
mini_batch_src_global generation:  0.01755809783935547
r_  generation:  0.14217543601989746
local_output_nid generation:  0.014130115509033203
local_in_edges_tensor generation:  0.012136459350585938
mini_batch_src_global generation:  0.018466949462890625
r_  generation:  0.15317463874816895
local_output_nid generation:  0.013718128204345703
local_in_edges_tensor generation:  0.010806560516357422
mini_batch_src_global generation:  0.01842212677001953
r_  generation:  0.1602470874786377
local_output_nid generation:  0.01303410530090332
local_in_edges_tensor generation:  0.008988142013549805
mini_batch_src_global generation:  0.021431446075439453
r_  generation:  0.14470505714416504
local_output_nid generation:  0.010446786880493164
local_in_edges_tensor generation:  0.00909733772277832
mini_batch_src_global generation:  0.019013643264770508
r_  generation:  0.14980864524841309
local_output_nid generation:  0.010070323944091797
local_in_edges_tensor generation:  0.010337114334106445
mini_batch_src_global generation:  0.01992344856262207
r_  generation:  0.15233254432678223
local_output_nid generation:  0.008757352828979492
local_in_edges_tensor generation:  0.009708881378173828
mini_batch_src_global generation:  0.0182645320892334
r_  generation:  0.14052462577819824
local_output_nid generation:  0.010634183883666992
local_in_edges_tensor generation:  0.00763392448425293
mini_batch_src_global generation:  0.01709461212158203
r_  generation:  0.1861281394958496
local_output_nid generation:  0.008680343627929688
local_in_edges_tensor generation:  0.007536649703979492
mini_batch_src_global generation:  0.019124507904052734
r_  generation:  0.14386248588562012
local_output_nid generation:  0.009006023406982422
local_in_edges_tensor generation:  0.007694244384765625
mini_batch_src_global generation:  0.01841259002685547
r_  generation:  0.1506659984588623
local_output_nid generation:  0.008848428726196289
local_in_edges_tensor generation:  0.007433176040649414
mini_batch_src_global generation:  0.018392086029052734
r_  generation:  0.14638209342956543
local_output_nid generation:  0.009123563766479492
local_in_edges_tensor generation:  0.008713245391845703
mini_batch_src_global generation:  0.019417524337768555
r_  generation:  0.14913344383239746
local_output_nid generation:  0.008987903594970703
local_in_edges_tensor generation:  0.007982492446899414
mini_batch_src_global generation:  0.01854705810546875
r_  generation:  0.14597392082214355
local_output_nid generation:  0.009093284606933594
local_in_edges_tensor generation:  0.007727384567260742
mini_batch_src_global generation:  0.01822972297668457
r_  generation:  0.14807844161987305
local_output_nid generation:  0.009155988693237305
local_in_edges_tensor generation:  0.007674455642700195
mini_batch_src_global generation:  0.01994776725769043
r_  generation:  0.14998292922973633
local_output_nid generation:  0.00899362564086914
local_in_edges_tensor generation:  0.007511138916015625
mini_batch_src_global generation:  0.018198728561401367
r_  generation:  0.14902544021606445
local_output_nid generation:  0.008900880813598633
local_in_edges_tensor generation:  0.007699489593505859
mini_batch_src_global generation:  0.018621206283569336
r_  generation:  0.15002918243408203
local_output_nid generation:  0.01107335090637207
local_in_edges_tensor generation:  0.009971380233764648
mini_batch_src_global generation:  0.01938652992248535
r_  generation:  0.1547703742980957
local_output_nid generation:  0.00876307487487793
local_in_edges_tensor generation:  0.007502317428588867
mini_batch_src_global generation:  0.018263816833496094
r_  generation:  0.14717411994934082
local_output_nid generation:  0.008770942687988281
local_in_edges_tensor generation:  0.007311105728149414
mini_batch_src_global generation:  0.017909765243530273
r_  generation:  0.15077948570251465
local_output_nid generation:  0.00911402702331543
local_in_edges_tensor generation:  0.007599592208862305
mini_batch_src_global generation:  0.018425703048706055
r_  generation:  0.15248727798461914
----------------------check_connections_block total spend ----------------------------- 7.330322265625
generate_one_block  0.1968708038330078
generate_one_block  0.18760228157043457
generate_one_block  0.17509913444519043
generate_one_block  0.17717599868774414
generate_one_block  0.1971890926361084
generate_one_block  0.16745591163635254
generate_one_block  0.17706036567687988
generate_one_block  0.1838667392730713
generate_one_block  0.1773238182067871
generate_one_block  0.17469072341918945
generate_one_block  0.17896485328674316
generate_one_block  0.17097187042236328
generate_one_block  0.18259859085083008
generate_one_block  0.18065237998962402
generate_one_block  0.17760324478149414
generate_one_block  0.1835770606994629
generate_one_block  0.18999218940734863
generate_one_block  0.1765446662902832
generate_one_block  0.1684410572052002
generate_one_block  0.17739033699035645
generate_one_block  0.18184399604797363
generate_one_block  0.1729273796081543
generate_one_block  0.17945241928100586
generate_one_block  0.17474007606506348
generate_one_block  0.1830897331237793
generate_one_block  0.18233275413513184
generate_one_block  0.1776878833770752
generate_one_block  0.18090176582336426
generate_one_block  0.18227839469909668
generate_one_block  0.17340493202209473
generate_one_block  0.17824387550354004
generate_one_block  0.19046688079833984
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03293561935424805
gen group dst list time:  0.10277366638183594
time for parepare:  0.021100521087646484
local_output_nid generation:  0.02749156951904297
local_in_edges_tensor generation:  0.04491877555847168
mini_batch_src_global generation:  0.03731799125671387
r_  generation:  0.3968808650970459
local_output_nid generation:  0.03249025344848633
local_in_edges_tensor generation:  0.037366628646850586
mini_batch_src_global generation:  0.04978132247924805
r_  generation:  0.40286827087402344
local_output_nid generation:  0.03030085563659668
local_in_edges_tensor generation:  0.03221464157104492
mini_batch_src_global generation:  0.04747462272644043
r_  generation:  0.4069075584411621
local_output_nid generation:  0.029186725616455078
local_in_edges_tensor generation:  0.02730560302734375
mini_batch_src_global generation:  0.04987215995788574
r_  generation:  0.4027731418609619
local_output_nid generation:  0.028918743133544922
local_in_edges_tensor generation:  0.028164386749267578
mini_batch_src_global generation:  0.048279762268066406
r_  generation:  0.4108772277832031
local_output_nid generation:  0.02808356285095215
local_in_edges_tensor generation:  0.030021190643310547
mini_batch_src_global generation:  0.05080151557922363
r_  generation:  0.41599607467651367
local_output_nid generation:  0.03026413917541504
local_in_edges_tensor generation:  0.026943445205688477
mini_batch_src_global generation:  0.04915261268615723
r_  generation:  0.4032256603240967
local_output_nid generation:  0.02758622169494629
local_in_edges_tensor generation:  0.02701735496520996
mini_batch_src_global generation:  0.05002880096435547
r_  generation:  0.4014453887939453
local_output_nid generation:  0.027566909790039062
local_in_edges_tensor generation:  0.026429414749145508
mini_batch_src_global generation:  0.04744672775268555
r_  generation:  0.41031432151794434
local_output_nid generation:  0.027817487716674805
local_in_edges_tensor generation:  0.02673935890197754
mini_batch_src_global generation:  0.04835391044616699
r_  generation:  0.40529537200927734
local_output_nid generation:  0.027875423431396484
local_in_edges_tensor generation:  0.026526451110839844
mini_batch_src_global generation:  0.04709172248840332
r_  generation:  0.40807533264160156
local_output_nid generation:  0.027988195419311523
local_in_edges_tensor generation:  0.02653789520263672
mini_batch_src_global generation:  0.04996514320373535
r_  generation:  0.3997960090637207
local_output_nid generation:  0.027894258499145508
local_in_edges_tensor generation:  0.02522420883178711
mini_batch_src_global generation:  0.04689359664916992
r_  generation:  0.41001248359680176
local_output_nid generation:  0.027327775955200195
local_in_edges_tensor generation:  0.025604724884033203
mini_batch_src_global generation:  0.048343658447265625
r_  generation:  0.41077089309692383
local_output_nid generation:  0.027872323989868164
local_in_edges_tensor generation:  0.0255124568939209
mini_batch_src_global generation:  0.04671049118041992
r_  generation:  0.407306432723999
local_output_nid generation:  0.028021812438964844
local_in_edges_tensor generation:  0.031246662139892578
mini_batch_src_global generation:  0.05022168159484863
r_  generation:  0.4040966033935547
local_output_nid generation:  0.02841472625732422
local_in_edges_tensor generation:  0.025536060333251953
mini_batch_src_global generation:  0.04791665077209473
r_  generation:  0.4151878356933594
local_output_nid generation:  0.028275489807128906
local_in_edges_tensor generation:  0.0299532413482666
mini_batch_src_global generation:  0.061835527420043945
r_  generation:  0.4327220916748047
local_output_nid generation:  0.02748870849609375
local_in_edges_tensor generation:  0.025655508041381836
mini_batch_src_global generation:  0.04611539840698242
r_  generation:  0.39786410331726074
local_output_nid generation:  0.027571916580200195
local_in_edges_tensor generation:  0.025151491165161133
mini_batch_src_global generation:  0.047861337661743164
r_  generation:  0.39830827713012695
local_output_nid generation:  0.02758932113647461
local_in_edges_tensor generation:  0.029514312744140625
mini_batch_src_global generation:  0.04873538017272949
r_  generation:  0.41403818130493164
local_output_nid generation:  0.029441356658935547
local_in_edges_tensor generation:  0.03153419494628906
mini_batch_src_global generation:  0.047994136810302734
r_  generation:  0.4082050323486328
local_output_nid generation:  0.027442455291748047
local_in_edges_tensor generation:  0.0325162410736084
mini_batch_src_global generation:  0.04878854751586914
r_  generation:  0.42161011695861816
local_output_nid generation:  0.028689146041870117
local_in_edges_tensor generation:  0.025960922241210938
mini_batch_src_global generation:  0.04857802391052246
r_  generation:  0.40070605278015137
local_output_nid generation:  0.027593374252319336
local_in_edges_tensor generation:  0.02690744400024414
mini_batch_src_global generation:  0.047446489334106445
r_  generation:  0.4088480472564697
local_output_nid generation:  0.028187036514282227
local_in_edges_tensor generation:  0.028353214263916016
mini_batch_src_global generation:  0.048922061920166016
r_  generation:  0.4059436321258545
local_output_nid generation:  0.02781820297241211
local_in_edges_tensor generation:  0.025676488876342773
mini_batch_src_global generation:  0.04699230194091797
r_  generation:  0.41321682929992676
local_output_nid generation:  0.027693510055541992
local_in_edges_tensor generation:  0.02771592140197754
mini_batch_src_global generation:  0.04802680015563965
r_  generation:  0.40688276290893555
local_output_nid generation:  0.029206275939941406
local_in_edges_tensor generation:  0.03247809410095215
mini_batch_src_global generation:  0.053189992904663086
r_  generation:  0.40898633003234863
local_output_nid generation:  0.027436494827270508
local_in_edges_tensor generation:  0.028842449188232422
mini_batch_src_global generation:  0.04814291000366211
r_  generation:  0.40560364723205566
local_output_nid generation:  0.029185771942138672
local_in_edges_tensor generation:  0.02661609649658203
mini_batch_src_global generation:  0.05013251304626465
r_  generation:  0.4088292121887207
local_output_nid generation:  0.02784252166748047
local_in_edges_tensor generation:  0.027747631072998047
mini_batch_src_global generation:  0.048651933670043945
r_  generation:  0.4081401824951172
----------------------check_connections_block total spend ----------------------------- 19.35394859313965
generate_one_block  0.5616617202758789
generate_one_block  0.5379903316497803
generate_one_block  0.5288012027740479
generate_one_block  0.5331552028656006
generate_one_block  0.6422164440155029
generate_one_block  0.5250303745269775
generate_one_block  0.5484774112701416
generate_one_block  0.5422966480255127
generate_one_block  0.5339429378509521
generate_one_block  0.5423915386199951
generate_one_block  0.5397968292236328
generate_one_block  0.5281229019165039
generate_one_block  0.5363109111785889
generate_one_block  0.5347514152526855
generate_one_block  0.5374987125396729
generate_one_block  0.5434870719909668
generate_one_block  0.5470192432403564
generate_one_block  0.5317027568817139
generate_one_block  0.5400514602661133
generate_one_block  0.5280179977416992
generate_one_block  0.5425918102264404
generate_one_block  0.5266296863555908
generate_one_block  0.5335643291473389
generate_one_block  0.5289874076843262
generate_one_block  0.561009407043457
generate_one_block  0.546229362487793
generate_one_block  0.5448160171508789
generate_one_block  0.5294003486633301
generate_one_block  0.5396392345428467
generate_one_block  0.525109052658081
generate_one_block  0.5337183475494385
generate_one_block  0.5437350273132324
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.12287092208862305  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

connection checking time:  26.68427085876465
block generation total time  23.076594352722168
average batch blocks generation time:  0.7211435735225677
block dataloader generation time/epoch 51.68830466270447
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1049947738647461  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.804497241973877  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10399723052978516  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.173802375793457  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10396289825439453  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.666027069091797  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1030435562133789  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.756047248840332  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10393095016479492  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.927922248840332  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10259532928466797  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.21757984161377  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10400009155273438  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.73729133605957  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10380268096923828  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.020246982574463  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1030130386352539  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.769850730895996  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10301923751831055  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.714845180511475  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1050114631652832  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.827621459960938  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10286903381347656  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.403563976287842  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10399055480957031  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.865362644195557  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10275745391845703  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.55789852142334  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1038818359375  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.586333274841309  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10400819778442383  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.889766693115234  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10509109497070312  GigaBytes
Max Memory Allocated: 16.270891666412354  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.249951362609863  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10236454010009766  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.210733413696289  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10264873504638672  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.222767353057861  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10297155380249023  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.550132274627686  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10503196716308594  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.964282512664795  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10285568237304688  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.475539684295654  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10401344299316406  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.856704235076904  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10287666320800781  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.580343246459961  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10502433776855469  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.872182369232178  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10432291030883789  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.977807998657227  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1029658317565918  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.720613479614258  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10293865203857422  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.848552703857422  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10503578186035156  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.910068035125732  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10266304016113281  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.418070793151855  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10275650024414062  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.492033004760742  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10321521759033203  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.728954315185547  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.032972149550914764 |0.01268952339887619 |0.2702580839395523 |9.290874004364014e-05 |0.4315623566508293 |0.006034135818481445 |
----------------------------------------------------------pseudo_mini_loss sum 1.3555424213409424
Total (block generation + training)time/epoch 75.50920148329301
Training time/epoch 23.98033332824707
Training time without block to device /epoch 23.574268579483032
Training time without total dataloading part /epoch 22.46726131439209
load block tensor time/epoch 1.0551087856292725
block to device time/epoch 0.4060647487640381
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 20 |
Number of nodes for computation during this epoch:  8577688
Number of first layer input nodes during this epoch:  4652857
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1204071044921875  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02793097496032715
random selection method range initialization spend 0.005612850189208984
time for parepare:  0.024402141571044922
local_output_nid generation:  0.0017728805541992188
local_in_edges_tensor generation:  0.005217313766479492
mini_batch_src_global generation:  0.002279996871948242
r_  generation:  0.008620500564575195
local_output_nid generation:  0.0017333030700683594
local_in_edges_tensor generation:  0.0011668205261230469
mini_batch_src_global generation:  0.0034821033477783203
r_  generation:  0.008661508560180664
local_output_nid generation:  0.0018792152404785156
local_in_edges_tensor generation:  0.0011370182037353516
mini_batch_src_global generation:  0.0013685226440429688
r_  generation:  0.008592367172241211
local_output_nid generation:  0.0019063949584960938
local_in_edges_tensor generation:  0.0010743141174316406
mini_batch_src_global generation:  0.0012116432189941406
r_  generation:  0.010135412216186523
local_output_nid generation:  0.001962900161743164
local_in_edges_tensor generation:  0.0010840892791748047
mini_batch_src_global generation:  0.0011680126190185547
r_  generation:  0.008112430572509766
local_output_nid generation:  0.0019676685333251953
local_in_edges_tensor generation:  0.0010492801666259766
mini_batch_src_global generation:  0.0011649131774902344
r_  generation:  0.00832056999206543
local_output_nid generation:  0.002022266387939453
local_in_edges_tensor generation:  0.0010268688201904297
mini_batch_src_global generation:  0.0011565685272216797
r_  generation:  0.008467912673950195
local_output_nid generation:  0.0020210742950439453
local_in_edges_tensor generation:  0.001119375228881836
mini_batch_src_global generation:  0.0011394023895263672
r_  generation:  0.00828409194946289
local_output_nid generation:  0.00203704833984375
local_in_edges_tensor generation:  0.001013040542602539
mini_batch_src_global generation:  0.001177072525024414
r_  generation:  0.008223772048950195
local_output_nid generation:  0.0020291805267333984
local_in_edges_tensor generation:  0.0010287761688232422
mini_batch_src_global generation:  0.0012693405151367188
r_  generation:  0.008442878723144531
local_output_nid generation:  0.0020301342010498047
local_in_edges_tensor generation:  0.0010123252868652344
mini_batch_src_global generation:  0.0010907649993896484
r_  generation:  0.008324384689331055
local_output_nid generation:  0.0020308494567871094
local_in_edges_tensor generation:  0.0010209083557128906
mini_batch_src_global generation:  0.001111745834350586
r_  generation:  0.008357524871826172
local_output_nid generation:  0.0020530223846435547
local_in_edges_tensor generation:  0.0009593963623046875
mini_batch_src_global generation:  0.0011343955993652344
r_  generation:  0.00817728042602539
local_output_nid generation:  0.0020494461059570312
local_in_edges_tensor generation:  0.0010223388671875
mini_batch_src_global generation:  0.0012035369873046875
r_  generation:  0.008544683456420898
local_output_nid generation:  0.0020394325256347656
local_in_edges_tensor generation:  0.0010073184967041016
mini_batch_src_global generation:  0.001081228256225586
r_  generation:  0.008336067199707031
local_output_nid generation:  0.0020377635955810547
local_in_edges_tensor generation:  0.0009832382202148438
mini_batch_src_global generation:  0.001068115234375
r_  generation:  0.008369922637939453
local_output_nid generation:  0.002072572708129883
local_in_edges_tensor generation:  0.0009989738464355469
mini_batch_src_global generation:  0.001066446304321289
r_  generation:  0.008341312408447266
local_output_nid generation:  0.0020799636840820312
local_in_edges_tensor generation:  0.001018524169921875
mini_batch_src_global generation:  0.0033104419708251953
r_  generation:  0.008038520812988281
local_output_nid generation:  0.0020809173583984375
local_in_edges_tensor generation:  0.000986337661743164
mini_batch_src_global generation:  0.001069784164428711
r_  generation:  0.008343696594238281
local_output_nid generation:  0.0020780563354492188
local_in_edges_tensor generation:  0.0010266304016113281
mini_batch_src_global generation:  0.0011088848114013672
r_  generation:  0.008503437042236328
local_output_nid generation:  0.002076864242553711
local_in_edges_tensor generation:  0.0010685920715332031
mini_batch_src_global generation:  0.0013289451599121094
r_  generation:  0.008809566497802734
local_output_nid generation:  0.0020961761474609375
local_in_edges_tensor generation:  0.0009779930114746094
mini_batch_src_global generation:  0.001131296157836914
r_  generation:  0.008697748184204102
local_output_nid generation:  0.002110719680786133
local_in_edges_tensor generation:  0.0009887218475341797
mini_batch_src_global generation:  0.0010828971862792969
r_  generation:  0.008594989776611328
local_output_nid generation:  0.0021162033081054688
local_in_edges_tensor generation:  0.0010004043579101562
mini_batch_src_global generation:  0.0010886192321777344
r_  generation:  0.008421897888183594
local_output_nid generation:  0.0020890235900878906
local_in_edges_tensor generation:  0.0009891986846923828
mini_batch_src_global generation:  0.0010766983032226562
r_  generation:  0.008387088775634766
local_output_nid generation:  0.0020797252655029297
local_in_edges_tensor generation:  0.0009877681732177734
mini_batch_src_global generation:  0.0010993480682373047
r_  generation:  0.008744001388549805
local_output_nid generation:  0.0020897388458251953
local_in_edges_tensor generation:  0.0009622573852539062
mini_batch_src_global generation:  0.0011098384857177734
r_  generation:  0.008760690689086914
local_output_nid generation:  0.002083301544189453
local_in_edges_tensor generation:  0.0010242462158203125
mini_batch_src_global generation:  0.0010535717010498047
r_  generation:  0.008092641830444336
local_output_nid generation:  0.0020792484283447266
local_in_edges_tensor generation:  0.0010042190551757812
mini_batch_src_global generation:  0.0010409355163574219
r_  generation:  0.00829005241394043
local_output_nid generation:  0.002096891403198242
local_in_edges_tensor generation:  0.0009980201721191406
mini_batch_src_global generation:  0.001093149185180664
r_  generation:  0.008432149887084961
local_output_nid generation:  0.0020852088928222656
local_in_edges_tensor generation:  0.0009860992431640625
mini_batch_src_global generation:  0.0010707378387451172
r_  generation:  0.01055765151977539
local_output_nid generation:  0.0020933151245117188
local_in_edges_tensor generation:  0.000995635986328125
mini_batch_src_global generation:  0.0011200904846191406
r_  generation:  0.008405447006225586
----------------------check_connections_block total spend ----------------------------- 0.5370337963104248
generate_one_block  0.023839473724365234
generate_one_block  0.019605159759521484
generate_one_block  0.016585826873779297
generate_one_block  0.015149593353271484
generate_one_block  0.015446186065673828
generate_one_block  0.015217065811157227
generate_one_block  0.015352725982666016
generate_one_block  0.015216588973999023
generate_one_block  0.014998674392700195
generate_one_block  0.015352725982666016
generate_one_block  0.018241167068481445
generate_one_block  0.015249013900756836
generate_one_block  0.014834403991699219
generate_one_block  0.015417098999023438
generate_one_block  0.014805793762207031
generate_one_block  0.01515507698059082
generate_one_block  0.015065908432006836
generate_one_block  0.014516353607177734
generate_one_block  0.01521444320678711
generate_one_block  0.015114307403564453
generate_one_block  0.015607118606567383
generate_one_block  0.015444040298461914
generate_one_block  0.020183324813842773
generate_one_block  0.024825572967529297
generate_one_block  0.022267818450927734
generate_one_block  0.015287160873413086
generate_one_block  0.015004158020019531
generate_one_block  0.014074325561523438
generate_one_block  0.014481544494628906
generate_one_block  0.014407873153686523
generate_one_block  0.01467442512512207
generate_one_block  0.014587163925170898
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.07258462905883789
gen group dst list time:  0.02436971664428711
time for parepare:  0.02370166778564453
local_output_nid generation:  0.00577855110168457
local_in_edges_tensor generation:  0.020269155502319336
mini_batch_src_global generation:  0.018148422241210938
r_  generation:  0.13381314277648926
local_output_nid generation:  0.007983922958374023
local_in_edges_tensor generation:  0.009391307830810547
mini_batch_src_global generation:  0.030646085739135742
r_  generation:  0.15670037269592285
local_output_nid generation:  0.009520530700683594
local_in_edges_tensor generation:  0.033611297607421875
mini_batch_src_global generation:  0.03544449806213379
r_  generation:  0.14489102363586426
local_output_nid generation:  0.008614778518676758
local_in_edges_tensor generation:  0.011763572692871094
mini_batch_src_global generation:  0.01742839813232422
r_  generation:  0.13338041305541992
local_output_nid generation:  0.010406494140625
local_in_edges_tensor generation:  0.009157180786132812
mini_batch_src_global generation:  0.018697738647460938
r_  generation:  0.1410198211669922
local_output_nid generation:  0.010099649429321289
local_in_edges_tensor generation:  0.008921623229980469
mini_batch_src_global generation:  0.019354820251464844
r_  generation:  0.14480900764465332
local_output_nid generation:  0.008135557174682617
local_in_edges_tensor generation:  0.011093378067016602
mini_batch_src_global generation:  0.019945859909057617
r_  generation:  0.15271329879760742
local_output_nid generation:  0.011353015899658203
local_in_edges_tensor generation:  0.008689641952514648
mini_batch_src_global generation:  0.020854949951171875
r_  generation:  0.147230863571167
local_output_nid generation:  0.008193016052246094
local_in_edges_tensor generation:  0.007811069488525391
mini_batch_src_global generation:  0.019471406936645508
r_  generation:  0.17127466201782227
local_output_nid generation:  0.008255243301391602
local_in_edges_tensor generation:  0.007738828659057617
mini_batch_src_global generation:  0.017702102661132812
r_  generation:  0.1431584358215332
local_output_nid generation:  0.00863790512084961
local_in_edges_tensor generation:  0.007470607757568359
mini_batch_src_global generation:  0.016875267028808594
r_  generation:  0.14130878448486328
local_output_nid generation:  0.008555889129638672
local_in_edges_tensor generation:  0.0074462890625
mini_batch_src_global generation:  0.016948461532592773
r_  generation:  0.14022541046142578
local_output_nid generation:  0.008657455444335938
local_in_edges_tensor generation:  0.007462978363037109
mini_batch_src_global generation:  0.016672611236572266
r_  generation:  0.1398313045501709
local_output_nid generation:  0.008864879608154297
local_in_edges_tensor generation:  0.007609128952026367
mini_batch_src_global generation:  0.017682790756225586
r_  generation:  0.142303466796875
local_output_nid generation:  0.008435726165771484
local_in_edges_tensor generation:  0.007348299026489258
mini_batch_src_global generation:  0.016727685928344727
r_  generation:  0.14071321487426758
local_output_nid generation:  0.008524179458618164
local_in_edges_tensor generation:  0.008001565933227539
mini_batch_src_global generation:  0.01726388931274414
r_  generation:  0.14099383354187012
local_output_nid generation:  0.008483171463012695
local_in_edges_tensor generation:  0.008437156677246094
mini_batch_src_global generation:  0.016730070114135742
r_  generation:  0.1417548656463623
local_output_nid generation:  0.008392810821533203
local_in_edges_tensor generation:  0.007341146469116211
mini_batch_src_global generation:  0.016819000244140625
r_  generation:  0.13759279251098633
local_output_nid generation:  0.008320093154907227
local_in_edges_tensor generation:  0.0076448917388916016
mini_batch_src_global generation:  0.0170135498046875
r_  generation:  0.19409894943237305
local_output_nid generation:  0.008292198181152344
local_in_edges_tensor generation:  0.0089263916015625
mini_batch_src_global generation:  0.01793694496154785
r_  generation:  0.14510107040405273
local_output_nid generation:  0.008671760559082031
local_in_edges_tensor generation:  0.00888967514038086
mini_batch_src_global generation:  0.017794370651245117
r_  generation:  0.14964842796325684
local_output_nid generation:  0.009581327438354492
local_in_edges_tensor generation:  0.010313987731933594
mini_batch_src_global generation:  0.029267311096191406
r_  generation:  0.14702796936035156
local_output_nid generation:  0.008559226989746094
local_in_edges_tensor generation:  0.00864863395690918
mini_batch_src_global generation:  0.017607927322387695
r_  generation:  0.14625859260559082
local_output_nid generation:  0.008552789688110352
local_in_edges_tensor generation:  0.008218526840209961
mini_batch_src_global generation:  0.01760697364807129
r_  generation:  0.14374256134033203
local_output_nid generation:  0.008581876754760742
local_in_edges_tensor generation:  0.008120059967041016
mini_batch_src_global generation:  0.017011165618896484
r_  generation:  0.16875028610229492
local_output_nid generation:  0.014060258865356445
local_in_edges_tensor generation:  0.01171112060546875
mini_batch_src_global generation:  0.021091222763061523
r_  generation:  0.17807602882385254
local_output_nid generation:  0.011529684066772461
local_in_edges_tensor generation:  0.00968790054321289
mini_batch_src_global generation:  0.01874065399169922
r_  generation:  0.14959287643432617
local_output_nid generation:  0.009162425994873047
local_in_edges_tensor generation:  0.0075817108154296875
mini_batch_src_global generation:  0.017203092575073242
r_  generation:  0.13672757148742676
local_output_nid generation:  0.008881807327270508
local_in_edges_tensor generation:  0.007817506790161133
mini_batch_src_global generation:  0.016797542572021484
r_  generation:  0.1467893123626709
local_output_nid generation:  0.008650541305541992
local_in_edges_tensor generation:  0.010855674743652344
mini_batch_src_global generation:  0.017285585403442383
r_  generation:  0.1425936222076416
local_output_nid generation:  0.00876760482788086
local_in_edges_tensor generation:  0.00879216194152832
mini_batch_src_global generation:  0.028905630111694336
r_  generation:  0.15936946868896484
local_output_nid generation:  0.010503530502319336
local_in_edges_tensor generation:  0.007783412933349609
mini_batch_src_global generation:  0.017912626266479492
r_  generation:  0.1444549560546875
----------------------check_connections_block total spend ----------------------------- 7.133776664733887
generate_one_block  0.1962878704071045
generate_one_block  0.17384934425354004
generate_one_block  0.1797776222229004
generate_one_block  0.16890859603881836
generate_one_block  0.19000482559204102
generate_one_block  0.17916560173034668
generate_one_block  0.1797027587890625
generate_one_block  0.1809685230255127
generate_one_block  0.17589926719665527
generate_one_block  0.1806933879852295
generate_one_block  0.17496800422668457
generate_one_block  0.17673730850219727
generate_one_block  0.17866230010986328
generate_one_block  0.18391060829162598
generate_one_block  0.1806197166442871
generate_one_block  0.18085336685180664
generate_one_block  0.17788290977478027
generate_one_block  0.17115521430969238
generate_one_block  0.18607831001281738
generate_one_block  0.18138647079467773
generate_one_block  0.1834714412689209
generate_one_block  0.18113112449645996
generate_one_block  0.180527925491333
generate_one_block  0.17873191833496094
generate_one_block  0.17927169799804688
generate_one_block  0.18490052223205566
generate_one_block  0.18439054489135742
generate_one_block  0.16894054412841797
generate_one_block  0.17702674865722656
generate_one_block  0.17934632301330566
generate_one_block  0.18647336959838867
generate_one_block  0.18038678169250488
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.033800363540649414
gen group dst list time:  0.10420751571655273
time for parepare:  0.020625591278076172
local_output_nid generation:  0.023389816284179688
local_in_edges_tensor generation:  0.04278969764709473
mini_batch_src_global generation:  0.04938960075378418
r_  generation:  0.39713287353515625
local_output_nid generation:  0.02877068519592285
local_in_edges_tensor generation:  0.03114914894104004
mini_batch_src_global generation:  0.05225372314453125
r_  generation:  0.38983964920043945
local_output_nid generation:  0.028330087661743164
local_in_edges_tensor generation:  0.02752208709716797
mini_batch_src_global generation:  0.04508805274963379
r_  generation:  0.4113478660583496
local_output_nid generation:  0.03166079521179199
local_in_edges_tensor generation:  0.02631998062133789
mini_batch_src_global generation:  0.046783447265625
r_  generation:  0.40036559104919434
local_output_nid generation:  0.02916860580444336
local_in_edges_tensor generation:  0.031071186065673828
mini_batch_src_global generation:  0.046868324279785156
r_  generation:  0.41402506828308105
local_output_nid generation:  0.029323577880859375
local_in_edges_tensor generation:  0.027248620986938477
mini_batch_src_global generation:  0.04976344108581543
r_  generation:  0.4255545139312744
local_output_nid generation:  0.03110980987548828
local_in_edges_tensor generation:  0.03528189659118652
mini_batch_src_global generation:  0.048906564712524414
r_  generation:  0.4084751605987549
local_output_nid generation:  0.027985334396362305
local_in_edges_tensor generation:  0.02899336814880371
mini_batch_src_global generation:  0.048209190368652344
r_  generation:  0.39841341972351074
local_output_nid generation:  0.027809619903564453
local_in_edges_tensor generation:  0.02671647071838379
mini_batch_src_global generation:  0.0466914176940918
r_  generation:  0.40871453285217285
local_output_nid generation:  0.02785181999206543
local_in_edges_tensor generation:  0.026917219161987305
mini_batch_src_global generation:  0.047937870025634766
r_  generation:  0.4024815559387207
local_output_nid generation:  0.027663230895996094
local_in_edges_tensor generation:  0.026503324508666992
mini_batch_src_global generation:  0.046784400939941406
r_  generation:  0.41397786140441895
local_output_nid generation:  0.028163433074951172
local_in_edges_tensor generation:  0.026531219482421875
mini_batch_src_global generation:  0.04850292205810547
r_  generation:  0.3997812271118164
local_output_nid generation:  0.02788710594177246
local_in_edges_tensor generation:  0.0267941951751709
mini_batch_src_global generation:  0.046514272689819336
r_  generation:  0.4067800045013428
local_output_nid generation:  0.028026819229125977
local_in_edges_tensor generation:  0.026746749877929688
mini_batch_src_global generation:  0.04777193069458008
r_  generation:  0.40085840225219727
local_output_nid generation:  0.027277708053588867
local_in_edges_tensor generation:  0.026149988174438477
mini_batch_src_global generation:  0.046135902404785156
r_  generation:  0.40775322914123535
local_output_nid generation:  0.03017258644104004
local_in_edges_tensor generation:  0.031127214431762695
mini_batch_src_global generation:  0.0497286319732666
r_  generation:  0.4082057476043701
local_output_nid generation:  0.030146360397338867
local_in_edges_tensor generation:  0.03008556365966797
mini_batch_src_global generation:  0.0464024543762207
r_  generation:  0.4112880229949951
local_output_nid generation:  0.02759861946105957
local_in_edges_tensor generation:  0.03314924240112305
mini_batch_src_global generation:  0.049326419830322266
r_  generation:  0.40088725090026855
local_output_nid generation:  0.027555227279663086
local_in_edges_tensor generation:  0.02933502197265625
mini_batch_src_global generation:  0.04716897010803223
r_  generation:  0.40701842308044434
local_output_nid generation:  0.02817559242248535
local_in_edges_tensor generation:  0.030393362045288086
mini_batch_src_global generation:  0.059073686599731445
r_  generation:  0.40752172470092773
local_output_nid generation:  0.029379606246948242
local_in_edges_tensor generation:  0.0303497314453125
mini_batch_src_global generation:  0.05257105827331543
r_  generation:  0.4127075672149658
local_output_nid generation:  0.02790093421936035
local_in_edges_tensor generation:  0.02699756622314453
mini_batch_src_global generation:  0.04840850830078125
r_  generation:  0.3999192714691162
local_output_nid generation:  0.027765512466430664
local_in_edges_tensor generation:  0.02656865119934082
mini_batch_src_global generation:  0.04804706573486328
r_  generation:  0.4084317684173584
local_output_nid generation:  0.027625560760498047
local_in_edges_tensor generation:  0.024752378463745117
mini_batch_src_global generation:  0.04795432090759277
r_  generation:  0.3992016315460205
local_output_nid generation:  0.027571678161621094
local_in_edges_tensor generation:  0.026521921157836914
mini_batch_src_global generation:  0.04664278030395508
r_  generation:  0.417675256729126
local_output_nid generation:  0.027904510498046875
local_in_edges_tensor generation:  0.02502894401550293
mini_batch_src_global generation:  0.048163652420043945
r_  generation:  0.4033067226409912
local_output_nid generation:  0.02803778648376465
local_in_edges_tensor generation:  0.028623580932617188
mini_batch_src_global generation:  0.04913067817687988
r_  generation:  0.41508007049560547
local_output_nid generation:  0.027536392211914062
local_in_edges_tensor generation:  0.02752399444580078
mini_batch_src_global generation:  0.047660112380981445
r_  generation:  0.3952043056488037
local_output_nid generation:  0.027982711791992188
local_in_edges_tensor generation:  0.029430389404296875
mini_batch_src_global generation:  0.04604697227478027
r_  generation:  0.40673017501831055
local_output_nid generation:  0.027332782745361328
local_in_edges_tensor generation:  0.029259443283081055
mini_batch_src_global generation:  0.047734975814819336
r_  generation:  0.39677000045776367
local_output_nid generation:  0.028833389282226562
local_in_edges_tensor generation:  0.025109052658081055
mini_batch_src_global generation:  0.04677581787109375
r_  generation:  0.41131019592285156
local_output_nid generation:  0.027604341506958008
local_in_edges_tensor generation:  0.025065898895263672
mini_batch_src_global generation:  0.04789543151855469
r_  generation:  0.39816951751708984
----------------------check_connections_block total spend ----------------------------- 19.275588512420654
generate_one_block  0.5488855838775635
generate_one_block  0.5325334072113037
generate_one_block  0.5277223587036133
generate_one_block  0.5268871784210205
generate_one_block  0.6326358318328857
generate_one_block  0.5458762645721436
generate_one_block  0.538463830947876
generate_one_block  0.5444552898406982
generate_one_block  0.5294694900512695
generate_one_block  0.5339088439941406
generate_one_block  0.5327160358428955
generate_one_block  0.5297966003417969
generate_one_block  0.5295329093933105
generate_one_block  0.5317161083221436
generate_one_block  0.5286083221435547
generate_one_block  0.550919771194458
generate_one_block  0.5328559875488281
generate_one_block  0.5266973972320557
generate_one_block  0.5283100605010986
generate_one_block  0.5360872745513916
generate_one_block  0.5415763854980469
generate_one_block  0.542055606842041
generate_one_block  0.535686731338501
generate_one_block  0.5351088047027588
generate_one_block  0.5500791072845459
generate_one_block  0.5423369407653809
generate_one_block  0.543621301651001
generate_one_block  0.5301394462585449
generate_one_block  0.5307362079620361
generate_one_block  0.5349688529968262
generate_one_block  0.5417382717132568
generate_one_block  0.5362546443939209
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1204071044921875  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

connection checking time:  26.40936517715454
block generation total time  23.01449179649353
average batch blocks generation time:  0.7192028686404228
block dataloader generation time/epoch 51.72370556990305
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1050562858581543  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.01667833328247  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10273170471191406  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.467095375061035  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10285615921020508  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.605041980743408  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10249900817871094  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.274163246154785  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10283803939819336  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.596605777740479  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10397052764892578  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.820480823516846  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10503101348876953  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.936105251312256  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10401153564453125  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.928794860839844  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1028280258178711  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.746490478515625  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10402154922485352  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.891600608825684  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1039438247680664  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.64988088607788  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10308408737182617  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.563941955566406  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10272407531738281  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.465380191802979  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10301637649536133  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.683660507202148  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10242319107055664  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.418691158294678  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10320091247558594  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.68915843963623  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10390949249267578  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.59827995300293  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10269546508789062  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.26539659500122  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1028451919555664  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.590752124786377  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10302543640136719  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.590319633483887  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10505056381225586  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.01737689971924  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10438013076782227  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.91679334640503  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1050252914428711  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.847967147827148  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10292577743530273  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.736614227294922  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1039729118347168  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.758593559265137  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10413789749145508  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.034729480743408  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10504722595214844  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.02470588684082  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1025543212890625  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.237611293792725  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10297250747680664  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.715233325958252  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10286664962768555  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.580862045288086  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10502815246582031  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.864320755004883  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10302257537841797  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.643469333648682  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03773246705532074 |0.012233003973960876 |0.2633332088589668 |9.11131501197815e-05 |0.4292445257306099 |0.005696773529052734 |
----------------------------------------------------------pseudo_mini_loss sum 1.3322173357009888
Total (block generation + training)time/epoch 75.54460138082504
Training time/epoch 23.820605039596558
Training time without block to device /epoch 23.42914891242981
Training time without total dataloading part /epoch 22.17109990119934
load block tensor time/epoch 1.2074389457702637
block to device time/epoch 0.39145612716674805
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 21 |
Number of nodes for computation during this epoch:  8575482
Number of first layer input nodes during this epoch:  4653246
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.11970710754394531  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021368741989135742
random selection method range initialization spend 0.00592494010925293
time for parepare:  0.020041465759277344
local_output_nid generation:  0.0013706684112548828
local_in_edges_tensor generation:  0.00623321533203125
mini_batch_src_global generation:  0.0015606880187988281
r_  generation:  0.008681535720825195
local_output_nid generation:  0.0015034675598144531
local_in_edges_tensor generation:  0.0009565353393554688
mini_batch_src_global generation:  0.001434326171875
r_  generation:  0.008491992950439453
local_output_nid generation:  0.0015871524810791016
local_in_edges_tensor generation:  0.0008928775787353516
mini_batch_src_global generation:  0.0010530948638916016
r_  generation:  0.007977008819580078
local_output_nid generation:  0.001528024673461914
local_in_edges_tensor generation:  0.0008275508880615234
mini_batch_src_global generation:  0.0009293556213378906
r_  generation:  0.008116483688354492
local_output_nid generation:  0.0015041828155517578
local_in_edges_tensor generation:  0.0008041858673095703
mini_batch_src_global generation:  0.0009205341339111328
r_  generation:  0.008069038391113281
local_output_nid generation:  0.001501321792602539
local_in_edges_tensor generation:  0.0007958412170410156
mini_batch_src_global generation:  0.0009036064147949219
r_  generation:  0.00816035270690918
local_output_nid generation:  0.0014836788177490234
local_in_edges_tensor generation:  0.0008327960968017578
mini_batch_src_global generation:  0.0009601116180419922
r_  generation:  0.008408784866333008
local_output_nid generation:  0.0014910697937011719
local_in_edges_tensor generation:  0.0008122920989990234
mini_batch_src_global generation:  0.000911712646484375
r_  generation:  0.008024454116821289
local_output_nid generation:  0.001489400863647461
local_in_edges_tensor generation:  0.0008108615875244141
mini_batch_src_global generation:  0.0009560585021972656
r_  generation:  0.008381128311157227
local_output_nid generation:  0.001485586166381836
local_in_edges_tensor generation:  0.0007987022399902344
mini_batch_src_global generation:  0.0010547637939453125
r_  generation:  0.009479522705078125
local_output_nid generation:  0.0014958381652832031
local_in_edges_tensor generation:  0.0008244514465332031
mini_batch_src_global generation:  0.001039266586303711
r_  generation:  0.008405208587646484
local_output_nid generation:  0.0015103816986083984
local_in_edges_tensor generation:  0.0008099079132080078
mini_batch_src_global generation:  0.000919342041015625
r_  generation:  0.00835728645324707
local_output_nid generation:  0.0015192031860351562
local_in_edges_tensor generation:  0.0007960796356201172
mini_batch_src_global generation:  0.00095367431640625
r_  generation:  0.008335351943969727
local_output_nid generation:  0.0015151500701904297
local_in_edges_tensor generation:  0.0007965564727783203
mini_batch_src_global generation:  0.0009179115295410156
r_  generation:  0.008329153060913086
local_output_nid generation:  0.0015003681182861328
local_in_edges_tensor generation:  0.0008051395416259766
mini_batch_src_global generation:  0.0008878707885742188
r_  generation:  0.008117437362670898
local_output_nid generation:  0.001489877700805664
local_in_edges_tensor generation:  0.0008037090301513672
mini_batch_src_global generation:  0.0009028911590576172
r_  generation:  0.008264303207397461
local_output_nid generation:  0.0014743804931640625
local_in_edges_tensor generation:  0.0007658004760742188
mini_batch_src_global generation:  0.0010008811950683594
r_  generation:  0.008450746536254883
local_output_nid generation:  0.0014774799346923828
local_in_edges_tensor generation:  0.0007748603820800781
mini_batch_src_global generation:  0.0009033679962158203
r_  generation:  0.008254766464233398
local_output_nid generation:  0.0014982223510742188
local_in_edges_tensor generation:  0.0008080005645751953
mini_batch_src_global generation:  0.0009331703186035156
r_  generation:  0.008579730987548828
local_output_nid generation:  0.0014925003051757812
local_in_edges_tensor generation:  0.0007643699645996094
mini_batch_src_global generation:  0.0008988380432128906
r_  generation:  0.008228778839111328
local_output_nid generation:  0.0014843940734863281
local_in_edges_tensor generation:  0.0007889270782470703
mini_batch_src_global generation:  0.0008835792541503906
r_  generation:  0.008165359497070312
local_output_nid generation:  0.0014760494232177734
local_in_edges_tensor generation:  0.00075531005859375
mini_batch_src_global generation:  0.00091552734375
r_  generation:  0.008161306381225586
local_output_nid generation:  0.0014781951904296875
local_in_edges_tensor generation:  0.000759124755859375
mini_batch_src_global generation:  0.0009009838104248047
r_  generation:  0.008341312408447266
local_output_nid generation:  0.001476287841796875
local_in_edges_tensor generation:  0.0007596015930175781
mini_batch_src_global generation:  0.000911712646484375
r_  generation:  0.008463144302368164
local_output_nid generation:  0.001463174819946289
local_in_edges_tensor generation:  0.0007760524749755859
mini_batch_src_global generation:  0.0009002685546875
r_  generation:  0.008124589920043945
local_output_nid generation:  0.0014867782592773438
local_in_edges_tensor generation:  0.0008013248443603516
mini_batch_src_global generation:  0.0009720325469970703
r_  generation:  0.009691238403320312
local_output_nid generation:  0.0015172958374023438
local_in_edges_tensor generation:  0.0007824897766113281
mini_batch_src_global generation:  0.0009324550628662109
r_  generation:  0.008265256881713867
local_output_nid generation:  0.001493692398071289
local_in_edges_tensor generation:  0.0007784366607666016
mini_batch_src_global generation:  0.0009355545043945312
r_  generation:  0.00835871696472168
local_output_nid generation:  0.001495361328125
local_in_edges_tensor generation:  0.0007660388946533203
mini_batch_src_global generation:  0.0009162425994873047
r_  generation:  0.008211612701416016
local_output_nid generation:  0.0014908313751220703
local_in_edges_tensor generation:  0.0007548332214355469
mini_batch_src_global generation:  0.0009253025054931641
r_  generation:  0.008334636688232422
local_output_nid generation:  0.001497507095336914
local_in_edges_tensor generation:  0.000774383544921875
mini_batch_src_global generation:  0.0010266304016113281
r_  generation:  0.008572578430175781
local_output_nid generation:  0.0014750957489013672
local_in_edges_tensor generation:  0.0007698535919189453
mini_batch_src_global generation:  0.0008823871612548828
r_  generation:  0.008082866668701172
----------------------check_connections_block total spend ----------------------------- 0.4815983772277832
generate_one_block  0.019780874252319336
generate_one_block  0.017630815505981445
generate_one_block  0.014831781387329102
generate_one_block  0.014678955078125
generate_one_block  0.014642000198364258
generate_one_block  0.0163118839263916
generate_one_block  0.014845609664916992
generate_one_block  0.014304399490356445
generate_one_block  0.014815807342529297
generate_one_block  0.015053987503051758
generate_one_block  0.01464390754699707
generate_one_block  0.014691352844238281
generate_one_block  0.014506816864013672
generate_one_block  0.014456748962402344
generate_one_block  0.014041900634765625
generate_one_block  0.014406681060791016
generate_one_block  0.01470041275024414
generate_one_block  0.014300346374511719
generate_one_block  0.014739751815795898
generate_one_block  0.014227867126464844
generate_one_block  0.014221906661987305
generate_one_block  0.014159440994262695
generate_one_block  0.01747417449951172
generate_one_block  0.015060901641845703
generate_one_block  0.014244794845581055
generate_one_block  0.015256404876708984
generate_one_block  0.014355659484863281
generate_one_block  0.014415502548217773
generate_one_block  0.014355659484863281
generate_one_block  0.014448404312133789
generate_one_block  0.014911890029907227
generate_one_block  0.014150381088256836
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.034041404724121094
gen group dst list time:  0.020856142044067383
time for parepare:  0.02216649055480957
local_output_nid generation:  0.0055370330810546875
local_in_edges_tensor generation:  0.015548944473266602
mini_batch_src_global generation:  0.012767314910888672
r_  generation:  0.12111592292785645
local_output_nid generation:  0.00788736343383789
local_in_edges_tensor generation:  0.00962686538696289
mini_batch_src_global generation:  0.015933990478515625
r_  generation:  0.15324163436889648
local_output_nid generation:  0.007820606231689453
local_in_edges_tensor generation:  0.028026342391967773
mini_batch_src_global generation:  0.013576745986938477
r_  generation:  0.1282639503479004
local_output_nid generation:  0.007905721664428711
local_in_edges_tensor generation:  0.00792074203491211
mini_batch_src_global generation:  0.015477418899536133
r_  generation:  0.12938737869262695
local_output_nid generation:  0.00830221176147461
local_in_edges_tensor generation:  0.009648799896240234
mini_batch_src_global generation:  0.015985727310180664
r_  generation:  0.13604068756103516
local_output_nid generation:  0.008243560791015625
local_in_edges_tensor generation:  0.008486270904541016
mini_batch_src_global generation:  0.016846418380737305
r_  generation:  0.13483071327209473
local_output_nid generation:  0.00839543342590332
local_in_edges_tensor generation:  0.009781360626220703
mini_batch_src_global generation:  0.01885986328125
r_  generation:  0.14321112632751465
local_output_nid generation:  0.008034229278564453
local_in_edges_tensor generation:  0.0073697566986083984
mini_batch_src_global generation:  0.016049623489379883
r_  generation:  0.16663479804992676
local_output_nid generation:  0.007978439331054688
local_in_edges_tensor generation:  0.008073806762695312
mini_batch_src_global generation:  0.018073081970214844
r_  generation:  0.17673826217651367
local_output_nid generation:  0.013339042663574219
local_in_edges_tensor generation:  0.017114877700805664
mini_batch_src_global generation:  0.024709224700927734
r_  generation:  0.14725518226623535
local_output_nid generation:  0.011223554611206055
local_in_edges_tensor generation:  0.008510828018188477
mini_batch_src_global generation:  0.016797304153442383
r_  generation:  0.1473100185394287
local_output_nid generation:  0.009173154830932617
local_in_edges_tensor generation:  0.008533954620361328
mini_batch_src_global generation:  0.016659259796142578
r_  generation:  0.13965630531311035
local_output_nid generation:  0.008987903594970703
local_in_edges_tensor generation:  0.008442401885986328
mini_batch_src_global generation:  0.016726255416870117
r_  generation:  0.14485383033752441
local_output_nid generation:  0.008622169494628906
local_in_edges_tensor generation:  0.00831747055053711
mini_batch_src_global generation:  0.017150163650512695
r_  generation:  0.13954806327819824
local_output_nid generation:  0.00849771499633789
local_in_edges_tensor generation:  0.008868932723999023
mini_batch_src_global generation:  0.01659083366394043
r_  generation:  0.14038681983947754
local_output_nid generation:  0.011690616607666016
local_in_edges_tensor generation:  0.01280665397644043
mini_batch_src_global generation:  0.016550064086914062
r_  generation:  0.13819050788879395
local_output_nid generation:  0.008425235748291016
local_in_edges_tensor generation:  0.011401891708374023
mini_batch_src_global generation:  0.017104148864746094
r_  generation:  0.14421415328979492
local_output_nid generation:  0.008216142654418945
local_in_edges_tensor generation:  0.01009058952331543
mini_batch_src_global generation:  0.016455411911010742
r_  generation:  0.14502501487731934
local_output_nid generation:  0.010286331176757812
local_in_edges_tensor generation:  0.008687973022460938
mini_batch_src_global generation:  0.016980648040771484
r_  generation:  0.14280486106872559
local_output_nid generation:  0.008307218551635742
local_in_edges_tensor generation:  0.0075800418853759766
mini_batch_src_global generation:  0.01658034324645996
r_  generation:  0.1364426612854004
local_output_nid generation:  0.008287906646728516
local_in_edges_tensor generation:  0.0075893402099609375
mini_batch_src_global generation:  0.01567363739013672
r_  generation:  0.1393277645111084
local_output_nid generation:  0.008340835571289062
local_in_edges_tensor generation:  0.007482290267944336
mini_batch_src_global generation:  0.016638994216918945
r_  generation:  0.13572192192077637
local_output_nid generation:  0.00842738151550293
local_in_edges_tensor generation:  0.007645606994628906
mini_batch_src_global generation:  0.016833782196044922
r_  generation:  0.14113974571228027
local_output_nid generation:  0.008441925048828125
local_in_edges_tensor generation:  0.009270668029785156
mini_batch_src_global generation:  0.017874717712402344
r_  generation:  0.13961029052734375
local_output_nid generation:  0.00821065902709961
local_in_edges_tensor generation:  0.007998228073120117
mini_batch_src_global generation:  0.015579462051391602
r_  generation:  0.13623952865600586
local_output_nid generation:  0.008693695068359375
local_in_edges_tensor generation:  0.007927179336547852
mini_batch_src_global generation:  0.017129182815551758
r_  generation:  0.14298319816589355
local_output_nid generation:  0.008384466171264648
local_in_edges_tensor generation:  0.00748133659362793
mini_batch_src_global generation:  0.01597428321838379
r_  generation:  0.1401381492614746
local_output_nid generation:  0.008370161056518555
local_in_edges_tensor generation:  0.0076503753662109375
mini_batch_src_global generation:  0.01639842987060547
r_  generation:  0.14080357551574707
local_output_nid generation:  0.008760690689086914
local_in_edges_tensor generation:  0.0081024169921875
mini_batch_src_global generation:  0.015967607498168945
r_  generation:  0.1400461196899414
local_output_nid generation:  0.008466958999633789
local_in_edges_tensor generation:  0.008545398712158203
mini_batch_src_global generation:  0.016822099685668945
r_  generation:  0.13786625862121582
local_output_nid generation:  0.008630514144897461
local_in_edges_tensor generation:  0.009323835372924805
mini_batch_src_global generation:  0.017071008682250977
r_  generation:  0.14465904235839844
local_output_nid generation:  0.008252859115600586
local_in_edges_tensor generation:  0.007489681243896484
mini_batch_src_global generation:  0.01636672019958496
r_  generation:  0.13512659072875977
----------------------check_connections_block total spend ----------------------------- 6.718696117401123
generate_one_block  0.1756751537322998
generate_one_block  0.17258095741271973
generate_one_block  0.1706831455230713
generate_one_block  0.17567777633666992
generate_one_block  0.19347620010375977
generate_one_block  0.17693090438842773
generate_one_block  0.18514370918273926
generate_one_block  0.17723441123962402
generate_one_block  0.20178794860839844
generate_one_block  0.18814492225646973
generate_one_block  0.18118596076965332
generate_one_block  0.17572474479675293
generate_one_block  0.178511381149292
generate_one_block  0.17635846138000488
generate_one_block  0.17013192176818848
generate_one_block  0.17491888999938965
generate_one_block  0.1785435676574707
generate_one_block  0.17630696296691895
generate_one_block  0.18082594871520996
generate_one_block  0.18273544311523438
generate_one_block  0.1760265827178955
generate_one_block  0.17894721031188965
generate_one_block  0.1813955307006836
generate_one_block  0.1826326847076416
generate_one_block  0.17309236526489258
generate_one_block  0.18731307983398438
generate_one_block  0.17841482162475586
generate_one_block  0.17804956436157227
generate_one_block  0.1788783073425293
generate_one_block  0.18374204635620117
generate_one_block  0.1843552589416504
generate_one_block  0.17286348342895508
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03416323661804199
gen group dst list time:  0.10379362106323242
time for parepare:  0.020539045333862305
local_output_nid generation:  0.02364802360534668
local_in_edges_tensor generation:  0.050034284591674805
mini_batch_src_global generation:  0.03757309913635254
r_  generation:  0.3914332389831543
local_output_nid generation:  0.030310869216918945
local_in_edges_tensor generation:  0.032613515853881836
mini_batch_src_global generation:  0.04962301254272461
r_  generation:  0.41101932525634766
local_output_nid generation:  0.03179144859313965
local_in_edges_tensor generation:  0.025502920150756836
mini_batch_src_global generation:  0.047933101654052734
r_  generation:  0.3983755111694336
local_output_nid generation:  0.030314922332763672
local_in_edges_tensor generation:  0.027413368225097656
mini_batch_src_global generation:  0.04887795448303223
r_  generation:  0.3962225914001465
local_output_nid generation:  0.03007054328918457
local_in_edges_tensor generation:  0.02825140953063965
mini_batch_src_global generation:  0.04674172401428223
r_  generation:  0.406463623046875
local_output_nid generation:  0.02880120277404785
local_in_edges_tensor generation:  0.025351762771606445
mini_batch_src_global generation:  0.04785013198852539
r_  generation:  0.3976106643676758
local_output_nid generation:  0.028150081634521484
local_in_edges_tensor generation:  0.027849912643432617
mini_batch_src_global generation:  0.04847455024719238
r_  generation:  0.4102671146392822
local_output_nid generation:  0.02772808074951172
local_in_edges_tensor generation:  0.02618408203125
mini_batch_src_global generation:  0.04787802696228027
r_  generation:  0.3959376811981201
local_output_nid generation:  0.027916908264160156
local_in_edges_tensor generation:  0.02560281753540039
mini_batch_src_global generation:  0.048235177993774414
r_  generation:  0.40709853172302246
local_output_nid generation:  0.028409719467163086
local_in_edges_tensor generation:  0.030541658401489258
mini_batch_src_global generation:  0.05019330978393555
r_  generation:  0.40709614753723145
local_output_nid generation:  0.02823042869567871
local_in_edges_tensor generation:  0.027942895889282227
mini_batch_src_global generation:  0.048038482666015625
r_  generation:  0.41091418266296387
local_output_nid generation:  0.02790689468383789
local_in_edges_tensor generation:  0.02496790885925293
mini_batch_src_global generation:  0.047942399978637695
r_  generation:  0.39844393730163574
local_output_nid generation:  0.02810978889465332
local_in_edges_tensor generation:  0.025609254837036133
mini_batch_src_global generation:  0.04705381393432617
r_  generation:  0.4093019962310791
local_output_nid generation:  0.027914047241210938
local_in_edges_tensor generation:  0.026690244674682617
mini_batch_src_global generation:  0.0475766658782959
r_  generation:  0.4011387825012207
local_output_nid generation:  0.02785778045654297
local_in_edges_tensor generation:  0.02842545509338379
mini_batch_src_global generation:  0.045845985412597656
r_  generation:  0.40816450119018555
local_output_nid generation:  0.029605865478515625
local_in_edges_tensor generation:  0.028596878051757812
mini_batch_src_global generation:  0.04717230796813965
r_  generation:  0.4002549648284912
local_output_nid generation:  0.028327465057373047
local_in_edges_tensor generation:  0.027085304260253906
mini_batch_src_global generation:  0.04679250717163086
r_  generation:  0.4090745449066162
local_output_nid generation:  0.028257131576538086
local_in_edges_tensor generation:  0.030663251876831055
mini_batch_src_global generation:  0.04740738868713379
r_  generation:  0.4007542133331299
local_output_nid generation:  0.028473854064941406
local_in_edges_tensor generation:  0.02706432342529297
mini_batch_src_global generation:  0.04835343360900879
r_  generation:  0.4119753837585449
local_output_nid generation:  0.0280606746673584
local_in_edges_tensor generation:  0.02830219268798828
mini_batch_src_global generation:  0.04974055290222168
r_  generation:  0.40149927139282227
local_output_nid generation:  0.027921438217163086
local_in_edges_tensor generation:  0.02490854263305664
mini_batch_src_global generation:  0.04797196388244629
r_  generation:  0.40718770027160645
local_output_nid generation:  0.027991771697998047
local_in_edges_tensor generation:  0.026929855346679688
mini_batch_src_global generation:  0.04823946952819824
r_  generation:  0.4070131778717041
local_output_nid generation:  0.02912163734436035
local_in_edges_tensor generation:  0.028064250946044922
mini_batch_src_global generation:  0.04704475402832031
r_  generation:  0.410477876663208
local_output_nid generation:  0.02866363525390625
local_in_edges_tensor generation:  0.029187917709350586
mini_batch_src_global generation:  0.04855799674987793
r_  generation:  0.4161643981933594
local_output_nid generation:  0.028969764709472656
local_in_edges_tensor generation:  0.025036096572875977
mini_batch_src_global generation:  0.04796242713928223
r_  generation:  0.4058983325958252
local_output_nid generation:  0.028136253356933594
local_in_edges_tensor generation:  0.02649092674255371
mini_batch_src_global generation:  0.04788684844970703
r_  generation:  0.4097871780395508
local_output_nid generation:  0.02790236473083496
local_in_edges_tensor generation:  0.027392864227294922
mini_batch_src_global generation:  0.04683709144592285
r_  generation:  0.4065852165222168
local_output_nid generation:  0.02791619300842285
local_in_edges_tensor generation:  0.027025461196899414
mini_batch_src_global generation:  0.04766964912414551
r_  generation:  0.39979076385498047
local_output_nid generation:  0.02811121940612793
local_in_edges_tensor generation:  0.02511000633239746
mini_batch_src_global generation:  0.0463559627532959
r_  generation:  0.40853452682495117
local_output_nid generation:  0.028261899948120117
local_in_edges_tensor generation:  0.029473066329956055
mini_batch_src_global generation:  0.04778933525085449
r_  generation:  0.4026801586151123
local_output_nid generation:  0.02858138084411621
local_in_edges_tensor generation:  0.028645753860473633
mini_batch_src_global generation:  0.049269676208496094
r_  generation:  0.412111759185791
local_output_nid generation:  0.027944326400756836
local_in_edges_tensor generation:  0.0252685546875
mini_batch_src_global generation:  0.04719686508178711
r_  generation:  0.39998650550842285
----------------------check_connections_block total spend ----------------------------- 19.182365894317627
generate_one_block  0.540212869644165
generate_one_block  0.5278313159942627
generate_one_block  0.5315852165222168
generate_one_block  0.5369269847869873
generate_one_block  0.6355741024017334
generate_one_block  0.5305390357971191
generate_one_block  0.5417788028717041
generate_one_block  0.527653694152832
generate_one_block  0.5311453342437744
generate_one_block  0.5476765632629395
generate_one_block  0.5417001247406006
generate_one_block  0.5339069366455078
generate_one_block  0.5397548675537109
generate_one_block  0.531386137008667
generate_one_block  0.5319445133209229
generate_one_block  0.5365097522735596
generate_one_block  0.536698579788208
generate_one_block  0.5282726287841797
generate_one_block  0.543670654296875
generate_one_block  0.5355145931243896
generate_one_block  0.5347485542297363
generate_one_block  0.5391349792480469
generate_one_block  0.5462591648101807
generate_one_block  0.5396475791931152
generate_one_block  0.5410432815551758
generate_one_block  0.5420968532562256
generate_one_block  0.5343348979949951
generate_one_block  0.5371015071868896
generate_one_block  0.529778242111206
generate_one_block  0.5394408702850342
generate_one_block  0.5522208213806152
generate_one_block  0.5296592712402344
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.11970710754394531  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

connection checking time:  25.90106201171875
block generation total time  23.024038076400757
average batch blocks generation time:  0.7195011898875237
block dataloader generation time/epoch 51.70126854456388
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10285663604736328  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.443582534790039  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10294008255004883  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.521078109741211  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1038217544555664  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.477388381958008  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10301589965820312  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.601031303405762  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10500764846801758  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.811446189880371  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10281229019165039  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.601150512695312  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10387802124023438  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.984139442443848  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1027064323425293  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.45643949508667  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10287761688232422  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.715933322906494  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10430383682250977  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.15473175048828  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10503768920898438  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.96123218536377  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10295438766479492  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.669276237487793  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10501241683959961  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.845623016357422  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10290288925170898  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.633371829986572  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10384941101074219  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.514203071594238  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10285234451293945  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.583998203277588  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10501670837402344  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.817812442779541  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10284709930419922  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.541402339935303  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10503435134887695  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.914284229278564  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1029973030090332  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.550958156585693  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10274600982666016  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.608331680297852  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10291767120361328  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.689404010772705  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10391998291015625  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.769652843475342  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10418891906738281  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.990857601165771  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10256147384643555  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.335229873657227  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10414409637451172  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.111667156219482  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10396766662597656  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.688302993774414  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10294103622436523  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.618806838989258  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10271310806274414  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.543313026428223  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10429048538208008  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.818394660949707  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10505533218383789  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.07064151763916  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10256767272949219  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.462750434875488  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03262005001306534 |0.010841213166713715 |0.27092163264751434 |9.386241436004639e-05 |0.4298720359802246 |0.0047149658203125 |
----------------------------------------------------------pseudo_mini_loss sum 1.3080024719238281
Total (block generation + training)time/epoch 75.52659810506381
Training time/epoch 23.87830877304077
Training time without block to device /epoch 23.531389951705933
Training time without total dataloading part /epoch 22.43311595916748
load block tensor time/epoch 1.0438416004180908
block to device time/epoch 0.34691882133483887
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 22 |
Number of nodes for computation during this epoch:  8576488
Number of first layer input nodes during this epoch:  4653720
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.11978483200073242  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02520918846130371
random selection method range initialization spend 0.006802558898925781
time for parepare:  0.024425029754638672
local_output_nid generation:  0.0018315315246582031
local_in_edges_tensor generation:  0.006532430648803711
mini_batch_src_global generation:  0.0018897056579589844
r_  generation:  0.008081674575805664
local_output_nid generation:  0.0018150806427001953
local_in_edges_tensor generation:  0.0012056827545166016
mini_batch_src_global generation:  0.0016379356384277344
r_  generation:  0.008896350860595703
local_output_nid generation:  0.0018725395202636719
local_in_edges_tensor generation:  0.0011129379272460938
mini_batch_src_global generation:  0.0012776851654052734
r_  generation:  0.008377313613891602
local_output_nid generation:  0.0019190311431884766
local_in_edges_tensor generation:  0.0010976791381835938
mini_batch_src_global generation:  0.001220703125
r_  generation:  0.008355140686035156
local_output_nid generation:  0.001936197280883789
local_in_edges_tensor generation:  0.0010573863983154297
mini_batch_src_global generation:  0.001132965087890625
r_  generation:  0.012757062911987305
local_output_nid generation:  0.0035572052001953125
local_in_edges_tensor generation:  0.0016946792602539062
mini_batch_src_global generation:  0.0023338794708251953
r_  generation:  0.011422395706176758
local_output_nid generation:  0.002177715301513672
local_in_edges_tensor generation:  0.001016378402709961
mini_batch_src_global generation:  0.0011396408081054688
r_  generation:  0.008097648620605469
local_output_nid generation:  0.0020155906677246094
local_in_edges_tensor generation:  0.0009400844573974609
mini_batch_src_global generation:  0.0010001659393310547
r_  generation:  0.008287668228149414
local_output_nid generation:  0.0019249916076660156
local_in_edges_tensor generation:  0.0009071826934814453
mini_batch_src_global generation:  0.0009694099426269531
r_  generation:  0.008228778839111328
local_output_nid generation:  0.0018486976623535156
local_in_edges_tensor generation:  0.000843048095703125
mini_batch_src_global generation:  0.0009124279022216797
r_  generation:  0.008089303970336914
local_output_nid generation:  0.0018177032470703125
local_in_edges_tensor generation:  0.0008406639099121094
mini_batch_src_global generation:  0.0009071826934814453
r_  generation:  0.008295059204101562
local_output_nid generation:  0.0017774105072021484
local_in_edges_tensor generation:  0.0008642673492431641
mini_batch_src_global generation:  0.0009534358978271484
r_  generation:  0.008454322814941406
local_output_nid generation:  0.0017592906951904297
local_in_edges_tensor generation:  0.0008120536804199219
mini_batch_src_global generation:  0.0009031295776367188
r_  generation:  0.008263111114501953
local_output_nid generation:  0.001695394515991211
local_in_edges_tensor generation:  0.0008053779602050781
mini_batch_src_global generation:  0.0008988380432128906
r_  generation:  0.008104324340820312
local_output_nid generation:  0.00170135498046875
local_in_edges_tensor generation:  0.0007960796356201172
mini_batch_src_global generation:  0.0008800029754638672
r_  generation:  0.008031606674194336
local_output_nid generation:  0.0016658306121826172
local_in_edges_tensor generation:  0.0008130073547363281
mini_batch_src_global generation:  0.0008955001831054688
r_  generation:  0.008316755294799805
local_output_nid generation:  0.0016460418701171875
local_in_edges_tensor generation:  0.0007872581481933594
mini_batch_src_global generation:  0.0008876323699951172
r_  generation:  0.008325576782226562
local_output_nid generation:  0.0016217231750488281
local_in_edges_tensor generation:  0.0007855892181396484
mini_batch_src_global generation:  0.0009503364562988281
r_  generation:  0.008675336837768555
local_output_nid generation:  0.0016202926635742188
local_in_edges_tensor generation:  0.0007624626159667969
mini_batch_src_global generation:  0.0008914470672607422
r_  generation:  0.008197784423828125
local_output_nid generation:  0.0016019344329833984
local_in_edges_tensor generation:  0.0007824897766113281
mini_batch_src_global generation:  0.0010089874267578125
r_  generation:  0.008623600006103516
local_output_nid generation:  0.0015728473663330078
local_in_edges_tensor generation:  0.0007779598236083984
mini_batch_src_global generation:  0.0009119510650634766
r_  generation:  0.00858163833618164
local_output_nid generation:  0.0015621185302734375
local_in_edges_tensor generation:  0.0007927417755126953
mini_batch_src_global generation:  0.0008931159973144531
r_  generation:  0.00851297378540039
local_output_nid generation:  0.0015363693237304688
local_in_edges_tensor generation:  0.0007739067077636719
mini_batch_src_global generation:  0.0009188652038574219
r_  generation:  0.008359432220458984
local_output_nid generation:  0.0015251636505126953
local_in_edges_tensor generation:  0.0007815361022949219
mini_batch_src_global generation:  0.0008873939514160156
r_  generation:  0.008250951766967773
local_output_nid generation:  0.001504659652709961
local_in_edges_tensor generation:  0.0007588863372802734
mini_batch_src_global generation:  0.0008914470672607422
r_  generation:  0.00831913948059082
local_output_nid generation:  0.001505136489868164
local_in_edges_tensor generation:  0.0007538795471191406
mini_batch_src_global generation:  0.0008728504180908203
r_  generation:  0.008215188980102539
local_output_nid generation:  0.0014996528625488281
local_in_edges_tensor generation:  0.0007686614990234375
mini_batch_src_global generation:  0.0009129047393798828
r_  generation:  0.00855875015258789
local_output_nid generation:  0.0014777183532714844
local_in_edges_tensor generation:  0.0007512569427490234
mini_batch_src_global generation:  0.0008935928344726562
r_  generation:  0.008197307586669922
local_output_nid generation:  0.0014653205871582031
local_in_edges_tensor generation:  0.0007636547088623047
mini_batch_src_global generation:  0.0008723735809326172
r_  generation:  0.008131265640258789
local_output_nid generation:  0.0014495849609375
local_in_edges_tensor generation:  0.0007777214050292969
mini_batch_src_global generation:  0.0009279251098632812
r_  generation:  0.008704423904418945
local_output_nid generation:  0.0014655590057373047
local_in_edges_tensor generation:  0.0007460117340087891
mini_batch_src_global generation:  0.0008912086486816406
r_  generation:  0.008112668991088867
local_output_nid generation:  0.0014557838439941406
local_in_edges_tensor generation:  0.0007731914520263672
mini_batch_src_global generation:  0.0008890628814697266
r_  generation:  0.008354425430297852
----------------------check_connections_block total spend ----------------------------- 0.5096843242645264
generate_one_block  0.01627039909362793
generate_one_block  0.017396211624145508
generate_one_block  0.015496969223022461
generate_one_block  0.014925479888916016
generate_one_block  0.014636516571044922
generate_one_block  0.014433860778808594
generate_one_block  0.014484882354736328
generate_one_block  0.01459503173828125
generate_one_block  0.014548778533935547
generate_one_block  0.01415562629699707
generate_one_block  0.01450037956237793
generate_one_block  0.015060186386108398
generate_one_block  0.014564275741577148
generate_one_block  0.014280319213867188
generate_one_block  0.014230489730834961
generate_one_block  0.014503002166748047
generate_one_block  0.014560461044311523
generate_one_block  0.01488947868347168
generate_one_block  0.014417409896850586
generate_one_block  0.014737367630004883
generate_one_block  0.014812707901000977
generate_one_block  0.014658451080322266
generate_one_block  0.017759323120117188
generate_one_block  0.01472783088684082
generate_one_block  0.01470494270324707
generate_one_block  0.016595125198364258
generate_one_block  0.014913558959960938
generate_one_block  0.014215707778930664
generate_one_block  0.014134407043457031
generate_one_block  0.014911413192749023
generate_one_block  0.014149904251098633
generate_one_block  0.01452326774597168
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04670405387878418
gen group dst list time:  0.020667552947998047
time for parepare:  0.019565820693969727
local_output_nid generation:  0.005223751068115234
local_in_edges_tensor generation:  0.014867305755615234
mini_batch_src_global generation:  0.01299285888671875
r_  generation:  0.12732958793640137
local_output_nid generation:  0.009793281555175781
local_in_edges_tensor generation:  0.009571075439453125
mini_batch_src_global generation:  0.015889883041381836
r_  generation:  0.12643218040466309
local_output_nid generation:  0.008254289627075195
local_in_edges_tensor generation:  0.034610748291015625
mini_batch_src_global generation:  0.01472783088684082
r_  generation:  0.13512182235717773
local_output_nid generation:  0.008103370666503906
local_in_edges_tensor generation:  0.009773015975952148
mini_batch_src_global generation:  0.015410423278808594
r_  generation:  0.1633615493774414
local_output_nid generation:  0.013386011123657227
local_in_edges_tensor generation:  0.010780096054077148
mini_batch_src_global generation:  0.018378734588623047
r_  generation:  0.16168618202209473
local_output_nid generation:  0.011504173278808594
local_in_edges_tensor generation:  0.009343385696411133
mini_batch_src_global generation:  0.01759648323059082
r_  generation:  0.13465166091918945
local_output_nid generation:  0.008882761001586914
local_in_edges_tensor generation:  0.007680654525756836
mini_batch_src_global generation:  0.015601634979248047
r_  generation:  0.13483524322509766
local_output_nid generation:  0.008521080017089844
local_in_edges_tensor generation:  0.007774829864501953
mini_batch_src_global generation:  0.01738739013671875
r_  generation:  0.13718056678771973
local_output_nid generation:  0.008144617080688477
local_in_edges_tensor generation:  0.00759577751159668
mini_batch_src_global generation:  0.016048669815063477
r_  generation:  0.13638544082641602
local_output_nid generation:  0.007807493209838867
local_in_edges_tensor generation:  0.00806117057800293
mini_batch_src_global generation:  0.01610279083251953
r_  generation:  0.13112974166870117
local_output_nid generation:  0.008309125900268555
local_in_edges_tensor generation:  0.0076084136962890625
mini_batch_src_global generation:  0.016154766082763672
r_  generation:  0.13905715942382812
local_output_nid generation:  0.00840139389038086
local_in_edges_tensor generation:  0.009138345718383789
mini_batch_src_global generation:  0.016747713088989258
r_  generation:  0.1378040313720703
local_output_nid generation:  0.008367538452148438
local_in_edges_tensor generation:  0.008004903793334961
mini_batch_src_global generation:  0.016305923461914062
r_  generation:  0.14175128936767578
local_output_nid generation:  0.008279561996459961
local_in_edges_tensor generation:  0.0074536800384521484
mini_batch_src_global generation:  0.016713380813598633
r_  generation:  0.13657855987548828
local_output_nid generation:  0.008192062377929688
local_in_edges_tensor generation:  0.007432460784912109
mini_batch_src_global generation:  0.015691518783569336
r_  generation:  0.13756108283996582
local_output_nid generation:  0.008381128311157227
local_in_edges_tensor generation:  0.00890660285949707
mini_batch_src_global generation:  0.01737046241760254
r_  generation:  0.13918423652648926
local_output_nid generation:  0.008210420608520508
local_in_edges_tensor generation:  0.008936643600463867
mini_batch_src_global generation:  0.017518281936645508
r_  generation:  0.1393117904663086
local_output_nid generation:  0.008473873138427734
local_in_edges_tensor generation:  0.00814509391784668
mini_batch_src_global generation:  0.01847076416015625
r_  generation:  0.14217448234558105
local_output_nid generation:  0.008232593536376953
local_in_edges_tensor generation:  0.008032560348510742
mini_batch_src_global generation:  0.0186920166015625
r_  generation:  0.13868951797485352
local_output_nid generation:  0.008242607116699219
local_in_edges_tensor generation:  0.008177995681762695
mini_batch_src_global generation:  0.016824007034301758
r_  generation:  0.13856196403503418
local_output_nid generation:  0.008405447006225586
local_in_edges_tensor generation:  0.00812983512878418
mini_batch_src_global generation:  0.02092599868774414
r_  generation:  0.1400129795074463
local_output_nid generation:  0.008434057235717773
local_in_edges_tensor generation:  0.008018970489501953
mini_batch_src_global generation:  0.01665043830871582
r_  generation:  0.13847994804382324
local_output_nid generation:  0.008403539657592773
local_in_edges_tensor generation:  0.008115530014038086
mini_batch_src_global generation:  0.016285419464111328
r_  generation:  0.14033222198486328
local_output_nid generation:  0.008209943771362305
local_in_edges_tensor generation:  0.007944822311401367
mini_batch_src_global generation:  0.01662588119506836
r_  generation:  0.13840889930725098
local_output_nid generation:  0.008434295654296875
local_in_edges_tensor generation:  0.008091211318969727
mini_batch_src_global generation:  0.016030311584472656
r_  generation:  0.14122557640075684
local_output_nid generation:  0.0081634521484375
local_in_edges_tensor generation:  0.007869482040405273
mini_batch_src_global generation:  0.01646876335144043
r_  generation:  0.13758063316345215
local_output_nid generation:  0.008470535278320312
local_in_edges_tensor generation:  0.008172750473022461
mini_batch_src_global generation:  0.016350746154785156
r_  generation:  0.1417522430419922
local_output_nid generation:  0.008230447769165039
local_in_edges_tensor generation:  0.007992744445800781
mini_batch_src_global generation:  0.016834020614624023
r_  generation:  0.14487195014953613
local_output_nid generation:  0.008322477340698242
local_in_edges_tensor generation:  0.009365558624267578
mini_batch_src_global generation:  0.016931772232055664
r_  generation:  0.13643836975097656
local_output_nid generation:  0.008549690246582031
local_in_edges_tensor generation:  0.008395910263061523
mini_batch_src_global generation:  0.01702117919921875
r_  generation:  0.14227628707885742
local_output_nid generation:  0.008254051208496094
local_in_edges_tensor generation:  0.008013248443603516
mini_batch_src_global generation:  0.015937089920043945
r_  generation:  0.137803316116333
local_output_nid generation:  0.008303403854370117
local_in_edges_tensor generation:  0.008184194564819336
mini_batch_src_global generation:  0.01732158660888672
r_  generation:  0.13947081565856934
----------------------check_connections_block total spend ----------------------------- 6.635663986206055
generate_one_block  0.17903661727905273
generate_one_block  0.17233848571777344
generate_one_block  0.18049979209899902
generate_one_block  0.17953276634216309
generate_one_block  0.1879422664642334
generate_one_block  0.17607855796813965
generate_one_block  0.1795058250427246
generate_one_block  0.1836075782775879
generate_one_block  0.18173003196716309
generate_one_block  0.17928099632263184
generate_one_block  0.18168306350708008
generate_one_block  0.1845548152923584
generate_one_block  0.18016839027404785
generate_one_block  0.17985272407531738
generate_one_block  0.1706695556640625
generate_one_block  0.1794145107269287
generate_one_block  0.1771376132965088
generate_one_block  0.1834120750427246
generate_one_block  0.17673540115356445
generate_one_block  0.18368053436279297
generate_one_block  0.18021583557128906
generate_one_block  0.17628765106201172
generate_one_block  0.18050909042358398
generate_one_block  0.17656636238098145
generate_one_block  0.17813396453857422
generate_one_block  0.18263649940490723
generate_one_block  0.18134474754333496
generate_one_block  0.19390487670898438
generate_one_block  0.17041969299316406
generate_one_block  0.18367338180541992
generate_one_block  0.17313623428344727
generate_one_block  0.17618465423583984
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.035028934478759766
gen group dst list time:  0.10239243507385254
time for parepare:  0.02081918716430664
local_output_nid generation:  0.023339509963989258
local_in_edges_tensor generation:  0.04397988319396973
mini_batch_src_global generation:  0.03640627861022949
r_  generation:  0.386080265045166
local_output_nid generation:  0.028450489044189453
local_in_edges_tensor generation:  0.03144645690917969
mini_batch_src_global generation:  0.046086788177490234
r_  generation:  0.39080333709716797
local_output_nid generation:  0.031223535537719727
local_in_edges_tensor generation:  0.028708457946777344
mini_batch_src_global generation:  0.04559135437011719
r_  generation:  0.40787482261657715
local_output_nid generation:  0.02882838249206543
local_in_edges_tensor generation:  0.03066539764404297
mini_batch_src_global generation:  0.04672861099243164
r_  generation:  0.40175580978393555
local_output_nid generation:  0.029233932495117188
local_in_edges_tensor generation:  0.03320765495300293
mini_batch_src_global generation:  0.0470736026763916
r_  generation:  0.4107398986816406
local_output_nid generation:  0.028643131256103516
local_in_edges_tensor generation:  0.026882410049438477
mini_batch_src_global generation:  0.049294471740722656
r_  generation:  0.4075140953063965
local_output_nid generation:  0.027103662490844727
local_in_edges_tensor generation:  0.028368234634399414
mini_batch_src_global generation:  0.045975685119628906
r_  generation:  0.40836191177368164
local_output_nid generation:  0.027600526809692383
local_in_edges_tensor generation:  0.029205322265625
mini_batch_src_global generation:  0.05074191093444824
r_  generation:  0.41748571395874023
local_output_nid generation:  0.029847383499145508
local_in_edges_tensor generation:  0.026583194732666016
mini_batch_src_global generation:  0.047044992446899414
r_  generation:  0.40396857261657715
local_output_nid generation:  0.02752685546875
local_in_edges_tensor generation:  0.024941205978393555
mini_batch_src_global generation:  0.048079490661621094
r_  generation:  0.39806056022644043
local_output_nid generation:  0.027972698211669922
local_in_edges_tensor generation:  0.03129076957702637
mini_batch_src_global generation:  0.04916787147521973
r_  generation:  0.4063575267791748
local_output_nid generation:  0.028236865997314453
local_in_edges_tensor generation:  0.02712082862854004
mini_batch_src_global generation:  0.05067253112792969
r_  generation:  0.4129040241241455
local_output_nid generation:  0.028071880340576172
local_in_edges_tensor generation:  0.02834010124206543
mini_batch_src_global generation:  0.0472722053527832
r_  generation:  0.4195713996887207
local_output_nid generation:  0.02771162986755371
local_in_edges_tensor generation:  0.025275707244873047
mini_batch_src_global generation:  0.04842329025268555
r_  generation:  0.3966512680053711
local_output_nid generation:  0.0277101993560791
local_in_edges_tensor generation:  0.029977798461914062
mini_batch_src_global generation:  0.04700016975402832
r_  generation:  0.4037601947784424
local_output_nid generation:  0.027804136276245117
local_in_edges_tensor generation:  0.024702787399291992
mini_batch_src_global generation:  0.0477907657623291
r_  generation:  0.39843130111694336
local_output_nid generation:  0.029491424560546875
local_in_edges_tensor generation:  0.027027368545532227
mini_batch_src_global generation:  0.04667782783508301
r_  generation:  0.4050405025482178
local_output_nid generation:  0.027970314025878906
local_in_edges_tensor generation:  0.028513669967651367
mini_batch_src_global generation:  0.050299882888793945
r_  generation:  0.4031553268432617
local_output_nid generation:  0.02796006202697754
local_in_edges_tensor generation:  0.03094315528869629
mini_batch_src_global generation:  0.04768633842468262
r_  generation:  0.40990781784057617
local_output_nid generation:  0.02809429168701172
local_in_edges_tensor generation:  0.027209758758544922
mini_batch_src_global generation:  0.048139095306396484
r_  generation:  0.40392637252807617
local_output_nid generation:  0.027895450592041016
local_in_edges_tensor generation:  0.026659011840820312
mini_batch_src_global generation:  0.04870319366455078
r_  generation:  0.40593791007995605
local_output_nid generation:  0.02789592742919922
local_in_edges_tensor generation:  0.027261972427368164
mini_batch_src_global generation:  0.04788088798522949
r_  generation:  0.40067625045776367
local_output_nid generation:  0.028244733810424805
local_in_edges_tensor generation:  0.027462005615234375
mini_batch_src_global generation:  0.04926300048828125
r_  generation:  0.4110143184661865
local_output_nid generation:  0.027814388275146484
local_in_edges_tensor generation:  0.02822256088256836
mini_batch_src_global generation:  0.04834771156311035
r_  generation:  0.4031953811645508
local_output_nid generation:  0.02800583839416504
local_in_edges_tensor generation:  0.02866673469543457
mini_batch_src_global generation:  0.047518014907836914
r_  generation:  0.4187147617340088
local_output_nid generation:  0.029769420623779297
local_in_edges_tensor generation:  0.025390625
mini_batch_src_global generation:  0.04811501502990723
r_  generation:  0.40869903564453125
local_output_nid generation:  0.027895450592041016
local_in_edges_tensor generation:  0.028763532638549805
mini_batch_src_global generation:  0.04756331443786621
r_  generation:  0.4076080322265625
local_output_nid generation:  0.027866363525390625
local_in_edges_tensor generation:  0.02509593963623047
mini_batch_src_global generation:  0.04874467849731445
r_  generation:  0.399066686630249
local_output_nid generation:  0.027696847915649414
local_in_edges_tensor generation:  0.02925419807434082
mini_batch_src_global generation:  0.04743170738220215
r_  generation:  0.40191221237182617
local_output_nid generation:  0.027815818786621094
local_in_edges_tensor generation:  0.024912118911743164
mini_batch_src_global generation:  0.04853010177612305
r_  generation:  0.40546250343322754
local_output_nid generation:  0.027817964553833008
local_in_edges_tensor generation:  0.027884483337402344
mini_batch_src_global generation:  0.04685497283935547
r_  generation:  0.4184110164642334
local_output_nid generation:  0.027912139892578125
local_in_edges_tensor generation:  0.02686166763305664
mini_batch_src_global generation:  0.04979705810546875
r_  generation:  0.4049346446990967
----------------------check_connections_block total spend ----------------------------- 19.220428228378296
generate_one_block  0.542468786239624
generate_one_block  0.5323565006256104
generate_one_block  0.5309302806854248
generate_one_block  0.5353360176086426
generate_one_block  0.6349484920501709
generate_one_block  0.5391995906829834
generate_one_block  0.5303499698638916
generate_one_block  0.5422694683074951
generate_one_block  0.5311267375946045
generate_one_block  0.5238728523254395
generate_one_block  0.5412387847900391
generate_one_block  0.5393214225769043
generate_one_block  0.5395529270172119
generate_one_block  0.5313396453857422
generate_one_block  0.5273318290710449
generate_one_block  0.5299263000488281
generate_one_block  0.5341305732727051
generate_one_block  0.5395421981811523
generate_one_block  0.5345489978790283
generate_one_block  0.537273645401001
generate_one_block  0.5334157943725586
generate_one_block  0.5320901870727539
generate_one_block  0.5438418388366699
generate_one_block  0.5457944869995117
generate_one_block  0.5433328151702881
generate_one_block  0.5351345539093018
generate_one_block  0.5407874584197998
generate_one_block  0.5287754535675049
generate_one_block  0.5322144031524658
generate_one_block  0.5440242290496826
generate_one_block  0.531754732131958
generate_one_block  0.5458996295928955
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.11978483200073242  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

connection checking time:  25.85609221458435
block generation total time  23.004005193710327
average batch blocks generation time:  0.7188751623034477
block dataloader generation time/epoch 51.68434090273721
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10271835327148438  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.363615989685059  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10268545150756836  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.530442714691162  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10404109954833984  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.841992378234863  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10286378860473633  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.810765266418457  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10397911071777344  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.713299751281738  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10409927368164062  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.785175323486328  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10279321670532227  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.612564086914062  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10442161560058594  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.966432571411133  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10392379760742188  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.618422031402588  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.102630615234375  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.393103122711182  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1050114631652832  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.841986179351807  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10436725616455078  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.926280498504639  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10500097274780273  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.796617984771729  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10266828536987305  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.536431312561035  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10263681411743164  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.468162536621094  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1029052734375  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.720218181610107  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10281658172607422  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.654613494873047  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10400962829589844  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.980534076690674  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10298395156860352  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.69182538986206  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10300540924072266  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.734210968017578  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10402870178222656  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.794302940368652  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10309123992919922  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.687166213989258  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10501956939697266  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.875808715820312  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10289192199707031  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.703419208526611  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1029820442199707  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.699121952056885  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10286140441894531  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.688491821289062  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10403203964233398  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.848638534545898  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10289621353149414  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.728596687316895  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10276269912719727  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.471127986907959  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10415935516357422  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.066933631896973  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10390758514404297  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.602951049804688  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10326671600341797  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.728140354156494  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03306135535240173 |0.010853543877601624 |0.2634175568819046 |8.879601955413818e-05 |0.4295870065689087 |0.005914926528930664 |
----------------------------------------------------------pseudo_mini_loss sum 1.2913730144500732
Total (block generation + training)time/epoch 75.49645004953656
Training time/epoch 23.640007734298706
Training time without block to device /epoch 23.292694330215454
Training time without total dataloading part /epoch 22.18490242958069
load block tensor time/epoch 1.0579633712768555
block to device time/epoch 0.34731340408325195
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 23 |
Number of nodes for computation during this epoch:  8575961
Number of first layer input nodes during this epoch:  4653393
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.12007808685302734  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021740436553955078
random selection method range initialization spend 0.00642848014831543
time for parepare:  0.019249677658081055
local_output_nid generation:  0.0013861656188964844
local_in_edges_tensor generation:  0.0041315555572509766
mini_batch_src_global generation:  0.0024263858795166016
r_  generation:  0.01701807975769043
local_output_nid generation:  0.0025856494903564453
local_in_edges_tensor generation:  0.0013256072998046875
mini_batch_src_global generation:  0.001692056655883789
r_  generation:  0.009140491485595703
local_output_nid generation:  0.002286672592163086
local_in_edges_tensor generation:  0.0011420249938964844
mini_batch_src_global generation:  0.001249551773071289
r_  generation:  0.008486747741699219
local_output_nid generation:  0.002199411392211914
local_in_edges_tensor generation:  0.0010936260223388672
mini_batch_src_global generation:  0.0011909008026123047
r_  generation:  0.008209705352783203
local_output_nid generation:  0.0021495819091796875
local_in_edges_tensor generation:  0.0010578632354736328
mini_batch_src_global generation:  0.001195669174194336
r_  generation:  0.008387088775634766
local_output_nid generation:  0.002139568328857422
local_in_edges_tensor generation:  0.001032114028930664
mini_batch_src_global generation:  0.0010814666748046875
r_  generation:  0.008344650268554688
local_output_nid generation:  0.002084493637084961
local_in_edges_tensor generation:  0.0010576248168945312
mini_batch_src_global generation:  0.0011339187622070312
r_  generation:  0.008301734924316406
local_output_nid generation:  0.0020723342895507812
local_in_edges_tensor generation:  0.0010089874267578125
mini_batch_src_global generation:  0.0012331008911132812
r_  generation:  0.008391857147216797
local_output_nid generation:  0.0020530223846435547
local_in_edges_tensor generation:  0.0010671615600585938
mini_batch_src_global generation:  0.0011107921600341797
r_  generation:  0.008579730987548828
local_output_nid generation:  0.0020818710327148438
local_in_edges_tensor generation:  0.0009865760803222656
mini_batch_src_global generation:  0.0010726451873779297
r_  generation:  0.008331060409545898
local_output_nid generation:  0.0021109580993652344
local_in_edges_tensor generation:  0.0010645389556884766
mini_batch_src_global generation:  0.0011131763458251953
r_  generation:  0.008105993270874023
local_output_nid generation:  0.002106904983520508
local_in_edges_tensor generation:  0.0010669231414794922
mini_batch_src_global generation:  0.0011630058288574219
r_  generation:  0.010213375091552734
local_output_nid generation:  0.00220489501953125
local_in_edges_tensor generation:  0.001020193099975586
mini_batch_src_global generation:  0.0012123584747314453
r_  generation:  0.00859689712524414
local_output_nid generation:  0.002183198928833008
local_in_edges_tensor generation:  0.0010707378387451172
mini_batch_src_global generation:  0.0011937618255615234
r_  generation:  0.008488178253173828
local_output_nid generation:  0.0021712779998779297
local_in_edges_tensor generation:  0.0010197162628173828
mini_batch_src_global generation:  0.0010805130004882812
r_  generation:  0.008543968200683594
local_output_nid generation:  0.0021419525146484375
local_in_edges_tensor generation:  0.0010406970977783203
mini_batch_src_global generation:  0.0011377334594726562
r_  generation:  0.008527517318725586
local_output_nid generation:  0.002140522003173828
local_in_edges_tensor generation:  0.0009989738464355469
mini_batch_src_global generation:  0.0010654926300048828
r_  generation:  0.008289337158203125
local_output_nid generation:  0.0021123886108398438
local_in_edges_tensor generation:  0.0010170936584472656
mini_batch_src_global generation:  0.001093149185180664
r_  generation:  0.008460521697998047
local_output_nid generation:  0.002151012420654297
local_in_edges_tensor generation:  0.001032114028930664
mini_batch_src_global generation:  0.0010907649993896484
r_  generation:  0.008172035217285156
local_output_nid generation:  0.0021505355834960938
local_in_edges_tensor generation:  0.00099945068359375
mini_batch_src_global generation:  0.0010688304901123047
r_  generation:  0.008573293685913086
local_output_nid generation:  0.002109050750732422
local_in_edges_tensor generation:  0.0010113716125488281
mini_batch_src_global generation:  0.001104593276977539
r_  generation:  0.008631706237792969
local_output_nid generation:  0.0021545886993408203
local_in_edges_tensor generation:  0.0009920597076416016
mini_batch_src_global generation:  0.0010809898376464844
r_  generation:  0.00840139389038086
local_output_nid generation:  0.002138376235961914
local_in_edges_tensor generation:  0.0009839534759521484
mini_batch_src_global generation:  0.001081705093383789
r_  generation:  0.008333444595336914
local_output_nid generation:  0.002193927764892578
local_in_edges_tensor generation:  0.0010037422180175781
mini_batch_src_global generation:  0.0010752677917480469
r_  generation:  0.008469581604003906
local_output_nid generation:  0.002127408981323242
local_in_edges_tensor generation:  0.001003265380859375
mini_batch_src_global generation:  0.0010714530944824219
r_  generation:  0.008318424224853516
local_output_nid generation:  0.0021343231201171875
local_in_edges_tensor generation:  0.0009765625
mini_batch_src_global generation:  0.0010497570037841797
r_  generation:  0.008355379104614258
local_output_nid generation:  0.0020933151245117188
local_in_edges_tensor generation:  0.0009851455688476562
mini_batch_src_global generation:  0.00104522705078125
r_  generation:  0.008402109146118164
local_output_nid generation:  0.0021300315856933594
local_in_edges_tensor generation:  0.0009710788726806641
mini_batch_src_global generation:  0.0010554790496826172
r_  generation:  0.0084991455078125
local_output_nid generation:  0.0020890235900878906
local_in_edges_tensor generation:  0.000986337661743164
mini_batch_src_global generation:  0.0010454654693603516
r_  generation:  0.008493423461914062
local_output_nid generation:  0.0020780563354492188
local_in_edges_tensor generation:  0.0009763240814208984
mini_batch_src_global generation:  0.0010151863098144531
r_  generation:  0.008351325988769531
local_output_nid generation:  0.0020782947540283203
local_in_edges_tensor generation:  0.0009882450103759766
mini_batch_src_global generation:  0.0010342597961425781
r_  generation:  0.008333444595336914
local_output_nid generation:  0.0020868778228759766
local_in_edges_tensor generation:  0.0009548664093017578
mini_batch_src_global generation:  0.0010180473327636719
r_  generation:  0.008453130722045898
----------------------check_connections_block total spend ----------------------------- 0.5380351543426514
generate_one_block  0.03206586837768555
generate_one_block  0.018046140670776367
generate_one_block  0.015035629272460938
generate_one_block  0.014612436294555664
generate_one_block  0.016133785247802734
generate_one_block  0.014383077621459961
generate_one_block  0.014168739318847656
generate_one_block  0.01432490348815918
generate_one_block  0.014613628387451172
generate_one_block  0.014155149459838867
generate_one_block  0.014078378677368164
generate_one_block  0.0168759822845459
generate_one_block  0.01453256607055664
generate_one_block  0.014356136322021484
generate_one_block  0.014222383499145508
generate_one_block  0.014380216598510742
generate_one_block  0.014203548431396484
generate_one_block  0.014441728591918945
generate_one_block  0.016160964965820312
generate_one_block  0.014758586883544922
generate_one_block  0.014707088470458984
generate_one_block  0.014330148696899414
generate_one_block  0.017416715621948242
generate_one_block  0.014796257019042969
generate_one_block  0.014425039291381836
generate_one_block  0.01691746711730957
generate_one_block  0.014796733856201172
generate_one_block  0.014592647552490234
generate_one_block  0.014580011367797852
generate_one_block  0.014261722564697266
generate_one_block  0.014240026473999023
generate_one_block  0.014636754989624023
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03555178642272949
gen group dst list time:  0.019777297973632812
time for parepare:  0.01950526237487793
local_output_nid generation:  0.005714893341064453
local_in_edges_tensor generation:  0.014912843704223633
mini_batch_src_global generation:  0.012426137924194336
r_  generation:  0.13337278366088867
local_output_nid generation:  0.007835626602172852
local_in_edges_tensor generation:  0.009928464889526367
mini_batch_src_global generation:  0.0161588191986084
r_  generation:  0.16173791885375977
local_output_nid generation:  0.007868051528930664
local_in_edges_tensor generation:  0.03316521644592285
mini_batch_src_global generation:  0.01610875129699707
r_  generation:  0.13238954544067383
local_output_nid generation:  0.007965564727783203
local_in_edges_tensor generation:  0.0096588134765625
mini_batch_src_global generation:  0.016000747680664062
r_  generation:  0.1337590217590332
local_output_nid generation:  0.008178234100341797
local_in_edges_tensor generation:  0.012460470199584961
mini_batch_src_global generation:  0.016225814819335938
r_  generation:  0.13717079162597656
local_output_nid generation:  0.008376836776733398
local_in_edges_tensor generation:  0.008044242858886719
mini_batch_src_global generation:  0.015961170196533203
r_  generation:  0.13648390769958496
local_output_nid generation:  0.00824117660522461
local_in_edges_tensor generation:  0.009568929672241211
mini_batch_src_global generation:  0.016181468963623047
r_  generation:  0.14845037460327148
local_output_nid generation:  0.012958049774169922
local_in_edges_tensor generation:  0.00861358642578125
mini_batch_src_global generation:  0.017161130905151367
r_  generation:  0.14193153381347656
local_output_nid generation:  0.009579181671142578
local_in_edges_tensor generation:  0.010294437408447266
mini_batch_src_global generation:  0.017465591430664062
r_  generation:  0.13949918746948242
local_output_nid generation:  0.008324384689331055
local_in_edges_tensor generation:  0.008666753768920898
mini_batch_src_global generation:  0.016401052474975586
r_  generation:  0.13373112678527832
local_output_nid generation:  0.008631706237792969
local_in_edges_tensor generation:  0.007645845413208008
mini_batch_src_global generation:  0.015897512435913086
r_  generation:  0.13502287864685059
local_output_nid generation:  0.009021997451782227
local_in_edges_tensor generation:  0.009258508682250977
mini_batch_src_global generation:  0.018235206604003906
r_  generation:  0.14404964447021484
local_output_nid generation:  0.008658170700073242
local_in_edges_tensor generation:  0.008286476135253906
mini_batch_src_global generation:  0.01672840118408203
r_  generation:  0.13991951942443848
local_output_nid generation:  0.008648872375488281
local_in_edges_tensor generation:  0.008331775665283203
mini_batch_src_global generation:  0.016891956329345703
r_  generation:  0.1391611099243164
local_output_nid generation:  0.00847768783569336
local_in_edges_tensor generation:  0.007517099380493164
mini_batch_src_global generation:  0.016521930694580078
r_  generation:  0.13454842567443848
local_output_nid generation:  0.008692741394042969
local_in_edges_tensor generation:  0.007738590240478516
mini_batch_src_global generation:  0.016660213470458984
r_  generation:  0.13728690147399902
local_output_nid generation:  0.008399486541748047
local_in_edges_tensor generation:  0.007573127746582031
mini_batch_src_global generation:  0.016103506088256836
r_  generation:  0.13713788986206055
local_output_nid generation:  0.008644342422485352
local_in_edges_tensor generation:  0.008069038391113281
mini_batch_src_global generation:  0.016945838928222656
r_  generation:  0.13593721389770508
local_output_nid generation:  0.008240222930908203
local_in_edges_tensor generation:  0.00799560546875
mini_batch_src_global generation:  0.015599727630615234
r_  generation:  0.17122888565063477
local_output_nid generation:  0.013574361801147461
local_in_edges_tensor generation:  0.011116504669189453
mini_batch_src_global generation:  0.020817041397094727
r_  generation:  0.15757250785827637
local_output_nid generation:  0.012260675430297852
local_in_edges_tensor generation:  0.008954524993896484
mini_batch_src_global generation:  0.017340898513793945
r_  generation:  0.14679980278015137
local_output_nid generation:  0.009701251983642578
local_in_edges_tensor generation:  0.008120059967041016
mini_batch_src_global generation:  0.017139434814453125
r_  generation:  0.1432509422302246
local_output_nid generation:  0.008957862854003906
local_in_edges_tensor generation:  0.008006811141967773
mini_batch_src_global generation:  0.01618337631225586
r_  generation:  0.13870835304260254
local_output_nid generation:  0.010183095932006836
local_in_edges_tensor generation:  0.008246898651123047
mini_batch_src_global generation:  0.016453981399536133
r_  generation:  0.1408829689025879
local_output_nid generation:  0.010501861572265625
local_in_edges_tensor generation:  0.008009910583496094
mini_batch_src_global generation:  0.01635909080505371
r_  generation:  0.14301300048828125
local_output_nid generation:  0.008735179901123047
local_in_edges_tensor generation:  0.010698080062866211
mini_batch_src_global generation:  0.017194747924804688
r_  generation:  0.14206910133361816
local_output_nid generation:  0.00869894027709961
local_in_edges_tensor generation:  0.009719610214233398
mini_batch_src_global generation:  0.017105817794799805
r_  generation:  0.14322233200073242
local_output_nid generation:  0.008742332458496094
local_in_edges_tensor generation:  0.010716915130615234
mini_batch_src_global generation:  0.01880025863647461
r_  generation:  0.1419079303741455
local_output_nid generation:  0.008626937866210938
local_in_edges_tensor generation:  0.007985830307006836
mini_batch_src_global generation:  0.017756938934326172
r_  generation:  0.14434123039245605
local_output_nid generation:  0.008611202239990234
local_in_edges_tensor generation:  0.011018991470336914
mini_batch_src_global generation:  0.017705202102661133
r_  generation:  0.1395714282989502
local_output_nid generation:  0.008480310440063477
local_in_edges_tensor generation:  0.008832216262817383
mini_batch_src_global generation:  0.015824079513549805
r_  generation:  0.13900303840637207
local_output_nid generation:  0.00872945785522461
local_in_edges_tensor generation:  0.007720470428466797
mini_batch_src_global generation:  0.017421960830688477
r_  generation:  0.1385669708251953
----------------------check_connections_block total spend ----------------------------- 6.7556312084198
generate_one_block  0.19957304000854492
generate_one_block  0.17542552947998047
generate_one_block  0.17304444313049316
generate_one_block  0.17603778839111328
generate_one_block  0.19370174407958984
generate_one_block  0.1743144989013672
generate_one_block  0.17318296432495117
generate_one_block  0.1788318157196045
generate_one_block  0.18601536750793457
generate_one_block  0.18009686470031738
generate_one_block  0.17376089096069336
generate_one_block  0.19009637832641602
generate_one_block  0.1806018352508545
generate_one_block  0.1808922290802002
generate_one_block  0.17070817947387695
generate_one_block  0.17662787437438965
generate_one_block  0.17459630966186523
generate_one_block  0.17651581764221191
generate_one_block  0.17035317420959473
generate_one_block  0.17756366729736328
generate_one_block  0.1838829517364502
generate_one_block  0.1793498992919922
generate_one_block  0.17322635650634766
generate_one_block  0.17863750457763672
generate_one_block  0.1810898780822754
generate_one_block  0.19224095344543457
generate_one_block  0.18110156059265137
generate_one_block  0.1807706356048584
generate_one_block  0.1809697151184082
generate_one_block  0.17773890495300293
generate_one_block  0.17766618728637695
generate_one_block  0.18115949630737305
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.040421247482299805
gen group dst list time:  0.12731528282165527
time for parepare:  0.01978325843811035
local_output_nid generation:  0.02407240867614746
local_in_edges_tensor generation:  0.045798540115356445
mini_batch_src_global generation:  0.03856778144836426
r_  generation:  0.40376758575439453
local_output_nid generation:  0.03030562400817871
local_in_edges_tensor generation:  0.03671884536743164
mini_batch_src_global generation:  0.05253887176513672
r_  generation:  0.4142270088195801
local_output_nid generation:  0.03252577781677246
local_in_edges_tensor generation:  0.031545162200927734
mini_batch_src_global generation:  0.04982161521911621
r_  generation:  0.3980085849761963
local_output_nid generation:  0.029653072357177734
local_in_edges_tensor generation:  0.0300140380859375
mini_batch_src_global generation:  0.04915308952331543
r_  generation:  0.3983907699584961
local_output_nid generation:  0.02923297882080078
local_in_edges_tensor generation:  0.02783656120300293
mini_batch_src_global generation:  0.04635167121887207
r_  generation:  0.40165233612060547
local_output_nid generation:  0.028768062591552734
local_in_edges_tensor generation:  0.02585148811340332
mini_batch_src_global generation:  0.04770064353942871
r_  generation:  0.3994596004486084
local_output_nid generation:  0.028065919876098633
local_in_edges_tensor generation:  0.027327299118041992
mini_batch_src_global generation:  0.04646801948547363
r_  generation:  0.41545653343200684
local_output_nid generation:  0.028095006942749023
local_in_edges_tensor generation:  0.02642345428466797
mini_batch_src_global generation:  0.05504322052001953
r_  generation:  0.3995356559753418
local_output_nid generation:  0.02822589874267578
local_in_edges_tensor generation:  0.027779102325439453
mini_batch_src_global generation:  0.047473907470703125
r_  generation:  0.40646862983703613
local_output_nid generation:  0.027901411056518555
local_in_edges_tensor generation:  0.026927947998046875
mini_batch_src_global generation:  0.04909515380859375
r_  generation:  0.3968522548675537
local_output_nid generation:  0.028043270111083984
local_in_edges_tensor generation:  0.024725914001464844
mini_batch_src_global generation:  0.045757293701171875
r_  generation:  0.40337038040161133
local_output_nid generation:  0.028128862380981445
local_in_edges_tensor generation:  0.026533842086791992
mini_batch_src_global generation:  0.050162315368652344
r_  generation:  0.4029271602630615
local_output_nid generation:  0.0279843807220459
local_in_edges_tensor generation:  0.026953935623168945
mini_batch_src_global generation:  0.04654264450073242
r_  generation:  0.4058237075805664
local_output_nid generation:  0.028162240982055664
local_in_edges_tensor generation:  0.026648521423339844
mini_batch_src_global generation:  0.049942970275878906
r_  generation:  0.40936875343322754
local_output_nid generation:  0.027464866638183594
local_in_edges_tensor generation:  0.029541015625
mini_batch_src_global generation:  0.04846358299255371
r_  generation:  0.4076731204986572
local_output_nid generation:  0.028903961181640625
local_in_edges_tensor generation:  0.03215622901916504
mini_batch_src_global generation:  0.04964160919189453
r_  generation:  0.42327284812927246
local_output_nid generation:  0.03150296211242676
local_in_edges_tensor generation:  0.030364513397216797
mini_batch_src_global generation:  0.04897117614746094
r_  generation:  0.4158458709716797
local_output_nid generation:  0.027803659439086914
local_in_edges_tensor generation:  0.029024839401245117
mini_batch_src_global generation:  0.049312591552734375
r_  generation:  0.39862704277038574
local_output_nid generation:  0.027751445770263672
local_in_edges_tensor generation:  0.02793121337890625
mini_batch_src_global generation:  0.04541802406311035
r_  generation:  0.40407633781433105
local_output_nid generation:  0.027889490127563477
local_in_edges_tensor generation:  0.025109529495239258
mini_batch_src_global generation:  0.047536611557006836
r_  generation:  0.39470720291137695
local_output_nid generation:  0.028006315231323242
local_in_edges_tensor generation:  0.028818368911743164
mini_batch_src_global generation:  0.04594540596008301
r_  generation:  0.41420412063598633
local_output_nid generation:  0.028059720993041992
local_in_edges_tensor generation:  0.029209613800048828
mini_batch_src_global generation:  0.04899930953979492
r_  generation:  0.40100598335266113
local_output_nid generation:  0.027597427368164062
local_in_edges_tensor generation:  0.02762746810913086
mini_batch_src_global generation:  0.0461575984954834
r_  generation:  0.40137815475463867
local_output_nid generation:  0.027692317962646484
local_in_edges_tensor generation:  0.02417898178100586
mini_batch_src_global generation:  0.047310590744018555
r_  generation:  0.3937509059906006
local_output_nid generation:  0.027791261672973633
local_in_edges_tensor generation:  0.028242111206054688
mini_batch_src_global generation:  0.047179222106933594
r_  generation:  0.41330480575561523
local_output_nid generation:  0.0292971134185791
local_in_edges_tensor generation:  0.027543067932128906
mini_batch_src_global generation:  0.04744553565979004
r_  generation:  0.40204787254333496
local_output_nid generation:  0.028599977493286133
local_in_edges_tensor generation:  0.032898664474487305
mini_batch_src_global generation:  0.046407461166381836
r_  generation:  0.41262006759643555
local_output_nid generation:  0.027797937393188477
local_in_edges_tensor generation:  0.029654741287231445
mini_batch_src_global generation:  0.04890847206115723
r_  generation:  0.4077024459838867
local_output_nid generation:  0.02786731719970703
local_in_edges_tensor generation:  0.02904987335205078
mini_batch_src_global generation:  0.05131673812866211
r_  generation:  0.43002915382385254
local_output_nid generation:  0.029656410217285156
local_in_edges_tensor generation:  0.03009819984436035
mini_batch_src_global generation:  0.05170083045959473
r_  generation:  0.4025537967681885
local_output_nid generation:  0.028121232986450195
local_in_edges_tensor generation:  0.02804255485534668
mini_batch_src_global generation:  0.048078060150146484
r_  generation:  0.4190216064453125
local_output_nid generation:  0.027963876724243164
local_in_edges_tensor generation:  0.025700092315673828
mini_batch_src_global generation:  0.046944618225097656
r_  generation:  0.4049713611602783
----------------------check_connections_block total spend ----------------------------- 19.261731147766113
generate_one_block  0.5570144653320312
generate_one_block  0.5340631008148193
generate_one_block  0.5251727104187012
generate_one_block  0.531268835067749
generate_one_block  0.6356029510498047
generate_one_block  0.533724308013916
generate_one_block  0.5310864448547363
generate_one_block  0.5409924983978271
generate_one_block  0.5501632690429688
generate_one_block  0.5286111831665039
generate_one_block  0.531397819519043
generate_one_block  0.5500338077545166
generate_one_block  0.5381436347961426
generate_one_block  0.5396811962127686
generate_one_block  0.5431158542633057
generate_one_block  0.5329797267913818
generate_one_block  0.5266497135162354
generate_one_block  0.5299105644226074
generate_one_block  0.5263261795043945
generate_one_block  0.5331778526306152
generate_one_block  0.5447616577148438
generate_one_block  0.5391654968261719
generate_one_block  0.524791955947876
generate_one_block  0.5298037528991699
generate_one_block  0.5458743572235107
generate_one_block  0.5319714546203613
generate_one_block  0.5472633838653564
generate_one_block  0.5353281497955322
generate_one_block  0.540316104888916
generate_one_block  0.5426154136657715
generate_one_block  0.5296833515167236
generate_one_block  0.5341174602508545
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.12007808685302734  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

connection checking time:  26.017362356185913
block generation total time  23.014583110809326
average batch blocks generation time:  0.7192057222127914
block dataloader generation time/epoch 51.68240016301473
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10508441925048828  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.216514587402344  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10317420959472656  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.717195987701416  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10287809371948242  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.510282516479492  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1030740737915039  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.745462417602539  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10273075103759766  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.712600231170654  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1027975082397461  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.531836032867432  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10381603240966797  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.448168277740479  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10384988784790039  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.847835540771484  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10503625869750977  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.982811450958252  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10289907455444336  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.561857223510742  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10274171829223633  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.564541339874268  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10404396057128906  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.249652862548828  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1039423942565918  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.885228157043457  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10422945022583008  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.936572074890137  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10260438919067383  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.397748470306396  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10308408737182617  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.748076438903809  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10386466979980469  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.52480697631836  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10290336608886719  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.674184799194336  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1027522087097168  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.379563331604004  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10300111770629883  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.538414478302002  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10504484176635742  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.999252319335938  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10409784317016602  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.895044326782227  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10274791717529297  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.49920129776001  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1027226448059082  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.572382926940918  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10294914245605469  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.731985092163086  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10283517837524414  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.58437967300415  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10381841659545898  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.783338069915771  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1032710075378418  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.761707305908203  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10501480102539062  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.848739624023438  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10402107238769531  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.75232219696045  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10287952423095703  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.567954540252686  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10294723510742188  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.708795547485352  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03689832240343094 |0.011600390076637268 |0.26390431076288223 |8.965283632278442e-05 |0.42952238768339157 |0.006016254425048828 |
----------------------------------------------------------pseudo_mini_loss sum 1.2798140048980713
Total (block generation + training)time/epoch 75.49379688898722
Training time/epoch 23.80115008354187
Training time without block to device /epoch 23.429937601089478
Training time without total dataloading part /epoch 22.19853949546814
load block tensor time/epoch 1.18074631690979
block to device time/epoch 0.3712124824523926
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 24 |
Number of nodes for computation during this epoch:  8575181
Number of first layer input nodes during this epoch:  4651718
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.11974000930786133  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022481918334960938
random selection method range initialization spend 0.0065691471099853516
time for parepare:  0.022867918014526367
local_output_nid generation:  0.0013666152954101562
local_in_edges_tensor generation:  0.0035963058471679688
mini_batch_src_global generation:  0.0020682811737060547
r_  generation:  0.009458303451538086
local_output_nid generation:  0.0015096664428710938
local_in_edges_tensor generation:  0.0009062290191650391
mini_batch_src_global generation:  0.0015797615051269531
r_  generation:  0.008516311645507812
local_output_nid generation:  0.0015673637390136719
local_in_edges_tensor generation:  0.0008535385131835938
mini_batch_src_global generation:  0.001112222671508789
r_  generation:  0.008011579513549805
local_output_nid generation:  0.001550436019897461
local_in_edges_tensor generation:  0.0007901191711425781
mini_batch_src_global generation:  0.0010154247283935547
r_  generation:  0.007989645004272461
local_output_nid generation:  0.001493215560913086
local_in_edges_tensor generation:  0.0008113384246826172
mini_batch_src_global generation:  0.0009989738464355469
r_  generation:  0.008116006851196289
local_output_nid generation:  0.0015263557434082031
local_in_edges_tensor generation:  0.0008342266082763672
mini_batch_src_global generation:  0.0010204315185546875
r_  generation:  0.008298397064208984
local_output_nid generation:  0.0014734268188476562
local_in_edges_tensor generation:  0.0007777214050292969
mini_batch_src_global generation:  0.0009589195251464844
r_  generation:  0.008162975311279297
local_output_nid generation:  0.001474618911743164
local_in_edges_tensor generation:  0.0007872581481933594
mini_batch_src_global generation:  0.0009813308715820312
r_  generation:  0.007857561111450195
local_output_nid generation:  0.0014755725860595703
local_in_edges_tensor generation:  0.0007731914520263672
mini_batch_src_global generation:  0.0009272098541259766
r_  generation:  0.008062601089477539
local_output_nid generation:  0.0014758110046386719
local_in_edges_tensor generation:  0.0007631778717041016
mini_batch_src_global generation:  0.0009009838104248047
r_  generation:  0.007946014404296875
local_output_nid generation:  0.0014729499816894531
local_in_edges_tensor generation:  0.0007648468017578125
mini_batch_src_global generation:  0.0009205341339111328
r_  generation:  0.008236408233642578
local_output_nid generation:  0.0014638900756835938
local_in_edges_tensor generation:  0.0007650852203369141
mini_batch_src_global generation:  0.0009219646453857422
r_  generation:  0.008168935775756836
local_output_nid generation:  0.0014743804931640625
local_in_edges_tensor generation:  0.0007925033569335938
mini_batch_src_global generation:  0.0009860992431640625
r_  generation:  0.009579896926879883
local_output_nid generation:  0.001497507095336914
local_in_edges_tensor generation:  0.0008020401000976562
mini_batch_src_global generation:  0.0009813308715820312
r_  generation:  0.008136510848999023
local_output_nid generation:  0.0015037059783935547
local_in_edges_tensor generation:  0.0007963180541992188
mini_batch_src_global generation:  0.0009675025939941406
r_  generation:  0.00862431526184082
local_output_nid generation:  0.001508951187133789
local_in_edges_tensor generation:  0.0007610321044921875
mini_batch_src_global generation:  0.0009324550628662109
r_  generation:  0.008211135864257812
local_output_nid generation:  0.0015017986297607422
local_in_edges_tensor generation:  0.0007674694061279297
mini_batch_src_global generation:  0.0009353160858154297
r_  generation:  0.008028745651245117
local_output_nid generation:  0.0014836788177490234
local_in_edges_tensor generation:  0.0008208751678466797
mini_batch_src_global generation:  0.0009477138519287109
r_  generation:  0.00869297981262207
local_output_nid generation:  0.0014710426330566406
local_in_edges_tensor generation:  0.0007889270782470703
mini_batch_src_global generation:  0.0009682178497314453
r_  generation:  0.008379459381103516
local_output_nid generation:  0.0014777183532714844
local_in_edges_tensor generation:  0.0007576942443847656
mini_batch_src_global generation:  0.000982522964477539
r_  generation:  0.008596181869506836
local_output_nid generation:  0.0014965534210205078
local_in_edges_tensor generation:  0.0007784366607666016
mini_batch_src_global generation:  0.0009965896606445312
r_  generation:  0.008083343505859375
local_output_nid generation:  0.0014941692352294922
local_in_edges_tensor generation:  0.0007939338684082031
mini_batch_src_global generation:  0.0009481906890869141
r_  generation:  0.008409738540649414
local_output_nid generation:  0.0014846324920654297
local_in_edges_tensor generation:  0.0007340908050537109
mini_batch_src_global generation:  0.0009167194366455078
r_  generation:  0.008101463317871094
local_output_nid generation:  0.0014660358428955078
local_in_edges_tensor generation:  0.0007739067077636719
mini_batch_src_global generation:  0.0009036064147949219
r_  generation:  0.00832366943359375
local_output_nid generation:  0.0014622211456298828
local_in_edges_tensor generation:  0.0007436275482177734
mini_batch_src_global generation:  0.0008890628814697266
r_  generation:  0.00810551643371582
local_output_nid generation:  0.0014472007751464844
local_in_edges_tensor generation:  0.0007524490356445312
mini_batch_src_global generation:  0.0008955001831054688
r_  generation:  0.008244991302490234
local_output_nid generation:  0.0014619827270507812
local_in_edges_tensor generation:  0.0007462501525878906
mini_batch_src_global generation:  0.0009746551513671875
r_  generation:  0.0082550048828125
local_output_nid generation:  0.0014491081237792969
local_in_edges_tensor generation:  0.0007314682006835938
mini_batch_src_global generation:  0.0009233951568603516
r_  generation:  0.008221149444580078
local_output_nid generation:  0.0014390945434570312
local_in_edges_tensor generation:  0.0007548332214355469
mini_batch_src_global generation:  0.0009212493896484375
r_  generation:  0.00820779800415039
local_output_nid generation:  0.0014317035675048828
local_in_edges_tensor generation:  0.0007379055023193359
mini_batch_src_global generation:  0.0009775161743164062
r_  generation:  0.007965803146362305
local_output_nid generation:  0.0014464855194091797
local_in_edges_tensor generation:  0.0007309913635253906
mini_batch_src_global generation:  0.0008935928344726562
r_  generation:  0.008193731307983398
local_output_nid generation:  0.0014579296112060547
local_in_edges_tensor generation:  0.0007343292236328125
mini_batch_src_global generation:  0.000904083251953125
r_  generation:  0.008210182189941406
----------------------check_connections_block total spend ----------------------------- 0.477994441986084
generate_one_block  0.019690752029418945
generate_one_block  0.017780542373657227
generate_one_block  0.014903545379638672
generate_one_block  0.014754056930541992
generate_one_block  0.014511823654174805
generate_one_block  0.014541387557983398
generate_one_block  0.01445317268371582
generate_one_block  0.014166831970214844
generate_one_block  0.014272928237915039
generate_one_block  0.014005422592163086
generate_one_block  0.014329195022583008
generate_one_block  0.014406204223632812
generate_one_block  0.015133142471313477
generate_one_block  0.014360189437866211
generate_one_block  0.015157222747802734
generate_one_block  0.014376640319824219
generate_one_block  0.01423954963684082
generate_one_block  0.014896631240844727
generate_one_block  0.014571905136108398
generate_one_block  0.014836311340332031
generate_one_block  0.014237165451049805
generate_one_block  0.01452183723449707
generate_one_block  0.01736903190612793
generate_one_block  0.014831066131591797
generate_one_block  0.014247894287109375
generate_one_block  0.014207839965820312
generate_one_block  0.014445066452026367
generate_one_block  0.014096736907958984
generate_one_block  0.014248371124267578
generate_one_block  0.013906717300415039
generate_one_block  0.014329671859741211
generate_one_block  0.014177560806274414
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03507089614868164
gen group dst list time:  0.023060321807861328
time for parepare:  0.02152419090270996
local_output_nid generation:  0.005352497100830078
local_in_edges_tensor generation:  0.015324831008911133
mini_batch_src_global generation:  0.0146331787109375
r_  generation:  0.1214303970336914
local_output_nid generation:  0.007827043533325195
local_in_edges_tensor generation:  0.009648799896240234
mini_batch_src_global generation:  0.018338680267333984
r_  generation:  0.16455698013305664
local_output_nid generation:  0.008432149887084961
local_in_edges_tensor generation:  0.02901005744934082
mini_batch_src_global generation:  0.039096832275390625
r_  generation:  0.14667510986328125
local_output_nid generation:  0.01377415657043457
local_in_edges_tensor generation:  0.012903928756713867
mini_batch_src_global generation:  0.017788410186767578
r_  generation:  0.1486682891845703
local_output_nid generation:  0.013917684555053711
local_in_edges_tensor generation:  0.013724803924560547
mini_batch_src_global generation:  0.01759195327758789
r_  generation:  0.15839743614196777
local_output_nid generation:  0.014054298400878906
local_in_edges_tensor generation:  0.012337446212768555
mini_batch_src_global generation:  0.018533706665039062
r_  generation:  0.1556718349456787
local_output_nid generation:  0.014035701751708984
local_in_edges_tensor generation:  0.012364864349365234
mini_batch_src_global generation:  0.01885676383972168
r_  generation:  0.15919709205627441
local_output_nid generation:  0.012927532196044922
local_in_edges_tensor generation:  0.010987281799316406
mini_batch_src_global generation:  0.021071910858154297
r_  generation:  0.17284536361694336
local_output_nid generation:  0.011808156967163086
local_in_edges_tensor generation:  0.009819984436035156
mini_batch_src_global generation:  0.021874189376831055
r_  generation:  0.1456589698791504
local_output_nid generation:  0.009407520294189453
local_in_edges_tensor generation:  0.009434938430786133
mini_batch_src_global generation:  0.019329309463500977
r_  generation:  0.14174437522888184
local_output_nid generation:  0.009901285171508789
local_in_edges_tensor generation:  0.009757518768310547
mini_batch_src_global generation:  0.018742084503173828
r_  generation:  0.1720280647277832
local_output_nid generation:  0.008575439453125
local_in_edges_tensor generation:  0.008607625961303711
mini_batch_src_global generation:  0.04524731636047363
r_  generation:  0.1617143154144287
local_output_nid generation:  0.010304689407348633
local_in_edges_tensor generation:  0.010660648345947266
mini_batch_src_global generation:  0.02328181266784668
r_  generation:  0.15007448196411133
local_output_nid generation:  0.008907794952392578
local_in_edges_tensor generation:  0.012817144393920898
mini_batch_src_global generation:  0.019397974014282227
r_  generation:  0.16881394386291504
local_output_nid generation:  0.013903141021728516
local_in_edges_tensor generation:  0.015836477279663086
mini_batch_src_global generation:  0.028276920318603516
r_  generation:  0.15757989883422852
local_output_nid generation:  0.012157201766967773
local_in_edges_tensor generation:  0.01233816146850586
mini_batch_src_global generation:  0.01909780502319336
r_  generation:  0.13391613960266113
local_output_nid generation:  0.009318113327026367
local_in_edges_tensor generation:  0.008538246154785156
mini_batch_src_global generation:  0.018825292587280273
r_  generation:  0.1384875774383545
local_output_nid generation:  0.009047269821166992
local_in_edges_tensor generation:  0.009450674057006836
mini_batch_src_global generation:  0.020078182220458984
r_  generation:  0.18787717819213867
local_output_nid generation:  0.008655548095703125
local_in_edges_tensor generation:  0.00984048843383789
mini_batch_src_global generation:  0.019858121871948242
r_  generation:  0.14435410499572754
local_output_nid generation:  0.008842706680297852
local_in_edges_tensor generation:  0.008416891098022461
mini_batch_src_global generation:  0.021183013916015625
r_  generation:  0.14277887344360352
local_output_nid generation:  0.008367776870727539
local_in_edges_tensor generation:  0.007810115814208984
mini_batch_src_global generation:  0.0168764591217041
r_  generation:  0.14023351669311523
local_output_nid generation:  0.008598566055297852
local_in_edges_tensor generation:  0.008209228515625
mini_batch_src_global generation:  0.017625093460083008
r_  generation:  0.14023232460021973
local_output_nid generation:  0.008525848388671875
local_in_edges_tensor generation:  0.007951021194458008
mini_batch_src_global generation:  0.016558408737182617
r_  generation:  0.14063334465026855
local_output_nid generation:  0.00857996940612793
local_in_edges_tensor generation:  0.007841110229492188
mini_batch_src_global generation:  0.017382144927978516
r_  generation:  0.13765478134155273
local_output_nid generation:  0.008437633514404297
local_in_edges_tensor generation:  0.007550477981567383
mini_batch_src_global generation:  0.01676344871520996
r_  generation:  0.14204978942871094
local_output_nid generation:  0.008440971374511719
local_in_edges_tensor generation:  0.009890079498291016
mini_batch_src_global generation:  0.017190217971801758
r_  generation:  0.13899016380310059
local_output_nid generation:  0.00862574577331543
local_in_edges_tensor generation:  0.008599996566772461
mini_batch_src_global generation:  0.035508155822753906
r_  generation:  0.14804577827453613
local_output_nid generation:  0.01025700569152832
local_in_edges_tensor generation:  0.008255958557128906
mini_batch_src_global generation:  0.017193317413330078
r_  generation:  0.1424400806427002
local_output_nid generation:  0.008629798889160156
local_in_edges_tensor generation:  0.011008262634277344
mini_batch_src_global generation:  0.01738429069519043
r_  generation:  0.1802992820739746
local_output_nid generation:  0.014311075210571289
local_in_edges_tensor generation:  0.011132240295410156
mini_batch_src_global generation:  0.02093791961669922
r_  generation:  0.1382765769958496
local_output_nid generation:  0.010531902313232422
local_in_edges_tensor generation:  0.009591817855834961
mini_batch_src_global generation:  0.017194271087646484
r_  generation:  0.14157629013061523
local_output_nid generation:  0.009105920791625977
local_in_edges_tensor generation:  0.008906364440917969
mini_batch_src_global generation:  0.016780614852905273
r_  generation:  0.16711020469665527
----------------------check_connections_block total spend ----------------------------- 7.337243556976318
generate_one_block  0.19210505485534668
generate_one_block  0.17536354064941406
generate_one_block  0.17580819129943848
generate_one_block  0.1807258129119873
generate_one_block  0.1935594081878662
generate_one_block  0.1785569190979004
generate_one_block  0.18161249160766602
generate_one_block  0.1755828857421875
generate_one_block  0.18092060089111328
generate_one_block  0.17577004432678223
generate_one_block  0.17551136016845703
generate_one_block  0.1744687557220459
generate_one_block  0.18467140197753906
generate_one_block  0.17408251762390137
generate_one_block  0.1815345287322998
generate_one_block  0.16859745979309082
generate_one_block  0.17438626289367676
generate_one_block  0.18288207054138184
generate_one_block  0.18278861045837402
generate_one_block  0.19197583198547363
generate_one_block  0.1824030876159668
generate_one_block  0.18316912651062012
generate_one_block  0.1856064796447754
generate_one_block  0.17737865447998047
generate_one_block  0.1772327423095703
generate_one_block  0.17471671104431152
generate_one_block  0.17920374870300293
generate_one_block  0.17709660530090332
generate_one_block  0.1773838996887207
generate_one_block  0.1724400520324707
generate_one_block  0.17792725563049316
generate_one_block  0.17554926872253418
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0382840633392334
gen group dst list time:  0.10367131233215332
time for parepare:  0.020786762237548828
local_output_nid generation:  0.023022890090942383
local_in_edges_tensor generation:  0.045444488525390625
mini_batch_src_global generation:  0.03635287284851074
r_  generation:  0.390117883682251
local_output_nid generation:  0.0289151668548584
local_in_edges_tensor generation:  0.03260231018066406
mini_batch_src_global generation:  0.046680450439453125
r_  generation:  0.40475034713745117
local_output_nid generation:  0.02897953987121582
local_in_edges_tensor generation:  0.025772809982299805
mini_batch_src_global generation:  0.04552412033081055
r_  generation:  0.39949965476989746
local_output_nid generation:  0.028650283813476562
local_in_edges_tensor generation:  0.02643585205078125
mini_batch_src_global generation:  0.04803180694580078
r_  generation:  0.3960416316986084
local_output_nid generation:  0.029030799865722656
local_in_edges_tensor generation:  0.02815413475036621
mini_batch_src_global generation:  0.0483250617980957
r_  generation:  0.40641283988952637
local_output_nid generation:  0.028216838836669922
local_in_edges_tensor generation:  0.024787187576293945
mini_batch_src_global generation:  0.04777717590332031
r_  generation:  0.40116214752197266
local_output_nid generation:  0.027356863021850586
local_in_edges_tensor generation:  0.028581857681274414
mini_batch_src_global generation:  0.04844212532043457
r_  generation:  0.4153611660003662
local_output_nid generation:  0.026476621627807617
local_in_edges_tensor generation:  0.03185629844665527
mini_batch_src_global generation:  0.049021244049072266
r_  generation:  0.3984999656677246
local_output_nid generation:  0.026944637298583984
local_in_edges_tensor generation:  0.025290250778198242
mini_batch_src_global generation:  0.04781365394592285
r_  generation:  0.4088551998138428
local_output_nid generation:  0.0271761417388916
local_in_edges_tensor generation:  0.02783346176147461
mini_batch_src_global generation:  0.04964470863342285
r_  generation:  0.4026460647583008
local_output_nid generation:  0.027791738510131836
local_in_edges_tensor generation:  0.02906632423400879
mini_batch_src_global generation:  0.046143293380737305
r_  generation:  0.42461156845092773
local_output_nid generation:  0.03024578094482422
local_in_edges_tensor generation:  0.026505470275878906
mini_batch_src_global generation:  0.04792284965515137
r_  generation:  0.39679861068725586
local_output_nid generation:  0.027890443801879883
local_in_edges_tensor generation:  0.03061699867248535
mini_batch_src_global generation:  0.048569679260253906
r_  generation:  0.40909504890441895
local_output_nid generation:  0.027639389038085938
local_in_edges_tensor generation:  0.024477005004882812
mini_batch_src_global generation:  0.04803276062011719
r_  generation:  0.39489006996154785
local_output_nid generation:  0.027665376663208008
local_in_edges_tensor generation:  0.026453256607055664
mini_batch_src_global generation:  0.04641079902648926
r_  generation:  0.4080390930175781
local_output_nid generation:  0.02716803550720215
local_in_edges_tensor generation:  0.02485036849975586
mini_batch_src_global generation:  0.04731106758117676
r_  generation:  0.3937869071960449
local_output_nid generation:  0.027624845504760742
local_in_edges_tensor generation:  0.026627779006958008
mini_batch_src_global generation:  0.048035383224487305
r_  generation:  0.40350914001464844
local_output_nid generation:  0.028189659118652344
local_in_edges_tensor generation:  0.030591487884521484
mini_batch_src_global generation:  0.050418853759765625
r_  generation:  0.40450263023376465
local_output_nid generation:  0.028072595596313477
local_in_edges_tensor generation:  0.024745941162109375
mini_batch_src_global generation:  0.046466827392578125
r_  generation:  0.41057658195495605
local_output_nid generation:  0.028384923934936523
local_in_edges_tensor generation:  0.026264190673828125
mini_batch_src_global generation:  0.0508112907409668
r_  generation:  0.4053974151611328
local_output_nid generation:  0.027973175048828125
local_in_edges_tensor generation:  0.025830745697021484
mini_batch_src_global generation:  0.047280073165893555
r_  generation:  0.4128146171569824
local_output_nid generation:  0.02781081199645996
local_in_edges_tensor generation:  0.02814483642578125
mini_batch_src_global generation:  0.048468828201293945
r_  generation:  0.4008619785308838
local_output_nid generation:  0.028001785278320312
local_in_edges_tensor generation:  0.0288388729095459
mini_batch_src_global generation:  0.04819488525390625
r_  generation:  0.40941286087036133
local_output_nid generation:  0.027775287628173828
local_in_edges_tensor generation:  0.027128934860229492
mini_batch_src_global generation:  0.04984593391418457
r_  generation:  0.39696168899536133
local_output_nid generation:  0.02800893783569336
local_in_edges_tensor generation:  0.025900840759277344
mini_batch_src_global generation:  0.04699993133544922
r_  generation:  0.41104555130004883
local_output_nid generation:  0.027597665786743164
local_in_edges_tensor generation:  0.02878570556640625
mini_batch_src_global generation:  0.048174381256103516
r_  generation:  0.3992733955383301
local_output_nid generation:  0.02808237075805664
local_in_edges_tensor generation:  0.026949644088745117
mini_batch_src_global generation:  0.048502206802368164
r_  generation:  0.4101746082305908
local_output_nid generation:  0.027936220169067383
local_in_edges_tensor generation:  0.030751943588256836
mini_batch_src_global generation:  0.048404693603515625
r_  generation:  0.40073466300964355
local_output_nid generation:  0.027782201766967773
local_in_edges_tensor generation:  0.024889469146728516
mini_batch_src_global generation:  0.04814720153808594
r_  generation:  0.4069399833679199
local_output_nid generation:  0.027758121490478516
local_in_edges_tensor generation:  0.02535223960876465
mini_batch_src_global generation:  0.04856681823730469
r_  generation:  0.39699649810791016
local_output_nid generation:  0.027902841567993164
local_in_edges_tensor generation:  0.02663445472717285
mini_batch_src_global generation:  0.04880094528198242
r_  generation:  0.4120965003967285
local_output_nid generation:  0.02784109115600586
local_in_edges_tensor generation:  0.0271914005279541
mini_batch_src_global generation:  0.04811906814575195
r_  generation:  0.4003424644470215
----------------------check_connections_block total spend ----------------------------- 19.12115716934204
generate_one_block  0.5471007823944092
generate_one_block  0.5304446220397949
generate_one_block  0.5315542221069336
generate_one_block  0.5375847816467285
generate_one_block  0.6319572925567627
generate_one_block  0.5405788421630859
generate_one_block  0.5376861095428467
generate_one_block  0.5272631645202637
generate_one_block  0.5316710472106934
generate_one_block  0.536884069442749
generate_one_block  0.5253446102142334
generate_one_block  0.5323898792266846
generate_one_block  0.5458908081054688
generate_one_block  0.5443251132965088
generate_one_block  0.5359079837799072
generate_one_block  0.5255780220031738
generate_one_block  0.5289721488952637
generate_one_block  0.5474708080291748
generate_one_block  0.5306730270385742
generate_one_block  0.5492398738861084
generate_one_block  0.5359897613525391
generate_one_block  0.5413157939910889
generate_one_block  0.5393612384796143
generate_one_block  0.5306179523468018
generate_one_block  0.5514376163482666
generate_one_block  0.5317282676696777
generate_one_block  0.5375511646270752
generate_one_block  0.5375556945800781
generate_one_block  0.5385775566101074
generate_one_block  0.5363094806671143
generate_one_block  0.5356411933898926
generate_one_block  0.5348355770111084
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.11974000930786133  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

connection checking time:  26.45840072631836
block generation total time  23.01044988632202
average batch blocks generation time:  0.7190765589475632
block dataloader generation time/epoch 51.70145197212696
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1038050651550293  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.415956020355225  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10317325592041016  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.609602928161621  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10271310806274414  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.532440662384033  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10269880294799805  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.804653644561768  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10500526428222656  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.839187622070312  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10298442840576172  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.75419282913208  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10502004623413086  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.879427909851074  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10260295867919922  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.398364543914795  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10396671295166016  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.668078899383545  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10398387908935547  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.70720100402832  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1025552749633789  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.487697124481201  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10294628143310547  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.515604972839355  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.105072021484375  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.096988677978516  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10276412963867188  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.49565601348877  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1040492057800293  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.876698017120361  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10261154174804688  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.199951648712158  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10291099548339844  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.605036735534668  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10438680648803711  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.08327293395996  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10393762588500977  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.876699924468994  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1044764518737793  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.10191535949707  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10401630401611328  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.719741821289062  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10407876968383789  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.92401933670044  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10499811172485352  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.785614490509033  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10304832458496094  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.587840557098389  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10500240325927734  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.8028564453125  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10267019271850586  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.503907203674316  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10500812530517578  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.793348789215088  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10288381576538086  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.696478366851807  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10292911529541016  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.695324420928955  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10297632217407227  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.520368576049805  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10401439666748047  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.788527011871338  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10274600982666016  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.51444149017334  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03772055357694626 |0.012110337615013123 |0.2624930664896965 |8.941441774368286e-05 |0.4292136877775192 |0.005110263824462891 |
----------------------------------------------------------pseudo_mini_loss sum 1.2609142065048218
Total (block generation + training)time/epoch 75.51145146787167
Training time/epoch 23.78876566886902
Training time without block to device /epoch 23.4012348651886
Training time without total dataloading part /epoch 22.142587661743164
load block tensor time/epoch 1.2070577144622803
block to device time/epoch 0.3875308036804199
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 25 |
Number of nodes for computation during this epoch:  8573421
Number of first layer input nodes during this epoch:  4653756
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.11935710906982422  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024428367614746094
random selection method range initialization spend 0.006441593170166016
time for parepare:  0.023744821548461914
local_output_nid generation:  0.0018897056579589844
local_in_edges_tensor generation:  0.006457805633544922
mini_batch_src_global generation:  0.0021543502807617188
r_  generation:  0.0091094970703125
local_output_nid generation:  0.0019817352294921875
local_in_edges_tensor generation:  0.001188516616821289
mini_batch_src_global generation:  0.001973867416381836
r_  generation:  0.009057044982910156
local_output_nid generation:  0.001993894577026367
local_in_edges_tensor generation:  0.0011420249938964844
mini_batch_src_global generation:  0.0013375282287597656
r_  generation:  0.008569717407226562
local_output_nid generation:  0.0020377635955810547
local_in_edges_tensor generation:  0.0010912418365478516
mini_batch_src_global generation:  0.0011680126190185547
r_  generation:  0.008381128311157227
local_output_nid generation:  0.0020492076873779297
local_in_edges_tensor generation:  0.0010781288146972656
mini_batch_src_global generation:  0.0010845661163330078
r_  generation:  0.008198261260986328
local_output_nid generation:  0.0020248889923095703
local_in_edges_tensor generation:  0.0010313987731933594
mini_batch_src_global generation:  0.0011250972747802734
r_  generation:  0.008586406707763672
local_output_nid generation:  0.002046823501586914
local_in_edges_tensor generation:  0.0010590553283691406
mini_batch_src_global generation:  0.001132965087890625
r_  generation:  0.008456945419311523
local_output_nid generation:  0.0020508766174316406
local_in_edges_tensor generation:  0.0010159015655517578
mini_batch_src_global generation:  0.001215219497680664
r_  generation:  0.008550405502319336
local_output_nid generation:  0.002092599868774414
local_in_edges_tensor generation:  0.0010225772857666016
mini_batch_src_global generation:  0.001257181167602539
r_  generation:  0.008708715438842773
local_output_nid generation:  0.002102375030517578
local_in_edges_tensor generation:  0.0010018348693847656
mini_batch_src_global generation:  0.0011050701141357422
r_  generation:  0.008475542068481445
local_output_nid generation:  0.0020880699157714844
local_in_edges_tensor generation:  0.001005411148071289
mini_batch_src_global generation:  0.0011017322540283203
r_  generation:  0.008621454238891602
local_output_nid generation:  0.002066373825073242
local_in_edges_tensor generation:  0.0010457038879394531
mini_batch_src_global generation:  0.0010979175567626953
r_  generation:  0.008347272872924805
local_output_nid generation:  0.0021049976348876953
local_in_edges_tensor generation:  0.0010404586791992188
mini_batch_src_global generation:  0.0011255741119384766
r_  generation:  0.009945154190063477
local_output_nid generation:  0.002187967300415039
local_in_edges_tensor generation:  0.001077413558959961
mini_batch_src_global generation:  0.0011246204376220703
r_  generation:  0.008420467376708984
local_output_nid generation:  0.002176523208618164
local_in_edges_tensor generation:  0.0010066032409667969
mini_batch_src_global generation:  0.0010960102081298828
r_  generation:  0.008810997009277344
local_output_nid generation:  0.0022308826446533203
local_in_edges_tensor generation:  0.0010018348693847656
mini_batch_src_global generation:  0.0010828971862792969
r_  generation:  0.00830841064453125
local_output_nid generation:  0.0021581649780273438
local_in_edges_tensor generation:  0.0010416507720947266
mini_batch_src_global generation:  0.0010688304901123047
r_  generation:  0.008518218994140625
local_output_nid generation:  0.002195119857788086
local_in_edges_tensor generation:  0.0009911060333251953
mini_batch_src_global generation:  0.0011169910430908203
r_  generation:  0.008484601974487305
local_output_nid generation:  0.002146482467651367
local_in_edges_tensor generation:  0.0010187625885009766
mini_batch_src_global generation:  0.0010292530059814453
r_  generation:  0.008384227752685547
local_output_nid generation:  0.002154111862182617
local_in_edges_tensor generation:  0.0009686946868896484
mini_batch_src_global generation:  0.0010602474212646484
r_  generation:  0.008496761322021484
local_output_nid generation:  0.0021288394927978516
local_in_edges_tensor generation:  0.0009784698486328125
mini_batch_src_global generation:  0.0010254383087158203
r_  generation:  0.008504152297973633
local_output_nid generation:  0.002134561538696289
local_in_edges_tensor generation:  0.0009562969207763672
mini_batch_src_global generation:  0.00106048583984375
r_  generation:  0.00851130485534668
local_output_nid generation:  0.002107858657836914
local_in_edges_tensor generation:  0.0009615421295166016
mini_batch_src_global generation:  0.0010111331939697266
r_  generation:  0.00849294662475586
local_output_nid generation:  0.0021042823791503906
local_in_edges_tensor generation:  0.0010101795196533203
mini_batch_src_global generation:  0.0010426044464111328
r_  generation:  0.008394718170166016
local_output_nid generation:  0.0021321773529052734
local_in_edges_tensor generation:  0.0009500980377197266
mini_batch_src_global generation:  0.0010526180267333984
r_  generation:  0.00829315185546875
local_output_nid generation:  0.0021042823791503906
local_in_edges_tensor generation:  0.0009677410125732422
mini_batch_src_global generation:  0.0010137557983398438
r_  generation:  0.008401632308959961
local_output_nid generation:  0.0020987987518310547
local_in_edges_tensor generation:  0.00098419189453125
mini_batch_src_global generation:  0.0012319087982177734
r_  generation:  0.008242368698120117
local_output_nid generation:  0.0021216869354248047
local_in_edges_tensor generation:  0.0009479522705078125
mini_batch_src_global generation:  0.0010290145874023438
r_  generation:  0.008525848388671875
local_output_nid generation:  0.0021104812622070312
local_in_edges_tensor generation:  0.0010056495666503906
mini_batch_src_global generation:  0.0011076927185058594
r_  generation:  0.008407354354858398
local_output_nid generation:  0.0021066665649414062
local_in_edges_tensor generation:  0.0009698867797851562
mini_batch_src_global generation:  0.0010924339294433594
r_  generation:  0.00854039192199707
local_output_nid generation:  0.002112865447998047
local_in_edges_tensor generation:  0.0010190010070800781
mini_batch_src_global generation:  0.001065969467163086
r_  generation:  0.008486747741699219
local_output_nid generation:  0.0021114349365234375
local_in_edges_tensor generation:  0.000982046127319336
mini_batch_src_global generation:  0.0011706352233886719
r_  generation:  0.008331775665283203
----------------------check_connections_block total spend ----------------------------- 0.5346083641052246
generate_one_block  0.02321028709411621
generate_one_block  0.020223617553710938
generate_one_block  0.016805648803710938
generate_one_block  0.016000986099243164
generate_one_block  0.015303611755371094
generate_one_block  0.015548229217529297
generate_one_block  0.028014659881591797
generate_one_block  0.015219688415527344
generate_one_block  0.01494908332824707
generate_one_block  0.014668464660644531
generate_one_block  0.01483011245727539
generate_one_block  0.014547109603881836
generate_one_block  0.015098094940185547
generate_one_block  0.014405488967895508
generate_one_block  0.014719486236572266
generate_one_block  0.014318466186523438
generate_one_block  0.014528036117553711
generate_one_block  0.01445913314819336
generate_one_block  0.014513492584228516
generate_one_block  0.014556169509887695
generate_one_block  0.014259099960327148
generate_one_block  0.014490127563476562
generate_one_block  0.018115520477294922
generate_one_block  0.01457977294921875
generate_one_block  0.014403343200683594
generate_one_block  0.014333963394165039
generate_one_block  0.013987064361572266
generate_one_block  0.014548063278198242
generate_one_block  0.014298439025878906
generate_one_block  0.014538764953613281
generate_one_block  0.014475345611572266
generate_one_block  0.014055013656616211
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.036986589431762695
gen group dst list time:  0.022802114486694336
time for parepare:  0.023837804794311523
local_output_nid generation:  0.005453348159790039
local_in_edges_tensor generation:  0.018583297729492188
mini_batch_src_global generation:  0.014617681503295898
r_  generation:  0.12485218048095703
local_output_nid generation:  0.009258270263671875
local_in_edges_tensor generation:  0.010063886642456055
mini_batch_src_global generation:  0.016492605209350586
r_  generation:  0.1296393871307373
local_output_nid generation:  0.007886886596679688
local_in_edges_tensor generation:  0.031705617904663086
mini_batch_src_global generation:  0.01504063606262207
r_  generation:  0.13519811630249023
local_output_nid generation:  0.008147239685058594
local_in_edges_tensor generation:  0.007738351821899414
mini_batch_src_global generation:  0.01653766632080078
r_  generation:  0.13507580757141113
local_output_nid generation:  0.00817108154296875
local_in_edges_tensor generation:  0.008337736129760742
mini_batch_src_global generation:  0.015248537063598633
r_  generation:  0.13472843170166016
local_output_nid generation:  0.008310556411743164
local_in_edges_tensor generation:  0.00826573371887207
mini_batch_src_global generation:  0.016901254653930664
r_  generation:  0.13929390907287598
local_output_nid generation:  0.00915980339050293
local_in_edges_tensor generation:  0.009693622589111328
mini_batch_src_global generation:  0.015982866287231445
r_  generation:  0.14133000373840332
local_output_nid generation:  0.008149147033691406
local_in_edges_tensor generation:  0.009902477264404297
mini_batch_src_global generation:  0.017252445220947266
r_  generation:  0.14009451866149902
local_output_nid generation:  0.008632183074951172
local_in_edges_tensor generation:  0.008044958114624023
mini_batch_src_global generation:  0.017619848251342773
r_  generation:  0.14438819885253906
local_output_nid generation:  0.007924795150756836
local_in_edges_tensor generation:  0.010241985321044922
mini_batch_src_global generation:  0.016955137252807617
r_  generation:  0.13665509223937988
local_output_nid generation:  0.008417367935180664
local_in_edges_tensor generation:  0.010153770446777344
mini_batch_src_global generation:  0.01718878746032715
r_  generation:  0.14238262176513672
local_output_nid generation:  0.008303165435791016
local_in_edges_tensor generation:  0.009541511535644531
mini_batch_src_global generation:  0.017063617706298828
r_  generation:  0.13375186920166016
local_output_nid generation:  0.008633852005004883
local_in_edges_tensor generation:  0.008023977279663086
mini_batch_src_global generation:  0.01714158058166504
r_  generation:  0.17745065689086914
local_output_nid generation:  0.008298635482788086
local_in_edges_tensor generation:  0.007710933685302734
mini_batch_src_global generation:  0.016895294189453125
r_  generation:  0.13669705390930176
local_output_nid generation:  0.008331298828125
local_in_edges_tensor generation:  0.007874727249145508
mini_batch_src_global generation:  0.01696324348449707
r_  generation:  0.14128923416137695
local_output_nid generation:  0.008348464965820312
local_in_edges_tensor generation:  0.007803678512573242
mini_batch_src_global generation:  0.0175168514251709
r_  generation:  0.136765718460083
local_output_nid generation:  0.00840449333190918
local_in_edges_tensor generation:  0.008495807647705078
mini_batch_src_global generation:  0.016316652297973633
r_  generation:  0.13920378684997559
local_output_nid generation:  0.008353948593139648
local_in_edges_tensor generation:  0.008286476135253906
mini_batch_src_global generation:  0.017058372497558594
r_  generation:  0.13665342330932617
local_output_nid generation:  0.008405208587646484
local_in_edges_tensor generation:  0.009362459182739258
mini_batch_src_global generation:  0.016087055206298828
r_  generation:  0.14115405082702637
local_output_nid generation:  0.00826406478881836
local_in_edges_tensor generation:  0.011966228485107422
mini_batch_src_global generation:  0.01671624183654785
r_  generation:  0.13979673385620117
local_output_nid generation:  0.008152961730957031
local_in_edges_tensor generation:  0.008762121200561523
mini_batch_src_global generation:  0.01755547523498535
r_  generation:  0.14293336868286133
local_output_nid generation:  0.010128498077392578
local_in_edges_tensor generation:  0.008246183395385742
mini_batch_src_global generation:  0.021412134170532227
r_  generation:  0.1388106346130371
local_output_nid generation:  0.008291244506835938
local_in_edges_tensor generation:  0.007752180099487305
mini_batch_src_global generation:  0.015979528427124023
r_  generation:  0.1364881992340088
local_output_nid generation:  0.008264303207397461
local_in_edges_tensor generation:  0.007710456848144531
mini_batch_src_global generation:  0.016712188720703125
r_  generation:  0.1362168788909912
local_output_nid generation:  0.008419275283813477
local_in_edges_tensor generation:  0.007941007614135742
mini_batch_src_global generation:  0.01580524444580078
r_  generation:  0.1385049819946289
local_output_nid generation:  0.008344411849975586
local_in_edges_tensor generation:  0.007726192474365234
mini_batch_src_global generation:  0.016469955444335938
r_  generation:  0.13484525680541992
local_output_nid generation:  0.00826883316040039
local_in_edges_tensor generation:  0.008368968963623047
mini_batch_src_global generation:  0.015136957168579102
r_  generation:  0.1351151466369629
local_output_nid generation:  0.008458375930786133
local_in_edges_tensor generation:  0.007549285888671875
mini_batch_src_global generation:  0.016849040985107422
r_  generation:  0.13875102996826172
local_output_nid generation:  0.008463621139526367
local_in_edges_tensor generation:  0.008456230163574219
mini_batch_src_global generation:  0.01587080955505371
r_  generation:  0.1385035514831543
local_output_nid generation:  0.008451223373413086
local_in_edges_tensor generation:  0.008087635040283203
mini_batch_src_global generation:  0.016578197479248047
r_  generation:  0.1379711627960205
local_output_nid generation:  0.008563756942749023
local_in_edges_tensor generation:  0.008718252182006836
mini_batch_src_global generation:  0.016147375106811523
r_  generation:  0.13967084884643555
local_output_nid generation:  0.00836944580078125
local_in_edges_tensor generation:  0.007565975189208984
mini_batch_src_global generation:  0.016491174697875977
r_  generation:  0.13479900360107422
----------------------check_connections_block total spend ----------------------------- 6.615035772323608
generate_one_block  0.1819758415222168
generate_one_block  0.18489837646484375
generate_one_block  0.18130707740783691
generate_one_block  0.18020939826965332
generate_one_block  0.1879570484161377
generate_one_block  0.1786808967590332
generate_one_block  0.178816556930542
generate_one_block  0.17749524116516113
generate_one_block  0.1784811019897461
generate_one_block  0.17499160766601562
generate_one_block  0.18221592903137207
generate_one_block  0.17274141311645508
generate_one_block  0.1822659969329834
generate_one_block  0.1768507957458496
generate_one_block  0.18124818801879883
generate_one_block  0.1769242286682129
generate_one_block  0.1791844367980957
generate_one_block  0.17604422569274902
generate_one_block  0.1767439842224121
generate_one_block  0.18653178215026855
generate_one_block  0.18427443504333496
generate_one_block  0.17641711235046387
generate_one_block  0.1753380298614502
generate_one_block  0.18006134033203125
generate_one_block  0.17749428749084473
generate_one_block  0.17360949516296387
generate_one_block  0.1724839210510254
generate_one_block  0.1842637062072754
generate_one_block  0.17862343788146973
generate_one_block  0.17809653282165527
generate_one_block  0.18205785751342773
generate_one_block  0.1771867275238037
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03261613845825195
gen group dst list time:  0.10436463356018066
time for parepare:  0.019742250442504883
local_output_nid generation:  0.02560567855834961
local_in_edges_tensor generation:  0.04528522491455078
mini_batch_src_global generation:  0.036626338958740234
r_  generation:  0.39316701889038086
local_output_nid generation:  0.029301881790161133
local_in_edges_tensor generation:  0.03402447700500488
mini_batch_src_global generation:  0.050009965896606445
r_  generation:  0.3964042663574219
local_output_nid generation:  0.02891993522644043
local_in_edges_tensor generation:  0.028092384338378906
mini_batch_src_global generation:  0.05717349052429199
r_  generation:  0.40926289558410645
local_output_nid generation:  0.030855417251586914
local_in_edges_tensor generation:  0.03023552894592285
mini_batch_src_global generation:  0.04717850685119629
r_  generation:  0.39563512802124023
local_output_nid generation:  0.029154539108276367
local_in_edges_tensor generation:  0.0287477970123291
mini_batch_src_global generation:  0.04566693305969238
r_  generation:  0.4025881290435791
local_output_nid generation:  0.028657197952270508
local_in_edges_tensor generation:  0.02530694007873535
mini_batch_src_global generation:  0.047446489334106445
r_  generation:  0.39707112312316895
local_output_nid generation:  0.02764439582824707
local_in_edges_tensor generation:  0.027840614318847656
mini_batch_src_global generation:  0.04581642150878906
r_  generation:  0.40360403060913086
local_output_nid generation:  0.027337074279785156
local_in_edges_tensor generation:  0.0259857177734375
mini_batch_src_global generation:  0.04777264595031738
r_  generation:  0.397385835647583
local_output_nid generation:  0.02788066864013672
local_in_edges_tensor generation:  0.025124788284301758
mini_batch_src_global generation:  0.048193931579589844
r_  generation:  0.41041064262390137
local_output_nid generation:  0.027756452560424805
local_in_edges_tensor generation:  0.025179386138916016
mini_batch_src_global generation:  0.0477902889251709
r_  generation:  0.3970153331756592
local_output_nid generation:  0.02783656120300293
local_in_edges_tensor generation:  0.0267484188079834
mini_batch_src_global generation:  0.0478215217590332
r_  generation:  0.41287875175476074
local_output_nid generation:  0.028984785079956055
local_in_edges_tensor generation:  0.03051924705505371
mini_batch_src_global generation:  0.05065131187438965
r_  generation:  0.39875054359436035
local_output_nid generation:  0.028550386428833008
local_in_edges_tensor generation:  0.028727293014526367
mini_batch_src_global generation:  0.04859209060668945
r_  generation:  0.4132499694824219
local_output_nid generation:  0.029321670532226562
local_in_edges_tensor generation:  0.02878427505493164
mini_batch_src_global generation:  0.04842662811279297
r_  generation:  0.4026954174041748
local_output_nid generation:  0.027654647827148438
local_in_edges_tensor generation:  0.02651357650756836
mini_batch_src_global generation:  0.046855926513671875
r_  generation:  0.4077796936035156
local_output_nid generation:  0.027811288833618164
local_in_edges_tensor generation:  0.029064655303955078
mini_batch_src_global generation:  0.04837298393249512
r_  generation:  0.4032750129699707
local_output_nid generation:  0.027886390686035156
local_in_edges_tensor generation:  0.029034852981567383
mini_batch_src_global generation:  0.04686117172241211
r_  generation:  0.4088726043701172
local_output_nid generation:  0.027912139892578125
local_in_edges_tensor generation:  0.030625104904174805
mini_batch_src_global generation:  0.048210859298706055
r_  generation:  0.39733219146728516
local_output_nid generation:  0.027549266815185547
local_in_edges_tensor generation:  0.03127861022949219
mini_batch_src_global generation:  0.047170400619506836
r_  generation:  0.4010460376739502
local_output_nid generation:  0.027538299560546875
local_in_edges_tensor generation:  0.025152921676635742
mini_batch_src_global generation:  0.04833269119262695
r_  generation:  0.39606451988220215
local_output_nid generation:  0.027631044387817383
local_in_edges_tensor generation:  0.032315731048583984
mini_batch_src_global generation:  0.048056602478027344
r_  generation:  0.4018096923828125
local_output_nid generation:  0.02764105796813965
local_in_edges_tensor generation:  0.026159286499023438
mini_batch_src_global generation:  0.04792308807373047
r_  generation:  0.3976166248321533
local_output_nid generation:  0.027547121047973633
local_in_edges_tensor generation:  0.024586915969848633
mini_batch_src_global generation:  0.04614877700805664
r_  generation:  0.4197664260864258
local_output_nid generation:  0.029470443725585938
local_in_edges_tensor generation:  0.029956340789794922
mini_batch_src_global generation:  0.04860234260559082
r_  generation:  0.40279674530029297
local_output_nid generation:  0.02808403968811035
local_in_edges_tensor generation:  0.027186155319213867
mini_batch_src_global generation:  0.04599499702453613
r_  generation:  0.4034297466278076
local_output_nid generation:  0.02745819091796875
local_in_edges_tensor generation:  0.02450251579284668
mini_batch_src_global generation:  0.04727745056152344
r_  generation:  0.3981630802154541
local_output_nid generation:  0.026914596557617188
local_in_edges_tensor generation:  0.02508544921875
mini_batch_src_global generation:  0.046193838119506836
r_  generation:  0.40720367431640625
local_output_nid generation:  0.02777838706970215
local_in_edges_tensor generation:  0.024692773818969727
mini_batch_src_global generation:  0.04754948616027832
r_  generation:  0.40015172958374023
local_output_nid generation:  0.03230571746826172
local_in_edges_tensor generation:  0.027874469757080078
mini_batch_src_global generation:  0.04659605026245117
r_  generation:  0.4068293571472168
local_output_nid generation:  0.02757549285888672
local_in_edges_tensor generation:  0.026519775390625
mini_batch_src_global generation:  0.04968547821044922
r_  generation:  0.40073609352111816
local_output_nid generation:  0.027799367904663086
local_in_edges_tensor generation:  0.025255203247070312
mini_batch_src_global generation:  0.04635024070739746
r_  generation:  0.4089019298553467
local_output_nid generation:  0.02750110626220703
local_in_edges_tensor generation:  0.026625871658325195
mini_batch_src_global generation:  0.04953145980834961
r_  generation:  0.39820027351379395
----------------------check_connections_block total spend ----------------------------- 19.08868145942688
generate_one_block  0.5410294532775879
generate_one_block  0.5354971885681152
generate_one_block  0.5360407829284668
generate_one_block  0.5343153476715088
generate_one_block  0.6251282691955566
generate_one_block  0.5339534282684326
generate_one_block  0.5321948528289795
generate_one_block  0.5323913097381592
generate_one_block  0.5411276817321777
generate_one_block  0.5261151790618896
generate_one_block  0.545910120010376
generate_one_block  0.5277087688446045
generate_one_block  0.5463278293609619
generate_one_block  0.5353701114654541
generate_one_block  0.5370073318481445
generate_one_block  0.5332629680633545
generate_one_block  0.5380668640136719
generate_one_block  0.5368132591247559
generate_one_block  0.5316901206970215
generate_one_block  0.537717342376709
generate_one_block  0.5346148014068604
generate_one_block  0.5286056995391846
generate_one_block  0.5400636196136475
generate_one_block  0.5428602695465088
generate_one_block  0.5422449111938477
generate_one_block  0.5278325080871582
generate_one_block  0.5211682319641113
generate_one_block  0.5423760414123535
generate_one_block  0.5399439334869385
generate_one_block  0.5286335945129395
generate_one_block  0.5366754531860352
generate_one_block  0.5325577259063721
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.11935710906982422  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

connection checking time:  25.70371723175049
block generation total time  22.960716009140015
average batch blocks generation time:  0.7175223752856255
block dataloader generation time/epoch 51.674448027330286
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1039423942565918  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.640373229980469  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1042323112487793  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.901074409484863  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1039571762084961  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.93418550491333  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10318517684936523  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.812425136566162  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1027073860168457  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.517537593841553  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10306262969970703  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.76884412765503  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10285758972167969  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.753473281860352  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10285329818725586  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.6766357421875  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10502195358276367  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.921900749206543  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10264301300048828  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.619330883026123  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10404205322265625  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.004805088043213  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1028127670288086  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.524129390716553  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10505485534667969  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.04412031173706  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10281229019165039  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.734161376953125  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10358905792236328  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.890999794006348  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1042170524597168  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.76976203918457  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.105010986328125  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.843918323516846  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1042790412902832  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.753836154937744  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10288858413696289  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.60107421875  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1029052734375  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.714973449707031  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10381889343261719  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.457408428192139  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10281229019165039  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.562585830688477  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10385704040527344  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.483278274536133  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10292720794677734  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.66073226928711  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10390663146972656  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.557907581329346  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10258913040161133  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.49965238571167  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10229110717773438  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.180490493774414  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10392999649047852  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.825159072875977  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10395240783691406  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.608898162841797  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1026763916015625  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.615052223205566  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1040182113647461  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.732466697692871  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10303735733032227  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.530451774597168  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03733154386281967 |0.01068916916847229 |0.26316697895526886 |9.004771709442139e-05 |0.42872748523950577 |0.005681514739990234 |
----------------------------------------------------------pseudo_mini_loss sum 1.2465959787368774
Total (block generation + training)time/epoch 75.48006248474121
Training time/epoch 23.73520064353943
Training time without block to device /epoch 23.393147230148315
Training time without total dataloading part /epoch 22.1491858959198
load block tensor time/epoch 1.1946094036102295
block to device time/epoch 0.3420534133911133
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 26 |
Number of nodes for computation during this epoch:  8571544
Number of first layer input nodes during this epoch:  4651682
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.12000894546508789  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02158665657043457
random selection method range initialization spend 0.006695985794067383
time for parepare:  0.019804716110229492
local_output_nid generation:  0.0013244152069091797
local_in_edges_tensor generation:  0.0036039352416992188
mini_batch_src_global generation:  0.0019898414611816406
r_  generation:  0.010192394256591797
local_output_nid generation:  0.0016357898712158203
local_in_edges_tensor generation:  0.0009138584136962891
mini_batch_src_global generation:  0.00133514404296875
r_  generation:  0.008239269256591797
local_output_nid generation:  0.001552581787109375
local_in_edges_tensor generation:  0.0008227825164794922
mini_batch_src_global generation:  0.0010991096496582031
r_  generation:  0.008110284805297852
local_output_nid generation:  0.0015156269073486328
local_in_edges_tensor generation:  0.0007946491241455078
mini_batch_src_global generation:  0.0010790824890136719
r_  generation:  0.00828695297241211
local_output_nid generation:  0.0015063285827636719
local_in_edges_tensor generation:  0.0007686614990234375
mini_batch_src_global generation:  0.0010383129119873047
r_  generation:  0.008285760879516602
local_output_nid generation:  0.0015213489532470703
local_in_edges_tensor generation:  0.0007975101470947266
mini_batch_src_global generation:  0.0009796619415283203
r_  generation:  0.008233070373535156
local_output_nid generation:  0.0014750957489013672
local_in_edges_tensor generation:  0.0007839202880859375
mini_batch_src_global generation:  0.0010311603546142578
r_  generation:  0.008219242095947266
local_output_nid generation:  0.001499176025390625
local_in_edges_tensor generation:  0.0007560253143310547
mini_batch_src_global generation:  0.0009562969207763672
r_  generation:  0.008205413818359375
local_output_nid generation:  0.0014729499816894531
local_in_edges_tensor generation:  0.0007450580596923828
mini_batch_src_global generation:  0.0009241104125976562
r_  generation:  0.008246421813964844
local_output_nid generation:  0.0014805793762207031
local_in_edges_tensor generation:  0.0007467269897460938
mini_batch_src_global generation:  0.0009355545043945312
r_  generation:  0.008227109909057617
local_output_nid generation:  0.001462697982788086
local_in_edges_tensor generation:  0.0007557868957519531
mini_batch_src_global generation:  0.00093841552734375
r_  generation:  0.008219003677368164
local_output_nid generation:  0.0014657974243164062
local_in_edges_tensor generation:  0.0007593631744384766
mini_batch_src_global generation:  0.0009205341339111328
r_  generation:  0.008404016494750977
local_output_nid generation:  0.0014681816101074219
local_in_edges_tensor generation:  0.0007417201995849609
mini_batch_src_global generation:  0.0009319782257080078
r_  generation:  0.008286714553833008
local_output_nid generation:  0.0014543533325195312
local_in_edges_tensor generation:  0.0007488727569580078
mini_batch_src_global generation:  0.0009291172027587891
r_  generation:  0.00855255126953125
local_output_nid generation:  0.0014481544494628906
local_in_edges_tensor generation:  0.0007519721984863281
mini_batch_src_global generation:  0.00093841552734375
r_  generation:  0.008469343185424805
local_output_nid generation:  0.001459360122680664
local_in_edges_tensor generation:  0.0007984638214111328
mini_batch_src_global generation:  0.0009322166442871094
r_  generation:  0.008165597915649414
local_output_nid generation:  0.0014584064483642578
local_in_edges_tensor generation:  0.0007417201995849609
mini_batch_src_global generation:  0.0009129047393798828
r_  generation:  0.008239984512329102
local_output_nid generation:  0.001455545425415039
local_in_edges_tensor generation:  0.0007753372192382812
mini_batch_src_global generation:  0.0009469985961914062
r_  generation:  0.008341312408447266
local_output_nid generation:  0.0014460086822509766
local_in_edges_tensor generation:  0.0007293224334716797
mini_batch_src_global generation:  0.00091552734375
r_  generation:  0.00834345817565918
local_output_nid generation:  0.0014672279357910156
local_in_edges_tensor generation:  0.0007684230804443359
mini_batch_src_global generation:  0.0009217262268066406
r_  generation:  0.008400201797485352
local_output_nid generation:  0.00153350830078125
local_in_edges_tensor generation:  0.0007531642913818359
mini_batch_src_global generation:  0.0009098052978515625
r_  generation:  0.008018970489501953
local_output_nid generation:  0.0014653205871582031
local_in_edges_tensor generation:  0.0007424354553222656
mini_batch_src_global generation:  0.0009341239929199219
r_  generation:  0.008428573608398438
local_output_nid generation:  0.0014600753784179688
local_in_edges_tensor generation:  0.0007696151733398438
mini_batch_src_global generation:  0.0009450912475585938
r_  generation:  0.008458137512207031
local_output_nid generation:  0.0014486312866210938
local_in_edges_tensor generation:  0.00075531005859375
mini_batch_src_global generation:  0.0009584426879882812
r_  generation:  0.00824284553527832
local_output_nid generation:  0.0014755725860595703
local_in_edges_tensor generation:  0.0007548332214355469
mini_batch_src_global generation:  0.0009760856628417969
r_  generation:  0.00856328010559082
local_output_nid generation:  0.0014641284942626953
local_in_edges_tensor generation:  0.0007467269897460938
mini_batch_src_global generation:  0.000946044921875
r_  generation:  0.008305072784423828
local_output_nid generation:  0.0014674663543701172
local_in_edges_tensor generation:  0.0007646083831787109
mini_batch_src_global generation:  0.0009319782257080078
r_  generation:  0.008337974548339844
local_output_nid generation:  0.0014557838439941406
local_in_edges_tensor generation:  0.0007309913635253906
mini_batch_src_global generation:  0.0009133815765380859
r_  generation:  0.008246183395385742
local_output_nid generation:  0.001458883285522461
local_in_edges_tensor generation:  0.0007300376892089844
mini_batch_src_global generation:  0.0009093284606933594
r_  generation:  0.008209466934204102
local_output_nid generation:  0.001447916030883789
local_in_edges_tensor generation:  0.0007226467132568359
mini_batch_src_global generation:  0.0009245872497558594
r_  generation:  0.008300542831420898
local_output_nid generation:  0.0014505386352539062
local_in_edges_tensor generation:  0.0007467269897460938
mini_batch_src_global generation:  0.0009088516235351562
r_  generation:  0.008307933807373047
local_output_nid generation:  0.001447916030883789
local_in_edges_tensor generation:  0.0007398128509521484
mini_batch_src_global generation:  0.0009071826934814453
r_  generation:  0.00828409194946289
----------------------check_connections_block total spend ----------------------------- 0.4761641025543213
generate_one_block  0.01710963249206543
generate_one_block  0.017199277877807617
generate_one_block  0.015163898468017578
generate_one_block  0.014936447143554688
generate_one_block  0.014878273010253906
generate_one_block  0.014435291290283203
generate_one_block  0.014423847198486328
generate_one_block  0.014498472213745117
generate_one_block  0.014693498611450195
generate_one_block  0.014420509338378906
generate_one_block  0.014374494552612305
generate_one_block  0.014679193496704102
generate_one_block  0.014386415481567383
generate_one_block  0.014540910720825195
generate_one_block  0.014711141586303711
generate_one_block  0.014197111129760742
generate_one_block  0.014518260955810547
generate_one_block  0.014490365982055664
generate_one_block  0.014534711837768555
generate_one_block  0.014615058898925781
generate_one_block  0.013988971710205078
generate_one_block  0.014633893966674805
generate_one_block  0.017601966857910156
generate_one_block  0.01459813117980957
generate_one_block  0.014961957931518555
generate_one_block  0.01444864273071289
generate_one_block  0.014417171478271484
generate_one_block  0.014325618743896484
generate_one_block  0.01421213150024414
generate_one_block  0.014387845993041992
generate_one_block  0.014534711837768555
generate_one_block  0.01432180404663086
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0358729362487793
gen group dst list time:  0.02062058448791504
time for parepare:  0.020006656646728516
local_output_nid generation:  0.005646228790283203
local_in_edges_tensor generation:  0.01606893539428711
mini_batch_src_global generation:  0.016167163848876953
r_  generation:  0.13039875030517578
local_output_nid generation:  0.007647275924682617
local_in_edges_tensor generation:  0.00936579704284668
mini_batch_src_global generation:  0.02564549446105957
r_  generation:  0.1320655345916748
local_output_nid generation:  0.01215362548828125
local_in_edges_tensor generation:  0.04236030578613281
mini_batch_src_global generation:  0.02977919578552246
r_  generation:  0.13857007026672363
local_output_nid generation:  0.00957489013671875
local_in_edges_tensor generation:  0.009712934494018555
mini_batch_src_global generation:  0.01855778694152832
r_  generation:  0.15872502326965332
local_output_nid generation:  0.0136871337890625
local_in_edges_tensor generation:  0.01063084602355957
mini_batch_src_global generation:  0.01771092414855957
r_  generation:  0.15320110321044922
local_output_nid generation:  0.01334238052368164
local_in_edges_tensor generation:  0.01152801513671875
mini_batch_src_global generation:  0.018453598022460938
r_  generation:  0.14361119270324707
local_output_nid generation:  0.013305425643920898
local_in_edges_tensor generation:  0.017588138580322266
mini_batch_src_global generation:  0.039391279220581055
r_  generation:  0.14299464225769043
local_output_nid generation:  0.01108694076538086
local_in_edges_tensor generation:  0.009444713592529297
mini_batch_src_global generation:  0.019934892654418945
r_  generation:  0.14472103118896484
local_output_nid generation:  0.009106636047363281
local_in_edges_tensor generation:  0.00807332992553711
mini_batch_src_global generation:  0.029850006103515625
r_  generation:  0.15668964385986328
local_output_nid generation:  0.012227535247802734
local_in_edges_tensor generation:  0.01120615005493164
mini_batch_src_global generation:  0.02126598358154297
r_  generation:  0.1505904197692871
local_output_nid generation:  0.009826898574829102
local_in_edges_tensor generation:  0.013632774353027344
mini_batch_src_global generation:  0.020160198211669922
r_  generation:  0.14879488945007324
local_output_nid generation:  0.008993148803710938
local_in_edges_tensor generation:  0.011293172836303711
mini_batch_src_global generation:  0.020334482192993164
r_  generation:  0.1744694709777832
local_output_nid generation:  0.011758089065551758
local_in_edges_tensor generation:  0.010813474655151367
mini_batch_src_global generation:  0.022741079330444336
r_  generation:  0.14607524871826172
local_output_nid generation:  0.008454322814941406
local_in_edges_tensor generation:  0.009032487869262695
mini_batch_src_global generation:  0.023316621780395508
r_  generation:  0.14786601066589355
local_output_nid generation:  0.009290695190429688
local_in_edges_tensor generation:  0.00875544548034668
mini_batch_src_global generation:  0.02196049690246582
r_  generation:  0.1481175422668457
local_output_nid generation:  0.008405208587646484
local_in_edges_tensor generation:  0.007560014724731445
mini_batch_src_global generation:  0.01798534393310547
r_  generation:  0.14322543144226074
local_output_nid generation:  0.008251428604125977
local_in_edges_tensor generation:  0.00806570053100586
mini_batch_src_global generation:  0.017415523529052734
r_  generation:  0.14385652542114258
local_output_nid generation:  0.008362770080566406
local_in_edges_tensor generation:  0.008179664611816406
mini_batch_src_global generation:  0.017908096313476562
r_  generation:  0.18553566932678223
local_output_nid generation:  0.008192300796508789
local_in_edges_tensor generation:  0.007846593856811523
mini_batch_src_global generation:  0.018294334411621094
r_  generation:  0.14443206787109375
local_output_nid generation:  0.008259296417236328
local_in_edges_tensor generation:  0.00791025161743164
mini_batch_src_global generation:  0.02086663246154785
r_  generation:  0.14322400093078613
local_output_nid generation:  0.007886409759521484
local_in_edges_tensor generation:  0.008312225341796875
mini_batch_src_global generation:  0.016696453094482422
r_  generation:  0.13893890380859375
local_output_nid generation:  0.008057594299316406
local_in_edges_tensor generation:  0.007556915283203125
mini_batch_src_global generation:  0.018002033233642578
r_  generation:  0.14556336402893066
local_output_nid generation:  0.008030891418457031
local_in_edges_tensor generation:  0.00836038589477539
mini_batch_src_global generation:  0.017839431762695312
r_  generation:  0.14501690864562988
local_output_nid generation:  0.008062124252319336
local_in_edges_tensor generation:  0.00802469253540039
mini_batch_src_global generation:  0.017878055572509766
r_  generation:  0.1410374641418457
local_output_nid generation:  0.00991964340209961
local_in_edges_tensor generation:  0.0077953338623046875
mini_batch_src_global generation:  0.029293060302734375
r_  generation:  0.1640017032623291
local_output_nid generation:  0.010136604309082031
local_in_edges_tensor generation:  0.008526086807250977
mini_batch_src_global generation:  0.018302202224731445
r_  generation:  0.1457812786102295
local_output_nid generation:  0.00890350341796875
local_in_edges_tensor generation:  0.008233070373535156
mini_batch_src_global generation:  0.017196178436279297
r_  generation:  0.14532899856567383
local_output_nid generation:  0.00851130485534668
local_in_edges_tensor generation:  0.007974386215209961
mini_batch_src_global generation:  0.027044057846069336
r_  generation:  0.1467273235321045
local_output_nid generation:  0.008428335189819336
local_in_edges_tensor generation:  0.007565736770629883
mini_batch_src_global generation:  0.026544570922851562
r_  generation:  0.17590618133544922
local_output_nid generation:  0.009087800979614258
local_in_edges_tensor generation:  0.0076751708984375
mini_batch_src_global generation:  0.018706083297729492
r_  generation:  0.14560556411743164
local_output_nid generation:  0.008564233779907227
local_in_edges_tensor generation:  0.009206533432006836
mini_batch_src_global generation:  0.018260717391967773
r_  generation:  0.14589858055114746
local_output_nid generation:  0.008533716201782227
local_in_edges_tensor generation:  0.010083198547363281
mini_batch_src_global generation:  0.017912626266479492
r_  generation:  0.1506032943725586
----------------------check_connections_block total spend ----------------------------- 7.271481275558472
generate_one_block  0.19125771522521973
generate_one_block  0.17005324363708496
generate_one_block  0.17673873901367188
generate_one_block  0.1815049648284912
generate_one_block  0.1974937915802002
generate_one_block  0.17304515838623047
generate_one_block  0.17545056343078613
generate_one_block  0.17679786682128906
generate_one_block  0.17585515975952148
generate_one_block  0.17690706253051758
generate_one_block  0.17590713500976562
generate_one_block  0.17631053924560547
generate_one_block  0.17303800582885742
generate_one_block  0.18018722534179688
generate_one_block  0.18031835556030273
generate_one_block  0.1764240264892578
generate_one_block  0.17621278762817383
generate_one_block  0.18019390106201172
generate_one_block  0.1764223575592041
generate_one_block  0.17957806587219238
generate_one_block  0.16850614547729492
generate_one_block  0.18103623390197754
generate_one_block  0.1747431755065918
generate_one_block  0.17067503929138184
generate_one_block  0.19031953811645508
generate_one_block  0.17917203903198242
generate_one_block  0.17896509170532227
generate_one_block  0.1747133731842041
generate_one_block  0.17492246627807617
generate_one_block  0.17757678031921387
generate_one_block  0.17924261093139648
generate_one_block  0.1827538013458252
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03402829170227051
gen group dst list time:  0.10385775566101074
time for parepare:  0.019151687622070312
local_output_nid generation:  0.02389216423034668
local_in_edges_tensor generation:  0.04752540588378906
mini_batch_src_global generation:  0.03699040412902832
r_  generation:  0.40122342109680176
local_output_nid generation:  0.029967308044433594
local_in_edges_tensor generation:  0.03123164176940918
mini_batch_src_global generation:  0.04895329475402832
r_  generation:  0.3939094543457031
local_output_nid generation:  0.029341936111450195
local_in_edges_tensor generation:  0.030873537063598633
mini_batch_src_global generation:  0.045583248138427734
r_  generation:  0.4144096374511719
local_output_nid generation:  0.030861377716064453
local_in_edges_tensor generation:  0.028940916061401367
mini_batch_src_global generation:  0.04909706115722656
r_  generation:  0.4013967514038086
local_output_nid generation:  0.02915334701538086
local_in_edges_tensor generation:  0.03132915496826172
mini_batch_src_global generation:  0.04718804359436035
r_  generation:  0.4095802307128906
local_output_nid generation:  0.028284072875976562
local_in_edges_tensor generation:  0.028596878051757812
mini_batch_src_global generation:  0.06176447868347168
r_  generation:  0.4015994071960449
local_output_nid generation:  0.029296875
local_in_edges_tensor generation:  0.028902053833007812
mini_batch_src_global generation:  0.04847407341003418
r_  generation:  0.40782785415649414
local_output_nid generation:  0.027979373931884766
local_in_edges_tensor generation:  0.024768590927124023
mini_batch_src_global generation:  0.04771256446838379
r_  generation:  0.39630770683288574
local_output_nid generation:  0.027770519256591797
local_in_edges_tensor generation:  0.026487112045288086
mini_batch_src_global generation:  0.04661822319030762
r_  generation:  0.40094780921936035
local_output_nid generation:  0.02775883674621582
local_in_edges_tensor generation:  0.024349689483642578
mini_batch_src_global generation:  0.047981977462768555
r_  generation:  0.4000394344329834
local_output_nid generation:  0.027752161026000977
local_in_edges_tensor generation:  0.027717113494873047
mini_batch_src_global generation:  0.04839730262756348
r_  generation:  0.40828442573547363
local_output_nid generation:  0.027814626693725586
local_in_edges_tensor generation:  0.024979591369628906
mini_batch_src_global generation:  0.047891855239868164
r_  generation:  0.4067714214324951
local_output_nid generation:  0.027878999710083008
local_in_edges_tensor generation:  0.026395797729492188
mini_batch_src_global generation:  0.04664254188537598
r_  generation:  0.4089176654815674
local_output_nid generation:  0.027581214904785156
local_in_edges_tensor generation:  0.026650190353393555
mini_batch_src_global generation:  0.04742717742919922
r_  generation:  0.3995933532714844
local_output_nid generation:  0.029147863388061523
local_in_edges_tensor generation:  0.0272064208984375
mini_batch_src_global generation:  0.04724931716918945
r_  generation:  0.41170525550842285
local_output_nid generation:  0.027840852737426758
local_in_edges_tensor generation:  0.026989221572875977
mini_batch_src_global generation:  0.04809761047363281
r_  generation:  0.40245914459228516
local_output_nid generation:  0.027861595153808594
local_in_edges_tensor generation:  0.02646327018737793
mini_batch_src_global generation:  0.04688096046447754
r_  generation:  0.410996675491333
local_output_nid generation:  0.02790236473083496
local_in_edges_tensor generation:  0.026556730270385742
mini_batch_src_global generation:  0.04760313034057617
r_  generation:  0.40363430976867676
local_output_nid generation:  0.029568195343017578
local_in_edges_tensor generation:  0.029288053512573242
mini_batch_src_global generation:  0.046530723571777344
r_  generation:  0.4129476547241211
local_output_nid generation:  0.027895689010620117
local_in_edges_tensor generation:  0.028434276580810547
mini_batch_src_global generation:  0.04793882369995117
r_  generation:  0.4092557430267334
local_output_nid generation:  0.027367353439331055
local_in_edges_tensor generation:  0.029596805572509766
mini_batch_src_global generation:  0.04712510108947754
r_  generation:  0.4052155017852783
local_output_nid generation:  0.02806544303894043
local_in_edges_tensor generation:  0.028486967086791992
mini_batch_src_global generation:  0.05048394203186035
r_  generation:  0.4131758213043213
local_output_nid generation:  0.02752995491027832
local_in_edges_tensor generation:  0.02572798728942871
mini_batch_src_global generation:  0.04905867576599121
r_  generation:  0.4242091178894043
local_output_nid generation:  0.0294339656829834
local_in_edges_tensor generation:  0.024487018585205078
mini_batch_src_global generation:  0.0482633113861084
r_  generation:  0.4005427360534668
local_output_nid generation:  0.028907299041748047
local_in_edges_tensor generation:  0.02884674072265625
mini_batch_src_global generation:  0.04792928695678711
r_  generation:  0.41214489936828613
local_output_nid generation:  0.027955293655395508
local_in_edges_tensor generation:  0.031349897384643555
mini_batch_src_global generation:  0.049596548080444336
r_  generation:  0.4054093360900879
local_output_nid generation:  0.02765345573425293
local_in_edges_tensor generation:  0.02553534507751465
mini_batch_src_global generation:  0.046259403228759766
r_  generation:  0.4263463020324707
local_output_nid generation:  0.027540922164916992
local_in_edges_tensor generation:  0.028990507125854492
mini_batch_src_global generation:  0.048310041427612305
r_  generation:  0.40390515327453613
local_output_nid generation:  0.027719497680664062
local_in_edges_tensor generation:  0.024450302124023438
mini_batch_src_global generation:  0.048349857330322266
r_  generation:  0.4113602638244629
local_output_nid generation:  0.027935028076171875
local_in_edges_tensor generation:  0.026465177536010742
mini_batch_src_global generation:  0.04916882514953613
r_  generation:  0.4034433364868164
local_output_nid generation:  0.027756214141845703
local_in_edges_tensor generation:  0.02794957160949707
mini_batch_src_global generation:  0.046596527099609375
r_  generation:  0.4138047695159912
local_output_nid generation:  0.027842283248901367
local_in_edges_tensor generation:  0.026238441467285156
mini_batch_src_global generation:  0.04829907417297363
r_  generation:  0.401409387588501
----------------------check_connections_block total spend ----------------------------- 19.244283437728882
generate_one_block  0.5543315410614014
generate_one_block  0.5252063274383545
generate_one_block  0.5302772521972656
generate_one_block  0.5389053821563721
generate_one_block  0.637397289276123
generate_one_block  0.5278098583221436
generate_one_block  0.5345525741577148
generate_one_block  0.5376925468444824
generate_one_block  0.5306956768035889
generate_one_block  0.5296151638031006
generate_one_block  0.5303685665130615
generate_one_block  0.5461511611938477
generate_one_block  0.5299549102783203
generate_one_block  0.5329334735870361
generate_one_block  0.540184736251831
generate_one_block  0.5423665046691895
generate_one_block  0.5368478298187256
generate_one_block  0.5391263961791992
generate_one_block  0.5317203998565674
generate_one_block  0.5377283096313477
generate_one_block  0.5328917503356934
generate_one_block  0.5474042892456055
generate_one_block  0.5299592018127441
generate_one_block  0.5280423164367676
generate_one_block  0.5546755790710449
generate_one_block  0.5467822551727295
generate_one_block  0.5403347015380859
generate_one_block  0.5451803207397461
generate_one_block  0.5343115329742432
generate_one_block  0.5304348468780518
generate_one_block  0.5405917167663574
generate_one_block  0.5349833965301514
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.12000894546508789  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

connection checking time:  26.515764713287354
block generation total time  22.981780767440796
average batch blocks generation time:  0.7181806489825249
block dataloader generation time/epoch 51.6918975909551
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10504770278930664  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.99067497253418  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10271167755126953  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.381568431854248  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10395431518554688  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.669812679290771  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1039586067199707  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.885071277618408  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10403633117675781  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.896152019500732  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1025543212890625  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.479985237121582  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1029820442199707  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.701803207397461  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10287618637084961  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.664101600646973  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10278940200805664  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.574203968048096  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10279321670532227  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.574676990509033  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10292673110961914  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.641581058502197  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10424232482910156  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.789678573608398  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10389423370361328  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.567197799682617  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10289335250854492  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.654016494750977  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10502147674560547  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.898395538330078  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10405874252319336  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.766953468322754  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10289764404296875  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.739068508148193  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1041560173034668  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.876591682434082  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10398578643798828  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.705594539642334  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10314178466796875  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.689417362213135  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1025381088256836  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.242913246154785  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10428953170776367  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.940996646881104  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1028909683227539  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.518068790435791  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10275125503540039  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.289709568023682  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10506200790405273  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.078413486480713  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10402965545654297  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.825589179992676  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10397672653198242  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.761659145355225  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10300207138061523  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.7016921043396  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10392284393310547  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.608105659484863  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10307121276855469  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.676650524139404  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10401248931884766  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.768578052520752  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1028742790222168  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.699977397918701  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03779897838830948 |0.012051500380039215 |0.2689890190958977 |9.1552734375e-05 |0.42992671579122543 |0.004538774490356445 |
----------------------------------------------------------pseudo_mini_loss sum 1.231447458267212
Total (block generation + training)time/epoch 75.5094519191318
Training time/epoch 24.020265102386475
Training time without block to device /epoch 23.63461709022522
Training time without total dataloading part /epoch 22.372771978378296
load block tensor time/epoch 1.2095673084259033
block to device time/epoch 0.3856480121612549
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 27 |
Number of nodes for computation during this epoch:  8574510
Number of first layer input nodes during this epoch:  4653787
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1204986572265625  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025976181030273438
random selection method range initialization spend 0.0072667598724365234
time for parepare:  0.03464841842651367
local_output_nid generation:  0.0023026466369628906
local_in_edges_tensor generation:  0.010834217071533203
mini_batch_src_global generation:  0.003487825393676758
r_  generation:  0.011239290237426758
local_output_nid generation:  0.0018846988677978516
local_in_edges_tensor generation:  0.0009379386901855469
mini_batch_src_global generation:  0.0017333030700683594
r_  generation:  0.008408546447753906
local_output_nid generation:  0.0017898082733154297
local_in_edges_tensor generation:  0.0008232593536376953
mini_batch_src_global generation:  0.0011332035064697266
r_  generation:  0.007926702499389648
local_output_nid generation:  0.0017237663269042969
local_in_edges_tensor generation:  0.000782012939453125
mini_batch_src_global generation:  0.0010535717010498047
r_  generation:  0.00804758071899414
local_output_nid generation:  0.001720428466796875
local_in_edges_tensor generation:  0.0008065700531005859
mini_batch_src_global generation:  0.0010247230529785156
r_  generation:  0.008097171783447266
local_output_nid generation:  0.0016579627990722656
local_in_edges_tensor generation:  0.0007681846618652344
mini_batch_src_global generation:  0.0009663105010986328
r_  generation:  0.008171796798706055
local_output_nid generation:  0.0015978813171386719
local_in_edges_tensor generation:  0.0007865428924560547
mini_batch_src_global generation:  0.0010688304901123047
r_  generation:  0.009535789489746094
local_output_nid generation:  0.0016257762908935547
local_in_edges_tensor generation:  0.0007944107055664062
mini_batch_src_global generation:  0.0009496212005615234
r_  generation:  0.00811910629272461
local_output_nid generation:  0.0015854835510253906
local_in_edges_tensor generation:  0.0007827281951904297
mini_batch_src_global generation:  0.0009429454803466797
r_  generation:  0.008269786834716797
local_output_nid generation:  0.0015859603881835938
local_in_edges_tensor generation:  0.0007784366607666016
mini_batch_src_global generation:  0.0009176731109619141
r_  generation:  0.008094310760498047
local_output_nid generation:  0.001547098159790039
local_in_edges_tensor generation:  0.0007839202880859375
mini_batch_src_global generation:  0.0009500980377197266
r_  generation:  0.008492231369018555
local_output_nid generation:  0.0015344619750976562
local_in_edges_tensor generation:  0.0008130073547363281
mini_batch_src_global generation:  0.0009827613830566406
r_  generation:  0.008535385131835938
local_output_nid generation:  0.0015375614166259766
local_in_edges_tensor generation:  0.0007688999176025391
mini_batch_src_global generation:  0.0009584426879882812
r_  generation:  0.008327722549438477
local_output_nid generation:  0.0015249252319335938
local_in_edges_tensor generation:  0.0007565021514892578
mini_batch_src_global generation:  0.0009424686431884766
r_  generation:  0.00838160514831543
local_output_nid generation:  0.0015256404876708984
local_in_edges_tensor generation:  0.0007681846618652344
mini_batch_src_global generation:  0.0009229183197021484
r_  generation:  0.009512901306152344
local_output_nid generation:  0.001558542251586914
local_in_edges_tensor generation:  0.0008068084716796875
mini_batch_src_global generation:  0.0010752677917480469
r_  generation:  0.009724855422973633
local_output_nid generation:  0.0015921592712402344
local_in_edges_tensor generation:  0.0007922649383544922
mini_batch_src_global generation:  0.0010089874267578125
r_  generation:  0.008390665054321289
local_output_nid generation:  0.0015687942504882812
local_in_edges_tensor generation:  0.0008044242858886719
mini_batch_src_global generation:  0.0009577274322509766
r_  generation:  0.008103370666503906
local_output_nid generation:  0.0015611648559570312
local_in_edges_tensor generation:  0.0007829666137695312
mini_batch_src_global generation:  0.000978708267211914
r_  generation:  0.008367061614990234
local_output_nid generation:  0.0015041828155517578
local_in_edges_tensor generation:  0.0007708072662353516
mini_batch_src_global generation:  0.0009362697601318359
r_  generation:  0.008352041244506836
local_output_nid generation:  0.001497030258178711
local_in_edges_tensor generation:  0.0007584095001220703
mini_batch_src_global generation:  0.0009109973907470703
r_  generation:  0.008217096328735352
local_output_nid generation:  0.0015041828155517578
local_in_edges_tensor generation:  0.0007798671722412109
mini_batch_src_global generation:  0.0009343624114990234
r_  generation:  0.008456945419311523
local_output_nid generation:  0.00153350830078125
local_in_edges_tensor generation:  0.0007910728454589844
mini_batch_src_global generation:  0.0009584426879882812
r_  generation:  0.008392333984375
local_output_nid generation:  0.0015337467193603516
local_in_edges_tensor generation:  0.0007469654083251953
mini_batch_src_global generation:  0.0009136199951171875
r_  generation:  0.008399009704589844
local_output_nid generation:  0.0014562606811523438
local_in_edges_tensor generation:  0.000751495361328125
mini_batch_src_global generation:  0.0009288787841796875
r_  generation:  0.00838923454284668
local_output_nid generation:  0.0014667510986328125
local_in_edges_tensor generation:  0.0007455348968505859
mini_batch_src_global generation:  0.0009374618530273438
r_  generation:  0.008271932601928711
local_output_nid generation:  0.0014646053314208984
local_in_edges_tensor generation:  0.0007333755493164062
mini_batch_src_global generation:  0.0009160041809082031
r_  generation:  0.008249282836914062
local_output_nid generation:  0.0014486312866210938
local_in_edges_tensor generation:  0.0007226467132568359
mini_batch_src_global generation:  0.0009071826934814453
r_  generation:  0.008267879486083984
local_output_nid generation:  0.0014407634735107422
local_in_edges_tensor generation:  0.0007588863372802734
mini_batch_src_global generation:  0.0009288787841796875
r_  generation:  0.008333444595336914
local_output_nid generation:  0.0014491081237792969
local_in_edges_tensor generation:  0.0007429122924804688
mini_batch_src_global generation:  0.0008919239044189453
r_  generation:  0.009689092636108398
local_output_nid generation:  0.0014379024505615234
local_in_edges_tensor generation:  0.0007863044738769531
mini_batch_src_global generation:  0.0009675025939941406
r_  generation:  0.00804758071899414
local_output_nid generation:  0.0014612674713134766
local_in_edges_tensor generation:  0.0007393360137939453
mini_batch_src_global generation:  0.0008826255798339844
r_  generation:  0.008096933364868164
----------------------check_connections_block total spend ----------------------------- 0.5130472183227539
generate_one_block  0.020259380340576172
generate_one_block  0.017470836639404297
generate_one_block  0.014722824096679688
generate_one_block  0.01468205451965332
generate_one_block  0.016948699951171875
generate_one_block  0.01455068588256836
generate_one_block  0.014594078063964844
generate_one_block  0.014419317245483398
generate_one_block  0.01465463638305664
generate_one_block  0.014100313186645508
generate_one_block  0.014890670776367188
generate_one_block  0.017575979232788086
generate_one_block  0.01474452018737793
generate_one_block  0.014485836029052734
generate_one_block  0.014352798461914062
generate_one_block  0.015271186828613281
generate_one_block  0.014553308486938477
generate_one_block  0.014063835144042969
generate_one_block  0.016787052154541016
generate_one_block  0.014507770538330078
generate_one_block  0.014583349227905273
generate_one_block  0.01484227180480957
generate_one_block  0.017803192138671875
generate_one_block  0.014972925186157227
generate_one_block  0.016688823699951172
generate_one_block  0.015055656433105469
generate_one_block  0.014427900314331055
generate_one_block  0.014327049255371094
generate_one_block  0.014618158340454102
generate_one_block  0.014537572860717773
generate_one_block  0.014241695404052734
generate_one_block  0.016048908233642578
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03609657287597656
gen group dst list time:  0.023390769958496094
time for parepare:  0.023753881454467773
local_output_nid generation:  0.005666017532348633
local_in_edges_tensor generation:  0.018351078033447266
mini_batch_src_global generation:  0.015110015869140625
r_  generation:  0.1277003288269043
local_output_nid generation:  0.007736921310424805
local_in_edges_tensor generation:  0.009475231170654297
mini_batch_src_global generation:  0.017501354217529297
r_  generation:  0.15697503089904785
local_output_nid generation:  0.010718345642089844
local_in_edges_tensor generation:  0.03653144836425781
mini_batch_src_global generation:  0.018413066864013672
r_  generation:  0.16950106620788574
local_output_nid generation:  0.013108968734741211
local_in_edges_tensor generation:  0.013965606689453125
mini_batch_src_global generation:  0.01636195182800293
r_  generation:  0.13808822631835938
local_output_nid generation:  0.010501861572265625
local_in_edges_tensor generation:  0.010921478271484375
mini_batch_src_global generation:  0.018718481063842773
r_  generation:  0.1405625343322754
local_output_nid generation:  0.00900721549987793
local_in_edges_tensor generation:  0.007931947708129883
mini_batch_src_global generation:  0.01932978630065918
r_  generation:  0.1593623161315918
local_output_nid generation:  0.013572216033935547
local_in_edges_tensor generation:  0.011882543563842773
mini_batch_src_global generation:  0.01934194564819336
r_  generation:  0.15284371376037598
local_output_nid generation:  0.013090133666992188
local_in_edges_tensor generation:  0.010981321334838867
mini_batch_src_global generation:  0.01838064193725586
r_  generation:  0.14714479446411133
local_output_nid generation:  0.014141559600830078
local_in_edges_tensor generation:  0.01243448257446289
mini_batch_src_global generation:  0.02401137351989746
r_  generation:  0.14299726486206055
local_output_nid generation:  0.00874185562133789
local_in_edges_tensor generation:  0.007955074310302734
mini_batch_src_global generation:  0.01899433135986328
r_  generation:  0.1365976333618164
local_output_nid generation:  0.008963823318481445
local_in_edges_tensor generation:  0.008986473083496094
mini_batch_src_global generation:  0.019567012786865234
r_  generation:  0.1457052230834961
local_output_nid generation:  0.008739948272705078
local_in_edges_tensor generation:  0.01025843620300293
mini_batch_src_global generation:  0.04407310485839844
r_  generation:  0.1418306827545166
local_output_nid generation:  0.008678436279296875
local_in_edges_tensor generation:  0.008706808090209961
mini_batch_src_global generation:  0.016920089721679688
r_  generation:  0.14559721946716309
local_output_nid generation:  0.008420467376708984
local_in_edges_tensor generation:  0.007592201232910156
mini_batch_src_global generation:  0.02594923973083496
r_  generation:  0.15195894241333008
local_output_nid generation:  0.010865211486816406
local_in_edges_tensor generation:  0.007564544677734375
mini_batch_src_global generation:  0.016857385635375977
r_  generation:  0.14735913276672363
local_output_nid generation:  0.008890151977539062
local_in_edges_tensor generation:  0.010726213455200195
mini_batch_src_global generation:  0.018766403198242188
r_  generation:  0.1831982135772705
local_output_nid generation:  0.008579015731811523
local_in_edges_tensor generation:  0.007650136947631836
mini_batch_src_global generation:  0.01720881462097168
r_  generation:  0.1454319953918457
local_output_nid generation:  0.008353948593139648
local_in_edges_tensor generation:  0.007458925247192383
mini_batch_src_global generation:  0.03275156021118164
r_  generation:  0.13998055458068848
local_output_nid generation:  0.008451461791992188
local_in_edges_tensor generation:  0.009368896484375
mini_batch_src_global generation:  0.03797292709350586
r_  generation:  0.1591475009918213
local_output_nid generation:  0.014053106307983398
local_in_edges_tensor generation:  0.011899232864379883
mini_batch_src_global generation:  0.025213956832885742
r_  generation:  0.14320826530456543
local_output_nid generation:  0.009880542755126953
local_in_edges_tensor generation:  0.007458686828613281
mini_batch_src_global generation:  0.01644134521484375
r_  generation:  0.1415872573852539
local_output_nid generation:  0.009239435195922852
local_in_edges_tensor generation:  0.008367300033569336
mini_batch_src_global generation:  0.016904592514038086
r_  generation:  0.1416630744934082
local_output_nid generation:  0.008785247802734375
local_in_edges_tensor generation:  0.008015871047973633
mini_batch_src_global generation:  0.01671600341796875
r_  generation:  0.14272809028625488
local_output_nid generation:  0.008542299270629883
local_in_edges_tensor generation:  0.007623434066772461
mini_batch_src_global generation:  0.01703476905822754
r_  generation:  0.13971161842346191
local_output_nid generation:  0.008469581604003906
local_in_edges_tensor generation:  0.0075185298919677734
mini_batch_src_global generation:  0.026830673217773438
r_  generation:  0.17331433296203613
local_output_nid generation:  0.009281158447265625
local_in_edges_tensor generation:  0.007850408554077148
mini_batch_src_global generation:  0.01945948600769043
r_  generation:  0.1531672477722168
local_output_nid generation:  0.008590221405029297
local_in_edges_tensor generation:  0.007674455642700195
mini_batch_src_global generation:  0.01940131187438965
r_  generation:  0.1451103687286377
local_output_nid generation:  0.008496999740600586
local_in_edges_tensor generation:  0.008083820343017578
mini_batch_src_global generation:  0.019192218780517578
r_  generation:  0.14423656463623047
local_output_nid generation:  0.009283065795898438
local_in_edges_tensor generation:  0.01114511489868164
mini_batch_src_global generation:  0.018468141555786133
r_  generation:  0.14340829849243164
local_output_nid generation:  0.00849294662475586
local_in_edges_tensor generation:  0.009635210037231445
mini_batch_src_global generation:  0.01699542999267578
r_  generation:  0.14335227012634277
local_output_nid generation:  0.008247852325439453
local_in_edges_tensor generation:  0.007941484451293945
mini_batch_src_global generation:  0.016527652740478516
r_  generation:  0.1377427577972412
local_output_nid generation:  0.008312702178955078
local_in_edges_tensor generation:  0.0074615478515625
mini_batch_src_global generation:  0.016709566116333008
r_  generation:  0.1414036750793457
----------------------check_connections_block total spend ----------------------------- 7.147543907165527
generate_one_block  0.18484020233154297
generate_one_block  0.1727001667022705
generate_one_block  0.17063450813293457
generate_one_block  0.1714315414428711
generate_one_block  0.19276905059814453
generate_one_block  0.17549967765808105
generate_one_block  0.17970609664916992
generate_one_block  0.17532753944396973
generate_one_block  0.18736958503723145
generate_one_block  0.1760098934173584
generate_one_block  0.18732357025146484
generate_one_block  0.18537306785583496
generate_one_block  0.1846175193786621
generate_one_block  0.18036866188049316
generate_one_block  0.17880868911743164
generate_one_block  0.18722820281982422
generate_one_block  0.18129801750183105
generate_one_block  0.171159029006958
generate_one_block  0.17703604698181152
generate_one_block  0.18280482292175293
generate_one_block  0.17852210998535156
generate_one_block  0.1805720329284668
generate_one_block  0.17997479438781738
generate_one_block  0.17818093299865723
generate_one_block  0.1992206573486328
generate_one_block  0.1811530590057373
generate_one_block  0.19717979431152344
generate_one_block  0.17969775199890137
generate_one_block  0.17734742164611816
generate_one_block  0.17957544326782227
generate_one_block  0.1723618507385254
generate_one_block  0.1753520965576172
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.033179283142089844
gen group dst list time:  0.10288667678833008
time for parepare:  0.02186131477355957
local_output_nid generation:  0.023334264755249023
local_in_edges_tensor generation:  0.044588565826416016
mini_batch_src_global generation:  0.0362544059753418
r_  generation:  0.3866856098175049
local_output_nid generation:  0.028761863708496094
local_in_edges_tensor generation:  0.03193473815917969
mini_batch_src_global generation:  0.048254966735839844
r_  generation:  0.40052318572998047
local_output_nid generation:  0.031213045120239258
local_in_edges_tensor generation:  0.02569293975830078
mini_batch_src_global generation:  0.04564619064331055
r_  generation:  0.40860557556152344
local_output_nid generation:  0.0298459529876709
local_in_edges_tensor generation:  0.03366827964782715
mini_batch_src_global generation:  0.049835920333862305
r_  generation:  0.40959644317626953
local_output_nid generation:  0.030159473419189453
local_in_edges_tensor generation:  0.0343935489654541
mini_batch_src_global generation:  0.04972982406616211
r_  generation:  0.4282255172729492
local_output_nid generation:  0.031551361083984375
local_in_edges_tensor generation:  0.028002500534057617
mini_batch_src_global generation:  0.048187971115112305
r_  generation:  0.39897704124450684
local_output_nid generation:  0.028114795684814453
local_in_edges_tensor generation:  0.026853322982788086
mini_batch_src_global generation:  0.048299551010131836
r_  generation:  0.4053213596343994
local_output_nid generation:  0.02771925926208496
local_in_edges_tensor generation:  0.027562618255615234
mini_batch_src_global generation:  0.04782724380493164
r_  generation:  0.3953859806060791
local_output_nid generation:  0.028140544891357422
local_in_edges_tensor generation:  0.024972915649414062
mini_batch_src_global generation:  0.04816412925720215
r_  generation:  0.4199340343475342
local_output_nid generation:  0.028017282485961914
local_in_edges_tensor generation:  0.02981424331665039
mini_batch_src_global generation:  0.04771685600280762
r_  generation:  0.4038407802581787
local_output_nid generation:  0.028147220611572266
local_in_edges_tensor generation:  0.027453184127807617
mini_batch_src_global generation:  0.05095839500427246
r_  generation:  0.4116675853729248
local_output_nid generation:  0.028037309646606445
local_in_edges_tensor generation:  0.029004335403442383
mini_batch_src_global generation:  0.04972982406616211
r_  generation:  0.40009641647338867
local_output_nid generation:  0.028080463409423828
local_in_edges_tensor generation:  0.027304887771606445
mini_batch_src_global generation:  0.04713940620422363
r_  generation:  0.4052619934082031
local_output_nid generation:  0.027922630310058594
local_in_edges_tensor generation:  0.02668023109436035
mini_batch_src_global generation:  0.04819536209106445
r_  generation:  0.4013059139251709
local_output_nid generation:  0.02785801887512207
local_in_edges_tensor generation:  0.02679610252380371
mini_batch_src_global generation:  0.04681110382080078
r_  generation:  0.4147646427154541
local_output_nid generation:  0.028467893600463867
local_in_edges_tensor generation:  0.02850508689880371
mini_batch_src_global generation:  0.04849886894226074
r_  generation:  0.40940427780151367
local_output_nid generation:  0.029122352600097656
local_in_edges_tensor generation:  0.028942584991455078
mini_batch_src_global generation:  0.04710054397583008
r_  generation:  0.42008018493652344
local_output_nid generation:  0.028006315231323242
local_in_edges_tensor generation:  0.03130006790161133
mini_batch_src_global generation:  0.04788041114807129
r_  generation:  0.4265251159667969
local_output_nid generation:  0.030552387237548828
local_in_edges_tensor generation:  0.025803327560424805
mini_batch_src_global generation:  0.04880547523498535
r_  generation:  0.4117624759674072
local_output_nid generation:  0.027951955795288086
local_in_edges_tensor generation:  0.026656627655029297
mini_batch_src_global generation:  0.04788374900817871
r_  generation:  0.40380167961120605
local_output_nid generation:  0.02787041664123535
local_in_edges_tensor generation:  0.026757240295410156
mini_batch_src_global generation:  0.0461125373840332
r_  generation:  0.4055807590484619
local_output_nid generation:  0.028113842010498047
local_in_edges_tensor generation:  0.028795957565307617
mini_batch_src_global generation:  0.04775238037109375
r_  generation:  0.4149487018585205
local_output_nid generation:  0.028107404708862305
local_in_edges_tensor generation:  0.028591394424438477
mini_batch_src_global generation:  0.04627418518066406
r_  generation:  0.4143862724304199
local_output_nid generation:  0.027852296829223633
local_in_edges_tensor generation:  0.024907350540161133
mini_batch_src_global generation:  0.04757070541381836
r_  generation:  0.40203404426574707
local_output_nid generation:  0.02832317352294922
local_in_edges_tensor generation:  0.029081344604492188
mini_batch_src_global generation:  0.04860544204711914
r_  generation:  0.4131619930267334
local_output_nid generation:  0.02810382843017578
local_in_edges_tensor generation:  0.028133392333984375
mini_batch_src_global generation:  0.048404693603515625
r_  generation:  0.404005765914917
local_output_nid generation:  0.028142213821411133
local_in_edges_tensor generation:  0.029285430908203125
mini_batch_src_global generation:  0.04734182357788086
r_  generation:  0.4079103469848633
local_output_nid generation:  0.028027772903442383
local_in_edges_tensor generation:  0.025255680084228516
mini_batch_src_global generation:  0.04824662208557129
r_  generation:  0.4021439552307129
local_output_nid generation:  0.030305862426757812
local_in_edges_tensor generation:  0.027936220169067383
mini_batch_src_global generation:  0.04807901382446289
r_  generation:  0.41098499298095703
local_output_nid generation:  0.028010845184326172
local_in_edges_tensor generation:  0.026932477951049805
mini_batch_src_global generation:  0.04977130889892578
r_  generation:  0.4061150550842285
local_output_nid generation:  0.030367374420166016
local_in_edges_tensor generation:  0.03484082221984863
mini_batch_src_global generation:  0.04651761054992676
r_  generation:  0.40828847885131836
local_output_nid generation:  0.027769088745117188
local_in_edges_tensor generation:  0.030862092971801758
mini_batch_src_global generation:  0.049719810485839844
r_  generation:  0.4028952121734619
----------------------check_connections_block total spend ----------------------------- 19.31402325630188
generate_one_block  0.5439815521240234
generate_one_block  0.5433051586151123
generate_one_block  0.5272414684295654
generate_one_block  0.5343365669250488
generate_one_block  0.6490998268127441
generate_one_block  0.5340383052825928
generate_one_block  0.5416622161865234
generate_one_block  0.5342965126037598
generate_one_block  0.5401551723480225
generate_one_block  0.5417718887329102
generate_one_block  0.5399274826049805
generate_one_block  0.5402829647064209
generate_one_block  0.540278434753418
generate_one_block  0.5327136516571045
generate_one_block  0.5380759239196777
generate_one_block  0.5487165451049805
generate_one_block  0.552332878112793
generate_one_block  0.5332388877868652
generate_one_block  0.5389435291290283
generate_one_block  0.5390996932983398
generate_one_block  0.5290737152099609
generate_one_block  0.5449376106262207
generate_one_block  0.5382206439971924
generate_one_block  0.5336320400238037
generate_one_block  0.5593879222869873
generate_one_block  0.5474436283111572
generate_one_block  0.5408759117126465
generate_one_block  0.5378072261810303
generate_one_block  0.5418024063110352
generate_one_block  0.5343606472015381
generate_one_block  0.5362265110015869
generate_one_block  0.5407834053039551
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1204986572265625  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

connection checking time:  26.461567163467407
block generation total time  23.159494161605835
average batch blocks generation time:  0.7237341925501823
block dataloader generation time/epoch 51.71737354680111
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1028738021850586  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.516009330749512  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.102935791015625  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.564487934112549  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10270833969116211  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.453049659729004  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10296392440795898  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.48244571685791  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10376214981079102  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.76115083694458  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10308027267456055  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.622542381286621  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1040029525756836  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.733799934387207  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1029505729675293  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.463440895080566  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10285615921020508  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.822157859802246  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10305356979370117  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.436614036560059  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10403680801391602  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.827142238616943  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10381603240966797  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.879141807556152  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10500955581665039  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.828234195709229  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10403251647949219  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.765129089355469  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10388851165771484  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.773032665252686  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1041254997253418  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.2428240776062  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10398292541503906  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.892658233642578  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10277700424194336  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.437294960021973  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10400199890136719  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.683956146240234  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10297489166259766  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.759986400604248  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10282373428344727  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.691922187805176  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10399675369262695  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.856555461883545  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10301017761230469  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.776320934295654  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10296201705932617  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.658254146575928  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10501861572265625  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.843721389770508  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10306882858276367  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.696227073669434  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1029672622680664  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.754781723022461  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10299301147460938  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.645993709564209  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10499954223632812  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.781600952148438  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10319328308105469  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.774314880371094  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1026458740234375  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.453545570373535  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1030435562133789  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.679536819458008  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03769005089998245 |0.012012533843517303 |0.2640611305832863 |9.048730134963989e-05 |0.42943672835826874 |0.005975961685180664 |
----------------------------------------------------------pseudo_mini_loss sum 1.2183446884155273
Total (block generation + training)time/epoch 75.53620620777733
Training time/epoch 23.84157133102417
Training time without block to device /epoch 23.457170248031616
Training time without total dataloading part /epoch 22.20080304145813
load block tensor time/epoch 1.2060816287994385
block to device time/epoch 0.3844010829925537
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 28 |
Number of nodes for computation during this epoch:  8573546
Number of first layer input nodes during this epoch:  4652186
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.12031364440917969  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02229762077331543
random selection method range initialization spend 0.006715297698974609
time for parepare:  0.020175695419311523
local_output_nid generation:  0.0013797283172607422
local_in_edges_tensor generation:  0.007851839065551758
mini_batch_src_global generation:  0.003645658493041992
r_  generation:  0.013057231903076172
local_output_nid generation:  0.002454996109008789
local_in_edges_tensor generation:  0.0012769699096679688
mini_batch_src_global generation:  0.0020017623901367188
r_  generation:  0.008831024169921875
local_output_nid generation:  0.0022411346435546875
local_in_edges_tensor generation:  0.0011286735534667969
mini_batch_src_global generation:  0.0011713504791259766
r_  generation:  0.01816701889038086
local_output_nid generation:  0.0024271011352539062
local_in_edges_tensor generation:  0.001146078109741211
mini_batch_src_global generation:  0.0013403892517089844
r_  generation:  0.008667945861816406
local_output_nid generation:  0.0017864704132080078
local_in_edges_tensor generation:  0.0009038448333740234
mini_batch_src_global generation:  0.0010716915130615234
r_  generation:  0.008259057998657227
local_output_nid generation:  0.0016908645629882812
local_in_edges_tensor generation:  0.0008573532104492188
mini_batch_src_global generation:  0.0009942054748535156
r_  generation:  0.00812220573425293
local_output_nid generation:  0.0016605854034423828
local_in_edges_tensor generation:  0.0008821487426757812
mini_batch_src_global generation:  0.0010039806365966797
r_  generation:  0.008022546768188477
local_output_nid generation:  0.0016226768493652344
local_in_edges_tensor generation:  0.0008566379547119141
mini_batch_src_global generation:  0.0009202957153320312
r_  generation:  0.008177995681762695
local_output_nid generation:  0.0015845298767089844
local_in_edges_tensor generation:  0.0008456707000732422
mini_batch_src_global generation:  0.0009808540344238281
r_  generation:  0.008211851119995117
local_output_nid generation:  0.0015909671783447266
local_in_edges_tensor generation:  0.0008022785186767578
mini_batch_src_global generation:  0.0009036064147949219
r_  generation:  0.008318662643432617
local_output_nid generation:  0.0015549659729003906
local_in_edges_tensor generation:  0.0008215904235839844
mini_batch_src_global generation:  0.0009353160858154297
r_  generation:  0.008539915084838867
local_output_nid generation:  0.0015540122985839844
local_in_edges_tensor generation:  0.0007987022399902344
mini_batch_src_global generation:  0.0008945465087890625
r_  generation:  0.008317947387695312
local_output_nid generation:  0.0015439987182617188
local_in_edges_tensor generation:  0.0008234977722167969
mini_batch_src_global generation:  0.0009348392486572266
r_  generation:  0.008483409881591797
local_output_nid generation:  0.0015110969543457031
local_in_edges_tensor generation:  0.0008084774017333984
mini_batch_src_global generation:  0.0009870529174804688
r_  generation:  0.008551359176635742
local_output_nid generation:  0.0015177726745605469
local_in_edges_tensor generation:  0.0007960796356201172
mini_batch_src_global generation:  0.0009472370147705078
r_  generation:  0.008582115173339844
local_output_nid generation:  0.0015091896057128906
local_in_edges_tensor generation:  0.0008153915405273438
mini_batch_src_global generation:  0.0009925365447998047
r_  generation:  0.008637189865112305
local_output_nid generation:  0.0015516281127929688
local_in_edges_tensor generation:  0.000789642333984375
mini_batch_src_global generation:  0.0009441375732421875
r_  generation:  0.008281946182250977
local_output_nid generation:  0.0015420913696289062
local_in_edges_tensor generation:  0.0007979869842529297
mini_batch_src_global generation:  0.0009868144989013672
r_  generation:  0.00814676284790039
local_output_nid generation:  0.0015268325805664062
local_in_edges_tensor generation:  0.0007643699645996094
mini_batch_src_global generation:  0.0009799003601074219
r_  generation:  0.008274555206298828
local_output_nid generation:  0.0014886856079101562
local_in_edges_tensor generation:  0.0007796287536621094
mini_batch_src_global generation:  0.0009152889251708984
r_  generation:  0.00816798210144043
local_output_nid generation:  0.0015017986297607422
local_in_edges_tensor generation:  0.0007884502410888672
mini_batch_src_global generation:  0.0009260177612304688
r_  generation:  0.008335590362548828
local_output_nid generation:  0.0015270709991455078
local_in_edges_tensor generation:  0.0008020401000976562
mini_batch_src_global generation:  0.000946044921875
r_  generation:  0.008481502532958984
local_output_nid generation:  0.0014848709106445312
local_in_edges_tensor generation:  0.0007715225219726562
mini_batch_src_global generation:  0.0009291172027587891
r_  generation:  0.008518695831298828
local_output_nid generation:  0.0014967918395996094
local_in_edges_tensor generation:  0.0007805824279785156
mini_batch_src_global generation:  0.0009307861328125
r_  generation:  0.008108377456665039
local_output_nid generation:  0.001481771469116211
local_in_edges_tensor generation:  0.0007646083831787109
mini_batch_src_global generation:  0.0008971691131591797
r_  generation:  0.008288383483886719
local_output_nid generation:  0.0014748573303222656
local_in_edges_tensor generation:  0.0007607936859130859
mini_batch_src_global generation:  0.0009105205535888672
r_  generation:  0.008241415023803711
local_output_nid generation:  0.0014731884002685547
local_in_edges_tensor generation:  0.0007822513580322266
mini_batch_src_global generation:  0.0009067058563232422
r_  generation:  0.00848245620727539
local_output_nid generation:  0.0014519691467285156
local_in_edges_tensor generation:  0.0007762908935546875
mini_batch_src_global generation:  0.0009081363677978516
r_  generation:  0.008430719375610352
local_output_nid generation:  0.0014510154724121094
local_in_edges_tensor generation:  0.0007605552673339844
mini_batch_src_global generation:  0.0009050369262695312
r_  generation:  0.008488893508911133
local_output_nid generation:  0.0014767646789550781
local_in_edges_tensor generation:  0.0007565021514892578
mini_batch_src_global generation:  0.0009300708770751953
r_  generation:  0.008469581604003906
local_output_nid generation:  0.0014400482177734375
local_in_edges_tensor generation:  0.0007770061492919922
mini_batch_src_global generation:  0.0009036064147949219
r_  generation:  0.008255720138549805
local_output_nid generation:  0.0014524459838867188
local_in_edges_tensor generation:  0.0007767677307128906
mini_batch_src_global generation:  0.0009279251098632812
r_  generation:  0.00843667984008789
----------------------check_connections_block total spend ----------------------------- 0.5144190788269043
generate_one_block  0.020346879959106445
generate_one_block  0.017813920974731445
generate_one_block  0.01513814926147461
generate_one_block  0.014914989471435547
generate_one_block  0.01464080810546875
generate_one_block  0.0146484375
generate_one_block  0.014067649841308594
generate_one_block  0.014573097229003906
generate_one_block  0.014383316040039062
generate_one_block  0.014675617218017578
generate_one_block  0.014520645141601562
generate_one_block  0.014833688735961914
generate_one_block  0.014630794525146484
generate_one_block  0.01479482650756836
generate_one_block  0.014780282974243164
generate_one_block  0.01503753662109375
generate_one_block  0.014329910278320312
generate_one_block  0.014110326766967773
generate_one_block  0.01431584358215332
generate_one_block  0.014281511306762695
generate_one_block  0.014668464660644531
generate_one_block  0.01465463638305664
generate_one_block  0.017943620681762695
generate_one_block  0.014636754989624023
generate_one_block  0.014441728591918945
generate_one_block  0.014454364776611328
generate_one_block  0.014826774597167969
generate_one_block  0.014362573623657227
generate_one_block  0.014694690704345703
generate_one_block  0.014663457870483398
generate_one_block  0.014113664627075195
generate_one_block  0.014673709869384766
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03980684280395508
gen group dst list time:  0.023005962371826172
time for parepare:  0.02190113067626953
local_output_nid generation:  0.0053863525390625
local_in_edges_tensor generation:  0.0244448184967041
mini_batch_src_global generation:  0.013737678527832031
r_  generation:  0.12359762191772461
local_output_nid generation:  0.007957220077514648
local_in_edges_tensor generation:  0.009996414184570312
mini_batch_src_global generation:  0.018261432647705078
r_  generation:  0.1549687385559082
local_output_nid generation:  0.008262872695922852
local_in_edges_tensor generation:  0.030315160751342773
mini_batch_src_global generation:  0.014433145523071289
r_  generation:  0.15900516510009766
local_output_nid generation:  0.008300304412841797
local_in_edges_tensor generation:  0.00757908821105957
mini_batch_src_global generation:  0.01569652557373047
r_  generation:  0.16065073013305664
local_output_nid generation:  0.013386726379394531
local_in_edges_tensor generation:  0.010854721069335938
mini_batch_src_global generation:  0.021517038345336914
r_  generation:  0.15357303619384766
local_output_nid generation:  0.013466835021972656
local_in_edges_tensor generation:  0.012185811996459961
mini_batch_src_global generation:  0.02065587043762207
r_  generation:  0.15082287788391113
local_output_nid generation:  0.01257467269897461
local_in_edges_tensor generation:  0.017061948776245117
mini_batch_src_global generation:  0.023213624954223633
r_  generation:  0.13236021995544434
local_output_nid generation:  0.011442899703979492
local_in_edges_tensor generation:  0.00830984115600586
mini_batch_src_global generation:  0.016941547393798828
r_  generation:  0.13506650924682617
local_output_nid generation:  0.009113073348999023
local_in_edges_tensor generation:  0.008571147918701172
mini_batch_src_global generation:  0.01624298095703125
r_  generation:  0.13486337661743164
local_output_nid generation:  0.00859975814819336
local_in_edges_tensor generation:  0.008955001831054688
mini_batch_src_global generation:  0.017687082290649414
r_  generation:  0.17220830917358398
local_output_nid generation:  0.008653879165649414
local_in_edges_tensor generation:  0.00811147689819336
mini_batch_src_global generation:  0.01640772819519043
r_  generation:  0.1757211685180664
local_output_nid generation:  0.00858759880065918
local_in_edges_tensor generation:  0.008299827575683594
mini_batch_src_global generation:  0.016733407974243164
r_  generation:  0.1729893684387207
local_output_nid generation:  0.008389472961425781
local_in_edges_tensor generation:  0.00815129280090332
mini_batch_src_global generation:  0.0165407657623291
r_  generation:  0.1613178253173828
local_output_nid generation:  0.008352994918823242
local_in_edges_tensor generation:  0.008263349533081055
mini_batch_src_global generation:  0.02176499366760254
r_  generation:  0.186720609664917
local_output_nid generation:  0.008537054061889648
local_in_edges_tensor generation:  0.010762929916381836
mini_batch_src_global generation:  0.018126249313354492
r_  generation:  0.14452862739562988
local_output_nid generation:  0.008475780487060547
local_in_edges_tensor generation:  0.008867263793945312
mini_batch_src_global generation:  0.01833820343017578
r_  generation:  0.14179730415344238
local_output_nid generation:  0.00814509391784668
local_in_edges_tensor generation:  0.00809788703918457
mini_batch_src_global generation:  0.01695704460144043
r_  generation:  0.138214111328125
local_output_nid generation:  0.008021354675292969
local_in_edges_tensor generation:  0.007777214050292969
mini_batch_src_global generation:  0.016449689865112305
r_  generation:  0.13091158866882324
local_output_nid generation:  0.008152246475219727
local_in_edges_tensor generation:  0.007908821105957031
mini_batch_src_global generation:  0.016678571701049805
r_  generation:  0.13972139358520508
local_output_nid generation:  0.007994413375854492
local_in_edges_tensor generation:  0.007329702377319336
mini_batch_src_global generation:  0.016541481018066406
r_  generation:  0.1346757411956787
local_output_nid generation:  0.008101463317871094
local_in_edges_tensor generation:  0.007863998413085938
mini_batch_src_global generation:  0.016971111297607422
r_  generation:  0.14458799362182617
local_output_nid generation:  0.008078813552856445
local_in_edges_tensor generation:  0.007491350173950195
mini_batch_src_global generation:  0.020449399948120117
r_  generation:  0.1695253849029541
local_output_nid generation:  0.008372306823730469
local_in_edges_tensor generation:  0.00826406478881836
mini_batch_src_global generation:  0.017730236053466797
r_  generation:  0.14562487602233887
local_output_nid generation:  0.009060859680175781
local_in_edges_tensor generation:  0.007598876953125
mini_batch_src_global generation:  0.016896724700927734
r_  generation:  0.13422822952270508
local_output_nid generation:  0.008202075958251953
local_in_edges_tensor generation:  0.007479667663574219
mini_batch_src_global generation:  0.016041994094848633
r_  generation:  0.13877439498901367
local_output_nid generation:  0.008081674575805664
local_in_edges_tensor generation:  0.007536888122558594
mini_batch_src_global generation:  0.016887664794921875
r_  generation:  0.13874316215515137
local_output_nid generation:  0.008463144302368164
local_in_edges_tensor generation:  0.008237123489379883
mini_batch_src_global generation:  0.017378807067871094
r_  generation:  0.14373993873596191
local_output_nid generation:  0.008170366287231445
local_in_edges_tensor generation:  0.0074901580810546875
mini_batch_src_global generation:  0.017354249954223633
r_  generation:  0.13749957084655762
local_output_nid generation:  0.008165836334228516
local_in_edges_tensor generation:  0.007847309112548828
mini_batch_src_global generation:  0.01647782325744629
r_  generation:  0.14168381690979004
local_output_nid generation:  0.00829625129699707
local_in_edges_tensor generation:  0.008064746856689453
mini_batch_src_global generation:  0.017024993896484375
r_  generation:  0.13981938362121582
local_output_nid generation:  0.00807499885559082
local_in_edges_tensor generation:  0.007325649261474609
mini_batch_src_global generation:  0.015494346618652344
r_  generation:  0.1356039047241211
local_output_nid generation:  0.008286237716674805
local_in_edges_tensor generation:  0.007737874984741211
mini_batch_src_global generation:  0.016634225845336914
r_  generation:  0.1431593894958496
----------------------check_connections_block total spend ----------------------------- 6.959009885787964
generate_one_block  0.18293118476867676
generate_one_block  0.18710994720458984
generate_one_block  0.17754411697387695
generate_one_block  0.18383288383483887
generate_one_block  0.19499731063842773
generate_one_block  0.18437600135803223
generate_one_block  0.17101621627807617
generate_one_block  0.17792129516601562
generate_one_block  0.1708841323852539
generate_one_block  0.18159031867980957
generate_one_block  0.1781623363494873
generate_one_block  0.1761023998260498
generate_one_block  0.18649649620056152
generate_one_block  0.17968082427978516
generate_one_block  0.18423819541931152
generate_one_block  0.18379592895507812
generate_one_block  0.17385458946228027
generate_one_block  0.16744780540466309
generate_one_block  0.1742842197418213
generate_one_block  0.17434430122375488
generate_one_block  0.1815967559814453
generate_one_block  0.17960095405578613
generate_one_block  0.18193721771240234
generate_one_block  0.1696012020111084
generate_one_block  0.17267060279846191
generate_one_block  0.17631006240844727
generate_one_block  0.1819007396697998
generate_one_block  0.17493247985839844
generate_one_block  0.17762184143066406
generate_one_block  0.17991137504577637
generate_one_block  0.16851401329040527
generate_one_block  0.17427635192871094
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.035590171813964844
gen group dst list time:  0.10482621192932129
time for parepare:  0.02042675018310547
local_output_nid generation:  0.023437976837158203
local_in_edges_tensor generation:  0.04492449760437012
mini_batch_src_global generation:  0.036782264709472656
r_  generation:  0.3905448913574219
local_output_nid generation:  0.029809951782226562
local_in_edges_tensor generation:  0.032332658767700195
mini_batch_src_global generation:  0.04847311973571777
r_  generation:  0.3922767639160156
local_output_nid generation:  0.02975320816040039
local_in_edges_tensor generation:  0.025339365005493164
mini_batch_src_global generation:  0.045987844467163086
r_  generation:  0.40164613723754883
local_output_nid generation:  0.029819250106811523
local_in_edges_tensor generation:  0.02840256690979004
mini_batch_src_global generation:  0.04921269416809082
r_  generation:  0.39979124069213867
local_output_nid generation:  0.03074193000793457
local_in_edges_tensor generation:  0.025257349014282227
mini_batch_src_global generation:  0.04659771919250488
r_  generation:  0.40842199325561523
local_output_nid generation:  0.03978085517883301
local_in_edges_tensor generation:  0.025609731674194336
mini_batch_src_global generation:  0.04726743698120117
r_  generation:  0.4021291732788086
local_output_nid generation:  0.027289390563964844
local_in_edges_tensor generation:  0.026144027709960938
mini_batch_src_global generation:  0.04567456245422363
r_  generation:  0.4062232971191406
local_output_nid generation:  0.028640270233154297
local_in_edges_tensor generation:  0.030980825424194336
mini_batch_src_global generation:  0.051596879959106445
r_  generation:  0.40516042709350586
local_output_nid generation:  0.02807784080505371
local_in_edges_tensor generation:  0.02398228645324707
mini_batch_src_global generation:  0.04788613319396973
r_  generation:  0.40585923194885254
local_output_nid generation:  0.027869701385498047
local_in_edges_tensor generation:  0.026543140411376953
mini_batch_src_global generation:  0.049956560134887695
r_  generation:  0.4067714214324951
local_output_nid generation:  0.02830338478088379
local_in_edges_tensor generation:  0.03296804428100586
mini_batch_src_global generation:  0.04901432991027832
r_  generation:  0.42879438400268555
local_output_nid generation:  0.030262470245361328
local_in_edges_tensor generation:  0.027860164642333984
mini_batch_src_global generation:  0.0483098030090332
r_  generation:  0.40027904510498047
local_output_nid generation:  0.027683258056640625
local_in_edges_tensor generation:  0.025399208068847656
mini_batch_src_global generation:  0.04641127586364746
r_  generation:  0.41538381576538086
local_output_nid generation:  0.027791500091552734
local_in_edges_tensor generation:  0.02764415740966797
mini_batch_src_global generation:  0.0495908260345459
r_  generation:  0.4041473865509033
local_output_nid generation:  0.02817535400390625
local_in_edges_tensor generation:  0.026292800903320312
mini_batch_src_global generation:  0.04683709144592285
r_  generation:  0.4083855152130127
local_output_nid generation:  0.027988910675048828
local_in_edges_tensor generation:  0.0326688289642334
mini_batch_src_global generation:  0.04836606979370117
r_  generation:  0.404313325881958
local_output_nid generation:  0.027642011642456055
local_in_edges_tensor generation:  0.024723529815673828
mini_batch_src_global generation:  0.0466763973236084
r_  generation:  0.405498743057251
local_output_nid generation:  0.02733135223388672
local_in_edges_tensor generation:  0.024363279342651367
mini_batch_src_global generation:  0.04742598533630371
r_  generation:  0.39000415802001953
local_output_nid generation:  0.02791905403137207
local_in_edges_tensor generation:  0.0277860164642334
mini_batch_src_global generation:  0.046324968338012695
r_  generation:  0.40472912788391113
local_output_nid generation:  0.028905153274536133
local_in_edges_tensor generation:  0.027111291885375977
mini_batch_src_global generation:  0.049146413803100586
r_  generation:  0.40018796920776367
local_output_nid generation:  0.027822017669677734
local_in_edges_tensor generation:  0.02838444709777832
mini_batch_src_global generation:  0.05013227462768555
r_  generation:  0.41109585762023926
local_output_nid generation:  0.027642011642456055
local_in_edges_tensor generation:  0.027434587478637695
mini_batch_src_global generation:  0.04841136932373047
r_  generation:  0.4007585048675537
local_output_nid generation:  0.028028249740600586
local_in_edges_tensor generation:  0.025081872940063477
mini_batch_src_global generation:  0.04848814010620117
r_  generation:  0.4081695079803467
local_output_nid generation:  0.027663707733154297
local_in_edges_tensor generation:  0.026332855224609375
mini_batch_src_global generation:  0.04739546775817871
r_  generation:  0.40192532539367676
local_output_nid generation:  0.028055191040039062
local_in_edges_tensor generation:  0.02474522590637207
mini_batch_src_global generation:  0.04761862754821777
r_  generation:  0.40769362449645996
local_output_nid generation:  0.027901649475097656
local_in_edges_tensor generation:  0.027114152908325195
mini_batch_src_global generation:  0.0477144718170166
r_  generation:  0.407684326171875
local_output_nid generation:  0.0281374454498291
local_in_edges_tensor generation:  0.028377532958984375
mini_batch_src_global generation:  0.046794891357421875
r_  generation:  0.4152233600616455
local_output_nid generation:  0.027972698211669922
local_in_edges_tensor generation:  0.029813051223754883
mini_batch_src_global generation:  0.04748892784118652
r_  generation:  0.4018731117248535
local_output_nid generation:  0.028067588806152344
local_in_edges_tensor generation:  0.026380538940429688
mini_batch_src_global generation:  0.04596304893493652
r_  generation:  0.40958571434020996
local_output_nid generation:  0.028298139572143555
local_in_edges_tensor generation:  0.027114152908325195
mini_batch_src_global generation:  0.04747319221496582
r_  generation:  0.42224788665771484
local_output_nid generation:  0.03053426742553711
local_in_edges_tensor generation:  0.026697397232055664
mini_batch_src_global generation:  0.04709315299987793
r_  generation:  0.40645599365234375
local_output_nid generation:  0.028252363204956055
local_in_edges_tensor generation:  0.027547359466552734
mini_batch_src_global generation:  0.047681570053100586
r_  generation:  0.39864182472229004
----------------------check_connections_block total spend ----------------------------- 19.180246353149414
generate_one_block  0.5418922901153564
generate_one_block  0.5347459316253662
generate_one_block  0.5354340076446533
generate_one_block  0.5453903675079346
generate_one_block  0.6342825889587402
generate_one_block  0.5416152477264404
generate_one_block  0.5257012844085693
generate_one_block  0.5390172004699707
generate_one_block  0.5283925533294678
generate_one_block  0.5421123504638672
generate_one_block  0.5378077030181885
generate_one_block  0.5295171737670898
generate_one_block  0.5340187549591064
generate_one_block  0.532285213470459
generate_one_block  0.5428721904754639
generate_one_block  0.5480709075927734
generate_one_block  0.5315444469451904
generate_one_block  0.5275704860687256
generate_one_block  0.525130033493042
generate_one_block  0.5325078964233398
generate_one_block  0.545210599899292
generate_one_block  0.5413706302642822
generate_one_block  0.5398895740509033
generate_one_block  0.5293219089508057
generate_one_block  0.5437510013580322
generate_one_block  0.5347740650177002
generate_one_block  0.5398783683776855
generate_one_block  0.5347020626068115
generate_one_block  0.5360770225524902
generate_one_block  0.5337293148040771
generate_one_block  0.5335166454315186
generate_one_block  0.5403990745544434
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.12031364440917969  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

connection checking time:  26.139256238937378
block generation total time  22.972012996673584
average batch blocks generation time:  0.7178754061460495
block dataloader generation time/epoch 51.714694833755495
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10300350189208984  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.691552639007568  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1031489372253418  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.772809028625488  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1039590835571289  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.669636249542236  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10425472259521484  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.924764633178711  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1039590835571289  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.668919563293457  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10317754745483398  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.584856986999512  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10255002975463867  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.28432035446167  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10409784317016602  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.766279220581055  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1027226448059082  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.48754596710205  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10414314270019531  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.949065208435059  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10392332077026367  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.768124103546143  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10294246673583984  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.7047758102417  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10296916961669922  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.792064666748047  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10397815704345703  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.932557106018066  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10506439208984375  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.084227561950684  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1042628288269043  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.1227068901062  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10283422470092773  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.539249897003174  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10257720947265625  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.249977588653564  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10286092758178711  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.556166648864746  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10282039642333984  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.489569187164307  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10504007339477539  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.924499034881592  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10269927978515625  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.816837787628174  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10505151748657227  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 16.00262212753296  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10257387161254883  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.418659210205078  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1039113998413086  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.581132411956787  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10304450988769531  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.738875389099121  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1050410270690918  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.949594020843506  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10296344757080078  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.667384147644043  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10294532775878906  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.736259937286377  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10418081283569336  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.802600860595703  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.10382080078125  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.394997596740723  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 0.1032552719116211  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 15.715700149536133  GigaBytes
Max Memory Allocated: 16.282000064849854  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0367007851600647 |0.011857934296131134 |0.26399435102939606 |9.068846702575684e-05 |0.43099143356084824 |0.005979061126708984 |
----------------------------------------------------------pseudo_mini_loss sum 1.2087072134017944
Total (block generation + training)time/epoch 75.53525048494339
Training time/epoch 23.853047370910645
Training time without block to device /epoch 23.47359347343445
Training time without total dataloading part /epoch 22.24842619895935
load block tensor time/epoch 1.1744251251220703
block to device time/epoch 0.3794538974761963
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 29 |
Number of nodes for computation during this epoch:  8578070
Number of first layer input nodes during this epoch:  4654257
