Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1647792509.8266695
ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0213623046875 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.028249025344848633
random selection method range initialization spend 0.00645899772644043
time for parepare:  0.018841028213500977
local_output_nid generation:  0.0011076927185058594
local_in_edges_tensor generation:  0.004294395446777344
mini_batch_src_global generation:  0.0015878677368164062
r_  generation:  0.010216236114501953
local_output_nid generation:  0.0012547969818115234
local_in_edges_tensor generation:  0.0009913444519042969
mini_batch_src_global generation:  0.0016798973083496094
r_  generation:  0.009899616241455078
local_output_nid generation:  0.0013480186462402344
local_in_edges_tensor generation:  0.0008988380432128906
mini_batch_src_global generation:  0.0010495185852050781
r_  generation:  0.009027242660522461
local_output_nid generation:  0.0014119148254394531
local_in_edges_tensor generation:  0.0008716583251953125
mini_batch_src_global generation:  0.0009796619415283203
r_  generation:  0.009139776229858398
local_output_nid generation:  0.001420736312866211
local_in_edges_tensor generation:  0.0008420944213867188
mini_batch_src_global generation:  0.0009479522705078125
r_  generation:  0.009161233901977539
local_output_nid generation:  0.0014147758483886719
local_in_edges_tensor generation:  0.0008327960968017578
mini_batch_src_global generation:  0.0009999275207519531
r_  generation:  0.00966954231262207
local_output_nid generation:  0.0014147758483886719
local_in_edges_tensor generation:  0.0008261203765869141
mini_batch_src_global generation:  0.000995635986328125
r_  generation:  0.009723186492919922
local_output_nid generation:  0.0014386177062988281
local_in_edges_tensor generation:  0.0007960796356201172
mini_batch_src_global generation:  0.0011456012725830078
r_  generation:  0.009768247604370117
local_output_nid generation:  0.0014336109161376953
local_in_edges_tensor generation:  0.0007970333099365234
mini_batch_src_global generation:  0.000986337661743164
r_  generation:  0.009635448455810547
local_output_nid generation:  0.0014345645904541016
local_in_edges_tensor generation:  0.0007882118225097656
mini_batch_src_global generation:  0.0010042190551757812
r_  generation:  0.009732723236083984
local_output_nid generation:  0.0014486312866210938
local_in_edges_tensor generation:  0.0007905960083007812
mini_batch_src_global generation:  0.001077413558959961
r_  generation:  0.01001596450805664
local_output_nid generation:  0.001443624496459961
local_in_edges_tensor generation:  0.0007884502410888672
mini_batch_src_global generation:  0.0010330677032470703
r_  generation:  0.009870052337646484
local_output_nid generation:  0.0014429092407226562
local_in_edges_tensor generation:  0.0007679462432861328
mini_batch_src_global generation:  0.000988006591796875
r_  generation:  0.009744882583618164
local_output_nid generation:  0.0014331340789794922
local_in_edges_tensor generation:  0.0007798671722412109
mini_batch_src_global generation:  0.001129150390625
r_  generation:  0.009870290756225586
local_output_nid generation:  0.00145721435546875
local_in_edges_tensor generation:  0.0007822513580322266
mini_batch_src_global generation:  0.0010459423065185547
r_  generation:  0.009954690933227539
local_output_nid generation:  0.0014455318450927734
local_in_edges_tensor generation:  0.0007960796356201172
mini_batch_src_global generation:  0.0009913444519042969
r_  generation:  0.009442329406738281
local_output_nid generation:  0.0014612674713134766
local_in_edges_tensor generation:  0.0007722377777099609
mini_batch_src_global generation:  0.0010671615600585938
r_  generation:  0.01038503646850586
local_output_nid generation:  0.0014598369598388672
local_in_edges_tensor generation:  0.0007698535919189453
mini_batch_src_global generation:  0.0010449886322021484
r_  generation:  0.009865999221801758
local_output_nid generation:  0.0014529228210449219
local_in_edges_tensor generation:  0.0007719993591308594
mini_batch_src_global generation:  0.0010304450988769531
r_  generation:  0.010004281997680664
local_output_nid generation:  0.0014431476593017578
local_in_edges_tensor generation:  0.0007565021514892578
mini_batch_src_global generation:  0.0010082721710205078
r_  generation:  0.009744882583618164
local_output_nid generation:  0.0014567375183105469
local_in_edges_tensor generation:  0.0007736682891845703
mini_batch_src_global generation:  0.0010144710540771484
r_  generation:  0.009896516799926758
local_output_nid generation:  0.0014426708221435547
local_in_edges_tensor generation:  0.0007803440093994141
mini_batch_src_global generation:  0.0010325908660888672
r_  generation:  0.009880542755126953
local_output_nid generation:  0.0014495849609375
local_in_edges_tensor generation:  0.0007641315460205078
mini_batch_src_global generation:  0.0010614395141601562
r_  generation:  0.010416030883789062
local_output_nid generation:  0.0014407634735107422
local_in_edges_tensor generation:  0.0007722377777099609
mini_batch_src_global generation:  0.0010724067687988281
r_  generation:  0.010283231735229492
local_output_nid generation:  0.0014531612396240234
local_in_edges_tensor generation:  0.0007741451263427734
mini_batch_src_global generation:  0.0010747909545898438
r_  generation:  0.010286092758178711
local_output_nid generation:  0.0014503002166748047
local_in_edges_tensor generation:  0.0007622241973876953
mini_batch_src_global generation:  0.0010709762573242188
r_  generation:  0.010101795196533203
local_output_nid generation:  0.0014576911926269531
local_in_edges_tensor generation:  0.0007491111755371094
mini_batch_src_global generation:  0.0010266304016113281
r_  generation:  0.00973963737487793
local_output_nid generation:  0.0014591217041015625
local_in_edges_tensor generation:  0.0007727146148681641
mini_batch_src_global generation:  0.0010848045349121094
r_  generation:  0.010182619094848633
local_output_nid generation:  0.0014562606811523438
local_in_edges_tensor generation:  0.0007784366607666016
mini_batch_src_global generation:  0.0011470317840576172
r_  generation:  0.010530471801757812
local_output_nid generation:  0.0014491081237792969
local_in_edges_tensor generation:  0.0057065486907958984
mini_batch_src_global generation:  0.0012822151184082031
r_  generation:  0.009989023208618164
local_output_nid generation:  0.0013382434844970703
local_in_edges_tensor generation:  0.0007910728454589844
mini_batch_src_global generation:  0.0011153221130371094
r_  generation:  0.009674072265625
local_output_nid generation:  0.0013737678527832031
local_in_edges_tensor generation:  0.0007567405700683594
mini_batch_src_global generation:  0.0010831356048583984
r_  generation:  0.009799003601074219
----------------------check_connections_block total spend ----------------------------- 0.5399727821350098
generate_one_block  0.0159456729888916
generate_one_block  0.015793561935424805
generate_one_block  0.014193534851074219
generate_one_block  0.014403343200683594
generate_one_block  0.014538288116455078
generate_one_block  0.015048742294311523
generate_one_block  0.014833688735961914
generate_one_block  0.015060901641845703
generate_one_block  0.014751911163330078
generate_one_block  0.014966011047363281
generate_one_block  0.015203237533569336
generate_one_block  0.014647483825683594
generate_one_block  0.01434779167175293
generate_one_block  0.01475071907043457
generate_one_block  0.014722824096679688
generate_one_block  0.013981819152832031
generate_one_block  0.015265464782714844
generate_one_block  0.014434337615966797
generate_one_block  0.014675378799438477
generate_one_block  0.014231443405151367
generate_one_block  0.014782905578613281
generate_one_block  0.014619112014770508
generate_one_block  0.015198707580566406
generate_one_block  0.014952421188354492
generate_one_block  0.015048742294311523
generate_one_block  0.014663219451904297
generate_one_block  0.014061212539672852
generate_one_block  0.015019893646240234
generate_one_block  0.01532888412475586
generate_one_block  0.014512777328491211
generate_one_block  0.014275312423706055
generate_one_block  0.014491796493530273
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.044878244400024414
gen group dst list time:  0.023257732391357422
time for parepare:  0.019975900650024414
local_output_nid generation:  0.005623817443847656
local_in_edges_tensor generation:  0.015511035919189453
mini_batch_src_global generation:  0.016355276107788086
r_  generation:  0.1638507843017578
local_output_nid generation:  0.010679006576538086
local_in_edges_tensor generation:  0.01697063446044922
mini_batch_src_global generation:  0.020975589752197266
r_  generation:  0.1719977855682373
local_output_nid generation:  0.009856939315795898
local_in_edges_tensor generation:  0.011310100555419922
mini_batch_src_global generation:  0.01830458641052246
r_  generation:  0.16759181022644043
local_output_nid generation:  0.009959936141967773
local_in_edges_tensor generation:  0.011636734008789062
mini_batch_src_global generation:  0.018984079360961914
r_  generation:  0.17362666130065918
local_output_nid generation:  0.010042667388916016
local_in_edges_tensor generation:  0.012908697128295898
mini_batch_src_global generation:  0.020142078399658203
r_  generation:  0.16985201835632324
local_output_nid generation:  0.013352632522583008
local_in_edges_tensor generation:  0.011930227279663086
mini_batch_src_global generation:  0.022676467895507812
r_  generation:  0.181807279586792
local_output_nid generation:  0.01029205322265625
local_in_edges_tensor generation:  0.011621475219726562
mini_batch_src_global generation:  0.020963430404663086
r_  generation:  0.17629623413085938
local_output_nid generation:  0.010426759719848633
local_in_edges_tensor generation:  0.015622854232788086
mini_batch_src_global generation:  0.026509761810302734
r_  generation:  0.19713187217712402
local_output_nid generation:  0.012993574142456055
local_in_edges_tensor generation:  0.028103113174438477
mini_batch_src_global generation:  0.02700185775756836
r_  generation:  0.18182659149169922
local_output_nid generation:  0.008193492889404297
local_in_edges_tensor generation:  0.011649847030639648
mini_batch_src_global generation:  0.021832704544067383
r_  generation:  0.17392706871032715
local_output_nid generation:  0.008412599563598633
local_in_edges_tensor generation:  0.021886110305786133
mini_batch_src_global generation:  0.023972272872924805
r_  generation:  0.1857929229736328
local_output_nid generation:  0.008287429809570312
local_in_edges_tensor generation:  0.010557889938354492
mini_batch_src_global generation:  0.022199153900146484
r_  generation:  0.18338441848754883
local_output_nid generation:  0.00892949104309082
local_in_edges_tensor generation:  0.016855955123901367
mini_batch_src_global generation:  0.022438764572143555
r_  generation:  0.18560099601745605
local_output_nid generation:  0.010596513748168945
local_in_edges_tensor generation:  0.011914968490600586
mini_batch_src_global generation:  0.024459123611450195
r_  generation:  0.1795201301574707
local_output_nid generation:  0.00816202163696289
local_in_edges_tensor generation:  0.011623144149780273
mini_batch_src_global generation:  0.024735450744628906
r_  generation:  0.1826920509338379
local_output_nid generation:  0.007940053939819336
local_in_edges_tensor generation:  0.008632183074951172
mini_batch_src_global generation:  0.021715879440307617
r_  generation:  0.16800904273986816
local_output_nid generation:  0.008486509323120117
local_in_edges_tensor generation:  0.011939048767089844
mini_batch_src_global generation:  0.02279829978942871
r_  generation:  0.17831182479858398
local_output_nid generation:  0.00811767578125
local_in_edges_tensor generation:  0.010517358779907227
mini_batch_src_global generation:  0.022944211959838867
r_  generation:  0.18202638626098633
local_output_nid generation:  0.008356332778930664
local_in_edges_tensor generation:  0.012024641036987305
mini_batch_src_global generation:  0.023757457733154297
r_  generation:  0.17867207527160645
local_output_nid generation:  0.008202075958251953
local_in_edges_tensor generation:  0.009139776229858398
mini_batch_src_global generation:  0.022043228149414062
r_  generation:  0.1767139434814453
local_output_nid generation:  0.009102344512939453
local_in_edges_tensor generation:  0.016309022903442383
mini_batch_src_global generation:  0.02405071258544922
r_  generation:  0.19234442710876465
local_output_nid generation:  0.010132789611816406
local_in_edges_tensor generation:  0.011372566223144531
mini_batch_src_global generation:  0.02354598045349121
r_  generation:  0.17802953720092773
local_output_nid generation:  0.00845789909362793
local_in_edges_tensor generation:  0.012613773345947266
mini_batch_src_global generation:  0.02325153350830078
r_  generation:  0.18128228187561035
local_output_nid generation:  0.008348226547241211
local_in_edges_tensor generation:  0.012283802032470703
mini_batch_src_global generation:  0.02478194236755371
r_  generation:  0.18145751953125
local_output_nid generation:  0.008493423461914062
local_in_edges_tensor generation:  0.012115240097045898
mini_batch_src_global generation:  0.02360367774963379
r_  generation:  0.18434405326843262
local_output_nid generation:  0.008256196975708008
local_in_edges_tensor generation:  0.010320901870727539
mini_batch_src_global generation:  0.023470401763916016
r_  generation:  0.18134856224060059
local_output_nid generation:  0.007927179336547852
local_in_edges_tensor generation:  0.009341001510620117
mini_batch_src_global generation:  0.02149796485900879
r_  generation:  0.17167162895202637
local_output_nid generation:  0.008380651473999023
local_in_edges_tensor generation:  0.008917093276977539
mini_batch_src_global generation:  0.022835254669189453
r_  generation:  0.18085575103759766
local_output_nid generation:  0.008474111557006836
local_in_edges_tensor generation:  0.012037515640258789
mini_batch_src_global generation:  0.023415327072143555
r_  generation:  0.1849381923675537
local_output_nid generation:  0.008104085922241211
local_in_edges_tensor generation:  0.00882577896118164
mini_batch_src_global generation:  0.02414417266845703
r_  generation:  0.1781785488128662
local_output_nid generation:  0.008022546768188477
local_in_edges_tensor generation:  0.011310577392578125
mini_batch_src_global generation:  0.024694204330444336
r_  generation:  0.1744837760925293
local_output_nid generation:  0.009000301361083984
local_in_edges_tensor generation:  0.01641535758972168
mini_batch_src_global generation:  0.037123680114746094
r_  generation:  0.18478941917419434
----------------------check_connections_block total spend ----------------------------- 8.539125680923462
generate_one_block  0.24155330657958984
generate_one_block  0.23757147789001465
generate_one_block  0.24301719665527344
generate_one_block  0.2173001766204834
generate_one_block  0.2215116024017334
generate_one_block  0.2280592918395996
generate_one_block  0.2265467643737793
generate_one_block  0.2589571475982666
generate_one_block  0.2527773380279541
generate_one_block  0.23233747482299805
generate_one_block  0.24369001388549805
generate_one_block  0.23291420936584473
generate_one_block  0.2294905185699463
generate_one_block  0.24284100532531738
generate_one_block  0.23340749740600586
generate_one_block  0.24933147430419922
generate_one_block  0.2421708106994629
generate_one_block  0.23229408264160156
generate_one_block  0.2277975082397461
generate_one_block  0.22448325157165527
generate_one_block  0.23357129096984863
generate_one_block  0.2290635108947754
generate_one_block  0.2492845058441162
generate_one_block  0.23649168014526367
generate_one_block  0.23929214477539062
generate_one_block  0.23040533065795898
generate_one_block  0.2181692123413086
generate_one_block  0.22918391227722168
generate_one_block  0.2385401725769043
generate_one_block  0.23196911811828613
generate_one_block  0.21746492385864258
generate_one_block  0.22847747802734375
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.052781105041503906
gen group dst list time:  0.11542510986328125
time for parepare:  0.021471500396728516
local_output_nid generation:  0.02447199821472168
local_in_edges_tensor generation:  0.049277305603027344
mini_batch_src_global generation:  0.04801511764526367
r_  generation:  0.47905659675598145
local_output_nid generation:  0.030603408813476562
local_in_edges_tensor generation:  0.05060839653015137
mini_batch_src_global generation:  0.07598614692687988
r_  generation:  0.4870584011077881
local_output_nid generation:  0.029819011688232422
local_in_edges_tensor generation:  0.0371859073638916
mini_batch_src_global generation:  0.05828452110290527
r_  generation:  0.4955480098724365
local_output_nid generation:  0.028617143630981445
local_in_edges_tensor generation:  0.043959617614746094
mini_batch_src_global generation:  0.05785226821899414
r_  generation:  0.4934358596801758
local_output_nid generation:  0.029721975326538086
local_in_edges_tensor generation:  0.03729724884033203
mini_batch_src_global generation:  0.05782890319824219
r_  generation:  0.514176607131958
local_output_nid generation:  0.028484582901000977
local_in_edges_tensor generation:  0.04657578468322754
mini_batch_src_global generation:  0.061905622482299805
r_  generation:  0.4952986240386963
local_output_nid generation:  0.03118753433227539
local_in_edges_tensor generation:  0.04141712188720703
mini_batch_src_global generation:  0.060309410095214844
r_  generation:  0.5040936470031738
local_output_nid generation:  0.029623985290527344
local_in_edges_tensor generation:  0.04185914993286133
mini_batch_src_global generation:  0.05955219268798828
r_  generation:  0.49262142181396484
local_output_nid generation:  0.0296173095703125
local_in_edges_tensor generation:  0.033162593841552734
mini_batch_src_global generation:  0.05912947654724121
r_  generation:  0.5013635158538818
local_output_nid generation:  0.029297828674316406
local_in_edges_tensor generation:  0.032099008560180664
mini_batch_src_global generation:  0.05917024612426758
r_  generation:  0.4903125762939453
local_output_nid generation:  0.029253482818603516
local_in_edges_tensor generation:  0.036980628967285156
mini_batch_src_global generation:  0.058388471603393555
r_  generation:  0.4987919330596924
local_output_nid generation:  0.029203176498413086
local_in_edges_tensor generation:  0.03723931312561035
mini_batch_src_global generation:  0.07584500312805176
r_  generation:  0.4942586421966553
local_output_nid generation:  0.028981685638427734
local_in_edges_tensor generation:  0.03254556655883789
mini_batch_src_global generation:  0.05863380432128906
r_  generation:  0.49156904220581055
local_output_nid generation:  0.02922964096069336
local_in_edges_tensor generation:  0.03675985336303711
mini_batch_src_global generation:  0.059528350830078125
r_  generation:  0.4978678226470947
local_output_nid generation:  0.029263734817504883
local_in_edges_tensor generation:  0.04228043556213379
mini_batch_src_global generation:  0.0590057373046875
r_  generation:  0.496326208114624
local_output_nid generation:  0.02927684783935547
local_in_edges_tensor generation:  0.03615140914916992
mini_batch_src_global generation:  0.05924248695373535
r_  generation:  0.49076342582702637
local_output_nid generation:  0.029369354248046875
local_in_edges_tensor generation:  0.05701637268066406
mini_batch_src_global generation:  0.059662818908691406
r_  generation:  0.4973337650299072
local_output_nid generation:  0.02927708625793457
local_in_edges_tensor generation:  0.0375063419342041
mini_batch_src_global generation:  0.0588231086730957
r_  generation:  0.49594640731811523
local_output_nid generation:  0.030146360397338867
local_in_edges_tensor generation:  0.037525177001953125
mini_batch_src_global generation:  0.05837583541870117
r_  generation:  0.49763989448547363
local_output_nid generation:  0.02949237823486328
local_in_edges_tensor generation:  0.042021989822387695
mini_batch_src_global generation:  0.06030583381652832
r_  generation:  0.4976954460144043
local_output_nid generation:  0.029239654541015625
local_in_edges_tensor generation:  0.03396153450012207
mini_batch_src_global generation:  0.0662848949432373
r_  generation:  0.49841856956481934
local_output_nid generation:  0.029266357421875
local_in_edges_tensor generation:  0.029031753540039062
mini_batch_src_global generation:  0.05907106399536133
r_  generation:  0.4985616207122803
local_output_nid generation:  0.0293276309967041
local_in_edges_tensor generation:  0.04171872138977051
mini_batch_src_global generation:  0.07566714286804199
r_  generation:  0.5054531097412109
local_output_nid generation:  0.029433727264404297
local_in_edges_tensor generation:  0.035877227783203125
mini_batch_src_global generation:  0.06357383728027344
r_  generation:  0.4956223964691162
local_output_nid generation:  0.02955341339111328
local_in_edges_tensor generation:  0.030722379684448242
mini_batch_src_global generation:  0.05872774124145508
r_  generation:  0.5000894069671631
local_output_nid generation:  0.030421972274780273
local_in_edges_tensor generation:  0.028894901275634766
mini_batch_src_global generation:  0.06349349021911621
r_  generation:  0.4992501735687256
local_output_nid generation:  0.029230594635009766
local_in_edges_tensor generation:  0.02916693687438965
mini_batch_src_global generation:  0.058635711669921875
r_  generation:  0.493180513381958
local_output_nid generation:  0.029340028762817383
local_in_edges_tensor generation:  0.02876424789428711
mini_batch_src_global generation:  0.06354522705078125
r_  generation:  0.4996604919433594
local_output_nid generation:  0.029651641845703125
local_in_edges_tensor generation:  0.041722774505615234
mini_batch_src_global generation:  0.06261301040649414
r_  generation:  0.5014734268188477
local_output_nid generation:  0.029098033905029297
local_in_edges_tensor generation:  0.02953791618347168
mini_batch_src_global generation:  0.06079602241516113
r_  generation:  0.49396800994873047
local_output_nid generation:  0.029034852981567383
local_in_edges_tensor generation:  0.028144121170043945
mini_batch_src_global generation:  0.059444427490234375
r_  generation:  0.49427127838134766
local_output_nid generation:  0.02916741371154785
local_in_edges_tensor generation:  0.029448747634887695
mini_batch_src_global generation:  0.0630640983581543
r_  generation:  0.49186277389526367
----------------------check_connections_block total spend ----------------------------- 23.443349599838257
generate_one_block  0.753394603729248
generate_one_block  0.6565589904785156
generate_one_block  0.6286666393280029
generate_one_block  0.6382315158843994
generate_one_block  0.6386477947235107
generate_one_block  0.6407077312469482
generate_one_block  0.6415612697601318
generate_one_block  0.6522376537322998
generate_one_block  0.6451210975646973
generate_one_block  0.6283454895019531
generate_one_block  0.6399309635162354
generate_one_block  0.6445901393890381
generate_one_block  0.6320409774780273
generate_one_block  0.6415181159973145
generate_one_block  0.6464929580688477
generate_one_block  0.637122631072998
generate_one_block  0.6392850875854492
generate_one_block  0.6397943496704102
generate_one_block  0.6426949501037598
generate_one_block  0.6436903476715088
generate_one_block  0.6582436561584473
generate_one_block  0.6417489051818848
generate_one_block  0.6471805572509766
generate_one_block  0.6559174060821533
generate_one_block  0.640866756439209
generate_one_block  0.6363670825958252
generate_one_block  0.6290295124053955
generate_one_block  0.65997314453125
generate_one_block  0.676349401473999
generate_one_block  0.6339309215545654
generate_one_block  0.62729811668396
generate_one_block  0.6352860927581787
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0213623046875 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

connection checking time:  31.98247528076172
block generation total time  28.17279028892517
average batch blocks generation time:  0.8803996965289116
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.09394311904907227  GigaBytes
Max Memory Allocated: 0.09394311904907227  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 21.152634143829346  GigaBytes
Max Memory Allocated: 21.255738735198975  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.5350341796875 GB
    Memory Allocated: 0.09912443161010742  GigaBytes
Max Memory Allocated: 21.255738735198975  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0350341796875 GB
    Memory Allocated: 21.275112628936768  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 0.09911918640136719  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 20.291638374328613  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 0.09875345230102539  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 20.486087799072266  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 0.09922027587890625  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 20.47639560699463  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 0.09875011444091797  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 20.897328853607178  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 0.09932899475097656  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 20.662569046020508  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 0.09908866882324219  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 20.975686073303223  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 0.09946823120117188  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 20.87418031692505  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 0.09865140914916992  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 20.613747119903564  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 0.09952926635742188  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 21.04065752029419  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 0.09865093231201172  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 20.819167137145996  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 0.09821224212646484  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 20.567372798919678  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 0.09893989562988281  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 20.771794319152832  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 0.09943866729736328  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 20.847851753234863  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 0.09840106964111328  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 20.03981351852417  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 0.09943675994873047  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 20.86650848388672  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 0.0986628532409668  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 20.737123012542725  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 0.09941768646240234  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 20.8381028175354  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 0.09882259368896484  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 20.61806869506836  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 0.09939956665039062  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 20.790552616119385  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 0.09877395629882812  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 20.703038215637207  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 0.09949207305908203  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 20.949594020843506  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 0.09902286529541016  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 21.022499561309814  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 0.09952640533447266  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 21.011947631835938  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 0.09876203536987305  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 20.908059120178223  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 0.09909248352050781  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 20.25035572052002  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 0.09883880615234375  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 20.959659576416016  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 0.0995798110961914  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 21.089177131652832  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 0.09888648986816406  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 20.650710582733154  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 0.09915447235107422  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 20.3271484375  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 0.09868764877319336  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 20.80022144317627  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.041312240064144135 |0.03715398162603378 |0.6896485462784767 |0.00010798871517181396 |1.5710354670882225 |0.01750469207763672 |
----------------------------------------------------------pseudo_mini_loss sum 5.395388603210449
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9160498
Number of first layer input nodes during this epoch:  4807464
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 0.1313166618347168  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02714061737060547
random selection method range initialization spend 0.005563259124755859
time for parepare:  0.019299745559692383
local_output_nid generation:  0.0014467239379882812
local_in_edges_tensor generation:  0.008143424987792969
mini_batch_src_global generation:  0.0018601417541503906
r_  generation:  0.010866880416870117
local_output_nid generation:  0.0017547607421875
local_in_edges_tensor generation:  0.001352071762084961
mini_batch_src_global generation:  0.0017452239990234375
r_  generation:  0.01050114631652832
local_output_nid generation:  0.0017545223236083984
local_in_edges_tensor generation:  0.0012221336364746094
mini_batch_src_global generation:  0.0012671947479248047
r_  generation:  0.010365009307861328
local_output_nid generation:  0.0016891956329345703
local_in_edges_tensor generation:  0.0011935234069824219
mini_batch_src_global generation:  0.0012497901916503906
r_  generation:  0.010227680206298828
local_output_nid generation:  0.0016541481018066406
local_in_edges_tensor generation:  0.001117706298828125
mini_batch_src_global generation:  0.0012106895446777344
r_  generation:  0.010385751724243164
local_output_nid generation:  0.0016865730285644531
local_in_edges_tensor generation:  0.0011599063873291016
mini_batch_src_global generation:  0.0013720989227294922
r_  generation:  0.010254383087158203
local_output_nid generation:  0.0016405582427978516
local_in_edges_tensor generation:  0.001148223876953125
mini_batch_src_global generation:  0.0012025833129882812
r_  generation:  0.010311126708984375
local_output_nid generation:  0.0016398429870605469
local_in_edges_tensor generation:  0.0011222362518310547
mini_batch_src_global generation:  0.0013506412506103516
r_  generation:  0.010176897048950195
local_output_nid generation:  0.0016493797302246094
local_in_edges_tensor generation:  0.0011143684387207031
mini_batch_src_global generation:  0.00115203857421875
r_  generation:  0.010164737701416016
local_output_nid generation:  0.0016448497772216797
local_in_edges_tensor generation:  0.0011262893676757812
mini_batch_src_global generation:  0.0012819766998291016
r_  generation:  0.010716676712036133
local_output_nid generation:  0.001650094985961914
local_in_edges_tensor generation:  0.001116037368774414
mini_batch_src_global generation:  0.001378774642944336
r_  generation:  0.010867118835449219
local_output_nid generation:  0.00164794921875
local_in_edges_tensor generation:  0.0011222362518310547
mini_batch_src_global generation:  0.0012710094451904297
r_  generation:  0.01058053970336914
local_output_nid generation:  0.0016701221466064453
local_in_edges_tensor generation:  0.001119852066040039
mini_batch_src_global generation:  0.0011489391326904297
r_  generation:  0.010012388229370117
local_output_nid generation:  0.0016312599182128906
local_in_edges_tensor generation:  0.0011067390441894531
mini_batch_src_global generation:  0.0011756420135498047
r_  generation:  0.00994873046875
local_output_nid generation:  0.0016281604766845703
local_in_edges_tensor generation:  0.0011103153228759766
mini_batch_src_global generation:  0.0012259483337402344
r_  generation:  0.010818719863891602
local_output_nid generation:  0.0016469955444335938
local_in_edges_tensor generation:  0.0010571479797363281
mini_batch_src_global generation:  0.0011210441589355469
r_  generation:  0.010184288024902344
local_output_nid generation:  0.0016162395477294922
local_in_edges_tensor generation:  0.0010788440704345703
mini_batch_src_global generation:  0.001323699951171875
r_  generation:  0.010257482528686523
local_output_nid generation:  0.0016102790832519531
local_in_edges_tensor generation:  0.0011148452758789062
mini_batch_src_global generation:  0.0012359619140625
r_  generation:  0.01062774658203125
local_output_nid generation:  0.0016155242919921875
local_in_edges_tensor generation:  0.0011055469512939453
mini_batch_src_global generation:  0.0012407302856445312
r_  generation:  0.010915279388427734
local_output_nid generation:  0.001661539077758789
local_in_edges_tensor generation:  0.0010819435119628906
mini_batch_src_global generation:  0.0011894702911376953
r_  generation:  0.01062631607055664
local_output_nid generation:  0.0016117095947265625
local_in_edges_tensor generation:  0.001081705093383789
mini_batch_src_global generation:  0.0012803077697753906
r_  generation:  0.010647773742675781
local_output_nid generation:  0.001607656478881836
local_in_edges_tensor generation:  0.0010707378387451172
mini_batch_src_global generation:  0.0012884140014648438
r_  generation:  0.011029243469238281
local_output_nid generation:  0.0016145706176757812
local_in_edges_tensor generation:  0.0011017322540283203
mini_batch_src_global generation:  0.0012164115905761719
r_  generation:  0.011014223098754883
local_output_nid generation:  0.001680612564086914
local_in_edges_tensor generation:  0.0010914802551269531
mini_batch_src_global generation:  0.0012028217315673828
r_  generation:  0.010541439056396484
local_output_nid generation:  0.0016193389892578125
local_in_edges_tensor generation:  0.0011286735534667969
mini_batch_src_global generation:  0.0012259483337402344
r_  generation:  0.010514259338378906
local_output_nid generation:  0.0016286373138427734
local_in_edges_tensor generation:  0.0011069774627685547
mini_batch_src_global generation:  0.0012297630310058594
r_  generation:  0.010475635528564453
local_output_nid generation:  0.0016148090362548828
local_in_edges_tensor generation:  0.0011043548583984375
mini_batch_src_global generation:  0.0012514591217041016
r_  generation:  0.01077890396118164
local_output_nid generation:  0.0016415119171142578
local_in_edges_tensor generation:  0.0011210441589355469
mini_batch_src_global generation:  0.0011799335479736328
r_  generation:  0.010444402694702148
local_output_nid generation:  0.0016317367553710938
local_in_edges_tensor generation:  0.0011229515075683594
mini_batch_src_global generation:  0.0012524127960205078
r_  generation:  0.010602951049804688
local_output_nid generation:  0.0016150474548339844
local_in_edges_tensor generation:  0.001112222671508789
mini_batch_src_global generation:  0.0014019012451171875
r_  generation:  0.010587215423583984
local_output_nid generation:  0.001611948013305664
local_in_edges_tensor generation:  0.0010564327239990234
mini_batch_src_global generation:  0.0013756752014160156
r_  generation:  0.01073598861694336
local_output_nid generation:  0.0016012191772460938
local_in_edges_tensor generation:  0.0011184215545654297
mini_batch_src_global generation:  0.0012292861938476562
r_  generation:  0.010441303253173828
----------------------check_connections_block total spend ----------------------------- 0.5912206172943115
generate_one_block  0.026148080825805664
generate_one_block  0.022045373916625977
generate_one_block  0.02085733413696289
generate_one_block  0.01954936981201172
generate_one_block  0.01979804039001465
generate_one_block  0.019151687622070312
generate_one_block  0.01896071434020996
generate_one_block  0.018756628036499023
generate_one_block  0.018723726272583008
generate_one_block  0.019415855407714844
generate_one_block  0.019696712493896484
generate_one_block  0.019440650939941406
generate_one_block  0.017826557159423828
generate_one_block  0.018184900283813477
generate_one_block  0.020088672637939453
generate_one_block  0.018381357192993164
generate_one_block  0.018669843673706055
generate_one_block  0.01932549476623535
generate_one_block  0.019866228103637695
generate_one_block  0.019142627716064453
generate_one_block  0.01934957504272461
generate_one_block  0.020046472549438477
generate_one_block  0.01975226402282715
generate_one_block  0.019075870513916016
generate_one_block  0.019060850143432617
generate_one_block  0.019214630126953125
generate_one_block  0.019692659378051758
generate_one_block  0.018922805786132812
generate_one_block  0.019243955612182617
generate_one_block  0.019311189651489258
generate_one_block  0.019336700439453125
generate_one_block  0.01896214485168457
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04235506057739258
gen group dst list time:  0.02199864387512207
time for parepare:  0.019753694534301758
local_output_nid generation:  0.006901264190673828
local_in_edges_tensor generation:  0.01711249351501465
mini_batch_src_global generation:  0.015890121459960938
r_  generation:  0.16012048721313477
local_output_nid generation:  0.009542226791381836
local_in_edges_tensor generation:  0.011439800262451172
mini_batch_src_global generation:  0.023888349533081055
r_  generation:  0.16605353355407715
local_output_nid generation:  0.010294198989868164
local_in_edges_tensor generation:  0.03353476524353027
mini_batch_src_global generation:  0.019996166229248047
r_  generation:  0.17962002754211426
local_output_nid generation:  0.00996708869934082
local_in_edges_tensor generation:  0.012231588363647461
mini_batch_src_global generation:  0.022259235382080078
r_  generation:  0.17535662651062012
local_output_nid generation:  0.009940624237060547
local_in_edges_tensor generation:  0.01065206527709961
mini_batch_src_global generation:  0.02213120460510254
r_  generation:  0.18544626235961914
local_output_nid generation:  0.009570598602294922
local_in_edges_tensor generation:  0.010589599609375
mini_batch_src_global generation:  0.021848440170288086
r_  generation:  0.18084168434143066
local_output_nid generation:  0.009449958801269531
local_in_edges_tensor generation:  0.010552406311035156
mini_batch_src_global generation:  0.02218174934387207
r_  generation:  0.17972946166992188
local_output_nid generation:  0.009433507919311523
local_in_edges_tensor generation:  0.010448217391967773
mini_batch_src_global generation:  0.02188849449157715
r_  generation:  0.17734217643737793
local_output_nid generation:  0.009729385375976562
local_in_edges_tensor generation:  0.00901341438293457
mini_batch_src_global generation:  0.02179121971130371
r_  generation:  0.1769254207611084
local_output_nid generation:  0.009989023208618164
local_in_edges_tensor generation:  0.009872198104858398
mini_batch_src_global generation:  0.023849964141845703
r_  generation:  0.18447065353393555
local_output_nid generation:  0.010285139083862305
local_in_edges_tensor generation:  0.012322664260864258
mini_batch_src_global generation:  0.02301788330078125
r_  generation:  0.18713045120239258
local_output_nid generation:  0.01012110710144043
local_in_edges_tensor generation:  0.010523080825805664
mini_batch_src_global generation:  0.02276325225830078
r_  generation:  0.18416357040405273
local_output_nid generation:  0.00958395004272461
local_in_edges_tensor generation:  0.008693695068359375
mini_batch_src_global generation:  0.021296977996826172
r_  generation:  0.1676177978515625
local_output_nid generation:  0.009702920913696289
local_in_edges_tensor generation:  0.008674860000610352
mini_batch_src_global generation:  0.02153182029724121
r_  generation:  0.17390894889831543
local_output_nid generation:  0.010381698608398438
local_in_edges_tensor generation:  0.01062631607055664
mini_batch_src_global generation:  0.024709463119506836
r_  generation:  0.19289350509643555
local_output_nid generation:  0.009783267974853516
local_in_edges_tensor generation:  0.008854389190673828
mini_batch_src_global generation:  0.022023439407348633
r_  generation:  0.17374253273010254
local_output_nid generation:  0.009862422943115234
local_in_edges_tensor generation:  0.01038360595703125
mini_batch_src_global generation:  0.022227764129638672
r_  generation:  0.1801896095275879
local_output_nid generation:  0.010405302047729492
local_in_edges_tensor generation:  0.010587453842163086
mini_batch_src_global generation:  0.02283310890197754
r_  generation:  0.18561625480651855
local_output_nid generation:  0.010124444961547852
local_in_edges_tensor generation:  0.014045476913452148
mini_batch_src_global generation:  0.023936033248901367
r_  generation:  0.1935892105102539
local_output_nid generation:  0.009655952453613281
local_in_edges_tensor generation:  0.009462356567382812
mini_batch_src_global generation:  0.023273468017578125
r_  generation:  0.186082124710083
local_output_nid generation:  0.009750604629516602
local_in_edges_tensor generation:  0.01078033447265625
mini_batch_src_global generation:  0.023207664489746094
r_  generation:  0.18599343299865723
local_output_nid generation:  0.009942770004272461
local_in_edges_tensor generation:  0.012292861938476562
mini_batch_src_global generation:  0.024772167205810547
r_  generation:  0.18898797035217285
local_output_nid generation:  0.009847879409790039
local_in_edges_tensor generation:  0.010740041732788086
mini_batch_src_global generation:  0.025300264358520508
r_  generation:  0.1891639232635498
local_output_nid generation:  0.009634733200073242
local_in_edges_tensor generation:  0.009563446044921875
mini_batch_src_global generation:  0.022875547409057617
r_  generation:  0.18345904350280762
local_output_nid generation:  0.009522676467895508
local_in_edges_tensor generation:  0.009091377258300781
mini_batch_src_global generation:  0.022718191146850586
r_  generation:  0.18465709686279297
local_output_nid generation:  0.009690999984741211
local_in_edges_tensor generation:  0.011590003967285156
mini_batch_src_global generation:  0.022807836532592773
r_  generation:  0.18555879592895508
local_output_nid generation:  0.009740114212036133
local_in_edges_tensor generation:  0.012081623077392578
mini_batch_src_global generation:  0.02288985252380371
r_  generation:  0.18619251251220703
local_output_nid generation:  0.009412050247192383
local_in_edges_tensor generation:  0.009268522262573242
mini_batch_src_global generation:  0.02305150032043457
r_  generation:  0.18334269523620605
local_output_nid generation:  0.009729623794555664
local_in_edges_tensor generation:  0.010031461715698242
mini_batch_src_global generation:  0.022750377655029297
r_  generation:  0.18717241287231445
local_output_nid generation:  0.009628772735595703
local_in_edges_tensor generation:  0.012174606323242188
mini_batch_src_global generation:  0.024730205535888672
r_  generation:  0.1866321563720703
local_output_nid generation:  0.009644508361816406
local_in_edges_tensor generation:  0.009366512298583984
mini_batch_src_global generation:  0.02481222152709961
r_  generation:  0.18898320198059082
local_output_nid generation:  0.009513378143310547
local_in_edges_tensor generation:  0.009368419647216797
mini_batch_src_global generation:  0.022513628005981445
r_  generation:  0.17912983894348145
----------------------check_connections_block total spend ----------------------------- 8.52958083152771
generate_one_block  0.24996209144592285
generate_one_block  0.23828887939453125
generate_one_block  0.2529873847961426
generate_one_block  0.2480611801147461
generate_one_block  0.28461337089538574
generate_one_block  0.24899578094482422
generate_one_block  0.24501919746398926
generate_one_block  0.24006438255310059
generate_one_block  0.242567777633667
generate_one_block  0.25312089920043945
generate_one_block  0.25717663764953613
generate_one_block  0.24562931060791016
generate_one_block  0.22478723526000977
generate_one_block  0.23107123374938965
generate_one_block  0.26213812828063965
generate_one_block  0.22999167442321777
generate_one_block  0.24269604682922363
generate_one_block  0.2516016960144043
generate_one_block  0.26379823684692383
generate_one_block  0.24779820442199707
generate_one_block  0.2539653778076172
generate_one_block  0.2585115432739258
generate_one_block  0.25726938247680664
generate_one_block  0.24100542068481445
generate_one_block  0.24284052848815918
generate_one_block  0.2502892017364502
generate_one_block  0.2517359256744385
generate_one_block  0.24751019477844238
generate_one_block  0.2529325485229492
generate_one_block  0.25353431701660156
generate_one_block  0.2555699348449707
generate_one_block  0.23947453498840332
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04008841514587402
gen group dst list time:  0.10199570655822754
time for parepare:  0.018208026885986328
local_output_nid generation:  0.02564382553100586
local_in_edges_tensor generation:  0.039215087890625
mini_batch_src_global generation:  0.04838252067565918
r_  generation:  0.4752976894378662
local_output_nid generation:  0.03175759315490723
local_in_edges_tensor generation:  0.04665517807006836
mini_batch_src_global generation:  0.057787418365478516
r_  generation:  0.48267436027526855
local_output_nid generation:  0.031494140625
local_in_edges_tensor generation:  0.042600393295288086
mini_batch_src_global generation:  0.056015729904174805
r_  generation:  0.4918251037597656
local_output_nid generation:  0.030731916427612305
local_in_edges_tensor generation:  0.039466142654418945
mini_batch_src_global generation:  0.061560630798339844
r_  generation:  0.4920778274536133
local_output_nid generation:  0.03079676628112793
local_in_edges_tensor generation:  0.034398794174194336
mini_batch_src_global generation:  0.05856180191040039
r_  generation:  0.5005104541778564
local_output_nid generation:  0.030524730682373047
local_in_edges_tensor generation:  0.03009510040283203
mini_batch_src_global generation:  0.05966329574584961
r_  generation:  0.4959232807159424
local_output_nid generation:  0.03059220314025879
local_in_edges_tensor generation:  0.029496192932128906
mini_batch_src_global generation:  0.058071136474609375
r_  generation:  0.4961574077606201
local_output_nid generation:  0.029993295669555664
local_in_edges_tensor generation:  0.029131174087524414
mini_batch_src_global generation:  0.05896782875061035
r_  generation:  0.49659109115600586
local_output_nid generation:  0.030356168746948242
local_in_edges_tensor generation:  0.03412938117980957
mini_batch_src_global generation:  0.05883193016052246
r_  generation:  0.49510622024536133
local_output_nid generation:  0.030193567276000977
local_in_edges_tensor generation:  0.03884720802307129
mini_batch_src_global generation:  0.059266090393066406
r_  generation:  0.502316951751709
local_output_nid generation:  0.030687332153320312
local_in_edges_tensor generation:  0.043015241622924805
mini_batch_src_global generation:  0.059410810470581055
r_  generation:  0.5135424137115479
local_output_nid generation:  0.030602216720581055
local_in_edges_tensor generation:  0.030076026916503906
mini_batch_src_global generation:  0.06051063537597656
r_  generation:  0.4993264675140381
local_output_nid generation:  0.0301210880279541
local_in_edges_tensor generation:  0.029016494750976562
mini_batch_src_global generation:  0.05841684341430664
r_  generation:  0.49256229400634766
local_output_nid generation:  0.030147552490234375
local_in_edges_tensor generation:  0.033262014389038086
mini_batch_src_global generation:  0.05942225456237793
r_  generation:  0.5034472942352295
local_output_nid generation:  0.030175209045410156
local_in_edges_tensor generation:  0.04279971122741699
mini_batch_src_global generation:  0.05898118019104004
r_  generation:  0.5036683082580566
local_output_nid generation:  0.029946565628051758
local_in_edges_tensor generation:  0.029551267623901367
mini_batch_src_global generation:  0.05925726890563965
r_  generation:  0.49010705947875977
local_output_nid generation:  0.030015945434570312
local_in_edges_tensor generation:  0.03813028335571289
mini_batch_src_global generation:  0.06221437454223633
r_  generation:  0.5082712173461914
local_output_nid generation:  0.030641555786132812
local_in_edges_tensor generation:  0.04259014129638672
mini_batch_src_global generation:  0.05974173545837402
r_  generation:  0.5041635036468506
local_output_nid generation:  0.030461549758911133
local_in_edges_tensor generation:  0.034908294677734375
mini_batch_src_global generation:  0.05977940559387207
r_  generation:  0.5128922462463379
local_output_nid generation:  0.030199527740478516
local_in_edges_tensor generation:  0.0308835506439209
mini_batch_src_global generation:  0.06016874313354492
r_  generation:  0.5098762512207031
local_output_nid generation:  0.030289888381958008
local_in_edges_tensor generation:  0.04353737831115723
mini_batch_src_global generation:  0.0588226318359375
r_  generation:  0.5093791484832764
local_output_nid generation:  0.03017902374267578
local_in_edges_tensor generation:  0.038558244705200195
mini_batch_src_global generation:  0.06025958061218262
r_  generation:  0.4995286464691162
local_output_nid generation:  0.030646800994873047
local_in_edges_tensor generation:  0.04301857948303223
mini_batch_src_global generation:  0.05896496772766113
r_  generation:  0.5066049098968506
local_output_nid generation:  0.030427217483520508
local_in_edges_tensor generation:  0.03289008140563965
mini_batch_src_global generation:  0.06015491485595703
r_  generation:  0.49654555320739746
local_output_nid generation:  0.029867887496948242
local_in_edges_tensor generation:  0.0410616397857666
mini_batch_src_global generation:  0.05872082710266113
r_  generation:  0.4996919631958008
local_output_nid generation:  0.03016829490661621
local_in_edges_tensor generation:  0.03382706642150879
mini_batch_src_global generation:  0.06264472007751465
r_  generation:  0.4982767105102539
local_output_nid generation:  0.03013157844543457
local_in_edges_tensor generation:  0.034209251403808594
mini_batch_src_global generation:  0.059266090393066406
r_  generation:  0.49801111221313477
local_output_nid generation:  0.030135154724121094
local_in_edges_tensor generation:  0.03371739387512207
mini_batch_src_global generation:  0.06229376792907715
r_  generation:  0.49359703063964844
local_output_nid generation:  0.030247211456298828
local_in_edges_tensor generation:  0.042954206466674805
mini_batch_src_global generation:  0.05849647521972656
r_  generation:  0.5051355361938477
local_output_nid generation:  0.0312044620513916
local_in_edges_tensor generation:  0.03251981735229492
mini_batch_src_global generation:  0.06307864189147949
r_  generation:  0.4981696605682373
local_output_nid generation:  0.030415058135986328
local_in_edges_tensor generation:  0.038764238357543945
mini_batch_src_global generation:  0.06208324432373047
r_  generation:  0.5069975852966309
local_output_nid generation:  0.03009486198425293
local_in_edges_tensor generation:  0.03921818733215332
mini_batch_src_global generation:  0.06845521926879883
r_  generation:  0.4981420040130615
----------------------check_connections_block total spend ----------------------------- 23.49482035636902
generate_one_block  0.6935133934020996
generate_one_block  0.6928126811981201
generate_one_block  0.6910409927368164
generate_one_block  0.6848840713500977
generate_one_block  0.8142757415771484
generate_one_block  0.6773624420166016
generate_one_block  0.6765596866607666
generate_one_block  0.6832914352416992
generate_one_block  0.682025671005249
generate_one_block  0.6869962215423584
generate_one_block  0.7009685039520264
generate_one_block  0.6941850185394287
generate_one_block  0.6606595516204834
generate_one_block  0.6698610782623291
generate_one_block  0.6925158500671387
generate_one_block  0.6750931739807129
generate_one_block  0.6783068180084229
generate_one_block  0.688495397567749
generate_one_block  0.6925127506256104
generate_one_block  0.6663064956665039
generate_one_block  0.7369730472564697
generate_one_block  0.6856870651245117
generate_one_block  0.6895005702972412
generate_one_block  0.6683621406555176
generate_one_block  0.7011215686798096
generate_one_block  0.732835054397583
generate_one_block  0.6753873825073242
generate_one_block  0.7029623985290527
generate_one_block  0.7007529735565186
generate_one_block  0.6888973712921143
generate_one_block  0.7070498466491699
generate_one_block  0.6876580715179443
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 0.1313166618347168  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

connection checking time:  32.02440118789673
block generation total time  30.1438627243042
average batch blocks generation time:  0.9419957101345062
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 0.1097559928894043  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 20.63452672958374  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 0.10890722274780273  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 20.44048500061035  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 0.10999584197998047  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8572998046875 GB
    Memory Allocated: 21.098998546600342  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8592529296875 GB
    Memory Allocated: 0.1091771125793457  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8592529296875 GB
    Memory Allocated: 20.71348237991333  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8592529296875 GB
    Memory Allocated: 0.11008167266845703  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0936279296875 GB
    Memory Allocated: 21.20806646347046  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9041748046875 GB
    Memory Allocated: 0.10922479629516602  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5916748046875 GB
    Memory Allocated: 20.781307220458984  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5936279296875 GB
    Memory Allocated: 0.10979747772216797  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7225341796875 GB
    Memory Allocated: 20.71744680404663  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7225341796875 GB
    Memory Allocated: 0.1089024543762207  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7225341796875 GB
    Memory Allocated: 20.55210304260254  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7225341796875 GB
    Memory Allocated: 0.1096944808959961  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7225341796875 GB
    Memory Allocated: 20.533057689666748  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7225341796875 GB
    Memory Allocated: 0.10932302474975586  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8709716796875 GB
    Memory Allocated: 20.90345573425293  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8709716796875 GB
    Memory Allocated: 0.11008358001708984  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1072998046875 GB
    Memory Allocated: 21.20451307296753  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.6053466796875 GB
    Memory Allocated: 0.10937166213989258  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5819091796875 GB
    Memory Allocated: 20.818806648254395  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5858154296875 GB
    Memory Allocated: 0.1092691421508789  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5858154296875 GB
    Memory Allocated: 19.839053630828857  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 0.10874748229980469  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 20.144649982452393  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0721435546875 GB
    Memory Allocated: 0.1101236343383789  GigaBytes
Max Memory Allocated: 21.377182006835938  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 21.291367530822754  GigaBytes
Max Memory Allocated: 21.390426635742188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6580810546875 GB
    Memory Allocated: 0.10880279541015625  GigaBytes
Max Memory Allocated: 21.390426635742188  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9237060546875 GB
    Memory Allocated: 20.09845781326294  GigaBytes
Max Memory Allocated: 21.390426635742188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9256591796875 GB
    Memory Allocated: 0.1097860336303711  GigaBytes
Max Memory Allocated: 21.390426635742188  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1053466796875 GB
    Memory Allocated: 20.664666652679443  GigaBytes
Max Memory Allocated: 21.390426635742188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1072998046875 GB
    Memory Allocated: 0.10947227478027344  GigaBytes
Max Memory Allocated: 21.390426635742188  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1072998046875 GB
    Memory Allocated: 20.855424404144287  GigaBytes
Max Memory Allocated: 21.390426635742188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1072998046875 GB
    Memory Allocated: 0.11018562316894531  GigaBytes
Max Memory Allocated: 21.390426635742188  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2459716796875 GB
    Memory Allocated: 21.394606113433838  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2635498046875 GB
    Memory Allocated: 0.1093282699584961  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7811279296875 GB
    Memory Allocated: 20.74854803085327  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10991382598876953  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.937153339385986  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10916948318481445  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 21.105212688446045  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4569091796875 GB
    Memory Allocated: 0.1101083755493164  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 21.254576206207275  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0506591796875 GB
    Memory Allocated: 0.10922050476074219  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0506591796875 GB
    Memory Allocated: 20.610633373260498  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0506591796875 GB
    Memory Allocated: 0.10979366302490234  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0740966796875 GB
    Memory Allocated: 20.68056631088257  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0760498046875 GB
    Memory Allocated: 0.1092529296875  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0760498046875 GB
    Memory Allocated: 20.815195560455322  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0760498046875 GB
    Memory Allocated: 0.10987377166748047  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0760498046875 GB
    Memory Allocated: 20.883314609527588  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0760498046875 GB
    Memory Allocated: 0.10892820358276367  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0760498046875 GB
    Memory Allocated: 20.70799970626831  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0760498046875 GB
    Memory Allocated: 0.10993385314941406  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0760498046875 GB
    Memory Allocated: 20.926846504211426  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0760498046875 GB
    Memory Allocated: 0.10928773880004883  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0994873046875 GB
    Memory Allocated: 20.96869659423828  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1014404296875 GB
    Memory Allocated: 0.11003303527832031  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2362060546875 GB
    Memory Allocated: 21.13460111618042  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2362060546875 GB
    Memory Allocated: 0.10907173156738281  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2362060546875 GB
    Memory Allocated: 20.491117000579834  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03001265972852707 |0.02597825974225998 |0.7138038799166679 |0.00010576099157333374 |1.387543000280857 |0.008576154708862305 |
----------------------------------------------------------pseudo_mini_loss sum 3.94765305519104
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9160098
Number of first layer input nodes during this epoch:  4807833
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.2362060546875 GB
    Memory Allocated: 0.13089847564697266  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.028641700744628906
random selection method range initialization spend 0.006677865982055664
time for parepare:  0.022517919540405273
local_output_nid generation:  0.0015859603881835938
local_in_edges_tensor generation:  0.005799531936645508
mini_batch_src_global generation:  0.0016832351684570312
r_  generation:  0.010734319686889648
local_output_nid generation:  0.0017750263214111328
local_in_edges_tensor generation:  0.001251220703125
mini_batch_src_global generation:  0.0017695426940917969
r_  generation:  0.010518312454223633
local_output_nid generation:  0.0019538402557373047
local_in_edges_tensor generation:  0.0011510848999023438
mini_batch_src_global generation:  0.001117706298828125
r_  generation:  0.009515762329101562
local_output_nid generation:  0.0019042491912841797
local_in_edges_tensor generation:  0.0011088848114013672
mini_batch_src_global generation:  0.0011620521545410156
r_  generation:  0.009767770767211914
local_output_nid generation:  0.0018885135650634766
local_in_edges_tensor generation:  0.001085519790649414
mini_batch_src_global generation:  0.0010800361633300781
r_  generation:  0.009727239608764648
local_output_nid generation:  0.0019288063049316406
local_in_edges_tensor generation:  0.0010840892791748047
mini_batch_src_global generation:  0.0012826919555664062
r_  generation:  0.010470390319824219
local_output_nid generation:  0.0020177364349365234
local_in_edges_tensor generation:  0.0011394023895263672
mini_batch_src_global generation:  0.001142740249633789
r_  generation:  0.010159492492675781
local_output_nid generation:  0.001940011978149414
local_in_edges_tensor generation:  0.0010685920715332031
mini_batch_src_global generation:  0.0011699199676513672
r_  generation:  0.010071516036987305
local_output_nid generation:  0.0019309520721435547
local_in_edges_tensor generation:  0.0010802745819091797
mini_batch_src_global generation:  0.001127481460571289
r_  generation:  0.01037454605102539
local_output_nid generation:  0.0019457340240478516
local_in_edges_tensor generation:  0.0010509490966796875
mini_batch_src_global generation:  0.0011477470397949219
r_  generation:  0.010753870010375977
local_output_nid generation:  0.0019500255584716797
local_in_edges_tensor generation:  0.0010228157043457031
mini_batch_src_global generation:  0.0011548995971679688
r_  generation:  0.010149955749511719
local_output_nid generation:  0.0019555091857910156
local_in_edges_tensor generation:  0.001031637191772461
mini_batch_src_global generation:  0.001089334487915039
r_  generation:  0.010038375854492188
local_output_nid generation:  0.0019533634185791016
local_in_edges_tensor generation:  0.001043558120727539
mini_batch_src_global generation:  0.0012028217315673828
r_  generation:  0.010577678680419922
local_output_nid generation:  0.0019485950469970703
local_in_edges_tensor generation:  0.001064300537109375
mini_batch_src_global generation:  0.0012755393981933594
r_  generation:  0.010631322860717773
local_output_nid generation:  0.0019724369049072266
local_in_edges_tensor generation:  0.0010406970977783203
mini_batch_src_global generation:  0.0011293888092041016
r_  generation:  0.010259389877319336
local_output_nid generation:  0.001963376998901367
local_in_edges_tensor generation:  0.0010540485382080078
mini_batch_src_global generation:  0.001134634017944336
r_  generation:  0.010365486145019531
local_output_nid generation:  0.001965761184692383
local_in_edges_tensor generation:  0.0010924339294433594
mini_batch_src_global generation:  0.0011453628540039062
r_  generation:  0.010578632354736328
local_output_nid generation:  0.0019609928131103516
local_in_edges_tensor generation:  0.0010399818420410156
mini_batch_src_global generation:  0.0012085437774658203
r_  generation:  0.010840654373168945
local_output_nid generation:  0.0019648075103759766
local_in_edges_tensor generation:  0.0010471343994140625
mini_batch_src_global generation:  0.0011467933654785156
r_  generation:  0.01024484634399414
local_output_nid generation:  0.0019783973693847656
local_in_edges_tensor generation:  0.0010519027709960938
mini_batch_src_global generation:  0.001107931137084961
r_  generation:  0.010183572769165039
local_output_nid generation:  0.0019669532775878906
local_in_edges_tensor generation:  0.001058816909790039
mini_batch_src_global generation:  0.0011594295501708984
r_  generation:  0.010590553283691406
local_output_nid generation:  0.0019774436950683594
local_in_edges_tensor generation:  0.0010714530944824219
mini_batch_src_global generation:  0.0011837482452392578
r_  generation:  0.010679483413696289
local_output_nid generation:  0.001961946487426758
local_in_edges_tensor generation:  0.0010302066802978516
mini_batch_src_global generation:  0.0011680126190185547
r_  generation:  0.010242938995361328
local_output_nid generation:  0.0019559860229492188
local_in_edges_tensor generation:  0.0010368824005126953
mini_batch_src_global generation:  0.0012023448944091797
r_  generation:  0.012706518173217773
local_output_nid generation:  0.0019516944885253906
local_in_edges_tensor generation:  0.001058816909790039
mini_batch_src_global generation:  0.0011875629425048828
r_  generation:  0.010436296463012695
local_output_nid generation:  0.0019774436950683594
local_in_edges_tensor generation:  0.0010387897491455078
mini_batch_src_global generation:  0.001180887222290039
r_  generation:  0.010216474533081055
local_output_nid generation:  0.00196075439453125
local_in_edges_tensor generation:  0.0010437965393066406
mini_batch_src_global generation:  0.0011210441589355469
r_  generation:  0.0103607177734375
local_output_nid generation:  0.0019457340240478516
local_in_edges_tensor generation:  0.0010304450988769531
mini_batch_src_global generation:  0.0011353492736816406
r_  generation:  0.010540962219238281
local_output_nid generation:  0.001953601837158203
local_in_edges_tensor generation:  0.0010385513305664062
mini_batch_src_global generation:  0.0011899471282958984
r_  generation:  0.010805845260620117
local_output_nid generation:  0.001989603042602539
local_in_edges_tensor generation:  0.0010614395141601562
mini_batch_src_global generation:  0.0011858940124511719
r_  generation:  0.01016092300415039
local_output_nid generation:  0.0019621849060058594
local_in_edges_tensor generation:  0.0010213851928710938
mini_batch_src_global generation:  0.0011601448059082031
r_  generation:  0.010504722595214844
local_output_nid generation:  0.001947641372680664
local_in_edges_tensor generation:  0.0010383129119873047
mini_batch_src_global generation:  0.0011742115020751953
r_  generation:  0.010748624801635742
----------------------check_connections_block total spend ----------------------------- 0.5909366607666016
generate_one_block  0.025521516799926758
generate_one_block  0.022126197814941406
generate_one_block  0.019093036651611328
generate_one_block  0.018655061721801758
generate_one_block  0.01880955696105957
generate_one_block  0.019598722457885742
generate_one_block  0.018620014190673828
generate_one_block  0.01840996742248535
generate_one_block  0.01901841163635254
generate_one_block  0.019147872924804688
generate_one_block  0.018337488174438477
generate_one_block  0.018341064453125
generate_one_block  0.019191741943359375
generate_one_block  0.01920032501220703
generate_one_block  0.01863694190979004
generate_one_block  0.018687725067138672
generate_one_block  0.018721580505371094
generate_one_block  0.01905035972595215
generate_one_block  0.018313884735107422
generate_one_block  0.01833200454711914
generate_one_block  0.01892995834350586
generate_one_block  0.01887345314025879
generate_one_block  0.01834702491760254
generate_one_block  0.018405675888061523
generate_one_block  0.018533945083618164
generate_one_block  0.01799321174621582
generate_one_block  0.01862168312072754
generate_one_block  0.018530607223510742
generate_one_block  0.019146203994750977
generate_one_block  0.018201589584350586
generate_one_block  0.018869876861572266
generate_one_block  0.01901984214782715
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03811335563659668
gen group dst list time:  0.02263927459716797
time for parepare:  0.020056724548339844
local_output_nid generation:  0.006654262542724609
local_in_edges_tensor generation:  0.01802229881286621
mini_batch_src_global generation:  0.016613245010375977
r_  generation:  0.1641862392425537
local_output_nid generation:  0.01144552230834961
local_in_edges_tensor generation:  0.012948751449584961
mini_batch_src_global generation:  0.020886898040771484
r_  generation:  0.1907331943511963
local_output_nid generation:  0.013640403747558594
local_in_edges_tensor generation:  0.04394793510437012
mini_batch_src_global generation:  0.022637605667114258
r_  generation:  0.16962075233459473
local_output_nid generation:  0.010833263397216797
local_in_edges_tensor generation:  0.008862972259521484
mini_batch_src_global generation:  0.020178794860839844
r_  generation:  0.17721819877624512
local_output_nid generation:  0.011039018630981445
local_in_edges_tensor generation:  0.017853260040283203
mini_batch_src_global generation:  0.025789976119995117
r_  generation:  0.18437671661376953
local_output_nid generation:  0.011656045913696289
local_in_edges_tensor generation:  0.013015270233154297
mini_batch_src_global generation:  0.02255702018737793
r_  generation:  0.18694448471069336
local_output_nid generation:  0.013058662414550781
local_in_edges_tensor generation:  0.009157657623291016
mini_batch_src_global generation:  0.02197098731994629
r_  generation:  0.17988228797912598
local_output_nid generation:  0.01076197624206543
local_in_edges_tensor generation:  0.00950002670288086
mini_batch_src_global generation:  0.021565914154052734
r_  generation:  0.1760706901550293
local_output_nid generation:  0.011017084121704102
local_in_edges_tensor generation:  0.010002374649047852
mini_batch_src_global generation:  0.043243408203125
r_  generation:  0.18594050407409668
local_output_nid generation:  0.012696266174316406
local_in_edges_tensor generation:  0.009508848190307617
mini_batch_src_global generation:  0.022658586502075195
r_  generation:  0.18157386779785156
local_output_nid generation:  0.0113067626953125
local_in_edges_tensor generation:  0.009005546569824219
mini_batch_src_global generation:  0.022167444229125977
r_  generation:  0.1774299144744873
local_output_nid generation:  0.01137542724609375
local_in_edges_tensor generation:  0.008754968643188477
mini_batch_src_global generation:  0.021764755249023438
r_  generation:  0.1751575469970703
local_output_nid generation:  0.011942863464355469
local_in_edges_tensor generation:  0.009695768356323242
mini_batch_src_global generation:  0.02409648895263672
r_  generation:  0.1862339973449707
local_output_nid generation:  0.01198434829711914
local_in_edges_tensor generation:  0.009555339813232422
mini_batch_src_global generation:  0.023639440536499023
r_  generation:  0.18686771392822266
local_output_nid generation:  0.01163172721862793
local_in_edges_tensor generation:  0.008886337280273438
mini_batch_src_global generation:  0.022952556610107422
r_  generation:  0.1816418170928955
local_output_nid generation:  0.011879920959472656
local_in_edges_tensor generation:  0.009988069534301758
mini_batch_src_global generation:  0.023067712783813477
r_  generation:  0.1842949390411377
local_output_nid generation:  0.01182246208190918
local_in_edges_tensor generation:  0.009930610656738281
mini_batch_src_global generation:  0.022563457489013672
r_  generation:  0.17835760116577148
local_output_nid generation:  0.01208043098449707
local_in_edges_tensor generation:  0.009093284606933594
mini_batch_src_global generation:  0.023122549057006836
r_  generation:  0.18412399291992188
local_output_nid generation:  0.011759757995605469
local_in_edges_tensor generation:  0.009117841720581055
mini_batch_src_global generation:  0.02197742462158203
r_  generation:  0.17576003074645996
local_output_nid generation:  0.011573553085327148
local_in_edges_tensor generation:  0.008851766586303711
mini_batch_src_global generation:  0.022065401077270508
r_  generation:  0.1774458885192871
local_output_nid generation:  0.011931180953979492
local_in_edges_tensor generation:  0.009450197219848633
mini_batch_src_global generation:  0.025917768478393555
r_  generation:  0.1861426830291748
local_output_nid generation:  0.011844873428344727
local_in_edges_tensor generation:  0.010872840881347656
mini_batch_src_global generation:  0.024318933486938477
r_  generation:  0.18738269805908203
local_output_nid generation:  0.011829614639282227
local_in_edges_tensor generation:  0.008908748626708984
mini_batch_src_global generation:  0.02284717559814453
r_  generation:  0.1815192699432373
local_output_nid generation:  0.011775493621826172
local_in_edges_tensor generation:  0.008834123611450195
mini_batch_src_global generation:  0.0229647159576416
r_  generation:  0.18454813957214355
local_output_nid generation:  0.011871814727783203
local_in_edges_tensor generation:  0.010249614715576172
mini_batch_src_global generation:  0.02245187759399414
r_  generation:  0.18207192420959473
local_output_nid generation:  0.011466741561889648
local_in_edges_tensor generation:  0.008967161178588867
mini_batch_src_global generation:  0.0234067440032959
r_  generation:  0.1758732795715332
local_output_nid generation:  0.011966943740844727
local_in_edges_tensor generation:  0.008924245834350586
mini_batch_src_global generation:  0.023537874221801758
r_  generation:  0.18581461906433105
local_output_nid generation:  0.011683225631713867
local_in_edges_tensor generation:  0.009692907333374023
mini_batch_src_global generation:  0.023799419403076172
r_  generation:  0.18429064750671387
local_output_nid generation:  0.011558771133422852
local_in_edges_tensor generation:  0.009813547134399414
mini_batch_src_global generation:  0.02357792854309082
r_  generation:  0.19191908836364746
local_output_nid generation:  0.011126995086669922
local_in_edges_tensor generation:  0.008861780166625977
mini_batch_src_global generation:  0.024755001068115234
r_  generation:  0.18014192581176758
local_output_nid generation:  0.011420011520385742
local_in_edges_tensor generation:  0.008851289749145508
mini_batch_src_global generation:  0.023039817810058594
r_  generation:  0.18918299674987793
local_output_nid generation:  0.00939798355102539
local_in_edges_tensor generation:  0.010404825210571289
mini_batch_src_global generation:  0.023144245147705078
r_  generation:  0.18780112266540527
----------------------check_connections_block total spend ----------------------------- 8.609478235244751
generate_one_block  0.2749364376068115
generate_one_block  0.24402260780334473
generate_one_block  0.23647165298461914
generate_one_block  0.24116849899291992
generate_one_block  0.2723565101623535
generate_one_block  0.2600853443145752
generate_one_block  0.24698901176452637
generate_one_block  0.24170255661010742
generate_one_block  0.25335097312927246
generate_one_block  0.24886488914489746
generate_one_block  0.24118876457214355
generate_one_block  0.2374584674835205
generate_one_block  0.25289130210876465
generate_one_block  0.25882887840270996
generate_one_block  0.2515711784362793
generate_one_block  0.2511570453643799
generate_one_block  0.23921799659729004
generate_one_block  0.2463688850402832
generate_one_block  0.23637843132019043
generate_one_block  0.24468016624450684
generate_one_block  0.2520294189453125
generate_one_block  0.24808239936828613
generate_one_block  0.24150848388671875
generate_one_block  0.2479560375213623
generate_one_block  0.2470259666442871
generate_one_block  0.2373826503753662
generate_one_block  0.265514612197876
generate_one_block  0.2508547306060791
generate_one_block  0.26200342178344727
generate_one_block  0.23994088172912598
generate_one_block  0.2524735927581787
generate_one_block  0.2543644905090332
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03982114791870117
gen group dst list time:  0.11583781242370605
time for parepare:  0.0226287841796875
local_output_nid generation:  0.02684640884399414
local_in_edges_tensor generation:  0.06169533729553223
mini_batch_src_global generation:  0.04767107963562012
r_  generation:  0.4924309253692627
local_output_nid generation:  0.03212237358093262
local_in_edges_tensor generation:  0.03757810592651367
mini_batch_src_global generation:  0.05928325653076172
r_  generation:  0.48726987838745117
local_output_nid generation:  0.030429601669311523
local_in_edges_tensor generation:  0.03387308120727539
mini_batch_src_global generation:  0.056847333908081055
r_  generation:  0.4964945316314697
local_output_nid generation:  0.029590129852294922
local_in_edges_tensor generation:  0.03356790542602539
mini_batch_src_global generation:  0.06054091453552246
r_  generation:  0.48944544792175293
local_output_nid generation:  0.029383420944213867
local_in_edges_tensor generation:  0.03417181968688965
mini_batch_src_global generation:  0.05904078483581543
r_  generation:  0.5025522708892822
local_output_nid generation:  0.02954411506652832
local_in_edges_tensor generation:  0.03543591499328613
mini_batch_src_global generation:  0.05909419059753418
r_  generation:  0.4992351531982422
local_output_nid generation:  0.029667139053344727
local_in_edges_tensor generation:  0.03169584274291992
mini_batch_src_global generation:  0.0603787899017334
r_  generation:  0.5012221336364746
local_output_nid generation:  0.029668092727661133
local_in_edges_tensor generation:  0.031845808029174805
mini_batch_src_global generation:  0.058501243591308594
r_  generation:  0.4942631721496582
local_output_nid generation:  0.03101825714111328
local_in_edges_tensor generation:  0.03005814552307129
mini_batch_src_global generation:  0.05820345878601074
r_  generation:  0.5032224655151367
local_output_nid generation:  0.02953171730041504
local_in_edges_tensor generation:  0.031089067459106445
mini_batch_src_global generation:  0.06263899803161621
r_  generation:  0.5130579471588135
local_output_nid generation:  0.029485225677490234
local_in_edges_tensor generation:  0.029619455337524414
mini_batch_src_global generation:  0.05841493606567383
r_  generation:  0.5134074687957764
local_output_nid generation:  0.03136467933654785
local_in_edges_tensor generation:  0.029183149337768555
mini_batch_src_global generation:  0.05961918830871582
r_  generation:  0.49706149101257324
local_output_nid generation:  0.030609607696533203
local_in_edges_tensor generation:  0.03192329406738281
mini_batch_src_global generation:  0.06110358238220215
r_  generation:  0.5048155784606934
local_output_nid generation:  0.030702590942382812
local_in_edges_tensor generation:  0.03333473205566406
mini_batch_src_global generation:  0.05888938903808594
r_  generation:  0.4989192485809326
local_output_nid generation:  0.030271530151367188
local_in_edges_tensor generation:  0.029101133346557617
mini_batch_src_global generation:  0.05872631072998047
r_  generation:  0.5111854076385498
local_output_nid generation:  0.03052997589111328
local_in_edges_tensor generation:  0.03146076202392578
mini_batch_src_global generation:  0.06129932403564453
r_  generation:  0.5016176700592041
local_output_nid generation:  0.03041982650756836
local_in_edges_tensor generation:  0.030002832412719727
mini_batch_src_global generation:  0.05803632736206055
r_  generation:  0.5009269714355469
local_output_nid generation:  0.030544519424438477
local_in_edges_tensor generation:  0.03134655952453613
mini_batch_src_global generation:  0.06180238723754883
r_  generation:  0.4988851547241211
local_output_nid generation:  0.0304718017578125
local_in_edges_tensor generation:  0.032514333724975586
mini_batch_src_global generation:  0.05778980255126953
r_  generation:  0.4961433410644531
local_output_nid generation:  0.030307292938232422
local_in_edges_tensor generation:  0.030038118362426758
mini_batch_src_global generation:  0.059140920639038086
r_  generation:  0.4966862201690674
local_output_nid generation:  0.0304105281829834
local_in_edges_tensor generation:  0.031565189361572266
mini_batch_src_global generation:  0.058641672134399414
r_  generation:  0.5000929832458496
local_output_nid generation:  0.030739545822143555
local_in_edges_tensor generation:  0.03538227081298828
mini_batch_src_global generation:  0.07915282249450684
r_  generation:  0.49894213676452637
local_output_nid generation:  0.030513286590576172
local_in_edges_tensor generation:  0.031562089920043945
mini_batch_src_global generation:  0.062172889709472656
r_  generation:  0.5014877319335938
local_output_nid generation:  0.031242847442626953
local_in_edges_tensor generation:  0.02943873405456543
mini_batch_src_global generation:  0.061541080474853516
r_  generation:  0.5055432319641113
local_output_nid generation:  0.030560970306396484
local_in_edges_tensor generation:  0.037375450134277344
mini_batch_src_global generation:  0.05838727951049805
r_  generation:  0.5030286312103271
local_output_nid generation:  0.030315160751342773
local_in_edges_tensor generation:  0.03352713584899902
mini_batch_src_global generation:  0.06081128120422363
r_  generation:  0.49614882469177246
local_output_nid generation:  0.030567169189453125
local_in_edges_tensor generation:  0.033136844635009766
mini_batch_src_global generation:  0.05936121940612793
r_  generation:  0.5021181106567383
local_output_nid generation:  0.030472517013549805
local_in_edges_tensor generation:  0.030806303024291992
mini_batch_src_global generation:  0.06081128120422363
r_  generation:  0.5010986328125
local_output_nid generation:  0.031248807907104492
local_in_edges_tensor generation:  0.03365731239318848
mini_batch_src_global generation:  0.058634042739868164
r_  generation:  0.5017056465148926
local_output_nid generation:  0.03049015998840332
local_in_edges_tensor generation:  0.029137134552001953
mini_batch_src_global generation:  0.05921745300292969
r_  generation:  0.4977710247039795
local_output_nid generation:  0.03250408172607422
local_in_edges_tensor generation:  0.03002142906188965
mini_batch_src_global generation:  0.05919241905212402
r_  generation:  0.5052840709686279
local_output_nid generation:  0.03048539161682129
local_in_edges_tensor generation:  0.030649185180664062
mini_batch_src_global generation:  0.06152796745300293
r_  generation:  0.5085709095001221
----------------------check_connections_block total spend ----------------------------- 23.454362392425537
generate_one_block  0.6985650062561035
generate_one_block  0.6807136535644531
generate_one_block  0.6710331439971924
generate_one_block  0.6842117309570312
generate_one_block  0.7854559421539307
generate_one_block  0.6924159526824951
generate_one_block  0.6799004077911377
generate_one_block  0.678102970123291
generate_one_block  0.6744978427886963
generate_one_block  0.680264949798584
generate_one_block  0.6865825653076172
generate_one_block  0.670539379119873
generate_one_block  0.6816720962524414
generate_one_block  0.6839203834533691
generate_one_block  0.6786608695983887
generate_one_block  0.6948003768920898
generate_one_block  0.6766383647918701
generate_one_block  0.692638635635376
generate_one_block  0.6711859703063965
generate_one_block  0.6733388900756836
generate_one_block  0.6844096183776855
generate_one_block  0.6827216148376465
generate_one_block  0.6775739192962646
generate_one_block  0.6867780685424805
generate_one_block  0.688805103302002
generate_one_block  0.6799890995025635
generate_one_block  0.6911134719848633
generate_one_block  0.6938245296478271
generate_one_block  0.6862554550170898
generate_one_block  0.6760802268981934
generate_one_block  0.687673807144165
generate_one_block  0.6834688186645508
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.2362060546875 GB
    Memory Allocated: 0.13089847564697266  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

connection checking time:  32.06384062767029
block generation total time  29.932659149169922
average batch blocks generation time:  0.9353955984115601
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2362060546875 GB
    Memory Allocated: 0.10990667343139648  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2362060546875 GB
    Memory Allocated: 20.916436195373535  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2362060546875 GB
    Memory Allocated: 0.10901498794555664  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2362060546875 GB
    Memory Allocated: 20.645222663879395  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2362060546875 GB
    Memory Allocated: 0.10956764221191406  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2362060546875 GB
    Memory Allocated: 20.28127908706665  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2362060546875 GB
    Memory Allocated: 0.10886764526367188  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2362060546875 GB
    Memory Allocated: 20.66935682296753  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2362060546875 GB
    Memory Allocated: 0.10979557037353516  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2362060546875 GB
    Memory Allocated: 20.688336849212646  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2362060546875 GB
    Memory Allocated: 0.10944890975952148  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2362060546875 GB
    Memory Allocated: 21.19777822494507  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5584716796875 GB
    Memory Allocated: 0.10980701446533203  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9041748046875 GB
    Memory Allocated: 20.71036195755005  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9061279296875 GB
    Memory Allocated: 0.1088571548461914  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9061279296875 GB
    Memory Allocated: 20.45366096496582  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9061279296875 GB
    Memory Allocated: 0.10999774932861328  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9412841796875 GB
    Memory Allocated: 21.068467140197754  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9432373046875 GB
    Memory Allocated: 0.10925960540771484  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9432373046875 GB
    Memory Allocated: 20.870963096618652  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9432373046875 GB
    Memory Allocated: 0.1097421646118164  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9959716796875 GB
    Memory Allocated: 20.582321166992188  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9979248046875 GB
    Memory Allocated: 0.10884571075439453  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9979248046875 GB
    Memory Allocated: 20.35889959335327  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9979248046875 GB
    Memory Allocated: 0.10998725891113281  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9979248046875 GB
    Memory Allocated: 21.076277256011963  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9979248046875 GB
    Memory Allocated: 0.10952949523925781  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9979248046875 GB
    Memory Allocated: 21.19748830795288  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9979248046875 GB
    Memory Allocated: 0.10988998413085938  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9979248046875 GB
    Memory Allocated: 20.89295196533203  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9979248046875 GB
    Memory Allocated: 0.10945940017700195  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9979248046875 GB
    Memory Allocated: 20.959347248077393  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9979248046875 GB
    Memory Allocated: 0.10974311828613281  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9979248046875 GB
    Memory Allocated: 20.620123863220215  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9979248046875 GB
    Memory Allocated: 0.10950994491577148  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9979248046875 GB
    Memory Allocated: 20.94297742843628  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9979248046875 GB
    Memory Allocated: 0.10961723327636719  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9979248046875 GB
    Memory Allocated: 20.38844633102417  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9979248046875 GB
    Memory Allocated: 0.10901927947998047  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9979248046875 GB
    Memory Allocated: 20.551610469818115  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9979248046875 GB
    Memory Allocated: 0.1099405288696289  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9979248046875 GB
    Memory Allocated: 20.977251052856445  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9979248046875 GB
    Memory Allocated: 0.10937356948852539  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9979248046875 GB
    Memory Allocated: 20.92733860015869  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9979248046875 GB
    Memory Allocated: 0.10978412628173828  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9979248046875 GB
    Memory Allocated: 20.6552152633667  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9979248046875 GB
    Memory Allocated: 0.10896730422973633  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9979248046875 GB
    Memory Allocated: 20.81679105758667  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9979248046875 GB
    Memory Allocated: 0.10977458953857422  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9979248046875 GB
    Memory Allocated: 20.66529941558838  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9979248046875 GB
    Memory Allocated: 0.10893106460571289  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9979248046875 GB
    Memory Allocated: 20.423583507537842  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9979248046875 GB
    Memory Allocated: 0.10985374450683594  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9979248046875 GB
    Memory Allocated: 20.81389331817627  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9979248046875 GB
    Memory Allocated: 0.1094655990600586  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9979248046875 GB
    Memory Allocated: 20.78457498550415  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9979248046875 GB
    Memory Allocated: 0.11006641387939453  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9979248046875 GB
    Memory Allocated: 21.187591075897217  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9979248046875 GB
    Memory Allocated: 0.1092534065246582  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9979248046875 GB
    Memory Allocated: 20.579659461975098  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9979248046875 GB
    Memory Allocated: 0.10993099212646484  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 20.95319414138794  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0506591796875 GB
    Memory Allocated: 0.10942363739013672  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0506591796875 GB
    Memory Allocated: 20.85925579071045  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.027584485709667206 |0.025953121483325958 |0.6328438818454742 |9.51811671257019e-05 |1.2113072574138641 |0.004599809646606445 |
----------------------------------------------------------pseudo_mini_loss sum 3.4938652515411377
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  9159954
Number of first layer input nodes during this epoch:  4808334
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.0506591796875 GB
    Memory Allocated: 0.13177824020385742  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.028397083282470703
random selection method range initialization spend 0.0066089630126953125
time for parepare:  0.02349066734313965
local_output_nid generation:  0.001397848129272461
local_in_edges_tensor generation:  0.003917217254638672
mini_batch_src_global generation:  0.002415895462036133
r_  generation:  0.011427640914916992
local_output_nid generation:  0.0016984939575195312
local_in_edges_tensor generation:  0.0009961128234863281
mini_batch_src_global generation:  0.0017337799072265625
r_  generation:  0.010650396347045898
local_output_nid generation:  0.0016546249389648438
local_in_edges_tensor generation:  0.0009136199951171875
mini_batch_src_global generation:  0.0014157295227050781
r_  generation:  0.00986027717590332
local_output_nid generation:  0.0016028881072998047
local_in_edges_tensor generation:  0.0008955001831054688
mini_batch_src_global generation:  0.0012977123260498047
r_  generation:  0.010105609893798828
local_output_nid generation:  0.0015790462493896484
local_in_edges_tensor generation:  0.0008590221405029297
mini_batch_src_global generation:  0.0012691020965576172
r_  generation:  0.009836196899414062
local_output_nid generation:  0.0015935897827148438
local_in_edges_tensor generation:  0.0009083747863769531
mini_batch_src_global generation:  0.0012543201446533203
r_  generation:  0.010091781616210938
local_output_nid generation:  0.0015919208526611328
local_in_edges_tensor generation:  0.0008535385131835938
mini_batch_src_global generation:  0.0012423992156982422
r_  generation:  0.009856462478637695
local_output_nid generation:  0.0015964508056640625
local_in_edges_tensor generation:  0.0008642673492431641
mini_batch_src_global generation:  0.0012049674987792969
r_  generation:  0.010015726089477539
local_output_nid generation:  0.0016248226165771484
local_in_edges_tensor generation:  0.0008852481842041016
mini_batch_src_global generation:  0.0012433528900146484
r_  generation:  0.010201454162597656
local_output_nid generation:  0.0015950202941894531
local_in_edges_tensor generation:  0.0008490085601806641
mini_batch_src_global generation:  0.001203775405883789
r_  generation:  0.010293960571289062
local_output_nid generation:  0.0016009807586669922
local_in_edges_tensor generation:  0.0008571147918701172
mini_batch_src_global generation:  0.0011773109436035156
r_  generation:  0.009939908981323242
local_output_nid generation:  0.001605987548828125
local_in_edges_tensor generation:  0.0008704662322998047
mini_batch_src_global generation:  0.0012519359588623047
r_  generation:  0.010294675827026367
local_output_nid generation:  0.0015761852264404297
local_in_edges_tensor generation:  0.0008983612060546875
mini_batch_src_global generation:  0.0012431144714355469
r_  generation:  0.010622024536132812
local_output_nid generation:  0.0016188621520996094
local_in_edges_tensor generation:  0.0008723735809326172
mini_batch_src_global generation:  0.0011553764343261719
r_  generation:  0.009698152542114258
local_output_nid generation:  0.0015888214111328125
local_in_edges_tensor generation:  0.0008547306060791016
mini_batch_src_global generation:  0.0011894702911376953
r_  generation:  0.010430335998535156
local_output_nid generation:  0.0015761852264404297
local_in_edges_tensor generation:  0.0008766651153564453
mini_batch_src_global generation:  0.0012297630310058594
r_  generation:  0.010324239730834961
local_output_nid generation:  0.0016431808471679688
local_in_edges_tensor generation:  0.0008745193481445312
mini_batch_src_global generation:  0.0011818408966064453
r_  generation:  0.010039806365966797
local_output_nid generation:  0.0015823841094970703
local_in_edges_tensor generation:  0.0008826255798339844
mini_batch_src_global generation:  0.0011935234069824219
r_  generation:  0.00997614860534668
local_output_nid generation:  0.0015711784362792969
local_in_edges_tensor generation:  0.0008745193481445312
mini_batch_src_global generation:  0.0012047290802001953
r_  generation:  0.010146379470825195
local_output_nid generation:  0.0015726089477539062
local_in_edges_tensor generation:  0.0008761882781982422
mini_batch_src_global generation:  0.0011410713195800781
r_  generation:  0.00973057746887207
local_output_nid generation:  0.0015687942504882812
local_in_edges_tensor generation:  0.0008943080902099609
mini_batch_src_global generation:  0.0012118816375732422
r_  generation:  0.01058053970336914
local_output_nid generation:  0.0015788078308105469
local_in_edges_tensor generation:  0.0008616447448730469
mini_batch_src_global generation:  0.0012133121490478516
r_  generation:  0.010269880294799805
local_output_nid generation:  0.0016036033630371094
local_in_edges_tensor generation:  0.0008540153503417969
mini_batch_src_global generation:  0.0012867450714111328
r_  generation:  0.01035618782043457
local_output_nid generation:  0.001573324203491211
local_in_edges_tensor generation:  0.0008690357208251953
mini_batch_src_global generation:  0.0011684894561767578
r_  generation:  0.010027170181274414
local_output_nid generation:  0.0016028881072998047
local_in_edges_tensor generation:  0.0008833408355712891
mini_batch_src_global generation:  0.0012042522430419922
r_  generation:  0.010405778884887695
local_output_nid generation:  0.0015764236450195312
local_in_edges_tensor generation:  0.0008509159088134766
mini_batch_src_global generation:  0.0012481212615966797
r_  generation:  0.009970426559448242
local_output_nid generation:  0.0015752315521240234
local_in_edges_tensor generation:  0.0008625984191894531
mini_batch_src_global generation:  0.0011899471282958984
r_  generation:  0.010164976119995117
local_output_nid generation:  0.0016040802001953125
local_in_edges_tensor generation:  0.0008718967437744141
mini_batch_src_global generation:  0.001222848892211914
r_  generation:  0.010004997253417969
local_output_nid generation:  0.0016024112701416016
local_in_edges_tensor generation:  0.0008699893951416016
mini_batch_src_global generation:  0.0011789798736572266
r_  generation:  0.010123014450073242
local_output_nid generation:  0.0015418529510498047
local_in_edges_tensor generation:  0.0008537769317626953
mini_batch_src_global generation:  0.0012080669403076172
r_  generation:  0.009953737258911133
local_output_nid generation:  0.00157928466796875
local_in_edges_tensor generation:  0.0008752346038818359
mini_batch_src_global generation:  0.0011785030364990234
r_  generation:  0.010310888290405273
local_output_nid generation:  0.0015864372253417969
local_in_edges_tensor generation:  0.0008571147918701172
mini_batch_src_global generation:  0.001153707504272461
r_  generation:  0.01008915901184082
----------------------check_connections_block total spend ----------------------------- 0.5661509037017822
generate_one_block  0.024576663970947266
generate_one_block  0.021459579467773438
generate_one_block  0.019276142120361328
generate_one_block  0.018935441970825195
generate_one_block  0.018381834030151367
generate_one_block  0.018656492233276367
generate_one_block  0.018143415451049805
generate_one_block  0.01863241195678711
generate_one_block  0.018596172332763672
generate_one_block  0.01876997947692871
generate_one_block  0.017974376678466797
generate_one_block  0.018535375595092773
generate_one_block  0.019046545028686523
generate_one_block  0.01755976676940918
generate_one_block  0.0187070369720459
generate_one_block  0.018593311309814453
generate_one_block  0.018174409866333008
generate_one_block  0.01806926727294922
generate_one_block  0.018459081649780273
generate_one_block  0.01756882667541504
generate_one_block  0.018970251083374023
generate_one_block  0.018721580505371094
generate_one_block  0.018494606018066406
generate_one_block  0.018128156661987305
generate_one_block  0.018616437911987305
generate_one_block  0.01791071891784668
generate_one_block  0.01820230484008789
generate_one_block  0.018061161041259766
generate_one_block  0.018166303634643555
generate_one_block  0.017839431762695312
generate_one_block  0.01844310760498047
generate_one_block  0.017981290817260742
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04476284980773926
gen group dst list time:  0.02560114860534668
time for parepare:  0.021159648895263672
local_output_nid generation:  0.0062673091888427734
local_in_edges_tensor generation:  0.017539501190185547
mini_batch_src_global generation:  0.018559694290161133
r_  generation:  0.16168928146362305
local_output_nid generation:  0.009041070938110352
local_in_edges_tensor generation:  0.011591672897338867
mini_batch_src_global generation:  0.03347587585449219
r_  generation:  0.1738443374633789
local_output_nid generation:  0.01464700698852539
local_in_edges_tensor generation:  0.04281878471374512
mini_batch_src_global generation:  0.02161550521850586
r_  generation:  0.18833661079406738
local_output_nid generation:  0.015616655349731445
local_in_edges_tensor generation:  0.017121553421020508
mini_batch_src_global generation:  0.043413639068603516
r_  generation:  0.18864083290100098
local_output_nid generation:  0.013810157775878906
local_in_edges_tensor generation:  0.009309530258178711
mini_batch_src_global generation:  0.027607202529907227
r_  generation:  0.19363903999328613
local_output_nid generation:  0.011714458465576172
local_in_edges_tensor generation:  0.010091066360473633
mini_batch_src_global generation:  0.02499842643737793
r_  generation:  0.19248414039611816
local_output_nid generation:  0.009747505187988281
local_in_edges_tensor generation:  0.014585256576538086
mini_batch_src_global generation:  0.026072025299072266
r_  generation:  0.18900156021118164
local_output_nid generation:  0.009729862213134766
local_in_edges_tensor generation:  0.011336565017700195
mini_batch_src_global generation:  0.026482582092285156
r_  generation:  0.19042754173278809
local_output_nid generation:  0.010935544967651367
local_in_edges_tensor generation:  0.013445615768432617
mini_batch_src_global generation:  0.03674721717834473
r_  generation:  0.2284533977508545
local_output_nid generation:  0.02058577537536621
local_in_edges_tensor generation:  0.011815547943115234
mini_batch_src_global generation:  0.032433271408081055
r_  generation:  0.2105104923248291
local_output_nid generation:  0.012246847152709961
local_in_edges_tensor generation:  0.013251543045043945
mini_batch_src_global generation:  0.02914571762084961
r_  generation:  0.19754838943481445
local_output_nid generation:  0.011823415756225586
local_in_edges_tensor generation:  0.010158061981201172
mini_batch_src_global generation:  0.028588294982910156
r_  generation:  0.2057194709777832
local_output_nid generation:  0.013950586318969727
local_in_edges_tensor generation:  0.012067317962646484
mini_batch_src_global generation:  0.031090974807739258
r_  generation:  0.21023988723754883
local_output_nid generation:  0.011369466781616211
local_in_edges_tensor generation:  0.009388446807861328
mini_batch_src_global generation:  0.025847434997558594
r_  generation:  0.20086669921875
local_output_nid generation:  0.015713214874267578
local_in_edges_tensor generation:  0.013941764831542969
mini_batch_src_global generation:  0.023848772048950195
r_  generation:  0.19302654266357422
local_output_nid generation:  0.01748514175415039
local_in_edges_tensor generation:  0.01507878303527832
mini_batch_src_global generation:  0.030420780181884766
r_  generation:  0.20616793632507324
local_output_nid generation:  0.012682437896728516
local_in_edges_tensor generation:  0.01043391227722168
mini_batch_src_global generation:  0.02903270721435547
r_  generation:  0.20599865913391113
local_output_nid generation:  0.011993646621704102
local_in_edges_tensor generation:  0.009822368621826172
mini_batch_src_global generation:  0.02743840217590332
r_  generation:  0.19811296463012695
local_output_nid generation:  0.011945486068725586
local_in_edges_tensor generation:  0.011516571044921875
mini_batch_src_global generation:  0.026892900466918945
r_  generation:  0.2000279426574707
local_output_nid generation:  0.011481285095214844
local_in_edges_tensor generation:  0.009498834609985352
mini_batch_src_global generation:  0.026810646057128906
r_  generation:  0.19338345527648926
local_output_nid generation:  0.011910200119018555
local_in_edges_tensor generation:  0.010158061981201172
mini_batch_src_global generation:  0.027440786361694336
r_  generation:  0.20812535285949707
local_output_nid generation:  0.011630058288574219
local_in_edges_tensor generation:  0.01128840446472168
mini_batch_src_global generation:  0.02765035629272461
r_  generation:  0.20187973976135254
local_output_nid generation:  0.01153254508972168
local_in_edges_tensor generation:  0.010656356811523438
mini_batch_src_global generation:  0.035482168197631836
r_  generation:  0.2134263515472412
local_output_nid generation:  0.011904716491699219
local_in_edges_tensor generation:  0.010957002639770508
mini_batch_src_global generation:  0.027933835983276367
r_  generation:  0.19989871978759766
local_output_nid generation:  0.012984752655029297
local_in_edges_tensor generation:  0.012710094451904297
mini_batch_src_global generation:  0.027099132537841797
r_  generation:  0.20823121070861816
local_output_nid generation:  0.013357162475585938
local_in_edges_tensor generation:  0.011833667755126953
mini_batch_src_global generation:  0.02751326560974121
r_  generation:  0.20573782920837402
local_output_nid generation:  0.0118255615234375
local_in_edges_tensor generation:  0.010503768920898438
mini_batch_src_global generation:  0.028260231018066406
r_  generation:  0.20806193351745605
local_output_nid generation:  0.011650323867797852
local_in_edges_tensor generation:  0.01358795166015625
mini_batch_src_global generation:  0.02849602699279785
r_  generation:  0.202911376953125
local_output_nid generation:  0.011646032333374023
local_in_edges_tensor generation:  0.01080942153930664
mini_batch_src_global generation:  0.028165340423583984
r_  generation:  0.20641446113586426
local_output_nid generation:  0.011523008346557617
local_in_edges_tensor generation:  0.012484550476074219
mini_batch_src_global generation:  0.02685546875
r_  generation:  0.21153688430786133
local_output_nid generation:  0.014219284057617188
local_in_edges_tensor generation:  0.01093435287475586
mini_batch_src_global generation:  0.028119564056396484
r_  generation:  0.20248150825500488
local_output_nid generation:  0.01158905029296875
local_in_edges_tensor generation:  0.009546995162963867
mini_batch_src_global generation:  0.035774946212768555
r_  generation:  0.20677590370178223
----------------------check_connections_block total spend ----------------------------- 9.627724170684814
generate_one_block  0.26107192039489746
generate_one_block  0.23741841316223145
generate_one_block  0.24945664405822754
generate_one_block  0.24619293212890625
generate_one_block  0.3004951477050781
generate_one_block  0.26029324531555176
generate_one_block  0.24840521812438965
generate_one_block  0.2507810592651367
generate_one_block  0.24529433250427246
generate_one_block  0.25109362602233887
generate_one_block  0.23853158950805664
generate_one_block  0.2467820644378662
generate_one_block  0.2597174644470215
generate_one_block  0.24155688285827637
generate_one_block  0.2551712989807129
generate_one_block  0.2583622932434082
generate_one_block  0.2569906711578369
generate_one_block  0.2532532215118408
generate_one_block  0.25216126441955566
generate_one_block  0.2478785514831543
generate_one_block  0.2605171203613281
generate_one_block  0.2524111270904541
generate_one_block  0.2459256649017334
generate_one_block  0.2422962188720703
generate_one_block  0.25374794006347656
generate_one_block  0.24172592163085938
generate_one_block  0.26842522621154785
generate_one_block  0.24851107597351074
generate_one_block  0.266981840133667
generate_one_block  0.2510244846343994
generate_one_block  0.252286434173584
generate_one_block  0.2424604892730713
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.044870615005493164
gen group dst list time:  0.11874723434448242
time for parepare:  0.019298791885375977
local_output_nid generation:  0.02649521827697754
local_in_edges_tensor generation:  0.05276632308959961
mini_batch_src_global generation:  0.047097206115722656
r_  generation:  0.5025818347930908
local_output_nid generation:  0.03295540809631348
local_in_edges_tensor generation:  0.04489493370056152
mini_batch_src_global generation:  0.059909820556640625
r_  generation:  0.48610830307006836
local_output_nid generation:  0.03196096420288086
local_in_edges_tensor generation:  0.036386966705322266
mini_batch_src_global generation:  0.05712580680847168
r_  generation:  0.49849438667297363
local_output_nid generation:  0.03266119956970215
local_in_edges_tensor generation:  0.03132176399230957
mini_batch_src_global generation:  0.07243895530700684
r_  generation:  0.49413299560546875
local_output_nid generation:  0.03149819374084473
local_in_edges_tensor generation:  0.03193235397338867
mini_batch_src_global generation:  0.058650970458984375
r_  generation:  0.4992251396179199
local_output_nid generation:  0.03094172477722168
local_in_edges_tensor generation:  0.028759241104125977
mini_batch_src_global generation:  0.07365894317626953
r_  generation:  0.503387451171875
local_output_nid generation:  0.0306398868560791
local_in_edges_tensor generation:  0.04460859298706055
mini_batch_src_global generation:  0.05895352363586426
r_  generation:  0.5087697505950928
local_output_nid generation:  0.03080129623413086
local_in_edges_tensor generation:  0.03106856346130371
mini_batch_src_global generation:  0.06426835060119629
r_  generation:  0.5014631748199463
local_output_nid generation:  0.03284788131713867
local_in_edges_tensor generation:  0.036054372787475586
mini_batch_src_global generation:  0.0615389347076416
r_  generation:  0.513237476348877
local_output_nid generation:  0.030956745147705078
local_in_edges_tensor generation:  0.03112196922302246
mini_batch_src_global generation:  0.06194472312927246
r_  generation:  0.5041110515594482
local_output_nid generation:  0.0307009220123291
local_in_edges_tensor generation:  0.03314065933227539
mini_batch_src_global generation:  0.058643341064453125
r_  generation:  0.5050101280212402
local_output_nid generation:  0.03152799606323242
local_in_edges_tensor generation:  0.033858299255371094
mini_batch_src_global generation:  0.061579227447509766
r_  generation:  0.5001411437988281
local_output_nid generation:  0.030716896057128906
local_in_edges_tensor generation:  0.03548932075500488
mini_batch_src_global generation:  0.060717105865478516
r_  generation:  0.5184919834136963
local_output_nid generation:  0.03279232978820801
local_in_edges_tensor generation:  0.03332710266113281
mini_batch_src_global generation:  0.06280398368835449
r_  generation:  0.48929715156555176
local_output_nid generation:  0.031000375747680664
local_in_edges_tensor generation:  0.02813100814819336
mini_batch_src_global generation:  0.058928489685058594
r_  generation:  0.5034196376800537
local_output_nid generation:  0.030470848083496094
local_in_edges_tensor generation:  0.03288841247558594
mini_batch_src_global generation:  0.059920310974121094
r_  generation:  0.497467041015625
local_output_nid generation:  0.03079509735107422
local_in_edges_tensor generation:  0.03179121017456055
mini_batch_src_global generation:  0.0588991641998291
r_  generation:  0.5158593654632568
local_output_nid generation:  0.03055262565612793
local_in_edges_tensor generation:  0.030399084091186523
mini_batch_src_global generation:  0.059259653091430664
r_  generation:  0.49626779556274414
local_output_nid generation:  0.032575368881225586
local_in_edges_tensor generation:  0.02854609489440918
mini_batch_src_global generation:  0.06055450439453125
r_  generation:  0.50323486328125
local_output_nid generation:  0.03042125701904297
local_in_edges_tensor generation:  0.030808687210083008
mini_batch_src_global generation:  0.06108236312866211
r_  generation:  0.4943258762359619
local_output_nid generation:  0.030855417251586914
local_in_edges_tensor generation:  0.03654837608337402
mini_batch_src_global generation:  0.058602333068847656
r_  generation:  0.5012078285217285
local_output_nid generation:  0.031167030334472656
local_in_edges_tensor generation:  0.030284881591796875
mini_batch_src_global generation:  0.06215167045593262
r_  generation:  0.5002119541168213
local_output_nid generation:  0.030772924423217773
local_in_edges_tensor generation:  0.03073716163635254
mini_batch_src_global generation:  0.05829024314880371
r_  generation:  0.503211498260498
local_output_nid generation:  0.03228259086608887
local_in_edges_tensor generation:  0.031017303466796875
mini_batch_src_global generation:  0.05961942672729492
r_  generation:  0.49657154083251953
local_output_nid generation:  0.03095102310180664
local_in_edges_tensor generation:  0.027963638305664062
mini_batch_src_global generation:  0.06040453910827637
r_  generation:  0.5008835792541504
local_output_nid generation:  0.03156328201293945
local_in_edges_tensor generation:  0.028600454330444336
mini_batch_src_global generation:  0.059775590896606445
r_  generation:  0.49807214736938477
local_output_nid generation:  0.030670881271362305
local_in_edges_tensor generation:  0.03844809532165527
mini_batch_src_global generation:  0.0616917610168457
r_  generation:  0.5011131763458252
local_output_nid generation:  0.030444622039794922
local_in_edges_tensor generation:  0.03542780876159668
mini_batch_src_global generation:  0.06035208702087402
r_  generation:  0.4947514533996582
local_output_nid generation:  0.03061532974243164
local_in_edges_tensor generation:  0.03234744071960449
mini_batch_src_global generation:  0.05835843086242676
r_  generation:  0.5147361755371094
local_output_nid generation:  0.030492067337036133
local_in_edges_tensor generation:  0.033377885818481445
mini_batch_src_global generation:  0.06339812278747559
r_  generation:  0.5051968097686768
local_output_nid generation:  0.03252911567687988
local_in_edges_tensor generation:  0.03264141082763672
mini_batch_src_global generation:  0.0594635009765625
r_  generation:  0.5051915645599365
local_output_nid generation:  0.030542850494384766
local_in_edges_tensor generation:  0.03291940689086914
mini_batch_src_global generation:  0.05999183654785156
r_  generation:  0.5027518272399902
----------------------check_connections_block total spend ----------------------------- 23.59022808074951
generate_one_block  0.6964788436889648
generate_one_block  0.6766397953033447
generate_one_block  0.6778953075408936
generate_one_block  0.693281888961792
generate_one_block  0.7916226387023926
generate_one_block  0.6968657970428467
generate_one_block  0.6872866153717041
generate_one_block  0.6853501796722412
generate_one_block  0.6778881549835205
generate_one_block  0.6786229610443115
generate_one_block  0.6736545562744141
generate_one_block  0.6825182437896729
generate_one_block  0.6892721652984619
generate_one_block  0.6717898845672607
generate_one_block  0.6817967891693115
generate_one_block  0.6906287670135498
generate_one_block  0.6852011680603027
generate_one_block  0.680875301361084
generate_one_block  0.6848857402801514
generate_one_block  0.6701898574829102
generate_one_block  0.6878650188446045
generate_one_block  0.6867263317108154
generate_one_block  0.678530216217041
generate_one_block  0.6788253784179688
generate_one_block  0.7069799900054932
generate_one_block  0.6802291870117188
generate_one_block  0.6801962852478027
generate_one_block  0.690500020980835
generate_one_block  0.6768462657928467
generate_one_block  0.6893432140350342
generate_one_block  0.7054874897003174
generate_one_block  0.6801307201385498
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.0506591796875 GB
    Memory Allocated: 0.13177824020385742  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

connection checking time:  33.217952251434326
block generation total time  30.10162615776062
average batch blocks generation time:  0.9406758174300194
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0506591796875 GB
    Memory Allocated: 0.10979604721069336  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0506591796875 GB
    Memory Allocated: 20.701722621917725  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0506591796875 GB
    Memory Allocated: 0.10911178588867188  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0506591796875 GB
    Memory Allocated: 20.453320503234863  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0506591796875 GB
    Memory Allocated: 0.10984325408935547  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0506591796875 GB
    Memory Allocated: 20.779051780700684  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0506591796875 GB
    Memory Allocated: 0.10935640335083008  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0506591796875 GB
    Memory Allocated: 20.90180778503418  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0506591796875 GB
    Memory Allocated: 0.10986709594726562  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0799560546875 GB
    Memory Allocated: 20.851890563964844  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0819091796875 GB
    Memory Allocated: 0.10974550247192383  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0819091796875 GB
    Memory Allocated: 20.90604877471924  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0819091796875 GB
    Memory Allocated: 0.10987186431884766  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0819091796875 GB
    Memory Allocated: 20.809868335723877  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0819091796875 GB
    Memory Allocated: 0.10948753356933594  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0819091796875 GB
    Memory Allocated: 21.068391799926758  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0819091796875 GB
    Memory Allocated: 0.1098642349243164  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0819091796875 GB
    Memory Allocated: 20.829806804656982  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0819091796875 GB
    Memory Allocated: 0.10934162139892578  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0819091796875 GB
    Memory Allocated: 21.0329647064209  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0819091796875 GB
    Memory Allocated: 0.10963153839111328  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0819091796875 GB
    Memory Allocated: 20.402796268463135  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0819091796875 GB
    Memory Allocated: 0.10911321640014648  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0819091796875 GB
    Memory Allocated: 20.874982833862305  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0819091796875 GB
    Memory Allocated: 0.11013603210449219  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2576904296875 GB
    Memory Allocated: 21.28631830215454  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2576904296875 GB
    Memory Allocated: 0.10884952545166016  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2576904296875 GB
    Memory Allocated: 20.21818971633911  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2576904296875 GB
    Memory Allocated: 0.1099538803100586  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2576904296875 GB
    Memory Allocated: 20.981738567352295  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2576904296875 GB
    Memory Allocated: 0.10932064056396484  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2576904296875 GB
    Memory Allocated: 20.92784547805786  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2576904296875 GB
    Memory Allocated: 0.1098928451538086  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2576904296875 GB
    Memory Allocated: 20.84473943710327  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2576904296875 GB
    Memory Allocated: 0.1089773178100586  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2576904296875 GB
    Memory Allocated: 20.824941158294678  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2576904296875 GB
    Memory Allocated: 0.10992622375488281  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2576904296875 GB
    Memory Allocated: 20.90827465057373  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2576904296875 GB
    Memory Allocated: 0.10872411727905273  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2576904296875 GB
    Memory Allocated: 20.344228744506836  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2576904296875 GB
    Memory Allocated: 0.11009693145751953  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2576904296875 GB
    Memory Allocated: 21.25617742538452  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2576904296875 GB
    Memory Allocated: 0.10955429077148438  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2576904296875 GB
    Memory Allocated: 20.932735919952393  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2576904296875 GB
    Memory Allocated: 0.10982036590576172  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2576904296875 GB
    Memory Allocated: 20.7547025680542  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2576904296875 GB
    Memory Allocated: 0.10919189453125  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2576904296875 GB
    Memory Allocated: 20.47482919692993  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2576904296875 GB
    Memory Allocated: 0.10995769500732422  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2576904296875 GB
    Memory Allocated: 20.973103046417236  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2576904296875 GB
    Memory Allocated: 0.10920286178588867  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2576904296875 GB
    Memory Allocated: 20.566842079162598  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2576904296875 GB
    Memory Allocated: 0.1098480224609375  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2576904296875 GB
    Memory Allocated: 20.77256679534912  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2576904296875 GB
    Memory Allocated: 0.10919618606567383  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2576904296875 GB
    Memory Allocated: 20.688470363616943  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2576904296875 GB
    Memory Allocated: 0.10979366302490234  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2576904296875 GB
    Memory Allocated: 20.705056190490723  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2576904296875 GB
    Memory Allocated: 0.10930681228637695  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2576904296875 GB
    Memory Allocated: 20.676476001739502  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2576904296875 GB
    Memory Allocated: 0.10986995697021484  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2576904296875 GB
    Memory Allocated: 20.828903198242188  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2576904296875 GB
    Memory Allocated: 0.10918760299682617  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2576904296875 GB
    Memory Allocated: 20.541175842285156  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0277596116065979 |0.022441968321800232 |0.6309890076518059 |9.738653898239136e-05 |1.2050028145313263 |0.005290031433105469 |
----------------------------------------------------------pseudo_mini_loss sum 2.784665822982788
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  9167867
Number of first layer input nodes during this epoch:  4810978
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.2576904296875 GB
    Memory Allocated: 0.13135528564453125  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02560901641845703
random selection method range initialization spend 0.0055999755859375
time for parepare:  0.020616769790649414
local_output_nid generation:  0.0014095306396484375
local_in_edges_tensor generation:  0.006935596466064453
mini_batch_src_global generation:  0.0016129016876220703
r_  generation:  0.010741949081420898
local_output_nid generation:  0.001617431640625
local_in_edges_tensor generation:  0.001028299331665039
mini_batch_src_global generation:  0.0011479854583740234
r_  generation:  0.012737035751342773
local_output_nid generation:  0.00168609619140625
local_in_edges_tensor generation:  0.0010151863098144531
mini_batch_src_global generation:  0.0012826919555664062
r_  generation:  0.01000070571899414
local_output_nid generation:  0.0016338825225830078
local_in_edges_tensor generation:  0.0009415149688720703
mini_batch_src_global generation:  0.0011713504791259766
r_  generation:  0.010070085525512695
local_output_nid generation:  0.0015778541564941406
local_in_edges_tensor generation:  0.0009267330169677734
mini_batch_src_global generation:  0.0011363029479980469
r_  generation:  0.009880781173706055
local_output_nid generation:  0.0015757083892822266
local_in_edges_tensor generation:  0.0009152889251708984
mini_batch_src_global generation:  0.0012063980102539062
r_  generation:  0.010259389877319336
local_output_nid generation:  0.0015747547149658203
local_in_edges_tensor generation:  0.0009293556213378906
mini_batch_src_global generation:  0.0012273788452148438
r_  generation:  0.010473966598510742
local_output_nid generation:  0.0015730857849121094
local_in_edges_tensor generation:  0.0008990764617919922
mini_batch_src_global generation:  0.001125335693359375
r_  generation:  0.01027059555053711
local_output_nid generation:  0.0015664100646972656
local_in_edges_tensor generation:  0.0009002685546875
mini_batch_src_global generation:  0.0011129379272460938
r_  generation:  0.010413169860839844
local_output_nid generation:  0.0015628337860107422
local_in_edges_tensor generation:  0.0008833408355712891
mini_batch_src_global generation:  0.00115203857421875
r_  generation:  0.010431289672851562
local_output_nid generation:  0.0015532970428466797
local_in_edges_tensor generation:  0.0009326934814453125
mini_batch_src_global generation:  0.0012085437774658203
r_  generation:  0.010712385177612305
local_output_nid generation:  0.00157928466796875
local_in_edges_tensor generation:  0.0008945465087890625
mini_batch_src_global generation:  0.0011451244354248047
r_  generation:  0.010510683059692383
local_output_nid generation:  0.0015773773193359375
local_in_edges_tensor generation:  0.0009629726409912109
mini_batch_src_global generation:  0.0011458396911621094
r_  generation:  0.010170459747314453
local_output_nid generation:  0.0015826225280761719
local_in_edges_tensor generation:  0.0008823871612548828
mini_batch_src_global generation:  0.0011813640594482422
r_  generation:  0.010461091995239258
local_output_nid generation:  0.0015597343444824219
local_in_edges_tensor generation:  0.0009250640869140625
mini_batch_src_global generation:  0.0012204647064208984
r_  generation:  0.010549783706665039
local_output_nid generation:  0.0015628337860107422
local_in_edges_tensor generation:  0.0008823871612548828
mini_batch_src_global generation:  0.001127004623413086
r_  generation:  0.01041865348815918
local_output_nid generation:  0.0015714168548583984
local_in_edges_tensor generation:  0.0009129047393798828
mini_batch_src_global generation:  0.0011315345764160156
r_  generation:  0.01027679443359375
local_output_nid generation:  0.001581430435180664
local_in_edges_tensor generation:  0.0009024143218994141
mini_batch_src_global generation:  0.0011720657348632812
r_  generation:  0.010809659957885742
local_output_nid generation:  0.0015766620635986328
local_in_edges_tensor generation:  0.0008943080902099609
mini_batch_src_global generation:  0.0011699199676513672
r_  generation:  0.01018667221069336
local_output_nid generation:  0.001577615737915039
local_in_edges_tensor generation:  0.0008924007415771484
mini_batch_src_global generation:  0.0011637210845947266
r_  generation:  0.010443687438964844
local_output_nid generation:  0.0015704631805419922
local_in_edges_tensor generation:  0.0008876323699951172
mini_batch_src_global generation:  0.0011162757873535156
r_  generation:  0.010204315185546875
local_output_nid generation:  0.0015747547149658203
local_in_edges_tensor generation:  0.0009148120880126953
mini_batch_src_global generation:  0.001161336898803711
r_  generation:  0.010350704193115234
local_output_nid generation:  0.001573324203491211
local_in_edges_tensor generation:  0.0008814334869384766
mini_batch_src_global generation:  0.0011174678802490234
r_  generation:  0.009934663772583008
local_output_nid generation:  0.001573801040649414
local_in_edges_tensor generation:  0.0008950233459472656
mini_batch_src_global generation:  0.001115560531616211
r_  generation:  0.010243892669677734
local_output_nid generation:  0.0015749931335449219
local_in_edges_tensor generation:  0.0008959770202636719
mini_batch_src_global generation:  0.001207590103149414
r_  generation:  0.01029658317565918
local_output_nid generation:  0.0015726089477539062
local_in_edges_tensor generation:  0.0008904933929443359
mini_batch_src_global generation:  0.0011734962463378906
r_  generation:  0.010215282440185547
local_output_nid generation:  0.0016179084777832031
local_in_edges_tensor generation:  0.0008611679077148438
mini_batch_src_global generation:  0.00119781494140625
r_  generation:  0.010372400283813477
local_output_nid generation:  0.001584768295288086
local_in_edges_tensor generation:  0.0009021759033203125
mini_batch_src_global generation:  0.001194000244140625
r_  generation:  0.010327339172363281
local_output_nid generation:  0.0015726089477539062
local_in_edges_tensor generation:  0.0008623600006103516
mini_batch_src_global generation:  0.0012044906616210938
r_  generation:  0.010402679443359375
local_output_nid generation:  0.001584768295288086
local_in_edges_tensor generation:  0.0009140968322753906
mini_batch_src_global generation:  0.001129150390625
r_  generation:  0.010164737701416016
local_output_nid generation:  0.0015652179718017578
local_in_edges_tensor generation:  0.0008919239044189453
mini_batch_src_global generation:  0.0011589527130126953
r_  generation:  0.010504484176635742
local_output_nid generation:  0.0015721321105957031
local_in_edges_tensor generation:  0.0008800029754638672
mini_batch_src_global generation:  0.00109100341796875
r_  generation:  0.010056257247924805
----------------------check_connections_block total spend ----------------------------- 0.5714266300201416
generate_one_block  0.025247812271118164
generate_one_block  0.023252010345458984
generate_one_block  0.021349191665649414
generate_one_block  0.01924872398376465
generate_one_block  0.01871347427368164
generate_one_block  0.018703460693359375
generate_one_block  0.019128799438476562
generate_one_block  0.01865220069885254
generate_one_block  0.01876521110534668
generate_one_block  0.018642425537109375
generate_one_block  0.019382953643798828
generate_one_block  0.01910710334777832
generate_one_block  0.018342971801757812
generate_one_block  0.018787860870361328
generate_one_block  0.01876091957092285
generate_one_block  0.018510103225708008
generate_one_block  0.018494367599487305
generate_one_block  0.01917886734008789
generate_one_block  0.01835346221923828
generate_one_block  0.01854419708251953
generate_one_block  0.01827263832092285
generate_one_block  0.01847672462463379
generate_one_block  0.017951011657714844
generate_one_block  0.0181581974029541
generate_one_block  0.01894092559814453
generate_one_block  0.02178025245666504
generate_one_block  0.018693208694458008
generate_one_block  0.018342018127441406
generate_one_block  0.01861286163330078
generate_one_block  0.017937183380126953
generate_one_block  0.01896214485168457
generate_one_block  0.01778268814086914
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03981518745422363
gen group dst list time:  0.020565032958984375
time for parepare:  0.02031230926513672
local_output_nid generation:  0.006544351577758789
local_in_edges_tensor generation:  0.020049333572387695
mini_batch_src_global generation:  0.01744675636291504
r_  generation:  0.16362643241882324
local_output_nid generation:  0.009499549865722656
local_in_edges_tensor generation:  0.012998342514038086
mini_batch_src_global generation:  0.023096561431884766
r_  generation:  0.1809859275817871
local_output_nid generation:  0.00949716567993164
local_in_edges_tensor generation:  0.033014774322509766
mini_batch_src_global generation:  0.020014286041259766
r_  generation:  0.17348504066467285
local_output_nid generation:  0.009537220001220703
local_in_edges_tensor generation:  0.01050877571105957
mini_batch_src_global generation:  0.020674467086791992
r_  generation:  0.17562365531921387
local_output_nid generation:  0.009531021118164062
local_in_edges_tensor generation:  0.010671615600585938
mini_batch_src_global generation:  0.02127981185913086
r_  generation:  0.17528414726257324
local_output_nid generation:  0.009438514709472656
local_in_edges_tensor generation:  0.008968830108642578
mini_batch_src_global generation:  0.02149653434753418
r_  generation:  0.17717623710632324
local_output_nid generation:  0.00916147232055664
local_in_edges_tensor generation:  0.012173652648925781
mini_batch_src_global generation:  0.022656679153442383
r_  generation:  0.1820683479309082
local_output_nid generation:  0.009096622467041016
local_in_edges_tensor generation:  0.009130239486694336
mini_batch_src_global generation:  0.022452116012573242
r_  generation:  0.1802959442138672
local_output_nid generation:  0.009099721908569336
local_in_edges_tensor generation:  0.00890493392944336
mini_batch_src_global generation:  0.022300004959106445
r_  generation:  0.17769956588745117
local_output_nid generation:  0.009287595748901367
local_in_edges_tensor generation:  0.009090662002563477
mini_batch_src_global generation:  0.02308940887451172
r_  generation:  0.17977237701416016
local_output_nid generation:  0.00974416732788086
local_in_edges_tensor generation:  0.009707212448120117
mini_batch_src_global generation:  0.02283167839050293
r_  generation:  0.1833181381225586
local_output_nid generation:  0.00957632064819336
local_in_edges_tensor generation:  0.009215593338012695
mini_batch_src_global generation:  0.02298426628112793
r_  generation:  0.18611931800842285
local_output_nid generation:  0.00958704948425293
local_in_edges_tensor generation:  0.01072549819946289
mini_batch_src_global generation:  0.02265143394470215
r_  generation:  0.17941784858703613
local_output_nid generation:  0.00955653190612793
local_in_edges_tensor generation:  0.009972572326660156
mini_batch_src_global generation:  0.022897005081176758
r_  generation:  0.1838855743408203
local_output_nid generation:  0.009722232818603516
local_in_edges_tensor generation:  0.009022712707519531
mini_batch_src_global generation:  0.02380824089050293
r_  generation:  0.18300890922546387
local_output_nid generation:  0.009592056274414062
local_in_edges_tensor generation:  0.009893178939819336
mini_batch_src_global generation:  0.02359628677368164
r_  generation:  0.18513822555541992
local_output_nid generation:  0.009627819061279297
local_in_edges_tensor generation:  0.010099411010742188
mini_batch_src_global generation:  0.022691011428833008
r_  generation:  0.1782691478729248
local_output_nid generation:  0.009687185287475586
local_in_edges_tensor generation:  0.009609460830688477
mini_batch_src_global generation:  0.023782014846801758
r_  generation:  0.1908423900604248
local_output_nid generation:  0.009419918060302734
local_in_edges_tensor generation:  0.009070873260498047
mini_batch_src_global generation:  0.022949695587158203
r_  generation:  0.1796891689300537
local_output_nid generation:  0.009515762329101562
local_in_edges_tensor generation:  0.008913278579711914
mini_batch_src_global generation:  0.022403955459594727
r_  generation:  0.18066072463989258
local_output_nid generation:  0.00935220718383789
local_in_edges_tensor generation:  0.009139537811279297
mini_batch_src_global generation:  0.02286529541015625
r_  generation:  0.17960357666015625
local_output_nid generation:  0.009632587432861328
local_in_edges_tensor generation:  0.008936882019042969
mini_batch_src_global generation:  0.022649526596069336
r_  generation:  0.18136048316955566
local_output_nid generation:  0.009186506271362305
local_in_edges_tensor generation:  0.011688709259033203
mini_batch_src_global generation:  0.022628307342529297
r_  generation:  0.173478364944458
local_output_nid generation:  0.009297847747802734
local_in_edges_tensor generation:  0.011754751205444336
mini_batch_src_global generation:  0.022687196731567383
r_  generation:  0.17737102508544922
local_output_nid generation:  0.009739160537719727
local_in_edges_tensor generation:  0.009380817413330078
mini_batch_src_global generation:  0.022757530212402344
r_  generation:  0.18585729598999023
local_output_nid generation:  0.009478569030761719
local_in_edges_tensor generation:  0.009175300598144531
mini_batch_src_global generation:  0.022844552993774414
r_  generation:  0.17714667320251465
local_output_nid generation:  0.009749412536621094
local_in_edges_tensor generation:  0.009048700332641602
mini_batch_src_global generation:  0.022871732711791992
r_  generation:  0.1811063289642334
local_output_nid generation:  0.009583711624145508
local_in_edges_tensor generation:  0.009683847427368164
mini_batch_src_global generation:  0.022200345993041992
r_  generation:  0.18563532829284668
local_output_nid generation:  0.009635686874389648
local_in_edges_tensor generation:  0.010036945343017578
mini_batch_src_global generation:  0.023974895477294922
r_  generation:  0.18515706062316895
local_output_nid generation:  0.009364128112792969
local_in_edges_tensor generation:  0.009480714797973633
mini_batch_src_global generation:  0.022317886352539062
r_  generation:  0.17726731300354004
local_output_nid generation:  0.009694576263427734
local_in_edges_tensor generation:  0.00920414924621582
mini_batch_src_global generation:  0.02282881736755371
r_  generation:  0.1834123134613037
local_output_nid generation:  0.009273529052734375
local_in_edges_tensor generation:  0.008738040924072266
mini_batch_src_global generation:  0.022377729415893555
r_  generation:  0.17853426933288574
----------------------check_connections_block total spend ----------------------------- 8.445162296295166
generate_one_block  0.24666595458984375
generate_one_block  0.2608480453491211
generate_one_block  0.24670624732971191
generate_one_block  0.24886465072631836
generate_one_block  0.2704451084136963
generate_one_block  0.24317026138305664
generate_one_block  0.25033068656921387
generate_one_block  0.24955511093139648
generate_one_block  0.242079496383667
generate_one_block  0.24613642692565918
generate_one_block  0.2530381679534912
generate_one_block  0.2524251937866211
generate_one_block  0.24032020568847656
generate_one_block  0.2452688217163086
generate_one_block  0.2472209930419922
generate_one_block  0.2502431869506836
generate_one_block  0.24062752723693848
generate_one_block  0.25728297233581543
generate_one_block  0.24065923690795898
generate_one_block  0.24626374244689941
generate_one_block  0.24129486083984375
generate_one_block  0.24312329292297363
generate_one_block  0.2365856170654297
generate_one_block  0.2408287525177002
generate_one_block  0.24939346313476562
generate_one_block  0.23764634132385254
generate_one_block  0.24520516395568848
generate_one_block  0.2450106143951416
generate_one_block  0.2513303756713867
generate_one_block  0.24166178703308105
generate_one_block  0.24781036376953125
generate_one_block  0.24010324478149414
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.042465925216674805
gen group dst list time:  0.1067357063293457
time for parepare:  0.018959760665893555
local_output_nid generation:  0.02527451515197754
local_in_edges_tensor generation:  0.05182313919067383
mini_batch_src_global generation:  0.0470273494720459
r_  generation:  0.4870338439941406
local_output_nid generation:  0.031652212142944336
local_in_edges_tensor generation:  0.038340091705322266
mini_batch_src_global generation:  0.05944371223449707
r_  generation:  0.4866347312927246
local_output_nid generation:  0.031711578369140625
local_in_edges_tensor generation:  0.03542208671569824
mini_batch_src_global generation:  0.05786561965942383
r_  generation:  0.49628162384033203
local_output_nid generation:  0.030945301055908203
local_in_edges_tensor generation:  0.02869248390197754
mini_batch_src_global generation:  0.05779695510864258
r_  generation:  0.49021077156066895
local_output_nid generation:  0.02959918975830078
local_in_edges_tensor generation:  0.029044151306152344
mini_batch_src_global generation:  0.05783247947692871
r_  generation:  0.4991176128387451
local_output_nid generation:  0.02960944175720215
local_in_edges_tensor generation:  0.030315160751342773
mini_batch_src_global generation:  0.05952715873718262
r_  generation:  0.49329495429992676
local_output_nid generation:  0.029593944549560547
local_in_edges_tensor generation:  0.03136444091796875
mini_batch_src_global generation:  0.05823707580566406
r_  generation:  0.5013673305511475
local_output_nid generation:  0.02950119972229004
local_in_edges_tensor generation:  0.031100988388061523
mini_batch_src_global generation:  0.059687137603759766
r_  generation:  0.4958834648132324
local_output_nid generation:  0.029409408569335938
local_in_edges_tensor generation:  0.03729081153869629
mini_batch_src_global generation:  0.060324907302856445
r_  generation:  0.49468517303466797
local_output_nid generation:  0.029451608657836914
local_in_edges_tensor generation:  0.032121896743774414
mini_batch_src_global generation:  0.059392690658569336
r_  generation:  0.4958782196044922
local_output_nid generation:  0.029642820358276367
local_in_edges_tensor generation:  0.02845168113708496
mini_batch_src_global generation:  0.06083416938781738
r_  generation:  0.49791407585144043
local_output_nid generation:  0.029596328735351562
local_in_edges_tensor generation:  0.030408143997192383
mini_batch_src_global generation:  0.05944013595581055
r_  generation:  0.496631383895874
local_output_nid generation:  0.02959132194519043
local_in_edges_tensor generation:  0.03148531913757324
mini_batch_src_global generation:  0.05814552307128906
r_  generation:  0.4984123706817627
local_output_nid generation:  0.0297393798828125
local_in_edges_tensor generation:  0.03109288215637207
mini_batch_src_global generation:  0.05941510200500488
r_  generation:  0.5009772777557373
local_output_nid generation:  0.02965998649597168
local_in_edges_tensor generation:  0.03078460693359375
mini_batch_src_global generation:  0.05817580223083496
r_  generation:  0.4995713233947754
local_output_nid generation:  0.029924392700195312
local_in_edges_tensor generation:  0.031340837478637695
mini_batch_src_global generation:  0.05936455726623535
r_  generation:  0.497112512588501
local_output_nid generation:  0.029670000076293945
local_in_edges_tensor generation:  0.030183792114257812
mini_batch_src_global generation:  0.05913186073303223
r_  generation:  0.4989933967590332
local_output_nid generation:  0.029672861099243164
local_in_edges_tensor generation:  0.03128504753112793
mini_batch_src_global generation:  0.05915331840515137
r_  generation:  0.4977710247039795
local_output_nid generation:  0.02973031997680664
local_in_edges_tensor generation:  0.031048059463500977
mini_batch_src_global generation:  0.05853104591369629
r_  generation:  0.49899911880493164
local_output_nid generation:  0.029564380645751953
local_in_edges_tensor generation:  0.030970096588134766
mini_batch_src_global generation:  0.05938982963562012
r_  generation:  0.495699405670166
local_output_nid generation:  0.029798269271850586
local_in_edges_tensor generation:  0.03121805191040039
mini_batch_src_global generation:  0.05834698677062988
r_  generation:  0.5013313293457031
local_output_nid generation:  0.0296018123626709
local_in_edges_tensor generation:  0.030822038650512695
mini_batch_src_global generation:  0.05945420265197754
r_  generation:  0.49716711044311523
local_output_nid generation:  0.029563188552856445
local_in_edges_tensor generation:  0.02964162826538086
mini_batch_src_global generation:  0.05805325508117676
r_  generation:  0.49776744842529297
local_output_nid generation:  0.02946925163269043
local_in_edges_tensor generation:  0.029070138931274414
mini_batch_src_global generation:  0.059650421142578125
r_  generation:  0.49455881118774414
local_output_nid generation:  0.029605388641357422
local_in_edges_tensor generation:  0.0283358097076416
mini_batch_src_global generation:  0.05802440643310547
r_  generation:  0.5046417713165283
local_output_nid generation:  0.029781103134155273
local_in_edges_tensor generation:  0.028950929641723633
mini_batch_src_global generation:  0.05941414833068848
r_  generation:  0.49790406227111816
local_output_nid generation:  0.029764413833618164
local_in_edges_tensor generation:  0.028573036193847656
mini_batch_src_global generation:  0.058620452880859375
r_  generation:  0.49872493743896484
local_output_nid generation:  0.02985978126525879
local_in_edges_tensor generation:  0.029886960983276367
mini_batch_src_global generation:  0.06163954734802246
r_  generation:  0.4978945255279541
local_output_nid generation:  0.029899120330810547
local_in_edges_tensor generation:  0.03381776809692383
mini_batch_src_global generation:  0.05883169174194336
r_  generation:  0.5019664764404297
local_output_nid generation:  0.0295257568359375
local_in_edges_tensor generation:  0.029731035232543945
mini_batch_src_global generation:  0.06032133102416992
r_  generation:  0.49782228469848633
local_output_nid generation:  0.02964305877685547
local_in_edges_tensor generation:  0.03336787223815918
mini_batch_src_global generation:  0.05852055549621582
r_  generation:  0.5023384094238281
local_output_nid generation:  0.02943873405456543
local_in_edges_tensor generation:  0.028856515884399414
mini_batch_src_global generation:  0.059721946716308594
r_  generation:  0.49838972091674805
----------------------check_connections_block total spend ----------------------------- 23.230464458465576
generate_one_block  0.6849050521850586
generate_one_block  0.6844329833984375
generate_one_block  0.6780810356140137
generate_one_block  0.6741082668304443
generate_one_block  0.7587661743164062
generate_one_block  0.674220085144043
generate_one_block  0.6769974231719971
generate_one_block  0.6830697059631348
generate_one_block  0.68247389793396
generate_one_block  0.6782636642456055
generate_one_block  0.6924910545349121
generate_one_block  0.6916816234588623
generate_one_block  0.6812469959259033
generate_one_block  0.6853673458099365
generate_one_block  0.6760804653167725
generate_one_block  0.682103157043457
generate_one_block  0.6854422092437744
generate_one_block  0.6810204982757568
generate_one_block  0.6807889938354492
generate_one_block  0.6754519939422607
generate_one_block  0.6779072284698486
generate_one_block  0.6817996501922607
generate_one_block  0.6730039119720459
generate_one_block  0.6680538654327393
generate_one_block  0.6983318328857422
generate_one_block  0.677642822265625
generate_one_block  0.6771032810211182
generate_one_block  0.6806628704071045
generate_one_block  0.6826956272125244
generate_one_block  0.6719076633453369
generate_one_block  0.677454948425293
generate_one_block  0.6705806255340576
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.2576904296875 GB
    Memory Allocated: 0.13135528564453125  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

connection checking time:  31.675626754760742
block generation total time  29.74228286743164
average batch blocks generation time:  0.9294463396072388
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2576904296875 GB
    Memory Allocated: 0.10997533798217773  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2576904296875 GB
    Memory Allocated: 21.011414051055908  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2576904296875 GB
    Memory Allocated: 0.10976362228393555  GigaBytes
Max Memory Allocated: 21.502837657928467  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3201904296875 GB
    Memory Allocated: 21.545359134674072  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9139404296875 GB
    Memory Allocated: 0.10993480682373047  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2440185546875 GB
    Memory Allocated: 20.935792922973633  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2459716796875 GB
    Memory Allocated: 0.10929679870605469  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2459716796875 GB
    Memory Allocated: 20.912179946899414  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2459716796875 GB
    Memory Allocated: 0.10980415344238281  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2459716796875 GB
    Memory Allocated: 20.71834373474121  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2459716796875 GB
    Memory Allocated: 0.10921812057495117  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2459716796875 GB
    Memory Allocated: 20.745577812194824  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2459716796875 GB
    Memory Allocated: 0.11001205444335938  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 21.053893089294434  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 0.10922956466674805  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 20.918429851531982  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 0.10976314544677734  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 20.691660404205322  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 0.10912370681762695  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 20.744605541229248  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 0.10998725891113281  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 21.064671516418457  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 0.10939264297485352  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 20.9986515045166  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 0.10978031158447266  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 20.670133590698242  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 0.10929679870605469  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 20.916139125823975  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 0.10990238189697266  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 20.876395225524902  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 0.109466552734375  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 20.956596851348877  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 0.10975265502929688  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 20.594215393066406  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 0.10948419570922852  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 21.267929553985596  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 0.10978317260742188  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 20.651559352874756  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 0.10930204391479492  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 20.672672748565674  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 0.1097869873046875  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 20.659676551818848  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 0.1092977523803711  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 20.688105583190918  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 0.10953521728515625  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 20.21880054473877  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 0.10890817642211914  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 20.369067668914795  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 0.1099081039428711  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 20.919574737548828  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 0.10904741287231445  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 20.412811756134033  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 0.1097879409790039  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 20.6837739944458  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 0.10927772521972656  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 20.675548553466797  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 0.1099252700805664  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 20.934241771697998  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 0.10893726348876953  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 20.42153787612915  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 0.10990238189697266  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 20.889442443847656  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 0.10875749588012695  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 20.422194480895996  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.027781367301940918 |0.02066381275653839 |0.6361905708909035 |9.670853614807129e-05 |1.2133033573627472 |0.005358219146728516 |
----------------------------------------------------------pseudo_mini_loss sum 2.4061644077301025
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  9163817
Number of first layer input nodes during this epoch:  4808209
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 0.13067054748535156  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026509761810302734
random selection method range initialization spend 0.005704641342163086
time for parepare:  0.021084308624267578
local_output_nid generation:  0.0013849735260009766
local_in_edges_tensor generation:  0.007565736770629883
mini_batch_src_global generation:  0.0017931461334228516
r_  generation:  0.0105743408203125
local_output_nid generation:  0.0016102790832519531
local_in_edges_tensor generation:  0.0010936260223388672
mini_batch_src_global generation:  0.0016293525695800781
r_  generation:  0.010603189468383789
local_output_nid generation:  0.0016510486602783203
local_in_edges_tensor generation:  0.0010166168212890625
mini_batch_src_global generation:  0.0012192726135253906
r_  generation:  0.010082244873046875
local_output_nid generation:  0.0016434192657470703
local_in_edges_tensor generation:  0.0009768009185791016
mini_batch_src_global generation:  0.0011849403381347656
r_  generation:  0.010298728942871094
local_output_nid generation:  0.0016329288482666016
local_in_edges_tensor generation:  0.0009725093841552734
mini_batch_src_global generation:  0.0011243820190429688
r_  generation:  0.009972572326660156
local_output_nid generation:  0.0015904903411865234
local_in_edges_tensor generation:  0.000911712646484375
mini_batch_src_global generation:  0.0010433197021484375
r_  generation:  0.01180124282836914
local_output_nid generation:  0.0016541481018066406
local_in_edges_tensor generation:  0.0009584426879882812
mini_batch_src_global generation:  0.00131988525390625
r_  generation:  0.010737419128417969
local_output_nid generation:  0.0015861988067626953
local_in_edges_tensor generation:  0.0009312629699707031
mini_batch_src_global generation:  0.001176595687866211
r_  generation:  0.01016855239868164
local_output_nid generation:  0.0015940666198730469
local_in_edges_tensor generation:  0.0009336471557617188
mini_batch_src_global generation:  0.0011560916900634766
r_  generation:  0.010204553604125977
local_output_nid generation:  0.0016214847564697266
local_in_edges_tensor generation:  0.0009188652038574219
mini_batch_src_global generation:  0.0011088848114013672
r_  generation:  0.010098695755004883
local_output_nid generation:  0.0015969276428222656
local_in_edges_tensor generation:  0.0009257793426513672
mini_batch_src_global generation:  0.0011780261993408203
r_  generation:  0.01061558723449707
local_output_nid generation:  0.0015912055969238281
local_in_edges_tensor generation:  0.0009567737579345703
mini_batch_src_global generation:  0.0011811256408691406
r_  generation:  0.01066446304321289
local_output_nid generation:  0.0015828609466552734
local_in_edges_tensor generation:  0.0009129047393798828
mini_batch_src_global generation:  0.0011212825775146484
r_  generation:  0.010389089584350586
local_output_nid generation:  0.0015823841094970703
local_in_edges_tensor generation:  0.0009136199951171875
mini_batch_src_global generation:  0.0011336803436279297
r_  generation:  0.01024770736694336
local_output_nid generation:  0.0015954971313476562
local_in_edges_tensor generation:  0.0009145736694335938
mini_batch_src_global generation:  0.0011010169982910156
r_  generation:  0.010166168212890625
local_output_nid generation:  0.0015869140625
local_in_edges_tensor generation:  0.0009286403656005859
mini_batch_src_global generation:  0.0011322498321533203
r_  generation:  0.010407447814941406
local_output_nid generation:  0.0015919208526611328
local_in_edges_tensor generation:  0.0009219646453857422
mini_batch_src_global generation:  0.0011515617370605469
r_  generation:  0.010684967041015625
local_output_nid generation:  0.001622915267944336
local_in_edges_tensor generation:  0.0009589195251464844
mini_batch_src_global generation:  0.001199960708618164
r_  generation:  0.010755062103271484
local_output_nid generation:  0.0015864372253417969
local_in_edges_tensor generation:  0.0009083747863769531
mini_batch_src_global generation:  0.001224517822265625
r_  generation:  0.010521888732910156
local_output_nid generation:  0.0016133785247802734
local_in_edges_tensor generation:  0.0009133815765380859
mini_batch_src_global generation:  0.0011713504791259766
r_  generation:  0.010399580001831055
local_output_nid generation:  0.0016589164733886719
local_in_edges_tensor generation:  0.0009105205535888672
mini_batch_src_global generation:  0.0011248588562011719
r_  generation:  0.010541200637817383
local_output_nid generation:  0.0016071796417236328
local_in_edges_tensor generation:  0.0008997917175292969
mini_batch_src_global generation:  0.0011599063873291016
r_  generation:  0.010221004486083984
local_output_nid generation:  0.0015926361083984375
local_in_edges_tensor generation:  0.0008895397186279297
mini_batch_src_global generation:  0.0011322498321533203
r_  generation:  0.01024937629699707
local_output_nid generation:  0.0016417503356933594
local_in_edges_tensor generation:  0.0008740425109863281
mini_batch_src_global generation:  0.0011284351348876953
r_  generation:  0.010294198989868164
local_output_nid generation:  0.0015947818756103516
local_in_edges_tensor generation:  0.0009267330169677734
mini_batch_src_global generation:  0.0011794567108154297
r_  generation:  0.010449409484863281
local_output_nid generation:  0.001621246337890625
local_in_edges_tensor generation:  0.0009315013885498047
mini_batch_src_global generation:  0.001161813735961914
r_  generation:  0.011029958724975586
local_output_nid generation:  0.0016140937805175781
local_in_edges_tensor generation:  0.0008950233459472656
mini_batch_src_global generation:  0.0011301040649414062
r_  generation:  0.010339021682739258
local_output_nid generation:  0.0015904903411865234
local_in_edges_tensor generation:  0.000904083251953125
mini_batch_src_global generation:  0.0011470317840576172
r_  generation:  0.010199785232543945
local_output_nid generation:  0.0016040802001953125
local_in_edges_tensor generation:  0.0009026527404785156
mini_batch_src_global generation:  0.0011394023895263672
r_  generation:  0.010474920272827148
local_output_nid generation:  0.0016143321990966797
local_in_edges_tensor generation:  0.0008804798126220703
mini_batch_src_global generation:  0.001119375228881836
r_  generation:  0.010074138641357422
local_output_nid generation:  0.0016014575958251953
local_in_edges_tensor generation:  0.0008852481842041016
mini_batch_src_global generation:  0.0011799335479736328
r_  generation:  0.010049819946289062
local_output_nid generation:  0.0015985965728759766
local_in_edges_tensor generation:  0.0008838176727294922
mini_batch_src_global generation:  0.0011875629425048828
r_  generation:  0.010263919830322266
----------------------check_connections_block total spend ----------------------------- 0.5771520137786865
generate_one_block  0.024765729904174805
generate_one_block  0.021462678909301758
generate_one_block  0.019561767578125
generate_one_block  0.019582748413085938
generate_one_block  0.018564462661743164
generate_one_block  0.019845962524414062
generate_one_block  0.020361661911010742
generate_one_block  0.019010305404663086
generate_one_block  0.018703937530517578
generate_one_block  0.018022775650024414
generate_one_block  0.019031763076782227
generate_one_block  0.019223451614379883
generate_one_block  0.018513202667236328
generate_one_block  0.01846027374267578
generate_one_block  0.018279552459716797
generate_one_block  0.018740177154541016
generate_one_block  0.0188446044921875
generate_one_block  0.019200801849365234
generate_one_block  0.018403053283691406
generate_one_block  0.018815040588378906
generate_one_block  0.018809795379638672
generate_one_block  0.01840066909790039
generate_one_block  0.018398523330688477
generate_one_block  0.018439769744873047
generate_one_block  0.01854848861694336
generate_one_block  0.019524574279785156
generate_one_block  0.01811838150024414
generate_one_block  0.018244504928588867
generate_one_block  0.018671751022338867
generate_one_block  0.017935514450073242
generate_one_block  0.01793384552001953
generate_one_block  0.01850414276123047
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04449343681335449
gen group dst list time:  0.022755861282348633
time for parepare:  0.021703004837036133
local_output_nid generation:  0.006494045257568359
local_in_edges_tensor generation:  0.019746065139770508
mini_batch_src_global generation:  0.016982078552246094
r_  generation:  0.15756535530090332
local_output_nid generation:  0.009079933166503906
local_in_edges_tensor generation:  0.01197361946105957
mini_batch_src_global generation:  0.02160191535949707
r_  generation:  0.1666882038116455
local_output_nid generation:  0.009732723236083984
local_in_edges_tensor generation:  0.034699201583862305
mini_batch_src_global generation:  0.019604206085205078
r_  generation:  0.1738603115081787
local_output_nid generation:  0.009997367858886719
local_in_edges_tensor generation:  0.012329816818237305
mini_batch_src_global generation:  0.021793842315673828
r_  generation:  0.1789562702178955
local_output_nid generation:  0.00969839096069336
local_in_edges_tensor generation:  0.009141206741333008
mini_batch_src_global generation:  0.021004199981689453
r_  generation:  0.17243552207946777
local_output_nid generation:  0.009741544723510742
local_in_edges_tensor generation:  0.010216236114501953
mini_batch_src_global generation:  0.023546457290649414
r_  generation:  0.18808603286743164
local_output_nid generation:  0.009221315383911133
local_in_edges_tensor generation:  0.009604930877685547
mini_batch_src_global generation:  0.022325515747070312
r_  generation:  0.18111538887023926
local_output_nid generation:  0.009183883666992188
local_in_edges_tensor generation:  0.009350776672363281
mini_batch_src_global generation:  0.0285189151763916
r_  generation:  0.1824491024017334
local_output_nid generation:  0.009248971939086914
local_in_edges_tensor generation:  0.009496212005615234
mini_batch_src_global generation:  0.02243351936340332
r_  generation:  0.18009471893310547
local_output_nid generation:  0.009280204772949219
local_in_edges_tensor generation:  0.011821269989013672
mini_batch_src_global generation:  0.02174210548400879
r_  generation:  0.17197775840759277
local_output_nid generation:  0.009666204452514648
local_in_edges_tensor generation:  0.009360313415527344
mini_batch_src_global generation:  0.022748708724975586
r_  generation:  0.18554353713989258
local_output_nid generation:  0.009776115417480469
local_in_edges_tensor generation:  0.010414361953735352
mini_batch_src_global generation:  0.023290157318115234
r_  generation:  0.18505144119262695
local_output_nid generation:  0.009724855422973633
local_in_edges_tensor generation:  0.010457038879394531
mini_batch_src_global generation:  0.02315831184387207
r_  generation:  0.18123579025268555
local_output_nid generation:  0.009733200073242188
local_in_edges_tensor generation:  0.00936746597290039
mini_batch_src_global generation:  0.022298336029052734
r_  generation:  0.18285250663757324
local_output_nid generation:  0.009691238403320312
local_in_edges_tensor generation:  0.009253740310668945
mini_batch_src_global generation:  0.02225017547607422
r_  generation:  0.17882466316223145
local_output_nid generation:  0.009774208068847656
local_in_edges_tensor generation:  0.009281635284423828
mini_batch_src_global generation:  0.022808313369750977
r_  generation:  0.18227767944335938
local_output_nid generation:  0.00978231430053711
local_in_edges_tensor generation:  0.00944209098815918
mini_batch_src_global generation:  0.02366161346435547
r_  generation:  0.18913030624389648
local_output_nid generation:  0.010062694549560547
local_in_edges_tensor generation:  0.009592056274414062
mini_batch_src_global generation:  0.02395796775817871
r_  generation:  0.18838238716125488
local_output_nid generation:  0.009674787521362305
local_in_edges_tensor generation:  0.009632110595703125
mini_batch_src_global generation:  0.022920846939086914
r_  generation:  0.18037772178649902
local_output_nid generation:  0.0098876953125
local_in_edges_tensor generation:  0.009409666061401367
mini_batch_src_global generation:  0.02404308319091797
r_  generation:  0.18670010566711426
local_output_nid generation:  0.00991368293762207
local_in_edges_tensor generation:  0.00996708869934082
mini_batch_src_global generation:  0.02332139015197754
r_  generation:  0.18651270866394043
local_output_nid generation:  0.009502172470092773
local_in_edges_tensor generation:  0.010343074798583984
mini_batch_src_global generation:  0.022864818572998047
r_  generation:  0.18086791038513184
local_output_nid generation:  0.009409189224243164
local_in_edges_tensor generation:  0.008785486221313477
mini_batch_src_global generation:  0.022961139678955078
r_  generation:  0.17786812782287598
local_output_nid generation:  0.009774208068847656
local_in_edges_tensor generation:  0.009340286254882812
mini_batch_src_global generation:  0.0226132869720459
r_  generation:  0.17935419082641602
local_output_nid generation:  0.009664535522460938
local_in_edges_tensor generation:  0.009219169616699219
mini_batch_src_global generation:  0.02254962921142578
r_  generation:  0.18175268173217773
local_output_nid generation:  0.010097026824951172
local_in_edges_tensor generation:  0.011268138885498047
mini_batch_src_global generation:  0.02403116226196289
r_  generation:  0.19330286979675293
local_output_nid generation:  0.009458065032958984
local_in_edges_tensor generation:  0.009090185165405273
mini_batch_src_global generation:  0.022562026977539062
r_  generation:  0.17861032485961914
local_output_nid generation:  0.009814262390136719
local_in_edges_tensor generation:  0.009866952896118164
mini_batch_src_global generation:  0.02229452133178711
r_  generation:  0.17926502227783203
local_output_nid generation:  0.009791851043701172
local_in_edges_tensor generation:  0.010837554931640625
mini_batch_src_global generation:  0.022910594940185547
r_  generation:  0.18387794494628906
local_output_nid generation:  0.009392499923706055
local_in_edges_tensor generation:  0.009132862091064453
mini_batch_src_global generation:  0.022359609603881836
r_  generation:  0.17687344551086426
local_output_nid generation:  0.009522199630737305
local_in_edges_tensor generation:  0.009384870529174805
mini_batch_src_global generation:  0.022002696990966797
r_  generation:  0.1776137351989746
local_output_nid generation:  0.009647130966186523
local_in_edges_tensor generation:  0.010696649551391602
mini_batch_src_global generation:  0.02231454849243164
r_  generation:  0.1841280460357666
----------------------check_connections_block total spend ----------------------------- 8.462330102920532
generate_one_block  0.24118518829345703
generate_one_block  0.2370302677154541
generate_one_block  0.24709868431091309
generate_one_block  0.25036048889160156
generate_one_block  0.26557064056396484
generate_one_block  0.26262950897216797
generate_one_block  0.24735808372497559
generate_one_block  0.24428105354309082
generate_one_block  0.24797916412353516
generate_one_block  0.23118185997009277
generate_one_block  0.25150108337402344
generate_one_block  0.2539958953857422
generate_one_block  0.24604082107543945
generate_one_block  0.23963308334350586
generate_one_block  0.24054217338562012
generate_one_block  0.24661707878112793
generate_one_block  0.2578706741333008
generate_one_block  0.25575828552246094
generate_one_block  0.24401521682739258
generate_one_block  0.2515537738800049
generate_one_block  0.25008344650268555
generate_one_block  0.24363327026367188
generate_one_block  0.2383568286895752
generate_one_block  0.24524712562561035
generate_one_block  0.24818682670593262
generate_one_block  0.2621166706085205
generate_one_block  0.2398226261138916
generate_one_block  0.241560697555542
generate_one_block  0.24932193756103516
generate_one_block  0.23856282234191895
generate_one_block  0.23917794227600098
generate_one_block  0.2485361099243164
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.037432193756103516
gen group dst list time:  0.10682439804077148
time for parepare:  0.019948720932006836
local_output_nid generation:  0.025815486907958984
local_in_edges_tensor generation:  0.04197192192077637
mini_batch_src_global generation:  0.046767473220825195
r_  generation:  0.4855799674987793
local_output_nid generation:  0.0317535400390625
local_in_edges_tensor generation:  0.037886857986450195
mini_batch_src_global generation:  0.05933237075805664
r_  generation:  0.48938632011413574
local_output_nid generation:  0.03156781196594238
local_in_edges_tensor generation:  0.032938480377197266
mini_batch_src_global generation:  0.05753779411315918
r_  generation:  0.49934911727905273
local_output_nid generation:  0.031827688217163086
local_in_edges_tensor generation:  0.03152894973754883
mini_batch_src_global generation:  0.05854940414428711
r_  generation:  0.497727632522583
local_output_nid generation:  0.030481338500976562
local_in_edges_tensor generation:  0.03020000457763672
mini_batch_src_global generation:  0.060173988342285156
r_  generation:  0.49633216857910156
local_output_nid generation:  0.029900789260864258
local_in_edges_tensor generation:  0.03330397605895996
mini_batch_src_global generation:  0.06147956848144531
r_  generation:  0.49834418296813965
local_output_nid generation:  0.029613971710205078
local_in_edges_tensor generation:  0.029920578002929688
mini_batch_src_global generation:  0.06186175346374512
r_  generation:  0.4997410774230957
local_output_nid generation:  0.029477357864379883
local_in_edges_tensor generation:  0.033034324645996094
mini_batch_src_global generation:  0.0591583251953125
r_  generation:  0.49070191383361816
local_output_nid generation:  0.029567718505859375
local_in_edges_tensor generation:  0.03121805191040039
mini_batch_src_global generation:  0.05831599235534668
r_  generation:  0.5091376304626465
local_output_nid generation:  0.031038522720336914
local_in_edges_tensor generation:  0.030759096145629883
mini_batch_src_global generation:  0.05936145782470703
r_  generation:  0.4916999340057373
local_output_nid generation:  0.030283689498901367
local_in_edges_tensor generation:  0.030963897705078125
mini_batch_src_global generation:  0.058225154876708984
r_  generation:  0.5049304962158203
local_output_nid generation:  0.031033039093017578
local_in_edges_tensor generation:  0.03038930892944336
mini_batch_src_global generation:  0.059854745864868164
r_  generation:  0.49992871284484863
local_output_nid generation:  0.030280113220214844
local_in_edges_tensor generation:  0.030913829803466797
mini_batch_src_global generation:  0.05823636054992676
r_  generation:  0.5072526931762695
local_output_nid generation:  0.031014442443847656
local_in_edges_tensor generation:  0.03100872039794922
mini_batch_src_global generation:  0.05947279930114746
r_  generation:  0.4958322048187256
local_output_nid generation:  0.030252456665039062
local_in_edges_tensor generation:  0.03104567527770996
mini_batch_src_global generation:  0.058156728744506836
r_  generation:  0.5028078556060791
local_output_nid generation:  0.030346155166625977
local_in_edges_tensor generation:  0.02842235565185547
mini_batch_src_global generation:  0.05980968475341797
r_  generation:  0.49517321586608887
local_output_nid generation:  0.030789613723754883
local_in_edges_tensor generation:  0.029792070388793945
mini_batch_src_global generation:  0.06097865104675293
r_  generation:  0.5090773105621338
local_output_nid generation:  0.030156373977661133
local_in_edges_tensor generation:  0.030256271362304688
mini_batch_src_global generation:  0.059400320053100586
r_  generation:  0.4994518756866455
local_output_nid generation:  0.030225038528442383
local_in_edges_tensor generation:  0.028940677642822266
mini_batch_src_global generation:  0.0583195686340332
r_  generation:  0.4998939037322998
local_output_nid generation:  0.030556917190551758
local_in_edges_tensor generation:  0.029736995697021484
mini_batch_src_global generation:  0.062047481536865234
r_  generation:  0.49746084213256836
local_output_nid generation:  0.0307772159576416
local_in_edges_tensor generation:  0.03484201431274414
mini_batch_src_global generation:  0.05864429473876953
r_  generation:  0.5035436153411865
local_output_nid generation:  0.030181407928466797
local_in_edges_tensor generation:  0.02945876121520996
mini_batch_src_global generation:  0.059848785400390625
r_  generation:  0.49564576148986816
local_output_nid generation:  0.03024458885192871
local_in_edges_tensor generation:  0.0304410457611084
mini_batch_src_global generation:  0.05822873115539551
r_  generation:  0.4998965263366699
local_output_nid generation:  0.030304908752441406
local_in_edges_tensor generation:  0.028797388076782227
mini_batch_src_global generation:  0.06181907653808594
r_  generation:  0.4979417324066162
local_output_nid generation:  0.030246257781982422
local_in_edges_tensor generation:  0.02870011329650879
mini_batch_src_global generation:  0.05846810340881348
r_  generation:  0.5027000904083252
local_output_nid generation:  0.030532360076904297
local_in_edges_tensor generation:  0.030415058135986328
mini_batch_src_global generation:  0.06236100196838379
r_  generation:  0.5003678798675537
local_output_nid generation:  0.03009200096130371
local_in_edges_tensor generation:  0.0330350399017334
mini_batch_src_global generation:  0.05843400955200195
r_  generation:  0.4975166320800781
local_output_nid generation:  0.030657291412353516
local_in_edges_tensor generation:  0.02881622314453125
mini_batch_src_global generation:  0.06047463417053223
r_  generation:  0.49439239501953125
local_output_nid generation:  0.03034186363220215
local_in_edges_tensor generation:  0.028641223907470703
mini_batch_src_global generation:  0.05860495567321777
r_  generation:  0.5002949237823486
local_output_nid generation:  0.03023552894592285
local_in_edges_tensor generation:  0.029165267944335938
mini_batch_src_global generation:  0.05962038040161133
r_  generation:  0.4921755790710449
local_output_nid generation:  0.02997422218322754
local_in_edges_tensor generation:  0.028998851776123047
mini_batch_src_global generation:  0.05799102783203125
r_  generation:  0.4970841407775879
local_output_nid generation:  0.030210256576538086
local_in_edges_tensor generation:  0.02851557731628418
mini_batch_src_global generation:  0.05937480926513672
r_  generation:  0.49764347076416016
----------------------check_connections_block total spend ----------------------------- 23.280625343322754
generate_one_block  0.6768794059753418
generate_one_block  0.6754209995269775
generate_one_block  0.6797494888305664
generate_one_block  0.6802799701690674
generate_one_block  0.761570930480957
generate_one_block  0.6810805797576904
generate_one_block  0.6799530982971191
generate_one_block  0.671947717666626
generate_one_block  0.675194501876831
generate_one_block  0.66668701171875
generate_one_block  0.6802802085876465
generate_one_block  0.6864852905273438
generate_one_block  0.6683697700500488
generate_one_block  0.6718199253082275
generate_one_block  0.6719622611999512
generate_one_block  0.671332836151123
generate_one_block  0.6871612071990967
generate_one_block  0.6687521934509277
generate_one_block  0.671912431716919
generate_one_block  0.6787288188934326
generate_one_block  0.6857612133026123
generate_one_block  0.6736514568328857
generate_one_block  0.6691956520080566
generate_one_block  0.6736125946044922
generate_one_block  0.6920180320739746
generate_one_block  0.6854169368743896
generate_one_block  0.6696343421936035
generate_one_block  0.6699123382568359
generate_one_block  0.6788554191589355
generate_one_block  0.6661796569824219
generate_one_block  0.6708970069885254
generate_one_block  0.6755859851837158
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 0.13067054748535156  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

connection checking time:  31.742955446243286
block generation total time  29.623098611831665
average batch blocks generation time:  0.9257218316197395
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 0.10961103439331055  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 20.41641664505005  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 0.10913944244384766  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 20.517970085144043  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 0.109954833984375  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 20.916861534118652  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 0.1093740463256836  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 21.091583251953125  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 0.10968780517578125  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 20.518101692199707  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 0.10979270935058594  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4061279296875 GB
    Memory Allocated: 21.454586505889893  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4061279296875 GB
    Memory Allocated: 0.10992813110351562  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4061279296875 GB
    Memory Allocated: 20.94460964202881  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4061279296875 GB
    Memory Allocated: 0.10929346084594727  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4061279296875 GB
    Memory Allocated: 20.809360027313232  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4061279296875 GB
    Memory Allocated: 0.10989952087402344  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4061279296875 GB
    Memory Allocated: 20.876198768615723  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4061279296875 GB
    Memory Allocated: 0.1089024543762207  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4061279296875 GB
    Memory Allocated: 20.229230403900146  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4061279296875 GB
    Memory Allocated: 0.11001110076904297  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4061279296875 GB
    Memory Allocated: 21.05802297592163  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4061279296875 GB
    Memory Allocated: 0.10959100723266602  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4061279296875 GB
    Memory Allocated: 21.161805152893066  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4061279296875 GB
    Memory Allocated: 0.10982036590576172  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4061279296875 GB
    Memory Allocated: 20.72322177886963  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4061279296875 GB
    Memory Allocated: 0.10943460464477539  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4061279296875 GB
    Memory Allocated: 20.585091590881348  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4061279296875 GB
    Memory Allocated: 0.1097402572631836  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4061279296875 GB
    Memory Allocated: 20.603609085083008  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4061279296875 GB
    Memory Allocated: 0.10929393768310547  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4061279296875 GB
    Memory Allocated: 20.853458881378174  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4061279296875 GB
    Memory Allocated: 0.11013126373291016  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4100341796875 GB
    Memory Allocated: 21.28926420211792  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4119873046875 GB
    Memory Allocated: 0.10939788818359375  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4119873046875 GB
    Memory Allocated: 21.1840238571167  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4119873046875 GB
    Memory Allocated: 0.10977649688720703  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4119873046875 GB
    Memory Allocated: 20.671711444854736  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4119873046875 GB
    Memory Allocated: 0.10948371887207031  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4119873046875 GB
    Memory Allocated: 20.91109561920166  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4119873046875 GB
    Memory Allocated: 0.110015869140625  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4119873046875 GB
    Memory Allocated: 21.051331996917725  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4119873046875 GB
    Memory Allocated: 0.10906362533569336  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4119873046875 GB
    Memory Allocated: 20.665058612823486  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4119873046875 GB
    Memory Allocated: 0.10967826843261719  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4119873046875 GB
    Memory Allocated: 20.462510108947754  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4119873046875 GB
    Memory Allocated: 0.10921669006347656  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4119873046875 GB
    Memory Allocated: 20.638695240020752  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4119873046875 GB
    Memory Allocated: 0.10983562469482422  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4119873046875 GB
    Memory Allocated: 20.76572561264038  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4119873046875 GB
    Memory Allocated: 0.10967254638671875  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4119873046875 GB
    Memory Allocated: 21.341176509857178  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4119873046875 GB
    Memory Allocated: 0.10851430892944336  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4119873046875 GB
    Memory Allocated: 20.462823390960693  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4119873046875 GB
    Memory Allocated: 0.10929012298583984  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4119873046875 GB
    Memory Allocated: 20.560917854309082  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4119873046875 GB
    Memory Allocated: 0.10989665985107422  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4119873046875 GB
    Memory Allocated: 20.885098457336426  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4119873046875 GB
    Memory Allocated: 0.10904645919799805  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4119873046875 GB
    Memory Allocated: 20.430514335632324  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4119873046875 GB
    Memory Allocated: 0.10963916778564453  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4119873046875 GB
    Memory Allocated: 20.42374086380005  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4119873046875 GB
    Memory Allocated: 0.10912322998046875  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4119873046875 GB
    Memory Allocated: 20.705750465393066  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.026888035237789154 |0.02242431789636612 |0.6307399198412895 |9.52109694480896e-05 |1.2077394798398018 |0.008283853530883789 |
----------------------------------------------------------pseudo_mini_loss sum 2.1869289875030518
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  9166336
Number of first layer input nodes during this epoch:  4810415
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.4119873046875 GB
    Memory Allocated: 0.1310725212097168  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.029703617095947266
random selection method range initialization spend 0.007177114486694336
time for parepare:  0.02590799331665039
local_output_nid generation:  0.001960277557373047
local_in_edges_tensor generation:  0.008193016052246094
mini_batch_src_global generation:  0.0023806095123291016
r_  generation:  0.010464906692504883
local_output_nid generation:  0.0019159317016601562
local_in_edges_tensor generation:  0.0014758110046386719
mini_batch_src_global generation:  0.002088308334350586
r_  generation:  0.011788129806518555
local_output_nid generation:  0.002053499221801758
local_in_edges_tensor generation:  0.001434326171875
mini_batch_src_global generation:  0.001543283462524414
r_  generation:  0.010138750076293945
local_output_nid generation:  0.0020847320556640625
local_in_edges_tensor generation:  0.0013782978057861328
mini_batch_src_global generation:  0.0015230178833007812
r_  generation:  0.01089334487915039
local_output_nid generation:  0.002109527587890625
local_in_edges_tensor generation:  0.0014064311981201172
mini_batch_src_global generation:  0.0014805793762207031
r_  generation:  0.010648012161254883
local_output_nid generation:  0.0021393299102783203
local_in_edges_tensor generation:  0.0014028549194335938
mini_batch_src_global generation:  0.0016107559204101562
r_  generation:  0.01160287857055664
local_output_nid generation:  0.002180337905883789
local_in_edges_tensor generation:  0.0014214515686035156
mini_batch_src_global generation:  0.0014543533325195312
r_  generation:  0.010703086853027344
local_output_nid generation:  0.002241373062133789
local_in_edges_tensor generation:  0.001398324966430664
mini_batch_src_global generation:  0.0015070438385009766
r_  generation:  0.010797739028930664
local_output_nid generation:  0.0022530555725097656
local_in_edges_tensor generation:  0.0013823509216308594
mini_batch_src_global generation:  0.0013933181762695312
r_  generation:  0.010645627975463867
local_output_nid generation:  0.0022499561309814453
local_in_edges_tensor generation:  0.0013942718505859375
mini_batch_src_global generation:  0.0014176368713378906
r_  generation:  0.011009454727172852
local_output_nid generation:  0.0022585391998291016
local_in_edges_tensor generation:  0.0013794898986816406
mini_batch_src_global generation:  0.00156402587890625
r_  generation:  0.011120080947875977
local_output_nid generation:  0.0023107528686523438
local_in_edges_tensor generation:  0.001405954360961914
mini_batch_src_global generation:  0.0014197826385498047
r_  generation:  0.01111459732055664
local_output_nid generation:  0.0022737979888916016
local_in_edges_tensor generation:  0.0013837814331054688
mini_batch_src_global generation:  0.001398324966430664
r_  generation:  0.01091623306274414
local_output_nid generation:  0.0022857189178466797
local_in_edges_tensor generation:  0.0013954639434814453
mini_batch_src_global generation:  0.0013659000396728516
r_  generation:  0.010894536972045898
local_output_nid generation:  0.0022857189178466797
local_in_edges_tensor generation:  0.0013761520385742188
mini_batch_src_global generation:  0.001508474349975586
r_  generation:  0.010771751403808594
local_output_nid generation:  0.002302885055541992
local_in_edges_tensor generation:  0.0014052391052246094
mini_batch_src_global generation:  0.0014333724975585938
r_  generation:  0.011388301849365234
local_output_nid generation:  0.002312183380126953
local_in_edges_tensor generation:  0.0014045238494873047
mini_batch_src_global generation:  0.0013527870178222656
r_  generation:  0.010315418243408203
local_output_nid generation:  0.0023114681243896484
local_in_edges_tensor generation:  0.0013813972473144531
mini_batch_src_global generation:  0.0013437271118164062
r_  generation:  0.010797977447509766
local_output_nid generation:  0.002310514450073242
local_in_edges_tensor generation:  0.0013840198516845703
mini_batch_src_global generation:  0.0013976097106933594
r_  generation:  0.010931968688964844
local_output_nid generation:  0.002294301986694336
local_in_edges_tensor generation:  0.0014185905456542969
mini_batch_src_global generation:  0.0013918876647949219
r_  generation:  0.01138615608215332
local_output_nid generation:  0.0022869110107421875
local_in_edges_tensor generation:  0.0013852119445800781
mini_batch_src_global generation:  0.0013415813446044922
r_  generation:  0.010446310043334961
local_output_nid generation:  0.002293825149536133
local_in_edges_tensor generation:  0.00136566162109375
mini_batch_src_global generation:  0.0014407634735107422
r_  generation:  0.011552095413208008
local_output_nid generation:  0.002293825149536133
local_in_edges_tensor generation:  0.0013849735260009766
mini_batch_src_global generation:  0.00150299072265625
r_  generation:  0.010898590087890625
local_output_nid generation:  0.0023348331451416016
local_in_edges_tensor generation:  0.0013895034790039062
mini_batch_src_global generation:  0.0014595985412597656
r_  generation:  0.011221885681152344
local_output_nid generation:  0.0023076534271240234
local_in_edges_tensor generation:  0.0013849735260009766
mini_batch_src_global generation:  0.0014200210571289062
r_  generation:  0.011147022247314453
local_output_nid generation:  0.0023186206817626953
local_in_edges_tensor generation:  0.0013332366943359375
mini_batch_src_global generation:  0.0013761520385742188
r_  generation:  0.011332035064697266
local_output_nid generation:  0.0022847652435302734
local_in_edges_tensor generation:  0.001371145248413086
mini_batch_src_global generation:  0.0015110969543457031
r_  generation:  0.010730743408203125
local_output_nid generation:  0.002315521240234375
local_in_edges_tensor generation:  0.0013794898986816406
mini_batch_src_global generation:  0.001322031021118164
r_  generation:  0.01071476936340332
local_output_nid generation:  0.0023093223571777344
local_in_edges_tensor generation:  0.0013928413391113281
mini_batch_src_global generation:  0.0014522075653076172
r_  generation:  0.010497808456420898
local_output_nid generation:  0.002310514450073242
local_in_edges_tensor generation:  0.001421213150024414
mini_batch_src_global generation:  0.001550912857055664
r_  generation:  0.011494636535644531
local_output_nid generation:  0.002312898635864258
local_in_edges_tensor generation:  0.0013895034790039062
mini_batch_src_global generation:  0.003934383392333984
r_  generation:  0.018221616744995117
local_output_nid generation:  0.002826690673828125
local_in_edges_tensor generation:  0.0016438961029052734
mini_batch_src_global generation:  0.001903533935546875
r_  generation:  0.010996341705322266
----------------------check_connections_block total spend ----------------------------- 0.6692171096801758
generate_one_block  0.025513410568237305
generate_one_block  0.02201700210571289
generate_one_block  0.019274234771728516
generate_one_block  0.019164085388183594
generate_one_block  0.019252538681030273
generate_one_block  0.019649505615234375
generate_one_block  0.018809080123901367
generate_one_block  0.018321514129638672
generate_one_block  0.018877744674682617
generate_one_block  0.0187075138092041
generate_one_block  0.01937699317932129
generate_one_block  0.018854856491088867
generate_one_block  0.0189669132232666
generate_one_block  0.01819467544555664
generate_one_block  0.018598079681396484
generate_one_block  0.019017457962036133
generate_one_block  0.01809215545654297
generate_one_block  0.0181732177734375
generate_one_block  0.018872976303100586
generate_one_block  0.019085168838500977
generate_one_block  0.018321752548217773
generate_one_block  0.019446611404418945
generate_one_block  0.01879262924194336
generate_one_block  0.018608570098876953
generate_one_block  0.01930403709411621
generate_one_block  0.018695592880249023
generate_one_block  0.018391132354736328
generate_one_block  0.018025636672973633
generate_one_block  0.018122434616088867
generate_one_block  0.019212961196899414
generate_one_block  0.019434690475463867
generate_one_block  0.018022537231445312
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04237198829650879
gen group dst list time:  0.025641679763793945
time for parepare:  0.021944046020507812
local_output_nid generation:  0.0066072940826416016
local_in_edges_tensor generation:  0.017866134643554688
mini_batch_src_global generation:  0.017403364181518555
r_  generation:  0.16198277473449707
local_output_nid generation:  0.009307146072387695
local_in_edges_tensor generation:  0.011607170104980469
mini_batch_src_global generation:  0.020900964736938477
r_  generation:  0.1674189567565918
local_output_nid generation:  0.009585380554199219
local_in_edges_tensor generation:  0.03764653205871582
mini_batch_src_global generation:  0.031848907470703125
r_  generation:  0.20130014419555664
local_output_nid generation:  0.016088485717773438
local_in_edges_tensor generation:  0.03268861770629883
mini_batch_src_global generation:  0.02527165412902832
r_  generation:  0.1846151351928711
local_output_nid generation:  0.012957334518432617
local_in_edges_tensor generation:  0.009715795516967773
mini_batch_src_global generation:  0.02164769172668457
r_  generation:  0.18360424041748047
local_output_nid generation:  0.011382579803466797
local_in_edges_tensor generation:  0.014704465866088867
mini_batch_src_global generation:  0.023821353912353516
r_  generation:  0.19316887855529785
local_output_nid generation:  0.009760856628417969
local_in_edges_tensor generation:  0.009016990661621094
mini_batch_src_global generation:  0.0225222110748291
r_  generation:  0.1823441982269287
local_output_nid generation:  0.009293556213378906
local_in_edges_tensor generation:  0.013027191162109375
mini_batch_src_global generation:  0.022226572036743164
r_  generation:  0.18094706535339355
local_output_nid generation:  0.009372711181640625
local_in_edges_tensor generation:  0.009836435317993164
mini_batch_src_global generation:  0.022915363311767578
r_  generation:  0.18580913543701172
local_output_nid generation:  0.009376764297485352
local_in_edges_tensor generation:  0.010572671890258789
mini_batch_src_global generation:  0.023023605346679688
r_  generation:  0.19300603866577148
local_output_nid generation:  0.01219034194946289
local_in_edges_tensor generation:  0.010600566864013672
mini_batch_src_global generation:  0.02425527572631836
r_  generation:  0.18702054023742676
local_output_nid generation:  0.010023355484008789
local_in_edges_tensor generation:  0.010012626647949219
mini_batch_src_global generation:  0.022756338119506836
r_  generation:  0.19653749465942383
local_output_nid generation:  0.010077238082885742
local_in_edges_tensor generation:  0.00915384292602539
mini_batch_src_global generation:  0.022644758224487305
r_  generation:  0.1797041893005371
local_output_nid generation:  0.009551048278808594
local_in_edges_tensor generation:  0.011258840560913086
mini_batch_src_global generation:  0.022433042526245117
r_  generation:  0.17578482627868652
local_output_nid generation:  0.009777069091796875
local_in_edges_tensor generation:  0.009119749069213867
mini_batch_src_global generation:  0.02294445037841797
r_  generation:  0.23470020294189453
local_output_nid generation:  0.009816408157348633
local_in_edges_tensor generation:  0.009830236434936523
mini_batch_src_global generation:  0.025244712829589844
r_  generation:  0.18627071380615234
local_output_nid generation:  0.009582042694091797
local_in_edges_tensor generation:  0.008873701095581055
mini_batch_src_global generation:  0.022744178771972656
r_  generation:  0.17703032493591309
local_output_nid generation:  0.00957942008972168
local_in_edges_tensor generation:  0.008849859237670898
mini_batch_src_global generation:  0.0228116512298584
r_  generation:  0.1787886619567871
local_output_nid generation:  0.011730670928955078
local_in_edges_tensor generation:  0.009700775146484375
mini_batch_src_global generation:  0.024084091186523438
r_  generation:  0.19081759452819824
local_output_nid generation:  0.00980067253112793
local_in_edges_tensor generation:  0.009711503982543945
mini_batch_src_global generation:  0.024566650390625
r_  generation:  0.1892528533935547
local_output_nid generation:  0.0095977783203125
local_in_edges_tensor generation:  0.009667396545410156
mini_batch_src_global generation:  0.02261185646057129
r_  generation:  0.18654084205627441
local_output_nid generation:  0.010031700134277344
local_in_edges_tensor generation:  0.009403467178344727
mini_batch_src_global generation:  0.023812532424926758
r_  generation:  0.19447112083435059
local_output_nid generation:  0.009886503219604492
local_in_edges_tensor generation:  0.013555526733398438
mini_batch_src_global generation:  0.02302384376525879
r_  generation:  0.22318816184997559
local_output_nid generation:  0.015370368957519531
local_in_edges_tensor generation:  0.020230770111083984
mini_batch_src_global generation:  0.02902841567993164
r_  generation:  0.19640731811523438
local_output_nid generation:  0.01174783706665039
local_in_edges_tensor generation:  0.011527776718139648
mini_batch_src_global generation:  0.024772167205810547
r_  generation:  0.19235491752624512
local_output_nid generation:  0.01021575927734375
local_in_edges_tensor generation:  0.009967803955078125
mini_batch_src_global generation:  0.023674964904785156
r_  generation:  0.18576812744140625
local_output_nid generation:  0.010120868682861328
local_in_edges_tensor generation:  0.009425878524780273
mini_batch_src_global generation:  0.03457903861999512
r_  generation:  0.20565176010131836
local_output_nid generation:  0.013232231140136719
local_in_edges_tensor generation:  0.0124969482421875
mini_batch_src_global generation:  0.027887344360351562
r_  generation:  0.1778254508972168
local_output_nid generation:  0.009874343872070312
local_in_edges_tensor generation:  0.0094757080078125
mini_batch_src_global generation:  0.022577285766601562
r_  generation:  0.17927980422973633
local_output_nid generation:  0.010063648223876953
local_in_edges_tensor generation:  0.010496377944946289
mini_batch_src_global generation:  0.024502038955688477
r_  generation:  0.18591809272766113
local_output_nid generation:  0.010059356689453125
local_in_edges_tensor generation:  0.010290861129760742
mini_batch_src_global generation:  0.0252685546875
r_  generation:  0.18967700004577637
local_output_nid generation:  0.009585142135620117
local_in_edges_tensor generation:  0.009172201156616211
mini_batch_src_global generation:  0.02303910255432129
r_  generation:  0.1778414249420166
----------------------check_connections_block total spend ----------------------------- 8.895938158035278
generate_one_block  0.26207971572875977
generate_one_block  0.24912595748901367
generate_one_block  0.2562575340270996
generate_one_block  0.2577528953552246
generate_one_block  0.28766369819641113
generate_one_block  0.26208019256591797
generate_one_block  0.24864840507507324
generate_one_block  0.2413010597229004
generate_one_block  0.2537229061126709
generate_one_block  0.2474656105041504
generate_one_block  0.2549278736114502
generate_one_block  0.2430119514465332
generate_one_block  0.24451351165771484
generate_one_block  0.2437760829925537
generate_one_block  0.2516915798187256
generate_one_block  0.27436041831970215
generate_one_block  0.24258804321289062
generate_one_block  0.24538516998291016
generate_one_block  0.25664782524108887
generate_one_block  0.2649881839752197
generate_one_block  0.24241876602172852
generate_one_block  0.2580411434173584
generate_one_block  0.25013160705566406
generate_one_block  0.24971508979797363
generate_one_block  0.26766204833984375
generate_one_block  0.25331616401672363
generate_one_block  0.24894309043884277
generate_one_block  0.2422199249267578
generate_one_block  0.24732089042663574
generate_one_block  0.2571597099304199
generate_one_block  0.2600569725036621
generate_one_block  0.24085593223571777
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.045395612716674805
gen group dst list time:  0.11997580528259277
time for parepare:  0.020180702209472656
local_output_nid generation:  0.02641916275024414
local_in_edges_tensor generation:  0.05396771430969238
mini_batch_src_global generation:  0.046537160873413086
r_  generation:  0.4949531555175781
local_output_nid generation:  0.0328524112701416
local_in_edges_tensor generation:  0.03783750534057617
mini_batch_src_global generation:  0.05852079391479492
r_  generation:  0.4832916259765625
local_output_nid generation:  0.032036781311035156
local_in_edges_tensor generation:  0.03823566436767578
mini_batch_src_global generation:  0.05738067626953125
r_  generation:  0.5020418167114258
local_output_nid generation:  0.03314781188964844
local_in_edges_tensor generation:  0.03364872932434082
mini_batch_src_global generation:  0.058730363845825195
r_  generation:  0.4936800003051758
local_output_nid generation:  0.031885385513305664
local_in_edges_tensor generation:  0.029178142547607422
mini_batch_src_global generation:  0.05852055549621582
r_  generation:  0.5004801750183105
local_output_nid generation:  0.030364274978637695
local_in_edges_tensor generation:  0.029569387435913086
mini_batch_src_global generation:  0.05918622016906738
r_  generation:  0.498309850692749
local_output_nid generation:  0.030042171478271484
local_in_edges_tensor generation:  0.03022003173828125
mini_batch_src_global generation:  0.06007099151611328
r_  generation:  0.5085635185241699
local_output_nid generation:  0.03019118309020996
local_in_edges_tensor generation:  0.02916717529296875
mini_batch_src_global generation:  0.05881857872009277
r_  generation:  0.4958817958831787
local_output_nid generation:  0.030265092849731445
local_in_edges_tensor generation:  0.036443233489990234
mini_batch_src_global generation:  0.05884289741516113
r_  generation:  0.5048062801361084
local_output_nid generation:  0.030209064483642578
local_in_edges_tensor generation:  0.032476186752319336
mini_batch_src_global generation:  0.0591890811920166
r_  generation:  0.4986398220062256
local_output_nid generation:  0.030502796173095703
local_in_edges_tensor generation:  0.03152871131896973
mini_batch_src_global generation:  0.06025290489196777
r_  generation:  0.5157020092010498
local_output_nid generation:  0.030096054077148438
local_in_edges_tensor generation:  0.030200481414794922
mini_batch_src_global generation:  0.059635162353515625
r_  generation:  0.4956858158111572
local_output_nid generation:  0.030147790908813477
local_in_edges_tensor generation:  0.031748294830322266
mini_batch_src_global generation:  0.05880546569824219
r_  generation:  0.501000165939331
local_output_nid generation:  0.029908418655395508
local_in_edges_tensor generation:  0.031317949295043945
mini_batch_src_global generation:  0.05978536605834961
r_  generation:  0.49831438064575195
local_output_nid generation:  0.03138542175292969
local_in_edges_tensor generation:  0.03205990791320801
mini_batch_src_global generation:  0.058516740798950195
r_  generation:  0.5022401809692383
local_output_nid generation:  0.03035879135131836
local_in_edges_tensor generation:  0.03140664100646973
mini_batch_src_global generation:  0.06086111068725586
r_  generation:  0.49806714057922363
local_output_nid generation:  0.03035116195678711
local_in_edges_tensor generation:  0.03450465202331543
mini_batch_src_global generation:  0.058966636657714844
r_  generation:  0.5025968551635742
local_output_nid generation:  0.031374216079711914
local_in_edges_tensor generation:  0.0325009822845459
mini_batch_src_global generation:  0.06019186973571777
r_  generation:  0.5024271011352539
local_output_nid generation:  0.030861854553222656
local_in_edges_tensor generation:  0.031696319580078125
mini_batch_src_global generation:  0.05956315994262695
r_  generation:  0.5099480152130127
local_output_nid generation:  0.03042459487915039
local_in_edges_tensor generation:  0.033739566802978516
mini_batch_src_global generation:  0.06231212615966797
r_  generation:  0.5121095180511475
local_output_nid generation:  0.030240297317504883
local_in_edges_tensor generation:  0.03749442100524902
mini_batch_src_global generation:  0.06448507308959961
r_  generation:  0.5016043186187744
local_output_nid generation:  0.031716346740722656
local_in_edges_tensor generation:  0.03522944450378418
mini_batch_src_global generation:  0.06075549125671387
r_  generation:  0.5074942111968994
local_output_nid generation:  0.030480146408081055
local_in_edges_tensor generation:  0.03130054473876953
mini_batch_src_global generation:  0.05922961235046387
r_  generation:  0.4995877742767334
local_output_nid generation:  0.030525684356689453
local_in_edges_tensor generation:  0.032238006591796875
mini_batch_src_global generation:  0.05999350547790527
r_  generation:  0.4985206127166748
local_output_nid generation:  0.03064870834350586
local_in_edges_tensor generation:  0.03185677528381348
mini_batch_src_global generation:  0.059082746505737305
r_  generation:  0.5103118419647217
local_output_nid generation:  0.0307314395904541
local_in_edges_tensor generation:  0.031397104263305664
mini_batch_src_global generation:  0.06040024757385254
r_  generation:  0.49666881561279297
local_output_nid generation:  0.030387401580810547
local_in_edges_tensor generation:  0.0427708625793457
mini_batch_src_global generation:  0.05928373336791992
r_  generation:  0.5038731098175049
local_output_nid generation:  0.030200958251953125
local_in_edges_tensor generation:  0.03076314926147461
mini_batch_src_global generation:  0.06433248519897461
r_  generation:  0.49399352073669434
local_output_nid generation:  0.030188560485839844
local_in_edges_tensor generation:  0.030930280685424805
mini_batch_src_global generation:  0.0583949089050293
r_  generation:  0.4978296756744385
local_output_nid generation:  0.030761003494262695
local_in_edges_tensor generation:  0.0314180850982666
mini_batch_src_global generation:  0.05985546112060547
r_  generation:  0.506068229675293
local_output_nid generation:  0.030597686767578125
local_in_edges_tensor generation:  0.03491711616516113
mini_batch_src_global generation:  0.05956745147705078
r_  generation:  0.5060577392578125
local_output_nid generation:  0.02994823455810547
local_in_edges_tensor generation:  0.031198978424072266
mini_batch_src_global generation:  0.062486886978149414
r_  generation:  0.49693799018859863
----------------------check_connections_block total spend ----------------------------- 23.489580392837524
generate_one_block  0.6892597675323486
generate_one_block  0.6802506446838379
generate_one_block  0.680098295211792
generate_one_block  0.6819961071014404
generate_one_block  0.7845964431762695
generate_one_block  0.6840519905090332
generate_one_block  0.6788990497589111
generate_one_block  0.6743998527526855
generate_one_block  0.6857178211212158
generate_one_block  0.6762275695800781
generate_one_block  0.6839210987091064
generate_one_block  0.672229528427124
generate_one_block  0.6780884265899658
generate_one_block  0.673431396484375
generate_one_block  0.6791000366210938
generate_one_block  0.6870594024658203
generate_one_block  0.6725983619689941
generate_one_block  0.67604660987854
generate_one_block  0.6929473876953125
generate_one_block  0.6722698211669922
generate_one_block  0.6688458919525146
generate_one_block  0.6918075084686279
generate_one_block  0.6853475570678711
generate_one_block  0.6836585998535156
generate_one_block  0.7025253772735596
generate_one_block  0.6779797077178955
generate_one_block  0.6828267574310303
generate_one_block  0.6699421405792236
generate_one_block  0.6709165573120117
generate_one_block  0.6879234313964844
generate_one_block  0.6908242702484131
generate_one_block  0.6701014041900635
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.4119873046875 GB
    Memory Allocated: 0.1310725212097168  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

connection checking time:  32.3855185508728
block generation total time  29.991718769073486
average batch blocks generation time:  0.9372412115335464
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4119873046875 GB
    Memory Allocated: 0.10961389541625977  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4119873046875 GB
    Memory Allocated: 20.418453216552734  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4119873046875 GB
    Memory Allocated: 0.10859203338623047  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4119873046875 GB
    Memory Allocated: 20.28412437438965  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4119873046875 GB
    Memory Allocated: 0.10984516143798828  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4119873046875 GB
    Memory Allocated: 20.783174991607666  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4119873046875 GB
    Memory Allocated: 0.10934209823608398  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4119873046875 GB
    Memory Allocated: 20.878262519836426  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4119873046875 GB
    Memory Allocated: 0.10990619659423828  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4119873046875 GB
    Memory Allocated: 20.90673017501831  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4119873046875 GB
    Memory Allocated: 0.10962629318237305  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4139404296875 GB
    Memory Allocated: 21.134309768676758  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4178466796875 GB
    Memory Allocated: 0.10980224609375  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4178466796875 GB
    Memory Allocated: 20.758434772491455  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4178466796875 GB
    Memory Allocated: 0.10907363891601562  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4178466796875 GB
    Memory Allocated: 20.535621643066406  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4178466796875 GB
    Memory Allocated: 0.1099996566772461  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4178466796875 GB
    Memory Allocated: 21.046019077301025  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4178466796875 GB
    Memory Allocated: 0.10904455184936523  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4178466796875 GB
    Memory Allocated: 20.72525119781494  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4178466796875 GB
    Memory Allocated: 0.11004829406738281  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4178466796875 GB
    Memory Allocated: 21.128285884857178  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4178466796875 GB
    Memory Allocated: 0.10917329788208008  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4178466796875 GB
    Memory Allocated: 20.599002361297607  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4178466796875 GB
    Memory Allocated: 0.10975933074951172  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4178466796875 GB
    Memory Allocated: 20.69402837753296  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4178466796875 GB
    Memory Allocated: 0.10891008377075195  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4178466796875 GB
    Memory Allocated: 20.403239727020264  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4178466796875 GB
    Memory Allocated: 0.10984516143798828  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4178466796875 GB
    Memory Allocated: 20.777758598327637  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4178466796875 GB
    Memory Allocated: 0.10931015014648438  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4178466796875 GB
    Memory Allocated: 21.104280948638916  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4178466796875 GB
    Memory Allocated: 0.1096334457397461  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4178466796875 GB
    Memory Allocated: 20.423951625823975  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4178466796875 GB
    Memory Allocated: 0.10904932022094727  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4178466796875 GB
    Memory Allocated: 20.602463245391846  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4178466796875 GB
    Memory Allocated: 0.11000347137451172  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4178466796875 GB
    Memory Allocated: 21.065356254577637  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4178466796875 GB
    Memory Allocated: 0.10929298400878906  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4178466796875 GB
    Memory Allocated: 20.983417987823486  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4178466796875 GB
    Memory Allocated: 0.1096353530883789  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4178466796875 GB
    Memory Allocated: 20.433356285095215  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4178466796875 GB
    Memory Allocated: 0.10962295532226562  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4178466796875 GB
    Memory Allocated: 21.231929302215576  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4178466796875 GB
    Memory Allocated: 0.1098642349243164  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4178466796875 GB
    Memory Allocated: 20.81106472015381  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4178466796875 GB
    Memory Allocated: 0.1092233657836914  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4178466796875 GB
    Memory Allocated: 20.809109210968018  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4178466796875 GB
    Memory Allocated: 0.11009025573730469  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4451904296875 GB
    Memory Allocated: 21.196292400360107  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.10897588729858398  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 20.764304161071777  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.10980796813964844  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 20.690580368041992  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.10887956619262695  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 20.29438304901123  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.10963630676269531  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 20.44655179977417  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.10939264297485352  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 20.952849864959717  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.11004161834716797  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 21.175704956054688  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.1085667610168457  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 20.284128189086914  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03657214343547821 |0.02205214649438858 |0.6294466704130173 |9.643286466598511e-05 |1.2005440667271614 |0.008853435516357422 |
----------------------------------------------------------pseudo_mini_loss sum 2.037170648574829
 Run 0| Epoch 6 |
Number of nodes for computation during this epoch:  9154394
Number of first layer input nodes during this epoch:  4806082
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.13005685806274414  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026714801788330078
random selection method range initialization spend 0.005357265472412109
time for parepare:  0.020621299743652344
local_output_nid generation:  0.0014111995697021484
local_in_edges_tensor generation:  0.007907629013061523
mini_batch_src_global generation:  0.0016336441040039062
r_  generation:  0.011051416397094727
local_output_nid generation:  0.0016019344329833984
local_in_edges_tensor generation:  0.0011513233184814453
mini_batch_src_global generation:  0.0015294551849365234
r_  generation:  0.010735511779785156
local_output_nid generation:  0.0016181468963623047
local_in_edges_tensor generation:  0.0010170936584472656
mini_batch_src_global generation:  0.0012285709381103516
r_  generation:  0.010416746139526367
local_output_nid generation:  0.0016100406646728516
local_in_edges_tensor generation:  0.0010075569152832031
mini_batch_src_global generation:  0.0011835098266601562
r_  generation:  0.010358095169067383
local_output_nid generation:  0.0015797615051269531
local_in_edges_tensor generation:  0.00096893310546875
mini_batch_src_global generation:  0.0011479854583740234
r_  generation:  0.01010274887084961
local_output_nid generation:  0.0015897750854492188
local_in_edges_tensor generation:  0.000957489013671875
mini_batch_src_global generation:  0.0011377334594726562
r_  generation:  0.010117530822753906
local_output_nid generation:  0.0015797615051269531
local_in_edges_tensor generation:  0.0009520053863525391
mini_batch_src_global generation:  0.0011639595031738281
r_  generation:  0.010205507278442383
local_output_nid generation:  0.00159454345703125
local_in_edges_tensor generation:  0.0009593963623046875
mini_batch_src_global generation:  0.0011196136474609375
r_  generation:  0.009973287582397461
local_output_nid generation:  0.001577138900756836
local_in_edges_tensor generation:  0.0009298324584960938
mini_batch_src_global generation:  0.0011129379272460938
r_  generation:  0.01024174690246582
local_output_nid generation:  0.003383636474609375
local_in_edges_tensor generation:  0.001071929931640625
mini_batch_src_global generation:  0.0011267662048339844
r_  generation:  0.010211467742919922
local_output_nid generation:  0.00159454345703125
local_in_edges_tensor generation:  0.0009148120880126953
mini_batch_src_global generation:  0.001171112060546875
r_  generation:  0.010295867919921875
local_output_nid generation:  0.0015838146209716797
local_in_edges_tensor generation:  0.0009348392486572266
mini_batch_src_global generation:  0.0011374950408935547
r_  generation:  0.010404825210571289
local_output_nid generation:  0.001607656478881836
local_in_edges_tensor generation:  0.0009009838104248047
mini_batch_src_global generation:  0.00119781494140625
r_  generation:  0.010286569595336914
local_output_nid generation:  0.0015788078308105469
local_in_edges_tensor generation:  0.0009050369262695312
mini_batch_src_global generation:  0.0011403560638427734
r_  generation:  0.010326862335205078
local_output_nid generation:  0.0015797615051269531
local_in_edges_tensor generation:  0.0009272098541259766
mini_batch_src_global generation:  0.0011382102966308594
r_  generation:  0.010083436965942383
local_output_nid generation:  0.0015935897827148438
local_in_edges_tensor generation:  0.0008864402770996094
mini_batch_src_global generation:  0.0011487007141113281
r_  generation:  0.010187149047851562
local_output_nid generation:  0.0015671253204345703
local_in_edges_tensor generation:  0.0009088516235351562
mini_batch_src_global generation:  0.0011484622955322266
r_  generation:  0.010285615921020508
local_output_nid generation:  0.0015788078308105469
local_in_edges_tensor generation:  0.0009479522705078125
mini_batch_src_global generation:  0.0011439323425292969
r_  generation:  0.010284662246704102
local_output_nid generation:  0.0015919208526611328
local_in_edges_tensor generation:  0.0008971691131591797
mini_batch_src_global generation:  0.001104593276977539
r_  generation:  0.01012730598449707
local_output_nid generation:  0.0015878677368164062
local_in_edges_tensor generation:  0.0008907318115234375
mini_batch_src_global generation:  0.0011410713195800781
r_  generation:  0.010354995727539062
local_output_nid generation:  0.00156402587890625
local_in_edges_tensor generation:  0.0009057521820068359
mini_batch_src_global generation:  0.0011491775512695312
r_  generation:  0.010270357131958008
local_output_nid generation:  0.0015668869018554688
local_in_edges_tensor generation:  0.0008904933929443359
mini_batch_src_global generation:  0.0011124610900878906
r_  generation:  0.010251522064208984
local_output_nid generation:  0.001589059829711914
local_in_edges_tensor generation:  0.0008764266967773438
mini_batch_src_global generation:  0.001132965087890625
r_  generation:  0.010156631469726562
local_output_nid generation:  0.0015571117401123047
local_in_edges_tensor generation:  0.0008852481842041016
mini_batch_src_global generation:  0.0011208057403564453
r_  generation:  0.01034855842590332
local_output_nid generation:  0.0015516281127929688
local_in_edges_tensor generation:  0.0008654594421386719
mini_batch_src_global generation:  0.0011522769927978516
r_  generation:  0.010463953018188477
local_output_nid generation:  0.0015628337860107422
local_in_edges_tensor generation:  0.0008795261383056641
mini_batch_src_global generation:  0.0011143684387207031
r_  generation:  0.01018381118774414
local_output_nid generation:  0.00154876708984375
local_in_edges_tensor generation:  0.0008881092071533203
mini_batch_src_global generation:  0.0011529922485351562
r_  generation:  0.010521888732910156
local_output_nid generation:  0.0015594959259033203
local_in_edges_tensor generation:  0.0008821487426757812
mini_batch_src_global generation:  0.001129150390625
r_  generation:  0.010502338409423828
local_output_nid generation:  0.0015609264373779297
local_in_edges_tensor generation:  0.0008816719055175781
mini_batch_src_global generation:  0.0011334419250488281
r_  generation:  0.010124921798706055
local_output_nid generation:  0.0016300678253173828
local_in_edges_tensor generation:  0.0008647441864013672
mini_batch_src_global generation:  0.0011546611785888672
r_  generation:  0.01046442985534668
local_output_nid generation:  0.0015497207641601562
local_in_edges_tensor generation:  0.0008547306060791016
mini_batch_src_global generation:  0.0011260509490966797
r_  generation:  0.010374069213867188
local_output_nid generation:  0.0015652179718017578
local_in_edges_tensor generation:  0.0008995532989501953
mini_batch_src_global generation:  0.0011172294616699219
r_  generation:  0.010311365127563477
----------------------check_connections_block total spend ----------------------------- 0.5734694004058838
generate_one_block  0.021492481231689453
generate_one_block  0.021311283111572266
generate_one_block  0.01998591423034668
generate_one_block  0.01931023597717285
generate_one_block  0.01889801025390625
generate_one_block  0.018416643142700195
generate_one_block  0.018297195434570312
generate_one_block  0.01816558837890625
generate_one_block  0.018433570861816406
generate_one_block  0.01800394058227539
generate_one_block  0.0183870792388916
generate_one_block  0.018581628799438477
generate_one_block  0.0181577205657959
generate_one_block  0.01833057403564453
generate_one_block  0.017920255661010742
generate_one_block  0.01839137077331543
generate_one_block  0.01838541030883789
generate_one_block  0.018202781677246094
generate_one_block  0.018108606338500977
generate_one_block  0.018331050872802734
generate_one_block  0.0185089111328125
generate_one_block  0.01847529411315918
generate_one_block  0.018279075622558594
generate_one_block  0.018326759338378906
generate_one_block  0.018546581268310547
generate_one_block  0.018220186233520508
generate_one_block  0.018543481826782227
generate_one_block  0.01858997344970703
generate_one_block  0.01812601089477539
generate_one_block  0.018533706665039062
generate_one_block  0.018433094024658203
generate_one_block  0.018352508544921875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04358696937561035
gen group dst list time:  0.02060103416442871
time for parepare:  0.02062678337097168
local_output_nid generation:  0.0067327022552490234
local_in_edges_tensor generation:  0.020313501358032227
mini_batch_src_global generation:  0.018039703369140625
r_  generation:  0.1637721061706543
local_output_nid generation:  0.00914764404296875
local_in_edges_tensor generation:  0.011829137802124023
mini_batch_src_global generation:  0.021252155303955078
r_  generation:  0.16565656661987305
local_output_nid generation:  0.011719226837158203
local_in_edges_tensor generation:  0.03523063659667969
mini_batch_src_global generation:  0.021320819854736328
r_  generation:  0.17886662483215332
local_output_nid generation:  0.009975194931030273
local_in_edges_tensor generation:  0.010679006576538086
mini_batch_src_global generation:  0.0208280086517334
r_  generation:  0.17745423316955566
local_output_nid generation:  0.009832382202148438
local_in_edges_tensor generation:  0.00926661491394043
mini_batch_src_global generation:  0.02194380760192871
r_  generation:  0.18024182319641113
local_output_nid generation:  0.009475231170654297
local_in_edges_tensor generation:  0.011574983596801758
mini_batch_src_global generation:  0.022131681442260742
r_  generation:  0.1783885955810547
local_output_nid generation:  0.009258031845092773
local_in_edges_tensor generation:  0.010628461837768555
mini_batch_src_global generation:  0.022055387496948242
r_  generation:  0.17758941650390625
local_output_nid generation:  0.009201765060424805
local_in_edges_tensor generation:  0.00915980339050293
mini_batch_src_global generation:  0.022354602813720703
r_  generation:  0.17968034744262695
local_output_nid generation:  0.009250402450561523
local_in_edges_tensor generation:  0.010088682174682617
mini_batch_src_global generation:  0.022706985473632812
r_  generation:  0.18020081520080566
local_output_nid generation:  0.009377717971801758
local_in_edges_tensor generation:  0.009738683700561523
mini_batch_src_global generation:  0.022867679595947266
r_  generation:  0.1771988868713379
local_output_nid generation:  0.009703636169433594
local_in_edges_tensor generation:  0.010246992111206055
mini_batch_src_global generation:  0.02250814437866211
r_  generation:  0.17882847785949707
local_output_nid generation:  0.009644746780395508
local_in_edges_tensor generation:  0.009090900421142578
mini_batch_src_global generation:  0.022737979888916016
r_  generation:  0.1819157600402832
local_output_nid generation:  0.009604930877685547
local_in_edges_tensor generation:  0.009216785430908203
mini_batch_src_global generation:  0.02272510528564453
r_  generation:  0.17778825759887695
local_output_nid generation:  0.009677648544311523
local_in_edges_tensor generation:  0.008991479873657227
mini_batch_src_global generation:  0.022485017776489258
r_  generation:  0.18060660362243652
local_output_nid generation:  0.009528875350952148
local_in_edges_tensor generation:  0.009019851684570312
mini_batch_src_global generation:  0.02388310432434082
r_  generation:  0.1772630214691162
local_output_nid generation:  0.009786128997802734
local_in_edges_tensor generation:  0.009046554565429688
mini_batch_src_global generation:  0.022638797760009766
r_  generation:  0.18022489547729492
local_output_nid generation:  0.009788274765014648
local_in_edges_tensor generation:  0.010493993759155273
mini_batch_src_global generation:  0.023977994918823242
r_  generation:  0.1840047836303711
local_output_nid generation:  0.009778976440429688
local_in_edges_tensor generation:  0.00896453857421875
mini_batch_src_global generation:  0.02283644676208496
r_  generation:  0.18478083610534668
local_output_nid generation:  0.009612083435058594
local_in_edges_tensor generation:  0.008967161178588867
mini_batch_src_global generation:  0.022730112075805664
r_  generation:  0.17955636978149414
local_output_nid generation:  0.009528875350952148
local_in_edges_tensor generation:  0.008980751037597656
mini_batch_src_global generation:  0.022942304611206055
r_  generation:  0.18370652198791504
local_output_nid generation:  0.009679079055786133
local_in_edges_tensor generation:  0.009105443954467773
mini_batch_src_global generation:  0.02536916732788086
r_  generation:  0.180419921875
local_output_nid generation:  0.00962066650390625
local_in_edges_tensor generation:  0.00979471206665039
mini_batch_src_global generation:  0.023920536041259766
r_  generation:  0.18548321723937988
local_output_nid generation:  0.009679079055786133
local_in_edges_tensor generation:  0.00968313217163086
mini_batch_src_global generation:  0.02285027503967285
r_  generation:  0.18461108207702637
local_output_nid generation:  0.009682655334472656
local_in_edges_tensor generation:  0.009128093719482422
mini_batch_src_global generation:  0.02285623550415039
r_  generation:  0.1821908950805664
local_output_nid generation:  0.00951385498046875
local_in_edges_tensor generation:  0.00964212417602539
mini_batch_src_global generation:  0.023075580596923828
r_  generation:  0.18499255180358887
local_output_nid generation:  0.009590864181518555
local_in_edges_tensor generation:  0.009775638580322266
mini_batch_src_global generation:  0.022846221923828125
r_  generation:  0.18429303169250488
local_output_nid generation:  0.009783506393432617
local_in_edges_tensor generation:  0.009664535522460938
mini_batch_src_global generation:  0.027528762817382812
r_  generation:  0.18556618690490723
local_output_nid generation:  0.010431528091430664
local_in_edges_tensor generation:  0.009813070297241211
mini_batch_src_global generation:  0.023353099822998047
r_  generation:  0.18650197982788086
local_output_nid generation:  0.009898900985717773
local_in_edges_tensor generation:  0.009464025497436523
mini_batch_src_global generation:  0.023568153381347656
r_  generation:  0.1850728988647461
local_output_nid generation:  0.01004791259765625
local_in_edges_tensor generation:  0.009033918380737305
mini_batch_src_global generation:  0.023365020751953125
r_  generation:  0.18582367897033691
local_output_nid generation:  0.009946584701538086
local_in_edges_tensor generation:  0.010500192642211914
mini_batch_src_global generation:  0.022845983505249023
r_  generation:  0.18549394607543945
local_output_nid generation:  0.009977102279663086
local_in_edges_tensor generation:  0.009339570999145508
mini_batch_src_global generation:  0.02298116683959961
r_  generation:  0.19036650657653809
----------------------check_connections_block total spend ----------------------------- 8.482621192932129
generate_one_block  0.24613261222839355
generate_one_block  0.2359309196472168
generate_one_block  0.2511632442474365
generate_one_block  0.25003981590270996
generate_one_block  0.27968692779541016
generate_one_block  0.24354100227355957
generate_one_block  0.2466421127319336
generate_one_block  0.24596691131591797
generate_one_block  0.24936938285827637
generate_one_block  0.23725080490112305
generate_one_block  0.2405409812927246
generate_one_block  0.2464745044708252
generate_one_block  0.24025559425354004
generate_one_block  0.24819183349609375
generate_one_block  0.23563766479492188
generate_one_block  0.24310946464538574
generate_one_block  0.24923944473266602
generate_one_block  0.24497699737548828
generate_one_block  0.24054622650146484
generate_one_block  0.2488412857055664
generate_one_block  0.2430727481842041
generate_one_block  0.25014472007751465
generate_one_block  0.24691462516784668
generate_one_block  0.24397659301757812
generate_one_block  0.2523186206817627
generate_one_block  0.246781587600708
generate_one_block  0.24972057342529297
generate_one_block  0.25346946716308594
generate_one_block  0.24492120742797852
generate_one_block  0.24974536895751953
generate_one_block  0.24840164184570312
generate_one_block  0.2458350658416748
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.041967153549194336
gen group dst list time:  0.10608386993408203
time for parepare:  0.018818378448486328
local_output_nid generation:  0.026054859161376953
local_in_edges_tensor generation:  0.05015230178833008
mini_batch_src_global generation:  0.04756045341491699
r_  generation:  0.4928615093231201
local_output_nid generation:  0.03174185752868652
local_in_edges_tensor generation:  0.03799700736999512
mini_batch_src_global generation:  0.05912280082702637
r_  generation:  0.48815035820007324
local_output_nid generation:  0.03183484077453613
local_in_edges_tensor generation:  0.0315401554107666
mini_batch_src_global generation:  0.05788111686706543
r_  generation:  0.5022058486938477
local_output_nid generation:  0.03233599662780762
local_in_edges_tensor generation:  0.031435489654541016
mini_batch_src_global generation:  0.058866024017333984
r_  generation:  0.4982411861419678
local_output_nid generation:  0.03194618225097656
local_in_edges_tensor generation:  0.030914306640625
mini_batch_src_global generation:  0.05828523635864258
r_  generation:  0.5040442943572998
local_output_nid generation:  0.02969503402709961
local_in_edges_tensor generation:  0.031397342681884766
mini_batch_src_global generation:  0.05879092216491699
r_  generation:  0.49767160415649414
local_output_nid generation:  0.029982566833496094
local_in_edges_tensor generation:  0.03131365776062012
mini_batch_src_global generation:  0.05991959571838379
r_  generation:  0.5011887550354004
local_output_nid generation:  0.02993631362915039
local_in_edges_tensor generation:  0.033573150634765625
mini_batch_src_global generation:  0.05984854698181152
r_  generation:  0.4971885681152344
local_output_nid generation:  0.02975010871887207
local_in_edges_tensor generation:  0.031180143356323242
mini_batch_src_global generation:  0.05861806869506836
r_  generation:  0.4999363422393799
local_output_nid generation:  0.029776811599731445
local_in_edges_tensor generation:  0.028768539428710938
mini_batch_src_global generation:  0.0599064826965332
r_  generation:  0.4914133548736572
local_output_nid generation:  0.029659271240234375
local_in_edges_tensor generation:  0.029126882553100586
mini_batch_src_global generation:  0.05817365646362305
r_  generation:  0.49942445755004883
local_output_nid generation:  0.029757022857666016
local_in_edges_tensor generation:  0.02924370765686035
mini_batch_src_global generation:  0.05956745147705078
r_  generation:  0.4929769039154053
local_output_nid generation:  0.029701948165893555
local_in_edges_tensor generation:  0.03173542022705078
mini_batch_src_global generation:  0.05820059776306152
r_  generation:  0.4980924129486084
local_output_nid generation:  0.029581546783447266
local_in_edges_tensor generation:  0.03130006790161133
mini_batch_src_global generation:  0.0593266487121582
r_  generation:  0.4936540126800537
local_output_nid generation:  0.029574155807495117
local_in_edges_tensor generation:  0.029180288314819336
mini_batch_src_global generation:  0.05758976936340332
r_  generation:  0.4975593090057373
local_output_nid generation:  0.029811859130859375
local_in_edges_tensor generation:  0.03128528594970703
mini_batch_src_global generation:  0.06148195266723633
r_  generation:  0.4959423542022705
local_output_nid generation:  0.02982926368713379
local_in_edges_tensor generation:  0.030396699905395508
mini_batch_src_global generation:  0.05870866775512695
r_  generation:  0.49788808822631836
local_output_nid generation:  0.029978036880493164
local_in_edges_tensor generation:  0.033704519271850586
mini_batch_src_global generation:  0.05956149101257324
r_  generation:  0.4980177879333496
local_output_nid generation:  0.02988433837890625
local_in_edges_tensor generation:  0.031575679779052734
mini_batch_src_global generation:  0.05819082260131836
r_  generation:  0.4963991641998291
local_output_nid generation:  0.02980637550354004
local_in_edges_tensor generation:  0.03096628189086914
mini_batch_src_global generation:  0.05938982963562012
r_  generation:  0.494966983795166
local_output_nid generation:  0.029591083526611328
local_in_edges_tensor generation:  0.031059980392456055
mini_batch_src_global generation:  0.06071281433105469
r_  generation:  0.5015583038330078
local_output_nid generation:  0.029810428619384766
local_in_edges_tensor generation:  0.03174471855163574
mini_batch_src_global generation:  0.059668540954589844
r_  generation:  0.5034999847412109
local_output_nid generation:  0.029801368713378906
local_in_edges_tensor generation:  0.038146257400512695
mini_batch_src_global generation:  0.06076359748840332
r_  generation:  0.4989182949066162
local_output_nid generation:  0.029903173446655273
local_in_edges_tensor generation:  0.029715538024902344
mini_batch_src_global generation:  0.060234785079956055
r_  generation:  0.4988112449645996
local_output_nid generation:  0.029584646224975586
local_in_edges_tensor generation:  0.031127452850341797
mini_batch_src_global generation:  0.05818510055541992
r_  generation:  0.4969673156738281
local_output_nid generation:  0.029850244522094727
local_in_edges_tensor generation:  0.029719829559326172
mini_batch_src_global generation:  0.059513092041015625
r_  generation:  0.5007193088531494
local_output_nid generation:  0.03096795082092285
local_in_edges_tensor generation:  0.030740737915039062
mini_batch_src_global generation:  0.0606837272644043
r_  generation:  0.4991326332092285
local_output_nid generation:  0.029755115509033203
local_in_edges_tensor generation:  0.02916407585144043
mini_batch_src_global generation:  0.0594029426574707
r_  generation:  0.4989023208618164
local_output_nid generation:  0.03022623062133789
local_in_edges_tensor generation:  0.030989885330200195
mini_batch_src_global generation:  0.05835866928100586
r_  generation:  0.5026166439056396
local_output_nid generation:  0.030029296875
local_in_edges_tensor generation:  0.03195071220397949
mini_batch_src_global generation:  0.05952882766723633
r_  generation:  0.49746227264404297
local_output_nid generation:  0.029662132263183594
local_in_edges_tensor generation:  0.02919745445251465
mini_batch_src_global generation:  0.06066012382507324
r_  generation:  0.5025918483734131
local_output_nid generation:  0.029925107955932617
local_in_edges_tensor generation:  0.03364992141723633
mini_batch_src_global generation:  0.0599365234375
r_  generation:  0.5005223751068115
----------------------check_connections_block total spend ----------------------------- 23.298177242279053
generate_one_block  0.6798532009124756
generate_one_block  0.6735448837280273
generate_one_block  0.6736242771148682
generate_one_block  0.6754460334777832
generate_one_block  0.7713525295257568
generate_one_block  0.6670124530792236
generate_one_block  0.6765093803405762
generate_one_block  0.6822493076324463
generate_one_block  0.6756024360656738
generate_one_block  0.667351484298706
generate_one_block  0.6738693714141846
generate_one_block  0.6746566295623779
generate_one_block  0.6810274124145508
generate_one_block  0.670264720916748
generate_one_block  0.6696760654449463
generate_one_block  0.6808960437774658
generate_one_block  0.6814651489257812
generate_one_block  0.6802961826324463
generate_one_block  0.6751775741577148
generate_one_block  0.6709980964660645
generate_one_block  0.6864931583404541
generate_one_block  0.6782152652740479
generate_one_block  0.6783103942871094
generate_one_block  0.6717584133148193
generate_one_block  0.6882383823394775
generate_one_block  0.6805109977722168
generate_one_block  0.673457145690918
generate_one_block  0.6782634258270264
generate_one_block  0.6790528297424316
generate_one_block  0.6760914325714111
generate_one_block  0.6849215030670166
generate_one_block  0.6794722080230713
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.13005685806274414  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

connection checking time:  31.78079843521118
block generation total time  29.65449833869934
average batch blocks generation time:  0.9267030730843544
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.10994768142700195  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 20.94484853744507  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.10906410217285156  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 20.373942375183105  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.11005592346191406  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 21.183088302612305  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.10947465896606445  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 21.014790534973145  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.10999298095703125  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 21.020949363708496  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.10911083221435547  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 20.765315532684326  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.10981559753417969  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 20.69769525527954  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.10954666137695312  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 20.853965282440186  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.1098794937133789  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 20.81175470352173  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.10912895202636719  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 20.46738624572754  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.10970401763916016  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 20.557799339294434  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.10920190811157227  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 20.816661834716797  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.10972023010253906  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 20.542070865631104  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.10903596878051758  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 20.667691230773926  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.10961246490478516  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 20.376870155334473  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.10937166213989258  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 20.696372509002686  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.10988903045654297  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 20.877079010009766  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.10941648483276367  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 20.814367294311523  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.10973739624023438  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 20.58932590484619  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.10909128189086914  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 20.74453592300415  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.10976409912109375  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 20.658058643341064  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.10938119888305664  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 20.960476398468018  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.10988426208496094  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 20.84204387664795  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.10935449600219727  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 20.76621150970459  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.10987281799316406  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 20.847443103790283  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.10929489135742188  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 20.803010940551758  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.10990238189697266  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 20.91396188735962  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.10911321640014648  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 20.95859718322754  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.10986614227294922  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 20.809914588928223  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.10924863815307617  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 20.981417179107666  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.10985755920410156  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 20.82573127746582  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.10943412780761719  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 20.680635929107666  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03559479862451553 |0.023488983511924744 |0.628138579428196 |9.682029485702515e-05 |1.1992963403463364 |0.006253480911254883 |
----------------------------------------------------------pseudo_mini_loss sum 1.9302000999450684
 Run 0| Epoch 7 |
Number of nodes for computation during this epoch:  9164743
Number of first layer input nodes during this epoch:  4810224
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.13228750228881836  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02570199966430664
random selection method range initialization spend 0.0066988468170166016
time for parepare:  0.023079395294189453
local_output_nid generation:  0.0016617774963378906
local_in_edges_tensor generation:  0.006163597106933594
mini_batch_src_global generation:  0.0017321109771728516
r_  generation:  0.02304530143737793
local_output_nid generation:  0.002452373504638672
local_in_edges_tensor generation:  0.0018219947814941406
mini_batch_src_global generation:  0.002606630325317383
r_  generation:  0.01285552978515625
local_output_nid generation:  0.0016608238220214844
local_in_edges_tensor generation:  0.0011298656463623047
mini_batch_src_global generation:  0.0012443065643310547
r_  generation:  0.010344982147216797
local_output_nid generation:  0.0016214847564697266
local_in_edges_tensor generation:  0.0008900165557861328
mini_batch_src_global generation:  0.0011301040649414062
r_  generation:  0.00978994369506836
local_output_nid generation:  0.0015974044799804688
local_in_edges_tensor generation:  0.0010466575622558594
mini_batch_src_global generation:  0.0012295246124267578
r_  generation:  0.009896278381347656
local_output_nid generation:  0.0015869140625
local_in_edges_tensor generation:  0.0009310245513916016
mini_batch_src_global generation:  0.0011873245239257812
r_  generation:  0.010209321975708008
local_output_nid generation:  0.0015921592712402344
local_in_edges_tensor generation:  0.0009598731994628906
mini_batch_src_global generation:  0.0011298656463623047
r_  generation:  0.010293722152709961
local_output_nid generation:  0.0016269683837890625
local_in_edges_tensor generation:  0.0010104179382324219
mini_batch_src_global generation:  0.0011439323425292969
r_  generation:  0.010164737701416016
local_output_nid generation:  0.0016095638275146484
local_in_edges_tensor generation:  0.0009510517120361328
mini_batch_src_global generation:  0.0012166500091552734
r_  generation:  0.010660409927368164
local_output_nid generation:  0.0015873908996582031
local_in_edges_tensor generation:  0.0009324550628662109
mini_batch_src_global generation:  0.0011525154113769531
r_  generation:  0.010183572769165039
local_output_nid generation:  0.0015876293182373047
local_in_edges_tensor generation:  0.0010006427764892578
mini_batch_src_global generation:  0.001177072525024414
r_  generation:  0.010724306106567383
local_output_nid generation:  0.0015959739685058594
local_in_edges_tensor generation:  0.0008862018585205078
mini_batch_src_global generation:  0.0011823177337646484
r_  generation:  0.01044154167175293
local_output_nid generation:  0.0015883445739746094
local_in_edges_tensor generation:  0.0009567737579345703
mini_batch_src_global generation:  0.0011909008026123047
r_  generation:  0.01015472412109375
local_output_nid generation:  0.0015742778778076172
local_in_edges_tensor generation:  0.0008771419525146484
mini_batch_src_global generation:  0.0011987686157226562
r_  generation:  0.010421991348266602
local_output_nid generation:  0.001592397689819336
local_in_edges_tensor generation:  0.0008916854858398438
mini_batch_src_global generation:  0.001142263412475586
r_  generation:  0.010519742965698242
local_output_nid generation:  0.0015869140625
local_in_edges_tensor generation:  0.0008671283721923828
mini_batch_src_global generation:  0.0012013912200927734
r_  generation:  0.010291814804077148
local_output_nid generation:  0.0016160011291503906
local_in_edges_tensor generation:  0.0008893013000488281
mini_batch_src_global generation:  0.0011630058288574219
r_  generation:  0.010489940643310547
local_output_nid generation:  0.0015680789947509766
local_in_edges_tensor generation:  0.0009522438049316406
mini_batch_src_global generation:  0.0012583732604980469
r_  generation:  0.01064157485961914
local_output_nid generation:  0.0015881061553955078
local_in_edges_tensor generation:  0.0008676052093505859
mini_batch_src_global generation:  0.0011599063873291016
r_  generation:  0.010707855224609375
local_output_nid generation:  0.0015926361083984375
local_in_edges_tensor generation:  0.0008919239044189453
mini_batch_src_global generation:  0.0011587142944335938
r_  generation:  0.010441780090332031
local_output_nid generation:  0.001566171646118164
local_in_edges_tensor generation:  0.0009295940399169922
mini_batch_src_global generation:  0.0011696815490722656
r_  generation:  0.010267972946166992
local_output_nid generation:  0.0015864372253417969
local_in_edges_tensor generation:  0.0008630752563476562
mini_batch_src_global generation:  0.0011441707611083984
r_  generation:  0.01038980484008789
local_output_nid generation:  0.0015752315521240234
local_in_edges_tensor generation:  0.0009355545043945312
mini_batch_src_global generation:  0.0011794567108154297
r_  generation:  0.010312795639038086
local_output_nid generation:  0.0015900135040283203
local_in_edges_tensor generation:  0.0008783340454101562
mini_batch_src_global generation:  0.0011796951293945312
r_  generation:  0.010334253311157227
local_output_nid generation:  0.0015859603881835938
local_in_edges_tensor generation:  0.0010628700256347656
mini_batch_src_global generation:  0.0013136863708496094
r_  generation:  0.01089024543762207
local_output_nid generation:  0.001585245132446289
local_in_edges_tensor generation:  0.0008859634399414062
mini_batch_src_global generation:  0.0011899471282958984
r_  generation:  0.01039886474609375
local_output_nid generation:  0.0015819072723388672
local_in_edges_tensor generation:  0.0009274482727050781
mini_batch_src_global generation:  0.0011546611785888672
r_  generation:  0.010425090789794922
local_output_nid generation:  0.001592397689819336
local_in_edges_tensor generation:  0.0008771419525146484
mini_batch_src_global generation:  0.0011553764343261719
r_  generation:  0.010181903839111328
local_output_nid generation:  0.0015740394592285156
local_in_edges_tensor generation:  0.0008749961853027344
mini_batch_src_global generation:  0.0011653900146484375
r_  generation:  0.010776281356811523
local_output_nid generation:  0.0015614032745361328
local_in_edges_tensor generation:  0.0009038448333740234
mini_batch_src_global generation:  0.0011708736419677734
r_  generation:  0.01027536392211914
local_output_nid generation:  0.0015723705291748047
local_in_edges_tensor generation:  0.0008771419525146484
mini_batch_src_global generation:  0.0012667179107666016
r_  generation:  0.010411500930786133
local_output_nid generation:  0.0015668869018554688
local_in_edges_tensor generation:  0.0008680820465087891
mini_batch_src_global generation:  0.0011475086212158203
r_  generation:  0.010223150253295898
----------------------check_connections_block total spend ----------------------------- 0.59541916847229
generate_one_block  0.024997711181640625
generate_one_block  0.021555423736572266
generate_one_block  0.019740581512451172
generate_one_block  0.018323183059692383
generate_one_block  0.018572092056274414
generate_one_block  0.018910646438598633
generate_one_block  0.018414974212646484
generate_one_block  0.018688201904296875
generate_one_block  0.01914381980895996
generate_one_block  0.018366098403930664
generate_one_block  0.018920183181762695
generate_one_block  0.018798112869262695
generate_one_block  0.01800823211669922
generate_one_block  0.01862478256225586
generate_one_block  0.01837635040283203
generate_one_block  0.018418073654174805
generate_one_block  0.018497943878173828
generate_one_block  0.018917083740234375
generate_one_block  0.018967151641845703
generate_one_block  0.01853656768798828
generate_one_block  0.018158912658691406
generate_one_block  0.018788576126098633
generate_one_block  0.018474102020263672
generate_one_block  0.018538951873779297
generate_one_block  0.01931142807006836
generate_one_block  0.01857161521911621
generate_one_block  0.018477201461791992
generate_one_block  0.018147945404052734
generate_one_block  0.018787145614624023
generate_one_block  0.018394947052001953
generate_one_block  0.01844334602355957
generate_one_block  0.018422603607177734
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03747916221618652
gen group dst list time:  0.02341747283935547
time for parepare:  0.022730350494384766
local_output_nid generation:  0.006757020950317383
local_in_edges_tensor generation:  0.018522977828979492
mini_batch_src_global generation:  0.016846895217895508
r_  generation:  0.15850353240966797
local_output_nid generation:  0.009244680404663086
local_in_edges_tensor generation:  0.012149333953857422
mini_batch_src_global generation:  0.023740530014038086
r_  generation:  0.21085500717163086
local_output_nid generation:  0.009711980819702148
local_in_edges_tensor generation:  0.03592371940612793
mini_batch_src_global generation:  0.023099899291992188
r_  generation:  0.21152210235595703
local_output_nid generation:  0.012458562850952148
local_in_edges_tensor generation:  0.01855778694152832
mini_batch_src_global generation:  0.023065567016601562
r_  generation:  0.17802858352661133
local_output_nid generation:  0.011478900909423828
local_in_edges_tensor generation:  0.011935949325561523
mini_batch_src_global generation:  0.022716045379638672
r_  generation:  0.1775217056274414
local_output_nid generation:  0.009778261184692383
local_in_edges_tensor generation:  0.010873794555664062
mini_batch_src_global generation:  0.022133827209472656
r_  generation:  0.17979669570922852
local_output_nid generation:  0.00933527946472168
local_in_edges_tensor generation:  0.013828039169311523
mini_batch_src_global generation:  0.022630691528320312
r_  generation:  0.17748737335205078
local_output_nid generation:  0.009368419647216797
local_in_edges_tensor generation:  0.010569334030151367
mini_batch_src_global generation:  0.023856163024902344
r_  generation:  0.18528008460998535
local_output_nid generation:  0.009817123413085938
local_in_edges_tensor generation:  0.012333154678344727
mini_batch_src_global generation:  0.023131370544433594
r_  generation:  0.1840806007385254
local_output_nid generation:  0.009673833847045898
local_in_edges_tensor generation:  0.009260416030883789
mini_batch_src_global generation:  0.022814035415649414
r_  generation:  0.18805742263793945
local_output_nid generation:  0.01210474967956543
local_in_edges_tensor generation:  0.009052515029907227
mini_batch_src_global generation:  0.02352595329284668
r_  generation:  0.19417881965637207
local_output_nid generation:  0.011986732482910156
local_in_edges_tensor generation:  0.00959324836730957
mini_batch_src_global generation:  0.023367881774902344
r_  generation:  0.17990446090698242
local_output_nid generation:  0.010322809219360352
local_in_edges_tensor generation:  0.00945281982421875
mini_batch_src_global generation:  0.023199796676635742
r_  generation:  0.17577242851257324
local_output_nid generation:  0.010263681411743164
local_in_edges_tensor generation:  0.009557723999023438
mini_batch_src_global generation:  0.023526906967163086
r_  generation:  0.18643498420715332
local_output_nid generation:  0.010158300399780273
local_in_edges_tensor generation:  0.009093523025512695
mini_batch_src_global generation:  0.022884130477905273
r_  generation:  0.1832287311553955
local_output_nid generation:  0.010058403015136719
local_in_edges_tensor generation:  0.009409189224243164
mini_batch_src_global generation:  0.024677515029907227
r_  generation:  0.18779635429382324
local_output_nid generation:  0.009943008422851562
local_in_edges_tensor generation:  0.009686470031738281
mini_batch_src_global generation:  0.02299809455871582
r_  generation:  0.18733835220336914
local_output_nid generation:  0.010012388229370117
local_in_edges_tensor generation:  0.010712623596191406
mini_batch_src_global generation:  0.02694106101989746
r_  generation:  0.18775248527526855
local_output_nid generation:  0.010140180587768555
local_in_edges_tensor generation:  0.009816169738769531
mini_batch_src_global generation:  0.023737430572509766
r_  generation:  0.18754291534423828
local_output_nid generation:  0.009853839874267578
local_in_edges_tensor generation:  0.009154319763183594
mini_batch_src_global generation:  0.023264408111572266
r_  generation:  0.18170833587646484
local_output_nid generation:  0.009764909744262695
local_in_edges_tensor generation:  0.009747982025146484
mini_batch_src_global generation:  0.022881507873535156
r_  generation:  0.1790754795074463
local_output_nid generation:  0.009962320327758789
local_in_edges_tensor generation:  0.009276866912841797
mini_batch_src_global generation:  0.02298569679260254
r_  generation:  0.18278193473815918
local_output_nid generation:  0.009904623031616211
local_in_edges_tensor generation:  0.009594917297363281
mini_batch_src_global generation:  0.023180723190307617
r_  generation:  0.17693424224853516
local_output_nid generation:  0.009882211685180664
local_in_edges_tensor generation:  0.009222269058227539
mini_batch_src_global generation:  0.02335381507873535
r_  generation:  0.18946218490600586
local_output_nid generation:  0.010178327560424805
local_in_edges_tensor generation:  0.010833263397216797
mini_batch_src_global generation:  0.024358510971069336
r_  generation:  0.1918032169342041
local_output_nid generation:  0.01064443588256836
local_in_edges_tensor generation:  0.010858774185180664
mini_batch_src_global generation:  0.023859024047851562
r_  generation:  0.18883895874023438
local_output_nid generation:  0.009648323059082031
local_in_edges_tensor generation:  0.010704994201660156
mini_batch_src_global generation:  0.022762298583984375
r_  generation:  0.18696856498718262
local_output_nid generation:  0.012312889099121094
local_in_edges_tensor generation:  0.011192798614501953
mini_batch_src_global generation:  0.02327442169189453
r_  generation:  0.18421673774719238
local_output_nid generation:  0.010128498077392578
local_in_edges_tensor generation:  0.010147809982299805
mini_batch_src_global generation:  0.023444652557373047
r_  generation:  0.19919395446777344
local_output_nid generation:  0.010014533996582031
local_in_edges_tensor generation:  0.010486602783203125
mini_batch_src_global generation:  0.02341628074645996
r_  generation:  0.18756604194641113
local_output_nid generation:  0.009882926940917969
local_in_edges_tensor generation:  0.012758970260620117
mini_batch_src_global generation:  0.024107694625854492
r_  generation:  0.1839921474456787
local_output_nid generation:  0.009886503219604492
local_in_edges_tensor generation:  0.009379148483276367
mini_batch_src_global generation:  0.023537397384643555
r_  generation:  0.18241071701049805
----------------------check_connections_block total spend ----------------------------- 8.733195304870605
generate_one_block  0.2561662197113037
generate_one_block  0.24282121658325195
generate_one_block  0.25271177291870117
generate_one_block  0.23767781257629395
generate_one_block  0.27748894691467285
generate_one_block  0.2535076141357422
generate_one_block  0.23981070518493652
generate_one_block  0.2524294853210449
generate_one_block  0.2555663585662842
generate_one_block  0.24552559852600098
generate_one_block  0.25145959854125977
generate_one_block  0.24399614334106445
generate_one_block  0.24161434173583984
generate_one_block  0.2563929557800293
generate_one_block  0.2591216564178467
generate_one_block  0.2553999423980713
generate_one_block  0.2525968551635742
generate_one_block  0.2577066421508789
generate_one_block  0.2592189311981201
generate_one_block  0.3737332820892334
generate_one_block  0.24126195907592773
generate_one_block  0.2463524341583252
generate_one_block  0.2382807731628418
generate_one_block  0.24982619285583496
generate_one_block  0.2600741386413574
generate_one_block  0.2503182888031006
generate_one_block  0.24824833869934082
generate_one_block  0.23986291885375977
generate_one_block  0.2687718868255615
generate_one_block  0.2547640800476074
generate_one_block  0.25279927253723145
generate_one_block  0.24717164039611816
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04148578643798828
gen group dst list time:  0.11177515983581543
time for parepare:  0.019527196884155273
local_output_nid generation:  0.02688908576965332
local_in_edges_tensor generation:  0.05330324172973633
mini_batch_src_global generation:  0.04658007621765137
r_  generation:  0.4935574531555176
local_output_nid generation:  0.03200507164001465
local_in_edges_tensor generation:  0.03843283653259277
mini_batch_src_global generation:  0.060526371002197266
r_  generation:  0.5074257850646973
local_output_nid generation:  0.0341033935546875
local_in_edges_tensor generation:  0.04056525230407715
mini_batch_src_global generation:  0.06260395050048828
r_  generation:  0.5008635520935059
local_output_nid generation:  0.03310561180114746
local_in_edges_tensor generation:  0.036078691482543945
mini_batch_src_global generation:  0.05748891830444336
r_  generation:  0.48728489875793457
local_output_nid generation:  0.03263497352600098
local_in_edges_tensor generation:  0.029854297637939453
mini_batch_src_global generation:  0.057659149169921875
r_  generation:  0.4976620674133301
local_output_nid generation:  0.031013011932373047
local_in_edges_tensor generation:  0.035987138748168945
mini_batch_src_global generation:  0.05879497528076172
r_  generation:  0.49416470527648926
local_output_nid generation:  0.03023505210876465
local_in_edges_tensor generation:  0.030617952346801758
mini_batch_src_global generation:  0.0596470832824707
r_  generation:  0.504523754119873
local_output_nid generation:  0.030302762985229492
local_in_edges_tensor generation:  0.030153274536132812
mini_batch_src_global generation:  0.05895233154296875
r_  generation:  0.49300217628479004
local_output_nid generation:  0.03132343292236328
local_in_edges_tensor generation:  0.038262128829956055
mini_batch_src_global generation:  0.06038022041320801
r_  generation:  0.5026540756225586
local_output_nid generation:  0.03040289878845215
local_in_edges_tensor generation:  0.029843807220458984
mini_batch_src_global generation:  0.05904531478881836
r_  generation:  0.49526000022888184
local_output_nid generation:  0.030623435974121094
local_in_edges_tensor generation:  0.030292749404907227
mini_batch_src_global generation:  0.05804276466369629
r_  generation:  0.500861406326294
local_output_nid generation:  0.03130483627319336
local_in_edges_tensor generation:  0.029740571975708008
mini_batch_src_global generation:  0.058522939682006836
r_  generation:  0.4941377639770508
local_output_nid generation:  0.030244112014770508
local_in_edges_tensor generation:  0.030864477157592773
mini_batch_src_global generation:  0.0575864315032959
r_  generation:  0.4999668598175049
local_output_nid generation:  0.030249357223510742
local_in_edges_tensor generation:  0.029573440551757812
mini_batch_src_global generation:  0.06006932258605957
r_  generation:  0.49776196479797363
local_output_nid generation:  0.030303239822387695
local_in_edges_tensor generation:  0.029327392578125
mini_batch_src_global generation:  0.06152510643005371
r_  generation:  0.5043292045593262
local_output_nid generation:  0.030469179153442383
local_in_edges_tensor generation:  0.03101944923400879
mini_batch_src_global generation:  0.06111931800842285
r_  generation:  0.4981696605682373
local_output_nid generation:  0.0306546688079834
local_in_edges_tensor generation:  0.03386831283569336
mini_batch_src_global generation:  0.05863761901855469
r_  generation:  0.5031185150146484
local_output_nid generation:  0.031080007553100586
local_in_edges_tensor generation:  0.031194210052490234
mini_batch_src_global generation:  0.06297874450683594
r_  generation:  0.496523380279541
local_output_nid generation:  0.030681610107421875
local_in_edges_tensor generation:  0.031564950942993164
mini_batch_src_global generation:  0.058890581130981445
r_  generation:  0.4997565746307373
local_output_nid generation:  0.03072047233581543
local_in_edges_tensor generation:  0.03237581253051758
mini_batch_src_global generation:  0.05941581726074219
r_  generation:  0.49481797218322754
local_output_nid generation:  0.030483007431030273
local_in_edges_tensor generation:  0.029409170150756836
mini_batch_src_global generation:  0.05913567543029785
r_  generation:  0.4965963363647461
local_output_nid generation:  0.030657052993774414
local_in_edges_tensor generation:  0.03338789939880371
mini_batch_src_global generation:  0.059685707092285156
r_  generation:  0.49698615074157715
local_output_nid generation:  0.030698776245117188
local_in_edges_tensor generation:  0.033030033111572266
mini_batch_src_global generation:  0.0584111213684082
r_  generation:  0.49805784225463867
local_output_nid generation:  0.031084775924682617
local_in_edges_tensor generation:  0.03374052047729492
mini_batch_src_global generation:  0.062383413314819336
r_  generation:  0.5024073123931885
local_output_nid generation:  0.031610965728759766
local_in_edges_tensor generation:  0.033301591873168945
mini_batch_src_global generation:  0.059305667877197266
r_  generation:  0.5061964988708496
local_output_nid generation:  0.03046274185180664
local_in_edges_tensor generation:  0.030447959899902344
mini_batch_src_global generation:  0.06018853187561035
r_  generation:  0.5054645538330078
local_output_nid generation:  0.03053593635559082
local_in_edges_tensor generation:  0.031609535217285156
mini_batch_src_global generation:  0.058709144592285156
r_  generation:  0.5121917724609375
local_output_nid generation:  0.030338048934936523
local_in_edges_tensor generation:  0.03829002380371094
mini_batch_src_global generation:  0.06359553337097168
r_  generation:  0.4990837574005127
local_output_nid generation:  0.03180241584777832
local_in_edges_tensor generation:  0.032970428466796875
mini_batch_src_global generation:  0.061307430267333984
r_  generation:  0.4993741512298584
local_output_nid generation:  0.030757427215576172
local_in_edges_tensor generation:  0.03260231018066406
mini_batch_src_global generation:  0.05971336364746094
r_  generation:  0.4979133605957031
local_output_nid generation:  0.031075716018676758
local_in_edges_tensor generation:  0.030637264251708984
mini_batch_src_global generation:  0.05895829200744629
r_  generation:  0.5020732879638672
local_output_nid generation:  0.030611515045166016
local_in_edges_tensor generation:  0.030899524688720703
mini_batch_src_global generation:  0.05975484848022461
r_  generation:  0.4967663288116455
----------------------check_connections_block total spend ----------------------------- 23.419196844100952
generate_one_block  0.8014981746673584
generate_one_block  0.6808874607086182
generate_one_block  0.678964376449585
generate_one_block  0.6674294471740723
generate_one_block  0.7001879215240479
generate_one_block  0.688997745513916
generate_one_block  0.6758997440338135
generate_one_block  0.6792769432067871
generate_one_block  0.6892523765563965
generate_one_block  0.6834783554077148
generate_one_block  0.6991028785705566
generate_one_block  0.6800632476806641
generate_one_block  0.6744935512542725
generate_one_block  0.6768887042999268
generate_one_block  0.6810317039489746
generate_one_block  0.68255615234375
generate_one_block  0.6734316349029541
generate_one_block  0.6854004859924316
generate_one_block  0.6910760402679443
generate_one_block  0.6795854568481445
generate_one_block  0.6768016815185547
generate_one_block  0.6769101619720459
generate_one_block  0.6742229461669922
generate_one_block  0.6907126903533936
generate_one_block  0.6947319507598877
generate_one_block  0.6824183464050293
generate_one_block  0.6874451637268066
generate_one_block  0.679938793182373
generate_one_block  0.6722879409790039
generate_one_block  0.6841282844543457
generate_one_block  0.6797478199005127
generate_one_block  0.7026569843292236
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.13228750228881836  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

connection checking time:  32.15239214897156
block generation total time  30.134183168411255
average batch blocks generation time:  0.9416932240128517
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.10955667495727539  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 20.28191566467285  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.10908889770507812  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 20.710361003875732  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.10994148254394531  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 20.941722869873047  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.10881948471069336  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 20.345977783203125  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.10981082916259766  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 20.68772554397583  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.10902166366577148  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 20.841182708740234  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.10965538024902344  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 20.483142375946045  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.10929250717163086  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 21.04313039779663  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.11007213592529297  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 21.168808937072754  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.10900640487670898  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 20.703015327453613  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.10998153686523438  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 21.0020112991333  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.10927152633666992  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 20.70811128616333  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.10963153839111328  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 20.392677783966064  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.10920381546020508  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 20.936068058013916  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.1097869873046875  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 20.654168605804443  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 0.10944128036499023  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 20.88795518875122  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5115966796875 GB
    Memory Allocated: 0.10987186431884766  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 20.854949474334717  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8182373046875 GB
    Memory Allocated: 0.10909605026245117  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9627685546875 GB
    Memory Allocated: 21.092633724212646  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9647216796875 GB
    Memory Allocated: 0.11006355285644531  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 21.162456035614014  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.10921049118041992  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 20.67827844619751  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.10971260070800781  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 20.555794715881348  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.10916757583618164  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 20.77671241760254  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.10964584350585938  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 20.43851089477539  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.10928964614868164  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 20.919307708740234  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.11008644104003906  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 21.239900588989258  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.1092076301574707  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 20.80635643005371  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.10982131958007812  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 20.752371311187744  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.10884237289428711  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 20.376872062683105  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.10993194580078125  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 20.950905323028564  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.1091923713684082  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 20.79329538345337  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.10988521575927734  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 20.874796390533447  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.10903501510620117  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 20.720825672149658  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.029090672731399536 |0.02337389439344406 |0.6288632452487946 |9.563565254211426e-05 |1.2018253952264786 |0.00792551040649414 |
----------------------------------------------------------pseudo_mini_loss sum 1.8512283563613892
 Run 0| Epoch 8 |
Number of nodes for computation during this epoch:  9156107
Number of first layer input nodes during this epoch:  4806239
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.13141298294067383  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025382041931152344
random selection method range initialization spend 0.007328033447265625
time for parepare:  0.02175450325012207
local_output_nid generation:  0.0014278888702392578
local_in_edges_tensor generation:  0.006306648254394531
mini_batch_src_global generation:  0.001977205276489258
r_  generation:  0.010607719421386719
local_output_nid generation:  0.0017809867858886719
local_in_edges_tensor generation:  0.0010700225830078125
mini_batch_src_global generation:  0.0015435218811035156
r_  generation:  0.010816812515258789
local_output_nid generation:  0.0016813278198242188
local_in_edges_tensor generation:  0.0009546279907226562
mini_batch_src_global generation:  0.0012469291687011719
r_  generation:  0.00984811782836914
local_output_nid generation:  0.0016472339630126953
local_in_edges_tensor generation:  0.000942230224609375
mini_batch_src_global generation:  0.0011391639709472656
r_  generation:  0.010128498077392578
local_output_nid generation:  0.0015993118286132812
local_in_edges_tensor generation:  0.0009014606475830078
mini_batch_src_global generation:  0.001127481460571289
r_  generation:  0.009859561920166016
local_output_nid generation:  0.0016086101531982422
local_in_edges_tensor generation:  0.0008950233459472656
mini_batch_src_global generation:  0.0011086463928222656
r_  generation:  0.01029658317565918
local_output_nid generation:  0.001608133316040039
local_in_edges_tensor generation:  0.0008969306945800781
mini_batch_src_global generation:  0.0011637210845947266
r_  generation:  0.009869575500488281
local_output_nid generation:  0.0016055107116699219
local_in_edges_tensor generation:  0.0008804798126220703
mini_batch_src_global generation:  0.0010669231414794922
r_  generation:  0.009740591049194336
local_output_nid generation:  0.0015935897827148438
local_in_edges_tensor generation:  0.0008807182312011719
mini_batch_src_global generation:  0.0011072158813476562
r_  generation:  0.010405302047729492
local_output_nid generation:  0.0015838146209716797
local_in_edges_tensor generation:  0.0008869171142578125
mini_batch_src_global generation:  0.0011072158813476562
r_  generation:  0.012342453002929688
local_output_nid generation:  0.0016100406646728516
local_in_edges_tensor generation:  0.0009059906005859375
mini_batch_src_global generation:  0.0013341903686523438
r_  generation:  0.010061264038085938
local_output_nid generation:  0.0016047954559326172
local_in_edges_tensor generation:  0.0008859634399414062
mini_batch_src_global generation:  0.0011527538299560547
r_  generation:  0.010160207748413086
local_output_nid generation:  0.001600027084350586
local_in_edges_tensor generation:  0.0009014606475830078
mini_batch_src_global generation:  0.00112152099609375
r_  generation:  0.010395526885986328
local_output_nid generation:  0.0015933513641357422
local_in_edges_tensor generation:  0.0008859634399414062
mini_batch_src_global generation:  0.0011484622955322266
r_  generation:  0.010477781295776367
local_output_nid generation:  0.0015897750854492188
local_in_edges_tensor generation:  0.0009095668792724609
mini_batch_src_global generation:  0.0011429786682128906
r_  generation:  0.01040792465209961
local_output_nid generation:  0.0016131401062011719
local_in_edges_tensor generation:  0.0008733272552490234
mini_batch_src_global generation:  0.0011129379272460938
r_  generation:  0.010250568389892578
local_output_nid generation:  0.001605987548828125
local_in_edges_tensor generation:  0.0008985996246337891
mini_batch_src_global generation:  0.0011050701141357422
r_  generation:  0.010282754898071289
local_output_nid generation:  0.0016019344329833984
local_in_edges_tensor generation:  0.000896453857421875
mini_batch_src_global generation:  0.0012140274047851562
r_  generation:  0.010591745376586914
local_output_nid generation:  0.0016074180603027344
local_in_edges_tensor generation:  0.0008783340454101562
mini_batch_src_global generation:  0.0011203289031982422
r_  generation:  0.010382652282714844
local_output_nid generation:  0.001583099365234375
local_in_edges_tensor generation:  0.000888824462890625
mini_batch_src_global generation:  0.0011138916015625
r_  generation:  0.010262489318847656
local_output_nid generation:  0.0015909671783447266
local_in_edges_tensor generation:  0.0008783340454101562
mini_batch_src_global generation:  0.0011665821075439453
r_  generation:  0.010476827621459961
local_output_nid generation:  0.0015881061553955078
local_in_edges_tensor generation:  0.0008993148803710938
mini_batch_src_global generation:  0.0011675357818603516
r_  generation:  0.010805606842041016
local_output_nid generation:  0.0015964508056640625
local_in_edges_tensor generation:  0.0008680820465087891
mini_batch_src_global generation:  0.0012006759643554688
r_  generation:  0.010749340057373047
local_output_nid generation:  0.0015881061553955078
local_in_edges_tensor generation:  0.0009074211120605469
mini_batch_src_global generation:  0.0011150836944580078
r_  generation:  0.010331392288208008
local_output_nid generation:  0.0016095638275146484
local_in_edges_tensor generation:  0.0008814334869384766
mini_batch_src_global generation:  0.0011293888092041016
r_  generation:  0.010530948638916016
local_output_nid generation:  0.0015990734100341797
local_in_edges_tensor generation:  0.0008711814880371094
mini_batch_src_global generation:  0.0010981559753417969
r_  generation:  0.009973287582397461
local_output_nid generation:  0.0015947818756103516
local_in_edges_tensor generation:  0.0008580684661865234
mini_batch_src_global generation:  0.0011429786682128906
r_  generation:  0.010409355163574219
local_output_nid generation:  0.0016028881072998047
local_in_edges_tensor generation:  0.0008864402770996094
mini_batch_src_global generation:  0.001135110855102539
r_  generation:  0.010237693786621094
local_output_nid generation:  0.0015938282012939453
local_in_edges_tensor generation:  0.0008938312530517578
mini_batch_src_global generation:  0.0011146068572998047
r_  generation:  0.010131597518920898
local_output_nid generation:  0.0015897750854492188
local_in_edges_tensor generation:  0.0008862018585205078
mini_batch_src_global generation:  0.0010857582092285156
r_  generation:  0.010016441345214844
local_output_nid generation:  0.00157928466796875
local_in_edges_tensor generation:  0.0008707046508789062
mini_batch_src_global generation:  0.00110626220703125
r_  generation:  0.010335206985473633
local_output_nid generation:  0.0015971660614013672
local_in_edges_tensor generation:  0.0008885860443115234
mini_batch_src_global generation:  0.0011646747589111328
r_  generation:  0.010639429092407227
----------------------check_connections_block total spend ----------------------------- 0.5705478191375732
generate_one_block  0.024973630905151367
generate_one_block  0.021525144577026367
generate_one_block  0.01915884017944336
generate_one_block  0.019115924835205078
generate_one_block  0.01839923858642578
generate_one_block  0.01884770393371582
generate_one_block  0.017919540405273438
generate_one_block  0.017748355865478516
generate_one_block  0.018767118453979492
generate_one_block  0.018471240997314453
generate_one_block  0.0180051326751709
generate_one_block  0.01841282844543457
generate_one_block  0.018384695053100586
generate_one_block  0.018671274185180664
generate_one_block  0.018629074096679688
generate_one_block  0.01832127571105957
generate_one_block  0.018329858779907227
generate_one_block  0.018852710723876953
generate_one_block  0.01841139793395996
generate_one_block  0.018283367156982422
generate_one_block  0.01873922348022461
generate_one_block  0.019222259521484375
generate_one_block  0.022239208221435547
generate_one_block  0.019370317459106445
generate_one_block  0.018863916397094727
generate_one_block  0.01782703399658203
generate_one_block  0.01862788200378418
generate_one_block  0.018149375915527344
generate_one_block  0.018297910690307617
generate_one_block  0.017879724502563477
generate_one_block  0.018680810928344727
generate_one_block  0.019196271896362305
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03901076316833496
gen group dst list time:  0.022180795669555664
time for parepare:  0.020769119262695312
local_output_nid generation:  0.0064885616302490234
local_in_edges_tensor generation:  0.01810479164123535
mini_batch_src_global generation:  0.016696691513061523
r_  generation:  0.15837502479553223
local_output_nid generation:  0.009560585021972656
local_in_edges_tensor generation:  0.011974811553955078
mini_batch_src_global generation:  0.021285295486450195
r_  generation:  0.19818496704101562
local_output_nid generation:  0.01596236228942871
local_in_edges_tensor generation:  0.05083775520324707
mini_batch_src_global generation:  0.02275848388671875
r_  generation:  0.19104313850402832
local_output_nid generation:  0.017552852630615234
local_in_edges_tensor generation:  0.021317005157470703
mini_batch_src_global generation:  0.027741432189941406
r_  generation:  0.1781017780303955
local_output_nid generation:  0.01347494125366211
local_in_edges_tensor generation:  0.009734392166137695
mini_batch_src_global generation:  0.024291515350341797
r_  generation:  0.17705130577087402
local_output_nid generation:  0.01064443588256836
local_in_edges_tensor generation:  0.011738300323486328
mini_batch_src_global generation:  0.022482633590698242
r_  generation:  0.18058061599731445
local_output_nid generation:  0.009549856185913086
local_in_edges_tensor generation:  0.008808374404907227
mini_batch_src_global generation:  0.021795034408569336
r_  generation:  0.17557191848754883
local_output_nid generation:  0.009196758270263672
local_in_edges_tensor generation:  0.009526968002319336
mini_batch_src_global generation:  0.02154397964477539
r_  generation:  0.17361855506896973
local_output_nid generation:  0.00948190689086914
local_in_edges_tensor generation:  0.010719060897827148
mini_batch_src_global generation:  0.023873090744018555
r_  generation:  0.18513083457946777
local_output_nid generation:  0.011298179626464844
local_in_edges_tensor generation:  0.010038375854492188
mini_batch_src_global generation:  0.034934043884277344
r_  generation:  0.23650264739990234
local_output_nid generation:  0.013385772705078125
local_in_edges_tensor generation:  0.009743928909301758
mini_batch_src_global generation:  0.024001121520996094
r_  generation:  0.1824321746826172
local_output_nid generation:  0.010187625885009766
local_in_edges_tensor generation:  0.009324073791503906
mini_batch_src_global generation:  0.02234649658203125
r_  generation:  0.1779191493988037
local_output_nid generation:  0.010341167449951172
local_in_edges_tensor generation:  0.010582208633422852
mini_batch_src_global generation:  0.022738218307495117
r_  generation:  0.18141937255859375
local_output_nid generation:  0.010340452194213867
local_in_edges_tensor generation:  0.010747432708740234
mini_batch_src_global generation:  0.024003267288208008
r_  generation:  0.1825394630432129
local_output_nid generation:  0.010439395904541016
local_in_edges_tensor generation:  0.010260343551635742
mini_batch_src_global generation:  0.024417877197265625
r_  generation:  0.186234712600708
local_output_nid generation:  0.010215044021606445
local_in_edges_tensor generation:  0.008906841278076172
mini_batch_src_global generation:  0.023707151412963867
r_  generation:  0.1808149814605713
local_output_nid generation:  0.01016378402709961
local_in_edges_tensor generation:  0.008805274963378906
mini_batch_src_global generation:  0.022784948348999023
r_  generation:  0.18009448051452637
local_output_nid generation:  0.010511159896850586
local_in_edges_tensor generation:  0.009195804595947266
mini_batch_src_global generation:  0.024621963500976562
r_  generation:  0.18620800971984863
local_output_nid generation:  0.010295629501342773
local_in_edges_tensor generation:  0.009350061416625977
mini_batch_src_global generation:  0.023299217224121094
r_  generation:  0.1832888126373291
local_output_nid generation:  0.010248184204101562
local_in_edges_tensor generation:  0.009190797805786133
mini_batch_src_global generation:  0.023606538772583008
r_  generation:  0.18730807304382324
local_output_nid generation:  0.010354042053222656
local_in_edges_tensor generation:  0.011139392852783203
mini_batch_src_global generation:  0.027626991271972656
r_  generation:  0.18733453750610352
local_output_nid generation:  0.010628223419189453
local_in_edges_tensor generation:  0.011787652969360352
mini_batch_src_global generation:  0.02539539337158203
r_  generation:  0.19114184379577637
local_output_nid generation:  0.01053929328918457
local_in_edges_tensor generation:  0.00902247428894043
mini_batch_src_global generation:  0.02445673942565918
r_  generation:  0.19414281845092773
local_output_nid generation:  0.010118961334228516
local_in_edges_tensor generation:  0.009126663208007812
mini_batch_src_global generation:  0.034392595291137695
r_  generation:  0.2078876495361328
local_output_nid generation:  0.014412164688110352
local_in_edges_tensor generation:  0.009864091873168945
mini_batch_src_global generation:  0.029994487762451172
r_  generation:  0.18707847595214844
local_output_nid generation:  0.010025739669799805
local_in_edges_tensor generation:  0.008750438690185547
mini_batch_src_global generation:  0.022422313690185547
r_  generation:  0.17997050285339355
local_output_nid generation:  0.010234594345092773
local_in_edges_tensor generation:  0.009329795837402344
mini_batch_src_global generation:  0.030013084411621094
r_  generation:  0.19154667854309082
local_output_nid generation:  0.009804487228393555
local_in_edges_tensor generation:  0.009026288986206055
mini_batch_src_global generation:  0.025823593139648438
r_  generation:  0.18416738510131836
local_output_nid generation:  0.00986170768737793
local_in_edges_tensor generation:  0.009319067001342773
mini_batch_src_global generation:  0.024429798126220703
r_  generation:  0.18631339073181152
local_output_nid generation:  0.010028362274169922
local_in_edges_tensor generation:  0.008779764175415039
mini_batch_src_global generation:  0.02257561683654785
r_  generation:  0.18403053283691406
local_output_nid generation:  0.010304689407348633
local_in_edges_tensor generation:  0.009011983871459961
mini_batch_src_global generation:  0.02351856231689453
r_  generation:  0.18682169914245605
local_output_nid generation:  0.010430574417114258
local_in_edges_tensor generation:  0.009921550750732422
mini_batch_src_global generation:  0.02727794647216797
r_  generation:  0.18613266944885254
----------------------check_connections_block total spend ----------------------------- 8.813021898269653
generate_one_block  0.24575138092041016
generate_one_block  0.24095726013183594
generate_one_block  0.2395625114440918
generate_one_block  0.24515938758850098
generate_one_block  0.2647101879119873
generate_one_block  0.2572777271270752
generate_one_block  0.24245142936706543
generate_one_block  0.24492311477661133
generate_one_block  0.26693248748779297
generate_one_block  0.25291967391967773
generate_one_block  0.24518179893493652
generate_one_block  0.24542856216430664
generate_one_block  0.2536928653717041
generate_one_block  0.25100111961364746
generate_one_block  0.25597453117370605
generate_one_block  0.24347996711730957
generate_one_block  0.24112272262573242
generate_one_block  0.25383758544921875
generate_one_block  0.24541163444519043
generate_one_block  0.25608253479003906
generate_one_block  0.2542893886566162
generate_one_block  0.2785022258758545
generate_one_block  0.26478004455566406
generate_one_block  0.251568078994751
generate_one_block  0.27040719985961914
generate_one_block  0.24353456497192383
generate_one_block  0.2530508041381836
generate_one_block  0.25852322578430176
generate_one_block  0.2558436393737793
generate_one_block  0.24703049659729004
generate_one_block  0.2543976306915283
generate_one_block  0.2552063465118408
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.039284467697143555
gen group dst list time:  0.11732673645019531
time for parepare:  0.020592689514160156
local_output_nid generation:  0.026592731475830078
local_in_edges_tensor generation:  0.054241180419921875
mini_batch_src_global generation:  0.04629659652709961
r_  generation:  0.48479652404785156
local_output_nid generation:  0.03159165382385254
local_in_edges_tensor generation:  0.03768801689147949
mini_batch_src_global generation:  0.058524370193481445
r_  generation:  0.509732723236084
local_output_nid generation:  0.034630775451660156
local_in_edges_tensor generation:  0.033463239669799805
mini_batch_src_global generation:  0.06322741508483887
r_  generation:  0.49413084983825684
local_output_nid generation:  0.032503366470336914
local_in_edges_tensor generation:  0.03120732307434082
mini_batch_src_global generation:  0.058159589767456055
r_  generation:  0.489764928817749
local_output_nid generation:  0.03258204460144043
local_in_edges_tensor generation:  0.03179526329040527
mini_batch_src_global generation:  0.058038949966430664
r_  generation:  0.500328540802002
local_output_nid generation:  0.0337071418762207
local_in_edges_tensor generation:  0.031304359436035156
mini_batch_src_global generation:  0.05936694145202637
r_  generation:  0.5102839469909668
local_output_nid generation:  0.030586719512939453
local_in_edges_tensor generation:  0.03101062774658203
mini_batch_src_global generation:  0.060727596282958984
r_  generation:  0.5012633800506592
local_output_nid generation:  0.0333096981048584
local_in_edges_tensor generation:  0.03091740608215332
mini_batch_src_global generation:  0.0589451789855957
r_  generation:  0.49390244483947754
local_output_nid generation:  0.030837059020996094
local_in_edges_tensor generation:  0.037123918533325195
mini_batch_src_global generation:  0.06027674674987793
r_  generation:  0.5065553188323975
local_output_nid generation:  0.03294730186462402
local_in_edges_tensor generation:  0.032074928283691406
mini_batch_src_global generation:  0.05966639518737793
r_  generation:  0.4994349479675293
local_output_nid generation:  0.030730247497558594
local_in_edges_tensor generation:  0.03105473518371582
mini_batch_src_global generation:  0.06036543846130371
r_  generation:  0.5026769638061523
local_output_nid generation:  0.030408620834350586
local_in_edges_tensor generation:  0.031177043914794922
mini_batch_src_global generation:  0.05895566940307617
r_  generation:  0.5061652660369873
local_output_nid generation:  0.030665874481201172
local_in_edges_tensor generation:  0.03340506553649902
mini_batch_src_global generation:  0.06278061866760254
r_  generation:  0.5076990127563477
local_output_nid generation:  0.03199481964111328
local_in_edges_tensor generation:  0.03142142295837402
mini_batch_src_global generation:  0.05915379524230957
r_  generation:  0.49540162086486816
local_output_nid generation:  0.031101226806640625
local_in_edges_tensor generation:  0.03275012969970703
mini_batch_src_global generation:  0.05901980400085449
r_  generation:  0.5034298896789551
local_output_nid generation:  0.030631542205810547
local_in_edges_tensor generation:  0.033501625061035156
mini_batch_src_global generation:  0.05989980697631836
r_  generation:  0.5060739517211914
local_output_nid generation:  0.030602693557739258
local_in_edges_tensor generation:  0.028847932815551758
mini_batch_src_global generation:  0.05892825126647949
r_  generation:  0.4995846748352051
local_output_nid generation:  0.030754566192626953
local_in_edges_tensor generation:  0.03431415557861328
mini_batch_src_global generation:  0.06259322166442871
r_  generation:  0.5015654563903809
local_output_nid generation:  0.0309145450592041
local_in_edges_tensor generation:  0.031185626983642578
mini_batch_src_global generation:  0.057881832122802734
r_  generation:  0.5000052452087402
local_output_nid generation:  0.03062272071838379
local_in_edges_tensor generation:  0.031148910522460938
mini_batch_src_global generation:  0.059206247329711914
r_  generation:  0.49631690979003906
local_output_nid generation:  0.031740427017211914
local_in_edges_tensor generation:  0.03162574768066406
mini_batch_src_global generation:  0.058571577072143555
r_  generation:  0.4998815059661865
local_output_nid generation:  0.031003952026367188
local_in_edges_tensor generation:  0.0310518741607666
mini_batch_src_global generation:  0.05942559242248535
r_  generation:  0.49837660789489746
local_output_nid generation:  0.03114604949951172
local_in_edges_tensor generation:  0.03110671043395996
mini_batch_src_global generation:  0.0587308406829834
r_  generation:  0.5059616565704346
local_output_nid generation:  0.030663728713989258
local_in_edges_tensor generation:  0.03127241134643555
mini_batch_src_global generation:  0.05924797058105469
r_  generation:  0.4963257312774658
local_output_nid generation:  0.03253579139709473
local_in_edges_tensor generation:  0.038330078125
mini_batch_src_global generation:  0.058550357818603516
r_  generation:  0.5005125999450684
local_output_nid generation:  0.030626773834228516
local_in_edges_tensor generation:  0.033676862716674805
mini_batch_src_global generation:  0.06066751480102539
r_  generation:  0.4966247081756592
local_output_nid generation:  0.030610322952270508
local_in_edges_tensor generation:  0.02851271629333496
mini_batch_src_global generation:  0.05784273147583008
r_  generation:  0.5040946006774902
local_output_nid generation:  0.03080892562866211
local_in_edges_tensor generation:  0.03360748291015625
mini_batch_src_global generation:  0.059166908264160156
r_  generation:  0.4987032413482666
local_output_nid generation:  0.03063488006591797
local_in_edges_tensor generation:  0.029525041580200195
mini_batch_src_global generation:  0.05849003791809082
r_  generation:  0.505079984664917
local_output_nid generation:  0.032052040100097656
local_in_edges_tensor generation:  0.03154325485229492
mini_batch_src_global generation:  0.06085944175720215
r_  generation:  0.492631196975708
local_output_nid generation:  0.030719995498657227
local_in_edges_tensor generation:  0.0383915901184082
mini_batch_src_global generation:  0.05962181091308594
r_  generation:  0.511282205581665
local_output_nid generation:  0.030625581741333008
local_in_edges_tensor generation:  0.036504268646240234
mini_batch_src_global generation:  0.05896282196044922
r_  generation:  0.4973423480987549
----------------------check_connections_block total spend ----------------------------- 23.458962440490723
generate_one_block  0.701958179473877
generate_one_block  0.6742784976959229
generate_one_block  0.6725902557373047
generate_one_block  0.6767499446868896
generate_one_block  0.7953882217407227
generate_one_block  0.6821973323822021
generate_one_block  0.6725702285766602
generate_one_block  0.6790282726287842
generate_one_block  0.6800191402435303
generate_one_block  0.6864354610443115
generate_one_block  0.6706435680389404
generate_one_block  0.6744472980499268
generate_one_block  0.6816825866699219
generate_one_block  0.6800901889801025
generate_one_block  0.6916625499725342
generate_one_block  0.6816074848175049
generate_one_block  0.6740496158599854
generate_one_block  0.6832535266876221
generate_one_block  0.6874575614929199
generate_one_block  0.6724202632904053
generate_one_block  0.6849799156188965
generate_one_block  0.6869156360626221
generate_one_block  0.6872508525848389
generate_one_block  0.6767838001251221
generate_one_block  0.6965057849884033
generate_one_block  0.6747405529022217
generate_one_block  0.6748020648956299
generate_one_block  0.691720724105835
generate_one_block  0.6741697788238525
generate_one_block  0.6730949878692627
generate_one_block  0.6920170783996582
generate_one_block  0.6824619770050049
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.13141298294067383  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

connection checking time:  32.271984338760376
block generation total time  29.99296545982361
average batch blocks generation time:  0.9372801706194878
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.10965681076049805  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 20.457627296447754  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.10922908782958984  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 20.581040382385254  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.10977458953857422  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 20.65487051010132  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.1091451644897461  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 20.742379665374756  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.10981941223144531  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 20.75047492980957  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.10888147354125977  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 20.906538486480713  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.10967636108398438  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 20.46904706954956  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.10904788970947266  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 20.33051109313965  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.10994911193847656  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 20.963337898254395  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.10928106307983398  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 20.838581562042236  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.10965251922607422  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 20.44155788421631  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.10905933380126953  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 20.50984001159668  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.10977935791015625  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 20.664689540863037  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.10913228988647461  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 20.803616046905518  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.11004352569580078  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 21.098235607147217  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.10931682586669922  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 20.662375450134277  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.10973262786865234  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 20.582419872283936  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.10948991775512695  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 21.088736534118652  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.10988616943359375  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 20.8496732711792  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.10927009582519531  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 20.92258644104004  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.10996532440185547  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 20.999070644378662  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.1094198226928711  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 21.308946132659912  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.11018753051757812  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 21.369226455688477  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10914182662963867  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 20.925617218017578  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10990047454833984  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 20.893765449523926  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.1090688705444336  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 20.342854022979736  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10988712310791016  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 20.87308168411255  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10921096801757812  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 20.73198175430298  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.1098184585571289  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 20.743564128875732  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10875892639160156  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 20.51944065093994  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.1099853515625  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 21.02070140838623  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10927343368530273  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 21.02542543411255  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.035500362515449524 |0.023136451840400696 |0.6303032711148262 |9.684264659881592e-05 |1.2043453082442284 |0.008959531784057617 |
----------------------------------------------------------pseudo_mini_loss sum 1.7555649280548096
 Run 0| Epoch 9 |
Number of nodes for computation during this epoch:  9160749
Number of first layer input nodes during this epoch:  4808595
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.1316967010498047  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02602529525756836
random selection method range initialization spend 0.006034135818481445
time for parepare:  0.021960020065307617
local_output_nid generation:  0.0014088153839111328
local_in_edges_tensor generation:  0.007972478866577148
mini_batch_src_global generation:  0.0017733573913574219
r_  generation:  0.010658502578735352
local_output_nid generation:  0.0016171932220458984
local_in_edges_tensor generation:  0.0011317729949951172
mini_batch_src_global generation:  0.0016243457794189453
r_  generation:  0.010484457015991211
local_output_nid generation:  0.0016303062438964844
local_in_edges_tensor generation:  0.0010099411010742188
mini_batch_src_global generation:  0.0011849403381347656
r_  generation:  0.009974479675292969
local_output_nid generation:  0.0016345977783203125
local_in_edges_tensor generation:  0.0009627342224121094
mini_batch_src_global generation:  0.0010976791381835938
r_  generation:  0.009509086608886719
local_output_nid generation:  0.0016026496887207031
local_in_edges_tensor generation:  0.0009627342224121094
mini_batch_src_global generation:  0.0011394023895263672
r_  generation:  0.010092020034790039
local_output_nid generation:  0.0015902519226074219
local_in_edges_tensor generation:  0.0009324550628662109
mini_batch_src_global generation:  0.0011353492736816406
r_  generation:  0.010239362716674805
local_output_nid generation:  0.001592874526977539
local_in_edges_tensor generation:  0.0009281635284423828
mini_batch_src_global generation:  0.001172780990600586
r_  generation:  0.010492324829101562
local_output_nid generation:  0.0016007423400878906
local_in_edges_tensor generation:  0.0009322166442871094
mini_batch_src_global generation:  0.0011594295501708984
r_  generation:  0.010479927062988281
local_output_nid generation:  0.0015881061553955078
local_in_edges_tensor generation:  0.0008914470672607422
mini_batch_src_global generation:  0.0011632442474365234
r_  generation:  0.010253429412841797
local_output_nid generation:  0.0015969276428222656
local_in_edges_tensor generation:  0.0009195804595947266
mini_batch_src_global generation:  0.0011496543884277344
r_  generation:  0.010082244873046875
local_output_nid generation:  0.0016028881072998047
local_in_edges_tensor generation:  0.0009179115295410156
mini_batch_src_global generation:  0.00115203857421875
r_  generation:  0.010391712188720703
local_output_nid generation:  0.0015845298767089844
local_in_edges_tensor generation:  0.000885009765625
mini_batch_src_global generation:  0.0011296272277832031
r_  generation:  0.01031804084777832
local_output_nid generation:  0.0016014575958251953
local_in_edges_tensor generation:  0.0009057521820068359
mini_batch_src_global generation:  0.0011184215545654297
r_  generation:  0.009978294372558594
local_output_nid generation:  0.0015859603881835938
local_in_edges_tensor generation:  0.0008900165557861328
mini_batch_src_global generation:  0.0011997222900390625
r_  generation:  0.010244131088256836
local_output_nid generation:  0.001598358154296875
local_in_edges_tensor generation:  0.000911712646484375
mini_batch_src_global generation:  0.0012054443359375
r_  generation:  0.010923385620117188
local_output_nid generation:  0.0016210079193115234
local_in_edges_tensor generation:  0.0009195804595947266
mini_batch_src_global generation:  0.0011904239654541016
r_  generation:  0.010598897933959961
local_output_nid generation:  0.001604318618774414
local_in_edges_tensor generation:  0.000896453857421875
mini_batch_src_global generation:  0.0011212825775146484
r_  generation:  0.010235786437988281
local_output_nid generation:  0.0016047954559326172
local_in_edges_tensor generation:  0.0008981227874755859
mini_batch_src_global generation:  0.0011391639709472656
r_  generation:  0.010326385498046875
local_output_nid generation:  0.0015943050384521484
local_in_edges_tensor generation:  0.0008742809295654297
mini_batch_src_global generation:  0.0011036396026611328
r_  generation:  0.010304450988769531
local_output_nid generation:  0.0016112327575683594
local_in_edges_tensor generation:  0.0009050369262695312
mini_batch_src_global generation:  0.001163482666015625
r_  generation:  0.010650873184204102
local_output_nid generation:  0.0016129016876220703
local_in_edges_tensor generation:  0.0008802413940429688
mini_batch_src_global generation:  0.0011134147644042969
r_  generation:  0.01026010513305664
local_output_nid generation:  0.0015902519226074219
local_in_edges_tensor generation:  0.0008871555328369141
mini_batch_src_global generation:  0.0011775493621826172
r_  generation:  0.010429859161376953
local_output_nid generation:  0.001608133316040039
local_in_edges_tensor generation:  0.0008754730224609375
mini_batch_src_global generation:  0.0011208057403564453
r_  generation:  0.01009678840637207
local_output_nid generation:  0.0015785694122314453
local_in_edges_tensor generation:  0.0008795261383056641
mini_batch_src_global generation:  0.0011401176452636719
r_  generation:  0.01035618782043457
local_output_nid generation:  0.0015959739685058594
local_in_edges_tensor generation:  0.0008742809295654297
mini_batch_src_global generation:  0.0011434555053710938
r_  generation:  0.01037144660949707
local_output_nid generation:  0.001642465591430664
local_in_edges_tensor generation:  0.0009007453918457031
mini_batch_src_global generation:  0.0012099742889404297
r_  generation:  0.010482311248779297
local_output_nid generation:  0.0015745162963867188
local_in_edges_tensor generation:  0.0008633136749267578
mini_batch_src_global generation:  0.001180410385131836
r_  generation:  0.010291337966918945
local_output_nid generation:  0.0015902519226074219
local_in_edges_tensor generation:  0.0008783340454101562
mini_batch_src_global generation:  0.0011258125305175781
r_  generation:  0.010080337524414062
local_output_nid generation:  0.0015904903411865234
local_in_edges_tensor generation:  0.0008804798126220703
mini_batch_src_global generation:  0.0010912418365478516
r_  generation:  0.010380029678344727
local_output_nid generation:  0.0016033649444580078
local_in_edges_tensor generation:  0.0008928775787353516
mini_batch_src_global generation:  0.0011620521545410156
r_  generation:  0.010598897933959961
local_output_nid generation:  0.001600503921508789
local_in_edges_tensor generation:  0.0008819103240966797
mini_batch_src_global generation:  0.0012166500091552734
r_  generation:  0.010984420776367188
local_output_nid generation:  0.0016083717346191406
local_in_edges_tensor generation:  0.0009107589721679688
mini_batch_src_global generation:  0.0012154579162597656
r_  generation:  0.010789632797241211
----------------------check_connections_block total spend ----------------------------- 0.5742959976196289
generate_one_block  0.024774551391601562
generate_one_block  0.021858930587768555
generate_one_block  0.019618749618530273
generate_one_block  0.01797628402709961
generate_one_block  0.019181013107299805
generate_one_block  0.018653154373168945
generate_one_block  0.018767833709716797
generate_one_block  0.018976926803588867
generate_one_block  0.01866292953491211
generate_one_block  0.018266916275024414
generate_one_block  0.018898487091064453
generate_one_block  0.018558979034423828
generate_one_block  0.018152475357055664
generate_one_block  0.018453121185302734
generate_one_block  0.01961541175842285
generate_one_block  0.018998146057128906
generate_one_block  0.018364429473876953
generate_one_block  0.021076202392578125
generate_one_block  0.01853656768798828
generate_one_block  0.0188446044921875
generate_one_block  0.01836371421813965
generate_one_block  0.018679380416870117
generate_one_block  0.021411418914794922
generate_one_block  0.019497156143188477
generate_one_block  0.01883220672607422
generate_one_block  0.01876044273376465
generate_one_block  0.01864767074584961
generate_one_block  0.018033266067504883
generate_one_block  0.018423080444335938
generate_one_block  0.019268512725830078
generate_one_block  0.019446134567260742
generate_one_block  0.01953125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.038596391677856445
gen group dst list time:  0.023171186447143555
time for parepare:  0.02226734161376953
local_output_nid generation:  0.0067141056060791016
local_in_edges_tensor generation:  0.02038884162902832
mini_batch_src_global generation:  0.017557859420776367
r_  generation:  0.15999984741210938
local_output_nid generation:  0.009386539459228516
local_in_edges_tensor generation:  0.01244974136352539
mini_batch_src_global generation:  0.02202582359313965
r_  generation:  0.17066073417663574
local_output_nid generation:  0.009763002395629883
local_in_edges_tensor generation:  0.03565239906311035
mini_batch_src_global generation:  0.021681785583496094
r_  generation:  0.17443370819091797
local_output_nid generation:  0.009310007095336914
local_in_edges_tensor generation:  0.011509418487548828
mini_batch_src_global generation:  0.020259380340576172
r_  generation:  0.16682910919189453
local_output_nid generation:  0.009832382202148438
local_in_edges_tensor generation:  0.010756969451904297
mini_batch_src_global generation:  0.023213863372802734
r_  generation:  0.18676066398620605
local_output_nid generation:  0.009323596954345703
local_in_edges_tensor generation:  0.010050296783447266
mini_batch_src_global generation:  0.022308349609375
r_  generation:  0.17869257926940918
local_output_nid generation:  0.009416341781616211
local_in_edges_tensor generation:  0.009721040725708008
mini_batch_src_global generation:  0.0229952335357666
r_  generation:  0.18005108833312988
local_output_nid generation:  0.00944828987121582
local_in_edges_tensor generation:  0.011212348937988281
mini_batch_src_global generation:  0.022458314895629883
r_  generation:  0.1813514232635498
local_output_nid generation:  0.009388446807861328
local_in_edges_tensor generation:  0.009752988815307617
mini_batch_src_global generation:  0.02311539649963379
r_  generation:  0.1820223331451416
local_output_nid generation:  0.009591341018676758
local_in_edges_tensor generation:  0.01082301139831543
mini_batch_src_global generation:  0.022198915481567383
r_  generation:  0.1789684295654297
local_output_nid generation:  0.0099334716796875
local_in_edges_tensor generation:  0.011441707611083984
mini_batch_src_global generation:  0.023449182510375977
r_  generation:  0.1886768341064453
local_output_nid generation:  0.00964808464050293
local_in_edges_tensor generation:  0.010138511657714844
mini_batch_src_global generation:  0.022707223892211914
r_  generation:  0.1782245635986328
local_output_nid generation:  0.009616851806640625
local_in_edges_tensor generation:  0.009970903396606445
mini_batch_src_global generation:  0.023616552352905273
r_  generation:  0.18028473854064941
local_output_nid generation:  0.009767293930053711
local_in_edges_tensor generation:  0.010119199752807617
mini_batch_src_global generation:  0.024088621139526367
r_  generation:  0.1841435432434082
local_output_nid generation:  0.010148048400878906
local_in_edges_tensor generation:  0.011849641799926758
mini_batch_src_global generation:  0.02492356300354004
r_  generation:  0.18899083137512207
local_output_nid generation:  0.00959014892578125
local_in_edges_tensor generation:  0.011564254760742188
mini_batch_src_global generation:  0.023416519165039062
r_  generation:  0.18943214416503906
local_output_nid generation:  0.009546041488647461
local_in_edges_tensor generation:  0.009209871292114258
mini_batch_src_global generation:  0.023335695266723633
r_  generation:  0.18483376502990723
local_output_nid generation:  0.009808778762817383
local_in_edges_tensor generation:  0.009237527847290039
mini_batch_src_global generation:  0.02290487289428711
r_  generation:  0.18290090560913086
local_output_nid generation:  0.009714365005493164
local_in_edges_tensor generation:  0.00919485092163086
mini_batch_src_global generation:  0.023326873779296875
r_  generation:  0.18539738655090332
local_output_nid generation:  0.010033607482910156
local_in_edges_tensor generation:  0.010033369064331055
mini_batch_src_global generation:  0.023529529571533203
r_  generation:  0.18506312370300293
local_output_nid generation:  0.009814023971557617
local_in_edges_tensor generation:  0.009197235107421875
mini_batch_src_global generation:  0.023096323013305664
r_  generation:  0.18331646919250488
local_output_nid generation:  0.009780406951904297
local_in_edges_tensor generation:  0.009096384048461914
mini_batch_src_global generation:  0.02376389503479004
r_  generation:  0.18795323371887207
local_output_nid generation:  0.009584426879882812
local_in_edges_tensor generation:  0.00995492935180664
mini_batch_src_global generation:  0.022934913635253906
r_  generation:  0.180833101272583
local_output_nid generation:  0.009800910949707031
local_in_edges_tensor generation:  0.009459257125854492
mini_batch_src_global generation:  0.023264646530151367
r_  generation:  0.18338823318481445
local_output_nid generation:  0.009665727615356445
local_in_edges_tensor generation:  0.009189367294311523
mini_batch_src_global generation:  0.022736787796020508
r_  generation:  0.18493366241455078
local_output_nid generation:  0.009722709655761719
local_in_edges_tensor generation:  0.009297609329223633
mini_batch_src_global generation:  0.022972583770751953
r_  generation:  0.18285441398620605
local_output_nid generation:  0.009860992431640625
local_in_edges_tensor generation:  0.009156465530395508
mini_batch_src_global generation:  0.022638797760009766
r_  generation:  0.18196773529052734
local_output_nid generation:  0.00960087776184082
local_in_edges_tensor generation:  0.009117603302001953
mini_batch_src_global generation:  0.022149324417114258
r_  generation:  0.179551362991333
local_output_nid generation:  0.009777307510375977
local_in_edges_tensor generation:  0.009368181228637695
mini_batch_src_global generation:  0.022948265075683594
r_  generation:  0.18655109405517578
local_output_nid generation:  0.010693550109863281
local_in_edges_tensor generation:  0.012235164642333984
mini_batch_src_global generation:  0.023753643035888672
r_  generation:  0.1868419647216797
local_output_nid generation:  0.009991884231567383
local_in_edges_tensor generation:  0.012831449508666992
mini_batch_src_global generation:  0.025390625
r_  generation:  0.19643926620483398
local_output_nid generation:  0.009913206100463867
local_in_edges_tensor generation:  0.01055765151977539
mini_batch_src_global generation:  0.024770498275756836
r_  generation:  0.19048261642456055
----------------------check_connections_block total spend ----------------------------- 8.55551266670227
generate_one_block  0.24626493453979492
generate_one_block  0.24497532844543457
generate_one_block  0.24850773811340332
generate_one_block  0.23283886909484863
generate_one_block  0.26558828353881836
generate_one_block  0.24522948265075684
generate_one_block  0.24605417251586914
generate_one_block  0.24777841567993164
generate_one_block  0.24880337715148926
generate_one_block  0.23917078971862793
generate_one_block  0.2509458065032959
generate_one_block  0.2394123077392578
generate_one_block  0.2404332160949707
generate_one_block  0.24961376190185547
generate_one_block  0.2565627098083496
generate_one_block  0.25864529609680176
generate_one_block  0.24229121208190918
generate_one_block  0.24390506744384766
generate_one_block  0.24425411224365234
generate_one_block  0.25518107414245605
generate_one_block  0.24599766731262207
generate_one_block  0.2556436061859131
generate_one_block  0.23809051513671875
generate_one_block  0.2472240924835205
generate_one_block  0.24462246894836426
generate_one_block  0.24512910842895508
generate_one_block  0.2446739673614502
generate_one_block  0.24055123329162598
generate_one_block  0.2470989227294922
generate_one_block  0.25218653678894043
generate_one_block  0.263469934463501
generate_one_block  0.2587289810180664
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.039563655853271484
gen group dst list time:  0.10664701461791992
time for parepare:  0.020444154739379883
local_output_nid generation:  0.025255203247070312
local_in_edges_tensor generation:  0.05327773094177246
mini_batch_src_global generation:  0.04688739776611328
r_  generation:  0.4911026954650879
local_output_nid generation:  0.03131842613220215
local_in_edges_tensor generation:  0.03898429870605469
mini_batch_src_global generation:  0.058617591857910156
r_  generation:  0.48228955268859863
local_output_nid generation:  0.031497955322265625
local_in_edges_tensor generation:  0.03955411911010742
mini_batch_src_global generation:  0.059350013732910156
r_  generation:  0.5049831867218018
local_output_nid generation:  0.031058073043823242
local_in_edges_tensor generation:  0.02984905242919922
mini_batch_src_global generation:  0.06080222129821777
r_  generation:  0.4878857135772705
local_output_nid generation:  0.031450510025024414
local_in_edges_tensor generation:  0.03017425537109375
mini_batch_src_global generation:  0.05968976020812988
r_  generation:  0.510969877243042
local_output_nid generation:  0.03120255470275879
local_in_edges_tensor generation:  0.030568361282348633
mini_batch_src_global generation:  0.059680938720703125
r_  generation:  0.4941587448120117
local_output_nid generation:  0.029863834381103516
local_in_edges_tensor generation:  0.032678842544555664
mini_batch_src_global generation:  0.06051182746887207
r_  generation:  0.5135433673858643
local_output_nid generation:  0.03226184844970703
local_in_edges_tensor generation:  0.035325050354003906
mini_batch_src_global generation:  0.06061220169067383
r_  generation:  0.49563026428222656
local_output_nid generation:  0.030205965042114258
local_in_edges_tensor generation:  0.03073263168334961
mini_batch_src_global generation:  0.05801677703857422
r_  generation:  0.5009870529174805
local_output_nid generation:  0.03006577491760254
local_in_edges_tensor generation:  0.030800819396972656
mini_batch_src_global generation:  0.06113839149475098
r_  generation:  0.49351072311401367
local_output_nid generation:  0.03036952018737793
local_in_edges_tensor generation:  0.03262805938720703
mini_batch_src_global generation:  0.05999326705932617
r_  generation:  0.503385066986084
local_output_nid generation:  0.030065536499023438
local_in_edges_tensor generation:  0.02974104881286621
mini_batch_src_global generation:  0.058834075927734375
r_  generation:  0.49207162857055664
local_output_nid generation:  0.030197858810424805
local_in_edges_tensor generation:  0.03174281120300293
mini_batch_src_global generation:  0.05715608596801758
r_  generation:  0.4980642795562744
local_output_nid generation:  0.030205726623535156
local_in_edges_tensor generation:  0.031815290451049805
mini_batch_src_global generation:  0.05876922607421875
r_  generation:  0.49744248390197754
local_output_nid generation:  0.030293703079223633
local_in_edges_tensor generation:  0.03250932693481445
mini_batch_src_global generation:  0.05825495719909668
r_  generation:  0.5050065517425537
local_output_nid generation:  0.030243396759033203
local_in_edges_tensor generation:  0.03146982192993164
mini_batch_src_global generation:  0.05846810340881348
r_  generation:  0.4994382858276367
local_output_nid generation:  0.03032064437866211
local_in_edges_tensor generation:  0.031891584396362305
mini_batch_src_global generation:  0.05792427062988281
r_  generation:  0.503197431564331
local_output_nid generation:  0.03036022186279297
local_in_edges_tensor generation:  0.032169342041015625
mini_batch_src_global generation:  0.05902886390686035
r_  generation:  0.497481107711792
local_output_nid generation:  0.03020334243774414
local_in_edges_tensor generation:  0.03133130073547363
mini_batch_src_global generation:  0.057433128356933594
r_  generation:  0.5002305507659912
local_output_nid generation:  0.03077220916748047
local_in_edges_tensor generation:  0.03174138069152832
mini_batch_src_global generation:  0.05905890464782715
r_  generation:  0.5071663856506348
local_output_nid generation:  0.03198671340942383
local_in_edges_tensor generation:  0.03211402893066406
mini_batch_src_global generation:  0.05735373497009277
r_  generation:  0.5073847770690918
local_output_nid generation:  0.03004622459411621
local_in_edges_tensor generation:  0.03192472457885742
mini_batch_src_global generation:  0.05854344367980957
r_  generation:  0.49754881858825684
local_output_nid generation:  0.03005385398864746
local_in_edges_tensor generation:  0.03252410888671875
mini_batch_src_global generation:  0.058077335357666016
r_  generation:  0.5011787414550781
local_output_nid generation:  0.03034806251525879
local_in_edges_tensor generation:  0.0325014591217041
mini_batch_src_global generation:  0.05978703498840332
r_  generation:  0.49834656715393066
local_output_nid generation:  0.030149221420288086
local_in_edges_tensor generation:  0.0307309627532959
mini_batch_src_global generation:  0.058599233627319336
r_  generation:  0.4996333122253418
local_output_nid generation:  0.030168771743774414
local_in_edges_tensor generation:  0.03271341323852539
mini_batch_src_global generation:  0.06006979942321777
r_  generation:  0.5008070468902588
local_output_nid generation:  0.030398130416870117
local_in_edges_tensor generation:  0.03180575370788574
mini_batch_src_global generation:  0.05889391899108887
r_  generation:  0.50126051902771
local_output_nid generation:  0.030550241470336914
local_in_edges_tensor generation:  0.032865047454833984
mini_batch_src_global generation:  0.05949831008911133
r_  generation:  0.4976158142089844
local_output_nid generation:  0.030295610427856445
local_in_edges_tensor generation:  0.03223395347595215
mini_batch_src_global generation:  0.05909252166748047
r_  generation:  0.5031824111938477
local_output_nid generation:  0.03052544593811035
local_in_edges_tensor generation:  0.031714677810668945
mini_batch_src_global generation:  0.060555219650268555
r_  generation:  0.49804258346557617
local_output_nid generation:  0.03063511848449707
local_in_edges_tensor generation:  0.03216743469238281
mini_batch_src_global generation:  0.05888938903808594
r_  generation:  0.5101237297058105
local_output_nid generation:  0.03052043914794922
local_in_edges_tensor generation:  0.031735897064208984
mini_batch_src_global generation:  0.06070971488952637
r_  generation:  0.5034613609313965
----------------------check_connections_block total spend ----------------------------- 23.366987228393555
generate_one_block  0.6762790679931641
generate_one_block  0.6749944686889648
generate_one_block  0.6729252338409424
generate_one_block  0.663874626159668
generate_one_block  0.7658088207244873
generate_one_block  0.6723251342773438
generate_one_block  0.6746325492858887
generate_one_block  0.6749131679534912
generate_one_block  0.6758432388305664
generate_one_block  0.6776773929595947
generate_one_block  0.6829962730407715
generate_one_block  0.6720306873321533
generate_one_block  0.6696338653564453
generate_one_block  0.6791481971740723
generate_one_block  0.684136152267456
generate_one_block  0.6717748641967773
generate_one_block  0.6739275455474854
generate_one_block  0.6761488914489746
generate_one_block  0.6720759868621826
generate_one_block  0.6780886650085449
generate_one_block  0.6735343933105469
generate_one_block  0.6789455413818359
generate_one_block  0.6684103012084961
generate_one_block  0.6860489845275879
generate_one_block  0.6854352951049805
generate_one_block  0.6710882186889648
generate_one_block  0.6812734603881836
generate_one_block  0.676887035369873
generate_one_block  0.6831009387969971
generate_one_block  0.681896448135376
generate_one_block  0.6874079704284668
generate_one_block  0.6923398971557617
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.1316967010498047  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

connection checking time:  31.922499895095825
block generation total time  29.685476303100586
average batch blocks generation time:  0.9276711344718933
block dataloader generation time/epoch 65.27549576759338
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10971879959106445  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 20.560245513916016  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10915565490722656  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 20.749411582946777  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10988140106201172  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 20.821621417999268  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10882282257080078  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 20.10023593902588  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10996341705322266  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 21.0018892288208  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10906553268432617  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 20.694011688232422  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10984992980957031  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 20.78410816192627  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10936546325683594  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 20.877915382385254  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10984992980957031  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 20.798712253570557  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.109039306640625  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 20.48417854309082  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10998249053955078  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 20.992597579956055  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10900068283081055  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 20.416966438293457  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10970687866210938  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 20.56190586090088  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10915851593017578  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 20.870579719543457  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.11004352569580078  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 21.152923107147217  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10908794403076172  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 21.042843341827393  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10975170135498047  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 20.609337329864502  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10921096801757812  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 20.73172378540039  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10978984832763672  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 20.677204608917236  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10942697525024414  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 20.924781799316406  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10979080200195312  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 20.72095012664795  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10905170440673828  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 20.96193218231201  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10962390899658203  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 20.381407260894775  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10901689529418945  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 20.8043270111084  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10973548889160156  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 20.633858680725098  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10923242568969727  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 20.709560871124268  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10978126525878906  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 20.692867279052734  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10917854309082031  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 20.44072914123535  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10988616943359375  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 20.813251495361328  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10915851593017578  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 20.947400093078613  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.1102294921875  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 21.458226680755615  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.1093602180480957  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 21.286683559417725  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.028147757053375244 |0.0226246640086174 |0.6309783086180687 |9.770691394805908e-05 |1.2070270255208015 |0.004896879196166992 |
----------------------------------------------------------pseudo_mini_loss sum 1.7108819484710693
Total (block generation + training)time/epoch 125.7856297492981
Training time/epoch 60.50985360145569
Training time without block to device /epoch 59.78586435317993
Training time without total dataloading part /epoch 58.82419419288635
load block tensor time/epoch 0.9007282257080078
block to device time/epoch 0.7239892482757568
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 10 |
Number of nodes for computation during this epoch:  9157845
Number of first layer input nodes during this epoch:  4806570
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.1327495574951172  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026371002197265625
random selection method range initialization spend 0.006792783737182617
time for parepare:  0.021425962448120117
local_output_nid generation:  0.0014181137084960938
local_in_edges_tensor generation:  0.007337331771850586
mini_batch_src_global generation:  0.0018498897552490234
r_  generation:  0.011322975158691406
local_output_nid generation:  0.001657724380493164
local_in_edges_tensor generation:  0.0011105537414550781
mini_batch_src_global generation:  0.001710653305053711
r_  generation:  0.01122593879699707
local_output_nid generation:  0.0016078948974609375
local_in_edges_tensor generation:  0.0010046958923339844
mini_batch_src_global generation:  0.0011546611785888672
r_  generation:  0.00961446762084961
local_output_nid generation:  0.0015978813171386719
local_in_edges_tensor generation:  0.0009758472442626953
mini_batch_src_global generation:  0.0011565685272216797
r_  generation:  0.010245323181152344
local_output_nid generation:  0.0016100406646728516
local_in_edges_tensor generation:  0.0009660720825195312
mini_batch_src_global generation:  0.0011107921600341797
r_  generation:  0.009957551956176758
local_output_nid generation:  0.0015914440155029297
local_in_edges_tensor generation:  0.0009486675262451172
mini_batch_src_global generation:  0.0011181831359863281
r_  generation:  0.009919404983520508
local_output_nid generation:  0.0016069412231445312
local_in_edges_tensor generation:  0.0009405612945556641
mini_batch_src_global generation:  0.0011570453643798828
r_  generation:  0.01042485237121582
local_output_nid generation:  0.0016591548919677734
local_in_edges_tensor generation:  0.0009412765502929688
mini_batch_src_global generation:  0.0011386871337890625
r_  generation:  0.010468244552612305
local_output_nid generation:  0.001592874526977539
local_in_edges_tensor generation:  0.0008878707885742188
mini_batch_src_global generation:  0.0011801719665527344
r_  generation:  0.010414361953735352
local_output_nid generation:  0.001588582992553711
local_in_edges_tensor generation:  0.0009241104125976562
mini_batch_src_global generation:  0.001161813735961914
r_  generation:  0.010527372360229492
local_output_nid generation:  0.0016074180603027344
local_in_edges_tensor generation:  0.0008993148803710938
mini_batch_src_global generation:  0.0012006759643554688
r_  generation:  0.01064443588256836
local_output_nid generation:  0.0015964508056640625
local_in_edges_tensor generation:  0.0008962154388427734
mini_batch_src_global generation:  0.0011525154113769531
r_  generation:  0.010140419006347656
local_output_nid generation:  0.0015861988067626953
local_in_edges_tensor generation:  0.0009028911590576172
mini_batch_src_global generation:  0.001115560531616211
r_  generation:  0.010441780090332031
local_output_nid generation:  0.0016064643859863281
local_in_edges_tensor generation:  0.0009016990661621094
mini_batch_src_global generation:  0.00113677978515625
r_  generation:  0.010426998138427734
local_output_nid generation:  0.0016214847564697266
local_in_edges_tensor generation:  0.0009489059448242188
mini_batch_src_global generation:  0.001219034194946289
r_  generation:  0.010420560836791992
local_output_nid generation:  0.0016679763793945312
local_in_edges_tensor generation:  0.000989675521850586
mini_batch_src_global generation:  0.0012049674987792969
r_  generation:  0.011020183563232422
local_output_nid generation:  0.001615762710571289
local_in_edges_tensor generation:  0.0008661746978759766
mini_batch_src_global generation:  0.0011713504791259766
r_  generation:  0.01064443588256836
local_output_nid generation:  0.00164031982421875
local_in_edges_tensor generation:  0.0009243488311767578
mini_batch_src_global generation:  0.001233816146850586
r_  generation:  0.011046886444091797
local_output_nid generation:  0.0016167163848876953
local_in_edges_tensor generation:  0.0008778572082519531
mini_batch_src_global generation:  0.0011620521545410156
r_  generation:  0.010477542877197266
local_output_nid generation:  0.0016124248504638672
local_in_edges_tensor generation:  0.0008940696716308594
mini_batch_src_global generation:  0.0011513233184814453
r_  generation:  0.010507822036743164
local_output_nid generation:  0.0016181468963623047
local_in_edges_tensor generation:  0.0008840560913085938
mini_batch_src_global generation:  0.0011668205261230469
r_  generation:  0.01061558723449707
local_output_nid generation:  0.001600503921508789
local_in_edges_tensor generation:  0.0009365081787109375
mini_batch_src_global generation:  0.0011382102966308594
r_  generation:  0.010160207748413086
local_output_nid generation:  0.0015931129455566406
local_in_edges_tensor generation:  0.0008742809295654297
mini_batch_src_global generation:  0.0011601448059082031
r_  generation:  0.010810613632202148
local_output_nid generation:  0.0015766620635986328
local_in_edges_tensor generation:  0.0009002685546875
mini_batch_src_global generation:  0.0011410713195800781
r_  generation:  0.010405540466308594
local_output_nid generation:  0.0015747547149658203
local_in_edges_tensor generation:  0.0009057521820068359
mini_batch_src_global generation:  0.0011472702026367188
r_  generation:  0.010221719741821289
local_output_nid generation:  0.0015838146209716797
local_in_edges_tensor generation:  0.0008730888366699219
mini_batch_src_global generation:  0.0011255741119384766
r_  generation:  0.010538339614868164
local_output_nid generation:  0.0015783309936523438
local_in_edges_tensor generation:  0.000865936279296875
mini_batch_src_global generation:  0.0011446475982666016
r_  generation:  0.010068893432617188
local_output_nid generation:  0.0015821456909179688
local_in_edges_tensor generation:  0.0008678436279296875
mini_batch_src_global generation:  0.0011737346649169922
r_  generation:  0.010469913482666016
local_output_nid generation:  0.001573801040649414
local_in_edges_tensor generation:  0.0008647441864013672
mini_batch_src_global generation:  0.0012166500091552734
r_  generation:  0.010763168334960938
local_output_nid generation:  0.0015876293182373047
local_in_edges_tensor generation:  0.0008754730224609375
mini_batch_src_global generation:  0.0011167526245117188
r_  generation:  0.01039266586303711
local_output_nid generation:  0.0015826225280761719
local_in_edges_tensor generation:  0.0008881092071533203
mini_batch_src_global generation:  0.0011205673217773438
r_  generation:  0.010136127471923828
local_output_nid generation:  0.0015704631805419922
local_in_edges_tensor generation:  0.0008554458618164062
mini_batch_src_global generation:  0.0010881423950195312
r_  generation:  0.010395050048828125
----------------------check_connections_block total spend ----------------------------- 0.5781464576721191
generate_one_block  0.02605271339416504
generate_one_block  0.022565603256225586
generate_one_block  0.0187225341796875
generate_one_block  0.019457578659057617
generate_one_block  0.018522977828979492
generate_one_block  0.018163204193115234
generate_one_block  0.01897120475769043
generate_one_block  0.018992900848388672
generate_one_block  0.019001483917236328
generate_one_block  0.018865108489990234
generate_one_block  0.019062519073486328
generate_one_block  0.01844000816345215
generate_one_block  0.018877267837524414
generate_one_block  0.01874828338623047
generate_one_block  0.018430233001708984
generate_one_block  0.019535064697265625
generate_one_block  0.018700361251831055
generate_one_block  0.019606828689575195
generate_one_block  0.01876068115234375
generate_one_block  0.01880478858947754
generate_one_block  0.018980026245117188
generate_one_block  0.01816534996032715
generate_one_block  0.022547006607055664
generate_one_block  0.019485950469970703
generate_one_block  0.018574237823486328
generate_one_block  0.018903732299804688
generate_one_block  0.01822686195373535
generate_one_block  0.018790006637573242
generate_one_block  0.01926732063293457
generate_one_block  0.01845407485961914
generate_one_block  0.01828742027282715
generate_one_block  0.01870870590209961
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03988170623779297
gen group dst list time:  0.023436546325683594
time for parepare:  0.023128509521484375
local_output_nid generation:  0.00680088996887207
local_in_edges_tensor generation:  0.019771814346313477
mini_batch_src_global generation:  0.017807960510253906
r_  generation:  0.16682982444763184
local_output_nid generation:  0.009865522384643555
local_in_edges_tensor generation:  0.012719154357910156
mini_batch_src_global generation:  0.023012399673461914
r_  generation:  0.1784377098083496
local_output_nid generation:  0.009439229965209961
local_in_edges_tensor generation:  0.0350186824798584
mini_batch_src_global generation:  0.019214868545532227
r_  generation:  0.1609029769897461
local_output_nid generation:  0.00994420051574707
local_in_edges_tensor generation:  0.012688398361206055
mini_batch_src_global generation:  0.021557331085205078
r_  generation:  0.17641210556030273
local_output_nid generation:  0.009617328643798828
local_in_edges_tensor generation:  0.012206554412841797
mini_batch_src_global generation:  0.021889448165893555
r_  generation:  0.17353105545043945
local_output_nid generation:  0.009224414825439453
local_in_edges_tensor generation:  0.010243654251098633
mini_batch_src_global generation:  0.020875930786132812
r_  generation:  0.1715092658996582
local_output_nid generation:  0.009430885314941406
local_in_edges_tensor generation:  0.009858846664428711
mini_batch_src_global generation:  0.023712635040283203
r_  generation:  0.1832115650177002
local_output_nid generation:  0.009401082992553711
local_in_edges_tensor generation:  0.010016679763793945
mini_batch_src_global generation:  0.02303171157836914
r_  generation:  0.18126606941223145
local_output_nid generation:  0.009580135345458984
local_in_edges_tensor generation:  0.009582757949829102
mini_batch_src_global generation:  0.023264169692993164
r_  generation:  0.18366217613220215
local_output_nid generation:  0.009722232818603516
local_in_edges_tensor generation:  0.010483503341674805
mini_batch_src_global generation:  0.023320436477661133
r_  generation:  0.181243896484375
local_output_nid generation:  0.00985097885131836
local_in_edges_tensor generation:  0.009611845016479492
mini_batch_src_global generation:  0.024326086044311523
r_  generation:  0.18813586235046387
local_output_nid generation:  0.009599447250366211
local_in_edges_tensor generation:  0.010101079940795898
mini_batch_src_global generation:  0.022150516510009766
r_  generation:  0.17162370681762695
local_output_nid generation:  0.00994420051574707
local_in_edges_tensor generation:  0.009521484375
mini_batch_src_global generation:  0.023005962371826172
r_  generation:  0.18425774574279785
local_output_nid generation:  0.009863138198852539
local_in_edges_tensor generation:  0.012574195861816406
mini_batch_src_global generation:  0.023808002471923828
r_  generation:  0.18073439598083496
local_output_nid generation:  0.009775638580322266
local_in_edges_tensor generation:  0.011244058609008789
mini_batch_src_global generation:  0.023411035537719727
r_  generation:  0.18053889274597168
local_output_nid generation:  0.01011514663696289
local_in_edges_tensor generation:  0.010969400405883789
mini_batch_src_global generation:  0.02492046356201172
r_  generation:  0.19182276725769043
local_output_nid generation:  0.009873151779174805
local_in_edges_tensor generation:  0.009366035461425781
mini_batch_src_global generation:  0.023767948150634766
r_  generation:  0.18770694732666016
local_output_nid generation:  0.010323524475097656
local_in_edges_tensor generation:  0.009869575500488281
mini_batch_src_global generation:  0.02496194839477539
r_  generation:  0.1906602382659912
local_output_nid generation:  0.00990438461303711
local_in_edges_tensor generation:  0.00956869125366211
mini_batch_src_global generation:  0.02382040023803711
r_  generation:  0.1866762638092041
local_output_nid generation:  0.009880542755126953
local_in_edges_tensor generation:  0.009591817855834961
mini_batch_src_global generation:  0.022850990295410156
r_  generation:  0.1833786964416504
local_output_nid generation:  0.009871482849121094
local_in_edges_tensor generation:  0.00939035415649414
mini_batch_src_global generation:  0.024447202682495117
r_  generation:  0.18839740753173828
local_output_nid generation:  0.009601116180419922
local_in_edges_tensor generation:  0.009019136428833008
mini_batch_src_global generation:  0.02261805534362793
r_  generation:  0.17728543281555176
local_output_nid generation:  0.010103940963745117
local_in_edges_tensor generation:  0.009527206420898438
mini_batch_src_global generation:  0.023642301559448242
r_  generation:  0.1939551830291748
local_output_nid generation:  0.00968790054321289
local_in_edges_tensor generation:  0.009514570236206055
mini_batch_src_global generation:  0.02424144744873047
r_  generation:  0.18361568450927734
local_output_nid generation:  0.009698152542114258
local_in_edges_tensor generation:  0.009499788284301758
mini_batch_src_global generation:  0.022406578063964844
r_  generation:  0.1829674243927002
local_output_nid generation:  0.009822845458984375
local_in_edges_tensor generation:  0.010174989700317383
mini_batch_src_global generation:  0.023325443267822266
r_  generation:  0.18562078475952148
local_output_nid generation:  0.009557008743286133
local_in_edges_tensor generation:  0.008920431137084961
mini_batch_src_global generation:  0.02316141128540039
r_  generation:  0.1836240291595459
local_output_nid generation:  0.00989389419555664
local_in_edges_tensor generation:  0.009656429290771484
mini_batch_src_global generation:  0.023636579513549805
r_  generation:  0.18503761291503906
local_output_nid generation:  0.010027408599853516
local_in_edges_tensor generation:  0.014014482498168945
mini_batch_src_global generation:  0.02420520782470703
r_  generation:  0.18792462348937988
local_output_nid generation:  0.009751319885253906
local_in_edges_tensor generation:  0.009703874588012695
mini_batch_src_global generation:  0.023240089416503906
r_  generation:  0.18402934074401855
local_output_nid generation:  0.010601282119750977
local_in_edges_tensor generation:  0.009977579116821289
mini_batch_src_global generation:  0.022154569625854492
r_  generation:  0.18027973175048828
local_output_nid generation:  0.009786605834960938
local_in_edges_tensor generation:  0.009485006332397461
mini_batch_src_global generation:  0.023229598999023438
r_  generation:  0.1814727783203125
----------------------check_connections_block total spend ----------------------------- 8.552785873413086
generate_one_block  0.25907421112060547
generate_one_block  0.25850915908813477
generate_one_block  0.22921490669250488
generate_one_block  0.2501795291900635
generate_one_block  0.2559494972229004
generate_one_block  0.23544549942016602
generate_one_block  0.25165796279907227
generate_one_block  0.24914073944091797
generate_one_block  0.250607967376709
generate_one_block  0.2507965564727783
generate_one_block  0.25419068336486816
generate_one_block  0.23220491409301758
generate_one_block  0.24526596069335938
generate_one_block  0.24579858779907227
generate_one_block  0.24318170547485352
generate_one_block  0.2606475353240967
generate_one_block  0.2521512508392334
generate_one_block  0.25783514976501465
generate_one_block  0.2498950958251953
generate_one_block  0.25238800048828125
generate_one_block  0.2518773078918457
generate_one_block  0.2389070987701416
generate_one_block  0.2571375370025635
generate_one_block  0.2411026954650879
generate_one_block  0.23775768280029297
generate_one_block  0.25124287605285645
generate_one_block  0.24531817436218262
generate_one_block  0.24685454368591309
generate_one_block  0.2540769577026367
generate_one_block  0.2443382740020752
generate_one_block  0.24060487747192383
generate_one_block  0.24446487426757812
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04013991355895996
gen group dst list time:  0.10752129554748535
time for parepare:  0.020850658416748047
local_output_nid generation:  0.026525497436523438
local_in_edges_tensor generation:  0.05758380889892578
mini_batch_src_global generation:  0.04866647720336914
r_  generation:  0.48876285552978516
local_output_nid generation:  0.03188729286193848
local_in_edges_tensor generation:  0.04018664360046387
mini_batch_src_global generation:  0.06161832809448242
r_  generation:  0.49201202392578125
local_output_nid generation:  0.03168129920959473
local_in_edges_tensor generation:  0.03929471969604492
mini_batch_src_global generation:  0.060339927673339844
r_  generation:  0.49535584449768066
local_output_nid generation:  0.0323030948638916
local_in_edges_tensor generation:  0.032216787338256836
mini_batch_src_global generation:  0.061537981033325195
r_  generation:  0.49373483657836914
local_output_nid generation:  0.03197026252746582
local_in_edges_tensor generation:  0.03417086601257324
mini_batch_src_global generation:  0.06069326400756836
r_  generation:  0.49919795989990234
local_output_nid generation:  0.031089305877685547
local_in_edges_tensor generation:  0.03386497497558594
mini_batch_src_global generation:  0.06992983818054199
r_  generation:  0.49576830863952637
local_output_nid generation:  0.030862808227539062
local_in_edges_tensor generation:  0.031182050704956055
mini_batch_src_global generation:  0.059389591217041016
r_  generation:  0.4985172748565674
local_output_nid generation:  0.029817581176757812
local_in_edges_tensor generation:  0.03120279312133789
mini_batch_src_global generation:  0.05969691276550293
r_  generation:  0.4976770877838135
local_output_nid generation:  0.03164410591125488
local_in_edges_tensor generation:  0.03055119514465332
mini_batch_src_global generation:  0.06206631660461426
r_  generation:  0.5004067420959473
local_output_nid generation:  0.0316317081451416
local_in_edges_tensor generation:  0.03326678276062012
mini_batch_src_global generation:  0.05991959571838379
r_  generation:  0.4960308074951172
local_output_nid generation:  0.03070974349975586
local_in_edges_tensor generation:  0.03139328956604004
mini_batch_src_global generation:  0.059580326080322266
r_  generation:  0.49977588653564453
local_output_nid generation:  0.030391216278076172
local_in_edges_tensor generation:  0.03174757957458496
mini_batch_src_global generation:  0.05962514877319336
r_  generation:  0.4936809539794922
local_output_nid generation:  0.030866622924804688
local_in_edges_tensor generation:  0.031202077865600586
mini_batch_src_global generation:  0.06145167350769043
r_  generation:  0.5000889301300049
local_output_nid generation:  0.030560970306396484
local_in_edges_tensor generation:  0.03215217590332031
mini_batch_src_global generation:  0.06039237976074219
r_  generation:  0.49767446517944336
local_output_nid generation:  0.030669450759887695
local_in_edges_tensor generation:  0.03136754035949707
mini_batch_src_global generation:  0.058943986892700195
r_  generation:  0.49530625343322754
local_output_nid generation:  0.030807018280029297
local_in_edges_tensor generation:  0.03146624565124512
mini_batch_src_global generation:  0.0626840591430664
r_  generation:  0.5005772113800049
local_output_nid generation:  0.030786991119384766
local_in_edges_tensor generation:  0.03484940528869629
mini_batch_src_global generation:  0.05912518501281738
r_  generation:  0.5030930042266846
local_output_nid generation:  0.031222820281982422
local_in_edges_tensor generation:  0.032311201095581055
mini_batch_src_global generation:  0.060181617736816406
r_  generation:  0.5032029151916504
local_output_nid generation:  0.03104114532470703
local_in_edges_tensor generation:  0.03275656700134277
mini_batch_src_global generation:  0.05983233451843262
r_  generation:  0.5020625591278076
local_output_nid generation:  0.031162738800048828
local_in_edges_tensor generation:  0.0329585075378418
mini_batch_src_global generation:  0.05991220474243164
r_  generation:  0.5006673336029053
local_output_nid generation:  0.031023263931274414
local_in_edges_tensor generation:  0.03417086601257324
mini_batch_src_global generation:  0.05934572219848633
r_  generation:  0.5025644302368164
local_output_nid generation:  0.03051924705505371
local_in_edges_tensor generation:  0.03181314468383789
mini_batch_src_global generation:  0.060273170471191406
r_  generation:  0.4934823513031006
local_output_nid generation:  0.03091740608215332
local_in_edges_tensor generation:  0.030786752700805664
mini_batch_src_global generation:  0.06171131134033203
r_  generation:  0.5023462772369385
local_output_nid generation:  0.030955076217651367
local_in_edges_tensor generation:  0.03740096092224121
mini_batch_src_global generation:  0.05984973907470703
r_  generation:  0.4987361431121826
local_output_nid generation:  0.031127214431762695
local_in_edges_tensor generation:  0.03180384635925293
mini_batch_src_global generation:  0.059514522552490234
r_  generation:  0.4981648921966553
local_output_nid generation:  0.031125545501708984
local_in_edges_tensor generation:  0.030669689178466797
mini_batch_src_global generation:  0.060149431228637695
r_  generation:  0.49689245223999023
local_output_nid generation:  0.03067159652709961
local_in_edges_tensor generation:  0.032395362854003906
mini_batch_src_global generation:  0.059137821197509766
r_  generation:  0.5041275024414062
local_output_nid generation:  0.030889511108398438
local_in_edges_tensor generation:  0.03272247314453125
mini_batch_src_global generation:  0.06237530708312988
r_  generation:  0.5018401145935059
local_output_nid generation:  0.03050684928894043
local_in_edges_tensor generation:  0.030403852462768555
mini_batch_src_global generation:  0.058708906173706055
r_  generation:  0.49927592277526855
local_output_nid generation:  0.03017401695251465
local_in_edges_tensor generation:  0.03162503242492676
mini_batch_src_global generation:  0.05976366996765137
r_  generation:  0.49360179901123047
local_output_nid generation:  0.030718088150024414
local_in_edges_tensor generation:  0.030588626861572266
mini_batch_src_global generation:  0.061156272888183594
r_  generation:  0.5013291835784912
local_output_nid generation:  0.030635833740234375
local_in_edges_tensor generation:  0.0303952693939209
mini_batch_src_global generation:  0.060036420822143555
r_  generation:  0.4942805767059326
----------------------check_connections_block total spend ----------------------------- 23.41528344154358
generate_one_block  0.6851654052734375
generate_one_block  0.6867353916168213
generate_one_block  0.6671137809753418
generate_one_block  0.6788089275360107
generate_one_block  0.7699587345123291
generate_one_block  0.6687347888946533
generate_one_block  0.6794095039367676
generate_one_block  0.6778526306152344
generate_one_block  0.6787800788879395
generate_one_block  0.6728196144104004
generate_one_block  0.6750593185424805
generate_one_block  0.674915075302124
generate_one_block  0.6780622005462646
generate_one_block  0.6809124946594238
generate_one_block  0.6759097576141357
generate_one_block  0.6879334449768066
generate_one_block  0.6840059757232666
generate_one_block  0.6828794479370117
generate_one_block  0.6854240894317627
generate_one_block  0.6702744960784912
generate_one_block  0.683638334274292
generate_one_block  0.6681547164916992
generate_one_block  0.6876728534698486
generate_one_block  0.6789579391479492
generate_one_block  0.685694694519043
generate_one_block  0.6802260875701904
generate_one_block  0.6842391490936279
generate_one_block  0.6868884563446045
generate_one_block  0.6775772571563721
generate_one_block  0.673393726348877
generate_one_block  0.6824159622192383
generate_one_block  0.675025224685669
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.1327495574951172  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

connection checking time:  31.968069314956665
block generation total time  29.762457370758057
average batch blocks generation time:  0.9300767928361893
block dataloader generation time/epoch 65.35386681556702
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10995244979858398  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 20.9387788772583  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.1095733642578125  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 21.196634769439697  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10933780670166016  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 19.899739742279053  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10960531234741211  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 20.912559509277344  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10964679718017578  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 20.407496452331543  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10919046401977539  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 20.329049110412598  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10990619659423828  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2420654296875 GB
    Memory Allocated: 20.907236099243164  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2440185546875 GB
    Memory Allocated: 0.10917425155639648  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2440185546875 GB
    Memory Allocated: 20.84940004348755  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2440185546875 GB
    Memory Allocated: 0.10993194580078125  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2440185546875 GB
    Memory Allocated: 20.93217420578003  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2440185546875 GB
    Memory Allocated: 0.10927057266235352  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2440185546875 GB
    Memory Allocated: 20.822746753692627  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2440185546875 GB
    Memory Allocated: 0.1100006103515625  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2440185546875 GB
    Memory Allocated: 21.08003044128418  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2440185546875 GB
    Memory Allocated: 0.10884380340576172  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2440185546875 GB
    Memory Allocated: 20.086246013641357  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2440185546875 GB
    Memory Allocated: 0.10990142822265625  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2440185546875 GB
    Memory Allocated: 20.835885047912598  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2440185546875 GB
    Memory Allocated: 0.109161376953125  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2440185546875 GB
    Memory Allocated: 20.6638503074646  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2440185546875 GB
    Memory Allocated: 0.10969829559326172  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2440185546875 GB
    Memory Allocated: 20.520101070404053  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2440185546875 GB
    Memory Allocated: 0.10959625244140625  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2440185546875 GB
    Memory Allocated: 21.35615873336792  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2440185546875 GB
    Memory Allocated: 0.10991573333740234  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2440185546875 GB
    Memory Allocated: 20.90633249282837  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2440185546875 GB
    Memory Allocated: 0.10964775085449219  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 21.258095264434814  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 0.1099557876586914  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 20.945600032806396  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 0.10942459106445312  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 20.81049919128418  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 0.10996437072753906  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 20.983726501464844  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 0.10883760452270508  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 20.33534288406372  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 0.11004638671875  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 21.090744972229004  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 0.10920953750610352  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 20.62192726135254  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 0.10961723327636719  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 20.414790630340576  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 0.10934114456176758  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 20.89378309249878  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 0.10977649688720703  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 20.65944766998291  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 0.1092686653137207  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 20.756181716918945  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 0.10991764068603516  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 20.946889877319336  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 0.10877847671508789  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 20.56878089904785  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 0.10970497131347656  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 20.524690628051758  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 0.1089181900024414  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 20.59666633605957  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02770412713289261 |0.02252279967069626 |0.6292154937982559 |9.584426879882812e-05 |1.2014815583825111 |0.009452342987060547 |
----------------------------------------------------------pseudo_mini_loss sum 1.6383460760116577
Total (block generation + training)time/epoch 125.74234080314636
Training time/epoch 60.26656985282898
Training time without block to device /epoch 59.5458402633667
Training time without total dataloading part /epoch 58.59482502937317
load block tensor time/epoch 0.8865320682525635
block to device time/epoch 0.7207295894622803
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 11 |
Number of nodes for computation during this epoch:  9158998
Number of first layer input nodes during this epoch:  4808317
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 0.13141155242919922  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026232004165649414
random selection method range initialization spend 0.006089687347412109
time for parepare:  0.01946091651916504
local_output_nid generation:  0.0014224052429199219
local_in_edges_tensor generation:  0.00841975212097168
mini_batch_src_global generation:  0.0017778873443603516
r_  generation:  0.010908126831054688
local_output_nid generation:  0.0016527175903320312
local_in_edges_tensor generation:  0.0011096000671386719
mini_batch_src_global generation:  0.0017402172088623047
r_  generation:  0.011017322540283203
local_output_nid generation:  0.0016498565673828125
local_in_edges_tensor generation:  0.001001596450805664
mini_batch_src_global generation:  0.0011870861053466797
r_  generation:  0.010136842727661133
local_output_nid generation:  0.0016105175018310547
local_in_edges_tensor generation:  0.0009641647338867188
mini_batch_src_global generation:  0.0010991096496582031
r_  generation:  0.009612083435058594
local_output_nid generation:  0.0015828609466552734
local_in_edges_tensor generation:  0.0009529590606689453
mini_batch_src_global generation:  0.0011870861053466797
r_  generation:  0.010258674621582031
local_output_nid generation:  0.0016255378723144531
local_in_edges_tensor generation:  0.0009295940399169922
mini_batch_src_global generation:  0.0011816024780273438
r_  generation:  0.010025501251220703
local_output_nid generation:  0.0015835762023925781
local_in_edges_tensor generation:  0.0009186267852783203
mini_batch_src_global generation:  0.0011141300201416016
r_  generation:  0.00996851921081543
local_output_nid generation:  0.0015797615051269531
local_in_edges_tensor generation:  0.000904083251953125
mini_batch_src_global generation:  0.0010688304901123047
r_  generation:  0.009884357452392578
local_output_nid generation:  0.0015823841094970703
local_in_edges_tensor generation:  0.0009021759033203125
mini_batch_src_global generation:  0.0011146068572998047
r_  generation:  0.010300159454345703
local_output_nid generation:  0.0015881061553955078
local_in_edges_tensor generation:  0.0009081363677978516
mini_batch_src_global generation:  0.0011587142944335938
r_  generation:  0.010342836380004883
local_output_nid generation:  0.0015807151794433594
local_in_edges_tensor generation:  0.0009059906005859375
mini_batch_src_global generation:  0.0011556148529052734
r_  generation:  0.010254621505737305
local_output_nid generation:  0.0015995502471923828
local_in_edges_tensor generation:  0.0008890628814697266
mini_batch_src_global generation:  0.0011284351348876953
r_  generation:  0.009913206100463867
local_output_nid generation:  0.001584768295288086
local_in_edges_tensor generation:  0.0008893013000488281
mini_batch_src_global generation:  0.0010874271392822266
r_  generation:  0.009885787963867188
local_output_nid generation:  0.0015943050384521484
local_in_edges_tensor generation:  0.0008807182312011719
mini_batch_src_global generation:  0.00116729736328125
r_  generation:  0.010315179824829102
local_output_nid generation:  0.0015881061553955078
local_in_edges_tensor generation:  0.0008914470672607422
mini_batch_src_global generation:  0.0011243820190429688
r_  generation:  0.010265350341796875
local_output_nid generation:  0.0015652179718017578
local_in_edges_tensor generation:  0.0009002685546875
mini_batch_src_global generation:  0.0011856555938720703
r_  generation:  0.010684728622436523
local_output_nid generation:  0.0015971660614013672
local_in_edges_tensor generation:  0.0009002685546875
mini_batch_src_global generation:  0.0012362003326416016
r_  generation:  0.010749340057373047
local_output_nid generation:  0.001598358154296875
local_in_edges_tensor generation:  0.0008802413940429688
mini_batch_src_global generation:  0.0011811256408691406
r_  generation:  0.01011800765991211
local_output_nid generation:  0.0015833377838134766
local_in_edges_tensor generation:  0.0008959770202636719
mini_batch_src_global generation:  0.0011720657348632812
r_  generation:  0.01049184799194336
local_output_nid generation:  0.0015861988067626953
local_in_edges_tensor generation:  0.0008847713470458984
mini_batch_src_global generation:  0.0011959075927734375
r_  generation:  0.010129213333129883
local_output_nid generation:  0.0015833377838134766
local_in_edges_tensor generation:  0.0028924942016601562
mini_batch_src_global generation:  0.001201629638671875
r_  generation:  0.010498285293579102
local_output_nid generation:  0.0016050338745117188
local_in_edges_tensor generation:  0.0008780956268310547
mini_batch_src_global generation:  0.0011551380157470703
r_  generation:  0.010175943374633789
local_output_nid generation:  0.0015895366668701172
local_in_edges_tensor generation:  0.0009367465972900391
mini_batch_src_global generation:  0.0012068748474121094
r_  generation:  0.01055598258972168
local_output_nid generation:  0.0015790462493896484
local_in_edges_tensor generation:  0.0008821487426757812
mini_batch_src_global generation:  0.0011827945709228516
r_  generation:  0.010249853134155273
local_output_nid generation:  0.001577615737915039
local_in_edges_tensor generation:  0.0008709430694580078
mini_batch_src_global generation:  0.0011169910430908203
r_  generation:  0.010130643844604492
local_output_nid generation:  0.0015726089477539062
local_in_edges_tensor generation:  0.0008807182312011719
mini_batch_src_global generation:  0.0011675357818603516
r_  generation:  0.01030278205871582
local_output_nid generation:  0.00157928466796875
local_in_edges_tensor generation:  0.0009369850158691406
mini_batch_src_global generation:  0.0011746883392333984
r_  generation:  0.010944604873657227
local_output_nid generation:  0.001577615737915039
local_in_edges_tensor generation:  0.0009050369262695312
mini_batch_src_global generation:  0.001132965087890625
r_  generation:  0.01040029525756836
local_output_nid generation:  0.0015878677368164062
local_in_edges_tensor generation:  0.0008866786956787109
mini_batch_src_global generation:  0.0011358261108398438
r_  generation:  0.010426759719848633
local_output_nid generation:  0.0015914440155029297
local_in_edges_tensor generation:  0.0009291172027587891
mini_batch_src_global generation:  0.0011036396026611328
r_  generation:  0.00998687744140625
local_output_nid generation:  0.0015683174133300781
local_in_edges_tensor generation:  0.0008730888366699219
mini_batch_src_global generation:  0.0011174678802490234
r_  generation:  0.010338068008422852
local_output_nid generation:  0.0015676021575927734
local_in_edges_tensor generation:  0.0008654594421386719
mini_batch_src_global generation:  0.0011627674102783203
r_  generation:  0.010132074356079102
----------------------check_connections_block total spend ----------------------------- 0.5716462135314941
generate_one_block  0.02568984031677246
generate_one_block  0.021928787231445312
generate_one_block  0.019723176956176758
generate_one_block  0.018282651901245117
generate_one_block  0.01921391487121582
generate_one_block  0.01850128173828125
generate_one_block  0.018034696578979492
generate_one_block  0.017890453338623047
generate_one_block  0.018517017364501953
generate_one_block  0.018448829650878906
generate_one_block  0.01813650131225586
generate_one_block  0.01792454719543457
generate_one_block  0.017623186111450195
generate_one_block  0.018565654754638672
generate_one_block  0.018339157104492188
generate_one_block  0.01919698715209961
generate_one_block  0.01893448829650879
generate_one_block  0.018187999725341797
generate_one_block  0.018687009811401367
generate_one_block  0.018373489379882812
generate_one_block  0.01821613311767578
generate_one_block  0.017939090728759766
generate_one_block  0.02211785316467285
generate_one_block  0.01919412612915039
generate_one_block  0.01847076416015625
generate_one_block  0.018596649169921875
generate_one_block  0.01950812339782715
generate_one_block  0.018558025360107422
generate_one_block  0.018696069717407227
generate_one_block  0.017735719680786133
generate_one_block  0.018418550491333008
generate_one_block  0.018208742141723633
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.039934396743774414
gen group dst list time:  0.0229339599609375
time for parepare:  0.02289128303527832
local_output_nid generation:  0.0067157745361328125
local_in_edges_tensor generation:  0.02140974998474121
mini_batch_src_global generation:  0.01793527603149414
r_  generation:  0.16699886322021484
local_output_nid generation:  0.009469270706176758
local_in_edges_tensor generation:  0.011625051498413086
mini_batch_src_global generation:  0.023227930068969727
r_  generation:  0.17488694190979004
local_output_nid generation:  0.009940385818481445
local_in_edges_tensor generation:  0.034941673278808594
mini_batch_src_global generation:  0.02142190933227539
r_  generation:  0.17953109741210938
local_output_nid generation:  0.010422945022583008
local_in_edges_tensor generation:  0.012054920196533203
mini_batch_src_global generation:  0.021813631057739258
r_  generation:  0.17114043235778809
local_output_nid generation:  0.009942293167114258
local_in_edges_tensor generation:  0.009460210800170898
mini_batch_src_global generation:  0.023056507110595703
r_  generation:  0.1866762638092041
local_output_nid generation:  0.009367942810058594
local_in_edges_tensor generation:  0.011157512664794922
mini_batch_src_global generation:  0.02362990379333496
r_  generation:  0.17661547660827637
local_output_nid generation:  0.009134292602539062
local_in_edges_tensor generation:  0.009966611862182617
mini_batch_src_global generation:  0.022489070892333984
r_  generation:  0.17501091957092285
local_output_nid generation:  0.009101390838623047
local_in_edges_tensor generation:  0.009811878204345703
mini_batch_src_global generation:  0.0233309268951416
r_  generation:  0.17433929443359375
local_output_nid generation:  0.009360074996948242
local_in_edges_tensor generation:  0.011972904205322266
mini_batch_src_global generation:  0.023470640182495117
r_  generation:  0.18214750289916992
local_output_nid generation:  0.009472131729125977
local_in_edges_tensor generation:  0.011988639831542969
mini_batch_src_global generation:  0.024340152740478516
r_  generation:  0.18113493919372559
local_output_nid generation:  0.00945138931274414
local_in_edges_tensor generation:  0.009378671646118164
mini_batch_src_global generation:  0.022780895233154297
r_  generation:  0.17891263961791992
local_output_nid generation:  0.009438276290893555
local_in_edges_tensor generation:  0.008876323699951172
mini_batch_src_global generation:  0.022502660751342773
r_  generation:  0.17389202117919922
local_output_nid generation:  0.00950312614440918
local_in_edges_tensor generation:  0.008708477020263672
mini_batch_src_global generation:  0.022581100463867188
r_  generation:  0.17798614501953125
local_output_nid generation:  0.009889364242553711
local_in_edges_tensor generation:  0.012080669403076172
mini_batch_src_global generation:  0.02466607093811035
r_  generation:  0.18332576751708984
local_output_nid generation:  0.009709596633911133
local_in_edges_tensor generation:  0.009464025497436523
mini_batch_src_global generation:  0.02271127700805664
r_  generation:  0.1833033561706543
local_output_nid generation:  0.01023101806640625
local_in_edges_tensor generation:  0.00967717170715332
mini_batch_src_global generation:  0.02525472640991211
r_  generation:  0.18938755989074707
local_output_nid generation:  0.010090112686157227
local_in_edges_tensor generation:  0.009681224822998047
mini_batch_src_global generation:  0.024277687072753906
r_  generation:  0.18839001655578613
local_output_nid generation:  0.009670495986938477
local_in_edges_tensor generation:  0.009248018264770508
mini_batch_src_global generation:  0.02327704429626465
r_  generation:  0.17920923233032227
local_output_nid generation:  0.009884119033813477
local_in_edges_tensor generation:  0.009341716766357422
mini_batch_src_global generation:  0.024120807647705078
r_  generation:  0.18519020080566406
local_output_nid generation:  0.009739398956298828
local_in_edges_tensor generation:  0.009050369262695312
mini_batch_src_global generation:  0.023357152938842773
r_  generation:  0.18142414093017578
local_output_nid generation:  0.009906291961669922
local_in_edges_tensor generation:  0.009318828582763672
mini_batch_src_global generation:  0.024015426635742188
r_  generation:  0.18976426124572754
local_output_nid generation:  0.009655475616455078
local_in_edges_tensor generation:  0.009505033493041992
mini_batch_src_global generation:  0.02411937713623047
r_  generation:  0.1814577579498291
local_output_nid generation:  0.009776830673217773
local_in_edges_tensor generation:  0.010203123092651367
mini_batch_src_global generation:  0.023731470108032227
r_  generation:  0.18764662742614746
local_output_nid generation:  0.009824275970458984
local_in_edges_tensor generation:  0.010595560073852539
mini_batch_src_global generation:  0.023926496505737305
r_  generation:  0.18177485466003418
local_output_nid generation:  0.009639501571655273
local_in_edges_tensor generation:  0.009332895278930664
mini_batch_src_global generation:  0.022917747497558594
r_  generation:  0.18009233474731445
local_output_nid generation:  0.009918451309204102
local_in_edges_tensor generation:  0.009535074234008789
mini_batch_src_global generation:  0.023927927017211914
r_  generation:  0.18388581275939941
local_output_nid generation:  0.010349035263061523
local_in_edges_tensor generation:  0.009388208389282227
mini_batch_src_global generation:  0.025429248809814453
r_  generation:  0.19748139381408691
local_output_nid generation:  0.009992361068725586
local_in_edges_tensor generation:  0.011062145233154297
mini_batch_src_global generation:  0.02454352378845215
r_  generation:  0.18703556060791016
local_output_nid generation:  0.009660720825195312
local_in_edges_tensor generation:  0.009374141693115234
mini_batch_src_global generation:  0.02391338348388672
r_  generation:  0.1890852451324463
local_output_nid generation:  0.00933980941772461
local_in_edges_tensor generation:  0.009187459945678711
mini_batch_src_global generation:  0.023246288299560547
r_  generation:  0.17671847343444824
local_output_nid generation:  0.009750127792358398
local_in_edges_tensor generation:  0.009608745574951172
mini_batch_src_global generation:  0.023100852966308594
r_  generation:  0.18520188331604004
local_output_nid generation:  0.009567737579345703
local_in_edges_tensor generation:  0.008943319320678711
mini_batch_src_global generation:  0.023442983627319336
r_  generation:  0.18200278282165527
----------------------check_connections_block total spend ----------------------------- 8.547515153884888
generate_one_block  0.25774216651916504
generate_one_block  0.25044727325439453
generate_one_block  0.24773669242858887
generate_one_block  0.23875784873962402
generate_one_block  0.27163219451904297
generate_one_block  0.2422780990600586
generate_one_block  0.24227380752563477
generate_one_block  0.24109911918640137
generate_one_block  0.24460721015930176
generate_one_block  0.24688482284545898
generate_one_block  0.24062609672546387
generate_one_block  0.23779630661010742
generate_one_block  0.24168133735656738
generate_one_block  0.2523951530456543
generate_one_block  0.24050188064575195
generate_one_block  0.25620365142822266
generate_one_block  0.25116944313049316
generate_one_block  0.2417004108428955
generate_one_block  0.24590563774108887
generate_one_block  0.2548985481262207
generate_one_block  0.25026655197143555
generate_one_block  0.24433565139770508
generate_one_block  0.2547342777252197
generate_one_block  0.24567461013793945
generate_one_block  0.2396221160888672
generate_one_block  0.2504408359527588
generate_one_block  0.26396656036376953
generate_one_block  0.2486414909362793
generate_one_block  0.2533698081970215
generate_one_block  0.2369399070739746
generate_one_block  0.24563336372375488
generate_one_block  0.2453293800354004
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04503011703491211
gen group dst list time:  0.10805106163024902
time for parepare:  0.021399974822998047
local_output_nid generation:  0.026288270950317383
local_in_edges_tensor generation:  0.051718711853027344
mini_batch_src_global generation:  0.04744553565979004
r_  generation:  0.49196481704711914
local_output_nid generation:  0.031909942626953125
local_in_edges_tensor generation:  0.039026498794555664
mini_batch_src_global generation:  0.06100964546203613
r_  generation:  0.48601341247558594
local_output_nid generation:  0.03241276741027832
local_in_edges_tensor generation:  0.03713035583496094
mini_batch_src_global generation:  0.0579226016998291
r_  generation:  0.49779748916625977
local_output_nid generation:  0.03169512748718262
local_in_edges_tensor generation:  0.03838944435119629
mini_batch_src_global generation:  0.06032156944274902
r_  generation:  0.48659324645996094
local_output_nid generation:  0.0344548225402832
local_in_edges_tensor generation:  0.031385183334350586
mini_batch_src_global generation:  0.0607302188873291
r_  generation:  0.5075361728668213
local_output_nid generation:  0.03216981887817383
local_in_edges_tensor generation:  0.034415245056152344
mini_batch_src_global generation:  0.05948019027709961
r_  generation:  0.5019457340240479
local_output_nid generation:  0.029995441436767578
local_in_edges_tensor generation:  0.030237436294555664
mini_batch_src_global generation:  0.06080126762390137
r_  generation:  0.500770092010498
local_output_nid generation:  0.029639005661010742
local_in_edges_tensor generation:  0.038713693618774414
mini_batch_src_global generation:  0.059548139572143555
r_  generation:  0.49306726455688477
local_output_nid generation:  0.029794692993164062
local_in_edges_tensor generation:  0.036635398864746094
mini_batch_src_global generation:  0.05837082862854004
r_  generation:  0.5036046504974365
local_output_nid generation:  0.029599666595458984
local_in_edges_tensor generation:  0.033452749252319336
mini_batch_src_global generation:  0.06009936332702637
r_  generation:  0.49332332611083984
local_output_nid generation:  0.02959752082824707
local_in_edges_tensor generation:  0.029738187789916992
mini_batch_src_global generation:  0.05821657180786133
r_  generation:  0.502770185470581
local_output_nid generation:  0.029695510864257812
local_in_edges_tensor generation:  0.03218197822570801
mini_batch_src_global generation:  0.05948638916015625
r_  generation:  0.4940471649169922
local_output_nid generation:  0.029300928115844727
local_in_edges_tensor generation:  0.03198671340942383
mini_batch_src_global generation:  0.057981014251708984
r_  generation:  0.4984164237976074
local_output_nid generation:  0.029715538024902344
local_in_edges_tensor generation:  0.030108928680419922
mini_batch_src_global generation:  0.06150341033935547
r_  generation:  0.4994630813598633
local_output_nid generation:  0.0294344425201416
local_in_edges_tensor generation:  0.0301516056060791
mini_batch_src_global generation:  0.058385610580444336
r_  generation:  0.5041167736053467
local_output_nid generation:  0.030153512954711914
local_in_edges_tensor generation:  0.0387568473815918
mini_batch_src_global generation:  0.0624394416809082
r_  generation:  0.49918150901794434
local_output_nid generation:  0.029673099517822266
local_in_edges_tensor generation:  0.029538631439208984
mini_batch_src_global generation:  0.058478593826293945
r_  generation:  0.49919676780700684
local_output_nid generation:  0.02934718132019043
local_in_edges_tensor generation:  0.03246760368347168
mini_batch_src_global generation:  0.06907463073730469
r_  generation:  0.4947628974914551
local_output_nid generation:  0.031003713607788086
local_in_edges_tensor generation:  0.03055596351623535
mini_batch_src_global generation:  0.057875871658325195
r_  generation:  0.49809718132019043
local_output_nid generation:  0.030317306518554688
local_in_edges_tensor generation:  0.029819726943969727
mini_batch_src_global generation:  0.061486005783081055
r_  generation:  0.4919929504394531
local_output_nid generation:  0.03028559684753418
local_in_edges_tensor generation:  0.03121185302734375
mini_batch_src_global generation:  0.05839133262634277
r_  generation:  0.4970095157623291
local_output_nid generation:  0.030023813247680664
local_in_edges_tensor generation:  0.0301358699798584
mini_batch_src_global generation:  0.05938005447387695
r_  generation:  0.492950439453125
local_output_nid generation:  0.030278682708740234
local_in_edges_tensor generation:  0.03247642517089844
mini_batch_src_global generation:  0.060457706451416016
r_  generation:  0.502683162689209
local_output_nid generation:  0.030499696731567383
local_in_edges_tensor generation:  0.0319371223449707
mini_batch_src_global generation:  0.059705495834350586
r_  generation:  0.5001242160797119
local_output_nid generation:  0.03062725067138672
local_in_edges_tensor generation:  0.03065657615661621
mini_batch_src_global generation:  0.05795407295227051
r_  generation:  0.5026280879974365
local_output_nid generation:  0.030400514602661133
local_in_edges_tensor generation:  0.02942180633544922
mini_batch_src_global generation:  0.05939173698425293
r_  generation:  0.4976036548614502
local_output_nid generation:  0.031154632568359375
local_in_edges_tensor generation:  0.032208919525146484
mini_batch_src_global generation:  0.05855679512023926
r_  generation:  0.5032660961151123
local_output_nid generation:  0.030463218688964844
local_in_edges_tensor generation:  0.031002283096313477
mini_batch_src_global generation:  0.05955052375793457
r_  generation:  0.49773669242858887
local_output_nid generation:  0.030403852462768555
local_in_edges_tensor generation:  0.031745195388793945
mini_batch_src_global generation:  0.05792856216430664
r_  generation:  0.502608060836792
local_output_nid generation:  0.030040502548217773
local_in_edges_tensor generation:  0.029543638229370117
mini_batch_src_global generation:  0.0589752197265625
r_  generation:  0.4927103519439697
local_output_nid generation:  0.030498266220092773
local_in_edges_tensor generation:  0.03248262405395508
mini_batch_src_global generation:  0.06072258949279785
r_  generation:  0.5020244121551514
local_output_nid generation:  0.03020644187927246
local_in_edges_tensor generation:  0.029521942138671875
mini_batch_src_global generation:  0.05901741981506348
r_  generation:  0.48970532417297363
----------------------check_connections_block total spend ----------------------------- 23.332889795303345
generate_one_block  0.6863360404968262
generate_one_block  0.6744530200958252
generate_one_block  0.6726968288421631
generate_one_block  0.6652235984802246
generate_one_block  0.7767219543457031
generate_one_block  0.6763730049133301
generate_one_block  0.6697096824645996
generate_one_block  0.6731648445129395
generate_one_block  0.6797943115234375
generate_one_block  0.6626322269439697
generate_one_block  0.6711125373840332
generate_one_block  0.6711230278015137
generate_one_block  0.662632942199707
generate_one_block  0.6832349300384521
generate_one_block  0.6685588359832764
generate_one_block  0.6832611560821533
generate_one_block  0.6715512275695801
generate_one_block  0.6708626747131348
generate_one_block  0.6657137870788574
generate_one_block  0.6790783405303955
generate_one_block  0.6841742992401123
generate_one_block  0.6688799858093262
generate_one_block  0.6803164482116699
generate_one_block  0.6790761947631836
generate_one_block  0.6962287425994873
generate_one_block  0.6739487648010254
generate_one_block  0.6814501285552979
generate_one_block  0.672868013381958
generate_one_block  0.6793022155761719
generate_one_block  0.6797077655792236
generate_one_block  0.6728830337524414
generate_one_block  0.6703445911407471
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 0.13141155242919922  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

connection checking time:  31.880404949188232
block generation total time  29.62870740890503
average batch blocks generation time:  0.9258971065282822
block dataloader generation time/epoch 65.26871808369954
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 0.10999917984008789  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 21.012410640716553  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 0.10934829711914062  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 21.00921869277954  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 0.10994434356689453  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 20.952953815460205  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 0.10900402069091797  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 20.487507343292236  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 0.11011886596679688  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 21.269689559936523  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 0.10919857025146484  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 20.696606159210205  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 0.10966014862060547  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 20.443662643432617  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 0.1090235710144043  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 20.573781490325928  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 0.10984134674072266  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 20.7483811378479  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 0.10904169082641602  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 20.726322174072266  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 0.10972404479980469  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 20.560799598693848  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 0.1090383529663086  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 20.394715309143066  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 0.10844659805297852  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 20.38059711456299  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 0.10927486419677734  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 20.88549280166626  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 0.10970592498779297  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 20.557873725891113  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3182373046875 GB
    Memory Allocated: 0.1098947525024414  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2401123046875 GB
    Memory Allocated: 21.358922004699707  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7576904296875 GB
    Memory Allocated: 0.1090540885925293  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7342529296875 GB
    Memory Allocated: 20.972843170166016  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7362060546875 GB
    Memory Allocated: 0.10903310775756836  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7830810546875 GB
    Memory Allocated: 20.548776626586914  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7869873046875 GB
    Memory Allocated: 0.10910892486572266  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9217529296875 GB
    Memory Allocated: 20.725067138671875  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9237060546875 GB
    Memory Allocated: 0.10923957824707031  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9237060546875 GB
    Memory Allocated: 20.705597400665283  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4354248046875 GB
    Memory Allocated: 0.10914039611816406  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4354248046875 GB
    Memory Allocated: 20.797537326812744  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4354248046875 GB
    Memory Allocated: 0.10910797119140625  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4354248046875 GB
    Memory Allocated: 20.62616729736328  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4354248046875 GB
    Memory Allocated: 0.10927629470825195  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4725341796875 GB
    Memory Allocated: 20.974855422973633  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4764404296875 GB
    Memory Allocated: 0.10937356948852539  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4764404296875 GB
    Memory Allocated: 20.79447031021118  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4764404296875 GB
    Memory Allocated: 0.10920906066894531  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4764404296875 GB
    Memory Allocated: 20.506840705871582  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4764404296875 GB
    Memory Allocated: 0.10927486419677734  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4764404296875 GB
    Memory Allocated: 20.828706741333008  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4764404296875 GB
    Memory Allocated: 0.10968255996704102  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4764404296875 GB
    Memory Allocated: 21.35736656188965  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7303466796875 GB
    Memory Allocated: 0.10926675796508789  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2030029296875 GB
    Memory Allocated: 20.908629417419434  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2049560546875 GB
    Memory Allocated: 0.1095438003540039  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2049560546875 GB
    Memory Allocated: 21.017112255096436  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2049560546875 GB
    Memory Allocated: 0.1087026596069336  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2049560546875 GB
    Memory Allocated: 20.343750476837158  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2049560546875 GB
    Memory Allocated: 0.10901689529418945  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2303466796875 GB
    Memory Allocated: 20.74781084060669  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2342529296875 GB
    Memory Allocated: 0.10900497436523438  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2342529296875 GB
    Memory Allocated: 20.575933933258057  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.027965709567070007 |0.022437475621700287 |0.682788610458374 |9.551644325256348e-05 |1.2073068842291832 |0.006299495697021484 |
----------------------------------------------------------pseudo_mini_loss sum 1.5934056043624878
Total (block generation + training)time/epoch 126.25344347953796
Training time/epoch 62.176961183547974
Training time without block to device /epoch 61.458961963653564
Training time without total dataloading part /epoch 60.492411851882935
load block tensor time/epoch 0.8949027061462402
block to device time/epoch 0.7179992198944092
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 12 |
Number of nodes for computation during this epoch:  9158301
Number of first layer input nodes during this epoch:  4806754
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.2342529296875 GB
    Memory Allocated: 0.13084030151367188  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02568793296813965
random selection method range initialization spend 0.006868839263916016
time for parepare:  0.021483182907104492
local_output_nid generation:  0.001447916030883789
local_in_edges_tensor generation:  0.004826784133911133
mini_batch_src_global generation:  0.0018148422241210938
r_  generation:  0.010972261428833008
local_output_nid generation:  0.0016777515411376953
local_in_edges_tensor generation:  0.0011289119720458984
mini_batch_src_global generation:  0.0016551017761230469
r_  generation:  0.010347366333007812
local_output_nid generation:  0.0016331672668457031
local_in_edges_tensor generation:  0.0010302066802978516
mini_batch_src_global generation:  0.0011942386627197266
r_  generation:  0.009690284729003906
local_output_nid generation:  0.0016138553619384766
local_in_edges_tensor generation:  0.0009660720825195312
mini_batch_src_global generation:  0.0012111663818359375
r_  generation:  0.010158300399780273
local_output_nid generation:  0.0015871524810791016
local_in_edges_tensor generation:  0.0009555816650390625
mini_batch_src_global generation:  0.0011944770812988281
r_  generation:  0.010085105895996094
local_output_nid generation:  0.0015919208526611328
local_in_edges_tensor generation:  0.0009324550628662109
mini_batch_src_global generation:  0.0011448860168457031
r_  generation:  0.010136842727661133
local_output_nid generation:  0.0016095638275146484
local_in_edges_tensor generation:  0.0009379386901855469
mini_batch_src_global generation:  0.0011365413665771484
r_  generation:  0.010070323944091797
local_output_nid generation:  0.0015666484832763672
local_in_edges_tensor generation:  0.0009305477142333984
mini_batch_src_global generation:  0.0011031627655029297
r_  generation:  0.010137796401977539
local_output_nid generation:  0.0015888214111328125
local_in_edges_tensor generation:  0.0009188652038574219
mini_batch_src_global generation:  0.0011420249938964844
r_  generation:  0.009903430938720703
local_output_nid generation:  0.001615285873413086
local_in_edges_tensor generation:  0.0009202957153320312
mini_batch_src_global generation:  0.001094818115234375
r_  generation:  0.01013636589050293
local_output_nid generation:  0.0015904903411865234
local_in_edges_tensor generation:  0.0009055137634277344
mini_batch_src_global generation:  0.0011417865753173828
r_  generation:  0.010274171829223633
local_output_nid generation:  0.001577615737915039
local_in_edges_tensor generation:  0.0009539127349853516
mini_batch_src_global generation:  0.0011935234069824219
r_  generation:  0.010505914688110352
local_output_nid generation:  0.0016047954559326172
local_in_edges_tensor generation:  0.0009114742279052734
mini_batch_src_global generation:  0.0011682510375976562
r_  generation:  0.010451793670654297
local_output_nid generation:  0.0015978813171386719
local_in_edges_tensor generation:  0.0009317398071289062
mini_batch_src_global generation:  0.0011699199676513672
r_  generation:  0.010693788528442383
local_output_nid generation:  0.0015857219696044922
local_in_edges_tensor generation:  0.0009207725524902344
mini_batch_src_global generation:  0.0011303424835205078
r_  generation:  0.009942054748535156
local_output_nid generation:  0.0015747547149658203
local_in_edges_tensor generation:  0.0009114742279052734
mini_batch_src_global generation:  0.0010869503021240234
r_  generation:  0.009867191314697266
local_output_nid generation:  0.0015788078308105469
local_in_edges_tensor generation:  0.0009188652038574219
mini_batch_src_global generation:  0.0011801719665527344
r_  generation:  0.01017904281616211
local_output_nid generation:  0.0015902519226074219
local_in_edges_tensor generation:  0.0009267330169677734
mini_batch_src_global generation:  0.0011630058288574219
r_  generation:  0.01029825210571289
local_output_nid generation:  0.0015821456909179688
local_in_edges_tensor generation:  0.0009210109710693359
mini_batch_src_global generation:  0.0012333393096923828
r_  generation:  0.010480642318725586
local_output_nid generation:  0.001600027084350586
local_in_edges_tensor generation:  0.0008921623229980469
mini_batch_src_global generation:  0.0011286735534667969
r_  generation:  0.010274887084960938
local_output_nid generation:  0.0016207695007324219
local_in_edges_tensor generation:  0.0009000301361083984
mini_batch_src_global generation:  0.0011665821075439453
r_  generation:  0.010306358337402344
local_output_nid generation:  0.0015861988067626953
local_in_edges_tensor generation:  0.0009398460388183594
mini_batch_src_global generation:  0.001216888427734375
r_  generation:  0.010837554931640625
local_output_nid generation:  0.0015728473663330078
local_in_edges_tensor generation:  0.0009191036224365234
mini_batch_src_global generation:  0.0011723041534423828
r_  generation:  0.009932518005371094
local_output_nid generation:  0.0015959739685058594
local_in_edges_tensor generation:  0.0009145736694335938
mini_batch_src_global generation:  0.0011014938354492188
r_  generation:  0.009954214096069336
local_output_nid generation:  0.0015995502471923828
local_in_edges_tensor generation:  0.0009000301361083984
mini_batch_src_global generation:  0.0011894702911376953
r_  generation:  0.010522842407226562
local_output_nid generation:  0.0015823841094970703
local_in_edges_tensor generation:  0.000919342041015625
mini_batch_src_global generation:  0.0011761188507080078
r_  generation:  0.009953022003173828
local_output_nid generation:  0.001589059829711914
local_in_edges_tensor generation:  0.0009288787841796875
mini_batch_src_global generation:  0.001135110855102539
r_  generation:  0.010237693786621094
local_output_nid generation:  0.0015864372253417969
local_in_edges_tensor generation:  0.0009019374847412109
mini_batch_src_global generation:  0.0012238025665283203
r_  generation:  0.01040029525756836
local_output_nid generation:  0.0015866756439208984
local_in_edges_tensor generation:  0.0008857250213623047
mini_batch_src_global generation:  0.0011789798736572266
r_  generation:  0.010657310485839844
local_output_nid generation:  0.0015780925750732422
local_in_edges_tensor generation:  0.0009019374847412109
mini_batch_src_global generation:  0.0011298656463623047
r_  generation:  0.010329484939575195
local_output_nid generation:  0.001577138900756836
local_in_edges_tensor generation:  0.0009312629699707031
mini_batch_src_global generation:  0.0011794567108154297
r_  generation:  0.010775327682495117
local_output_nid generation:  0.0015823841094970703
local_in_edges_tensor generation:  0.0009012222290039062
mini_batch_src_global generation:  0.0011692047119140625
r_  generation:  0.010537862777709961
----------------------check_connections_block total spend ----------------------------- 0.5682308673858643
generate_one_block  0.02516794204711914
generate_one_block  0.02143573760986328
generate_one_block  0.019041776657104492
generate_one_block  0.019081830978393555
generate_one_block  0.018782615661621094
generate_one_block  0.0184781551361084
generate_one_block  0.01838850975036621
generate_one_block  0.018533706665039062
generate_one_block  0.01806807518005371
generate_one_block  0.018445968627929688
generate_one_block  0.018728017807006836
generate_one_block  0.01935124397277832
generate_one_block  0.01866459846496582
generate_one_block  0.01883101463317871
generate_one_block  0.0178983211517334
generate_one_block  0.01774001121520996
generate_one_block  0.018692970275878906
generate_one_block  0.018584728240966797
generate_one_block  0.018911361694335938
generate_one_block  0.018542051315307617
generate_one_block  0.018631458282470703
generate_one_block  0.019193410873413086
generate_one_block  0.02117776870727539
generate_one_block  0.01863265037536621
generate_one_block  0.01925826072692871
generate_one_block  0.018096923828125
generate_one_block  0.018340349197387695
generate_one_block  0.0186004638671875
generate_one_block  0.01907825469970703
generate_one_block  0.01847529411315918
generate_one_block  0.019447803497314453
generate_one_block  0.018839597702026367
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0390324592590332
gen group dst list time:  0.0230410099029541
time for parepare:  0.02151322364807129
local_output_nid generation:  0.006554126739501953
local_in_edges_tensor generation:  0.018302440643310547
mini_batch_src_global generation:  0.020198345184326172
r_  generation:  0.16788911819458008
local_output_nid generation:  0.009304285049438477
local_in_edges_tensor generation:  0.01243448257446289
mini_batch_src_global generation:  0.021635770797729492
r_  generation:  0.17186927795410156
local_output_nid generation:  0.009413957595825195
local_in_edges_tensor generation:  0.03510737419128418
mini_batch_src_global generation:  0.020752429962158203
r_  generation:  0.16884589195251465
local_output_nid generation:  0.00973820686340332
local_in_edges_tensor generation:  0.00912618637084961
mini_batch_src_global generation:  0.020618915557861328
r_  generation:  0.17625975608825684
local_output_nid generation:  0.009699583053588867
local_in_edges_tensor generation:  0.011123180389404297
mini_batch_src_global generation:  0.022261857986450195
r_  generation:  0.17883729934692383
local_output_nid generation:  0.009428262710571289
local_in_edges_tensor generation:  0.009145736694335938
mini_batch_src_global generation:  0.022783517837524414
r_  generation:  0.18118715286254883
local_output_nid generation:  0.009119272232055664
local_in_edges_tensor generation:  0.0106201171875
mini_batch_src_global generation:  0.02372884750366211
r_  generation:  0.17759323120117188
local_output_nid generation:  0.009211301803588867
local_in_edges_tensor generation:  0.013377904891967773
mini_batch_src_global generation:  0.02276134490966797
r_  generation:  0.18142938613891602
local_output_nid generation:  0.009253501892089844
local_in_edges_tensor generation:  0.009073734283447266
mini_batch_src_global generation:  0.025168895721435547
r_  generation:  0.17823576927185059
local_output_nid generation:  0.009422063827514648
local_in_edges_tensor generation:  0.009189844131469727
mini_batch_src_global generation:  0.022434711456298828
r_  generation:  0.1793045997619629
local_output_nid generation:  0.00954437255859375
local_in_edges_tensor generation:  0.008928060531616211
mini_batch_src_global generation:  0.022706985473632812
r_  generation:  0.18013596534729004
local_output_nid generation:  0.009588479995727539
local_in_edges_tensor generation:  0.009164571762084961
mini_batch_src_global generation:  0.024394512176513672
r_  generation:  0.18314099311828613
local_output_nid generation:  0.00974273681640625
local_in_edges_tensor generation:  0.010425329208374023
mini_batch_src_global generation:  0.0232388973236084
r_  generation:  0.18564677238464355
local_output_nid generation:  0.00971674919128418
local_in_edges_tensor generation:  0.010680437088012695
mini_batch_src_global generation:  0.023213624954223633
r_  generation:  0.1830732822418213
local_output_nid generation:  0.009369373321533203
local_in_edges_tensor generation:  0.011639833450317383
mini_batch_src_global generation:  0.023229360580444336
r_  generation:  0.17663931846618652
local_output_nid generation:  0.00935983657836914
local_in_edges_tensor generation:  0.010376453399658203
mini_batch_src_global generation:  0.02166152000427246
r_  generation:  0.17371773719787598
local_output_nid generation:  0.009562492370605469
local_in_edges_tensor generation:  0.009311676025390625
mini_batch_src_global generation:  0.022989511489868164
r_  generation:  0.1820816993713379
local_output_nid generation:  0.009643793106079102
local_in_edges_tensor generation:  0.009177684783935547
mini_batch_src_global generation:  0.02298426628112793
r_  generation:  0.1785731315612793
local_output_nid generation:  0.009870052337646484
local_in_edges_tensor generation:  0.010234832763671875
mini_batch_src_global generation:  0.024545907974243164
r_  generation:  0.1877596378326416
local_output_nid generation:  0.009625911712646484
local_in_edges_tensor generation:  0.009887218475341797
mini_batch_src_global generation:  0.02604222297668457
r_  generation:  0.18587422370910645
local_output_nid generation:  0.00971078872680664
local_in_edges_tensor generation:  0.009962797164916992
mini_batch_src_global generation:  0.023177623748779297
r_  generation:  0.18379521369934082
local_output_nid generation:  0.009883403778076172
local_in_edges_tensor generation:  0.012487649917602539
mini_batch_src_global generation:  0.02484130859375
r_  generation:  0.18810224533081055
local_output_nid generation:  0.009456396102905273
local_in_edges_tensor generation:  0.009693384170532227
mini_batch_src_global generation:  0.022627830505371094
r_  generation:  0.17766237258911133
local_output_nid generation:  0.009485721588134766
local_in_edges_tensor generation:  0.008889436721801758
mini_batch_src_global generation:  0.022372722625732422
r_  generation:  0.175933837890625
local_output_nid generation:  0.009885549545288086
local_in_edges_tensor generation:  0.009409427642822266
mini_batch_src_global generation:  0.023215293884277344
r_  generation:  0.18617749214172363
local_output_nid generation:  0.009522438049316406
local_in_edges_tensor generation:  0.008813619613647461
mini_batch_src_global generation:  0.02285289764404297
r_  generation:  0.17817330360412598
local_output_nid generation:  0.009575605392456055
local_in_edges_tensor generation:  0.009077310562133789
mini_batch_src_global generation:  0.02284073829650879
r_  generation:  0.1816267967224121
local_output_nid generation:  0.009774446487426758
local_in_edges_tensor generation:  0.009009122848510742
mini_batch_src_global generation:  0.024002552032470703
r_  generation:  0.18566370010375977
local_output_nid generation:  0.009865283966064453
local_in_edges_tensor generation:  0.010740280151367188
mini_batch_src_global generation:  0.023566484451293945
r_  generation:  0.18981289863586426
local_output_nid generation:  0.009543418884277344
local_in_edges_tensor generation:  0.009044170379638672
mini_batch_src_global generation:  0.02309393882751465
r_  generation:  0.18265104293823242
local_output_nid generation:  0.009753227233886719
local_in_edges_tensor generation:  0.010960578918457031
mini_batch_src_global generation:  0.02492213249206543
r_  generation:  0.19219255447387695
local_output_nid generation:  0.009740352630615234
local_in_edges_tensor generation:  0.010647058486938477
mini_batch_src_global generation:  0.026712417602539062
r_  generation:  0.188140869140625
----------------------check_connections_block total spend ----------------------------- 8.511492490768433
generate_one_block  0.2524752616882324
generate_one_block  0.24816632270812988
generate_one_block  0.2387406826019287
generate_one_block  0.24445891380310059
generate_one_block  0.26418399810791016
generate_one_block  0.2494373321533203
generate_one_block  0.24131298065185547
generate_one_block  0.24766850471496582
generate_one_block  0.24440312385559082
generate_one_block  0.24854755401611328
generate_one_block  0.24947571754455566
generate_one_block  0.25409436225891113
generate_one_block  0.24904990196228027
generate_one_block  0.2490854263305664
generate_one_block  0.2361748218536377
generate_one_block  0.23508620262145996
generate_one_block  0.24786019325256348
generate_one_block  0.24471759796142578
generate_one_block  0.2587273120880127
generate_one_block  0.25780272483825684
generate_one_block  0.24971795082092285
generate_one_block  0.2577948570251465
generate_one_block  0.23621869087219238
generate_one_block  0.23848581314086914
generate_one_block  0.2474806308746338
generate_one_block  0.23817801475524902
generate_one_block  0.2435288429260254
generate_one_block  0.2501518726348877
generate_one_block  0.25584983825683594
generate_one_block  0.24515795707702637
generate_one_block  0.26456618309020996
generate_one_block  0.24935078620910645
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03938174247741699
gen group dst list time:  0.10647225379943848
time for parepare:  0.02067422866821289
local_output_nid generation:  0.025983095169067383
local_in_edges_tensor generation:  0.04872536659240723
mini_batch_src_global generation:  0.0470273494720459
r_  generation:  0.4933598041534424
local_output_nid generation:  0.03196573257446289
local_in_edges_tensor generation:  0.03879070281982422
mini_batch_src_global generation:  0.05881357192993164
r_  generation:  0.48899364471435547
local_output_nid generation:  0.031342267990112305
local_in_edges_tensor generation:  0.034308671951293945
mini_batch_src_global generation:  0.05677938461303711
r_  generation:  0.49155163764953613
local_output_nid generation:  0.03151130676269531
local_in_edges_tensor generation:  0.030421972274780273
mini_batch_src_global generation:  0.06036520004272461
r_  generation:  0.48824024200439453
local_output_nid generation:  0.031728267669677734
local_in_edges_tensor generation:  0.03345847129821777
mini_batch_src_global generation:  0.05784416198730469
r_  generation:  0.49888038635253906
local_output_nid generation:  0.03163576126098633
local_in_edges_tensor generation:  0.03159523010253906
mini_batch_src_global generation:  0.05947685241699219
r_  generation:  0.49463963508605957
local_output_nid generation:  0.03070807456970215
local_in_edges_tensor generation:  0.03214597702026367
mini_batch_src_global generation:  0.0579986572265625
r_  generation:  0.49953484535217285
local_output_nid generation:  0.029822826385498047
local_in_edges_tensor generation:  0.030399084091186523
mini_batch_src_global generation:  0.059220075607299805
r_  generation:  0.49253058433532715
local_output_nid generation:  0.029924392700195312
local_in_edges_tensor generation:  0.029307126998901367
mini_batch_src_global generation:  0.0584716796875
r_  generation:  0.49665141105651855
local_output_nid generation:  0.02969837188720703
local_in_edges_tensor generation:  0.031777381896972656
mini_batch_src_global generation:  0.0595707893371582
r_  generation:  0.4925708770751953
local_output_nid generation:  0.029619455337524414
local_in_edges_tensor generation:  0.03178811073303223
mini_batch_src_global generation:  0.05781388282775879
r_  generation:  0.49693870544433594
local_output_nid generation:  0.029574871063232422
local_in_edges_tensor generation:  0.03174948692321777
mini_batch_src_global generation:  0.05866718292236328
r_  generation:  0.4921281337738037
local_output_nid generation:  0.029842853546142578
local_in_edges_tensor generation:  0.03612041473388672
mini_batch_src_global generation:  0.05788731575012207
r_  generation:  0.4952120780944824
local_output_nid generation:  0.029553651809692383
local_in_edges_tensor generation:  0.034357309341430664
mini_batch_src_global generation:  0.05918478965759277
r_  generation:  0.49195241928100586
local_output_nid generation:  0.02959442138671875
local_in_edges_tensor generation:  0.0312042236328125
mini_batch_src_global generation:  0.05704855918884277
r_  generation:  0.49465274810791016
local_output_nid generation:  0.029265880584716797
local_in_edges_tensor generation:  0.0335385799407959
mini_batch_src_global generation:  0.05842137336730957
r_  generation:  0.4882040023803711
local_output_nid generation:  0.029521465301513672
local_in_edges_tensor generation:  0.03061652183532715
mini_batch_src_global generation:  0.057444095611572266
r_  generation:  0.5248327255249023
local_output_nid generation:  0.03169870376586914
local_in_edges_tensor generation:  0.0314791202545166
mini_batch_src_global generation:  0.059729576110839844
r_  generation:  0.49367737770080566
local_output_nid generation:  0.030654191970825195
local_in_edges_tensor generation:  0.03176307678222656
mini_batch_src_global generation:  0.05832982063293457
r_  generation:  0.5045106410980225
local_output_nid generation:  0.03150820732116699
local_in_edges_tensor generation:  0.03144574165344238
mini_batch_src_global generation:  0.059012651443481445
r_  generation:  0.49169492721557617
local_output_nid generation:  0.030400991439819336
local_in_edges_tensor generation:  0.03135538101196289
mini_batch_src_global generation:  0.05768918991088867
r_  generation:  0.49983954429626465
local_output_nid generation:  0.030560016632080078
local_in_edges_tensor generation:  0.032218217849731445
mini_batch_src_global generation:  0.05951118469238281
r_  generation:  0.49706554412841797
local_output_nid generation:  0.030157804489135742
local_in_edges_tensor generation:  0.030979394912719727
mini_batch_src_global generation:  0.057858943939208984
r_  generation:  0.4990997314453125
local_output_nid generation:  0.030115842819213867
local_in_edges_tensor generation:  0.031638145446777344
mini_batch_src_global generation:  0.05922079086303711
r_  generation:  0.4902000427246094
local_output_nid generation:  0.030611038208007812
local_in_edges_tensor generation:  0.03154253959655762
mini_batch_src_global generation:  0.05763816833496094
r_  generation:  0.5024304389953613
local_output_nid generation:  0.030046701431274414
local_in_edges_tensor generation:  0.029624462127685547
mini_batch_src_global generation:  0.05863666534423828
r_  generation:  0.49043726921081543
local_output_nid generation:  0.030215024948120117
local_in_edges_tensor generation:  0.031755685806274414
mini_batch_src_global generation:  0.05983710289001465
r_  generation:  0.500830888748169
local_output_nid generation:  0.030637264251708984
local_in_edges_tensor generation:  0.033760786056518555
mini_batch_src_global generation:  0.06071877479553223
r_  generation:  0.49616193771362305
local_output_nid generation:  0.030440092086791992
local_in_edges_tensor generation:  0.03188037872314453
mini_batch_src_global generation:  0.05893278121948242
r_  generation:  0.503554105758667
local_output_nid generation:  0.030338287353515625
local_in_edges_tensor generation:  0.031832218170166016
mini_batch_src_global generation:  0.05948209762573242
r_  generation:  0.49498820304870605
local_output_nid generation:  0.030658245086669922
local_in_edges_tensor generation:  0.03234577178955078
mini_batch_src_global generation:  0.05868721008300781
r_  generation:  0.5022282600402832
local_output_nid generation:  0.03026127815246582
local_in_edges_tensor generation:  0.03132987022399902
mini_batch_src_global generation:  0.05910754203796387
r_  generation:  0.4955322742462158
----------------------check_connections_block total spend ----------------------------- 23.23288655281067
generate_one_block  0.6840999126434326
generate_one_block  0.6750304698944092
generate_one_block  0.670360803604126
generate_one_block  0.6717610359191895
generate_one_block  0.7707724571228027
generate_one_block  0.6770138740539551
generate_one_block  0.6719708442687988
generate_one_block  0.6692712306976318
generate_one_block  0.6739139556884766
generate_one_block  0.6787440776824951
generate_one_block  0.6721138954162598
generate_one_block  0.6785540580749512
generate_one_block  0.6804225444793701
generate_one_block  0.6746389865875244
generate_one_block  0.6691596508026123
generate_one_block  0.6715452671051025
generate_one_block  0.6769731044769287
generate_one_block  0.6802089214324951
generate_one_block  0.6838529109954834
generate_one_block  0.6776676177978516
generate_one_block  0.6762590408325195
generate_one_block  0.6817634105682373
generate_one_block  0.6711158752441406
generate_one_block  0.6724898815155029
generate_one_block  0.7011370658874512
generate_one_block  0.6699662208557129
generate_one_block  0.6801149845123291
generate_one_block  0.6768558025360107
generate_one_block  0.6856155395507812
generate_one_block  0.6797888278961182
generate_one_block  0.6805601119995117
generate_one_block  0.6699092388153076
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.2342529296875 GB
    Memory Allocated: 0.13084030151367188  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

connection checking time:  31.7443790435791
block generation total time  29.691601991653442
average batch blocks generation time:  0.9278625622391701
block dataloader generation time/epoch 65.20891684293747
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2342529296875 GB
    Memory Allocated: 0.10924148559570312  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2342529296875 GB
    Memory Allocated: 20.865589141845703  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2342529296875 GB
    Memory Allocated: 0.1092386245727539  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2342529296875 GB
    Memory Allocated: 20.801058769226074  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2342529296875 GB
    Memory Allocated: 0.10884380340576172  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2342529296875 GB
    Memory Allocated: 20.418378353118896  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2342529296875 GB
    Memory Allocated: 0.10929536819458008  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2342529296875 GB
    Memory Allocated: 20.817947387695312  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2342529296875 GB
    Memory Allocated: 0.10931587219238281  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2615966796875 GB
    Memory Allocated: 20.855849742889404  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2655029296875 GB
    Memory Allocated: 0.1092829704284668  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2655029296875 GB
    Memory Allocated: 20.877132892608643  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2655029296875 GB
    Memory Allocated: 0.10938787460327148  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2655029296875 GB
    Memory Allocated: 20.66858434677124  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2655029296875 GB
    Memory Allocated: 0.10913705825805664  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2655029296875 GB
    Memory Allocated: 20.81535243988037  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2655029296875 GB
    Memory Allocated: 0.10905838012695312  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3455810546875 GB
    Memory Allocated: 20.603156566619873  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3494873046875 GB
    Memory Allocated: 0.10903072357177734  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3494873046875 GB
    Memory Allocated: 20.638035774230957  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3494873046875 GB
    Memory Allocated: 0.10880279541015625  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3494873046875 GB
    Memory Allocated: 20.689783573150635  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3494873046875 GB
    Memory Allocated: 0.1092367172241211  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3494873046875 GB
    Memory Allocated: 20.900562286376953  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3494873046875 GB
    Memory Allocated: 0.1093282699584961  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3494873046875 GB
    Memory Allocated: 20.923396587371826  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3494873046875 GB
    Memory Allocated: 0.10931777954101562  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3494873046875 GB
    Memory Allocated: 20.93733549118042  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3494873046875 GB
    Memory Allocated: 0.10905981063842773  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3494873046875 GB
    Memory Allocated: 20.293102264404297  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3494873046875 GB
    Memory Allocated: 0.10871458053588867  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3494873046875 GB
    Memory Allocated: 20.272549629211426  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3494873046875 GB
    Memory Allocated: 0.10905694961547852  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3494873046875 GB
    Memory Allocated: 20.810749530792236  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3494873046875 GB
    Memory Allocated: 0.10926485061645508  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3494873046875 GB
    Memory Allocated: 20.611387252807617  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3494873046875 GB
    Memory Allocated: 0.10963869094848633  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3494873046875 GB
    Memory Allocated: 21.16684913635254  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3494873046875 GB
    Memory Allocated: 0.10931062698364258  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3494873046875 GB
    Memory Allocated: 20.972254753112793  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3494873046875 GB
    Memory Allocated: 0.10931253433227539  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3494873046875 GB
    Memory Allocated: 20.941627502441406  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3494873046875 GB
    Memory Allocated: 0.1096043586730957  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3494873046875 GB
    Memory Allocated: 21.287866592407227  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3494873046875 GB
    Memory Allocated: 0.10892677307128906  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3494873046875 GB
    Memory Allocated: 20.405137062072754  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3494873046875 GB
    Memory Allocated: 0.10891914367675781  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3494873046875 GB
    Memory Allocated: 20.410207271575928  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3494873046875 GB
    Memory Allocated: 0.10928487777709961  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 20.926530361175537  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10892868041992188  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.428975105285645  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10909700393676758  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.60228204727173  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10930538177490234  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.95679235458374  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10953950881958008  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 21.19172191619873  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10915088653564453  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.698721885681152  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10925865173339844  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 21.32345676422119  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7811279296875 GB
    Memory Allocated: 0.10898923873901367  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1229248046875 GB
    Memory Allocated: 20.850396633148193  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03661815822124481 |0.024116717278957367 |0.6364686340093613 |9.567290544509888e-05 |1.2100691124796867 |0.009057760238647461 |
----------------------------------------------------------pseudo_mini_loss sum 1.557076096534729
Total (block generation + training)time/epoch 126.22568196058273
Training time/epoch 61.11261439323425
Training time without block to device /epoch 60.34087944030762
Training time without total dataloading part /epoch 59.10132718086243
load block tensor time/epoch 1.171781063079834
block to device time/epoch 0.7717349529266357
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 13 |
Number of nodes for computation during this epoch:  9155101
Number of first layer input nodes during this epoch:  4805819
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.1248779296875 GB
    Memory Allocated: 0.1321554183959961  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02709507942199707
random selection method range initialization spend 0.008316755294799805
time for parepare:  0.022258758544921875
local_output_nid generation:  0.0014164447784423828
local_in_edges_tensor generation:  0.008901596069335938
mini_batch_src_global generation:  0.003431081771850586
r_  generation:  0.017538785934448242
local_output_nid generation:  0.0026543140411376953
local_in_edges_tensor generation:  0.0013263225555419922
mini_batch_src_global generation:  0.003317117691040039
r_  generation:  0.019356250762939453
local_output_nid generation:  0.002018451690673828
local_in_edges_tensor generation:  0.0011851787567138672
mini_batch_src_global generation:  0.00146484375
r_  generation:  0.010646343231201172
local_output_nid generation:  0.0018546581268310547
local_in_edges_tensor generation:  0.0010344982147216797
mini_batch_src_global generation:  0.0012042522430419922
r_  generation:  0.010022640228271484
local_output_nid generation:  0.0017414093017578125
local_in_edges_tensor generation:  0.0009670257568359375
mini_batch_src_global generation:  0.0011680126190185547
r_  generation:  0.010184288024902344
local_output_nid generation:  0.0017001628875732422
local_in_edges_tensor generation:  0.0009527206420898438
mini_batch_src_global generation:  0.0011475086212158203
r_  generation:  0.010719060897827148
local_output_nid generation:  0.001682281494140625
local_in_edges_tensor generation:  0.0009441375732421875
mini_batch_src_global generation:  0.0011408329010009766
r_  generation:  0.010268926620483398
local_output_nid generation:  0.0016512870788574219
local_in_edges_tensor generation:  0.0009181499481201172
mini_batch_src_global generation:  0.0011610984802246094
r_  generation:  0.010333776473999023
local_output_nid generation:  0.0016341209411621094
local_in_edges_tensor generation:  0.0008757114410400391
mini_batch_src_global generation:  0.0011167526245117188
r_  generation:  0.010436773300170898
local_output_nid generation:  0.0016338825225830078
local_in_edges_tensor generation:  0.0008852481842041016
mini_batch_src_global generation:  0.0011358261108398438
r_  generation:  0.010592460632324219
local_output_nid generation:  0.0016369819641113281
local_in_edges_tensor generation:  0.0009181499481201172
mini_batch_src_global generation:  0.0010972023010253906
r_  generation:  0.010086774826049805
local_output_nid generation:  0.0016345977783203125
local_in_edges_tensor generation:  0.0008716583251953125
mini_batch_src_global generation:  0.0010848045349121094
r_  generation:  0.010744094848632812
local_output_nid generation:  0.001634836196899414
local_in_edges_tensor generation:  0.0008864402770996094
mini_batch_src_global generation:  0.001209259033203125
r_  generation:  0.010288238525390625
local_output_nid generation:  0.0016052722930908203
local_in_edges_tensor generation:  0.0008749961853027344
mini_batch_src_global generation:  0.0011715888977050781
r_  generation:  0.011103391647338867
local_output_nid generation:  0.0016086101531982422
local_in_edges_tensor generation:  0.0008604526519775391
mini_batch_src_global generation:  0.00113677978515625
r_  generation:  0.010344505310058594
local_output_nid generation:  0.0015935897827148438
local_in_edges_tensor generation:  0.0008533000946044922
mini_batch_src_global generation:  0.0011131763458251953
r_  generation:  0.01041722297668457
local_output_nid generation:  0.0016126632690429688
local_in_edges_tensor generation:  0.000881195068359375
mini_batch_src_global generation:  0.00106048583984375
r_  generation:  0.00979757308959961
local_output_nid generation:  0.0015947818756103516
local_in_edges_tensor generation:  0.0008785724639892578
mini_batch_src_global generation:  0.0010919570922851562
r_  generation:  0.010361671447753906
local_output_nid generation:  0.0015871524810791016
local_in_edges_tensor generation:  0.0008609294891357422
mini_batch_src_global generation:  0.0011048316955566406
r_  generation:  0.010386943817138672
local_output_nid generation:  0.0015995502471923828
local_in_edges_tensor generation:  0.0008950233459472656
mini_batch_src_global generation:  0.001177072525024414
r_  generation:  0.010631084442138672
local_output_nid generation:  0.0015940666198730469
local_in_edges_tensor generation:  0.0008320808410644531
mini_batch_src_global generation:  0.0011036396026611328
r_  generation:  0.010329961776733398
local_output_nid generation:  0.0015707015991210938
local_in_edges_tensor generation:  0.00084686279296875
mini_batch_src_global generation:  0.0010766983032226562
r_  generation:  0.01060032844543457
local_output_nid generation:  0.0015764236450195312
local_in_edges_tensor generation:  0.0008394718170166016
mini_batch_src_global generation:  0.0011529922485351562
r_  generation:  0.010500431060791016
local_output_nid generation:  0.0015709400177001953
local_in_edges_tensor generation:  0.0008573532104492188
mini_batch_src_global generation:  0.0010695457458496094
r_  generation:  0.010313034057617188
local_output_nid generation:  0.0015876293182373047
local_in_edges_tensor generation:  0.0008342266082763672
mini_batch_src_global generation:  0.0011336803436279297
r_  generation:  0.010761260986328125
local_output_nid generation:  0.0015685558319091797
local_in_edges_tensor generation:  0.0009095668792724609
mini_batch_src_global generation:  0.0011706352233886719
r_  generation:  0.011184215545654297
local_output_nid generation:  0.0015652179718017578
local_in_edges_tensor generation:  0.0008504390716552734
mini_batch_src_global generation:  0.0010797977447509766
r_  generation:  0.010273456573486328
local_output_nid generation:  0.0015788078308105469
local_in_edges_tensor generation:  0.0008461475372314453
mini_batch_src_global generation:  0.0012240409851074219
r_  generation:  0.010388374328613281
local_output_nid generation:  0.0015790462493896484
local_in_edges_tensor generation:  0.0008375644683837891
mini_batch_src_global generation:  0.0011446475982666016
r_  generation:  0.010165929794311523
local_output_nid generation:  0.0015659332275390625
local_in_edges_tensor generation:  0.0008258819580078125
mini_batch_src_global generation:  0.0011136531829833984
r_  generation:  0.010849237442016602
local_output_nid generation:  0.0015325546264648438
local_in_edges_tensor generation:  0.0008640289306640625
mini_batch_src_global generation:  0.0011370182037353516
r_  generation:  0.010555505752563477
local_output_nid generation:  0.0015523433685302734
local_in_edges_tensor generation:  0.0009853839874267578
mini_batch_src_global generation:  0.0011296272277832031
r_  generation:  0.010596990585327148
----------------------check_connections_block total spend ----------------------------- 0.6054244041442871
generate_one_block  0.024702787399291992
generate_one_block  0.021872520446777344
generate_one_block  0.020235300064086914
generate_one_block  0.0183718204498291
generate_one_block  0.019083023071289062
generate_one_block  0.01931929588317871
generate_one_block  0.018419981002807617
generate_one_block  0.01837635040283203
generate_one_block  0.019057035446166992
generate_one_block  0.018680572509765625
generate_one_block  0.018177032470703125
generate_one_block  0.01894235610961914
generate_one_block  0.018721818923950195
generate_one_block  0.019386768341064453
generate_one_block  0.0184481143951416
generate_one_block  0.018456220626831055
generate_one_block  0.017398834228515625
generate_one_block  0.018248796463012695
generate_one_block  0.018617630004882812
generate_one_block  0.018552780151367188
generate_one_block  0.018457889556884766
generate_one_block  0.018549203872680664
generate_one_block  0.021873950958251953
generate_one_block  0.018788814544677734
generate_one_block  0.019526004791259766
generate_one_block  0.01938462257385254
generate_one_block  0.018451452255249023
generate_one_block  0.018341064453125
generate_one_block  0.01835918426513672
generate_one_block  0.01894664764404297
generate_one_block  0.018966197967529297
generate_one_block  0.018547534942626953
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.041434526443481445
gen group dst list time:  0.02588939666748047
time for parepare:  0.022722244262695312
local_output_nid generation:  0.006449460983276367
local_in_edges_tensor generation:  0.0228731632232666
mini_batch_src_global generation:  0.017846345901489258
r_  generation:  0.16188359260559082
local_output_nid generation:  0.009230375289916992
local_in_edges_tensor generation:  0.012554168701171875
mini_batch_src_global generation:  0.021781444549560547
r_  generation:  0.17170047760009766
local_output_nid generation:  0.009836912155151367
local_in_edges_tensor generation:  0.03758645057678223
mini_batch_src_global generation:  0.02211785316467285
r_  generation:  0.18542051315307617
local_output_nid generation:  0.009589672088623047
local_in_edges_tensor generation:  0.01093602180480957
mini_batch_src_global generation:  0.02145695686340332
r_  generation:  0.17459630966186523
local_output_nid generation:  0.009737491607666016
local_in_edges_tensor generation:  0.012248754501342773
mini_batch_src_global generation:  0.024498462677001953
r_  generation:  0.18738484382629395
local_output_nid generation:  0.010406732559204102
local_in_edges_tensor generation:  0.011234760284423828
mini_batch_src_global generation:  0.02387213706970215
r_  generation:  0.19252228736877441
local_output_nid generation:  0.009242057800292969
local_in_edges_tensor generation:  0.01393890380859375
mini_batch_src_global generation:  0.02350330352783203
r_  generation:  0.18370318412780762
local_output_nid generation:  0.009043693542480469
local_in_edges_tensor generation:  0.010537147521972656
mini_batch_src_global generation:  0.021997928619384766
r_  generation:  0.1796720027923584
local_output_nid generation:  0.00933218002319336
local_in_edges_tensor generation:  0.012047290802001953
mini_batch_src_global generation:  0.02561211585998535
r_  generation:  0.18912434577941895
local_output_nid generation:  0.009501934051513672
local_in_edges_tensor generation:  0.016228437423706055
mini_batch_src_global generation:  0.023415327072143555
r_  generation:  0.18360066413879395
local_output_nid generation:  0.009461402893066406
local_in_edges_tensor generation:  0.013903379440307617
mini_batch_src_global generation:  0.02382349967956543
r_  generation:  0.1862194538116455
local_output_nid generation:  0.011931419372558594
local_in_edges_tensor generation:  0.011197090148925781
mini_batch_src_global generation:  0.02336859703063965
r_  generation:  0.1849057674407959
local_output_nid generation:  0.00993967056274414
local_in_edges_tensor generation:  0.012353897094726562
mini_batch_src_global generation:  0.023981332778930664
r_  generation:  0.1831815242767334
local_output_nid generation:  0.010129451751708984
local_in_edges_tensor generation:  0.011034965515136719
mini_batch_src_global generation:  0.024261474609375
r_  generation:  0.19026637077331543
local_output_nid generation:  0.009874820709228516
local_in_edges_tensor generation:  0.009931802749633789
mini_batch_src_global generation:  0.02306532859802246
r_  generation:  0.18144512176513672
local_output_nid generation:  0.00978231430053711
local_in_edges_tensor generation:  0.009491920471191406
mini_batch_src_global generation:  0.022625446319580078
r_  generation:  0.17885088920593262
local_output_nid generation:  0.009507417678833008
local_in_edges_tensor generation:  0.00996088981628418
mini_batch_src_global generation:  0.022704362869262695
r_  generation:  0.1723775863647461
local_output_nid generation:  0.009757518768310547
local_in_edges_tensor generation:  0.009167671203613281
mini_batch_src_global generation:  0.025132417678833008
r_  generation:  0.17905092239379883
local_output_nid generation:  0.009902477264404297
local_in_edges_tensor generation:  0.009739398956298828
mini_batch_src_global generation:  0.02409052848815918
r_  generation:  0.18228650093078613
local_output_nid generation:  0.009852170944213867
local_in_edges_tensor generation:  0.009230852127075195
mini_batch_src_global generation:  0.023313045501708984
r_  generation:  0.18673443794250488
local_output_nid generation:  0.009845733642578125
local_in_edges_tensor generation:  0.010624885559082031
mini_batch_src_global generation:  0.023483753204345703
r_  generation:  0.18371105194091797
local_output_nid generation:  0.010072946548461914
local_in_edges_tensor generation:  0.009556293487548828
mini_batch_src_global generation:  0.023058652877807617
r_  generation:  0.18340015411376953
local_output_nid generation:  0.01009511947631836
local_in_edges_tensor generation:  0.009328365325927734
mini_batch_src_global generation:  0.023261308670043945
r_  generation:  0.18236660957336426
local_output_nid generation:  0.009616613388061523
local_in_edges_tensor generation:  0.009328365325927734
mini_batch_src_global generation:  0.022609233856201172
r_  generation:  0.1811842918395996
local_output_nid generation:  0.010197162628173828
local_in_edges_tensor generation:  0.010070562362670898
mini_batch_src_global generation:  0.024288654327392578
r_  generation:  0.19103336334228516
local_output_nid generation:  0.010238409042358398
local_in_edges_tensor generation:  0.012710332870483398
mini_batch_src_global generation:  0.026478290557861328
r_  generation:  0.1941232681274414
local_output_nid generation:  0.010118484497070312
local_in_edges_tensor generation:  0.009613037109375
mini_batch_src_global generation:  0.023007631301879883
r_  generation:  0.18207168579101562
local_output_nid generation:  0.009720087051391602
local_in_edges_tensor generation:  0.009645938873291016
mini_batch_src_global generation:  0.021863937377929688
r_  generation:  0.17893075942993164
local_output_nid generation:  0.009787559509277344
local_in_edges_tensor generation:  0.008989095687866211
mini_batch_src_global generation:  0.022752046585083008
r_  generation:  0.18376636505126953
local_output_nid generation:  0.00998830795288086
local_in_edges_tensor generation:  0.009277582168579102
mini_batch_src_global generation:  0.022789716720581055
r_  generation:  0.18339991569519043
local_output_nid generation:  0.010155200958251953
local_in_edges_tensor generation:  0.009397506713867188
mini_batch_src_global generation:  0.023638248443603516
r_  generation:  0.18861079216003418
local_output_nid generation:  0.009644508361816406
local_in_edges_tensor generation:  0.0093231201171875
mini_batch_src_global generation:  0.02285599708557129
r_  generation:  0.1852400302886963
----------------------check_connections_block total spend ----------------------------- 8.626724004745483
generate_one_block  0.25925445556640625
generate_one_block  0.24293041229248047
generate_one_block  0.25892090797424316
generate_one_block  0.2443387508392334
generate_one_block  0.27141833305358887
generate_one_block  0.2620124816894531
generate_one_block  0.2491757869720459
generate_one_block  0.24475669860839844
generate_one_block  0.25647687911987305
generate_one_block  0.2498173713684082
generate_one_block  0.24391603469848633
generate_one_block  0.256547212600708
generate_one_block  0.257399320602417
generate_one_block  0.26447606086730957
generate_one_block  0.25192952156066895
generate_one_block  0.24364113807678223
generate_one_block  0.2364826202392578
generate_one_block  0.24402523040771484
generate_one_block  0.2518332004547119
generate_one_block  0.26232147216796875
generate_one_block  0.25289392471313477
generate_one_block  0.25060606002807617
generate_one_block  0.2505204677581787
generate_one_block  0.24670815467834473
generate_one_block  0.25992894172668457
generate_one_block  0.26439833641052246
generate_one_block  0.2445967197418213
generate_one_block  0.2426750659942627
generate_one_block  0.2495591640472412
generate_one_block  0.2510099411010742
generate_one_block  0.256591796875
generate_one_block  0.2483375072479248
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.045769691467285156
gen group dst list time:  0.11232757568359375
time for parepare:  0.019460439682006836
local_output_nid generation:  0.026365280151367188
local_in_edges_tensor generation:  0.052333831787109375
mini_batch_src_global generation:  0.04625225067138672
r_  generation:  0.490490198135376
local_output_nid generation:  0.034690141677856445
local_in_edges_tensor generation:  0.0412139892578125
mini_batch_src_global generation:  0.060717105865478516
r_  generation:  0.4876859188079834
local_output_nid generation:  0.03267216682434082
local_in_edges_tensor generation:  0.04052543640136719
mini_batch_src_global generation:  0.05956244468688965
r_  generation:  0.49874258041381836
local_output_nid generation:  0.031749725341796875
local_in_edges_tensor generation:  0.040271759033203125
mini_batch_src_global generation:  0.06139802932739258
r_  generation:  0.5100767612457275
local_output_nid generation:  0.03225255012512207
local_in_edges_tensor generation:  0.04271554946899414
mini_batch_src_global generation:  0.060533761978149414
r_  generation:  0.5049378871917725
local_output_nid generation:  0.0330052375793457
local_in_edges_tensor generation:  0.0396115779876709
mini_batch_src_global generation:  0.060089111328125
r_  generation:  0.5162696838378906
local_output_nid generation:  0.03142833709716797
local_in_edges_tensor generation:  0.033768415451049805
mini_batch_src_global generation:  0.059007883071899414
r_  generation:  0.5093653202056885
local_output_nid generation:  0.03221416473388672
local_in_edges_tensor generation:  0.038281917572021484
mini_batch_src_global generation:  0.062125205993652344
r_  generation:  0.49768781661987305
local_output_nid generation:  0.0312955379486084
local_in_edges_tensor generation:  0.03455018997192383
mini_batch_src_global generation:  0.05998373031616211
r_  generation:  0.49802279472351074
local_output_nid generation:  0.030450820922851562
local_in_edges_tensor generation:  0.032140254974365234
mini_batch_src_global generation:  0.05998349189758301
r_  generation:  0.5033018589019775
local_output_nid generation:  0.030553102493286133
local_in_edges_tensor generation:  0.03448057174682617
mini_batch_src_global generation:  0.058542728424072266
r_  generation:  0.5000946521759033
local_output_nid generation:  0.03025984764099121
local_in_edges_tensor generation:  0.03257036209106445
mini_batch_src_global generation:  0.05958223342895508
r_  generation:  0.5042822360992432
local_output_nid generation:  0.03309440612792969
local_in_edges_tensor generation:  0.03428530693054199
mini_batch_src_global generation:  0.05791497230529785
r_  generation:  0.5044939517974854
local_output_nid generation:  0.03078317642211914
local_in_edges_tensor generation:  0.031792402267456055
mini_batch_src_global generation:  0.061672210693359375
r_  generation:  0.5081968307495117
local_output_nid generation:  0.03022170066833496
local_in_edges_tensor generation:  0.031960248947143555
mini_batch_src_global generation:  0.05924344062805176
r_  generation:  0.49932050704956055
local_output_nid generation:  0.03023529052734375
local_in_edges_tensor generation:  0.04474830627441406
mini_batch_src_global generation:  0.06174278259277344
r_  generation:  0.5005433559417725
local_output_nid generation:  0.03005075454711914
local_in_edges_tensor generation:  0.036292314529418945
mini_batch_src_global generation:  0.05847978591918945
r_  generation:  0.4939448833465576
local_output_nid generation:  0.03053593635559082
local_in_edges_tensor generation:  0.031796932220458984
mini_batch_src_global generation:  0.059763193130493164
r_  generation:  0.5024130344390869
local_output_nid generation:  0.030591726303100586
local_in_edges_tensor generation:  0.03624320030212402
mini_batch_src_global generation:  0.06342387199401855
r_  generation:  0.5113623142242432
local_output_nid generation:  0.03050065040588379
local_in_edges_tensor generation:  0.036638498306274414
mini_batch_src_global generation:  0.06220507621765137
r_  generation:  0.5073401927947998
local_output_nid generation:  0.03197360038757324
local_in_edges_tensor generation:  0.03411674499511719
mini_batch_src_global generation:  0.05956411361694336
r_  generation:  0.4981703758239746
local_output_nid generation:  0.030694246292114258
local_in_edges_tensor generation:  0.03816652297973633
mini_batch_src_global generation:  0.06029486656188965
r_  generation:  0.5002825260162354
local_output_nid generation:  0.030784130096435547
local_in_edges_tensor generation:  0.0330653190612793
mini_batch_src_global generation:  0.05929923057556152
r_  generation:  0.5094766616821289
local_output_nid generation:  0.030408143997192383
local_in_edges_tensor generation:  0.03483915328979492
mini_batch_src_global generation:  0.060193538665771484
r_  generation:  0.5045173168182373
local_output_nid generation:  0.030566692352294922
local_in_edges_tensor generation:  0.034047842025756836
mini_batch_src_global generation:  0.060202836990356445
r_  generation:  0.4990527629852295
local_output_nid generation:  0.03087139129638672
local_in_edges_tensor generation:  0.03485393524169922
mini_batch_src_global generation:  0.06166887283325195
r_  generation:  0.503338098526001
local_output_nid generation:  0.030569791793823242
local_in_edges_tensor generation:  0.03190493583679199
mini_batch_src_global generation:  0.05871939659118652
r_  generation:  0.5010457038879395
local_output_nid generation:  0.03065800666809082
local_in_edges_tensor generation:  0.03196430206298828
mini_batch_src_global generation:  0.05896425247192383
r_  generation:  0.50392746925354
local_output_nid generation:  0.030363798141479492
local_in_edges_tensor generation:  0.031618356704711914
mini_batch_src_global generation:  0.05746054649353027
r_  generation:  0.49584031105041504
local_output_nid generation:  0.030393123626708984
local_in_edges_tensor generation:  0.03308987617492676
mini_batch_src_global generation:  0.05898761749267578
r_  generation:  0.4995152950286865
local_output_nid generation:  0.030686140060424805
local_in_edges_tensor generation:  0.033743858337402344
mini_batch_src_global generation:  0.06184983253479004
r_  generation:  0.5061547756195068
local_output_nid generation:  0.030498027801513672
local_in_edges_tensor generation:  0.033255577087402344
mini_batch_src_global generation:  0.06009817123413086
r_  generation:  0.5051500797271729
----------------------check_connections_block total spend ----------------------------- 23.63381552696228
generate_one_block  0.6988937854766846
generate_one_block  0.6741011142730713
generate_one_block  0.6901569366455078
generate_one_block  0.6791074275970459
generate_one_block  0.7865383625030518
generate_one_block  0.6878316402435303
generate_one_block  0.6761040687561035
generate_one_block  0.6804022789001465
generate_one_block  0.6803176403045654
generate_one_block  0.683067798614502
generate_one_block  0.681241512298584
generate_one_block  0.6839244365692139
generate_one_block  0.6770544052124023
generate_one_block  0.6833527088165283
generate_one_block  0.6841261386871338
generate_one_block  0.6773459911346436
generate_one_block  0.6723036766052246
generate_one_block  0.6907525062561035
generate_one_block  0.6834578514099121
generate_one_block  0.6821324825286865
generate_one_block  0.6767103672027588
generate_one_block  0.6818873882293701
generate_one_block  0.6820714473724365
generate_one_block  0.679267168045044
generate_one_block  0.6994788646697998
generate_one_block  0.6881012916564941
generate_one_block  0.6815762519836426
generate_one_block  0.6712038516998291
generate_one_block  0.6787004470825195
generate_one_block  0.6821744441986084
generate_one_block  0.6883223056793213
generate_one_block  0.6876287460327148
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.1248779296875 GB
    Memory Allocated: 0.1321554183959961  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

connection checking time:  32.260539531707764
block generation total time  30.018835306167603
average batch blocks generation time:  0.9380886033177376
block dataloader generation time/epoch 65.3528642654419
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1248779296875 GB
    Memory Allocated: 0.1089792251586914  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1248779296875 GB
    Memory Allocated: 20.4802827835083  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1248779296875 GB
    Memory Allocated: 0.10918140411376953  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1248779296875 GB
    Memory Allocated: 20.601301193237305  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1248779296875 GB
    Memory Allocated: 0.10967016220092773  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1248779296875 GB
    Memory Allocated: 21.263794898986816  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1248779296875 GB
    Memory Allocated: 0.10919427871704102  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1248779296875 GB
    Memory Allocated: 20.565062046051025  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1248779296875 GB
    Memory Allocated: 0.10923004150390625  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1248779296875 GB
    Memory Allocated: 21.02416229248047  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1248779296875 GB
    Memory Allocated: 0.10951375961303711  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 21.226412773132324  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1541748046875 GB
    Memory Allocated: 0.10919380187988281  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1541748046875 GB
    Memory Allocated: 20.614113807678223  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1541748046875 GB
    Memory Allocated: 0.10907697677612305  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1541748046875 GB
    Memory Allocated: 20.533782958984375  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1541748046875 GB
    Memory Allocated: 0.10932683944702148  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1541748046875 GB
    Memory Allocated: 20.969390392303467  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1541748046875 GB
    Memory Allocated: 0.10937070846557617  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1541748046875 GB
    Memory Allocated: 20.739081382751465  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1541748046875 GB
    Memory Allocated: 0.1090550422668457  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1541748046875 GB
    Memory Allocated: 20.38051128387451  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1541748046875 GB
    Memory Allocated: 0.10932397842407227  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1737060546875 GB
    Memory Allocated: 20.96945095062256  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1756591796875 GB
    Memory Allocated: 0.10908174514770508  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1756591796875 GB
    Memory Allocated: 20.746519088745117  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1756591796875 GB
    Memory Allocated: 0.10974836349487305  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1756591796875 GB
    Memory Allocated: 21.25639009475708  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1756591796875 GB
    Memory Allocated: 0.10923194885253906  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1756591796875 GB
    Memory Allocated: 20.67264223098755  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1756591796875 GB
    Memory Allocated: 0.10890722274780273  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1756591796875 GB
    Memory Allocated: 20.489579677581787  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1756591796875 GB
    Memory Allocated: 0.10882711410522461  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1756591796875 GB
    Memory Allocated: 20.16096258163452  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1756591796875 GB
    Memory Allocated: 0.10940837860107422  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1756591796875 GB
    Memory Allocated: 20.64055061340332  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1756591796875 GB
    Memory Allocated: 0.10923051834106445  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1756591796875 GB
    Memory Allocated: 20.83159351348877  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1756591796875 GB
    Memory Allocated: 0.10936689376831055  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1756591796875 GB
    Memory Allocated: 21.001428604125977  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1756591796875 GB
    Memory Allocated: 0.10921335220336914  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1756591796875 GB
    Memory Allocated: 20.855729579925537  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1756591796875 GB
    Memory Allocated: 0.10911273956298828  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1756591796875 GB
    Memory Allocated: 20.776339054107666  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1756591796875 GB
    Memory Allocated: 0.10927248001098633  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1756591796875 GB
    Memory Allocated: 20.757182598114014  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1756591796875 GB
    Memory Allocated: 0.10891914367675781  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1756591796875 GB
    Memory Allocated: 20.61875295639038  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1756591796875 GB
    Memory Allocated: 0.10919666290283203  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1971435546875 GB
    Memory Allocated: 21.10703420639038  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 0.10968589782714844  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 21.342203617095947  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 0.10903024673461914  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 20.586360454559326  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 0.10915708541870117  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 20.436973094940186  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 0.10908269882202148  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 20.746356964111328  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2147216796875 GB
    Memory Allocated: 0.10930156707763672  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2147216796875 GB
    Memory Allocated: 20.776211261749268  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2147216796875 GB
    Memory Allocated: 0.10943317413330078  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2147216796875 GB
    Memory Allocated: 21.08130407333374  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2147216796875 GB
    Memory Allocated: 0.1091465950012207  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2147216796875 GB
    Memory Allocated: 20.798328399658203  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03408501297235489 |0.02268300950527191 |0.6362601667642593 |9.617209434509277e-05 |1.207589142024517 |0.008401632308959961 |
----------------------------------------------------------pseudo_mini_loss sum 1.518372893333435
Total (block generation + training)time/epoch 126.34560170173646
Training time/epoch 60.896331548690796
Training time without block to device /epoch 60.170475244522095
Training time without total dataloading part /epoch 59.01465702056885
load block tensor time/epoch 1.0907204151153564
block to device time/epoch 0.7258563041687012
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 14 |
Number of nodes for computation during this epoch:  9163366
Number of first layer input nodes during this epoch:  4808801
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.2147216796875 GB
    Memory Allocated: 0.13124704360961914  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02788686752319336
random selection method range initialization spend 0.006836414337158203
time for parepare:  0.021751880645751953
local_output_nid generation:  0.00140380859375
local_in_edges_tensor generation:  0.0038766860961914062
mini_batch_src_global generation:  0.0015456676483154297
r_  generation:  0.010805845260620117
local_output_nid generation:  0.0016465187072753906
local_in_edges_tensor generation:  0.0010323524475097656
mini_batch_src_global generation:  0.0015690326690673828
r_  generation:  0.010706424713134766
local_output_nid generation:  0.0016837120056152344
local_in_edges_tensor generation:  0.0009911060333251953
mini_batch_src_global generation:  0.0012295246124267578
r_  generation:  0.010286092758178711
local_output_nid generation:  0.0016789436340332031
local_in_edges_tensor generation:  0.0009834766387939453
mini_batch_src_global generation:  0.0012459754943847656
r_  generation:  0.010410308837890625
local_output_nid generation:  0.0016224384307861328
local_in_edges_tensor generation:  0.0009412765502929688
mini_batch_src_global generation:  0.0011153221130371094
r_  generation:  0.009875774383544922
local_output_nid generation:  0.0016107559204101562
local_in_edges_tensor generation:  0.0009419918060302734
mini_batch_src_global generation:  0.0011250972747802734
r_  generation:  0.010062694549560547
local_output_nid generation:  0.0016002655029296875
local_in_edges_tensor generation:  0.0009582042694091797
mini_batch_src_global generation:  0.0011279582977294922
r_  generation:  0.010107755661010742
local_output_nid generation:  0.0015871524810791016
local_in_edges_tensor generation:  0.0008990764617919922
mini_batch_src_global generation:  0.0011029243469238281
r_  generation:  0.009939908981323242
local_output_nid generation:  0.0016064643859863281
local_in_edges_tensor generation:  0.0008955001831054688
mini_batch_src_global generation:  0.001068115234375
r_  generation:  0.010104656219482422
local_output_nid generation:  0.0015718936920166016
local_in_edges_tensor generation:  0.0008985996246337891
mini_batch_src_global generation:  0.0011527538299560547
r_  generation:  0.010480880737304688
local_output_nid generation:  0.001554250717163086
local_in_edges_tensor generation:  0.0009062290191650391
mini_batch_src_global generation:  0.001131296157836914
r_  generation:  0.010528802871704102
local_output_nid generation:  0.0015904903411865234
local_in_edges_tensor generation:  0.0009028911590576172
mini_batch_src_global generation:  0.0011904239654541016
r_  generation:  0.010834932327270508
local_output_nid generation:  0.001585245132446289
local_in_edges_tensor generation:  0.0009167194366455078
mini_batch_src_global generation:  0.0011470317840576172
r_  generation:  0.01015019416809082
local_output_nid generation:  0.0015802383422851562
local_in_edges_tensor generation:  0.0008933544158935547
mini_batch_src_global generation:  0.0011081695556640625
r_  generation:  0.010560035705566406
local_output_nid generation:  0.0016074180603027344
local_in_edges_tensor generation:  0.0008642673492431641
mini_batch_src_global generation:  0.0011174678802490234
r_  generation:  0.010477066040039062
local_output_nid generation:  0.0015790462493896484
local_in_edges_tensor generation:  0.000888824462890625
mini_batch_src_global generation:  0.0011429786682128906
r_  generation:  0.010145187377929688
local_output_nid generation:  0.0015652179718017578
local_in_edges_tensor generation:  0.0008883476257324219
mini_batch_src_global generation:  0.0011172294616699219
r_  generation:  0.010419607162475586
local_output_nid generation:  0.0015835762023925781
local_in_edges_tensor generation:  0.0008790493011474609
mini_batch_src_global generation:  0.0011031627655029297
r_  generation:  0.010277509689331055
local_output_nid generation:  0.0015594959259033203
local_in_edges_tensor generation:  0.0008633136749267578
mini_batch_src_global generation:  0.0011644363403320312
r_  generation:  0.010693073272705078
local_output_nid generation:  0.0015532970428466797
local_in_edges_tensor generation:  0.0008842945098876953
mini_batch_src_global generation:  0.0011284351348876953
r_  generation:  0.010291099548339844
local_output_nid generation:  0.0015838146209716797
local_in_edges_tensor generation:  0.0008521080017089844
mini_batch_src_global generation:  0.0011866092681884766
r_  generation:  0.011032581329345703
local_output_nid generation:  0.0015726089477539062
local_in_edges_tensor generation:  0.0008852481842041016
mini_batch_src_global generation:  0.0011758804321289062
r_  generation:  0.01060175895690918
local_output_nid generation:  0.0015532970428466797
local_in_edges_tensor generation:  0.0008714199066162109
mini_batch_src_global generation:  0.0011429786682128906
r_  generation:  0.010207176208496094
local_output_nid generation:  0.0015652179718017578
local_in_edges_tensor generation:  0.0008702278137207031
mini_batch_src_global generation:  0.0011165142059326172
r_  generation:  0.010439634323120117
local_output_nid generation:  0.00154876708984375
local_in_edges_tensor generation:  0.0008966922760009766
mini_batch_src_global generation:  0.00112152099609375
r_  generation:  0.01010751724243164
local_output_nid generation:  0.0015583038330078125
local_in_edges_tensor generation:  0.0008778572082519531
mini_batch_src_global generation:  0.0010988712310791016
r_  generation:  0.010311365127563477
local_output_nid generation:  0.0015761852264404297
local_in_edges_tensor generation:  0.0008630752563476562
mini_batch_src_global generation:  0.0012247562408447266
r_  generation:  0.01018524169921875
local_output_nid generation:  0.0015516281127929688
local_in_edges_tensor generation:  0.0008723735809326172
mini_batch_src_global generation:  0.0013189315795898438
r_  generation:  0.010563373565673828
local_output_nid generation:  0.0015621185302734375
local_in_edges_tensor generation:  0.0021615028381347656
mini_batch_src_global generation:  0.001194000244140625
r_  generation:  0.010368824005126953
local_output_nid generation:  0.0015430450439453125
local_in_edges_tensor generation:  0.0011513233184814453
mini_batch_src_global generation:  0.0011069774627685547
r_  generation:  0.009977579116821289
local_output_nid generation:  0.0016055107116699219
local_in_edges_tensor generation:  0.00091552734375
mini_batch_src_global generation:  0.0011730194091796875
r_  generation:  0.01020359992980957
local_output_nid generation:  0.0015528202056884766
local_in_edges_tensor generation:  0.0009646415710449219
mini_batch_src_global generation:  0.0011200904846191406
r_  generation:  0.010575294494628906
----------------------check_connections_block total spend ----------------------------- 0.570587158203125
generate_one_block  0.021140575408935547
generate_one_block  0.021854400634765625
generate_one_block  0.020130395889282227
generate_one_block  0.019704103469848633
generate_one_block  0.018564939498901367
generate_one_block  0.018787384033203125
generate_one_block  0.01868891716003418
generate_one_block  0.01825737953186035
generate_one_block  0.018537282943725586
generate_one_block  0.019115686416625977
generate_one_block  0.018843412399291992
generate_one_block  0.019722461700439453
generate_one_block  0.01829218864440918
generate_one_block  0.01906418800354004
generate_one_block  0.018835783004760742
generate_one_block  0.0184328556060791
generate_one_block  0.018910646438598633
generate_one_block  0.018692731857299805
generate_one_block  0.01918935775756836
generate_one_block  0.01894378662109375
generate_one_block  0.019884347915649414
generate_one_block  0.01920938491821289
generate_one_block  0.021636962890625
generate_one_block  0.019973039627075195
generate_one_block  0.018585205078125
generate_one_block  0.018891334533691406
generate_one_block  0.018571138381958008
generate_one_block  0.01920175552368164
generate_one_block  0.018703937530517578
generate_one_block  0.01806354522705078
generate_one_block  0.0185086727142334
generate_one_block  0.019260644912719727
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03770184516906738
gen group dst list time:  0.02094101905822754
time for parepare:  0.02016901969909668
local_output_nid generation:  0.006483554840087891
local_in_edges_tensor generation:  0.017424821853637695
mini_batch_src_global generation:  0.01656937599182129
r_  generation:  0.1613328456878662
local_output_nid generation:  0.00915670394897461
local_in_edges_tensor generation:  0.011928081512451172
mini_batch_src_global generation:  0.02188253402709961
r_  generation:  0.20879530906677246
local_output_nid generation:  0.009468555450439453
local_in_edges_tensor generation:  0.03535270690917969
mini_batch_src_global generation:  0.020690202713012695
r_  generation:  0.17856836318969727
local_output_nid generation:  0.009865999221801758
local_in_edges_tensor generation:  0.012599706649780273
mini_batch_src_global generation:  0.022693157196044922
r_  generation:  0.18880510330200195
local_output_nid generation:  0.00957942008972168
local_in_edges_tensor generation:  0.010450124740600586
mini_batch_src_global generation:  0.022360801696777344
r_  generation:  0.1818373203277588
local_output_nid generation:  0.010742425918579102
local_in_edges_tensor generation:  0.012382268905639648
mini_batch_src_global generation:  0.02143573760986328
r_  generation:  0.17642664909362793
local_output_nid generation:  0.009336709976196289
local_in_edges_tensor generation:  0.00966787338256836
mini_batch_src_global generation:  0.02192997932434082
r_  generation:  0.20140552520751953
local_output_nid generation:  0.013942241668701172
local_in_edges_tensor generation:  0.012151002883911133
mini_batch_src_global generation:  0.025310277938842773
r_  generation:  0.1950082778930664
local_output_nid generation:  0.015292882919311523
local_in_edges_tensor generation:  0.0120697021484375
mini_batch_src_global generation:  0.027584314346313477
r_  generation:  0.1826801300048828
local_output_nid generation:  0.010435104370117188
local_in_edges_tensor generation:  0.012669801712036133
mini_batch_src_global generation:  0.024034738540649414
r_  generation:  0.1831965446472168
local_output_nid generation:  0.009926319122314453
local_in_edges_tensor generation:  0.009404182434082031
mini_batch_src_global generation:  0.022936344146728516
r_  generation:  0.18186068534851074
local_output_nid generation:  0.010343790054321289
local_in_edges_tensor generation:  0.009433984756469727
mini_batch_src_global generation:  0.026968717575073242
r_  generation:  0.19408321380615234
local_output_nid generation:  0.009707450866699219
local_in_edges_tensor generation:  0.009443283081054688
mini_batch_src_global generation:  0.022780656814575195
r_  generation:  0.18269920349121094
local_output_nid generation:  0.010009050369262695
local_in_edges_tensor generation:  0.00917196273803711
mini_batch_src_global generation:  0.025286197662353516
r_  generation:  0.1890273094177246
local_output_nid generation:  0.009957551956176758
local_in_edges_tensor generation:  0.009086847305297852
mini_batch_src_global generation:  0.022722721099853516
r_  generation:  0.18318510055541992
local_output_nid generation:  0.009714603424072266
local_in_edges_tensor generation:  0.01167154312133789
mini_batch_src_global generation:  0.024110794067382812
r_  generation:  0.18270468711853027
local_output_nid generation:  0.009889364242553711
local_in_edges_tensor generation:  0.010704278945922852
mini_batch_src_global generation:  0.023226261138916016
r_  generation:  0.18741559982299805
local_output_nid generation:  0.00987696647644043
local_in_edges_tensor generation:  0.013028860092163086
mini_batch_src_global generation:  0.02338576316833496
r_  generation:  0.1844174861907959
local_output_nid generation:  0.009934663772583008
local_in_edges_tensor generation:  0.011615991592407227
mini_batch_src_global generation:  0.02452254295349121
r_  generation:  0.18825602531433105
local_output_nid generation:  0.00992274284362793
local_in_edges_tensor generation:  0.009100198745727539
mini_batch_src_global generation:  0.023798465728759766
r_  generation:  0.1859757900238037
local_output_nid generation:  0.010280370712280273
local_in_edges_tensor generation:  0.011228322982788086
mini_batch_src_global generation:  0.02528524398803711
r_  generation:  0.19263386726379395
local_output_nid generation:  0.0098724365234375
local_in_edges_tensor generation:  0.009292125701904297
mini_batch_src_global generation:  0.02414083480834961
r_  generation:  0.1875009536743164
local_output_nid generation:  0.00972437858581543
local_in_edges_tensor generation:  0.010729074478149414
mini_batch_src_global generation:  0.02288985252380371
r_  generation:  0.18283843994140625
local_output_nid generation:  0.009926319122314453
local_in_edges_tensor generation:  0.00934457778930664
mini_batch_src_global generation:  0.02302241325378418
r_  generation:  0.18938517570495605
local_output_nid generation:  0.010596275329589844
local_in_edges_tensor generation:  0.009676933288574219
mini_batch_src_global generation:  0.026389360427856445
r_  generation:  0.18456482887268066
local_output_nid generation:  0.010008811950683594
local_in_edges_tensor generation:  0.01271200180053711
mini_batch_src_global generation:  0.023145437240600586
r_  generation:  0.18908452987670898
local_output_nid generation:  0.009649276733398438
local_in_edges_tensor generation:  0.01256561279296875
mini_batch_src_global generation:  0.022825241088867188
r_  generation:  0.18792080879211426
local_output_nid generation:  0.009994745254516602
local_in_edges_tensor generation:  0.009497404098510742
mini_batch_src_global generation:  0.023167133331298828
r_  generation:  0.18767952919006348
local_output_nid generation:  0.011584281921386719
local_in_edges_tensor generation:  0.01241612434387207
mini_batch_src_global generation:  0.022561073303222656
r_  generation:  0.18476390838623047
local_output_nid generation:  0.00954127311706543
local_in_edges_tensor generation:  0.011400222778320312
mini_batch_src_global generation:  0.022287368774414062
r_  generation:  0.17491936683654785
local_output_nid generation:  0.009777545928955078
local_in_edges_tensor generation:  0.012625932693481445
mini_batch_src_global generation:  0.027858734130859375
r_  generation:  0.18035173416137695
local_output_nid generation:  0.010929584503173828
local_in_edges_tensor generation:  0.010868072509765625
mini_batch_src_global generation:  0.02416229248046875
r_  generation:  0.18582987785339355
----------------------check_connections_block total spend ----------------------------- 8.769457817077637
generate_one_block  0.26000428199768066
generate_one_block  0.2475285530090332
generate_one_block  0.2530810832977295
generate_one_block  0.2578873634338379
generate_one_block  0.25864744186401367
generate_one_block  0.24296855926513672
generate_one_block  0.24542784690856934
generate_one_block  0.2418971061706543
generate_one_block  0.2536814212799072
generate_one_block  0.2670884132385254
generate_one_block  0.2534816265106201
generate_one_block  0.2633805274963379
generate_one_block  0.24829649925231934
generate_one_block  0.2519571781158447
generate_one_block  0.24924468994140625
generate_one_block  0.24059343338012695
generate_one_block  0.2551734447479248
generate_one_block  0.25513625144958496
generate_one_block  0.2606322765350342
generate_one_block  0.2631862163543701
generate_one_block  0.2665715217590332
generate_one_block  0.2580418586730957
generate_one_block  0.24848151206970215
generate_one_block  0.25380563735961914
generate_one_block  0.24647235870361328
generate_one_block  0.25163912773132324
generate_one_block  0.24344587326049805
generate_one_block  0.2594325542449951
generate_one_block  0.24400544166564941
generate_one_block  0.23596739768981934
generate_one_block  0.2383289337158203
generate_one_block  0.2531557083129883
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04063057899475098
gen group dst list time:  0.1383826732635498
time for parepare:  0.01983356475830078
local_output_nid generation:  0.025916576385498047
local_in_edges_tensor generation:  0.05115818977355957
mini_batch_src_global generation:  0.04635000228881836
r_  generation:  0.4817490577697754
local_output_nid generation:  0.03141331672668457
local_in_edges_tensor generation:  0.03884434700012207
mini_batch_src_global generation:  0.06078910827636719
r_  generation:  0.5058903694152832
local_output_nid generation:  0.03154492378234863
local_in_edges_tensor generation:  0.039132118225097656
mini_batch_src_global generation:  0.059615135192871094
r_  generation:  0.5162935256958008
local_output_nid generation:  0.033225059509277344
local_in_edges_tensor generation:  0.039827823638916016
mini_batch_src_global generation:  0.06190037727355957
r_  generation:  0.5090939998626709
local_output_nid generation:  0.031691551208496094
local_in_edges_tensor generation:  0.035495758056640625
mini_batch_src_global generation:  0.06190800666809082
r_  generation:  0.5185847282409668
local_output_nid generation:  0.03336286544799805
local_in_edges_tensor generation:  0.042075157165527344
mini_batch_src_global generation:  0.06634044647216797
r_  generation:  0.51064133644104
local_output_nid generation:  0.03306865692138672
local_in_edges_tensor generation:  0.037990570068359375
mini_batch_src_global generation:  0.05845999717712402
r_  generation:  0.5048136711120605
local_output_nid generation:  0.0334930419921875
local_in_edges_tensor generation:  0.03411102294921875
mini_batch_src_global generation:  0.05939340591430664
r_  generation:  0.4909510612487793
local_output_nid generation:  0.030477523803710938
local_in_edges_tensor generation:  0.031319379806518555
mini_batch_src_global generation:  0.05925107002258301
r_  generation:  0.4987194538116455
local_output_nid generation:  0.03068852424621582
local_in_edges_tensor generation:  0.03742027282714844
mini_batch_src_global generation:  0.06254696846008301
r_  generation:  0.49868297576904297
local_output_nid generation:  0.030346155166625977
local_in_edges_tensor generation:  0.02985978126525879
mini_batch_src_global generation:  0.058294057846069336
r_  generation:  0.49982595443725586
local_output_nid generation:  0.030511856079101562
local_in_edges_tensor generation:  0.035532474517822266
mini_batch_src_global generation:  0.06305551528930664
r_  generation:  0.5042917728424072
local_output_nid generation:  0.03161120414733887
local_in_edges_tensor generation:  0.028363704681396484
mini_batch_src_global generation:  0.06082010269165039
r_  generation:  0.506843090057373
local_output_nid generation:  0.03199172019958496
local_in_edges_tensor generation:  0.03401613235473633
mini_batch_src_global generation:  0.06242036819458008
r_  generation:  0.509117841720581
local_output_nid generation:  0.03053140640258789
local_in_edges_tensor generation:  0.03297686576843262
mini_batch_src_global generation:  0.05987238883972168
r_  generation:  0.5025308132171631
local_output_nid generation:  0.03040623664855957
local_in_edges_tensor generation:  0.0345301628112793
mini_batch_src_global generation:  0.060428619384765625
r_  generation:  0.5037899017333984
local_output_nid generation:  0.030547380447387695
local_in_edges_tensor generation:  0.04367995262145996
mini_batch_src_global generation:  0.06411409378051758
r_  generation:  0.5264813899993896
local_output_nid generation:  0.03281712532043457
local_in_edges_tensor generation:  0.03857612609863281
mini_batch_src_global generation:  0.06227445602416992
r_  generation:  0.503333330154419
local_output_nid generation:  0.030388832092285156
local_in_edges_tensor generation:  0.02973651885986328
mini_batch_src_global generation:  0.05936169624328613
r_  generation:  0.5043623447418213
local_output_nid generation:  0.03083205223083496
local_in_edges_tensor generation:  0.02890753746032715
mini_batch_src_global generation:  0.06066155433654785
r_  generation:  0.505338191986084
local_output_nid generation:  0.031186580657958984
local_in_edges_tensor generation:  0.03364729881286621
mini_batch_src_global generation:  0.07260537147521973
r_  generation:  0.5079309940338135
local_output_nid generation:  0.030633926391601562
local_in_edges_tensor generation:  0.03383660316467285
mini_batch_src_global generation:  0.06019020080566406
r_  generation:  0.49973177909851074
local_output_nid generation:  0.030312299728393555
local_in_edges_tensor generation:  0.03254103660583496
mini_batch_src_global generation:  0.059392690658569336
r_  generation:  0.4962046146392822
local_output_nid generation:  0.030684709548950195
local_in_edges_tensor generation:  0.031893253326416016
mini_batch_src_global generation:  0.06047248840332031
r_  generation:  0.4984893798828125
local_output_nid generation:  0.03301239013671875
local_in_edges_tensor generation:  0.029619216918945312
mini_batch_src_global generation:  0.05926370620727539
r_  generation:  0.5026383399963379
local_output_nid generation:  0.030495643615722656
local_in_edges_tensor generation:  0.029445648193359375
mini_batch_src_global generation:  0.062052249908447266
r_  generation:  0.4988555908203125
local_output_nid generation:  0.030539751052856445
local_in_edges_tensor generation:  0.029989957809448242
mini_batch_src_global generation:  0.05871081352233887
r_  generation:  0.4992516040802002
local_output_nid generation:  0.031076669692993164
local_in_edges_tensor generation:  0.0309598445892334
mini_batch_src_global generation:  0.06230807304382324
r_  generation:  0.5066843032836914
local_output_nid generation:  0.0300447940826416
local_in_edges_tensor generation:  0.03148007392883301
mini_batch_src_global generation:  0.058441877365112305
r_  generation:  0.4978196620941162
local_output_nid generation:  0.031157732009887695
local_in_edges_tensor generation:  0.030718326568603516
mini_batch_src_global generation:  0.059072017669677734
r_  generation:  0.4896876811981201
local_output_nid generation:  0.029835224151611328
local_in_edges_tensor generation:  0.030354738235473633
mini_batch_src_global generation:  0.05776810646057129
r_  generation:  0.491605281829834
local_output_nid generation:  0.03006434440612793
local_in_edges_tensor generation:  0.030397415161132812
mini_batch_src_global generation:  0.058658599853515625
r_  generation:  0.49461913108825684
----------------------check_connections_block total spend ----------------------------- 23.62924885749817
generate_one_block  0.6854250431060791
generate_one_block  0.6751418113708496
generate_one_block  0.6876018047332764
generate_one_block  0.684147834777832
generate_one_block  0.7837119102478027
generate_one_block  0.6769464015960693
generate_one_block  0.6789195537567139
generate_one_block  0.6801843643188477
generate_one_block  0.6824567317962646
generate_one_block  0.6978392601013184
generate_one_block  0.684708833694458
generate_one_block  0.6858940124511719
generate_one_block  0.6774356365203857
generate_one_block  0.6831130981445312
generate_one_block  0.6764528751373291
generate_one_block  0.6706995964050293
generate_one_block  0.6810612678527832
generate_one_block  0.6882998943328857
generate_one_block  0.6848533153533936
generate_one_block  0.6770679950714111
generate_one_block  0.6843864917755127
generate_one_block  0.674659252166748
generate_one_block  0.674285888671875
generate_one_block  0.6768054962158203
generate_one_block  0.6987214088439941
generate_one_block  0.6789932250976562
generate_one_block  0.6703739166259766
generate_one_block  0.675368070602417
generate_one_block  0.6759252548217773
generate_one_block  0.6699950695037842
generate_one_block  0.6673052310943604
generate_one_block  0.6875290870666504
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.2147216796875 GB
    Memory Allocated: 0.13124704360961914  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

connection checking time:  32.398706674575806
block generation total time  29.94495177268982
average batch blocks generation time:  0.9357797428965569
block dataloader generation time/epoch 65.47596617539723
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2147216796875 GB
    Memory Allocated: 0.1087489128112793  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2147216796875 GB
    Memory Allocated: 20.473398208618164  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2147216796875 GB
    Memory Allocated: 0.10906791687011719  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2147216796875 GB
    Memory Allocated: 20.782413959503174  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2147216796875 GB
    Memory Allocated: 0.10921812057495117  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2147216796875 GB
    Memory Allocated: 21.02013349533081  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2147216796875 GB
    Memory Allocated: 0.10949277877807617  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 21.281453609466553  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10896062850952148  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.563695430755615  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10934162139892578  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.6594820022583  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10901737213134766  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.6911883354187  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10875320434570312  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.399630546569824  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.1094522476196289  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.795424938201904  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10939645767211914  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.956804275512695  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10896158218383789  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.752171516418457  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.1094212532043457  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 21.325818061828613  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.1092519760131836  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.639187812805176  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10944366455078125  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.96143865585327  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10898876190185547  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.63182783126831  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.1091766357421875  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.41722345352173  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.1094827651977539  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.928476333618164  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10958003997802734  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.919004917144775  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.1094064712524414  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 21.01597261428833  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10933780670166016  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.924823760986328  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10981082916259766  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 21.388261318206787  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.1093740463256836  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 21.019143104553223  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10882282257080078  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.57574224472046  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10947895050048828  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.780049800872803  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10905122756958008  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.60479164123535  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10915660858154297  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.77918767929077  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10866975784301758  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.450193881988525  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10942459106445312  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.870901107788086  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10894346237182617  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.53392505645752  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.1088247299194336  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.038465976715088  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10914897918701172  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.347553730010986  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10925102233886719  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.906495094299316  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.028023533523082733 |0.023000463843345642 |0.6280754506587982 |9.962916374206543e-05 |1.2021389529109001 |0.004529476165771484 |
----------------------------------------------------------pseudo_mini_loss sum 1.4871785640716553
Total (block generation + training)time/epoch 126.34835835297902
Training time/epoch 60.270395278930664
Training time without block to device /epoch 59.5343804359436
Training time without total dataloading part /epoch 58.574578523635864
load block tensor time/epoch 0.8967530727386475
block to device time/epoch 0.7360148429870605
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 15 |
Number of nodes for computation during this epoch:  9157283
Number of first layer input nodes during this epoch:  4807511
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.1312270164489746  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026213884353637695
random selection method range initialization spend 0.0057637691497802734
time for parepare:  0.021762371063232422
local_output_nid generation:  0.0014760494232177734
local_in_edges_tensor generation:  0.007493257522583008
mini_batch_src_global generation:  0.0017540454864501953
r_  generation:  0.011093854904174805
local_output_nid generation:  0.0015761852264404297
local_in_edges_tensor generation:  0.0010609626770019531
mini_batch_src_global generation:  0.0016357898712158203
r_  generation:  0.010678768157958984
local_output_nid generation:  0.0015954971313476562
local_in_edges_tensor generation:  0.0009980201721191406
mini_batch_src_global generation:  0.0011606216430664062
r_  generation:  0.009963512420654297
local_output_nid generation:  0.0015926361083984375
local_in_edges_tensor generation:  0.0009510517120361328
mini_batch_src_global generation:  0.0011115074157714844
r_  generation:  0.009886741638183594
local_output_nid generation:  0.0015747547149658203
local_in_edges_tensor generation:  0.0009093284606933594
mini_batch_src_global generation:  0.0010864734649658203
r_  generation:  0.010096549987792969
local_output_nid generation:  0.001565694808959961
local_in_edges_tensor generation:  0.0009369850158691406
mini_batch_src_global generation:  0.0012054443359375
r_  generation:  0.010530948638916016
local_output_nid generation:  0.0015594959259033203
local_in_edges_tensor generation:  0.0008969306945800781
mini_batch_src_global generation:  0.0011234283447265625
r_  generation:  0.010400056838989258
local_output_nid generation:  0.0015540122985839844
local_in_edges_tensor generation:  0.0008912086486816406
mini_batch_src_global generation:  0.0010657310485839844
r_  generation:  0.009851455688476562
local_output_nid generation:  0.0015530586242675781
local_in_edges_tensor generation:  0.0009088516235351562
mini_batch_src_global generation:  0.001058340072631836
r_  generation:  0.009849071502685547
local_output_nid generation:  0.0015540122985839844
local_in_edges_tensor generation:  0.0008566379547119141
mini_batch_src_global generation:  0.0010907649993896484
r_  generation:  0.010442495346069336
local_output_nid generation:  0.0015561580657958984
local_in_edges_tensor generation:  0.0008738040924072266
mini_batch_src_global generation:  0.0010921955108642578
r_  generation:  0.010349035263061523
local_output_nid generation:  0.0015652179718017578
local_in_edges_tensor generation:  0.0008678436279296875
mini_batch_src_global generation:  0.0010406970977783203
r_  generation:  0.010017871856689453
local_output_nid generation:  0.0015485286712646484
local_in_edges_tensor generation:  0.000865936279296875
mini_batch_src_global generation:  0.001039743423461914
r_  generation:  0.010088682174682617
local_output_nid generation:  0.0015609264373779297
local_in_edges_tensor generation:  0.0008447170257568359
mini_batch_src_global generation:  0.0012362003326416016
r_  generation:  0.010607481002807617
local_output_nid generation:  0.0015518665313720703
local_in_edges_tensor generation:  0.0008919239044189453
mini_batch_src_global generation:  0.0010826587677001953
r_  generation:  0.010087251663208008
local_output_nid generation:  0.0015838146209716797
local_in_edges_tensor generation:  0.0008854866027832031
mini_batch_src_global generation:  0.001093149185180664
r_  generation:  0.010276556015014648
local_output_nid generation:  0.001547098159790039
local_in_edges_tensor generation:  0.0008609294891357422
mini_batch_src_global generation:  0.0011420249938964844
r_  generation:  0.010361194610595703
local_output_nid generation:  0.0015497207641601562
local_in_edges_tensor generation:  0.0008540153503417969
mini_batch_src_global generation:  0.0011086463928222656
r_  generation:  0.010622739791870117
local_output_nid generation:  0.0015568733215332031
local_in_edges_tensor generation:  0.0009019374847412109
mini_batch_src_global generation:  0.0011026859283447266
r_  generation:  0.01042795181274414
local_output_nid generation:  0.001547098159790039
local_in_edges_tensor generation:  0.0008714199066162109
mini_batch_src_global generation:  0.0010483264923095703
r_  generation:  0.010222911834716797
local_output_nid generation:  0.0015418529510498047
local_in_edges_tensor generation:  0.0008113384246826172
mini_batch_src_global generation:  0.0010447502136230469
r_  generation:  0.010239362716674805
local_output_nid generation:  0.0015375614166259766
local_in_edges_tensor generation:  0.0008952617645263672
mini_batch_src_global generation:  0.001077890396118164
r_  generation:  0.010260820388793945
local_output_nid generation:  0.0015494823455810547
local_in_edges_tensor generation:  0.0008695125579833984
mini_batch_src_global generation:  0.0011053085327148438
r_  generation:  0.01063680648803711
local_output_nid generation:  0.0015435218811035156
local_in_edges_tensor generation:  0.0008649826049804688
mini_batch_src_global generation:  0.0010695457458496094
r_  generation:  0.010307550430297852
local_output_nid generation:  0.0015926361083984375
local_in_edges_tensor generation:  0.001039266586303711
mini_batch_src_global generation:  0.0011701583862304688
r_  generation:  0.010135889053344727
local_output_nid generation:  0.001573801040649414
local_in_edges_tensor generation:  0.0008814334869384766
mini_batch_src_global generation:  0.0010488033294677734
r_  generation:  0.009840726852416992
local_output_nid generation:  0.0015778541564941406
local_in_edges_tensor generation:  0.0008480548858642578
mini_batch_src_global generation:  0.0010519027709960938
r_  generation:  0.010221481323242188
local_output_nid generation:  0.0015811920166015625
local_in_edges_tensor generation:  0.0009357929229736328
mini_batch_src_global generation:  0.001108407974243164
r_  generation:  0.010064840316772461
local_output_nid generation:  0.0015482902526855469
local_in_edges_tensor generation:  0.0009131431579589844
mini_batch_src_global generation:  0.0011398792266845703
r_  generation:  0.010250568389892578
local_output_nid generation:  0.0015685558319091797
local_in_edges_tensor generation:  0.0008275508880615234
mini_batch_src_global generation:  0.0010459423065185547
r_  generation:  0.010040998458862305
local_output_nid generation:  0.0015878677368164062
local_in_edges_tensor generation:  0.0008392333984375
mini_batch_src_global generation:  0.001165151596069336
r_  generation:  0.010340452194213867
local_output_nid generation:  0.0015707015991210938
local_in_edges_tensor generation:  0.0009343624114990234
mini_batch_src_global generation:  0.0010917186737060547
r_  generation:  0.010271787643432617
----------------------check_connections_block total spend ----------------------------- 0.5659193992614746
generate_one_block  0.025285959243774414
generate_one_block  0.02113652229309082
generate_one_block  0.019182443618774414
generate_one_block  0.0186922550201416
generate_one_block  0.018855571746826172
generate_one_block  0.019321203231811523
generate_one_block  0.018952131271362305
generate_one_block  0.01797771453857422
generate_one_block  0.018101215362548828
generate_one_block  0.019009113311767578
generate_one_block  0.018681764602661133
generate_one_block  0.01830601692199707
generate_one_block  0.01821112632751465
generate_one_block  0.019169330596923828
generate_one_block  0.018015384674072266
generate_one_block  0.018361330032348633
generate_one_block  0.018664121627807617
generate_one_block  0.01898980140686035
generate_one_block  0.01886463165283203
generate_one_block  0.018187284469604492
generate_one_block  0.01847219467163086
generate_one_block  0.01844167709350586
generate_one_block  0.022219419479370117
generate_one_block  0.019433021545410156
generate_one_block  0.018837690353393555
generate_one_block  0.017798662185668945
generate_one_block  0.018429994583129883
generate_one_block  0.018112897872924805
generate_one_block  0.01837921142578125
generate_one_block  0.018007278442382812
generate_one_block  0.01873159408569336
generate_one_block  0.0187833309173584
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04288840293884277
gen group dst list time:  0.02352118492126465
time for parepare:  0.022182941436767578
local_output_nid generation:  0.006670713424682617
local_in_edges_tensor generation:  0.01824164390563965
mini_batch_src_global generation:  0.018503904342651367
r_  generation:  0.16579627990722656
local_output_nid generation:  0.008977651596069336
local_in_edges_tensor generation:  0.01190042495727539
mini_batch_src_global generation:  0.021498680114746094
r_  generation:  0.16612482070922852
local_output_nid generation:  0.009324312210083008
local_in_edges_tensor generation:  0.034935712814331055
mini_batch_src_global generation:  0.021340608596801758
r_  generation:  0.17448759078979492
local_output_nid generation:  0.009459733963012695
local_in_edges_tensor generation:  0.012033224105834961
mini_batch_src_global generation:  0.020573854446411133
r_  generation:  0.17629027366638184
local_output_nid generation:  0.009583473205566406
local_in_edges_tensor generation:  0.010286569595336914
mini_batch_src_global generation:  0.021787643432617188
r_  generation:  0.17797350883483887
local_output_nid generation:  0.009835004806518555
local_in_edges_tensor generation:  0.01254892349243164
mini_batch_src_global generation:  0.023806333541870117
r_  generation:  0.18639659881591797
local_output_nid generation:  0.009272098541259766
local_in_edges_tensor generation:  0.011658191680908203
mini_batch_src_global generation:  0.023347854614257812
r_  generation:  0.1821458339691162
local_output_nid generation:  0.008882522583007812
local_in_edges_tensor generation:  0.0104217529296875
mini_batch_src_global generation:  0.021794795989990234
r_  generation:  0.17353606224060059
local_output_nid generation:  0.008986473083496094
local_in_edges_tensor generation:  0.011218786239624023
mini_batch_src_global generation:  0.0231475830078125
r_  generation:  0.1752772331237793
local_output_nid generation:  0.009494304656982422
local_in_edges_tensor generation:  0.011519670486450195
mini_batch_src_global generation:  0.023539304733276367
r_  generation:  0.1817307472229004
local_output_nid generation:  0.009480714797973633
local_in_edges_tensor generation:  0.009935140609741211
mini_batch_src_global generation:  0.023331403732299805
r_  generation:  0.181779146194458
local_output_nid generation:  0.009305238723754883
local_in_edges_tensor generation:  0.011133909225463867
mini_batch_src_global generation:  0.022138595581054688
r_  generation:  0.17342376708984375
local_output_nid generation:  0.009501934051513672
local_in_edges_tensor generation:  0.009189844131469727
mini_batch_src_global generation:  0.02241349220275879
r_  generation:  0.17670941352844238
local_output_nid generation:  0.009724140167236328
local_in_edges_tensor generation:  0.009470939636230469
mini_batch_src_global generation:  0.02393031120300293
r_  generation:  0.18488168716430664
local_output_nid generation:  0.009277582168579102
local_in_edges_tensor generation:  0.008740663528442383
mini_batch_src_global generation:  0.02281475067138672
r_  generation:  0.1751537322998047
local_output_nid generation:  0.009479999542236328
local_in_edges_tensor generation:  0.00928044319152832
mini_batch_src_global generation:  0.02292776107788086
r_  generation:  0.18477082252502441
local_output_nid generation:  0.009557723999023438
local_in_edges_tensor generation:  0.009628772735595703
mini_batch_src_global generation:  0.023654460906982422
r_  generation:  0.18320775032043457
local_output_nid generation:  0.009601593017578125
local_in_edges_tensor generation:  0.009839057922363281
mini_batch_src_global generation:  0.023478031158447266
r_  generation:  0.18389582633972168
local_output_nid generation:  0.00965738296508789
local_in_edges_tensor generation:  0.009270906448364258
mini_batch_src_global generation:  0.023599624633789062
r_  generation:  0.18497014045715332
local_output_nid generation:  0.009510040283203125
local_in_edges_tensor generation:  0.011472702026367188
mini_batch_src_global generation:  0.023837566375732422
r_  generation:  0.18052172660827637
local_output_nid generation:  0.009333372116088867
local_in_edges_tensor generation:  0.010002851486206055
mini_batch_src_global generation:  0.022476673126220703
r_  generation:  0.18036723136901855
local_output_nid generation:  0.009756326675415039
local_in_edges_tensor generation:  0.009221553802490234
mini_batch_src_global generation:  0.022394418716430664
r_  generation:  0.18297648429870605
local_output_nid generation:  0.009789705276489258
local_in_edges_tensor generation:  0.009176015853881836
mini_batch_src_global generation:  0.02346038818359375
r_  generation:  0.1850295066833496
local_output_nid generation:  0.009596109390258789
local_in_edges_tensor generation:  0.00961923599243164
mini_batch_src_global generation:  0.023040056228637695
r_  generation:  0.18090152740478516
local_output_nid generation:  0.009644031524658203
local_in_edges_tensor generation:  0.009582996368408203
mini_batch_src_global generation:  0.023580312728881836
r_  generation:  0.18432211875915527
local_output_nid generation:  0.009291410446166992
local_in_edges_tensor generation:  0.010822296142578125
mini_batch_src_global generation:  0.022174596786499023
r_  generation:  0.17481017112731934
local_output_nid generation:  0.009544134140014648
local_in_edges_tensor generation:  0.009089946746826172
mini_batch_src_global generation:  0.02276754379272461
r_  generation:  0.17933201789855957
local_output_nid generation:  0.009579658508300781
local_in_edges_tensor generation:  0.008718729019165039
mini_batch_src_global generation:  0.022359609603881836
r_  generation:  0.1834855079650879
local_output_nid generation:  0.009618520736694336
local_in_edges_tensor generation:  0.009165525436401367
mini_batch_src_global generation:  0.022505521774291992
r_  generation:  0.17993545532226562
local_output_nid generation:  0.009404897689819336
local_in_edges_tensor generation:  0.008815765380859375
mini_batch_src_global generation:  0.022113561630249023
r_  generation:  0.17827534675598145
local_output_nid generation:  0.009657859802246094
local_in_edges_tensor generation:  0.009157419204711914
mini_batch_src_global generation:  0.023550748825073242
r_  generation:  0.18682146072387695
local_output_nid generation:  0.009689092636108398
local_in_edges_tensor generation:  0.009360551834106445
mini_batch_src_global generation:  0.02292656898498535
r_  generation:  0.18492865562438965
----------------------check_connections_block total spend ----------------------------- 8.448847770690918
generate_one_block  0.2532367706298828
generate_one_block  0.24010467529296875
generate_one_block  0.24519801139831543
generate_one_block  0.24587059020996094
generate_one_block  0.26213574409484863
generate_one_block  0.2615697383880615
generate_one_block  0.2513117790222168
generate_one_block  0.23757576942443848
generate_one_block  0.23822736740112305
generate_one_block  0.24817585945129395
generate_one_block  0.24862051010131836
generate_one_block  0.23291349411010742
generate_one_block  0.23919677734375
generate_one_block  0.2534923553466797
generate_one_block  0.23656201362609863
generate_one_block  0.24717402458190918
generate_one_block  0.2491910457611084
generate_one_block  0.25069713592529297
generate_one_block  0.24947094917297363
generate_one_block  0.24715852737426758
generate_one_block  0.2453784942626953
generate_one_block  0.24275779724121094
generate_one_block  0.2505054473876953
generate_one_block  0.2427988052368164
generate_one_block  0.24848389625549316
generate_one_block  0.23380136489868164
generate_one_block  0.24291086196899414
generate_one_block  0.2414848804473877
generate_one_block  0.24287867546081543
generate_one_block  0.24033761024475098
generate_one_block  0.2537863254547119
generate_one_block  0.24756360054016113
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.039656639099121094
gen group dst list time:  0.10489296913146973
time for parepare:  0.020381927490234375
local_output_nid generation:  0.025210857391357422
local_in_edges_tensor generation:  0.049515724182128906
mini_batch_src_global generation:  0.050017595291137695
r_  generation:  0.48485755920410156
local_output_nid generation:  0.03167271614074707
local_in_edges_tensor generation:  0.037177085876464844
mini_batch_src_global generation:  0.060866355895996094
r_  generation:  0.48084163665771484
local_output_nid generation:  0.031557321548461914
local_in_edges_tensor generation:  0.037493228912353516
mini_batch_src_global generation:  0.05899357795715332
r_  generation:  0.5063076019287109
local_output_nid generation:  0.034542083740234375
local_in_edges_tensor generation:  0.03103780746459961
mini_batch_src_global generation:  0.061173200607299805
r_  generation:  0.4897146224975586
local_output_nid generation:  0.032157182693481445
local_in_edges_tensor generation:  0.03215169906616211
mini_batch_src_global generation:  0.06040310859680176
r_  generation:  0.49556398391723633
local_output_nid generation:  0.03261852264404297
local_in_edges_tensor generation:  0.031426191329956055
mini_batch_src_global generation:  0.0617222785949707
r_  generation:  0.4912865161895752
local_output_nid generation:  0.030725479125976562
local_in_edges_tensor generation:  0.03653979301452637
mini_batch_src_global generation:  0.05870842933654785
r_  generation:  0.4955024719238281
local_output_nid generation:  0.029877662658691406
local_in_edges_tensor generation:  0.03684353828430176
mini_batch_src_global generation:  0.05923581123352051
r_  generation:  0.4844796657562256
local_output_nid generation:  0.030225515365600586
local_in_edges_tensor generation:  0.029754161834716797
mini_batch_src_global generation:  0.058670997619628906
r_  generation:  0.49564528465270996
local_output_nid generation:  0.030399322509765625
local_in_edges_tensor generation:  0.0290071964263916
mini_batch_src_global generation:  0.059755563735961914
r_  generation:  0.49223947525024414
local_output_nid generation:  0.030052900314331055
local_in_edges_tensor generation:  0.029533863067626953
mini_batch_src_global generation:  0.05868053436279297
r_  generation:  0.4985239505767822
local_output_nid generation:  0.029844999313354492
local_in_edges_tensor generation:  0.029185771942138672
mini_batch_src_global generation:  0.05902671813964844
r_  generation:  0.4885444641113281
local_output_nid generation:  0.03023529052734375
local_in_edges_tensor generation:  0.028444290161132812
mini_batch_src_global generation:  0.0579836368560791
r_  generation:  0.49613451957702637
local_output_nid generation:  0.030214548110961914
local_in_edges_tensor generation:  0.028332948684692383
mini_batch_src_global generation:  0.06236696243286133
r_  generation:  0.4913489818572998
local_output_nid generation:  0.02963399887084961
local_in_edges_tensor generation:  0.028815269470214844
mini_batch_src_global generation:  0.05770587921142578
r_  generation:  0.49353957176208496
local_output_nid generation:  0.02965068817138672
local_in_edges_tensor generation:  0.02886366844177246
mini_batch_src_global generation:  0.05917978286743164
r_  generation:  0.4925844669342041
local_output_nid generation:  0.030513525009155273
local_in_edges_tensor generation:  0.028687238693237305
mini_batch_src_global generation:  0.058716773986816406
r_  generation:  0.5000500679016113
local_output_nid generation:  0.029914140701293945
local_in_edges_tensor generation:  0.028805017471313477
mini_batch_src_global generation:  0.05971717834472656
r_  generation:  0.4978320598602295
local_output_nid generation:  0.03066396713256836
local_in_edges_tensor generation:  0.0300140380859375
mini_batch_src_global generation:  0.05864405632019043
r_  generation:  0.5000407695770264
local_output_nid generation:  0.0299224853515625
local_in_edges_tensor generation:  0.029872894287109375
mini_batch_src_global generation:  0.05933785438537598
r_  generation:  0.4978780746459961
local_output_nid generation:  0.030249595642089844
local_in_edges_tensor generation:  0.030057907104492188
mini_batch_src_global generation:  0.058280229568481445
r_  generation:  0.49747538566589355
local_output_nid generation:  0.03023552894592285
local_in_edges_tensor generation:  0.02858257293701172
mini_batch_src_global generation:  0.05968594551086426
r_  generation:  0.49933791160583496
local_output_nid generation:  0.030240297317504883
local_in_edges_tensor generation:  0.03125596046447754
mini_batch_src_global generation:  0.06015181541442871
r_  generation:  0.5034036636352539
local_output_nid generation:  0.030058622360229492
local_in_edges_tensor generation:  0.03220081329345703
mini_batch_src_global generation:  0.0601344108581543
r_  generation:  0.4963808059692383
local_output_nid generation:  0.030124902725219727
local_in_edges_tensor generation:  0.03152942657470703
mini_batch_src_global generation:  0.058580636978149414
r_  generation:  0.49953556060791016
local_output_nid generation:  0.029947280883789062
local_in_edges_tensor generation:  0.029211759567260742
mini_batch_src_global generation:  0.05905508995056152
r_  generation:  0.49300432205200195
local_output_nid generation:  0.029887914657592773
local_in_edges_tensor generation:  0.028216838836669922
mini_batch_src_global generation:  0.058063507080078125
r_  generation:  0.49480628967285156
local_output_nid generation:  0.029839515686035156
local_in_edges_tensor generation:  0.03053879737854004
mini_batch_src_global generation:  0.05926799774169922
r_  generation:  0.4923365116119385
local_output_nid generation:  0.029919862747192383
local_in_edges_tensor generation:  0.030036449432373047
mini_batch_src_global generation:  0.05986380577087402
r_  generation:  0.4991157054901123
local_output_nid generation:  0.029742717742919922
local_in_edges_tensor generation:  0.030561208724975586
mini_batch_src_global generation:  0.05978798866271973
r_  generation:  0.492267370223999
local_output_nid generation:  0.02996540069580078
local_in_edges_tensor generation:  0.03089308738708496
mini_batch_src_global generation:  0.05884361267089844
r_  generation:  0.4998788833618164
local_output_nid generation:  0.030064105987548828
local_in_edges_tensor generation:  0.030841827392578125
mini_batch_src_global generation:  0.060173988342285156
r_  generation:  0.4951751232147217
----------------------check_connections_block total spend ----------------------------- 23.169437646865845
generate_one_block  0.6783480644226074
generate_one_block  0.6690061092376709
generate_one_block  0.6708106994628906
generate_one_block  0.6744959354400635
generate_one_block  0.7571227550506592
generate_one_block  0.6763362884521484
generate_one_block  0.671398401260376
generate_one_block  0.6630651950836182
generate_one_block  0.6691293716430664
generate_one_block  0.6764030456542969
generate_one_block  0.6757550239562988
generate_one_block  0.6673438549041748
generate_one_block  0.6796715259552002
generate_one_block  0.6831278800964355
generate_one_block  0.6672835350036621
generate_one_block  0.6746437549591064
generate_one_block  0.6821846961975098
generate_one_block  0.6736931800842285
generate_one_block  0.6809277534484863
generate_one_block  0.6742813587188721
generate_one_block  0.6730961799621582
generate_one_block  0.6809842586517334
generate_one_block  0.685964822769165
generate_one_block  0.6779947280883789
generate_one_block  0.6978981494903564
generate_one_block  0.6709449291229248
generate_one_block  0.6738696098327637
generate_one_block  0.6832759380340576
generate_one_block  0.6816260814666748
generate_one_block  0.6782548427581787
generate_one_block  0.6831872463226318
generate_one_block  0.6875309944152832
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.1312270164489746  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

connection checking time:  31.618285417556763
block generation total time  29.61022710800171
average batch blocks generation time:  0.9253195971250534
block dataloader generation time/epoch 65.39255598613194
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10931205749511719  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 21.066176414489746  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10929059982299805  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.559121131896973  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.1093287467956543  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.8701491355896  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10951662063598633  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.90726947784424  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10936164855957031  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.879435062408447  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10960006713867188  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 21.33906126022339  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10951089859008789  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 21.061949729919434  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10886478424072266  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.413265705108643  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10906839370727539  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.58129596710205  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10935211181640625  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.97750997543335  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10947227478027344  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.92163610458374  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10883760452270508  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.338362216949463  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10945892333984375  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.57669448852539  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10937070846557617  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 21.034770488739014  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10884761810302734  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.347495555877686  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10913324356079102  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.869091510772705  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10946798324584961  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.954551219940186  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10954809188842773  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 21.033762454986572  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10942697525024414  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 21.01892375946045  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10887908935546875  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.643468379974365  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10891199111938477  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.611376762390137  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10925865173339844  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.610843181610107  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10940694808959961  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 21.021907329559326  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10915422439575195  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.73149299621582  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10912227630615234  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.936304092407227  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.1088857650756836  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.26191806793213  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10885381698608398  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.475478649139404  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10920524597167969  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.613789081573486  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10927391052246094  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.652522563934326  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10896444320678711  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.531874656677246  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10923576354980469  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 21.023301124572754  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10950565338134766  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.93401527404785  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03448563814163208 |0.02243886888027191 |0.6314096748828888 |9.779632091522217e-05 |1.2019269168376923 |0.005289554595947266 |
----------------------------------------------------------pseudo_mini_loss sum 1.4577546119689941
Total (block generation + training)time/epoch 126.2199308531625
Training time/epoch 60.55703353881836
Training time without block to device /epoch 59.83898973464966
Training time without total dataloading part /epoch 58.67518997192383
load block tensor time/epoch 1.1035404205322266
block to device time/epoch 0.7180438041687012
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 16 |
Number of nodes for computation during this epoch:  9161604
Number of first layer input nodes during this epoch:  4809193
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.13231229782104492  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.029893875122070312
random selection method range initialization spend 0.006772279739379883
time for parepare:  0.02325749397277832
local_output_nid generation:  0.00146484375
local_in_edges_tensor generation:  0.006741762161254883
mini_batch_src_global generation:  0.0024611949920654297
r_  generation:  0.012338638305664062
local_output_nid generation:  0.001800537109375
local_in_edges_tensor generation:  0.000978708267211914
mini_batch_src_global generation:  0.0016515254974365234
r_  generation:  0.010829687118530273
local_output_nid generation:  0.001771688461303711
local_in_edges_tensor generation:  0.0009267330169677734
mini_batch_src_global generation:  0.0011641979217529297
r_  generation:  0.010013341903686523
local_output_nid generation:  0.001653432846069336
local_in_edges_tensor generation:  0.0009005069732666016
mini_batch_src_global generation:  0.0011982917785644531
r_  generation:  0.012478351593017578
local_output_nid generation:  0.0028467178344726562
local_in_edges_tensor generation:  0.0010242462158203125
mini_batch_src_global generation:  0.0011000633239746094
r_  generation:  0.009943723678588867
local_output_nid generation:  0.0016849040985107422
local_in_edges_tensor generation:  0.0008785724639892578
mini_batch_src_global generation:  0.0010929107666015625
r_  generation:  0.010038137435913086
local_output_nid generation:  0.0016198158264160156
local_in_edges_tensor generation:  0.0008764266967773438
mini_batch_src_global generation:  0.0011451244354248047
r_  generation:  0.010190486907958984
local_output_nid generation:  0.0016148090362548828
local_in_edges_tensor generation:  0.0008594989776611328
mini_batch_src_global generation:  0.0010690689086914062
r_  generation:  0.010007381439208984
local_output_nid generation:  0.0016222000122070312
local_in_edges_tensor generation:  0.0008802413940429688
mini_batch_src_global generation:  0.001209259033203125
r_  generation:  0.010589122772216797
local_output_nid generation:  0.0016071796417236328
local_in_edges_tensor generation:  0.0008447170257568359
mini_batch_src_global generation:  0.0011725425720214844
r_  generation:  0.012304067611694336
local_output_nid generation:  0.0016143321990966797
local_in_edges_tensor generation:  0.0010030269622802734
mini_batch_src_global generation:  0.001199960708618164
r_  generation:  0.010849475860595703
local_output_nid generation:  0.0015993118286132812
local_in_edges_tensor generation:  0.0008714199066162109
mini_batch_src_global generation:  0.0012309551239013672
r_  generation:  0.010645151138305664
local_output_nid generation:  0.0016283988952636719
local_in_edges_tensor generation:  0.0008471012115478516
mini_batch_src_global generation:  0.0011446475982666016
r_  generation:  0.01027536392211914
local_output_nid generation:  0.0015959739685058594
local_in_edges_tensor generation:  0.0008597373962402344
mini_batch_src_global generation:  0.0011985301971435547
r_  generation:  0.010435104370117188
local_output_nid generation:  0.0015902519226074219
local_in_edges_tensor generation:  0.0008361339569091797
mini_batch_src_global generation:  0.0011115074157714844
r_  generation:  0.010338306427001953
local_output_nid generation:  0.0016205310821533203
local_in_edges_tensor generation:  0.0008392333984375
mini_batch_src_global generation:  0.0011136531829833984
r_  generation:  0.010785341262817383
local_output_nid generation:  0.0015799999237060547
local_in_edges_tensor generation:  0.0009415149688720703
mini_batch_src_global generation:  0.0011622905731201172
r_  generation:  0.010356664657592773
local_output_nid generation:  0.0015895366668701172
local_in_edges_tensor generation:  0.0008511543273925781
mini_batch_src_global generation:  0.0010974407196044922
r_  generation:  0.009983539581298828
local_output_nid generation:  0.0016467571258544922
local_in_edges_tensor generation:  0.0008502006530761719
mini_batch_src_global generation:  0.0010840892791748047
r_  generation:  0.010276079177856445
local_output_nid generation:  0.0016031265258789062
local_in_edges_tensor generation:  0.0008656978607177734
mini_batch_src_global generation:  0.0012149810791015625
r_  generation:  0.010776042938232422
local_output_nid generation:  0.0015897750854492188
local_in_edges_tensor generation:  0.0008878707885742188
mini_batch_src_global generation:  0.00119781494140625
r_  generation:  0.010824441909790039
local_output_nid generation:  0.0015933513641357422
local_in_edges_tensor generation:  0.0008404254913330078
mini_batch_src_global generation:  0.001110076904296875
r_  generation:  0.010114908218383789
local_output_nid generation:  0.0016062259674072266
local_in_edges_tensor generation:  0.0008313655853271484
mini_batch_src_global generation:  0.0013096332550048828
r_  generation:  0.010011672973632812
local_output_nid generation:  0.001598358154296875
local_in_edges_tensor generation:  0.0008409023284912109
mini_batch_src_global generation:  0.0011925697326660156
r_  generation:  0.01021885871887207
local_output_nid generation:  0.0016226768493652344
local_in_edges_tensor generation:  0.0009105205535888672
mini_batch_src_global generation:  0.0011413097381591797
r_  generation:  0.010133504867553711
local_output_nid generation:  0.001569986343383789
local_in_edges_tensor generation:  0.0008828639984130859
mini_batch_src_global generation:  0.0011551380157470703
r_  generation:  0.010662555694580078
local_output_nid generation:  0.0016036033630371094
local_in_edges_tensor generation:  0.0008742809295654297
mini_batch_src_global generation:  0.0012469291687011719
r_  generation:  0.010647296905517578
local_output_nid generation:  0.0016088485717773438
local_in_edges_tensor generation:  0.0008656978607177734
mini_batch_src_global generation:  0.0011951923370361328
r_  generation:  0.011007308959960938
local_output_nid generation:  0.001603841781616211
local_in_edges_tensor generation:  0.0009317398071289062
mini_batch_src_global generation:  0.003435373306274414
r_  generation:  0.010692358016967773
local_output_nid generation:  0.0015866756439208984
local_in_edges_tensor generation:  0.00093841552734375
mini_batch_src_global generation:  0.0011887550354003906
r_  generation:  0.010208368301391602
local_output_nid generation:  0.001589059829711914
local_in_edges_tensor generation:  0.0008673667907714844
mini_batch_src_global generation:  0.0011222362518310547
r_  generation:  0.010217428207397461
local_output_nid generation:  0.0015959739685058594
local_in_edges_tensor generation:  0.0008766651153564453
mini_batch_src_global generation:  0.0011112689971923828
r_  generation:  0.010283231735229492
----------------------check_connections_block total spend ----------------------------- 0.5866613388061523
generate_one_block  0.026241540908813477
generate_one_block  0.021905899047851562
generate_one_block  0.019359111785888672
generate_one_block  0.0191347599029541
generate_one_block  0.018541336059570312
generate_one_block  0.018795490264892578
generate_one_block  0.02038431167602539
generate_one_block  0.022207021713256836
generate_one_block  0.0194091796875
generate_one_block  0.01890730857849121
generate_one_block  0.01963019371032715
generate_one_block  0.01972341537475586
generate_one_block  0.018543004989624023
generate_one_block  0.019036531448364258
generate_one_block  0.018933534622192383
generate_one_block  0.01891946792602539
generate_one_block  0.020444393157958984
generate_one_block  0.01806330680847168
generate_one_block  0.018511056900024414
generate_one_block  0.019675731658935547
generate_one_block  0.019599437713623047
generate_one_block  0.018221378326416016
generate_one_block  0.021442890167236328
generate_one_block  0.019552946090698242
generate_one_block  0.01869368553161621
generate_one_block  0.018968582153320312
generate_one_block  0.019026756286621094
generate_one_block  0.021589279174804688
generate_one_block  0.01911759376525879
generate_one_block  0.018332958221435547
generate_one_block  0.018290281295776367
generate_one_block  0.018587589263916016
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04088401794433594
gen group dst list time:  0.02592158317565918
time for parepare:  0.022426128387451172
local_output_nid generation:  0.006745100021362305
local_in_edges_tensor generation:  0.024543046951293945
mini_batch_src_global generation:  0.018824100494384766
r_  generation:  0.17182397842407227
local_output_nid generation:  0.009336233139038086
local_in_edges_tensor generation:  0.012346267700195312
mini_batch_src_global generation:  0.022137880325317383
r_  generation:  0.1986536979675293
local_output_nid generation:  0.01627063751220703
local_in_edges_tensor generation:  0.04632711410522461
mini_batch_src_global generation:  0.0213167667388916
r_  generation:  0.1721205711364746
local_output_nid generation:  0.011248111724853516
local_in_edges_tensor generation:  0.012258768081665039
mini_batch_src_global generation:  0.021625757217407227
r_  generation:  0.21906328201293945
local_output_nid generation:  0.010556459426879883
local_in_edges_tensor generation:  0.010269403457641602
mini_batch_src_global generation:  0.0220184326171875
r_  generation:  0.17294764518737793
local_output_nid generation:  0.009463310241699219
local_in_edges_tensor generation:  0.01051640510559082
mini_batch_src_global generation:  0.022904396057128906
r_  generation:  0.20884037017822266
local_output_nid generation:  0.014358282089233398
local_in_edges_tensor generation:  0.012228250503540039
mini_batch_src_global generation:  0.025925874710083008
r_  generation:  0.1966559886932373
local_output_nid generation:  0.014361143112182617
local_in_edges_tensor generation:  0.01339268684387207
mini_batch_src_global generation:  0.024523496627807617
r_  generation:  0.1932518482208252
local_output_nid generation:  0.014745950698852539
local_in_edges_tensor generation:  0.01578831672668457
mini_batch_src_global generation:  0.026658296585083008
r_  generation:  0.20362353324890137
local_output_nid generation:  0.015083074569702148
local_in_edges_tensor generation:  0.011948585510253906
mini_batch_src_global generation:  0.03711748123168945
r_  generation:  0.18277621269226074
local_output_nid generation:  0.010687589645385742
local_in_edges_tensor generation:  0.010759353637695312
mini_batch_src_global generation:  0.027441024780273438
r_  generation:  0.19235491752624512
local_output_nid generation:  0.010176897048950195
local_in_edges_tensor generation:  0.012079000473022461
mini_batch_src_global generation:  0.026301860809326172
r_  generation:  0.18796467781066895
local_output_nid generation:  0.010927915573120117
local_in_edges_tensor generation:  0.009084224700927734
mini_batch_src_global generation:  0.02524089813232422
r_  generation:  0.18166565895080566
local_output_nid generation:  0.009648561477661133
local_in_edges_tensor generation:  0.010229110717773438
mini_batch_src_global generation:  0.02550196647644043
r_  generation:  0.18464946746826172
local_output_nid generation:  0.011327028274536133
local_in_edges_tensor generation:  0.011530399322509766
mini_batch_src_global generation:  0.02333545684814453
r_  generation:  0.1894702911376953
local_output_nid generation:  0.010289192199707031
local_in_edges_tensor generation:  0.012002706527709961
mini_batch_src_global generation:  0.024786949157714844
r_  generation:  0.18825984001159668
local_output_nid generation:  0.009529829025268555
local_in_edges_tensor generation:  0.010622262954711914
mini_batch_src_global generation:  0.023702144622802734
r_  generation:  0.18842840194702148
local_output_nid generation:  0.009262800216674805
local_in_edges_tensor generation:  0.011504650115966797
mini_batch_src_global generation:  0.02615213394165039
r_  generation:  0.1773681640625
local_output_nid generation:  0.010671377182006836
local_in_edges_tensor generation:  0.010123014450073242
mini_batch_src_global generation:  0.02270960807800293
r_  generation:  0.18152379989624023
local_output_nid generation:  0.009844303131103516
local_in_edges_tensor generation:  0.012552499771118164
mini_batch_src_global generation:  0.02411818504333496
r_  generation:  0.18905067443847656
local_output_nid generation:  0.009746313095092773
local_in_edges_tensor generation:  0.012410879135131836
mini_batch_src_global generation:  0.02515125274658203
r_  generation:  0.190687894821167
local_output_nid generation:  0.009337902069091797
local_in_edges_tensor generation:  0.011944293975830078
mini_batch_src_global generation:  0.023005962371826172
r_  generation:  0.1766805648803711
local_output_nid generation:  0.009518146514892578
local_in_edges_tensor generation:  0.009545564651489258
mini_batch_src_global generation:  0.022502660751342773
r_  generation:  0.1794424057006836
local_output_nid generation:  0.009575605392456055
local_in_edges_tensor generation:  0.008785724639892578
mini_batch_src_global generation:  0.022995948791503906
r_  generation:  0.18203330039978027
local_output_nid generation:  0.009596109390258789
local_in_edges_tensor generation:  0.008913993835449219
mini_batch_src_global generation:  0.022690296173095703
r_  generation:  0.17981410026550293
local_output_nid generation:  0.00963735580444336
local_in_edges_tensor generation:  0.012868881225585938
mini_batch_src_global generation:  0.023540258407592773
r_  generation:  0.21633458137512207
local_output_nid generation:  0.009596586227416992
local_in_edges_tensor generation:  0.010580778121948242
mini_batch_src_global generation:  0.023259878158569336
r_  generation:  0.21825170516967773
local_output_nid generation:  0.013307571411132812
local_in_edges_tensor generation:  0.010286569595336914
mini_batch_src_global generation:  0.029536962509155273
r_  generation:  0.19264864921569824
local_output_nid generation:  0.00978541374206543
local_in_edges_tensor generation:  0.009124755859375
mini_batch_src_global generation:  0.023735523223876953
r_  generation:  0.18630027770996094
local_output_nid generation:  0.009332895278930664
local_in_edges_tensor generation:  0.008782386779785156
mini_batch_src_global generation:  0.022725820541381836
r_  generation:  0.1779770851135254
local_output_nid generation:  0.009379148483276367
local_in_edges_tensor generation:  0.008950233459472656
mini_batch_src_global generation:  0.02252650260925293
r_  generation:  0.23007607460021973
local_output_nid generation:  0.009228706359863281
local_in_edges_tensor generation:  0.00876307487487793
mini_batch_src_global generation:  0.023873329162597656
r_  generation:  0.18207359313964844
----------------------check_connections_block total spend ----------------------------- 8.994992733001709
generate_one_block  0.26700758934020996
generate_one_block  0.24197697639465332
generate_one_block  0.24304413795471191
generate_one_block  0.24842596054077148
generate_one_block  0.2581179141998291
generate_one_block  0.2501060962677002
generate_one_block  0.2532174587249756
generate_one_block  0.24488520622253418
generate_one_block  0.2529268264770508
generate_one_block  0.24738645553588867
generate_one_block  0.26097607612609863
generate_one_block  0.25153064727783203
generate_one_block  0.24213957786560059
generate_one_block  0.24848294258117676
generate_one_block  0.2530858516693115
generate_one_block  0.25806427001953125
generate_one_block  0.26848912239074707
generate_one_block  0.2359941005706787
generate_one_block  0.2494044303894043
generate_one_block  0.26659727096557617
generate_one_block  0.26436448097229004
generate_one_block  0.2427678108215332
generate_one_block  0.24111294746398926
generate_one_block  0.24900007247924805
generate_one_block  0.2440485954284668
generate_one_block  0.2581005096435547
generate_one_block  0.253143310546875
generate_one_block  0.2652301788330078
generate_one_block  0.2571079730987549
generate_one_block  0.24332070350646973
generate_one_block  0.2737925052642822
generate_one_block  0.2758018970489502
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04258298873901367
gen group dst list time:  0.12876486778259277
time for parepare:  0.02579784393310547
local_output_nid generation:  0.037841081619262695
local_in_edges_tensor generation:  0.0632026195526123
mini_batch_src_global generation:  0.054473876953125
r_  generation:  0.56437087059021
local_output_nid generation:  0.05059337615966797
local_in_edges_tensor generation:  0.04365730285644531
mini_batch_src_global generation:  0.08451700210571289
r_  generation:  0.5133390426635742
local_output_nid generation:  0.036435604095458984
local_in_edges_tensor generation:  0.03920745849609375
mini_batch_src_global generation:  0.06608200073242188
r_  generation:  0.5547676086425781
local_output_nid generation:  0.036365509033203125
local_in_edges_tensor generation:  0.0411374568939209
mini_batch_src_global generation:  0.06794619560241699
r_  generation:  0.5270547866821289
local_output_nid generation:  0.0381319522857666
local_in_edges_tensor generation:  0.03846549987792969
mini_batch_src_global generation:  0.07943105697631836
r_  generation:  0.5359888076782227
local_output_nid generation:  0.037442684173583984
local_in_edges_tensor generation:  0.029469013214111328
mini_batch_src_global generation:  0.0664985179901123
r_  generation:  0.524254560470581
local_output_nid generation:  0.038170814514160156
local_in_edges_tensor generation:  0.04654216766357422
mini_batch_src_global generation:  0.06395626068115234
r_  generation:  0.5324218273162842
local_output_nid generation:  0.03734636306762695
local_in_edges_tensor generation:  0.03696870803833008
mini_batch_src_global generation:  0.06481480598449707
r_  generation:  0.509692907333374
local_output_nid generation:  0.03762650489807129
local_in_edges_tensor generation:  0.03676104545593262
mini_batch_src_global generation:  0.06593537330627441
r_  generation:  0.555006742477417
local_output_nid generation:  0.040662288665771484
local_in_edges_tensor generation:  0.03424239158630371
mini_batch_src_global generation:  0.06706523895263672
r_  generation:  0.5103754997253418
local_output_nid generation:  0.03814196586608887
local_in_edges_tensor generation:  0.04099154472351074
mini_batch_src_global generation:  0.06604743003845215
r_  generation:  0.5317814350128174
local_output_nid generation:  0.037667274475097656
local_in_edges_tensor generation:  0.0363771915435791
mini_batch_src_global generation:  0.08496761322021484
r_  generation:  0.510200023651123
local_output_nid generation:  0.03719806671142578
local_in_edges_tensor generation:  0.029731035232543945
mini_batch_src_global generation:  0.06294608116149902
r_  generation:  0.5245053768157959
local_output_nid generation:  0.03754997253417969
local_in_edges_tensor generation:  0.029811859130859375
mini_batch_src_global generation:  0.0628209114074707
r_  generation:  0.5149111747741699
local_output_nid generation:  0.03724169731140137
local_in_edges_tensor generation:  0.03142070770263672
mini_batch_src_global generation:  0.06478142738342285
r_  generation:  0.5348348617553711
local_output_nid generation:  0.037396907806396484
local_in_edges_tensor generation:  0.029874563217163086
mini_batch_src_global generation:  0.06302237510681152
r_  generation:  0.5151431560516357
local_output_nid generation:  0.03838038444519043
local_in_edges_tensor generation:  0.03929638862609863
mini_batch_src_global generation:  0.0636141300201416
r_  generation:  0.5342857837677002
local_output_nid generation:  0.03963327407836914
local_in_edges_tensor generation:  0.03827714920043945
mini_batch_src_global generation:  0.06171274185180664
r_  generation:  0.5205674171447754
local_output_nid generation:  0.03757500648498535
local_in_edges_tensor generation:  0.03965258598327637
mini_batch_src_global generation:  0.06528401374816895
r_  generation:  0.5402641296386719
local_output_nid generation:  0.037747859954833984
local_in_edges_tensor generation:  0.045683860778808594
mini_batch_src_global generation:  0.08112168312072754
r_  generation:  0.5189509391784668
local_output_nid generation:  0.03712034225463867
local_in_edges_tensor generation:  0.028959989547729492
mini_batch_src_global generation:  0.06876873970031738
r_  generation:  0.5057041645050049
local_output_nid generation:  0.0331571102142334
local_in_edges_tensor generation:  0.03135371208190918
mini_batch_src_global generation:  0.05939483642578125
r_  generation:  0.4984471797943115
local_output_nid generation:  0.033325910568237305
local_in_edges_tensor generation:  0.029079914093017578
mini_batch_src_global generation:  0.058048248291015625
r_  generation:  0.520880937576294
local_output_nid generation:  0.03326916694641113
local_in_edges_tensor generation:  0.028778076171875
mini_batch_src_global generation:  0.05949044227600098
r_  generation:  0.5031874179840088
local_output_nid generation:  0.03332781791687012
local_in_edges_tensor generation:  0.030528783798217773
mini_batch_src_global generation:  0.05862689018249512
r_  generation:  0.5054006576538086
local_output_nid generation:  0.03339385986328125
local_in_edges_tensor generation:  0.030843734741210938
mini_batch_src_global generation:  0.06124687194824219
r_  generation:  0.5067100524902344
local_output_nid generation:  0.03325295448303223
local_in_edges_tensor generation:  0.02888202667236328
mini_batch_src_global generation:  0.05879664421081543
r_  generation:  0.5072901248931885
local_output_nid generation:  0.03366541862487793
local_in_edges_tensor generation:  0.03141522407531738
mini_batch_src_global generation:  0.06213521957397461
r_  generation:  0.5102710723876953
local_output_nid generation:  0.033531904220581055
local_in_edges_tensor generation:  0.032628536224365234
mini_batch_src_global generation:  0.0591282844543457
r_  generation:  0.5154685974121094
local_output_nid generation:  0.034358978271484375
local_in_edges_tensor generation:  0.029024600982666016
mini_batch_src_global generation:  0.06005144119262695
r_  generation:  0.5049586296081543
local_output_nid generation:  0.0330655574798584
local_in_edges_tensor generation:  0.03235173225402832
mini_batch_src_global generation:  0.058022499084472656
r_  generation:  0.5063860416412354
local_output_nid generation:  0.03301191329956055
local_in_edges_tensor generation:  0.03323054313659668
mini_batch_src_global generation:  0.06131434440612793
r_  generation:  0.499622106552124
----------------------check_connections_block total spend ----------------------------- 24.781846046447754
generate_one_block  0.7047581672668457
generate_one_block  0.6843609809875488
generate_one_block  0.6798043251037598
generate_one_block  0.6889147758483887
generate_one_block  0.795069694519043
generate_one_block  0.6800658702850342
generate_one_block  0.6777706146240234
generate_one_block  0.6747372150421143
generate_one_block  0.680657148361206
generate_one_block  0.699725866317749
generate_one_block  0.699805736541748
generate_one_block  0.686884880065918
generate_one_block  0.6813247203826904
generate_one_block  0.6802465915679932
generate_one_block  0.6831881999969482
generate_one_block  0.6790499687194824
generate_one_block  0.6740939617156982
generate_one_block  0.677992582321167
generate_one_block  0.6856386661529541
generate_one_block  0.6895079612731934
generate_one_block  0.6853647232055664
generate_one_block  0.6755011081695557
generate_one_block  0.6799736022949219
generate_one_block  0.6816225051879883
generate_one_block  0.6960599422454834
generate_one_block  0.6880090236663818
generate_one_block  0.6809828281402588
generate_one_block  0.6999020576477051
generate_one_block  0.6881396770477295
generate_one_block  0.6794595718383789
generate_one_block  0.6803474426269531
generate_one_block  0.6795961856842041
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.13231229782104492  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

connection checking time:  33.77683877944946
block generation total time  30.128206491470337
average batch blocks generation time:  0.941506452858448
block dataloader generation time/epoch 65.70816656947136
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10950136184692383  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 21.220983028411865  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10896778106689453  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.603281497955322  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10940313339233398  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.59991979598999  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.1091909408569336  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.83892583847046  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.1089177131652832  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.38219404220581  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10912418365478516  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.731287002563477  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10922622680664062  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.644909381866455  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10912179946899414  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 20.584044933319092  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.10918378829956055  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3612060546875 GB
    Memory Allocated: 21.016478061676025  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 0.10927963256835938  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 20.732036590576172  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 0.10982179641723633  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 21.352524280548096  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 0.10939311981201172  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 21.01444435119629  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 0.10915470123291016  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 20.560351848602295  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 0.10920572280883789  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 20.832231998443604  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 0.10933494567871094  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 20.91933536529541  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 0.10902070999145508  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 20.927934169769287  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 0.1092691421508789  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 20.79032611846924  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 0.10898733139038086  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 20.132546424865723  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 0.10929250717163086  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 20.632909297943115  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 0.10977363586425781  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 21.1846661567688  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 0.10947656631469727  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 21.21472978591919  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 0.10905933380126953  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 20.401649475097656  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 0.1090097427368164  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 20.495871543884277  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 0.10927391052246094  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 20.709909439086914  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 0.10913658142089844  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 20.526726722717285  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 0.1089472770690918  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 20.81288766860962  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 0.10905838012695312  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 20.72140073776245  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 0.10972118377685547  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 21.36291265487671  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 0.10941028594970703  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 20.963380336761475  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 0.10900163650512695  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 20.41178321838379  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 0.1089167594909668  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 20.51931858062744  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 0.10893535614013672  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 20.57105827331543  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.033852770924568176 |0.024082839488983154 |0.6334818452596664 |9.711086750030518e-05 |1.2030784264206886 |0.008668661117553711 |
----------------------------------------------------------pseudo_mini_loss sum 1.4323004484176636
Total (block generation + training)time/epoch 126.52034741640091
Training time/epoch 60.70557737350464
Training time without block to device /epoch 59.93492650985718
Training time without total dataloading part /epoch 58.781704902648926
load block tensor time/epoch 1.0832886695861816
block to device time/epoch 0.7706508636474609
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 17 |
Number of nodes for computation during this epoch:  9161364
Number of first layer input nodes during this epoch:  4808849
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 0.1309494972229004  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02732229232788086
random selection method range initialization spend 0.0059299468994140625
time for parepare:  0.021625280380249023
local_output_nid generation:  0.0014045238494873047
local_in_edges_tensor generation:  0.0041046142578125
mini_batch_src_global generation:  0.0017936229705810547
r_  generation:  0.010615825653076172
local_output_nid generation:  0.0016541481018066406
local_in_edges_tensor generation:  0.0011487007141113281
mini_batch_src_global generation:  0.00174713134765625
r_  generation:  0.010716676712036133
local_output_nid generation:  0.0016608238220214844
local_in_edges_tensor generation:  0.00092315673828125
mini_batch_src_global generation:  0.0011568069458007812
r_  generation:  0.009918689727783203
local_output_nid generation:  0.0016140937805175781
local_in_edges_tensor generation:  0.0009195804595947266
mini_batch_src_global generation:  0.0011305809020996094
r_  generation:  0.010051965713500977
local_output_nid generation:  0.0015974044799804688
local_in_edges_tensor generation:  0.0008611679077148438
mini_batch_src_global generation:  0.0010983943939208984
r_  generation:  0.009964227676391602
local_output_nid generation:  0.0015916824340820312
local_in_edges_tensor generation:  0.0009398460388183594
mini_batch_src_global generation:  0.0011379718780517578
r_  generation:  0.010148286819458008
local_output_nid generation:  0.0015804767608642578
local_in_edges_tensor generation:  0.000843048095703125
mini_batch_src_global generation:  0.0011255741119384766
r_  generation:  0.010286808013916016
local_output_nid generation:  0.0015933513641357422
local_in_edges_tensor generation:  0.0008690357208251953
mini_batch_src_global generation:  0.0011098384857177734
r_  generation:  0.009987354278564453
local_output_nid generation:  0.0015625953674316406
local_in_edges_tensor generation:  0.0008575916290283203
mini_batch_src_global generation:  0.001024484634399414
r_  generation:  0.012143373489379883
local_output_nid generation:  0.0016617774963378906
local_in_edges_tensor generation:  0.0008859634399414062
mini_batch_src_global generation:  0.0012235641479492188
r_  generation:  0.010492801666259766
local_output_nid generation:  0.0015854835510253906
local_in_edges_tensor generation:  0.0008697509765625
mini_batch_src_global generation:  0.0011792182922363281
r_  generation:  0.010601282119750977
local_output_nid generation:  0.0015828609466552734
local_in_edges_tensor generation:  0.0008518695831298828
mini_batch_src_global generation:  0.001142263412475586
r_  generation:  0.01044607162475586
local_output_nid generation:  0.001590728759765625
local_in_edges_tensor generation:  0.0008618831634521484
mini_batch_src_global generation:  0.0011334419250488281
r_  generation:  0.010209083557128906
local_output_nid generation:  0.0015726089477539062
local_in_edges_tensor generation:  0.0008299350738525391
mini_batch_src_global generation:  0.001104116439819336
r_  generation:  0.01029205322265625
local_output_nid generation:  0.0015659332275390625
local_in_edges_tensor generation:  0.0008256435394287109
mini_batch_src_global generation:  0.0011620521545410156
r_  generation:  0.010607481002807617
local_output_nid generation:  0.001589059829711914
local_in_edges_tensor generation:  0.0008342266082763672
mini_batch_src_global generation:  0.0011029243469238281
r_  generation:  0.010230541229248047
local_output_nid generation:  0.001577615737915039
local_in_edges_tensor generation:  0.0008776187896728516
mini_batch_src_global generation:  0.0011191368103027344
r_  generation:  0.010136604309082031
local_output_nid generation:  0.001575469970703125
local_in_edges_tensor generation:  0.0008478164672851562
mini_batch_src_global generation:  0.0011038780212402344
r_  generation:  0.009894371032714844
local_output_nid generation:  0.0015976428985595703
local_in_edges_tensor generation:  0.0008301734924316406
mini_batch_src_global generation:  0.0011129379272460938
r_  generation:  0.010553359985351562
local_output_nid generation:  0.0015895366668701172
local_in_edges_tensor generation:  0.0010287761688232422
mini_batch_src_global generation:  0.001216888427734375
r_  generation:  0.010497093200683594
local_output_nid generation:  0.0015757083892822266
local_in_edges_tensor generation:  0.0008530616760253906
mini_batch_src_global generation:  0.0011925697326660156
r_  generation:  0.010429143905639648
local_output_nid generation:  0.0016145706176757812
local_in_edges_tensor generation:  0.0009598731994628906
mini_batch_src_global generation:  0.0011796951293945312
r_  generation:  0.01005101203918457
local_output_nid generation:  0.0015783309936523438
local_in_edges_tensor generation:  0.0008549690246582031
mini_batch_src_global generation:  0.0011250972747802734
r_  generation:  0.010040521621704102
local_output_nid generation:  0.001577138900756836
local_in_edges_tensor generation:  0.00093841552734375
mini_batch_src_global generation:  0.001283884048461914
r_  generation:  0.010517597198486328
local_output_nid generation:  0.0015692710876464844
local_in_edges_tensor generation:  0.0009224414825439453
mini_batch_src_global generation:  0.0011169910430908203
r_  generation:  0.010266304016113281
local_output_nid generation:  0.001550912857055664
local_in_edges_tensor generation:  0.0008890628814697266
mini_batch_src_global generation:  0.0011258125305175781
r_  generation:  0.01018381118774414
local_output_nid generation:  0.0015463829040527344
local_in_edges_tensor generation:  0.0009095668792724609
mini_batch_src_global generation:  0.0012166500091552734
r_  generation:  0.010438919067382812
local_output_nid generation:  0.0015423297882080078
local_in_edges_tensor generation:  0.0008971691131591797
mini_batch_src_global generation:  0.0011820793151855469
r_  generation:  0.010441780090332031
local_output_nid generation:  0.0015447139739990234
local_in_edges_tensor generation:  0.0008211135864257812
mini_batch_src_global generation:  0.0011866092681884766
r_  generation:  0.010483264923095703
local_output_nid generation:  0.0015299320220947266
local_in_edges_tensor generation:  0.0008382797241210938
mini_batch_src_global generation:  0.0010895729064941406
r_  generation:  0.009740352630615234
local_output_nid generation:  0.0015537738800048828
local_in_edges_tensor generation:  0.0008594989776611328
mini_batch_src_global generation:  0.0011131763458251953
r_  generation:  0.010464191436767578
local_output_nid generation:  0.0015614032745361328
local_in_edges_tensor generation:  0.0009000301361083984
mini_batch_src_global generation:  0.0012133121490478516
r_  generation:  0.010943412780761719
----------------------check_connections_block total spend ----------------------------- 0.5677728652954102
generate_one_block  0.024527788162231445
generate_one_block  0.021363019943237305
generate_one_block  0.0191342830657959
generate_one_block  0.018960237503051758
generate_one_block  0.01860523223876953
generate_one_block  0.018674373626708984
generate_one_block  0.018491506576538086
generate_one_block  0.01842474937438965
generate_one_block  0.020193815231323242
generate_one_block  0.020134687423706055
generate_one_block  0.019291400909423828
generate_one_block  0.018894672393798828
generate_one_block  0.01824045181274414
generate_one_block  0.018471479415893555
generate_one_block  0.018930912017822266
generate_one_block  0.0185396671295166
generate_one_block  0.01836252212524414
generate_one_block  0.017918825149536133
generate_one_block  0.019037246704101562
generate_one_block  0.018579483032226562
generate_one_block  0.018182039260864258
generate_one_block  0.01813030242919922
generate_one_block  0.021431684494018555
generate_one_block  0.01957225799560547
generate_one_block  0.018816232681274414
generate_one_block  0.018529891967773438
generate_one_block  0.01894354820251465
generate_one_block  0.01929020881652832
generate_one_block  0.018799543380737305
generate_one_block  0.017760753631591797
generate_one_block  0.01887059211730957
generate_one_block  0.020024538040161133
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.038984060287475586
gen group dst list time:  0.023778676986694336
time for parepare:  0.021822214126586914
local_output_nid generation:  0.006642818450927734
local_in_edges_tensor generation:  0.017380475997924805
mini_batch_src_global generation:  0.018275976181030273
r_  generation:  0.16591453552246094
local_output_nid generation:  0.009159088134765625
local_in_edges_tensor generation:  0.012042760848999023
mini_batch_src_global generation:  0.02332329750061035
r_  generation:  0.1717679500579834
local_output_nid generation:  0.009432077407836914
local_in_edges_tensor generation:  0.03563284873962402
mini_batch_src_global generation:  0.020758390426635742
r_  generation:  0.17210149765014648
local_output_nid generation:  0.009672164916992188
local_in_edges_tensor generation:  0.009102106094360352
mini_batch_src_global generation:  0.021719932556152344
r_  generation:  0.2093338966369629
local_output_nid generation:  0.012603521347045898
local_in_edges_tensor generation:  0.010726451873779297
mini_batch_src_global generation:  0.02886819839477539
r_  generation:  0.18115997314453125
local_output_nid generation:  0.009601354598999023
local_in_edges_tensor generation:  0.012310266494750977
mini_batch_src_global generation:  0.023745298385620117
r_  generation:  0.18304944038391113
local_output_nid generation:  0.009191751480102539
local_in_edges_tensor generation:  0.009145259857177734
mini_batch_src_global generation:  0.02290034294128418
r_  generation:  0.17956137657165527
local_output_nid generation:  0.009173393249511719
local_in_edges_tensor generation:  0.010657072067260742
mini_batch_src_global generation:  0.022211074829101562
r_  generation:  0.18683791160583496
local_output_nid generation:  0.00965571403503418
local_in_edges_tensor generation:  0.013191461563110352
mini_batch_src_global generation:  0.02462625503540039
r_  generation:  0.20037579536437988
local_output_nid generation:  0.009723424911499023
local_in_edges_tensor generation:  0.010198831558227539
mini_batch_src_global generation:  0.023307085037231445
r_  generation:  0.1891310214996338
local_output_nid generation:  0.009878873825073242
local_in_edges_tensor generation:  0.014795780181884766
mini_batch_src_global generation:  0.026839017868041992
r_  generation:  0.1916041374206543
local_output_nid generation:  0.010581016540527344
local_in_edges_tensor generation:  0.01170969009399414
mini_batch_src_global generation:  0.023517608642578125
r_  generation:  0.1869523525238037
local_output_nid generation:  0.00954890251159668
local_in_edges_tensor generation:  0.014188766479492188
mini_batch_src_global generation:  0.023633956909179688
r_  generation:  0.18884992599487305
local_output_nid generation:  0.012121915817260742
local_in_edges_tensor generation:  0.010071754455566406
mini_batch_src_global generation:  0.023042917251586914
r_  generation:  0.18146204948425293
local_output_nid generation:  0.01022481918334961
local_in_edges_tensor generation:  0.009885549545288086
mini_batch_src_global generation:  0.023722410202026367
r_  generation:  0.18732833862304688
local_output_nid generation:  0.009881973266601562
local_in_edges_tensor generation:  0.009305953979492188
mini_batch_src_global generation:  0.02344036102294922
r_  generation:  0.1824204921722412
local_output_nid generation:  0.009873390197753906
local_in_edges_tensor generation:  0.012078046798706055
mini_batch_src_global generation:  0.022959232330322266
r_  generation:  0.18108391761779785
local_output_nid generation:  0.009566545486450195
local_in_edges_tensor generation:  0.011793851852416992
mini_batch_src_global generation:  0.023134708404541016
r_  generation:  0.17376971244812012
local_output_nid generation:  0.010223150253295898
local_in_edges_tensor generation:  0.009654045104980469
mini_batch_src_global generation:  0.023586750030517578
r_  generation:  0.1876530647277832
local_output_nid generation:  0.00989532470703125
local_in_edges_tensor generation:  0.009045124053955078
mini_batch_src_global generation:  0.023260831832885742
r_  generation:  0.18210244178771973
local_output_nid generation:  0.009864330291748047
local_in_edges_tensor generation:  0.012978792190551758
mini_batch_src_global generation:  0.02285146713256836
r_  generation:  0.18241310119628906
local_output_nid generation:  0.009772300720214844
local_in_edges_tensor generation:  0.008921146392822266
mini_batch_src_global generation:  0.022600412368774414
r_  generation:  0.1830911636352539
local_output_nid generation:  0.009770870208740234
local_in_edges_tensor generation:  0.00890350341796875
mini_batch_src_global generation:  0.023270130157470703
r_  generation:  0.18138766288757324
local_output_nid generation:  0.009994983673095703
local_in_edges_tensor generation:  0.010210752487182617
mini_batch_src_global generation:  0.023812055587768555
r_  generation:  0.18805766105651855
local_output_nid generation:  0.009845733642578125
local_in_edges_tensor generation:  0.008931398391723633
mini_batch_src_global generation:  0.023048877716064453
r_  generation:  0.18429803848266602
local_output_nid generation:  0.009865045547485352
local_in_edges_tensor generation:  0.00959014892578125
mini_batch_src_global generation:  0.02316880226135254
r_  generation:  0.18346714973449707
local_output_nid generation:  0.010057210922241211
local_in_edges_tensor generation:  0.009931325912475586
mini_batch_src_global generation:  0.024209022521972656
r_  generation:  0.1873927116394043
local_output_nid generation:  0.010075807571411133
local_in_edges_tensor generation:  0.009433746337890625
mini_batch_src_global generation:  0.023712635040283203
r_  generation:  0.18656015396118164
local_output_nid generation:  0.009954690933227539
local_in_edges_tensor generation:  0.009286165237426758
mini_batch_src_global generation:  0.023255586624145508
r_  generation:  0.19109272956848145
local_output_nid generation:  0.009612083435058594
local_in_edges_tensor generation:  0.00992131233215332
mini_batch_src_global generation:  0.023096561431884766
r_  generation:  0.1774458885192871
local_output_nid generation:  0.010036945343017578
local_in_edges_tensor generation:  0.011429071426391602
mini_batch_src_global generation:  0.02440643310546875
r_  generation:  0.190277099609375
local_output_nid generation:  0.010399818420410156
local_in_edges_tensor generation:  0.012891769409179688
mini_batch_src_global generation:  0.02551102638244629
r_  generation:  0.1969609260559082
----------------------check_connections_block total spend ----------------------------- 8.716380834579468
generate_one_block  0.26595306396484375
generate_one_block  0.24889826774597168
generate_one_block  0.24321746826171875
generate_one_block  0.24851465225219727
generate_one_block  0.26764655113220215
generate_one_block  0.25493311882019043
generate_one_block  0.24857139587402344
generate_one_block  0.24938583374023438
generate_one_block  0.27211976051330566
generate_one_block  0.25110960006713867
generate_one_block  0.2599971294403076
generate_one_block  0.2610769271850586
generate_one_block  0.24721217155456543
generate_one_block  0.2470250129699707
generate_one_block  0.25816965103149414
generate_one_block  0.24901080131530762
generate_one_block  0.25013232231140137
generate_one_block  0.24032902717590332
generate_one_block  0.25649452209472656
generate_one_block  0.25636792182922363
generate_one_block  0.2482280731201172
generate_one_block  0.24445009231567383
generate_one_block  0.24281072616577148
generate_one_block  0.2539103031158447
generate_one_block  0.24320268630981445
generate_one_block  0.24518513679504395
generate_one_block  0.25284671783447266
generate_one_block  0.2499833106994629
generate_one_block  0.25773191452026367
generate_one_block  0.23862242698669434
generate_one_block  0.2672576904296875
generate_one_block  0.26269960403442383
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.041741371154785156
gen group dst list time:  0.11487603187561035
time for parepare:  0.021259307861328125
local_output_nid generation:  0.026656150817871094
local_in_edges_tensor generation:  0.05456185340881348
mini_batch_src_global generation:  0.047232627868652344
r_  generation:  0.48824477195739746
local_output_nid generation:  0.03236103057861328
local_in_edges_tensor generation:  0.038153648376464844
mini_batch_src_global generation:  0.05888485908508301
r_  generation:  0.4897589683532715
local_output_nid generation:  0.031699180603027344
local_in_edges_tensor generation:  0.03243660926818848
mini_batch_src_global generation:  0.0578763484954834
r_  generation:  0.49851512908935547
local_output_nid generation:  0.03207683563232422
local_in_edges_tensor generation:  0.03779959678649902
mini_batch_src_global generation:  0.05985903739929199
r_  generation:  0.49312329292297363
local_output_nid generation:  0.031462669372558594
local_in_edges_tensor generation:  0.032552480697631836
mini_batch_src_global generation:  0.059890031814575195
r_  generation:  0.5000708103179932
local_output_nid generation:  0.031538963317871094
local_in_edges_tensor generation:  0.03340768814086914
mini_batch_src_global generation:  0.06138110160827637
r_  generation:  0.503812313079834
local_output_nid generation:  0.03153657913208008
local_in_edges_tensor generation:  0.030320405960083008
mini_batch_src_global generation:  0.05915546417236328
r_  generation:  0.5024759769439697
local_output_nid generation:  0.031269073486328125
local_in_edges_tensor generation:  0.03493046760559082
mini_batch_src_global generation:  0.059114933013916016
r_  generation:  0.49733710289001465
local_output_nid generation:  0.030118465423583984
local_in_edges_tensor generation:  0.03861570358276367
mini_batch_src_global generation:  0.06259036064147949
r_  generation:  0.5108809471130371
local_output_nid generation:  0.029532909393310547
local_in_edges_tensor generation:  0.038565874099731445
mini_batch_src_global generation:  0.06189703941345215
r_  generation:  0.5123493671417236
local_output_nid generation:  0.03006720542907715
local_in_edges_tensor generation:  0.03209328651428223
mini_batch_src_global generation:  0.05827665328979492
r_  generation:  0.5065040588378906
local_output_nid generation:  0.03072357177734375
local_in_edges_tensor generation:  0.038210391998291016
mini_batch_src_global generation:  0.05960965156555176
r_  generation:  0.5097520351409912
local_output_nid generation:  0.02951335906982422
local_in_edges_tensor generation:  0.03013157844543457
mini_batch_src_global generation:  0.06256937980651855
r_  generation:  0.5132019519805908
local_output_nid generation:  0.03148818016052246
local_in_edges_tensor generation:  0.035559892654418945
mini_batch_src_global generation:  0.06270813941955566
r_  generation:  0.49925661087036133
local_output_nid generation:  0.03091716766357422
local_in_edges_tensor generation:  0.030452728271484375
mini_batch_src_global generation:  0.0608973503112793
r_  generation:  0.501950740814209
local_output_nid generation:  0.030157089233398438
local_in_edges_tensor generation:  0.030196666717529297
mini_batch_src_global generation:  0.06004190444946289
r_  generation:  0.49648237228393555
local_output_nid generation:  0.030492067337036133
local_in_edges_tensor generation:  0.0292203426361084
mini_batch_src_global generation:  0.058387041091918945
r_  generation:  0.5023746490478516
local_output_nid generation:  0.030038118362426758
local_in_edges_tensor generation:  0.029763460159301758
mini_batch_src_global generation:  0.059285640716552734
r_  generation:  0.4943580627441406
local_output_nid generation:  0.032303571701049805
local_in_edges_tensor generation:  0.02945113182067871
mini_batch_src_global generation:  0.06106376647949219
r_  generation:  0.5080177783966064
local_output_nid generation:  0.030617237091064453
local_in_edges_tensor generation:  0.029816865921020508
mini_batch_src_global generation:  0.07148313522338867
r_  generation:  0.5039899349212646
local_output_nid generation:  0.030684232711791992
local_in_edges_tensor generation:  0.031368255615234375
mini_batch_src_global generation:  0.060703277587890625
r_  generation:  0.5060722827911377
local_output_nid generation:  0.030528783798217773
local_in_edges_tensor generation:  0.029958248138427734
mini_batch_src_global generation:  0.05994248390197754
r_  generation:  0.5046770572662354
local_output_nid generation:  0.030414104461669922
local_in_edges_tensor generation:  0.03171968460083008
mini_batch_src_global generation:  0.05851292610168457
r_  generation:  0.5005557537078857
local_output_nid generation:  0.030411720275878906
local_in_edges_tensor generation:  0.03323030471801758
mini_batch_src_global generation:  0.059972286224365234
r_  generation:  0.5018765926361084
local_output_nid generation:  0.03106236457824707
local_in_edges_tensor generation:  0.03231310844421387
mini_batch_src_global generation:  0.06190800666809082
r_  generation:  0.5049095153808594
local_output_nid generation:  0.03031635284423828
local_in_edges_tensor generation:  0.029653072357177734
mini_batch_src_global generation:  0.059708356857299805
r_  generation:  0.4983696937561035
local_output_nid generation:  0.030219554901123047
local_in_edges_tensor generation:  0.03433060646057129
mini_batch_src_global generation:  0.06119942665100098
r_  generation:  0.5015873908996582
local_output_nid generation:  0.030347108840942383
local_in_edges_tensor generation:  0.031409263610839844
mini_batch_src_global generation:  0.05965733528137207
r_  generation:  0.4973328113555908
local_output_nid generation:  0.030334949493408203
local_in_edges_tensor generation:  0.03467082977294922
mini_batch_src_global generation:  0.061240196228027344
r_  generation:  0.5000314712524414
local_output_nid generation:  0.031565189361572266
local_in_edges_tensor generation:  0.02875232696533203
mini_batch_src_global generation:  0.06000924110412598
r_  generation:  0.4945847988128662
local_output_nid generation:  0.030477285385131836
local_in_edges_tensor generation:  0.032540321350097656
mini_batch_src_global generation:  0.06315994262695312
r_  generation:  0.5047662258148193
local_output_nid generation:  0.03059530258178711
local_in_edges_tensor generation:  0.031018733978271484
mini_batch_src_global generation:  0.06032109260559082
r_  generation:  0.5037076473236084
----------------------check_connections_block total spend ----------------------------- 23.554086923599243
generate_one_block  0.7040610313415527
generate_one_block  0.683220386505127
generate_one_block  0.6765189170837402
generate_one_block  0.6783723831176758
generate_one_block  0.7857069969177246
generate_one_block  0.688126802444458
generate_one_block  0.6807472705841064
generate_one_block  0.6816279888153076
generate_one_block  0.6862521171569824
generate_one_block  0.6770458221435547
generate_one_block  0.6815042495727539
generate_one_block  0.6828739643096924
generate_one_block  0.6741876602172852
generate_one_block  0.6738381385803223
generate_one_block  0.6880474090576172
generate_one_block  0.6826531887054443
generate_one_block  0.6858181953430176
generate_one_block  0.6780643463134766
generate_one_block  0.6929805278778076
generate_one_block  0.6762597560882568
generate_one_block  0.6806106567382812
generate_one_block  0.6775608062744141
generate_one_block  0.6805355548858643
generate_one_block  0.6913571357727051
generate_one_block  0.7116742134094238
generate_one_block  0.6781845092773438
generate_one_block  0.6895339488983154
generate_one_block  0.6726078987121582
generate_one_block  0.680243730545044
generate_one_block  0.6794779300689697
generate_one_block  0.6989805698394775
generate_one_block  0.6924188137054443
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 0.1309494972229004  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

connection checking time:  32.27046775817871
block generation total time  30.0741868019104
average batch blocks generation time:  0.9398183375597
block dataloader generation time/epoch 65.73999071121216
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 0.10948324203491211  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 20.833269596099854  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 0.10940837860107422  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 20.793626308441162  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 0.1092071533203125  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 20.642223834991455  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 0.10935735702514648  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 20.85634994506836  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 0.10912466049194336  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 20.848352432250977  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 0.10953187942504883  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 21.01371145248413  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 0.1093897819519043  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 20.736182689666748  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 0.10934782028198242  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 20.717869758605957  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 0.10971784591674805  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 21.428160667419434  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8612060546875 GB
    Memory Allocated: 0.10884857177734375  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1834716796875 GB
    Memory Allocated: 20.762122631072998  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1834716796875 GB
    Memory Allocated: 0.10942268371582031  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1834716796875 GB
    Memory Allocated: 21.018763542175293  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1834716796875 GB
    Memory Allocated: 0.1092386245727539  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2733154296875 GB
    Memory Allocated: 20.958474159240723  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2772216796875 GB
    Memory Allocated: 0.10891342163085938  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2772216796875 GB
    Memory Allocated: 20.43489122390747  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2772216796875 GB
    Memory Allocated: 0.1091146469116211  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2772216796875 GB
    Memory Allocated: 20.72092628479004  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2772216796875 GB
    Memory Allocated: 0.10976219177246094  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 21.08337926864624  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2987060546875 GB
    Memory Allocated: 0.10891866683959961  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2987060546875 GB
    Memory Allocated: 20.7182879447937  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2987060546875 GB
    Memory Allocated: 0.10931634902954102  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2987060546875 GB
    Memory Allocated: 20.66492795944214  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2987060546875 GB
    Memory Allocated: 0.10877609252929688  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2987060546875 GB
    Memory Allocated: 20.146626949310303  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2987060546875 GB
    Memory Allocated: 0.10944223403930664  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2987060546875 GB
    Memory Allocated: 21.044047832489014  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2987060546875 GB
    Memory Allocated: 0.10883235931396484  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2987060546875 GB
    Memory Allocated: 20.65851926803589  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2987060546875 GB
    Memory Allocated: 0.10927152633666992  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2987060546875 GB
    Memory Allocated: 20.58732509613037  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2987060546875 GB
    Memory Allocated: 0.1089620590209961  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2987060546875 GB
    Memory Allocated: 20.54909610748291  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2987060546875 GB
    Memory Allocated: 0.10909032821655273  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2987060546875 GB
    Memory Allocated: 20.44388723373413  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2987060546875 GB
    Memory Allocated: 0.10935783386230469  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2987060546875 GB
    Memory Allocated: 20.95475196838379  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2987060546875 GB
    Memory Allocated: 0.10943126678466797  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2987060546875 GB
    Memory Allocated: 20.64546012878418  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2987060546875 GB
    Memory Allocated: 0.10909891128540039  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2987060546875 GB
    Memory Allocated: 20.62152862548828  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2987060546875 GB
    Memory Allocated: 0.10930967330932617  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2987060546875 GB
    Memory Allocated: 20.9429931640625  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2987060546875 GB
    Memory Allocated: 0.10901880264282227  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2987060546875 GB
    Memory Allocated: 20.736781120300293  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2987060546875 GB
    Memory Allocated: 0.10915946960449219  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2987060546875 GB
    Memory Allocated: 20.91482973098755  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2987060546875 GB
    Memory Allocated: 0.1089029312133789  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2987060546875 GB
    Memory Allocated: 20.180039882659912  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2987060546875 GB
    Memory Allocated: 0.10952186584472656  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2987060546875 GB
    Memory Allocated: 21.161898612976074  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2987060546875 GB
    Memory Allocated: 0.1098031997680664  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2987060546875 GB
    Memory Allocated: 21.418850898742676  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.032710470259189606 |0.02353309839963913 |0.6377875879406929 |9.675323963165283e-05 |1.2054329067468643 |0.008836746215820312 |
----------------------------------------------------------pseudo_mini_loss sum 1.404954433441162
Total (block generation + training)time/epoch 126.55732772085402
Training time/epoch 60.85830855369568
Training time without block to device /epoch 60.10524940490723
Training time without total dataloading part /epoch 58.994988679885864
load block tensor time/epoch 1.0467350482940674
block to device time/epoch 0.7530591487884521
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 18 |
Number of nodes for computation during this epoch:  9164994
Number of first layer input nodes during this epoch:  4809604
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.2987060546875 GB
    Memory Allocated: 0.13360929489135742  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.029459476470947266
random selection method range initialization spend 0.007060527801513672
time for parepare:  0.026221513748168945
local_output_nid generation:  0.0019371509552001953
local_in_edges_tensor generation:  0.005341291427612305
mini_batch_src_global generation:  0.004418134689331055
r_  generation:  0.014069318771362305
local_output_nid generation:  0.0018756389617919922
local_in_edges_tensor generation:  0.0012462139129638672
mini_batch_src_global generation:  0.0023412704467773438
r_  generation:  0.017714977264404297
local_output_nid generation:  0.002857685089111328
local_in_edges_tensor generation:  0.0014042854309082031
mini_batch_src_global generation:  0.0023345947265625
r_  generation:  0.011367082595825195
local_output_nid generation:  0.002105712890625
local_in_edges_tensor generation:  0.0009846687316894531
mini_batch_src_global generation:  0.0014204978942871094
r_  generation:  0.00982356071472168
local_output_nid generation:  0.001972675323486328
local_in_edges_tensor generation:  0.0009732246398925781
mini_batch_src_global generation:  0.0012557506561279297
r_  generation:  0.009800195693969727
local_output_nid generation:  0.001895904541015625
local_in_edges_tensor generation:  0.0009450912475585938
mini_batch_src_global generation:  0.0012574195861816406
r_  generation:  0.011655330657958984
local_output_nid generation:  0.0018763542175292969
local_in_edges_tensor generation:  0.0009016990661621094
mini_batch_src_global generation:  0.0011391639709472656
r_  generation:  0.010027170181274414
local_output_nid generation:  0.0019266605377197266
local_in_edges_tensor generation:  0.0008862018585205078
mini_batch_src_global generation:  0.0011534690856933594
r_  generation:  0.01011800765991211
local_output_nid generation:  0.001825571060180664
local_in_edges_tensor generation:  0.0008535385131835938
mini_batch_src_global generation:  0.0011756420135498047
r_  generation:  0.010232210159301758
local_output_nid generation:  0.0018088817596435547
local_in_edges_tensor generation:  0.0008919239044189453
mini_batch_src_global generation:  0.005103349685668945
r_  generation:  0.013661384582519531
local_output_nid generation:  0.002038240432739258
local_in_edges_tensor generation:  0.0011653900146484375
mini_batch_src_global generation:  0.0012001991271972656
r_  generation:  0.011809110641479492
local_output_nid generation:  0.0018138885498046875
local_in_edges_tensor generation:  0.0008668899536132812
mini_batch_src_global generation:  0.0011334419250488281
r_  generation:  0.009979009628295898
local_output_nid generation:  0.001821279525756836
local_in_edges_tensor generation:  0.0008409023284912109
mini_batch_src_global generation:  0.0011448860168457031
r_  generation:  0.010281801223754883
local_output_nid generation:  0.0017707347869873047
local_in_edges_tensor generation:  0.0008549690246582031
mini_batch_src_global generation:  0.001203775405883789
r_  generation:  0.010210275650024414
local_output_nid generation:  0.0017697811126708984
local_in_edges_tensor generation:  0.0008375644683837891
mini_batch_src_global generation:  0.0011305809020996094
r_  generation:  0.01016378402709961
local_output_nid generation:  0.001772165298461914
local_in_edges_tensor generation:  0.0008432865142822266
mini_batch_src_global generation:  0.0011622905731201172
r_  generation:  0.010328531265258789
local_output_nid generation:  0.0017309188842773438
local_in_edges_tensor generation:  0.0008275508880615234
mini_batch_src_global generation:  0.0011377334594726562
r_  generation:  0.011734962463378906
local_output_nid generation:  0.0017518997192382812
local_in_edges_tensor generation:  0.0008475780487060547
mini_batch_src_global generation:  0.0011172294616699219
r_  generation:  0.009994745254516602
local_output_nid generation:  0.0017812252044677734
local_in_edges_tensor generation:  0.0008807182312011719
mini_batch_src_global generation:  0.0010991096496582031
r_  generation:  0.009848833084106445
local_output_nid generation:  0.0017552375793457031
local_in_edges_tensor generation:  0.0008311271667480469
mini_batch_src_global generation:  0.0011785030364990234
r_  generation:  0.010472774505615234
local_output_nid generation:  0.0017290115356445312
local_in_edges_tensor generation:  0.0008654594421386719
mini_batch_src_global generation:  0.001178741455078125
r_  generation:  0.01066732406616211
local_output_nid generation:  0.0017285346984863281
local_in_edges_tensor generation:  0.0008411407470703125
mini_batch_src_global generation:  0.001129150390625
r_  generation:  0.01028752326965332
local_output_nid generation:  0.001730203628540039
local_in_edges_tensor generation:  0.0008330345153808594
mini_batch_src_global generation:  0.0014412403106689453
r_  generation:  0.010190010070800781
local_output_nid generation:  0.0017247200012207031
local_in_edges_tensor generation:  0.0008301734924316406
mini_batch_src_global generation:  0.0011157989501953125
r_  generation:  0.009628772735595703
local_output_nid generation:  0.0017287731170654297
local_in_edges_tensor generation:  0.000850677490234375
mini_batch_src_global generation:  0.0011169910430908203
r_  generation:  0.010328292846679688
local_output_nid generation:  0.0017216205596923828
local_in_edges_tensor generation:  0.0009801387786865234
mini_batch_src_global generation:  0.0012099742889404297
r_  generation:  0.010334968566894531
local_output_nid generation:  0.0016911029815673828
local_in_edges_tensor generation:  0.0009393692016601562
mini_batch_src_global generation:  0.0012102127075195312
r_  generation:  0.010101795196533203
local_output_nid generation:  0.0016965866088867188
local_in_edges_tensor generation:  0.0008563995361328125
mini_batch_src_global generation:  0.0011763572692871094
r_  generation:  0.010406732559204102
local_output_nid generation:  0.001722574234008789
local_in_edges_tensor generation:  0.000865936279296875
mini_batch_src_global generation:  0.001129150390625
r_  generation:  0.010432243347167969
local_output_nid generation:  0.0016818046569824219
local_in_edges_tensor generation:  0.0008404254913330078
mini_batch_src_global generation:  0.0012023448944091797
r_  generation:  0.012045860290527344
local_output_nid generation:  0.0017008781433105469
local_in_edges_tensor generation:  0.0009343624114990234
mini_batch_src_global generation:  0.001239776611328125
r_  generation:  0.010574102401733398
local_output_nid generation:  0.0016791820526123047
local_in_edges_tensor generation:  0.0008769035339355469
mini_batch_src_global generation:  0.0011479854583740234
r_  generation:  0.010474443435668945
----------------------check_connections_block total spend ----------------------------- 0.6324851512908936
generate_one_block  0.026051759719848633
generate_one_block  0.021730899810791016
generate_one_block  0.021870136260986328
generate_one_block  0.018969058990478516
generate_one_block  0.01855754852294922
generate_one_block  0.01880931854248047
generate_one_block  0.01814436912536621
generate_one_block  0.018636226654052734
generate_one_block  0.02110433578491211
generate_one_block  0.019837379455566406
generate_one_block  0.021906137466430664
generate_one_block  0.0186002254486084
generate_one_block  0.018493175506591797
generate_one_block  0.02063131332397461
generate_one_block  0.018552780151367188
generate_one_block  0.018726587295532227
generate_one_block  0.018596887588500977
generate_one_block  0.018074989318847656
generate_one_block  0.01976299285888672
generate_one_block  0.019238948822021484
generate_one_block  0.019337892532348633
generate_one_block  0.0184476375579834
generate_one_block  0.021815776824951172
generate_one_block  0.01822042465209961
generate_one_block  0.020768165588378906
generate_one_block  0.0191347599029541
generate_one_block  0.018522977828979492
generate_one_block  0.01885247230529785
generate_one_block  0.018635034561157227
generate_one_block  0.02083754539489746
generate_one_block  0.019150257110595703
generate_one_block  0.019135475158691406
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04033637046813965
gen group dst list time:  0.02786707878112793
time for parepare:  0.0228421688079834
local_output_nid generation:  0.006943225860595703
local_in_edges_tensor generation:  0.019835948944091797
mini_batch_src_global generation:  0.021448612213134766
r_  generation:  0.1791849136352539
local_output_nid generation:  0.010197877883911133
local_in_edges_tensor generation:  0.01531219482421875
mini_batch_src_global generation:  0.033980369567871094
r_  generation:  0.18661022186279297
local_output_nid generation:  0.010553598403930664
local_in_edges_tensor generation:  0.11281013488769531
mini_batch_src_global generation:  0.02361273765563965
r_  generation:  0.1876070499420166
local_output_nid generation:  0.01185464859008789
local_in_edges_tensor generation:  0.014788627624511719
mini_batch_src_global generation:  0.02211141586303711
r_  generation:  0.1790449619293213
local_output_nid generation:  0.01064920425415039
local_in_edges_tensor generation:  0.012162208557128906
mini_batch_src_global generation:  0.02233123779296875
r_  generation:  0.17887616157531738
local_output_nid generation:  0.013567447662353516
local_in_edges_tensor generation:  0.011523008346557617
mini_batch_src_global generation:  0.024958133697509766
r_  generation:  0.1983640193939209
local_output_nid generation:  0.0125885009765625
local_in_edges_tensor generation:  0.011714696884155273
mini_batch_src_global generation:  0.03634834289550781
r_  generation:  0.17586135864257812
local_output_nid generation:  0.010522127151489258
local_in_edges_tensor generation:  0.010643482208251953
mini_batch_src_global generation:  0.02692699432373047
r_  generation:  0.18706274032592773
local_output_nid generation:  0.010492801666259766
local_in_edges_tensor generation:  0.010002851486206055
mini_batch_src_global generation:  0.025394678115844727
r_  generation:  0.18539214134216309
local_output_nid generation:  0.011510848999023438
local_in_edges_tensor generation:  0.012585639953613281
mini_batch_src_global generation:  0.03672671318054199
r_  generation:  0.19417166709899902
local_output_nid generation:  0.011198282241821289
local_in_edges_tensor generation:  0.00999903678894043
mini_batch_src_global generation:  0.025330543518066406
r_  generation:  0.18624353408813477
local_output_nid generation:  0.010975360870361328
local_in_edges_tensor generation:  0.012223243713378906
mini_batch_src_global generation:  0.027029037475585938
r_  generation:  0.1819009780883789
local_output_nid generation:  0.010984182357788086
local_in_edges_tensor generation:  0.009370088577270508
mini_batch_src_global generation:  0.0240478515625
r_  generation:  0.18872475624084473
local_output_nid generation:  0.010852575302124023
local_in_edges_tensor generation:  0.009249448776245117
mini_batch_src_global generation:  0.024454116821289062
r_  generation:  0.189591646194458
local_output_nid generation:  0.010902881622314453
local_in_edges_tensor generation:  0.009063005447387695
mini_batch_src_global generation:  0.03611946105957031
r_  generation:  0.1905534267425537
local_output_nid generation:  0.010965347290039062
local_in_edges_tensor generation:  0.00885319709777832
mini_batch_src_global generation:  0.024482250213623047
r_  generation:  0.19208455085754395
local_output_nid generation:  0.010872125625610352
local_in_edges_tensor generation:  0.008927583694458008
mini_batch_src_global generation:  0.024478912353515625
r_  generation:  0.18816161155700684
local_output_nid generation:  0.010740041732788086
local_in_edges_tensor generation:  0.008899688720703125
mini_batch_src_global generation:  0.02619171142578125
r_  generation:  0.18108201026916504
local_output_nid generation:  0.010700464248657227
local_in_edges_tensor generation:  0.013844728469848633
mini_batch_src_global generation:  0.023067951202392578
r_  generation:  0.17857789993286133
local_output_nid generation:  0.011248350143432617
local_in_edges_tensor generation:  0.009548664093017578
mini_batch_src_global generation:  0.025301456451416016
r_  generation:  0.19070792198181152
local_output_nid generation:  0.01125645637512207
local_in_edges_tensor generation:  0.011402130126953125
mini_batch_src_global generation:  0.02461838722229004
r_  generation:  0.19076848030090332
local_output_nid generation:  0.011038064956665039
local_in_edges_tensor generation:  0.00969552993774414
mini_batch_src_global generation:  0.024432659149169922
r_  generation:  0.18706369400024414
local_output_nid generation:  0.010961294174194336
local_in_edges_tensor generation:  0.010329723358154297
mini_batch_src_global generation:  0.02446460723876953
r_  generation:  0.18596267700195312
local_output_nid generation:  0.010552644729614258
local_in_edges_tensor generation:  0.011186838150024414
mini_batch_src_global generation:  0.023092031478881836
r_  generation:  0.17800593376159668
local_output_nid generation:  0.011118650436401367
local_in_edges_tensor generation:  0.009047746658325195
mini_batch_src_global generation:  0.02427530288696289
r_  generation:  0.1907212734222412
local_output_nid generation:  0.011237859725952148
local_in_edges_tensor generation:  0.010259628295898438
mini_batch_src_global generation:  0.025896310806274414
r_  generation:  0.1916029453277588
local_output_nid generation:  0.010978221893310547
local_in_edges_tensor generation:  0.01010584831237793
mini_batch_src_global generation:  0.023921489715576172
r_  generation:  0.18960237503051758
local_output_nid generation:  0.011086702346801758
local_in_edges_tensor generation:  0.009939432144165039
mini_batch_src_global generation:  0.025144100189208984
r_  generation:  0.19302701950073242
local_output_nid generation:  0.011029243469238281
local_in_edges_tensor generation:  0.009033441543579102
mini_batch_src_global generation:  0.024080276489257812
r_  generation:  0.1926708221435547
local_output_nid generation:  0.011560678482055664
local_in_edges_tensor generation:  0.009536504745483398
mini_batch_src_global generation:  0.024044275283813477
r_  generation:  0.19092130661010742
local_output_nid generation:  0.01119542121887207
local_in_edges_tensor generation:  0.01107168197631836
mini_batch_src_global generation:  0.025678157806396484
r_  generation:  0.19605088233947754
local_output_nid generation:  0.011307954788208008
local_in_edges_tensor generation:  0.012451887130737305
mini_batch_src_global generation:  0.026202917098999023
r_  generation:  0.19304943084716797
----------------------check_connections_block total spend ----------------------------- 9.0396728515625
generate_one_block  0.2859206199645996
generate_one_block  0.25131678581237793
generate_one_block  0.2722647190093994
generate_one_block  0.24533462524414062
generate_one_block  0.24454903602600098
generate_one_block  0.2552039623260498
generate_one_block  0.23926305770874023
generate_one_block  0.25304603576660156
generate_one_block  0.2503786087036133
generate_one_block  0.2620537281036377
generate_one_block  0.2492542266845703
generate_one_block  0.24256277084350586
generate_one_block  0.25248050689697266
generate_one_block  0.25633788108825684
generate_one_block  0.2522919178009033
generate_one_block  0.25569677352905273
generate_one_block  0.25786757469177246
generate_one_block  0.23795366287231445
generate_one_block  0.23855042457580566
generate_one_block  0.25809717178344727
generate_one_block  0.2543010711669922
generate_one_block  0.2514941692352295
generate_one_block  0.24804115295410156
generate_one_block  0.23587775230407715
generate_one_block  0.24847865104675293
generate_one_block  0.2527651786804199
generate_one_block  0.24933385848999023
generate_one_block  0.2547292709350586
generate_one_block  0.24966979026794434
generate_one_block  0.2500460147857666
generate_one_block  0.2571737766265869
generate_one_block  0.25253748893737793
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.038483381271362305
gen group dst list time:  0.11526799201965332
time for parepare:  0.019804954528808594
local_output_nid generation:  0.025645017623901367
local_in_edges_tensor generation:  0.050775766372680664
mini_batch_src_global generation:  0.0471341609954834
r_  generation:  0.4937398433685303
local_output_nid generation:  0.03403306007385254
local_in_edges_tensor generation:  0.03869342803955078
mini_batch_src_global generation:  0.059597015380859375
r_  generation:  0.4899418354034424
local_output_nid generation:  0.031970977783203125
local_in_edges_tensor generation:  0.0377655029296875
mini_batch_src_global generation:  0.06127333641052246
r_  generation:  0.4993927478790283
local_output_nid generation:  0.03152894973754883
local_in_edges_tensor generation:  0.040576934814453125
mini_batch_src_global generation:  0.06056571006774902
r_  generation:  0.49199557304382324
local_output_nid generation:  0.03178834915161133
local_in_edges_tensor generation:  0.04083681106567383
mini_batch_src_global generation:  0.05773448944091797
r_  generation:  0.5000443458557129
local_output_nid generation:  0.032743215560913086
local_in_edges_tensor generation:  0.029888629913330078
mini_batch_src_global generation:  0.05992603302001953
r_  generation:  0.500572919845581
local_output_nid generation:  0.031563758850097656
local_in_edges_tensor generation:  0.03036975860595703
mini_batch_src_global generation:  0.06020617485046387
r_  generation:  0.4997439384460449
local_output_nid generation:  0.029641151428222656
local_in_edges_tensor generation:  0.03385043144226074
mini_batch_src_global generation:  0.06122231483459473
r_  generation:  0.5154173374176025
local_output_nid generation:  0.03236269950866699
local_in_edges_tensor generation:  0.03781747817993164
mini_batch_src_global generation:  0.0620267391204834
r_  generation:  0.5004935264587402
local_output_nid generation:  0.03131890296936035
local_in_edges_tensor generation:  0.12673163414001465
mini_batch_src_global generation:  0.062005043029785156
r_  generation:  0.5019176006317139
local_output_nid generation:  0.02941131591796875
local_in_edges_tensor generation:  0.029329538345336914
mini_batch_src_global generation:  0.05823159217834473
r_  generation:  0.5050928592681885
local_output_nid generation:  0.029421567916870117
local_in_edges_tensor generation:  0.029333829879760742
mini_batch_src_global generation:  0.05968356132507324
r_  generation:  0.49596714973449707
local_output_nid generation:  0.02969956398010254
local_in_edges_tensor generation:  0.03016495704650879
mini_batch_src_global generation:  0.058114051818847656
r_  generation:  0.5036911964416504
local_output_nid generation:  0.02940535545349121
local_in_edges_tensor generation:  0.028882980346679688
mini_batch_src_global generation:  0.0594334602355957
r_  generation:  0.4967663288116455
local_output_nid generation:  0.029537200927734375
local_in_edges_tensor generation:  0.028451204299926758
mini_batch_src_global generation:  0.05823493003845215
r_  generation:  0.5007398128509521
local_output_nid generation:  0.029639244079589844
local_in_edges_tensor generation:  0.029550552368164062
mini_batch_src_global generation:  0.06227588653564453
r_  generation:  0.500455379486084
local_output_nid generation:  0.029720067977905273
local_in_edges_tensor generation:  0.032616615295410156
mini_batch_src_global generation:  0.05852913856506348
r_  generation:  0.5065498352050781
local_output_nid generation:  0.02926039695739746
local_in_edges_tensor generation:  0.029690980911254883
mini_batch_src_global generation:  0.05962371826171875
r_  generation:  0.5040562152862549
local_output_nid generation:  0.029259443283081055
local_in_edges_tensor generation:  0.03165841102600098
mini_batch_src_global generation:  0.05832242965698242
r_  generation:  0.503312349319458
local_output_nid generation:  0.03005814552307129
local_in_edges_tensor generation:  0.029363632202148438
mini_batch_src_global generation:  0.06015586853027344
r_  generation:  0.5044765472412109
local_output_nid generation:  0.02973628044128418
local_in_edges_tensor generation:  0.038266897201538086
mini_batch_src_global generation:  0.05890512466430664
r_  generation:  0.5060973167419434
local_output_nid generation:  0.029604196548461914
local_in_edges_tensor generation:  0.029310226440429688
mini_batch_src_global generation:  0.06195712089538574
r_  generation:  0.4978806972503662
local_output_nid generation:  0.029471397399902344
local_in_edges_tensor generation:  0.028815269470214844
mini_batch_src_global generation:  0.05792069435119629
r_  generation:  0.5011951923370361
local_output_nid generation:  0.030739545822143555
local_in_edges_tensor generation:  0.0339360237121582
mini_batch_src_global generation:  0.05902743339538574
r_  generation:  0.48971033096313477
local_output_nid generation:  0.029284954071044922
local_in_edges_tensor generation:  0.028841018676757812
mini_batch_src_global generation:  0.05977654457092285
r_  generation:  0.4979085922241211
local_output_nid generation:  0.02950763702392578
local_in_edges_tensor generation:  0.029421567916870117
mini_batch_src_global generation:  0.061605215072631836
r_  generation:  0.4970710277557373
local_output_nid generation:  0.029925823211669922
local_in_edges_tensor generation:  0.029433012008666992
mini_batch_src_global generation:  0.05826735496520996
r_  generation:  0.5058531761169434
local_output_nid generation:  0.02938675880432129
local_in_edges_tensor generation:  0.03255963325500488
mini_batch_src_global generation:  0.060402870178222656
r_  generation:  0.498490571975708
local_output_nid generation:  0.029966354370117188
local_in_edges_tensor generation:  0.029195547103881836
mini_batch_src_global generation:  0.05810141563415527
r_  generation:  0.5002303123474121
local_output_nid generation:  0.029857397079467773
local_in_edges_tensor generation:  0.0293731689453125
mini_batch_src_global generation:  0.060204267501831055
r_  generation:  0.49965596199035645
local_output_nid generation:  0.03040003776550293
local_in_edges_tensor generation:  0.03136086463928223
mini_batch_src_global generation:  0.05888557434082031
r_  generation:  0.5082809925079346
local_output_nid generation:  0.0301973819732666
local_in_edges_tensor generation:  0.030109405517578125
mini_batch_src_global generation:  0.05968213081359863
r_  generation:  0.4993257522583008
----------------------check_connections_block total spend ----------------------------- 23.527509450912476
generate_one_block  0.7029838562011719
generate_one_block  0.6836638450622559
generate_one_block  0.6824545860290527
generate_one_block  0.6745960712432861
generate_one_block  0.6805286407470703
generate_one_block  0.6806759834289551
generate_one_block  0.7049851417541504
generate_one_block  0.6805500984191895
generate_one_block  0.6811165809631348
generate_one_block  0.6857335567474365
generate_one_block  0.6826980113983154
generate_one_block  0.6853122711181641
generate_one_block  0.6827898025512695
generate_one_block  0.6798810958862305
generate_one_block  0.6753232479095459
generate_one_block  0.6793520450592041
generate_one_block  0.6861438751220703
generate_one_block  0.677731990814209
generate_one_block  0.6718273162841797
generate_one_block  0.6900198459625244
generate_one_block  0.6911768913269043
generate_one_block  0.686873197555542
generate_one_block  0.6846327781677246
generate_one_block  0.676236629486084
generate_one_block  0.6766607761383057
generate_one_block  0.691826581954956
generate_one_block  0.6843407154083252
generate_one_block  0.6721920967102051
generate_one_block  0.6748826503753662
generate_one_block  0.6847965717315674
generate_one_block  0.6898622512817383
generate_one_block  0.6911733150482178
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.2987060546875 GB
    Memory Allocated: 0.13360929489135742  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

connection checking time:  32.567182302474976
block generation total time  29.937894582748413
average batch blocks generation time:  0.9355592057108879
block dataloader generation time/epoch 65.79944620132446
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2987060546875 GB
    Memory Allocated: 0.10962772369384766  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3397216796875 GB
    Memory Allocated: 21.36553144454956  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7830810546875 GB
    Memory Allocated: 0.10922622680664062  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0115966796875 GB
    Memory Allocated: 20.774799823760986  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0135498046875 GB
    Memory Allocated: 0.10926389694213867  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0330810546875 GB
    Memory Allocated: 20.92302942276001  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0350341796875 GB
    Memory Allocated: 0.10898780822753906  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0447998046875 GB
    Memory Allocated: 20.563085079193115  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0467529296875 GB
    Memory Allocated: 0.10904359817504883  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0467529296875 GB
    Memory Allocated: 20.52550506591797  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0467529296875 GB
    Memory Allocated: 0.10950517654418945  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0916748046875 GB
    Memory Allocated: 20.983464241027832  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0955810546875 GB
    Memory Allocated: 0.10881471633911133  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0955810546875 GB
    Memory Allocated: 20.193233013153076  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0955810546875 GB
    Memory Allocated: 0.10898828506469727  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0955810546875 GB
    Memory Allocated: 20.93767213821411  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0955810546875 GB
    Memory Allocated: 0.10907649993896484  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0955810546875 GB
    Memory Allocated: 20.730942249298096  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0955810546875 GB
    Memory Allocated: 0.10962247848510742  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2283935546875 GB
    Memory Allocated: 21.375561714172363  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2283935546875 GB
    Memory Allocated: 0.10895538330078125  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2283935546875 GB
    Memory Allocated: 20.756657123565674  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2283935546875 GB
    Memory Allocated: 0.10917425155639648  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2283935546875 GB
    Memory Allocated: 20.510048866271973  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2283935546875 GB
    Memory Allocated: 0.10924339294433594  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2283935546875 GB
    Memory Allocated: 20.806972980499268  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2283935546875 GB
    Memory Allocated: 0.10901260375976562  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2987060546875 GB
    Memory Allocated: 20.908751964569092  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3026123046875 GB
    Memory Allocated: 0.10922956466674805  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3026123046875 GB
    Memory Allocated: 20.65541124343872  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3026123046875 GB
    Memory Allocated: 0.10925769805908203  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3026123046875 GB
    Memory Allocated: 20.94041395187378  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3026123046875 GB
    Memory Allocated: 0.1092538833618164  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3026123046875 GB
    Memory Allocated: 20.714618682861328  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3026123046875 GB
    Memory Allocated: 0.10905790328979492  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3026123046875 GB
    Memory Allocated: 20.33555555343628  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3026123046875 GB
    Memory Allocated: 0.10907840728759766  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3026123046875 GB
    Memory Allocated: 20.300166130065918  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3026123046875 GB
    Memory Allocated: 0.1095118522644043  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3026123046875 GB
    Memory Allocated: 21.044503688812256  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3026123046875 GB
    Memory Allocated: 0.10957860946655273  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3026123046875 GB
    Memory Allocated: 21.02029800415039  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3026123046875 GB
    Memory Allocated: 0.10917854309082031  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3026123046875 GB
    Memory Allocated: 20.78789710998535  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3026123046875 GB
    Memory Allocated: 0.10917091369628906  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3026123046875 GB
    Memory Allocated: 20.67698049545288  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3026123046875 GB
    Memory Allocated: 0.10866069793701172  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3026123046875 GB
    Memory Allocated: 20.0308198928833  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3026123046875 GB
    Memory Allocated: 0.10900688171386719  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3026123046875 GB
    Memory Allocated: 20.73193359375  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3026123046875 GB
    Memory Allocated: 0.10932683944702148  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3026123046875 GB
    Memory Allocated: 20.903411865234375  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3026123046875 GB
    Memory Allocated: 0.10925960540771484  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3026123046875 GB
    Memory Allocated: 20.672744750976562  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3026123046875 GB
    Memory Allocated: 0.10930824279785156  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3026123046875 GB
    Memory Allocated: 20.970798015594482  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3026123046875 GB
    Memory Allocated: 0.10911321640014648  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3026123046875 GB
    Memory Allocated: 20.730422019958496  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3026123046875 GB
    Memory Allocated: 0.10913801193237305  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3026123046875 GB
    Memory Allocated: 20.64445447921753  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3026123046875 GB
    Memory Allocated: 0.10950517654418945  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3026123046875 GB
    Memory Allocated: 21.065038204193115  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3026123046875 GB
    Memory Allocated: 0.1094822883605957  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3026123046875 GB
    Memory Allocated: 20.932955265045166  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.037080034613609314 |0.023695454001426697 |0.6354662477970123 |9.597092866897583e-05 |1.201075255870819 |0.005398273468017578 |
----------------------------------------------------------pseudo_mini_loss sum 1.3846601247787476
Total (block generation + training)time/epoch 126.61366159915924
Training time/epoch 60.785852909088135
Training time without block to device /epoch 60.02759838104248
Training time without total dataloading part /epoch 58.77779746055603
load block tensor time/epoch 1.186561107635498
block to device time/epoch 0.7582545280456543
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 19 |
Number of nodes for computation during this epoch:  9158375
Number of first layer input nodes during this epoch:  4807741
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.3026123046875 GB
    Memory Allocated: 0.13207626342773438  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02771162986755371
random selection method range initialization spend 0.005701303482055664
time for parepare:  0.022493839263916016
local_output_nid generation:  0.0015420913696289062
local_in_edges_tensor generation:  0.00947427749633789
mini_batch_src_global generation:  0.001767873764038086
r_  generation:  0.010650157928466797
local_output_nid generation:  0.0016026496887207031
local_in_edges_tensor generation:  0.0011258125305175781
mini_batch_src_global generation:  0.0017039775848388672
r_  generation:  0.011324167251586914
local_output_nid generation:  0.0016512870788574219
local_in_edges_tensor generation:  0.0010020732879638672
mini_batch_src_global generation:  0.0011682510375976562
r_  generation:  0.009877443313598633
local_output_nid generation:  0.001592397689819336
local_in_edges_tensor generation:  0.0010077953338623047
mini_batch_src_global generation:  0.001125335693359375
r_  generation:  0.009896039962768555
local_output_nid generation:  0.0015952587127685547
local_in_edges_tensor generation:  0.0009694099426269531
mini_batch_src_global generation:  0.0011479854583740234
r_  generation:  0.010179996490478516
local_output_nid generation:  0.0016150474548339844
local_in_edges_tensor generation:  0.0009174346923828125
mini_batch_src_global generation:  0.0011508464813232422
r_  generation:  0.009540319442749023
local_output_nid generation:  0.0015947818756103516
local_in_edges_tensor generation:  0.0009212493896484375
mini_batch_src_global generation:  0.0011086463928222656
r_  generation:  0.009938955307006836
local_output_nid generation:  0.0015747547149658203
local_in_edges_tensor generation:  0.0008871555328369141
mini_batch_src_global generation:  0.0011255741119384766
r_  generation:  0.010692119598388672
local_output_nid generation:  0.0015997886657714844
local_in_edges_tensor generation:  0.0009107589721679688
mini_batch_src_global generation:  0.0011684894561767578
r_  generation:  0.010063648223876953
local_output_nid generation:  0.0015811920166015625
local_in_edges_tensor generation:  0.0008852481842041016
mini_batch_src_global generation:  0.0011334419250488281
r_  generation:  0.010156869888305664
local_output_nid generation:  0.0016329288482666016
local_in_edges_tensor generation:  0.0008795261383056641
mini_batch_src_global generation:  0.0011043548583984375
r_  generation:  0.01033926010131836
local_output_nid generation:  0.0015819072723388672
local_in_edges_tensor generation:  0.0008666515350341797
mini_batch_src_global generation:  0.0010814666748046875
r_  generation:  0.009674310684204102
local_output_nid generation:  0.001589059829711914
local_in_edges_tensor generation:  0.0008792877197265625
mini_batch_src_global generation:  0.0010876655578613281
r_  generation:  0.010558128356933594
local_output_nid generation:  0.0016078948974609375
local_in_edges_tensor generation:  0.0008752346038818359
mini_batch_src_global generation:  0.0011792182922363281
r_  generation:  0.010408878326416016
local_output_nid generation:  0.0015716552734375
local_in_edges_tensor generation:  0.0008978843688964844
mini_batch_src_global generation:  0.0010962486267089844
r_  generation:  0.010017156600952148
local_output_nid generation:  0.0015730857849121094
local_in_edges_tensor generation:  0.0008649826049804688
mini_batch_src_global generation:  0.00110626220703125
r_  generation:  0.010334014892578125
local_output_nid generation:  0.0015687942504882812
local_in_edges_tensor generation:  0.0009298324584960938
mini_batch_src_global generation:  0.0011761188507080078
r_  generation:  0.012106895446777344
local_output_nid generation:  0.0016465187072753906
local_in_edges_tensor generation:  0.0009098052978515625
mini_batch_src_global generation:  0.0012369155883789062
r_  generation:  0.010369300842285156
local_output_nid generation:  0.00159454345703125
local_in_edges_tensor generation:  0.0008847713470458984
mini_batch_src_global generation:  0.0011284351348876953
r_  generation:  0.009833574295043945
local_output_nid generation:  0.0015969276428222656
local_in_edges_tensor generation:  0.0009274482727050781
mini_batch_src_global generation:  0.001163482666015625
r_  generation:  0.010100603103637695
local_output_nid generation:  0.0015912055969238281
local_in_edges_tensor generation:  0.0008838176727294922
mini_batch_src_global generation:  0.0011720657348632812
r_  generation:  0.010528564453125
local_output_nid generation:  0.0015838146209716797
local_in_edges_tensor generation:  0.0008409023284912109
mini_batch_src_global generation:  0.0010905265808105469
r_  generation:  0.010065317153930664
local_output_nid generation:  0.001573801040649414
local_in_edges_tensor generation:  0.0008559226989746094
mini_batch_src_global generation:  0.001142740249633789
r_  generation:  0.010469675064086914
local_output_nid generation:  0.0015821456909179688
local_in_edges_tensor generation:  0.0008504390716552734
mini_batch_src_global generation:  0.0011332035064697266
r_  generation:  0.010294914245605469
local_output_nid generation:  0.0015680789947509766
local_in_edges_tensor generation:  0.0008318424224853516
mini_batch_src_global generation:  0.0012416839599609375
r_  generation:  0.010430335998535156
local_output_nid generation:  0.0015666484832763672
local_in_edges_tensor generation:  0.0008852481842041016
mini_batch_src_global generation:  0.0011699199676513672
r_  generation:  0.01076197624206543
local_output_nid generation:  0.0015714168548583984
local_in_edges_tensor generation:  0.0008952617645263672
mini_batch_src_global generation:  0.0011110305786132812
r_  generation:  0.010326385498046875
local_output_nid generation:  0.0015561580657958984
local_in_edges_tensor generation:  0.0008509159088134766
mini_batch_src_global generation:  0.0011324882507324219
r_  generation:  0.010563135147094727
local_output_nid generation:  0.0015645027160644531
local_in_edges_tensor generation:  0.0008637905120849609
mini_batch_src_global generation:  0.0011453628540039062
r_  generation:  0.010583162307739258
local_output_nid generation:  0.001569986343383789
local_in_edges_tensor generation:  0.0008509159088134766
mini_batch_src_global generation:  0.0011043548583984375
r_  generation:  0.010031700134277344
local_output_nid generation:  0.0015840530395507812
local_in_edges_tensor generation:  0.00101470947265625
mini_batch_src_global generation:  0.0011827945709228516
r_  generation:  0.010012626647949219
local_output_nid generation:  0.0015609264373779297
local_in_edges_tensor generation:  0.0009293556213378906
mini_batch_src_global generation:  0.0011591911315917969
r_  generation:  0.010208606719970703
----------------------check_connections_block total spend ----------------------------- 0.5732762813568115
generate_one_block  0.025135278701782227
generate_one_block  0.022881746292114258
generate_one_block  0.019775390625
generate_one_block  0.019051074981689453
generate_one_block  0.019292593002319336
generate_one_block  0.01793980598449707
generate_one_block  0.018793821334838867
generate_one_block  0.01937079429626465
generate_one_block  0.018755674362182617
generate_one_block  0.018861770629882812
generate_one_block  0.018999814987182617
generate_one_block  0.022298574447631836
generate_one_block  0.020308494567871094
generate_one_block  0.018912792205810547
generate_one_block  0.018368005752563477
generate_one_block  0.01902031898498535
generate_one_block  0.020000934600830078
generate_one_block  0.01920628547668457
generate_one_block  0.01812911033630371
generate_one_block  0.018593549728393555
generate_one_block  0.019041776657104492
generate_one_block  0.018435239791870117
generate_one_block  0.019390344619750977
generate_one_block  0.0186460018157959
generate_one_block  0.01908254623413086
generate_one_block  0.01926732063293457
generate_one_block  0.018975019454956055
generate_one_block  0.01932835578918457
generate_one_block  0.019557476043701172
generate_one_block  0.018443822860717773
generate_one_block  0.018361806869506836
generate_one_block  0.018436431884765625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04476213455200195
gen group dst list time:  0.023913145065307617
time for parepare:  0.02287459373474121
local_output_nid generation:  0.0067484378814697266
local_in_edges_tensor generation:  0.02194976806640625
mini_batch_src_global generation:  0.018320322036743164
r_  generation:  0.16451048851013184
local_output_nid generation:  0.009714365005493164
local_in_edges_tensor generation:  0.012810468673706055
mini_batch_src_global generation:  0.024087190628051758
r_  generation:  0.1807701587677002
local_output_nid generation:  0.009750604629516602
local_in_edges_tensor generation:  0.03431057929992676
mini_batch_src_global generation:  0.021892786026000977
r_  generation:  0.17235016822814941
local_output_nid generation:  0.009694337844848633
local_in_edges_tensor generation:  0.011871337890625
mini_batch_src_global generation:  0.02218937873840332
r_  generation:  0.17772841453552246
local_output_nid generation:  0.00976252555847168
local_in_edges_tensor generation:  0.010393619537353516
mini_batch_src_global generation:  0.02494668960571289
r_  generation:  0.18389368057250977
local_output_nid generation:  0.008862733840942383
local_in_edges_tensor generation:  0.012330770492553711
mini_batch_src_global generation:  0.02227020263671875
r_  generation:  0.1684572696685791
local_output_nid generation:  0.009223461151123047
local_in_edges_tensor generation:  0.012156486511230469
mini_batch_src_global generation:  0.023785114288330078
r_  generation:  0.18421483039855957
local_output_nid generation:  0.009236812591552734
local_in_edges_tensor generation:  0.011603832244873047
mini_batch_src_global generation:  0.024740934371948242
r_  generation:  0.18947696685791016
local_output_nid generation:  0.009527206420898438
local_in_edges_tensor generation:  0.00918436050415039
mini_batch_src_global generation:  0.024164915084838867
r_  generation:  0.18167376518249512
local_output_nid generation:  0.009676218032836914
local_in_edges_tensor generation:  0.012332916259765625
mini_batch_src_global generation:  0.022841453552246094
r_  generation:  0.18436360359191895
local_output_nid generation:  0.009860515594482422
local_in_edges_tensor generation:  0.01385045051574707
mini_batch_src_global generation:  0.022905349731445312
r_  generation:  0.18294668197631836
local_output_nid generation:  0.00934457778930664
local_in_edges_tensor generation:  0.00948190689086914
mini_batch_src_global generation:  0.022878408432006836
r_  generation:  0.17358970642089844
local_output_nid generation:  0.009768009185791016
local_in_edges_tensor generation:  0.010421514511108398
mini_batch_src_global generation:  0.023545026779174805
r_  generation:  0.18886852264404297
local_output_nid generation:  0.009624004364013672
local_in_edges_tensor generation:  0.009139537811279297
mini_batch_src_global generation:  0.02335524559020996
r_  generation:  0.18460345268249512
local_output_nid generation:  0.009493350982666016
local_in_edges_tensor generation:  0.011778831481933594
mini_batch_src_global generation:  0.023501873016357422
r_  generation:  0.17794466018676758
local_output_nid generation:  0.009806156158447266
local_in_edges_tensor generation:  0.009405851364135742
mini_batch_src_global generation:  0.023450374603271484
r_  generation:  0.18837475776672363
local_output_nid generation:  0.01171255111694336
local_in_edges_tensor generation:  0.010704755783081055
mini_batch_src_global generation:  0.025548458099365234
r_  generation:  0.19488120079040527
local_output_nid generation:  0.00930476188659668
local_in_edges_tensor generation:  0.009536504745483398
mini_batch_src_global generation:  0.023073673248291016
r_  generation:  0.17706823348999023
local_output_nid generation:  0.009490013122558594
local_in_edges_tensor generation:  0.00876760482788086
mini_batch_src_global generation:  0.02165699005126953
r_  generation:  0.1757972240447998
local_output_nid generation:  0.009626388549804688
local_in_edges_tensor generation:  0.010127782821655273
mini_batch_src_global generation:  0.022869348526000977
r_  generation:  0.18090462684631348
local_output_nid generation:  0.00981283187866211
local_in_edges_tensor generation:  0.011068105697631836
mini_batch_src_global generation:  0.023381471633911133
r_  generation:  0.18974757194519043
local_output_nid generation:  0.009606361389160156
local_in_edges_tensor generation:  0.009424448013305664
mini_batch_src_global generation:  0.023765087127685547
r_  generation:  0.1874861717224121
local_output_nid generation:  0.009766578674316406
local_in_edges_tensor generation:  0.009648799896240234
mini_batch_src_global generation:  0.02376103401184082
r_  generation:  0.18925237655639648
local_output_nid generation:  0.009588003158569336
local_in_edges_tensor generation:  0.009381771087646484
mini_batch_src_global generation:  0.023195743560791016
r_  generation:  0.1826610565185547
local_output_nid generation:  0.00983881950378418
local_in_edges_tensor generation:  0.009535074234008789
mini_batch_src_global generation:  0.023665904998779297
r_  generation:  0.18712854385375977
local_output_nid generation:  0.009974956512451172
local_in_edges_tensor generation:  0.009571075439453125
mini_batch_src_global generation:  0.02410602569580078
r_  generation:  0.18932509422302246
local_output_nid generation:  0.009796857833862305
local_in_edges_tensor generation:  0.00976252555847168
mini_batch_src_global generation:  0.023253202438354492
r_  generation:  0.18547606468200684
local_output_nid generation:  0.009885549545288086
local_in_edges_tensor generation:  0.009577035903930664
mini_batch_src_global generation:  0.024557113647460938
r_  generation:  0.19473814964294434
local_output_nid generation:  0.010050535202026367
local_in_edges_tensor generation:  0.009339570999145508
mini_batch_src_global generation:  0.023668527603149414
r_  generation:  0.19210505485534668
local_output_nid generation:  0.009372234344482422
local_in_edges_tensor generation:  0.009066343307495117
mini_batch_src_global generation:  0.02288508415222168
r_  generation:  0.18059897422790527
local_output_nid generation:  0.009629249572753906
local_in_edges_tensor generation:  0.009123086929321289
mini_batch_src_global generation:  0.02272343635559082
r_  generation:  0.18311738967895508
local_output_nid generation:  0.009637594223022461
local_in_edges_tensor generation:  0.008940935134887695
mini_batch_src_global generation:  0.022949695587158203
r_  generation:  0.1833972930908203
----------------------check_connections_block total spend ----------------------------- 8.615056037902832
generate_one_block  0.24541902542114258
generate_one_block  0.262042760848999
generate_one_block  0.24545598030090332
generate_one_block  0.24834227561950684
generate_one_block  0.27105069160461426
generate_one_block  0.2321782112121582
generate_one_block  0.25119876861572266
generate_one_block  0.26015639305114746
generate_one_block  0.2475135326385498
generate_one_block  0.24838662147521973
generate_one_block  0.2491588592529297
generate_one_block  0.2336874008178711
generate_one_block  0.2540757656097412
generate_one_block  0.2481081485748291
generate_one_block  0.24277067184448242
generate_one_block  0.2538716793060303
generate_one_block  0.2649502754211426
generate_one_block  0.23765349388122559
generate_one_block  0.23276162147521973
generate_one_block  0.24929285049438477
generate_one_block  0.257706880569458
generate_one_block  0.2486095428466797
generate_one_block  0.25389552116394043
generate_one_block  0.24441981315612793
generate_one_block  0.24852442741394043
generate_one_block  0.25771498680114746
generate_one_block  0.2506418228149414
generate_one_block  0.2616732120513916
generate_one_block  0.258716344833374
generate_one_block  0.24118494987487793
generate_one_block  0.24243927001953125
generate_one_block  0.24613285064697266
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.033963680267333984
gen group dst list time:  0.10691595077514648
time for parepare:  0.02101898193359375
local_output_nid generation:  0.0264132022857666
local_in_edges_tensor generation:  0.046993255615234375
mini_batch_src_global generation:  0.04723548889160156
r_  generation:  0.4882798194885254
local_output_nid generation:  0.032732486724853516
local_in_edges_tensor generation:  0.04170680046081543
mini_batch_src_global generation:  0.061171770095825195
r_  generation:  0.4886047840118408
local_output_nid generation:  0.03183913230895996
local_in_edges_tensor generation:  0.03814125061035156
mini_batch_src_global generation:  0.05900454521179199
r_  generation:  0.49446773529052734
local_output_nid generation:  0.031531333923339844
local_in_edges_tensor generation:  0.03470134735107422
mini_batch_src_global generation:  0.05803108215332031
r_  generation:  0.49245643615722656
local_output_nid generation:  0.03176426887512207
local_in_edges_tensor generation:  0.03156876564025879
mini_batch_src_global generation:  0.05800819396972656
r_  generation:  0.5020911693572998
local_output_nid generation:  0.0314939022064209
local_in_edges_tensor generation:  0.03650188446044922
mini_batch_src_global generation:  0.06044745445251465
r_  generation:  0.49182701110839844
local_output_nid generation:  0.030268192291259766
local_in_edges_tensor generation:  0.03562164306640625
mini_batch_src_global generation:  0.058005332946777344
r_  generation:  0.5022697448730469
local_output_nid generation:  0.02979111671447754
local_in_edges_tensor generation:  0.030060768127441406
mini_batch_src_global generation:  0.059395551681518555
r_  generation:  0.49811720848083496
local_output_nid generation:  0.029375314712524414
local_in_edges_tensor generation:  0.0296175479888916
mini_batch_src_global generation:  0.0583646297454834
r_  generation:  0.5012896060943604
local_output_nid generation:  0.02955484390258789
local_in_edges_tensor generation:  0.030157089233398438
mini_batch_src_global generation:  0.05963015556335449
r_  generation:  0.4981060028076172
local_output_nid generation:  0.02972555160522461
local_in_edges_tensor generation:  0.02938222885131836
mini_batch_src_global generation:  0.05881452560424805
r_  generation:  0.4985992908477783
local_output_nid generation:  0.03276395797729492
local_in_edges_tensor generation:  0.03100872039794922
mini_batch_src_global generation:  0.06009101867675781
r_  generation:  0.4930851459503174
local_output_nid generation:  0.02948617935180664
local_in_edges_tensor generation:  0.029208898544311523
mini_batch_src_global generation:  0.05847358703613281
r_  generation:  0.5014915466308594
local_output_nid generation:  0.029793500900268555
local_in_edges_tensor generation:  0.031461477279663086
mini_batch_src_global generation:  0.05975461006164551
r_  generation:  0.5030117034912109
local_output_nid generation:  0.029627323150634766
local_in_edges_tensor generation:  0.0301973819732666
mini_batch_src_global generation:  0.05799579620361328
r_  generation:  0.49921369552612305
local_output_nid generation:  0.029731035232543945
local_in_edges_tensor generation:  0.030185461044311523
mini_batch_src_global generation:  0.06100964546203613
r_  generation:  0.5048666000366211
local_output_nid generation:  0.030239343643188477
local_in_edges_tensor generation:  0.038973093032836914
mini_batch_src_global generation:  0.0607755184173584
r_  generation:  0.5056872367858887
local_output_nid generation:  0.029501914978027344
local_in_edges_tensor generation:  0.030489683151245117
mini_batch_src_global generation:  0.059295654296875
r_  generation:  0.49988603591918945
local_output_nid generation:  0.02951979637145996
local_in_edges_tensor generation:  0.03391242027282715
mini_batch_src_global generation:  0.05817079544067383
r_  generation:  0.4984307289123535
local_output_nid generation:  0.029669523239135742
local_in_edges_tensor generation:  0.02957773208618164
mini_batch_src_global generation:  0.05909538269042969
r_  generation:  0.49991297721862793
local_output_nid generation:  0.029732227325439453
local_in_edges_tensor generation:  0.031164169311523438
mini_batch_src_global generation:  0.05968308448791504
r_  generation:  0.5026721954345703
local_output_nid generation:  0.02977132797241211
local_in_edges_tensor generation:  0.02927875518798828
mini_batch_src_global generation:  0.05890250205993652
r_  generation:  0.4992861747741699
local_output_nid generation:  0.029798507690429688
local_in_edges_tensor generation:  0.029623746871948242
mini_batch_src_global generation:  0.06032848358154297
r_  generation:  0.49887967109680176
local_output_nid generation:  0.029811382293701172
local_in_edges_tensor generation:  0.030679941177368164
mini_batch_src_global generation:  0.059409141540527344
r_  generation:  0.4980018138885498
local_output_nid generation:  0.029547452926635742
local_in_edges_tensor generation:  0.03320789337158203
mini_batch_src_global generation:  0.057570457458496094
r_  generation:  0.4996926784515381
local_output_nid generation:  0.030188322067260742
local_in_edges_tensor generation:  0.03172922134399414
mini_batch_src_global generation:  0.05939817428588867
r_  generation:  0.49836301803588867
local_output_nid generation:  0.03008556365966797
local_in_edges_tensor generation:  0.03150820732116699
mini_batch_src_global generation:  0.05821108818054199
r_  generation:  0.49755096435546875
local_output_nid generation:  0.029610157012939453
local_in_edges_tensor generation:  0.031479597091674805
mini_batch_src_global generation:  0.059005022048950195
r_  generation:  0.4983210563659668
local_output_nid generation:  0.02972412109375
local_in_edges_tensor generation:  0.031684160232543945
mini_batch_src_global generation:  0.05821347236633301
r_  generation:  0.5033652782440186
local_output_nid generation:  0.029772520065307617
local_in_edges_tensor generation:  0.03298354148864746
mini_batch_src_global generation:  0.05883955955505371
r_  generation:  0.49918103218078613
local_output_nid generation:  0.029656410217285156
local_in_edges_tensor generation:  0.03151202201843262
mini_batch_src_global generation:  0.057433366775512695
r_  generation:  0.5002756118774414
local_output_nid generation:  0.030164241790771484
local_in_edges_tensor generation:  0.031231403350830078
mini_batch_src_global generation:  0.058899879455566406
r_  generation:  0.5075638294219971
----------------------check_connections_block total spend ----------------------------- 23.33572816848755
generate_one_block  0.6897659301757812
generate_one_block  0.6838927268981934
generate_one_block  0.6800837516784668
generate_one_block  0.6806027889251709
generate_one_block  0.7758915424346924
generate_one_block  0.6779451370239258
generate_one_block  0.6760921478271484
generate_one_block  0.6920554637908936
generate_one_block  0.6748499870300293
generate_one_block  0.6846389770507812
generate_one_block  0.6789112091064453
generate_one_block  0.6708757877349854
generate_one_block  0.6807272434234619
generate_one_block  0.6837501525878906
generate_one_block  0.6761975288391113
generate_one_block  0.6811914443969727
generate_one_block  0.6878128051757812
generate_one_block  0.6787433624267578
generate_one_block  0.673663854598999
generate_one_block  0.6791272163391113
generate_one_block  0.6797518730163574
generate_one_block  0.6800234317779541
generate_one_block  0.6778767108917236
generate_one_block  0.680992841720581
generate_one_block  0.6961169242858887
generate_one_block  0.6978549957275391
generate_one_block  0.6801459789276123
generate_one_block  0.6791808605194092
generate_one_block  0.6882445812225342
generate_one_block  0.6806161403656006
generate_one_block  0.6829087734222412
generate_one_block  0.6891660690307617
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.3026123046875 GB
    Memory Allocated: 0.13207626342773438  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

connection checking time:  31.95078420639038
block generation total time  29.909432888031006
average batch blocks generation time:  0.9346697777509689
block dataloader generation time/epoch 65.77595669573003
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3026123046875 GB
    Memory Allocated: 0.10941505432128906  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3026123046875 GB
    Memory Allocated: 20.71311378479004  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3026123046875 GB
    Memory Allocated: 0.10941457748413086  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3690185546875 GB
    Memory Allocated: 21.371312618255615  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3729248046875 GB
    Memory Allocated: 0.10918855667114258  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3729248046875 GB
    Memory Allocated: 20.663546562194824  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3729248046875 GB
    Memory Allocated: 0.1092371940612793  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3729248046875 GB
    Memory Allocated: 20.77762460708618  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3729248046875 GB
    Memory Allocated: 0.10933065414428711  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3729248046875 GB
    Memory Allocated: 21.08454990386963  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3729248046875 GB
    Memory Allocated: 0.1086883544921875  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3729248046875 GB
    Memory Allocated: 20.0123291015625  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3729248046875 GB
    Memory Allocated: 0.10938119888305664  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3729248046875 GB
    Memory Allocated: 20.93792724609375  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3729248046875 GB
    Memory Allocated: 0.10918760299682617  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3729248046875 GB
    Memory Allocated: 21.153817176818848  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3729248046875 GB
    Memory Allocated: 0.10913515090942383  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3729248046875 GB
    Memory Allocated: 20.745245456695557  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3729248046875 GB
    Memory Allocated: 0.1092672348022461  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3729248046875 GB
    Memory Allocated: 20.870935440063477  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3729248046875 GB
    Memory Allocated: 0.10930299758911133  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3729248046875 GB
    Memory Allocated: 20.853307247161865  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3729248046875 GB
    Memory Allocated: 0.10889768600463867  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3729248046875 GB
    Memory Allocated: 20.155883312225342  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3729248046875 GB
    Memory Allocated: 0.1092691421508789  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3729248046875 GB
    Memory Allocated: 21.03195285797119  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3729248046875 GB
    Memory Allocated: 0.10914373397827148  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3729248046875 GB
    Memory Allocated: 20.785727500915527  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3729248046875 GB
    Memory Allocated: 0.10897254943847656  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3729248046875 GB
    Memory Allocated: 20.36537742614746  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3729248046875 GB
    Memory Allocated: 0.10919713973999023  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3729248046875 GB
    Memory Allocated: 20.91207790374756  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3729248046875 GB
    Memory Allocated: 0.10997247695922852  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 21.497677326202393  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10847663879394531  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.201910495758057  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10887002944946289  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.13764476776123  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10899543762207031  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.492887020111084  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10957860946655273  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 21.067768096923828  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10909652709960938  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.73312997817993  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10934925079345703  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 21.04593849182129  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10911417007446289  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.670437812805176  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10926485061645508  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.824846744537354  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10959196090698242  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 21.142059803009033  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10926246643066406  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.810773372650146  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10932207107543945  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 21.189247608184814  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10948705673217773  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 21.207973957061768  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10893774032592773  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.469029426574707  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10903358459472656  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.618706226348877  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10943841934204102  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.73572540283203  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03513864427804947 |0.02284066379070282 |0.6365535035729408 |9.682774543762207e-05 |1.2073509991168976 |0.0045015811920166016 |
----------------------------------------------------------pseudo_mini_loss sum 1.365679144859314
Total (block generation + training)time/epoch 126.60088148984042
Training time/epoch 60.931755781173706
Training time without block to device /epoch 60.200854539871216
Training time without total dataloading part /epoch 59.01254415512085
load block tensor time/epoch 1.124436616897583
block to device time/epoch 0.7309012413024902
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 20 |
Number of nodes for computation during this epoch:  9161183
Number of first layer input nodes during this epoch:  4807116
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.13175296783447266  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02483201026916504
random selection method range initialization spend 0.006767988204956055
time for parepare:  0.02262139320373535
local_output_nid generation:  0.0014262199401855469
local_in_edges_tensor generation:  0.006180763244628906
mini_batch_src_global generation:  0.002569913864135742
r_  generation:  0.012270689010620117
local_output_nid generation:  0.0017299652099609375
local_in_edges_tensor generation:  0.000972747802734375
mini_batch_src_global generation:  0.0016598701477050781
r_  generation:  0.010517597198486328
local_output_nid generation:  0.0016736984252929688
local_in_edges_tensor generation:  0.0009388923645019531
mini_batch_src_global generation:  0.0012731552124023438
r_  generation:  0.010202884674072266
local_output_nid generation:  0.0016417503356933594
local_in_edges_tensor generation:  0.0008604526519775391
mini_batch_src_global generation:  0.0011262893676757812
r_  generation:  0.009470701217651367
local_output_nid generation:  0.0016162395477294922
local_in_edges_tensor generation:  0.0008890628814697266
mini_batch_src_global generation:  0.0011415481567382812
r_  generation:  0.009950876235961914
local_output_nid generation:  0.0016033649444580078
local_in_edges_tensor generation:  0.0008766651153564453
mini_batch_src_global generation:  0.0011854171752929688
r_  generation:  0.010116338729858398
local_output_nid generation:  0.0015811920166015625
local_in_edges_tensor generation:  0.0008265972137451172
mini_batch_src_global generation:  0.0011799335479736328
r_  generation:  0.010551691055297852
local_output_nid generation:  0.0015766620635986328
local_in_edges_tensor generation:  0.0008807182312011719
mini_batch_src_global generation:  0.0011756420135498047
r_  generation:  0.010283470153808594
local_output_nid generation:  0.0015637874603271484
local_in_edges_tensor generation:  0.000835418701171875
mini_batch_src_global generation:  0.0011494159698486328
r_  generation:  0.010185480117797852
local_output_nid generation:  0.0015685558319091797
local_in_edges_tensor generation:  0.0008418560028076172
mini_batch_src_global generation:  0.0011463165283203125
r_  generation:  0.01038980484008789
local_output_nid generation:  0.001544952392578125
local_in_edges_tensor generation:  0.0008435249328613281
mini_batch_src_global generation:  0.0011365413665771484
r_  generation:  0.010330915451049805
local_output_nid generation:  0.0015499591827392578
local_in_edges_tensor generation:  0.0008459091186523438
mini_batch_src_global generation:  0.0011169910430908203
r_  generation:  0.009950637817382812
local_output_nid generation:  0.0015621185302734375
local_in_edges_tensor generation:  0.0008625984191894531
mini_batch_src_global generation:  0.0011181831359863281
r_  generation:  0.009940147399902344
local_output_nid generation:  0.0015425682067871094
local_in_edges_tensor generation:  0.0008451938629150391
mini_batch_src_global generation:  0.001169443130493164
r_  generation:  0.010514974594116211
local_output_nid generation:  0.0015561580657958984
local_in_edges_tensor generation:  0.0008654594421386719
mini_batch_src_global generation:  0.0011162757873535156
r_  generation:  0.010032415390014648
local_output_nid generation:  0.0015652179718017578
local_in_edges_tensor generation:  0.0008432865142822266
mini_batch_src_global generation:  0.0011382102966308594
r_  generation:  0.010241985321044922
local_output_nid generation:  0.0015664100646972656
local_in_edges_tensor generation:  0.0009088516235351562
mini_batch_src_global generation:  0.0011365413665771484
r_  generation:  0.010203123092651367
local_output_nid generation:  0.0015399456024169922
local_in_edges_tensor generation:  0.0008599758148193359
mini_batch_src_global generation:  0.001079559326171875
r_  generation:  0.009473085403442383
local_output_nid generation:  0.001565694808959961
local_in_edges_tensor generation:  0.0008313655853271484
mini_batch_src_global generation:  0.0011494159698486328
r_  generation:  0.0102386474609375
local_output_nid generation:  0.0015821456909179688
local_in_edges_tensor generation:  0.0008578300476074219
mini_batch_src_global generation:  0.0011303424835205078
r_  generation:  0.010201454162597656
local_output_nid generation:  0.0015575885772705078
local_in_edges_tensor generation:  0.0008087158203125
mini_batch_src_global generation:  0.0011568069458007812
r_  generation:  0.010614156723022461
local_output_nid generation:  0.0015423297882080078
local_in_edges_tensor generation:  0.0008404254913330078
mini_batch_src_global generation:  0.0011577606201171875
r_  generation:  0.010586023330688477
local_output_nid generation:  0.00154876708984375
local_in_edges_tensor generation:  0.0008363723754882812
mini_batch_src_global generation:  0.0011625289916992188
r_  generation:  0.010468244552612305
local_output_nid generation:  0.001543283462524414
local_in_edges_tensor generation:  0.0008244514465332031
mini_batch_src_global generation:  0.0011124610900878906
r_  generation:  0.01022481918334961
local_output_nid generation:  0.0015316009521484375
local_in_edges_tensor generation:  0.0008058547973632812
mini_batch_src_global generation:  0.0011286735534667969
r_  generation:  0.010198354721069336
local_output_nid generation:  0.0015399456024169922
local_in_edges_tensor generation:  0.0008208751678466797
mini_batch_src_global generation:  0.0011374950408935547
r_  generation:  0.010721206665039062
local_output_nid generation:  0.0015528202056884766
local_in_edges_tensor generation:  0.0008199214935302734
mini_batch_src_global generation:  0.0011849403381347656
r_  generation:  0.010625839233398438
local_output_nid generation:  0.0015463829040527344
local_in_edges_tensor generation:  0.0009458065032958984
mini_batch_src_global generation:  0.0011487007141113281
r_  generation:  0.011523246765136719
local_output_nid generation:  0.0015451908111572266
local_in_edges_tensor generation:  0.0008382797241210938
mini_batch_src_global generation:  0.0011224746704101562
r_  generation:  0.010245323181152344
local_output_nid generation:  0.0015537738800048828
local_in_edges_tensor generation:  0.0008249282836914062
mini_batch_src_global generation:  0.0010833740234375
r_  generation:  0.010057687759399414
local_output_nid generation:  0.0015528202056884766
local_in_edges_tensor generation:  0.0009093284606933594
mini_batch_src_global generation:  0.0011560916900634766
r_  generation:  0.010314226150512695
local_output_nid generation:  0.001537322998046875
local_in_edges_tensor generation:  0.0008955001831054688
mini_batch_src_global generation:  0.0011396408081054688
r_  generation:  0.010255098342895508
----------------------check_connections_block total spend ----------------------------- 0.5686664581298828
generate_one_block  0.026082277297973633
generate_one_block  0.021208763122558594
generate_one_block  0.019788265228271484
generate_one_block  0.018154382705688477
generate_one_block  0.019106149673461914
generate_one_block  0.01875758171081543
generate_one_block  0.018973588943481445
generate_one_block  0.019010066986083984
generate_one_block  0.01880168914794922
generate_one_block  0.018961429595947266
generate_one_block  0.018829345703125
generate_one_block  0.021794795989990234
generate_one_block  0.01934671401977539
generate_one_block  0.01944446563720703
generate_one_block  0.018146753311157227
generate_one_block  0.018886566162109375
generate_one_block  0.018615245819091797
generate_one_block  0.01753377914428711
generate_one_block  0.018746137619018555
generate_one_block  0.0187680721282959
generate_one_block  0.019571304321289062
generate_one_block  0.019754409790039062
generate_one_block  0.01917266845703125
generate_one_block  0.018770694732666016
generate_one_block  0.018936634063720703
generate_one_block  0.0198211669921875
generate_one_block  0.01972222328186035
generate_one_block  0.017685651779174805
generate_one_block  0.018738508224487305
generate_one_block  0.0186004638671875
generate_one_block  0.01874542236328125
generate_one_block  0.0188596248626709
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03922390937805176
gen group dst list time:  0.026250123977661133
time for parepare:  0.02254509925842285
local_output_nid generation:  0.006891012191772461
local_in_edges_tensor generation:  0.020610570907592773
mini_batch_src_global generation:  0.021080732345581055
r_  generation:  0.19746947288513184
local_output_nid generation:  0.012375831604003906
local_in_edges_tensor generation:  0.01307368278503418
mini_batch_src_global generation:  0.02590155601501465
r_  generation:  0.17090988159179688
local_output_nid generation:  0.00950932502746582
local_in_edges_tensor generation:  0.035816192626953125
mini_batch_src_global generation:  0.024429798126220703
r_  generation:  0.18019366264343262
local_output_nid generation:  0.00922250747680664
local_in_edges_tensor generation:  0.011629104614257812
mini_batch_src_global generation:  0.0238034725189209
r_  generation:  0.17530584335327148
local_output_nid generation:  0.009671688079833984
local_in_edges_tensor generation:  0.011202096939086914
mini_batch_src_global generation:  0.03207898139953613
r_  generation:  0.1839282512664795
local_output_nid generation:  0.009343862533569336
local_in_edges_tensor generation:  0.009933710098266602
mini_batch_src_global generation:  0.026710987091064453
r_  generation:  0.18852472305297852
local_output_nid generation:  0.00937199592590332
local_in_edges_tensor generation:  0.012766122817993164
mini_batch_src_global generation:  0.027187824249267578
r_  generation:  0.19720077514648438
local_output_nid generation:  0.00932455062866211
local_in_edges_tensor generation:  0.013981819152832031
mini_batch_src_global generation:  0.02698230743408203
r_  generation:  0.19577479362487793
local_output_nid generation:  0.010164976119995117
local_in_edges_tensor generation:  0.01283121109008789
mini_batch_src_global generation:  0.025356054306030273
r_  generation:  0.19474124908447266
local_output_nid generation:  0.009722471237182617
local_in_edges_tensor generation:  0.014437437057495117
mini_batch_src_global generation:  0.02533411979675293
r_  generation:  0.19707846641540527
local_output_nid generation:  0.009752035140991211
local_in_edges_tensor generation:  0.0124359130859375
mini_batch_src_global generation:  0.025285959243774414
r_  generation:  0.19107365608215332
local_output_nid generation:  0.009711265563964844
local_in_edges_tensor generation:  0.012388229370117188
mini_batch_src_global generation:  0.023916244506835938
r_  generation:  0.18839645385742188
local_output_nid generation:  0.009760618209838867
local_in_edges_tensor generation:  0.01139068603515625
mini_batch_src_global generation:  0.025644540786743164
r_  generation:  0.1868453025817871
local_output_nid generation:  0.010019540786743164
local_in_edges_tensor generation:  0.011377096176147461
mini_batch_src_global generation:  0.03352618217468262
r_  generation:  0.21951985359191895
local_output_nid generation:  0.011388301849365234
local_in_edges_tensor generation:  0.011010885238647461
mini_batch_src_global generation:  0.024416446685791016
r_  generation:  0.19156813621520996
local_output_nid generation:  0.01105952262878418
local_in_edges_tensor generation:  0.009270668029785156
mini_batch_src_global generation:  0.025098323822021484
r_  generation:  0.18703341484069824
local_output_nid generation:  0.010003328323364258
local_in_edges_tensor generation:  0.010520219802856445
mini_batch_src_global generation:  0.02404022216796875
r_  generation:  0.1845409870147705
local_output_nid generation:  0.009521722793579102
local_in_edges_tensor generation:  0.011508703231811523
mini_batch_src_global generation:  0.022934675216674805
r_  generation:  0.1754903793334961
local_output_nid generation:  0.010020017623901367
local_in_edges_tensor generation:  0.009353160858154297
mini_batch_src_global generation:  0.024149179458618164
r_  generation:  0.18622827529907227
local_output_nid generation:  0.009890556335449219
local_in_edges_tensor generation:  0.009233474731445312
mini_batch_src_global generation:  0.024128437042236328
r_  generation:  0.18442559242248535
local_output_nid generation:  0.010262250900268555
local_in_edges_tensor generation:  0.010510921478271484
mini_batch_src_global generation:  0.025742292404174805
r_  generation:  0.19170260429382324
local_output_nid generation:  0.010246753692626953
local_in_edges_tensor generation:  0.011228322982788086
mini_batch_src_global generation:  0.02441883087158203
r_  generation:  0.19093871116638184
local_output_nid generation:  0.01007080078125
local_in_edges_tensor generation:  0.00939631462097168
mini_batch_src_global generation:  0.02455925941467285
r_  generation:  0.22184252738952637
local_output_nid generation:  0.009921550750732422
local_in_edges_tensor generation:  0.00948786735534668
mini_batch_src_global generation:  0.02388930320739746
r_  generation:  0.22031188011169434
local_output_nid generation:  0.010069131851196289
local_in_edges_tensor generation:  0.00927424430847168
mini_batch_src_global generation:  0.025029897689819336
r_  generation:  0.18987298011779785
local_output_nid generation:  0.010206222534179688
local_in_edges_tensor generation:  0.012593269348144531
mini_batch_src_global generation:  0.02628922462463379
r_  generation:  0.19625329971313477
local_output_nid generation:  0.010342121124267578
local_in_edges_tensor generation:  0.01010441780090332
mini_batch_src_global generation:  0.025330781936645508
r_  generation:  0.19789600372314453
local_output_nid generation:  0.009605884552001953
local_in_edges_tensor generation:  0.008615970611572266
mini_batch_src_global generation:  0.02307415008544922
r_  generation:  0.18576812744140625
local_output_nid generation:  0.009763240814208984
local_in_edges_tensor generation:  0.00999140739440918
mini_batch_src_global generation:  0.02410125732421875
r_  generation:  0.1932377815246582
local_output_nid generation:  0.009721040725708008
local_in_edges_tensor generation:  0.012701034545898438
mini_batch_src_global generation:  0.026494264602661133
r_  generation:  0.18802809715270996
local_output_nid generation:  0.010030984878540039
local_in_edges_tensor generation:  0.009566545486450195
mini_batch_src_global generation:  0.024779558181762695
r_  generation:  0.18988299369812012
local_output_nid generation:  0.009926080703735352
local_in_edges_tensor generation:  0.010204792022705078
mini_batch_src_global generation:  0.023942232131958008
r_  generation:  0.18664312362670898
----------------------check_connections_block total spend ----------------------------- 9.042943000793457
generate_one_block  0.2788372039794922
generate_one_block  0.2386784553527832
generate_one_block  0.24613189697265625
generate_one_block  0.24028682708740234
generate_one_block  0.2626011371612549
generate_one_block  0.2569127082824707
generate_one_block  0.2656106948852539
generate_one_block  0.2653813362121582
generate_one_block  0.2542736530303955
generate_one_block  0.25466275215148926
generate_one_block  0.2580556869506836
generate_one_block  0.2447962760925293
generate_one_block  0.2407550811767578
generate_one_block  0.2549457550048828
generate_one_block  0.23724961280822754
generate_one_block  0.24665570259094238
generate_one_block  0.24723029136657715
generate_one_block  0.2326812744140625
generate_one_block  0.24836397171020508
generate_one_block  0.2566096782684326
generate_one_block  0.27144360542297363
generate_one_block  0.2570321559906006
generate_one_block  0.25430774688720703
generate_one_block  0.25159239768981934
generate_one_block  0.2577173709869385
generate_one_block  0.2637045383453369
generate_one_block  0.2600739002227783
generate_one_block  0.2405712604522705
generate_one_block  0.25081753730773926
generate_one_block  0.2541179656982422
generate_one_block  0.25682878494262695
generate_one_block  0.25003695487976074
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.040207624435424805
gen group dst list time:  0.11986446380615234
time for parepare:  0.019626855850219727
local_output_nid generation:  0.027118682861328125
local_in_edges_tensor generation:  0.059754133224487305
mini_batch_src_global generation:  0.04785776138305664
r_  generation:  0.4918348789215088
local_output_nid generation:  0.031606435775756836
local_in_edges_tensor generation:  0.03750324249267578
mini_batch_src_global generation:  0.06123495101928711
r_  generation:  0.48679685592651367
local_output_nid generation:  0.03166913986206055
local_in_edges_tensor generation:  0.03859376907348633
mini_batch_src_global generation:  0.06605696678161621
r_  generation:  0.5107665061950684
local_output_nid generation:  0.034491539001464844
local_in_edges_tensor generation:  0.03783011436462402
mini_batch_src_global generation:  0.05932450294494629
r_  generation:  0.4894876480102539
local_output_nid generation:  0.03241729736328125
local_in_edges_tensor generation:  0.03345608711242676
mini_batch_src_global generation:  0.05808615684509277
r_  generation:  0.4960155487060547
local_output_nid generation:  0.032505035400390625
local_in_edges_tensor generation:  0.03397345542907715
mini_batch_src_global generation:  0.05974912643432617
r_  generation:  0.49794983863830566
local_output_nid generation:  0.03135871887207031
local_in_edges_tensor generation:  0.037423133850097656
mini_batch_src_global generation:  0.05862545967102051
r_  generation:  0.5129256248474121
local_output_nid generation:  0.030677080154418945
local_in_edges_tensor generation:  0.03125405311584473
mini_batch_src_global generation:  0.061785221099853516
r_  generation:  0.5001475811004639
local_output_nid generation:  0.030417680740356445
local_in_edges_tensor generation:  0.03324580192565918
mini_batch_src_global generation:  0.05878758430480957
r_  generation:  0.502427339553833
local_output_nid generation:  0.030771970748901367
local_in_edges_tensor generation:  0.029278993606567383
mini_batch_src_global generation:  0.06197023391723633
r_  generation:  0.5010273456573486
local_output_nid generation:  0.03171229362487793
local_in_edges_tensor generation:  0.037764549255371094
mini_batch_src_global generation:  0.05818676948547363
r_  generation:  0.5025811195373535
local_output_nid generation:  0.030675411224365234
local_in_edges_tensor generation:  0.03104424476623535
mini_batch_src_global generation:  0.05909991264343262
r_  generation:  0.4947319030761719
local_output_nid generation:  0.030372142791748047
local_in_edges_tensor generation:  0.028262615203857422
mini_batch_src_global generation:  0.06053018569946289
r_  generation:  0.5012249946594238
local_output_nid generation:  0.0305023193359375
local_in_edges_tensor generation:  0.03200507164001465
mini_batch_src_global generation:  0.059134721755981445
r_  generation:  0.5013699531555176
local_output_nid generation:  0.030467748641967773
local_in_edges_tensor generation:  0.03410696983337402
mini_batch_src_global generation:  0.05871176719665527
r_  generation:  0.49790310859680176
local_output_nid generation:  0.030477285385131836
local_in_edges_tensor generation:  0.03222227096557617
mini_batch_src_global generation:  0.06229400634765625
r_  generation:  0.5031025409698486
local_output_nid generation:  0.030513286590576172
local_in_edges_tensor generation:  0.03232288360595703
mini_batch_src_global generation:  0.05776095390319824
r_  generation:  0.4993124008178711
local_output_nid generation:  0.030206918716430664
local_in_edges_tensor generation:  0.03452420234680176
mini_batch_src_global generation:  0.0592191219329834
r_  generation:  0.4941747188568115
local_output_nid generation:  0.0304868221282959
local_in_edges_tensor generation:  0.03833436965942383
mini_batch_src_global generation:  0.06246328353881836
r_  generation:  0.5028612613677979
local_output_nid generation:  0.0320734977722168
local_in_edges_tensor generation:  0.028699398040771484
mini_batch_src_global generation:  0.059326887130737305
r_  generation:  0.49459052085876465
local_output_nid generation:  0.030669212341308594
local_in_edges_tensor generation:  0.030458450317382812
mini_batch_src_global generation:  0.06214499473571777
r_  generation:  0.5041413307189941
local_output_nid generation:  0.030837059020996094
local_in_edges_tensor generation:  0.0383448600769043
mini_batch_src_global generation:  0.060018062591552734
r_  generation:  0.5198683738708496
local_output_nid generation:  0.03254342079162598
local_in_edges_tensor generation:  0.03652548789978027
mini_batch_src_global generation:  0.06197857856750488
r_  generation:  0.5033228397369385
local_output_nid generation:  0.030986785888671875
local_in_edges_tensor generation:  0.031271934509277344
mini_batch_src_global generation:  0.05988478660583496
r_  generation:  0.49660658836364746
local_output_nid generation:  0.030605792999267578
local_in_edges_tensor generation:  0.029830217361450195
mini_batch_src_global generation:  0.05832719802856445
r_  generation:  0.5017929077148438
local_output_nid generation:  0.030514955520629883
local_in_edges_tensor generation:  0.030565261840820312
mini_batch_src_global generation:  0.06023430824279785
r_  generation:  0.499237060546875
local_output_nid generation:  0.031143903732299805
local_in_edges_tensor generation:  0.03218507766723633
mini_batch_src_global generation:  0.060532569885253906
r_  generation:  0.5082299709320068
local_output_nid generation:  0.030411720275878906
local_in_edges_tensor generation:  0.03233146667480469
mini_batch_src_global generation:  0.0595245361328125
r_  generation:  0.4983041286468506
local_output_nid generation:  0.030530929565429688
local_in_edges_tensor generation:  0.029697895050048828
mini_batch_src_global generation:  0.05824899673461914
r_  generation:  0.5057942867279053
local_output_nid generation:  0.03039264678955078
local_in_edges_tensor generation:  0.027961015701293945
mini_batch_src_global generation:  0.0599668025970459
r_  generation:  0.5081470012664795
local_output_nid generation:  0.030811786651611328
local_in_edges_tensor generation:  0.029419660568237305
mini_batch_src_global generation:  0.05801677703857422
r_  generation:  0.5039088726043701
local_output_nid generation:  0.030505657196044922
local_in_edges_tensor generation:  0.029863357543945312
mini_batch_src_global generation:  0.05950570106506348
r_  generation:  0.5038084983825684
----------------------check_connections_block total spend ----------------------------- 23.524113655090332
generate_one_block  0.6984264850616455
generate_one_block  0.6784183979034424
generate_one_block  0.6697266101837158
generate_one_block  0.6681675910949707
generate_one_block  0.78952956199646
generate_one_block  0.6870753765106201
generate_one_block  0.680976390838623
generate_one_block  0.6807007789611816
generate_one_block  0.6813046932220459
generate_one_block  0.6831381320953369
generate_one_block  0.6877071857452393
generate_one_block  0.6796331405639648
generate_one_block  0.6763510704040527
generate_one_block  0.6825666427612305
generate_one_block  0.6868877410888672
generate_one_block  0.6849336624145508
generate_one_block  0.6765854358673096
generate_one_block  0.6712896823883057
generate_one_block  0.6743803024291992
generate_one_block  0.6844744682312012
generate_one_block  0.6907455921173096
generate_one_block  0.6889312267303467
generate_one_block  0.6870486736297607
generate_one_block  0.68182373046875
generate_one_block  0.6998653411865234
generate_one_block  0.6902377605438232
generate_one_block  0.6922497749328613
generate_one_block  0.6768815517425537
generate_one_block  0.6745991706848145
generate_one_block  0.6761841773986816
generate_one_block  0.6836297512054443
generate_one_block  0.678558349609375
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.13175296783447266  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

connection checking time:  32.56705665588379
block generation total time  30.041992664337158
average batch blocks generation time:  0.9388122707605362
block dataloader generation time/epoch 65.8236517906189
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.1095585823059082  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 21.297125816345215  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10890340805053711  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.476871490478516  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.1090850830078125  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.732877254486084  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10874652862548828  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.231656551361084  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10894632339477539  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.643024444580078  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10915851593017578  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.87781572341919  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10948991775512695  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 21.08919668197632  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10927629470825195  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 21.121235370635986  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10909843444824219  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.891436100006104  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10915040969848633  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.948270797729492  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10937166213989258  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.72754955291748  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10919857025146484  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.598426818847656  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10895061492919922  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.446972370147705  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10924720764160156  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.893717765808105  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10851192474365234  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.27361249923706  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10935163497924805  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.803035736083984  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10922908782958984  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.662389278411865  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10873603820800781  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.03379774093628  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10901832580566406  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.66628932952881  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10915756225585938  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.582079887390137  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10954856872558594  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 21.068435668945312  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10968637466430664  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 21.059083938598633  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10928821563720703  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.978543281555176  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10907459259033203  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.74230194091797  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10918092727661133  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.914650917053223  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10954570770263672  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 21.259809970855713  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.1096181869506836  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 21.27923583984375  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10879659652709961  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.182849407196045  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10921382904052734  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.78700351715088  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10910987854003906  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.678051471710205  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10935592651367188  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.897168159484863  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.1091451644897461  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.60600185394287  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03723342716693878 |0.02237815409898758 |0.6316218823194504 |9.594112634658813e-05 |1.1979113146662712 |0.009136438369750977 |
----------------------------------------------------------pseudo_mini_loss sum 1.3485729694366455
Total (block generation + training)time/epoch 126.62357858816783
Training time/epoch 60.5247061252594
Training time without block to device /epoch 59.8086051940918
Training time without total dataloading part /epoch 58.55726885795593
load block tensor time/epoch 1.191469669342041
block to device time/epoch 0.7161009311676025
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 21 |
Number of nodes for computation during this epoch:  9157512
Number of first layer input nodes during this epoch:  4806098
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.13077306747436523  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02495098114013672
random selection method range initialization spend 0.005356550216674805
time for parepare:  0.021240234375
local_output_nid generation:  0.0013916492462158203
local_in_edges_tensor generation:  0.007574558258056641
mini_batch_src_global generation:  0.001619100570678711
r_  generation:  0.010840892791748047
local_output_nid generation:  0.0016319751739501953
local_in_edges_tensor generation:  0.0010445117950439453
mini_batch_src_global generation:  0.0014655590057373047
r_  generation:  0.01119375228881836
local_output_nid generation:  0.0016186237335205078
local_in_edges_tensor generation:  0.0009913444519042969
mini_batch_src_global generation:  0.0011522769927978516
r_  generation:  0.010187625885009766
local_output_nid generation:  0.0016186237335205078
local_in_edges_tensor generation:  0.0009233951568603516
mini_batch_src_global generation:  0.0010921955108642578
r_  generation:  0.009970664978027344
local_output_nid generation:  0.0015799999237060547
local_in_edges_tensor generation:  0.0009057521820068359
mini_batch_src_global generation:  0.00109100341796875
r_  generation:  0.010078668594360352
local_output_nid generation:  0.0015659332275390625
local_in_edges_tensor generation:  0.0008966922760009766
mini_batch_src_global generation:  0.0011157989501953125
r_  generation:  0.010338068008422852
local_output_nid generation:  0.0015587806701660156
local_in_edges_tensor generation:  0.0009021759033203125
mini_batch_src_global generation:  0.0012316703796386719
r_  generation:  0.010661125183105469
local_output_nid generation:  0.001575469970703125
local_in_edges_tensor generation:  0.0008866786956787109
mini_batch_src_global generation:  0.0011143684387207031
r_  generation:  0.01022028923034668
local_output_nid generation:  0.0015683174133300781
local_in_edges_tensor generation:  0.0008933544158935547
mini_batch_src_global generation:  0.001100301742553711
r_  generation:  0.010473012924194336
local_output_nid generation:  0.0015764236450195312
local_in_edges_tensor generation:  0.0008733272552490234
mini_batch_src_global generation:  0.0011646747589111328
r_  generation:  0.010754108428955078
local_output_nid generation:  0.0015780925750732422
local_in_edges_tensor generation:  0.0008821487426757812
mini_batch_src_global generation:  0.0011267662048339844
r_  generation:  0.010512351989746094
local_output_nid generation:  0.001575469970703125
local_in_edges_tensor generation:  0.0008800029754638672
mini_batch_src_global generation:  0.0011067390441894531
r_  generation:  0.010564804077148438
local_output_nid generation:  0.0015711784362792969
local_in_edges_tensor generation:  0.0008695125579833984
mini_batch_src_global generation:  0.0011391639709472656
r_  generation:  0.010533332824707031
local_output_nid generation:  0.0015769004821777344
local_in_edges_tensor generation:  0.0008869171142578125
mini_batch_src_global generation:  0.0011250972747802734
r_  generation:  0.010468244552612305
local_output_nid generation:  0.001566171646118164
local_in_edges_tensor generation:  0.00086212158203125
mini_batch_src_global generation:  0.0010960102081298828
r_  generation:  0.010349750518798828
local_output_nid generation:  0.0016109943389892578
local_in_edges_tensor generation:  0.0009062290191650391
mini_batch_src_global generation:  0.0011413097381591797
r_  generation:  0.010406494140625
local_output_nid generation:  0.001562356948852539
local_in_edges_tensor generation:  0.000858306884765625
mini_batch_src_global generation:  0.0011582374572753906
r_  generation:  0.010685920715332031
local_output_nid generation:  0.0015819072723388672
local_in_edges_tensor generation:  0.0008366107940673828
mini_batch_src_global generation:  0.0010974407196044922
r_  generation:  0.010240793228149414
local_output_nid generation:  0.0015566349029541016
local_in_edges_tensor generation:  0.0008478164672851562
mini_batch_src_global generation:  0.0011544227600097656
r_  generation:  0.010697603225708008
local_output_nid generation:  0.0015876293182373047
local_in_edges_tensor generation:  0.0008592605590820312
mini_batch_src_global generation:  0.0011472702026367188
r_  generation:  0.010502815246582031
local_output_nid generation:  0.0015785694122314453
local_in_edges_tensor generation:  0.0008554458618164062
mini_batch_src_global generation:  0.0010848045349121094
r_  generation:  0.01025533676147461
local_output_nid generation:  0.0015687942504882812
local_in_edges_tensor generation:  0.0008547306060791016
mini_batch_src_global generation:  0.0010950565338134766
r_  generation:  0.010322332382202148
local_output_nid generation:  0.00156402587890625
local_in_edges_tensor generation:  0.0008637905120849609
mini_batch_src_global generation:  0.0011098384857177734
r_  generation:  0.010482072830200195
local_output_nid generation:  0.0015537738800048828
local_in_edges_tensor generation:  0.0008409023284912109
mini_batch_src_global generation:  0.0011184215545654297
r_  generation:  0.010673284530639648
local_output_nid generation:  0.0015614032745361328
local_in_edges_tensor generation:  0.0008985996246337891
mini_batch_src_global generation:  0.00110626220703125
r_  generation:  0.009936332702636719
local_output_nid generation:  0.0015668869018554688
local_in_edges_tensor generation:  0.0008311271667480469
mini_batch_src_global generation:  0.0011610984802246094
r_  generation:  0.011083126068115234
local_output_nid generation:  0.0015537738800048828
local_in_edges_tensor generation:  0.0009584426879882812
mini_batch_src_global generation:  0.0011115074157714844
r_  generation:  0.010390043258666992
local_output_nid generation:  0.0015532970428466797
local_in_edges_tensor generation:  0.0009248256683349609
mini_batch_src_global generation:  0.0011823177337646484
r_  generation:  0.010339736938476562
local_output_nid generation:  0.0015568733215332031
local_in_edges_tensor generation:  0.0008933544158935547
mini_batch_src_global generation:  0.0010886192321777344
r_  generation:  0.010396957397460938
local_output_nid generation:  0.0015552043914794922
local_in_edges_tensor generation:  0.000919342041015625
mini_batch_src_global generation:  0.0011665821075439453
r_  generation:  0.010457515716552734
local_output_nid generation:  0.0015578269958496094
local_in_edges_tensor generation:  0.0009243488311767578
mini_batch_src_global generation:  0.0011775493621826172
r_  generation:  0.010665655136108398
local_output_nid generation:  0.0015714168548583984
local_in_edges_tensor generation:  0.0008757114410400391
mini_batch_src_global generation:  0.001115560531616211
r_  generation:  0.01031041145324707
----------------------check_connections_block total spend ----------------------------- 0.5730538368225098
generate_one_block  0.02097916603088379
generate_one_block  0.021673202514648438
generate_one_block  0.01927471160888672
generate_one_block  0.018563270568847656
generate_one_block  0.01851797103881836
generate_one_block  0.018522024154663086
generate_one_block  0.019423484802246094
generate_one_block  0.018146991729736328
generate_one_block  0.018968582153320312
generate_one_block  0.01940321922302246
generate_one_block  0.018790483474731445
generate_one_block  0.021491527557373047
generate_one_block  0.019847869873046875
generate_one_block  0.020815372467041016
generate_one_block  0.01861739158630371
generate_one_block  0.018696308135986328
generate_one_block  0.019357681274414062
generate_one_block  0.018102645874023438
generate_one_block  0.01942300796508789
generate_one_block  0.01849675178527832
generate_one_block  0.018430709838867188
generate_one_block  0.018671751022338867
generate_one_block  0.018720626831054688
generate_one_block  0.019162416458129883
generate_one_block  0.017979860305786133
generate_one_block  0.01966381072998047
generate_one_block  0.01856374740600586
generate_one_block  0.018646955490112305
generate_one_block  0.018651962280273438
generate_one_block  0.018886089324951172
generate_one_block  0.019265174865722656
generate_one_block  0.017917871475219727
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04144549369812012
gen group dst list time:  0.02140641212463379
time for parepare:  0.02039361000061035
local_output_nid generation:  0.006485700607299805
local_in_edges_tensor generation:  0.01950812339782715
mini_batch_src_global generation:  0.016948223114013672
r_  generation:  0.16117429733276367
local_output_nid generation:  0.009234428405761719
local_in_edges_tensor generation:  0.012297630310058594
mini_batch_src_global generation:  0.022087574005126953
r_  generation:  0.16829371452331543
local_output_nid generation:  0.009230852127075195
local_in_edges_tensor generation:  0.03348994255065918
mini_batch_src_global generation:  0.020072221755981445
r_  generation:  0.1694645881652832
local_output_nid generation:  0.009550809860229492
local_in_edges_tensor generation:  0.008998870849609375
mini_batch_src_global generation:  0.021357059478759766
r_  generation:  0.1720750331878662
local_output_nid generation:  0.009641647338867188
local_in_edges_tensor generation:  0.012192010879516602
mini_batch_src_global generation:  0.022559165954589844
r_  generation:  0.18066930770874023
local_output_nid generation:  0.00959157943725586
local_in_edges_tensor generation:  0.011932373046875
mini_batch_src_global generation:  0.022450685501098633
r_  generation:  0.17888879776000977
local_output_nid generation:  0.009493112564086914
local_in_edges_tensor generation:  0.01266026496887207
mini_batch_src_global generation:  0.024453401565551758
r_  generation:  0.18733644485473633
local_output_nid generation:  0.009091615676879883
local_in_edges_tensor generation:  0.009328842163085938
mini_batch_src_global generation:  0.022629737854003906
r_  generation:  0.17678070068359375
local_output_nid generation:  0.009221792221069336
local_in_edges_tensor generation:  0.012290716171264648
mini_batch_src_global generation:  0.023920297622680664
r_  generation:  0.18360590934753418
local_output_nid generation:  0.00971078872680664
local_in_edges_tensor generation:  0.010999917984008789
mini_batch_src_global generation:  0.024986743927001953
r_  generation:  0.18911409378051758
local_output_nid generation:  0.009656906127929688
local_in_edges_tensor generation:  0.011748313903808594
mini_batch_src_global generation:  0.023967981338500977
r_  generation:  0.18946290016174316
local_output_nid generation:  0.009607791900634766
local_in_edges_tensor generation:  0.00911402702331543
mini_batch_src_global generation:  0.02314138412475586
r_  generation:  0.18125271797180176
local_output_nid generation:  0.009670019149780273
local_in_edges_tensor generation:  0.01101827621459961
mini_batch_src_global generation:  0.024480104446411133
r_  generation:  0.18746685981750488
local_output_nid generation:  0.009629249572753906
local_in_edges_tensor generation:  0.009287357330322266
mini_batch_src_global generation:  0.023276090621948242
r_  generation:  0.1814563274383545
local_output_nid generation:  0.009380102157592773
local_in_edges_tensor generation:  0.009397745132446289
mini_batch_src_global generation:  0.022826433181762695
r_  generation:  0.1792147159576416
local_output_nid generation:  0.009583234786987305
local_in_edges_tensor generation:  0.009203195571899414
mini_batch_src_global generation:  0.022826194763183594
r_  generation:  0.18138718605041504
local_output_nid generation:  0.009781837463378906
local_in_edges_tensor generation:  0.01231241226196289
mini_batch_src_global generation:  0.024542808532714844
r_  generation:  0.18851184844970703
local_output_nid generation:  0.009408235549926758
local_in_edges_tensor generation:  0.009274721145629883
mini_batch_src_global generation:  0.022909879684448242
r_  generation:  0.17824006080627441
local_output_nid generation:  0.009903430938720703
local_in_edges_tensor generation:  0.009649515151977539
mini_batch_src_global generation:  0.024165630340576172
r_  generation:  0.18749761581420898
local_output_nid generation:  0.009709358215332031
local_in_edges_tensor generation:  0.009119987487792969
mini_batch_src_global generation:  0.023298263549804688
r_  generation:  0.18150758743286133
local_output_nid generation:  0.009463310241699219
local_in_edges_tensor generation:  0.011113166809082031
mini_batch_src_global generation:  0.022730112075805664
r_  generation:  0.18332672119140625
local_output_nid generation:  0.009607553482055664
local_in_edges_tensor generation:  0.00997471809387207
mini_batch_src_global generation:  0.02352595329284668
r_  generation:  0.18747162818908691
local_output_nid generation:  0.009775876998901367
local_in_edges_tensor generation:  0.009729862213134766
mini_batch_src_global generation:  0.023915767669677734
r_  generation:  0.18832111358642578
local_output_nid generation:  0.009855270385742188
local_in_edges_tensor generation:  0.010489463806152344
mini_batch_src_global generation:  0.02426743507385254
r_  generation:  0.19126677513122559
local_output_nid generation:  0.009426116943359375
local_in_edges_tensor generation:  0.010009527206420898
mini_batch_src_global generation:  0.022780895233154297
r_  generation:  0.17861032485961914
local_output_nid generation:  0.010030984878540039
local_in_edges_tensor generation:  0.010418176651000977
mini_batch_src_global generation:  0.025180578231811523
r_  generation:  0.19388055801391602
local_output_nid generation:  0.009656190872192383
local_in_edges_tensor generation:  0.0093231201171875
mini_batch_src_global generation:  0.023363828659057617
r_  generation:  0.18317675590515137
local_output_nid generation:  0.009569644927978516
local_in_edges_tensor generation:  0.009093046188354492
mini_batch_src_global generation:  0.0228273868560791
r_  generation:  0.18413257598876953
local_output_nid generation:  0.00955343246459961
local_in_edges_tensor generation:  0.009636163711547852
mini_batch_src_global generation:  0.02318406105041504
r_  generation:  0.1850426197052002
local_output_nid generation:  0.009627819061279297
local_in_edges_tensor generation:  0.009255409240722656
mini_batch_src_global generation:  0.023671865463256836
r_  generation:  0.18503904342651367
local_output_nid generation:  0.009908676147460938
local_in_edges_tensor generation:  0.009585380554199219
mini_batch_src_global generation:  0.0239408016204834
r_  generation:  0.19080805778503418
local_output_nid generation:  0.009420633316040039
local_in_edges_tensor generation:  0.010913848876953125
mini_batch_src_global generation:  0.02262139320373535
r_  generation:  0.17695093154907227
----------------------check_connections_block total spend ----------------------------- 8.556902408599854
generate_one_block  0.23853135108947754
generate_one_block  0.23880386352539062
generate_one_block  0.24009919166564941
generate_one_block  0.24127578735351562
generate_one_block  0.25957393646240234
generate_one_block  0.24462532997131348
generate_one_block  0.25629663467407227
generate_one_block  0.24086999893188477
generate_one_block  0.2498307228088379
generate_one_block  0.2599184513092041
generate_one_block  0.25244641304016113
generate_one_block  0.24251365661621094
generate_one_block  0.25249576568603516
generate_one_block  0.2420213222503662
generate_one_block  0.24514150619506836
generate_one_block  0.24198293685913086
generate_one_block  0.2518949508666992
generate_one_block  0.2388463020324707
generate_one_block  0.25455594062805176
generate_one_block  0.24909424781799316
generate_one_block  0.24330925941467285
generate_one_block  0.25168538093566895
generate_one_block  0.25089406967163086
generate_one_block  0.25633907318115234
generate_one_block  0.23986268043518066
generate_one_block  0.25786709785461426
generate_one_block  0.24417781829833984
generate_one_block  0.24340271949768066
generate_one_block  0.2486436367034912
generate_one_block  0.2503213882446289
generate_one_block  0.2561459541320801
generate_one_block  0.23575782775878906
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.038043975830078125
gen group dst list time:  0.11129975318908691
time for parepare:  0.02039027214050293
local_output_nid generation:  0.02598285675048828
local_in_edges_tensor generation:  0.05318117141723633
mini_batch_src_global generation:  0.04802513122558594
r_  generation:  0.48389506340026855
local_output_nid generation:  0.03186464309692383
local_in_edges_tensor generation:  0.038249969482421875
mini_batch_src_global generation:  0.05920052528381348
r_  generation:  0.48537302017211914
local_output_nid generation:  0.03167223930358887
local_in_edges_tensor generation:  0.03161144256591797
mini_batch_src_global generation:  0.058556318283081055
r_  generation:  0.4950590133666992
local_output_nid generation:  0.03241777420043945
local_in_edges_tensor generation:  0.032355308532714844
mini_batch_src_global generation:  0.05919933319091797
r_  generation:  0.4950597286224365
local_output_nid generation:  0.03205227851867676
local_in_edges_tensor generation:  0.032778024673461914
mini_batch_src_global generation:  0.05832266807556152
r_  generation:  0.5005874633789062
local_output_nid generation:  0.03166604042053223
local_in_edges_tensor generation:  0.029637813568115234
mini_batch_src_global generation:  0.06049680709838867
r_  generation:  0.49454498291015625
local_output_nid generation:  0.030345678329467773
local_in_edges_tensor generation:  0.03827238082885742
mini_batch_src_global generation:  0.06124424934387207
r_  generation:  0.5036101341247559
local_output_nid generation:  0.029703140258789062
local_in_edges_tensor generation:  0.029870986938476562
mini_batch_src_global generation:  0.060217857360839844
r_  generation:  0.49208879470825195
local_output_nid generation:  0.029834747314453125
local_in_edges_tensor generation:  0.0328068733215332
mini_batch_src_global generation:  0.058777809143066406
r_  generation:  0.499208927154541
local_output_nid generation:  0.03213047981262207
local_in_edges_tensor generation:  0.03787970542907715
mini_batch_src_global generation:  0.062477827072143555
r_  generation:  0.5012574195861816
local_output_nid generation:  0.030595064163208008
local_in_edges_tensor generation:  0.02927708625793457
mini_batch_src_global generation:  0.061406612396240234
r_  generation:  0.5025827884674072
local_output_nid generation:  0.029976367950439453
local_in_edges_tensor generation:  0.029358863830566406
mini_batch_src_global generation:  0.06011772155761719
r_  generation:  0.4963552951812744
local_output_nid generation:  0.03006744384765625
local_in_edges_tensor generation:  0.029276132583618164
mini_batch_src_global generation:  0.05932927131652832
r_  generation:  0.5013782978057861
local_output_nid generation:  0.02981734275817871
local_in_edges_tensor generation:  0.02932429313659668
mini_batch_src_global generation:  0.06038784980773926
r_  generation:  0.4960458278656006
local_output_nid generation:  0.029965639114379883
local_in_edges_tensor generation:  0.029657363891601562
mini_batch_src_global generation:  0.0590052604675293
r_  generation:  0.49842119216918945
local_output_nid generation:  0.02968597412109375
local_in_edges_tensor generation:  0.03134727478027344
mini_batch_src_global generation:  0.0605013370513916
r_  generation:  0.49727964401245117
local_output_nid generation:  0.030134201049804688
local_in_edges_tensor generation:  0.03149127960205078
mini_batch_src_global generation:  0.061418771743774414
r_  generation:  0.502112627029419
local_output_nid generation:  0.02971959114074707
local_in_edges_tensor generation:  0.0291748046875
mini_batch_src_global generation:  0.06084442138671875
r_  generation:  0.5008196830749512
local_output_nid generation:  0.030123472213745117
local_in_edges_tensor generation:  0.02916550636291504
mini_batch_src_global generation:  0.05870342254638672
r_  generation:  0.5005302429199219
local_output_nid generation:  0.029942035675048828
local_in_edges_tensor generation:  0.029558181762695312
mini_batch_src_global generation:  0.05962967872619629
r_  generation:  0.5013935565948486
local_output_nid generation:  0.029840469360351562
local_in_edges_tensor generation:  0.028760671615600586
mini_batch_src_global generation:  0.0576777458190918
r_  generation:  0.4978902339935303
local_output_nid generation:  0.029791593551635742
local_in_edges_tensor generation:  0.02879047393798828
mini_batch_src_global generation:  0.058681488037109375
r_  generation:  0.49858665466308594
local_output_nid generation:  0.029981613159179688
local_in_edges_tensor generation:  0.03154349327087402
mini_batch_src_global generation:  0.06032228469848633
r_  generation:  0.5061545372009277
local_output_nid generation:  0.030269384384155273
local_in_edges_tensor generation:  0.03145122528076172
mini_batch_src_global generation:  0.059535980224609375
r_  generation:  0.5052568912506104
local_output_nid generation:  0.029645204544067383
local_in_edges_tensor generation:  0.0304567813873291
mini_batch_src_global generation:  0.05769085884094238
r_  generation:  0.4973902702331543
local_output_nid generation:  0.03052353858947754
local_in_edges_tensor generation:  0.03099822998046875
mini_batch_src_global generation:  0.059319257736206055
r_  generation:  0.5081536769866943
local_output_nid generation:  0.030260801315307617
local_in_edges_tensor generation:  0.03103947639465332
mini_batch_src_global generation:  0.05830693244934082
r_  generation:  0.5039174556732178
local_output_nid generation:  0.029877662658691406
local_in_edges_tensor generation:  0.03074812889099121
mini_batch_src_global generation:  0.05912280082702637
r_  generation:  0.49840283393859863
local_output_nid generation:  0.029960155487060547
local_in_edges_tensor generation:  0.030687570571899414
mini_batch_src_global generation:  0.057813167572021484
r_  generation:  0.5010833740234375
local_output_nid generation:  0.03031611442565918
local_in_edges_tensor generation:  0.03128671646118164
mini_batch_src_global generation:  0.059635162353515625
r_  generation:  0.4988124370574951
local_output_nid generation:  0.030542850494384766
local_in_edges_tensor generation:  0.03198719024658203
mini_batch_src_global generation:  0.05844473838806152
r_  generation:  0.5161299705505371
local_output_nid generation:  0.0301516056060791
local_in_edges_tensor generation:  0.03346610069274902
mini_batch_src_global generation:  0.05901622772216797
r_  generation:  0.49352598190307617
----------------------check_connections_block total spend ----------------------------- 23.30793046951294
generate_one_block  0.6797289848327637
generate_one_block  0.6780600547790527
generate_one_block  0.6727471351623535
generate_one_block  0.6816737651824951
generate_one_block  0.7634067535400391
generate_one_block  0.6753876209259033
generate_one_block  0.6776447296142578
generate_one_block  0.673048734664917
generate_one_block  0.6728837490081787
generate_one_block  0.680253267288208
generate_one_block  0.6800975799560547
generate_one_block  0.6741824150085449
generate_one_block  0.6779687404632568
generate_one_block  0.6779534816741943
generate_one_block  0.6801941394805908
generate_one_block  0.6798899173736572
generate_one_block  0.6817367076873779
generate_one_block  0.6787128448486328
generate_one_block  0.6819860935211182
generate_one_block  0.683556079864502
generate_one_block  0.6768321990966797
generate_one_block  0.6816959381103516
generate_one_block  0.6817045211791992
generate_one_block  0.6854231357574463
generate_one_block  0.687598466873169
generate_one_block  0.6838071346282959
generate_one_block  0.684013843536377
generate_one_block  0.6731700897216797
generate_one_block  0.679347038269043
generate_one_block  0.685640811920166
generate_one_block  0.6900148391723633
generate_one_block  0.6715614795684814
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.13077306747436523  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

connection checking time:  31.864832878112793
block generation total time  29.751147508621216
average batch blocks generation time:  0.929723359644413
block dataloader generation time/epoch 65.78468539164616
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10904169082641602  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.46672296524048  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10912847518920898  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.58422040939331  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10913658142089844  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.46738338470459  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10912561416625977  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.6401309967041  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10932159423828125  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.750032424926758  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.1089940071105957  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.70599126815796  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10926294326782227  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 21.225718021392822  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10896778106689453  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.565089225769043  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10914039611816406  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.88990879058838  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10969734191894531  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 21.344616413116455  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10936403274536133  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 21.078611850738525  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10916709899902344  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.651206493377686  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.1095590591430664  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 21.07814073562622  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10901403427124023  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.606059074401855  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10922908782958984  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.519986629486084  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10902595520019531  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.642289638519287  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10950517654418945  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.95434284210205  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10888910293579102  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.428327560424805  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10946941375732422  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 21.077393531799316  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10924148559570312  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.675687313079834  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10893440246582031  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.608595848083496  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10919380187988281  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.861727237701416  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10925865173339844  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.888904094696045  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10948896408081055  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 21.172274112701416  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10883951187133789  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.353986263275146  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10952568054199219  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 21.30094575881958  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10936546325683594  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.76469087600708  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10902833938598633  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.641716957092285  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10904836654663086  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.808773517608643  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10954666137695312  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.934922695159912  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10964775085449219  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 21.183215141296387  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10871553421020508  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.297273635864258  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0343247652053833 |0.021795958280563354 |0.6331131607294083 |9.679049253463745e-05 |1.2044667303562164 |0.008432149887084961 |
----------------------------------------------------------pseudo_mini_loss sum 1.3282241821289062
Total (block generation + training)time/epoch 126.5750708763416
Training time/epoch 60.67562007904053
Training time without block to device /epoch 59.9781494140625
Training time without total dataloading part /epoch 58.814085960388184
load block tensor time/epoch 1.0983924865722656
block to device time/epoch 0.6974706649780273
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 22 |
Number of nodes for computation during this epoch:  9161719
Number of first layer input nodes during this epoch:  4807585
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.13049745559692383  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02433300018310547
random selection method range initialization spend 0.005294322967529297
time for parepare:  0.022246360778808594
local_output_nid generation:  0.0014443397521972656
local_in_edges_tensor generation:  0.006216526031494141
mini_batch_src_global generation:  0.0016887187957763672
r_  generation:  0.010242462158203125
local_output_nid generation:  0.0017046928405761719
local_in_edges_tensor generation:  0.0010378360748291016
mini_batch_src_global generation:  0.0016660690307617188
r_  generation:  0.010418415069580078
local_output_nid generation:  0.0016798973083496094
local_in_edges_tensor generation:  0.0009133815765380859
mini_batch_src_global generation:  0.0011894702911376953
r_  generation:  0.010108709335327148
local_output_nid generation:  0.0016009807586669922
local_in_edges_tensor generation:  0.0008952617645263672
mini_batch_src_global generation:  0.0011472702026367188
r_  generation:  0.009996891021728516
local_output_nid generation:  0.0015883445739746094
local_in_edges_tensor generation:  0.0008871555328369141
mini_batch_src_global generation:  0.0011396408081054688
r_  generation:  0.009874343872070312
local_output_nid generation:  0.0015747547149658203
local_in_edges_tensor generation:  0.0008664131164550781
mini_batch_src_global generation:  0.0011105537414550781
r_  generation:  0.009950876235961914
local_output_nid generation:  0.0015757083892822266
local_in_edges_tensor generation:  0.0008480548858642578
mini_batch_src_global generation:  0.0010998249053955078
r_  generation:  0.009918212890625
local_output_nid generation:  0.0015659332275390625
local_in_edges_tensor generation:  0.0008447170257568359
mini_batch_src_global generation:  0.0012056827545166016
r_  generation:  0.010263204574584961
local_output_nid generation:  0.0015740394592285156
local_in_edges_tensor generation:  0.0008111000061035156
mini_batch_src_global generation:  0.0011382102966308594
r_  generation:  0.010263204574584961
local_output_nid generation:  0.0015766620635986328
local_in_edges_tensor generation:  0.0008509159088134766
mini_batch_src_global generation:  0.0011239051818847656
r_  generation:  0.009805440902709961
local_output_nid generation:  0.0015759468078613281
local_in_edges_tensor generation:  0.0008389949798583984
mini_batch_src_global generation:  0.0011036396026611328
r_  generation:  0.010270118713378906
local_output_nid generation:  0.001566171646118164
local_in_edges_tensor generation:  0.0008449554443359375
mini_batch_src_global generation:  0.001125335693359375
r_  generation:  0.010544538497924805
local_output_nid generation:  0.0015625953674316406
local_in_edges_tensor generation:  0.0008254051208496094
mini_batch_src_global generation:  0.0011107921600341797
r_  generation:  0.010262727737426758
local_output_nid generation:  0.0015628337860107422
local_in_edges_tensor generation:  0.0008573532104492188
mini_batch_src_global generation:  0.0010917186737060547
r_  generation:  0.010062456130981445
local_output_nid generation:  0.001561880111694336
local_in_edges_tensor generation:  0.0008366107940673828
mini_batch_src_global generation:  0.001096963882446289
r_  generation:  0.009993553161621094
local_output_nid generation:  0.0015578269958496094
local_in_edges_tensor generation:  0.0008270740509033203
mini_batch_src_global generation:  0.0011262893676757812
r_  generation:  0.010370731353759766
local_output_nid generation:  0.0015590190887451172
local_in_edges_tensor generation:  0.0008287429809570312
mini_batch_src_global generation:  0.00112152099609375
r_  generation:  0.010181427001953125
local_output_nid generation:  0.0015454292297363281
local_in_edges_tensor generation:  0.0008215904235839844
mini_batch_src_global generation:  0.0012242794036865234
r_  generation:  0.01062631607055664
local_output_nid generation:  0.001569986343383789
local_in_edges_tensor generation:  0.0008344650268554688
mini_batch_src_global generation:  0.0011000633239746094
r_  generation:  0.01018977165222168
local_output_nid generation:  0.0015497207641601562
local_in_edges_tensor generation:  0.0008113384246826172
mini_batch_src_global generation:  0.0011951923370361328
r_  generation:  0.010541439056396484
local_output_nid generation:  0.0015439987182617188
local_in_edges_tensor generation:  0.0007910728454589844
mini_batch_src_global generation:  0.001123666763305664
r_  generation:  0.010285377502441406
local_output_nid generation:  0.001542806625366211
local_in_edges_tensor generation:  0.0008335113525390625
mini_batch_src_global generation:  0.0012292861938476562
r_  generation:  0.010479927062988281
local_output_nid generation:  0.0015494823455810547
local_in_edges_tensor generation:  0.0008318424224853516
mini_batch_src_global generation:  0.001123189926147461
r_  generation:  0.010425567626953125
local_output_nid generation:  0.0015473365783691406
local_in_edges_tensor generation:  0.0008406639099121094
mini_batch_src_global generation:  0.0010709762573242188
r_  generation:  0.010108709335327148
local_output_nid generation:  0.0015475749969482422
local_in_edges_tensor generation:  0.00081634521484375
mini_batch_src_global generation:  0.0011742115020751953
r_  generation:  0.010396242141723633
local_output_nid generation:  0.001556396484375
local_in_edges_tensor generation:  0.0008215904235839844
mini_batch_src_global generation:  0.0010833740234375
r_  generation:  0.010154962539672852
local_output_nid generation:  0.0015490055084228516
local_in_edges_tensor generation:  0.0008208751678466797
mini_batch_src_global generation:  0.001119852066040039
r_  generation:  0.010576963424682617
local_output_nid generation:  0.0015578269958496094
local_in_edges_tensor generation:  0.0008261203765869141
mini_batch_src_global generation:  0.0011260509490966797
r_  generation:  0.010240316390991211
local_output_nid generation:  0.001547098159790039
local_in_edges_tensor generation:  0.0010089874267578125
mini_batch_src_global generation:  0.001155853271484375
r_  generation:  0.010033607482910156
local_output_nid generation:  0.0015408992767333984
local_in_edges_tensor generation:  0.0008118152618408203
mini_batch_src_global generation:  0.0011303424835205078
r_  generation:  0.010641813278198242
local_output_nid generation:  0.0015635490417480469
local_in_edges_tensor generation:  0.00092315673828125
mini_batch_src_global generation:  0.0011353492736816406
r_  generation:  0.010063409805297852
local_output_nid generation:  0.0015408992767333984
local_in_edges_tensor generation:  0.0009195804595947266
mini_batch_src_global generation:  0.0011837482452392578
r_  generation:  0.010362625122070312
----------------------check_connections_block total spend ----------------------------- 0.5636978149414062
generate_one_block  0.02423858642578125
generate_one_block  0.02152276039123535
generate_one_block  0.020021677017211914
generate_one_block  0.019249916076660156
generate_one_block  0.01886272430419922
generate_one_block  0.0184326171875
generate_one_block  0.018346071243286133
generate_one_block  0.01910710334777832
generate_one_block  0.018634557723999023
generate_one_block  0.018027782440185547
generate_one_block  0.01880645751953125
generate_one_block  0.022404193878173828
generate_one_block  0.019881725311279297
generate_one_block  0.018570899963378906
generate_one_block  0.018114805221557617
generate_one_block  0.01867532730102539
generate_one_block  0.018378496170043945
generate_one_block  0.01910090446472168
generate_one_block  0.01877737045288086
generate_one_block  0.021650075912475586
generate_one_block  0.018900394439697266
generate_one_block  0.019054174423217773
generate_one_block  0.019309043884277344
generate_one_block  0.01829695701599121
generate_one_block  0.019075632095336914
generate_one_block  0.018535614013671875
generate_one_block  0.01891326904296875
generate_one_block  0.018607139587402344
generate_one_block  0.01805567741394043
generate_one_block  0.019415855407714844
generate_one_block  0.01827716827392578
generate_one_block  0.018680334091186523
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03799557685852051
gen group dst list time:  0.023828506469726562
time for parepare:  0.022228717803955078
local_output_nid generation:  0.006380558013916016
local_in_edges_tensor generation:  0.018515586853027344
mini_batch_src_global generation:  0.017818450927734375
r_  generation:  0.15999197959899902
local_output_nid generation:  0.009022712707519531
local_in_edges_tensor generation:  0.012346744537353516
mini_batch_src_global generation:  0.02232217788696289
r_  generation:  0.20024371147155762
local_output_nid generation:  0.009275436401367188
local_in_edges_tensor generation:  0.03588747978210449
mini_batch_src_global generation:  0.021727323532104492
r_  generation:  0.1759812831878662
local_output_nid generation:  0.009622573852539062
local_in_edges_tensor generation:  0.01056814193725586
mini_batch_src_global generation:  0.022759199142456055
r_  generation:  0.17883086204528809
local_output_nid generation:  0.009613513946533203
local_in_edges_tensor generation:  0.012250185012817383
mini_batch_src_global generation:  0.023122549057006836
r_  generation:  0.18165993690490723
local_output_nid generation:  0.009439945220947266
local_in_edges_tensor generation:  0.011937856674194336
mini_batch_src_global generation:  0.022838592529296875
r_  generation:  0.22096586227416992
local_output_nid generation:  0.010020256042480469
local_in_edges_tensor generation:  0.01012420654296875
mini_batch_src_global generation:  0.022890329360961914
r_  generation:  0.22552013397216797
local_output_nid generation:  0.009313106536865234
local_in_edges_tensor generation:  0.010857582092285156
mini_batch_src_global generation:  0.024922609329223633
r_  generation:  0.19322919845581055
local_output_nid generation:  0.009164094924926758
local_in_edges_tensor generation:  0.009963274002075195
mini_batch_src_global generation:  0.02524709701538086
r_  generation:  0.18448829650878906
local_output_nid generation:  0.009237051010131836
local_in_edges_tensor generation:  0.011879682540893555
mini_batch_src_global generation:  0.023433446884155273
r_  generation:  0.17453527450561523
local_output_nid generation:  0.009643793106079102
local_in_edges_tensor generation:  0.012193679809570312
mini_batch_src_global generation:  0.026967525482177734
r_  generation:  0.22945713996887207
local_output_nid generation:  0.012490272521972656
local_in_edges_tensor generation:  0.010264158248901367
mini_batch_src_global generation:  0.028729915618896484
r_  generation:  0.18633151054382324
local_output_nid generation:  0.009906530380249023
local_in_edges_tensor generation:  0.010274887084960938
mini_batch_src_global generation:  0.023375988006591797
r_  generation:  0.1823108196258545
local_output_nid generation:  0.009796142578125
local_in_edges_tensor generation:  0.010804414749145508
mini_batch_src_global generation:  0.023359298706054688
r_  generation:  0.18009471893310547
local_output_nid generation:  0.009650230407714844
local_in_edges_tensor generation:  0.009007692337036133
mini_batch_src_global generation:  0.022655010223388672
r_  generation:  0.17874860763549805
local_output_nid generation:  0.010000467300415039
local_in_edges_tensor generation:  0.010915040969848633
mini_batch_src_global generation:  0.023688554763793945
r_  generation:  0.18444085121154785
local_output_nid generation:  0.009803056716918945
local_in_edges_tensor generation:  0.00923919677734375
mini_batch_src_global generation:  0.023207426071166992
r_  generation:  0.1826322078704834
local_output_nid generation:  0.010222434997558594
local_in_edges_tensor generation:  0.009714365005493164
mini_batch_src_global generation:  0.025226593017578125
r_  generation:  0.18927812576293945
local_output_nid generation:  0.009860038757324219
local_in_edges_tensor generation:  0.009254217147827148
mini_batch_src_global generation:  0.024257183074951172
r_  generation:  0.18444395065307617
local_output_nid generation:  0.010097503662109375
local_in_edges_tensor generation:  0.012354850769042969
mini_batch_src_global generation:  0.023845434188842773
r_  generation:  0.18691229820251465
local_output_nid generation:  0.009980440139770508
local_in_edges_tensor generation:  0.010972261428833008
mini_batch_src_global generation:  0.024794816970825195
r_  generation:  0.18651437759399414
local_output_nid generation:  0.009946823120117188
local_in_edges_tensor generation:  0.009448528289794922
mini_batch_src_global generation:  0.0236663818359375
r_  generation:  0.1839590072631836
local_output_nid generation:  0.010083436965942383
local_in_edges_tensor generation:  0.009411334991455078
mini_batch_src_global generation:  0.023739099502563477
r_  generation:  0.18970060348510742
local_output_nid generation:  0.009675979614257812
local_in_edges_tensor generation:  0.00913858413696289
mini_batch_src_global generation:  0.023494482040405273
r_  generation:  0.18024802207946777
local_output_nid generation:  0.01006174087524414
local_in_edges_tensor generation:  0.009332656860351562
mini_batch_src_global generation:  0.023312091827392578
r_  generation:  0.18726563453674316
local_output_nid generation:  0.009789466857910156
local_in_edges_tensor generation:  0.009005069732666016
mini_batch_src_global generation:  0.023853302001953125
r_  generation:  0.18603157997131348
local_output_nid generation:  0.010002613067626953
local_in_edges_tensor generation:  0.009458780288696289
mini_batch_src_global generation:  0.023541688919067383
r_  generation:  0.18579888343811035
local_output_nid generation:  0.00998067855834961
local_in_edges_tensor generation:  0.012594223022460938
mini_batch_src_global generation:  0.024844884872436523
r_  generation:  0.19062185287475586
local_output_nid generation:  0.009694814682006836
local_in_edges_tensor generation:  0.016145944595336914
mini_batch_src_global generation:  0.02291107177734375
r_  generation:  0.18256115913391113
local_output_nid generation:  0.010208368301391602
local_in_edges_tensor generation:  0.009583234786987305
mini_batch_src_global generation:  0.025097370147705078
r_  generation:  0.19503378868103027
local_output_nid generation:  0.011417865753173828
local_in_edges_tensor generation:  0.010039567947387695
mini_batch_src_global generation:  0.022875070571899414
r_  generation:  0.18285512924194336
local_output_nid generation:  0.01001429557800293
local_in_edges_tensor generation:  0.013757705688476562
mini_batch_src_global generation:  0.023455142974853516
r_  generation:  0.18722081184387207
----------------------check_connections_block total spend ----------------------------- 8.812233209609985
generate_one_block  0.2580993175506592
generate_one_block  0.24120378494262695
generate_one_block  0.2487649917602539
generate_one_block  0.2540459632873535
generate_one_block  0.2637917995452881
generate_one_block  0.24579358100891113
generate_one_block  0.24549365043640137
generate_one_block  0.26020050048828125
generate_one_block  0.2486276626586914
generate_one_block  0.2443692684173584
generate_one_block  0.2541999816894531
generate_one_block  0.26056742668151855
generate_one_block  0.251863956451416
generate_one_block  0.24434328079223633
generate_one_block  0.24177813529968262
generate_one_block  0.25394511222839355
generate_one_block  0.24352407455444336
generate_one_block  0.25791239738464355
generate_one_block  0.2506287097930908
generate_one_block  0.25713586807250977
generate_one_block  0.2517359256744385
generate_one_block  0.24932384490966797
generate_one_block  0.25557732582092285
generate_one_block  0.2518150806427002
generate_one_block  0.2526214122772217
generate_one_block  0.25123119354248047
generate_one_block  0.24964189529418945
generate_one_block  0.25188350677490234
generate_one_block  0.23885583877563477
generate_one_block  0.25809407234191895
generate_one_block  0.24166059494018555
generate_one_block  0.24880695343017578
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.040997982025146484
gen group dst list time:  0.11409378051757812
time for parepare:  0.020310401916503906
local_output_nid generation:  0.025741100311279297
local_in_edges_tensor generation:  0.05604100227355957
mini_batch_src_global generation:  0.04858040809631348
r_  generation:  0.48403477668762207
local_output_nid generation:  0.031568050384521484
local_in_edges_tensor generation:  0.03762364387512207
mini_batch_src_global generation:  0.058960676193237305
r_  generation:  0.48358798027038574
local_output_nid generation:  0.03149986267089844
local_in_edges_tensor generation:  0.03748822212219238
mini_batch_src_global generation:  0.059819698333740234
r_  generation:  0.5100431442260742
local_output_nid generation:  0.03148174285888672
local_in_edges_tensor generation:  0.03565168380737305
mini_batch_src_global generation:  0.05838823318481445
r_  generation:  0.49246668815612793
local_output_nid generation:  0.03217911720275879
local_in_edges_tensor generation:  0.03803586959838867
mini_batch_src_global generation:  0.060235023498535156
r_  generation:  0.5031580924987793
local_output_nid generation:  0.031508684158325195
local_in_edges_tensor generation:  0.032351016998291016
mini_batch_src_global generation:  0.06150197982788086
r_  generation:  0.4938967227935791
local_output_nid generation:  0.03055739402770996
local_in_edges_tensor generation:  0.033605098724365234
mini_batch_src_global generation:  0.05831766128540039
r_  generation:  0.5013363361358643
local_output_nid generation:  0.030211210250854492
local_in_edges_tensor generation:  0.03784465789794922
mini_batch_src_global generation:  0.06202435493469238
r_  generation:  0.5032124519348145
local_output_nid generation:  0.029937744140625
local_in_edges_tensor generation:  0.032704830169677734
mini_batch_src_global generation:  0.058937788009643555
r_  generation:  0.5011086463928223
local_output_nid generation:  0.02961444854736328
local_in_edges_tensor generation:  0.032080650329589844
mini_batch_src_global generation:  0.05967903137207031
r_  generation:  0.49229001998901367
local_output_nid generation:  0.029655933380126953
local_in_edges_tensor generation:  0.0378415584564209
mini_batch_src_global generation:  0.0601353645324707
r_  generation:  0.5091016292572021
local_output_nid generation:  0.031101465225219727
local_in_edges_tensor generation:  0.03995537757873535
mini_batch_src_global generation:  0.06034278869628906
r_  generation:  0.49595189094543457
local_output_nid generation:  0.029784440994262695
local_in_edges_tensor generation:  0.031008481979370117
mini_batch_src_global generation:  0.060898542404174805
r_  generation:  0.4986851215362549
local_output_nid generation:  0.029406309127807617
local_in_edges_tensor generation:  0.03206181526184082
mini_batch_src_global generation:  0.059162139892578125
r_  generation:  0.48851823806762695
local_output_nid generation:  0.029451370239257812
local_in_edges_tensor generation:  0.030580520629882812
mini_batch_src_global generation:  0.060028076171875
r_  generation:  0.4955787658691406
local_output_nid generation:  0.029525279998779297
local_in_edges_tensor generation:  0.03465747833251953
mini_batch_src_global generation:  0.06364941596984863
r_  generation:  0.5012087821960449
local_output_nid generation:  0.029423236846923828
local_in_edges_tensor generation:  0.02957463264465332
mini_batch_src_global generation:  0.0588529109954834
r_  generation:  0.5099093914031982
local_output_nid generation:  0.03202533721923828
local_in_edges_tensor generation:  0.03294205665588379
mini_batch_src_global generation:  0.06017589569091797
r_  generation:  0.49687910079956055
local_output_nid generation:  0.030137062072753906
local_in_edges_tensor generation:  0.03183746337890625
mini_batch_src_global generation:  0.05911731719970703
r_  generation:  0.4963409900665283
local_output_nid generation:  0.030458450317382812
local_in_edges_tensor generation:  0.02977466583251953
mini_batch_src_global generation:  0.06026268005371094
r_  generation:  0.4942319393157959
local_output_nid generation:  0.030288219451904297
local_in_edges_tensor generation:  0.0312039852142334
mini_batch_src_global generation:  0.059308767318725586
r_  generation:  0.49683403968811035
local_output_nid generation:  0.030390501022338867
local_in_edges_tensor generation:  0.031705379486083984
mini_batch_src_global generation:  0.06018519401550293
r_  generation:  0.4939725399017334
local_output_nid generation:  0.03058147430419922
local_in_edges_tensor generation:  0.041422128677368164
mini_batch_src_global generation:  0.060848236083984375
r_  generation:  0.5115311145782471
local_output_nid generation:  0.03008866310119629
local_in_edges_tensor generation:  0.0297548770904541
mini_batch_src_global generation:  0.06003379821777344
r_  generation:  0.4966390132904053
local_output_nid generation:  0.030763626098632812
local_in_edges_tensor generation:  0.03071284294128418
mini_batch_src_global generation:  0.058745622634887695
r_  generation:  0.49878954887390137
local_output_nid generation:  0.030096054077148438
local_in_edges_tensor generation:  0.030376434326171875
mini_batch_src_global generation:  0.06025505065917969
r_  generation:  0.49143362045288086
local_output_nid generation:  0.03053116798400879
local_in_edges_tensor generation:  0.029878854751586914
mini_batch_src_global generation:  0.05831503868103027
r_  generation:  0.4969954490661621
local_output_nid generation:  0.030267715454101562
local_in_edges_tensor generation:  0.03121352195739746
mini_batch_src_global generation:  0.06010913848876953
r_  generation:  0.49699878692626953
local_output_nid generation:  0.030139446258544922
local_in_edges_tensor generation:  0.029287099838256836
mini_batch_src_global generation:  0.05829262733459473
r_  generation:  0.49512457847595215
local_output_nid generation:  0.030857086181640625
local_in_edges_tensor generation:  0.03103017807006836
mini_batch_src_global generation:  0.06233692169189453
r_  generation:  0.4979887008666992
local_output_nid generation:  0.030313730239868164
local_in_edges_tensor generation:  0.030944108963012695
mini_batch_src_global generation:  0.05837440490722656
r_  generation:  0.5028600692749023
local_output_nid generation:  0.030551433563232422
local_in_edges_tensor generation:  0.031494855880737305
mini_batch_src_global generation:  0.06052398681640625
r_  generation:  0.49545860290527344
----------------------check_connections_block total spend ----------------------------- 23.382601976394653
generate_one_block  0.6942145824432373
generate_one_block  0.6705958843231201
generate_one_block  0.6733415126800537
generate_one_block  0.6773519515991211
generate_one_block  0.7806398868560791
generate_one_block  0.6736252307891846
generate_one_block  0.6746997833251953
generate_one_block  0.687483549118042
generate_one_block  0.6816887855529785
generate_one_block  0.6681411266326904
generate_one_block  0.6796519756317139
generate_one_block  0.68282151222229
generate_one_block  0.6805872917175293
generate_one_block  0.6698293685913086
generate_one_block  0.6790177822113037
generate_one_block  0.6778266429901123
generate_one_block  0.6759264469146729
generate_one_block  0.6809115409851074
generate_one_block  0.6796891689300537
generate_one_block  0.6781809329986572
generate_one_block  0.6848468780517578
generate_one_block  0.6940507888793945
generate_one_block  0.68215012550354
generate_one_block  0.6770405769348145
generate_one_block  0.6958208084106445
generate_one_block  0.675360918045044
generate_one_block  0.6818978786468506
generate_one_block  0.677255392074585
generate_one_block  0.673105001449585
generate_one_block  0.6850733757019043
generate_one_block  0.684218168258667
generate_one_block  0.683283805847168
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.13049745559692383  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

connection checking time:  32.19483518600464
block generation total time  29.887865781784058
average batch blocks generation time:  0.9339958056807518
block dataloader generation time/epoch 65.78615886824471
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10896635055541992  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.41004228591919  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10883808135986328  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.49904155731201  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10931634902954102  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.848507404327393  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10910415649414062  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.935908794403076  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10947942733764648  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.81532049179077  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10912752151489258  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.724120140075684  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.1090078353881836  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.664774417877197  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10976552963256836  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 21.233248710632324  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10921573638916016  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.657358646392822  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10886573791503906  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.27125310897827  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10930776596069336  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.92426300048828  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.1097259521484375  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 21.138341426849365  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10949087142944336  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.859205722808838  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10889148712158203  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.58117914199829  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10886621475219727  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.495375156402588  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.1092228889465332  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.888622760772705  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10894393920898438  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.6152982711792  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.1093740463256836  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 21.072840213775635  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.109161376953125  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.794562816619873  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10929489135742188  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.908820152282715  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10924959182739258  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.814600467681885  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10936117172241211  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.818206310272217  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10972261428833008  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 21.01653528213501  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10898160934448242  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.622848510742188  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10938024520874023  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.891339778900146  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.1090550422668457  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.756834506988525  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10917329788208008  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.86019802093506  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10917901992797852  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.895569801330566  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10886478424072266  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.355266094207764  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10956048965454102  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 21.278531074523926  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10919761657714844  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.547358989715576  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10949993133544922  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.8292818069458  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03656955063343048 |0.022969819605350494 |0.632776103913784 |9.456276893615723e-05 |1.2040333300828934 |0.008963584899902344 |
----------------------------------------------------------pseudo_mini_loss sum 1.3084293603897095
Total (block generation + training)time/epoch 126.57450536319188
Training time/epoch 60.761587619781494
Training time without block to device /epoch 60.02655339241028
Training time without total dataloading part /epoch 58.789891481399536
load block tensor time/epoch 1.1702256202697754
block to device time/epoch 0.7350342273712158
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 23 |
Number of nodes for computation during this epoch:  9159854
Number of first layer input nodes during this epoch:  4808385
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.1331343650817871  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03130769729614258
random selection method range initialization spend 0.007713794708251953
time for parepare:  0.023781776428222656
local_output_nid generation:  0.001413583755493164
local_in_edges_tensor generation:  0.008550882339477539
mini_batch_src_global generation:  0.002331256866455078
r_  generation:  0.012209653854370117
local_output_nid generation:  0.0016639232635498047
local_in_edges_tensor generation:  0.0010404586791992188
mini_batch_src_global generation:  0.0016510486602783203
r_  generation:  0.010607719421386719
local_output_nid generation:  0.0016028881072998047
local_in_edges_tensor generation:  0.0009467601776123047
mini_batch_src_global generation:  0.0011281967163085938
r_  generation:  0.01004171371459961
local_output_nid generation:  0.0016367435455322266
local_in_edges_tensor generation:  0.0009133815765380859
mini_batch_src_global generation:  0.001092672348022461
r_  generation:  0.009750843048095703
local_output_nid generation:  0.0015926361083984375
local_in_edges_tensor generation:  0.0008928775787353516
mini_batch_src_global generation:  0.0011336803436279297
r_  generation:  0.00995635986328125
local_output_nid generation:  0.001580953598022461
local_in_edges_tensor generation:  0.0008928775787353516
mini_batch_src_global generation:  0.0010738372802734375
r_  generation:  0.009852409362792969
local_output_nid generation:  0.0015833377838134766
local_in_edges_tensor generation:  0.0009298324584960938
mini_batch_src_global generation:  0.0010814666748046875
r_  generation:  0.009813785552978516
local_output_nid generation:  0.0015957355499267578
local_in_edges_tensor generation:  0.0008752346038818359
mini_batch_src_global generation:  0.0010781288146972656
r_  generation:  0.010030269622802734
local_output_nid generation:  0.0015797615051269531
local_in_edges_tensor generation:  0.0008807182312011719
mini_batch_src_global generation:  0.0011098384857177734
r_  generation:  0.010186910629272461
local_output_nid generation:  0.0015833377838134766
local_in_edges_tensor generation:  0.0008714199066162109
mini_batch_src_global generation:  0.001079559326171875
r_  generation:  0.009900093078613281
local_output_nid generation:  0.0015842914581298828
local_in_edges_tensor generation:  0.0008680820465087891
mini_batch_src_global generation:  0.0010836124420166016
r_  generation:  0.009860515594482422
local_output_nid generation:  0.0015726089477539062
local_in_edges_tensor generation:  0.0008685588836669922
mini_batch_src_global generation:  0.0012505054473876953
r_  generation:  0.014430046081542969
local_output_nid generation:  0.0016453266143798828
local_in_edges_tensor generation:  0.0008831024169921875
mini_batch_src_global generation:  0.001245737075805664
r_  generation:  0.010927677154541016
local_output_nid generation:  0.001588582992553711
local_in_edges_tensor generation:  0.0008494853973388672
mini_batch_src_global generation:  0.0011572837829589844
r_  generation:  0.01029825210571289
local_output_nid generation:  0.0015687942504882812
local_in_edges_tensor generation:  0.0008647441864013672
mini_batch_src_global generation:  0.0011148452758789062
r_  generation:  0.010223865509033203
local_output_nid generation:  0.0015811920166015625
local_in_edges_tensor generation:  0.0008397102355957031
mini_batch_src_global generation:  0.0011148452758789062
r_  generation:  0.010165691375732422
local_output_nid generation:  0.0015807151794433594
local_in_edges_tensor generation:  0.0008487701416015625
mini_batch_src_global generation:  0.0010848045349121094
r_  generation:  0.010048627853393555
local_output_nid generation:  0.001562356948852539
local_in_edges_tensor generation:  0.0008265972137451172
mini_batch_src_global generation:  0.0011262893676757812
r_  generation:  0.010279178619384766
local_output_nid generation:  0.0015621185302734375
local_in_edges_tensor generation:  0.0008985996246337891
mini_batch_src_global generation:  0.0010902881622314453
r_  generation:  0.00981283187866211
local_output_nid generation:  0.0015869140625
local_in_edges_tensor generation:  0.00083160400390625
mini_batch_src_global generation:  0.0011496543884277344
r_  generation:  0.010297298431396484
local_output_nid generation:  0.0015759468078613281
local_in_edges_tensor generation:  0.0008666515350341797
mini_batch_src_global generation:  0.0011730194091796875
r_  generation:  0.010588407516479492
local_output_nid generation:  0.0015702247619628906
local_in_edges_tensor generation:  0.000827789306640625
mini_batch_src_global generation:  0.0011157989501953125
r_  generation:  0.010390043258666992
local_output_nid generation:  0.0015709400177001953
local_in_edges_tensor generation:  0.0010247230529785156
mini_batch_src_global generation:  0.0011866092681884766
r_  generation:  0.010081768035888672
local_output_nid generation:  0.0015766620635986328
local_in_edges_tensor generation:  0.0009560585021972656
mini_batch_src_global generation:  0.0011715888977050781
r_  generation:  0.010243654251098633
local_output_nid generation:  0.0015645027160644531
local_in_edges_tensor generation:  0.00091552734375
mini_batch_src_global generation:  0.0011031627655029297
r_  generation:  0.010101556777954102
local_output_nid generation:  0.001566171646118164
local_in_edges_tensor generation:  0.0009448528289794922
mini_batch_src_global generation:  0.00110626220703125
r_  generation:  0.010160446166992188
local_output_nid generation:  0.0015685558319091797
local_in_edges_tensor generation:  0.0008816719055175781
mini_batch_src_global generation:  0.0010952949523925781
r_  generation:  0.010251045227050781
local_output_nid generation:  0.0015692710876464844
local_in_edges_tensor generation:  0.0009205341339111328
mini_batch_src_global generation:  0.0011179447174072266
r_  generation:  0.010258674621582031
local_output_nid generation:  0.001554727554321289
local_in_edges_tensor generation:  0.0008559226989746094
mini_batch_src_global generation:  0.001169443130493164
r_  generation:  0.010489463806152344
local_output_nid generation:  0.0015482902526855469
local_in_edges_tensor generation:  0.0009009838104248047
mini_batch_src_global generation:  0.001220703125
r_  generation:  0.010174036026000977
local_output_nid generation:  0.0015685558319091797
local_in_edges_tensor generation:  0.0008611679077148438
mini_batch_src_global generation:  0.0011227130889892578
r_  generation:  0.010185480117797852
local_output_nid generation:  0.001558542251586914
local_in_edges_tensor generation:  0.0009074211120605469
mini_batch_src_global generation:  0.0011281967163085938
r_  generation:  0.01021122932434082
----------------------check_connections_block total spend ----------------------------- 0.5758171081542969
generate_one_block  0.022037267684936523
generate_one_block  0.021696805953979492
generate_one_block  0.01958441734313965
generate_one_block  0.01870107650756836
generate_one_block  0.01886773109436035
generate_one_block  0.018178939819335938
generate_one_block  0.017874717712402344
generate_one_block  0.018408775329589844
generate_one_block  0.01870870590209961
generate_one_block  0.017894744873046875
generate_one_block  0.017969608306884766
generate_one_block  0.022991418838500977
generate_one_block  0.023662567138671875
generate_one_block  0.01902008056640625
generate_one_block  0.0182497501373291
generate_one_block  0.018680572509765625
generate_one_block  0.018332958221435547
generate_one_block  0.018491506576538086
generate_one_block  0.01763629913330078
generate_one_block  0.01850271224975586
generate_one_block  0.019225120544433594
generate_one_block  0.018603086471557617
generate_one_block  0.018190622329711914
generate_one_block  0.01844310760498047
generate_one_block  0.01815176010131836
generate_one_block  0.018225669860839844
generate_one_block  0.018595218658447266
generate_one_block  0.01860332489013672
generate_one_block  0.018958568572998047
generate_one_block  0.0185086727142334
generate_one_block  0.018108129501342773
generate_one_block  0.01851797103881836
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04070019721984863
gen group dst list time:  0.023965120315551758
time for parepare:  0.0227508544921875
local_output_nid generation:  0.00678706169128418
local_in_edges_tensor generation:  0.020120859146118164
mini_batch_src_global generation:  0.019348621368408203
r_  generation:  0.17560553550720215
local_output_nid generation:  0.009190797805786133
local_in_edges_tensor generation:  0.012196063995361328
mini_batch_src_global generation:  0.02257084846496582
r_  generation:  0.17452526092529297
local_output_nid generation:  0.009191036224365234
local_in_edges_tensor generation:  0.03584790229797363
mini_batch_src_global generation:  0.02124953269958496
r_  generation:  0.17362022399902344
local_output_nid generation:  0.009647607803344727
local_in_edges_tensor generation:  0.009214162826538086
mini_batch_src_global generation:  0.021571636199951172
r_  generation:  0.17549562454223633
local_output_nid generation:  0.009776115417480469
local_in_edges_tensor generation:  0.012105226516723633
mini_batch_src_global generation:  0.023280620574951172
r_  generation:  0.17984628677368164
local_output_nid generation:  0.009516477584838867
local_in_edges_tensor generation:  0.01234579086303711
mini_batch_src_global generation:  0.022514820098876953
r_  generation:  0.1744089126586914
local_output_nid generation:  0.009375572204589844
local_in_edges_tensor generation:  0.011606931686401367
mini_batch_src_global generation:  0.022604703903198242
r_  generation:  0.17079782485961914
local_output_nid generation:  0.008886575698852539
local_in_edges_tensor generation:  0.011014938354492188
mini_batch_src_global generation:  0.023410797119140625
r_  generation:  0.18056797981262207
local_output_nid generation:  0.009233951568603516
local_in_edges_tensor generation:  0.010926485061645508
mini_batch_src_global generation:  0.023431777954101562
r_  generation:  0.18296408653259277
local_output_nid generation:  0.009334564208984375
local_in_edges_tensor generation:  0.00981593132019043
mini_batch_src_global generation:  0.024579763412475586
r_  generation:  0.17559814453125
local_output_nid generation:  0.00934910774230957
local_in_edges_tensor generation:  0.010190010070800781
mini_batch_src_global generation:  0.022566795349121094
r_  generation:  0.17942094802856445
local_output_nid generation:  0.009871482849121094
local_in_edges_tensor generation:  0.012034416198730469
mini_batch_src_global generation:  0.02477550506591797
r_  generation:  0.1955428123474121
local_output_nid generation:  0.009773015975952148
local_in_edges_tensor generation:  0.012256145477294922
mini_batch_src_global generation:  0.024996042251586914
r_  generation:  0.18694615364074707
local_output_nid generation:  0.009714841842651367
local_in_edges_tensor generation:  0.009539604187011719
mini_batch_src_global generation:  0.02401280403137207
r_  generation:  0.18791580200195312
local_output_nid generation:  0.009328365325927734
local_in_edges_tensor generation:  0.011048316955566406
mini_batch_src_global generation:  0.02333211898803711
r_  generation:  0.17682337760925293
local_output_nid generation:  0.009604692459106445
local_in_edges_tensor generation:  0.009237527847290039
mini_batch_src_global generation:  0.026676177978515625
r_  generation:  0.18380951881408691
local_output_nid generation:  0.009398937225341797
local_in_edges_tensor generation:  0.009067296981811523
mini_batch_src_global generation:  0.02288985252380371
r_  generation:  0.17968463897705078
local_output_nid generation:  0.009592533111572266
local_in_edges_tensor generation:  0.009349346160888672
mini_batch_src_global generation:  0.022984981536865234
r_  generation:  0.18203353881835938
local_output_nid generation:  0.00942683219909668
local_in_edges_tensor generation:  0.009619951248168945
mini_batch_src_global generation:  0.022205114364624023
r_  generation:  0.1741499900817871
local_output_nid generation:  0.0097198486328125
local_in_edges_tensor generation:  0.009889602661132812
mini_batch_src_global generation:  0.022467613220214844
r_  generation:  0.17674827575683594
local_output_nid generation:  0.009971380233764648
local_in_edges_tensor generation:  0.009315252304077148
mini_batch_src_global generation:  0.023886680603027344
r_  generation:  0.19042706489562988
local_output_nid generation:  0.009697914123535156
local_in_edges_tensor generation:  0.011531829833984375
mini_batch_src_global generation:  0.024242162704467773
r_  generation:  0.18522906303405762
local_output_nid generation:  0.009312629699707031
local_in_edges_tensor generation:  0.009329557418823242
mini_batch_src_global generation:  0.022658824920654297
r_  generation:  0.18047761917114258
local_output_nid generation:  0.009592294692993164
local_in_edges_tensor generation:  0.008983373641967773
mini_batch_src_global generation:  0.023461341857910156
r_  generation:  0.18326091766357422
local_output_nid generation:  0.009412050247192383
local_in_edges_tensor generation:  0.00879812240600586
mini_batch_src_global generation:  0.022968769073486328
r_  generation:  0.18290424346923828
local_output_nid generation:  0.009471893310546875
local_in_edges_tensor generation:  0.009079694747924805
mini_batch_src_global generation:  0.022838115692138672
r_  generation:  0.18145489692687988
local_output_nid generation:  0.009657859802246094
local_in_edges_tensor generation:  0.009093284606933594
mini_batch_src_global generation:  0.023064374923706055
r_  generation:  0.18450117111206055
local_output_nid generation:  0.009459733963012695
local_in_edges_tensor generation:  0.009312868118286133
mini_batch_src_global generation:  0.023084402084350586
r_  generation:  0.18157553672790527
local_output_nid generation:  0.009744405746459961
local_in_edges_tensor generation:  0.009203672409057617
mini_batch_src_global generation:  0.023442745208740234
r_  generation:  0.1880033016204834
local_output_nid generation:  0.009664773941040039
local_in_edges_tensor generation:  0.009267807006835938
mini_batch_src_global generation:  0.026437759399414062
r_  generation:  0.18364262580871582
local_output_nid generation:  0.009595394134521484
local_in_edges_tensor generation:  0.009391546249389648
mini_batch_src_global generation:  0.022741079330444336
r_  generation:  0.18235158920288086
local_output_nid generation:  0.009701728820800781
local_in_edges_tensor generation:  0.00911712646484375
mini_batch_src_global generation:  0.023123502731323242
r_  generation:  0.18236827850341797
----------------------check_connections_block total spend ----------------------------- 8.515209913253784
generate_one_block  0.26372528076171875
generate_one_block  0.2440946102142334
generate_one_block  0.24169921875
generate_one_block  0.243943452835083
generate_one_block  0.26360392570495605
generate_one_block  0.23789095878601074
generate_one_block  0.23415565490722656
generate_one_block  0.2463998794555664
generate_one_block  0.2474803924560547
generate_one_block  0.23422765731811523
generate_one_block  0.2401871681213379
generate_one_block  0.2677733898162842
generate_one_block  0.25402355194091797
generate_one_block  0.2556791305541992
generate_one_block  0.23735976219177246
generate_one_block  0.2456810474395752
generate_one_block  0.2434840202331543
generate_one_block  0.24463963508605957
generate_one_block  0.23381280899047852
generate_one_block  0.24596333503723145
generate_one_block  0.26068902015686035
generate_one_block  0.25603461265563965
generate_one_block  0.24574923515319824
generate_one_block  0.24819612503051758
generate_one_block  0.24835658073425293
generate_one_block  0.24753332138061523
generate_one_block  0.24727559089660645
generate_one_block  0.2485973834991455
generate_one_block  0.25200963020324707
generate_one_block  0.24700212478637695
generate_one_block  0.24100303649902344
generate_one_block  0.24329376220703125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03414463996887207
gen group dst list time:  0.12535381317138672
time for parepare:  0.019784927368164062
local_output_nid generation:  0.025624752044677734
local_in_edges_tensor generation:  0.044446706771850586
mini_batch_src_global generation:  0.047432899475097656
r_  generation:  0.4932880401611328
local_output_nid generation:  0.03171515464782715
local_in_edges_tensor generation:  0.03806424140930176
mini_batch_src_global generation:  0.0615229606628418
r_  generation:  0.49837350845336914
local_output_nid generation:  0.03206372261047363
local_in_edges_tensor generation:  0.03760480880737305
mini_batch_src_global generation:  0.06290268898010254
r_  generation:  0.5061936378479004
local_output_nid generation:  0.03438591957092285
local_in_edges_tensor generation:  0.036145925521850586
mini_batch_src_global generation:  0.06385564804077148
r_  generation:  0.5061461925506592
local_output_nid generation:  0.03186845779418945
local_in_edges_tensor generation:  0.04355978965759277
mini_batch_src_global generation:  0.06198000907897949
r_  generation:  0.5281755924224854
local_output_nid generation:  0.03507709503173828
local_in_edges_tensor generation:  0.038602352142333984
mini_batch_src_global generation:  0.06355071067810059
r_  generation:  0.49415087699890137
local_output_nid generation:  0.03178262710571289
local_in_edges_tensor generation:  0.03851652145385742
mini_batch_src_global generation:  0.058704376220703125
r_  generation:  0.5015513896942139
local_output_nid generation:  0.03094029426574707
local_in_edges_tensor generation:  0.03178119659423828
mini_batch_src_global generation:  0.06023550033569336
r_  generation:  0.4992954730987549
local_output_nid generation:  0.030928373336791992
local_in_edges_tensor generation:  0.038552045822143555
mini_batch_src_global generation:  0.06067347526550293
r_  generation:  0.5094625949859619
local_output_nid generation:  0.030651092529296875
local_in_edges_tensor generation:  0.02867293357849121
mini_batch_src_global generation:  0.06119561195373535
r_  generation:  0.5025978088378906
local_output_nid generation:  0.031022071838378906
local_in_edges_tensor generation:  0.036529541015625
mini_batch_src_global generation:  0.0587468147277832
r_  generation:  0.507030725479126
local_output_nid generation:  0.03235316276550293
local_in_edges_tensor generation:  0.030944108963012695
mini_batch_src_global generation:  0.06172800064086914
r_  generation:  0.5112621784210205
local_output_nid generation:  0.031086206436157227
local_in_edges_tensor generation:  0.03263115882873535
mini_batch_src_global generation:  0.05933713912963867
r_  generation:  0.5093779563903809
local_output_nid generation:  0.03272104263305664
local_in_edges_tensor generation:  0.0435943603515625
mini_batch_src_global generation:  0.06199526786804199
r_  generation:  0.502772331237793
local_output_nid generation:  0.030625343322753906
local_in_edges_tensor generation:  0.03890371322631836
mini_batch_src_global generation:  0.062310218811035156
r_  generation:  0.5221214294433594
local_output_nid generation:  0.03284883499145508
local_in_edges_tensor generation:  0.03466486930847168
mini_batch_src_global generation:  0.06376051902770996
r_  generation:  0.49974775314331055
local_output_nid generation:  0.03035426139831543
local_in_edges_tensor generation:  0.03293967247009277
mini_batch_src_global generation:  0.06016254425048828
r_  generation:  0.5190489292144775
local_output_nid generation:  0.030457019805908203
local_in_edges_tensor generation:  0.03003096580505371
mini_batch_src_global generation:  0.06188511848449707
r_  generation:  0.5005388259887695
local_output_nid generation:  0.030517578125
local_in_edges_tensor generation:  0.03033280372619629
mini_batch_src_global generation:  0.05799102783203125
r_  generation:  0.5050735473632812
local_output_nid generation:  0.030332088470458984
local_in_edges_tensor generation:  0.02916240692138672
mini_batch_src_global generation:  0.060640811920166016
r_  generation:  0.49980854988098145
local_output_nid generation:  0.030991554260253906
local_in_edges_tensor generation:  0.037670135498046875
mini_batch_src_global generation:  0.05994915962219238
r_  generation:  0.5098469257354736
local_output_nid generation:  0.03062725067138672
local_in_edges_tensor generation:  0.03141951560974121
mini_batch_src_global generation:  0.06230902671813965
r_  generation:  0.5033531188964844
local_output_nid generation:  0.031655073165893555
local_in_edges_tensor generation:  0.038038015365600586
mini_batch_src_global generation:  0.05829811096191406
r_  generation:  0.505274772644043
local_output_nid generation:  0.031466007232666016
local_in_edges_tensor generation:  0.03213024139404297
mini_batch_src_global generation:  0.059732913970947266
r_  generation:  0.49866557121276855
local_output_nid generation:  0.030487060546875
local_in_edges_tensor generation:  0.029502391815185547
mini_batch_src_global generation:  0.05954909324645996
r_  generation:  0.5005156993865967
local_output_nid generation:  0.03052830696105957
local_in_edges_tensor generation:  0.0291287899017334
mini_batch_src_global generation:  0.06058049201965332
r_  generation:  0.49764180183410645
local_output_nid generation:  0.030758380889892578
local_in_edges_tensor generation:  0.032819509506225586
mini_batch_src_global generation:  0.058373212814331055
r_  generation:  0.5047996044158936
local_output_nid generation:  0.030944108963012695
local_in_edges_tensor generation:  0.034470319747924805
mini_batch_src_global generation:  0.06019115447998047
r_  generation:  0.5026810169219971
local_output_nid generation:  0.03123188018798828
local_in_edges_tensor generation:  0.033901214599609375
mini_batch_src_global generation:  0.061246395111083984
r_  generation:  0.5071713924407959
local_output_nid generation:  0.030841588973999023
local_in_edges_tensor generation:  0.03592944145202637
mini_batch_src_global generation:  0.06059408187866211
r_  generation:  0.5007176399230957
local_output_nid generation:  0.030408859252929688
local_in_edges_tensor generation:  0.029432296752929688
mini_batch_src_global generation:  0.059918880462646484
r_  generation:  0.5079488754272461
local_output_nid generation:  0.030333518981933594
local_in_edges_tensor generation:  0.032885074615478516
mini_batch_src_global generation:  0.06190347671508789
r_  generation:  0.5175964832305908
----------------------check_connections_block total spend ----------------------------- 23.756054401397705
generate_one_block  0.7092435359954834
generate_one_block  0.6816549301147461
generate_one_block  0.6704707145690918
generate_one_block  0.6807756423950195
generate_one_block  0.8078386783599854
generate_one_block  0.68515944480896
generate_one_block  0.6853926181793213
generate_one_block  0.6801064014434814
generate_one_block  0.6836984157562256
generate_one_block  0.6755375862121582
generate_one_block  0.6839771270751953
generate_one_block  0.6841888427734375
generate_one_block  0.684319019317627
generate_one_block  0.6863889694213867
generate_one_block  0.672332763671875
generate_one_block  0.6770439147949219
generate_one_block  0.6757574081420898
generate_one_block  0.6796419620513916
generate_one_block  0.675922155380249
generate_one_block  0.677506685256958
generate_one_block  0.6881589889526367
generate_one_block  0.6891593933105469
generate_one_block  0.6804025173187256
generate_one_block  0.6766006946563721
generate_one_block  0.697432279586792
generate_one_block  0.6830751895904541
generate_one_block  0.6836752891540527
generate_one_block  0.6821355819702148
generate_one_block  0.6860277652740479
generate_one_block  0.6880943775177002
generate_one_block  0.6804182529449463
generate_one_block  0.6774020195007324
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.1331343650817871  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

connection checking time:  32.27126431465149
block generation total time  29.881104469299316
average batch blocks generation time:  0.9337845146656036
block dataloader generation time/epoch 65.79279330571492
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10973453521728516  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 21.420724391937256  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.1093592643737793  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.78502607345581  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10914134979248047  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.653273582458496  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10927295684814453  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.8075909614563  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10907554626464844  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.931339740753174  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.1089324951171875  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.51953411102295  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10902595520019531  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.288816928863525  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10901355743408203  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.884113311767578  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.1092844009399414  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.9770450592041  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10897302627563477  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.332157611846924  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10900163650512695  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 20.572268962860107  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5076904296875 GB
    Memory Allocated: 0.10962820053100586  GigaBytes
Max Memory Allocated: 21.644381046295166  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 21.64534044265747  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.10941886901855469  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9783935546875 GB
    Memory Allocated: 21.141964435577393  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9783935546875 GB
    Memory Allocated: 0.10963726043701172  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 21.23947811126709  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 0.10888862609863281  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 20.432992458343506  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 0.10928726196289062  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 20.843307495117188  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 0.10910606384277344  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 20.577292442321777  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 0.10907888412475586  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 20.709943294525146  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 0.10884332656860352  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 20.2117657661438  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 0.1091303825378418  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 20.46367835998535  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 0.10963249206542969  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 21.25049066543579  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 0.10943460464477539  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 21.05345058441162  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 0.10897541046142578  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 20.568921089172363  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 0.10904169082641602  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 20.747128009796143  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 0.10905694961547852  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 20.667142868041992  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 0.10903072357177734  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 20.65566635131836  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 0.10910606384277344  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 20.796922206878662  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 0.10946416854858398  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 20.811007022857666  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 0.10939884185791016  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 21.02389669418335  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 0.10927152633666992  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 20.866782665252686  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 0.10907316207885742  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 20.551620960235596  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 0.1090245246887207  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 20.686376571655273  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.036343179643154144 |0.023186050355434418 |0.6359574943780899 |9.626895189285278e-05 |1.2076292932033539 |0.008436441421508789 |
----------------------------------------------------------pseudo_mini_loss sum 1.299975037574768
Total (block generation + training)time/epoch 126.59410177866617
Training time/epoch 60.982531785964966
Training time without block to device /epoch 60.240578174591064
Training time without total dataloading part /epoch 59.00629425048828
load block tensor time/epoch 1.1629817485809326
block to device time/epoch 0.7419536113739014
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 24 |
Number of nodes for computation during this epoch:  9158638
Number of first layer input nodes during this epoch:  4806473
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 0.1310901641845703  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02933335304260254
random selection method range initialization spend 0.006566524505615234
time for parepare:  0.026985645294189453
local_output_nid generation:  0.0019061565399169922
local_in_edges_tensor generation:  0.00797414779663086
mini_batch_src_global generation:  0.0029451847076416016
r_  generation:  0.01011037826538086
local_output_nid generation:  0.0019195079803466797
local_in_edges_tensor generation:  0.0012476444244384766
mini_batch_src_global generation:  0.0022041797637939453
r_  generation:  0.011721372604370117
local_output_nid generation:  0.002074003219604492
local_in_edges_tensor generation:  0.0012226104736328125
mini_batch_src_global generation:  0.0015850067138671875
r_  generation:  0.010512828826904297
local_output_nid generation:  0.0021407604217529297
local_in_edges_tensor generation:  0.0011324882507324219
mini_batch_src_global generation:  0.0015437602996826172
r_  generation:  0.010557174682617188
local_output_nid generation:  0.002132892608642578
local_in_edges_tensor generation:  0.0018763542175292969
mini_batch_src_global generation:  0.004019260406494141
r_  generation:  0.016379356384277344
local_output_nid generation:  0.005604982376098633
local_in_edges_tensor generation:  0.0015151500701904297
mini_batch_src_global generation:  0.0015401840209960938
r_  generation:  0.010916709899902344
local_output_nid generation:  0.002178668975830078
local_in_edges_tensor generation:  0.0010609626770019531
mini_batch_src_global generation:  0.0012989044189453125
r_  generation:  0.010593652725219727
local_output_nid generation:  0.002007007598876953
local_in_edges_tensor generation:  0.0010426044464111328
mini_batch_src_global generation:  0.0011806488037109375
r_  generation:  0.009940385818481445
local_output_nid generation:  0.0019621849060058594
local_in_edges_tensor generation:  0.0009331703186035156
mini_batch_src_global generation:  0.0011494159698486328
r_  generation:  0.01019906997680664
local_output_nid generation:  0.0018951892852783203
local_in_edges_tensor generation:  0.0008847713470458984
mini_batch_src_global generation:  0.001131296157836914
r_  generation:  0.010111808776855469
local_output_nid generation:  0.0018665790557861328
local_in_edges_tensor generation:  0.0009202957153320312
mini_batch_src_global generation:  0.0011272430419921875
r_  generation:  0.010237455368041992
local_output_nid generation:  0.0018239021301269531
local_in_edges_tensor generation:  0.0008881092071533203
mini_batch_src_global generation:  0.0011248588562011719
r_  generation:  0.010297060012817383
local_output_nid generation:  0.001783132553100586
local_in_edges_tensor generation:  0.0008738040924072266
mini_batch_src_global generation:  0.0012416839599609375
r_  generation:  0.013939619064331055
local_output_nid generation:  0.0018947124481201172
local_in_edges_tensor generation:  0.0009355545043945312
mini_batch_src_global generation:  0.0011553764343261719
r_  generation:  0.010372638702392578
local_output_nid generation:  0.0017702579498291016
local_in_edges_tensor generation:  0.0009024143218994141
mini_batch_src_global generation:  0.0011301040649414062
r_  generation:  0.010669231414794922
local_output_nid generation:  0.0017676353454589844
local_in_edges_tensor generation:  0.0009007453918457031
mini_batch_src_global generation:  0.001081705093383789
r_  generation:  0.010083436965942383
local_output_nid generation:  0.0017168521881103516
local_in_edges_tensor generation:  0.0009357929229736328
mini_batch_src_global generation:  0.0011076927185058594
r_  generation:  0.009987354278564453
local_output_nid generation:  0.0017209053039550781
local_in_edges_tensor generation:  0.0008819103240966797
mini_batch_src_global generation:  0.0011746883392333984
r_  generation:  0.010891914367675781
local_output_nid generation:  0.0017018318176269531
local_in_edges_tensor generation:  0.00090789794921875
mini_batch_src_global generation:  0.0011615753173828125
r_  generation:  0.012774467468261719
local_output_nid generation:  0.0016884803771972656
local_in_edges_tensor generation:  0.0009458065032958984
mini_batch_src_global generation:  0.0012025833129882812
r_  generation:  0.010684013366699219
local_output_nid generation:  0.0016586780548095703
local_in_edges_tensor generation:  0.0009214878082275391
mini_batch_src_global generation:  0.0011494159698486328
r_  generation:  0.010171890258789062
local_output_nid generation:  0.0016486644744873047
local_in_edges_tensor generation:  0.0008292198181152344
mini_batch_src_global generation:  0.001100301742553711
r_  generation:  0.010448932647705078
local_output_nid generation:  0.0016326904296875
local_in_edges_tensor generation:  0.00154876708984375
mini_batch_src_global generation:  0.0010976791381835938
r_  generation:  0.010253190994262695
local_output_nid generation:  0.001600503921508789
local_in_edges_tensor generation:  0.0008876323699951172
mini_batch_src_global generation:  0.0011622905731201172
r_  generation:  0.010452985763549805
local_output_nid generation:  0.0016150474548339844
local_in_edges_tensor generation:  0.0009081363677978516
mini_batch_src_global generation:  0.0011093616485595703
r_  generation:  0.010233879089355469
local_output_nid generation:  0.0036733150482177734
local_in_edges_tensor generation:  0.0010802745819091797
mini_batch_src_global generation:  0.001226663589477539
r_  generation:  0.010418415069580078
local_output_nid generation:  0.0016181468963623047
local_in_edges_tensor generation:  0.0009045600891113281
mini_batch_src_global generation:  0.001116037368774414
r_  generation:  0.010507345199584961
local_output_nid generation:  0.0016117095947265625
local_in_edges_tensor generation:  0.000993967056274414
mini_batch_src_global generation:  0.001216888427734375
r_  generation:  0.010734319686889648
local_output_nid generation:  0.0015959739685058594
local_in_edges_tensor generation:  0.0009984970092773438
mini_batch_src_global generation:  0.0011692047119140625
r_  generation:  0.010511398315429688
local_output_nid generation:  0.0015802383422851562
local_in_edges_tensor generation:  0.0009467601776123047
mini_batch_src_global generation:  0.0010900497436523438
r_  generation:  0.009926557540893555
local_output_nid generation:  0.0016074180603027344
local_in_edges_tensor generation:  0.0008814334869384766
mini_batch_src_global generation:  0.0011518001556396484
r_  generation:  0.010579824447631836
local_output_nid generation:  0.0015735626220703125
local_in_edges_tensor generation:  0.0010025501251220703
mini_batch_src_global generation:  0.0029218196868896484
r_  generation:  0.010264396667480469
----------------------check_connections_block total spend ----------------------------- 0.6239497661590576
generate_one_block  0.027323484420776367
generate_one_block  0.022138118743896484
generate_one_block  0.02004861831665039
generate_one_block  0.02130270004272461
generate_one_block  0.0189361572265625
generate_one_block  0.019060850143432617
generate_one_block  0.019264698028564453
generate_one_block  0.017977237701416016
generate_one_block  0.018761873245239258
generate_one_block  0.02037334442138672
generate_one_block  0.01904749870300293
generate_one_block  0.021619319915771484
generate_one_block  0.020460844039916992
generate_one_block  0.01861405372619629
generate_one_block  0.02104043960571289
generate_one_block  0.01810145378112793
generate_one_block  0.018268585205078125
generate_one_block  0.01975560188293457
generate_one_block  0.019196271896362305
generate_one_block  0.020750045776367188
generate_one_block  0.018393516540527344
generate_one_block  0.01879429817199707
generate_one_block  0.018907785415649414
generate_one_block  0.018794775009155273
generate_one_block  0.018541574478149414
generate_one_block  0.02004241943359375
generate_one_block  0.0188751220703125
generate_one_block  0.018857717514038086
generate_one_block  0.019084692001342773
generate_one_block  0.017833709716796875
generate_one_block  0.021445274353027344
generate_one_block  0.018529176712036133
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04105401039123535
gen group dst list time:  0.02639317512512207
time for parepare:  0.02443408966064453
local_output_nid generation:  0.006876468658447266
local_in_edges_tensor generation:  0.02330160140991211
mini_batch_src_global generation:  0.019377946853637695
r_  generation:  0.17064809799194336
local_output_nid generation:  0.011658668518066406
local_in_edges_tensor generation:  0.012539386749267578
mini_batch_src_global generation:  0.024850130081176758
r_  generation:  0.20169830322265625
local_output_nid generation:  0.009483575820922852
local_in_edges_tensor generation:  0.04131197929382324
mini_batch_src_global generation:  0.024091243743896484
r_  generation:  0.17662954330444336
local_output_nid generation:  0.00955057144165039
local_in_edges_tensor generation:  0.011861324310302734
mini_batch_src_global generation:  0.02489614486694336
r_  generation:  0.17976832389831543
local_output_nid generation:  0.009693622589111328
local_in_edges_tensor generation:  0.008911848068237305
mini_batch_src_global generation:  0.02542734146118164
r_  generation:  0.18122315406799316
local_output_nid generation:  0.009731769561767578
local_in_edges_tensor generation:  0.012048482894897461
mini_batch_src_global generation:  0.02240753173828125
r_  generation:  0.1799907684326172
local_output_nid generation:  0.010004520416259766
local_in_edges_tensor generation:  0.011590003967285156
mini_batch_src_global generation:  0.03592729568481445
r_  generation:  0.1872868537902832
local_output_nid generation:  0.011747598648071289
local_in_edges_tensor generation:  0.010604143142700195
mini_batch_src_global generation:  0.023151636123657227
r_  generation:  0.17853522300720215
local_output_nid generation:  0.00933384895324707
local_in_edges_tensor generation:  0.010480165481567383
mini_batch_src_global generation:  0.023244619369506836
r_  generation:  0.24040460586547852
local_output_nid generation:  0.009235858917236328
local_in_edges_tensor generation:  0.008914470672607422
mini_batch_src_global generation:  0.02383708953857422
r_  generation:  0.18284106254577637
local_output_nid generation:  0.009881258010864258
local_in_edges_tensor generation:  0.010225057601928711
mini_batch_src_global generation:  0.02270030975341797
r_  generation:  0.18494677543640137
local_output_nid generation:  0.009905338287353516
local_in_edges_tensor generation:  0.008888959884643555
mini_batch_src_global generation:  0.024120807647705078
r_  generation:  0.1828000545501709
local_output_nid generation:  0.010154247283935547
local_in_edges_tensor generation:  0.013243436813354492
mini_batch_src_global generation:  0.024712562561035156
r_  generation:  0.19475841522216797
local_output_nid generation:  0.009589910507202148
local_in_edges_tensor generation:  0.014585018157958984
mini_batch_src_global generation:  0.023536205291748047
r_  generation:  0.18049287796020508
local_output_nid generation:  0.011368274688720703
local_in_edges_tensor generation:  0.011332035064697266
mini_batch_src_global generation:  0.024161577224731445
r_  generation:  0.19135332107543945
local_output_nid generation:  0.010270833969116211
local_in_edges_tensor generation:  0.011532306671142578
mini_batch_src_global generation:  0.02291393280029297
r_  generation:  0.22256946563720703
local_output_nid generation:  0.009633064270019531
local_in_edges_tensor generation:  0.011755704879760742
mini_batch_src_global generation:  0.023910999298095703
r_  generation:  0.18648409843444824
local_output_nid generation:  0.011905908584594727
local_in_edges_tensor generation:  0.015702009201049805
mini_batch_src_global generation:  0.025579452514648438
r_  generation:  0.1958756446838379
local_output_nid generation:  0.009922027587890625
local_in_edges_tensor generation:  0.012625932693481445
mini_batch_src_global generation:  0.026691436767578125
r_  generation:  0.19251012802124023
local_output_nid generation:  0.010000228881835938
local_in_edges_tensor generation:  0.012500286102294922
mini_batch_src_global generation:  0.024511098861694336
r_  generation:  0.19216036796569824
local_output_nid generation:  0.013072013854980469
local_in_edges_tensor generation:  0.01058197021484375
mini_batch_src_global generation:  0.03035140037536621
r_  generation:  0.1867530345916748
local_output_nid generation:  0.010092973709106445
local_in_edges_tensor generation:  0.00976419448852539
mini_batch_src_global generation:  0.026992082595825195
r_  generation:  0.18558049201965332
local_output_nid generation:  0.010010480880737305
local_in_edges_tensor generation:  0.012329339981079102
mini_batch_src_global generation:  0.024225950241088867
r_  generation:  0.18723773956298828
local_output_nid generation:  0.010065555572509766
local_in_edges_tensor generation:  0.010004997253417969
mini_batch_src_global generation:  0.023269176483154297
r_  generation:  0.18158197402954102
local_output_nid generation:  0.00994873046875
local_in_edges_tensor generation:  0.009987115859985352
mini_batch_src_global generation:  0.02326512336730957
r_  generation:  0.18643975257873535
local_output_nid generation:  0.010009050369262695
local_in_edges_tensor generation:  0.009682655334472656
mini_batch_src_global generation:  0.023249387741088867
r_  generation:  0.1832902431488037
local_output_nid generation:  0.00999140739440918
local_in_edges_tensor generation:  0.009790420532226562
mini_batch_src_global generation:  0.023512840270996094
r_  generation:  0.18790388107299805
local_output_nid generation:  0.009906768798828125
local_in_edges_tensor generation:  0.02154088020324707
mini_batch_src_global generation:  0.02368474006652832
r_  generation:  0.19041824340820312
local_output_nid generation:  0.01008915901184082
local_in_edges_tensor generation:  0.010329484939575195
mini_batch_src_global generation:  0.023040056228637695
r_  generation:  0.2151474952697754
local_output_nid generation:  0.009713411331176758
local_in_edges_tensor generation:  0.010603904724121094
mini_batch_src_global generation:  0.023753643035888672
r_  generation:  0.1828618049621582
local_output_nid generation:  0.011709928512573242
local_in_edges_tensor generation:  0.013315439224243164
mini_batch_src_global generation:  0.02382636070251465
r_  generation:  0.19069194793701172
local_output_nid generation:  0.009843587875366211
local_in_edges_tensor generation:  0.01140451431274414
mini_batch_src_global generation:  0.02309250831604004
r_  generation:  0.18476295471191406
----------------------check_connections_block total spend ----------------------------- 8.945518732070923
generate_one_block  0.2653481960296631
generate_one_block  0.24654269218444824
generate_one_block  0.24588274955749512
generate_one_block  0.2523636817932129
generate_one_block  0.2643318176269531
generate_one_block  0.24839520454406738
generate_one_block  0.25516605377197266
generate_one_block  0.24108314514160156
generate_one_block  0.2567117214202881
generate_one_block  0.2548487186431885
generate_one_block  0.24942684173583984
generate_one_block  0.2533736228942871
generate_one_block  0.25917649269104004
generate_one_block  0.2413473129272461
generate_one_block  0.25156641006469727
generate_one_block  0.23574590682983398
generate_one_block  0.24531221389770508
generate_one_block  0.2645902633666992
generate_one_block  0.2546572685241699
generate_one_block  0.26898789405822754
generate_one_block  0.25284433364868164
generate_one_block  0.2689061164855957
generate_one_block  0.25506114959716797
generate_one_block  0.248063325881958
generate_one_block  0.25524091720581055
generate_one_block  0.2548811435699463
generate_one_block  0.2577822208404541
generate_one_block  0.25853896141052246
generate_one_block  0.2544701099395752
generate_one_block  0.2444744110107422
generate_one_block  0.256685733795166
generate_one_block  0.25484514236450195
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.040108680725097656
gen group dst list time:  0.11827373504638672
time for parepare:  0.022709131240844727
local_output_nid generation:  0.027167797088623047
local_in_edges_tensor generation:  0.058045148849487305
mini_batch_src_global generation:  0.04779195785522461
r_  generation:  0.489762544631958
local_output_nid generation:  0.033376455307006836
local_in_edges_tensor generation:  0.04365062713623047
mini_batch_src_global generation:  0.06158900260925293
r_  generation:  0.4911024570465088
local_output_nid generation:  0.03155255317687988
local_in_edges_tensor generation:  0.0359952449798584
mini_batch_src_global generation:  0.05736112594604492
r_  generation:  0.5180113315582275
local_output_nid generation:  0.03411507606506348
local_in_edges_tensor generation:  0.03703904151916504
mini_batch_src_global generation:  0.06275272369384766
r_  generation:  0.49750399589538574
local_output_nid generation:  0.03321242332458496
local_in_edges_tensor generation:  0.039514780044555664
mini_batch_src_global generation:  0.060221195220947266
r_  generation:  0.5005559921264648
local_output_nid generation:  0.04402899742126465
local_in_edges_tensor generation:  0.03427553176879883
mini_batch_src_global generation:  0.05929756164550781
r_  generation:  0.49936628341674805
local_output_nid generation:  0.03204798698425293
local_in_edges_tensor generation:  0.02959895133972168
mini_batch_src_global generation:  0.06164836883544922
r_  generation:  0.49985289573669434
local_output_nid generation:  0.030364990234375
local_in_edges_tensor generation:  0.037689208984375
mini_batch_src_global generation:  0.05917239189147949
r_  generation:  0.491135835647583
local_output_nid generation:  0.03096795082092285
local_in_edges_tensor generation:  0.031874656677246094
mini_batch_src_global generation:  0.06100153923034668
r_  generation:  0.5058562755584717
local_output_nid generation:  0.030817747116088867
local_in_edges_tensor generation:  0.029839754104614258
mini_batch_src_global generation:  0.05968904495239258
r_  generation:  0.5016663074493408
local_output_nid generation:  0.030682802200317383
local_in_edges_tensor generation:  0.0352168083190918
mini_batch_src_global generation:  0.06065487861633301
r_  generation:  0.49664974212646484
local_output_nid generation:  0.03064274787902832
local_in_edges_tensor generation:  0.030664682388305664
mini_batch_src_global generation:  0.062460899353027344
r_  generation:  0.49891161918640137
local_output_nid generation:  0.030740976333618164
local_in_edges_tensor generation:  0.03167462348937988
mini_batch_src_global generation:  0.060956478118896484
r_  generation:  0.499431848526001
local_output_nid generation:  0.030457735061645508
local_in_edges_tensor generation:  0.03098011016845703
mini_batch_src_global generation:  0.061783790588378906
r_  generation:  0.4955923557281494
local_output_nid generation:  0.030442237854003906
local_in_edges_tensor generation:  0.02994680404663086
mini_batch_src_global generation:  0.058232784271240234
r_  generation:  0.5018329620361328
local_output_nid generation:  0.03121495246887207
local_in_edges_tensor generation:  0.029616594314575195
mini_batch_src_global generation:  0.05907082557678223
r_  generation:  0.495466947555542
local_output_nid generation:  0.030692577362060547
local_in_edges_tensor generation:  0.029352188110351562
mini_batch_src_global generation:  0.05992913246154785
r_  generation:  0.5000791549682617
local_output_nid generation:  0.03087139129638672
local_in_edges_tensor generation:  0.03814959526062012
mini_batch_src_global generation:  0.06204056739807129
r_  generation:  0.5039985179901123
local_output_nid generation:  0.03073740005493164
local_in_edges_tensor generation:  0.03379321098327637
mini_batch_src_global generation:  0.06057143211364746
r_  generation:  0.5123991966247559
local_output_nid generation:  0.031922101974487305
local_in_edges_tensor generation:  0.035093069076538086
mini_batch_src_global generation:  0.06210017204284668
r_  generation:  0.5030384063720703
local_output_nid generation:  0.030703067779541016
local_in_edges_tensor generation:  0.03136301040649414
mini_batch_src_global generation:  0.05867481231689453
r_  generation:  0.5024123191833496
local_output_nid generation:  0.030755043029785156
local_in_edges_tensor generation:  0.03558516502380371
mini_batch_src_global generation:  0.06061244010925293
r_  generation:  0.505117654800415
local_output_nid generation:  0.031093597412109375
local_in_edges_tensor generation:  0.03263735771179199
mini_batch_src_global generation:  0.0638120174407959
r_  generation:  0.5114734172821045
local_output_nid generation:  0.03239893913269043
local_in_edges_tensor generation:  0.03215360641479492
mini_batch_src_global generation:  0.062160491943359375
r_  generation:  0.4934108257293701
local_output_nid generation:  0.031232833862304688
local_in_edges_tensor generation:  0.030040502548217773
mini_batch_src_global generation:  0.05874061584472656
r_  generation:  0.5007429122924805
local_output_nid generation:  0.03048229217529297
local_in_edges_tensor generation:  0.028935909271240234
mini_batch_src_global generation:  0.06017136573791504
r_  generation:  0.5071141719818115
local_output_nid generation:  0.030796051025390625
local_in_edges_tensor generation:  0.02953171730041504
mini_batch_src_global generation:  0.06152057647705078
r_  generation:  0.5049798488616943
local_output_nid generation:  0.031059741973876953
local_in_edges_tensor generation:  0.03284907341003418
mini_batch_src_global generation:  0.05994009971618652
r_  generation:  0.5005264282226562
local_output_nid generation:  0.03074193000793457
local_in_edges_tensor generation:  0.03139925003051758
mini_batch_src_global generation:  0.05916118621826172
r_  generation:  0.4992692470550537
local_output_nid generation:  0.030729055404663086
local_in_edges_tensor generation:  0.030652761459350586
mini_batch_src_global generation:  0.06029820442199707
r_  generation:  0.49704432487487793
local_output_nid generation:  0.030954599380493164
local_in_edges_tensor generation:  0.032557010650634766
mini_batch_src_global generation:  0.05891227722167969
r_  generation:  0.500572919845581
local_output_nid generation:  0.030701875686645508
local_in_edges_tensor generation:  0.02990412712097168
mini_batch_src_global generation:  0.06006646156311035
r_  generation:  0.49774622917175293
----------------------check_connections_block total spend ----------------------------- 23.53374171257019
generate_one_block  0.692345142364502
generate_one_block  0.681494951248169
generate_one_block  0.673130989074707
generate_one_block  0.6773679256439209
generate_one_block  0.7901322841644287
generate_one_block  0.6801421642303467
generate_one_block  0.6818904876708984
generate_one_block  0.674771785736084
generate_one_block  0.6866171360015869
generate_one_block  0.6856718063354492
generate_one_block  0.6713981628417969
generate_one_block  0.6828792095184326
generate_one_block  0.6842522621154785
generate_one_block  0.6817901134490967
generate_one_block  0.6813056468963623
generate_one_block  0.6803839206695557
generate_one_block  0.6754748821258545
generate_one_block  0.6889688968658447
generate_one_block  0.6822183132171631
generate_one_block  0.6845169067382812
generate_one_block  0.6793012619018555
generate_one_block  0.6781110763549805
generate_one_block  0.6894192695617676
generate_one_block  0.6852545738220215
generate_one_block  0.7061727046966553
generate_one_block  0.6805527210235596
generate_one_block  0.681821346282959
generate_one_block  0.6814267635345459
generate_one_block  0.6810059547424316
generate_one_block  0.6773455142974854
generate_one_block  0.6821212768554688
generate_one_block  0.6808702945709229
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 0.1310901641845703  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

connection checking time:  32.47926044464111
block generation total time  30.05680751800537
average batch blocks generation time:  0.9392752349376678
block dataloader generation time/epoch 65.82792134582996
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 0.10910367965698242  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 20.356918334960938  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 0.10932731628417969  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 20.662178993225098  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 0.1090855598449707  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 20.707549571990967  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 0.10887861251831055  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 20.86836290359497  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 0.10929393768310547  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 20.82661199569702  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 0.1091609001159668  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 20.81648826599121  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 0.10958051681518555  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 21.0501446723938  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 0.10881328582763672  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 20.32673168182373  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 0.10944461822509766  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 20.900300979614258  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 0.10917949676513672  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 20.763750076293945  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 0.10888671875  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 20.619704246520996  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 0.1091761589050293  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 20.73844575881958  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 0.1095738410949707  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 21.14238452911377  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 0.10897970199584961  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 20.485315322875977  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 0.109161376953125  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 20.88282346725464  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 0.1087193489074707  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 20.129835605621338  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 0.10913562774658203  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 20.66113805770874  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 0.10982084274291992  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2479248046875 GB
    Memory Allocated: 21.362513542175293  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2479248046875 GB
    Memory Allocated: 0.10909509658813477  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2479248046875 GB
    Memory Allocated: 20.95322561264038  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2479248046875 GB
    Memory Allocated: 0.10978269577026367  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2479248046875 GB
    Memory Allocated: 21.26826524734497  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2479248046875 GB
    Memory Allocated: 0.10910987854003906  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2479248046875 GB
    Memory Allocated: 20.73530101776123  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2479248046875 GB
    Memory Allocated: 0.10932445526123047  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2479248046875 GB
    Memory Allocated: 20.882423877716064  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2479248046875 GB
    Memory Allocated: 0.1093149185180664  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2674560546875 GB
    Memory Allocated: 20.878721714019775  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 0.10921192169189453  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 20.596468448638916  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 0.10932540893554688  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 20.835537910461426  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 0.10901451110839844  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 20.72008228302002  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 0.10941314697265625  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 20.884665489196777  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 0.10921144485473633  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 20.890883922576904  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 0.10918617248535156  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 20.867629051208496  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 0.10902690887451172  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 20.383240222930908  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 0.1091756820678711  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 20.84767246246338  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 0.10892677307128906  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 20.511077404022217  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03487387299537659 |0.022196941077709198 |0.6339161396026611 |9.606778621673584e-05 |1.2024566680192947 |0.0052678585052490234 |
----------------------------------------------------------pseudo_mini_loss sum 1.303045630455017
Total (block generation + training)time/epoch 126.62031519412994
Training time/epoch 60.658403158187866
Training time without block to device /epoch 59.94810104370117
Training time without total dataloading part /epoch 58.77227187156677
load block tensor time/epoch 1.1159639358520508
block to device time/epoch 0.7103021144866943
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 25 |
Number of nodes for computation during this epoch:  9156648
Number of first layer input nodes during this epoch:  4807484
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 0.1305689811706543  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.028648853302001953
random selection method range initialization spend 0.0076253414154052734
time for parepare:  0.02454233169555664
local_output_nid generation:  0.002008676528930664
local_in_edges_tensor generation:  0.005325794219970703
mini_batch_src_global generation:  0.002209901809692383
r_  generation:  0.010900259017944336
local_output_nid generation:  0.0019123554229736328
local_in_edges_tensor generation:  0.0011899471282958984
mini_batch_src_global generation:  0.0019366741180419922
r_  generation:  0.012433290481567383
local_output_nid generation:  0.0022263526916503906
local_in_edges_tensor generation:  0.0012195110321044922
mini_batch_src_global generation:  0.0015532970428466797
r_  generation:  0.011074304580688477
local_output_nid generation:  0.002309560775756836
local_in_edges_tensor generation:  0.0011324882507324219
mini_batch_src_global generation:  0.0014486312866210938
r_  generation:  0.011041641235351562
local_output_nid generation:  0.002299070358276367
local_in_edges_tensor generation:  0.0012025833129882812
mini_batch_src_global generation:  0.0013201236724853516
r_  generation:  0.010085582733154297
local_output_nid generation:  0.0022401809692382812
local_in_edges_tensor generation:  0.0011632442474365234
mini_batch_src_global generation:  0.0013775825500488281
r_  generation:  0.01073598861694336
local_output_nid generation:  0.0022335052490234375
local_in_edges_tensor generation:  0.0010833740234375
mini_batch_src_global generation:  0.001312255859375
r_  generation:  0.010562896728515625
local_output_nid generation:  0.002209901809692383
local_in_edges_tensor generation:  0.001116037368774414
mini_batch_src_global generation:  0.0014328956604003906
r_  generation:  0.010690450668334961
local_output_nid generation:  0.0022096633911132812
local_in_edges_tensor generation:  0.0014622211456298828
mini_batch_src_global generation:  0.004224538803100586
r_  generation:  0.017479419708251953
local_output_nid generation:  0.002570629119873047
local_in_edges_tensor generation:  0.0012030601501464844
mini_batch_src_global generation:  0.0014009475708007812
r_  generation:  0.010959863662719727
local_output_nid generation:  0.002197742462158203
local_in_edges_tensor generation:  0.0009951591491699219
mini_batch_src_global generation:  0.0012242794036865234
r_  generation:  0.010543107986450195
local_output_nid generation:  0.0020904541015625
local_in_edges_tensor generation:  0.0010075569152832031
mini_batch_src_global generation:  0.0011348724365234375
r_  generation:  0.010387420654296875
local_output_nid generation:  0.0019996166229248047
local_in_edges_tensor generation:  0.0009412765502929688
mini_batch_src_global generation:  0.0011456012725830078
r_  generation:  0.010790348052978516
local_output_nid generation:  0.0019571781158447266
local_in_edges_tensor generation:  0.0009002685546875
mini_batch_src_global generation:  0.0011239051818847656
r_  generation:  0.010482549667358398
local_output_nid generation:  0.0019042491912841797
local_in_edges_tensor generation:  0.0009105205535888672
mini_batch_src_global generation:  0.0012121200561523438
r_  generation:  0.01074981689453125
local_output_nid generation:  0.0018994808197021484
local_in_edges_tensor generation:  0.0009567737579345703
mini_batch_src_global generation:  0.0011479854583740234
r_  generation:  0.010412454605102539
local_output_nid generation:  0.0018453598022460938
local_in_edges_tensor generation:  0.0009138584136962891
mini_batch_src_global generation:  0.0011794567108154297
r_  generation:  0.010379314422607422
local_output_nid generation:  0.0018050670623779297
local_in_edges_tensor generation:  0.0008792877197265625
mini_batch_src_global generation:  0.0011265277862548828
r_  generation:  0.010440349578857422
local_output_nid generation:  0.0018079280853271484
local_in_edges_tensor generation:  0.000881195068359375
mini_batch_src_global generation:  0.001092672348022461
r_  generation:  0.010185480117797852
local_output_nid generation:  0.0017404556274414062
local_in_edges_tensor generation:  0.0008780956268310547
mini_batch_src_global generation:  0.0012650489807128906
r_  generation:  0.010373592376708984
local_output_nid generation:  0.0017638206481933594
local_in_edges_tensor generation:  0.0008478164672851562
mini_batch_src_global generation:  0.001117706298828125
r_  generation:  0.010309457778930664
local_output_nid generation:  0.001703023910522461
local_in_edges_tensor generation:  0.0009703636169433594
mini_batch_src_global generation:  0.0012526512145996094
r_  generation:  0.010471343994140625
local_output_nid generation:  0.0016875267028808594
local_in_edges_tensor generation:  0.0009522438049316406
mini_batch_src_global generation:  0.0011234283447265625
r_  generation:  0.010156869888305664
local_output_nid generation:  0.0016825199127197266
local_in_edges_tensor generation:  0.0009052753448486328
mini_batch_src_global generation:  0.0011398792266845703
r_  generation:  0.01042628288269043
local_output_nid generation:  0.001726388931274414
local_in_edges_tensor generation:  0.0009014606475830078
mini_batch_src_global generation:  0.0011146068572998047
r_  generation:  0.010172843933105469
local_output_nid generation:  0.0016591548919677734
local_in_edges_tensor generation:  0.0008778572082519531
mini_batch_src_global generation:  0.0011677742004394531
r_  generation:  0.010277986526489258
local_output_nid generation:  0.0016355514526367188
local_in_edges_tensor generation:  0.0008766651153564453
mini_batch_src_global generation:  0.0011074542999267578
r_  generation:  0.009969472885131836
local_output_nid generation:  0.0016405582427978516
local_in_edges_tensor generation:  0.0009222030639648438
mini_batch_src_global generation:  0.0011126995086669922
r_  generation:  0.010502338409423828
local_output_nid generation:  0.0016155242919921875
local_in_edges_tensor generation:  0.0009145736694335938
mini_batch_src_global generation:  0.0011680126190185547
r_  generation:  0.010179996490478516
local_output_nid generation:  0.0016140937805175781
local_in_edges_tensor generation:  0.0009455680847167969
mini_batch_src_global generation:  0.0011608600616455078
r_  generation:  0.010536909103393555
local_output_nid generation:  0.0016088485717773438
local_in_edges_tensor generation:  0.0009036064147949219
mini_batch_src_global generation:  0.0011565685272216797
r_  generation:  0.010234355926513672
local_output_nid generation:  0.0015783309936523438
local_in_edges_tensor generation:  0.0008862018585205078
mini_batch_src_global generation:  0.0010943412780761719
r_  generation:  0.010280370712280273
----------------------check_connections_block total spend ----------------------------- 0.6119914054870605
generate_one_block  0.02106761932373047
generate_one_block  0.02185344696044922
generate_one_block  0.019949913024902344
generate_one_block  0.019286394119262695
generate_one_block  0.018223047256469727
generate_one_block  0.0187685489654541
generate_one_block  0.018569469451904297
generate_one_block  0.018918991088867188
generate_one_block  0.018938779830932617
generate_one_block  0.018782377243041992
generate_one_block  0.018882036209106445
generate_one_block  0.021187305450439453
generate_one_block  0.020328521728515625
generate_one_block  0.01854991912841797
generate_one_block  0.01890110969543457
generate_one_block  0.018496990203857422
generate_one_block  0.01874065399169922
generate_one_block  0.018698453903198242
generate_one_block  0.018306970596313477
generate_one_block  0.018446683883666992
generate_one_block  0.018443822860717773
generate_one_block  0.01841902732849121
generate_one_block  0.01822185516357422
generate_one_block  0.01803874969482422
generate_one_block  0.018244504928588867
generate_one_block  0.018030643463134766
generate_one_block  0.01784062385559082
generate_one_block  0.02139449119567871
generate_one_block  0.01858663558959961
generate_one_block  0.01889944076538086
generate_one_block  0.018373489379882812
generate_one_block  0.01811385154724121
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03809547424316406
gen group dst list time:  0.02115154266357422
time for parepare:  0.020445823669433594
local_output_nid generation:  0.006691455841064453
local_in_edges_tensor generation:  0.016955852508544922
mini_batch_src_global generation:  0.017048120498657227
r_  generation:  0.16696691513061523
local_output_nid generation:  0.009308338165283203
local_in_edges_tensor generation:  0.013830423355102539
mini_batch_src_global generation:  0.0229494571685791
r_  generation:  0.17718505859375
local_output_nid generation:  0.009315013885498047
local_in_edges_tensor generation:  0.03670907020568848
mini_batch_src_global generation:  0.0212247371673584
r_  generation:  0.18583130836486816
local_output_nid generation:  0.011130571365356445
local_in_edges_tensor generation:  0.011695146560668945
mini_batch_src_global generation:  0.021728515625
r_  generation:  0.21358680725097656
local_output_nid generation:  0.012380599975585938
local_in_edges_tensor generation:  0.012324333190917969
mini_batch_src_global generation:  0.02562713623046875
r_  generation:  0.17586207389831543
local_output_nid generation:  0.009897947311401367
local_in_edges_tensor generation:  0.012082576751708984
mini_batch_src_global generation:  0.023337364196777344
r_  generation:  0.18016910552978516
local_output_nid generation:  0.009573698043823242
local_in_edges_tensor generation:  0.010644674301147461
mini_batch_src_global generation:  0.022942304611206055
r_  generation:  0.18211722373962402
local_output_nid generation:  0.00941324234008789
local_in_edges_tensor generation:  0.010815143585205078
mini_batch_src_global generation:  0.022679805755615234
r_  generation:  0.18163037300109863
local_output_nid generation:  0.009435176849365234
local_in_edges_tensor generation:  0.009758710861206055
mini_batch_src_global generation:  0.023320674896240234
r_  generation:  0.18454790115356445
local_output_nid generation:  0.0098419189453125
local_in_edges_tensor generation:  0.012136220932006836
mini_batch_src_global generation:  0.02308511734008789
r_  generation:  0.18194055557250977
local_output_nid generation:  0.009976625442504883
local_in_edges_tensor generation:  0.009082555770874023
mini_batch_src_global generation:  0.024506092071533203
r_  generation:  0.18756771087646484
local_output_nid generation:  0.00964975357055664
local_in_edges_tensor generation:  0.008835315704345703
mini_batch_src_global generation:  0.02288651466369629
r_  generation:  0.17909955978393555
local_output_nid generation:  0.010130882263183594
local_in_edges_tensor generation:  0.009387969970703125
mini_batch_src_global generation:  0.02461838722229004
r_  generation:  0.19108176231384277
local_output_nid generation:  0.00970911979675293
local_in_edges_tensor generation:  0.008997917175292969
mini_batch_src_global generation:  0.023554325103759766
r_  generation:  0.18439650535583496
local_output_nid generation:  0.009737014770507812
local_in_edges_tensor generation:  0.009020566940307617
mini_batch_src_global generation:  0.023758888244628906
r_  generation:  0.19223260879516602
local_output_nid generation:  0.010037660598754883
local_in_edges_tensor generation:  0.009363651275634766
mini_batch_src_global generation:  0.023712873458862305
r_  generation:  0.18854951858520508
local_output_nid generation:  0.011627197265625
local_in_edges_tensor generation:  0.009145498275756836
mini_batch_src_global generation:  0.023306608200073242
r_  generation:  0.1875929832458496
local_output_nid generation:  0.00996541976928711
local_in_edges_tensor generation:  0.009016275405883789
mini_batch_src_global generation:  0.02327871322631836
r_  generation:  0.1859443187713623
local_output_nid generation:  0.00974130630493164
local_in_edges_tensor generation:  0.00906229019165039
mini_batch_src_global generation:  0.02333855628967285
r_  generation:  0.18718981742858887
local_output_nid generation:  0.009776115417480469
local_in_edges_tensor generation:  0.00914621353149414
mini_batch_src_global generation:  0.023321866989135742
r_  generation:  0.18699240684509277
local_output_nid generation:  0.010842323303222656
local_in_edges_tensor generation:  0.009166955947875977
mini_batch_src_global generation:  0.02331995964050293
r_  generation:  0.18673133850097656
local_output_nid generation:  0.009852886199951172
local_in_edges_tensor generation:  0.011293649673461914
mini_batch_src_global generation:  0.022726774215698242
r_  generation:  0.18524789810180664
local_output_nid generation:  0.009808063507080078
local_in_edges_tensor generation:  0.01177072525024414
mini_batch_src_global generation:  0.02361893653869629
r_  generation:  0.18523716926574707
local_output_nid generation:  0.009786605834960938
local_in_edges_tensor generation:  0.010033130645751953
mini_batch_src_global generation:  0.023002147674560547
r_  generation:  0.1900498867034912
local_output_nid generation:  0.009837150573730469
local_in_edges_tensor generation:  0.013589859008789062
mini_batch_src_global generation:  0.023118257522583008
r_  generation:  0.18320035934448242
local_output_nid generation:  0.009620189666748047
local_in_edges_tensor generation:  0.010473012924194336
mini_batch_src_global generation:  0.022333145141601562
r_  generation:  0.1788647174835205
local_output_nid generation:  0.009551763534545898
local_in_edges_tensor generation:  0.011736631393432617
mini_batch_src_global generation:  0.022957801818847656
r_  generation:  0.17643260955810547
local_output_nid generation:  0.00990915298461914
local_in_edges_tensor generation:  0.010335683822631836
mini_batch_src_global generation:  0.024538516998291016
r_  generation:  0.18723034858703613
local_output_nid generation:  0.009826183319091797
local_in_edges_tensor generation:  0.009133100509643555
mini_batch_src_global generation:  0.022938966751098633
r_  generation:  0.1818218231201172
local_output_nid generation:  0.009923934936523438
local_in_edges_tensor generation:  0.00920557975769043
mini_batch_src_global generation:  0.02401566505432129
r_  generation:  0.18387603759765625
local_output_nid generation:  0.009929180145263672
local_in_edges_tensor generation:  0.009660482406616211
mini_batch_src_global generation:  0.02299022674560547
r_  generation:  0.18970823287963867
local_output_nid generation:  0.009727239608764648
local_in_edges_tensor generation:  0.015717506408691406
mini_batch_src_global generation:  0.022954225540161133
r_  generation:  0.1837749481201172
----------------------check_connections_block total spend ----------------------------- 8.701375007629395
generate_one_block  0.26339149475097656
generate_one_block  0.25974345207214355
generate_one_block  0.2556953430175781
generate_one_block  0.2522847652435303
generate_one_block  0.2592892646789551
generate_one_block  0.24666261672973633
generate_one_block  0.24834394454956055
generate_one_block  0.24967622756958008
generate_one_block  0.25016021728515625
generate_one_block  0.2492079734802246
generate_one_block  0.27223682403564453
generate_one_block  0.25037336349487305
generate_one_block  0.2597784996032715
generate_one_block  0.2526071071624756
generate_one_block  0.2594473361968994
generate_one_block  0.25571107864379883
generate_one_block  0.25319480895996094
generate_one_block  0.2516472339630127
generate_one_block  0.24906063079833984
generate_one_block  0.25728344917297363
generate_one_block  0.25165319442749023
generate_one_block  0.2500483989715576
generate_one_block  0.24838590621948242
generate_one_block  0.25164103507995605
generate_one_block  0.24678659439086914
generate_one_block  0.24317002296447754
generate_one_block  0.2430410385131836
generate_one_block  0.25596094131469727
generate_one_block  0.24608254432678223
generate_one_block  0.2514655590057373
generate_one_block  0.24923110008239746
generate_one_block  0.24385952949523926
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03850507736206055
gen group dst list time:  0.11666417121887207
time for parepare:  0.02127838134765625
local_output_nid generation:  0.02641463279724121
local_in_edges_tensor generation:  0.05413675308227539
mini_batch_src_global generation:  0.047043561935424805
r_  generation:  0.4907376766204834
local_output_nid generation:  0.0323481559753418
local_in_edges_tensor generation:  0.039754629135131836
mini_batch_src_global generation:  0.061625003814697266
r_  generation:  0.49030232429504395
local_output_nid generation:  0.03211379051208496
local_in_edges_tensor generation:  0.03367328643798828
mini_batch_src_global generation:  0.05732297897338867
r_  generation:  0.49927639961242676
local_output_nid generation:  0.03261923789978027
local_in_edges_tensor generation:  0.031911373138427734
mini_batch_src_global generation:  0.05863666534423828
r_  generation:  0.4919595718383789
local_output_nid generation:  0.031879425048828125
local_in_edges_tensor generation:  0.03876018524169922
mini_batch_src_global generation:  0.060419559478759766
r_  generation:  0.4962940216064453
local_output_nid generation:  0.0321202278137207
local_in_edges_tensor generation:  0.03309154510498047
mini_batch_src_global generation:  0.06006598472595215
r_  generation:  0.4952657222747803
local_output_nid generation:  0.03041672706604004
local_in_edges_tensor generation:  0.02975010871887207
mini_batch_src_global generation:  0.058257341384887695
r_  generation:  0.5105946063995361
local_output_nid generation:  0.029813766479492188
local_in_edges_tensor generation:  0.030159473419189453
mini_batch_src_global generation:  0.059262752532958984
r_  generation:  0.49929332733154297
local_output_nid generation:  0.03056502342224121
local_in_edges_tensor generation:  0.0340573787689209
mini_batch_src_global generation:  0.058968544006347656
r_  generation:  0.507159948348999
local_output_nid generation:  0.030093908309936523
local_in_edges_tensor generation:  0.03780341148376465
mini_batch_src_global generation:  0.06223607063293457
r_  generation:  0.5028667449951172
local_output_nid generation:  0.03049492835998535
local_in_edges_tensor generation:  0.038308143615722656
mini_batch_src_global generation:  0.0589137077331543
r_  generation:  0.503342866897583
local_output_nid generation:  0.03000020980834961
local_in_edges_tensor generation:  0.03441143035888672
mini_batch_src_global generation:  0.060175180435180664
r_  generation:  0.4971907138824463
local_output_nid generation:  0.02995014190673828
local_in_edges_tensor generation:  0.029612302780151367
mini_batch_src_global generation:  0.05922508239746094
r_  generation:  0.5077428817749023
local_output_nid generation:  0.029772043228149414
local_in_edges_tensor generation:  0.03174185752868652
mini_batch_src_global generation:  0.05985260009765625
r_  generation:  0.5020170211791992
local_output_nid generation:  0.02981090545654297
local_in_edges_tensor generation:  0.032492876052856445
mini_batch_src_global generation:  0.05860137939453125
r_  generation:  0.5057978630065918
local_output_nid generation:  0.031113624572753906
local_in_edges_tensor generation:  0.031256675720214844
mini_batch_src_global generation:  0.06223726272583008
r_  generation:  0.5100469589233398
local_output_nid generation:  0.030256271362304688
local_in_edges_tensor generation:  0.033457040786743164
mini_batch_src_global generation:  0.0584874153137207
r_  generation:  0.5052218437194824
local_output_nid generation:  0.030344247817993164
local_in_edges_tensor generation:  0.034525156021118164
mini_batch_src_global generation:  0.06226205825805664
r_  generation:  0.5047397613525391
local_output_nid generation:  0.029781103134155273
local_in_edges_tensor generation:  0.040546417236328125
mini_batch_src_global generation:  0.06059145927429199
r_  generation:  0.49976634979248047
local_output_nid generation:  0.02985072135925293
local_in_edges_tensor generation:  0.03406929969787598
mini_batch_src_global generation:  0.059636592864990234
r_  generation:  0.5174598693847656
local_output_nid generation:  0.03218555450439453
local_in_edges_tensor generation:  0.03880119323730469
mini_batch_src_global generation:  0.06209301948547363
r_  generation:  0.5041570663452148
local_output_nid generation:  0.03323936462402344
local_in_edges_tensor generation:  0.031169891357421875
mini_batch_src_global generation:  0.05939531326293945
r_  generation:  0.4945557117462158
local_output_nid generation:  0.030809879302978516
local_in_edges_tensor generation:  0.03029918670654297
mini_batch_src_global generation:  0.05841255187988281
r_  generation:  0.4989433288574219
local_output_nid generation:  0.030790328979492188
local_in_edges_tensor generation:  0.030684232711791992
mini_batch_src_global generation:  0.05954170227050781
r_  generation:  0.49427294731140137
local_output_nid generation:  0.03124856948852539
local_in_edges_tensor generation:  0.0322873592376709
mini_batch_src_global generation:  0.05825185775756836
r_  generation:  0.5114507675170898
local_output_nid generation:  0.030533552169799805
local_in_edges_tensor generation:  0.02863478660583496
mini_batch_src_global generation:  0.05939221382141113
r_  generation:  0.50433349609375
local_output_nid generation:  0.030231952667236328
local_in_edges_tensor generation:  0.0289151668548584
mini_batch_src_global generation:  0.05768227577209473
r_  generation:  0.49610400199890137
local_output_nid generation:  0.030459880828857422
local_in_edges_tensor generation:  0.030887126922607422
mini_batch_src_global generation:  0.06163477897644043
r_  generation:  0.4982032775878906
local_output_nid generation:  0.03076934814453125
local_in_edges_tensor generation:  0.03089737892150879
mini_batch_src_global generation:  0.05856013298034668
r_  generation:  0.5051393508911133
local_output_nid generation:  0.030637264251708984
local_in_edges_tensor generation:  0.030815839767456055
mini_batch_src_global generation:  0.059413909912109375
r_  generation:  0.4983837604522705
local_output_nid generation:  0.030835628509521484
local_in_edges_tensor generation:  0.03143501281738281
mini_batch_src_global generation:  0.05866360664367676
r_  generation:  0.5059385299682617
local_output_nid generation:  0.031083106994628906
local_in_edges_tensor generation:  0.036421775817871094
mini_batch_src_global generation:  0.059890031814575195
r_  generation:  0.5063846111297607
----------------------check_connections_block total spend ----------------------------- 23.501823902130127
generate_one_block  0.6999862194061279
generate_one_block  0.6829755306243896
generate_one_block  0.682476282119751
generate_one_block  0.6813280582427979
generate_one_block  0.7873420715332031
generate_one_block  0.6840159893035889
generate_one_block  0.6809923648834229
generate_one_block  0.6828756332397461
generate_one_block  0.6870579719543457
generate_one_block  0.6764504909515381
generate_one_block  0.6831629276275635
generate_one_block  0.6816079616546631
generate_one_block  0.6868560314178467
generate_one_block  0.6806626319885254
generate_one_block  0.6797585487365723
generate_one_block  0.6815600395202637
generate_one_block  0.6822662353515625
generate_one_block  0.6855950355529785
generate_one_block  0.682880163192749
generate_one_block  0.6795189380645752
generate_one_block  0.6918542385101318
generate_one_block  0.6755270957946777
generate_one_block  0.6704039573669434
generate_one_block  0.6837306022644043
generate_one_block  0.7000741958618164
generate_one_block  0.6733036041259766
generate_one_block  0.674267053604126
generate_one_block  0.6811161041259766
generate_one_block  0.688359260559082
generate_one_block  0.6751279830932617
generate_one_block  0.6851134300231934
generate_one_block  0.691115140914917
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 0.1305689811706543  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

connection checking time:  32.20319890975952
block generation total time  30.03648328781128
average batch blocks generation time:  0.9386401027441025
block dataloader generation time/epoch 65.8403325361364
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 0.10923099517822266  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 20.698840618133545  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 0.10946941375732422  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 20.954516410827637  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 0.10923147201538086  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 21.044195652008057  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 0.10944223403930664  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 21.027708530426025  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 0.10890913009643555  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 20.553292274475098  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 0.10920524597167969  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 20.81893539428711  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 0.1090855598449707  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 20.820379734039307  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 0.109130859375  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 20.788670539855957  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 0.10972404479980469  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 21.007930755615234  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 0.1089167594909668  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 20.725066661834717  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 0.1092681884765625  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 21.112950801849365  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 0.10908746719360352  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 20.57687520980835  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 0.1095576286315918  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 21.172561168670654  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 0.1090250015258789  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 20.761837005615234  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 0.10889053344726562  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2947998046875 GB
    Memory Allocated: 21.017890453338623  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10948371887207031  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.945087432861328  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10936975479125977  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.935534477233887  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10951423645019531  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.865952014923096  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.1091160774230957  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.5917067527771  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.1089940071105957  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.72317600250244  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10931158065795898  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.66531276702881  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10896587371826172  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.540725708007812  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10907983779907227  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.470036506652832  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.1090855598449707  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.715392589569092  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10924053192138672  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.599133014678955  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10877084732055664  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.42203712463379  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.1085047721862793  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.15257453918457  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.1090993881225586  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.922844886779785  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.1093149185180664  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.671003341674805  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.108917236328125  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.712918281555176  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10931587219238281  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.726271152496338  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.1092991828918457  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.600274085998535  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0369734913110733 |0.022022701799869537 |0.6345363929867744 |9.560585021972656e-05 |1.2050963416695595 |0.00954294204711914 |
----------------------------------------------------------pseudo_mini_loss sum 1.2828866243362427
Total (block generation + training)time/epoch 126.63484214333927
Training time/epoch 60.82808971405029
Training time without block to device /epoch 60.12336325645447
Training time without total dataloading part /epoch 58.880849838256836
load block tensor time/epoch 1.1831517219543457
block to device time/epoch 0.7047264575958252
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 26 |
Number of nodes for computation during this epoch:  9155420
Number of first layer input nodes during this epoch:  4805821
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.1310882568359375  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026052474975585938
random selection method range initialization spend 0.005324840545654297
time for parepare:  0.02094578742980957
local_output_nid generation:  0.001432657241821289
local_in_edges_tensor generation:  0.00841832160949707
mini_batch_src_global generation:  0.0017228126525878906
r_  generation:  0.011234760284423828
local_output_nid generation:  0.0015985965728759766
local_in_edges_tensor generation:  0.0011334419250488281
mini_batch_src_global generation:  0.0014646053314208984
r_  generation:  0.010514974594116211
local_output_nid generation:  0.0016241073608398438
local_in_edges_tensor generation:  0.0009617805480957031
mini_batch_src_global generation:  0.0011534690856933594
r_  generation:  0.010229110717773438
local_output_nid generation:  0.0016074180603027344
local_in_edges_tensor generation:  0.0009679794311523438
mini_batch_src_global generation:  0.0011827945709228516
r_  generation:  0.010249137878417969
local_output_nid generation:  0.0016150474548339844
local_in_edges_tensor generation:  0.0009071826934814453
mini_batch_src_global generation:  0.0011246204376220703
r_  generation:  0.010326147079467773
local_output_nid generation:  0.0016057491302490234
local_in_edges_tensor generation:  0.0009272098541259766
mini_batch_src_global generation:  0.0011565685272216797
r_  generation:  0.010246515274047852
local_output_nid generation:  0.0015912055969238281
local_in_edges_tensor generation:  0.0009462833404541016
mini_batch_src_global generation:  0.001125335693359375
r_  generation:  0.010037660598754883
local_output_nid generation:  0.0016045570373535156
local_in_edges_tensor generation:  0.0009188652038574219
mini_batch_src_global generation:  0.0011181831359863281
r_  generation:  0.010236978530883789
local_output_nid generation:  0.001596212387084961
local_in_edges_tensor generation:  0.0009012222290039062
mini_batch_src_global generation:  0.0010788440704345703
r_  generation:  0.01006007194519043
local_output_nid generation:  0.0015869140625
local_in_edges_tensor generation:  0.0008842945098876953
mini_batch_src_global generation:  0.0012271404266357422
r_  generation:  0.01010751724243164
local_output_nid generation:  0.0015780925750732422
local_in_edges_tensor generation:  0.0008671283721923828
mini_batch_src_global generation:  0.0011050701141357422
r_  generation:  0.010092973709106445
local_output_nid generation:  0.0015897750854492188
local_in_edges_tensor generation:  0.0008950233459472656
mini_batch_src_global generation:  0.001108407974243164
r_  generation:  0.010157346725463867
local_output_nid generation:  0.0015556812286376953
local_in_edges_tensor generation:  0.0008628368377685547
mini_batch_src_global generation:  0.0010974407196044922
r_  generation:  0.010354995727539062
local_output_nid generation:  0.0015702247619628906
local_in_edges_tensor generation:  0.0008835792541503906
mini_batch_src_global generation:  0.001216888427734375
r_  generation:  0.010449409484863281
local_output_nid generation:  0.0015950202941894531
local_in_edges_tensor generation:  0.0008780956268310547
mini_batch_src_global generation:  0.0011355876922607422
r_  generation:  0.010747909545898438
local_output_nid generation:  0.0015611648559570312
local_in_edges_tensor generation:  0.0008497238159179688
mini_batch_src_global generation:  0.001127481460571289
r_  generation:  0.010189294815063477
local_output_nid generation:  0.001561880111694336
local_in_edges_tensor generation:  0.0010726451873779297
mini_batch_src_global generation:  0.0012357234954833984
r_  generation:  0.010386228561401367
local_output_nid generation:  0.0015811920166015625
local_in_edges_tensor generation:  0.0008490085601806641
mini_batch_src_global generation:  0.0011920928955078125
r_  generation:  0.010469198226928711
local_output_nid generation:  0.0015530586242675781
local_in_edges_tensor generation:  0.0008955001831054688
mini_batch_src_global generation:  0.0011599063873291016
r_  generation:  0.0104522705078125
local_output_nid generation:  0.001562356948852539
local_in_edges_tensor generation:  0.0009067058563232422
mini_batch_src_global generation:  0.0011305809020996094
r_  generation:  0.010329961776733398
local_output_nid generation:  0.0015764236450195312
local_in_edges_tensor generation:  0.0008640289306640625
mini_batch_src_global generation:  0.001081705093383789
r_  generation:  0.009803295135498047
local_output_nid generation:  0.0015659332275390625
local_in_edges_tensor generation:  0.0009620189666748047
mini_batch_src_global generation:  0.0012145042419433594
r_  generation:  0.010477542877197266
local_output_nid generation:  0.0015728473663330078
local_in_edges_tensor generation:  0.0009069442749023438
mini_batch_src_global generation:  0.0011165142059326172
r_  generation:  0.01051640510559082
local_output_nid generation:  0.0015952587127685547
local_in_edges_tensor generation:  0.0008523464202880859
mini_batch_src_global generation:  0.0011324882507324219
r_  generation:  0.010061502456665039
local_output_nid generation:  0.001558542251586914
local_in_edges_tensor generation:  0.0008547306060791016
mini_batch_src_global generation:  0.0011944770812988281
r_  generation:  0.010597944259643555
local_output_nid generation:  0.001560211181640625
local_in_edges_tensor generation:  0.0009102821350097656
mini_batch_src_global generation:  0.0011835098266601562
r_  generation:  0.010448217391967773
local_output_nid generation:  0.0016007423400878906
local_in_edges_tensor generation:  0.0009109973907470703
mini_batch_src_global generation:  0.001107931137084961
r_  generation:  0.010274887084960938
local_output_nid generation:  0.0015606880187988281
local_in_edges_tensor generation:  0.0009262561798095703
mini_batch_src_global generation:  0.0011212825775146484
r_  generation:  0.010148048400878906
local_output_nid generation:  0.0015594959259033203
local_in_edges_tensor generation:  0.0008337497711181641
mini_batch_src_global generation:  0.0011184215545654297
r_  generation:  0.010182619094848633
local_output_nid generation:  0.0016021728515625
local_in_edges_tensor generation:  0.0008513927459716797
mini_batch_src_global generation:  0.0011053085327148438
r_  generation:  0.010405778884887695
local_output_nid generation:  0.001567840576171875
local_in_edges_tensor generation:  0.0009033679962158203
mini_batch_src_global generation:  0.0010783672332763672
r_  generation:  0.010359764099121094
local_output_nid generation:  0.0015652179718017578
local_in_edges_tensor generation:  0.0008952617645263672
mini_batch_src_global generation:  0.0010995864868164062
r_  generation:  0.010445117950439453
----------------------check_connections_block total spend ----------------------------- 0.5708098411560059
generate_one_block  0.022214889526367188
generate_one_block  0.021135330200195312
generate_one_block  0.019915342330932617
generate_one_block  0.019426345825195312
generate_one_block  0.01961660385131836
generate_one_block  0.018961668014526367
generate_one_block  0.018611907958984375
generate_one_block  0.018824338912963867
generate_one_block  0.01841259002685547
generate_one_block  0.018402814865112305
generate_one_block  0.018283367156982422
generate_one_block  0.021308422088623047
generate_one_block  0.01963329315185547
generate_one_block  0.019294023513793945
generate_one_block  0.01954483985900879
generate_one_block  0.01869678497314453
generate_one_block  0.018956899642944336
generate_one_block  0.02126479148864746
generate_one_block  0.01904153823852539
generate_one_block  0.018929719924926758
generate_one_block  0.017832517623901367
generate_one_block  0.01903843879699707
generate_one_block  0.01908254623413086
generate_one_block  0.019568443298339844
generate_one_block  0.019626140594482422
generate_one_block  0.01900315284729004
generate_one_block  0.01853322982788086
generate_one_block  0.018327951431274414
generate_one_block  0.021131038665771484
generate_one_block  0.0189511775970459
generate_one_block  0.018889904022216797
generate_one_block  0.018962383270263672
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03925943374633789
gen group dst list time:  0.026647567749023438
time for parepare:  0.022581100463867188
local_output_nid generation:  0.006907463073730469
local_in_edges_tensor generation:  0.02282857894897461
mini_batch_src_global generation:  0.019002199172973633
r_  generation:  0.17347216606140137
local_output_nid generation:  0.009154319763183594
local_in_edges_tensor generation:  0.012139320373535156
mini_batch_src_global generation:  0.02251291275024414
r_  generation:  0.1664576530456543
local_output_nid generation:  0.009322643280029297
local_in_edges_tensor generation:  0.03617238998413086
mini_batch_src_global generation:  0.02142047882080078
r_  generation:  0.17651987075805664
local_output_nid generation:  0.009719133377075195
local_in_edges_tensor generation:  0.010814428329467773
mini_batch_src_global generation:  0.022711753845214844
r_  generation:  0.1802976131439209
local_output_nid generation:  0.00989985466003418
local_in_edges_tensor generation:  0.011592626571655273
mini_batch_src_global generation:  0.022888660430908203
r_  generation:  0.1848607063293457
local_output_nid generation:  0.009738683700561523
local_in_edges_tensor generation:  0.01191568374633789
mini_batch_src_global generation:  0.023627042770385742
r_  generation:  0.17832255363464355
local_output_nid generation:  0.009353160858154297
local_in_edges_tensor generation:  0.011882781982421875
mini_batch_src_global generation:  0.023439884185791016
r_  generation:  0.18042683601379395
local_output_nid generation:  0.011245965957641602
local_in_edges_tensor generation:  0.010081768035888672
mini_batch_src_global generation:  0.022847652435302734
r_  generation:  0.18175983428955078
local_output_nid generation:  0.009100675582885742
local_in_edges_tensor generation:  0.009725570678710938
mini_batch_src_global generation:  0.022112607955932617
r_  generation:  0.1807079315185547
local_output_nid generation:  0.009664535522460938
local_in_edges_tensor generation:  0.0094146728515625
mini_batch_src_global generation:  0.022865772247314453
r_  generation:  0.17975425720214844
local_output_nid generation:  0.009647607803344727
local_in_edges_tensor generation:  0.009092569351196289
mini_batch_src_global generation:  0.02271723747253418
r_  generation:  0.18015527725219727
local_output_nid generation:  0.009522676467895508
local_in_edges_tensor generation:  0.009429693222045898
mini_batch_src_global generation:  0.023227930068969727
r_  generation:  0.18152832984924316
local_output_nid generation:  0.009841203689575195
local_in_edges_tensor generation:  0.009293556213378906
mini_batch_src_global generation:  0.022682905197143555
r_  generation:  0.18236565589904785
local_output_nid generation:  0.009613037109375
local_in_edges_tensor generation:  0.00935816764831543
mini_batch_src_global generation:  0.024330854415893555
r_  generation:  0.18242120742797852
local_output_nid generation:  0.00991678237915039
local_in_edges_tensor generation:  0.012207984924316406
mini_batch_src_global generation:  0.023667335510253906
r_  generation:  0.18790435791015625
local_output_nid generation:  0.009748458862304688
local_in_edges_tensor generation:  0.010149717330932617
mini_batch_src_global generation:  0.023710250854492188
r_  generation:  0.18548965454101562
local_output_nid generation:  0.009811878204345703
local_in_edges_tensor generation:  0.009806394577026367
mini_batch_src_global generation:  0.024232149124145508
r_  generation:  0.18796300888061523
local_output_nid generation:  0.009900569915771484
local_in_edges_tensor generation:  0.009516716003417969
mini_batch_src_global generation:  0.02419257164001465
r_  generation:  0.1894826889038086
local_output_nid generation:  0.009821414947509766
local_in_edges_tensor generation:  0.00937795639038086
mini_batch_src_global generation:  0.02271437644958496
r_  generation:  0.18268465995788574
local_output_nid generation:  0.009861469268798828
local_in_edges_tensor generation:  0.009001731872558594
mini_batch_src_global generation:  0.0230715274810791
r_  generation:  0.1788184642791748
local_output_nid generation:  0.009325504302978516
local_in_edges_tensor generation:  0.011582136154174805
mini_batch_src_global generation:  0.02249002456665039
r_  generation:  0.17470288276672363
local_output_nid generation:  0.009924173355102539
local_in_edges_tensor generation:  0.009512186050415039
mini_batch_src_global generation:  0.023542404174804688
r_  generation:  0.18771862983703613
local_output_nid generation:  0.009767770767211914
local_in_edges_tensor generation:  0.00916910171508789
mini_batch_src_global generation:  0.024693965911865234
r_  generation:  0.1860642433166504
local_output_nid generation:  0.009507179260253906
local_in_edges_tensor generation:  0.010144710540771484
mini_batch_src_global generation:  0.022310495376586914
r_  generation:  0.1754140853881836
local_output_nid generation:  0.010033369064331055
local_in_edges_tensor generation:  0.009264945983886719
mini_batch_src_global generation:  0.023362398147583008
r_  generation:  0.19127416610717773
local_output_nid generation:  0.009882926940917969
local_in_edges_tensor generation:  0.009544849395751953
mini_batch_src_global generation:  0.024014711380004883
r_  generation:  0.1879410743713379
local_output_nid generation:  0.009699583053588867
local_in_edges_tensor generation:  0.00942683219909668
mini_batch_src_global generation:  0.02320718765258789
r_  generation:  0.188124418258667
local_output_nid generation:  0.00966501235961914
local_in_edges_tensor generation:  0.009604692459106445
mini_batch_src_global generation:  0.02359914779663086
r_  generation:  0.18477129936218262
local_output_nid generation:  0.009616613388061523
local_in_edges_tensor generation:  0.00908803939819336
mini_batch_src_global generation:  0.02338719367980957
r_  generation:  0.18510198593139648
local_output_nid generation:  0.011705398559570312
local_in_edges_tensor generation:  0.009360074996948242
mini_batch_src_global generation:  0.024431943893432617
r_  generation:  0.18709945678710938
local_output_nid generation:  0.009737968444824219
local_in_edges_tensor generation:  0.013748407363891602
mini_batch_src_global generation:  0.023180007934570312
r_  generation:  0.18917179107666016
local_output_nid generation:  0.009813308715820312
local_in_edges_tensor generation:  0.009090662002563477
mini_batch_src_global generation:  0.02394580841064453
r_  generation:  0.187178373336792
----------------------check_connections_block total spend ----------------------------- 8.616994619369507
generate_one_block  0.2716083526611328
generate_one_block  0.24867582321166992
generate_one_block  0.2534499168395996
generate_one_block  0.25922369956970215
generate_one_block  0.2761707305908203
generate_one_block  0.24681639671325684
generate_one_block  0.24872469902038574
generate_one_block  0.24719548225402832
generate_one_block  0.24371671676635742
generate_one_block  0.24648785591125488
generate_one_block  0.2514028549194336
generate_one_block  0.24866485595703125
generate_one_block  0.2523918151855469
generate_one_block  0.251706600189209
generate_one_block  0.25269532203674316
generate_one_block  0.2530217170715332
generate_one_block  0.24985814094543457
generate_one_block  0.2536938190460205
generate_one_block  0.24621057510375977
generate_one_block  0.2490863800048828
generate_one_block  0.24259328842163086
generate_one_block  0.25795984268188477
generate_one_block  0.25187015533447266
generate_one_block  0.2475440502166748
generate_one_block  0.263110876083374
generate_one_block  0.2555692195892334
generate_one_block  0.25058960914611816
generate_one_block  0.24940872192382812
generate_one_block  0.24857401847839355
generate_one_block  0.25542163848876953
generate_one_block  0.2534751892089844
generate_one_block  0.25674009323120117
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0448145866394043
gen group dst list time:  0.11873936653137207
time for parepare:  0.02014446258544922
local_output_nid generation:  0.026595592498779297
local_in_edges_tensor generation:  0.054522037506103516
mini_batch_src_global generation:  0.04857325553894043
r_  generation:  0.49901819229125977
local_output_nid generation:  0.03149056434631348
local_in_edges_tensor generation:  0.038704872131347656
mini_batch_src_global generation:  0.061842918395996094
r_  generation:  0.48740506172180176
local_output_nid generation:  0.0316925048828125
local_in_edges_tensor generation:  0.038240671157836914
mini_batch_src_global generation:  0.06006765365600586
r_  generation:  0.505742073059082
local_output_nid generation:  0.03159666061401367
local_in_edges_tensor generation:  0.03795576095581055
mini_batch_src_global generation:  0.06170177459716797
r_  generation:  0.5009069442749023
local_output_nid generation:  0.03174424171447754
local_in_edges_tensor generation:  0.03209662437438965
mini_batch_src_global generation:  0.05884528160095215
r_  generation:  0.5077061653137207
local_output_nid generation:  0.032308101654052734
local_in_edges_tensor generation:  0.03273129463195801
mini_batch_src_global generation:  0.06250619888305664
r_  generation:  0.4972703456878662
local_output_nid generation:  0.030507802963256836
local_in_edges_tensor generation:  0.0358586311340332
mini_batch_src_global generation:  0.05882740020751953
r_  generation:  0.5056231021881104
local_output_nid generation:  0.030142784118652344
local_in_edges_tensor generation:  0.038553714752197266
mini_batch_src_global generation:  0.06212782859802246
r_  generation:  0.4970710277557373
local_output_nid generation:  0.03035283088684082
local_in_edges_tensor generation:  0.03670001029968262
mini_batch_src_global generation:  0.060869455337524414
r_  generation:  0.5059161186218262
local_output_nid generation:  0.02972698211669922
local_in_edges_tensor generation:  0.03897356986999512
mini_batch_src_global generation:  0.06006336212158203
r_  generation:  0.5178203582763672
local_output_nid generation:  0.03258013725280762
local_in_edges_tensor generation:  0.031682729721069336
mini_batch_src_global generation:  0.061540842056274414
r_  generation:  0.5034668445587158
local_output_nid generation:  0.031228303909301758
local_in_edges_tensor generation:  0.03390693664550781
mini_batch_src_global generation:  0.06104230880737305
r_  generation:  0.5049970149993896
local_output_nid generation:  0.03086996078491211
local_in_edges_tensor generation:  0.03107285499572754
mini_batch_src_global generation:  0.059702396392822266
r_  generation:  0.5018117427825928
local_output_nid generation:  0.030644655227661133
local_in_edges_tensor generation:  0.03037238121032715
mini_batch_src_global generation:  0.0604550838470459
r_  generation:  0.49854016304016113
local_output_nid generation:  0.03087019920349121
local_in_edges_tensor generation:  0.03809714317321777
mini_batch_src_global generation:  0.060921669006347656
r_  generation:  0.5025651454925537
local_output_nid generation:  0.030694961547851562
local_in_edges_tensor generation:  0.03783774375915527
mini_batch_src_global generation:  0.06096196174621582
r_  generation:  0.5004067420959473
local_output_nid generation:  0.03030109405517578
local_in_edges_tensor generation:  0.029194116592407227
mini_batch_src_global generation:  0.05909609794616699
r_  generation:  0.5006554126739502
local_output_nid generation:  0.04221320152282715
local_in_edges_tensor generation:  0.029425859451293945
mini_batch_src_global generation:  0.06009554862976074
r_  generation:  0.4965646266937256
local_output_nid generation:  0.03045034408569336
local_in_edges_tensor generation:  0.029491186141967773
mini_batch_src_global generation:  0.061989545822143555
r_  generation:  0.5001809597015381
local_output_nid generation:  0.03034043312072754
local_in_edges_tensor generation:  0.030942916870117188
mini_batch_src_global generation:  0.06067633628845215
r_  generation:  0.49626684188842773
local_output_nid generation:  0.03003096580505371
local_in_edges_tensor generation:  0.03475213050842285
mini_batch_src_global generation:  0.058789730072021484
r_  generation:  0.4987173080444336
local_output_nid generation:  0.030437707901000977
local_in_edges_tensor generation:  0.03213787078857422
mini_batch_src_global generation:  0.06061863899230957
r_  generation:  0.5015561580657959
local_output_nid generation:  0.03029465675354004
local_in_edges_tensor generation:  0.031183242797851562
mini_batch_src_global generation:  0.08005833625793457
r_  generation:  0.5106179714202881
local_output_nid generation:  0.030482053756713867
local_in_edges_tensor generation:  0.0324099063873291
mini_batch_src_global generation:  0.06264185905456543
r_  generation:  0.49896979331970215
local_output_nid generation:  0.030558347702026367
local_in_edges_tensor generation:  0.0324251651763916
mini_batch_src_global generation:  0.05978822708129883
r_  generation:  0.5141162872314453
local_output_nid generation:  0.031115055084228516
local_in_edges_tensor generation:  0.03591632843017578
mini_batch_src_global generation:  0.06233835220336914
r_  generation:  0.5130214691162109
local_output_nid generation:  0.030808687210083008
local_in_edges_tensor generation:  0.034169912338256836
mini_batch_src_global generation:  0.05937671661376953
r_  generation:  0.5051100254058838
local_output_nid generation:  0.0303800106048584
local_in_edges_tensor generation:  0.029114723205566406
mini_batch_src_global generation:  0.06032752990722656
r_  generation:  0.49738359451293945
local_output_nid generation:  0.030347585678100586
local_in_edges_tensor generation:  0.03188467025756836
mini_batch_src_global generation:  0.05917954444885254
r_  generation:  0.522695779800415
local_output_nid generation:  0.03346657752990723
local_in_edges_tensor generation:  0.03852963447570801
mini_batch_src_global generation:  0.06705188751220703
r_  generation:  0.5017249584197998
local_output_nid generation:  0.030703306198120117
local_in_edges_tensor generation:  0.03607177734375
mini_batch_src_global generation:  0.05925583839416504
r_  generation:  0.5058646202087402
local_output_nid generation:  0.030521631240844727
local_in_edges_tensor generation:  0.030696392059326172
mini_batch_src_global generation:  0.06046724319458008
r_  generation:  0.519927978515625
----------------------check_connections_block total spend ----------------------------- 23.72827959060669
generate_one_block  0.7074012756347656
generate_one_block  0.6874535083770752
generate_one_block  0.682403564453125
generate_one_block  0.6937212944030762
generate_one_block  0.8075761795043945
generate_one_block  0.6900162696838379
generate_one_block  0.6934919357299805
generate_one_block  0.694983959197998
generate_one_block  0.6943135261535645
generate_one_block  0.68033766746521
generate_one_block  0.6831550598144531
generate_one_block  0.6810672283172607
generate_one_block  0.6838066577911377
generate_one_block  0.6884260177612305
generate_one_block  0.6836698055267334
generate_one_block  0.6887786388397217
generate_one_block  0.6851000785827637
generate_one_block  0.6836380958557129
generate_one_block  0.6834826469421387
generate_one_block  0.6814901828765869
generate_one_block  0.6861677169799805
generate_one_block  0.6955418586730957
generate_one_block  0.6895499229431152
generate_one_block  0.6795129776000977
generate_one_block  0.7168569564819336
generate_one_block  0.6927914619445801
generate_one_block  0.6846234798431396
generate_one_block  0.6855800151824951
generate_one_block  0.6885478496551514
generate_one_block  0.6813597679138184
generate_one_block  0.6805229187011719
generate_one_block  0.6828811168670654
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.1310882568359375  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

connection checking time:  32.345274209976196
block generation total time  30.22190809249878
average batch blocks generation time:  0.9444346278905869
block dataloader generation time/epoch 65.86741054058075
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10953760147094727  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 21.193223476409912  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10885095596313477  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.36523675918579  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10958147048950195  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.855565071105957  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10913658142089844  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.99038791656494  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10929059982299805  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 21.101370811462402  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10882091522216797  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.65495491027832  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10910558700561523  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.73374366760254  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10899066925048828  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.654794216156006  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10893917083740234  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.517425060272217  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.1089324951171875  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.610936164855957  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10894250869750977  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.603514194488525  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10924482345581055  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.736746311187744  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10921669006347656  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.727120399475098  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10898208618164062  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.688918113708496  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10948038101196289  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 21.070306301116943  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10933065414428711  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.964090824127197  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10904693603515625  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.862520217895508  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10946035385131836  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 21.04720640182495  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10912418365478516  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.652524948120117  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10922002792358398  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.5865797996521  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10870504379272461  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.112064838409424  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10950517654418945  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 21.059074878692627  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10909032821655273  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.730106830596924  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10887861251831055  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.130409717559814  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10947895050048828  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 21.09048843383789  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10931539535522461  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.96071720123291  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10901403427124023  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.68158197402954  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10908174514770508  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.65463924407959  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10916566848754883  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.65363311767578  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.1093907356262207  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.900597095489502  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10921287536621094  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.863032817840576  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10914468765258789  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.92628240585327  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03686238080263138 |0.023517288267612457 |0.6320832595229149 |9.440630674362183e-05 |1.1999968960881233 |0.00874185562133789 |
----------------------------------------------------------pseudo_mini_loss sum 1.2582381963729858
Total (block generation + training)time/epoch 126.65291077560849
Training time/epoch 60.63205862045288
Training time without block to device /epoch 59.87950539588928
Training time without total dataloading part /epoch 58.638327836990356
load block tensor time/epoch 1.179596185684204
block to device time/epoch 0.7525532245635986
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 27 |
Number of nodes for computation during this epoch:  9155041
Number of first layer input nodes during this epoch:  4804862
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.13120651245117188  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027037858963012695
random selection method range initialization spend 0.005929231643676758
time for parepare:  0.02044510841369629
local_output_nid generation:  0.0013873577117919922
local_in_edges_tensor generation:  0.007943153381347656
mini_batch_src_global generation:  0.0015535354614257812
r_  generation:  0.01078653335571289
local_output_nid generation:  0.0015957355499267578
local_in_edges_tensor generation:  0.001077890396118164
mini_batch_src_global generation:  0.001428842544555664
r_  generation:  0.010453224182128906
local_output_nid generation:  0.0015876293182373047
local_in_edges_tensor generation:  0.0009636878967285156
mini_batch_src_global generation:  0.0011034011840820312
r_  generation:  0.009537696838378906
local_output_nid generation:  0.0015683174133300781
local_in_edges_tensor generation:  0.0009129047393798828
mini_batch_src_global generation:  0.0011243820190429688
r_  generation:  0.00963282585144043
local_output_nid generation:  0.0015721321105957031
local_in_edges_tensor generation:  0.0009107589721679688
mini_batch_src_global generation:  0.001068115234375
r_  generation:  0.009944677352905273
local_output_nid generation:  0.0016078948974609375
local_in_edges_tensor generation:  0.0009074211120605469
mini_batch_src_global generation:  0.0010685920715332031
r_  generation:  0.009800910949707031
local_output_nid generation:  0.001561880111694336
local_in_edges_tensor generation:  0.0008831024169921875
mini_batch_src_global generation:  0.0010650157928466797
r_  generation:  0.009734392166137695
local_output_nid generation:  0.0015511512756347656
local_in_edges_tensor generation:  0.0008797645568847656
mini_batch_src_global generation:  0.001047372817993164
r_  generation:  0.009969234466552734
local_output_nid generation:  0.001565694808959961
local_in_edges_tensor generation:  0.0008561611175537109
mini_batch_src_global generation:  0.0010616779327392578
r_  generation:  0.010260820388793945
local_output_nid generation:  0.0015637874603271484
local_in_edges_tensor generation:  0.0008962154388427734
mini_batch_src_global generation:  0.0010521411895751953
r_  generation:  0.009802818298339844
local_output_nid generation:  0.001561880111694336
local_in_edges_tensor generation:  0.0008699893951416016
mini_batch_src_global generation:  0.0010879039764404297
r_  generation:  0.010331869125366211
local_output_nid generation:  0.0015575885772705078
local_in_edges_tensor generation:  0.0008599758148193359
mini_batch_src_global generation:  0.0011243820190429688
r_  generation:  0.010697364807128906
local_output_nid generation:  0.0015709400177001953
local_in_edges_tensor generation:  0.0008664131164550781
mini_batch_src_global generation:  0.0011157989501953125
r_  generation:  0.01041722297668457
local_output_nid generation:  0.001562356948852539
local_in_edges_tensor generation:  0.0008845329284667969
mini_batch_src_global generation:  0.0010848045349121094
r_  generation:  0.010300874710083008
local_output_nid generation:  0.0015568733215332031
local_in_edges_tensor generation:  0.0008697509765625
mini_batch_src_global generation:  0.001079559326171875
r_  generation:  0.010274648666381836
local_output_nid generation:  0.0015692710876464844
local_in_edges_tensor generation:  0.0008442401885986328
mini_batch_src_global generation:  0.0011277198791503906
r_  generation:  0.010802268981933594
local_output_nid generation:  0.0015666484832763672
local_in_edges_tensor generation:  0.0008382797241210938
mini_batch_src_global generation:  0.00121307373046875
r_  generation:  0.010545730590820312
local_output_nid generation:  0.0015752315521240234
local_in_edges_tensor generation:  0.0008592605590820312
mini_batch_src_global generation:  0.0011138916015625
r_  generation:  0.010022640228271484
local_output_nid generation:  0.0015614032745361328
local_in_edges_tensor generation:  0.0008618831634521484
mini_batch_src_global generation:  0.0010805130004882812
r_  generation:  0.010077238082885742
local_output_nid generation:  0.001566171646118164
local_in_edges_tensor generation:  0.0008234977722167969
mini_batch_src_global generation:  0.0010647773742675781
r_  generation:  0.010197877883911133
local_output_nid generation:  0.0015680789947509766
local_in_edges_tensor generation:  0.0008602142333984375
mini_batch_src_global generation:  0.0010786056518554688
r_  generation:  0.010476827621459961
local_output_nid generation:  0.0015642642974853516
local_in_edges_tensor generation:  0.0008215904235839844
mini_batch_src_global generation:  0.001196146011352539
r_  generation:  0.010360956192016602
local_output_nid generation:  0.0015418529510498047
local_in_edges_tensor generation:  0.0009329319000244141
mini_batch_src_global generation:  0.001111745834350586
r_  generation:  0.010584592819213867
local_output_nid generation:  0.0015399456024169922
local_in_edges_tensor generation:  0.0008761882781982422
mini_batch_src_global generation:  0.001088857650756836
r_  generation:  0.010355472564697266
local_output_nid generation:  0.0015301704406738281
local_in_edges_tensor generation:  0.0008795261383056641
mini_batch_src_global generation:  0.0011353492736816406
r_  generation:  0.01029825210571289
local_output_nid generation:  0.0015299320220947266
local_in_edges_tensor generation:  0.0008180141448974609
mini_batch_src_global generation:  0.0011336803436279297
r_  generation:  0.01044464111328125
local_output_nid generation:  0.0015468597412109375
local_in_edges_tensor generation:  0.0008685588836669922
mini_batch_src_global generation:  0.0010542869567871094
r_  generation:  0.010320901870727539
local_output_nid generation:  0.001539468765258789
local_in_edges_tensor generation:  0.0008847713470458984
mini_batch_src_global generation:  0.0011010169982910156
r_  generation:  0.0102081298828125
local_output_nid generation:  0.0015804767608642578
local_in_edges_tensor generation:  0.0008711814880371094
mini_batch_src_global generation:  0.0010907649993896484
r_  generation:  0.010476112365722656
local_output_nid generation:  0.0015494823455810547
local_in_edges_tensor generation:  0.0008645057678222656
mini_batch_src_global generation:  0.0010950565338134766
r_  generation:  0.010456085205078125
local_output_nid generation:  0.0015366077423095703
local_in_edges_tensor generation:  0.0009052753448486328
mini_batch_src_global generation:  0.0010771751403808594
r_  generation:  0.009963274002075195
local_output_nid generation:  0.0015540122985839844
local_in_edges_tensor generation:  0.0008981227874755859
mini_batch_src_global generation:  0.0011184215545654297
r_  generation:  0.010192632675170898
----------------------check_connections_block total spend ----------------------------- 0.5647251605987549
generate_one_block  0.02442765235900879
generate_one_block  0.02113199234008789
generate_one_block  0.018442630767822266
generate_one_block  0.018412113189697266
generate_one_block  0.018588542938232422
generate_one_block  0.01815056800842285
generate_one_block  0.01800084114074707
generate_one_block  0.01819586753845215
generate_one_block  0.01845550537109375
generate_one_block  0.017850399017333984
generate_one_block  0.018665075302124023
generate_one_block  0.022136926651000977
generate_one_block  0.020050525665283203
generate_one_block  0.01865386962890625
generate_one_block  0.01860809326171875
generate_one_block  0.01951146125793457
generate_one_block  0.019016742706298828
generate_one_block  0.01802992820739746
generate_one_block  0.018322229385375977
generate_one_block  0.01830911636352539
generate_one_block  0.018821001052856445
generate_one_block  0.019002676010131836
generate_one_block  0.019078493118286133
generate_one_block  0.018651723861694336
generate_one_block  0.018809080123901367
generate_one_block  0.018817901611328125
generate_one_block  0.01835799217224121
generate_one_block  0.018366575241088867
generate_one_block  0.01865363121032715
generate_one_block  0.018616199493408203
generate_one_block  0.019277095794677734
generate_one_block  0.018360376358032227
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04067826271057129
gen group dst list time:  0.025887012481689453
time for parepare:  0.022318124771118164
local_output_nid generation:  0.006558895111083984
local_in_edges_tensor generation:  0.021816730499267578
mini_batch_src_global generation:  0.0179593563079834
r_  generation:  0.16171956062316895
local_output_nid generation:  0.009403467178344727
local_in_edges_tensor generation:  0.012021780014038086
mini_batch_src_global generation:  0.022350072860717773
r_  generation:  0.1666111946105957
local_output_nid generation:  0.009345293045043945
local_in_edges_tensor generation:  0.03544974327087402
mini_batch_src_global generation:  0.019873619079589844
r_  generation:  0.16833996772766113
local_output_nid generation:  0.009460210800170898
local_in_edges_tensor generation:  0.009334087371826172
mini_batch_src_global generation:  0.02061295509338379
r_  generation:  0.16870570182800293
local_output_nid generation:  0.009634017944335938
local_in_edges_tensor generation:  0.011937618255615234
mini_batch_src_global generation:  0.022790193557739258
r_  generation:  0.1773078441619873
local_output_nid generation:  0.009096145629882812
local_in_edges_tensor generation:  0.008888721466064453
mini_batch_src_global generation:  0.022253751754760742
r_  generation:  0.17457914352416992
local_output_nid generation:  0.009142875671386719
local_in_edges_tensor generation:  0.010472774505615234
mini_batch_src_global generation:  0.023017168045043945
r_  generation:  0.17564845085144043
local_output_nid generation:  0.009088516235351562
local_in_edges_tensor generation:  0.009435653686523438
mini_batch_src_global generation:  0.022719383239746094
r_  generation:  0.17476940155029297
local_output_nid generation:  0.009249448776245117
local_in_edges_tensor generation:  0.009085893630981445
mini_batch_src_global generation:  0.023723602294921875
r_  generation:  0.17980313301086426
local_output_nid generation:  0.009296894073486328
local_in_edges_tensor generation:  0.009053707122802734
mini_batch_src_global generation:  0.022409439086914062
r_  generation:  0.17285871505737305
local_output_nid generation:  0.009599447250366211
local_in_edges_tensor generation:  0.010486125946044922
mini_batch_src_global generation:  0.023699283599853516
r_  generation:  0.18119049072265625
local_output_nid generation:  0.009812593460083008
local_in_edges_tensor generation:  0.01113438606262207
mini_batch_src_global generation:  0.028424739837646484
r_  generation:  0.1834239959716797
local_output_nid generation:  0.009807825088500977
local_in_edges_tensor generation:  0.011927604675292969
mini_batch_src_global generation:  0.0239715576171875
r_  generation:  0.18368220329284668
local_output_nid generation:  0.00958561897277832
local_in_edges_tensor generation:  0.009479045867919922
mini_batch_src_global generation:  0.02374410629272461
r_  generation:  0.18116450309753418
local_output_nid generation:  0.009643316268920898
local_in_edges_tensor generation:  0.010226964950561523
mini_batch_src_global generation:  0.023631572723388672
r_  generation:  0.18500971794128418
local_output_nid generation:  0.009867429733276367
local_in_edges_tensor generation:  0.012881040573120117
mini_batch_src_global generation:  0.025686264038085938
r_  generation:  0.1900336742401123
local_output_nid generation:  0.00964808464050293
local_in_edges_tensor generation:  0.010800361633300781
mini_batch_src_global generation:  0.024748802185058594
r_  generation:  0.1885826587677002
local_output_nid generation:  0.00943613052368164
local_in_edges_tensor generation:  0.009402990341186523
mini_batch_src_global generation:  0.023513317108154297
r_  generation:  0.17669439315795898
local_output_nid generation:  0.009486913681030273
local_in_edges_tensor generation:  0.009365081787109375
mini_batch_src_global generation:  0.021929264068603516
r_  generation:  0.17827749252319336
local_output_nid generation:  0.00975489616394043
local_in_edges_tensor generation:  0.009385824203491211
mini_batch_src_global generation:  0.02300572395324707
r_  generation:  0.18070435523986816
local_output_nid generation:  0.009636163711547852
local_in_edges_tensor generation:  0.009264945983886719
mini_batch_src_global generation:  0.023648500442504883
r_  generation:  0.18640708923339844
local_output_nid generation:  0.00975942611694336
local_in_edges_tensor generation:  0.011385202407836914
mini_batch_src_global generation:  0.024261474609375
r_  generation:  0.1827094554901123
local_output_nid generation:  0.009819269180297852
local_in_edges_tensor generation:  0.010631084442138672
mini_batch_src_global generation:  0.023578643798828125
r_  generation:  0.18540072441101074
local_output_nid generation:  0.009620189666748047
local_in_edges_tensor generation:  0.009307384490966797
mini_batch_src_global generation:  0.023579120635986328
r_  generation:  0.1809842586517334
local_output_nid generation:  0.009847164154052734
local_in_edges_tensor generation:  0.00936579704284668
mini_batch_src_global generation:  0.023630619049072266
r_  generation:  0.18475842475891113
local_output_nid generation:  0.009798765182495117
local_in_edges_tensor generation:  0.009046316146850586
mini_batch_src_global generation:  0.023714542388916016
r_  generation:  0.1830883026123047
local_output_nid generation:  0.009624481201171875
local_in_edges_tensor generation:  0.009267568588256836
mini_batch_src_global generation:  0.02294182777404785
r_  generation:  0.18438076972961426
local_output_nid generation:  0.009746074676513672
local_in_edges_tensor generation:  0.009548187255859375
mini_batch_src_global generation:  0.02307891845703125
r_  generation:  0.18136239051818848
local_output_nid generation:  0.009892940521240234
local_in_edges_tensor generation:  0.009100198745727539
mini_batch_src_global generation:  0.023473501205444336
r_  generation:  0.18532872200012207
local_output_nid generation:  0.009840726852416992
local_in_edges_tensor generation:  0.009547710418701172
mini_batch_src_global generation:  0.023869991302490234
r_  generation:  0.18427276611328125
local_output_nid generation:  0.009452104568481445
local_in_edges_tensor generation:  0.009093046188354492
mini_batch_src_global generation:  0.02241826057434082
r_  generation:  0.17728376388549805
local_output_nid generation:  0.009718894958496094
local_in_edges_tensor generation:  0.009341716766357422
mini_batch_src_global generation:  0.02335381507873535
r_  generation:  0.18296241760253906
----------------------check_connections_block total spend ----------------------------- 8.476983547210693
generate_one_block  0.2505929470062256
generate_one_block  0.23894262313842773
generate_one_block  0.23497295379638672
generate_one_block  0.23642182350158691
generate_one_block  0.2618999481201172
generate_one_block  0.2403857707977295
generate_one_block  0.2423856258392334
generate_one_block  0.24170303344726562
generate_one_block  0.2449173927307129
generate_one_block  0.23619532585144043
generate_one_block  0.24486756324768066
generate_one_block  0.2524399757385254
generate_one_block  0.251967191696167
generate_one_block  0.24699020385742188
generate_one_block  0.2508559226989746
generate_one_block  0.25876879692077637
generate_one_block  0.25434160232543945
generate_one_block  0.2394852638244629
generate_one_block  0.23923611640930176
generate_one_block  0.2502784729003906
generate_one_block  0.2536168098449707
generate_one_block  0.2513256072998047
generate_one_block  0.2512023448944092
generate_one_block  0.24609971046447754
generate_one_block  0.24872827529907227
generate_one_block  0.24927926063537598
generate_one_block  0.2483806610107422
generate_one_block  0.24487900733947754
generate_one_block  0.25177431106567383
generate_one_block  0.2528817653656006
generate_one_block  0.23796582221984863
generate_one_block  0.24617505073547363
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0340418815612793
gen group dst list time:  0.10644745826721191
time for parepare:  0.018999814987182617
local_output_nid generation:  0.024901390075683594
local_in_edges_tensor generation:  0.0450587272644043
mini_batch_src_global generation:  0.047107696533203125
r_  generation:  0.4795353412628174
local_output_nid generation:  0.031443119049072266
local_in_edges_tensor generation:  0.03749537467956543
mini_batch_src_global generation:  0.058945655822753906
r_  generation:  0.47813987731933594
local_output_nid generation:  0.032851219177246094
local_in_edges_tensor generation:  0.03570365905761719
mini_batch_src_global generation:  0.05830025672912598
r_  generation:  0.48896241188049316
local_output_nid generation:  0.031838178634643555
local_in_edges_tensor generation:  0.028702735900878906
mini_batch_src_global generation:  0.06104564666748047
r_  generation:  0.48668837547302246
local_output_nid generation:  0.031499624252319336
local_in_edges_tensor generation:  0.03865194320678711
mini_batch_src_global generation:  0.06096696853637695
r_  generation:  0.49323439598083496
local_output_nid generation:  0.03171110153198242
local_in_edges_tensor generation:  0.03312826156616211
mini_batch_src_global generation:  0.05987119674682617
r_  generation:  0.4897348880767822
local_output_nid generation:  0.03046727180480957
local_in_edges_tensor generation:  0.0298001766204834
mini_batch_src_global generation:  0.0578920841217041
r_  generation:  0.4957149028778076
local_output_nid generation:  0.029395103454589844
local_in_edges_tensor generation:  0.030233144760131836
mini_batch_src_global generation:  0.05903053283691406
r_  generation:  0.488755464553833
local_output_nid generation:  0.02947545051574707
local_in_edges_tensor generation:  0.02922987937927246
mini_batch_src_global generation:  0.0581362247467041
r_  generation:  0.49584507942199707
local_output_nid generation:  0.0295565128326416
local_in_edges_tensor generation:  0.02921891212463379
mini_batch_src_global generation:  0.05897974967956543
r_  generation:  0.49001598358154297
local_output_nid generation:  0.029448270797729492
local_in_edges_tensor generation:  0.03109598159790039
mini_batch_src_global generation:  0.06073355674743652
r_  generation:  0.49806642532348633
local_output_nid generation:  0.02944326400756836
local_in_edges_tensor generation:  0.031099557876586914
mini_batch_src_global generation:  0.05916476249694824
r_  generation:  0.49469447135925293
local_output_nid generation:  0.029846906661987305
local_in_edges_tensor generation:  0.033675432205200195
mini_batch_src_global generation:  0.06003975868225098
r_  generation:  0.49971532821655273
local_output_nid generation:  0.03188610076904297
local_in_edges_tensor generation:  0.030240774154663086
mini_batch_src_global generation:  0.059294939041137695
r_  generation:  0.4935142993927002
local_output_nid generation:  0.029433488845825195
local_in_edges_tensor generation:  0.02895331382751465
mini_batch_src_global generation:  0.06033587455749512
r_  generation:  0.49773597717285156
local_output_nid generation:  0.02979898452758789
local_in_edges_tensor generation:  0.03339743614196777
mini_batch_src_global generation:  0.05875658988952637
r_  generation:  0.49547290802001953
local_output_nid generation:  0.029762983322143555
local_in_edges_tensor generation:  0.031668663024902344
mini_batch_src_global generation:  0.057987213134765625
r_  generation:  0.4956245422363281
local_output_nid generation:  0.029465675354003906
local_in_edges_tensor generation:  0.029323816299438477
mini_batch_src_global generation:  0.05920672416687012
r_  generation:  0.49666500091552734
local_output_nid generation:  0.02948164939880371
local_in_edges_tensor generation:  0.032495975494384766
mini_batch_src_global generation:  0.05755329132080078
r_  generation:  0.49890589714050293
local_output_nid generation:  0.02935504913330078
local_in_edges_tensor generation:  0.032091379165649414
mini_batch_src_global generation:  0.0588688850402832
r_  generation:  0.49240589141845703
local_output_nid generation:  0.029237747192382812
local_in_edges_tensor generation:  0.029157638549804688
mini_batch_src_global generation:  0.05988717079162598
r_  generation:  0.4941439628601074
local_output_nid generation:  0.029889345169067383
local_in_edges_tensor generation:  0.03325390815734863
mini_batch_src_global generation:  0.05922746658325195
r_  generation:  0.5064630508422852
local_output_nid generation:  0.02966475486755371
local_in_edges_tensor generation:  0.0311281681060791
mini_batch_src_global generation:  0.05766749382019043
r_  generation:  0.5019378662109375
local_output_nid generation:  0.029405832290649414
local_in_edges_tensor generation:  0.03122401237487793
mini_batch_src_global generation:  0.0585787296295166
r_  generation:  0.5022125244140625
local_output_nid generation:  0.030135393142700195
local_in_edges_tensor generation:  0.031077861785888672
mini_batch_src_global generation:  0.05797576904296875
r_  generation:  0.5003392696380615
local_output_nid generation:  0.029673337936401367
local_in_edges_tensor generation:  0.031081438064575195
mini_batch_src_global generation:  0.05896759033203125
r_  generation:  0.4971191883087158
local_output_nid generation:  0.02953052520751953
local_in_edges_tensor generation:  0.031218528747558594
mini_batch_src_global generation:  0.05770587921142578
r_  generation:  0.4988272190093994
local_output_nid generation:  0.029536008834838867
local_in_edges_tensor generation:  0.0337221622467041
mini_batch_src_global generation:  0.05933117866516113
r_  generation:  0.4949789047241211
local_output_nid generation:  0.02971935272216797
local_in_edges_tensor generation:  0.03178095817565918
mini_batch_src_global generation:  0.05868387222290039
r_  generation:  0.5010507106781006
local_output_nid generation:  0.029604434967041016
local_in_edges_tensor generation:  0.031426191329956055
mini_batch_src_global generation:  0.05923056602478027
r_  generation:  0.49448132514953613
local_output_nid generation:  0.029255151748657227
local_in_edges_tensor generation:  0.03451371192932129
mini_batch_src_global generation:  0.05865979194641113
r_  generation:  0.49617719650268555
local_output_nid generation:  0.029627323150634766
local_in_edges_tensor generation:  0.029880523681640625
mini_batch_src_global generation:  0.05968475341796875
r_  generation:  0.4947226047515869
----------------------check_connections_block total spend ----------------------------- 23.154569149017334
generate_one_block  0.673271656036377
generate_one_block  0.6727302074432373
generate_one_block  0.6652777194976807
generate_one_block  0.6764116287231445
generate_one_block  0.7674431800842285
generate_one_block  0.6791694164276123
generate_one_block  0.6735973358154297
generate_one_block  0.6730246543884277
generate_one_block  0.6740779876708984
generate_one_block  0.6695690155029297
generate_one_block  0.6737797260284424
generate_one_block  0.668813943862915
generate_one_block  0.677098274230957
generate_one_block  0.6745622158050537
generate_one_block  0.6802546977996826
generate_one_block  0.6776807308197021
generate_one_block  0.6765415668487549
generate_one_block  0.6667988300323486
generate_one_block  0.6752521991729736
generate_one_block  0.6722023487091064
generate_one_block  0.6725881099700928
generate_one_block  0.6783349514007568
generate_one_block  0.6761696338653564
generate_one_block  0.6734645366668701
generate_one_block  0.6968855857849121
generate_one_block  0.6830015182495117
generate_one_block  0.6849081516265869
generate_one_block  0.6824347972869873
generate_one_block  0.6881513595581055
generate_one_block  0.6839308738708496
generate_one_block  0.6941170692443848
generate_one_block  0.673757791519165
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.13120651245117188  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

connection checking time:  31.631552696228027
block generation total time  29.655258893966675
average batch blocks generation time:  0.9267268404364586
block dataloader generation time/epoch 65.82197002360695
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10920572280883789  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.60585594177246  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10907840728759766  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.520540237426758  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.1087942123413086  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.348628520965576  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10918045043945312  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.47038459777832  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10900497436523438  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.816213130950928  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10924863815307617  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.629780292510986  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10915422439575195  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.630874633789062  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10910511016845703  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.585067749023438  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.1089792251586914  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.732698917388916  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10918903350830078  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.39579200744629  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10925865173339844  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.85237741470337  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10915613174438477  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 21.041826248168945  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10946226119995117  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 21.027161121368408  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.1092371940612793  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.83378553390503  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10920286178588867  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 21.011582374572754  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10942411422729492  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 21.338711261749268  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10936832427978516  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 21.13965654373169  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10906696319580078  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.515223503112793  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10920429229736328  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.596542358398438  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10913991928100586  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.681454181671143  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10919380187988281  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.92756938934326  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.1092071533203125  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.95948362350464  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10930728912353516  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.961732864379883  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10925531387329102  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.713118076324463  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10944843292236328  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.955727100372314  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10933351516723633  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.839725017547607  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10916900634765625  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.75837516784668  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.1091604232788086  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.725764274597168  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10946941375732422  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.97040891647339  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.1094808578491211  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.95074701309204  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10879325866699219  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.352815628051758  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10930490493774414  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.85871934890747  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03666960448026657 |0.021423332393169403 |0.6335186883807182 |9.537488222122192e-05 |1.2111961841583252 |0.009411334991455078 |
----------------------------------------------------------pseudo_mini_loss sum 1.2449495792388916
Total (block generation + training)time/epoch 126.6168569514626
Training time/epoch 60.9635910987854
Training time without block to device /epoch 60.27804446220398
Training time without total dataloading part /epoch 59.043339252471924
load block tensor time/epoch 1.1734273433685303
block to device time/epoch 0.6855466365814209
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 28 |
Number of nodes for computation during this epoch:  9158118
Number of first layer input nodes during this epoch:  4807509
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.13126468658447266  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02736186981201172
random selection method range initialization spend 0.006898403167724609
time for parepare:  0.022176742553710938
local_output_nid generation:  0.0014507770538330078
local_in_edges_tensor generation:  0.0060613155364990234
mini_batch_src_global generation:  0.00208282470703125
r_  generation:  0.011666297912597656
local_output_nid generation:  0.0016868114471435547
local_in_edges_tensor generation:  0.0010445117950439453
mini_batch_src_global generation:  0.0015006065368652344
r_  generation:  0.010807991027832031
local_output_nid generation:  0.0016169548034667969
local_in_edges_tensor generation:  0.001018524169921875
mini_batch_src_global generation:  0.001129150390625
r_  generation:  0.00968027114868164
local_output_nid generation:  0.001604318618774414
local_in_edges_tensor generation:  0.0009181499481201172
mini_batch_src_global generation:  0.0010991096496582031
r_  generation:  0.009949684143066406
local_output_nid generation:  0.001584768295288086
local_in_edges_tensor generation:  0.0009565353393554688
mini_batch_src_global generation:  0.0011663436889648438
r_  generation:  0.01003575325012207
local_output_nid generation:  0.0015790462493896484
local_in_edges_tensor generation:  0.0008966922760009766
mini_batch_src_global generation:  0.0011069774627685547
r_  generation:  0.00992584228515625
local_output_nid generation:  0.001567840576171875
local_in_edges_tensor generation:  0.0009150505065917969
mini_batch_src_global generation:  0.0010287761688232422
r_  generation:  0.00955057144165039
local_output_nid generation:  0.0015864372253417969
local_in_edges_tensor generation:  0.0008800029754638672
mini_batch_src_global generation:  0.0011167526245117188
r_  generation:  0.010126352310180664
local_output_nid generation:  0.0015604496002197266
local_in_edges_tensor generation:  0.000888824462890625
mini_batch_src_global generation:  0.0010972023010253906
r_  generation:  0.010169267654418945
local_output_nid generation:  0.0015778541564941406
local_in_edges_tensor generation:  0.0008769035339355469
mini_batch_src_global generation:  0.0011188983917236328
r_  generation:  0.010297298431396484
local_output_nid generation:  0.0015759468078613281
local_in_edges_tensor generation:  0.0008559226989746094
mini_batch_src_global generation:  0.0011475086212158203
r_  generation:  0.010267972946166992
local_output_nid generation:  0.001589059829711914
local_in_edges_tensor generation:  0.0008804798126220703
mini_batch_src_global generation:  0.0011324882507324219
r_  generation:  0.010265827178955078
local_output_nid generation:  0.0015702247619628906
local_in_edges_tensor generation:  0.0009179115295410156
mini_batch_src_global generation:  0.0010879039764404297
r_  generation:  0.010318517684936523
local_output_nid generation:  0.0015704631805419922
local_in_edges_tensor generation:  0.0008471012115478516
mini_batch_src_global generation:  0.0011358261108398438
r_  generation:  0.010320186614990234
local_output_nid generation:  0.0015635490417480469
local_in_edges_tensor generation:  0.0008647441864013672
mini_batch_src_global generation:  0.0011386871337890625
r_  generation:  0.010686397552490234
local_output_nid generation:  0.0015468597412109375
local_in_edges_tensor generation:  0.0008406639099121094
mini_batch_src_global generation:  0.0011792182922363281
r_  generation:  0.010720968246459961
local_output_nid generation:  0.0015566349029541016
local_in_edges_tensor generation:  0.0008685588836669922
mini_batch_src_global generation:  0.0010938644409179688
r_  generation:  0.010231494903564453
local_output_nid generation:  0.0016052722930908203
local_in_edges_tensor generation:  0.0009396076202392578
mini_batch_src_global generation:  0.0011453628540039062
r_  generation:  0.010088443756103516
local_output_nid generation:  0.0016400814056396484
local_in_edges_tensor generation:  0.0008602142333984375
mini_batch_src_global generation:  0.001116037368774414
r_  generation:  0.010334491729736328
local_output_nid generation:  0.0015816688537597656
local_in_edges_tensor generation:  0.000873565673828125
mini_batch_src_global generation:  0.0011487007141113281
r_  generation:  0.010218143463134766
local_output_nid generation:  0.0015726089477539062
local_in_edges_tensor generation:  0.0008242130279541016
mini_batch_src_global generation:  0.0012023448944091797
r_  generation:  0.01049661636352539
local_output_nid generation:  0.0015697479248046875
local_in_edges_tensor generation:  0.0008597373962402344
mini_batch_src_global generation:  0.0011446475982666016
r_  generation:  0.01031351089477539
local_output_nid generation:  0.0015764236450195312
local_in_edges_tensor generation:  0.0008592605590820312
mini_batch_src_global generation:  0.0011353492736816406
r_  generation:  0.010530710220336914
local_output_nid generation:  0.0015702247619628906
local_in_edges_tensor generation:  0.0008535385131835938
mini_batch_src_global generation:  0.001100301742553711
r_  generation:  0.010041952133178711
local_output_nid generation:  0.0015730857849121094
local_in_edges_tensor generation:  0.0008590221405029297
mini_batch_src_global generation:  0.001123189926147461
r_  generation:  0.00996255874633789
local_output_nid generation:  0.0015645027160644531
local_in_edges_tensor generation:  0.0008456707000732422
mini_batch_src_global generation:  0.001127481460571289
r_  generation:  0.010444879531860352
local_output_nid generation:  0.0015687942504882812
local_in_edges_tensor generation:  0.0008652210235595703
mini_batch_src_global generation:  0.0011539459228515625
r_  generation:  0.010440349578857422
local_output_nid generation:  0.0015649795532226562
local_in_edges_tensor generation:  0.0008625984191894531
mini_batch_src_global generation:  0.0013952255249023438
r_  generation:  0.010200977325439453
local_output_nid generation:  0.0015721321105957031
local_in_edges_tensor generation:  0.0008389949798583984
mini_batch_src_global generation:  0.0011429786682128906
r_  generation:  0.010439395904541016
local_output_nid generation:  0.0015690326690673828
local_in_edges_tensor generation:  0.0008602142333984375
mini_batch_src_global generation:  0.0012536048889160156
r_  generation:  0.010360240936279297
local_output_nid generation:  0.0015707015991210938
local_in_edges_tensor generation:  0.0008215904235839844
mini_batch_src_global generation:  0.0011126995086669922
r_  generation:  0.010013341903686523
local_output_nid generation:  0.001567840576171875
local_in_edges_tensor generation:  0.0009992122650146484
mini_batch_src_global generation:  0.001230478286743164
r_  generation:  0.010451555252075195
----------------------check_connections_block total spend ----------------------------- 0.5696370601654053
generate_one_block  0.025485754013061523
generate_one_block  0.02179694175720215
generate_one_block  0.01944112777709961
generate_one_block  0.019172191619873047
generate_one_block  0.019337892532348633
generate_one_block  0.0186920166015625
generate_one_block  0.01784038543701172
generate_one_block  0.019152402877807617
generate_one_block  0.018340349197387695
generate_one_block  0.019032001495361328
generate_one_block  0.018923521041870117
generate_one_block  0.021763324737548828
generate_one_block  0.019865751266479492
generate_one_block  0.0190889835357666
generate_one_block  0.019412755966186523
generate_one_block  0.019463300704956055
generate_one_block  0.018288135528564453
generate_one_block  0.017833232879638672
generate_one_block  0.018433332443237305
generate_one_block  0.01830148696899414
generate_one_block  0.019258737564086914
generate_one_block  0.019128084182739258
generate_one_block  0.019328594207763672
generate_one_block  0.01809978485107422
generate_one_block  0.018103837966918945
generate_one_block  0.018863439559936523
generate_one_block  0.019072294235229492
generate_one_block  0.018413782119750977
generate_one_block  0.01914834976196289
generate_one_block  0.019016265869140625
generate_one_block  0.018279314041137695
generate_one_block  0.01870274543762207
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04492521286010742
gen group dst list time:  0.023664474487304688
time for parepare:  0.020412921905517578
local_output_nid generation:  0.0068132877349853516
local_in_edges_tensor generation:  0.020914793014526367
mini_batch_src_global generation:  0.017148256301879883
r_  generation:  0.17203545570373535
local_output_nid generation:  0.00943136215209961
local_in_edges_tensor generation:  0.012254476547241211
mini_batch_src_global generation:  0.025217771530151367
r_  generation:  0.18083715438842773
local_output_nid generation:  0.009690999984741211
local_in_edges_tensor generation:  0.036501169204711914
mini_batch_src_global generation:  0.02169203758239746
r_  generation:  0.17353034019470215
local_output_nid generation:  0.009769201278686523
local_in_edges_tensor generation:  0.015816926956176758
mini_batch_src_global generation:  0.022016048431396484
r_  generation:  0.18314647674560547
local_output_nid generation:  0.00988459587097168
local_in_edges_tensor generation:  0.011070728302001953
mini_batch_src_global generation:  0.022463560104370117
r_  generation:  0.18969273567199707
local_output_nid generation:  0.010785579681396484
local_in_edges_tensor generation:  0.00957489013671875
mini_batch_src_global generation:  0.023448467254638672
r_  generation:  0.17671537399291992
local_output_nid generation:  0.009002923965454102
local_in_edges_tensor generation:  0.011519908905029297
mini_batch_src_global generation:  0.022025585174560547
r_  generation:  0.16751933097839355
local_output_nid generation:  0.009606599807739258
local_in_edges_tensor generation:  0.011835336685180664
mini_batch_src_global generation:  0.024213552474975586
r_  generation:  0.1864018440246582
local_output_nid generation:  0.009397029876708984
local_in_edges_tensor generation:  0.011932373046875
mini_batch_src_global generation:  0.02328348159790039
r_  generation:  0.1757984161376953
local_output_nid generation:  0.009975433349609375
local_in_edges_tensor generation:  0.010742902755737305
mini_batch_src_global generation:  0.024586200714111328
r_  generation:  0.18633770942687988
local_output_nid generation:  0.009988784790039062
local_in_edges_tensor generation:  0.00909733772277832
mini_batch_src_global generation:  0.023401975631713867
r_  generation:  0.1847400665283203
local_output_nid generation:  0.00988149642944336
local_in_edges_tensor generation:  0.010226249694824219
mini_batch_src_global generation:  0.023207426071166992
r_  generation:  0.18421578407287598
local_output_nid generation:  0.009892940521240234
local_in_edges_tensor generation:  0.012253522872924805
mini_batch_src_global generation:  0.023630380630493164
r_  generation:  0.18662095069885254
local_output_nid generation:  0.012739896774291992
local_in_edges_tensor generation:  0.009816884994506836
mini_batch_src_global generation:  0.023933887481689453
r_  generation:  0.18759894371032715
local_output_nid generation:  0.010213375091552734
local_in_edges_tensor generation:  0.012409210205078125
mini_batch_src_global generation:  0.025474071502685547
r_  generation:  0.19703125953674316
local_output_nid generation:  0.010274887084960938
local_in_edges_tensor generation:  0.012016773223876953
mini_batch_src_global generation:  0.024481534957885742
r_  generation:  0.1951007843017578
local_output_nid generation:  0.00975489616394043
local_in_edges_tensor generation:  0.009198427200317383
mini_batch_src_global generation:  0.023759841918945312
r_  generation:  0.1841728687286377
local_output_nid generation:  0.009581565856933594
local_in_edges_tensor generation:  0.010887384414672852
mini_batch_src_global generation:  0.022434711456298828
r_  generation:  0.1760249137878418
local_output_nid generation:  0.009920358657836914
local_in_edges_tensor generation:  0.01035308837890625
mini_batch_src_global generation:  0.023492813110351562
r_  generation:  0.1831374168395996
local_output_nid generation:  0.009802579879760742
local_in_edges_tensor generation:  0.009864330291748047
mini_batch_src_global generation:  0.024715185165405273
r_  generation:  0.18305253982543945
local_output_nid generation:  0.010112285614013672
local_in_edges_tensor generation:  0.009712934494018555
mini_batch_src_global generation:  0.02379298210144043
r_  generation:  0.19251680374145508
local_output_nid generation:  0.01008152961730957
local_in_edges_tensor generation:  0.010681867599487305
mini_batch_src_global generation:  0.02384352684020996
r_  generation:  0.19001340866088867
local_output_nid generation:  0.01034235954284668
local_in_edges_tensor generation:  0.011170387268066406
mini_batch_src_global generation:  0.0263059139251709
r_  generation:  0.19068098068237305
local_output_nid generation:  0.009797334671020508
local_in_edges_tensor generation:  0.010009765625
mini_batch_src_global generation:  0.0227508544921875
r_  generation:  0.1808915138244629
local_output_nid generation:  0.009828805923461914
local_in_edges_tensor generation:  0.009804010391235352
mini_batch_src_global generation:  0.022521495819091797
r_  generation:  0.1767730712890625
local_output_nid generation:  0.010071039199829102
local_in_edges_tensor generation:  0.010257720947265625
mini_batch_src_global generation:  0.02359604835510254
r_  generation:  0.1900029182434082
local_output_nid generation:  0.010268926620483398
local_in_edges_tensor generation:  0.010339021682739258
mini_batch_src_global generation:  0.02408456802368164
r_  generation:  0.19019460678100586
local_output_nid generation:  0.010005474090576172
local_in_edges_tensor generation:  0.009796380996704102
mini_batch_src_global generation:  0.023773908615112305
r_  generation:  0.18198633193969727
local_output_nid generation:  0.0100555419921875
local_in_edges_tensor generation:  0.010618925094604492
mini_batch_src_global generation:  0.023637056350708008
r_  generation:  0.1873619556427002
local_output_nid generation:  0.010856151580810547
local_in_edges_tensor generation:  0.010542154312133789
mini_batch_src_global generation:  0.02366018295288086
r_  generation:  0.1895294189453125
local_output_nid generation:  0.009822607040405273
local_in_edges_tensor generation:  0.009064912796020508
mini_batch_src_global generation:  0.02282428741455078
r_  generation:  0.17798280715942383
local_output_nid generation:  0.009972572326660156
local_in_edges_tensor generation:  0.010643720626831055
mini_batch_src_global generation:  0.023587942123413086
r_  generation:  0.1845400333404541
----------------------check_connections_block total spend ----------------------------- 8.679534912109375
generate_one_block  0.258838415145874
generate_one_block  0.2493431568145752
generate_one_block  0.2424914836883545
generate_one_block  0.24904298782348633
generate_one_block  0.26280713081359863
generate_one_block  0.24374151229858398
generate_one_block  0.23340272903442383
generate_one_block  0.2523159980773926
generate_one_block  0.2374725341796875
generate_one_block  0.25609850883483887
generate_one_block  0.2546420097351074
generate_one_block  0.2517516613006592
generate_one_block  0.2604503631591797
generate_one_block  0.2587242126464844
generate_one_block  0.2699744701385498
generate_one_block  0.2666661739349365
generate_one_block  0.25034451484680176
generate_one_block  0.23927688598632812
generate_one_block  0.24454784393310547
generate_one_block  0.2472400665283203
generate_one_block  0.2572505474090576
generate_one_block  0.256744384765625
generate_one_block  0.262373685836792
generate_one_block  0.24442291259765625
generate_one_block  0.23772835731506348
generate_one_block  0.254610538482666
generate_one_block  0.25928759574890137
generate_one_block  0.24892115592956543
generate_one_block  0.250995397567749
generate_one_block  0.2520334720611572
generate_one_block  0.23726606369018555
generate_one_block  0.24454784393310547
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0400388240814209
gen group dst list time:  0.1148064136505127
time for parepare:  0.020361900329589844
local_output_nid generation:  0.026013612747192383
local_in_edges_tensor generation:  0.051712989807128906
mini_batch_src_global generation:  0.047469377517700195
r_  generation:  0.48614501953125
local_output_nid generation:  0.03206157684326172
local_in_edges_tensor generation:  0.03792691230773926
mini_batch_src_global generation:  0.06100893020629883
r_  generation:  0.48879194259643555
local_output_nid generation:  0.03207063674926758
local_in_edges_tensor generation:  0.03217148780822754
mini_batch_src_global generation:  0.057186126708984375
r_  generation:  0.5077941417694092
local_output_nid generation:  0.03259778022766113
local_in_edges_tensor generation:  0.03935050964355469
mini_batch_src_global generation:  0.06058669090270996
r_  generation:  0.4976210594177246
local_output_nid generation:  0.031807661056518555
local_in_edges_tensor generation:  0.03757476806640625
mini_batch_src_global generation:  0.06012535095214844
r_  generation:  0.5022227764129639
local_output_nid generation:  0.0321812629699707
local_in_edges_tensor generation:  0.03235578536987305
mini_batch_src_global generation:  0.06240487098693848
r_  generation:  0.4999573230743408
local_output_nid generation:  0.03078317642211914
local_in_edges_tensor generation:  0.0382084846496582
mini_batch_src_global generation:  0.060950279235839844
r_  generation:  0.5037915706634521
local_output_nid generation:  0.029982566833496094
local_in_edges_tensor generation:  0.034223079681396484
mini_batch_src_global generation:  0.06119108200073242
r_  generation:  0.5043959617614746
local_output_nid generation:  0.02988886833190918
local_in_edges_tensor generation:  0.031484127044677734
mini_batch_src_global generation:  0.06043434143066406
r_  generation:  0.5012857913970947
local_output_nid generation:  0.03027963638305664
local_in_edges_tensor generation:  0.0331268310546875
mini_batch_src_global generation:  0.061791181564331055
r_  generation:  0.5033860206604004
local_output_nid generation:  0.03033137321472168
local_in_edges_tensor generation:  0.02974987030029297
mini_batch_src_global generation:  0.06073713302612305
r_  generation:  0.5008645057678223
local_output_nid generation:  0.030096769332885742
local_in_edges_tensor generation:  0.03409218788146973
mini_batch_src_global generation:  0.06257843971252441
r_  generation:  0.49958038330078125
local_output_nid generation:  0.03166055679321289
local_in_edges_tensor generation:  0.03800034523010254
mini_batch_src_global generation:  0.0584263801574707
r_  generation:  0.5039491653442383
local_output_nid generation:  0.030137062072753906
local_in_edges_tensor generation:  0.03407096862792969
mini_batch_src_global generation:  0.059424638748168945
r_  generation:  0.4987518787384033
local_output_nid generation:  0.030324459075927734
local_in_edges_tensor generation:  0.03388643264770508
mini_batch_src_global generation:  0.06325507164001465
r_  generation:  0.5038831233978271
local_output_nid generation:  0.030056238174438477
local_in_edges_tensor generation:  0.03551673889160156
mini_batch_src_global generation:  0.062148094177246094
r_  generation:  0.5223462581634521
local_output_nid generation:  0.03135561943054199
local_in_edges_tensor generation:  0.03631329536437988
mini_batch_src_global generation:  0.0619204044342041
r_  generation:  0.5049624443054199
local_output_nid generation:  0.031187057495117188
local_in_edges_tensor generation:  0.032736778259277344
mini_batch_src_global generation:  0.06149458885192871
r_  generation:  0.4973866939544678
local_output_nid generation:  0.03088688850402832
local_in_edges_tensor generation:  0.03207039833068848
mini_batch_src_global generation:  0.05814409255981445
r_  generation:  0.4993712902069092
local_output_nid generation:  0.030721187591552734
local_in_edges_tensor generation:  0.03514385223388672
mini_batch_src_global generation:  0.05949807167053223
r_  generation:  0.5006608963012695
local_output_nid generation:  0.030949115753173828
local_in_edges_tensor generation:  0.03776979446411133
mini_batch_src_global generation:  0.060756683349609375
r_  generation:  0.5027816295623779
local_output_nid generation:  0.031174659729003906
local_in_edges_tensor generation:  0.029423236846923828
mini_batch_src_global generation:  0.05941486358642578
r_  generation:  0.50130295753479
local_output_nid generation:  0.03081822395324707
local_in_edges_tensor generation:  0.03190302848815918
mini_batch_src_global generation:  0.06023716926574707
r_  generation:  0.5017340183258057
local_output_nid generation:  0.03055715560913086
local_in_edges_tensor generation:  0.03060746192932129
mini_batch_src_global generation:  0.059656620025634766
r_  generation:  0.5056157112121582
local_output_nid generation:  0.031023025512695312
local_in_edges_tensor generation:  0.0338442325592041
mini_batch_src_global generation:  0.058385610580444336
r_  generation:  0.5008602142333984
local_output_nid generation:  0.03162407875061035
local_in_edges_tensor generation:  0.02960348129272461
mini_batch_src_global generation:  0.06056666374206543
r_  generation:  0.5056688785552979
local_output_nid generation:  0.031271934509277344
local_in_edges_tensor generation:  0.03086113929748535
mini_batch_src_global generation:  0.0586848258972168
r_  generation:  0.506765604019165
local_output_nid generation:  0.030713796615600586
local_in_edges_tensor generation:  0.028949975967407227
mini_batch_src_global generation:  0.05945181846618652
r_  generation:  0.5040290355682373
local_output_nid generation:  0.030572891235351562
local_in_edges_tensor generation:  0.032283782958984375
mini_batch_src_global generation:  0.06072497367858887
r_  generation:  0.5015733242034912
local_output_nid generation:  0.030756711959838867
local_in_edges_tensor generation:  0.030016660690307617
mini_batch_src_global generation:  0.05952048301696777
r_  generation:  0.5010554790496826
local_output_nid generation:  0.03080916404724121
local_in_edges_tensor generation:  0.028228282928466797
mini_batch_src_global generation:  0.058855533599853516
r_  generation:  0.4990377426147461
local_output_nid generation:  0.03135108947753906
local_in_edges_tensor generation:  0.03511810302734375
mini_batch_src_global generation:  0.05950927734375
r_  generation:  0.502514123916626
----------------------check_connections_block total spend ----------------------------- 23.557607889175415
generate_one_block  0.6998553276062012
generate_one_block  0.6886904239654541
generate_one_block  0.6863179206848145
generate_one_block  0.6906156539916992
generate_one_block  0.7988860607147217
generate_one_block  0.6811487674713135
generate_one_block  0.6877388954162598
generate_one_block  0.6846356391906738
generate_one_block  0.6773502826690674
generate_one_block  0.6874475479125977
generate_one_block  0.6867702007293701
generate_one_block  0.6871585845947266
generate_one_block  0.6838574409484863
generate_one_block  0.6848270893096924
generate_one_block  0.683943510055542
generate_one_block  0.6937623023986816
generate_one_block  0.6886696815490723
generate_one_block  0.6743605136871338
generate_one_block  0.6737139225006104
generate_one_block  0.691943883895874
generate_one_block  0.6971118450164795
generate_one_block  0.6829164028167725
generate_one_block  0.6893250942230225
generate_one_block  0.6804249286651611
generate_one_block  0.697108268737793
generate_one_block  0.6870815753936768
generate_one_block  0.703047513961792
generate_one_block  0.6740636825561523
generate_one_block  0.6759364604949951
generate_one_block  0.6878974437713623
generate_one_block  0.6847875118255615
generate_one_block  0.6913082599639893
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.13126468658447266  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

connection checking time:  32.23714280128479
block generation total time  30.118057250976562
average batch blocks generation time:  0.9411892890930176
block dataloader generation time/epoch 65.83512412309646
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10927343368530273  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.818880558013916  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10943460464477539  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.92292070388794  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10920572280883789  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.606117248535156  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10954999923706055  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.942582607269287  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10951900482177734  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.856786251068115  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10935735702514648  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.647630214691162  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10856342315673828  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 19.97499942779541  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10948467254638672  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 21.031946659088135  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.1088566780090332  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.349977016448975  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10954093933105469  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 21.161490440368652  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10917186737060547  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.90957498550415  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10924291610717773  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.74035358428955  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10927581787109375  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.94888162612915  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10916471481323242  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.94237995147705  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10959005355834961  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 21.378591537475586  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10964059829711914  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 21.433403968811035  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10912752151489258  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.611299514770508  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.1089029312133789  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.16678476333618  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10921001434326172  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.636180877685547  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10909557342529297  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.465742111206055  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10948038101196289  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 21.147568225860596  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10907793045043945  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.956446647644043  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10962772369384766  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 21.17489528656006  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10884714126586914  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.530893802642822  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10912513732910156  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.375030994415283  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10945320129394531  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 21.005444049835205  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10939407348632812  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 21.024330139160156  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10914754867553711  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.65068817138672  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.1091303825378418  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.796841621398926  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10934305191040039  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.884684085845947  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10917234420776367  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.429311752319336  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 0.10949277877807617  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2967529296875 GB
    Memory Allocated: 20.76149892807007  GigaBytes
Max Memory Allocated: 21.748734951019287  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03514997661113739 |0.023308075964450836 |0.6423270031809807 |9.676814079284668e-05 |1.212143063545227 |0.009601354598999023 |
----------------------------------------------------------pseudo_mini_loss sum 1.235345482826233
Total (block generation + training)time/epoch 126.6546660065651
Training time/epoch 61.28771638870239
Training time without block to device /epoch 60.541857957839966
Training time without total dataloading part /epoch 59.35574007034302
load block tensor time/epoch 1.1247992515563965
block to device time/epoch 0.7458584308624268
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 29 |
Number of nodes for computation during this epoch:  9166847
Number of first layer input nodes during this epoch:  4810652
